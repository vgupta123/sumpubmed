BACKGROUND
the large-scale identification, characterization and quantification of proteins in biological samples by liquid chromatography-mass spectrometry  and liquid chromatography-tandem mass spectrometry -based proteomic methods play a crucial role in biomedical research  <cit> . for example, in biomarker discovery studies, a common aim is to elucidate a set of proteins that can be used to reliably differentiate diseased and normal samples by abundance measurements. precision and accuracy are critical for confident protein biomarker discovery and validation. in "bottom-up" approaches, proteins are cleaved by sequence-specific proteases such as trypsin prior to analysis. a protein fold change can be inferred from the relative abundance of peptides across samples, where peptide identification and quantification can be accomplished in separate steps  <cit> . in this paper, we consider the problem of relative isotopic quantification of peptides in lc-ms based on time-of-flight  instruments. it is assumed herein that a list of candidate peptides has been compiled a priori, and that we are interested in measuring the relative abundance of their isotopes .

the measurement of peptide abundance is complicated by the fact that a peptide forms both lc and ms peaks during its lc elution interval. to quantify a peptide, it requires the integration of its complete lc peaks, which is sometimes impossible due to strong interference from other peptide species or contaminants. however, relative quantification is still possible for the uncorrupted segments of lc peaks with slightly different isotopic compositions. relative isotope abundance measurement is particularly important in chemical and metabolic labeling experiments for the quantification of differential expression of isotopically-labeled peptide pairs and their corresponding proteins. in "label-free" lc-ms peptide detection, measurement of relative natural isotope abundance is employed for peptide detection. in both cases, there exist several significant challenges:  <dig>  the determination of lc peak boundaries to exclude noisy scans;  <dig>  background noise suppression in lc peaks;  <dig>  interference detection and removal; and  <dig>  mass drift correction. to achieve accurate relative quantification, these issues have to be addressed. current software packages have not addressed these issues effectively. quil  <cit>  and proteinquant  <cit>  determine lc peak boundaries by the apex and the full-width-half-maximum  of a peak, i.e., it is assumed that for a given lc elution peak, the distance between its starting point and its apex is the fwhm of the peak. this assumption is problematic when elution peaks  are asymmetrical and jagged. some software packages use an intensity threshold or local minima to determine the boundaries of lc peaks. the main problem of these methods is: one is never sure whether noise or interference-corrupted scans are included within the peak boundaries, which could greatly degrade quantification accuracy. among popular software packages, msinspect  <cit>  and superhirn  <cit>  use thresholds, asapratio  <cit>  and mapquant  <cit>  use peak apex and fwhm. recently, maxquant  <cit>  uses local minima for lc peak detection after extracted-ion-chromatogram  smoothing. see  <cit>  for a comprehensive review of software tools currently available for lc-ms quantification.

on the problem of background noise suppression, almost all current software packages use savitzky-golay or other types of filters  <cit>  to smooth xics. however, through our own observation, elution process variations share similar frequency characteristics with that of instrument and poisson noise . applying filters will distort elution process variations which adversely affect quantification accuracy.

for interference detection and removal, most software packages de-convolute peptide peaks and only consider peak centroids. although this procedure decouples peptides with similar masses to a degree, it is susceptible to thermal noise, which can cause errors in the calculation of peak centroids. in addition, this procedure cannot provide interference detection, which is critical for accurate quantification.

also, automatic mass drift correction is not implemented in these software packages, and users are generally expected to supply mass calibration information. this requirement introduces another source of variability, since the accurate determination of mass drift over all m/z ranges is a challenging problem. these issues become more severe when peptide abundance is low. consequently, they have been bottlenecks in quantitative proteomic studies. for example, it is observed that whenever the signal intensity is low, the measurement of isotopically-labeled peptide pairs tends to be erroneous  <cit> . if we can computationally improve the coverage of accurate quantification, the chance for protein biomarker discovery will improve accordingly.

we limit the scope of this paper to tofms instruments where the gaussian additive thermal noise model is appropriate  <cit> , . in contrast, in ftms, the assumption of gaussian additive noise does not hold which is noted in  <cit>  as the phenomenon of increased noise in xics.

in this paper, we propose a maximum ratio combining  based quantification  algorithm to address current issues in quantification. mrcquant was developed based on the observation that peptide species register identical ms peak signals  in different ms scans and m/z locations. sometimes, the registered peaks have high signal-to-noise ratios , while in other occasions, the peaks are noisy with low snrs. while quantification at high snrs is very accurate, quantification at low snrs is problematic due to noise. we can extract the maximum likelihood estimate of peptide ms signals from ms peaks at high snrs using mrc, hence referred to as ms templates. note that these templates are extracted directly from experiment, and are not "predefined", thus they can capture slight variations in the shape and center locations of ms peaks caused by different environmental factors and instrument designs. subsequently, extracted ms templates can be used as references when quantifying low snr peaks. this method can effectively remove background noise without filtering out elution process variations. in addition, extracted ms templates can be compared to ms peaks for interference detection and removal. after interference and noise removal, accurate quantification can be performed.

mrcquant provides measurements of isotopic abundance for each peptide of interest at all charge states and all isotope positions of interest. the output of the algorithm can be further processed to infer relative protein abundance in labeled experiments, or the results can be used for peptide detection based on isotope pattern in lc-ms data. the peptide list of interest can be compiled from peptides identified from multiple lc-ms/ms runs or from lc-ms peak detection algorithms such as msinspect  <cit> .

definitions
before we describe the mrcquant algorithm, we first define several key terminologies that we use throughout the paper.

 <dig>  maximum ratio combining  is an averaging method that has been widely applied in telecommunications  <cit>  for estimating the actual transmitted signal from multiple copies received through additive white gaussian noise  channels. mrc assigns averaging weights proportional to the square root of snrs of received copies. mrc is mathematically derived based on the maximum likelihood principle. mrc provides an estimation of the transmitted signal with the highest snr possible among all averaging methods. given a peptide, we consider its ms peaks in multiple ms scans as copies of its real ms signal, which can be optimally estimated through mrc.

 <dig>  a reference template, not specific to any particular peptide, is defined as an estimation of the general ms peak shape in an lc-ms experiment. such a peak shape is usually determined by instrument characteristics and environmental factors. slight variations could exist between a reference template and particular peptide peak. this template can be translated and adjusted  to different mass/charge  locations. . a reference template is described by its center m/z and its m/z -intensity pair values. reference templates can either be extracted from lc-ms datasets at high snrs, or can be theoretically predicted based on instrument resolution and characteristics. there may be several reference templates at different m/z values in an lc-ms dataset.

 <dig>  a peptide template is defined as an estimation of the ms peak signal registered by a specific peptide in one experiment. comparing to reference templates, peptide templates are better estimations of ms peak signals for individual peptides. peptide templates are generally extracted from ms peaks registered at the highest  isotope and charge state position of peptides, where snrs are high. each peptide has its own template.

methods
mrcquant algorithm
here we describe the mrcquant algorithm for relative peptide isotope quantification on lc-ms. the input of the algorithm includes an lc-ms dataset and a list of peptides to be quantified annotated by their monoisotopic mass and/or amino acid sequence. the mass annotation can be obtained through an lc-ms peptide identification algorithm like msinspect. the output of the algorithm is a matrix of abundance measurements, with a maximum of p columns, where p is the total number of peptides to be quantified, and whose rows are indexed by cs * maxcs + iso, where cs ∈  represents charge state, maxcs is the maximum number of charge states considered, and iso represents the isotope position. for a given peptide, we need to first detect its lc peaks. a peptide at a given mass forms a series of  <dig> d peptide peaks at different isotope and charge state positions. these  <dig> d peaks form lc and ms peaks if they are viewed from the elution time and m/z dimension. to establish the connection between a group of  <dig> d peaks to a specific peptide mass, we need to verify that:  <dig>  their lc peaks at different isotope and charge state positions should be the same; and  <dig>  their ms peaks match a reference template translated to their expected m/z locations. after lc peak identification, we need to accurately detect lc peak boundaries and perform quantification. to accomplish these goals, the proposed algorithm performs the following:  <dig>  extracts or theoretically predicts reference templates.  <dig>  for each peptide of interest, performs lc peak detection at its highest isotope and charge state position using a reference template.  <dig> 

extracts peptide templates based on the mrc principle, which are used for accurate lc peak boundary detection and interference/noise removal at lower snrs. finally, quantification is performed based on peptide templates. the goal of the algorithm is to record accurate relative ion counts at all charge states and isotope positions.

a flow diagram of the entire process is shown in figure  <dig>  which is explained in detail below.

generation of reference templates
reference templates can either be extracted from experiments directly, or obtained through theoretical prediction. theoretically predicted templates can adopt different peak shapes according to different instrument characteristics . mass drifts can be accounted by shifting the center of theoretically predicted templates according to mass calibrations. next, we discuss in detail how to extract reference templates from lc-ms data at high snrs. given an input peptide list, we select a subset of peptide that register uncorrupted ms peaks, from which we extract a number of reference templates centered at different m/z values. the underlying assumption is that ms peaks registered by the same instrument should be similar . thus, it is possible to use the estimated ms peak signals at high snrs as reference templates for initial lc peak detection. note that slight deviation of actual ms signals to reference templates is allowed since the templates are used for lc peak detection but not quantification. the number of templates can be selected by the user, and  <dig> templates have been used in our simulations with good results. later, when quantifying a peptide at a given m/z value, we will not use a reference template, instead, we will use a peptide template for accurate quantification at low snrs. this ensures that the template with the closest m/z value will be selected for lc peak boundary detection, interference detection and removal.

to extract the list of reference templates, we go through the following process for each peptide in the input list:

 <dig>  determine the xics of the peptide of interest at all charge states and isotope positions.

 <dig>  determine the lc elution interval for the peptide of interest. to achieve this, we apply a high threshold at half maximum of the most intense  lc peak among all xics. on the xic with the tallest lc peak, all intervals above the threshold are considered as possible lc elution intervals. then at the charge state of the base peak, we further check the correlations between the lc peaks on possible intervals at the two highest isotope positions . the interval corresponding to the peptide of interest should have a high correlation; otherwise the lc peaks must have been registered by other peptides, or have been corrupted by interference signals. the correlation is checked by r-squared statistics  <cit> , and we apply a stringent threshold . we accept lc intervals with correlations higher than the threshold. if none of the intervals pass the threshold, we move on to the next peptide for possible template extraction. if multiple intervals have high correlations, which indicates that multiple peptides with similar mass occur on the same xic, then we reject all intervals and move on to the next peptide since we can not detect the peptide interval unambiguously. this iterative procedure ensures that  <dig>  we select a correct and unambiguous elution interval for the peptide of interest, and  <dig>  the ms signal has not been corrupted by interference or noise.

 <dig>  if the elution interval is accepted, we determine the range of m/z values that the reference template spans . the size of the ms window is determined by instrument resolution.

 <dig>  we average all ms peaks within the ms window and the accepted elution interval based on the mrc principle. the resulted mrc signal is an estimation of the ms peak signal registered by the peptide, and it can be used as a reference template.

after performing the above steps for each peptide, a list of reference templates has been obtained for lc peak detection. the details of xic extraction, determination of ms windows, and the theoretical derivation of reference templates can be found in .

lc peak detection
after obtaining a list of reference templates, the algorithm moves on to accurately detect and quantify the lc peak for each peptide of interest. given a peptide, we start lc peak detection by inspecting its xics. usually, several lc peaks above the background noise level exist on an xic, where, one is generated by the peptide of interest and the rest belong to others. we need to correctly identify the lc peak and its boundaries so that noise signals are not included in relative quantification. we perform the following processing steps:

candidate lc peak generation
the goal of this step is to detect high intensity intervals  on xics of the peptide of interest for further investigation. ideally, we should perform such detection at the most abundant charge state and isotope position where the lc peak has the highest snr possible. given peptide sequence information or mass, it is possible to predict its isotopic pattern  <cit> , and its most abundant isotope position . on the other hand, it is difficult to predict the most abundant charge state, and an exhaustive search must be conducted. we perform the following processing steps at all charge states:

 <dig>  given a peptide's mass  at a charge state , determine its theoretical m/z values at different isotope positions.

 <dig>  at the m/z value of its base peak, estimate its ms window and generate the xic.

 <dig>  apply an intensity threshold at  <dig> times the estimated background noise standard deviation to identify lc peak candidates.

 <dig>  determine the fwhm elution intervals of lc peak candidates by applying thresholds at half maximum of these lc peak candidates. these fwhm boundaries are set as initial lc peak boundaries. in this way, we only include ms scans with relatively high snrs.

 <dig>  check the correlation between lc peaks at the most intense and the second most intense isotope positions within the initial boundaries of each lc peak candidate. the correlation is checked using r-squared statistics, and all candidates with r statistics greater than  <dig>  will be accepted. in this way, all intervals with good correlations between two isotopes will be selected.

 <dig>  if the maximum r-statistic is less than  <dig> , then the lc peak candidate with the maximum r statistics will be selected. this corresponds to the case when correlations between isotope elution profiles are poor due to noise or interference, and the peptide of interest may or may not exist. in such cases, we select the best candidate for further verification in the ms dimension.

at the end of this process, a list of k lc peak candidates, each denoted by its start and end scan, is generated at each charge state. the charge state with the highest total ion count within initial lc peak boundaries will be selected.

next, one of these lc peak candidates will be identified as the initial lc peak.

lc peak identification
from previous steps, we find k lc peak candidates, but generally only one of them is generated by the peptide of interest, which can be further identified by matching a reference template to the ms peaks within the elution interval of each candidate:

 <dig>  we select the closest reference template to the peptide of interest in m/z values, which ensures the best match between the template and local ms peaks. we then translate the template to the local m/z value of the peptide of interest. details of template translation can be found in .

 <dig>  for each lc peak candidate, estimate its local ms peak signal by averaging all ms peaks  within its initial boundaries. by employing mrc, noise in individual ms peaks will be maximally suppressed.

 <dig>  the estimated local ms signal will be compared to the selected reference template. the lc peak candidate with the best matched local ms signal will be identified as the final lc peak.

 <dig>  if none of the local ms signals match with the reference template well , then lc peak detection failed for the given peptide. this could happen when a peptide identification algorithm wrongly reports the center mass of the peptide, which leads to a mismatch between the reference template and the local ms signal. although it is possible to correct such wrongly reported mass, however, it is beyond the scope of this paper.

at the end of this processing step, an lc peak has been identified for the peptide of interest with initial boundaries detected using a high intensity threshold at half the maximum of the lc peak.

we do not assume specific lc peak shapes , and the algorithm can be applied in various lc conditions . if reference templates are extracted from an lc-ms experiment directly, then they will be centered at their theoretical m/z values plus the mass drift of the experiment. thus, mass drift will be automatically accounted when applying such reference templates for lc peak detection. if a theoretical reference template is used, then its center needs to be shifted according to user provided mass calibration information.

peptide template extraction
for a peptide of interest, its identified lc peak has an initial elution interval that covers the intensity region above half of the lc peak maximum, and it is obtained at the highest charge state and isotope position. these conditions ensure that the mrc signal associated with the identified lc peak is estimated at a high snr, and it can be treated as the peptide template of interest. such a template captures accurate ms peak shape information, which can be used for lc peak boundary detection and quantification.

accurate lc peak boundary detection
the initial lc peak boundaries are obtained by applying a high intensity threshold, and many ms scans that belong to the peptide of interest are excluded. we need to accurately extend the boundaries so that all ms scans of the peptide will be accounted. if the boundaries exclude a significant segment of the lc peak, then quantification will be less accurate since combining fewer scans cannot suppress noise sufficiently. if the boundaries are extended too far to include scans that contain interference and noise, then quantification accuracy will also be reduced.

the problem of lc peak boundary detection can be translated to the problem of detecting of all scans that contain the peptide template. it can be further formulated as a hypothesis testing problem:

h0: a given ms scan only contains noise;

h1: the scan contains noise plus the peptide template.

we test the hypothesis by comparing the peptide template to the ms peak signal in a given scan. if the r-statistic is greater than a threshold , then h <dig> is accepted.

we start this hypothesis testing procedure from the initial lc peak starting scan to extend the head of the lc peak. then we apply the same procedure to the tail end of the peak. whenever encountering a scan that does not contain the template, the extension process will be terminated.

accurate boundary detection plays a critical role in quantification accuracy. for example, in figure  <dig>  we plot the  <dig> d peaks of a peptide at 12c and 13c positions in charge state  <dig>  the peptide signal actually resides from scan  <dig> to  <dig>  in scan  <dig> -  <dig>  an interfering peptide with similar m/z produces ms peaks at the 12c position. however, inspecting the peaks at 13c, it is evident that interference peaks do not exist in scans  <dig> -  <dig>  if the interfering scans are included, the resulted relative quantification accuracy will be greatly degraded. in figure  <dig>  we compare different boundary detection methods. the threshold method includes all scans from the interfering peptide. the fwhm method includes a few interfering peptide scans and excludes a few scans that belong to the peptide of interest. in contrast, the proposed method accurately detected the boundary from scan 200- <dig> 

quantification
for a given peptide, we have obtained its peptide template and lc peak boundaries after lc peak detection. based on these inputs, we can accurately quantify the peptide at other charge state and isotope positions. at a given "local m/z value" of low snr, quantification consists of three processing steps:  <dig>  obtain a local mrc signal by averaging all ms peaks  within the detected lc peak boundaries to optimally suppress noise;  <dig>  compare the translated peptide template with the local mrc signal for interference detection and removal. this step also provides an estimation of the scaling factor for the local mrc signal in reference to the peptide template, which can be multiplied to the total ion count of the template to derive the total ion count of the peptide at the local m/z value.

local mrc signal are derived using weights proportional to the lc peak intensities obtained at the lc peak detection stage. the details of other processing steps are described below.

interference detection and removal
the input to this processing step includes the local mrc signal and the translated peptide template, whose correlation is calculated using the r-square statistic  <cit> . if the correlation is greater than  <dig> , then it is considered that the interference signal does not exists. otherwise, the local mrc signal is considered as interference corrupted, and we have to perform interference removal within its ms window.

we model a local mrc signal as the superposition of the translated peptide template  and an interference signal which is modeled as an order l polynomial. the interference removal problem is equivalent to the accurate estimation of the scale factor a and the polynomial parameters.

when assuming gaussian noise, the maximum likelihood estimation of these parameters is equivalent to their least-square-estimation . note that the correlation between the interference and the peptide template signal must be minimized to yield a good estimate of a. otherwise, the estimated interference signal could contain partial template signal. consequently, besides finding the lse of parameters, the second objective is to find parameters that minimize the correlation between the template and the interference signal. in addition, there is the constraint that both the template and the interference signal should be positive at all m/z values. these requirements lead us to formulate a constrained multiple objective optimization problem. we utilize the quadratic programming algorithm  <cit>  to numerically search for the solution of model parameters. the selection of polynomial order is based on the bayesian information criteria   <cit> . see  for details.

note that there exist various peak identification algorithms  <cit>  that are specially designed to deal with the problem of overlapping peptide peaks. these algorithms are generally exponentially complex with the number of overlapping peaks considered. in this paper, the focus is on accurate quantification after peptide identification. thus, the problem is simplified to only extract signals for the peptide of interest. the knowledge of overlapping peptides can help in improving quantification accuracy, but since peak identification algorithms may or may not provide such information, we uniformly treat overlapping signals as interference. the mrc process also has the effect of suppressing interfering signals since higher weights are given to tall ms peaks of the peptide of interest but not interfering peaks. this treatment also limits the computational complexity, which is linear to the number of peptides to be quantified.

quantification based on local mrc signal
at the end of interference removal, the local mrc signal is cleaned of interference and the scale factor a is also derived. it is easy to show that the total ion count cs of all ms peaks within the lc peak interval and the total ion count of the local mrc ms signal cm has the relationship   

where w are normalizing weights used for mrc. thus if the total ion count of the peptide template is ct, the total ion count of the lc peak cp can be estimated as , where ct * a = cm is the estimated total ion count of the local mrc signal.

in figure  <dig>  we show an example of the effect of noise reduction by mrc. at a lower snr position, the peptide signal in an individual scan is very noisy . in contrast, the local mrc combined signal has a much higher snr, and it is very close to the peptide template.

data collection and processing
we developed our algorithm based on an lc-ms dataset collected from a tryptic digest of horse myoglobin at a concentration of  <dig> fmol . for reference, we also obtained an lc-ms/ms dataset for peptide sequence information at  <dig> fmol. lc-ms/ms was performed with a splitless nanolc- <dig> d pump , a  <dig> μm-i.d. column packed with  <dig> cm of  <dig> μm-o.d. c <dig> particles, and a linear ion trap tandem mass spectrometer . the top  <dig> most abundant eluting ions were fragmented by  collision-induced dissociation . the lc gradient was  <dig> to 98%  <dig> % formic acid/acetonitrile in  <dig> min  at  <dig> nl/min. tandem mass spectra were extracted by mascot distiller version  <dig> . <dig>  charge-state-deconvolution and deisotoping were not performed. all ms/ms samples were analyzed using mascot . mascot was set up to search the swiss-prot database assuming the digestion enzyme trypsin. mascot was searched with a fragment ion mass tolerance of  <dig>  da and a parent ion tolerance of  <dig>  da. oxidation of methionine and iodoacetamide derivative of cysteine were specified in mascot as variable modifications. lc-ms was performed with a splitless nanolc- <dig> d pump , a  <dig> μm-i.d. column packed with  <dig> cm of  <dig> micro-o.d. c <dig> particles, and a time-of-flight mass spectrometer . the lc gradient was  <dig> to 98%  <dig> %formic acid/acetonitrile in  <dig> min  at  <dig> nl/min. mascot search correctly linked  <dig> peptides observed in the sample to horse myoglobin with an 80% sequence coverage.

for algorithm verification, we downloaded a qtof dataset from the repository of seattle proteome center at http://regis-web.systemsbiology.net/publicdatasets/. the repository was created for testing various algorithms. it contains lc-ms/ms datasets of an  <dig> protein digest. for details of data collection please refer to  <cit> . there are multiple lc-ms/ms datasets collected on various instruments within the repository. we downloaded datasets related to protein mixture  <dig> of the  <dig> protein mix. among which, from a total of  <dig> runs on ltq-ft, qstar and qtof, we compiled a list of  <dig> lc-ms/ms-identified peptides for the same protein mixture. these peptides were all identified with a peptideprophet™ <cit>  score greater than 0: <dig>  we also performed lc-ms peak detection using msinspect on one of the qtof datasets qt 20060925_mix4_ <dig> mzxml  that identified  <dig> peptides. subsequently we quantify these peptides by mrcquant. msinspect was selected because it is the most representative lc-ms peptide identification and quantification algorithm and has been shown to outperform other peak detection algorithms  <cit> . it applies a conservative noise threshold initially. subsequently, ms scans are centroided; xics are smoothed; lc peak length filter is applied; and lc peaks that appear and disappear together are pooled and treated as signals registered by identical peptides at different isotope positions and charge states. subsequently, peptides are identified by comparing their theoretically predicted isotope patterns and measured isotope patterns using kullback-leibler distance. other popular software packages such as asapratio  <cit>  differ slightly in the details, but the main procedure, ms peak detection in each ms scan followed by quantification based on xics, is similar to that of msinspect. among these software packages, msinspect provides relative quantification accuracy measurements in the form of kl distance, which enables us to compare performances. other software packages do not provide this measurements, therefore, relative quantification accuracy cannot be accessed.

when using the msinspect software package  to process mix4_ <dig> dataset, we tried to optimize the number of peptides being reported. we selected the "walksmooth" option when running the command "findpeptides", and we set msinspect parameters "minpeaks" to  <dig> and "maxkl" to  <dig>  the "walksmooth" option greatly improves the number of features as well as the kl scores reported. a total of  <dig> features were reported. in comparison, if the default settings of msinspect are used,  <dig> features were reported with worse kl scores.

the peptides reported by msinspect were further processed by mrcquant. we used extracted templates at high snrs as reference ms templates. we rejected some msinspect reported features either because: their reported msinspect kl scores are negative, or our algorithm determines that the lc peaks reported by msinspect cannot be found. the latter case could be caused by inaccurate mass reporting by msinspect. when the mass is reported inaccurately, the reference template and the local ms signal would deviate from each other significantly, and our algorithm rejects lc peaks when the r statistic between the reference template and the local ms signal is less than  <dig> . correcting the incorrectly reported mass is a peptide identification problem which is beyond the scope of this paper. this results in a peptide list of length  <dig> with accurately reported mass values.

relative quantification accuracy evaluation
to perform relative quantification accuracy evaluation, we need to introduce an appropriate metric. the ideal way to evaluate relative quantification accuracy is to compare the measured ratios of natural isotopes to that of theoretically predicted ones. however, none of the software packages report abundance levels at different isotope positions directly. msinspect reports kl scores which can be used to access relative quantification accuracy indirectly. given measured natural isotope ratios  and theoretically predicted ones , , the kl score is evaluated using the following formula:   

if two sets of isotope ratios entirely agree with one another, then their kl score equals to zero. otherwise, a kl score is always positive, and the larger it is, the bigger the difference between the two sets of isotope ratios.

different kl scores indicate different levels of quantification accuracy, and it is possible to compare the performance of different algorithms by the reported number of peptides at different kl score thresholds. for example, we can claim that algorithm one is better than algorithm two, if algorithm one reports more peptides with kl scores less than a threshold.

obviously, we cannot set the kl threshold to infinity, and now the question becomes what could constitute an "acceptable range of kl thresholds". we know that given a kl score, there always exist the probability that it is the divergence between an arbitrarily generated and an authentic isotope distribution. the higher the kl score is, the higher the probability. if the kl score of a reported peptide is high, it is very probable that the real peptide signal does not exist, and the reported isotope distribution is generated based on observations of random noise. this probability is defined as the false-detection-rate , which can be converted from a kl score in reference to a kl null distribution . obviously, when the fdr is high, it is not meaningful to compare the reported number of peptides between two algorithms anymore, since a significant portion of reported peptides should have been falsely detected. in this paper, we adopt a cutoff fdr of 12%, and we compare the number of reported peptides at different fdrs less than  <dig> .

given a kl score reported by an algorithm, to convert it to fdr, the p-value of the kl score is first generated based on the kl null distribution. subsequently, the fdr is estimated using the method described in  <cit>  based on the p-value. the matlab function, mafdr, is used to estimate the fdrs from the p-values.

the null distribution on kl score is generated by calculating the kl scores between arbitrarily generated isotope distributions with authentic ones. without observations, an arbitrary distribution on isotopes is generated by drawing maxiso random numbers uniformly distributed on  <dig> <cit> , and then these numbers are normalized to form a distribution. we generate authentic theoretical isotope distributions by randomly drawing mass values from the peptide list reported by msinspect, and then for these mass values, we calculate their theoretical isotope ratios using the method in  <cit> .

RESULTS
we applied mrcquant to both peptide lists identified by msinspect and lc-ms/ms. the performance of mrcquant is measured by the number of reported peptides at fdrs that are less then  <dig> . peptides reported with low fdrs/kls are considered as accurately quantified ones. see figure  <dig> for an illustration of the algorithm verification process. note that the direct comparison of computing time between mrcquant and msinspect is not possible because msinspect is a combined peak identification and quantification algorithm, while mrcquant focuses on quantification only. the complexity of mrcquant is linear in complexity, i.e. the processing time is linear to the number of peptides to be quantified. on a dell t <dig> workstation, the processing time for the msinspect list was below half an hour.

performance comparison between mrcquant and msinspect
we first compared the performance of mrcquant to that of msinspect based on the msinspect reported peptide list. in figure  <dig>  we plot the number of reported peptides at different fdrs by mrcquant and msinspect. from this figure, we can see that mrcquant reports more accurately quantified peptides than msinspect at low fdrs. we used reference and peptide templates extracted from lc-ms data for these calculations.

we also compared the performance of msinspect and mrcquant based on lc-ms/ms-identified peptides. however, when allowing a  <dig> ppm tolerance, there are only  <dig> lc-ms/ms-identified peptides that overlap with msinspect-reported peptides. in other words, most peptides compiled from multiple lc-ms/ms runs were not reported by msinspect. with such a small number of overlaps, we could not perform a meaningful comparison. in contrast to the low detection rate of lc-ms/ms-identified peptides by msinspect, mrcquant quantified  <dig> lc-ms/ms-identified peptides in total, among which,  <dig> have an fdr <=  <dig> .

performance at different intensity levels
mrcquant is mainly designed to correctly quantify peptides at low intensity levels where the effect of noise is the most detrimental. to evaluate the performance at different intensity levels, we sorted peptides according to their peak intensities reported by msinspect. then, we divided peptides into  <dig> different groups according to their intensity levels, and we plotted the performance curves  as shown in figure  <dig>  mrcquant clearly provides similar performance to msinspect in the high intensity region ; however, mrcquant provides better performance over msinspect in lower intensity regions. note that there are more peptides in low intensity regions  than in the high intensity region . thus, mrcquant has a much better performance on the low intensity regions where most peptides can be found.

effect of using different templates
mrcquant can be configured to use extracted or theoretically predicted reference templates for lc peak detection, and it can also be configured to use locally extracted peptide or reference templates for quantification. thus, there are four possible ways of employing mrcquant: . use the extracted reference template for lc peak detection and use the extracted peptide template for quantification. . use the theoretically predicted reference template for lc peak detection and use the extracted peptide template for quantification. . use the extracted reference template for lc peak detection and quantification. . use the theoretically predicted reference template for lc peak detection and quantification. we tested these four cases on the lc-ms/ms-identified peptide list. the performances are reported in figure  <dig>  the selection of templates greatly affects quantification performance. case  uses the most accurate templates possible in both lc peak detection and quantification, and the result is the best with significantly higher number of reported peptides on the low fdr region. the comparison between case  and case  reveals the effect of mass drift on quantification accuracy. in case , the extracted reference templates are used, the mass drift in a specific lc-ms run is automatically addressed, and thus lc peak detection is more accurate. in case , the theoretically predicted ms reference template was not adjusted for mass drift and the resulted lc peak detection result is poor. comparing case  and , we can see quantification accuracy degradation caused by not using extracted peptide templates. slight variations in local signal peak shapes affect quantification accuracy significantly. we also compared the performance of using different templates based on msinspect generated peptide list. again, more peptides are reported with low frds in case  than in other cases, which confirms the importance of using extracted templates.

CONCLUSIONS
in this paper, we describe a new algorithm called "mrcquant" for lc-ms relative quantification of "bottom-up" proteomics data based on extracted ms templates. reference- and peptide- ms templates are extracted from scans with relatively high snrs using mrc, a process that optimally suppresses noise.

subsequently, these templates are used for detecting lc peak boundaries, detecting interference, and removing noise at lower snrs. mrcquant performs automatic mass drift correction by utilizing extracted ms templates which capture mass deviation from theoretical mass values. these techniques address major deficiencies in previous lc-ms quantification algorithms effectively. we demonstrate significant improvement in relative quantification accuracy with a larger number of detected peptides at low fdrs compared to msinspect. we expect that mrcquant can be integrated with various lc-ms processing software to improve the overall performance. for example, mrcquant can be readily modified and applied in label and label-free proteomic experiments for quantitative analysis. the proposed algorithm can also be incorporated in lc-ms peak detection algorithms that use isotope ratios.

authors' contributions
jz conceived, developed, and implemented the algorithm. she also prepared the initial manuscript. wh performed the lc-ms/ms experiments and revised the manuscript. kp advised and revised the manuscript. all authors have read and approved the final manuscript.

availability and requirements
relevant data and source matlab scripts are available at project home page: http://compgenomics.utsa.edu/mrcquant.html

supplementary material
additional file 1
support information. in this file we provide support information.

click here for file

 acknowledgements
this work is supported by san antonio life sciences institute research enhancement, and a grant from national institute of health . the authors thank the rcmi proteomics and protein biomarkers cores at utsa for assistance with experiment design, sample preparation, data collection, results interpretation, and manuscript preparation. we thank the computational biology initiative  for providing access and training to the analysis software used. lastly, the authors gratefully acknowledge the support of the cancer therapy and research center  at the university of texas health science center san antonio, an nci-designated cancer center. . this work is also partially supported by grants from the virginia g. piper charitable trust and the flinn foundation of arizona.
