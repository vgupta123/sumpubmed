BACKGROUND
single nucleotide polymorphisms  are a valuable marker system with many genetic and genomic applications. for large scale snp discovery, several strategies have been developed:  comparing sequences of multiple genotypes in the public databases to identify putative polymorphic sites  <cit> ,  sequencing random dna fragments  <cit> ,  re-sequencing  <cit> , and  using a target gene approach  <cit> . with the target gene approach, primer pairs are designed on the basis of comparisons of conserved regions  of orthologous genes in related species  <cit> . these primers are used to amplify sequences flanking less conserved regions  in a targeted genome. such gene-specific pcr primer pairs can help to identify unique loci in virtually any genome. for comparative gene mapping, such loci are equivalent to sequence tagged sites  or expressed sequence tags . therefore, they have been termed comparative anchor tagged sequences   <cit> . since primer pairs spanning introns are picked from two conserved exon regions of a gene, they are also called conserved primers  <cit> , intron-flanking primers  <cit> , or exon-priming-intron-crossing  primers  <cit> . in this paper, the terms intron-flanking primers and conserved primers are used interchangeably. the general strategy of intron-flanking primer design is to align est sequences of a targeted species with the genomic sequence of a related species for prediction of intron/exon junctions  and estimation of intron lengths from the reference genome. the information obtained is used to design intron-flanking primer pairs for pcr amplification and sequencing from different exons through intervening introns and other exons.

the target gene approach for snp discovery and marker development is based on three basic assumptions or findings. first, most exons or gene regions are conserved among related species  <cit> . second, intron positions and approximate intron lengths of a gene are conserved features, even over long evolutionary distance  <cit> . thus, the size of an intron between two consecutive exons can be approximately predicted from genomic sequences of related species. third, non-coding regions  of a gene evolve faster than the coding regions , and are more diverse and polymorphic than the exons  <cit> . therefore, marker development using a gene sequence with intron information is more effective. a prerequisite for this approach, satisfied now for many species, is the availability of public databases of a large number of est sequences. by the end of  <dig>  a total of  <dig> , <dig> est entries for  <dig>  species had been generated  <cit> . most of the economically important species have large numbers of est sequences available but lack information about their genomic sequences and intron/exon boundaries. many of these species have a large and complex genome that cannot be sequenced efficiently and accurately with the current sequencing techniques. the target gene approach will be particularly useful for marker development in those species.

to date, the target gene approach has been used to discover snps and assay genetic variations in several species, such as rhododendron catawbiense  <cit>  and medicago truncatula  <cit>  using arabidopsis as the reference species, and non-human vertebrates  <cit>  referenced to the human or mouse genomes. however, these applications were on a small scale. no suitable high-throughput tool is available for large-scale conserved primer design. expeditor  <cit>  is a web-based program for designing conserved primers using human gene structure and livestock animal est information. the major limitations of this program are its input format of reference sequences, which must be specifically formatted for the ensembl exonview, and limited primer design throughput due to its web implementation. gemprospector  <cit>  is another web-based pipeline tool for designing cross-species intron-flanking primers in the legume and grass families. however, this program requires ests of several related species in order to find conserved regions. for example, the ests of rice, sorghum and barley were used in an application in the grass family. because the target sequence has to be conserved among the three species, a limited number of conserved primers can be designed. clearly, this tool may not be suitable for the high-throughput design of conserved primers on the basis of only two related species. uniprime <dig>  <cit>  is the most recently released web tool for cross-species universal primer design. this tool automatically retrieves and aligns homologous sequences from genbank, identifies conserved regions from the alignments, and generates suitable primers. however, intron regions are not taken into consideration.

for a wheat snp project  <cit> , the target gene approach was adopted to discover genome-specific snps. wheat  is an allohexaploid with the a, b and d genomes. it was formed through hybridization of three diploid species, triticum urartu , aegilops tauschii , and a wild diploid species thought to be extinct and closely related to aegilops speltoides   <cit> . the first step in the snp discovery pipeline was to design conserved primers, which was followed by the pcr amplification of gene targets from wheat diploid and tetraploid ancestors and sequencing of the amplicons. genome-specific primers were then designed on the basis of amplicon sequences and verification with appropriate aneuploid genetic stocks  <cit> . in the second step, dna was amplified with genome-specific primers and snps were discovered in amplicons  <cit> .

to effectively design a large number of conserved primers, we developed a high-throughput pipeline software tool, named conservedprimers  <dig> , in  <dig>  this tool has been further improved for general use and used in several projects for snp discovery and genetic variation studies. in this paper, we describe the development and characteristics of conservedprimers  <dig>  as a generalized pipeline and illustrate its utility in wheat snp discovery.

intron-flanking primer design pipeline and its implementation
the pipeline and its command-line tool
the pipeline  consists of three steps:

step 1: sequence alignment and intron/exon junction analysis
at this step, non-redundant ests of a target genome are aligned to a genomic sequence of a related species , such as rice, arabidopsis, brachypodium, or human. hereafter the term "est" represents a singleton est as well as an assembled est contig which is a gene transcript assembled from a set of ests that appear to come from the same or closely related orthologous and paralogous genes. the use of non-redundant ests is strongly recommended for two reasons; i.e., to avoid duplicate primer pairs being designed for the same locus, and to facilitate identification of primers that would recognize paralogous genes. the unique est contig sequences of a large number of species can be downloaded from the ncbi unigene database  <cit>  and the tigr plant transcript assemblies database  <cit> . alignments are performed with the blastn program   <cit>  to determine the existence of a colinear "exon block" between an est and the reference genome. a colinear exon block is an intragenic linear alignment of exons along a reference genome that has at least two consecutive exon matches in the reference genome . each block must start and end with an exon and have one or more introns of less than  <dig>  kb in length. we restrict the intron length to no more than  <dig>  kb to make pcr amplification and sequencing more efficient. if an intron is longer than  <dig>  kb, the alignment should be split into two smaller colinear exon blocks if possible . a single candidate primer pair should be generated from each colinear exon block, and only a single primer pair should be chosen for each gene locus. if the same region of an est sequence has two or more colinear exon blocks detected in more than one location in the reference genome, these colinear exon blocks are considered to be non-unique  and will be eliminated from further consideration. the non-unique colinear exon blocks are probably due to paralogous genes within gene families . paralogs originate by gene duplications either prior to speciation  or after speciation   <cit> . the purpose of this step is to find a unique colinear exon block for each est.

in order to identify colinear exon blocks and predict intron lengths from alignments of each est sequence, blastn reports are further parsed and analyzed. first, one should thoroughly search for matches  with expect values ≤ a user specified cutoff  and then identify colinear exon blocks. ests with non-unique colinear exon blocks are eliminated to avoid paralogous genes. ests with a single exon match from the blastn alignments will also be excluded. the length of each exon and intron will be calculated, and their coordinates determined. finally, a new sequence string will be recorded for each est that has a unique colinear exon block. in the sequence string, the intron sequences from the reference genome are inserted between two consecutive exons with intron sequences replaced by "ns"  - these n-marked sequences will be used to design conserved primers.

using the n-marked sequences instead of the original est sequences has several advantages. first, primer pairs can be more easily designed from the exons. in addition, the size of a pcr product and the number and length of introns and exons in the amplified pcr product can be estimated. finally, in the primer analysis step , one can check whether the designed primer pairs come from different exons or from the same exon. this process has been implemented in a java program named "intronexonanalysis.jar". the entire process has been implemented in a perl script "est_alignment.pl". this script takes two files as inputs: a fasta file of ests  and a fasta file of reference genome sequences . the script first calls the formatdb program to make a blast database for the reference genome and then calls the blastall program   <cit>  to perform alignments . the java program "intronexonanalysis.jar" is used to parse and annotate the alignment results. this script generates two files: an intron-marked sequence file for primer design and an alignment summary file for primer analysis.

among all of the parameters that are set in the blastn search, the most important parameter is the expect value . the selection of e-value relies on the evolutionary distance between the target species and genomic reference species. for closely related species, a more stringent  value may be required. the pipeline uses 1e- <dig> as the default.

step 2: batch primer design
within this step, primers will be batch-designed using a perl script . this script takes the intron-marked sequence file exported from step  <dig> as input and calls the primer <dig> core program  <cit> . alternatively, the batchprimer <dig> web software  <cit>  can be used to design primers. however, some of the primer-designing parameters need to be set before running the software. the default primer-designing parameters used in the pipeline are as follows: primer length of  <dig> to  <dig> bases with the optimum  <dig> bases, tm of  <dig> to 65°c with the optimum 60°c, gc content of 20% to 80%, and an 800-base optimum product size with a range from  <dig> to  <dig>  bases. usually only one primer pair is picked for each est. two or more primer pair candidates may be obtained if multiple unique colinear exon blocks are found in an est. a tab-delimited primer table file is subsequently generated from this script or from the batchprimer <dig> web software  <cit> .

step 3: primer analysis
to increase the success rate in pcr amplification with the primers and polymorphism discovery rate, the designed primers should be unique and span at least one intron. a perl script  has been implemented to analyze the designed primer pairs. this script takes several files exported from step  <dig> and step  <dig> and performs two major tasks. first, all designed primers are compared with all of non-redundant ests or other user-specified non-redundant est databases with the blastn program to exclude the primer pairs with more than one hit. this step reduces failed pcr amplifications and avoids amplifying duplicate genes. the primer pairs picked from the same exon regions are also removed, since no intron can be amplified if a primer pair comes from the same exon region. such primer pairs are removed since exon sequences are expected to have fewer polymorphisms. information about the alignments and pcr primers from step  <dig> and step  <dig>  such as the number of matched exons, coordinates of the exons in sequences, match scores of each exon, the numbers and lengths of introns and exons included in the amplified product, is combined in a final table of primers for primer selection and ordering.

these three steps can be done separately. however, for ease of use we have integrated them into a simple, automatic pipeline program  that only takes two sequence files as inputs . all executables and source code of the pipeline and a user's guide are available for public use  <cit>  .

web implementation of the pipeline
to assist users who need to design a small number of primers at a time, the web version of conservedprimers  <dig>  pipeline has been implemented. a similar interface and implementations with batchprimer <dig>  <cit>  were applied to provide users with target est sequence input, reference sequence selection, and flexible parameter settings for blast search and primer design . genome sequences of eight plant species, arabidopsis thaliana  <cit> , oryza sativa   <cit> , sorghum bicolor   <cit> , brachypodium distachyon  <cit> , glycine max   <cit> , medicago truncatula  <cit> , vitis vinifera   <cit>  and populus trichocarpa   <cit> , are currently available as reference sequences. more reference genome sequences can be easily embedded into the web application if needed. as in batchprimer <dig>  <cit> , target gene  sequences can be input by either a copy-and-paste to the sequence text box  or uploading a sequence file. the sequences must be in fasta format. unlike batchprimer <dig>  sequences masking with "{}", "<>" or "" pairs to represent including, excluding or target regions are not allowed in the sequence input. all unrecognized characters in the sequences are automatically removed. in order to balance the workload on the server, a limit of  <dig> sequences is set on the web application. for a larger number of est sequences, the command-line based pipeline is recommended.

the conservedprimers  <dig>  web application is configured to run on the apache http server  <cit> . it generates output in three parts:  a main html page containing the primer design summary of all input sequences,  an html table page and a tab-delimited text file listing all designed primers and primer properties, and  a detailed primer view page for each sequence with successfully designed primers. the primer list can be directly saved as a text file or an excel file for further editing or primer ordering. all primer design results and intermediate files can be downloaded as a "zip" compressed file. this conservedprimers  <dig>  web application provides a convenient and user-friendly interface and is accessible at  <cit> .

RESULTS
intragenic colinear exon blocks between wheat ests and the rice genome
the command-line based pipeline was used to analyze wheat est data. a total of  <dig>  wheat ests   <cit>  that had been mapped in wheat deletion bins were compared using the blastn program  against the rice genome  at the expect value < 1e- <dig>  a total of  <dig>  ests  were matched to the rice genome. out of the  <dig>  ests,  <dig>   had unique colinear exon blocks,  <dig>  had non-unique colinear exon blocks, and  <dig>   had only one exon matched. the ests with unique colinear exon blocks were included in the pipeline for designing conserved primers.

the alignment identities  over all unique colinear exon blocks were normally distributed with a mean of  <dig>  ±  <dig> % . the alignment length or the exon length and the predicted intron length had a skewed distribution with averages of  <dig>  ±  <dig>  bp and  <dig>  ±  <dig>  bp, respectively . the average number of introns in unique colinear exon blocks was  <dig>  ±  <dig>  .

intron-flanking primer design, pcr amplification and snp discovery
after removing the ests that had no colinear exon blocks or had non-unique colinear exon blocks, a total of  <dig>  ests which yielded  <dig>  n-marked sequences were carried forward in the pipeline for primer design. from  <dig>  est loci,  <dig>  conserved primer pairs were generated with a 97% success rate for primer design. the failure in primer design for some ests was primarily because their n-marked sequences were too short to meet the minimum pcr product size requirement. since the intron length was restricted to  <dig>  kb, longer colinear exon alignments were split into two or more shorter colinear exon blocks, and one n-marked sequence for each of the shorter blocks was generated for primer design. fifty-two wheat ests were found to have multiple colinear exon blocks. the primers were manually screened to determine how many were derived from single- or low-copy genes in wheat. a total of  <dig>  such primer pairs were used for pcr amplification and amplicon sequencing of six wheat diploid ancestors and one tetraploid wheat in a cooperative effort from seven different laboratories  <cit> . for example, of the  <dig> conserved primer pairs used for snp discovery in wheat chromosome 1a, 1b and 1d,  <dig>  produced amplicons that resulted in successful sequencing of wheat diploid ancestors and discovery of polymorphisms in at least one of the three wheat genomes.

wheat intron lengths were correlated significantly  with the predicted intron lengths from the rice genome . the same linear correlation was also observed between the actual pcr product sizes and their predicted sizes  . despite a larger genome size, the average wheat gene intron lengths were smaller  than those of rice  . similar results were also observed between gossypium, arabidopsis, and rice  <cit> . gossypium has a genome larger than arabidopsis and rice, but the gossypium introns are generally smaller . the difference in intron lengths between wheat and rice was small enough to allow using rice to predict wheat intron lengths in the  <dig> to  <dig>  bp range.

sequences of amplicons produced with the  <dig>  conserved primers were used to design genome-specific primers for amplifying and sequencing the target dna sequences from a single genome of hexaploid wheat. a total of  <dig>  loci containing one or more genome-specific snps were discovered. in the previously mentioned  <dig> loci that had been mapped to wheat chromosomes 1a, 1b and 1d, a total of  <dig> loci  were found to have at least one genome-specific snp. among them,  <dig> loci were located in the a genome,  <dig> loci in the b genome and  <dig> loci in the d genome.

running time of the conservedprimers pipeline
the three-step pipeline sequentially uses three separate command-line perl scripts together with one java program for intron/exon junction analysis, the ncbi blast  <dig>  software  <cit>  for alignments, the primer <dig> core program  <cit>  or batchprimer <dig>  <cit> , and three perl packages for primer design . a user can run scripts step by step, or run the single pipeline program, primer_design_pipeline.pl, which integrates all of the three steps into one script. the performance is primarily related to genome size of reference species, the number of ests, and the speed of the computer. for instance,  <dig>  wheat ests and the rice genome were used for conserved primer design. the size of the rice genome  is  <dig> mb. it took a desktop computer  a total of  <dig>  minutes for running the entire pipeline and  <dig> ,  <dig>  and  <dig>  minutes for step  <dig>   <dig> and  <dig>  respectively. a majority of running time  was taken by step  <dig> to perform blastn searches and intron/exon analysis. the web version of the conservedprimers pipeline will take more time than the command-based pipeline since the sequences are loaded to the server before processing. client internet speed will also affect sequence loading. therefore performance of the web application may vary among different users. a random sample of  <dig> sequences chosen from  <dig>  wheat ests were used for testing the web application through intranet set-up. a total of  <dig> seconds were needed to finish the entire pipeline.

discussion
intragenic colinear exon blocks and intron-flanking primer design
a basic prerequisite has to be satisfied for designing intron-flanking primers: both the positions and the lengths of the exon and the intron must be relatively conserved between the target genome and the reference genome, i.e., a colinear exon block must be identified in an est locus. extensive colinear exon blocks within genes were observed between wheat and rice. since wheat and barley are more closely related to brachypodium than to rice  <cit> , brachypodium may be a better reference species for comparative genomic researches than rice.

intron length variation has been investigated in animals, plants  and fungi  <cit> . although intron lengths in orthologous genes vary among species, the positions and approximate lengths of introns tend to be conserved  <cit> . since intron lengths were significantly correlated between rice and wheat, the wheat intron lengths can be approximately predicted from the rice introns for the purpose of designing intron-flanking primers.

conservedprimers  <dig>  pipeline
the conservedprimers  <dig>  pipeline is a high throughput software tool for designing intron-flanking primers, and is usable with two evolutionarily related species. the primary requirement is the availability of abundant unique ests for the target species and an evolutionarily related model or reference species with a fully sequenced genome. depending on their evolutionary distance, a different e-value cutoff should be used in a blastn search of colinear exon blocks. for two closely related species, such as wheat, barley, sorghum, maize or sugarcane referenced to rice or brachypodium, a more stringent e-value cutoff, such as 1e- <dig>  should be used. otherwise, a less stringent e-value cutoff would be more suitable. for example, rhododendron is phylogenetically distant from arabidopsis, and 1e- <dig> was used in the blast search against arabidopsis genomic sequences  <cit> . the more stringent the e-value cutoff, the fewer colinear exon blocks are identified. this results in fewer, but higher-quality, intron-flanking primer pairs being selected. besides the e-value, all parameters for primer design also can be easily changed within the perl script, pick_primers.pl.

the conservedprimer  <dig>  pipeline has been implemented as a command-line tool as well as a web application. the command line style makes it possible to design intron-flanking primer pairs or marker candidates for polymorphism discovery in a high-throughput manner and to use any genome size of the model species and any number of the ests as inputs without memory and speed restrictions. the web-based pipeline serves as a convenient and easy-to-use tool for primer design of a small number of ests. compared to the web-based system, a novice user may need some basic computer skills for initial set-up and running the command line programs.

CONCLUSIONS
the conservedprimers  <dig>  pipeline for designing intron-flanking primers was developed and its utility demonstrated. the tool can be used for snp discovery, genetic variation assays and marker development for any target genome that has abundant ests and an evolutionarily related reference genome that has been fully sequenced. the conservedprimers  <dig>  pipeline has been implemented as a command-line tool as well as a web application. both versions are freely available at  <cit> .

availability and requirements
project name: conservedprimers pipeline software.

project home page: 

operating systems: the command-line pipeline and the web server were tested in linux systems, but should work in an operating system which can run perl and java programs.

programming language: perl and java

other requirements: perl interpreter program, java j2se  <dig>  or above, primer <dig> core program  or batchprimer <dig> .

license: gnu pgl

any restrictions to use by non-academics: none

authors' contributions
fmy designed and implemented the pipeline software, designed wheat conserved primers and drafted the manuscript. yqg and nh validated wheat conserved primers. jd, oda and grl helped to design the pipeline and to draft the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
conserved primers  <dig>  command-line pipeline package. the file has been collected with "tar" and compressed by "gzip", and includes conservedprimers  <dig>  command-line pipeline programs with source code, and a user's guide for installation.

click here for file

 acknowledgements
the authors thank dr. yang yen and dr. ming-cheng luo for critical reading of the manuscript. this work is supported by the u.s. national science foundation grant bdi- <dig> 
