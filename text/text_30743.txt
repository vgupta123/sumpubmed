BACKGROUND
advances in high-throughput technologies, such as dna microarrays and genome sequencing, have enabled the large-scale exploration of the genome in a way that is systematic, comprehensive, and quantitative. gene expression profiling has revealed valuable discoveries in basic biological research, pharmacology, and medicine. currently, clustering has become a popular method for profiling genomic data by which clusters are formed based on the similarity between data points. the points in each specific cluster are similar from each other but different from points outside this cluster.

clustering methods depend on the measure of pair-wise similarity, the similarity between two points. one commonly used similarity metric is the correlation coefficient between the profiles of the two points, and another commonly used similarity metric is the euclidean distance. the measure of similarity based on correlation coefficients captures the similarity in shape or pattern of the profiles, and it does not account for the amplitude of the profiles. scaled versions of any two profiles will have the same correlation coefficient since that of the pair of original profiles, i.e., the amplitude of the profiles, does not affect the correlation coefficient as long as the wave form  of the profiles is maintained. if the similarity is measured by distance, the amplitude of the profiles does matter. two profiles with the same pattern but very different amplitudes can have an ideal similarity  when measured by the correlation coefficient, but a very low similarity when measured by the euclidean distance due to the large difference in amplitudes.

in this study, we focus on clustering based on similarity measured by the correlation coefficient where two genes with similar expression patterns will be considered to be similar regardless of the difference in their amplitudes. using the pearson correlation coefficient as the similarity metric, eisen et al.  <cit>  analyzed one of the first genome-wide microarray data sets for the budding yeast saccharomyces cerevisiae. when calculating the gene expression similarity with the pearson correlation coefficient  <cit> , many studies only averaged the replicates in each experiment  <cit>  without taking into account the error in the replicates. instead of averaging over the replicates, hughes et al.  <cit>  defined an error model which uses a standard deviation -weighted correlation coefficient  to down-weight the gene expression values with high error estimates in their clustering analysis and classified the functions of previously uncharacterized genes by comparing the expression profiles of mutant cells from their s. cerevisiae compendium. using the same correlation, van't veer et al.  <cit>  derived a breast cancer prognosis from the gene expression profile of a primary tumor. in addition, yeung et al.  <cit>  showed that the sd-weighted correlation coefficient improves cluster accuracy and stability to a greater extent than the pearson correlation coefficient with averaging replicates.

however, the sd-weighted correlation coefficient  <cit>  also has disadvantages. the error of measurement is estimated directly by the standard deviation of the replicates, and such an estimate of error can be very inaccurate when the number of replicates is small relative to the number of objects   <cit> . unfortunately, most of the microarray experiments performed by an academic laboratory employ only small  number of replicates due to the experimental cost and time concerns, and such a replicate number is much smaller than the amount of genes profiled . the "stein phenomenon"  <cit>  suggests that an effective statistical model is needed to deal with replicated microarray data. here we provide a shrinkage correlation coefficient that considers both the number of replicates and the variance within each experimental group and fully exploits the similarity between the replicated microarray experimental samples. the shrinkage concept is widely accepted as a method to improve the estimation of correlation when the sample size is small  <cit> , which is the primary inspiration for this work. we first describe our shrinkage correlation coefficient in generality, and then demonstrate the superiority of our correlation compared to the other two most widely-used correlation coefficients  using hierarchical clustering and k-means clustering. finally we use a recently published analysis of the gene expression changes that occur during the germination of spores of the fern ceratopteris richardii  <cit>  as an example of this shrinkage correlation coefficient.

other clustering techniques have been used for gene expression analysis. for example, using an analysis of variance  model, kerr and churchill  <cit>  applied bootstrapping on a publicly available data set to assess the reliability of clustering results. ng et al.  <cit>  proposed a linear mixed-effects model  as an extension of the normal mixture model to incorporate covariate information into the clustering process. tjaden  <cit>  developed a clustering method that is similar to k-means clustering. using a bayesian infinite mixture model , medvedovic and sivaganesan  <cit>  developed a clustering procedure to incorporate the information on experimental variability into gene expression profiling. imm measures the similarity using a probabilistic model of the data, and the error between repeated measurements is inherently represented in the model. instead of forming final clusters directly, a posterior distribution of the possible clusters is generated by gibbs sampling first. then the similarity between two data points is measured by the probability of the pair of points being in the same cluster inferred by the posterior distribution of the clustering result. with this measured similarity, final clusters are formed by applying the classical hierarchical clustering. conceptually, imm considers the magnitude  of gene expression profiles and is similar to the euclidean distance, as noted by tjaden  <cit> . in contrast, as a correlation coefficient, our method is based on the pattern of gene expression profiles and is apparently different from imm when applied to clustering methods.

we stress that our shrinkage correlation coefficient is a correlation instead of a clustering method, and it could be used as a similarity metric in many clustering methods or other circumstances. therefore, we compare our correlation with two existing widely-used correlation coefficients  using hierarchical and k-means clustering. we present our method for better estimating the error in replicated microarrays that cannot be adequately estimated by other correlation coefficients when applying the existing popular clustering methods.

in this paper, we propose a novel correlation coefficient, shrinkage correlation coefficient . the comparison of scc with other two most widely-used correlation coefficients using hierachical and k-means clustering shows that scc is an alternative to the pearson correlation coefficient and the sd-weighted correlation coefficient and achieves better clustering performance on both synthetic expression data as well as real gene expression data from saccharomyces cerevisiae. we use scc-based two-dimensional hierarchical clustering to analyze the replicated microarray data of salmi et al.  <cit> , revealing the novel finding that there are two distinct clusters of genes with shared expression patterns during the early stages of germination of c. richardii spores. findings from this gene expression analysis suggest that some of the mechanisms that control germination in such diverse plant lineages as mosses and angiosperms are also conserved among ferns. we also present the use of singular value decomposition   <cit>  to uncover the gene-wise bias introduced by experimental artifacts due to comparison of different biological samples and multiple arrays.

RESULTS
shrinkage correlation coefficient 
correlation coefficients are computed to measure the similarity between each pair of genes in hierarchical clustering. assuming that we have a total of n arrays consisting of f experimental  groups with n replicates for the kth experimental group, then n=∑k=1fn. let gi,n denote the expression level of the ith gene for the nth replicate in the kth experimental group. the mean and variance of the expression of the ith gene over the replicates in the kth experimental group are defined as g¯i=∑n=1ngi,n/n and si2=1n−1∑n=1n−g¯i) <dig>  respectively.

if the standard deviation  is used as an estimate of the measurement error, then the sd-weighted average expression of gene i over the experimental groups is given by

  g¯i=∑k=1fg¯isi2/∑k=1f1si <dig> 

and the sd-weighted correlation coefficient is defined as

  ρijew=∑k=1f−g¯i)si−g¯j)sj∑k=1f−g¯isi)2∑k=1f−g¯jsj) <dig>  

which has been used in the previous studies  <cit> . since the sd-weighted correlation takes the measurement error into account, it is better than the pearson correlation coefficient in estimating the correlation between a pair of genes in the case of repeated measurements  <cit> . the concept of applying larger weights on genes with smaller measurement error seems natural and has been demonstrated to be effective. however, the standard deviation may not be the best estimate of measurement error according to the stein phenomenon  <cit> .

if f >  <dig>  the stein estimation, defined as s∼i2=si <dig> with d=∑k=1f) <dig>  is better than the standard variance in the sense that it is statistically closer to the real error  <cit> . the last statement is valid under the assumption that si <dig>  k =  <dig> , ..., f, are gaussian distributed and independent of each other, which can be readily justified using the central limit theorem.

since the stein phenomenon was discovered, several shrinkage estimation methods have been developed to find the optimal estimate of a group of measurement errors. in this work we propose a simple but effective methodology which is mainly inspired by the shrinkage concept  <cit> .

let the real squared measurement errors for the f experimental groups be ψi, ψi...ψi. we may estimate these f parameters using a high-dimensional model . according to statistics theory, the estimates in a high dimensional model will have larger variances compared to those in low-dimensional model  when the same number of data points are available. furthermore, if the number of data points are very limited  the variances of a high-dimensional model may be unacceptably high for practical purposes. to reduce the estimation variance one may map the high-dimensional model for the f parameters onto a lower-dimensional restricted submodel. for example we may use the mean of the f parameters,

  Θi=1f∑k=1fψi 

as a one-dimensional submodel. then, the estimation variance can be greatly reduced. however, the estimate is biased if we replace ψi, ψi...ψi by Θi.

to summarize, the estimates in the original high-dimensional model have larger variances but are unbiased, and the estimate in the restricted one-dimensional submodel has a smaller variance but is biased. since neither situation is satisfactory, we will propose a shrinkage error estimate that makes a balance between the above two kinds of estimates.

with the above restricted one-dimensional model , we have an unbiased estimate of the squared measurement error Θi as follows:

  s¯i2=1n−f∑k=1f∑n=1n−g¯i)2=∑k=1fn−1n−fsi <dig>  

then, we can use a linear regularization model to define a balanced estimate:

  ti=si2+λis¯i <dig>  

where λi ∈  <cit>  is an shrinkage factor that is to be determined according to a chosen optimization criterion. we propose to minimize the risk

  r=e−ψi)2). 

applying the methodology of  <cit>  and  <cit> , the optimal shrinkage factor can be derived as

  λ^i=∑k=1f∑k=1fe. 

from previous discussion, si2k, k =  <dig> , ..., f, are assumed to be independent of each other, and from the above equation we have

  λ^i=∑k=1f∑k=1f−s¯i2)2=∑k=1f−1n−f)var⁡)∑k=1f−s¯i2) <dig>  

where var) is the variance of si <dig> estimated by

  var⁡)=n−1)3∑n=1n <dig>  

to make sure that the shrinkage factor lies between  <dig> and  <dig>  we define the final shrinkage factor to be

  λi∗=min⁡), 

and then we obtain the shrinkage estimate of si <dig>  k =  <dig> , ..., f, as

  ti∗=si2+λi∗s¯i <dig>  

notice that in  <cit> , a related mathematical problem is considered, where it aims to get a shrinkage estimate of a covariance matrix by using a restricted lower dimensional submodel in which the covariance matrix is assumed to be diagonal with common variance. in this work our problem is simpler. we only need to estimate the diagonal elements of the covariance matrix, not the whole matrix. therefore, our result is different from what is obtained in  <cit> , and is much simpler.

using ti∗, the shrinkage estimate of si <dig>  the error between the group mean g¯i and the corresponding true expression value can be measured by means of the shrinkage error defined as Φi=ti∗n. if we replace si by Φi in eqs. 1& <dig>  the shrinkage error-weighted average expression of gene i is given by

  g¯isw=∑k=1fg¯iΦi2/∑k=1f1Φi <dig>  

and we can define a new shrinkage correlation coefficient for any pair of ith and jth genes as

  ρij=∑k=1f−g¯isw)Φi−g¯jsw)Φj∑k=1f−g¯iswΦi)2∑k=1f−g¯jswΦj) <dig>  

if the number of replicates n is the same for all the experimental  groups, then Φi = αti∗, where α = 1/n is a constant, and hence the shrinkage correlation coefficient  is effectively weighted by the shrinkage estimate ti∗  has no effect on the shrinkage correlation coefficient). however, if the number of replicates is different for each experimental group, the use of Φi=ti∗n in the shrinkage correlation coefficient provides additional benefits in our method through the weighting n in a way that agrees with the common practice in statistics  <cit> .

when using a biologically meaningful control sample, e.g., a matched and untreated sample, a zero time point, or the reference sample  <dig> hr presented in this study, we should use uncentered correlation to keep the impact of the biologically meaningful control sample on the gene expression changes  <cit> . therefore, we replace g¯isw and g¯jsw with zero in our analysis, and hence eq.  <dig> is modified as follows:

  ρij=∑k=1fg¯iΦig¯jΦj∑k=1fΦi)2∑k=1fΦj) <dig>  

shrinkage correlation coefficient  is superior in clustering the synthetic and real gene expression data
as shown in eq.  <dig>  scc is a type of correlation coefficient which is very useful in gene expression clustering. to assess the effectiveness of a new correlation coefficient in clustering analysis, it is important to compare it with other widely-used correlation coefficents using existing popular clustering methods. in this study, we compared scc with the two most commonly used correlation coefficients: pearson correlation coefficient  <cit>  and sd-weighted correlation coefficient  <cit> . we applied these three correlation coefficients on the two most popular clustering methods: hierarchical clustering  <cit>  and k-means clustering  <cit> , and evaluated the performance by comparing the adjusted rand index  <cit>  generated for each correlation using these two clustering methods. both synthetic expression data and real yeast expression data  <cit>  were used in this study. the adjusted rand index is a statistic that has been recently used for the comparison of clustering using different correlation coefficients  <cit> . it measures the extent of concurrence between the clustering results and the underlying known cluster structure  <cit> . the comparison of the adjusted rand indices generated by different correlation coefficients for the same data set indicates the performance of each correlation. the adjusted rand index lies between  <dig> and  <dig>  and a larger index indicates a higher level of agreement between the clustering results and the prior knowledge of functional categories, and further suggests better clustering performance  <cit> .

each synthetic data set includes  <dig> experiments,  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  and  <dig> replicates for each experiment, and two different levels of noises . the data sets were generated with predetermined patterns plus low or high level of random noise so that the underlying cluster structure is known. we evaluated the level of agreement between the resulting clusters from each of the three correlations and the known underlying cluster structure by computing the average adjusted rand index over  <dig> randomly generated synthetic data sets. figure 1a and 1b show the correlation comparisons using hierarchical clustering and figure 1c and 1d are the results from k-means clustering. as shown in figure 1a, under low noise level , scc has the same performance as the pearson correlation coefficient but far better than the sd-weighted correlation coefficient when the replicate number is two. when the number of replicates is four, six and eight, scc is superior to the other correlations. with the increasing of the number of replicates, the sd-weighted correlation coefficient approaches scc but both of them still outperform the pearson correlation coefficient. figure 1b shows that, when the noise level is high , scc performs the best for all the numbers of replicates. these results suggest that, for synthetic microarray data, scc is superior to the pearson correlation coefficient and the sd-weighted correlation coefficient when using hierarchical clustering as it results in the most consistently high adjusted rand index regardless of noise level and number of replicates.

we also compared the correlations using k-means clustering. under low noise level , scc surpasses the other two correlations when the number of replicates is lower than  <dig>  with the increasing of the number of replicates, the sd-weighted correlation coefficient approaches scc but both of them still outperform the pearson correlation coefficient. while the noise level is high , scc outperforms the pearson correlation coefficients for almost all the numbers of replicates. when compared with the sd-weighted correlation coefficient, scc is better when the number of replicates is smaller than four and close to the sd-weighted correlation coefficient when the number of replicates is four and six. with the increasing of the number of replicates, we noticed that scc performs almost equally as the sd-weighted correlation coefficient and has a slight advantage when the number of replicates is larger than  <dig>  the k-means clustering results suggests that, scc is a better choice compared to other correlations when the expression noise level is low, while the noise level is high, scc is obviously superior to the pearson correlation coefficient on almost all the numbers of replicates and has slight advantages over the sd-weighted correlation coefficient for most of the numbers of replicates.

to further demonstrate the superiority of scc, we applied the three correlations individually to hierarchical and k-means clustering and computed the adjusted rand index on the real yeast expression data  <cit> . this microarray data represent  <dig> systematic perturbations of the yeast galactose-utilization pathway, and four replicates were performed for each perturbation. each gene has been annotated in one of four functional clusters in the gene ontology  <cit> . these four clusters are used as the external knowledge. as shown in figure  <dig>  when hierarchical clustering is used, the adjusted rand indices for scc is  <dig>  which is higher than those of the other two correlations . when applied to k-means clustering, scc is also superior to other correlations with the highest adjusted rand index  <dig> . since the noise level of this real yeast expression data was not clearly stated and barely quantified in the previous study, we could not determine which is better between the pearson correlation coefficient and the sd-weighted correlation coefficient. however, this real expression data comparison suggests that scc is superior regardless of noise level and clustering methods which corresponds to the results with the synthetic data.

analysis of the tentative unique gene expression profiles during early development in germinating spores of c. richardii by scc
spores of c. richardii have proved to be an excellent model system to study the basic cellular processes that occur in early gametophyte development, such as gravity sensing and response, sex determination and differentiation, pattern formation, and photomorphogenesis  <cit> . using dna microarrays consisting of  <dig>  spotted cdna clones from an est analysis, salmi et al.  <cit>  monitored the mrna levels for  <dig>  tentative unique genes  of c. richardii over the first  <dig> hr of gametophyte development. tug expression in the spores was evaluated at  <dig>   <dig>   <dig>   <dig> and  <dig> hr after spores were exposed to continuous white light. this developmental period includes initiation of germination at  <dig> hr, the production of a detectable polar calcium current that peaks at 6– <dig> hr, fixation of the polarity of more than half of cells by gravity at  <dig> hr, migration of the nucleus at  <dig> hr, and a polar cell division at  <dig> hr  <cit> .

the data analysis of salmi et al.  <cit>  focused on identification of differentially-expressed genes between time points and did not attempt to identify upward or downward trends in the time course data. this analysis did not discover and filter out the underlying biases associated with experimental artifacts due to comparison of different biological replicates and prints of arrays to facilitate further gene expression profiling. moreover, this analysis did not organize expression patterns into biologically meaningful profiles through the whole time course experiments by assimilating the patterns of gene expression. a more thorough analysis of these microarray expression data that focuses on characterizing the entire set of transcripts temporally and displaying them graphically would promote a better understanding of cellular processes underlying early gametophyte development in ferns.

in total, we analyzed  <dig> arrays with biological replicates of four different developmental time point comparisons: nine replicates of 0: <dig> hr, eight of 6: <dig> hr, nine of 12: <dig> hr, and eight of 48: <dig> hr. the  <dig> arrays were used to generate a total of  <dig> data columns in which each column was treated independently rather than averaging the replicates.

the initial selection retained non-flagged spots for which the within-spot pixel-to-pixel correlation of intensities is >  <dig>  and the sum of median  signal intensities is > <dig>  these non-flagged spots were also well-measured in at least 80% of the array. in this selection, 39% of the tugs were filtered out prior to further analysis. selecting for tugs with a known accession number in genbank removed a further 4% of the tugs. selection for a fluorescence ratio of at least  <dig> -fold greater than the geometric mean ratio for the tugs examined in at least two arrays of any time point comparison removed 41%. the resulting data set  for the experiments analyzed included tabulation of the log2ratios of gene-expression levels for  <dig> tugs. in the entire  <dig> arrays there were  <dig> tugs for which there were no missing data. a total of  <dig>  expression ratios were missed, accounting for only about 6% of the total data set we analyzed. after the imputation of the missing data with the k-nearest neighbors  method  <cit> , the data set was normalized array-wise with the mean of  <dig> tugs expression ratios of each array set as zero and the standard deviation as one.

we first uncovered ten samples that have poor correlation to other samples of their time point group by applying unsupervised agglomerative hierarchical array clustering and svd . these ten arrays, which likely represent experimental artifacts, were removed from the data set, and the new data set  was used to tabulate the log <dig> ratios of gene-expression levels for  <dig> tugs. of these tugs,  <dig> have no missing data in the entire  <dig> arrays. a total of  <dig> data were missed, accounting for only  <dig> % of the adjusted data set. the imputation of the missing data was performed by the k-nearest neighbors  method  <cit>  with the average value of the nearest  <dig> neighbors . we further normalized this new data set by adjusting the mean of  <dig> tugs expression ratios of each array to zero and the standard deviation to one.

in the new data set, the expression profile of the 12: <dig> hr time point comparison group was measured by two prints of arrays: four replicates hybridized on the cri <dig> arrays, and two on the cri <dig> arrays. cri <dig> and cri <dig> arrays were the same except printed on different days. in attempt to identify and correct the gene-wise bias introduced by the two prints of arrays, we carried out svd. this technique has previously been used to detect and correct the artifact in the data set that was caused by different types of arrays   <cit>  or sampling from cultures with slightly different periods  <cit> . we reduced the new "tugs × arrays" space to the "eigenarrays" space that spans the space of the array expression profiles and the "eigengenes" space that spans the space of the gene expression profiles. eigengene  <dig> was discovered to be exactly correlated with the gene-wise bias . we sorted the abundance of this eigengene in each of the  <dig> arrays, and found a perfect correlation between the abundance and the print of array . all of the four cri <dig> arrays show negative abundances, whereas the cri <dig> arrays all have non-negative abundances.

we filtered out the gene-wise bias from the data set  by substituting eigenexpression  <dig>  with zero, and reconstructed the final data set with eq.  <dig> of additional file  <dig>  subsequently, this final data set  was analyzed by the unsupervised two-dimensional agglomerative hierarchical clustering. we first calculated the optimal shrinkage factor λi∗ with eq.  <dig>  since the number of replicates is six  for each time point comparison after we filtered out ten low-quality arrays, λi∗ is significantly different from  <dig> and  <dig>  and has an average value of  <dig>  . this indicates scc is effective in our analysis, and neither the pearson correlation coefficient nor the sd-weighted correlation coefficient should be used here. therefore, we applied scc to the gene clustering, and the pearson correlation coefficient  <cit>  to the array clustering. the tug expression profiles during the early stages of gametophyte development of c. richardii are shown in figure  <dig>  the  <dig> tugs are clearly clustered into two distinct groups: cluster a with  <dig> tugs, and cluster b with  <dig> tugs.

we performed functional analysis of clusters a and b using gene ontology annotations transferred from putative a. thaliana homologs of individual tugs, as identified by blastx analysis described previously  <cit> . using a standard over-representation analysis as implemented in the erminej software  <cit> , we examined the clusters to identify gene ontology terms that appeared unusually often among the tugs in each cluster, relative to the full complement of tugs represented on the array.

we found that cluster a, which includes genes that are up-regulated during the first  <dig> hours following germination, were significantly enriched with genes annotated with the go term rna-binding. the cluster contained tugs that had high homology to a. thaliana proteins at4g <dig>   and at2g <dig>  . at4g <dig>  contains an rna recognition motif, and at2g <dig>  contains a region matching a nucleoporin pfam motif. both are annotated with the term "rna export from nucleus," suggesting that their c. richardii counterparts may also be involved in rna processing and export.

over-representation analysis of cluster b, which includes genes that are down-regulated during the same period of development, revealed fourteen enriched terms. these included terms related to signal transduction , transport, biosynthetic activities , oxidative phosphorylation, and response to oxidative stress. a full list of terms is given in table  <dig> 

go id: the gene ontology identifier for each over-represented gene ontology terms. term: the name of the term. genes: number of genes on the array with the go annotation term in column  <dig>  p value: the unadjusted p value from the over-representation analysis  test.

in addition, we noticed that the final data set  analyzed here was generated by filtering out ten low-quality microarray samples and one gene-wise bias from the original  <dig> arrays. therefore, it will be reasonable to obtain similar clusters based on this final data set by applying the three correlations  to hierarchical or k-means clustering . since scc is superior in clustering synthetic and real expression data as demonstrated above, we presented here the application of scc to analyze our own microarray data.

discussion
in this work we have shown that a new correlation coefficient, shrinkage correlation coefficient , can be used as a similarity metric in clustering replicated microarray data generated by most academic laboratories and derive new information pertaining to gene expression patterns. using hierarchical and k-means clustering, we compared scc with the two most widely-used correlation coefficients: pearson correlation coefficient  <cit>  and sd-weighted correlation coefficient  <cit> . the adjusted rand index comparison showed that scc enables improved clustering performance for both synthetic and real expression data. using the scc-based hierarchical clustering algorithm, we discovered two distinct clusters of genes during the germination of c. richardii spores. functional analysis suggests that some of the mechanisms that control germination in such diverse plant lineages as mosses and angiosperms are also conserved among ferns.

scc is a robust correlation coefficient
correlation coefficient is crucial in cluster analysis to determine the similarity between two objects  and further classify the objects into different groups. when the pearson correlation coefficient was first applied for clustering gene expression  <cit> , the replicates of each treatment group were simply averaged without considering the underlying error. as the importance of the error information was discovered  <cit> , more and more studies use standard deviation as the error estimate when clustering gene expression with the help of correlation coefficient. using the sd-weighted correlation coefficient, they down-weighted the gene expression values with high error estimates in microarray analysis  <cit> . however, the sd-weighted correlation coefficient is still not statistically efficient for analyzing replicated microarray data and the use of standard deviation as the error estimate exhibits serious defects when the number of replicates is small  <cit> .

commonly, the number of microarray replicates that are performed by most academic laboratories is usually less than  <dig> due to the experimental cost and time concern. the "stein phenomenon"  <cit>  states that when the number of data samples  in each experimental group is relatively small, a better estimate of the error of any individual experimental group could be obtained by shrinkage that considers all experimental groups. to avoid inaccuracy introduced by the small number of replicates, a better estimate of the error in the replicates can be obtained by shrinkage estimate. our shrinkage correlation coefficient  can be regarded as a generalized definition of correlation coefficient for the expression of a pair of genes with replicates. it takes into consideration both the number of replicates and the variance within each treatment comparison.

scc can be reduced to other definitions of correlation coefficients when the shrinkage factor λi∗ is set to some special values. for example, under the condition that the numbers of replicates are equal for all the f experimental groups, scc is equivalent to the pearson correlation coefficient when λi∗ =  <dig>  and to the sd-weighted correlation coefficient when λi∗ =  <dig>  therefore, the sd-weighted correlation coefficient and the pearson correlation coefficient are just two extreme cases of scc. the correlation coefficient with optimal shrinkage is an alternative to these two extremes and is superior to them when  <dig> <λi∗ <  <dig>  by using the shrinkage factor λi∗, we obtain an optimal estimate of the error in the replicates and, accordingly, better estimates of the similarity between any pair of genes.

we would argue that in scc, the use of the shrinkage error Φi=ti∗n as a weighting provides a better correlation measure for two reasons. first, ti∗ is superior to the standard deviation as an estimate of the measurement error, and secondly, the inclusion of n takes the size of an experimental group into account as an assessment of the reliability of the group mean. the benefit of n disappears if all experimental groups are of the same size. for example, in our c. richardii microarray data analysis, the number of replicates happens to be equal for each time point comparison after filtering out ten low-quality arrays. in such an analysis, the use of Φi=ti∗n and the use of Φi=ti∗ are equivalent, since either choice leads to the same value of shrinkage correlation in eq.  <dig>  figure 1a, b and 1c shows that scc is superior to the other models regardless of the number of replicates. in figure 1d, scc also has advantages for most of the numbers of replicates. therefore, scc offers utility to most replicated microarray data sets.

using the stein shrinkage concept  <cit> , a shrinkage estimator for gene-specific variance components was proposed to construct a f-like statistic that has been used in a linear mixed anova  model  <cit> , and a shrinkage estimator of the mean used in the clustering similarity metric was developed for genome-wide expression data analysis  <cit> . this shrinkage anova model and the shrinkage mean could be combined with our scc for analyzing expression data in future studies.

results of functional analysis
the stringent quality control filtering followed by novel cluster analysis methodology of microarray data on c. richardii early development produced two distinct clusters of tugs. as shown in figure  <dig>  the tugs represented in scc cluster a increased expression during the first  <dig> hours following germination, while tugs in cluster b decreased expression during the same period. an analysis of go terms associated with tugs in cluster a reveals that only one term  is over-represented among go annotations associated with cluster a tugs relative to the other tugs assayed in the microarrays. this suggests that the tugs in cluster a represent a cross-section of many different types of genes, perhaps reflecting a general "ramp-up" in multiple biological functions, along with an increase in rna processing as the spore activates embryonic transcription.

previous results from other systems suggests that genes associated with the term rna transport may be related to the process of establishing and maintaining cellular polarity in the early stages of germination of c. richardii spores. in the filamentous fungus aspergillus nidulans, mutation of swok, a gene that encodes a protein with an n-terminal rna recognition motif that causes cells to swell and lack the normal polarity maintained fungal hyphal cells  <cit> . the swok protein appears to function in both mrna maturation and nuclear export of mrnas.

by contrast, over-representation analysis of the cluster b tugs, which are down-regulated during the  <dig> hr time course, reveals an enrichment of several go terms, suggesting that the cluster b tugs represent a more specialized set of genes involved in functions and processes required during early development of c. richardii. cluster b consists of genes that are down-regulated during the earliest stages of spore germination, starting with the initiation of germination by light  through the first two days of development, when the first cell division occurs. these are likely to include transcripts that were present in the dormant spore but decline in abundance in the germinating spore. this population is likely to encode proteins involved in maintaining the dormant condition. once germination begins, genes responsible for maintaining the dormant condition of the spore would need to be down-regulated to allow for the transition from dormant metabolism to active growth and development.

careful examination of the cluster b genes and their associated go terms reveals some interesting patterns. one of the most notable findings from this study is that genes involved in abscisic acid mediated signaling are overrepresented among genes down-regulated in the first  <dig> hr of spore germination. abscisic acid  is a plant hormone known to be involved in the process of establishing and maintaining dormancy in angiosperm seeds  <cit>  and moss spores  <cit> . aba has been previously shown to be involved in another aspect of c. richardii development. sex determination of c. richardii gametophytes is regulated in part by aba  <cit> .

the process of seed germination in arabidopsis involves a decrease in the endogenous levels of abscisic acid  <cit> , and inhibiting aba biosynthesis by treatment with fluridone caused nicotiana plumbaginifolia seeds that should be physiologically dormant  to germinate at the same rate as seeds that are in a physiologically non-dormant  condition  <cit> . the more general term hormone-mediated signaling  is also over-represented among the tugs in cluster b. this term annotates tugs predicted to be involved in aba-related pathways as well as other hormone-related processes, notably signaling pathways mediated by gibberellic acid. hormone-mediated regulation of the process of germination has been well studied in angiosperm seeds, including aba involvement in the maintenance of dormancy, and the germination activating role of gibberellin. the process of germination in angiosperm seeds involves extensive hormone-mediated signaling  <cit>  so it is not surprising to find this category of genes implicated in fern spore germination, as well.

the involvement of aba in germination is not unique to angiosperm seeds. in moss cells that have differentiated into spores, removal of aba causes these cells to germinate and develop into new filamentous cells  <cit> . in the classical view of hormone signaling in eukaryotic organisms hormones are thought of as the chemical substances produced in one part of the organism that serves as a signal to another part of the organism. in this paradigm it would seem unusual for a plant hormone to function within the single cell of the c. richardii spore. however, an aba receptor involved in seed germination has been characterized that is not plasma membrane localized  <cit> , the arabidopsis gene chlh . this receptor functions inside of cells and it could, in principle, respond to intracellular changes in the level of aba to regulate physiological changes within single cells. the chlh "receptor" gene encodes a subunit of the mg-chelatase complex that is an integral part of chlorophyll biosynthesis, and is involved in plastid-to-nucleus signaling. the process of producing a highly resistant, dormant stage of plant reproductive cycles  is conserved among all major plant lineages. given the intercellular localization and functioning of an aba receptor that mediates germination in arabidopsis seeds, and the documented role of aba in the germination of various spores, it is plausible that this signaling pathway is similar in fern and moss germination.

one of the well-documented mechanisms that regulates aba signaling in seed germination is dephosphorylation of regulatory proteins by protein phosphatases, particularly type 2c protein phosphatases   <cit> . in fagus sylvatica the expression of a pp2c is directly regulated by aba in dormant seeds  <cit> . additionally, dephosphorylation of actin by protein phosphatases has been implicated in the germination of the plasmodium physarum sclerotium  <cit>  and dictyostelium discoideum  <cit> . the biological process of dephosphorylation was included as an activity that is over-represented in the cluster of genes down regulated during germination, and this category includes genes likely to encode pp2c enzymes. the prediction from our clustering results that aba-regulated signaling enzymes like protein phosphatases are involved in fern spore germination is plausible in light of the conservation of this pathway in other plant species.

annotation of genes in the down-regulated cluster identified three cellular localization categories, including external encapsulating structure, nucleolus, and plasma membrane. of these three categories, the down regulation of nucleolar associated genes is similar to a process observed in angiosperm seed germination. in zea mays seeds, nucleolus-associated bodies are present in the cells of dry seeds, but after  <dig> h of imbibition these nuclear bodies have decreased significantly  <cit> . although c. richardii spores are a useful model system for the study of gravity perception in a single cell, we did not identify any genes in this analysis of early development that are obviously involved in the process of gravity perception or in early signaling steps of the gravity response.

CONCLUSIONS
in summary, we have developed a robust correlation coefficient, shrinkage correlation coefficient , which is an alternative to the pearson correlation coefficient and the sd-weighted correlation coefficient, and particularly useful for clustering replicated microarray data generated by most academic laboratories. we have shown the superiority of scc by the adjusted rand index comparison on both synthetic and real expression data using hierarchical and k-means clustering. we apply scc to successfully identify distinct clusters of genes during c. richardii early development. we also present the use of svd to uncover the gene-wise biases introduced by experimental artifacts due to comparison of different biological replicates and prints of arrays. this computational approach is not only applicable to dna microarray analysis but is also applicable to proteomics data or any other high-throughput analysis methodology.

