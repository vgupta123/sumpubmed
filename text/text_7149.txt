BACKGROUND
microarray experiments can provide a comprehensive picture of gene expression levels in biological samples. in a typical application they compare expression of several thousand genes under two different conditions , using a small number of replicate experiments. various techniques have been developed to rank genes according to their expression changes, e.g. based on the t-statistic  <cit>  or the strong non-parametric rankproducts  <cit> . the resulting list of genes can then be restricted to those genes that fulfill a certain statistical criterion, usually an arbitrarily chosen maximum accepted false discovery rate.

the main challenge to the biologist is contained in the next step of the analysis. it consists in identifying the biologically relevant expression changes, the "big picture" of the experiment. as microarray experiments tend to generate unexpected observations in areas outside the specialized expertise of the experimentalist, this can be quite difficult and time-consuming. a principled mechanism to identify the significant higher-level features of the experimental results would therefore be very useful.

the biological interpretation process consists to a large extent of finding evidence connecting certain genes that are differentially expressed. this evidence can consist, e.g., of joint participation in some physiological process, physical interaction at the protein level, reported co-expression in earlier microarray experiments, a shared functional annotation, etc. this kind of evidence can intuitively be represented as a graph, and this feature is regularly used to visualize biological data, in the form of metabolic or signaling pathways or protein interaction maps. the task can then be described as the identification of subgraphs that as a whole show a statistically significant expression change. this would allow the biologist to focus her analysis on the most promising areas, without prior bias, while at the same time presenting the relevant evidence underlying each association for critical evaluation.

RESULTS
the algorithm
we have recently developed an approach, iterative group analysis  that identifies significantly changed functional classes of genes in a microarray experiment  <cit> . in contrast to similar approaches such as  <cit> , the iga method does not require a previous delimitation of a set of "differentially expressed genes", but uses an iterative calculation of p-values to determine the subset of class members that is most likely to be changed. due to this feature, the iga method is more sensitive in identifying functional classes that are slightly but consistently regulated, and works well on noisy data with small numbers of replicates, where the delimitation of gene lists can be overly restrictive.

here we extend this approach to the analysis of "evidence graphs", which offers much larger flexibility of the annotations that can be used and allows substantially improved visualization. evidence graphs can be represented as bigraphs with two types of nodes, one for genes and one for the associated "evidence" . for evaluation purposes we focused on two types of networks, one where the evidence consists of geneontology annotations  and one where the evidence comprises enzyme substrates . the construction of these networks from gene annotation files is fast and simple, but more unconventional networks are also straightforward . before the calculation the bigraph is converted to a simple graph, eliminating the evidence nodes and introducing pairwise edges between all nodes that were connected to a common evidence node .

in addition to the graph, a complete list of genes sorted by differential expression is provided. all nodes without corresponding expression data are eliminated from the network. in the first step of the analysis, each gene node is assigned its rank in the list of genes, such that the node for the most strongly changed gene is labeled "1" , the second most changed gene is labeled "2", etc. then, local minima are identified in the graph, i.e. those nodes that have a lower rank than all their direct neighbors in the graph . in the next step, subgraphs are iteratively extended from each of those local minima by including the neighboring node with the next highest rank  and, if present, all adjacent nodes of ranks equal or smaller than m. hence, at each step of the extension process the newly extended subgraph is not adjacent to any outside node with a rank lower than m . at each extension step we thus obtain a subgraph with n members with a maximum rank m and can calculate the p-value for observing all n of n genes at rank m or better in a list of n total genes in the graph, , which follows easily from inserting these values in the cumulative hypergeometric equation, which is also used for iga  <cit> .

the extension process is continued until all nodes reachable from the local minimum are included or the subgraph reaches an arbitrary maximum size. after extending the subgraphs, for each local minimum the subgraph yielding the smallest p-value is selected as its "regulated neighborhood" and all local minima are sorted by increasing p-value of these regulated neighborhoods. the subgraphs at the top positions of the resulting list should contain the most relevant regions of the total evidence network.

comparison with previous approaches
the method devised by ideker et al.  <cit>  for the determination of signaling and regulation circuits from a combination of protein interaction information and expression data could easily be extended to cover the more general case of microarray interpretation addressed by giga. this would only require the extension of "interaction" to include, e.g., participation in a shared cellular process or shared functional annotation. their approach uses aggregate z-scores to evaluate the quality of each subgraph. this requires a relatively complex parameter estimation procedure followed by simulated annealing. in contrast, the rank-transform of the data that is the basis of giga allows non-parametric p-value calculations and is thus much faster  than the method described by ideker et al. a disadvantage of both methods is that they both do not guarantee to find the optimally scoring subgraph.

the recently released commercial pathway analysis software from ingenuity systems  seems to be based on a similar concept as giga, i.e. the determination of regulated subgraphs in annotation networks. however, it just classifies genes as changed  or unchanged based on an arbitrary selected significance cut-off and thus discards most of the relative-change information  used by giga . therefore, this method is difficult to apply to very noisy or unreplicated experiments where a reliable delimitation of the "changed" genes becomes impossible.

experimental case study
to validate the giga approach, we used the yeast diauxic shift experiment by derisi et al.  <cit> . in this classical study the authors examined the response of yeast cells to glucose depletion in the growth medium. as the biology of this process is extremely well understood and the functional annotation of the yeast genome is very comprehensive, we could use this dataset to test the ability  of giga to identify the relevant subgraphs of interest.

in their original publication, derisi et al. highlight the following changes during starvation: rechanneling of metabolites into the tricarboxylic acid  and glyoxylate cycle, increase in aerobic respiration , gluconeogenesis, and carbohydrate storage . in contrast, 95% of ribosomal proteins, as well as trna synthetases and translation elongation/initiation factors were strongly down-regulated. twenty hours after the initial inoculation of the sample about 20% of all genes showed at least a two-fold change in expression.

this connectivity between genes and functional classes is provided by giga. table  <dig> summarizes the results for the  <dig>  hour time point, using two different networks, one for geneontology classes, and one for enzyme substrates, extracted from the swissprot catalytic activity descriptors of yeast proteins. for both up- and down-regulated genes, the most significant subgraph is widely separated from the next best one, contains the largest number of genes, and comprises almost all the processes detected by iga and the original authors.  figures  <dig> and  <dig> show the automatically generated visualization of the corresponding most significant subgraphs and the associated annotation. it is obvious how giga highlights the functional connections between different enzymes. in fig.  <dig>  the association between small and large ribosomal subunits, nucleolar rrna processing and translational elongation is faithfully reconstructed. in fig.  <dig>  which uses the enzyme substrate network , the interplay between the tca cycle, the overlapping glyoxylate cycle, and all the relevant protein complexes of the respiratory chain are readily apparent. the agreement with the manual interpretation by derisi et al. extends down to the single gene level, while at the same time adding additional, obviously relevant connections, e.g. from the tca cycle to the atp synthase complex. fig.  <dig> also shows the second best subgraph, which contains the cytochrome c oxidase subunits together with two catalase genes that may be involved in the detoxification of the hydrogen peroxide generated by the respiratory burst induced by starvation.

the performance of giga  is best appreciated when compared to the results of an extensive expert interpretation of the same data. table  <dig> to  <dig>  and fig.  <dig> and  <dig> show how both techniques succeed in detecting and condensing exactly the genes and processes that were considered relevant by the expert biologists when first interpreting the same data  <cit> . giga effectively summarizes the original publication in three subgraph pictures . this is even more astonishing when considering that these results are achieved for each single time-point separately . this reveals the stability of the approach towards the measurement variance inherent in any unreplicated microarray experiment.

it is important to be aware that each of the highlighted subgraphs has to be carefully evaluated for its biological relevance. on the one hand, the sheer number of possible subgraphs in an evidence network creates a major multiple-testing problem, which means that some of the detected associations may be due to chance. random permutations of the expression data – which can be generated by the giga software – can give an idea of the expected false-discovery rate. on the other hand, functional annotations are at present notoriously unreliable and spurious edges may affect the details of the results. also, not all genes within a detected subgraph will necessarily show a strong expression change, because sometimes less strongly affected genes may connect those genes that do change. such a relation is for example expected for many transcription factors and their targets  <cit> . nonetheless, giga is able to direct the user to the most interesting areas in the evidence network.

the giga method is not restricted to use with exhaustively annotated genomes. it can work on a wide variety of "evidence" to build the necessary network, including hypothetical predicted functions or associations. it is even possible to apply giga to metabolomics results, which are characterized by the absence of any significant amount of annotation – usually only exact molecular masses and their differential abundance are known. in that case, an evidence network can be built from the measured masses themselves, linking compounds m <dig> and m <dig> whenever their mass difference  can be explained by a common biochemical transformation ). the set of relevant transformations can easily be collected from any biochemistry textbook. in addition, one can introduce edges for condensation reactions between observed masses, i.e. if m <dig> + m <dig> = m <dig> + mass then edges between m <dig> and m <dig>  and m <dig> and m <dig> are added to the evidence network. we are currently developing the application of giga to this kind of data in the sir henry wellcome functional genomics facility at the university of glasgow ; data not shown).

CONCLUSIONS
the present analysis of a biologically well-understood test case demonstrates the reliable performance of giga. the method automatically identifies all relevant physiological processes, puts them into context, summarizes them in an intuitive format, and associates them with the underlying evidence . it can be applied to experiments with very small numbers of replicates  and can be used with any available functional annotation, including protein interaction networks, co-expression data or literature mining results, as well as in areas beyond microarray analysis. for visualization, we have used the graph-layout software aisee, but output files suitable for a variety of graphical tools can easily be generated by slight modifications in the implementation. giga can be used as a stand-alone tool, but we expect that it will be most useful when integrated into existing microarray analysis software, and for that reason the giga algorithm is freely available without restrictions.

