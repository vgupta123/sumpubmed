BACKGROUND
the nervous system consists of a very large number of neurons—and glial cells—that are connected in complex networks. neurons convey information by means of electrical pulses, called action potentials or spikes, consisting of a very fast and transient depolarization of their membrane potential. sequences of spikes, called spike trains, are believed to serve as an information code in the brain. pairwise synchrony between spike trains is widely studied in neuroscience as a way to understand these codes. although neuronal interactions are probably not described only by pairwise associations  <cit> , they have been shown to provide important information about neural coding . on the other hand, the definition of neural synchrony is a matter of debate and different conceptions of it exist, such as “exact spiking coincidence” or “firing rate association”. there are several existing models for synchrony between simultaneous spike trains, most of them based on cross-correlation analysis. common methods to measure synchrony are, for example, the cross-correlogram or the joint peristimulus time histogram  <cit> . other methods not based on cross-correlation analysis include unitary event analysis  <cit> , conditional synchrony measure  <cit>  and a method based on the distances between the closest spikes  <cit> , among others. most commonly, association measures are used to test for the presence/absence of synchrony. several methodologies exist for this aim  <cit> ; however, in this paper we address a different problem. we use a cross-correlation based method, called the integrated cross-correlation synchrony index , which allows us to obtain a synchrony curve as a function of time and search for differences in the strength of pairwise associations regarding different factors. a similar problem was considered by faes et al.  <cit> , where these authors compare the synchrony between neurons under experimental conditions with synchrony at baseline.

during deep sleep, neurons in the cerebral cortex present a highly oscillatory global activity that can be observed by means of an electroencephalogram  or an electrocorticogram . furthermore, in the awake state, these global oscillations disappear giving rise to a less synchronized global activity. the transition from the sleep state to the awake state is regulated by the activating ascending pathways, which are afferent neuronal pathways originating in nuclei located at the basal forebrain and the brainstem  <cit> . under general anesthesia, the eeg is characterized by the presence of a number of patterns  that show a progressive increase in low-frequency, high-amplitude activity . in this scenario, the transition to the awake-like state can also be reproduced by means of microelectrical stimulation of some activating ascending areas  <cit> . on the other hand, an important property of neurons in the primary visual cortex  is orientation selectivity; i.e., the neurons respond better  to a specific orientation of the visual stimulus, the so-called preferred orientation  <cit> . this property is important in neurophysiological studies because it can provide meaningful clues regarding the physiology and microanatomy of the striate cortex.

the aim of the present study is to investigate the differences in synchrony strength regarding different experimental conditions given by anesthesia and awake-like activity, as well as the orientation selectivity of neurons in v1: we study whether similarities among neurons, such as the similarity in preferred orientation, affect the strength of correlated activity. we perform the analysis in a group of neurons recorded from v <dig> of an anesthetized adult cat. a method is proposed to investigate whether the mode of activity , and the affinity in orientation selectivity of a given pair of neurons, have a determinant influence in how neuronal synchronization evolves.

the data are synchrony measurements computed at any time point. therefore, the data are curves varying continuously over time. this is the reason why, in this paper, the word functional will be used to denote the nature of the data and not to make reference to the neurophysiology of the neurons under study. this term comes from statistics, where “functional data analysis” is a widely developing research field.

a functional two-way analysis of variance is proposed. functional data analysis tools, based on cuesta-albertos and febrero-bande  <cit> , are used. the method is adapted to consider the dependence that exists among the data because of the experimental setting. a parametric bootstrap is proposed for hypothesis testing.

methods
in this section, the data are presented. also, the synchrony measure used to obtain the functional data is described, as well as the statistical methodology used to cope with the functional analysis of variance  model.

dataset
data were recorded from an anesthetized and paralyzed adult cat. a microelectrode array with eight independent movable electrodes was introduced into the primary visual cortex of the animal for neuronal recording. another two microelectrodes were introduced into the brainstem and basal forebrain for electrical stimulation. these stimulations, which we denote as bs  and bf , provoked a change in cortical activity from anesthesia to an awake-like pattern. all experiments followed the guidelines of the international council for laboratory animal science and the european union  and the protocols were approved by the university of a coruña committee on animal care.

at the beginning of each recording, neurons were characterized regarding their preferred orientation. drifting gratings were used to visually stimulate the cat while the firing activities of a group of neurons were recorded. each grating corresponded to an angle, which we call orientation, with a specific direction of movement. orientation  are continuous variables; however, owing to the nature of the experiments, they will here be considered as discrete. sixteen possible orientation-direction gratings were used: eight orientations with two possible directions each. for example: a drifting grating at 90°  that moves from right to left is a possible orientation-direction stimulus; another moving from left to right is a different one. although the use of the two possible directions is also of interest in the study of other properties of v <dig> neurons , in this work we focus our analysis on the orientation selectivity. hence, there were eight possible values for orientation: 0°,22°,45°, <dig> °,90°, <dig> °,135° and  <dig> °. so, each recorded neuron was associated with one orientation , corresponding to its maximum firing rate. however, we still need to go one step further, as the objective of the study is to evaluate the effect of orientation selectivity on neural synchrony. to achieve this aim, each pair of neurons is identified with a value of a variable, g, which is defined as the difference between the preferred orientations of the neurons that form the pair. that is, if o <dig> and o <dig> are the preferred orientations of two neurons, we define g=min{|o1−o2|,180°−|o1−o2|}. given the previous considerations, g can take one of these five possible outcomes: 0°, <dig> °, 45°,  <dig> ° and 90°.

throughout the paper, we will denote the number of neurons in a simultaneously recorded group by n and the number of possible pairs by . the number of experimental conditions will be denoted by k, the number of trials in each of these conditions will be l and n will denote the total sample size: n=krl. for our data, n= <dig>  r= <dig>  k= <dig>  l= <dig> and n= <dig>  the firing rates of the test neurons varied from less than  <dig> hz to around  <dig> hz; however the most common values ranged from  <dig> to  <dig> hz, denoting typically low firing activity.

synchrony measure
to measure synchrony, we used a cross-correlation based measure defined as the area under the cross-correlation function in a neighborhood around zero. data were recorded under spontaneous activity, which is characterized by its very low firing activity. exact spiking coincidences hardly ever occur, although the global activity of the brain is highly synchronized. by considering the area under the normalized cross-correlation function in an interval around zero we allow for a more relaxed definition of synchronous spike trains than that of just exactly coincident events.

integrated cross-correlation synchrony index 
let  and  be two simultaneously recorded spike trains in the time interval . that is,  is the time when the i-th spike of train  <dig> occurred, and similarly for . let ui and u−i be the waiting times from a spike in train  <dig> to the i-th subsequent and the i-th preceding spike in train  <dig>  respectively. the probability density functions of these random variables are called the forward and backward cross-interval densities of order i, respectively, and we denote them by ηi and η−i. the cross-correlation function ζ is defined as the sum of cross-interval densities of all orders:
  <dig>  

where τ is an arbitrary value, the waiting time. the normalized cross-correlation function
  

represents the probability density function of the time from an event in train  <dig> to an event randomly chosen in train 2
 <cit> .

the observed spike trains can be used to estimate the cross-interval densities. empirical normalized cross-correlograms are used to estimate the normalized cross-correlation function. the cross-correlogram, , is built as the histogram  of the observed waiting times between the spikes of the first neuron and the spikes of the second neuron. usually, joint firing, or close-in-time firing, is the event of interest so only small values of τ in  are taken into account. then, we consider the normalized  cross-correlogram, , as follows:
  

the intuitive definition of synchrony involves the event of two neurons firing together. under low firing rates, the spikes corresponding to two highly synchronized neurons do not appear exactly at the same time, although they may follow a similar pattern. in this context, flexible tools are needed to capture synchrony. we use the integral of the cross-correlogram around zero:
  <dig>  

where δ< <dig> is an arbitrary small number chosen by the researcher. in this way, we allow synchrony to be based on delayed firing and not only on simultaneous firing. integrating  in a neighborhood of zero we account for spikes that occur closely in time, though not exactly at the same time.

to study the evolution of synchrony in time, sliding windows can be used. that is, if the total observational time of the spike trains is , synchrony at time t∈ can be estimated by computing y in the time window . details on functional data analysis are not given here, though we outline the basic notions that are necessary to understand our analysis. for details and theory on this subject, we refer the reader to, for example, the books .

the number of pairs in each of the categories given by g  is  <dig> , <dig>  and  <dig> respectively. therefore, there are  <dig> , <dig>  and  <dig> curves in each category defined by stimulus and orientation. the curves can be evaluated over as many points as desired. points in an equispaced grid 0<t1<…<tm=t are considered: from  <dig> s to  <dig> s every  <dig>  s. therefore, each synchrony curve is evaluated over  <dig> points. let Ψ={:i,j∈ <dig> …,n and i<j} and denote the pairs of neurons with indices ∈Ψ. we will denote by  the l-th trial for the curve y under the k-th stimulus; k= <dig>  and l= <dig> , <dig> . the curves are bounded, since . figure  <dig> shows the data averaged over trials. the top panel shows the functions that correspond to bs stimulation and the bottom panel shows the ones for bf stimulation. different colors are used for the different levels of g.figure  <dig> 
functional data. top panel: iccsi curves  averaged over four trials for the first stimulus, bs. bottom panel: iccsi curves averaged over four trials for the second stimulus, bf. different orientation selectivity groups are shown in different colors: 0° ,  <dig> ° , 45° ,  <dig> °  and 90° .



we search for population differences in the dynamics of the awake-like period induced by each stimulus, taking into account the possible effect of the other factor: difference between orientation selectivity. this problem can be dealt with as a functional two-way anova with a two-level factor: stimulus and a five-level factor: g.

functional anova
as already mentioned, the aim of this work is to search for differences in synchrony dynamics relative to two factors: stimulus and difference in orientation selectivity. as the difference in orientation selectivity can take only values in a given finite set of values, the problem is one of a two-way analysis of variance with fixed effects in which the response variable is functional. in the following subsection, we outline the methods.

the random projection method for the anova model
the random projection approach in the functional data context is based on the ideas of cuesta-albertos et al.   <cit> . these authors give an extension, on hilbert spaces, to the cramer-wold theorem, which characterizes a probability distribution in terms of one-dimensional projections. their theorem  <dig>  states that if two distributions are different, and we choose a marginal of them at random, those marginals will almost surely be different. based on this fact, cuesta-albertos and febrero-bande  <cit>  propose a method for hypothesis testing in infinite dimensional spaces. we will state their result more formally, particularizing it to our problem. let us assume the data belong to a hilbert space,, with a scalar product 〈, 〉, and let μg be a gaussian distribution in. suppose the hypothesis to be tested is whether certain parameters, say γ <dig> and γ <dig>  are equal . if γ1≠γ <dig>  then the set of random directions, ν, from μg in, for which 〈ν,γ1〉=〈ν,γ2〉, has probability zero. that is, if h <dig> fails, then it also fails in its projected version for μg—almost every ν∈. therefore, a test at level a in the one-dimensional space is a test at the same level to test h <dig> 

we now present the functional two-way anova model for our problem and state the methodology more formally. we consider the following linear model for the synchrony curves:
  <dig>  

for k= <dig>  and l= <dig> , <dig> . the function  is the iccsi for trial l of the pair given by neurons i and j under stimulus k; m is the global effect curve and αk is the effect of stimulus k. the function g:Ψ↦{ <dig> ,⋯,5} indicates the level of the factor g that corresponds to the pair given by neurons i and j, identifying level  <dig> to 0°, level  <dig> to  <dig> ° and so on. therefore, βg is the effect of level g on the synchrony curve. the effect of a possible interaction between the factors is gathered by γkg and, finally,  is the random error term. for parameter identifiability, we assume:
  <dig>  

the relevant null hypotheses to be tested are:
  

which means that there is no effect of the stimulus and
  

which states that there is no effect of the orientation selectivity. also, a hypothesis for the interactions is interesting:
  

theorem  <dig>  in  <cit>  states that, if the data belong to a hilbert space,, endowed with a scalar product 〈, 〉, μg is a gaussian distribution on such that its one-dimensional projections are non-degenerate, then, if ∃k∈{ <dig> }, such that αk≠ <dig>  then   

if ∃g∈{ <dig> , <dig> ,5}, such that βg≠ <dig>  then   

if ∃k∈{ <dig> } and g∈{ <dig> , <dig> ,5} such that γkg≠ <dig>  then   



therefore, the proposed procedure is to randomly project the data on the one-dimensional space and to test the hypotheses in that context. given a random function, ν, and denoting the projection of a function f∈ in the direction of ν as f, 〈ν,f〉, we consider the projected model:
  <dig>  

and the hypotheses in the one-dimensional problem:
  <dig>  

the tests defined in the one-dimensional response case are clearly conditional on the random projection used, ν. to reduce the error introduced by the choice of the random projection, we will use the correction that implies controlling the false discovery rate  introduced by benjamini and hochberg   <cit> . this method is also recommended by cuesta-albertos and febrero-bande  <cit> . in particular, we use the fdr procedure that arises from the work of benjamini and yakutieli   <cit> . given the ordered p-values p<…<p obtained using s random projections, we will choose the corrected p-value as the quantity , where min stands for the minimum of a set.

so far, this test can help in the search for global differences between the two groups of curves, although we would rather study how these differences change in time. to do this, we propose the use of moving windows along time. for each time point, t, we consider an interval of time, centered at t, and project the pieces of curves that correspond to that interval, to perform the anova test.

the hypotheses in  can be tested with any regular anova approach. nevertheless, some caution is needed, as the errors in our model cannot be assumed to be independent, as we discuss in the next subsection.

anova model with dependent errors
in this section we introduce the problem of the dependence that is present in the data. the dependency comes from the fact that the data are observed at the neuron-pair level. so, it is only fair to think that the curves obtained from two pairs of neurons with one cell in common could be correlated.

since we work with the projections of the y functions, we can forget about the infinite dimensional problem and focus on the one-dimensional one. let us consider the model in , dropping the superscript  for simplicity:
  <dig>  

with ∈Ψ, k∈{ <dig> } and g∈{ <dig> ,…,5}. model  is a two-way anova model with a two-level first factor and a five-level second factor, with unbalanced cells, as we do not observe the same amount of pairs of neurons with differences in orientation selectivity. the following representation of the problem is more convenient. consider each , i.e., the synchrony of a given pair of neurons under each stimulus, as a random variable. in this way, we have four realizations of each variable, so our linear model becomes another linear model with 2r variables and l observations each. the model can be written in matrix form, as follows:
  <dig>  

where  are the data ordered in a convenient form,  is the design matrix,  is the vector of parameters, θt=. the parameters α <dig>  β <dig> and γ <dig> are not included in the definition of θ because they are superfluous by the conditions defined in . finally,  is the vector of errors. here, we consider the data ordered as follows:
  

and therefore the vector of errors, ε, has the form:
  

the assumptions of normality and homoscedasticity for the errors are reasonable in this context, but the fundamental problem in this study arises from the presence of dependence among the data that comes from pairs of neurons sharing a cell. that is,  and  are dependent if {i,j}∩{i′,j′}≠∅. the errors of the model are normally distributed with zero mean and covariance matrix Σ. we assume that the variance of  is the same for all  and all k and equal to σ <dig>  on the other hand, we also assume that  whenever #= <dig>  where # denotes the cardinal . let Ω={:#= <dig> k=k′,l=l′} then, in summary:
  <dig>  

therefore, Σ results in a very special matrix, with σ <dig> in the diagonal, and σ2ρ where the variable in the column and the variable in the row share a neuron and also share a trial . that is, Σ is a n×n matrix composed by a diagonal of nr×r blocks, and the rest of the elements are zeros. the blocks in the diagonal are all equal and equal to the covariance matrix, σ2c, of the data that correspond to one level of the first factor :
  <dig>  

with c=c in our particular example :
  

with this definition, Σ is positive definite for small values of ρ. the eigenvalues of the matrix in  result in only three different values: σ <dig>  σ <dig> and σ <dig>  which, for ρ∈ <cit> , are all greater than zero at the same time, whenever ρ< <dig> . this means that this correlation structure for the data is plausible only for ρ∈ [  <dig> .5).

the fstatistic
our anova problem comprises the hypothesis test that some of the parameters in model  are equal to zero. in matrix form, this can be written as
  <dig>  

where, in the case of the stimulus effect,
  

and, in the case of the orientation selectivity, the hypothesis matrix is
  

and, in both cases, h is a vector of zeros. let us denote by q the total number of parameters in the complete model and let q <dig> be the number of parameters, different from zero, under the null hypothesis.

let the residual sum of squares function, in matrix form, be denoted by q:
  

denote by  the estimate of θ in the complete one-dimensional model and let  be the estimate for the reduced model. that is,  is the vector of parameters that minimizes q under the restriction given by . then, the classical anova f statistic is
  <dig>  

where d <dig> denotes the degrees of freedom of the numerator, that is, q−q <dig>  and d <dig> the degrees of freedom of the denominator: n−.

the test statistic, f, under assumptions of independence, normality and homoscedasticity, follows an f distribution with q−q <dig> and n− degrees of freedom. in our context, as the errors of the model cannot be assumed to be independent, the test statistic does not have an  distribution and, therefore, we need to calibrate the null distribution of the test statistic. we propose a parametric bootstrap procedure to calibrate the distribution of the anova test statistic under the null hypothesis.

estimation of the correlation coefficient
since we assume that the covariance between the different pairs of error terms are equal, provided the pairs belong to Ω, we will estimate the correlation coefficient as the average of the pearson correlation coefficient of the corresponding pairs, which is equivalent to:
  <dig>  

where  are the elements of the residual vector:  and  is the estimated residual variance:
  

direct bootstrap
as the data are normally distributed, we propose the use of a parametric bootstrap to calibrate the distribution of the anova test statistic under the null hypothesis. we now describe the procedure for a general null hypothesis .

once the linear model has been fitted to obtain  and the classical anova statistic has been computed , we estimate σ <dig> and ρ from the residuals to build the estimated covariance matrix, . we proceed with the following bootstrap algorithm:replace the i-th parameter in the estimated  by zero . this set of parameters will be denoted by . build a bootstrap sample:  with .

fit the linear model to the resample, obtain the bootstrap version of the estimated parameters  and compute f∗, the bootstrap version of f.

repeat steps 1– <dig> b times to obtain f∗ <dig> …,f∗b.

compute the desired -quantile of the bootstrap versions, . we reject the null hypothesis if .



RESULTS
in this section we show the results of applying the random projections method to the functional anova problem at hand. to draw the random vectors we use brownian motions or, more precisely, approximations to standard brownian motions by sequences of partial sums of normally distributed random variables. we only need to compute the values of the random vectors in the equidistant time points, t <dig> ⋯,tm, where the functions  are defined. for this, we consider m independent and identically distributed standard normal random variables, z <dig> …,zm, and define a trajectory ν <dig> as
  <dig>  

on the other hand, we would like to have directions without tendency and such that their variability throughout the trajectory does not change too much. for this aim, we define the random trajectories as the sum of two brownian motions, as just defined, where one of them has been “flipped" so as to be equal to zero in the last time point tm. that is, let ν <dig> and ν <dig> be defined as in  and let ν3=ν <dig>  the final directions we use are defined as ν=ν1+ν <dig> 

a preliminary analysis, fitting model , showed that the interaction between factors was not significant. therefore, the final model considered is:
  <dig>  

with k∈{ <dig> }, g∈{ <dig> ,…,5}, and l∈{ <dig> , <dig> }. figure  <dig> shows the p-values obtained by using sliding windows across time to study the evolution of the effects of both factors. a 40-s time window was considered, moving along the time axis  from  <dig> s of recording to  <dig> s. in the time period between  <dig> s and  <dig> s, this was done every second; for the rest, it was done every  <dig> s. at each window,  <dig> random directions were used to project the data  and the fdr correction was applied, resulting in just one p-value. it is clear that there are differences between the two approaches used. when dependence is not taken into account  the test is less conservative than when dependence is included. although for the effect of the stimuli there is a period of time at the beginning of the awake-like period  for which both tests reject the null hypothesis, next there is another period in which it would be rejected if dependence was not accounted for. the results show that a period of time exists during the awake-like mode when the difference between the effects of the two stimuli is significant. this result reinforces the view that there are important differences in the physiology and dynamics of the two activating pathways: bs and bf. on the other hand, the differences in synchrony among the levels of the factor g were also found to be significant after the stimulus.figure  <dig> 
anova
p
-values.
p-values for the two-way anova as a function of time, for the significance of the stimulus effect  and for the significance of the difference in orientation selectivity . p-values obtained using the  distribution , direct bootstrap  and χ
2-based bootstrap from the appendix  are shown. p-values below the horizontal dotted line  are significant. the vertical dotted lines depict the stimulation times.



the estimation of the correlation coefficient changes for each window; nevertheless, the estimation is not very variable, even from one projection to the other. figure  <dig> shows the  as a function of time and their mean across projections. we can observe that, at the beginning of the recording, the estimated correlation coefficients were greater than  <dig>  and they were truncated for the covariance matrix, , to be positive definite.figure  <dig> 
correlation coefficient estimates. evolution of the correlation coefficient estimates. estimations for different random projections , and their means . the vertical dotted lines depict the stimulation times.



when large correlation is present  an alternative, nonparametric, bootstrap can be carried out. in the following procedure, each set of bootstrap residuals is defined as the set of original residuals of a trial chosen at random with equal probability from all possible trials:for each k∈{ <dig> } and l∈{ <dig> , <dig> } draw the bootstrap pair  with equal probability from { <dig> }×{ <dig> , <dig> }, that is,  for all k′∈{ <dig> ,} and all k′∈{ <dig> , <dig> }.

define .



this bootstrap procedure has the drawback that, in our case, the vector of bootstrap residuals can only take eight possible values. a possible improvement is to use a smoothed version. to achieve this, a smoothing parameter h, typically small with respect to the standard deviation of the residuals, is chosen and step  <dig> is replaced by:

 <dig>  define  with  iid ∀.

the green curve in figure  <dig> represents the p-values obtained with an alternative bootstrap algorithm based on an approximation to the real distribution of the f statistic. this alternative method, which we call the χ2-based bootstrap, reduces computational time considerably. it involves some theoretical insight that we describe in the appendix. the main result is based on the fact that the test statistic f can be expressed as a ratio of quadratic forms on the errors of the model. there are plenty of results concerning the exact distribution of quadratic forms on normal vectors. for example, provost et al.  <cit>  derive the exact density function of an indefinite quadratic form in noncentral vectors, which allows us to derive the distribution of ratios of quadratic forms as those involved in anova tests. nevertheless, the closed formulas for the density functions of quadratic forms are complex and not practical. on the other hand, the distribution of the numerator and the denominator that give shape to the f statistic are quite easy to approximate by montecarlo, as is also described in the appendix. we use this approach to carry out, in the next two sections, an evaluation of the test. first, we compare the distribution of the test statistic when dependence is either taken into account or not. finally, we perform a simulation study to evaluate the performance of the bootstrap test.

distribution of the test statistic f
to visualize the differences between the distribution of the test statistic, f, either when taking into account dependence or when independence between observations is assumed , figures  <dig> and  <dig> show the density of f under the null hypotheses, approximated by montecarlo in the numerator and denominator of . the model used is the same as in the real data case; i.e., y=xθ+ε given by . the real data scenario was reproduced by constructing the model for eight neurons and four trials under each stimulus. the values of the second factor were exactly as in the real case. moreover, the errors were assumed ε∼n with Σ defined as in  with σ2= <dig> and different values for the correlation coefficient: ρ= <dig> . <dig> . <dig> and  <dig> . the first panel of figures  <dig> and  <dig> show that the null distribution of the test statistic corresponds to the  distribution  when ρ= <dig>  figure  <dig> shows that, on the other hand, the  distribution departs from the null distribution of the test statistic when ρ increases. this is evidence for the necessity of using the bootstrap to calibrate the distribution of f instead of using the f distribution. figure  <dig> shows the comparison of both densities for the hypothesis on βi. in this case the difference is not as large as in the previous case. however, in the last panel we can still observe a small deviation. in general we can state that, when ρ increases, the tail of the distribution becomes heavier. this explains why, sometimes, the test using the classical approach rejects while the bootstrap approach does not.figure  <dig> 
test statistic density function under no stimulus effect. probability density function of the test statistic under no stimulus effect  compared with the corresponding  distribution  under different correlation scenarios: ρ= <dig> , ρ= <dig>  , ρ= <dig>   and ρ= <dig>  .
test statistic density function under no effect of the difference in orientation selectivity. probability density function of the test statistic under no effect of the difference in orientation selectivity  compared with the corresponding  distribution  under different correlation scenarios: ρ= <dig> , ρ= <dig>  , ρ= <dig>   and ρ= <dig>  .



performance of the test
in this section we perform a simulation study to evaluate whether the type i error  of our test is close to its nominal value . also, we evaluate the power of the test, which is the probability that it correctly rejects the null hypothesis when the null hypothesis is false. for this aim, we simulated data, similar to real data, using different  model parameters and correlation coefficients. with the simulated data, we computed f and followed the procedure used to calibrate the distribution of the test statistic with level a= <dig> . finally, we compared the results  with the true case. the data were generated as if three trials under two stimulation conditions of a group of seven neurons had been recorded. each neuron was assigned a given fixed characteristic  so that the second factor  could be computed. in this case, the preferred orientations were defined with only two possible values that were assigned arbitrarily to each neuron. then,
  

where θ=t. the covariance matrix, Σ, was defined as in  for four values of ρ. the values used for the simulations are m= <dig>  α1= <dig> . <dig> . <dig>  β1= <dig> . <dig> . <dig> and ρ= <dig> . <dig> . <dig> . <dig> 

a large variance  with respect to the parameters was chosen to reflect a typical situation for the real data. for most of the projections, the signal to noise ratio is rather small. this large variance might affect the ability of the test to detect differences between the parameters. m= <dig> montecarlo simulations were performed and for each one, b= <dig> bootstrap trials were used. the results are shown in tables  <dig>   <dig> and  <dig>  table  <dig> shows the proportion of rejections when testing for no effect of the first factor. it can be observed that the nominal level of the test is not well respected under dependence. the test is moderately anti-conservative when using the bootstrap, and severely anti-conservative when using the f distribution. when using the bootstrap, the rejection percentage under the null remains close to the nominal even when increasing the dependence. this is not the case when using the f distribution, since the rejection percentage under the null is inadmissibly large. table  <dig> shows the proportion of rejections when testing for no effect of the second factor. in this case, the bootstrap respects the nominal level reasonably well when testing for β <dig>  however, the test based on the f distribution is very conservative under large dependence. regarding the power of the test, table  <dig> shows that the proportion of rejections decreases when ρ increases for both tests. it is noticeable that the power of the test based on the f distribution is rather larger than that of the bootstrap test, especially for large correlations. nevertheless, the fact that the level of the test is respected a lot better by the bootstrap makes this method more appropriate. table  <dig> shows that, surprisingly, the value of the correlation parameter does not influence the results, regarding power, when testing for β <dig>  for β1= <dig> , we can observe near to 100% rejection under the alternative in almost all cases. table  <dig> also shows how the power of the bootstrap test is better compared with the one calibrated with the f distribution.table  <dig> 
proportion of rejections for

at level
a
=0
.
05


f
f
f
f
β

α
β
β
β

α
β
β
β

α
β
β

at level
a
=0
.
05


f
f
f
f
α

β
α
α
α

β
α
α
α

β
α
α

at level
a
=0
.
05


f
f
f
f
β

α
β
β
β

α
β
β
β

α
β
β


finally, we show similar simulation results when testing for the interaction between the two factors. table  <dig> shows the proportion of rejections under the null hypothesis for different values of ρ and  <dig> montecarlo replications. we can observe that the nominal level is successfully met by the bootstrap test for small correlation values. although for the case of large correlation values the test seems to be conservative, it outperforms the f test remarkably. it is important to note that, regarding the power of the test, in these simulations the test rejected the null hypothesis 100% of the time , using values of γ= <dig> , <dig> to simulate data in the alternative.

CONCLUSIONS
in this work we proposed a functional two-way anova for neural synchrony curves, using random projection techniques. these methods are very easy to implement and interpret, which makes them appealing for applying to many problems. the method was shown to be useful as it allowed the significance effects of the factors under study to be addressed.

the model under study involves synchrony curves obtained by a cross-correlation based method. the curves were separated into groups given by the stimuli and the difference in preferred orientation between the two neurons involved in each curve. differences between the levels of this second factor were also of interest. although there were groups with very few elements, several conclusions can be established.

the importance of including the dependence between curves in the analysis was shown. the distribution of the test statistic was approximated using a parametric bootstrap on the residuals of the model, allowing for dependence. the classical f test statistic can lead to false positives, as the distribution of the test statistic has a heavier tail than the f distribution. two algorithms were presented to carry out the bootstrap: a direct resampling plan, which resamples from the model, and a second one, based on the fact that the f statistic has the same distribution as that of a ratio of particular linear combinations of  variables. the second algorithm has a substantially lower computational cost than the first one.

regarding the real data, the interactions between the factors were not statistically significant. an effect of the factor stimulus can be found at the beginning of the awake-like period . to make a statement regarding the differential effect that bs and bf have on pairwise synchrony, the analysis of more groups of neurons would be necessary. however, this work shows that the question is worth asking, as we were able to find evidence of these differences after the switch from anesthesia to the awake-like mode. in fact, taking into account the ability of bs and bf to promote wakefulness with a similar effect on ecog power spectral density  <cit> , the robustness of the proposed statistical method  allows us to find some differences in neural pattern synchrony, consistent with physiological data as follows. activation of the parabrachial nucleus in the bs enables thalamic relay neurons to disrupt cortical synchronization via glutamate release  <cit> . in contrast, bf stimulation induces not only ach release, but also gaba, glutamate and no in the cortex  <cit> . thus, although the effect that bs and bf activation has on ecog dynamics has been characterized as regulatory on cortical activation, the different operational mechanism of each system could be reflected in the temporal coordination between neurons. finally, a relevant issue in neurophysiology relates to the type of information processing carried on by primary visual cortex neurons . briefly, some basic properties of the visual processing—like orientation selectivity—could be based either on highly refined and specific anatomical connections or, in contrast, could be carried out by distributed computational processes at the cortical level. the results presented here show that the effect of the difference in orientation selectivity was significant throughout all the generated awake-like activity, suggesting that the strength of the connectivity was dependent on the orientation selectivity of primary visual cortex neurons, thus favoring the second hypothesis.

overall, this work is a contribution to the development of statistical tools for neuroscience. although the methods we propose here have been focused on a particular problem, they are applicable in many other contexts. it is worth to mention that differences were found even though the firing activity of the test group was considerably low, showing the method can be useful when low firing rates are present. also, bootstrap techniques are very powerful and easy to implement , and might be a good alternative to parametric inference using minimal mathematical assumptions.

appendix - χ2-based bootstrap
here we present the results that provide a computationally more efficient way to perform the bootstrap test. first of all, let us rewrite f in a more convenient form. recall
  

where  is the estimator of the parameter vector θ in the unconstrained model, while  is the estimator under the null hypothesis . it can be shown that  and  relate as follows:
  

where
  

and,
  

which implies that
  

moreover, we can write this expression as a quadratic form based on the errors of the model by noticing that:
  

therefore,
  

and finally,
  <dig>  

in a similar way, the sum of squares of the denominator can be expressed as
  <dig>  

from  and  we obtain:
  <dig>  

let us denote the matrix in the last expression of  by
  

and the final matrix in  by
  

finally, we can give the expression for the f statistic in terms of quadratic forms on normal vectors:
  <dig>  

where ε∼n.

let us denote z=εta1ε. also, let s be a matrix such that Σ=sst and let r=s−1ε. we denote the eigenvalues of sta1s, or equivalently those of Σa <dig>  by λ <dig> …,λn and by p, an orthogonal matrix whose columns are the eigenvectors of sta1s. so, z=rtsta1sr=rtpdptr=εttpdpts−1ε=vtdv, where v=pts−1ε and d is a diagonal matrix with diagonal elements λ <dig> …,λn. it follows that v∼n and, therefore,
  

where  for i= <dig> …,n.

the same argument is true for the quadratic form in the denominator of f. thus, the distribution of εta2ε is the same as the distribution of , where μ <dig> …,μn are the eigenvalues of Σa <dig> and , i= <dig> …,n. consequently, the ratio
  <dig>  

has the same distribution as f. the distribution of  can be approximated by montecarlo.

in practice, Σ is not known, so the λi and μi cannot be computed. however, Σ can be replaced by  as in . thus,  and   can be used in . observe that this is equivalent to the original bootstrap resampling plan as presented above. this gives an alternative method for performing the bootstrap that is much less time consuming. for instance, in the example shown in figure  <dig>  the results obtained with the direct bootstrap are reproduced, except for minor differences due to montecarlo error, and the computational time is at least  <dig> times smaller with this alternative method.

competing interests

the authors declare that they have no competing interests.

authors’ contributions

ne, jc and jm conceived the neurophysiological problem and designed and performed the experiments. amgm and rc designed the model and the hypothesis tests. amgm implemented the statistical tools, and performed the analyses and computational experiments. amgm, rc, ne and jm analyzed the results. amgm and rc drafted the manuscript. all authors revised and approved the final version of the manuscript.

this work was supported by grant mtm2011- <dig> from the spanish ministry of economy and competitiveness. amgm was supported by a “formación de personal investigador”  grant  from the spanish ministry of economy and competitiveness. amgm, ne and jm were supported by xunta de galicia . the authors would like to thank professor juan cuesta-albertos for his useful comments during the early stage of this research.
