BACKGROUND
the effective size of a population  is the size of an idealized population that would show the same amount of genetic drift or the same inbreeding rate than the population under consideration  <cit> . it is an important parameter in population and quantitative genetics and in evolutionary and conservation biology because it determines the rate at which genetic variation is lost.

traditionally, ne has been estimated from demographic or pedigree data  <cit> , but when this information is unavailable, ne can be estimated from genetic data  <cit> . until recently, the most widely used genetic method for estimating contemporary ne has been the temporal method  <cit>  which is based on the temporal changes in allele frequencies for samples of the same population collected at  two different points in time. however, with the advent of high throughput genotyping techniques, the one-sample method based on linkage disequilibrium  measures  <cit>  has attracted increasing attention in recent years .

one of the main advantages of the ld-based method over the temporal method is that it uses much more information and therefore leads to estimates of higher accuracy  <cit> . also, the strength of ld at different genetic distances between loci can be used to infer ne at any point in time from a single sample  <cit> , as ld between a pair of markers is determined by the product of ne, recombination frequency and number of generations since mutation  <cit> . on the contrary, the temporal method only gives estimates of ne over the period between sample collections.

an important assumption of the genetic methods proposed for estimating ne that is often violated is that generations are discrete. different corrections have been developed to account for overlapping generations when using the temporal method  <cit> , but the applicability of the ld method in this context remains unclear  <cit> . it is also unclear the optimal way to account for different factors that affect the relationship between ld and ne such as mutation and sample size  <cit>  under a scenario of overlapping generations.

under this context, a valuable dataset for investigating the applicability of the ld method would be that coming from a population with overlapping generations where accurate ne estimates across generations can be obtained . these accurate estimates could then be used as a baseline against which to compare ld-based estimates. this is the case of the present study, where complete and accurate pedigree records  for an experimental herd of iberian pigs with overlapping generations founded in  <dig> are available. our aim was to obtain estimates of ne with the ld method using genome-wide data obtained with the illumina porcinesnp <dig> beadchip. by comparing estimates for ne assuming different models that varied in the way in which mutation and sample size were accounted for with accurate pedigree-based ne estimates it was possible to determine the most appropriate model. another novelty implemented in this study was to treat different generations as replicates of the same population, in order to assess the error of the estimates. to our knowledge, this is the first study that evaluates the applicability of the ld method in a population with overlapping generations using temporal replicates of empirical data and accurate estimates of pedigree-based ne as a benchmark to decide the optimal model for obtaining ld-based estimates.

methods
ethical statement
the current study was carried out under a project license from the inia scientific ethic committee. animal manipulations were performed according to the spanish policy for animal protection rd1201/ <dig>  which meets the european union directive 86/ <dig> about the protection of animals used in experimentation. we hereby confirm that the inia scientific ethic committee, which is the named iacuc for the inia, specifically approved this study.

samples and snp genotypes
data used in this study originated from pigs from the guadyerbas strain that represents one of the original strains of iberian pigs  <cit> . it has been kept isolated in an experimental closed herd established from  <dig> founders  in  <dig>  management of the herd has implied avoidance of matings between relatives. very accurate and complete pedigree data have been recorded since the time of the foundation of the herd until  <dig> . the complete genealogy includes  <dig>  animals.

genotypic data from the illumina porcine snp <dig> beadchip v <dig> were available for  <dig> guadyerbas animals born between  <dig> and  <dig> in the herd. this implies that genotypes were available for all the animals belonging to the last  <dig> generations . the illumina porcine snp <dig> beadchip v <dig> contains  <dig>  probes that are distributed along  <dig> autosomal and two sex chromosomes, according to the latest version of the porcine map . dna samples, extracted from blood samples were hybridized with the chip and images were scanned by an external service . genotype calls were obtained with the genotyping module of the genomestudio data analysis software . quality control criteria used were those described in saura et al.  <cit> . in brief, a total of  <dig> samples  were used to check the quality of genotyping data. snps that did not satisfy the following quality control criteria were removed: call frequency <  <dig> , gentrainscore <  <dig> , ab r mean <  <dig> , maf =  <dig> and number of inconsistencies with the genealogy >  <dig>  unmapped snps and snps mapped to sex chromosomes were also excluded. after filtering snps, the data were reanalysed and samples with a call rate <  <dig>  and with a large number of inconsistencies with the genealogy were removed. the final number of autosomal snps and guadyerbas samples available for the analysis were  <dig> and  <dig> , respectively. the number of snps segregating was  <dig> . further information about estimates of genetic variability in this herd can be found in fernández et al.  <cit>  and saura et al.  <cit> . the number of genotyped animals per generation was  <dig>   <dig>   <dig>   <dig>   <dig> and  <dig> for generations  <dig>   <dig>   <dig>   <dig>  <dig> and  <dig>  respectively.

estimation of ne across time from pedigree data
pedigree-based estimates of ne per generation were obtained from the rate of inbreeding per generation  as ne = −  <dig> and Δf was estimated from individual long-term contributions to the last generation ; i.e., Δf=∑i=1ntci2/ <dig>  where ci <dig> is the squared long-term contributions of individual i and nt is the number of individuals that form generation t. the long-term genetic contribution of an ancestor  is the ultimate proportional contribution of the ancestor to generations in the distant future  <cit> . thus, the effective population size at generation t was obtained as net=2/∑i=1ntci <dig>  long-term contributions were computed using a fortran software provided by dm howard . an example of the calculation of long-term contributions is provided in the additional file  <dig> 

the generation interval  is defined as the turnover time of genes which equal to the time in which genetic contributions sum to unity; i.e., the genetic contribution summed over all ancestors entering the population over a time period of l years equals unity:  =  <dig>  <cit> . here, the sum of long-term contributions is taken over those born over the time unit .

ld estimation
estimates of ne were obtained on a per generation basis. given that we are dealing with overlapping generations, a given generation included a number of consecutive cohorts that was roughly equal to l. according to this and given that genotypes for the last six generations were available, we built six replicates of the same population and each replicate corresponded to one generation. this design of splitting the data into replicates has never been considered before. it allowed us to evaluate the error of the ne estimates.

for each replicate , autosome pairwise ld was computed as the squared correlation between pairs of snps   <cit>  using the formula r2=d2papapbpb, where d = pab − papb, pab is the frequency of the genotype ab  and pa, pa, pb and pb are the frequencies of alleles a, a, b and b, respectively. values for r <dig> were obtained using the software provided by r pong-wong  which implements an em algorithm  <cit>  to estimate haplotype frequencies. to enable a clear presentation of results showing ld in relation to physical distance between markers, snp pairs were divided into three distance classes:   <dig> to 2 mb,   <dig> to 5 mb and   <dig> to 50 mb. distance bins of  <dig> ,  <dig>  and  <dig>  mb were used for classes ,  and , respectively, and average r <dig> values for each bin were plotted against physical distance. also, in order to determine the background ld , r <dig> was calculated for a random selection of non-syntenic snps that included  <dig> snps per autosome, following khatkar et al.  <cit> . thus,  <dig>  pairwise independent correlations were computed.

estimation of ne across time from ld
the well known relationship between ld and ne was derived by sved  <cit>  and it was based on the work of hill and robertson  <cit> . however, sved’s equation did account neither mutation nor the effect of sample size. the consequence of ignoring mutation is that even with physical linkage, the expected association between loci is incomplete and leads to an underestimation of r <dig>  this effect increases as historical time increases. the consequence of ignoring sample size is that the magnitude of r <dig> can be overestimated in samples of small size as a consequence of spurious associations. this effect increases as historical time decreases  <cit> . taking into account both mutation and sample size leads to a more general expression: er2=α+4nec−1+1/n where α is a parameter related to mutation, c is the recombination rate and the term 1/n is an adjustment for sample size  <cit> . note that 4ne corresponds to the slope and α to the intercept of the regression equation. parameter α can be set to a fixed value   <cit>  but can also be estimated from the data. when haplotypes are unknown , n equals the number of diploid individuals sampled   <cit> , whereas when haplotypes are known without error n equals 2n  <cit> . here, the effect of correcting for mutation and sample size was investigated by comparing results from six different models that varied in α and 1/n as shown in table  <dig> table  <dig> description of the statistical models assumed to estimate n
e based on ld

six different models differing in mutation and sample size adjustments are indicated


n number of individuals



for predicting ne at any generation in the past, we have to consider r <dig> between snp pairs at a specific linkage distance in morgans . this distance yields a prediction of the time since the gametes are expected to have coalesced 1/ generations ago  <cit> . thus, net=4d−1rd2−n−1−1−α where ne is the effective population size t generations ago and rd <dig> is the mean value of r <dig> for markers d morgans apart. based on this equation a non-linear least squares approach was implemented to statistically model the observed r <dig>  with the aim to avoid dependence between ld and linkage distance estimated from the same data, we used estimates of recombination rates for each chromosome from a different study in the same species. specifically, we used estimates from tourtereau et al.  <cit>  who described a high density recombination map for the pig using the porcine snp <dig> beadchip. they built this map using information from four independent pedigrees coming from f <dig> crosses involving five breeds . therefore, for each snp pair in ld separated by a particular physical distance , an equivalent linkage distance  was calculated as the product of the recombination rate for a particular chromosome obtained from tourtereau et al.  <cit>  and the physical distance.

we investigated the evolution of ne across the period between  <dig>  and  <dig> , a period comprising  <dig> generations. to estimate ne at the time of the foundation of the herd  from the relationship between t and d, we had to consider snp pairs at a linkage distance of approximately  <dig>  morgans which in this population corresponded to  <dig>  mb. in the same way, to calculate the ne at the present, the corresponding physical distance between the snp pairs corresponded approximately to 66 mb. however, non-syntenic levels of ld might be taken into account, as they are not a function of the distance. otherwise ne estimates will be biased. in particular, the maximum distance between snp pairs that can provide informative estimates of ne needs to be lower than the distance determining non-syntenic levels of ld. in addition, to ensure that sufficient snp pairwise comparisons are available to obtain estimates of r <dig> with acceptable precision, we used a maximum distance between snps of 15 mb , which translated into  <dig> generations in the past.

we segmented the interval between  <dig>  and  <dig>  mb into  <dig> distance categories  and performed an equivalent number of regressions to estimate ne at different times. we applied this procedure on each of the six scenarios differing in mutation and sample size adjustments and on each of the six replicates.

RESULTS
estimation of ne across time from pedigree data
figure  <dig> shows estimates of long-term contributions and ne obtained from pedigree data. the estimated ne at the time where the herd was founded  <dig> generations ago was  <dig> individuals. after that, the value for ne slightly increased across generations up to six generations ago, when a decrease of 40 % in ne was observed. the average generation interval estimated from long-term contributions was approximately three years.fig.  <dig> individual long-term contributions  and estimates of effective population size  based on those contributions. long-term contributions for each individual to the last generation obtained from pedigree information  and estimates of n
e obtained from individual contributions plotted against generations in the past . each dot in  represents the contribution of one individual born ‘x’ generations ago to the last generation. for instance, the circled dot represents the contribution of an individual born one generation ago  to the last generation 



these estimates were used as the reference estimates with which to compare the corresponding ne obtained from ld measures under the different models assumed. in this way, the molecular estimates that better fit the pedigree estimates will determine the best model of adjustment.

ld estimates
the average r <dig> between adjacent snp was  <dig>   and the mean distance between adjacent snp was  <dig>  kb. figure  <dig> represents the decline in r <dig> between syntenic snp pairs  with increasing distance. the average r <dig> for snps at distances between  <dig>  and  <dig>  mb was  <dig> . the most rapid decline in r <dig> was observed at marker distances lower than  <dig>  mb where r <dig> decreased by more than half. table  <dig> summarizes the average r <dig> for each autosome for different categories of distances between markers up to  <dig>  mb. the average r <dig> was reduced to non-syntenic levels  at distances greater than  <dig>  mb.fig.  <dig> average linkage disequilibrium plotted against distance between snps. average linkage disequilibrium  measured as r
 <dig> and the 5th and 95th percentiles  plotted against the average of the distance bin range . to enable a clear presentation of results, distances between snp pairs were divided into three distance ranges:   <dig> to 2 mb,   <dig> to 5 mb and   <dig> to 50 mb. distance bins of  <dig> ,  <dig>  and  <dig>  mb were used for classes ,  and , respectively, and average r
 <dig> values pooled over autosomes for each bin were plotted against physical distance


chr chromosome


n
snp number of snps



estimation of ne across time from ld
figure  <dig> shows estimates of ne based on ld for the time period elapsed between the foundation of the herd and the present, for the six models assumed and for the six temporal replicates. each point in the graphs corresponds to the result of a non-linear regression for a specific physical distance category, as previously explained.fig.  <dig> estimates of effective population size  based on linkage disequilibrium plotted against generations in the past. estimates of n
e obtained from linkage disequilibrium measures for the six temporal replicates  estimating  or fixing α to  <dig>  and ignoring  or accounting  for the sampling effect. the term 1/n is the adjustment for sample size



in general, average values of ne across replicates at the time of the foundation of the herd were lower when α was estimated than when it was fixed. standard deviations of the ne estimate across replicates were higher in models where α was fixed . all scenarios analyzed provided estimates significantly different from zero for both α  and ne. with the exception of model c , models where α was estimated from the data led to ne estimates that slightly increased from the time of the foundation of the herd to approximately six generations ago, when a decline occurred. models where α was fixed to  <dig> led to ne estimates that decreased progressively across generations . the molecular ne estimates closest to pedigree-based estimates were those obtained under the model where  the parameter α was estimated; and  a correction of 1/2n for sample size was imposed .fig.  <dig> comparison of estimates of effective population size  based on linkage disequilibrium with those based on pedigree data, averaged across replicates. average ld-based n
e estimates across replicates  compared to pedigree-based estimates . estimates based on ld were obtained estimating  or fixing α to  <dig>  and ignoring  or accounting  for the sampling effect. the term 1/n is the adjustment for sample size



discussion
in this study we have evaluated the applicability of the ld method when using genome-wide information for estimating ne in an experimental population of iberian pigs where generations overlap. we took advantage of having a complete and accurate pedigree dataset available, a situation that is very rare in practice. this allowed us to obtain precise pedigree-based estimates of ne that were considered as a baseline against which to compare ld-based ne estimates. the approach allowed us to determine the most suitable statistical model of adjustment when the ld method is used for species with overlapping generations. this is in a context of conserved populations of small ne for which genetic methods perform better because the signal  is the largest  <cit> . the ld-based ne estimates closest to pedigree-based estimates were those obtained under model b, that adjusted the values of r <dig> for sample size using the 1/2n correction and estimated α from the data . the novel use of contiguous generations as temporal replicates made also possible to determine the error of the estimates and confirmed the applicability of the method. the study represents thus an advance towards the use of the ld method to estimate ne in species where generations overlap.

we have investigated for the first time the effect of different sample size corrections under the new context of having available genome-wide information and efficient analytical methods to predict r <dig> from unphased data. in theory, under a two-locus model, the 1/2n correction should only be applied when haplotypes are known without error; otherwise the correction to be used is 1/n  <cit> . in the particular case of the guadyerbas strain, the inbreeding rate is high  <cit> . in fact, both the amount and the extension of ld were much higher than those observed in other pig breeds . a priori, the fact that high levels of inbreeding have been detected in this population would imply that the number of double heterozygotes  is low. thus, the distinction of gametic phases might be relatively straightforward when using accurate algorithms such as the em algorithm. also, the 1/n correction would probably be too strong under a scenario of small population size. in summary, model b seems to be the most appropriate model to apply in small populations with overlapping generations when high dense snp data are used.

another important issue to consider when applying the ld method is the coalescence time. coalescence theory predicts that the expected time for coalescence of a sample of gametes is < 4ne generations. therefore, estimates of ne more than 4ne generations in the past may be questionable. although this corresponds to  <dig> generations in this study, our interest was to go back to the time of the foundation of the herd  as this is the period of time for which pedigree-based estimates can be obtained and compared with ld-based estimates. molecular estimates of ne under the more suitable model  showed that ne slightly increased for  <dig> generations from the time of the foundation of the herd. after  <dig> generations ne suffered a strong reduction due to a well-documented disease outbreak experienced in the herd. this result was in agreement with the pedigree-based ne and validates the accuracy of the method to predict population decline for populations of small ne, as suggested in previous studies  <cit> .

previous studies have questioned the precision of ne at recent generations  <cit> . this precision can be influenced by  the effect of non-syntenic ld, that conditions the maximum distance between snp pairs to compute informative r <dig> measures, and by  the availability of sufficient snp pair comparisons when the distance between snps is very high. the basal levels of non-syntenic ld  were higher  than those reported for other livestock species such as cattle  and horses , and for other pig breeds . our results of non-syntenic levels of ld were equivalent to ld levels between syntenic snps separated >  <dig>  mb, which had not impact on our calculations of recent ne. however, computation of ne for the last five generations would not be adequate because there are not enough snp pairwise correlations to ensure a high accuracy.

specific corrections for considering overlapping generations have been suggested for different demographic and genetic methods  <cit>  but not for the ld method. however, simulation studies have shown that levels of ld in samples including a number of consecutive cohorts equal to the generation length should provide accurate estimates of per-generation ne for populations with overlapping generations  <cit> . our results validate this argument.

CONCLUSIONS
early detection of population decline is a crucial issue to prevent extinctions by implementing management actions  that reduce extinction risks. the maintenance of large ne and the associated genetic variation is also important in terms of evolution, because loss of genetic variation affects the adaptation capability of a population. this highlights the importance of using accurate genetic estimators of ne in populations where pedigree and/or demographic data are not available. our results showed that, when using genome-wide information currently available, the ld method is accurate and broadly applicable to populations with small ne even for species with overlapping generations.

additional file
additional file 1: 
example of calculation of long-term contributions. 



competing interests

the authors declare that they have no competing interests.

authors’ contributions

bv supervised the work. bv, at and jw conceived the design of the study. ms performed the analyses and wrote the first draft of the manuscript. af assisted with the data analysis. all authors discussed the results, made suggestions and corrections. all authors read and approved the final manuscript.

