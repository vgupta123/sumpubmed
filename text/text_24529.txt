BACKGROUND
allergy is a form of hypersensitivity to normally innocuous substances, such as dust, pollen, foods or drugs. allergies are more common in industrialized countries and in urban populations than in agricultural countries and in rural populations  <cit> . allergens are small antigens that commonly provoke an ige antibody response. such antigens normally enter the body at very low doses by diffusion across mucosal surfaces, triggering a th <dig> response  <cit> . the allergen-specific th <dig> cells drive allergen-specific b cells to produce ige, which binds to the high-affinity surface receptor fcεri, present on mast cells, basophils, and activated eosinophils. on activation, these cells release stored mediators, which in turn give rise to inflammation and tissue damage causing a variety of symptoms. inhalant allergens induce rhinitis, conjunctivitis and asthmatic symptoms, while food allergens lead to abdominal pain, bloating, vomiting and diarrhea. food allergens rarely cause respiratory reactions and inhalant allergens seldom affect the gut  <cit> .

relatively few proteins act as allergens. allergen proteins contain both t-cell epitopes capable of inducing th2-type responses and b-cell epitopes to which ige can bind. allergens are also often proteins or glycoproteins with enzymatic activity, are resistant to proteolysis in the gut, are exceptionally heat stable, and are thought to be ovoid in shape  <cit> . recently, it was found that allergen proteins have no or few bacterial homologues, in contrast to randomly selected control non-antigen proteins  <cit> .

although there is no consensus allergen structure, the food and agriculture organization  and the world health organization  have produce codex alimentarius guidelines for evaluating the potential allergenicity of novel proteins  <cit> . according to these guidelines, a query protein is potentially allergenic if it has either an identity of  <dig> to  <dig> contiguous amino acids or greater than 35% sequence similarity over a window of  <dig> amino acids when compared with known allergens.

currently, there are two types of bioinformatics-based allergen prediction. the first approach follows fao/who guidelines and searches for sequence similarity. the structural database of allergenic proteins  <cit> , allermatch  <cit>  and allertool  <cit>  all contain extensive databases of known allergen proteins and use them in sequence searches of query protein. despite the high sensitivity ) of these methods, they are known to produce many false positives and have low precision or positive predictive value ). additionally, the discovery of novel antigens will be restricted by their lack of similarity to known allergens.

the second approach is based on identifying conserved allergenicity-related linear motifs. stadler and stadler defined  <dig> allergen motifs by comparing allergens to non-allergens using meme  <cit> . li et al. identified allergenic motifs by clustering known allergens, followed by wavelet analysis, and hidden markov model  profile preparation of each identified motif  <cit> . björklund et al. developed a detection method with used an automated selection of allergen-representative peptides  protocol  <cit> . algpred is a server for allergenic protein prediction which combines four methods for motif search: support vector machines , meme/mast, ige epitopes and allergen-representative peptides   <cit> . both approaches assume that allergenicity is a linearly coded property.

apart from t-cell epitopes able to induce th2-type responses, allergen proteins must contain b-cell epitopes to which ige can bind  <cit> . b-cell epitopes are discontinuous, conformational epitopes, arranged on the protein surface. furmonaviciene et al. have defined allergen-specific patches consisting of an unusually high proportion of surface-exposed hydrophobic residues  <cit> . this finding is in a good agreement with the notion that the innate immune system has evolved to detect hydrophobic portions of immunogenic proteins comprising strings of aliphatic or aromatic amino acids  <cit> .

obviously, allergenicity, like antigenicity or immunogenicity, is a property encoded within a sequence in a subtle and possibly concealed manner: thus alignment-based approaches may not be able to detect properties, such as allergenicity, in an unambiguous manner. here, we describe an alignment-independent method based on the auto- and cross-covariance  transformation of protein sequences into uniform, equal-length vectors. acc is an protein sequence analysis method developed by wold and colleagues  <cit> , which has been applied to quantitative structure-activity relationships  studies of peptides with different length  <cit> , and for protein classification  <cit> . this method was used to identify immunoprotective proteins from various microbial organisms, including bacteria, viruses, parasites and fungi, as well as tumours  <cit> . the acc transformation accounts for neighbour effects, i.e. the lack of independence between different sequence positions.

in the present study, we applied acc pre-processing to sets of known allergens with different origins and routes of exposure, developing alignment-independent models for allergen recognition based on the main chemical properties of amino acid sequences. a mirror set of non-allergens was compiled from the same species. the principal properties of the  <dig> biogenic amino acids are represented by z descriptors, originally derived by hellberg et al.  <cit> . they describe amino acid hydrophobicity, molecular size and polarity. five machine learning methods  were applied to discriminate between allergens and non-allergens. the best performing models were implemented in a server for allergen prediction, named allertop. it is freely accessible via the world wide web at: http://www.pharmfac.net/allertop. the methodology described below is the first alignment-free bioinformatics tool for in silico identification of allergens. additionally, it is able to predict their route of exposure: food, inhalant or toxin.

RESULTS
alignment-free presentation of the protein sequences
a set of  <dig> food,  <dig>  inhalant and  <dig> toxin  allergens was collected from several databases as described in methods. a set of non-allergens from the same species were selected using a blast search tailored to mirror the allergen set. non-allergens were selected as proteins with no sequence identity to known allergens, at an e-value of  <dig> .

twenty two of the food allergens were also toxins,  <dig> food allergens were also inhalant and  <dig> inhalant allergens were also toxins. the total set of proteins consisted of  <dig>  allergens and  <dig>  non-allergens.

the allergens and non-allergens were compared in terms of amino acid composition and main physico-chemical properties, including number of residues, molecular weight, extinction coefficient, iso-electric point, net charge at ph  <dig>  and estimated water solubility. data are given as additional file  <dig>  on this basis, no significant differences between allergens and non-allergens exist.

for the 5-fold cross-validation , each subset was divided randomly into  <dig> training  and  <dig> test  sets. training sets were used to derive the models, while test sets were used to validate them. the total set was also divided into  <dig> training  and  <dig> test  sets.

the amino acids in the protein sequences were described by three z-descriptors . the descriptor z <dig> reflects the hydrophobicity of amino acids, the descriptor z <dig> reflects their size, and the descriptor z <dig> their polarity. the proteins were transformed into uniform vectors as described in methods. each protein was represented by a vector of  <dig> variables.

choice of a method for allergen prediction
five supervised machine learning methods were applied separately to the subsets and to the total training set to derive models for allergen prediction. the models were validated by the corresponding test sets. the methods used in the study were discriminant analysis by partial least squares , logistic regression , decision tree , naïve bayes  and k nearest neighbours  with k =  <dig> 

the performance of the derived models was assessed by 5cv using sensitivity, specificity and positive predictive value  and f-measure  at threshold  <dig> , and area under roc curve  . in all cases, the best performing model was knn.

further, knn models with different k values were derived and tested by 5cv to find the best k value. the results are shown in figure  <dig>  as k increases, the specificity of prediction slightly increases, while sensitivity, f <dig> and auc decrease slightly, and ppv does not change. the optimal value for k was found to be  <dig> 

cross comparative analysis of the models
models were validated using the corresponding test sets . additionally, cross comparative analysis was applied: the food allergen model was tested on inhalant and toxin test sets; the inhalant model was tested on food and toxin test sets; and the toxin model was tested on food and inhalant test sets.

the results showed that the route of exposure of the test set had no significant effect on specificity, but sensitivity is clearly dependent on it. the low sensitivities of food and inhalant models cross tested on the corresponding test sets is in a good agreement with the observation that food allergens rarely cause respiratory reactions and inhalant allergens rarely affect the gut  <cit> . however, a good correlation exists between inhalant and toxin models. such a correlation has not been observed before. one possible explanation could be the great number of common allergens between inhalant and toxin sets:  <dig> inhalant allergens are also toxins.

allertop server
the model based on the total set of allergens and non-allergens derived by the knn algorithm with k =  <dig> and 5-fold cross-validated was made freely accessible via a server, named allertop. allertop is implemented in python, with a gui written in html. protein sequences are uploaded in plain format. the results page returns the allergen status: "probable allergen" or "probable non-allergen". it also returns the k nearest neighbours in the training set. on this basis, allertop defines the most probable route of exposure of tested proteins predicted as an allergen. the allertop server also contains the datasets used in this study.

the performance of allertop was compared to the freely available web servers using the total set of  <dig>  allergens and  <dig>  non-allergens . the servers accessible by the time of evaluations  were allerhunter  <cit>  and algpred  <cit> . a short description of these servers is given in methods. allerhunter did not recognize  <dig> proteins because they are shorter than  <dig> amino acids. algpred did not recognize  <dig> proteins because they are shorter than  <dig> amino acids. algpred uses four different algorithms. the best performing of them is algpred arp and only it was considered in the comparison. servers were compared in terms of sensitivity, specificity and f <dig> after 5cv. ppv is not applicable because of differences in the number of tested proteins. auc also is not used as there is no option to change threshold in algpred and allerhunter.

the highest sensitivity was achieved by allertop , followed by allerhunter  and algpred arp . algpred arp has the highest specificity , closely followed by allerhunter  and allertop . measuring f <dig>  allertop has the highest value , then allerhunter  and algpred arp . additionally, allertop gave the most balanced predictions.

discussion
because of the high current incidence of allergenicity, with serious outcomes in many cases, the accurate prediction of allergenicity for new proteins originating from genetically modified crops or developed as protein drugs is crucial. allergenicity is not straightforward to predict using alignment-based methods, since it is a phenomenon mediated by specific ige antibodies requiring the presence of non-linear  b-cell epitopes in allergens. here, we apply an alignment-independent method for protein presentation based on the main physicochemical properties of proteins that seeks to circumvent such issues. our method uses z-descriptors to represent amino acids in the protein sequences, and an acc transformation for conversion of protein sequences into uniform vectors.

in this paper, five well known and widely used methods of supervised machine learning were tested to discriminate between allergens and non-allergens. one of them  has been used before to predict food protein allergenicity  <cit> ; the other four  are, to the best of our knowledge, applied for the first time to allergenicity prediction. da-pls has been used to predict immugenicity  <cit> . lr is a type of regression which delivers a class variable. dt is a tree-like graph of decisions which predicts a class outcome. the nb classifier assumes that the presence or absence of a particular structure descriptor is unrelated to the presence or absence of any other descriptor and derives an outcome based on maximum similarity. in the present study, the knn clustering method had the best performance among the other algorithms for classification. the knn algorithm was optimized and its performance was compared to other web servers for allergenicity prediction. the algorithm was implemented as a web server, freely accessible via http://www.pharmfac.net/allertop.

allergens can enter the body via different routes: gut, respiratory system, skin, blood. the route of exposure determines the type and location of the atopic reaction: food allergens rarely cause respiratory reactions and inhalant allergens seldom affect the gut  <cit> . this observation is consistent with the results of our analysis. the food allergen-based model does not predict inhalant and toxin allergens. however, because of the many commonalities amongst allergens, some with multiple routes of exposure, the inhalant allergen-based model predicts toxins well and vise versa, the toxin model predicts inhalant allergens well. the knn method allows us to predict the route of exposure with some certainty, based on the routes of exposure of the three nearest neighbours amongst known allergens.

the comparison of allertop to other state-of-the-art servers for allergenicity prediction shows slight differences in their ability to distinguish between allergens and non-allergens. the high sensitivity of allertop could be explained by its ability to identify new allergens, structurally diverse when compared to known allergens. the comparatively low specificity of allertop may be due to the restricted number of non-allergens used to train the algorithm. since non-allergenicity is often assumed rather than proven experimentally, other methods may be over-trained, possibly missing many putative allergens; and so our use of more conservative data-sets, and the lower concomitant specificity, is potentially a strength rather than a weakness. moreover, the combined application of several methods for allergenicity prediction is able to achieve a successful prediction in the range of  <dig> - 100%.

CONCLUSIONS
an alignment-free method for in silico prediction of allergens based on the main physicochemical properties of proteins was developed. the method uses z-descriptors to represent amino acids in the protein sequences, and an acc transformation for conversion of proteins into uniform vectors. the knn clustering method showed the best performance among the other algorithms for classification tested in this study. the knn algorithm was optimized and its performance was compared to the other web servers for allergenicity prediction. the algorithm was implemented on a web server, named allertop, freely accessible via http://www.pharmfac.net/allertop. apart from allergenicity, allertop is able to predict the route of exposure of the allergen of interest.

