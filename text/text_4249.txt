BACKGROUND
protein binding and docking
proteins often associate with other proteins to create complexes that function as a biological unit. these complexes play a central role in nearly every cellular process  <cit> . since the structure and function of proteins are closely related, detection of protein complexes and their structures helps us understand their role in various important biological processes.

despite the advance in experimental structure detection methods, elucidating the three-dimensional arrangement of protein complexes is still a very challenging process. computational methods have become very useful in complementing and helping experimental structure detection methods. computational docking methods try to predict the way two or more proteins bind. they are typically made of two stages: the search stage uses structural and geometric techniques to detect native-like configurations of the complex, and the ranking stage uses a scoring function made of physico-chemical and geometric filters to estimate the binding affinity and rank computed structures according to energetic criteria. these functions typically focus on electrostatic, van der waals, and solvent interactions, similarity to experimental structures, or agreement with other experimental data  <cit> .

multimeric docking
in nature many proteins interact to generate multimers containing more than two monomeric units, but most docking and refinement methods only focus on dimeric structures due to the possible exponential increase in the already large search space, posed by the addition of monomers. due to the additional increase in complexity, in the case of multimeric docking it is especially important to carefully select the search and ranking methods. only a small number methods exist for docking more than two monomers. these methods attempt to make the search for the correct docking configuration tractable by focusing on symmetric complexes  <cit>  or by extending pairwise solutions via combinatorially assembling monomers incrementally, using greedy heuristics to cut down the search space such as selecting only a subset of the complexes of size k and pass them to the next stage as candidates to search for a complex of size k +  <dig>  or generating pairwise docking results and expanding them using a minimum spanning tree  <cit> .

docking refinement
the results generated by computational docking methods are expected to be low-energy structures that are similar to the native complex structures. however, computational docking methods are not complete. the energetic difference between the native structure and other non-native complexes may be small and the scoring function used by docking methods is often not sensitive enough to detect it. additionally, the correct binding site is not always known experimentally and docking methods may miss the correct binding site completely. as a result, low-energy structures produced by docking programs often disagree with nmr data  <cit> . recent capri  rounds show an important observation: even the most accurate methods predict only about 50% of the targets  <cit> . a survey of various scoring functions showed that although some components in several scoring functions have meaningful individual components, none of these functions could predict the binding affinity reliably  <cit> . therefore, the results of computational docking methods need to be further refined in order to obtain native-like structures. usage of refinement methods on protein complexes is not limited to computational docking methods; structures obtained by experimental methods can also be refined. docking algorithms often produce a large number of putative complexes, ranked according to some scoring function. docking refinement methods refine and re-rank these complexes in order to produce improved structures with lower energy and better interface packing. the goal is to improve both the rmsd and the ranking of the solution closest to the native structure. refinement methods are often based on a combination of geometric and energetic optimization. existing methods include rigid body transformations with side chain flexibility  <cit> , flexible fitting that accounts for the changes proteins undergo upon binding  <cit> , normal-mode analysis  <cit> , molecular dynamics   <cit> , energy minimization  <cit> , monte carlo   <cit> , genetic algorithms  <cit>  and more.

refinement and re-ranking using conservation and electrostatics
we recently developed a docking refinement method that uses a scoring function based on evolutionary conservation  <cit> , in addition to the usual vdw energy term. it employs a novel evolutionary trace -based  <cit>  conservation scoring function. evolutionary traces are based on the idea that residues on functional interfaces are important for correct binding, and are therefore more likely to be conserved. we showed a strong correlation between conservation scores and the correct binding geometry when tested on dimeric protein structures. our method biases the search towards conformations which have those conserved amino acids positioned close to each other on the binding interface. the scoring function iteratively detects top-scoring transformations at each stage of the refinement and passes them to the next stage for further refinement. we use a greedy selection approach to avoid exponential growth of the number of candidate complexes and speed up the computation time. we showed that the method can significantly improve docking results and also help distinguishing badly docked complexes from near-native complexes.

more recently we extended our refinement method to multimeric protein structures  <cit> . biasing the search towards functional interface greatly reduces the search space, which is especially important in the case of multimeric complexes. we also incorporated electrostatic interaction energy to improve the accuracy of our prediction and provide a greater diversity of the selected conformations. the search iteratively selects two monomers out of the complex, and they are refined with respect to each other. out of the newly refined candidates, top ranking conformations with respect to energy are passed on to the next stage for further refinement. in that work we also introduced a new probabilistic search scheme, which allows a greater variety in the selection of complexes and enables the method to escape possible local minima. we showed that our refinement method significantly improved the geometry of the input complexes and achieved lower lrmsd with respect to the native complexes.

in the current work we introduce an improved scoring function which aims to eliminate the bias created by the conservation score towards large interfaces. as input, we use coarsely docked complexes resulting from a multimeric docking program, multi-lzerd  <cit> . we tested our refinement method on a large dataset of both dimeric and multimeric complexes. in most cases, there are several results among the top ranking complexes with better lrmsd than the input structure. this shows the potential of our method to serve as an efficient tool to improve the geometry and interface packing of coarsely docked complexes.

methods
our program takes as input a protein complex generated by any docking method. the refinement proceeds in cycles where each cycle seeks to improve the conformation of one unit  with respect to the other ones. for each input structure, we create  <dig> conformations using rigid-body rotations by a random angle within a predefined range around an arbitrary axis passing through the centroid of the unit. each rotation results in a new conformation and these randomly generated conformations are first energy minimized for  <dig> steps using namd  <cit>  to resolve local clashes without introducing drastic changes to the structure, then ranked using both a conservation scoring function and an electrostatic scoring function. after creating probability distributions based on conservation and electrostatic ranking,  <dig> conformations are selected according to the probabilistic selection scheme described below and provided as inputs for the following refinement cycle.

creating multimeric protein structures
the coarsely docked multimers used in this paper were produced using multi-lzerd  <cit>  without the refinement module. we selected coarsely docked complexes whose distance to the native complexes was between  <dig> and 6Å, to allow effective refinement and not attempt to refine incorrectly docked complexes whose rmsd from the native structure was too big to refine.

we refine multimeric protein structures by creating conformations as described in the flowchart at figure  <dig>  we first create a set of units to refine, r . in the beginning each chain is considered a separate unit. we then do a pairwise interface comparison and pick the two units, ci and cj , in r that share the largest interface . next, we rotate cj around an arbitrary axis passing through its centroid by a random angle between - <dig> and  <dig> degrees . afterwards, we merge ci and cj into a combined unit , remove ci and cj from r  and add the new combined unit to r . this process repeats until r has a single combined unit that contains all the chains of the protein. by combining the units we achieve two important benefits:  we refine chains or chain lists in the order that leads to the largest interface, and  we avoid impairing previously refined chains.

scoring function
the scoring function that we aim to optimize is computed for the set of interface atoms, which is defined, for each chain, as the atoms within at most  <dig> Å distance to an atom from an adjacent chain. in our previous work  <cit> , we employed a scoring function consisting of the van der waals term taken from the amber ff <dig> force field  <cit>  and the conservation term that we defined using et scores of each interface residue.

for each interface atom, we defined the evolutionary conservation value, ci, as the relative importance of the residue that the atom belongs to. relative importance of a residue is specified in the coverage column of the corresponding et files for each protein chain. the coverage value ranges between  <dig> and  <dig>  where low coverage implies evolutionary importance.

the conservation term of our interface scoring function was then defined as in eq. , where ci and cj are the conservation values for the interface atom pair i and j. in this manner, each interface atom i on one unit and interface atom j on the other unit are considered in computing the conservation term.

  econservation= ∑i,jci*cj 

by experiments on several protein complexes we have previously shown  <cit>  that the proposed conservation term had strong correlations with least rmds  values. therefore, we defined the scoring function based on conservation  as in eq. . minimized van der waals term, ev dw was added to eliminate structures with clashing atoms.

  etc=evdw+econservation 

through experiments on different protein complexes, we showed in  <cit>  that the scoring function defined in eq.  proves useful also in refining multimeric protein complexes. on the other hand, we also identified that for some docked protein complexes the conservation-based scoring function does not show a strong correlation with lrmsd values. yet the interface electrostatic energy, taken from the amber ff <dig> force field  <cit> , is highly correlated with lrmsd values for those complexes. therefore, we defined another scoring function based on electrostatic  as in eq. . similar to eq. , ev dw is added to eliminate structures with steric clashes. below we explain how to use these two scoring functions in combination.

  ete=evdw+eelectrostatic 

probabilistic selection of conformations
we rank our refinement candidates using the above mentioned scoring function and select a subset of them as the refinement output. in our previous work  <cit> , we ranked random conformations according to etc values and selected the  <dig> top ranked conformations.

deterministic selection increased the likelihood of false positives because we selected only top 1%  of conformations in a multi cycle refinement process. the scoring function rarely correlates perfectly with lrmsd values and is only a model of the "true" potential energy. also, it increased our chances of getting trapped in a local minimum. in order to address this limitation, we employ a probabilistic selection approach detailed below, which we first introduced in  <cit> .

the conformations are sorted in ascending order using the scoring functions defined in eq.  and eq.  and create two different probability distributions based on etc and ete values as in table  <dig>  we then randomly select  <dig> conformations according to the conservation score probability distribution and  <dig> conformations according to the electrostatic score probability distribution. the cumulative probability of selecting the top 10% conformations is about 70%, which allows lower energy conformations to be selected more often. in the future we will experiment with different selection probabilities and their effect on the results. we will also try to distinguish between complexes whose geometry correlates better with etc and those that correlate better with ete, as it appears that they represent different types of interface interactions.

after the conformations are sorted in ascending order according to etc and ete, their selection probability depending on the number of generated conformations  is assigned as described above. the relative probability is with respect to a conformation in the top 1% to be selected.

test set
in order to test our multimeric refinement method, we used docked dimeric structures provided by shehu et al.  <cit>  with the following pdb ids: 1bdj, 1c1y, 1cse, 1ds <dig>  1ohz, 1tx <dig> and 1wq <dig>  in addition to these dimers, we produced multimeric input structures by running the multi-lzerd multimeric docking program without refinement  <cit>  for protein complexes with the following pdb ids: 1i3o, 1jyo, 1log, 1qgw, 1vcb, 1w <dig>  1www, 2bbk, 2prg and 6rlx. some of these proteins are trimers or tetramers that we used before as dimers only  <cit> , while others are popular test cases  <cit> .

for each input docked structure, the refinement is performed iteratively in  <dig> steps. in the first step,  <dig> random conformations are generated from the input structure as described in section. these  <dig> conformations are ranked using the two scoring functions and  <dig> conformations are selected according to our selection function . in the second step,  <dig> new random conformations are created for each of the  <dig> conformations produced in the first step. then, these  <dig> new conformations are ranked using the scoring functions and  <dig> conformations are selected and output as refined candidate complexes.

RESULTS
refinement results of our program for dimeric and multimeric complexes are shown in table  <dig> and table  <dig>  respectively. in addition, several examples of the docked input, refined and native structures are depicted in figures  <dig>   <dig>   <dig>   <dig> for visual comparison. as seen, in most cases there are several structures among the top ranking complexes with better lrmsd than the input structure. in some cases, such as 1ohz and 1wq <dig>  the improvement is significant - over 35%, and all resulting structures are very close to the native complex. the difference is more noticeable in the case of dimers and it can be seen in figures  <dig>   <dig>   <dig>   <dig>  in the case of multimers, even though the lrmsd difference between the input and refined structure is not big, in many cases the interface difference is rather noticeable . even though the organization of the input and refined structures are similar to one another and to the native structure, the interface of refined structure resembles the native structure more. this shows the potential of our method to serve as an efficient tool to improve the geometry and interface packing of coarsely docked complexes.

least rmsd values in Å with respect to the native structure are shown for the initial docked structure and ten best refinement results generated by our method for each input.

least rmsd values in Å with respect to the native structure are shown for the initial docked structure and ten best refinement results generated by our method for each input.

on the other hand, the refinement performance is not alike across different proteins. even though our method yields better solutions than the input structure for all dimeric and some multimeric complexes, the magnitude of improvement varies from protein to protein. indeed, there are some complexes, such as 1vcb, for which our solutions are not better than the input structure. we believe it is crucial to better understand what causes this performance difference in order to further improve our refinement method. as explained earlier, our method relies on the observation that residues on binding interfaces tend to be more conserved throughout the evolution due to their functional importance. therefore, the conservation energy component of our scoring function is designed to favor complexes with more conserved residues on interfaces. stated differently, structures with more clusters of conserved residues on interfaces are expected to have lower conservation energy and lower lrmsds with respect to the native structure. on the other hand, the electrostatic energy component of the scoring function is devised to prefer complexes with lower electrostatic energy based on the assumption that native-like structures have better electrostatic interactions.

however, knowing that for some proteins, refinement results are not as good as the input structure, we performed an in-depth correlation analysis of the different scoring function components and the lrmsd to the native structure to assess our performace. for this purpose we define icar as the ratio of conserved atoms on interfaces to the total interface size. we measured the following magnitudes:  the ratio of conserved atoms on interfaces  vs. lrmsd;  etc vs. lrmsd;  icar vs. etc ; and  ete vs. lrmsd. ideally, icar would have strong negative correlation with lrmsd and etc , while etc and ete would both have strong positive correlation with lrmsd, since near-native complexes are assumed to have lower energy. to perform this correlation analysis, we generated  <dig> random conformations for each docked input structure and investigated how each of these magnitudes changed with respect to one another. to calculate icar, we assumed a residue is conserved if its et coverage value is lower than the following threshold, where µ is the mean of et coverage values of residues in the chain, and σ is the standard deviation of et coverage values of residues in the chain.

  threshold=μ-σ* <dig>  

the results of the correlation analysis are summarized in table  <dig>  several points in particular are worth highlighting. first of all, icar vs. etc correlation is almost always negative . this confirms that our conservation scoring function correctly favors structures with more clusters of conserved atoms on interfaces as intended.

secondly, icar exhibits a strongly negative correlation with lrmsd correlation in most, but not all cases.

this suggests that there are cases, such as 1log and 6rlx, where structures with a large proportion of conserved interface atoms are less native-like, contrary to our underlying hypothesis. whenever icar vs. lrmsd correlation is strong negative , etc shows a strong positive correlation with lrmsd as expected. in other words, structures that are closer to the native have lower conservation energy. on the other hand, when icar vs lrmsd is not a strong negative correlation, the conservation score is not able to favor low lrmsd structures, again as expected.

lastly, there are certain cases where etc does not show a positive correlation with lrmsd  but we are able to obtain better lrmsd structures. this is due to the positive ete vs lrmsd correlation in these cases. this is the reason we intentionally did not mix etc and ete into a single energy function as also explained in our previous work  <cit> . the results in this paper reaffirms that observation, which suggests that we may be able to group input structures into one of two categories and employ a scoring function  selectively. this is the subject of ongoing research.

for input structures like 1log and 2bbk, we could not select better lrmsd structures even though etc or ete had relatively strong correlation with lrmsd. analyzing them further uncovers that out of  <dig> through small-scale random conformations produced for 2bbk only  <dig> had lower or same lrmsd as the input. in fact, our scoring function was able to select one of them. similarly, out of  <dig> random conformations produced for 1log only  <dig> had lower or same lrmsd as the input. hence, this is either a statistical matter or generation of random conformations could have been improved to address this issue , which can be considered in future work.

CONCLUSIONS
proteins interact to create complexes as part of their cellular function. modeling the structure of these complexes is highly important in order to understand these processes. here we present a refinement and re-ranking algorithm to improve the structures of coarsely docked multimeric complexes. many protein complexes contain more than two monomers, but the vast majority of docking and refinement algorithms can only handle dimers due to the increased computational cost which causes a potential exponential increase in the runtime. our method uses a geometry-based local search and a scoring function that is based on evolutionary conservation and pairwise interactions, relying on the observation that amino acids on binding interfaces tend to be highly conserved due to their important role. this scoring function allows us to bias our refinement scheme towards potential functional interfaces, reducing the large search space and improving the geometry and energy of the input structures. we introduced a probabilistic search scheme that allows us to escape local energy minima and enhance the diversity of selected structures. future work includes testing our method on a larger dataset and incorporate backbone and sidechain flexibility into the search. additionally, we plan to further investigate the difference between complexes which give better conservation score and complexes with better electrostatic energy, in order to establish an automated way to distinguish between them during the refinement process. finally, we aim to incorporate the refinement method in a larger framework which also includes docking of multimeric complexes given only monomeric structures.

competing interests
the authors declare that they have no competing interests.

authors' contributions
b. akbal-delibas conducted the research. n. haspel supervised the research. both authors co-wrote the paper.

