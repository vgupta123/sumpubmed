BACKGROUND
there are now a large number of completely sequenced genomes of bacteria and archaea that can be used to study evolution at the whole-genome level. comparison of sets of genes across genomes reveals that gene content varies quite substantially between even fairly closely related species. for example, the number of genes in a typical genome of escherichia coli and shigella is around  <dig>  but when  <dig> of these genomes are compared, there are only around  <dig> ‘core’ genes found in all genomes  <cit> . similar results are found with streptococcus <cit>  and prochlorococcus <cit> . when diverse groups of genomes are compared, the set of core genes falls to very low numbers. it was estimated that the ‘extended core’ of bacterial genes  contained only  <dig> genes  <cit> . a study aimed at constructing a universal phylogenetic tree  <cit>  found only  <dig> genes present as clear orthologues in all genomes.

these studies also show that newly sequenced genomes almost always contain genes that have no detectable homologues in existing genomes. the size of the pan-genome  increases rapidly with the number of genomes studied, and it is often believed that the pan-genome would increase indefinitely if new genomes continued to be added to the data. rapid gain and loss of genes during genome evolution has important consequences. at the small scale, gain and loss of a few specific genes can explain why some microbial strains are pathogenic and close relatives are not. at the large scale, rapid changes in gene content make the use of phylogenetic methods for bacteria and archaea difficult, and given that genes can also be transferred horizontally between unrelated organisms, the very existence of an evolutionary tree for bacteria and archaea is questionable  <cit> . our aim in this paper is therefore to use quantitative comparative methods across a wide range of genomes in order to better understand the processes giving rise to change in gene content.

gene duplication has long been recognized as a mechanism by which organisms adapt  <cit> . a duplicate copy of an existing gene can be maintained in the genome if it evolves a new or more specialized function, or it can be lost through pseudogenization and eventual gene deletion. families of two or more paralogous genes are common in most genomes, which testifies to the important role played by gene duplication in expansion of genome size and acquisition of new functional genes. gene families can also arise by evolutionary innovation within a genome, e.g. a new open reading frame could form within a non-coding region, or an existing gene could undergo sequence divergence, insertions/deletions or domain reshuffling to such an extent that it would no longer be classed as part of its original family. the insertion of genes via horizontal gene transfer is also an important mechanism of change in gene content. this could start a new gene family if the recipient genome did not already contain a homologous sequence, or it could add to an existing family.

the relationships among sets of genes within and across genomes are potentially very complex. similar sequences can arise by speciation , duplication  or horizontal transfer . disentangling these alternatives would be difficult without manual sequence analysis of each case, and would then be somewhat subjective. in this paper, we deliberately want to keep sequence analysis methods as simple as possible. therefore, we use simple objective criteria based on blast to cluster genes into related groups. the procedure is automated and easily reproducible, and can be repeated many times with different clustering parameters in order to check the sensitivity of the outcome. the procedure does not assign detailed evolutionary relationships among the sequences in each cluster, although it assumes that all sequences in a cluster are descended from a common ancestor by one means or another.

gene clusters contain genes from one or more genomes. for each cluster, let k be the number of genomes that contain at least one gene from this cluster. an important quantity is g, the number of clusters that contain genes from k genomes. this is sometimes called the gene frequency spectrum. g has been measured in several experimental data sets  <cit> , and shows a u-shaped distribution, with many genes present in only a small number of genomes, a moderate number of core genes present in  all genomes, and fewer genes at intermediate values of k. modelling the distribution of clusters across genomes is complex because it depends on the branching process that generates the sample of genomes, as well as on the processes of gain and loss of genes from a given genome. we are only aware of one theoretical model that attempts to explain this shape  <cit> .

we will use ‘family’ to denote a group of genes from one genome that are within one cluster. the mean size of families in a cluster, , is usually between  <dig> and  <dig>  but there are a significant number of clusters with  as large as  <dig> or more. we show that gene clusters that are more widely spread across genomes tend to have larger gene families. however, clusters with very high  are found at both low and high values of k. we also analyze the data by genomes. we define  as the mean family size within a genome. this is again between  <dig> and  <dig>  but there are a significant number of families as large as  <dig> or more in most genomes. we show that  and the proportion of large families increase with the size of the genome.

previous studies have shown that f, defined as the number of families of n genes in one genome, is distributed approximately as a power law  <cit> , with most families found as singletons and only a few families with large numbers of genes. a number of mathematical models have been constructed to explain this  <cit> . it is substantially easier to model f than g because it only depends on gain and loss of genes from one genome. these models are formulated in different ways. while there is as yet no consensus on the minimal processes needed to reproduce the gene family size distributions observed in bacteria and archaea, there are signs that heterogeneity of evolutionary rates among gene families  may be required to explain the shapes of these distributions  <cit> . here we infer the presence of multiple classes of genes in the genomes of bacteria and archaea using a birth, death, and innovation model  <cit> . each class represents a set of genes with a different ratio of duplication to deletion rates, perhaps due to the effects of natural selection.

methods
clustering
complete nucleic acid and translated proteome sequences were obtained from the ncbi genomes database for  <dig> bacteria from over a dozen phyla , sequenced as part of the genomic encyclopedia of bacteria and archaea  <cit> , and  <dig> archaea . genes encoded on plasmids associated with each genome sequence were also included, and were treated as part of the genome. blast databases were created for each genome with all amino acid sequences encoded by each genome, and all-against-all searches were performed using blastp . for each pair of genomes, each inter- and intra-genome peptide sequence was used as a query against every other peptide sequence. a direct link was counted between two genes if both blast e-values were less than a specified cutoff value, ecut, and if the length of the locally aligned region found by blast was longer than a fraction fmin of the length of both sequences. sequences were grouped into clusters using the single-link cluster procedure, i.e. sequences are part of the same cluster if there is a direct link between them or if there is a chain of direct links that connects them. these clustering methods, similar to those used by ncbi's blastclust program, were implemented with custom perl scripts that are available from the authors.

definitions
for each cluster, let g be the number of genes in the cluster and let k be the number of genomes that contain at least one gene from this cluster. the mean family size in the cluster is defined as . let g be the number of clusters that contain genes from k genomes. the total number of clusters is  and the mean number of genomes contributing to each cluster is . the number of clusters that contain genes from one genome only is g. these are ‘orfans’ with no detectable homologues in other genomes. the number of clusters that have at least one gene in every genome is gcore.

for each genome, let ngenes be the total number of genes in the genome, and let ftot be the total number of families with at least one gene in that genome. the mean family size in the genome is . let f be the number of families of n genes in a genome. it follows that , and . it is of interest to consider the number of single gene families f and the number of large  families, .

quantitative models to predict the distribution of gene family sizes
in this section we describe mathematical models to predict the number of gene families in one genome. we will use lower case f to indicate the predictions of the model and upper case f to indicate the observed data. we will use maximum likelihood methods to fit f to f as closely as possible.

we consider a birth and death process in which the number of genes can increase or decrease by one gene at a time. let λn be the rate of transition from n to n +  <dig>  and let δn be the rate of transition from n to n –  <dig>  these rates are defined for n ≥  <dig>  the total number of families is not fixed. let there be a rate u of innovation of new gene families with n =  <dig>  which could occur via de novo origin of a gene within a genome or by acquisition of a gene by horizontal transfer. this is assumed to be independent of the number of families already present in the genome. families are lost if a deletion occurs in a single gene family, which occurs at rate δ1f. in the stationary state, the rates of gain and loss of families are equal; hence   

in the stationary state, the rate of change from n to n –  <dig> balances the rate of the reverse change. therefore, fδn = fλn– <dig>  from which we obtain   

the basic model that we will use in this paper will be termed bdi <dig>  where bdi denotes birth, death and innovation. this is similar to models proposed by karev et al.  <cit>  and wòjtowicz and tiuryn  <cit> . it is supposed that there is a constant duplication rate λ and a constant deletion rate δ per gene, so that the birth and death rates are λn = nλ and δn = nδ. from eq. , the stationary distribution for model bdi <dig> is   

where  is the ratio of duplication to deletion rates. it is useful to define the function   

the total number of families can then be written as   

and the mean family size can be written as   

fig.  <dig> shows  as a function of r. this is close to  <dig> for small r and diverges as r approaches  <dig>  note that the total number of families is proportional to u, but the shape of the distribution and the value of  depend only on r and not on u. the optimal value of r can be estimated by maximum likelihood methods, as follows.

the proportion of families that are expected to have n genes according to the model is   

this result has also been given by wòjtowicz and tiuryn  <cit> . the logarithm of the likelihood of observing the data according to the model is   

to find r for each data set, we used the nelder-mead optimization method in r  <cit>  to find the maximum value of lnl. it can be shown by substituting the qn from eq.  and taking the derivative  that the maximum likelihood solution for r is such that the mean family size, , given by the model ) is equal to the mean family size in the data, ngenes/ftot. once r is known, it is possible to choose u/δ so as to make the total number of families predicted by the model ) equal to the observed number, ftot.

in summary, the bdi <dig> model has two independent parameters, r and u/δ. these parameters can be chosen so that the mean family size and the total number of families are exactly equal to their values in the data. having done this, there are no further parameters to adjust the shape of the distribution. it will be shown that the shape is not fitted well by the bdi <dig> model, so we consider several more general models in the following section.

more general models
we define model bdik such that there are k classes of genes, each of which behaves as model bdi <dig>  each class, k, has an independent value of rk. the frequency of families in the genome in class k is ξk, and these frequencies must sum to  <dig>  model bdik thus has 2k –  <dig> free parameters. the stationary qn distribution for model bdik is   

a multi-class model of this form has also been considered by wòjtowicz and tiuryn  <cit> . a more general birth, death and innovation model  proposed by karev et al.  <cit>  is defined such that λn = λ; δn = δ. it is straightforward to obtain   

for n >  <dig>  and q <dig> can be obtained by normalizing the distribution. this model has three relevant parameters for the shape: r, a, and b. a particular case of this model is where r =  <dig>  this has been called the second-order balanced model by karev et al.  <cit> . note that the distribution still converges when r =  <dig>  provided b >a. in this case it can be shown that the distribution is approximately a power law, qn ~ n– for large n.

as it has been argued  <cit>  that data of this type can be well represented by a power law, we further consider the simple power law distribution   

where the exponent γ is the only free parameter.

RESULTS
properties of gene clusters and families
properties of clusters generated using different values of ecut and fmin are shown for the bacteria and archaea data sets in tables  <dig> and  <dig>  although we changed the ecut values by many orders of magnitude and varied the minimum length criterion considerably, the most important properties of the clusters did not change very much. in the bacteria, the total number of clusters gtot decreased by about a factor of two from the most stringent to the least stringent clustering criteria. the number of core clusters, gcore, increased as the stringency of clustering was reduced, and was always much less than gtot. in each case, g was large and thus orfan clusters comprised a relatively large fraction of gtot . the majority of clusters were only found in a small number of genomes, so that  was small .

properties of the family size distribution also varied to some extent with clustering parameters, although the main points do not depend on the choice of parameters. the quantities ftot, f, flarge, and  were calculated for each genome and the figures shown are averages over genomes. the majority of families were single gene families, i.e. f was close to ftot, and  was less than  <dig> for all choices of the clustering parameters. however, there were significant numbers of large families in all cases, even for the most stringent clustering parameters. this confirms that some genes are indeed frequently duplicated, and large families are not simply an artifact of the clustering technique. the final column of tables  <dig> and  <dig>  nmax, is the number of genes in the largest family in any one genome. although the precise value of nmax depends on the clustering parameters, it is always very much larger than  <dig>  thus the f distribution contains a tail of large families that is very different from typical families of only  <dig> or  <dig> genes.

the results for the archaea were similar to those for bacteria. the parasitic species nanoarchaeum equitans has a genome size less than half the size of any of the other archaea, and the presence of this species significantly affected the clustering statistics. therefore the results quoted in table  <dig> were calculated for  <dig> archaea excluding n. equitans.

variation of gene family size with genome size
for the more detailed analysis in the remainder of the paper, we used one representative set of clustering parameters: ecut = 1e- <dig>  fmin =  <dig> . the genomes in the two data sets vary in terms of the number of genes they encode. the range in archaea is 536– <dig> genes and in bacteria, it is 1353– <dig> genes. we wished to determine whether there were any variations in the family size distribution correlated with the number of genes. the mean family size per genome  displayed a significant increasing trend with ngenes , with archaea having a significantly greater slope  than bacteria . by definition , so ftot also increases with ngenes, but slightly less than linearly, as shown in fig. 2b. there was no difference between the number of large gene families in archaea compared to similarly-sized bacteria . the fraction of large gene families flarge/ftot increases with ftot and tends towards a plateau at 2-3% for large genomes . the x–intercept is at about  <dig> families, suggesting a minimum threshold genome size below which large gene families are absent or very rare.

archaea typically have smaller genomes than bacteria, but in both taxonomic groups larger genomes tend to have larger gene families. this is not bound to be the case, it could simply have been that larger genomes had a larger total number of families and that the mean family size stayed the same. the fact that the mean family size increases with genome size means that gene duplication plays a significant role in the evolution of genome size. the steeper slope in mean family size within the archaea may indicate that gene duplication plays a somewhat more prominent role in genome expansion than in bacteria, or that archaea preferentially discard duplicate genes during genome contraction. in both bacteria and archaea, genome size is influenced both by innovation of new families and by duplication of genes within a family.

relationship between gene family size and the number of genomes in which the family is found
as defined in the methods section, k is the number of genomes that have at least one gene in a given cluster, and g is the number of clusters that contain genes from k genomes. the g distributions are shown for bacteria and archaea in figures  <dig> and  <dig>  as expected, these are u-shaped distributions with large numbers of clusters in only one or a small number of genomes, fewer clusters with intermediate k, and a substantial number in all or almost all genomes. the peak of core genes on the right of the u is relatively small in both datasets because the genomes are very diverse and there are few core genes. we intend to investigate the factors determining the shape of g in more detail in future work. however, at this point, we wish to focus on the relationship between the mean family size, , within each cluster and the number of genomes, k, in which the cluster is found.

in figures  <dig> and  <dig> we plot  as a function of k for the representative data sets. each point represents one cluster. for the smaller k there are many points superimposed, as the  values are always rational fractions. the solid line shows the average  for all clusters with the same k. in both cases, this shows a steady increase from very slightly more than  <dig> for k =  <dig>  to about  <dig> for the core clusters. we conclude that almost all orfan genes are in single gene families, but genes that are present in larger numbers of genomes have a greater probability to be part of multi-gene families in a given genome, i.e. more widespread genes are more likely to be duplicated. nevertheless, the mean  is only around  <dig> or less, even for large k, which means that there are many core genes that also exist as single gene families.

it is clear from looking at the points for the individual clusters in figures  <dig> and  <dig> that there are some clusters with  values much larger than the mean. these unusual clusters are found both at high and low k. clusters with high k and high  are presumably core clusters containing large gene families in all genomes, whereas clusters with low k and high  are probably the result of recent rapid duplication within a closely related group of genomes. to investigate this in more detail, we looked at the annotation of the genes in the clusters with large . additional file  <dig>  table  <dig> and additional file  <dig>  table  <dig> list the clusters with the largest  in bacteria and archaea. the most frequent genbank annotation of the genes in each cluster is given in the tables. it was found that the core cluster with the maximum  consisted of genes annotated as abc transporters in both cases. abc transporters have a wide range of related functions and are known to be widespread in many genomes  <cit> . we found that there were many separate clusters in our analysis that contained genes annotated as abc transporters, covering a wide range of substrate specificities. these genes are rapidly evolving and duplicating and appear to be diversifying fast enough to cause the initiation of many new clusters of sequences that are not grouped together according to the criteria we used for clustering.

additional file  <dig>  table  <dig> and additional file  <dig>  table  <dig> also show the high  genes that were present in only a single genome. it was found that many of these genes were transposable elements. as these genes are not widely distributed, we presume they have arisen recently and are duplicating rapidly due to their own transposase activity, even if they are not beneficial to the organism. this contrasts with genes like the abc transporters, that may not be duplicating particularly rapidly, but which are presumably maintained in the genome in multiple copies because of their beneficial function to the organism. it also appears that there are a few specific genomes in which highly-duplicated, highly-localized genes are over-represented, e.g. among the bacteria, haliangium ochraceum dsm  <dig> and bacillus tusciae dsm  <dig>  and within the archaea, methanospirillum hungatei jf- <dig> and sulfolobus solfataricus p <dig>  in the case of haliangium ochraceum, one of the largest genomes we investigated , many copies of a cluster of  <dig> orfan genes are concentrated into a small region of the genome, flanked variously by mobile elements like transposases and prophage-associated genes, possibly indicating recent duplication events that are out of equilibrium with the rest of the genome.

family size distributions
the quantitative models defined in the methods section were fitted to the data using numerical methods to optimize lnl. figure  <dig> shows the mean f distribution for the bacteria and the archaea and the fits of the various models. model bdi <dig> gave a poor fit to the data, overestimating the frequency of families in the range 2- <dig> and underestimating the frequency of large families by many orders of magnitude. models bdi <dig> and bdi <dig> gave much better fits; hence it is clearly useful to introduce more than one class of gene. the fit for bdi <dig> appeared very similar to bdi <dig> and is not shown. the generalized model, gbdi, fit noticeably better than bdi <dig>  but still considerably underestimated the frequency of large families. the power-law fit performed similarly to models bdi <dig> and bdi <dig> at the least restrictive clustering parameters but provided poorer fits as clustering became more strict.

to select the best fitting model in a more principled way, akaike’s information criterion  was used  <cit> . this is defined as aic =  <dig>  the model with the smallest aic is to be preferred because it has a high likelihood without over-fitting the data. the aic can be applied when fitting each genome individually because the families in one genome are assumed to be independent. however, it cannot be applied to fitting the mean data because families from the same cluster in different genomes are phylogenetically related and are not independent. we applied the aic analysis to each of the genomes in each of the two sets separately. model bdi <dig> was the best fitting model for 85% of the  <dig> bacteria genomes under each of the  <dig> clustering regimes. model bdi <dig> was substantially worse, fitting best in only 8% of cases. model bdi <dig> was never the best fitting model for any of the bacteria, nor was the gbdi model. a simple power law was occasionally the best fit . model bdi <dig> was always a poor choice by aic, indicating that the four-class model was over-fitting the data.

the  <dig> archaeal genomes were most commonly fit best by model bdi <dig> , which was selected much more frequently than bdi <dig> . only the reduced genome of n. equitans was ever best fit by bdi <dig>  model bdi <dig> was very rarely the best fit for archaea; gbdi was never the best fit. a simple power law was the best fit for a number of archaea .

having established that the preferred model is bdi <dig>  we show the fitted parameters for this model in tables  <dig> and  <dig> for bacteria and archaea, respectively. the column fbdi <dig> shows the fraction of the individual genomes for which the bdi <dig> model was the preferred model according to aic. the ξk and rk columns show the best fit parameters to the average f for all the genomes in each set. during the fitting procedure, the r values were constrained so that r <dig> <r <dig> <r <dig>  the fitted parameters were qualitatively similar independent of clustering parameters chosen or dataset examined. there is always a large fraction of genes in class 1: ξ <dig> is between  <dig> and 85% in bacteria. the corresponding values of r <dig> are around  <dig> . from fig.  <dig> it can be seen that n is very close to  <dig> in this range of r. thus, these genes are almost always in single-gene families. class  <dig> genes have frequency between 14% and 25%, with r <dig> in the range  <dig> – <dig> . the corresponding n is between  <dig>  and  <dig>  these genes are also usually in fairly small families. only 1–3% of genes fall in class  <dig>  and these have r <dig> =  <dig>  or greater, which corresponds to n around  <dig> or larger. the conclusions for archaea are similar to those for bacteria, although the mean value of r <dig> is lower than for bacteria, indicating that the largest families are not quite so large.

from these results, it can be seen that in order to explain the large number of single-gene families seen in the data, it is necessary to have a large fraction of genes with relatively small values of r. if r is small, the probability of generating very large gene families is very low. this is the reason why model bdi <dig> cannot fit the data with only a single class of genes. the data contains a significant number of large gene families. the fitting procedure shows that this is best explained by having a fairly small fraction of genes with an r that is substantially larger than that for the majority of genes.

as the sizes of genomes differ within each data set, we wish to look at the f distributions in individual genomes. for both the bacteria and archaea, we chose the smallest and largest genomes and a third genome with size close to the median. figure  <dig> show the data and the fits to model bdi <dig> for each of these genomes. the two large size genomes both contain many large families with n ≥  <dig>  the two medium-sized genomes each contain a handful of large families. the smallest bacterium in our data, atopobíum parυulum, with  <dig> genes, contains one family of  <dig> and one of  <dig>  with the rest being  <dig> or fewer. the smallest archaeon, n. equitans, with only  <dig> genes contains no families with n >  <dig>  these show that there are significant differences among organisms in the distribution of family sizes. large families are rare or absent in small genomes.

discussion and 
CONCLUSIONS
the aspect of our data that has previously been studied most frequently is the distribution of family sizes within one genome, f. it was shown by huynen and van nimwegen  <cit>  that this distribution has a tail of large families that dies away slowly with n; hence it resembles a power law rather than an exponential. this has since been confirmed by many authors and several mathematical models have been proposed to explain it. there are three qualitatively different explanations:  family sizes are in constant expansion;  the distribution is stationary and second-order balanced;  the distribution is stationary and there are multiple classes of genes. we will compare these explanations and explain why we favour case .

by ‘stationary’ we mean that the number of families of any given size is not varying with time on average in any one genome. this can occur in the models used here if r <  <dig>  i.e. if duplication is less frequent than deletion. under these circumstances, families do not grow indefinitely and are bound to become extinct eventually. the rate of innovation of new families balances the extinction rate. in contrast, if duplication is more frequent than deletion, then both the total number of genes per genome and the number of genes in individual families increase with time. the models of yanai et al.  <cit> , qian et al.  <cit>  and kamal et al.  <cit>  are examples of explanation . these show that if family sizes are in constant expansion, then the shape of f can converge to a power law after the expansion process has been in operation for some time. however, there is considerable variation in genome sizes in the data, and genomes can increase or decrease in size relatively easily over the time scale of diversification of bacteria and archaea. there are many examples of parasitic or endosymbiotic microbes whose genomes have reduced in size in comparison to their closest free-living relatives. it can also be seen from figure  <dig> that genomes of different sizes have different family size distributions. our interpretation is that duplication and deletion rates vary among species. if these rates change along an evolutionary lineage, it will take some time for the family size distribution to come into equilibrium with the new parameters. if we fit a stationary model to data from different genomes, we are assuming that there has been sufficient time for each genome to reach a different equilibrium. this seems reasonable, given that rates of gene gain and loss have been estimated as very high  <cit> , and it seems closer to the truth than the assumption that there is a constant rate of non-stationary expansion.

explanation  is illustrated by the gbdi model ). this model was not a particularly good fit to our data, but we wish to make a few comments about the parameters that emerged when fitting this model. it was found that the value of r converged to  <dig> and the value of a converged to  <dig> for every genome analyzed . thus b was the only remaining parameter in the fit. the case r =  <dig> is the second-order balanced model of karev et al.  <cit> , and it is known that the stationary distribution is close to a power law in this case. nevertheless, we do not find this model very appealing, because it is not intuitively clear why the ratio of insertions to deletions should be tuned exactly to  <dig> in every case. also, it is not easy to interpret what the fitting parameters a and b mean biologically.

in contrast, the bdi models depend on parameters u, λ and δ that have a simple biological interpretation. the distribution for the basic bdi <dig> model does not resemble a power law, but when different classes of genes are included with different ratios of duplication to deletion, the model fits the data well. this is explanation  for the family size distribution. the simple power law model ) was included in our analysis as a null model because it has only one parameter, but according to aic, model bdi <dig> was a better fit in the majority of cases. the existence of several classes of genes with different rate parameters has also been observed by wòjtowicz and tiuryn  <cit>  and hughes and liberies  <cit> .

although we found a minimum of three gene classes were necessary to fit the genomic data, in reality the number of classes could approach the total number of families in a genome. the fact that different types of genes in a genome should have different duplication and deletion rates seems intuitively reasonable because these rates depend on selection. a duplication or deletion arising in an individual cell could be beneficial, neutral or deleterious, and this will influence the likelihood of this variant becoming widespread. selection parameters are unlikely to be the same for every gene family in the genome.

when fitting the bdi models, we can only estimate the ratio λ/δ, and not the two separate rates. self-replicating elements provide one mechanism by which a gene family can be preferentially duplicated over another and thus affect λ. a high-r class can then represent both self-replicating  and useful  gene families. likewise, low-r classes can represent deleterious  gene families, neutral or ‘junk’ gene families having rapid turnover rates, and core or ‘essential’ gene families for which the loss of the last member is fatal to the organism.

while gene function is not expected to correspond explicitly with the gene classes described above, we might expect some association between functional category and class. for example, genes involved in transcriptional regulation may be found more frequently in multi-gene  families because they can be utilized repeatedly throughout the genome, whereas genes involved in specialized metabolic functions may be found more frequently in single-gene  families. observations from comparative genomics support this prediction. molina and van nimwegen  <cit>  found that the abundance of protein domains associated with ‘regulation of transcription’ scaled quadratically with total number of domains in a genome, whereas ‘metabolic process’ domains scaled less than linearly. in general, different functional categories of genes, each composed of numerous gene families, have been found to vary in representation within genomes and follow scaling laws which may  <cit>  or may not  <cit>  differ by lineage.

we note that wòjtowicz and tiuryn  <cit>  have considered an extra process, occurring at rate κ, in which an existing gene mutates to a new kind of gene; thus one family is reduced in size by one and a new family of size one is initiated at the same time. the result of this is that the distribution has the same shape, but depends on the ratio λ/, instead of λ/δ. this is interesting theoretically, but as we can only measure the ratio from the stationary distribution, it is not helpful to add κ to the model.

the next step in analysis of data of this type would be to look at the dynamics of the processes generating the patterns of gene copy numbers across species on a phylogenetic tree. this removes some of the redundancy in parameters, and may allow more detailed conclusions about the mechanisms of gene family evolution than can be obtained from stationary family size distributions. several models of this type have been investigated  <cit>  and we intend to continue on these lines. however, the κ process would be difficult to consider in a phylogenetic model because it would mean that changes in copy numbers in different families would not be independent of one another.

there are several aspects of our data that go beyond the family size distribution, and these have been studied less frequently by other authors. one of these is the so-called gene frequency spectrum, g, which is the number of clusters with one or more genes in k genomes. this is usually plotted for orthologues only, in which case there is either  <dig> or  <dig> gene per genome in the cluster. in our case, we included paralogues in the same cluster. this does not alter the shape of the distribution very much. there is still a u shape with a large peak at k =  <dig> and a smaller peak of core genes in all genomes. the infinitely-many genes model, introduced by baumdicker et al.  <cit> , predicts the shape of the spectrum under the assumption that each type of gene is introduced into the set of genomes only once, that it can spread to new genomes as the lineages of genomes divide, and that it can then be deleted independently from any genomes. this model qualitatively explains the u-shaped distribution, and we are currently developing models of this type in order to more quantitatively fit the g distribution in our data. baumdicker et al.  <cit>  assume that the genealogical tree relating the genomes in the sample can be described by a coalescent tree, which is what we would expect for neutral evolution within a species. it is not yet clear whether this can be applied to describe the gene frequency spectrum across species , as the tree arising from speciation may not resemble a coalescent tree. a quantity related to g is the distribution of the total number of genes in a cluster. enright et al.  <cit>  plotted this for genes in mcl-derived clusters, and found that it was approximately a power law over quite a wide range of n. developing a good quantitative model for this would require a combination of a branching process that generates the tree of genomes and a duplication/deletion model to describe gene families in each lineage.

the mean family size can be defined in two ways: either within a cluster, , or within a genome, . comparison of  for different clusters revealed that more widespread clusters  tend to have larger families. this makes sense for genes that are beneficial. a gene that was beneficial in the genome in which it originated would remain in that genome for long enough to be duplicated and for long enough for a speciation to occur. hence beneficial genes are more likely to have both paralogues and orthologues. the converse of this argument is that genes that are not beneficial in the genome in which they arise are likely to be deleted rapidly before duplication or speciation. it thus makes sense that  is very close to  <dig> for orfan clusters with k =  <dig>  the fact that g is so large shows that there is a high rate of innovation of new gene families in individual lineages, and suggests that most of these families are not useful enough to be retained over long times.

in future work we will examine the dynamical aspects of gene family evolution to further investigate the process of gene innovation and to distinguish between innovation via evolution within a lineage and innovation via horizontal transfer from a genome outside the current data set. horizontal gene transfer  clearly plays a role in bacterial genome evolution and one of our future goals is to understand this in a quantitative way. however, the stationary distribution of genome families in individual genomes is not instructive regarding hgt because it is not possible to distinguish what fraction of the innovation rate represents origin within the lineage and what fraction represents insertion of a gene by hgt. in our model we assume that the rate of gain of additional genes in a family is proportional to the number of genes already present. interpreted as gene duplication, this means that genes in larger families are more frequently duplicated. however, this could also be interpreted as hgt if the majority of horizontal transfer events are between closely related organisms that form an effective bacterial “species” via frequent exchange of genes. in this case the number of genes in the family will be similar in all the genomes from which transfer is occurring, and the rate of gain of a gene by hgt will be proportional to the number of genes already present. along these lines, treangen and rocha  <cit>  have recently reported that the majority of the gains of additional members of multi-gene families occur by hgt rather than gene duplication. however, it is difficult to reconcile their findings with the observation that the majority of gene families are only found in a small number of genomes, which would not be the case if there were frequent repeated transfers of members of the same gene family. if there is a high diversity of genes in the pool from which genes can be gained by hgt, as suggested by the large numbers of singletons observed even in closely related organisms, then it is highly unlikely that a gene in the same gene cluster will be gained more than once. together with our forthcoming phylogeny-based model, a more careful accounting of gene gains and losses will be required to reconcile these discrepancies.

comparison of  for different genomes revealed that larger genomes have larger mean family sizes as well as larger number of families in total. this raises the question of why some genomes are larger than others among bacteria and archaea. the genomes of these organisms appear relatively streamlined, in the sense that there are relatively few non-coding regions and repetitive sequences in comparison to eukaryotic genomes. this suggests that there is a high rate of deletion of junk dna or that there is a cost to the replication of excess dna or that there is a cost to possession of genes that do not produce beneficial proteins. it is possible that larger genomes are larger because these organisms occupy niches where a more diverse set of genes is necessary or beneficial to the organism. on the other hand, it could be that larger genomes get larger simply because the rate of deletion of non-functional genes is lower in these species or because the cost of non-functional genes is less, so that the genome can tolerate a higher proportion of genes that are not beneficial. this latter explanation fits with our observation that there is a higher proportion of duplicate genes in larger genomes . in contrast, the smallest genomes contain small numbers of large gene families. this suggests that there is a rapid rate of deletion of non-beneficial genes and significant selection against retention of these genes. looking at gene gain and loss in a dynamical phylogenetic model would again help to clarify this, because one could estimate rates of gene gain and loss in different lineages.

authors' contributions
rec wrote the programs for data analysis, analyzed the data and wrote the paper. hm wrote the scripts for running blast and creating the gene clusters. pgh designed the study, developed the mathematical models and wrote the paper.

competing interests
the authors declare that they have no competing interests.

