BACKGROUND
there are many computational methods for predicting protein interactions and functional relationships . among them, two types of techniques, "phylogenetic profiling" and "similarity of phylogenetic trees", are based on the fact that interacting or functionally related proteins are co-evolving at different levels, defining co-evolution as interdependence between evolutionary histories  <cit> .

phylogenetic profiling  <cit>  is based on the intuitive idea that the genes of two functionally related protein families, which need each other to work, will tend to be both present in the same set of organisms, and probably absent together in the complementary set. a "phylogenetic profile" is a vector representing the pattern of presence/absence of a given gene in a set of organisms, eventually with quantitative information on the sequence similarity of the genes respect to that in a reference organism  <cit> . similarity between two of these vectors has been shown to be a good indicator of functional relationship between the families they represent. the similarity of presence/absence patterns between interacting proteins can be seen as a reflection of an extreme case of evolutionary dependence  since the "existence" of the proteins themselves depends on each other.

co-evolution between interacting or functionally related protein families is also reflected in their phylogenetic trees, being these more similar than expected. such similarity was first qualitatively evaluated and latter quantified for large collections of interacting and non-interacting protein pairs in order to statistically assess its relationship with interaction  <cit> . since then, this idea was applied to study many interacting families, and many groups developed different implementations and variations of the methodology . the basic mirrortree methodology for predicting whether two proteins of a given organism interact or not starts by looking for orthologs of these two sequences in a set of genomes. multiple sequence alignments are then generated for these two sets of orthologs and phylogenetic trees are obtained from them. pairwise distances are then calculated for all possible pairs of sequences in both sets. finally, the similarity between these two sets of distances is evaluated with a linear correlation coefficient, using only the distances involving organisms present in both sets. a high correlation coefficient is indicative of similar trees and hence of possible co-evolution. this co-evolutive trend points to a possible interaction or functional relationship between the proteins. this methodology has recently been fully automated and implemented in a web server which allows non-expert users to apply it starting with single sequences  <cit> . moreover, this basic methodology has been improved in many ways by different authors . for example, the background similarity expected between any pair of trees due to the underlying speciation process has been subtracted in different ways in order to improve the predictions  <cit> . more recently, networks representing the pair-wise tree similarities for all proteins in a given genome have been used to improve the prediction of interaction partners and to get insight into the substructure and functioning of macromolecular complexes  <cit> . part of this last methodology consist on representing the co-evolutionary context of a given protein by a vector containing its tree similarities  with the rest of the proteins, and then re-evaluating the eventual co-evolution between two proteins as the correlation between their corresponding vectors . in the same framework of genome-wide co-evolutions, a partial correlation study allows to separate specific from non-specific co-evolutions  <cit> . it has been shown that these two variants are better predictors of interaction than the original tree correlations.

both mirrortree and "phylogenetic profiling" use a reference set of organisms for looking for orthologs and building the phylogenetic trees or presence/absence profiles respectively. the characteristics of this set  are expected to influence the performance of these methodologies. for phylogenetic profiling, some pioneering studies addressed this problem by evaluating the effect of this reference set of genomes on the performance and range of applicability of the methodology  <cit> . nevertheless, no equivalent study has been done for mirrortree and related methodologies. in most studies, the authors use all genomes available in a given resource/database  or, in some cases, they remove redundancy at the strain level  <cit> . it is worth studying the effect of the organism set in the performance of the mirrortree-related methodologies for three main reasons: i) there could be a subset of organisms yielding better results than the whole set of available genomes; ii) different types of interactions  could be better detected using different subsets of organisms; and iii) with the growing number of completely-sequenced genomes, there will be a point in the future were it would not be possible to use all. in such case, it would be valuable to have "recipes" on which subset to use, phrased in terms of number of organisms, phylogenetic distribution, etc.

in this work we explore the effect of using different reference sets of organisms in the performance of the original mirrortree algorithm  <cit>  and two of its more recent variants: profile-correlation and context-mirror  <cit> . starting with the set of  <dig> genomes used by juan et al.  <cit> , we took different subsets sampled according with different taxonomic criteria, and evaluate the performance of these methodologies using as gold standards sets of interactions of different nature . our goal is to get insight on the influence of these factors on the co-evolutionary analyses. the results obtained allowed us to propose a number of pragmatic recipes for the use of these methodologies in terms of which subset is better for detecting each particular type of interactions, and which subset to use when the number of available sequenced genomes makes it impossible to use all. apart from the results obtained from a large scale evaluation, we also show particular examples to illustrate how using different sets of organisms can drastically affect the observed co-evolution between proteins.

methods
for comparative purposes, we used as initial set of organisms all the eubacteria and archaea that were fully sequenced and available in the integr <dig> database  <cit>  at the time when juan et al. work was performed:  <dig> genomes.  we then sampled this initial set according with different taxonomic criteria using e coli k <dig> as reference organism, and evaluated the performance of three mirrortree-related methodologies in a number of sets representing different types of interactions and using these sampled subsets of organisms as reference sets. figure  <dig> illustrates the process.

selection of different subsets of organisms
we used the ncbi taxonomic tree  <cit>  as framework for the taxonomy-based selection of organisms. this tree classifies organisms according with a pre-defined hierarchy in which the root represents "cellular organisms", the first level represents the "superkingdoms" , the next one the "phylums", and so on. this tree does not contain quantitative information on phylogenetic distances between organisms. two criteria were used for performing the selections:

• "nearest". starting from our reference organism  we follow its taxonomy back to the root of the tree and successively take all the organisms belonging to each node. so "nearest_1" represents the e coli species , "nearest_2" contains the enterobacteriaceae family , and so on up to "nearest_6" which represents the bacteria superkingdom  and "nearest_7" . four organisms are represented in the trees but not used due to the lack of information on their proteomes in the ncbi data. this sampling is designed to evaluate the effect of including close vs. distant organisms in the performance, as well as the effect of the redundancy to some extent .

• "level". the taxonomic tree is successively cut at each level of the hierarchical classification starting from the root  and one organism is taken from each resulting group. the criterion for selecting an organism within a group is simply to use that with the highest number of proteins in its genome. the rationale for doing this is to maximize the chances of finding orthologs in that genome in subsequent steps of the process. so, "level_1" would contain  <dig> organisms , "level_2" contains  <dig> organisms, one for each phylum. and so on up to "level_9" which represents the whole dataset . this experiment is designed to quantify the effect of sampling homogeneously the taxonomy at different levels of granularity .

• for comparative purposes we also included the set of genomes used in juan et al  <cit>  . this set is very similar to our "level_5" .

due to the requirement of  <dig> or more organisms in common between the trees of two protein families , some of these subsets are never used in practice. the lists of organisms in the final  <dig> subsets used, as well as representations of their taxonomic distributions, are available in the "additional file s1".

datasets of protein interactions and functional relationships
we used as gold standards to asses the methods' performance three datasets representing e. coli protein interactions of different nature and with different characteristics and peculiarities. "pathways": functional interactions inferred as co-presence in metabolic pathways taken from the ecocyc resource  <cit> . this dataset comprises  <dig>  pairs between  <dig> proteins. "complexes": physical interactions  inferred by co-presence in macromolecular complexes experimentally determined and taken also from ecocyc . "binary_phys": physical direct binary interactions obtained from the mpidb database  <cit> . these have been manually curated from the literature or imported from other databases, providing a high-confidence gold standard to evaluate putative physical direct interactions. the version we used of this database contains  <dig>  binary interactions between  <dig>  different e. coli proteins. the first two datasets were previously used by juan and co-workers  <cit> , while the last is used here for the first time.

for each dataset, a set of negative examples  is constructed by generating all possible pairs between the proteins involved in the positive  pairs.

co-evolution-based prediction of protein interactions
we applied three methods used in juan et al.  <cit>  to predict interacting pairs of proteins using the different sets of reference genomes discussed above for constructing the trees.

the starting point for all methodologies is the generation of phylogenetic trees of orthologs for all e coli proteins using the reference sets of organisms sampled as described above. for detecting the ortholog of a given e coli protein in each genome we used the "blast best bi-directional hit" criterion, with an e-value cutoff of 10e- <dig>  and requiring an alignment coverage of 70%. the orthologs found are aligned with muscle  <cit>  using the default parameters of this program. then, a phylogenetic tree is generated from this alignment using the neighbor-joining algorithm implemented in clustalw  <cit> , excluding the gaps for the distance calculation. a matrix containing the pair-wise distances between all orthologs is generated from this tree by summing the lengths of the branches separating the corresponding leaves.

the mirrortree method  evaluates the co-evolution between two proteins by calculating the linear correlation coefficient between their corresponding distance matrices. a minimum of  <dig> species in common between their trees is required for evaluating a given pair. only correlation values supported by a  p-value of 10e- <dig> or lower are considered.

a matrix containing the significant pair-wise tree correlations  for all pairs of proteins within the genome of e coli is used as input for the profile-correlation method . a row  in this matrix  contains the correlations between a given protein and all the others in the genome, and can be considered as a representation of the co-evolutionary context for that protein. the profile-correlation method re-assesses the co-evolution between two proteins by calculating the linear correlation between their respective co-evolutionary profiles. finally, the context-mirror method  assesses the influence of third proteins in a given co-evolutionary signal observed for two proteins using a partial correlation criterion. this allows separating specific co-evolution  from general co-evolutionary trends involving many proteins. so this method produces results at different "levels" of specificity. see  <cit>  for a more detailed description of these methodologies.

evaluation
for each pair of proteins in the e coli genome fulfilling the requirements mentioned above, we have the scores of the three methods  based on a given sampled subset of organisms. as commented above, for context-mirror the results are split in different levels of co-evolutionary specificity. in addition, we know whether that pair represents a true interaction or functional relationship according with the datasets described earlier. so, for each combination method/dataset/subset of organisms we have a large list of protein pairs sorted by the score of the method, being each pair labeled as "positive"  or "negative" .

we apply "receiver operating characteristic" analysis   <cit>  to these lists to assess the capacity of the method to separate the positives from the negatives. for each of these lists, the roc analysis generates a plot of "true positives rate"  against "false positives rate"  when varying the classification threshold . curves above the diagonal in this plot represent methods with some discriminative power, being this discriminative capacity better as the curve gets closer to the top-left corner of the plot. due to the requirement of  <dig> or more organisms in common in order to evaluate a given pair, the same method applied to the same interaction dataset can produce lists with very different number of pairs  when based on different subsets of organisms . in order to compare the roc curves in these cases, fpr's and tpr's are calculated respect to the total number of pairs  in the original dataset, and not respect to the number of pairs rendered by a given subset of organisms. moreover, defined in this way, these roc curves give an idea not only on the ability of the method to separate positives and negatives, but also on its range of applicability and coverage: longer curves represent methods that can be applied to  a large number of pairs, and the other way around. so, the roc curves are generated by cutting the sorted list of scores at different thresholds and plotting the resulting tpr's against fpr's calculated as

 tpr=tp∕p=sensitivityfpr=fp∕n=1-specificity 

where tp, fp and tn are the true positives, false positives and true negatives obtained at a given threshold, and p and n the total number of positive and negative pairs for that interaction dataset . note that these parameters can also be interpreted in terms of "sensitivity" and "specificity" as indicated in the formula above.

additionally, we also evaluated the results in terms of "precision", "recall" .

RESULTS
as discussed in detail in methods, for each combination method/interactions-dataset/subset-of-organisms we obtain a roc plot which represents the capacity of that method for discriminating interacting from non-interacting pairs of proteins  when using the phylogenetic trees based on that subset of organisms. figure  <dig> shows these roc plots classified by interaction dataset and method. the different curves within each of these plots correspond to the results obtained with the different organism subsets. for "context-mirror"  we show only the results for level  <dig>  which was shown to represent a good threshold of co-evolutionary specificity for predictive purposes  <cit> . while the results for other levels vary slightly in terms of accuracy/coverage, their behavior respect to the sets of organisms is virtually identical to those of level  <dig>  and hence they are not included here for the sake of clarity.

each plot in this figure has its own scale to facilitate the comparison between organism sets, which is the final goal of this work. the same figure with all plots in the same scale, which facilitates the comparison between methods, is available as "additional file 2". the same results represented in terms of f-measure vs. score are available as "additional file 3", together with an explanation of these parameters. finally, to have a single numerical estimator of the performance of a given method using the trees derived from a given set of organisms, the maximum f-measure is shown in the "additional file 4".

in the "conclusions" section, we derive some recipes for the future use of these methodologies based on the results shown here.

the most obvious observation is that all these co-evolution based methodologies are able to detect a significant number of interactions of different nature across a wide range of organism sets. this is in line with the growing evidence on the relationship between protein interactions and co-evolution, reported by many groups using diverse datasets and variations of the methodology. another evident observation is that results can vary largely depending on the set of organisms used for building the trees.

pc is the most stable methodology in the sense that its results are those with the lowest dependence on the organism set, as reflected in the highest similarity between roc curves  . it consistently renders good predictions with the highest independence on the organism set. this could be due to the fact that pc is able to filter artefactual tree-correlations such as those related to phylogenetic bias. cm is globally the best methodology and it produces the highest accuracies, but at the expense of requiring a large number of organisms: its results drastically drop off as we use datasets with low number of organisms . this effect can be easily explained by the fact that cm requires a rich network of significant inter-protein correlations in order to derive partial correlations. decreasing the number of organisms reduces the chances of obtaining correlations for many pairs , which makes such network sparser and less usable for cm. as previously reported, mt is the methodology with the worst performance and, moreover, it is severely affected by the phylogenetic redundancy in the organism set . in general, the three methods benefit from using datasets with a large number of organisms. however, for mt, this benefit reaches a point where it enters into conflict with the redundancy issue discussed above resulting in "level6"  being the optimal set. pc and cm implicitly correct phylogenetic redundancy and hence they are more benefited when from using more organisms .

another global result is that all methods predict better interactions representing co-presence in macromolecular complexes, followed by binary physical interactions, and being co-presence in metabolic pathways the relationships hardest to detect for all . within this general trend, each type of interaction seems to be better predicted by a certain set of organisms. in general, complexes are better predicted with datasets including phylogenetically distant organisms, while binary interactions and pathways are better predicted with datasets excluding distant organisms: e.g. follow "nearest5", "6" and "7" in figure  <dig> 

examples
we include some examples to illustrate this last result: how using close/distant organisms can drastically affect the predictions. table  <dig> contains examples of interactions extracted from the "binary_phys" dataset which probably correspond to "recent" interactions, as well as others extracted from "complexes" which probably are "old". the "new" interactions include physical interactions between metabolic enzymes and the interaction between two proteins involved in the division machinery: mine-mind  <cit> . the "old" interactions include some involved in the translation/transcription machinery as well as interactions between abc transporters. abc transporters are known to be very ancient systems  <cit> . the table contains the results that would have been obtained applying the pc method to these cases using as reference sets of organisms "level9"  and "nearest2" . the correlation coefficient of the pc method indicates the similarity of the co-evolutionary profiles and hence can be seen as a measure of co-evolution. as a measure of performance in detecting the right interactor, the "area under the roc curve"   <cit>  is shown. the higher this parameter, the higher are the right interactors  in the sorted list of scores . the size of the lists of scores and the number of positives are also indicated. for simplicity and to facilitate the comparison of auc values, roc curves are generated here for the positives/negatives which are in the lists, and not taking into account the total number of positives and negatives . it can be seen that "recent" interactions have higher co-evolutionary scores using the "nearest2" dataset than with "level9", and so are the respective predictive performances . exactly the opposite happens for the "ancient" interactions: higher co-evolutionary scores and performances are associated to the "level9" set. we follow in detail one of the examples to better understand this table: dpo3a_ecoli  has one reported interaction in the complexes dataset . with the trees constructed based on the "level9" set of organisms, it was possible to apply the pc method to  <dig> pairs of proteins involving the α subunit  one of which is the α-ε pair. using the "nearest2" set of organisms, it was possible to apply pc to  <dig> pairs involving dna pol iii α. the co-evolutionary score for α-ε is  <dig>  when using the "level9" set of organisms, while it drops to  <dig>  when based on "nearest2". as a consequence, there is a much higher proportion of false positives in the sorted list of pairs for "nearest2" compared to "level9" . the behavior for the "newer" interactions  is exactly the opposite.

"recent"
"old"
the co-evolution between these proteins was evaluated using the "level9" and "nearest2" sets of organisms. the total number of pairs involving each protein for which it was possible to make calculations, as well as the number of positives  are indicated. the co-evolutionary score with the interactor is also shown . for the cases for which the list contain more than one positive the score is the highest one . finally, the auc value for the list of scores is also included.

discussion
our results show that considerable differences in performance are obtained with mirrortree-based methodologies depending on the set of organisms used for building the trees. they also show that it is not always better to use as many genomes as available, as previously assumed. most of these results have plausible explanations taking into account the type of interaction and the taxonomic distribution of the organisms.

although the goal of this work is not to compare methods, but organism sets, our results on the performance of the different mirrortree variants are in agreement with previous studies  <cit> . the lower performance of the baseline mt method compared with pc and cm had been already reported and is related to the fact that these two improved methodologies are able to use the information of genome-wide co-evolutionary networks to better detect real co-evolutions as well as implicitly correct phylogenetic biases  <cit> .

the fact that, in general, all methods work better as more genomes are used is not surprising as more co-evolutive information is available for them. nevertheless, it is important to take into account the issues related to phylogenetic distances and redundancy commented below. pc and cm to some extent correct tree similarities artificially increased by the introduction of redundant genomes   <cit> . that is not the case for mt and hence this methodology is especially sensible to this and other phylogenetic biases, some of which can be corrected explicitly  <cit> . the corrections of all these phylogenetic biases implicit in pc and cm make them to be consistently benefited from using more organisms.

the fact that all methodologies render better results for permanent interactions  had been already reported  <cit> . actually, for mt and pc, the results for the binary and pathways datasets, in spite of being clearly significant and different from random, might not be of practical applicability in certain prediction scenarios . the explanation for the better predictions of complexes could be that the evolutionary pressure for co-evolving is expected to be higher in proteins forced to interact permanently than in those with occasional associations. according to these observations macromolecular complexes seem to act as "co-evolutionary units"  <cit> .

another feature of these macromolecular complexes is that, in general, they represent ancient interactions, compared to transient interactions and functional associations. for this reason, the interaction is expected to occur for all orthologs , and hence its associated co-evolutive landmark to be spread through the whole taxonomy. that would explain the observation that better results are obtained for this kind of interactions when including distant organisms within the datasets.

functional associations and transient interactions are intuitively less prone to yield strong co-evolutions, what would explain the globally lower performances associated to them. another characteristic of these associations is that, in general, they are "newer" than the macromolecular complexes. it is known that "rewiring" transient interactions is easy and relatively fast in evolutionary terms  <cit> . for this reason, it may happen that the orthologs of two proteins participating in a transient interaction in a given organism are not interacting in a relatively distant one   <cit> . if that is the case, including these "orthologs", which are not interacting and hence not subject to co-evolution, would "dilute" the co-evolutionary signal. this would explain the fact that, for these types of interactions and associations, better results are obtained when using only close organisms, since the interaction is expected to be conserved on them, while it might be absent in taxonomically distant organisms. in other words, many of the e coli pathways and transient interactions we are evaluating might be new and hence specific for this microorganism and its close neighbors, and hence the eventual co-evolutions associated to them would be apparent only in these particular genomes. interestingly, a similar relationship between the "age" of the interactions, their conservation across the taxonomy, and the resulting optimal set of organisms has been reported for the "phylogenetic profiling" method  <cit> .

in some cases it is difficult to disentangle the factors contributing to a given result, for example number of organisms vs. taxonomic criteria used for selecting them. moreover, it is difficult to quantify and numerically assess the differences of the roc curves we are using for evaluating performances. for that reason, these curves are evaluated qualitatively and the conclusions presented are based on general trends observed for many curves, instead of particular cases.

a future study aimed at obtaining more insight into the relationship between organism sets and performance should include samplings according with other taxonomic criteria , and a detailed study of the particular interactions detected and not detected in each experiment .

in the next section, we propose some recipes for the users of these methodologies derived from these results. we plan to implement some of the recipes obtained for the mt method in its recently developed web server  <cit> .

CONCLUSIONS
the number of available genomes continues to grow. and the more we know on protein interactions the more we realize that it is a very complex phenomenon with different types of interactions having different characteristics. for these reasons it is increasingly important to "tune" protein interaction prediction methodologies adapting them for each specific application, instead of using the same protocols and data sources in every situation. many methods and concepts are being built around the reported relationship between similarity of evolutionary histories  and protein interactions. for this reason it is timely to get insight into the different factors affecting such relationship. among these factors, a critical one not explored previously is the effect of the organism set used to build the trees on the behavior of these methodologies.

our results allow us to propose a set of simple and general "recipes" for users on which set of organisms to use depending on the type of interactions they want to predict and the genomic information available.

if phylogenetic trees for the whole genome of interest can be calculated , use pc and cm instead of mt. if mt has to be used  the set of organisms to use should be filtered by phylogenetic redundancy. filtering at the strain or species level seems to be enough.

pc is a sort of "all-road" method since it shows the lowest dependence on the organism set. it is the best option for general situations, when we are not sure which set of organism to use. it is also better than cm in terms of coverage and hence it is more adequate if we are interested in retrieving many interactions at the expenses of bearing more false positives. moreover, it is computationally less intensive than cm.

cm should be the chosen option when a lot of genomes  are available and we are interested in detecting a small number of interactions but highly reliable. not only it renders the best accuracy but additional information on the structure of the co-evolutionary network which offers some clues about the substructure and functioning of macromolecular complexes is obtained as well  <cit> . it has to be taken into account that its performance drops drastically when few organisms are available.

apart from that, if possible it is important to include or exclude distant organisms depending on the type of interactions we try to detect. i.e. to remove phylogenetically distant organisms if we suspect the interactions are not conserved on them .

competing interests
the authors declare that they have no competing interests.

authors' contributions
fp conceived the original idea. fp, dj and av designed the experiments. dh, do and dl implemented the idea and carried out the tests. all authors analyzed the results and contributed writing the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
list of organisms in the different subsets and representations of their taxonomic distributions.

click here for file

 additional file 2
version of the figure  <dig> with all plots in the same scale.

click here for file

 additional file 3
results of figure  <dig> given in terms of f-measure .

click here for file

 additional file 4
maximum of the f-measure curves of "additional file 3". this parameter can be regarded as a single numerical estimator of the performance of a given method/organism set, although it does not encompass all the information of a roc curve.

click here for file

 acknowledgements
we sincerely thank the members of the computational systems biology group  and profs. victor de lorenzo and miguel vicente  for interesting discussions. this work was partially funded by projects bio2009- <dig> and bio2010- <dig> from the spanish ministry for science and innovation, and project kbbe-2007-3-2- <dig> from the 7fp of the eu. dh was recipient of a "leonardo da vinci" fellowship from the eu. do is recipient a fellowship from the basque country.
