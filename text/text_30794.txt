BACKGROUND
fundamental to evolutionary biology is the development and implementation of molecular phylogenetic methods  <cit> . these methods provide the means to reconstruct the past evolutionary history of biological entities given present-day molecular data, such as dna. considering kimuraâ€™s neutral theory of molecular evolution, it is logical to apply a stochastic model at the level of dna substitutions to construct probabilistic description of what molecular alignments are expected to be observed, given a proposed evolutionary history . is commonly implemented assuming an iid  and markov process for dna substitution, leading to a model that has a continuous-time markov chain at its core .

in a series of papers, hendy and colleagues introduced the hadamard conjugation as a novel tool for phylogenetic analyses . they found an invertible relationship between a phylogenetic tree, as characterized by its edge length spectrum, and the probability distribution of site patterns . originally introduced only for the 2-state symmetric model, the hadamard conjugation was later extended to the k3st model  and further to any of the so-called â€œgroup-basedâ€ models  <cit> . hadamard conjugation has been used as both a tool for simulation  <cit>  and to look at statistical properties of methods, exploring the inconsistency of parsimony under a molecular clock  <cit> . for these sorts of applications, following the notation in felsenstein  <cit> , we can use the hadamard transform h to start with an edge length spectrum Î³ and calculate the sequence spectrum s=hâˆ’ <dig> log. the beauty of hadamard conjugations is that one can also begin with an observed sequence spectrum Å and perform the inverse of the conjugation to empirically obtain an edge length spectrum Î³^=hâˆ’1log. although it is not expected that the Î³^ spectrum will precisely match a tree, hendy  <cit>  proposed using an optimisation criterion to map from Î³^ to the â€œclosest treeâ€.

several authors have commented that it is potentially a useful feature of hadamard conjugation that data isnâ€™t forced onto a fixed tree. the conflicting information can be retained and interpreted in the form of a â€œlentoplotâ€  <cit>  or a splits-graph  <cit> , with both of these methods implemented in spectronet  <cit> . schliep  <cit>  gives some more statistical justification for such an approach by making a link to modern statistical techniques such as the lasso and ridge regression.

von haeseler and churchill  <cit>  seems to be the first paper that explicitly suggests using hadamard conjugation to provide a likelihood framework for networks. the principle idea in this work was to start with an edge length spectrum that encodes a set of incompatible splits, use the hadamard transformation to get site probabilities and use these to determine a likelihood. this idea was further explored by bryant  <cit> , and bryant  <cit>  followed this through defining the â€œn-taxon processâ€ for group-based models. it should be noted that likelihoods calculated via hadamard are not equivalent to likelihoods calculated by taking a mixture of trees. indeed, matsen and steel  <cit> , matsen et al.  <cit>  used hadamard methods in combination with phylogenetic invariants to show that mixtures of trees with the same topology can exactly mimic another tree under the 2-state model. considering biological applications, thinking in terms of mixtures of trees or partitions where the data can be thought of as arising on a set of trees  seems more reasonable than the hadamard conjugation. strimmer and moulton  <cit>  suggested using split networks as a spring board to likelihood-based analyses on dags, but later identified several problems with the approach  <cit> ; most notably, in split-networks internal nodes do not have a biological interpretation as an ancestor.

in sumner et al.  <cit> , we gave some additional insight into the interpretation of applying the hadamard conjugation in a network setting. we showed that permutation group structure inherent to the hadamard transformation â€“ as for any group-based model â€“ restricts the resulting process from being capable of reproducing truly convergent processes. this is a serious limitation, as one of the biological motivations for explicit network models is the ability to model convergent processes. we also presented an alternative algebraic formalism for the general markov model, analogous to the n-taxon process, but capable of reproducing convergent processes.

from the point of view of group representation theory, the inversion of group-based models relies on the fact that the irreducible representations of an abelian group are one-dimensional, and the model structure essentially reduces to analysing group characters â€“ hence the standard presentation of a fourier inversion. in this article, we make this connection concrete. for the general markov model, it is then immediately apparent that an analogous inversion is not possible because the algebraic structure underlying the model is not abelian and hence the irreducible representations are not one-dimensional. in fact, to obtain one-dimensional representations for the general markov model, it is necessary to apply higher-degree polynomial maps , and define â€œmarkov invariantsâ€  <cit> . these invariants present one-dimensional representations but at the cost of the higher degree â€“ degree  <dig> in the case of the general markov model with four states on quartet trees  <cit> . this connection between hadamard transformation and markov invariants is an interesting one, but we do not discuss it further here.

in this paper we approach the inversion of group-based phylogenetic models by taking a representation-theoretic perspective and working explicitly with tensor indices. our approach rests heavily on the formalism of â€œphylogenetic tensorsâ€, as presented in bashford et al.  <cit> , for the binary-symmetric and k3st model, and sumner et al.  <cit> , for the general markov model.

although the main inversion results presented here are not more general than those in in szÃ©kely et al.  <cit> , we think it is important to reformulate them using the language of tensors and representation theory. this viewpoint has already led to new approaches for modeling convergent evolution  <cit>  and for studying non-group-based models  <cit> . however, in none of our previous work was the link to hadamard conjugation explicitly discussed. by presenting an old technique  in a new light we hope to introduce other researchers to the viewpoint of tensor analysis and representation theory.

methods
group-based models
we consider the continuous-time formulation of markov processes, and show how to implement the inversion of a group-based phylogenetic model based on any abelian group g. we note that such an inversion requires a map from tensor product space  to phylogenetic splits . we achieve this by finding canonical maps from bipartitions to ordered-n-partitions.

for a group g  with order |g|=d, we write g={Ïƒ <dig> Ïƒ <dig> â€¦,Ïƒd}, and, when necessary, write Îµâˆˆg to specify the identity element of g. we will discuss the â€œregular representationâ€ of g shortly, but skipping ahead we find that any rate matrix q occurring in a group-based markov model can be written in the form
  q=âˆ’Î»1+âˆ‘Îµâ‰ ÏƒâˆˆgÎ±ÏƒkÏƒ, 

where each 0â‰¤Î±Ïƒâˆˆâ„, Î»=âˆ‘Îµâ‰ ÏƒâˆˆgÎ±Ïƒ and the kÏƒ are the permutation matrices corresponding to the  group elements Ïƒâˆˆg.

for the reader interested in deriving this result, consider the d-dimensional vector space gâ„‚â‰¡Ïƒ <dig> Ïƒ <dig> â€¦,Ïƒdâ„‚={v=v1Ïƒ1+v2Ïƒ2+â€¦+vdÏƒd:viâˆˆâ„‚}, with scalar multiplication and vector addition defined via
 v+Î»vâ€²=+Î»=Ïƒ1+Ïƒ2+â€¦+Ïƒd, 

for all v,vâ€²âˆˆâŒ©gâŒªâ„‚ and Î»âˆˆâ„‚. the regular representation,Ïreg:gâ†’gl, is then defined by setting the group action
 Ïƒ:vâ†¦Ïƒv=v1+v2+â€¦+vd,  for all vâˆˆâŒ©gâŒªâ„‚ and Ïƒâˆˆg. if we fix {Ïƒ <dig> Ïƒ <dig> â€¦,Ïƒd} as an ordered basis for âŒ©gâŒªâ„‚, it is then clear â€“ via cayleyâ€™s theorem â€“ that each group element Ïƒ gets mapped to a permutation matrix kÏƒ:=Ïreg, with kÏƒÏƒi=âˆ‘jkÏƒijÏƒj:=ÏƒÏƒi. thus kÏƒ has matrix elements
  kÏƒij= <dig> ifÏƒj=ÏƒÏƒi, <dig> otherwise. 

consider the unit column vectors
 Î¾1=t,Î¾2=t,â€¦Î¾d=t;  and identify each Ïƒiâˆˆgâ„‚ with Î¾iâˆˆâ„‚d, so that the group action becomes Ïƒ:Î¾iâ†¦kÏƒÎ¾i=Î¾j where Ïƒj=ÏƒÏƒi. thus the matrix elements kÏƒij have i as the column label and j as the row label.

a group-based markov model is then obtained by taking a continuous-time markov chain with state space g={Ïƒ <dig> Ïƒ <dig> â€¦,Ïƒd} and using the group multiplication in g to assign a rate Î±Ïƒ to all substitutions Ïƒ1â†¦Ïƒ <dig> where ÏƒÏƒ1=Ïƒ <dig>  following this through  we are led to the formula  for rate matrices in any group-based model.

the regular representation is one example of the general concept of a representation of g on a vector space v, defined as a homomorphism Ï:gâ†’gl satisfying Ï=ÏÏ for all g <dig> g2âˆˆg. a representation is said to be reducible if there exists a proper subspace uâŠ‚v satisfying ÏuâŠ‚u, i.e. the set of matrices Ï send vectors in u back to u. in this case, u is called an invariant subspace. the representation Ï is then called irreducible if v does not contain any invariant subspaces.

the reader should note that the usual construction of a â€œgroup-basedâ€ model  <cit>  stipulates that g be abelian. although the construction just given using the regular representation allows for non-abelian g, we will nonetheless only consider the abelian case in this paper, because, as discussed in the introduction, it is only in the abelian case that a  inversion of phylogenetic models is possible. in this case the irreducible representations of g are all one-dimensional  <cit> , and hence the analysis reduces to computations with group characters, as is exploited in the previous approaches using fourier analysis  <cit> .

phylogenetic tensors
we denote :={ <dig> ,â€¦,d} as the state space for a continuous-time markov chain. consider an n-taxa phylogenetic tree and a d-state phylogenetic pattern distribution {pi1i2â€¦in}i <dig> i <dig> â€¦,inâˆˆd with the interpretation that pi1i2â€¦in is the probability that the observed state at the kth leaf on the tree is ik. as is shown in sumner and jarvis  <cit>  and in more detail in sumner et al.  <cit> , such phylogenetic pattern distributions can be represented abstractly as tensors in the n-fold tensor product space âŠ—nâ„‚d:=â„‚dâŠ—â„‚dâŠ—â€¦âŠ—â„‚d, as follows. if we choose {Î¾ <dig> Î¾ <dig> â€¦,Î¾d} as an ordered basis for â„‚d, and ordered basis {Î¾i1âŠ—Î¾i2âŠ—â€¦âŠ—Î¾id}i <dig> i <dig> â€¦,inâˆˆd for the tensor product space, a â€œphylogenetic tensorâ€ pâˆˆâŠ—nâ„‚d is then defined as
 p=âˆ‘i <dig> i <dig> â€¦,inâˆˆdpi1i2â€¦inÎ¾i1âŠ—Î¾i2âŠ—â€¦âŠ—Î¾in. 

for readers who are unfamiliar with tensor products, it is possible to understand the general concept via the definition of the â€œkroneckerâ€ product of a nÃ—m matrix a and a nâ€²Ã—mâ€² matrix b as the nnâ€²Ã—mmâ€² matrix given by



we can index the matrix aâŠ—b with row indicies i1j1= <dig> ,â€¦,nnâ€² and column indices j1j2= <dig> ,â€¦,mmâ€², i.e. generically i1j <dig> i2j2=ai1i2bj1j <dig> and specifically  <dig> =a13b <dig>  this point of view is useful if one wants to write out specific matrix representations of tensors, however, in the development that follows will focus heavily on the indexing of tensor components in the various cases discussed.

suppose Ï€=âˆ‘iâˆˆdÏ€iÎ¾iâˆˆâ„‚d represents the state distribution of a single taxa, i.e. Ï€i is the probability that a randomly chosen site in the sequence will be in state i. now suppose a phylogenetic branching event occurs and the sequence is copied. the corresponding phylogenetic tensor p=âˆ‘i <dig> i2âˆˆdpi1i2Î¾i1âŠ—Î¾i <dig> representing the joint distribution of the two-taxa just after the branching event then has the property that pi1i2=Ï€i <dig> if i2=i <dig> and is zero otherwise. thinking in terms of tensor operations, we find that phylogenetic branching events can be generated by a linear operator Î´:â„‚dâ†’â„‚dâŠ—â„‚d determined by Î´=p and defined in general using our chosen basis as
 Î´:=Î¾iâŠ—Î¾i,Î´=Î´âˆ‘iÏ€iÎ¾i=âˆ‘iÏ€iÎ´=âˆ‘iÏ€iÎ¾iâŠ—Î¾i. 

the remarkable fact for group-based models, central to the present article, is that the permutation matrices â€œintertwineâ€ particularly simply with the branching operator:
 Î´=Î´)=Î¾ÏƒâŠ—Î¾Ïƒ=kÏƒâŠ—kÏƒÂ·Î´. 

thus, for any rate matrix q arising from a group-based model, we have :
  Î´Â·q=âˆ’Î»1âŠ—1+âˆ‘Îµâ‰ ÏƒâˆˆgÎ±ÏƒkÏƒâŠ—kÏƒÂ·Î´. 

we also note that, since q can be expressed a linear combination of permutation matrices representing elements in a group g, the matrix powers q <dig> q <dig> q4â€¦ will also be expressible as linear combinations of the same permutation matrices . together with , this implies that, for any substitution matrix eqt arising from matrix exponentiation,
  Î´Â·eqt=eâˆ’Î»expâˆ‘Îµâ‰ ÏƒâˆˆgÎ±ÏƒkÏƒâŠ—kÏƒÂ·Î´. 

this relation shows that mathematically, and hence conceptually, â€œmarkov evolution on a single followed by a branching eventâ€ can be replaced with â€œbranching event on a single taxon followed by  markov evolution of two taxa.â€ this equivalence is illustrated in figure  <dig>  and should be compared to the equivalent discussion of the â€œn-taxa processâ€ given in  <cit>  and  <cit> .markov evolution on a single followed by a branching event , is equivalent to a branching event on a single taxon followed by correlated markov evolution of two taxa . mathematically, this equivalence can be implemented by exploiting the equality given in .



in sumner et al.  <cit>  we showed how to generalise this intertwining action to the case of the general markov model. interestingly, for the general markov model the appropriate intertwining has quite a different structure from what occurs in group-based models, and hence the simplicity of  is somewhat misleading in general. we refer the reader to sumner et al.  <cit>  for more discussion on this point.

returning to the case of group-based models, for each subset aâŠ†, we define a linear map on âŠ—nâ„‚d as the tensor product kÏƒ:=kÏƒa1âŠ—kÏƒa2âŠ—â€¦âŠ—kÏƒan where ai= <dig> if iâˆˆa and  <dig> otherwise. for example, if n= <dig>  we have
 kÏƒ=kÏƒâŠ—kÏƒâŠ—1âŠ—kÏƒâŠ— <dig>  

to develop a phylogenetic tensor on a tree, we root the phylogenetic tree at taxon n, and label edges by subsets âˆ…â‰ eâŠ†, where iâˆˆe if the path from taxon n to taxon i crosses the edge labelled by e. a five taxon tree with this labelling, is presented in figure  <dig>  to each edge labelled by âˆ…â‰ eâŠ†, we assign the rate matrix
 qe:=âˆ’Î»e1+âˆ‘Îµâ‰ ÏƒâˆˆgÎ±eÏƒkÏƒ, figure  <dig> 
a six taxa tree rooted at taxon  <dig> with edges labelled by subsets of { <dig> , <dig> ,5}.




where each Î±eÏƒâ‰¥ <dig> is the rate of substitution for all states Ïƒ <dig> to Ïƒ <dig> satisfying Ïƒ=Ïƒ2Ïƒ1âˆ’ <dig>  and Î»e=âˆ‘ÏƒâˆˆgÎ±eÏƒ. each edge is then assigned substitution matrix me=eqe, so that the time parameter for each edge is absorbed into the definition of qe.

now iterating  multiple times, bashford et al.  <cit>  show that any phylogenetic tensor can be written as
  p=eâˆ’Î»expâˆ‘âˆ…â‰ eâŠ†nâˆ’ <dig> ÏƒâˆˆgÎ±eÏƒkÏƒÂ·Î´nâˆ’1Ï€. 

where Î»=âˆ‘âˆ…â‰ eâŠ†nâˆ’1Î»e=âˆ‘âˆ…â‰ eâŠ†nâˆ’ <dig> Îµâ‰ ÏƒâˆˆgÎ±eÏƒ, and Î´nâˆ’1Ï€ is the dÃ—dÃ—â€¦Ã—d tensor that represents the â€œzero edge-length star treeâ€ distribution on n taxa. it is this form of phylogenetic tensors that will do a lot of the heavy lifting in the discussion that follows. the reader should note that under this representation, there is no need for the edge parameters Î±eÏƒ:âˆ…â‰ eâŠ†nâˆ’ <dig> Ïƒâˆˆg to be chosen to be compatible with a particular tree, hence the possibilities for generalising to non-tree-like or network models, as discussed in the introduction.

the stationary distribution for group-based models is uniform . in this paper we always assume a stationary distribution, so that:
 Ï€=1dt, 

and Î´nâˆ’1Ï€ has tensor components
 Î´nâˆ’1Ï€i1i2â€¦in=1d,ifi1=i2=â€¦=in, <dig> otherwise. 

this concludes our discussion of the tensor presentation of phylogenetic probability distributions under group-based models. it is important to note that everything discussed so far works for any group-based model, with no requirement that the underlying group g be abelian.

in what follows, we discuss the inversion of abelian group-based models. we present the simplest case with g=â„¤2; the g=â„¤ <dig> case; the g=â„¤2Ã—â„¤ <dig> case; the general g=â„¤r case; and finally we discuss the case of any abelian group.

RESULTS
the binary-symmetric case
we begin with the inversion of the so-called â€œbinary-symmetricâ€ model. consider â„‚ <dig> with standard basis
 Î¾0= <dig> Î¾1= <dig>  

as a group-based model, the binary-symmetric model arises by taking the group
 g:=â„¤2={ <dig> }+â‰…Ïƒ|Ïƒ2=Îµ, 

with a generic rate matrix given by
 q=âˆ’111âˆ’1=âˆ’1+k, 

where k= <dig> is the permutation matrix representing Ïƒ in the standard basis.

now Ïreg:â„¤2â†’ğ•„ <dig>  with Ïƒâ†¦k, is the regular representation of â„¤ <dig>  and the character table of â„¤ <dig> given in table  <dig> is easily recognised to be the hadamard matrix
 h=111âˆ’ <dig>  table  <dig> 
the character table of
â„¤2


id
sgn


as â„¤ <dig> is an abelian group, the irreducible representations are one-dimensional.

the corresponding projection operators can be read off from the columns of the character table. that is, the operators
 Î˜id:=12Îµ+Ïƒ,Î˜sgn:=12Îµâˆ’Ïƒ; 

project Ïreg=idâŠ•sgn onto the id and sgn representations of â„¤ <dig>  respectively.

this observation prompts us to work in the alternative basis:
 f0:=Î˜idÂ·Î¾0=Î˜idÂ·Î¾1=hÎ¾0=Î¾0+Î¾ <dig> f1:=Î˜sgnÂ·Î¾0=âˆ’Î˜sgnÂ·Î¾1=hÎ¾1=Î¾0âˆ’Î¾ <dig>  

in this basis the permutation matrix is diagonal:
 k^:=hkhâˆ’1=100âˆ’ <dig> q^:=âˆ’1+k^=000âˆ’ <dig>  

the representation-theoretic perspective on k^ is to observe that id= <dig> and sgn=âˆ’ <dig> 

referring to , we know that we can write a generic phylogenetic tensor as
 p=eâˆ’Î»expâˆ‘âˆ…â‰ eâŠ†nâˆ’1Î±ekÂ·Î´nâˆ’1Ï€, 

where Î»=âˆ‘âˆ…â‰ eâŠ†nâˆ’1Î±e.

we index matrix and tensor indices by using i,j,k= <dig> âˆˆâ„¤ <dig> and allow multiplication Ã— in the ring of integers . the hadamard matrix then has matrix elements ij=iÃ—j where j is the row index and i is the column index. observe that in the diagonal basis, the permutation matrix has elements
 k^ij=Î´iji. 

thus we have expressions such as
 k^i1i2i3j1j2j3=Î´i1j1Î´i2j2Î´i3j3i2+i <dig>  

where k^=1âŠ—k^âŠ—k^.

as we are dealing with tensors of arbitrary size, it is convenient to represent a string such as i1i2â€¦in as an ordered-bipartitionÎ¼=Î¼0:Î¼ <dig> of the set , where Î¼ <dig> Î¼1âŠ† with jâˆˆÎ¼k if and only if ij=k. for example we have the following equivalences:
 00110â‰¡{ <dig> ,5}:{ <dig> },01111â‰¡{1}:{ <dig> , <dig> },10001â‰¡{ <dig> ,4}:{ <dig> } 

and inequivalence:
 01010â‰¡{ <dig> ,5}:{ <dig> }â‰ { <dig> }:{ <dig> ,5}â‰¡ <dig>  

we then have
 k^i1i2â€¦inj1j2â€¦jn=k^Î¼Î½=k^Î¼0:Î¼1Î½0:Î½1=Î´Î¼0Î½0Î´Î¼1Î½1|eâˆ©Î¼1|. 

defining h:=hâŠ—h where h:=h, in the diagonal basis p^:=hÂ·p and using our notation h has tensor components
 hÎ¼Î½=hÎ¼0:Î¼1Î½0:Î½1=hi1i2â€¦inj1j2â€¦jn=i1Ã—j1+i2Ã—j2+â€¦+inÃ—jn=|Î¼1âˆ©Î½1|. 

the zero edge-length star-tree initial distribution has tensor components
 Î´nâˆ’1Ï€i1i2â€¦in=12Î´i1i2Î´i1i3â€¦Î´i1in, 

. in the diagonal basis with Î´nâˆ’1Ï€^:=hÂ·Î´nâˆ’1Ï€, we have components
 Î´nâˆ’1Ï€^i1i2â€¦in=12âˆ‘j <dig> j <dig> â€¦,jni1Ã—j1+i2Ã—j2+â€¦+inÃ—jnÎ´j1j2Î´j1j3â€¦Î´j1jn=12âˆ‘j1i1+i2+â€¦+inÃ—j1=121+i1+i2+â€¦+in, 

which is exactly the statement
 Î´nâˆ’1Ï€^Î¼=Î´nâˆ’1Ï€^Î¼0:Î¼1=121+|Î¼1|. 

since k^ is diagonal in the transformed basis, we can conclude that
 p^Î¼=p^Î¼0:Î¼1=eâˆ’Î»expâˆ‘âˆ…â‰ eâŠ† <dig> nÎ±ek^Î¼0:Î¼1Î¼0:Î¼1121+|Î¼1|. 

of course many of these tensor components will be zero and we would like to ignore these.

take u=u0:u <dig> as an ordered bipartition of the reduced set , so that uâ‰¡i1i2â€¦inâˆ’ <dig> where jâˆˆuk if and only if ij=k, and define
 Î³= <dig> if|u1|is even, <dig> if|u1|is odd;=2âˆ’0|u0|+1|u1|, 

and interpret uÂ·Î³ as a string: uÂ·Î³ = i1i2â€¦inâˆ’1Î³.

if we make the definitions
 pu:=p^uÂ·Î³,Î·u:=12âˆ‘âˆ…â‰ eâŠ†nâˆ’1Î±ek^uÂ·Î³uÂ·Î³, 

then we can write the non-zero components as
 pu=eâˆ’Î»expÎ·u, 

with inverses
  Î·u=lnpu+Î». 

this is the first part of the inversion.

we would like to go further and actually recover the individual edge weights Î±e. to do this we define the  2nâˆ’1Ã—2nâˆ’ <dig> matrix f with components
 fue:=k^uÂ·Î³uÂ·Î³=|eâˆ©u|=hue, 

with e a subset and u an ordered-bipartition of . as h2=12nâˆ’ <dig>  we see that f provides its own inverse fâˆ’ <dig> with components
 fâˆ’1eu:=12nâˆ’1fue. 

defining the column vectors Î±â†’=Î±e and Î·â†’=Î·u, we can write the matrix equations
 Î·â†’=fÎ±â†’,Î±â†’=fâˆ’1Î·â†’. 

together with the first part of the inversion , these equations give a one-one map between pattern probabilities and edge weights for the binary-symmetric model.

inversion of the â„¤ <dig> model
taking confidence from the previous case we now discuss the inversion of the group-based phylogenetic model with g=â„¤ <dig>  we take
 â„¤3={ <dig> ,2}+â‰…âŒ©Ïƒ|Ïƒ3=ÎµâŒª,  and, by analogy to the â„¤ <dig> case, index tensors with indices i,j= <dig> , <dig> and allow multiplication Ã— by extending â„¤ <dig> to the ring ğ”½3={ <dig> ,2}+,Ã—.

in this case a generic rate matrix is given by
 q=âˆ’Î²Î±Î±âˆ’Î²Î²Î±âˆ’=âˆ’Î±+Î²1+Î±k1+Î²k <dig>  

where
 k1= <dig> k2= <dig>  

are the matrices representing the permutations Ïƒâ‰… and Ïƒ2â‰… under the regular representation, respectively.

we define Ï‰=e2Ï€i/ <dig>  and present the character table of â„¤ <dig> in table  <dig>  the decomposition of the regular representation is Ïreg=idâŠ•Ï‰âŠ•Ï‰ <dig>  and the columns of the character table give the projection operators onto the  irreducible subspaces:
 Î˜id:=13Îµ+Ïƒ+Ïƒ <dig> Î˜Ï‰:=13Îµ+Ï‰Ïƒ+Ï‰2Ïƒ <dig> Î˜Ï‰2:=13Îµ+Ï‰2Ïƒ+Ï‰Ïƒ <dig>  table  <dig> 
the character table of
â„¤3


id
Ï‰
Ï‰
2
Ï‰
Ï‰
2
[ Ïƒ
Ï‰
2
Ï‰


therefore, the matrix
 f=1111Ï‰Ï‰21Ï‰2Ï‰, 

diagonalizes the generic rate matrix for this model:
 q^=fqfâˆ’1=0000Î±Ï‰+Î²Ï‰2000Î±Ï‰2+Î²Ï‰, 

or, equivalently,
 k^1=fk1fâˆ’1=1000Ï‰000Ï‰ <dig> k^2=fk2fâˆ’1=1000Ï‰2000Ï‰. 

we recall our basic result  that for group-based models, a generic phylogenetic tensor can be expressed as
 p=eâˆ’Î»expâˆ‘âˆ…â‰ eâŠ†nâˆ’1Î±ek1+Î²ek2Â·Î´nâˆ’1Ï€, 

where Î»=âˆ‘âˆ…â‰ eâŠ†nâˆ’1Î±e+Î²e. we take the stationary distribution as initial distribution, so Ï€= <dig> ,13t.

the matrix elements of f can be expressed as ij=Ï‰iÃ—j, where we extend i,jâˆˆâ„¤ <dig> to include multiplication Ã— from the ring of integers . similarly,
 k^1ij=Î´ijÏ‰i,k^2ij=Î´iji. 

more generally, tensorial components can be expressed as
 1âŠ—k1^âŠ—k1^i1i2i3j1j2j3=Î´i1j1Î´i2j2Î´i3j3Ï‰i2+i <dig>  

we represent a string i1i2â€¦in as an ordered-tripartition, i1i2â€¦inâ‰¡Î¼=Î¼0:Î¼1:Î¼ <dig>  of the set , where jâˆˆÎ¼k if and only if ij=k. for example, if we take n= <dig>  we have:
 00000â‰¡{ <dig> , <dig> ,5}:âˆ…:âˆ…,20120â‰¡{ <dig> }:{3}:{ <dig> },01122â‰¡{1}:{ <dig> }:{ <dig> }. 

taking n =  <dig>  we have
 k^1Î¼Î½=1âŠ—k^1âŠ—k^1Î¼Î½=1âŠ—k^1âŠ—k^1Î¼0:Î¼1:Î¼2Î½0:Î½1:Î½2=Î´Î¼Î½Ï‰|Î¼1âˆ©{ <dig> }|+2|Î¼2âˆ©{ <dig> }|, 

and in general:
 k^1Î¼Î½=Î´Î¼Î½Ï‰|eâˆ©Î¼1|+2|eâˆ©Î¼2|,k^2Î¼Î½=Î´Î¼Î½Ï‰|eâˆ©Î¼2|+2|eâˆ©Î¼1|. 

taking the uniform distribution as initial distribution, the initial star-tree distribution can be written as
 Î´nâˆ’1Ï€i1i2â€¦in=13Î´i1i2Î´i1i3â€¦Î´i1in. 

defining f=fâŠ—f where f=f, we have
 fÎ¼Î½=fi1i2â€¦inj1j2â€¦jn=fi1j1fi2j2â€¦finjn=Ï‰i1Ã—j1+i2Ã—j2+â€¦+inÃ—jn, 

and in the transformed basis, where Î´nâˆ’1Ï€^:=fÂ·Î´nâˆ’1Ï€, we have
 Î´nâˆ’1Ï€^i1i2â€¦in=13âˆ‘j <dig> j <dig> â€¦,jnÏ‰i1Ã—j1+i2Ã—j2+â€¦+inÃ—jnÃ—Î´j1j2Î´j1j3â€¦Î´j1jn=13âˆ‘j1Ï‰j1Ã—=131+Ï‰i1+i2+â€¦+in+i1+i2+â€¦+in. 

indexing by ordered-tripartitions, we conclude that
 Î´nâˆ’1Ï€^Î¼=131+Ï‰i1+i2+â€¦+in+i1+i2+â€¦+in=131+Ï‰|Î¼1|+2|Î¼2|+|Î¼1|+2|Î¼2|. 

now suppose |Î¼1|+2|Î¼2|= <dig> , then
 Î´nâˆ’1Ï€^Î¼=131+1+1= <dig>  

if |Î¼1|+2|Î¼2|= <dig> , then
 Î´nâˆ’1Ï€^Î¼=131+Ï‰+Ï‰2= <dig>  

and if |Î¼1|+2|Î¼2|= <dig> , then
 Î´nâˆ’1Ï€^Î¼=131+Ï‰2+Ï‰= <dig>  

thus we have found a basis where all the elements of the initial star-tree tensor are zero unless the tripartion Î¼ satisfies |Î¼1|+2|Î¼2|= <dig> . crucially, this statement also holds for the phylogenetic tensor p^ because in this basis the rate matrices of this model are diagonal:
 p^Î¼=p^Î¼0:Î¼1:Î¼2=eâˆ’Î»exp12âˆ‘âˆ…â‰ eâŠ†nâˆ’1Î±ek1+Î²ek2Î¼0:Î¼1:Î¼2Î¼0:Î¼1:Î¼2Ã—131+Ï‰1|Î¼1|+Ï‰2|Î¼2|. 

we deal with this condition on Î¼ by taking u=u0:u1:u <dig> as an ordered-tripartion of the reduced set  and setting Î¼=uÂ·Î³  where
 Î³= <dig> if|u1|+2|u2|= <dig> if|u1|+2|u2|=22;if|u1|+2|u2|=1=3âˆ’0|u0|+1|u1|+2|u2|. 

if we make the definitions
 pu:=p^uÂ·Î³,Î·u:=âˆ‘âˆ…â‰ eâŠ†nâˆ’1Î±ek1+Î²ek2uÂ·Î³uÂ·Î³, 

we then have the first part of the inversion
  pu=eâˆ’Î»expÎ·u,Î·u=lnpu+Î». 

as in the â„¤ <dig> case, we would like to use Î·u to recover the rate parameters Î±e,Î²e for all âˆ…â‰ eâŠ† and thus complete the full inversion for this model. of course, it is little bit more difficult this time.

recall that Î¼=Î¼0:Î¼1:Î¼ <dig> with Î¼iâŠ†, whereas u=u0:u1:u <dig> with uiâŠ†, and âˆ…â‰ eâŠ†. considering
 k1Î¼Î¼=Ï‰|eâˆ©Î¼1|+2|eâˆ©Î¼2|, 

it follows that
 k1uÂ·Î³uÂ·Î³=Ï‰|eâˆ©u1|+2|eâˆ©u2|, 

and similarly
 k2uÂ·Î³uÂ·Î³=Ï‰|eâˆ©u2|+2|eâˆ©u1|. 

we make the observation that
 f1ue:=fu0:u1:u2ec:e:âˆ…=Ï‰|u1âˆ©e|+2|u2âˆ©e|=kÎ±uÂ·Î³uÂ·Î³, 

and
 f2ue:=fu0:u1:u2ec:âˆ…:e=Ï‰|u2âˆ©e|+2|u1âˆ©e|=kÎ²uÂ·Î³uÂ·Î³, 

where f <dig> and f <dig> are 2nâˆ’1Ã—3nâˆ’ <dig> matrices.

thus we may write
 Î·u=âˆ‘âˆ…â‰ eâŠ†nâˆ’1Î±ef1ue+Î²ef2ue. 

defining the column vectors Î±â†’={Î±e},Î²â†’={Î²e} and Î·â†’={Î·u}, we can write
 Î·â†’=f1Î±â†’+f2Î²â†’, 

and define two 3nâˆ’1Ã—2nâˆ’ <dig> matrices g <dig> and g <dig> as
 g1eu:=fâˆ’1ec:e:âˆ…u,g2eu:=fâˆ’1ec:âˆ…:eu, 

where
 fâˆ’1=1111Ï‰Ï‰21Ï‰2Ï‰, 

with ffâˆ’1= <dig> 

considering that
 âˆ‘vfâˆ’1uvfvw=Î´uw, 

for all ordered-triparitions u,w of , we have the matrix products
 g1f1= <dig> g1f2= <dig> g2f2= <dig> g2f1= <dig>  

thus the second part of the inversion for this model is
 Î±â†’=g1Î·â†’,Î²â†’=g2Î·â†’. 

together with , these equations give a one-one map between pattern probabilities and edge weights for the group-based model with g=â„¤ <dig> 

inversion of the k3st model
we now consider the k3st model  <cit>  which occurs as the group-based model with
 g=â„¤2Ã—â„¤2={,,,}+â‰…âŒ©,âŒª. 

in this model a generic rate matrix is given by
 q=âˆ’Î±+Î²+Î³1+Î±k01+Î²k10+Î³k <dig>  

where
  k01=1âŠ—k= <dig> k10=kâŠ—1= <dig> k11=kâŠ—k= <dig>  

we already know that the 2Ã— <dig> hadamard matrix h diagonalizes k, so we see immediately that h=hâŠ—h diagonalizes this model:
 k^01:=hk01hâˆ’1=1âŠ—hkhâˆ’1=10000âˆ’1000010000âˆ’ <dig> k^10:=hk10hâˆ’1=1000010000âˆ’10000âˆ’ <dig> k^11:=hk11hâˆ’1=10000âˆ’10000âˆ’ <dig>  

of course h is the character table of â„¤2Ã—â„¤ <dig> and the permutation matrices , together with k00:= <dig>  give the regular representation Ïregâ‰…idâŠ—idâŠ•idâŠ—sgnâŠ•sgnâŠ—idâŠ•sgnâŠ—sgn, where we recall the basic result that the tensor product of two irreducible representations of a group g gives an irreducible representation of gÃ—g.

simplifying notation, for this model we index tensors with indices given as pairs: i,j= <dig> , <dig> âˆˆâ„¤2Ã—â„¤2; and we express the individual parts using lower case roman characters. for example, we write i:=ab= <dig>  with a= <dig> and b= <dig>  this gives matrix elements:
 k^01abcd=Î´acÎ´bdb,k^10abcd=Î´acÎ´bda,k^11abcd=Î´acÎ´bda+b; 

and more complicated tensor products such as
 k^01âŠ—k^01âŠ—1a1b1a2b2a3b3c1d1c2d2c3d3=Î´a1c1Î´b1d1Î´a2c2Î´b2d2Î´a3c3Î´b3d3b1+b <dig>  

again we interpret strings such as Î¼â‰¡a1a2â€¦an and Î½â‰¡b1b2â€¦bn as ordered-bipartitions Î¼=Î¼0:Î¼ <dig> and Î½=Î½0:Î½ <dig> of the set . we can then write matrix elements of tensor products as
 k^01Î¼,Î½Î¼â€²,Î½â€²=Î´Î¼Î¼â€²Î´Î½Î½â€²|eâˆ©Î½1|,k^10Î¼,Î½Î¼â€²,Î½â€²=Î´Î¼Î¼â€²Î´Î½Î½â€²|eâˆ©Î¼1|,k^11Î¼,Î½Î¼â€²,Î½â€²=Î´Î¼Î¼â€²Î´Î½Î½â€²|eâˆ©Î¼1|+|eâˆ©Î½1|. 

taking the stationary distribution Ï€=14t as initial distribution, the zero edge-length star-tree distribution is given by
 Î´nâˆ’1Ï€i1i2â€¦in=14Î´i1i2Î´i1i3â€¦Î´i1in, 

which in the finer index representation is
 Î´nâˆ’1Ï€a1b1a2b2â€¦anbn=14Î´a1a2Î´a1a3â€¦Î´a1anÎ´b1b2Î´b1b3â€¦Î´b1bn. 

recall that elements of the hadamard matrix can be written as hba=aÃ—b, where a,bâˆˆâ„¤ <dig> and we allow multiplication Ã— by extending to the ring of integers . in the transformed basis, we have
 Î´nâˆ’1Ï€^a1b1a2b2â€¦anbn=Î´nâˆ’1Ï€^Î¼,Î½=14âˆ‘c <dig> c <dig> â€¦,cnd <dig> d <dig> â€¦,dnhc1a1hc2a2â€¦hcnanhd1b1hd2b2â€¦Ã—hdnbnÎ´a1a2Î´a1a3â€¦Î´a1anÎ´b1b2Î´b1b3â€¦Î´b1bn=14âˆ‘c <dig> d1Ã—c1+Ã—d1=141+a1+â€¦+an+b1+â€¦+bn+a1+â€¦+an+b1+â€¦+bn= <dig> if either|Î¼1|or|Î½1|is odd; <dig> if|Î¼1|and|Î½1|are both even. 

we recall , so under this model we can express a generic phylogenetic tensor as
 p=eâˆ’Î»expâˆ‘âˆ…â‰ eâŠ†nâˆ’1Î±ek01+Î²ek10+Î³ek11Â·Î´nâˆ’1Ï€. 

to exclude the vanishing components we define, for all ordered bipartitions u=u0:u <dig> of the reduced set ,
 Î³= <dig> if|u1|is even, <dig> if|u1|is odd;=2âˆ’, 

and intepret uÂ·Î³ as the string uÂ·Î³=a1a2â€¦anâˆ’1Î³. then, for each pair u,v of ordered-bipartitions of , we define
 Î·u,v:=âˆ‘âˆ…â‰ eâŠ†nâˆ’1Î±ek01+Î²ek10+Î³ek11uÂ·Î³,vÂ·Î³uÂ·Î³,vÂ·Î³, 

and
 pu,v:=puÂ·Î³,vÂ·Î³, 

this gives the inversion
 pu,v=eâˆ’Î»expÎ·u,v,Î·u,v=Î»+lnpu,v. 

consider the 2nÃ—2nâˆ’ <dig> rectangular matrices f <dig>  f <dig> and f <dig> with components
 f01u,ve=k01u,vu,v=|eâˆ©v1|,f10u,ve=k10u,vu,v=|eâˆ©u1|,f11u,ve=k11u,vu,v=|eâˆ©u1|+|eâˆ©v1|; 

where eâŠ† and u=u0:u <dig> and v=v0:v <dig> are ordered-bipartitions of . if we define the column vector Î·â†’:={Î·u,v} indexed by pairs of ordered-bipartitions and the column vectors Î±â†’:={Î±e}, Î²â†’:={Î±e} and Î³â†’:={Î±e} indexed by subsets of , we then have the matrix equation
 Î·â†’=f01Î±â†’+f10Î²â†’+f11Î³â†’. 

writing h=hâŠ—h with h=h, we note that
 f01u,ve=hu,vâˆ…,e,f10u,ve=hu,ve,âˆ…,f11u,ve=hu,ve,e; 

and define the 2nâˆ’1Ã—2n rectangular matrices g <dig> g <dig> and g <dig> as
 g01eu,v=hâˆ’1âˆ…,eu,v,g10eu,v=hâˆ’1e,âˆ…u,v,g11eu,v=hâˆ’1e,eu,v. 

noting that
 âˆ‘w,xhâˆ’1u,vw,xhw,xy,z=Î´u,yÎ´v,z, 

for all u,v,y,z ordered-bipartitions of , we then have the matrix identities
 g01f01= <dig> g10f10= <dig> g11f11= <dig>  

and
 g01f10=0=g01f11=gÎ²f11=g10f01=g11f01=g11f <dig>  

writing
 Î±â†’=g01Î·â†’,Î²â†’=g10Î·â†’,Î³â†’=g11Î·â†’, 

completes the inversion for the k3st model.

inversion of the â„¤r model
we now consider the group based model for â„¤r= <dig> , <dig> â€¦+â‰…âŒ©Ïƒ:Ïƒr=eâŒª. for this model the generic rate matrix has the form
 q=âˆ’Î»1+âˆ‘i=1rÎ±ikÏƒi, 

where Î»=âˆ‘i=1rÎ±i and
 kÏƒ=00â€¦011000001â€¦00â‹®â‹®â‹±â‹®â‹®00â€¦ <dig>  

so that kÏƒi=kÏƒi.

defining Ï‰=e2Ï€i/r, we have Ï‰r= <dig> and 1+Ï‰+Ï‰2+â€¦+Ï‰râˆ’1= <dig> and fij=Ï‰ij where i,j= <dig> , <dig> â€¦,râˆ’ <dig>  of course, f is the character table of â„¤r and fâˆ’1ji=1rÏ‰âˆ’ij.

lemma <dig> 
 âˆ‘Î½fâŠ—fâŠ—â€¦âŠ—fÎ¼Î½fâˆ’1âŠ—fâˆ’1âŠ—â€¦âŠ—fâˆ’1Î½Î¼â€²=Î´Î¼Î¼â€², 

where Î¼,Î½,Î¼â€² are ordered-r-partitions of the set  defined by the strings i1i2â€¦in, j1j2â€¦jn and k1k2â€¦kn, respectively.

proof.
the result is obvious by the definition of tensor product. however, explicitly we have
 âˆ‘Î½fâŠ—fâŠ—â€¦âŠ—fÎ¼Î½fâˆ’1âŠ—fâˆ’1âŠ—â€¦âŠ—fâˆ’1Î½Î¼â€²=1rnâˆ‘0â‰¤j <dig> j <dig> â€¦,jrâˆ’1â‰¤Ã—Ï‰i1j1+i2j2+â€¦irâˆ’1jrâˆ’1Ï‰âˆ’j1k1+j2k2+â€¦+jnkn=1rnâˆ‘0â‰¤j <dig> j <dig> â€¦,jrâˆ’1â‰¤Ã—Ï‰j1+j2+â€¦+jn 

which clearly equals  <dig> if iâ„“âˆ’kâ„“= <dig> for all â„“, and, by repeatedly applying 1+Ï‰+Ï‰2+â€¦+Ï‰râˆ’1= <dig>  equals  <dig> otherwise.

the regular representation contains exactly one copy of every irreducible representation and the irreducible representations of â„¤r are given by the powers of Ï‰:
 Ïi:â„¤râ†’â„‚Ïƒâ†¦Ï‰i. 

thus the change of basis kÏƒiâ†¦k^Ïƒi=fkÏƒifâˆ’ <dig> will give diagonal matrices k^Ïƒi. additionally,

lemma <dig> 
in the diagonal basis, the matrices k^Ïƒi:=fkÏƒifâˆ’ <dig> have matrix elements given by k^Ïƒsij=Ï‰isÎ´ij.

proof.
consider the matrix elements kÏƒsij=Î´iÏƒs. thus
 fkÏƒsfâˆ’1ji=âˆ‘k,lÏ‰ikÎ´kÏƒsÏ‰âˆ’lj=âˆ‘lÏ‰iÏƒsâˆ’lj=âˆ‘lÏ‰iâˆ’lj=Ï‰isâˆ‘lÏ‰l=Ï‰isÎ´ij, 

where we have used Ï‰Ïƒs=Ï‰m+s.

now
 Î´nâˆ’1Ï€i1i2â€¦in=1rÎ´i1i2Î´i1i3â€¦Î´i1in, 

and
 Î´nâˆ’1Ï€^i1i2â€¦in=1râˆ‘j <dig> j <dig> â€¦,jrÏ‰i1j1+i2j2+â€¦+injnÃ—Î´j1j2Î´j1j3â€¦Î´j1jn=1râˆ‘j1Ï‰j1=1ifi1+i2+â€¦+in= <dig> otherwise. 

translating this result using the ordered-r-partitions for indices, we have

lemma <dig> 
in the diagonal basis, the uniform initial distribution on the star tree has components
 Î´nâˆ’1Ï€^Î¼=1if0|Î¼0|+1|Î¼1|+2|Î¼2|+â€¦+|Î¼râˆ’1|= <dig> otherwise., 

where Î¼=Î¼0:Î¼1:Î¼2:â€¦:Î¼râˆ’ <dig> is an ordered-r-partition of the set .

again recall that for this model a generic phylogenetic tensor can be written as
 p=eâˆ’Î»expâˆ‘âˆ…â‰ eâŠ†nâˆ’ <dig> sâˆˆrâˆ’1Î±eskÏƒsÎ´nâˆ’1Ï€, 

where Ï€=1rt. in the diagonal basis p^:=fÂ·p and as a consequence of lemma 3p^ will have many vanishing components. to avoid these we take u=u0:u1:u2:â€¦:urâˆ’ <dig> as an ordered-r-partition of  and set
 Î³=râˆ’0|u0|+1|u1|+2|u2|+â€¦+|urâˆ’1|. 

if we define pu:=p^uÂ·Î³ and
 Î·u:=âˆ‘âˆ…â‰ eâŠ†nâˆ’ <dig> sâˆˆrâˆ’1Î±esk^ÏƒsuÂ·Î³uÂ·Î³, 

we then have the first part of the inversion for the â„¤r model:
 pu=eâˆ’Î»expÎ·u,Î·u=lnpu+Î». 

for each iâˆˆ, we define the column vectors Î±â†’i:=Î±eiâˆ…â‰ eâŠ†nâˆ’ <dig>  and, for each âˆ…â‰ eâŠ† and u an ordered- -partition of , we define the rectangular rnâˆ’1Ã—2nâˆ’ <dig> matrices
 f1ue:=kÏƒuÂ·Î³uÂ·Î³,f2ue:=kÏƒ2uÂ·Î³uÂ·Î³,â€¦frâˆ’1ue:=kÏƒrâˆ’1uÂ·Î³uÂ·Î³, 

so we have the vector equation
 Î·=f1Î±1â†’+f2Î±2â†’+â€¦+frâˆ’1Î±â†’râˆ’ <dig>  

we claim that

lemma <dig> 
 f1ue=fuec:e:âˆ…:âˆ…:â€¦:âˆ…,f2ue=fuec:âˆ…:e:âˆ…:â€¦:âˆ…,â‹¯â‹¯frâˆ’1ue=fuec:âˆ…:âˆ…:âˆ…:â€¦:e. 

proof.
we recall that k^Ïƒsij=Ï‰isÎ´ij, so, for Î¼=Î¼0:Î¼1:Î¼2:â€¦:Î¼râˆ’ <dig> an ordered-r-parition of , and e a subset of  we have
 k^ÏƒsÎ¼Î¼=Ï‰s0|Î¼0âˆ©e|+1|Î¼1âˆ©e|+â€¦+|Î¼râˆ’1âˆ©e|, 

so
 k^ÏƒsuÂ·Î³uÂ·Î³=Ï‰s0|u0âˆ©e|+1|u1âˆ©e|+â€¦+|urâˆ’1âˆ©e|, 

because eâŠ†. on the other hand fij=Ï‰ij, so
 fuec:âˆ…:â€¦:âˆ…:e:âˆ…:â€¦:âˆ…=Ï‰s0|u0âˆ©e|+1|u1âˆ©e|+â€¦+|urâˆ’1âˆ©e|, 

where e appears in the sth position.

define, for iâˆˆ, the rectangular 2nâˆ’1Ã—rnâˆ’ <dig> matrices
 g1eu:=fâˆ’1uÂ·Î³ecÂ·Î³:e:âˆ…:âˆ…:â€¦:âˆ…g2eu:=fâˆ’1uÂ·Î³ecÂ·Î³:âˆ…:e:âˆ…:â€¦:âˆ…â‹®grâˆ’1eu=fâˆ’1uÂ·Î³ecÂ·Î³:âˆ…:âˆ…:âˆ…:â€¦:e. 

of course gifj=Î´ij <dig>  so we now have the second part of the inversion:
 Î±iâ†’=giÎ·. 

inversion of any abelian group-based model
lemma <dig> 
any  abelian group g is isomorphic to a direct product of cyclic groups of prime-power order, ie. gâ‰…â„¤r1Ã—â„¤r2Ã—â€¦Ã—â„¤rq where each ri=pini where pi is prime and ni is a positive integer.

lemma <dig> 
the group-based model arising from the g is defined only up to group isomorphisms of g.

proof.
a generic rate matrix for the group-based model arsing from g is given by
 q=âˆ’Î»1+âˆ‘eâ‰ ÏƒâˆˆgÎ±ÏƒkÏƒ. 

under a group isomorphism Ï•:gâ†’gâ€², we have Ï•=Ï•Ï•.

recall , so that the matrix elements kÏƒij is set via the action Ïƒiâ†¦ÏƒÏƒi=Ïƒj. if we consider the regular representation of gâ€² we then have kÏ•ij defined by Ï•â†¦Ï•Ï•. now Ï•Ï•=Ï•=Ï• and, because Ï• is a group isomorphism, this occurs if and only if ÏƒÏƒi=Ïƒj. thus kÏ•ij=kÏƒij for all i and j.

this means that we can restrict attention to a single representitive in the isomorphism class of g. of course, for this purpose we choose the representative guaranteed by lemma  <dig> 

thus, for any abelian group g, with generators Ïƒ <dig> Ïƒ <dig> â€¦,Ïƒq the corresponding group-based model has rate generators given by
 lÏƒ=âˆ’1+kÏƒ1m1âŠ—kÏƒ2m2âŠ—â€¦âŠ—kÏƒqmq, 

for all eâ‰ Ïƒ=Ïƒ1m <dig> Ïƒ2m <dig> â€¦,Ïƒqmqâˆˆg, where kÏƒi is the permutation matrix representing the generator Ïƒiâˆˆâ„¤ri. the character table f of g is simply the tensor product of the individual character tables of the â„¤ri:
 f=f1âŠ—f2âŠ—â€¦âŠ—fq. 

in the diagonal basis we have matrix elements
 fkkÏƒksfkâˆ’1ij=k^Ïƒksij=Ï‰kisÎ´ij, 

where Ï‰k is a kth root of unity. thus
 k^Ïƒ1m1âŠ—k^Ïƒ2m2âŠ—â€¦k^Ïƒqmqi1i2â€¦iqj1j2â€¦jq=Î´i1j1Î´i2j2â€¦Î´iqjqÏ‰1i1m1Ï‰2i2m2â€¦Ï‰qiqmq. 

we write phylogenetic tensors for this model in the form
 pi11i12â€¦i1n,i21i22â€¦i2nâ€¦â€¦iq1iq2â€¦iqn, 

where 0â‰¤isjâ‰¤rs for all 0â‰¤sâ‰¤q. we simplify notation by writing each group of indices as Î¼:=is1is2â€¦isn where Î¼ is an ordered- rs-partition of .

lemma <dig> 
in the diagonal basis, the uniform initial distribution on the star tree has components
 Î´nâˆ’1Ï€^Î¼Î¼â€¦Î¼= <dig> if0|Î¼0|+1|Î¼1|+â€¦+|Î¼râˆ’1|=0âˆ€i; <dig> otherwise. 

a generic phylogenetic tensor for this model can be expressed as
 p=eâˆ’Î»expâˆ‘âˆ…â‰ eâŠ†nâˆ’1siâˆˆriâˆ’1Î±es1s2â€¦sqkÏƒ1s1âŠ—kÏƒ2s2âŠ—â€¦âŠ—kÏƒqsqÂ·Î´nâˆ’1Ï€, 

where Ï€ is the unifrom distribution on âˆ‘i=1qri states, i.e.
 Ï€=âˆ‘i=1qriâˆ’ <dig> ,â€¦,1t. 

in the diagonal basis p^=Â·p, and, as a consequence of the previous lemma, p has many vanishing components. to avoid these, for each iâˆˆ we take u=u0:u1:u2:â€¦:uriâˆ’ <dig> as an ordered- ri-partition of  and set
 Î³i)=riâˆ’0|u0|+1|u1|+2|u2|+â€¦+|urâˆ’1|. 

we then define
 puuâ€¦u:=p^uÂ·Î³1uuÂ·Î³2uâ€¦uÂ·Î³1u, 

and
 Î·uâ€¦u:=âˆ‘âˆ…â‰ eâŠ†nâˆ’1siâˆˆriâˆ’1Î±es1â€¦sqk^Ïƒ1s1âŠ—â€¦âŠ—k^ÏƒqsquÂ·Î³1uâ€¦uÂ·Î³1)uÂ·Î³1uâ€¦uÂ·Î³1u, 

so that we have the first part of the inversion
 puuâ€¦u=eâˆ’Î»expÎ·uuâ€¦u,Î·uuâ€¦u=Î»+lnpuuâ€¦u. 

we define the column vectors Î±â†’s1s2â€¦sq:=Î±es1s2â€¦sqâˆ…â‰ eâŠ†nâˆ’ <dig> and Î·â†’:={Î·uuâ€¦u} where ui is an ordered- ri-partition of , and we define the nâˆ’1Ã—2nâˆ’ <dig> matrices
 fs1s2â€¦squ1u2â€¦uqe:=kÏƒ1s1u1Â·Î³u1Â·Î³kÏƒ2s2u2Â·Î³u2Â·Î³â€¦kÏƒqsquqÂ·Î³uqÂ·Î³=f1u1ec:âˆ…:â€¦:âˆ…:e:âˆ…:â€¦:âˆ…f2u2ec:âˆ…:â€¦:âˆ…:e:âˆ…:â€¦:âˆ…â€¦â€¦fquqec:âˆ…:â€¦:âˆ…:e:âˆ…:â€¦:âˆ…, 

where in each term e appears in the sith position and the equality follows from lemma  <dig> 

we can then write the vector equation
 Î·â†’=âˆ‘s1s2â€¦sq:1â‰¤siâ‰¤riâˆ’1fs1s2â€¦sqÎ±â†’s1s2â€¦sq. 

if we define the 2nâˆ’1Ã—nâˆ’ <dig> matrices
 gs1s2â€¦sqeu1u2â€¦uq=f1âˆ’1u1ec:âˆ…:â€¦:âˆ…:e:âˆ…:â€¦:âˆ…f2âˆ’1u2ec:âˆ…:â€¦:âˆ…:e:âˆ…:â€¦:âˆ…â€¦â€¦fqâˆ’1uqec:âˆ…:â€¦:âˆ…:e:âˆ…:â€¦:âˆ…, 

where in each term e appears in the sith position, we have the orthogonality relations
 gs1s2â€¦sqfs1â€²s2â€²â€¦sqâ€²=Î´s1s1â€²Î´s2s2â€²â€¦Î´sqsqâ€² <dig>  

this gives us the second part of the inversion of any group-based model:
 Î±â†’s1s2â€¦sq=gs1s2â€¦sqÎ·â†’. 

CONCLUSIONS
in this article we have given an alternative derivation of the inversion of group-based phylogenetic models. primarily our method relies on the remarkable intertwining relation between branching events and markov evolution , and the resulting simplified expression of phylogenetic tensors given in . from there we took a representation theoretic approach concentrating on the structure of tensor indices.

competing interests

the authors declare that they have no competing interests.

authorsâ€™ contributions

jgs conducted much of the theoretical work presented, and was primarily responsible for drafting of the paper. pdj contributed to the theoretical work and assisted in editing of the paper. brh contributed to the theoretical work and contributed substantially to the writing of the paper. all authors read and approved the final manuscript.

authorsâ€™ information

jeremy g. sumner is a arc research fellow, peter d. jarvis is a alexander von humboldt fellow and barbara r. holland is a arc future fellow.

