BACKGROUND
since the completion of sequencing the first metazoan genomes in 1998
 <cit> , more than  <dig> important metazoan and plant genomes have been sequenced thus far
 <cit> , and enormous efforts have been made to understand how biological functions and diseases of these organisms including the humans can be explained by the genetic information stored in the genome sequences. although significant progress has been made in the past 16 years, we are still far from the goal of understanding the biology of metazoans and plants solely from their genome sequences
 <cit> . in fact, it turns out that interpreting a genome is more difficult and challenging than originally thought when a few eukaryotic genomes including the human genome were first released
 <cit> . with this recognition, the community has taken a more realistic approach by first identifying all the functional sequence elements in the genomes
. these functional elements include transcribed sequences as well as transcriptional control elements, epigenetic features, and regulatory elements acting at the rna level post-transcriptionally. in principle, while the transcribed sequences specify the potential part list in the cells in an organism, including proteins, various types of rnas and metabolites, the transcriptional control elements including promoters, enhancers, silencers and insulators together with epigenetic remodeling machineries, determine which protein- or rna-specifying sequences should be transcribed in each cell during development and under various physiological conditions, thereby specifying the cell’s type during development and specific physiological functions, as it is the dynamic interactions of these components in a cell that determine the cell’s type and specific physiological functions
 <cit> . once these functional elements are at least partially known, then we can move toward to the next step to identify dynamic interactions among the functional sequence elements and their products of proteins, rnas and metabolites in different cell types in the entire life of the organism.

in the past we have gained a good understanding of transcribed sequences, particularly protein-coding sequences in numerous sequenced eukaryotic genomes thanks to the development of powerful computational and experimental methods for their characterization
 <cit> . however, we have had only very limited understanding of transcriptional control elements, particularly promoters, enhancers and silencers in virtually all sequenced large eukaryotic genomes, even though these elements are as important as the transcribed sequences for the functions of an organism
. more specifically, promoters, enhancers and silencers are clusters of closely located cis-regulatory elements  that are recognized by specific transcription factors 
 <cit> . thus, a cre is also called a tf binding site . these clusters of cres are also called cis-regulatory modules 
 <cit> . the difficulty to identify cres and crms either computationally or experimentally is due mainly to their short and degenerate nature while they mainly reside in very long intergenic or intronic background sequences
 <cit> . to further confound the problem, they can be very far away from the target genes or even can be located on a different chromosome
 <cit> , making their characterization extremely difficult by computational methods such as comparative genomics approaches, although there are successful examples, in particular for developmental enhancers that tend to be more conserved
 <cit> .

however, in the past a few years, the development of a plethora of next-generation sequencing -based high throughput techniques has largely changed the way to characterize cres or even crms genome-wide in large eukaryotic genomes. these techniques include chip-chip and chip-seq for locating cres of a tf
 and various chromatin modification marks
 <cit> , dnase-seq
 and faire-seq
 <cit>  for locating free nucleosome regions which tend to coincide with active crms, and hi-c for measuring the physical proximity of linearly distal dna segments
 <cit> . while a single epigenetic dataset derived from dnase-seq
, faire-seq
 <cit>  or enhancer mark chip-seq potentially contains location information of all crms active in a cell or tissue type, cres and crms for specific tfs cannot be easily identified in such a dataset, as it lumps all cres and crms active in the cell or tissue type. in contrast, a tf chip-seq dataset is highly enriched for the cres of the tf, thus they can be potentially identified at single nucleotide resolution in a cell or tissue or type. however, the sequenced potential binding regions in a tf chip-seq dataset can be still much longer than the cres of the chip-ed tf, thus peak-calling algorithms and tools have been developed to identify the binding peaks in the potential binding regions. even though the existing peak-calling algorithms can narrow down cres of a chip-ed tf to a certain regions, typically from a few hundred to a few thousand base pairs 
 <cit> , they are still much longer than the typical lengths of cres, which are typically 6 ~ 16 bp long. hence, the actual locations of cres need to be identified by a motif-finding tool
 <cit> . although a few new motif-finders have been developed to analyze large sequence sets from chip-seq experiments, such as seeder
 <cit> , trawler
 <cit> , chipmunk
 <cit> , hms
 <cit> , cmf
 <cit> , steme
 <cit> , dreme
 <cit> , decod
 <cit> , rsat
 <cit> , and posmo
 <cit> , they are typically used to find the cres of a chip-ed tf in a short region of sequences  around the binding peak summits in order to reduce the searching space and increase prediction specificity in trading of sensitivity. some of these tools
 <cit>  use the locations of binding peaks to help find the cres of a chip-ed tf. thus only cres of the chip-ed tf are returned by these tools. however, cres in higher eukaryotes rarely work alone, instead, they cooperate with one another by forming crms for combinatorial regulations
 <cit> . it has been shown that cres of cooperative tfs of a chip-ed tf can be found in the neighborhoods of the binding peaks of the chip-ed tf
. in this sense, the information of cres in a chip dataset is not fully explored by the majority of current studies that were mainly targeted to identify the cres of a chip-ed tf.

with the continuous drop in costs of ngs technologies, tf chip-seq is becoming routine in numerous individual labs worldwide, and enormous chip-seq datasets are being produced in many important metazoans and plants, in addition to the large amount of chip data churned out by large consortiums such as the encode
 <cit>  and modencode
 <cit>  projects aimed at identifying all the functional sequence elements in the genomes of humans and the model organisms c. elegans
 <cit>  and d. melanogaster
 <cit> . it is highly expected that very soon, at least one chip-seq dataset will be available in a certain cell type, tissue or developmental stage for the majority of tfs encoded in the genomes through these efforts. since certain combinations of tfs are often repeatedly used for regulating one or more groups  of genes in some cell types, tissues and developmental stages
 <cit> , the increasing number of chip-seq datasets contains a wealth of information about the combinatorial patterns of different tfs for transcriptional regulation
 <cit> . thus, it is now possible to predict the cres and crms genome-wide through integrating the information about co-occurrence of motifs in a large number of chip-seq datasets for different tfs from different cell types, tissues, developmental stages and physiological conditions. although a few methods such as spamo
 <cit> , cpmodule
 <cit>  and
 <cit> , have been made to identify cres of cooperator tfs in a chip-seq dataset, they do not integrate multiple chip-seq datasets, and cannot predict novel motifs in crms, as they all depend on a library of known cres such as transfac
 <cit>  or jaspar
 <cit>  to scan for possible cooperative cres in binding peaks. consequently, simple and approximate methods were often used to find motifs in big chip datasets. for instance, in recent studies using the modencode
 <cit>  and encode
 <cit>  datasets, only the top  <dig> and  <dig> binding peaks with a length of 100 bp and 200 bp, respectively, in each dataset were used to find motifs. hence, the wealthy information in the valuable chip datasets was not fully explored.

in this paper, we have developed a new algorithm depcrm for genome-wide  novo rediction of  and cres by identifying overrepresented patterns of motif combinations in a large number of chip datasets in a sequenced eukaryotic organism. when applied to the d. melanogaster genome using a total of  <dig> chip-chip and chip-seq datasets for  <dig> tfs, depcrm identified  <dig> cre motifs and  <dig>  crms, recovering  <dig> % of known crms located in the datasets and  <dig> % of known crms containing at least one predicted cre. thus the algorithm has achieved rather high prediction accuracy even using this limited number of datasets.

RESULTS
basic idea of the algorithm
as tfs in eukaryotes tend to work together by binding to their cres in crms with a typical size of 500 ~  <dig>  bp
 <cit> , we assume that although a chip experiment is mainly aimed to identify the binding locations of the chip-ed tf, if we extend shorter binding peaks toward the two ends to reach the typical size of crms , then extended binding peaks are more likely to contain the cres of different cooperative tfs  in addition to the cres of the chip-ed tf as illustrated in figure 
 <dig>  in other words, if two different tfs  cooperatively regulate the same regulons in certain cell types by binding to their respective cres in crms, then their extended chip binding peaks from these cell types should overlap with one another to some extent. hence, if we have enough number of chip datasets for different tfs from the same and/or different cell types, then the datasets are likely to include overlapping binding peaks for cooperative tfs. accordingly, our algorithm predicts crms through identifying overrepresented co-occurring putative motif patterns in a large number of chip datasets, ideally for different tfs in different cell types and developmental stages.figure  <dig> 
a schematic view of our hypothesis. if the binding peak is shorter than  <dig>  bp, we equally extended from the two ends to have a length up to  <dig>  bp. we assume that in addition to the cres of the chip-ed tf , cres of different cooperative tfs  are also enriched in the neighborhoods of at least some subsets of the binding peak dataset. each line represents an extended binding peak sequence.



more specifically, first, we identify all possible motifs in each of extended binding peak datasets  using a fast motif finder. second, we find overrepresented co-occurring motif pairs regardless of their distance in each of the datasets, and call them co-occurring pairs  . third, we reason that if some highly similar cps appear in multiple datasets, then all these similar cps are likely to be subsets of the motifs of two certain tfs that cooperatively regulate regulons in different cell types or developmental stages, and therefore are likely to form crms by themselves or to be a part of larger crms. we identify such repeatedly occurring similar cps in multiple datasets, and call them cp clusters  . presumably, each of the cpcs contains highly similar cps for two certain tfs. fourth, to predict crms containing more than two cres, we cluster cpcs if they tend to co-occur in the same binding peaks . each cpc cluster corresponds to a possible combination of their motifs to form a part of or an entire crm dependent on the sufficiency of the datasets, and thus we refer to them as crm components  . finally, we predict individual crms across the genome based on the motif pattern of the crmcs and their close adjacency . obviously, in order to accurately predict crms genome-wide, we need to have a sufficiently large number of diverse tf chip datasets, so that they likely include datasets for cooperative tfs in different cell types and developmental stages. we expect that the more complete the datasets, the more accurate the predictions will be. the details of the algorithm are described in methods.figure  <dig> 
a schematic of the major steps of the depcrm algorithm. a. illustration of extended binding peaks from dataset d <dig>  d <dig> and d <dig> respectively. b. illustration of cres found within each dataset, cres of the same motif are shown in the same shape and color. c. construction of cp similarity graph. {p <dig>  p <dig>  p <dig>  p4}, {p <dig>  p <dig>  p7} and {p <dig>  p <dig>  p10} are sets of cps found in datasets d <dig>  d <dig> and d <dig> respectively. for clarity, the cps formed between motifs in p <dig> and motifs in p <dig> and so on in the datasets are not shown. each cp  is a node of the multi-partied similarity graph, and two nodes are linked by an edge if and only if their s
s ≥ β, with s
s being the weight, which is not shown for clarity. d. by removing the dotted edges in panel c, mcl cuts the graph into five cp clusters : c1 = {p <dig>  p <dig>  p8}; c2 = {p <dig>  p6}, c3 = {p <dig>  p9} , c4 = {p <dig>  p7)} and c5 = {p10}. cps in a cluster are connected by edges in the same color. the singleton cluster c5 = {p10} is discarded for its low density. e. for each pair ci and cj from the four cpcs, we find sets of cps from the same dataset d
k, and compute a co-occurring scores s
cpc  for the two cpcs. f. construction of the cpc co-occurring graph using the four cpcs. cutting the graph using mcl results in two crmcs, {c <dig> c <dig> ,c3} and {c4}. g. after merging motifs into unique motifs , we project the cres of crmcs to the genome and predict the crms.



overlap of the extended binding peaks of cooperative tfs in the datasets
since d. melanogaster has been long used to study gene transcriptional regulation in metazoans, a relatively large number of its cres and crms have been experimentally characterized, and since a large number of chip-chip and chip-seq have been generated in the organism in the last few years, we evaluated our algorithm in this organism. to this end, we compiled a total of  <dig> chip-seq and chip-chip datasets for  <dig> distinct tfs, collected at different developmental stages  and under different experimental conditions . more specifically,  <dig> chip-chip and  <dig> chip-seq datasets were from the modencode project
 <cit> ,  <dig> chip-chip datasets were from the berkeley drosophila transcription network project 
 <cit> , and  <dig> chip-chip datasets were from literature. additional file
1: table s <dig> summarizes the major features of the  <dig> datasets. as shown in figure 
3a, the majority of the binding peaks have a length around  <dig>  bp, and only  <dig> % of them have a length longer than  <dig>  bp, which were not used in our study due to their low quality. furthermore, if a binding peak is shorter than  <dig> pb, we extended it up to  <dig> pb  in order to include cres of possible cooperative tfs . the datasets contain a total of  <dig>  sequences, each individual dataset containing  <dig> to  <dig>  sequences . these  <dig>  sequences contain a total of  <dig> , <dig>  bp, which are  <dig>  times of the genome , but only cover  <dig> %  of the genome , indicating that some of these sequences highly overlap with one another, thus confirming our aforementioned assumption. of the  <dig> ,033 bp genome sequence covered by the datasets,  <dig> ,300 bp  are in non-coding regions , consisting of  <dig> % of ncrs  in the genome . the remaining  <dig> , <dig>  sequences are in coding regions , consisting of  <dig> % of cdrs  in the genome . thus we have included a considerable portion of cdrs in the datasets, because some binding peaks are located in cdrs. currently, there are  <dig>  known crms in d. melanogaster in the redfly database
 <cit> , and  <dig>   of which are located in the extended binding peaks. we will evaluate our algorithm for its ability to recover these  <dig>  known crms in the extended binding peaks.figure  <dig> 
analysis of the original datasets and motif finding results. a. distribution of the binding peak lengths in the  <dig> original datasets. vast majority  of the binding peaks are shorter than  <dig>  bp. b. number of motifs found in each of the  <dig> datasets as a function of the number of binding peaks the datasets. c. distribution of the information content of the predicted motifs in the datasets. d. the rank of the chip-ed tf’s motif among the predicted motifs in the  <dig> datasets in which the motifs of the chip-ed tfs can be identified. the diamond on the bar indicates the rank of the chip-ed tf’s motif among the predicted motifs in the dataset. the higher the position of the diamond, the higher the rank of the target tf’s motif.
coverage of the datasets, predicted cres and crms on the genome and its cdrs and ncrs. *, the numbers above a line  are the percentages of the cdrs and ncrs in the category. **, the numbers below a line are the percentages of cdrs and ncrs of the category with respect to the entire cdrs and ncrs in the genome. ***, the number on the right of a line is the percentage of the category with respect to the genome.



to see the overlapping patterns of binding peaks upon which our algorithm is based, we computed pair-wise overlapping scores  in methods) of the extended binding peaks among the  <dig> datasets for the  <dig> tfs , and clustered the datasets using the overlapping scores. as shown in figure 
5a, consistent with the above analysis, there are significant overlaps among the binding peaks in even these limited  <dig> datasets for only  <dig> %  of the  <dig>  annotated tfs encoded in the genome . as expected there are overlaps among datasets of the same tfs collected at differently developmental stages and/or under different experimental conditions, indicating that these tfs might function similarly under these circumstances. for example, the datasets  <dig> and  <dig> from the modencode project were collected using the same tf caudal  at the embryonic stages 0– <dig> hours and adult female, respectively, and they have an overlapping score of  <dig> . on the other hand, there are also numerous overlaps among datasets of different tfs. interestingly, the datasets of tfs that are known to work cooperatively form clusters. the two highlighted boxes in figure 
5a show two examples of such clusters. the upper cluster is formed by the binding peaks for tfs medea , dichaete , dorsal , twist  and daughterless . it has been reported that dl and twi cooperatively regulate the expression of snail  in the mesoderm of the embryo
 <cit> . the lower cluster is formed by the binding peaks of the global regulator creb-binding protein , gap regulators kruppel , giant , cad and hunch back . it has been well documented that these tfs bind to crms  of genes involved in the segmentation process of early embryogenesis of d. melanogaster
 <cit> . an example of such crms is shown in additional file
4: figure s <dig>  to further evaluate the overlaps of the binding peaks of distinct tfs, we analyzed the  <dig> out of the  <dig> datasets, each being for a different tf , and the same conclusion can be drawn about the overlaps of the binding peaks of different tfs . the similar results also were reported in d. melanogaster
 <cit>  and human
 <cit>  datasets. thus these results validate our assumption of the overlaps of binding peaks, and indicate that the datasets might contain sufficient information to predict at least portion of crms in the genome.figure  <dig> 
overlapping analysis of the datasets. a. hierarchical clustering of the  <dig> datasets for  <dig> tfs based on their pair-wise binding peak overlapping scores s
o. the blow-ups show two clusters for cooperative tfs . b. the motifs of tfs kr and hb are both found in the overlapping datasets gsm511084_dmel-kr <dig> chip-ed by kr and gsm511081_dmel-hb <dig> chip-ed by hb.



identification of motifs in the extended binding peaks
our goal now is to identify in each of the extended binding peak datasets all possible tf binding motifs of the chip-ed tfs as well as of its cooperative tfs . because accurate motif-finding is still a notoriously difficult problem
, to achieve this goal we consider all overrepresented motifs returned by dreme
 <cit>  in each extended binding peak datasets to maximally include possible true motifs. as shown in figure 
3b, depending on the size and quality of the datasets, a varying number  of motifs were found in each dataset. particularly, in a total of six datasets that generally contain fewer binding peaks and are of low quality , none or only a single motif could be identified. as no motif pairs can be formed in these datasets, they did not contribute to the final cre and crm predictions. in other words, they were filtered out by the motif-finder. on the other hand, putative cres were found in the vast majority  of the  <dig>  extended binding peaks in the remaining  <dig> datasets, indicating that they were highly enriched with motifs. in this sense, the motif finding step servers as a quality control to filter out low quality datasets without the need of human involvement, conferring additional robustness to the algorithm. the returned motifs from the  <dig> datasets for  <dig> tfs  generally have high information contents . importantly, the known motifs of the chip-ed tfs were found by dreme for  <dig> of the  <dig> datasets, and were generally ranked high by the program, although they were usually not the top hit of dreme , suggesting that it is necessary to consider a sufficient number of returned motifs to include the true ones. moreover, when the datasets of different tfs have significant overlaps, we can identify all the motifs of the chip-ed tfs in all the overlapping datasets. for instance, the dataset gsm <dig> for tf kr is significantly overlap with the dataset gsm <dig> for tf hb, and motifs highly similar to the known binding sites of kr and hb were found in both the datasets . overall, we identified a total of  <dig>  putative motifs corresponding to  <dig> , <dig> putative cres in the  <dig> datasets. these  <dig> , <dig> putative cres contain  <dig> ,398 bp which are  <dig>  times of the genome, but only cover  <dig> %  of the genome, indicating that some of them still overlap with one another. at least one putative cre was found in  <dig>   of the  <dig>  known crms in the sequences . the failure to find cres in the remaining  <dig> known crms in the datasets could be due to the fact that the cres in these crms were not enriched in the datasets. nonetheless, these results strongly suggest that in addition to the cres of the chip-ed tfs, cres of cooperative tfs, and thus at least partial crms are highly enriched in the extended binding peaks. this conclusion is in agreement with an early study based on  <dig> chip datasets in d. melanogaster
 <cit> , and also is supported by two recent studies using human datasets
 <cit> .table  <dig> 
summary of the predictions of cres and crms in the
d. melanogaster
genome at the major steps of the algorithm


each percentage is calculated based on the immediate previous step, except for the overall percentages which are based on the relevant initial step.



prediction of crms by iteratively enriching repeatedly used motif combinatorial patterns
clearly, as we used a rather loose stringency in motif finding to maximally include true motifs, there are inevitably a large number of spurious predictions in the  <dig>  putative motifs identified in the datasets. thus, our algorithm takes these  <dig>  putative motifs as the input, and predicts cres and crms by iteratively enriching repeatedly used motif combinatorial patterns though gradually filtering out spurious ones. specifically, depcrm first identifies highly co-occurring motif pairs  in each dataset by computing a co-occurring score  ) for each pair of putative motifs found in each dataset . as shown in figure 
6a, the distribution of sc is strongly skewed toward right, indicating that there are multiple components of the sc values. the left low-scoring component can be well fitted to a gaussian distribution with a mean and standard deviation  <dig>  and  <dig> , respectively. the motif pairs accounting for this component are more likely to co-occur by chance, and thus they are likely spurious motif pairs. on the other hand, the right high-scoring portion of the distribution is more likely to attribute to true cooperative motif pairs. to find the sc cutoff α by which a maximal number of motif pairs occurring by chance are filtered out while a maximal number of possible true motif pairs are kept, we plotted the proportion of the motif pairs with a sc 
≥ α as a function of α. as shown in figures 
5a and b, when α =  <dig> ,  <dig> , <dig> motif pairs and  <dig>  motifs  were filtered out, while putative cres in only  <dig>  the known  <dig>  crms containing predicted cres were completely left out. thus we selected the motif pairs with sc 
≥ α =  <dig>  as cps for further analysis, thereby discarding the vast majority of presumably randomly occurring motif pairs  and motifs . this results in  <dig>  cps containing  <dig>   motifs  for further analysis, which are presumably enriched for true motif pairs and motifs.figure  <dig> 
setting s
c
cutoff α. a. distribution of co-occurring scores s
c of the motif pairs found in the  <dig> datasets. the curve is a fitting of the left portion of the distribution to a gaussian distribution n. b. the remaining proportions of predicted motifs and known crms as functions of the s
c cutoff α. the vertical line indicates the position of the chosen cutoff α =  <dig>  for selecting co-occurring motif pairs .



to further enrich true motif pairs and motifs, the algorithm identifies repeatedly used cps by clustering highly similar cps in different datasets. to this end, we computed a similarity scores ss ) for each pair of cps, each from two different datasets; and then constructed a cp similarity graph based on an ss cutoff value β . as shown in figure 
7a, with the increase in β, the density of the graph drops rapidly, but the dropping starts slowing down around β = <dig> ; meanwhile the number of nodes  in the graph starts decreasing rapidly around β = <dig>  . thus, we set β = <dig>  to construct the cp similarity graph . applying the markov chain clustering  algorithm
 <cit>  to the graph  resulted in  <dig> cp clusters  containing  <dig>   cps and  <dig>   motifs . thus we further filtered out  <dig>   cps and  <dig>  putative motifs.figure  <dig> 
setting s
s
cutoff β and s
cpc
cutoff γ. a. the density of the cp similarity graph drops rapidly with the increase in the s
s cutoff β, but the trend of decrease slows down around β = <dig> . b. the number of crm in the graph also starts to drop rapidly around β =  <dig> . thus we set β = <dig>  for construing the final cp similarity graph. c. the distribution of cpc co-occurring scores s
cpc are well separated into a low-scoring component and a high-scoring component. the vertical line indicates the s
cpc cutoff γ = <dig>  at the deepest valley between the two peaks, for constructing the cpc co-occurring graph.



next, to identify larger repeatedly used motif patterns, we computed a co-occurring score scpc ) for each pair of cpcs across the datasets in which both the cpcs have motifs. interestingly, as shown in figure 
7c, the scpc scores display a well-separated bimodal distribution, and the low-scoring peak is likely mainly due to random motif patterns, while the high-scoring one is more likely attributable to truly cooperative motifs, thus we considered cpc pairs with an scpc ≥ γ = <dig>   for further analysis. applying the mcl algorithm to the resulting cpc co-occurring graph , gave rise to  <dig> crm components  containing  <dig> cpcs,  <dig>  cps and  <dig>   motifs . the compositions and structures of these  <dig> crmcs are shown in additional file
6: figure s <dig>  each containing 1 ~  <dig> cpcs. overall,  <dig>   of the original  <dig>  input motifs were filtered out by the algorithm , suggesting that at least the vast majority  of the putative motifs found in the datasets are spurious predictions.

as expected, some of the resulting  <dig>  motifs found in different datasets are highly similar and often overlap with one another as demonstrated by the examples shown in figure 
5b. they are likely recognized by the same tfs or closely related ones, thus need to be combined into non-redundant and unique ones. to this end, we iteratively clustered the final  <dig>  motifs based on their similarities , resulting in  <dig> clusters. we consider each cluster as a unique motif and refer to it as a umotif, each containing  <dig> or 2 ~  <dig> highly similar motifs and 255 ~  <dig>  cres . when compared with the known motifs in multiple built-in databases including dmmpmm, idmmpmm, flyreg and fly factor survey using tomtom
,  <dig>  of the umotifs are highly similar to known motifs in d. melanogaster at p <  <dig>  , strongly suggesting that they are likely to be true motifs. as shown in additional file
9: figure s <dig>  a p-value cutoff of  <dig>  is sufficient to identify highly similar motifs. more examples of such umotifs, their constituent motifs and the known motifs hit are shown in additional file
10: figures s5a and 5b. the rest  <dig> umotifs that does not resemble any known motif might be novel ones. examples of such umotifs, their constituent motifs are shown in additional file
10: figures s5c and 5d. furthermore,  <dig> ,  <dig>  and  <dig>  of  <dig> possibly redundant motifs found in the earlier study
 <cit>  were recovered by the umotifs with a p-value cutoff of  <dig> ,  <dig>  and  <dig> , respectively. we replaced the motifs in the crmcs with the umotifs that they belong to, and each of the crmcs is represented by their constituent umotifs. some crmcs contain the same combination of umotifs, thus we merged them in a unique one, resulting in  <dig> crmcs.

genome-wide predictions of cres and crms in d. melanogaster
projecting the cres in these  <dig> crmcs back to the d. melanogaster genome  resulted in a total of  <dig> , <dig> non-overlapping cres with an average of  <dig>  ±  <dig>  bp, with  <dig>   of which being entirely located in cdrs. these  <dig> , <dig> cres cover  <dig> ,115 bp  genome sequence, of which  <dig> ,816 bp  are in ncrs, consisting of  <dig> % of ncrs; the remaining  <dig>  bp  are in cdrs, consisting of  <dig> % of cdrs . by connecting these putative cres , we predicted a total of  <dig>  non-overlapping crms,  <dig>   of which are entirely located in ncrs, and the remaining  <dig>  contain cdrs. these  <dig>  crms cover  <dig> ,159 bp  genome sequence,  <dig> ,944 bp  of which are in ncrs, consisting  <dig> % of ncrs; the remaining  <dig> ,215 bp  are in cdrs, consisting of  <dig> % of cdrs . these putative crms tend to have shorter lengths than those of the known crms . furthermore, the putative crms harbor  <dig> to  <dig> with a median of  <dig> cres, and the distances between adjacent two putative cres are largely similar to those in known crms, except that a small portion of the putative crms tends to have a short distance between adjacent two putative cres . these results suggest that we might have missed certain cres in the predicted crms, particularly at the two ends, presumably due to insufficient information in the limited number of available chip datasets used in this study. in other words, some of our predictions might consist of only a part of real crms with possible missing cres at the two ends of the crm. clearly, in order to make more accurate and complete predictions, more and highly diverse chip datasets are needed.figure  <dig> 
summary of the predicted crms. a. distribution of the lengths of the known and predicted crms. b. distribution of the distances  between two adjacent cres in the known and predicted crms. c. recovery rates of the known crms in the datasets  and the known crms containing a predicted cre  by the predicted crms and the corresponding same number and length sequences randomly selected from ncrs.



to evaluate the sensitivity of our predicted crms, we first computed the recovery rate by the predicted crms of the  <dig>  known crms contained in the datasets. we consider a known crm is recovered if it overlaps with a predicted crm by at least half of its length. remarkably,  <dig>   of the  <dig>  known crms were recovered by the  <dig>  putative crms . by contrast, when the same number and length sequences were randomly selected from the genome region covered by the datasets, only  <dig>  ±  <dig> %   of the  <dig>  known crms could be recovered. the recovery rate for the  <dig>  known crms, in which at least a putative cre was found, was even higher . by contrast, when the same number and length sequences were randomly selected from the genome region covered by the dataset, only  <dig>  ±  <dig> %   of the known crms were recovered. hence, our algorithm has achieved rather a high recovery rate or sensitivity of crm predictions, in particular when a putative cre could be identified in them, even using just the limited number of datasets for only  <dig> tfs. importantly, some of known cres in these recovered crms overlap with our predicted cres. for example, crm containing umotif  <dig> recovers a known crm of gene e; and a putative cre of umotif  <dig> overlaps with the known cre of tf da in the crm, while umotif  <dig> is highly similar to the known motif of da . furthermore, crm  containing umotifs  <dig> and  <dig> recovers the known crm of gene cyce; moreover, umotifs  <dig> and  <dig> are highly similar to the known motifs of hth and kni which also have cres located in the recovered crm, respectively . in addition, many of our novel predictions also have strong experimental data supports thus are likely to be authentic. for example, our predicted crms 3r: <dig> . <dig> , 3r:  <dig> . <dig> and 2r:  <dig> . <dig> share umotifs  <dig> and  <dig>  and they recover the known crms of genes abd-a, jun-realted antigen  and single-minded . it has been shown that these three genes are involved in nervous system development
, and thus are likely to be coregulated. consistent with this, we identified cres of umotifs  <dig> and  <dig> in the regulatory regions of these genes. interestingly, umotifs  <dig> and  <dig> are highly similar to the known motifs of hormone receptor  <dig>  and ladybird early , receptively , and it has been reported that hr <dig> and lb regulate neurogenesis
 <cit> . thus hr <dig> and lb might carry out their functions by binding to the putative cres of umotifs  <dig> and  <dig>  furthermore, we have predicted a crm 2r:  <dig> . <dig> overlaps with the first intron of gene actin57b  containing umotif  <dig> and  <dig>  which are highly similar to the known motifs of tfs myocyte enhancer factor  <dig>  and chorion factor  <dig> , respectively . it has been shown that these two tfs cooperatively regulate actin57b by binding to its promoter region
 <cit> . thus met <dig> and cf <dig> might also regulate actin57b through binding to the putative cres of umotifs  <dig> and  <dig> located in its first intron . therefore, our predicted cres and crms can help biologists identify potential enhancers for genes of interest.

the predicted crms as well as cres in a crm as a whole are more conserved than randomly selected sequences
as functional sequences tend to be more conserved than non-functional ones, to further evaluate our predicted crms and cres, we first compared the average phastcons conservation scores
 <cit>  of the nucleotides in each of the putative  <dig>  crms entirely located in ncrs with those of the same number and length sequence randomly selected from ncrs. the phastcons score is computed as the posterior probability for a nucleotide to be conserved given a multiple alignment of genomes and their phylogenetic tree
 <cit> . as shown in figure 
9a, although the average phastcons scores of both the predicted crms in ncrs and the randomly selected sequences have tri-modal distributions, they are significantly different . specifically, the right peak with very low phastcons scores, which reflects highly conserved sequences
 <cit>  is much larger for the former than for the latter, and the opposite is true for the left peak with very high phastcons score, which reflects highly non-conserved sequences
 <cit> . moreover, the middle peak with intermediate phastcons scores, which reflects neutral to moderately conserved sequences
 <cit> , shifts about  <dig>  to right for the former relative to that for the latter. thus the nucleotides in the predicted crms in ncrs tend to be more conserved than those in the randomly selected sequences. as the spacing sequences between cres in a crm may not necessarily be functional and thus conserved, we next compared average phastcons scores of putative cres in each of the  <dig>  predicted crms in cdrs with those of the same number and length sequences randomly selected from ncrs. as shown in figure 
9b, average phastcons scores of cres in a crm and randomly selected sequences from ncrs also show tri-modal distributions, however again, they are significantly different  in the similar way as for those of the full length putative crms and the corresponding randomly selected sequences . however, there are subtle differences between the two cases: compared to the difference between the peaks for the putative crms and the randomly selected sequence , the right peak for the putative cres is much larger than that of the randomly selected sequences , and the middle peak for the putative cres shift more  to right relative to that of the randomly selected sequences . hence, putative cres in a crm as a whole are much more conserved than the randomly selected ncrs, and also more conserved than spacer sequences in the putative crms. we further compared average phastcons scores of nucleotides in single cres in the  <dig>  predicted crms in cdrs and in the  <dig>  predicted crms in cdrs with those of the same number and length sequences randomly selected from ncrs and cdrs, respectively. as shown in figure 
9c and d, the average phastcons scores of single putative cres in both ncrs and cdrs and those of the corresponding randomly selected short k-mer sequences all show well separated bi-modal distributions, with each peak located near the two extremes  of phastcons scores. this result indicates that nucleotides in single putative cres in both ncrs and cdrs and their corresponding randomly selected short k-mers all tend to have either a very low  or a very high  average phastcons score, implying that the nucleotides in short sequences tend to be simultaneously highly conserved or non-conserved. this observation is consistent with the findings that the d. melanogaster genome is highly compact, and vast majority of its sequences are either negatively or positive selected, and thus are likely to be functional
. however, interestingly, there are striking differences between the predicted cres in ncrs  and those in cdrs . first, the distribution for single putative cres in ncrs is significantly different from that for the corresponding randomly selected sequences , as the right peak of the former is slightly larger than that of the latter , indicating that a small fraction of single predicted cres in ncrs are more conserved than the randomly selected short k-mers. by contrast, the distributions for single putative cres in cdrs and the corresponding randomly selected short k-mers are not significantly different , indicating that single putative cres in ncrs are not more conserved than the randomly selected short k-mers. second, the right peaks for single predicted cres in ncrs and the randomly selected short k-mers are slightly smaller than their own left peaks , indicating that there are slightly fewer conserved short sequences than non-conserved ones in ncrs. by contrast, the right peaks for single putative cres in cdrs and the randomly selected short k-mers are much larger than their own left peaks , indicating that there are much more conserved short sequences than non-conserved ones in cdrs, which is expected as most cdrs are highly conserved. third, the right peaks for single putative cres in ncrs and the corresponding randomly selected k-mers are much smaller than those of single putative cres in cdrs and the corresponding randomly selected short k-mers, and the opposites are true for the left peaks , indicating that short sequences in cdrs are more conserved than those in ncrs as expected. finally, to see the extent to which the original binding peaks  in the datasets were enriched for crms and cres, we computed average phastcons scores of the non-redundant original binding peaks and the cres contained as well as of the same number and length sequences randomly selected from ncrs and ncrs in the binding peaks, respectively. as shown in figure 
9e, the distribution of average phastcons scores of non-redundant original binding peaks was quite different from that of putative crms. in particular, the peak at the score =  <dig> in the latter distribution was almost missing in the former distribution. moreover, the original binding peaks with an average phastcons score > <dig>  even tended to be less conserved than randomly selected ncrs, and the opposite was true for the putative crms, indicating that the predicted crms contains more conserved sequences than do the original binding peaks. furthermore, the distribution difference between average phastcons scores of cres predicted in the original binding peaks and those of randomly selected ncrs with the same lengths is similar to that between average phastcons scores of cres and those of the randomly selected ncrs . thus our predicted cres in extended binding peaks as a whole are of similar quality to the predicted cres in the original binding peaks. in summary, although only a small fraction of the single predicted cres in ncrs are more conserved than the randomly selected short k-mers, predicted cres in a putative crm as a whole and predicted crms are significantly more conserved than the corresponding randomly selected sequences, thus they are highly likely to be functional.figure  <dig> 
conservation analysis of the crms. a. distribution of average phastcons scores of the predicted crms in ncrs and of the same number and length sequences randomly selected from ncrs. the vertical dashed lines indicate the phastcons score cutoffs for highly conserved  and non-conserved  crms. b. distribution of average phastcons scores of all putative cres in a predicted crms in ncrs and of the same number and length sequences randomly selected from ncrs. c. distribution of average phastcons scores of single predicted cres in ncrs and of the same number and length sequences randomly selected from ncrs. d. distribution of average phastcons scores of single predicted cres in cdrs and of the same number and length sequences randomly selected from cdrs. e. distribution of average phastcons scores of the non-redundant original binding peaks in ncrs and of the same number and length sequences randomly selected from ncrs. f. distribution of average phastcons scores of single predicted cres in the original binding peaks in ncrs and of the same number and length sequences randomly selected from the original binding peaks in ncrs.



highly conserved and non-conserved crms regulate distinct classes of genes
to further evaluate our predicted crms, we examined whether or not the highly conserved predicted crms  and highly non-conserved predicted crms   have distinct regulatory functions. to this end, we assigned each of the predicted crms a target gene whose transcription start site has the shortest distance to the predicted crm. thus a predicted crm can only be assigned to a gene, while a gene can have multiple assigned putative regulating crms. a total of  <dig> and  <dig>  genes are predicted as targets of the highly conserved and highly non-conserved putative crms, of which  <dig> and  <dig>  have gene ontology  annotations, respectively. as shown in additional file
13: table s <dig>   <dig>  the putative target genes of the  <dig> highly conserved putative crms are clustered into  <dig> functional groups using the david program
 <cit>  with an enrichment score ≥ <dig>  and p <  <dig>  . intriguingly, these genes are enriched for developmental functions , neurological functions , motility  and transcriptional regulations . on the other hand,  <dig> putative target genes of the  <dig>  highly non-conserved putative crms are clustered into  <dig> functional groups with an enrichment score ≥ <dig>  and p <  <dig> , in contrast to the putative target genes of highly conserved putative crms, these genes are enriched for plasma membrane functions , metabolism , and chemical sensory perception  . thus, the highly conserved putative crms and highly non-conserved putative crms do regulate distinct groups of genes. the results are in excellent agreement with the fact that highly conserved crms are mainly involved in embryonic development in both insects
 <cit>  and vertebrates
 <cit> , while crms for genes with other functions in particular those related to environmental adaptations evolve extremely fast
 <cit> , strongly suggesting that both the highly conserved putative and non-conserved putative crms are likely to be functional. the predicted cres, umotifs, crms, average phastcons scores and putative target genes are stored in a searchable relational database pcrms  for public use. the query results and relevant knowledge are displayed using the ncbi graphical sequence viewer. currently, the algorithm was implemented in perl, and the scripts are available on the pcrms website.

discussion
the recent development of various chip-seq, dnase-seq and faire-seq techniques for locating bind regions of specific tfs, chromatin marks, free nucleosome regions, has provided an unprecedented opportunity for deciphering all cis-regulatory sequences in eukaryotic genomes. these techniques and resulting datasets reveal similar or quite different aspects of cis-regulatory sequences, and have their pros and cons. on one hand, a single epigenomic dataset resulted from dnase-seq, faire-seq, or enhancer mark such as h3k27ac chip-seq provide information of the locations of all functional crms in a cell or tissue type, thus these techniques could be less expensive. however, it is very difficult to predict novel cres of specific tfs from such an epigenetic dataset, since it lumps the potential cres for all tfs active in the cell or tissue type, and tf information is usually unavailable. due to the lack of cre locations, it is also difficult to predict crms at single nucleotide resolution using epigenetic datasets. on the other hand, a tf chip-seq dataset is highly enriched for the cres of the chip-ed tf and of its cooperators, thus all these cres can be potentially identified at single nucleotide resolution in a cell or tissue type. however, as a tf chip-seq dataset only contains location information of cres of the chip-ed tf, a certain number of tfs that are potentially active in the cell or tissue type need to be analyzed to identify all the cres and crms. nevertheless, to fully understand the cis-regulatory genome and also for a wide spectrum of applications, it is necessary to real the exact locations of all cres and crms in the genome. chip-seq datasets for various tf in different cell and tissue types can be the key to the goal.

however, precise identification of cres in the binding peaks from chip experiments is still a challenging computational problem
 <cit> . efforts have been made to narrow down the binding peaks through improving experimental procedures
 <cit> , thereby facilitating the identification of cres. on the other hand, once the binding peak summits of a tf are identified, information about the cres of its cooperative tfs around the summits can provide a good opportunity to identify the relevant crms. with the accumulation of a large number of chip datasets in many important metazoans and plants, it is tantalizing to predict crms around cres of the chip-ed tfs by integrating information in a large number of chip datasets in an organism. in this study, we have explored this idea and developed a novel algorithm depcrm for such a purpose. the algorithm is largely based on the fact that similar tf combinatorial patterns are often repeatedly used to regulate multiple similar or different regulons in different cell types, tissues, developmental stages or physiologically conditions. as the number of possible combinations of tfs is extremely large, depcrm identifies possible real motif combinatorial patterns in a sufficiently large number of chip datasets through iteratively filtering out randomly occurring spurious motifs, thereby effectively reducing the searching space in each step . clearly, in order for the algorithm to make reasonable predictions, the chip datasets have to be sufficiently large and diverse, so that they are likely to include datasets for cooperative tfs in different cell types, tissues, developmental stages and physiological conditions.

using the currently available  <dig> chip datasets for  <dig> tfs in d. melanogaster, the algorithm was able to recover  <dig> % of the known crms in the datasets and even  <dig> % known crms in which a putative cre could be identified . thus our algorithm has achieved rather high prediction sensitivity even only using these limited  <dig> datasets, in particular when a putative cre can be located in the crms by a motif finding tool. although we cannot rigorously evaluate the prediction specificity of the algorithm due to the limited knowledge of crms in the genome, it should not be too low for the following reasons. first, the chance for such high recovery rate of known crms to happen by chance is virtually impossible as indicated by our simulation studies . second, our predicted crms as well as cres in a crm as a whole are more conserved than the corresponding randomly selected sequences . third, the highly conserved predicted crms tend to be located in the close neighborhoods of genes involved in embryonic development , which is consistent with the existing knowledge
. fourth, the highly non-conserved predicted crms tend to be located in the close neighborhoods of genes involved in neural transmission, chemical sensation and metabolism, which is also in excellent agreement with the observations that gene regulatory networks for genes involved in responses to environmental factors tend to evolve very rapidly through rewiring by degrading existing cres , or gaining new cres , a process called cre turnover
 <cit> . this form of genetic changes plays a more pivotal role in functional evolution of organisms than previously thought
 <cit> . therefore, both the conserved and non-conserved putative crms are highly likely to be functional.

as vast majority of known crms are located in ncrs, we did not attempt to predict crms that are entirely located in cdrs, thus, we only allow the extended binding peaks to include at most the adjacent exon . nevertheless,  <dig> % of our predicted crms at least partially include the first or last exon of genes. although putative cres in cdrs are more likely to be conserved than those in ncrs , they are not more conserved than the randomly selected short k-mers in cdrs . therefore putative cres in cdrs are not necessarily under a higher selection pressure than are the randomly selected short k-mers in cdrs. on the other hand, the other  <dig> % of our predicted crms are entirely located in ncrs , and consist of  <dig> % of all ncrs in the genome. interestingly, it has been shown that there are more than three times as many functional ncrs as cdrs in the d. melanogaster genome, because these ncrs are under at least the same level of natural selection as cdrs
 <cit> . in other words, more than 75% of ncrs in the genome are likely to be functional. in this regarding, we have predicted less than half of possible crms in the genome. furthermore, our predicted crms are based on  <dig> combinatorial patterns  of  <dig> identified umotifs. since tfs of the same structural family tend to recognize highly similar motifs
 <cit> , our predicted umotif might correspond to multiple highly similar motifs of different tfs of the same structural family. hence, we may have actually predicted more than  <dig> motifs for some of the  <dig>  annotated tfs in the genomes, and many of them are likely novel motifs. however, our predicted motifs might be far away from covering all the annotated tfs as our predicted crms only cover  <dig> % of ncrs, of which at least 75% are likely to have transcriptional regulatory functions
 <cit> .

nonetheless, our results demonstrate that even these limited  <dig> datasets for just  <dig> tfs can result in highly meaningful predictions of crms and cres genome-wide. in other words, these datasets contain sufficient information for repeatedly used motif patterns as indicated by the significant overlaps of their binding peaks . on the other hand, because these datasets were not generated by random efforts of the community, rather, they are likely biased to well-studied cooperative tfs, and their crms are relatively well documented in the literature. therefore, if the datasets were generated by random efforts and the known crms were characterized by uncorrelated efforts, then we might need a much larger number of datasets to achieve the similar prediction accuracy. moreover, as indicated above, although we have achieved a rather high recovery rate  of known crms with a putative cre, more and diverse chip datasets are needed to further improve the predictions, in particular to predict all crms in the genome. fortunately, with chip-seq techniques becoming routine and the progress of the encode projects, more and more chip-seq datasets will be churned out for numerous and even all tfs encoded in the organisms. thus our algorithm could be very useful for elucidating crms encoded any genome once a sufficient number of diverse chip-seq datasets become available in the organism.

clearly, our predicted result is only a static map of cres and crms encoded in the genome, and for many putative cres in the predicted crms, we may not know their cognate tfs and functional states  in specific cell types and tissues. however, once such a global crms map is available for an organism, it is relatively straightforward to infer the functional states to crms if epigenetic data in a certain cell type, tissue, developmental stage or physiological condition are available, such as chip-seq data for histone modification markers  at active promoters, enhancers and silencers
, and dnase-seq data for nucleosome free regions
 <cit> . in this sense, various epigenetic datasets in different cell and tissue types can complement with tf chip datasets and speed up the process of deciphering the entire cis-regulatory genome of an organism. thus, a future development is to incorporate the epigenetic datasets, hereby predicting the functional states of all the predicted crms in a certain cell type, tissue, developmental stage or physiological condition
. then, it is also possible to predict the molecular, cellular and organismal phenotypes based on the functional states of the crms and their variations among individuals and species, given the recent indication of the importance of crms in determining the phenotypes of organism
.

CONCLUSIONS
the exponentially increasing number of tf binding location data produced by the recent wide adaptation of chromatin immunoprecipitation coupled with microarray hybridization  or high-throughput sequencing  technologies has provided an unprecedented opportunity to identify crms and cres in genomes. however, how to effectively mine the large volumes of chip data to identify cres and crms is a challenging task. we have developed a novel graph-theoretic based algorithm depcrm for genome-wide de novo predictions of crms and cres using a large number of chip datasets. depcrm predicts crms by identifying overrepresented combinatorial motif patterns in multiple chip datasets in an effective way. when applied to  <dig> chip datasets of  <dig> tfs from d. melanogaster, depcrm identified  <dig> and  <dig> overrepresented motifs and their combinatorial patterns, respectively, and predicted a total of  <dig>  crms in the genome. the predictions recover  <dig> % of known crms in the datasets,  <dig> % of known crms containing at least one predicted cre. these putative crms and cres as a whole in a crm are more conserved than randomly selected sequences, thus, they are highly likely to be functional. thus the algorithm can be used to predict crms and cres in other eukaryotic genomes from which a sufficient number of diverse chip datasets are available. all the predicted cres, motifs, crms, and their target genes are available at http://bioinfo.uncc.edu/mniu/pcrms/www/.

