BACKGROUND
as a ubiquitous second messenger, calcium  mediates multiple signal transduction pathways in diverse types of plant responses to biotic and abiotic stimuli  <cit> . transient variations in calcium concentration occurring in the cytosol, nucleus and/or other compartments of the plant cell are believed to transduce extracellular signals into appropriate cellular responses  <cit> . these range from changes in turgor pressure as in stomatal guard cells  <cit> , to the control of apical growth in pollen tubes  <cit>  or the regulation of gene expression  <cit> . one of the most intriguing and well-studied types of ca2+ signaling is the generation of repeated peaks in ca2+ concentration that can persist for relatively long periods of time  and is commonly referred to as “ca2+ spiking”  <cit> .

ca2+ spiking is characterized by distinctive features such as peak shape, amplitude, frequency and regularity, certain of which may confer a degree of specificity in the respective stimulus-response coupling. amongst the best studied examples, the regulation of stomatal closure was demonstrated to be based on peak frequency  <cit> , and in the case of host-endosymbiont signaling differences in ca2+ spiking regularity may be important in the recognition of the bacterial or fungal partner  <cit> .

unfortunately, the detailed characterization of such traits, which contribute to the so-called ‘calcium signature’ of the respective signal transduction pathway  <cit> , is complicated by the intrinsic cell-to-cell variability of the oscillatory response  <cit> . in addition, background noise often masks ‘true’ peaks with clusters of smaller random oscillations. for these reasons, ca2+ spiking analyses always require large data-sets before general trends can be clearly established. as a result, manual large scale analyses and the application of statistical tools is often very time consuming and can lead to the introduction of human operator biases. fully standardizing the analysis is a therefore a prerequisite for correctly analyzing ca2+ spiking signatures.

indeed, many analytical methods have been developed in other areas, such as neuroscience, to analyze and classify the repeated oscillations in a biological parameter such as membrane potential . nevertheless, such analytical processes largely relate peak identification to their regular frequency. since an intrinsic trait in symbiotic ca2+ spiking signals in plants is a variable extent of irregularity  <cit> , such analyses based on peak prediction could not be successfully applied to our experimental data. we therefore chose to try a different approach and analytically characterize the phenomenon by identifying each spike based on its shape and how much this differs from background noise oscillations.

with this aim, we have prototyped original software that performs an automated ca2+ spiking analysis  based on our recent studies where a prototypal computational model was formalized to simulate ca2+ spiking dynamics  <cit> . the casa software that we present here can quickly and reliably analyze large data sets, independently of the instrument or method used for recording the biological signal, and perform automatic peak detection and several statistical analyses. a pipeline chart schematizing data preparation and casa usage can be found in additional file  <dig>  the casa software is coded in gnu octave  <cit> , a high-level interpreted language, and can be run on gnu/linux systems.

to evaluate the software reliability we have applied casa to nuclear ca2+ spiking profiles obtained with root epidermal cells of the legume medicago truncatula. we have chosen two case studies, both based on the induction of nuclear ca2+ spiking by signals released from two symbiotic root-interacting microbes: the arbuscular mycorrhizal  fungus gigaspora margarita and the symbiotic nitrogen-fixing  bacterium sinorhizobium meliloti. legumes can establish mutualistic interactions with both types of root symbionts. the am symbiosis develops inside the root tissues, where living cortical cells are colonized by specialized hyphal structures called arbuscules. in contrast, snf rhizobia colonize specialized root-derived organs, called root nodules, where they convert atmospheric nitrogen into ammonia, that can be later assimilated into organic compounds that can be assimilated by the host  <cit> .

for both am and snf, initial stages of the symbiotic association require reciprocal recognition between the host plant and the respective microbe. rhizobia are identified by the host plant through the perception of secreted lipochito-oligosaccharides  known as “nod factors”  <cit> . recent evidence suggests that the molecules mediating the recognition of am fungi may also be based on chito-oligosaccharides, either lcos   <cit>  or undecorated, short-chain chito-oligosaccharides such as chito-tetraose   <cit> . downstream of their perception, these chitinaceous signals are transduced by a common symbiotic signalling pathway  involving a common subset of plant proteins. one of these proteins, localized in the nucleoplasm, is a calcium- and calmodulin-dependent kinase   <cit> . this key component of the cssp is believed to interpret the respective nuclear ca2+ spiking response which is activated following symbiotic signal perception  <cit> .

am fungi are beneficial to the plant since thay are able to extract inorganic phosphate  and other mineral nutrients from the soil with a higher efficiency compared to the non-symbiotic root system  <cit> . consistent with this, high pi availability in the soil is well known to limit the overall level of root colonization by am fungi  <cit> , although the underlying molecular mechanisms are only starting to emerge  <cit> . furthermore, pi availability has been shown to reduce the plant biosynthesis and secretion of strigolactones, key regulators of presymbiotic fungal development .

in our first case study we have investigated whether the pi concentration in the growth medium also impacts the earliest plant responses to am fungal signals by monitoring nuclear ca2+ oscillations in the host epidermis. our results using casa analysis have allowed us to detect a significant inhibition of presymbiotic signaling in response to high pi levels.

how nuclear ca2+ spiking specifically encodes am- or snf-related signals within the cssp, and how these are then decoded by dmi <dig> to activate the appropriate downstream responses remains unclear. one possibility is that the pattern of the spiking profiles contains the encoded information in the form of a specific ca2+ signature. for this reason the spiking profiles induced in legumes by both am fungi and rhizobia have been the subject of several studies  <cit> . in our second case study we have applied the casa software to analyze the spiking profiles induced by either nod factor or the putative am co <dig> signals in the epidermis of m. truncatula roots. our results underline highly significant differences in the regularity of peak-to-peak intervals, suggesting that this trait could be part of the signature used by the plant cell to discriminate between the two signals.

RESULTS
the casa software
casa software comprises a workflow of programming modules to analyze time-series data. it was prototyped in the gnu octave language on the gnu/linux platform. to run the gnu octave software, the gnuplot graphic utility and zenity/gtk + tools are required.

the computation flow, presented in figure  <dig>  proceeds as follows:

 <dig>  the treatment and control data sets, loaded by the user in the form of text files, are filtered for noise using a polynomial sg filter. the same filtering also provides point by point first and second derivatives. the filtering is controlled by the parameters listed below. in order to fine tune the analysis to the specific characteristics of different experimental systems, all of the parameters can be adjusted by the user via dialogue windows .

 width of the sliding measurement window. this must be an odd value, corresponding to the total number of time points that will be included in the filter window. if n points are considered before and after the filtered point , then w =  <dig> n +  <dig>  in general, a window width covering the maximum peak duration should be selected.

 degree of the approximating polynomial curve. a default value of  <dig>  was chosen to capture peak asymmetry, which is a constant feature in our spiking records, but different values can be entered by the user to best fit any peak shape.

 threshold for peak detection in the function peak
c
. this value determines the threshold in peak height above which an oscillation is identified as a peak rather than background noise. a default threshold is proposed by the software, but again the user can enter a value that provides the best signal/noise discrimination for a specific data set.

 <dig>  the application of the derived peak function to the filtered data is used to obtain an instantaneous indicator of peak occurrence. in the case of the control data set, where only background noise is recorded, this function identifies a number of ‘false’ peaks that will be used in step  <dig> to validate the significance of peaks detected for the treatment data.

 <dig>  the amplitude of each peak in the treatment data set is compared to the amplitude of ‘false’ peaks identified in the control data set. in brief, a peak is validated whenever its amplitude is higher than that measured for a defined percentage of the false peaks from the control data set. such a percentage is defined as a quantile  and can be chosen by the user in the dialog window where the q parameter is requested. a default value of  <dig>   is automatically proposed by the software.

 <dig>  the following quantitative information is then obtained for each data set: number of peaks detected, peak-to-peak intervals . actively-responding cells are defined as those with a minimum of three peaks during the 30 min period of observation. basic statistical analyses are carried out on the output data, including the average waiting time and the waiting time autocorrelation for each sample, as well as the average peak number in the actively responding cells from the whole data set.

after the analysis, the casa software outputs a series of plots as png image files, where the original ratiometric data, the sg filtered curve, and each of the detected peaks  are indicated. figure 2a and b show representative profiles recorded from cells that were treated with either the fungal exudate or sterile distilled water . figure 2c and d show the results of casa software analysis of this data. the original time series  is overlayed onto the sg filtered curve  and the starting points, maximum and ending points are indicated for each detected peak.

an output text file is also created, containing all the results of the computational analysis , such as the peak count for each sample, the identification of “active” vs. “inactive” cells  and the autocorrelation analysis of peak-to-peak intervals . the file includes a legend briefly explaining the meaning of each quantitative parameter.

the casa software is available for download with the supplementary data .

case study 1: ca2+ spiking responses to am fungal exudates as a function of the pi concentration in the fungal and plant growth media
with the aim of studying whether pi availability can influence the early pre-infection steps of the am interaction, and in particular the activation of ca2+ signaling within the cssp, we recorded nuclear ca2+ spiking profiles in epidermal tissues of m. truncatula roots in response to germinated am fungal exudates when both roots and fungus were grown under different phosphate conditions, as described in the methods section and reported in table  <dig> 

2
po
 <dig> 
2
po
 <dig> 
2
po
 <dig> 
starting from the standard conditions  <cit>  where g. margarita spores are germinated in distilled water  and m. truncatula rocs are grown on m medium , we considered three alternative cases where the pi concentration is raised to  <dig>  mm for either the plant  or the fungus  medium, or both .

by applying the casa software to our data we were able to calculate different parameters of the spiking response. firstly, the percentage of ‘actively responding cells  was calculated for each treatment. as reported in figure  <dig>  statistical tests showed that the percentage of responding cells when both the plant roots and the fungus were grown under low phosphate conditions  was significantly higher compared to all other experimental combinations . the average number of peaks in the active cells, directly derived from the casa output file, was also used for comparison. figure  <dig> shows that total peak averages were statistically higher when both roots and fungus were grown under low pi  and statistically lower when both roots and fungus were grown under high pi , confirmed by both kruskal-wallis  and post-hoc tests . since the high pi conditions used in our experiments did not affect fungal viability or spore germination rate , our results indicate that an inhibitory effect of pi is already present during the earliest stages of the interaction that involve the activation of host nuclear ca2+ spiking in response to fungal symbiotic signals present in germinating spore exudates. this inhibition is highlighted by the lower intensity of the ca2+ spiking response  and is most striking when both the plant and the fungus are grown in high pi media.

case study 2: comparison of ca2+ spiking profiles in response to am fungal and rhizobial signals
this case study aimed at identifying quantifiable features in the spiking patterns triggered by either nod factors or co <dig>  the signal molecules that most effectively activate snf- and am-related nuclear ca2+ signaling  <cit> . since early snf and am responses focus on different cell types - root hairs versus atrichoblasts respectively - in this study we have compared root hair responses to nod factors with atrichoblast responses to co <dig>  several examples of typical spiking patterns observed in m. truncatula root epidermal cells in response to s. meliloti nod factor or co <dig> are shown in figure  <dig>  we found that casa was able to quantify significant and consistent differences between the two populations of spiking data sets. it turned out that the most striking differences concerned the time intervals between adjacent peaks . by applying autocorrelation analysis to these values, the software identified a different periodicity, thus providing a quantitative parameter that discriminates the two spiking responses. as presented in figure  <dig>  the distribution of autocorrelation values is significantly different for co <dig> and nod factor treatments . this indicates that the sequence of peak-to-peak intervals in response to nod factor is relatively regular: long waiting times are in most cases followed by long waiting times and short waiting times are followed by short waiting times. by contrast, the co <dig> treatment elicits spiking which is generally characterised by negative autocorrelation values, indicating that most cells alternate short and long waiting times.

for comparative purposes, we have applied the same casa analysis to a data set of ca2+ spiking responses induced in the m. truncatula epidermis by g. margarita exudates prepared in the absence of phosphate . interestingly, the distribution of waiting time autocorrelation values is very similar to that for co4-induced spiking, with no statistically significant difference . this confirms the fact that short-length chitin oligomers can mimic the effect of am fungal exudates in activating the cssp and strengthens the proposal that these molecules are key signals in glomeromycete recognition by their hosts  <cit> .

in conclusion, the casa software has allowed us to quantify significant differences in peak periodicity between the spiking patterns associated with am fungal signaling  and rhizobial signaling .

discussion
the characterization of the molecular dialogues between symbiotic microbes and their plant hosts is of crucial importance in understanding the key recognition processes which precede successful associations. in the case of the endosymbiotic interactions between legumes and either glomeromycetes or rhizobia, research in many laboratories has to a large extent identified the genetic bases of the host mechanisms involved in the perception of fungal and bacterial signals, leading to the characterization of a common transduction pathway, the cssp  <cit> . it has been proposed that distinct signatures exist for the nuclear ca2+ spiking which is at the core of the cssp  <cit> . given the crucial role of pi in the symbiotic nutrient trading between glomeromycota and their host plants  <cit> , growing interest is accumulating around the effects of available pi on the establishment of am  <cit> . the investigation of such processes has revealed a more complex picture than previously envisaged, suggesting the existence of a crosstalk in the plant perception of microbial signals and available nutrients.

ca2+ spiking is the earliest known hallmark of symbiotic plant-microbe interactions and, as an increasing number of research groups focus on these topics, the variability and complexity of the observed spiking profiles is now becoming apparent. as a result, there is a crucial need for reliable tools that allow fast and reproducible analyses of spiking patterns. we propose the casa software as one such tool, and the examples we have chosen to illustrate its usefulness, targeted on two specific biological problems, and based on relatively large data sets, show that this approach can indeed identify and quantify distinct features of spiking profiles which can be used to define ca2+ signatures.

casa software performance
compared to manual peak count and data analysis, the use of casa analysis resulted to be advantageous in terms of both time and reliability. although a few file conversion steps are also required when using casa, the software dramatically reduced the time required for data analysis and figure preparation. we estimated that, excluding image acquisition and confocal data import to a datasheet file, 30 minutes were required for manual peak counting in a set of  <dig> nuclei. casa reduced this time to less than 5 minutes, saving more than 80% of operator time. moreover, casa also provides a few statistical analyses that would further increase the required time if calculated manually.

even if casa can be considered as a prototypal software in its present release, a major effort has been made to simplify usage while at the same time providing direct access to all of the major computational functions implemented in the automated spiking analysis process. for this, the user is presented with a limited number of dialog windows where the key parameters of the analysis can be entered. in all cases default values are proposed which correspond to those that were the most suitable for our studies. nevertheless, by adjusting each parameter, the analysis can be fine-tuned to very diverse types of data. for example, by changing the degree of the approximating polynomial from  <dig> to  <dig>  the software can better detect peaks where asymmetry is less pronounced or totally absent.

in addition to the generation of a text file containing all the results of the analysis, the last step in the casa process includes the rendering of a series of image files where the data are plotted. this graphical representation of the analysis has many applications. first of all it is of great help when adjusting the software parameters to better fit the spiking records. the identification of errors in the procedure is extremely easy since each peak detected can be directly checked with the overlaid original data. secondly, a rapid screening of the output image files allows the identification of individual records which may contain instrument-related mistakes or other anomalies. such records can be easily excluded from the subsequent computation runs by entering their corresponding progressive numbers into the final dialog window entitled ‘samples to be excluded’. this option is also of use when a subset of plots is needed, for example in view of data publication.

as for all software, casa analysis is not error free. in our tests, false positive and negative peaks did occasionally appear even when the analysis parameters were adjusted to give optimal performance. nevertheless, the impact of such rare errors did not modify the final interpretation of any of the global trends that we considered in our case studies. in addition, repeated trials where we compared manual and automated peak counting revealed that manual peak detection varies significantly from one operator to another, and even when the same operator repeats the counting under different conditions. by contrast, casa provides the obvious advantage of full repeatability of the analysis. a typical case where manual peak identification could be ambiguous can be found in the second plot of figure 5b, where an irregularly shaped peak  displays an initial maximum followed by a second weaker oscillation. in our tests, different operators identified either one or two peaks in this shape. by contrast only the first maximum is consistently identified as a peak by casa.

in conclusion we propose the casa software as a versatile tool that can be of help to obtain rapid and reliable analyses of diverse types of oscillatory data, including but not limited to ca2+ spiking.

pi partially inhibits the presymbiotic dialogue in am associations
a number of studies have analysed the physiological and molecular mechanisms that regulate the establishment of the am symbiosis, highlighting the inhibitory effect of high phosphate availability on the extent of root colonization by am fungi  <cit> . here we have investigated whether the presence of high pi in the growth media also affects earlier steps of the interaction, and in particular activation of the cssp during the pre-symbiotic dialogue. our analyses using casa suggest two distinct effects of high pi concentration. firstly, when both symbionts are independently grown under high pi conditions, the root responsiveness to the fungal exudate is significantly reduced both in terms of the percentage of epidermal cells where the nuclear ca2+ spiking signal is triggered and the total number of peaks recorded in responding cells. we interpret this as a partial inhibitory effect of pi on the activation of the cssp. this is a novel observation that suggests that at least part of the known inhibition of root colonization by am fungi under comparable pi concentrations  <cit>  may be due to a reduced pre-symbiotic host response. in further support of this, high pi has also been shown to moderately lower the expression levels of petunia genes acting upstream of ca2+ spiking in the cssp  <cit> .

secondly, when high pi is present only during am spore germination there is also a significantly weaker plant response in terms of average peak number compared to the reference low pi conditions. this suggests that high pi levels not only affect the plant host, but are also perceived by the fungus. the ability of the am fungus to detect extracellular pi availability is perhaps not surprising, if we consider that glomeromycetes are particularly effective in pi scavenging from soils. the implication that the am fungus could in some way limit its own signaling to the host plant under pi-rich conditions is extremely intriguing and certainly deserves further investigation. in line with this,  <cit>  recently demonstrated that pi availability modulates the expression of several fungal genes, including the pi transporter gintpt in the am fungus rhizophagus irregularis. it should be underlined that our reference elp-mlp condition  corresponds to the standard growth conditions that were found to be optimal for in vitro am establishment  <cit> . the identical condition, where spore germination was induced in sterile distilled water, was also recently used to characterize the potential signaling molecules  produced by the presymbiotic mycelium of am fungi  <cit> .

a recent publication  <cit>  also investigated the effects of pi availability on cssp activation with a significantly different setup. part of the study was focused on a later stage of the interaction - after hyphopodium contact. secondly, fungal exudates used to induce ca2+ spiking were only prepared in the absence of pi and from a different fungal species : we currently cannot exclude that the complex connection between am development and pi availability is also dependent on the plant/fungus coupling.

we therefore conclude that pi has a limited but significant effect on host plant perception/transduction of am signals present in fungal exudates from g. margarita. this attenuated ca2+ spiking response in the presence of high pi appears to be due both to fungal and host partners. since the optimal synthesis and secretion of strigolactones, the root-secreted molecules which stimulate pre-symbiotic hyphal branching in am fungi  <cit> , also requires pi deficiency  <cit> , we can now consider that high pi functions as a general negative regulator of the molecular pre-symbiotic dialogue.

specific ca2+ signatures for am and snf?
ever since the discovery that both am fungal and rhizobial signals are transduced by the cssp in legumes  <cit> , the question immediately arose as to the mechanisms by which two different signals could be transduced by the same pathway and activate different downstream responses  <cit> . upstream of the cssp, different receptors are probably involved in binding the respective am fungal or rhizobial signals. although a specific receptor for fungal signals has not yet been identified, this hypothesis is supported by the fact that putative nod factor receptors  are not required for am establishment  <cit> . similarly, downstream of the cssp, different transcription factors are involved in gene regulation during am  and snf . it has also been proposed that a central and essential component of the cssp, the nuclear kinase mtdmi <dig>  is differentially activated when binding ca2+ ions and/or calmodulin  <cit> . this would indeed be in line with the generation of different calcium signals encoding am- or snf-specific information. the spiking profiles induced in snf and am have both been described as combining chaotic and stochastic elements  <cit> , while part of the response-specificity could be related by the type of epidermal cell responding to either am fungi or rhizobia: atrichoblasts and root hairs respectively  <cit> .

the study reported here is based on the hypothesis of  <cit>  concerning the presence of a stochastic component in am- and snf-related ca2+ spiking. stochasticity can be interpreted as evidence for the transmission of a message through a communication channel  <cit> . in this context, we have previously demonstrated the exponential distribution of waiting times in relation to the elapsed time from the initial stimulus  <cit> , in agreement with the theoretically efficient use of a communication channel  <cit> .

we therefore investigated the presence of a repetitive pattern in the sequence of peak-to-peak intervals, as a possible component of the calcium signature. several techniques of pattern recognition can be found in literature which in most cases analyze the conformity of the experimental data to a predetermined pattern model  <cit> . since we had no indication for a precise pattern model that could fit our case, we introduced the calculation of waiting time autocorrelation. this allowed the characterization two distinct trends in the spiking patterns associated with either am fungi or rhizobia.

based on the results presented in this article, we now propose that the explicit mechanism encoding the ca2+-mediated message can be found in the variability of the waiting time. by introducing the calculation of waiting time autocorrelation we have been able to characterize two distinct trends in the spiking patterns associated with either am fungi or rhizobia. in line with the hypothesis of  <cit> , these results provide evidence for a quantifiable trait in nuclear ca2+ signaling that can play a role in the capacity of the legume root epidermis to discriminate between the two symbionts.

CONCLUSIONS
the casa software has been exploited in two different experimental contexts to further our understanding of the molecular/cellular signaling mechanisms underlying the establishment of symbiotic plant-microbe interactions. we therefore propose casa as an attractive platform to face so far unsolved questions concerning ca2+ spiking signals and their modulation. our findings suggest that am fungal signal production could be limited in the presence of high inorganic phosphate levels, since co <dig> production is significantly enhanced by strigolactones  <cit> , it would now be interesting to study strigolactone stimulation of the germinating am spores as a function of different pi concentrations. casa software has also revealed substantial, quantifiable differences between the ca2+ spiking profiles triggered by either nod factor or co <dig>  thus opening the question as to whether such differences remain when roots are treated with myc-lcos, whose chemical structures are more closely related to nod factor  <cit> .

