BACKGROUND
investigating patterns of gene expression using mouse and human microarrays has produced insights into cancer  <cit> , cardiac diseases  <cit> , and metabolic disorders  <cit> . these and many other functional genomics studies rely on full genomic sequence to establish well-annotated databases. yet, microarrays based on est collections are increasingly being used for diverse species, from honey bees to fish  <cit>  and including simple diploblastic organisms  <cit> . these studies within a diversity of organisms provide insights not provided by 'model' species . for example, 'non-model' organisms have provided insight into the natural variation in gene expression  <cit> , social castes among bees  <cit> , hypoxia  <cit> , and physiological responses to variation in the thermal environment  <cit> . to investigate adaptive variation in gene expression we use the teleost fundulus heteroclitus   <cit> .

the killifish fundulus heteroclitus are distributed along the eastern coast of north america which has one of the steepest thermal clines in the world: northern populations have environmental temperatures more than 12°c below southern populations across  <dig> degrees of latitude. migration among populations is sufficient to minimize random genetic drift  <cit>  but not frequent enough to extinguish local adaptation  <cit> . populations are large  and affected by historical, demographic and selective constraints, providing a framework for the partitioning of variation in gene expression within and among populations. additionally, the well-established phylogenetic relationship among fundulus species can be used to discern adaptive changes  <cit> . these characteristics make f. heteroclitus an ideal species to investigate adaptive variation in gene expression.

microarrays from diverse est collections offer opportunities to address many biological problems, but to effectively use this information often requires a locally generated bioinformatics approach. tools like the tigr gene index  <cit>  and unigene  <cit>  provide significant information on many species, yet these databases do not meet the needs of functional genomics projects for many non-model species. currently, tigr and ncbi provide gene indices for  <dig> and  <dig> animal species, respectively. yet, there are  <dig> animal species with more than  <dig>  ests  <cit> . the number of species with ests > <dig>  has continued to grow, and there was approximately a 20% increase in the preceding three months. while annotation from these resources can be accessed through web-based homology searches, for many laboratory collections of ests it is difficult to use existing tools to achieve a systems-level view of gene functions and relationships. rather than simply browsing functional information over the web for a different group's project, laboratories that produce novel est collections and microarrays require customized databases providing access to integrated functional annotation as expression data are being analyzed.

we have developed funnybase to meet these functional genomics needs. funnybase provides functional information for > <dig>  ests from the teleost fish fundulus heteroclitus, provides the means to quickly process, evaluate, and store annotation based on similarity searches of public resources, and integrates these data with species-specific clustering and microarray analysis. perhaps ironically, the greatest challenge for functional annotation based on similarity searches is an overabundance of data. there are a number of databases to chose from, and often the single best hit from a given database search is not the most informative. funnybase implements a strategy to make maximum use of systems-level functional information from gene ontology   <cit>  assignments and membership in metabolic pathways as defined by the kyoto encyclopedia of genes and genomes   <cit> . specifically, several sequence databases are queried and results integrated to maximize the number of annotated sequences. alignments and scores for all homology based associations are tracked, allowing further evaluation and statistical studies.

microarray data using genes annotated in funnybase can be systematically analyzed in the context of biological functions. we present a case study to illustrate how assessment of systems-level annotation can identify statistically significant functional differences among sets of genes.

RESULTS
funnybase  is divided into  <dig> modules: sequence pipeline, hierarchical annotation, and microarray production and analysis. the sequence pipeline takes sequences and quality output files from the sequencer, applies vector screening, quality trimming, clone tracking, and clustering  to produce a set of unique sequences that are deposited in the 'sequence data' and 'cluster data' tables. notice "unique sequences" are a combination of singletons  and clusters of overlapping sequences.

the hierarchical annotation module uses the consensus sequences from the clusters or singletons, and integrates primary annotation such as gene name and description with associated pathways and systems-level functional annotation. this may include gene function , metabolic or signal pathway , or biological function . sequence data from the first module and functional annotation from the second are matched using database similarity searches . e-values, bit scores and local alignments are stored in the 'similarity data' table for all significant matches. one of the strengths of funnybase is the use of different sequence databases  to provide separate annotations. although these databases are not completely independent, the three separate annotations provide verification of gene names.

the third module, microarray production & analysis provides a list of unique genes to be printed and integrates expression data from microarray experiments with the hierarchical annotation module. this provides functional annotation for expression data. funnybase annotation is accessible through the web or through local sql queries and data-mining scripts.

est isolation and sequencing
the overall strategy used to isolate and sequence thousands of fundulus cdnas was  generate a high quality unidirectional cdna library,  normalize the library,  randomly pick colonies and amplify by pcr the cdna within the vector,  sequence and identify pcr products, and  after approximately every  <dig>  clones, subtract these from the normalized library and repeat steps 3– <dig>  details for all protocols are provided at  and were used in the comparative functional genomic course at mount desert island, me  <dig> 

we sequenced  <dig>  ests and  <dig>  of these are available in the dbest database at ncbi  as of june  <dig>   <dig>  sequences in funnybase are identified by a number series: unique sequence number, array number, plate number and well identifier . the remaining  <dig>  un-submitted sequences failed to meet one of the sequence quality parameters. two criteria are used for defining "good" sequences: 1) > <dig> bp of sequence with phred score > <dig> or 2) form an overlapping cluster with other sequences. of the  <dig>  sequences processed with the current version of funnybase,  <dig>   passed one of these quality parameters. in earlier iterations of funnybase, visual inspection and later a sequencer-specific quality measure equivalent to a phred score of  <dig> were used as filters resulting in  <dig>  of the first  <dig>  sequences  and  <dig>  of the next  <dig>  sequences  meeting quality standards, respectively. re-sequences account for  <dig>  sequences, and  <dig>  of these were submitted.

controls
one of the most important steps for producing microarrays from cdna libraries is being able to associate the bacteria containing the cdnas of interest with the est annotation. high-throughput procedures are highly prone to tracking errors including: loading plates into an automatic sequencer in the wrong order, orienting symmetric plates in the wrong direction, or mislabeling of plates. the ability to identify these types of mistakes requires controls for identifying plates and plate orientation. the funnybase system has a number of integrated quality control steps. first, a ctenophore cdna  that is unlike anything else in genbank is used as a control. controls are placed in 96-well plates in wells corresponding to the plate number and two orientation wells . sequences from 96-well plates are automatically scanned for these controls so that the identity and orientation are confirmed and a report is generated for manual review. secondly, all clones used for microarray production are re-sequenced. this is necessary because individual cdnas are cherry picked, re-grown and re-amplified, and each of these steps has the potential to introduce or magnify an error. for example, for a  <dig>  gene array, a 5% error rate would result in  <dig> incorrect clones. re-sequenced array plates are compared using pair-wise blast  <cit>  against previous sequencing results so that the identity of printed microarray spots are verified.

est clustering
est projects generate a number of redundant sequences due to the random selection of cdnas from tissue libraries . clustering redundant sequences is a critical first step of analysis in order to identify genes to target for subtraction. the program cap <dig> by xiaong huang  <cit>  was used to cluster est sequences with a  <dig> bp overlap and  <dig> percent similarity.

funnybase contains a total of  <dig>  est sequences from f. heteroclitus heart and liver. clustering with cap <dig> yields  <dig>  clusters that contain  <dig>  ests . the remaining  <dig>  ests  are singletons. by storing the results of clustering with annotation, funnybase easily identifies these genes and aids in the selection of genes to be used for library subtraction with the goal of picking less common transcripts.

the  <dig> annotated clusters with the most sequences are listed in table  <dig>  in microarray experiments these genes tend to be highly expressed and the fluorescent signal tends to saturate the photomultiplier tube. these genes also serve to verify microarray printing because the predicted spots for these genes have the strongest signal.

the distribution of the number of clusters with two or more ests is depicted in figure  <dig>  although most clusters  in funnybase have two or three-to-four sequences , a small number of highly expressed genes form clusters with a large number of ests. for example, there are three clusters that contain  <dig> to  <dig>  ests and ten clusters that contain  <dig> to  <dig> ests . this distribution is similar to other teleost fish est collections . notice, as more ests are added, clusters tend to get larger  rather than new small clusters growing in frequency. of the  <dig>  killifish clusters, 14% have more than eight ests, yet of the  <dig>  medaka clusters, 48% have eight or more ests. these distributions suggest that adding more est sequences has diminishing returns.

one of the objectives of est projects is to isolate most, if not all, genes expressed in a tissue or organism. the increasing size of larger clusters with more sequencing efforts indicates that strategies to increase the probability of isolating new genes need to be employed. we used two strategies. first, we normalized the library to reduce the differences among expressed genes to less than 10-fold among rare and abundant mrnas  <cit> . using this technique we were able to reduce redundancy in annotated genes from 33% in the non-normalized library to 11% after normalization. second, we targeted specific sequences for subtraction: annotated cdnas with high frequencies were targeted in order to focus effort on picking new, rare sequences. through subtraction we were able to increase the rate of discovery of new annotatable sequences from 24% to 36%. however, analysis of these results indicate that a set of highly expressed sequences, some of which were not subtracted because they were not in the set of annotated genes, still make up much of the est library and should be the focus of future subtractions.

gene annotation
of the  <dig>  unique ests ,  <dig>   were annotated. the distribution of e-values for these annotations is shown in figure  <dig>  most  of these ests have e-values less than 10- <dig>  among the clusters,  <dig>  of  <dig>   <dig>  were annotated as compared to  <dig> of  <dig>   of confirmed high quality singletons. the lower percent of annotated singletons suggests that these are either rare fish-specific genes, or represent otherwise divergent, likely non-coding , regions.

annotations for ests are based on similarity using blastx or blastn  <cit>  to sequences in one of six-public databases: swiss-prot, human unigene, danio rerio unigene, oncorhynchus mykiss unigene, oryzias latipes unigene, or genbank nr. funnybase includes locally parsed copies of these databases in a relational format. thus, all searches are done locally and annotation features beyond the fasta description can be queried. consensus sequences from the fundulus est clusters as well as high quality single unique sequences  are used as query sequences for blast searches against these public databases. the use of consensus sequences, when available, allows sequences that do not contain regions of significant similarity with known protein  to be annotated if they are members of an annotated cluster. all hits with e-value less than  <dig>  and their associated alignments are stored in the database and tracked with any associated functional annotation. users can specify a custom level of significance when assessing the validity of homology based annotation. this record, which goes beyond storing a certain number of 'best hits', is critical because in many cases additional results may have a negligibly lower alignment score, but provide much more useful functional data.

the use of multiple databases increases the total number of annotated ests  as compared with any one source and provides opportunity to compare annotation between all three sources for  <dig>   sequences. genbank nr provided the most number of annotations, but these tend to be less informative . human unigene provided an additional  <dig>  annotations. swissprot provided an additional  <dig> annotations  with  <dig> fewer annotated sequences than the nr. however, swissprot is uniformly well annotated as compared to nr where informative functional annotation can easily be buried by numerous uninformative hits at similar e-values. besides increasing the number of annotations, comparing the annotations from multiple databases ensures that mistakes in the curation can be detected and information such as alternative gene names can be compiled from multiple sources.

systematic functional annotation: kegg and gene ontology
in conjunction with performing similarity searches by blast, funnybase includes locally parsed representations of public databases such as swiss-prot in a relational database format. these databases provide additional information that cross-references other public resources such as go, kegg or omim  <cit>  that are not available in the single fasta description line returned by blast search.

kegg  <cit>  is a unique tool that represents metabolic and signal-transduction pathways both visually and computationally. funnybase links annotated genes to enzymes in kegg pathways based on enzyme commission  numbers. these pathway associations are stored and queries can readily identify genes from a given pathway that show specific patterns of expression. for visual inspection of the pathway, the web interface  links directly to the graphical kegg pathways in which a gene occurs.

of the  <dig>  annotated ests in funnybase,  <dig>  participate in one or more pathways defined by kegg. these  <dig> ests represent  <dig> different pathways. table  <dig> provides a breakdown of the number of ests in funnybase for the  <dig> pathways associated with the largest number of distinct sequences . the extent that a given pathway is represented in funnybase can be used to identify metabolic differences among tissues  <cit>  or in different species.

the gene ontology project  has produced a structured vocabulary in the form of an acyclic directed graph that biologists can use to annotate genes in a systematic manner  <cit> . funnybase includes two non-trivial steps to make the best possible use of go terms. first, many go annotations are lost if only the single 'best hit' from a homology search is considered because go annotation is applied most often to a few model species such as human that may not appear as the single 'best hit' in a list of blast results. funnybase identifies the gene name associated with the 'best hit' blast result and then uses all go annotation associated with hits from the complete blast results that have the same gene name as the 'best hit' and an e-value of e < 10- <dig>  the goal of this approach is to identify annotation associated with a single 'best hit' gene based on results that may come from multiple species  and therefore may have varying degrees of sequence similarity due to phylogenetic distance, but to avoid the problem of selecting an inconsistent set of go terms arising from gene families that share regions of sequence similarity but may have different functions.

secondly, go annotation in public databases tends to annotate sequences with only the most specific go term available, for example rna polymerase ii transcription factor activity, enhancer binding  rather than the more general parent term transcription regulator activity . however, in functional genomic analysis, significant patterns of expression may exist at the more general level of functional description. funnybase takes advantage of the connected parent-child relationship of go terms provided by using the relational database version of go available for download at  to identify such relationships. these data are used to extract the tree of more general go terms related to those provided by public databases. a funnybase script then re-annotates genes with this more complete set of go terms.

of the  <dig>  annotated genes,  <dig>   are assigned one or more go terms with a total  <dig>  go assignments being made directly based on information in public databases such as swissprot. using parent-child go term relationship backtracking, an additional  <dig>  go term assignments were made, resulting in a final count of go assignments of  <dig>  excluding the most general terms that divide go into three categories. thus, on average,  <dig> go terms are assigned to each of  <dig>  annotated genes.

gene scaffolding: clustering of clusters
humans have approximately  <dig>  expressed genes, yet there are over  <dig> , <dig> human unigenes . clearly, these clusters of cdnas greatly overestimate the number of unique genes. similarly, funnybase has multiple clusters for the same gene:  <dig> apolipoprotein i,  <dig> cytochrome oxidase i, and  <dig> vitellogenin clusters. to provide a more precise estimate of the number of unique genes, consensus sequences were queried against the  <dig>  sequences from the human refseq  <cit>  database, then grouped by identical gene symbol. of the  <dig>  fundulus clusters that were similar to a sequence in human refseq ,  <dig>   had distinct gene annotations. this method of clustering clusters by similarity to well-annotated reference sequences provides a method to more accurately define the number of unique genes represented by an est set.

case study: using functional annotation for microarray analysis
as a case study in how functional annotation in funnybase can be integrated with microarray data in a rigorous manner, we used a data set based on a microarray of metabolic genes printed from ests annotated in funnybase  <cit> . statistical analysis of this set of  <dig> metabolic genes identified a set of  <dig> genes that showed statistically significant regression between gene expression levels and temperature along the atlantic coast. that is, among individuals collected from different locations along the thermocline and then acclimated to common physiological conditions for at least nine months before analysis, 17% of the metabolic genes had a linear relationship between the amount of mrna and the environmental temperature these animals evolved in. our hypothesis was that this set of  <dig> genes represents a functionally different set than those genes that do not show regression with temperature. to test this hypothesis we examined the frequency of genes annotated with a given go term in the statistically significant gene set versus the non-significant genes. figure  <dig> shows the relevant proportions in each set for go terms that are represented by  <dig> or more ests in the significant set. for example, the go term amine metabolism  is assigned to 14% of the  <dig> statistically significant genes but only 3% of the non-significant genes . a fisher-exact test indicates these frequencies  represent different underlying distributions . specifically, genes involved in amine metabolism are overrepresented in the set of genes that show regression with temperature as compared with the remaining sequences. this significant increase is found for two other non-mutually exclusive go terms: amino acid and derivative metabolism, and amino acid metabolism . other go terms show a reverse trend although none were statistically significant. for example, ion transport  and cell growth  had few genes with a clinal variation in expression. these data suggest that the functions of genes influence whether they are affected by ecologically interesting patterns of expression .

web interface
the web interface  provides public access to the funnybase system and dataset. searches can query by keyword in annotation, gene name, go term, metabolic pathway, clone or plate id, and blast homology search. all data including raw sequences, cluster memberships, cluster alignments, and alignments with homologous sequences are provided for the user to examine the source of annotations. links associated with each annotation are made to external resources such as go's amigo browser, kegg pathways, swissprot, and ncbi records.

other fundulus sequences
funnybase was constructed to annotate sequences for the analysis of gene expression. it provides identification and annotation for genes in the crawford laboratory with a primary goal of identifying clones useful for the construction of microarrays. as such, other fundulus sequences in genbank are not included. however, funnybase forms the basis of the tigr killifish gene index  that includes publicly available f. heteroclitus sequences.

CONCLUSIONS
customized species specific est databases are available for many species  <cit> . funnybase provides an integrated method to annotate ests with the most biologically relevant set of associations and provides several innovations for the production of ests for microarrays. control sequences are identified in each 96-well plate so that mislabelled or inverted plates are automatically detected. annotations are based upon several different public databases. the multiple annotations provide greater assurance about gene description and greater frequency of annotation than any one database. the most functionally informative innovation of funnybase is the process of culling through numerous primary similarity search results in order to identify links to systematic functional databases in go and kegg. these provide a discrete set of terms that can be analyzed statistically and that are organized into networks that represent biological knowledge of higher-level functional and pathway associations. the range of databases queried by similarity search and the tracking of homology beyond a single 'best' hit maximizes the opportunity to obtain this annotation. a richer set of go terms is achieved by using all hits with e-values less than 10- <dig> that represent the same gene as the 'best hit'. additional go terms that represent more general functions than those found in public annotation are derived through the parent-child relationship of the gene ontology. ec numbers provide links, via kegg, to metabolic pathways and these stored terms can be used to investigate the relationship between gene expression in specific metabolic pathways including cardiac metabolism  <cit> . to provide a more accurate accounting of the number of unique genes, consensus sequence from clusters of ests were queried against the human refseq database and those sequences sharing the same gene symbol are grouped based on this scaffolding information. these approaches use publicly available bioinformatics tools . the application of theses tools in an appropriate framework as outlined in funnybase can be used to create a systems level functional genomics annotation system useful for est databases to study biological processes among a rich diversity of organisms.

