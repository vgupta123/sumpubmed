BACKGROUND
beginning in the late 1990's, construction of a systematic, barcoded gene deletion strain collection in s. cerevisiae set the stage for high throughput functional screening in eukaryotes  <cit> . researchers using that resource developed powerful functional genomics screening approaches, and significantly, introduced the concept of performing complex, pooled population screens to simultaneously interrogate an organism's entire genome to identify drug targets, synthetic genetic interactions and other phenomena  <cit> . similarly, the contemporary development of large libraries of short hairpin rnas  and open reading frame  collections has significantly expanded the research toolkit available for performing mammalian functional genetics in a comprehensive manner  <cit> . the development of such tools, combined with the years of lessons from yeast-based screens suggested that similar genome-wide screens using a 'barcoded pool' screening strategy should be possible in a mammalian context  <cit> . indeed, several groups have demonstrated the impressive ability of pooled rnai dropout screens to identify genes essential to cancer cell proliferation  <cit> . based on these early reports, pooled rnai screens hold great promise for identifying genes important for growth, metabolism, differentiation, dna damage response, sensitivity/resistance to therapeutics and many other processes in both normal and diseased cells.

linking phenotypic changes to gene dosage in a heterogeneous population of cells requires a stably inherited molecular tag, such as a dna barcode, that uniquely associates the phenotype with the perturbagen. a decade of work with yeast and other microbes has shown that dna barcodes are sensitive and quantitative genetic markers that permit cell-based screening in high complexity pooled formats, with subsequent deconvolution by amplification of barcodes followed by microarray hybridization or high throughput dna sequencing  <cit> . in contrast to the yeast knock-out strains, for pooled shrnas and orfs the growth perturbing agents themselves can serve as specific barcodes because they consist of uniquely identifiable dna sequences. this approach has been demonstrated in several recent publications using different shrna libraries  <cit> . for each publication, a different custom array was built and quality controlled, but information on the optimization and validation was limited, and the microarrays were not made commercially available. consequently, researchers interested in utilizing this technology would need to perform resource intensive optimization and quality assurance on a new custom microarray for each shrna library - an approach that is cost-inefficient, and does not promote standardized datasets amenable to high level informatics analysis. in order to facilitate loss-of-function and gain-of-function pooled screens using commercially available gene modulation libraries, we designed and validated a single microarray detection platform for deconvolution of loss- and gain-of-function pooled screens in human, mouse and yeast cells.

one can now easily procure custom microarrays designed to detect novel barcoded libraries. in order to evaluate and maximize the effectiveness of such barcoded platforms, extensive testing and optimization is required. for gene expression studies, extensive development work has already been done for a number of detection platforms and, as a result, they have become straightforward and routine to use. for new custom barcoded systems, similarly rigorous testing, optimization of protocols, and development of quality control standards must be done. this manuscript describes a detailed evaluation and analysis of the performance of the gene modulation array platform  microarray, and carefully optimized protocols for every step of the process from sample preparation to data analysis. in essence, we provide a guide to use the gmap chip as well as highlight the design principles and quality control measures that may be useful for other customized microarray platforms. in addition, we have also developed a software tool  for use in extracting and analysing the data from the gmap.

RESULTS
we designed the multipurpose, cost-effective gmap to enable researchers to inexpensively and comprehensively collect data from genome-scale pooled gene-dosage modulation screens performed in human, mouse, and yeast cells using commercially available gene modulation libraries on a standard platform. specifically, the gmap enables readout of clone enrichments and depletions from pooled screens using the rnai consortium  human and mouse libraries  <cit> , human orf expression pools  <cit> , and pooled screens using gene deletion-associated barcodes or orfs from budding yeast <cit> .

the detection features on gmap are summarized in table  <dig>  the gmap features encompass the entire trc <dig> shrna human and mouse collections and a portion of the greatly expanded trc <dig> collection such that > <dig>  unique shrnas from the trc collection can potentially be assayed in parallel. to achieve this extraordinary density, gmap features were synthesized at a  <dig> μm scale, resulting in a  <dig> -fold smaller surface area than the  <dig> μm features on the trcbc array, a commercially unavailable microarray that was previously generated to perform pooled shrna screens on a subset of the trc <dig> shrna collection  <cit> . we based the design of the gmap shrna features on observations from the trcbc microarray which included three different, but highly overlapping sequences to detect each shrna <cit> . one of these three feature designs was superior to the others in tests using engineered pools with known relative shrna compositions . the gmap chip starts with the best performing feature design and adds one base from the 21-base shrna stem sequence to extend the feature length from  <dig> to  <dig> bases. three identical replicates per shrna barcode feature were included on the gmap microarray. this strategy was used to maximize signal-to-noise and to identify and potentially correct for any subtle shrna processing inconsistencies without significantly impacting specificity.

in order to achieve consistent results, a simple-to-follow standard operating procedure  was developed for preparing samples for hybridization . as part of the sop optimization process, a standardized amount of shrna probe was hybridized to the gmap array. hybridizations were performed with quantities of  <dig> μg,  <dig> μg, and  <dig> μg of purified shrna probe  that was generated from a plasmid pool of  <dig>   human shrnas .  <dig> μg of probe gave the best signal-to-noise ratio and was therefore chosen as the standard quantity for all  <dig> k pool hybridizations. for pools of different complexity, the amount of probe applied to gmap is altered proportionally compared to the  <dig> μg used for  <dig> k pools . in addition to optimizing the quantity of probe, a range of hybridization and washing temperatures were tested using  <dig> μg of  <dig> k shrna pool probe. hybridization was tested at 40°c and 45°c, with washing tested at 30°c and 35°c. hybridization at 40°c, with array washing at 30°c was found to provide the highest probe signal with minimal signal from features corresponding to shrnas not included in the pool .

to assess gmap chip performance with complex shrna populations, probe generated from the  <dig> k human shrna pool or a different  <dig> k mouse shrna pool was hybridized and analyzed. signal intensity histograms and cumulative distribution plots generated from the collected data indicate that the signal intensities for probes corresponding to shrnas present in the  <dig> k pools were well resolved from the background signal of gmap features corresponding to shrnas not present in the pools . the small overlap between the signals for features matched to either of the human or mouse shrna pools versus the features that have no matching shrna in the corresponding pools indicates low rates of library composition errors and cross-hybridization. a surface plot of intensities for all shrna features on the gmap array for the human  <dig> k pool versus the mouse  <dig> k pool indicates that large pools of equal complexity can be easily resolved from each other  and from shrna features not corresponding to either experimental pool .

one major application of pooled shrna screens is to perform negative selection screens, so called "dropout screens", in cancer cell lines to identify cancer-essential genes that represent potential therapeutic targets. to assess the performance of the gmap in deconvolving genome-scale shrna drop-out screens, we first calculated a minimum signal in the reference data for inclusion in analysis. this was accomplished by adding  <dig>  standard deviations  to the mean background log signal measured on human  <dig> k pool hybridizations, yielding a threshold of log <dig> =  <dig>  . consequently,  <dig> % of the shrna signals in the reference data exceeded this threshold and were retained for analysis. we simulated shrna dropout screens by altering the concentration of sub-fractions of the human  <dig> k pool in two different shrna dilution experiments. the first approach utilized four different  <dig> k human pools, each containing the same  <dig>  shrnas. approximately  <dig>  shrnas were present in equal concentration in all four pools, while an identical sub-fraction of ~ <dig>  shrnas were either undiluted , or diluted 4-fold, 16-fold, or 64-fold . distribution plots of shrna log <dig> signal intensity difference between the diluted pools and the even pool demonstrate that the diluted subpools can be distinctly resolved from each other . in a second approach, we constructed a single  <dig> k shrna pool  in which, relative to the bulk population, four distinct subsets of ~ <dig> shrnas each were diluted 2-fold, 5-fold, 10-fold and 20-fold, respectively. similar to the previous experiment, distribution plots of shrna signal difference between diluted pools and the reference population in the even pool demonstrate that the diluted subpools are resolvable . we did observe that the signal reduction in diluted subpools on the gmap chip is not directly proportional to the dilution factor, indicating that changes in microarray signal are not linearly proportional to shrna concentration across the full observed signal range. in particular, the subpool dilution signals are spaced more closely, or compressed, than would be expected for a linear concentration versus signal relationship.

to assess the performance of gmap relative to the lower density and previous generation trcbc array, we amplified shrna probes from genomic dna extracted from human bt- <dig> cells infected with a ~ <dig>  shrna pool of lentiviruses corresponding to all available human shrna features on the trcbc chip, divided the probe and hybridized samples to both trcbc and gmap chips. comparison of signal intensity between the two different array formats revealed a spearman correlation coefficient of r =  <dig>  . this result confirms that moving from  <dig> μm feature sizes to  <dig> μm feature sizes does not cause any significant reduction in signal strength or specificity, agreeing with reported observations on yeast barcode arrays  <cit> .

to compare the bar-seq strategy  <cit>  with microarray detection for shrna barcodes, we used illumina next-generation sequencing technology to enumerate barcodes in the same five human shrna  <dig> k pools described above . sequencing libraries were prepared from these pools via essentially the same approach used for generating labelled shrna barcodes for the gmap array, followed by an additional amplification step to incorporate adapter regions . between  <dig>  million and  <dig>  million mapped sequence reads for each of the five shrna plasmid pools were obtained, yielding a median number of reads per shrna per  <dig> k pool of between  <dig> and  <dig> . notably,  <dig>   of expected shrna sequences were detected in the combined data from all five shrna pools sequenced  and  <dig>   of expected shrna barcodes were detected in the human  <dig> k even pool alone . comparison of the sequence read frequency to gmap intensity signal for shrna barcodes in the even pool resulted in a positive spearman correlation of r =  <dig>  . by omitting shrna clones that were not enumerated in the sequencing data by at least  <dig> reads and with a signal intensity of at least log <dig> =  <dig>  on the gmap array, the correlation improved to  <dig> . while both the sequencing and the chip hybridization methods provide an assessment of shrna relative concentration that is reproducible, the modest level of correlation between the signals for these two types or readouts indicates that they have significantly different relationships to absolute shrna concentration.

a major concern in using large shrna pools with microarray detection strategies is the extent to which cross-hybridization occurs. to address this issue, we measured the frequency of significant signals from gmap shrna features that did not correspond to constituents of a pool of shrna probes. specifically, we examined features corresponding to the  <dig> k mouse pool for signal when the  <dig> k human pool was hybridized. features on gmap that had 100% identity to shrnas in both the mouse and human pools were removed from the analysis. after doing so, we found that only  <dig> of  <dig>   mouse  <dig> k pool features had significant signal . from this finding, we infer that amongst the human shrna features, the cross-hybridization rate from human  <dig> k pooled probe would be similar.

frequency distribution plots of sequencing read counts for the even, 4x, 16x, 64x and 2-20x pools  show similar characteristics to the distributions generated for the same pools by microarray detection on the gmap  with some exceptions. first, the distributions tended to be slightly wider for sequence data. second, the distributions for sequence data exhibit a linear relationship that more accurately reflects the actual experimental dilution of shrnas in the dilution pools. in other words, the distribution curves for sequencing data tend to center over the correct fold-dilution. these observations demonstrate that sequencing barcode pools results in linear, quantifiable signals whereas microarray detection displays nonlinear signal, a behaviour previously observed by pierce et al.  <cit> . in addition, the dynamic range of signal obtained from gmap is compressed relative to deep sequencing . however, these differences aside, overall, gmap detection of shrna sequences was similar to sequencing-based deconvolution in its sensitivity and quantitative reproducibility over a range of shrna concentrations.

microarray experiments have historically suffered from subtle to substantial differences in data produced from the same or similar templates when performed on different dates, by different users, or in different locations  <cit> . a candidate method to enable detection and/or correction of these differences is to include a standard set of synthetic oligonucleotide probes that are "spiked" into array hybridization mixtures in defined amounts. these hairpin spike-in  probes, designed to have identical length and similar sequence characteristics to shrnas, may be used as yardsticks for artifact detection and data normalization methods. we replicated  <dig> clusters of  <dig> hspi features across the gmap . spatially localized signal intensity fluctuations between hspi clusters may indicate potentially poor hybridization or washing performance, contamination, or physical damage to the array surface. as a trial,  <dig> hspi probes were tested in replicate array hybridizations to examine their hybridization characteristics and it was found that they behaved in a dose-dependent manner similar to labelled shrna probes .

to examine gmap performance in a simulated cell screening experiment, two large pools of  <dig>  shrnas, each targeting ~ <dig>  human genes were constructed. for the " <dig> k reference" pool, all of the shrna plasmids were combined at approximately equal concentrations, while a dilution series pool, the " <dig> k dilution", contained four sub-sets of ~ <dig>  shrnas each that were diluted 2-fold, 4-fold, 10-fold or 20-fold with respect to their counterparts in the  <dig> k reference pool. distribution plots of shrna log <dig> signal difference between the  <dig> k dilution and the  <dig> k reference pools demonstrate that the diluted sub fractions are clearly resolvable . we generated lentivirus from the  <dig> k reference and  <dig> k dilution pools that was subsequently used to infect a <dig> cells. genomic dna prepared from these cells containing integrated shrna-expressing cassettes was used as template for probe generation and gmap hybridization. the resulting distribution plots of log <dig> signal difference between the  <dig> k dilution and  <dig> k reference pools post-infection  were very similar to those achieved with probe generated from plasmid template for the  <dig> k pools and  <dig> k pools. a scatter plot comparing data for the  <dig> k reference pool derived from plasmid and genomic dna template reveals excellent correlation  further demonstrating that reliable results can be obtained from pooled cell-based screening experiments with shrna pools spanning essentially the entire human genome with coverage of 4- <dig> shrnas per gene.

to enable pooled orf over-expression screening using the gmap array to detect and quantify orf sequences, we designed features against  <dig>  distinct human orf sequences in the mammalian genome collection  . between  <dig> and  <dig> probes were designed against each orf, with a median of  <dig> probes per sequence. for comparative purposes, we also included up to three additional features found on the human expression profiling affymetrix gene  <dig>  st array for  <dig>  of these sequences. to assess the gmap performance with human orf hybridization, we developed  <dig> plasmid pools of entry clones  from the human orfeome v <dig>  collection that were combined to generate a single master pool. subsequently,  <dig>  orfs were amplified in pooled format with common flanking primers, labelled and hybridized to both the human gene  <dig>  st array and gmap arrays in duplicate . signal for features shared between the two arrays was highly correlated , with similar distribution of signal across the features for each array  and similar signal-to-noise ratios . these results demonstrate that the gmap has robust reporting of orf data, and suggests that the gmap can be used for a number of human gene assays including human orf/cdna overexpression screens.

to compare the dynamic range of signal for huorf and hugene features on the gmap, five different quantities of probe generated from orfeome plasmid pools were hybridized to gmap in duplicate. the resulting data indicated that two-fold changes in probe input produced highly correlated signals across a 16-fold dynamic range , thus we combined huorf and hugene features into one feature set. our methodology to detect orf sequences on microarrays depends on common flanking primers that amplify entire open reading frames. this provides an opportunity to examine the utility of the three sets of orf features on the gmap microarray, including the 22-mer hairpin features designed to detect shrna barcodes. the signal concordance between sequence identity-conserved horf features and shrna features on gmap was interchangeable across the entire spectrum of probe concentrations . this concordance can be further exploited to expand the feature set for each gene to obtain more accurate measurements of orfs in a given hybridization mix, which is particularly important for discriminating isoforms in a polyclonal library of open reading frames.

gmap also contains triplicate copies of features for the collection of ~ <dig>   <dig> nucleotide yeast knockout collection barcodes <cit> , and single copies of ~ <dig>   <dig> nucleotide yeast orf-specific features . the yeast orfs represented on this array are identical to those found on the tag <dig> barcode array with two distinct probes designed against each of  <dig> yeast orf sequences. these features can serve as additional controls as they are non-homologous to the shrna or human orfeome probes on the gmap. the yeast features on the gmap display comparable performance to the tag <dig> microarray  from which they are derived .

a major hurdle to using a new microarray platform is the informatics associated with data extraction and analysis. the gmap chip contains several subsets of features, some of which can be organized as traditional affymetrix feature sets as well as features for interrogation of short input dna sequences . extraction of signal from these arrays can be done with the affymetrix power tool  collection. to help aid adoption of the gmap, we have developed a java application to allow data reorganization, graphical summaries and downstream analysis of the datasets extracted from these arrays . this application makes use of a variety of r and bioconductor libraries . the r functions that we have developed for this analysis will also be available as scripts/libraries to allow end users to work directly in the r environment. the current functionality of the application includes methods to extract signals into a single tab-delimited file for subsets of features and gc-matched background signal, normalization procedures, routines to generate signal ratios against one or more reference chips with options to fine-tune analyses and standard or user-defined annotation files for merging analyzed signal.

CONCLUSIONS
our goal was to develop a comprehensive and standardized microarray platform for quantification of pooled screening results using commercially available gene expression modulation libraries for human, mouse and budding yeast cells. the advantages of a standardized microarray are many-fold. first, a highly validated microarray is invaluable to research labs that want to adopt compatible screening approaches but do not have extensive resources to build, test and optimize a custom barcode microarray themselves. the gmap presents an accessible solution because the obstacle of designing, constructing, and testing of the array as well as development of rigorous sops has already been overcome. second, screening costs are reduced since the gmap supports multiple commercially available functional screening approaches in a single solution. as such, individual labs or facilities do not have to re-optimize hybridization conditions for different microarray platforms, and a single framework can be used for data extraction and quality control analysis. third, a standard microarray permits use of uniform methods across the many laboratories using these gene modulation libraries. lastly, a multipurpose array can serve as a useful validation tool as new technologies for detecting barcodes utilizing deep sequencing mature and become more widely used. to enable facile adoption of the gmap array for large-scale screen deconvolution, we have also provided a series of supplemental protocols and software tools to help extract data from functional screens using commercially available gene modulation libraries.

a thorough comparison of barcode detection strategies for large, complex shrna pools has been lacking in the literature. we undertook such a comparison with pools comprised of ~ <dig>  and ~ <dig>  distinct lentiviral shrnas, the largest such shrna screening pools described to date. we directly compared microarray detection with deconvolution by illumina deep sequencing and conclude that, at least in the current context, data quality is comparable using either method. for many or most users, the array-based read-out is currently more cost-effective on a per-sample basis when costs per sample are tabulated. equally important as cost for many researchers is the turn-around time required for sample preparation, sample run time and data acquisition/processing, which is currently accomplished more rapidly using microarrays. sample run time on the gmap chip spans ~ <dig> hours between probe application, hybridization, washing and scanning. typical microarray platform equipped labs or core facilities should be able to easily accommodate more than  <dig> experimental samples in a typical work-week.

in addition to examining a plasmid pool containing > <dig>  shrna clones, we also simulated a cell-based dropout screen with a larger pool of > <dig>  shrna clones. genomic dna was isolated from each of the transduced populations and shrna barcodes were detected using the gmap. importantly, the resolution of barcode detection was nearly equivalent whether the starting template was from plasmid dna or genomic dna. this experiment demonstrates that with the protocols developed here, the gmap offers an effective and efficient means of screening very large pools in a cellular context. our trials with complex shrna and human orf pools demonstrate that the gmap array is capable of efficiently quantifying human and mouse genome-scale gene modulation screens. as well, the gmap chip detection performance is equally suited for quantifying shrna abundance in lower complexity pools. the gmap array is not limited to use with the pooled reagents described here - in fact, any screen which uses the yeast deletion barcodes or trc shrna sequences as molecular barcodes can be analyzed using the gmap array. further generations of gmap, utilizing even higher feature-count microarrays, could be expanded to include other shrna and/or orf libraries. however, benefits of such an expansion would have to be weighed against the increased cost of such expanded arrays. generating specific arrays corresponding to different shrna libraries might be more efficient and cost effective. in summary, this cost-effective platform provides any academic laboratory with access to a standardized array and a suite of methods and analytical tools to perform systematic genome-scale genetics on mammalian cells.

materials and methods
cell lines and growth conditions
bt- <dig> and a <dig> cells were obtained from atcc and maintained in dmem  + 10% fbs  at 37°c and 5% co <dig> 

hspi probe design
spike-in sequence-feature combinations were selected so that their perfect match tm profiles  would be similar to shrna-feature combinations, but any mismatch tm profiles would be significantly lower than the lowest shrna-feature tm profile. we computed tm only for instances in which spike-in sequences had at least  <dig> bases of sequence identity to known shrna features. sequences could share  <dig> bases of identity anywhere within the designed 21-mer. candidate sequences with fewer than  <dig> bases of identical sequence to any shrna feature sequence were retained without tm evaluation as unlikely to cross-hybridize, and candidate sequences with more than  <dig> bases of sequence similarity were eliminated outright without evaluating tm. the top  <dig> sequences were selected for inclusion as spike-in features on the gmap array.

pooled libraries
all shrna pools and constructs in this study were derived from the rnai consortium lentiviral libraries  <cit>  available from sigma-aldrich and thermofisher-open biosystems. the human and mouse  <dig> k shrna lentivirus plasmid pools were assembled by combining equal proportions of ten sub-pools of ~ <dig>  clones each targeting either ~ <dig>  human or ~ <dig>  mouse transcripts. dilution pools were constructed by the same method, except that diluted sub-pool fractions were reduced in their representation in the  <dig> k pool by the indicated amounts. lentivirus pools were generated from pooled lentiviral plasmid dna.  <dig> k plasmid pools were constructed by combining ~3500- <dig> member shrna sub-pools together. these sub-pools consisted of concentration-normalized plasmid. dilutions were prepared as described for  <dig> k pools. the human orf pool was derived from the human orfeome v <dig>  clones  <cit>  available through thermofisher-open biosystems.  <dig> subpools of plasmid dna were generated from  <dig>  entry clones where each subpool contained ~ <dig> human orfs. a master horf pool was derived from equivalent amounts of each of the  <dig> subpools normalized for the number of horfs in each subpool.

pooled lentiviral infections
 <dig> ×  <dig> a <dig> cells per replicate were infected with either  <dig> k reference or  <dig> k dilution lentiviral shrna pools at an moi of  <dig> - <dig> . after four days of selection in puromycin-containing medium to eliminate uninfected cells, genomic dna was prepared from shrna-containing cell populations .  <dig> ×  <dig> bt <dig> cells were infected with the human shrna pool at an moi of  <dig> - <dig>  after two days of selection in puromycin-containing medium to eliminate uninfected cells, genomic dna was prepared from shrna-containing cell populations.

shrna probe preparation 
to create microarray probe from shrna pools, a master mixture for each sample containing template dna , 2x pcr buffer, 2x enhancer solution,  <dig> μm each dntp,  <dig> nm each oligonucleotide primer ,  <dig> mm mgso <dig>   <dig> units of platinum pfx polymerase , and water to  <dig> μl was created and divided into  <dig> μl aliquots. the amplification reaction was performed by denaturing once at 94°c for  <dig> minutes, followed by x <dig>  68°c for  <dig> minutes, then cooling to 4°c.

when electrophoresed on a 2% agarose gel, it is expected that there should be a preponderance of an apparent 178bp pcr product, and as little as possible of an apparent 225bp product. both bands on the gel represent amplified shrna barcode sequences, but the upper, slower migrating band is composed of two dna strands in a cruciform structure, centered around the palindromic shrna sequence, which is not suitable for further processing into a gmap probe. dna in this structure is resistant to restriction enzyme activity at the xhoi restriction site between the shrna palindrome sequences. application of pcr product containing a mixture of two apparently different products to a denaturing urea gel resolves a single size species of dna . if pcr reactions are favouring cruciform product, reducing the number of cycles in the pcr reaction will favour the linear product . pcr products are immediately purified using the qiaquick pcr purification kit  since long-term storage at 4°c or -20°c enables the conversion of linear product to cruciform dna. the purified 178bp pcr product is then digested with xhoi  for  <dig> hours at 37°c to generate a thermo-stable half-hairpin probe. the digested samples are separated on 2% agarose gels with lanes large enough to accommodate  <dig> μl of sample. using sterile materials, the half-hairpin probes  are excised from the gel and purified using a gel extraction kit . to remove remaining salts, the probe dna may be passed through a pcr cleanup column, and eluted in a final volume of  <dig> μl.

gmap shrna probe hybridization
microarrays were pre-hybridized by one wash with 40°c  <dig> mm naoh, followed by incubation at 40°c for  <dig> minutes with rotation at  <dig> rpm with a second volume of  <dig> mm naoh. the arrays were then slowly washed with 3- <dig> ml 6x sspe,  <dig> % tween  <dig>  followed by filling and incubation for  <dig> minutes at 40°c with rotation at  <dig> rpm with  <dig> % triton x- <dig>  arrays were then emptied, rinsed twice, then filled with 6x sspe,  <dig> % tween  <dig>  and incubated for  <dig> hours at 40°c with rotation at  <dig> rpm.

hybridization solutions consisted of  <dig> μg of probe for  <dig> k shrna pools  in buffer containing 1x mes,  <dig> m nacl,  <dig> mm edta,  <dig> % tween  <dig>   <dig>  mg/ml bsa,  <dig>  mg/ml herring sperm dna,  <dig>  nm biotinylated b <dig> oligo , 10% dmso,  <dig> μm each blocking oligos , and sterile water to a final volume of  <dig> μl. samples in buffer were denatured at 95°c for  <dig> minutes, incubated at 40°c for  <dig> minutes, collected by centrifugation then applied to arrays, which were incubated for  <dig> hours at 40°c at  <dig> rpm. arrays were stained with sape labeling mix , and washed on an affymetrix fluidics station, then scanned. more complete shrna probe preparation and hybridization protocols are included in additional file  <dig> 

illumina sequencing
pcr product was prepared as described above for gmap shrna probe preparation except that  <dig> cycles of pcr were employed when amplifying from pooled plasmid dna. purified pcr product dna was used as a template for a second round of amplification in order to incorporate illumina adapter sequences. each  <dig> μl reaction contained  <dig> ng of template, 2x pcr buffer, 2x enhancer solution,  <dig> μm each dntp, 900nm each for adapter a  and adapter b ,  <dig> mm mgso <dig>   <dig>  units of platinum pfx polymerase, and water to  <dig> μl. the pcr reaction was performed by denaturing at 94°c for  <dig> minutes, followed by x <dig>  68°c for  <dig> minutes, then cooling to 4°c. the resulting 218bp product was purified by electrophoresis in 2% agarose followed by gel extraction. libraries were initially quantified by the quant-it fluorescent assay , and fragment size was confirmed using a bioanalyzer high sensitivity chip in a  <dig> bioanalyzer . libraries were diluted to ~15nm concentration, and concentration was confirmed using commercially available qpcr standard on 1: <dig> dilutions of library samples. dna templates were then diluted to 8pm as per the illumina cbot user guide, and clusters were generated on a single read flowcell using the illumina cbot. each dilution pool was run in a separate lane. using an illumina gaiix instrument, sequence was collected for  <dig> bases using the primer seqshrna .

illumina data processing
raw reads were generated using illumina's offline base caller software . reads that passed quality filtering were extracted from the qseq files and merged into fastq files using a custom bash script. reads were aligned to a synthetic chromosome, constructed by interspersing the hairpin sense strand sequence with 79nt of random sequence, using maq v <dig> . <dig>  <cit>  with default parameters. the synthetic chromosome and hairpin index are available upon request. aligned sequences were matched to individual hairpin ids if the alignment start site corresponded with the correct starting nucleotide of the hairpin sequence  and the maq quality score was ≥ <dig>  this quality threshold allowed one mismatch over the 21nt sequence. if a read mapped to one of the  <dig> shrna barcode sequences duplicated in the shrna library, it was counted once for each of the duplicate hairpin ids. reads were determined in a single replicate experiment, and counts were log <dig> transformed prior to further analysis.

human orf probe preparation and hybridization
human orfs were amplified from the master horf pool where each horf was contained within the pdonr <dig> plasmid. five reactions were carried out in a  <dig> μl volume containing  <dig> μl of 2x phusion flash high-fidelity master mix , 400nm of each primer and  <dig> ng of plasmid. the reaction times and temperature were  <dig> minute at 98°c for  <dig> cycle;  <dig> seconds at 98°c,  <dig> seconds at 60°c, and  <dig> minutes at 72°c for  <dig> cycles;  <dig> minutes at 72°c for  <dig> cycle. the sequences of the forward and reverse primers specific for the cloned human orfs were 5'-cacgacgttgtaaaacgacggccagtc-3' and 5'-gagctgccaggaaacagctatgaccatg-3' respectively. pcr products were purified  and pooled. purified pcr product was biotinylated  using a bioprime dna labelling kit  and unincorporated biotin-14-dctp was removed by passing the samples through sephadex g- <dig> columns . microarrays were pre-hybridized by adding  <dig> μl of hybridization buffer and incubating for  <dig> minutes at 45°c and  <dig> rpm. the hybridization mix contained 2x hybridization buffer, 5nm b <dig> oligo, 50x denhardt's solution and biotinylated pcr product. different amounts of labelled probe were added to affymetrix arrays and hybridized at 45°c for  <dig> hours with a rotation of  <dig> rpm. gmap-uts <dig> affymetrix arrays were hybridized with  <dig> μg,  <dig>  μg,  <dig>  μg,  <dig>  μg or  <dig>  μg of biotinylated pcr product obtained from the human orfeome  <dig>  collection. the human gene  <dig>  st arrays were hybridized with  <dig>  μg of sample. probe was hybridized to the arrays for  <dig> hours at 45c and  <dig> rpm. arrays were stained with sape labelling mix , washed on an affymetrix fluidics station and scanned.

gmap data extraction and processing
feature signal was extracted from the gmap and trcbc arrays using affymetrix power tools v. <dig> . <dig> . the gmap chip contains triplicate features per shrna, which we summarized by using the median value. gc-background  correction for non-specific probe binding was performed with apt, using feature signals derived from  <dig>  gc-background probes on the array. normalization of replicate arrays was performed with the bioconductor affy package  in r, using cyclic loess based on the 'ma-plot' of pairs of arrays. distribution plots generated from the raw, gcbg-corrected, and loess-normalized signal intensities demonstrated that gcbg-correction served to increase the differentiation between signal from the features corresponding to shrna pool probes and those features on the gmap without corresponding partners in the probe pool. while normalization reduced the variance between replicates .

web-based tool for gmap
we have developed a java front-end through which this extraction and analysis can be accomplished by users outside our laboratories. the current functionality of the application includes the following:

 <dig>  extraction of signal from a set of affymetrix. cel files into a single tab-delimited file. the extracted signal can be limited to a specific subset of features and gc-matched background signal can be subtracted.

 <dig>  signal across chips can be normalized using a variety of procedures. graphical output is generated for assessment of normalization.

 <dig>  currently, the primary use of this chip is for assessment of strain abundance during pooled growth in a variety of systems that correspond to features on this array. this includes strains with integrated molecular barcodes, transduced with shrna sequences, or horf sequences. the java application includes tools to calculate signal ratios against one or more reference chips with a variety of options available to fine-tune the analysis.

 <dig>  extracted feature signal datasets can be further reduced by limiting to features relevant to specific pools. standard or user-defined annotation files can be merged with the analyzed signal.

this application, r scripts, links to supporting software and examples of use are available on our supplementary website http://chemogenomics.med.utoronto.ca/supplemental/gmap/.

list of abbreviations
apt: affymetrix power tool; dna: deoxyribonucleic acid; gmap: gene modulation array platform; hpsi: hairpin spike-in; huorf: human orf; mgc: mammalian genome collection; orf: open reading frame; shrna: short hairpin rna; sop: standard operating procedure; trc: the rnai consortium; trcbc: the rnai consortium barcode; rna: ribonucleic acid

authors' contributions
all authors read and approved the final manuscript. tk developed gmap shrna protocols , and performed shrna probe amplification. leh  was responsible for gmap design. leh and as developed java-based gmap data extraction tools. leh assisted with data extraction in shrna sequencing experiments. dk prepared shrna probe samples and performed gmap shrna pool hybridizations. krb and jlyk performed provided statistical analysis of shrna gmap and sequencing data. ra, ams, aa performed orf over-expression experiments and analysis on gmap. kb and dk provided shrna reagents. td performed shrna sequencing reactions. gsc and xy prepared trc shrnas,  <dig> k shrna pools and  <dig> k shrna infected cell genomic dna. experimental work was carried out in the labs of gg, der, jm and cn. tk and jm wrote the bulk of the manuscript, with contributions from all other authors. jm and cn directed the project.

supplementary material
additional file 1
contains additional figures s1-s <dig> and the corresponding figure legends.

click here for file

 additional file 2
contains details methods for gmap probe generation and hybridization as well as recipes and reagents.

click here for file

 acknowledgements
this work was supported by the canadian foundation for innovation , the ontario institute for cancer research , and the canadian institutes for health research  and by the canadian cancer society .

we thank members of the rnai consortium  for helpful discussions and support. the authors thank thomas green, tashfeen bhimdi and matthew greene for assistance in the selection and design of hairpin spike-in probes .
