BACKGROUND
membrane transporter proteins, or simply transporters, play crucial roles in living cells, such as importing essential nutrients and exporting toxic cellular metabolites, mediating signal transduction, and maintaining ionic and osmotic homeostasis.

a handful of in-vitro or in-vivo experimental methods have been developed and applied to study transporter mechanisms, such as the patch-clamp techniques for analyzing ion channels  <cit>  and heterologous expression and mutant complementation approaches, which are often coupled with the use of isotopically-labeled substrates  <cit> . these methods are costly and time-consuming, both of which limit their applications in identifying transporters on a large scale. therefore, computational methods are desired for selecting and sorting potential targets on a genome scale prior to laboratory experiments. homology searches against experimentally-determined transporters is heretofore the most common approach in inferring novel transporters, as exemplified by blast searches  <cit>  against the transporter classification database   <cit> . employing this approach, a putative transporter database named transportdb was constructed for hundreds of completely sequenced genomes  <cit> . the wide adoption of tcdb for transporter annotation is due to its unique characteristics. it contains comprehensive information on experimentally-characterized transporters. these transporters are organized within a simple tree structure based on both function and homology, which contains over  <dig> transporter families. the transporter families possess a distinct functional-phylogenetic property, i.e. the members in a transporter family are not only homologous but also share similar transporter mechanisms. other classification systems such as pfam  <cit>  and gene ontology  <cit>  do not have this property. in the pfam system, a specific domain may be contained within proteins of different functions. in the gene ontology system, a transporter may logically belong to multiple transporter terms or functions due to the directed acyclic graphs  adopted to represent relationships among protein functions.

homology methods may reveal new putative transporters, but they can also generate many false positive assignments, due to systematic errors arising from homology inference, since nontrivial functional variations may be induced during gene duplication or domain shuffling  <cit> . for example, paralogs often exhibit distinct functions  <cit> . as a result, more complicated modeling of transporter families have been proposed, including profile based methods like hmmer  <cit>  and pst  <cit> , and machine learning methods like svmprot  <cit> . profile based methods rely heavily on regions of local conservation among family members. however, the level of conservation within many transporter families, such as potassium channels, may be very low  <cit> , which limits the effectiveness of these methods. machine learning methods can sidestep lack of conservation by utilizing quite distinct features such as physicochemical properties and overall composition of amino acids  <cit> . however, both methods, especially the machine learning ones, require many examples of a transporter family for effective modeling, which may be a limitation for many transporter families with few experimentally determined members.

recently, some integrative methods have been reported that incorporate at least two data sources or methods. we proposed a nearest neighbor approach previously which integrated blast, hidden markov model  and topology analysis  <cit> . another transporter annotation pipeline named transaap was launched along with transportdb  <cit> . it searches tcdb  <cit> , pfam  <cit>  and gene ontology  <cit> , and utilizes a couple of empirical rules for decision. though transaap currently works effectively for prokaryotic organisms, it is still weak in handling eukaryotic organisms. therefore, existing computational tools for transporter prediction, including integrative methods, suffer from insufficient predictive coverage or low accuracy. extensive curation efforts are still required for transporter annotation on a genome-wide scale.

here, we present an automatic transporter prediction and characterization system called transporttp which has significantly increased predictive performance than existing systems, including our previous work  <cit> , requiring, therefore, much less manual curation. transporttp utilizes a two-phase classification approach . firstly, traditional homology-based approaches are adopted to search the tcdb database  <cit> , during which pairwise and domain similarities are integrated and initial predictions are made. the phase is similar to our previous approach except that topology analysis is not included  <cit> . secondly, machine learning methods are used to improve the initial predictions, during which both non-homology evidence and homology evidence from other sources are integrated, such as transmembrane segments and the consistency of tc families of the top-k nearest neighbors in tcdb  <cit> , homologs in pfam  <cit>  and gene ontology  <cit>  databases, and non-transporter homologs from swissprot  <cit> . all forms of evidence are converted into features of a refining classifier and rules to discriminate true positives from false positives of the initial classifier are learned from some well-studied model organisms. unlike transapp  <cit> , which integrates evidence by empirical rules, transporttp searches for discriminative rules using machine learning methods, which is more efficient and systematic, since certain types of evidence may be conflicting with each other, or may be biased in different databases, such as pfam  <cit>  and gene ontology  <cit> . thus, manual handling of empirical rules are very difficult to be efficient, but machine learning methods are efficient at searching for the discriminative boundary in a large evidence space.

transporttp was implemented as both linux command lines and a web server. only basic information, such as nucleotide/amino acid sequences, predictive options like training organisms and initial e-value threshold, are required by transporttp for prediction. the predictive results are presented in a user-friendly manner through a web interface, enumerating all evidence used in decision making and providing cross-links from the evidence to related databases for further verification. results are sortable via various criteria selected by the user, to accommodate specific interests or curation emphasis. implementation of the system is very efficient due to the use of parallel computing algorithms among multiple cpus in a single computer and/or computers spanning a local network.

RESULTS
data and performance assessment
the databases for implementation and testing of transporttp were downloaded in september  <dig>  the tcdb  <cit>  for the initial classifier consisted of  <dig>  transporters within  <dig> tc families/superfamilies, of which  <dig> possessed at least  <dig> members with corresponding hmms. the terms of family and superfamily are alternatively used in this manuscript because they mix in the third taxonomic level of the tc system. if a superfamily exists in a hierarchical branch, the superfamily was studied rather than its constituent tc families. pfam   <cit> , gene ontology   <cit>  and swissprot   <cit>  databases contained  <dig>  domains, and  <dig>  and  <dig>  curated sequences, respectively. eleven organisms were chosen for cross-validation of transporttp, including seven model organisms , and four non-model organisms . sequences and functional annotations of the eleven organisms were acquired from ncbi, except for s. cerevisiae and o. sativa, which were obtained from sgd ftp://ftp.yeastgenome.org/yeast/data_download/sequence/genomic_sequence/orf_protein/archive/ and jcvi ftp://ftp.jcvi.org/pub/data/eukaryotic_projects/o_sativa/annotation_dbs/pseudomolecules/version_ <dig> / respectively. five plant organims were chosen for case studies, including sorghum bicolor, populus trichocarpa, vitis vinifera, physcomitrella patens and chlamydomonas reinhardtii. the genomic sequences of the five plant organisms were downloaded from jgi microbial genomics ftp://ftp.jgi-psf.org/pub/jgi_data, except for vitis vinifera, which was downloaded from genoscope http://www.genoscope.cns.fr/externe/download/projets/projet_ml/data/annotation/vitis_vinifera_peptide_v <dig> fa.

three measurements were applied in the performance assessment of transporttp. the first was recall, defined as the proportion of transporters in test sets which were exactly categorized by transporttp with the same tc family or superfamily. the test sets were either transportdb  <cit>  in cross-validations or curated transporters in case studies. the second measurement was precision, defined as the proportion of predicted transporters by transporttp which exactly matched the test sets in tc family/superfamily. the third measurement was balanced accuracy, which was the overall assessment of a single test and was defined as:   

these three measurements are also known as sensitivity, selectivity, and f-measure, respectively. the average value of each measurement on multiple testing organisms reflects the predictive performance of transporttp on the specific training organisms. specificity and the receiver operating characteristic curve were not used in our assessment because non-transporters are much more than the transporters, making them less informative.

cross-validation test
the performance of transporttp was tested by two cross-validation schemas:  leave-one-in  cross-validation, i.e. choosing the proteome of one model organism for training and the proteomes of other ten organisms for testing;  leave-multiple-in  cross-validation, i.e. choosing the proteomes of all seven model organisms for training and only the proteomes of the four non-model organisms for testing. redundant protein sequences with a similarity of 40% or above were removed during the training to avoid potential overestimation of prediction accuracy. transportdb  <cit>  was used as a benchmark transporter database in the cross-validation.

the leave-one-in cross-validation intended to examine whether the classification rules learned from one model organism can effectively predict transporters in other organisms. s. cerevisiae  was chosen as an example organism in our analysis with e-value threshold set to  <dig> , since the best predictive results were often achieved around this e-value threshold for most training organisms. the cross-validation results of the example are shown in table  <dig>  on average,  <dig> %  of the curated transporters of the ten non-yeast testing organisms in transportdb were exactly predicted by transporttp. the exact matches accounted for  <dig> %  of the predictions and corresponded to a balanced accuracy of  <dig> % as well. besides, there were  <dig> % of predictions validated by a text mining program through the comparison of functional annotation along with the protein sequences . those predictions were not counted in the stringent assessment but they might be bona fide transporters excluded by transportdb  <cit> . the mismatch at superfamily or family level between our predictions and transportdb was only  <dig> % among the predicted population. only a slight difference in performance was observed between model and non-model organisms, with the balanced accuracy of  <dig> % and  <dig> %, average recall of  <dig> % and  <dig> %, and average precision of  <dig> % and  <dig> %, respectively. this result indicated that the over-representation of transporters of model organisms in the training datasets did not influence significantly the predictive accuracy due to efficient avoidance of overtraining by the support vector machines  <cit>  applied in the refining classifier. on the contrary, other factors such as evolutionary distance between the training organisms and the testing organisms may contribute more to the difference of predictive accuracy. the performance between model and non-model organisms training on other individual organisms also supports this hypothesis .

 the proteome of the yeast was used for training and the ten non-yeast proteomes were used for testing at the e-value threshold of  <dig> . transportdb was chosen for the benchmark transporter database. the "matches" column represents the number of proteins predicted by transporttp and curated by transportdb with the same tc family or superfamily . the "mismatches" column corresponds to the number of proteins predicted as transporters by both methods but with conflicting tc classification. the column of "transportdb unique" is the number of proteins annotated by transportdb but absent in the predictions of transporttp. the number of "text mining validated" corresponds to the number of proteins not annotated by transportdb but predicted by transporttp and validated by our text mining program through the functional annotations together with protein sequences.

predictive performance differed significantly between major transporter classes. the best performance was achieved for carriers, followed by channels, and finally primary active transporters. more specifically, transporttp achieved a balanced accuracy of  <dig> % on  <dig> carrier families,  <dig> % on  <dig> channel families, and  <dig> % on  <dig> primary active transporter families that transportdb reported on the ten non-yeast testing organisms, at the e-value threshold of  <dig>  . this difference in performance is likely due to factors such as distinct transporter mechanisms within transporter classes, other than difference in sequence divergence in transporter families, since the correlation between the balanced accuracy and sequence identity of the predicted families/superfamilies on the ten testing organisms was  <dig> , a weak correlation.

the complete results of leave-one-in cross-validation tests at the e-value threshold of  <dig>  are shown in figure  <dig> and additional file  <dig>  although the performance varied with respect to various training and testing organisms, it can be summarized as follows:  the average balanced accuracy was  <dig> % among  <dig> cross-validations , of which  <dig>  cross-validations had a balanced accuracy of over 80%. if e-value thresholds were variable for specific training and testing organisms,  <dig> out of the  <dig>  cross-validations achieved a best balanced accuracy of over 80%;  e. coli yielded the worse performance among the seven training model organisms because it was the only prokaryotic organism used for training. c. elegans had the worst testing performance for most training organisms probably due to the poor annotation of this organism, as reflected by many un-annotated proteins in ncbi;  the performance of a testing organism was greatly influenced by the evolutionary distance to the training organism. the diagonal elements in the figure generally served as the performance peaks since they correspond to zero evolutionary distances between training and testing organism.

the leave-multiple-in  validation results using all model organisms for training and the four non-model organisms for testing are shown in table  <dig> and additional file  <dig>  two fold results were observed from the comparison of this approach with leave-one-in  approach using individual model organism for training. the lmi approach achieved better balanced accuracy on the four non-model testing organisms than the loi approach using c. elegans, d. melanogaster, h. sapiens and e. coli for training, but comparable to that using s. cerevisiae, a. thaliana and o. sativa for training. for example, the lmi approach achieved comparable balanced accuracy  to that yielded by the yeast alone  in the loi approach. nevertheless, the maximal loss of balanced accuracy using all model organisms for training was  <dig> %, compared with any individual organism for training at the same e-value threshold, therefore, it seems to be a good trade off using all model organisms for training if no well-studied model organism exists.

the proteomes of seven model organisms were used for training and proteomes of four non-model organisms were used for testing at the e-value threshold of  <dig> . transportdb was chosen for the benchmark transporter database. the definition of the columns can be referred to table  <dig> 

comparative study of performance
the performance of transporttp was also studied by comparing it with other approaches, using at a broad range of e-value thresholds between  <dig> and 1e- <dig>  to reveal the comprehensive characteristics of transporttp and alternative strategies.

firstly, transporttp was compared with blast search, the approach used widely by biologists, and the integration of blast and hmm, the approach applied in our initial classifier. s. cerevisiae  was again chosen as an example training organism for analysis. the comparative results are shown in figure  <dig> and figure  <dig>  transporttp significantly outperformed both blast search and blast plus hmm, as measured by precision versus recall over a wide range of e-value thresholds . superior performance of transporttp versus blast plus hmm demonstrates the value of integrating various transporter-related evidence in the refining classifier of our method. figure  <dig> also demonstrates the value of integrating hmm models with blast search in the initial classifier of transporttp since blast plus hmm was always superior to blast alone.

the advantages of transporttp are further demonstrated in figure  <dig>  which shows the average balanced accuracy of the ten non-yeast testing organisms versus e-value thresholds adopted in the initial classifier. transporttp outperformed both blast plus hmm and the blast search alone in balanced accuracy, especially at commonly used e-value thresholds. at the threshold e-value  <dig>  transporttp outperformed blast plus hmm by  <dig> %. the great increase of balanced accuracy resulted from an increase of precision from  <dig> % to  <dig> % along with a relatively small decrease of recall from  <dig> % to  <dig> % . at this high e-value threshold, most transporters were covered in the initial classifier, making it possible for the refining classifier to discriminate the true positives from the false positives. at very low e-value thresholds, many true positives are excluded and few false positives are included, limiting the power of the refining classifier to generate effective discriminative rules.

transporttp was also compared with other reported methods. compared with our previous work  <cit> , which was similar to our initial classifier but included the tms filtering, transporttp achieved a better balanced accuracy of  <dig> % compared with  <dig> % in the previous approach. more specifically, transporttp significantly improved the precision from  <dig> % to  <dig> %, with a slight sacrifice in recall from  <dig> % to  <dig> % . compared with svmport  <cit> , transporttp achieved better performance in recall, precision and most importantly, the much larger coverage of tc families, since svmport only achieved an average recall of  <dig> % and an average precision of  <dig> % among five tc superfamilies and three families in an independent evaluation set.

case studies
the performance of transporttp was investigated further using sequences from five model plant oraganisms, based on the availability of whole proteome and their evolutionary divergence. sorghum bicolor , populus trichocarpa  and vitis vinifera  are important agricultural organisms. physcomitrella patens  is a simplest plant model for plant functional evolutionary studies, and chlamydomonas reinhardtii  is a single-cell green alga organism, representing the group from which land plants evolved. these organisms span a large part of the plant family tree, from single-celled to vascular plants, including monocots to dicots, so that the performance on these organisms should reflect the performance of transporttp on plant transporters in general. finally, although most of these organisms were recently sequenced, they lack good annotation for membrane transporters  <cit> .

the performance of transporttp on plant organisms was evaluated via the comparison of the predictive results of the program with the manual curation by our biologists. automatic transporter prediction was learned from the model plant organisms arabidopsis thaliana at an e-value threshold of  <dig>  to cover as many transporters as possible. manual transporter curation was carried out via human review of all transporter-related evidence from candidate proteins, specifically transmembrane proteins and homologs of tcdb transporters. the evidence included all data utilized by transporttp, such as predicted membrane topology, presence of homologs in tcdb  <cit> , conserved pfam domains  <cit> , gene ontology terms  <cit> , and presence of homologs in swissprot database  <cit> . in addition, evidence which was difficult to manage by automatic prediction, such as annotation of homology hits in the ncbi nr-refseq database  <cit> , were also reviewed. curated putative membrane transporters were organized into confidence levels based on types of confidence for the classification. level one corresponded to the highest confidence, in which almost all expected pieces of evidence for a transporter superfamily/family supported the classification. level two corresponded to a moderate confidence, where a minor piece of evidence was conflicting or missing . level three corresponded to the lowest confidence level, in which multiple types of evidence or an important evidence were missing , raising doubts about the transporter functionality or gene annotation. the union of level-one and level-two confidence levels was considered as a benchmark for manual curation of membrane transporters, while the level-three was only taken as reference and disregarded in further analysis. the detailed results are hosted at http://bioinfo <dig> noble.org/transporter/model.htm.

the comparative results for manual curation versus automatic prediction of transporters for the five plant organisms are shown in table  <dig>  on average,  <dig> % of putative transporters curated manually for the four plant organisms, excluding the green alga, were exactly predicted by transporttp. the exact matches accounted for  <dig> % of the automatic predictions. another  <dig> % of automatic predictions exactly matched manual curation with level-three confidence, which may also include some bona fide transporters.

the manual curation and automatic prediction by transporttp were compared in five plant organisms at the e-value threshold of  <dig>  the column of curated is the number of transporters manually curated with confidence level  <dig> or level  <dig>  the fourth column corresponds to the number of predictions matched the curation with confidence levels  <dig> and  <dig>  the last column is the proportion of predictions matched the curation with confidence level  <dig> 

predictions of the green alga were less successful presumably because of the evolutionary distance from arabidopsis, the training organism. nevertheless, transporttp still achieved a recall of  <dig> % with respect to the manual curation approach and a precision of  <dig> % on the automatic prediction. compared with transportdb which includes p. patens and c. reinhardtii, transporttp achieved a recall of  <dig> % and a precision of  <dig> % on p. patens at an e-value threshold of  <dig>  and achieved a recall of  <dig> % and a precision of  <dig> % on c. reinhardtii at an e-value threshold of  <dig>  . the results demonstrate a solid performance of transporttp in predicting transporters on plant organisms using a model plant proteome for training.

further investigation of the comparative results revealed that the confidence levels of manual curation were correlated with their recall of transporttp on the groups. specifically,  <dig> %,  <dig> % and  <dig> % of curated transporters in confidence levels  <dig>   <dig> and  <dig> were exactly predicted by transporttp, respectively, on the five plant organisms explored . the low recall made by transporttp for confidence level  <dig> does not deny the effectiveness of transporttp, since the manual curation could not reliably assert this group of potential transporters into superfamilies/families, indicating major problems for classification of these proteins.

discussion
we adopted stringent assessment in the cross-validation of transporttp, where only predictions matching with curated transporters in transportdb were counted in correct ones during the training and the testing. however, transportdb manually excluded some categories of transporters  <cit> , resulting in these transporter categories incorrectly trained and undetectable in the testing for any genome being annotated. therefore, if the coverage of the benchmark database improves, the predictive performance will be further increased, both for the cross-validation and for case studies.

we did not adopt the standard k-folds or leave-one-out cross-validations but instead, used leave-one-in strategy, because the underlying transporter mechanisms in different organisms may be distinct although they share very large similarity. for example, the distribution of transporter families and the gating mechanisms of transporters are likely to be different between prokaryotic and eukaryotic organisms  <cit> . thus, the combination of multiple organisms for training a classification model may not always increase the predictive accuracy, as shown in additional file  <dig> 

we did not adopt traditional support vector machine  but used an ensemble and balanced svms in the refining classifier, to handle the unbalanced data produced by the initial classifier. the comparative results of using traditional support vector machine   <cit>  without the ensemble and balanced technology are shown in additional file  <dig>  although transporttp with and without the ensemble of balanced svms achieved almost equivalent balanced accuracy with respect to the same e-value threshold used in the initial classifier, transporttp outperformed traditional svms measured by precision versus recall, especially when the initial predictions were highly imbalanced with true and false positives. similarly, the ensemble and balanced techniques brought improvement to precision versus recall for decision trees like cart  <cit> . however, the balanced random forest of decision trees  <cit>  was not adopted in transporttp because of its over-training on model organisms and unstable performance, as shown in additional file  <dig> 

despite of the effectiveness and efficiency, some potential pitfalls of transporttp exist. firstly, although non-homology pieces of evidence contribute significantly to the performance, sequence homology still plays a nontrivial rule in the inference of novel transporters. if some proteins are very similar to transporters but in fact they are not transporters, for example, receptors or sensors, which evolved from transporters but diverged functionally since the evolutionary split  <cit> , they may be annotated as transporters incorrectly. fortunately, the inclusion of characteristic features such as presence of conserved domains and number of transmembrane segments in our method may help distinguishing these proteins from the transporters in a great extent.

secondly, transporttp targets on individual transporters rather than multimeric transporters, which are complex functional structures assembled from products of multiple genes. for example, human tap transporters dimers  <cit> , while glutamate transporters are trimers  <cit> . for those multimeric transporters, each polypeptide chain is classified individually into a transporter family according to the characteristics assigned for the chain, even when some other chains are not found to complete the transporter function. we opted to offer the possibility for the researchers to find the whole multimeric transporter structure, which would require further analysis such as examining the interactions among the chains and functional evolution of each chain.

thirdly, transporttp generally relies on complete protein sequences for classification, since partial sequences will introduce doubts on functionality of the gene/peptide, thus being confined to lower confidence levels. when handling partial sequences such as some ests, the classification will depend on the key regions of the proteins available for classification, such as unique conserved domains and transmembrane segments. in a nutshell, the system is built to rely on whole protein sequences, but can be useful for partial sequences, with loss of robustness.

CONCLUSIONS
in summary, the effectiveness and the utility of transporttp has been demonstrated in detail through cross-validation between model and non-model organisms, comparative study with alternative strategies in the cross-validation, and the case studies of plant organisms. transporttp will be of importance for researchers working on annotation of newly assembled genomes, especially eukaryotic genomes, and will probably be used as an additional step for classification of genes/proteins that cannot be clearly classified as transporters by using existing database resources. the approach of transporttp may be of interest for improvement of broad classification tasks, showing how new classification rules can be extracted from sequences through combination of homology and non-homology evidence.

