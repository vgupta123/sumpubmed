BACKGROUND
in any biological system, genotypes contain the information needed to make phenotypes. the relationship between genotype and phenotype is also known as a genotype-phenotype map  <cit> . the ability to analyze different kinds of biological systems computationally has allowed a detailed characterization of genotype-phenotype maps for different systems. one common feature of genotype-phenotype maps is the existence of genotype networks, connected sets of genotypes that adopt the same phenotype. they exist in systems as different as model proteins  <cit> , rna secondary structures  <cit> , regulatory circuits  <cit> , and metabolic networks  <cit> . another feature is the large phenotypic diversity that is found in different neighborhoods of a genotype network  <cit> . these two properties facilitate the exploration of novel and potentially beneficial phenotypes in genotype space. by analyzing genotype-phenotype maps of different systems, one can identify general features of genotype maps, as well as features that are specific to a system.

in this work we concentrate on the genotype-phenotype maps of metabolic networks involved in the utilization of sulfur. we have two aims. aim  <dig> is to examine how general earlier observations about the genotype-phenotype map of carbon metabolism are  <cit> . we do so by examining if these observations also apply to sulfur metabolism. in particular, we investigate the existence of genotype networks whose members share the same phenotype, and the amount of phenotypic diversity in their neighborhoods. aim  <dig> is to study how rapidly evolving populations of networks "discover" metabolic innovations in metabolic genotype space. specifically, we are interested in how the rate of discovery depends on the robustness of a metabolic system. this robustness indicates a metabolic network's ability to preserve its biosynthetic capacity upon random removal of reactions. previous work on macromolecules showed that the robustness of a molecule's phenotype to mutations can accelerate the rate at which evolving populations discover new phenotypes  <cit> . we will ask whether the same holds for metabolic systems.

carbon metabolism comprises so many reactions that the computational demands of studying population processes in its genotype space are too high for current computational technology. sulfur metabolism, in contrast, comprises a smaller number of chemical reactions, which renders the computational analysis of population processes more tractable. despite being involved in fewer reactions, sulfur is no less essential to biological organisms than other elements, such as carbon or nitrogen. sulfur is a versatile and integral element in the biochemistry of organisms  <cit> . its presence in biological organisms ranges from  <dig> % to 50% of dry weight  <cit> . it occurs in multiple oxidation states, ranging from the highly oxidized s4+ to the reduced state s2-. this versatility in oxidation state may explain the diversity of sulfur metabolism and why it is involved in both anabolism as well as catabolism. in catabolism, depending on the environment, sulfur can be used as an electron acceptor or an electron donor, and in some cases even both as donor and acceptor. in anabolism, sulfur must first be reduced in a sequence of energetically expensive steps before being incorporated into biomass  <cit> .

sulfur is present in two major constituents of biomass, the amino-acid cysteine, which confers stability to proteins through disulfide bonds, and the amino acid methionine, which is the first amino acid of many proteins. sulfur is also a part of s-adenosylmethionine . this compound is a cysteine metabolite that is a major methyl donor to the methyl carrier metabolite tetrahydrofolate, which is indispensable for amino acid synthesis, and for the methylation of biomolecules. furthermore, sulfur is the active element in coenzyme-a, an acyl carrier metabolite involved in the calvin cycle and in lipid synthesis. sulfur is also present in the active core of iron-sulfur proteins, which are involved in a number of important reactions. examples include nitrogenase, which enables the fixation of nitrogen, and hemoglobin, which enables the transport of oxygen. another prominent molecule involving sulfur is glutathione, a peptide responsible for protection against oxidative stress in cells.

we next outline the order of our analyses in the results section. first we introduce two concepts that allow us to estimate some properties of genotype space organization. the first is that of a minimal metabolic network. this is a metabolic network from which no reactions can be removed without destroying its viability in a given environment, that is, its ability to synthesize all essential biomass molecules. the second concept is that of a superessential reaction. for our purpose, a superessential reaction is an essential chemical reaction that occurs in all minimal networks. after these preliminary analyses, we demonstrate the existence of long phenotype-preserving paths through metabolic genotypes space that allow exploring this space through many single phenotype-preserving mutations . the maximum length of these paths and metabolic network size can be estimated and varies linearly with the number of superessential reactions. we show that the robustness of metabolic networks depends both on their size and on the average size of minimal metabolic networks viable on a given number of sulfur sources. next, we show that the existence of neutral paths allows evolving metabolic networks to encounter an increasing number of novel phenotypes . we finally explore the relationship between robustness and a population's ability to access novel phenotypes through changes in a network's reactions. in contrast to macromolecules, where robustness may facilitate phenotypic innovation  <cit> , we find that the ability to find novel phenotypes in our system peaks at intermediate robustness.

RESULTS
the model
we follow an approach taken in a previous study of large-scale metabolic networks  <cit> . we define a metabolic genotype as the set of biochemical reactions that may take place in an organism, and that are catalyzed by gene-encoded enzymes. the set of all reactions used in this work is a subset of  <dig> reactions out of  <dig> reactions we curated previously  <cit>  from the kyoto encyclopedia of genes and genomes   <cit> . these reactions comprise all elementally-balanced reactions that involve sulfur containing metabolites .

a metabolic genotype can be represented in at least  <dig> different ways . the first views it as a metabolic network graph whose nodes are metabolites. reactions are represented as directed links from substrate metabolites to product metabolites . the second views it as a list of reactions , or, equivalently a binary vector whose length -  <dig> reactions in our case - corresponds to the number of reactions in a known reaction "universe". each position i in this vector corresponds to a reaction. its values  or  at position i indicate the inability or ability of the organism to catalyze the corresponding reaction .

we define the phenotype of a metabolic network as the subset of sulfur sources  that allow the network  to synthesize all biomass components, if one of the sulfur sources is provided as the sole sulfur source to the organism. we represent this phenotype as a binary vector of length  <dig> whose entry at position i indicates viability if sulfur source i is the sole sulfur source . this is not the only way to define a metabolic phenotype, but it is appropriate for our purpose. an obvious alternative phenotype definition would count the number of biomass metabolites that a network can produce in a given environment. however, because all these metabolites are essential for survival of an organism, networks that cannot synthesize some of them are of limited biological relevance. additional advantages of the phenotype definition we chose are that it allows a straightforward and systematic comparison of phenotypes, and enables us to study metabolic innovation in a biologically sensible way. using this phenotype definition, a metabolic innovation is the ability to synthesize biomass metabolites from a new, previously unusable sulfur source.

to determine metabolic phenotypes from genotypes, we use flux balance analysis  <cit> , a computational method that finds a growth-maximizing steady-state metabolic flux through all reactions in a metabolic network. this method requires information about the stoichiometry of every metabolic reaction, a maximally allowed flux of each metabolite in and out of the environment, and information about an organism's biomass composition . we focus on a metabolic network's qualitative ability to produce all sulfur-containing biomass precursors. we will study networks that are able to do so from each one of a specific set of sole sulfur sources. for brevity, we call such networks viable. we will also refer to the number s of sulfur sources that a metabolic network must be viable on as the environmental demand imposed on the network.

we next introduce the concept of a genotype network for metabolic networks   <cit> . the nodes in this network correspond to individual genotypes  with the same phenotype. two genotypes are linked - they are neighbors - if they differ in a single reaction. a genotype network thus is a network of metabolic networks. this concept is useful when we examine the evolution of metabolic networks through the addition and elimination of metabolic reactions, which can occur, for example, by horizontal gene transfer  <cit> , or through loss-of-function mutations in enzyme-coding genes. consider the metabolic network genotype g <dig> of some organism. this genotype is a node on the genotype network associated with this genotype's phenotype. if some variant g <dig> of this network - obtained through an addition or a deletion of a reaction - has the same phenotype as g <dig>  it will be a neighbor of g <dig> on the same genotype network. in this manner, one can envision phenotype-preserving evolutionary change of metabolic genotypes as a path through a genotype network. such paths correspond to successive hops from genotype to genotype, by way of the edges connecting neighboring genotypes . for our analysis, it will be useful to define a distance >d between two metabolic network genotypes as the fraction of reactions in which two metabolic networks differ, or

 d=1−2rcn1+n <dig>  

where rc is the number of reactions shared by both networks, and n <dig> and n <dig> are the total numbers of reactions in networks g <dig> and g <dig>  respectively. this formula simplifies to d = 1-rc/n when both networks have the same size n..

minimal viable metabolic networks can be diverse and contain many superessential reactions
we begin with an analysis of minimal viable networks, which provides insights into the reactions that are essential to utilize a specific set of sulfur sources. a minimal metabolic network is a network in which all reactions are essential and none can be removed without rendering it inviable. for any one given phenotype p, there may be multiple viable minimal networks. random minimal networks can be generated by starting from a network comprised of all  <dig> reactions - which is viable on all sulfur sources - and eliminating randomly chosen reactions one-by-one, until no reactions can be further removed without rendering the network inviable on the sulfur sources defined by p. we note that a minimal network is not the same as the network with the smallest possible number of reactions with a given phenotype, which could be very difficult to find in a vast metabolic genotype space.

we generated  <dig> random minimal metabolic networks viable on a given number s of sulfur sources . specifically, we generated  <dig> minimal networks for  <dig> random sets of sulfur sources with the same number s - but not necessarily identity - of sources. we note in passing that such networks often also happen to be viable on additional sulfur sources that we did not require them to be viable on . figure 2a shows the distribution of genotype distances for pairs of minimal metabolic networks viable on s =  <dig>   <dig>  or  <dig> sulfur sources. the figure demonstrates that, first, random minimal metabolic networks can be very different from one another. their genotype distance may exceed d =  <dig> , meaning that they may share fewer than  <dig> percent of reactions. second, their average distance depends on the number of sulfur sources a network needs to be viable on. specifically, the average genotype distance is largest davg =  <dig>  for minimal metabolic networks viable on s =  <dig> sulfur source, and decreases to davg =  <dig>  for networks viable on s =  <dig> sulfur sources. third, the distribution of genotype distances is much wider for metabolic networks subject to few environmental demands  where it ranges from davg =  <dig>  to davg =  <dig> , than for metabolic networks subject to many environmental demands  where it ranges from davg =  <dig>  to davg =  <dig> .

many viable sulfur metabolic network genotypes are connected via paths that lead far through metabolic genotype space
we next extended our previous work on carbon metabolism to ask about the existence of genotype networks in the space of sulfur-involving reactions, and of neutral paths that traverse such networks while preserving a metabolic phenotype. we define a neutral path as a series of mutations  that leave a phenotype intact . we emphasize that we do not use the term neutrality in its meaning of unchanged fitness in the field of molecular evolution  <cit> , but merely for brevity, in the sense of preserving viability on a specific set of sulfur sources. changes to metabolic networks such as additions or deletions of chemical reactions can potentially have a positive or negative effect on fitness. the addition of a chemical reaction may have a beneficial effect if it increases the rate at which biomass is synthesized, or it may have a deleterious effect if it generates metabolites that interfere with cell physiology. similarly, the deletion of a reaction may have both beneficial and deleterious fitness effects  <cit> . studies on compensatory mutations in macromolecules, mutations that compensate for the fitness effects of previous mutations with negative effects, show that fitness neutrality is not a prerequisite for a population's genetic change on a genotype network  <cit> .

we are especially interested in two questions. how far does a neutral path typically lead through genotype space? and how does this distance depend on the number n of reactions in a network, and on the environmental demands on the network? to answer these questions, we performed  <dig> random walks of  <dig>  <dig> mutations each for metabolic networks of various sizes, and for various environmental demands. specifically, for networks of each size we performed  <dig> random walks for each of  <dig> different sets of s of sole sulfur sources that we required the network to be viable on. each random walk started from a random initial viable metabolic network comprising n reactions . we allowed n to vary by no more than one reaction during the random walk. moreover, each step in the random walk had to preserve viability. finally, none of the steps was allowed to decrease the distance to the starting network, in order to maximize the distance from this network .

maximal genotype distance and robustness of metabolic networks are well approximated by simple properties of minimal networks
we asked whether the maximal genotype distance of networks of a given size, as well as their robustness to reaction removal can be predicted from properties of the underlying minimal networks. the answer is yes.

  ρ=1+m−nminn, 

here, rse is the number of reactions that are super-essential for a given environmental demand s. we had estimated this number in our previous analysis of minimal networks . the simple relationship of equation  fits our numerical data  remarkably well and corresponds exactly to our distance function when the number of superessential reactions rse replaces the number of common reactions rc between networks of the same size. this implies that the only common reactions between maximally distant networks are the superessential reactions. therefore, as the size of a network increases, more phenotype-preserving changes become possible. for networks of the smallest size, dmax, systematically overestimates the maximal genotype distance, but it does so by no more than 10% percent. we note that our estimates of maximum genotype distances are only lower bounds, such that this discrepancy may result from our limited ability to find maximal genotype distances accurately. in sum, a simple, linear function of the number of superessential reactions at any one environmental demand s approximates the maximal genotype distance between networks well.

next we examined how network robustness depends on the size of metabolic networks and on environmental demands. we define robustness as the fraction of non-essential reactions in a metabolic network. figure 3b shows the robustness of metabolic networks as a function of network size n and varying environmental demands s on a network. large metabolic networks with  <dig> reactions or more have a robustness ρ > <dig>  for all values of s. for smaller metabolic networks , robustness ranges from ρ =  <dig>  under low environmental demands  to ρ =  <dig>  under high environmental demands . the relationship between ρ and network size n can be explained by noting that ρ = 1-ress/n where ress is the number of essential reactions. we find that ress decreases linearly with increasing metabolic network size  and is described by the function ress = nmin-nm, in this equation, nmin is the average size of minimal metabolic networks  and m is the rate at which the number of essential reactions decreases with increasing metabolic network size . the question why the number of essential reactions ress decreases with increasing size has a simple answer. as one increases the size of a metabolic network by adding reactions and entire pathways to minimal metabolic networks, some reactions may become non-essential because the added reactions create alternative pathways for biomass metabolite synthesis. describing ρ in terms of n, nmin and m, we arrive at the following relation

  ρ=1+m−nminn, 

which is plotted as the solid lines in figure 3b and fits the data very well.

this relationship means that network robustness is a linear function of the ratio nmin/n, whose inverse indicates how much larger a given network is than a minimal network for a given s, and of the rate at which reaction essentiality declines  with increasing n.

the diversity of phenotypes found in the neighborhood of two metabolic networks changes rapidly with their genotype distance
thus far, we have concentrated on the characteristics of individual sets of genotypes viable on a given number s of sulfur sources, and on the genotype networks they form. long paths through a genotype network can contribute to evolutionary innovation in metabolic phenotypes, if many novel phenotypes can be encountered near such a path. we next asked whether this is the case, and how this number of novel phenotypes depends on environmental demands on a network. we consider a phenotype to be novel if it confers viability in a set of new sulfur sources, in addition to those required by the environmental demands imposed on the metabolic network.

we first introduce the notion of a  neighborhood around a metabolic network genotype, which comprises all networks that differ from the genotype by a single reaction . because our genotype space has  <dig> metabolic reactions, each metabolic network has  <dig> neighbors. of all these neighbors, some will be inviable in any given environment , some will maintain the same phenotype, and some will have a novel phenotype while being viable in this environment. that is, they will have gained viability on a new sulfur source. we focus on the latter class of neighbors in this section.

we asked how different are the novel phenotypes in the neighborhood of two metabolic networks g and gk on the same genotype network, where gk is a metabolic network derived from g through k random reaction changes. that is, we determined the fraction of novel phenotypes that occurred in the neighborhood of only one but not the other network. below we refer to it as the fraction of novel phenotypes unique to one neighborhood. if this fraction is very small even for large k, then networks in different regions of a genotype space will have mutational access to similar novel phenotypes. figure  <dig> shows that the opposite is the case. we obtained the data shown during phenotype-preserving random walks starting from an initial network, by recording the fraction of novel phenotypes that occur in the neighborhood of the changing metabolic network, but not of the initial network. every data point is an average over  <dig> random walks each for  <dig> different initial metabolic networks  at every value of s. figure  <dig> shows that the fraction of unique novel phenotypes reaches high values for modest distance between two metabolic networks - small compared to the maximum genotype distance - and does not depend much on the number of sulfur sources s on which viability is required. it also does not depend strongly on metabolic network size . in sum, the neighborhood of moderately different metabolic networks contains very different novel phenotypes.

the ability of metabolic networks to encounter novel phenotypes does not depend monotonically on their phenotypic robustness
the question of how robustness relates to phenotypic variability has raised considerable interest in recent years  <cit> . macromolecules - rna and protein - whose phenotypes are more robust to mutations can access more novel phenotypes than less robust phenotypes  <cit> . this holds for both large and small evolving populations of such molecules, at least in rna  <cit> . we next asked whether these observations are specific to macromolecules, or whether they hold more generally, that is, also for the genotype-phenotype map of metabolic networks.

above we considered the robustness of a metabolic genotype as its fraction of non-essential reactions. analogously, we now consider the robustness of a metabolic phenotype as the average fraction of non-essential reactions of all networks with this phenotype  <cit> . we showed that robustness decreases as networks are required to be viable on more and more sulfur sources . that is, for networks of any given size, the number s of sulfur sources on which they are viable can serve as a proxy for phenotypic robustness. the greater a phenotype's s is, the smaller is its robustness.

when analyzing how evolving populations explore a genotype network, we need to distinguish between two different kinds of populations. the first are populations where the product of population size and mutation rate is much smaller than one. for brevity, we refer to such populations here as small populations. the second are populations where this product is much greater than one. we refer to these as large populations.

small populations are genotypically monomorphic most of the time  <cit> , and effectively explore a genotype network much like a single changing network would, i.e., through a random walk on the genotype network. during such a random walk, the changing network encounters different phenotypes in its neighborhood. we determined the cumulative number of different novel phenotypes found in the neighborhood of a random walker. that is, if a phenotype was encountered twice, either in the same neighborhood, or in a neighborhood encountered during an earlier step, we counted it only once. we did so for networks of varying size n and number of sulfur sources s. specifically, for each n and s, we carried out  <dig> random walks of  <dig>  <dig> mutations each . figure 5a shows the resulting data. the cumulative number of novel phenotypes is a unimodal function of s, indicating that metabolic networks under few and many environmental demands encounter fewer novel phenotypes than under an intermediate number of environmental demands . the cumulative number of novel phenotypes depends strongly on metabolic network size for s <  <dig>  where larger metabolic networks encounter more novel phenotypes throughout the random walk. it is not sensitive to n for larger values of s.

we next examine large evolving populations. such populations are polymorphic most of the time. to model their evolutionary dynamics, one needs to track every individual in the population, unlike for monomorphic populations. we determined the cumulative number of novel phenotypes that are mutationally accessible to a population of metabolic networks evolving on  a specific genotype network. this number can be determined by examining, for each generation, the neighborhood of each individual in the population, and by counting the total number of different novel phenotypes encountered. we simulated populations of  <dig> individuals evolving for  <dig> generations . additional file  <dig> shows the average number of cumulative unique novel phenotypes accessible to a population through generation  <dig>  each data point represents an average and standard deviation over  <dig> simulations . qualitatively, the figure resembles our observations for a single random walk , except that the absolute number of cumulative unique phenotypes encountered is higher in evolving populations.

taken together, these observations show that the number of novel phenotypes accessible to a population does not increase monotonically with phenotypic robustness. it decreases with increasing robustness  for low values of s, and it increases with robustness at higher values of s. additional file  <dig> demonstrates this relationship in a  <dig> d plot of the number of novel phenotypes versus robustness and network size  or environmental demands .

we next examined two candidate explanations of this pattern. the first is that environmental demands and network size affect how rapidly a population can diversify on its genotype network, and thus also how many novel phenotypes it can access. to find out whether this diversification rate matters, we examined the average pairwise genotype distance of our evolving populations. the smaller this difference is, the more slowly a population diversifies. figure 5b shows a plot of pairwise genotype distances, averaged over an entire population, at the end of  <dig> generations. one can see that populations of smaller networks are less diverse. however, environmental demand  influences genotypic diversity only weakly, and not in the same unimodal way as seen in additional file  <dig>  thus, population dynamic processes alone cannot explain the pattern observed in figure 5a and additional file  <dig> 

the second candidate explanation is that the patterns of figure 5a and additional file  <dig> may simply reflect how the number of novel phenotypes in the neighborhood of random metabolic networks varies with n and s. figure 5c shows the number of novel phenotypes in the neighborhood of random viable metabolic networks of varying size, and with varying environmental demands on the network. this figure is based on random samples of  <dig> metabolic networks  for every value of n and s . the vertical axis of this figure shows the mean and standard deviation of the number of unique novel phenotypes in the neighborhood of the examined networks. it shows similar unimodal characteristics as the data in figure 5a and additional file  <dig>  the figure demonstrates that the number of novel phenotypes depends strongly on metabolic network size for environments with s <  <dig>  in this regime, larger metabolic networks have more novel phenotypes in their neighborhood than smaller networks. for s >  <dig>  the dependency on metabolic network size disappears and the number of accessible novel phenotypes declines again. in sum, the different accessibility of novel phenotypes in evolving populations, at least qualitatively, emerges from how novel phenotypes are distributed in genotype neighborhoods, and how this distribution depends on s and n.

discussion
the genotype-phenotype map we characterized here shows both similarities and differences to previously characterized such maps  <cit> . one similarity is the existence of connected genotype networks that extend far through genotype space, and that link genotypes having the same phenotype. connected sets of metabolic networks viable on the same set of sulfur sources exhibit large maximum genotype distances dmax. for example, networks with as few as  <dig> reactions can show dmax > <dig> , meaning that they share fewer than  <dig> percent of their reactions. a second similarity regards phenotypic innovations, genotypes whose phenotypes allow viability on novel sulfur sources. the neighborhoods of two genotypes g <dig> and g <dig> tend to contain very different phenotypic innovations, even if g <dig> and g <dig> are only moderately different. both features, taken together, facilitate the exploration of novel phenotypes. they would allow a population of organisms  to explore different regions of genotype space, preserving their phenotype while exploring many novel phenotypes.

a major difference to previously studied genotype-phenotype maps regards the relationship between a phenotype's robustness to mutation and a population's ability to explore novel phenotypes. in macromolecules, this relationship appears to be positive: greater robustness facilitates innovation  <cit> . although robust molecules can access, on average, fewer novel phenotypes in their mutational neighborhoods, populations of robust molecules can spread faster through genotype space. in balance, the second process dominates and allows evolving populations to access more novel phenotypes through mutations.

in sulfur metabolism, we do not see this relationship. robust phenotypes in this context are characterized by viability on few sulfur sources. they are less easily disrupted through eliminations of individual reactions. we found that the number of phenotypic innovations such phenotypes can access in their neighborhood - through changes of single reactions - is highest at intermediate robustness, that is, for phenotypes viable on approximately  <dig> out of  <dig> carbon sources we examined.  this phenomenon cannot solely be explained by the evolutionary dynamics of evolving populations, partly because populations whose members have intermediate robustness do not spread fastest through genotype space. instead, the phenomenon is a simple consequence of how many novel phenotypes occur in the neighborhoods of individual genotypes. this number peaks for genotypes whose phenotypes have intermediate robustness. it shows the same qualitative dependence on robustness as the number of novel phenotypes accessible to populations. thus, in this case, population dynamics do not dominate the process of novel phenotype exploration. we note that the total number of possible novel phenotypes decreases exponentially with the number s of sulfur sources on which a network is already viable. if we took this exponential decrease into account, for example by determining the cumulative fraction instead of the number of novel phenotypes accessible to evolving population, this fraction would decrease with increasing s.

these observations raise the question whether they are unique to sulfur metabolism or whether they occur in other metabolic systems. as we stated earlier, part of our motivation to study sulfur metabolism was to avoid the much larger number of reactions of carbon metabolism, which render population approaches like ours computationally intractable. nonetheless, very limited analyses for carbon metabolism are possible. additional file  <dig> panels a and b show the results of such an analysis, based on a small number of populations of networks at moderate size. the analysis has large uncertainties, but it shows a pattern that is at least reminiscent of sulfur metabolism: innovation peaks at intermediate robustness .

taken together these analyses show that the organization of different phenotypes in genotype space can differ greatly among different classes of biological systems, such as proteins and metabolic networks. and these differences can affect the ability of a system to explore novel phenotypes in this genotype space.

a third class of analyses regards features that have not been studied previously, partly because they are unique to metabolic systems and our representation of them. one of them regards the analysis of networks with different sizes . our genotype representation can accommodate and allows us to compare networks of different sizes, whereas commonly used representations of other systems - molecules or regulatory circuits - cannot. for example, proteins of different length form genotype spaces of different dimensions, making their comparison challenging  <cit> .

when analyzing metabolic networks of different sizes, we found that populations of small networks can explore fewer novel phenotypes . this observation is easily explained if one considers that populations of such networks are less robust. their genotype can thus be altered less easily. in consequence, they are genotypically less diverse , which restricts their access to novel phenotypes .

another analysis focusing on network sizes is our characterization of minimal metabolic networks, networks in which all reactions are essential. while the process of genome and metabolic network reduction leading to small networks has been studied for specific biological networks  <cit> , our approach does not start from such a network and can thus provides a more systematic exploration of genotype space. in our analysis of random minimal metabolic network viable on the same sulfur sources, we found that such networks can have large genotype distance. we can explain part of this observation through reactions that are very similar but differ in one of several highly related metabolites. for example, in many types of reactions involving the phosphorylation of a metabolite, the phosphor group donor can be any of atp, adp, amp or even other phosphorylated nucleotide bases. this allows single reactions to be substituted by similar reactions that only use another group donor metabolite. also, many alternate pathways require only the swapping of two reactions allowing metabolic networks with very little robustness to substitute some of their reactions. however, these may not be the only explanations of different network architectures, because minimal metabolic networks viable on the same sulfur sources can have dramatic pathway differences . whether such differences can be bridged through series of single reaction changes is a question for future exploration.

properties of minimal networks are also useful in explaining the maximal genotype distance in a genotype network. for example, for metabolic networks of a given size n and viability on s sulfur sources, the maximum genotype distance within a genotype network is well approximated by one minus the fraction of superessential reactions in minimal metabolic networks. these are reactions found in all minimal networks viable on a given number of sulfur sources. we currently have no mechanistic explanation for this relationship and it, also, remains a subject for future work.

studies like ours have several limitations. one of them is that we focus on biomass synthesis phenotypes, and not on other aspects of metabolism, such as secondary metabolite production. the reason is that biomass synthesis has the most immediate impact on an organism's survival. other limitations include that the addition and deletion of reactions may have effects on fitness even if they do not affect biomass synthesis, that our knowledge of the reaction universe is limited, and that we face uncertainty about the biologically most important sulfur sources, about thermodynamic properties of individual metabolic reactions, and about the role of cellular compartmentalization in guiding sulfur metabolism. our study, even though it uncovers generic features of genotype-phenotype maps with demonstrated relevance for evolutionary adaptation and innovation in other biological systems  <cit> , is thus best viewed as a modest beginning in characterizing a complex metabolic genotype space.

CONCLUSIONS
we demonstrate that metabolic networks in sulfur metabolism with the same phenotype form large genotype networks that reach far through metabolic genotype space. how far they reach through this space is a linear function of the number of super-essential reactions specific to the environment. we show that the robustness of metabolic networks depends on the size of a metabolic network, on the average size of minimal networks viable in a given environment, and on how rapidly the proportion of essential reactions decrease with increasing network size. the neighborhoods of two metabolic networks on the same genotype network typically contain different novel phenotypes. in evolving populations of metabolic networks, robustness facilitates the discovery of novel phenotypes only up to some modest value of robustness, beyond which populations discover fewer novel phenotypes. the difference in the role of robustness in the evolution of metabolic networks compared to its role in the evolution of macromolecules shows that phenotypic innovations may not occur according to the same principles in all biological systems.

