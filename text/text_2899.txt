BACKGROUND
with the increasingly high coverage of molecular interactions owing to the advancement of high-throughput techniques for measuring biomolecular interactions, such as the two-hybrid screening  <cit>  and co-immunoprecipitation  <cit> , comparative analysis of biological networks has recently attracted significant research attention. it has been demonstrated that comparative network analysis can provide an effective means of systematically studying molecular interactions in various organisms and gaining novel system-level insights  <cit> . for example, local network alignment across different species can identify similar subnetwork regions in the respective networks, which may lead to the discovery of conserved pathways that carry out essential cellular functionalities  <cit> . the concept of comparative network analysis can lead to the development of novel computational tools that allow us to transfer biological knowledge across species, especially from well-studied species to less-studied species  <cit> .

current local network algorithms  <cit>  search for similar subnetwork regions by optimizing a pre-defined alignment score that incorporates the topological similarity of the interaction patterns in the compared networks as well as the node similarity of the molecules that belong to different networks, typically measured based on sequence similarity. to obtain better alignment results that are biologically more significant, there have been research efforts to improve the scoring scheme by incorporating evolutionary  <cit>  or functional relationships  <cit>  between molecules. although there are various approaches for measuring the similarity between network nodes, most of the existing approaches compute this similarity based on the properties of individual nodes, such as their composition, functionality, or evolutionary relationships. however, cellular functions are carried out by collaborative efforts among many molecules, where interacting molecules may carry similar functionalities and share common characteristics. therefore it would be reasonable to expect that, when evaluating the node similarity, incorporating additional information about the interacting molecules would enhance the network alignment results and lead to predictions that are biologically more meaningful.

recently, we have introduced an effective framework for local network alignment based on hidden markov models , in which we integrate both the node sequence similarity and the interaction reliability into the scoring scheme by determining the parameters of the hmms correspondingly  <cit> . we also developed an efficient dynamic programming algorithm that can find the closest pair of pathways from the respective networks in polynomial time. the hmm-based local alignment method can deal with a large class of path isomorphism and it allows one to search for long conserved pathways across large-scale networks. in this paper, we implement a semi-markov random walk framework that diffuses the relationships of all the molecule pairs across the networks to obtain a global correspondence score between every pair of nodes. the resulting global correspondence score reflects the global similarity between nodes in different networks, by seamlessly integrating the topological similarity and individual node similarity. alignment results based on synthetic networks and microbial protein-protein interaction  networks show that the performance of the hmm-based local alignment scheme can be significantly improved by utilizing the global correspondence score instead of the original individual sequence similarity score. the major contributions of this paper include the following: first, we integrate the global node correspondence scoring scheme into the hmm-based local network alignment framework  <cit> , which leads to more accurate and robust alignment results; second, we thoroughly evaluate the performance of the proposed scheme based on synthetic benchmark networks, as well as real microbial networks, which clearly demonstrates the advantages of utilizing global correspondence scores, especially, in combination with the hmm-based framework.

methods
local network alignment based on hidden markov models
in this section, we briefly review our local network alignment algorithm based on hidden markov models   <cit> . we focus on aligning two biological networks to identify the common pathways that are conserved in both networks. suppose we have two biological networks, represented as two graphs  and . in graph  of n <dig> nodes represents the corresponding molecules, and  of m <dig> edges indicates the presence of interactions dij between the two molecules ui and uj. similarly, we assume that  has a set  of n <dig> nodes and a set  of m <dig> edges. we denote the interaction reliability score between ui and uj in  as w <dig> and the interaction reliability between vi and vj in  as w <dig>  the node similarity between  and  is denoted as s.

in order to use hmms to search for the pathways that are conserved in both networks, we search for the best matching pair of paths  and  of length l in the respective networks that maximizes the pathway alignment score h. the alignment score h integrates the node similarity score s between the aligned nodes ui and vj , the interaction reliability score w <dig> between ui and ui+ <dig> , the interaction reliability score w <dig> between vj and vj+ <dig> , and the penalty for potential gaps in the alignment.

we first construct two hmms respectively for two given networks. for , we design the state transition diagram of its corresponding hmm based on the graph structure of . the resulting hmm contains a hidden state for each node , which we also denote as ui for convenience. state transition is allowed from ui to uj for  such that . the hmm for  can be constructed in a similar way. to allow flexible node insertions and/or deletions in the alignment result, we add auxiliary states to the hmms as described in  <cit> . the state transition probabilities of the hmms are determined based on the interaction reliability scores w <dig> and w <dig>  by introducing a “virtual observation sequence” q = q <dig> ⋯ ql that is jointly emitted by the two hmms, we design the emission probabilities based on the node similarity s. using these hmms, the problem of finding the optimal pair of paths in the two networks is translated into that of finding the optimal pair of state sequences in the two hmms that jointly maximize the probability p of the “virtual observation sequence”:  

we can use log p as the alignment score h, and find the best matching pair of paths using dynamic programming  <cit> . for this purpose, we first define the score for the most probable pair of paths of length t as follows:   

where tw <dig>  and tw <dig>  are the logarithms of transition probabilities determined by the interaction reliability scores in the respective networks. next, we find the optimal pair of paths    

by iteratively computing the score in  for l =  <dig>   <dig>  ⋯ , l. instead of finding only the best matching pair of paths, we can also search for the top k path pairs by replacing the max operator in  by an operator that finds the k largest scores. the computational complexity of the described dynamic programming algorithm is only o for finding the top k pairs of matching paths. note that the computational complexity is linear with respect to each parameter k, l, m <dig>  and m <dig> 

in our previous implementation of hmm-based local alignment  <cit> , we have used the sequence similarity between individual molecules to measure the node similarity s. as we discussed earlier, it is desirable to integrate all the available information to measure the similarity between network nodes, instead of relying on the similarity between individual molecules. in this paper, we propose to use a semi-markov random walk model to define a global correspondence scoring scheme for measuring node similarity by incorporating the topological properties around the nodes. as we will demonstrate later, the use of global correspondence scores can improve the accuracy and robustness of the hmm-based alignment results.

computation of global correspondence scores through semi-markov random walk
in order to predict the global correspondence between nodes, we should first consider the similarity between the corresponding molecules themselves, in terms of sequence, structure, and/or function. however, considering that biomolecules carry out their functions through intertwined interactions with other molecules, it is important to consider these interaction patterns as well when evaluating the global similarity between nodes. as recently proposed and discussed in  <cit> , markov random walk can provide an elegant framework for evaluating the global correspondence between nodes that belong to different networks by seamlessly integrating the similarity between the nodes themselves and that between their interaction patterns.

in this work, we adopt the semi-markov random walk approach  <cit>  to compute the global correspondence scores for the node similarity s. the basic idea of this scheme is to perform a simultaneous semi-markov random walk on  and , such that the random walker moves to one of the neighboring nodes in each network at each time point. the next node is randomly selected among all the neighboring nodes, where nodes with higher interaction reliability have a larger chance to be selected. the time that the random walker spends at a given pair of nodes  and  is proportional to the sequence similarity between the nodes. according to this model, the long-run proportion of time that the random walker spends at  will increase if ui and vj have higher individual node similarity . furthermore, the proportion of time spent at  will also increase if the two nodes are surrounded by similar nodes, hence have a higher topological similarity. as a result, this semi-markov random walk provides an elegant way of evaluating the global similarity between nodes by integrating individual node similarity and topological similarity. using this model, we can compute the global correspondence score as follows:   

in which π <dig> is the stationary probability of visiting node ui in an ordinary markov random walk on , π <dig> is the stationary probability of visiting vj in a markov random walk on , and h estimates the individual node similarity between ui and vj, which is measured in terms of sequence similarity in this work. the above scheme is conceptually similar to the one proposed in  <cit> , where the similarity between two nodes in different networks are measured by linearly combining the topological similarity score and the sequence similarity score. the resulting score can be viewed as the long-run proportion of time spent at the given pair of nodes based on a “markov random walk with restart” model, in which the restart probability has to be chosen in advance to balance the contributions from the interaction similarity and the sequence similarity, typically in an ad-hoc manner. note that such parameter tuning is not needed in the semi-markov random walk approach adopted in this work.

in the following sections, we analyze the effect of using the global correspondence scores in the hmm-based local network alignment method. more specifically, we evaluate the performance of the hmm-based local network alignment method when using the global correspondence score for s given in , and compare it to the performance of the hmm-based alignment method that directly uses the sequence similarity score with s = h, as originally proposed in  <cit> .

RESULTS
aligning synthetic networks
to illustrate the advantages of using the global correspondence scores in the hmm-based local network alignment scheme, we first conducted a set of experiments based on synthetically generated networks. figure  <dig> shows two simple synthetic networks, each of which contains a similar core path, respectively marked in dark blue and dark red. we added more nodes around the core path in each network in a way that the corresponding nodes in the core paths have similar local topological structures. we further assigned individual node similarity scores, where nodes in the respective networks that are located at similar vertical levels were given higher scores. we assigned exceptionally high similarity scores to two node pairs  and , which are shown by dashed lines in fig.  <dig>  these two highly similar pairs are analogous to molecules in real biological networks that have high sequence similarity without real biological significance. such nodes can mislead the alignment algorithm, yielding inaccurate alignment results. in fact, we may typically face similar problems when aligning two or more large-scale biological networks. the network adjacency matrices and the node similarity matrix are provided in the additional file  <dig> 

we applied the hmm-based local alignment to identify the most similar pair of paths of length l =  <dig>  the identified top pair of paths when directly using the assigned node similarity scores is shown in fig.  <dig>  we notice that the alignment result is strongly influenced by the high similarity pairs  and  in this case and the prediction does not capture the obvious topological similarity in the two networks. next, we computed the global correspondence scores between nodes based on the semi-markov random walk scheme and used these scores in the alignment algorithm, instead of the original node similarity scores. figure  <dig> shows the top path alignment for this case, where the core paths were accurately identified as we expect based on the topology of the two networks. simulations based on other small synthetic networks, constructed in similar ways, yielded similar results .

for a more thorough performance comparison between the two different schemes—the original scheme that directly uses the individual similarity scores and the proposed scheme that uses the global correspondence scores computed by semi-markov random walk—we further created a benchmark set that consists of large synthetic networks generated based on a scale-free model  <cit> . although we can also evaluate the performance of network alignment algorithms by aligning real biological networks and measuring the accuracy of the alignment results using functional annotations based on gene ontology  terms  <cit>  or kegg ortholog  group annotations  <cit> , these annotations are still highly incomplete and may not accurately reflect the real functional similarity between molecules. as a result, a carefully constructed synthetic benchmark dataset may provide a better benchmark for evaluating future network alignment algorithms.

to construct the synthetic networks, we first randomly generated an undirected seed network  of size  <dig> with an average degree of  <dig>  next, we grew this network according to the ba  model  <cit>  to generate a random scale-free network using the preferential attachment algorithm  <cit> . in this algorithm, at each time step, a new node is added to the network and connected to m existing nodes with a probability that is proportional to the number of links that the nodes already have. as shown in  <cit> , the resulting network captures several important characteristics of real ppi networks. the scale-free degree distribution is one such property, which means that the degree distribution of the network approximately follows the power law p ~ kγ, where γ is the degree exponent. in this work, we used this model with m =  <dig> to grow  to a network of size  <dig>  once  was created, we duplicated the network into two identical networks  and . to model the functional coherence between orthologous proteins, we then assigned a distinct group annotation to each pair of corresponding proteins in the two networks. more specifically, both the node ui in  and the node vi in  were assigned to the ith functional group. we randomly assigned individual node similarity scores between orthologous nodes according to the gaussian distribution  with mean µo =  <dig> and standard deviation σo =  <dig>  the node similarity scores between non-orthologous nodes were randomly assigned according to a different distribution , where σ =  <dig>  and µ was used as a free parameter that determines the level of overlap between the two similarity score distributions. node similarity scores below a certain threshold  were set to zero. for every node, we also restricted the number of non-orthologous nodes with a nonzero similarity score to  <dig>  these settings were used to make the resulting random networks similar to real ppi networks in public databases.

up to this point, the two networks  and  were topologically identical. to introduce topological differences in these networks, we randomly deleted 10% of the edges in  and . furthermore, we also randomly deleted 10% of the nodes in the two networks and added back an identical number of new nodes by growing the networks using the preferential attachment algorithm. no functional group was assigned to these randomly inserted nodes. the node similarity between the inserted nodes in one network and the nodes in the other network was sparsely assigned according to , as before.

based on the above model, we generated two networks  and  with µ =  <dig>  using the hmm-based local network alignment algorithm, we identified the top  <dig> high-scoring path alignments with gaps. to find the top  <dig> path alignments, we iterated the following steps:  find the optimal path alignment;  store the predicted alignment;  remove the interactions included in the path alignments;  repeat the experiment to find the next path alignment. the accuracy of the identified path pairs are measured based on the group annotations of the aligned nodes as in  <cit> . we define the cumulative specificity of the top k alignments as follows:   

where  the total number of correctly aligned node pairs in the top ith alignment, and  is the total number of annotated node pairs also in the top ith alignment. we also define the cumulative coverage of the top k alignments as , which computes the cumulative number of pairs with the same functional annotations. this metric measures the size of the accurately aligned network regions covered by the top k path alignments. we repeated the alignment experiments for different path lengths: l =  <dig>   <dig>  and  <dig>  the alignment results are summarized in fig.  <dig>  as we can see in this figure, the use of global node correspondence scores computed by the semi-markov random walk approach significantly improves the specificity of the alignment, while the coverage is also slightly improved. this clearly shows that incorporating topological information of network nodes into the alignment process can be crucial in obtaining accurate alignment results when the individual node similarity scores are not highly discriminative by themselves.

next, we investigated performance improvement by the proposed approach for varying levels of overlap between the node similarity score distribution for orthologous nodes and that for non-orthologous nodes. we set l =  <dig> and evaluated the performance of the hmm-based alignment algorithm using the global correspondence scores and the individual similarity scores, respectively, for various values of µ. the simulation results are shown fig.  <dig>  as shown in this figure, the advantage of using the global correspondence scores for network alignment becomes more prominent for larger µ. when µ is small , we can accurately identify orthologous nodes by using individual node similarity scores. however, as µ increases and the individual node similarity scores become less discriminative, it becomes more critical to utilize topological information to identify orthologs. this can be seen when µ =  <dig>  in which case the use of global correspondence scores can remarkably improve the accuracy of the alignment. it is also apparent from the figure that the performance of local network alignment using individual node similarity degrades much faster as the individual similarity gets less informative. this implies that we can obtain more robust and reliable alignment results by incorporating the global correspondence scores into the hmm-based local network alignment algorithm. 

aligning microbial ppi networks
for further evaluation of the proposed method, we performed pairwise alignments of three microbial ppi networks obtained from  <cit> . in our experiments, we aligned the e. coli network and the c. crescentus networks to detect conserved functional modules in the two networks. similarly, we also performed a pairwise alignment between the e. coli and the s. typhimurium networks to find conserved modules in these networks. as before, we have assessed the accuracy of the alignment results using two metrics—namely, specificity and coverage—based on the kegg ortholog  group annotations  <cit>  of the proteins in the microbial networks. a protein alignment is regarded as being correct if the aligned proteins have the same ko group annotations, and incorrect if the annotations do not agree.

in these experiments, the parameters of the hmms were chosen as follows. first, the transition scores tw in  were determined based on the presence  of protein interactions in the microbial networks determined by the srini algorithm  <cit> :   

second, we used the blastp hit scores between protein pairs, provided in  <cit> , as the individual node similarity scores. the global correspondence scores were computed according to the semi-markov random walk approach described earlier. these two types of node similarity scores were normalized such that they lie in the same range.

based on the constructed hmms, we used our local network alignment algorithm to find the  <dig> top-scoring pathway alignments with gaps. this experiment was also repeated for several different virtual path length: l =  <dig>   <dig>  and  <dig>  in all our experiments, we disallowed multiple occurrences of identical protein pairs in a given path alignment. the cumulative specificity csk of the pairwise alignment of the e. coli and the c. crescentus networks using the two different types of node similarities are shown in figs.  <dig>  , and  for l =  <dig>   <dig>  and  <dig>  respectively. the results of the pairwise alignment of the e. coli and the s. typhimurium networks are shown in figs.  <dig>  , and . figure  <dig> shows the cumulative coverage cck of the predicted path alignments using the two different node similarity scores.

as we can see from the pairwise alignment results of the e. coli and the c. crescentus networks, shown in fig.  <dig>  ,  and fig.  <dig>  , , when the coverage of the predicted path alignments is comparable, using the global correspondence scores results in higher specificity compared to using the individual node similarity scores. this implies that hmm-based network alignment based on global correspondence scores can more effectively capture the functional similarity between nodes. however, as we can see in fig.  <dig>  , , the protein pairs aligned using the semi-markov random walk based global correspondence scores are less annotated  for the pairwise alignment of the e. coli and the s. typhimurium networks, in which case the specificity of the predicted alignment is not necessarily improved by the global scores. this can be seen in fig.  <dig>  , . one possible explanation for this observation is that the ko group annotations may have been curated largely baed on sequence similarity between proteins. for example, for remote orthologs that do not have high sequence similarity, it may be practically difficult to judge to which ko group they should belong since there is not enough evidence. from this point of view, network alignment using global correspondence scores obtained from semi-markov random walk could be used to validate and improve functional annotation of proteins.

in order to further examine the biological significance of the alignment results obtained from the proposed method, we retrieved the unannotated protein pairs that are aligned in the top path alignments predicted by comparing the e. coli and the s. typhimurium networks. as these proteins do not have curated functional annotations, such as go terms or ko groups, we manually checked the protein information for the first  <dig> unannotated pairs in the protein database at the national center for biotechnology information   <cit> . table  <dig> shows the assigned gene names and regions names based on the genlnfo identifiers  of these aligned proteins. among these  <dig> protein pairs that are unannotated in the kegg database,  <dig> pairs consist of proteins that have been assigned with the exactly same gene names and region names. in fact, these protein pairs indeed have similar cellular functionalities, where many of them are membrane proteins. further information about these protein pairs can be found at the urls included in the additional file  <dig>  for the remaining two protein pairs , we could see that the aligned proteins were not assigned with the same gene names because the proteins in the s. typhimurium network were not annotated. when we checked the region names of the aligned proteins in each pair, we could see that the proteins in the first pair have the same region name “transposase_3l” and those in the second pair have the same region name “duf1131”. these observations suggest that the hmm-based network alignment method using semi-markov random walk scores may provide a promising framework for automatic functional annotation of proteins.

CONCLUSIONS
in this paper, we studied the effect of using a global similarity scoring scheme to measure the node similarity and incorporating these global scores in the hmm-based local network alignment algorithm. we used the semi-markov random walk framework to compute the global correspondence scores between nodes in different networks. the resulting scores can effectively combine the topological similarity of the subnetworks around the network nodes as well as their individual molecular similarity. experimental results on microbial protein-protein interaction networks and synthetic scale-free networks show that the use of global correspondence scores can better identify paths with similar topological properties, thereby improving the specificity of the predicted alignment. we believe that the proposed alignment scheme can provide an effective and computationally efficient framework for developing robust and accurate functional annotation tools for proteins.

authors contributions
conceived and designed the experiments: xq, smes, bjy. performed the network alignment experiments: xq. implemented the semi-markov random walk based scoring scheme: smes. analyzed the data and wrote the paper: xq, smes, bjy.

supplementary material
additional file 1
supplement.pdf this file contains:  information of the benchmark set that contains randomly generated synthetic networks,  additional experimental results, and  relevant information regarding the unannotated pairs of aligned proteins in microbial networks.

click here for file

 acknowledgements
xq was supported in part by the university of south florida internal awards program under grant no.  <dig>  bjy was supported in part by the texas a&m faculty start-up fund.

competing interests
the authors  declare that they have no competing interests.

this article has been published as part of bmc bioinformatics volume  <dig> supplement  <dig>  2011: proceedings of the eighth annual mcbios conference. computational biology and bioinformatics for a new decade. the full contents of the supplement are available online at http://www.biomedcentral.com/1471-2105/12?issue=s <dig> 
