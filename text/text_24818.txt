BACKGROUND
most of known diseases are complex diseases. this means that they are caused by the combination of genetic and environmental factors. the introduction of the concept of network biology
 <cit>  allowed the application of network based approaches for studying this type of diseases. these approaches rely on the possibility to represent molecules, as proteins or genes, as interaction networks. microarray experiments of gene expression represent a useful tool to examine the change of gene expression profile in diseases. many efforts were performed to build, starting from gene expression, molecular networks. this activity is sometimes referred to as reverse engineering of gene regulatory networks
 <cit> . one type of method applied for this goal, relies on the structural equation modeling , a general methodology used to address questions about complex systems
 <cit> . sem finds a number of applications in biological networks, for example in the inference of causal phenotype networks , genome-wide association studies  and gene-environment interactions
 <cit> , as well as to measure effects of quantitative trait loci  in linkage analyses
 <cit> . the use of sem in the analysis of microarray is not new. one of the first applications is shown by
 <cit> , who demonstrated that covariance structure analysis is a useful statistical method to find common transcriptional factors for a set of genes and to specify and evaluate hypothesized biological pathways.
 <cit>  applied sem systematically for gene network reconstruction using gene expression data pre-processed with genetic algorithms. in most of the applications of sem the aim is to infer networks starting from data. thus, we can define these approaches as exploratory approaches. more recently,
 <cit>  described a confirmatory approach in microarray analysis.

in this paper we propose a sem pipeline that, from initial and revised a priori network models, obtained by pathway analysis
 <cit> , is able to compare the path strengths between several groups and to determine the effect of factors analyzed on the paths. our framework takes into consideration the generation of pathway models based on the principles of network theory such as the small network phenomena and the detection of modules
 <cit> . firstly considering how differentially expressed genes  are connected by other genes in the microarray, we try to bring out which modifications in the gene network could be responsible of the differences observed between groups considered. our approach relies on: 1) curated biological pathway databases, 2) the principles that characterize disease genes in biological networks, 3) grouping genes in protein information resource  super-families
 <cit>  for facilitating the interpretation of the model. the proposed sem pipeline is a combination of data-driven and knowledge-driven approaches. in fact, in order to generate perturbed pathway modules, we used curated biological pathways, representing the a priori biological knowledge about genes and their connections. the hardest part is to highlight which portion of the pathway is actually distinctive of the phenomenon being analyzed. we consider, as initial model, the one obtained from the shortest paths between every couple of degs. this process preserves the biological knowledge completely, as the connections in the new model are not inferred, but already present in the original pathway. the model is then fitted with sem and improved by balancing between data-driven and knowledge-driven evidences obtained by the combination of sem with the knowledge enclosed in public databases, relative to real and putative connections among genes. finally, sem with multiple group analyses supplies useful information to clinicians and biologists about experimental group differences, unveiling which connections and genes are statistically significant in the perturbed pathway models.

methods
illustration of the proposed pipeline
the pipeline, similar to that described by
 <cit> , is illustrated in figure 
 <dig>  in step- <dig>  degs were obtained by significance analysis of microarray 
 <cit>  and the perturbed pathways by signaling pathway impact analysis 
 <cit>  using kegg database
 <cit> ; in step- <dig>  the pathway models were generated by network analysis and evaluated with sem in step- <dig> for: 1) improving the models generated by the biological pathways found; 2) testing if the pathway models differ across groups by multiple group analysis; 3) screening of single differences in expression  and in regulation  across groups. we used the implementation provided by the r packages samr
 <cit>  and spia
 <cit>  for sam/spia procedures.

structural equations models 
sem is a statistical procedure for confirmatory causal inference originated from path analysis proposed in  <dig> by the american geneticist sewall wright
 <cit> . it is based on multivariate linear regression equations, where the response variable in one regression equation may appear as a predictor in another equation. indeed, variables may influence one-another reciprocally, either directly or through other variables as intermediaries. additionally, correlated or uncorrelated unmeasured variables may indicate the presence of unobserved factors that influences observed variables.

in general, a sem consists of a structural model describing  relationships among latent  variables and a measurement model describing the relationships between the observed measurements and the underlying latent variables
 <cit> . here we consider sem with observed variables only, and therefore no measurement models have been used
 <cit> . specifically, let v to be the index set of the y observed variables, represented as the “parent” set {pa|i ∈ v}, i.e. the explanatory variables of y
i
, or as the “siblings” set {sib|i ∈ v}, i.e. the unmeasured linked variables with y
i
, respectively. these sets determine a system of linear equations:

 yi=∑j∈paiβijyj+uii∈v 

and a covariance structure:

 covui;uj=ψijifi=jorj∈sibi0otherwise 

the system of linear equations affirms that every node is characterized by the relationships with his parents, while the covariance structure describes the relationships between unobserved nodes.

they encode two distinct causal assumptions:  a “weak” assumption on the possible existence of  casual influences of explanatory variables on y
i
, and  correlated unmeasured variables u
i
, quantified by the regression  coefficients β
ij
, and the covariances ψ
ij
, respectively; and 2) a “strong” assumption based on the absence of  causal influences or  correlations of any observed/unobserved variables neither in the “parents” set pa nor in the “siblings” set sib. in other terms, a weak assumption excludes some values for a parameter , but permits a range of other values; while, strong assumptions assume that parameters take specific values . the linear equations and the covariance structure can be encoded and visualized in a “path diagram”, that is, a mixed graph g =  featuring both directed  and bi-directed  edges. the vertex set v includes the genes and the edge set e represents relations or reactions among vertexes. the “activity” of a given gene is embedded in a path diagram: the actions performed by a gene on downstream molecules, and the signals that it receives from upstream regulators. “directed edges” between two genes ), measured by path coefficients , represent expected change in the activity of the downstream gene, given a unit of change in the upstream gene while the values of the other genes remain constant. considering that paths reflect a direct influence of one gene on another, negative path coefficients indicate ensemble inhibition  and positive paths measure net activation . “bi-directed edges” between two genes , or equivalently, if and only if i ∈ sib) encode a hidden common cause that may be interpreted as latent or unobserved measurement of upstream regulators that could account for the observed covariances  between the two genes.

one important feature of sem is that direct and indirect effects can be computed and compared. “directed paths” between two genes are the sequence of all the directed edges  from genes yj to yi. each directed path is a channel along which information  can flow, and so a “total effect”  of gene yj on gene yi is defined as the total sum of the products of the sequence of arrows  along all directed paths from yj to yi. accordingly, a “indirect effect”  of gene yj on gene yi represents the portion of the total effects not considering the directed edge effect , i.e. te = de + ie.

the well-known sem analysis consists of four steps
 <cit> : a) definition and identification of an initial path model, b) estimation of parameters, c) evaluation of the fitting, and d) model modification.

initial model building
specification of initial pathway models  was obtained taking the perturbed pathways and converting them in directed graphs or gene networks. generalizing, each pathway can be seen as a mixed graph. the idea is to understand how degs are connected in the perturbed pathways by other microarray genes. a natural way to solve this problem is to identify the shortest paths  between degs. the geodesic distance dgeo between two degs, yi and yj, is defined as the minimum distance between these two genes. the function get.shortest.paths of the r package igraph was used to compute all the shortest paths
 <cit> . define the microarray genes, degs, and not degs in the following way: mg = {mg
1
, mg
2
, …, mg
m
}; deg = {deg
1
, deg
2
 ,…, deg
n
} and ndeg = {ndeg
1
, ndeg
2
,…,ndeg
m-n
}, where mg = deg ∪ ndeg and deg ∩ ndeg = {∅}. each shortest path could be represented as a list of nodes y
k
=  and a list of the corresponding edges ek = , ..., ej) where  ∈ deg;  ∈ ; yk ⊆ y and ek ⊆ e. the shortest paths for each pathway constitute k  subgraphs gk = {yk,ek} of the original pathway, g = {y, e}. not all degs and ndegs will be included in the shortest paths. therefore, we define two new sets: deg and ndeg respectively, the sets of degs and the set of not degs that include all genes in shortest paths, where deg ⊆ deg and ndeg ⊆ ndeg.

to reach the final model the ndeg that connect deg are grouped in basis to their pir superfamily . based on the evolutionary relationships of whole proteins, this classification system allows annotation of both specific biological and generic biochemical functions. the pirsf can be represented as supf = {supf
1
, supf
2
,…, supf
g
}, where ∀ supf
i
 ⊆ ndeg and ∀i≠j supf
i
 ∩ supf
j
 = {∅}. using this information, each original shorthest path gk = {yk,ek} is transformed in a new shortest paths, g*k = {y*k = , e*k = ,…, e*j) }, where  ∈  ∨ supf ∨ ndeg) and e* ⊆ e. the function to obtain the final graph, g* = , is described in the following pseudo-code:  

the graph g* =  is the fusion of all shortest paths found, where each node and each edge cannot be present more than once, the self-loops are not considered but the feed-backs and cycles were preserved. to ensure the identification of the initial models, the “block-recursive” criterion of rigdon
 <cit>  and the “bow free” criterion of brito and pearl
 <cit>  were applied. the first affirms that reciprocal relationships, feedback loops, or covariances are segregated into groups, or blocks, with no more than two equations per block. the second affirms that a model is ensured if variables standing in direct causal relationships  do not have correlated errors . so a new graph is attained in which the degs are connected by other degs, pirsfs or ndegs. in this way a model was created for each significant pathway found.

successively, pirsfs composite variables are defined considering not degs, present in shortest paths, as causal indicators of latent  constructs
 <cit> . to generate the pirsfs, a principal component analysis  was performed on genes belonging to a pirsf and the principal component scores of the first principal component  were considered as the values that characterize the pirsf. only pirsfs for which the pc <dig> represents 50% or more of the total variance are considered. at the end of process we have the initial sem model.

the pathway graph conversion, the graph analysis, and the pc <dig> scores are obtained by graphite
 <cit> , igraph
 <cit>  and stats
 <cit>  r packages, respectively, while r functions for network analysis are implemented ad hoc, and are available additional file
 <dig> 

sem fitting
for parameter estimation , the classic derivation of the maximum likelihood estimation  is used, that assumes all observed variables are jointly gaussian. the system of structural equations and covariance structure of unmeasured variables can be written compactly in a matrix form as: y = by + u, and cov = Ψ. this specification induces a structure on the covariance matrix of the joint distribution of the genes y as:

 Σθ=i-b-1Ψi-b-t 

where θ= is the list of the free parameters in the model of dimension t. the unknown parameters are estimated so that the implied covariance matrix Σ is close to the observed sample covariance matrix s.

the assessment of the model  involves the likelihood ratio test  converted to a chi-square test of the fitted model. specifically, let Σ0 = e to be the true population covariance matrix, and Σ the model-implied covariance matrix. the hypothesis to be tested is:

 h0:Σ0=Σθvs.h1:Σ0≠Σθ 

the chi-square test is then χ <dig> = -2loglrt = - <dig> with d = p/2-t degree of freedom . logl represents the log-likelihood of the model, p the number of genes, t the number of parameters of the fitted model. not-significant p-values  indicate that the model provides a good fit to the data. the p-values are derived by using the χ <dig> distribution or a resampling bootstrap distribution
 <cit> .

an alternative procedure
 <cit>  assumes that in the population, a model-implied covariance matrix Σ, which is approximately correct, is in the neighborhood of Σ <dig>  so the null hypothesis of “exact fit” is replaced by the null hypothesis of “close fit”:

 h0:Σθ0-Σθ<ε= <dig> vs.h1:ε> <dig>  

and the root mean square error of approximation  measures the discrepancy ε for the fitted model:

 rmsea=max0;χ2-d/dn- <dig> 

p-values for rmsea are set up from the non-central χ <dig> distribution with non-centrality parameter, λ =  × d ×  <dig>  or from a resampling bootstrap distribution. the null hypothesis of close fit is not rejected if p >  <dig> .

we also consider the standardized root-mean-square residual , one of the most used sem fit indices. srmr is a measure based on the differences between observed  values and the ones obtained from the model  of the covariance matrix:

 srmr=∑j=1p∑k=j+1psjk-σjk2/sjjskkpp+1/ <dig> 

srmr values < <dig>  are assumed as an adequate fitting measure, whereas values < <dig>  may be considered as a good fit
 <cit> .

finally, the model refinement  is obtained adding new directed or bi-directed edges to the initial model. this modification was needed considering that the initial model is only a simplified representation of the whole pathway. the criteria used for the refinement are based on the combination of three elements. first, the modification indexes , that is an estimate of the decrease in the χ2-score statistic that would result by freeing each fixed  parameter in the model; second, z-tests  of the mle; and finally, biological evidences obtained by string database
 <cit>  and by the existence of a direct path between the nodes that mi proposes to connect. the following heuristic stepwise strategy was used:

heuristic stepwise procedure:

input: list of the fixed  parameters  in the model.

output: new free parameters  in the model.

steps:

 <dig>  freeing just a single parameter  at a time, and these in turn are sorted in descending order of magnitude using mi;

 <dig>  verify if the edge  to add is present in string or when the edge is a path coefficient, if it represents a direct path that connects the nodes in the pathway selected, and then add this new edge in the model;

 <dig>  fit the model and if the new edge is statistically not significant , using a z value , remove it and repeat step 1-2;

 <dig>  stop the selection procedure if the model achieves a non significant lrt  or rmsea  or srmr <  <dig> , otherwise repeat step 1-3

multiple-group analysis
when data are observed from multiple subsamples, the representation of groups with “indicator variables”, considered as nodes, allows to recognize degs. instead, “multiple-group analysis” allows to identify differentially regulated genes  across groups.

specifically, define μ <dig> and Σ <dig> as the model-implied mean vector and covariance matrix of group  <dig>  respectively and μ <dig> and Σ <dig> as the corresponding moments of group  <dig> . for each models, two omnibus tests are performed considering the two experimental conditions , one for the differential expression genes  and the other for the strength of the edges. in the first case, the hypothesis to be tested is:

 h0:μ1θ=μ2θvs.h1:μ1θ≠μ2θ 

while, in the second case, is:

 h0:Σ1θ=Σ2θvs.h1:Σ1θ≠Σ2θ 

in the “null” model , the mean or covariance estimates are constrained to be equal across groups; in the “alternative” model , they are allowed to differ across groups. the statistical significance is determined by comparison of lrt chi-square  values at a given degree of freedom . if there is a significant difference  in the chi-squared goodness-of-fit index, the groups differ significantly for one or more specific gene expression  and/or gene-relationships . finally, three path-coefficient differences are screened: 1) “up/down” expression , testing the “zero value” for the group indicator variable  path coefficients; 2) “up/down” regulation , testing the “zero value” for the differences of path coefficients across groups; 3) “on/off” regulation  with respect to a priori kegg gene regulation target, testing the “zero value” of the edge coefficients across groups.

specifically, assume c to be the path coefficient matrix of the group indicator variables and c
i
 be an element of the matrix c. let b <dig> and b <dig> to be the corresponding path coefficient matrices in the experimental and control groups; d = b <dig> – b <dig> and d
ij
 be an element of the matrix d. we consider the test statistics:

 tc=ci/seciandtd=dij/set1=bij1/sebij1andt2=bij12/se 

where se is the estimated standard error of the parameters. the statistic tc can be used to test the conditional “up/down” expression level difference of one gene between groups, given the parents of the gene in the network. similarly, t
d
 checks the conditional “up/down” expression regulatory differences of one gene on another between groups. moreover, t <dig> and t <dig> check the “on/off” regulatory differences compared to a priori kegg pathway. the p-values of these statistics  are derived either asymptotically from the n-distribution or empirically from the nonparametric-based or using model-based bootstrap distribution with b bootstrap samples .

note that the marginal bivariate test of degs with sam approach can be regarded as the special case of the conditional test with tc, when the pathway graph is g = , so pa = ∅ for all genes ∈y.

we use the implementation provided by the lavaan
 <cit>  r package for estimation, evaluation, and modification of sem data analysis, and r codes is available in additional file
 <dig> 

RESULTS
the above described method was applied to two gene expression microarrays datasets, one from a study on ftld-u and the other on ms.

ftld-u analysis
the data were obtained from a microarray experiment that analyzes various brain regions of patients affected by ftld-u in presence of the mutation in the progranulin gene. two groups were selected: one affected by ftld with mutation in the progranulin gene  and the other constituted by the control . data are freely available at gene expression omnibus  database with id gse <dig>  for our analysis, we used normalized expression values submitted in the database. in the first step, sam was performed using a delta value of  <dig>  and a minimum fold-change of  <dig>  the number of genes up-expressed was  <dig> while the number of gene down-expressed  <dig>  using this list of degs, the spia analysis found seven important pathways for the explanation of the role of the progranulin mutation on the ftld-u, as showed in the table 
 <dig> 

psize = number of genes in the pathway; nde = number of degs in the pathway; pnde = p-value of the enrichment; ta = total perturbation; ppert = p-value of the perturbation; status = direction of the perturbation.

the most of the dysregulated pathways, as the mpak signalling pathway, the calcium signalling pathway, the gap junction and the ecm-receptor interaction, confirm the analysis of
 <cit> . the dysregulated pathways with a significant p-pert were the glutamatergic synapse and gabaergic synapse. the role of the glutamate in the acute and neurodegenerative processes were well described in literature
 <cit> . meldrum
 <cit>  illustrated three different pathological mechanisms of action of the glutamate in the neurodegeneration. glutamate can be neurotoxic through an agonist effect on the n-methyl-d-aspartate , α-amino-hydroxy-5-methyl-4-isoaxaleproprionicacid , kainate or group i metabotropic receptors. the relative contribution of these different classes of receptors vary according to the neurons involved and a variety of other circumstances. selective neuronal death subsequent to the epileptics status appears to be highly dependent on nmda receptor activation. acute neuronal degeneration after transient global or focal cerebral ischemia seems to be dependent on both nmda and ampa receptors. regarding the gabaergic pathway, a loss of glutamatergic pyramidal cells and calbindin-d28k-immunoreactive gabaergic neurons in the frontal and temporal cortices of patients with ftld
 <cit>  and ftld with motor neuron disease
 <cit>  was reported.

sem analysis of glutamatergic synapse kegg pathway
for sake of brevity, model specification was obtained only for the glutamatergic synapses pathway, but the same procedure could be used for all significant pathways. we started from the original kegg pathway and then, passing through the shortest paths model, we reached the pirsf model. four composite variables  were generated: 1) plc-beta  by entrez id genes  <dig>   <dig>  23236: variance explained 66%; 2) adenylate cyclase  by entrez id genes  <dig>   <dig>  155: variance explained 68%; 3) gtp-binding regulatory protein gs alpha chain  by entrez id genes  <dig>  2778: variance explained 53%; 4) ionotropic glutamate receptor  by entrez id genes  <dig>   <dig>  2905: variance explained 54%. the graph reduction of the model specification process was the following: from kegg  =  <dig> ) to degs shortest paths model  =  <dig> ), and to pirsf model  =  <dig> ). the initial fitting indices were poor  =  <dig>  , p <  <dig> , rmsea  = <dig>  , srmr =  <dig> ). this is likely because the existing pathway databases do not even contain all pathway information presented in the public literature
 <cit> , and because the model generated was a simplification of the real connections between nodes. twenty-two directed edges were added, six using string database and sixteen using graph information. the final pathway model was an adequate approximation of the observed covariance matrix, as demonstrated by the srmr index . two-group analysis of the final pathway model revealed a significant global mean  =  <dig>  , p <  <dig>  of h0: μ <dig> = μ <dig> subject to Σ <dig> = Σ2) and covariance differences  =  <dig>  , p <  <dig>  of h0: Σ <dig> = Σ <dig> subject to μ1≠ μ2). the specific tests that consider the effect of the progranulin mutation on every gene and every edge are summarized in tables 
 <dig> and
 <dig> 

glutam_recp = pirsf ionotropic glutamate receptor; ade_cycl = pirsf adenylate cyclise; plc_b = pirsf plc-beta; gtp_bind = pirsf gtp-binding regulatory protein gs alpha chain.

glutam_recp = pirsf ionotropic glutamate receptor; ade_cycl = pirsf adenylate cyclise; plc_b = pirsf plc-beta; gtp_bind = pirsf gtp-binding regulatory protein gs alpha chain.

four genes and one pirsf of the glutamatergic model resulted influenced by the group: genes  <dig> or psd- <dig>   <dig> or ppp3cb,  <dig> or gng <dig>   <dig> or ppp3r <dig> and the pirsf of the glutamate receptor. an important role could be played by psd- <dig> gene that is believed to be involved in the synapse maturation, in the induction of a network of neurotransmitter receptors, scaffolding proteins and ionotropic glutamate receptors
 <cit> . the gene ppp3cb and the gene gng <dig> are associated to the wnt signalling correlated to the dysregulation in the case of progranulin deficiency
 <cit> . to note that four of the nodes influenced by the group were involved in the perturbed edges described in the table 
 <dig>  giving a look to the significant edges found, the relationships  <dig> <- <dig> and  <dig> <-pirsf “glutamate receptors” are well note in the literature. in fact, the gene  <dig> or shank <dig> plays a critical role both in the integration of the various postsynaptic membrane proteins, cell-adhesion molecules, signal components, scaffolding proteins, and actin-based cytoskeleton, part of the psd protein network 
 <cit> , and in the organization of the glutamate receptors
 <cit> . the edges  <dig> <- <dig> that involves the gene itpr <dig> and the gene homer <dig> were very interesting. the relationships are involved in the spinocerebellar ataxia in human as described by
 <cit> . also other links that include the pirsf adenylate cyclase, gtp-binding regulatory protein and the plc-beta could be useful to interpret the role of mutation in the progranulin gene group.

the comparison with kegg edges revealed that  <dig> edges were not active  in the “mutant” group and  <dig> in the “control”. in contrast the edges activated  was  <dig> and  <dig> in mutant and control, respectively . the figure 
 <dig> illustrates the model and the links found statistically significant between the yes/no mutant groups.

multiple sclerosis
ms is a neurodegenerative disease with a presumed autoimmune component. the genome-wide expression study in peripheral blood mononuclear cells , from  <dig> ms patients and  <dig> controls, was performed in order to identify degs and dysregulated pathways. data are freely available at geo database with id gse <dig>  for the analysis, we used expression values submitted in the database. the sam was performed using a delta value of  <dig>  and a minimum fold-change of  <dig>  the number of genes up-expressed was of  <dig> while the number of gene down-expressed of  <dig>  using this list of degs, the spia analysis found three important pathways that could be involved in the mechanism of the development of the ms, as showed in the table 
 <dig> 

psize = number of genes in the pathway; nde = number of degs in the pathway; pnde = p-value of the enrichment; ta = total perturbation; ppert = p-value of the perturbation; status = direction of the perturbation.

the first, b cell receptor  signaling pathway, is an important component of adaptive immunity. b cells produce and secrete millions of different antibody molecules, each of which recognizes a different antigen. this signalling ultimately results in the expression of immediate early genes that further activate the expression of other genes involved in b cell proliferation, differentiation and immunoglobulin  production as well as other processes. the role of b cells is well known in ms
 <cit> . the second one, fc gamma r-mediated phagocytosis pathway, includes specialized cell types as macrophages, neutrophils, and monocytes that take part in host-defence mechanisms. expression of the inhibitory fc gamma receptor iib  plays an important role during peripheral b cell development, which prevents memory b cells with low affinity or self-reactive receptors from entering the germinal center and becoming igg positive plasma cells
 <cit> . furthermore, the decreased expression of fc gamma riib or non-functional fc gamma riib variants are consistently associated with the development of autoimmune tissue inflammation
 <cit> –
 <cit> . considering the connection between the fc gamma r-mediated phagocytosis and b cells, and the association of this pathway with autoimmune inflammation, we could conclude that also this pathway could be implicated in the ms phenotype.

salmonella infection, the third pathway, may appear less interesting, nevertheless it is connected with response to infections that, as showed for the two previous pathways, plays an important role in ms.

sem analysis of fc gamma r-mediated phagocytosis kegg
as an example, we analyzed the fc gamma r-mediated phagocytosis pathway. the model was obtained starting from the kegg pathway and finding the shortest paths between degs . the graph reduction of the model specification was from kegg pathway  =  <dig> ) to degs shortest paths model  = 17). the initial model had a poor fit  =  <dig>  , p <  <dig> , rmsea  = <dig>  , srmr =  <dig> ) and the final model was adequate considering the srmr index  and rmsea   <dig>  . to reach the final model, twenty edges were added: fifteen using as driving criteria the presence of a directed path between the nodes in the original pathway, and five using string database information.

two-group analysis of the final pathway-model revealed a significant global mean  =  <dig>  , p <  <dig>  of h0: μ1 = μ <dig> subject to Σ1 = Σ2) and covariance differences  =  <dig>  , p <  <dig>  of h0: Σ1 = Σ <dig> subject to μ1≠ μ2).

the specific tests, that analyze the effect of the disease-model on genes and edges, are reported in tables 
 <dig> and
 <dig>  five genes resulted group-sensitive: the genes  <dig> or arf <dig>   <dig> or arpc <dig>   <dig> or prkcd,  <dig> or plag2g4a,  <dig> or crkl. the gene arf <dig>  as showed by
 <cit> , could be implicated in the disruptive effects of il-1b, a gene recently associated with ms
 <cit> . in addition, other group sensitive genes could be associated with ms
 <cit> . considering the edges perturbed, the links between the gene  <dig> or arf <dig> and the gene  <dig> or crkl resulted very interesting. the il- <dig> beta, as reported
 <cit> , has an effect on the endothelial stability by the cascade myd <dig> – arno and arf <dig>  a known regulator of adherents protein localization. in turn the gene crkl, an adapter protein required for the spreading of epithelial colonies and breakdown of epithelial colonies and the breakdown of adherents junctions in response to hepatocyte growth factor, modulates the gene arf6
 <cit> . so the genes il-1b, arf <dig> and crkl could be involved in the same pathological mechanism. other interesting significant edges were the connections between gene  <dig> or pip5k1c with gene  <dig> or ppap2c and with gene  <dig> or ppap2b. the gene pip5k1c catalyzes the synthesis of phosphatidylinositol  <dig> -bisphosphate, an essential lipid molecule in various cellular processes. as described by
 <cit>  the phosphatidylinositol- <dig>  5-bisphosphate synthesis has a critical role in the regulation of multiple steps of the synaptic vesicle cycle. this gene is connected with ppap2c and ppap2b, genes that have a role in metabolic pathways controlling the synthesis of glycerophospholipids and triacylglycerols, and in receptor-activated signal transduction mediated by phospholipase d, considered a susceptibility factor in sclerosis
 <cit> .

the comparison with kegg edges showed that in the model pathway,  <dig> edges were not active  in the ms patients and  <dig> in controls. in contrast, the edges activated  were  <dig> and  <dig> in ms patients and control subjects respectively . the figure 
 <dig> illustrates the pathway model and the links found statistically significant between the ms/control groups.

discussion
this work illustrated a new procedure based on structural equation modeling  to discover and compare perturbed pathway-modules, similar to that proposed by
 <cit> . unlike these authors, new pathway analysis  and new model generation, based on mixed graph theory and principles of network biology, were added. starting from the significant dysregulated pathways, a model for each pathway was generated, that allowed both to verify how degs were connected between them in a causal structure and to improve the model interpretation by grouping not degs in pir superfamilies. to note that the initial model is not inferred by data, because connections among genes represent the biological knowledge enclosed in the pathway and in pirsfs. the use of sem proved to be very versatile in the downstream analysis of microarray data. it was used to: 1) test and improve the generated models ; 2) verify the overall differences between groups, and 3) individuate differential expression level of one gene and differential connection between two genes.

our procedure was tested on two experiments of gene expression microarray data finalized to unravel the biological mechanisms that allowed us to explain the differences between yes/no mutant groups and disease/healthy groups. starting from the output of spia, the model generation procedure, illustrated in this paper, was applied. the first step was to obtain a subgraph for each perturbed pathway containing only the genes present in the microarray. then, the connections between degs through shortest paths were found, and finally not degs were grouped in pirsfs. the models generated were tested and improved using an integrate approach based on the combination between sem and other type of evidences as explicated in the string database. once a good model has been determined, a two-groups sem analysis has been performed to unveil significant differences between groups. studying each link present in the final perturbed model, we hypothesized which connections could be altered. for example in ftld-u experiment, we found the connection between shank <dig> and psd- <dig>  and in ms we hypothesized that the genes il-1b, arf <dig> and crkl could be involved in a same pathological mechanism. these results confirmed and could be able to elucidate the mechanisms that lead to the pathogenesis and progression of the observed diseases.

the framework illustrated, being a composition of different methods, could be easily adapted to new solutions. the idea is to have a general and modular framework where different other methods could be taken in consideration in each step of the pipeline.

first, alternative ways to select degs and perturbed pathways could be considered. in
 <cit>  a unified framework was proposed to jointly find significant perturbed pathways and degs by sparse linear discriminant analysis . other methods for identifying degs and differential connections, based on graphical gaussian modeling , are the following: a first one generates networks directly from very high dimensional data, determining the pattern of zeros in the inverse covariance matrix
 <cit> ; a second one defines bayesian networks  on a structure of dependence derived from external resources
 <cit> ; the last one derives dags from external resources converting them into undirected cycle-free graphs
 <cit> . an additional approach for conducting a differential analysis of networks directly from data by measuring gene association/interaction with connectivity scores, based on partial least squares , was suggested by
 <cit> .

second, we used pca to create new observed composite variables that represent pirsfs. another plan could be to take advantage of the potentiality of sem in the creation of latent variables as proposed by
 <cit>  in transcriptional regulation of protein-dna interactions. a valid alternative to the modification indices of sem could be the pc-algorithm
 <cit> , that allow to infer causal information from data. the idea in this case is to fix an initial model, provided by the perturbed pathways model, and then use the pc-algorithm to add new links supervised by string knowledge. lastly, since in sem multigroup analysis numerous hypothesis are tested, multiple testing control procedures using the method of
 <cit>  can be desirable.

CONCLUSIONS
the pipeline proposed introduces in the analysis of gene expression data the main principles that govern biological networks as well described by
 <cit> . otherwise from reverse-engineering gene regulatory networks, that build networks directly from data, our initial models are obtained by a biological curated pathway database  and then modified on the basis of the knowledge provided by another database . the principal evidence is that the manifestation of a particular phenotype depends on the interactions existing among many causal agents. this was obtained taking in consideration not only degs but also how genes interact. the pipeline has been validated on two expression datasets. in both the cases, we tested the models, improved them and individuated the gene expression levels and the connections that were perturbed and that could justify the different phenotypes observed. the results were satisfactory and strongly coherent with experimental findings available in literature, considering that most of the genes in the model are known to characterize the phenomena analyzed and that links perturbed were previously connected to the progression of the diseases.

competing interests
the authors declare that they have no competing interests.

authors’ contribution
dp defined the procedure to generate models. mg supervised the work, in particular the statistical part, and together with dp, developed the procedure to test the models. dp and mg wrote jointly the paper. all the authors read and approved the final manuscript.

supplementary material
additional file 1
r codes for a demonstration of the procedure for the multiple sclerosis  example.

click here for file

 acknowledgements
this work was funded by laboratory of multivariate statistics, department of brain and behavioural sciences, medical and genomic statistics unit, university of pavia, pavia- italy. we want to thank, the phd student fernando palluzzi and the phd valeria carossa for their advice and helping.
