BACKGROUND
gene expression is regulated by many factors acting in concert with the status of the chromatin environment, particularly histone methylation  <cit> . the set-domain-containing protein family is a major player in histone methylation. these proteins are responsible for the methylation of lysine  residues in various histones, specifically k <dig>  k <dig>  k <dig>  and k <dig> in histone h <dig> and k <dig> in histone h <dig>  <cit> ; h3k <dig> is an exception  <cit> . all members of this family share a highly conserved set domain  <cit> , named for three drosophila melanogaster proteins: suppressor of variegation 3- <dig> 3-9) , enhancer of zeste ) and trithorax . this domain has approximately  <dig> amino acids and has been found in all eukaryotic organisms studied so far  <cit> . proteins containing the set domain can also be found in viruses as well as both domains of prokaryotes  <cit> .

recent studies have revealed that the set domain  genes are important for regulating growth and reproduction processes, such as control of flowering time and embryogenesis in plants  <cit> . genome sequencing has uncovered many genes encoding set-domain proteins; in particular, arabidopsis set genes are the best annotated and characterized. for example, the arabidopsis curly leaf  gene is required for stable repression of the floral homeotic gene agamous in leaves and stems  <cit> . arabidopsis trithorax  <dig>  functions as an activator of homeotic genes, like trithorax in animal systems  <cit> . arabidopsis trithorax-related protein  <dig>  is an h3k <dig> methylase required for proper expression of the flowering locus c  gene  <cit> . the arabidopsis ash <dig> homolog  <dig>  protein has been suggested to methylate h3k <dig> and/or h3k <dig>  similar to drosophila ash <dig> and yeast set <dig>  a h3k <dig> histone methyltransferase   <cit> . other set genes are associated with embryogenesis, including medea ; a maternally inherited loss-of-function mea allele results in embryo abortion and prolonged endosperm production  <cit> . recently, atxr <dig> is crucial for both sporophyte and gametophyte development and encodes the major enzyme responsible for trimethylation of h3k <dig>  <cit> .

in plants, at least  <dig>   <dig>   <dig>  and  <dig> set genes have been identified in arabidopsis, grape, maize and rice, respectively  <cit> . in both arabidopsis and rice it has been determined that many set genes are located in large blocks of related regions derived from whole genome duplication events, indicating that whole genome duplication could be an important contributor to the duplication of set genes  <cit> . in addition, different classifications of set genes were used in different plants. initially,  <dig> putative arabidopsis set domain proteins were classified into four distinct classes:  enhancer of zeste  homologs;  trithorax  homologs and related proteins;  ash <dig> homologs and related proteins; and  suppressor of variegation  homologs and related proteins  <cit> . in another study,  <dig> arabidopsis and  <dig> maize set genes were classified into five classes according to phylogenetic relationships and domain organization  <cit> . more recently, two additional classes  were recognized for set genes in arabidopsis, grape, maize, and rice  <cit> . interestingly, in arabidopsis several genes in class iii, like atxr <dig>  were shown to be crucial for both sporophyte and gametophyte development  <cit> . moreover, arabidopsis has ten su homologue  genes belonging to class v, including several that control heterochromatic domains. loss of function of these genes suppresses gene silencing, whereas overexpression enhances silencing, causing ectopic heterochromatization and significant growth defects in arabidopsis  <cit> . therefore, set genes in different subfamilies could have diverse functions.

previous studies of set genes have focused on annotation and arabidopsis functional characterizations  <cit> ; in addition evolutionary analyses have been limited to herbaceous plants  <cit> . trees are distinct from herbaceous species in many ways: they have a self-supporting structure, the secondary growth or wood, and a much longer lifespan  <cit> . the regulatory networks and molecular mechanisms that underlie these unique properties cannot be investigated through the examination of nontree species. therefore, it is worthwhile to study set genes in trees, thereby improving our understanding in their functions and the evolution of set genes. the recently completed genome sequence of the model tree, populus trichocarpa   <cit> , provides a great opportunity to investigate these issues.

molecular evidence suggests that arabidopsis and populus shared their last common ancestor as much as  <dig> to  <dig> million years ago  <cit> . since then, arabidopsis and populus have evolved different life histories, including herbaceous versus arboreal development, annual versus perennial habit, and self-pollination versus cross-pollination strategies  <cit> . in addition, since they diverged from each other, populus has experienced whole genome duplication once, whereas arabidopsis has twice  <cit> . in plants, evolutionary diversity has been hypothesized to be modulated directly or indirectly by epigenetic regulations  <cit> . therefore, the set gene family, among the most important epigenetic regulators, could be postulated to contribute substantially to the evolutionary innovations in plant diversity.

we conducted a comparative analysis of set genes from arabidopsis and populus to address the key question: how have set genes evolved in populus after the divergence of arabidopsis and populus. in particular, how did the set gene family expand and diversify in populus? in this study, we performed comprehensive analyses of set genes from populus, including phylogeny, gene structure, domain architecture, gene duplication and diversification, and expression profiling analyses. our results provide insight into the function of populus set genes and provide a basis for understanding how gene functions, particularly functions involved in the development of trees, have evolved.

RESULTS
identification of set genes in populus
we obtained the populus whole-genome shotgun trace data from jgi and identified all predicted proteins containing set domains. we named populus set genes based on the previously reported arabidopsis set gene names  <cit>  and phylogenetic relationships here . the arabidopsis set genes follow the standard gene symbol conventions with all capital letters; for genes from populus, the first letter was capitalized but others were in lower case, using the same name as the closest arabidopsis homolog. if the name of the closest arabidopsis homolog is already used for a populus gene, then the name of the next closest homolog is used; if two or more populus genes are equally close to a single arabidopsis gene, then the same name is used followed by the letters "a", "b", etc. a total of  <dig> populus set genes were identified and compared to set genes in arabidopsis  and rice   <cit> . there were a total of  <dig>  protein-coding genes in populus,  <dig>  in arabidopsis and  <dig>  in rice. this suggested that the numbers of set genes were not proportional to the sizes of the predicted gene sets.

* represent the subfamilies shown in figure 1

phylogeny and gene structures of populus set genes
to understand the evolution of populus set genes, we performed unrooted phylogenetic analyses on the  <dig> set genes from populus  and arabidopsis  using maximum likelihood , bayesian inference  and neighbour-joining  methods . the tree topologies produced by the three methods are largely consistent, with only minor differences at interior nodes . the nj tree is shown in figure 1a and discussed below. most populus set genes clustered with their homologs in arabidopsis. sometimes, however, two populus genes clustered together with either a single arabidopsis gene, or without any corresponding gene in arabidopsis . in total, there are  <dig> such pairs of populus set genes.

the phylogenetic tree topology and the predicted protein domain compositions also allow the grouping of the  <dig> set genes in arabidopsis and populus into eight subfamilies , trx, smyd and setd; figure 1a), generally in accordance with those in other plants  <cit> . nevertheless, there were some differences from prior classifications  <cit> . one notable difference is that recent classifications placed mea, clf and swn in class i and atx <dig>  atx <dig>  atx <dig>  atx <dig>  atx <dig>  atxr <dig> and atxr <dig> in class iii  <cit> , but our results had all of these genes clustering together, forming a monophyletic clade with bootstrap support of 77% . in addition, each subfamily formed a group with high bootstrap support in the unrooted ml/bi/nj analysis and may have the same ancestral origin.

in general, members from the same subfamily shared similar exon/intron structures, e.g. intron number and exon length; however, some members of the suv, smyd and setd subfamilies  had structural differences from other members. in the suv subfamily, retrotransposition events have been reported  <cit> , which could have contributed to the diversity of the subfamily members. for subfamilies smyd and setd, we observed considerable diversity in gene structure and highly divergent sequences among subfamily members, but this diversity and its possible functions have rarely been reported.

expansion and evolution of the set gene family in populus
the phylogenetic analysis of populus set genes indicates that they have experienced multiple gene duplication events. gene duplication mechanisms include tandem duplication and large segmental/whole-genome duplication . to examine the relative contribution of each of these mechanisms in the expansion of the set gene family, each member was electronically mapped to loci across all  <dig> populus chromosomes and  <dig> additional scaffolds according to the location information provided by the jgi database  <cit>  . chromosomes lg xi and lg xix did not contain any set genes . the highest number of set genes  was found on chromosome ii, v and xiv . intriguingly, we did not identify gene clusters on any populus chromosomes , indicating that tandem duplication was not the cause of the detected duplicates in the populus set gene family. this is similar to the lack of tandem duplication events in the arabidopsis and rice set gene families  <cit> .

previous studies showed that the populus genome contains evidence for three or more distinct wgd events  <cit> . actually, strong support has been reported for two ancient wgd events in ancestral lineages shortly before the diversification of extant seed plants  and extant angiosperms , respectively  <cit> . we analysed all of the duplicated gene pairs with intragenome syntenic relationships in the populus genome from plant genome duplication database   <cit> . all  <dig> of the duplicated pairs of populus set genes resided in populus segmental duplicated blocks . particularly, the atx4/atx <dig> and atx3a/atx3b pairs were also located on two pairs of duplicated segmental blocks .

the mean ks value was calculated for each pair of protein-coding genes within a duplicated block and used to date the duplication events. ks values of all duplicated gene pairs greater than  <dig>  and less than  <dig>  were discarded for arabidopsis; ks greater than  <dig>  for populus was also discarded, except atx4/ <dig> and atx3a/b

in addition, we calculated the values of synonymous substitutions per synonymous site  of duplicated gene pairs from pgdd, which we assumed to be correlated with the time of divergence since the genome duplication . apparently, the populus duplicates found in syntenic blocks matched with two wgds . there was also a third peak , which might be due to the ancient angiosperm-wide and/or seed plant-wide wgds  <cit> , with possible blurring of the distinction between the two expected peaks due to subsequent ks rate variation. to estimate the divergence time of the  <dig> duplicated gene pairs, we calculated their syntenic ks values. they could be classified at least into two categories . the first category included the  <dig> gene pairs, whose locations in the syntenic region are shown in figure 2c and additional file  <dig>  they had an average ks value between  <dig> - <dig> , corresponding to the first peak  in figure 2b. this duplication event was dated to  <dig> - <dig>  mya, corresponding to a recent segmental duplication/wgd event in populus, approximately 10- <dig> mya after the split from the lineage leading to arabidopsis  <cit> . the other category included one pair of duplicated blocks ; their detailed locations in the syntenic region are shown in figure 2d and additional file  <dig>  interestingly, they had much higher average ks value,  <dig>  , corresponding to the second peak. these duplicated blocks could be due to the retention of genes from an ancient wgd event shared by core eudicots  <cit> . in addition the ks values of between suvh4a and suvh4b or suvh4c were  <dig>  or  <dig> , respectively , suggesting that the duplication of suvh4a and suvh4b/c could be due to the wgd shared by the core eudicots. other pairs of poplar set genes have ks values ranging from  <dig>  and  <dig> , consistent with them being from even older wgd duplications, but the ks values are not reliable to assign the specific wgd. our analysis strong suggests that segmental duplication events, especially those resulting from recent polyploidy events, have contributed to the expansion of the set domain gene family in populus.

domain diversity in populus set gene family
domains are basic functional and structural modules in proteins, and new combination of domains is associated with specific changes in protein functions  <cit> . we analysed the domain architecture of the set gene family in populus. in addition to the set domain, most of these set proteins included other domains with known or predicted functions. in particular, each of the six subfamilies found in our analysis had its own specific functional domains , similar to those in arabidopsis, maize and rice  <cit> . in some subfamilies, there were gains and/or losses of domains. preset, set, and postset are considered to be primordial domains  <cit> , and they are usually organized in proteins in the order preset/set/postset, as seen in the suv subfamily. other domains  were integrated into this primordial structure to form new gene family members; other members lost one or more of the primordial domains during their evolution . the general patterns of domain gains and losses were similar in the ash, trx and e subfamilies.

some duplicated gene pairs  also experienced some domain gains and losses . for instance, suvr5b gained a znf_c2h <dig> motif near the n-terminus of the encoded protein compared with its counterpart suvr5a . compared with its counterpart atxr7a, atxr7b lost the pfam: luteo_coat domain near the n terminus . we have checked all  <dig> pairs of genes produced by the most recent rounds of wgd in populus, and found that  <dig> pairs of them  have experienced domain gain and losses. in contrast, among the  <dig> pairs of wgd duplicates in the set domain gene family, ~ 45% of them  have experienced domain gain and losses . these gains and losses of domains tended to occur near the n terminus , although they were occasionally found at the c terminus . most set domains are located near the c terminus and there might be specific functional constraints that protect the stability of the domain architecture at the c terminus.

*: n: n-terminus of protein, c: c-terminus of protein. **: shown in figure 4

the analysis of the populus set genes indicated that one of two recent set duplicate undergoes domain gain or loss, during a relatively short period of evolutionary time following a recently wgd event. new domain architectures can drive the evolution of organismal complexity  <cit> ; for example, recombination of domains encoded by genes belonging to the yeast mating pathway had a major influence on phenotype  <cit> . therefore, the domain gains and losses in set genes that occurred  <dig> - <dig>  mya might have been a strong force of evolution of populus complexity. because set proteins are important for histone modification and chromatin structure, they can play crucial roles in regulating gene expression during plant development  <cit> . that their domain architecture has incurred major changes in a short time indicates that epigenetic regulation could be somewhat plastic.

expression analysis of set genes in populus
to learn about the expression patterns of set genes, we reanalysed the populus microarray data generated by wilkins and co-workers  <cit> . only four set genes  did not have corresponding probes in that dataset, and the expression profiles of the other  <dig> set genes were analysed as shown in figure  <dig> and additional file  <dig>  we also investigated the frequency of ests from est databases at national center for biotechnology information   and obtained digital expression profiles of  <dig> populus set genes; the other  <dig> set genes did not have est data . the set genes were expressed widely in a number of tissues; intriguingly, expression level of the set genes in specific tissues was higher in young leaves  than in other tissues , except the mature leaves  and roots . in contrast, the expression level in differentiating xylem  was lower than in other tissues , except light-grown seedling  and dark-grown seedlings .

based on hierarchical clustering, the expression patterns of set genes could be divided into four groups: g1-g <dig> . g <dig> can be divided into two subgroups: g1-sub <dig> and g1-sub <dig> . their expression patterns are listed in table  <dig>  the ortholog of clfb in arabidopsis was clf, which is required to repress flc  <cit> . based on the expression of clfb in populus, we inferred that clfb could have a similar effect on flowering and the shape of mature leaves in populus.

â€»based on hierarchical clustering as shown in figure 5

in addition, we determined the expression profiles of the duplicated set gene pairs. in  <dig> of the  <dig> duplicated gene pairs, both copies were co-expressed . as shown in figure  <dig>  the expression profiles of these  <dig> duplicated set genes formed two patterns: i) one paralog was expressed higher than the other in at least one tissue, whereas the other was expressed at a higher level in some other tissues ; or ii) one paralog had lower expression levels than the other in all tissues .

structural divergence of duplicated populus set gene pairs via four major scenarios
previous studies showed that structural divergences have played important role during the evolution of duplicates in plants  <cit> . to understand the structural divergence of duplicated populus set gene pairs, we compared gene structures between the two recent paralogs in each of the  <dig> duplicated gene pairs. we found that the 3'-and 5'- terminal regions  of most duplicated populus set pairs were highly divergent . the 5'-terminal end is more polymorphic than the 3'-terminal end . further investigation of their sequences revealed that these gene structure changes could have originated from one  of four major scenarios .

we have found that the 3'-terminal and 5'-terminal regions  of most duplicated populus set gene pairs were highly divergent, particularly the 5' end . further investigation of their sequences revealed that these gene structure differences could have originated from one  of four major scenarios . the first scenario is insertion or deletion  of partial or entire exons . for example, the first exons at the 5' ends of atxr7a and atxr7b matched very well with one other except that the exon in atxr7b lacked three nucleotides at its beginning, indicating an indel event of one codon . a notable indel case was the loss of an entire exon at the 5' end of the clfb gene in comparison with clfa . changes in exon length between most duplicated pairs appeared to have resulted from this scenario .

the second scenario was the intronization/exonization of a partial or entire exon/intron . the second exons at the 5' ends of clfa and clfb were extremely similar in sequence, but atxr7a was about  <dig> bp longer at its 3' end; we found that part of a clfb intron had been exonized in clfa . in another interesting case, the second exon in ashh2a matches an intronic region in ashh2b, demonstrating intronization of the whole exon .

the third scenario was the gain of introns, which divide one exon into two or more smaller ones, or the loss of introns, which unite two or more exons into one longer one . the exons near the 5' ends of suvh <dig> and suvh <dig> make a persuasive example . there were two exons,  <dig> and  <dig>  at the 5' end of suvh <dig>  which flanked a  <dig> bp intron; whereas there was a single exon,  <dig>  at the 5' end of suvh <dig>  without an intron.

the last scenario involved an increase or decrease in the utr at the 5' ends of duplicated pairs genes . generally, the utr of one duplicate was longer than the other. for example, suvh <dig> had a longer utr at its 5' end than its corresponding region in suvh <dig> . taken together, scenarios 1a and 2a alters exon length, whereas scenarios 1b and 2b and  <dig> change exon number, or scenario  <dig> change intron number. in contrast, the 3' ends of the duplicates were not as different as the 5' ends. the most common case was a change in the length of the utr at the 3' end.

discussion
we have performed systematic phylogenetic analysis of populus set genes, and determine ks values of duplicates and examined their expression patterns. our analyses indicate that set genes have experienced many duplication events during the populus evolutionary history. the relatively recent duplicates are likely the results of whole-genome duplication, and many show structural divergence, including gain/loss of functional domains. furthermore, at least some recent paralogs exhibit divergent expression patterns. therefore, set genes in populus provide a case study for evolution of genes following duplication, showing both gene loss and retention with functional divergence at both structural and expression levels.

genome duplication and evolution of set genes
there are  <dig>   <dig> and  <dig> known set genes in populus, arabidopsis and rice, respectively. the populus genome has experienced at least four rounds of genome duplication: two ancient duplication events prior to the gymnosperm-angiosperm divergence and before the diversification of all extent angiosperms, an intermediate event shared with all core eudicots plants, and a recent event occurring after the divergence of the lineages leading to populus and arabidopsis  <cit> . our analysis suggested that, of the  <dig> duplicated pairs of adjacent populus set genes on the phylogenetic tree, all resulted from the recent wgd event. among older duplicates prior to the split of populus and arabidopsis, one or two suv pairs and one atx pair likely resulted from the core eudicot wgd, and possibly others from older wgds. given that at least four rounds of wgd are known in the populus lineage, many genes loss within the set gene family appears to have occurred in populus. the arabidopsis lineage has experienced two wgd events since its split from the populus lineage and has lost many of the duplicates  <cit> . our investigation of arabidopsis set genes revealed five duplicated gene pairs since its divergence from populus. these five pairs had average ks values between  <dig> - <dig> , with estimated dates between  <dig> - <dig>  mya for the duplication, corresponding to a recent wgd in arabidopsis  <cit> . furthermore, soybean has experienced one more wgd event than populus since its split with the populus lineage, and it has  <dig> more set genes than populus. most of the increased soybean set gene number resulted from the recent wgd . therefore, the expansions in the set gene family in arabidopsis, populus, and soybean could be explained by gene loss and gain after wgd events.

an increase in the number of regulatory genes  is one of important factors that facilitated the evolution of more complex developmental systems  <cit> . maere et al. estimated that more than 90% of the increases in arabidopsis regulatory genes were likely caused by genome duplications during the last  <dig> million years  <cit> . our results suggest that wgd could be the main mechanism for the expansion of the set gene family in populus, consistent with this idea. to date, many studies have shown that many members of transcriptional factor  gene families survive after wgd events  <cit> , but few papers report on epigenetic regulatory gene families. set genes are important epigenetic regulatory gene and have been largely retained after wgds. epigenetic regulators modulate expression of a large number of functionally related genes. therefore, our study suggests that more basic regulatory gene families could have evolutionary mechanisms similar to tf genes, which might contribute to the evolution of gene networks and provide insight into chromatin regulatory evolution.

expression profiles of set genes and functional diversity of duplicated pairs in populus
we investigated populus microarray and est data and found that most set genes are expressed relatively widely, suggesting that the populus set genes that have survived after wgd events are likely functional. similarly, almost all arabidopsis and soybean set genes were expressed , again suggesting that these set genes have functions.

according to the expression patterns of populus genes and the functions of their arabidopsis orthologues, we could hypothesize possible functions of these genes in populus. for example, the orthologue of swnb in arabidopsis is swn, which is involved in h3k <dig> trimethylation at important floral and shoot developmental genes, including agamous and shoot meristemless   <cit> . therefore, swnb might have a function similar to swn in regulating populus flower and shoot development. however, some set genes were specific to populus, for example, suvr4a, suvr4b, atx3a, and atx3b. all of these genes have abundant transcripts in populus and are expressed at different levels in different tissues. these results suggest that their counterparts in arabidopsis have been lost and the functions are either not needed in arabidopsis or performed by other genes.

interestingly, one of the greatest differences between the populus set genes and arabidopsis set genes is that there are  <dig> duplicated populus set gene pairs but only five arabidopsis set gene pairs. in  <dig> of the  <dig> duplicated gene pairs, both copies of were expressed, with two types of expression patterns.

the first type is that one copy was expressed at higher levels than the other in one or more tissues, but the other copy was higher in some other tissue . for example, ashh2a and ashh2b corresponded to ashh <dig> in arabidopsis, which negatively regulates shoot branching  <cit> . the ashh2a and ashh2b duplicates in populus are both expressed at the same stages and could repress shoot branching in populus. swna and swnb corresponded to the arabidopsis swn, which exhibits partial functional redundancy with clf and mea  <cit> . populus is a perennial woody plant with a juvenile-to-mature phase change, so its flowering processes is different from that of arabidopsis and may require two duplicates with somewhat different functions to regulate these processes.

the second type is that one duplicate was expressed at higher levels than the other in all tissues , suggesting that ther former has a stronger function than the latter. the arabidopsis atxr <dig> gene corresponds to the poplar atxr3a and atxr3b. atxr <dig> mutants are smaller with curly leaves, short roots, early flowering, and female sterility  <cit> . the closest populus homologues of atxr <dig> may also play important roles in regulating broad developmental processes, consistent with one duplicate having wide-ranging high level expression. similarly, the fact that arabidopsis suvh <dig> is responsible for the majority of h3k <dig> dimethylation in heterochromatin and affects the number of floral organs and the expression of phosphoanthrinilate isomerase   <cit>  suggests that the populus homologues suvh4a and suvh4b could also regulate multiple developmental processes.

the two different expression patterns in different tissues of the  <dig> duplicated gene pairs suggest functional diversification and possible function redundancy , respectively. many models for the evolution of gene duplications have been proposed in the past nearly four decades  <cit> . recently, divergence in expression between duplicates has also been examined for arabidopsis regulatory genes  <cit> . the first pattern may support the duplication-degeneration-complementation  model, in which divergent expression in different tissues allows functional differentiation of the duplicates and finally lead to subfunctionalization or neofunctionalization  <cit> . on the other hand, the latter pattern might suggest functional reduction for one copy , before the weak copy is completely lost   <cit> .

CONCLUSIONS
we have shown that populus has gained additional set genes compared with its common ancestor with arabidopsis, due to a wgd since the divergence from the lineage leading to arabidopsis. those duplicates that have been retained show divergence in both coding regions and expression levels, suggesting that the set genes might have experienced functional diversification, including possible subfunctionalization. the increased number of set genes with potentially distinct functions could have supported the evolution of epigenetic gene regulation of a woody perennial that is more complex than that of an herbaceous annual.

