BACKGROUND
the increasing number of newly sequenced genomes is stimulating interest in comparative genomics and highlighting the need for the development of efficient tools that enable assessing their evolutionary relatedness. one problem of central importance is the identification of blocks of genes  with evolutionary conserved order. these synteny blocks help in tracing back the evolution of genomes in terms of rearrangement events, such as reversals, translocation, fusion, fission etc. consequently, genome evolution and phylogenetic  trees can be reconstructed from the analysis of synteny  <cit> . furthermore, the presence of conserved blocks of genes in multiple genomes may also indicate functional relatedness of their products, e.g., in terms of protein-protein interactions  <cit>  or presence of functionally important non-coding regions  <cit> .

the evolutionary distance between two genomes can be expressed in terms of the minimum number of reversals to transform one genome into another, which is also referred to as the reversal distance  <cit> . in this approximation, translocation, fission and fusion events are represented as reversals, whereas the effect of transpositions is neglected. furthermore, it is important to realize that rd is dependent on the choice of a set of discrete markers that are conserved between two  genomes, the actual definition of synteny blocks , the algorithm used to detect synteny blocks and various other parameters. therefore, synteny identification and the resulting reversal distances need to be carefully assessed with respect to these choices, requiring fast algorithms and flexible tools.

a number of browsers, including ensembl syntenyview  <cit>  and ncbi's mapviewer  <cit>  can be used to visualize synteny for well annotated genomes. while the existing tools offer a variety of graphical representations of synteny blocks, they typically show pre-computed results for selected genomes and do not allow users to interactively assess the effects of the choice of a set of markers or other critical parameters, such as the minimum length of synteny blocks or the required minimum number of markers within a block. furthermore, the evolutionary distances between genomes of different species are not computed directly by these tools. we developed a new web server, called cinteny, which combines fast computation and assessment of the reversal distance with interactive synteny browsing and visualization in multiple genomes.

thanks to remarkable algorithmic developments, the reversal distance  can be efficiently computed in linear time  <cit> . utilizing these algorithmic achievements, the grimm server was developed  <cit>  to compute reversal distances for arbitrary pairs of genomes. however, the genomes of interest, as defined in terms of specific markers, must be first converted to signed numeric permutations by the user. this makes the use of grimm and interpretation of its results somewhat tedious, especially for multiple genomes. cinteny addresses these limitations and additionally provides a number of features that facilitate identification and visualization of synteny blocks and measuring the reversal distance in multiple genomes.

implementation
data structure and algorithm
in order to efficiently represent the linear order of markers on a genome, cinteny uses a tailored data-structure, which is implemented as a straightforward extension of ternary search trees   <cit> . in particular, we extended tsts by "walks" through the leaves of the tree, which correspond to "walks" on the genome markers in their linear order. such markers can be defined, e.g., by using the notion of orthologous genes, which are also referred to as homologous genes to indicate the similarity or homology between their sequences. thus, homologous genes can be identified in the genomes of interest using sequence alignment and other annotation methods. we would like to comment, however, that the data structure and implementation considered here are, in fact, applicable to other readily available sets of unique markers that can be identified in the genomes of interest, as discussed in the results and discussion section.

there are several advantages of this hybrid data-structure: i) a gene may be searched in logarithmic time as the complexity of tst is similar to a binary search tree; ii) starting with a gene, one can directly enumerate all orthologs; iii) starting with a gene, one can visit the genes upstream and downstream by traversing up or down the walk. these factors facilitate the identification of conserved blocks and their representation in the form of a signed numeric permutation in linear time. consequently, the reversal distance can be computed in linear time overall, using the approach by hannenhalli and pevzner  <cit> , with modifications proposed by bader and colleagues  <cit> . moreover, the construction of the tst graph and associated walks scales linearly in practice  where n is the number of markers), which makes it is suitable for large genomes. as result, a typical query, involving computation of the reversal distance for a pair of mammalian genomes, takes only a few cpu second on a typical desktop pc.

initially, we define the synteny blocks by identifying blocks of conserved markers without any disruption of order and all the genes or other markers having the same relative orientation, i.e., two signed permutations representing these blocks being identical up to one reversal operation. these initial blocks with perfectly conserved order are subsequently extended  into larger  synteny blocks by ignoring smaller blocks, such as those resulting from micro-rearrangements. the aggregation strategy used here is based on that of peng and colleagues  <cit>  and involves adjustable parameters defined in the results and discussion section .

these parameters effectively define the extent to which small divergences are tolerated within extended synteny blocks. we note also that many divergences in gene  order may involve markers only observed in some genomes; these are thus automatically filtered out when multiple genomes are used, as described in the next section. the resulting coarse-graining leads to further computational simplifications, making cinteny suitable for large scale comparisons of multiple genomes and a comprehensive sensitivity analysis of the results.

using multiple genomes
finding synteny blocks and the reversal distance typically involves identifying markers  that are shared by two species of interest. for example, the synteny between human and mouse can be analyzed using  <dig>  orthologs, as identified by homologene  <cit> . using cinteny, one may extend this approach to include a reduced set of markers common to multiple species, e.g.,  <dig>  genes common to human, chimpanzee, dog, mouse and rat genomes. in the latter case, the pair wise synteny  between human and mouse may be found using this reduced set of  <dig>  genes . the advantage of this approach is that only highly conserved segments are used and the aggregation of synteny blocks is taken care of automatically, filtering out micro-rearrangements. on the other hand, in some cases this strategy may lead to a significant loss of data, especially if one of the genomes included in the analysis is poorly annotated, resulting in many missing genes or other markers. we stress, however, that the multiple genome-based approach is just one of several available options for synteny block detection that can now be easily compared with alternative strategies.

visualization
cinteny enables analyses of genome rearrangements at three different levels: genome-wide, chromosome or around individual genes. the graphical layer for synteny browsing and analysis is built using php and enables intuitive interpretation of the results. all graphical representations are cross-linked and can be browsed interactively. for example, one can easily jump from a genome level view to a chromosome level view, or further magnify a synteny block for a detailed study. the graphical elements are also linked to external resources, such as ncbi. public domain packages, including gbrowse  <cit>  and synview  <cit>  are also used to provide alternative views of synteny blocks.

RESULTS
in this section, we demonstrate examples of interrogating evolutionary relatedness of genomes using the cinteny server. different types of queries and different setup of parameters are illustrated. in particular, we show how the cinteny web server can be used to identify synteny blocks and compute the reversal distance  between whole genomes as well as between any two chromosomes of two genomes.

in order to perform sensitivity analysis for the computation of rd and identification of synteny blocks, cinteny allows the user to interactively adjust several parameters, including: i) minimum length of synteny blocks ; ii) maximum gap between adjacent blocks for aggregation ; iii) minimum number of markers in a block . aggregation refers here to combining smaller synteny blocks to form larger blocks, wherever feasible. for example, by increasing the length between adjacent blocks , one may effectively join segments which are otherwise far apart and obtain longer synteny blocks. thus, such aggregation provides an effective coarse-graining of synteny blocks and affects the resulting rds.

another problem in applying algorithms for synteny block identification is posed by degenerate markers, such as paralogs . in particular, the hannenhalli-pevzner theorem assumes that markers are unique  <cit> . in order to address this problem, cinteny offers several different options for dealing with paralogs and enabling the assessment of these heuristics. one rational strategy is to use a paralog which lies within the most conserved region . in fact, this is the default option used also for all the examples shown in this paper. other options, which are provided to enable an assessment of the results of such arbitrary choices, include the use of a random paralog or ignoring all genes which have paralogs.

whole genome analysis
finding synteny and the rd between whole genomes is discussed here as an example of a typical application in comparative genomics. figure  <dig> shows the synteny blocks for human and mouse genomes. the genome shown in the right panel  is the source genome and the genome on the left  is the target genome. all chromosomes of the source genome are shown in unique colors. each chromosome of the target genome is shown as composed of segments of some chromosome of the source genome, as indicated by the corresponding color. for example, the majority of human chromosome  <dig> is composed of  mouse chromosomes  <dig>   <dig> and  <dig> 

the figure was generated using a particular level of coarse-graining , as defined by min_len =  <dig> kb, max_gap =  <dig> mb and min_num =  <dig>  the number of synteny blocks found with these parameters and using the set of  <dig>  human-mouse orthologs, as identified by homologene  <dig>   <cit> , is  <dig> and the rd is  <dig>  these results are in qualitative agreement with previous studies  <cit> . however, it should be noted that by changing the level of coarse graining one may obtain very different results. for example, using min_len =  <dig>  max_gap =  <dig> and min_num =  <dig>  we find that number of synteny blocks increases to  <dig> and the rd to  <dig>  respectively. we discuss further the problem of the dependence of the results on the parameters in multiple genomes section.

chromosome level analysis
cinteny can also be used to identify synteny blocks and reversal distance between two chromosomes. in this case we use common markers located on the chromosomes of interest. in figure  <dig>  we show an example of synteny for the x chromosome of the mouse and the rat genomes. figure 3a shows the syntenic blocks obtained without any aggregation . the number of synteny blocks is  <dig> and the rd is  <dig> in this case. on the other hand, when using the aggregation described in the previous section, the number of synteny blocks is reduced to  <dig> and the rd to  <dig>  respectively . as discussed later, similar results were obtained by imposing natural coarse-graining that utilizes multiple genomes.

analysis of individual synteny blocks
in addition to queries illustrated above, one may use cinteny for visualization and analysis of the synteny around a specific marker or gene. for example, starting with human and mouse genomes and default aggregation parameters, we find that the human brca <dig> gene is present in a conserved region of size  <dig>  mb in human chromosome  <dig>  whereas its mouse ortholog  is present in a conserved region of size  <dig>  mb on mouse chromosome  <dig> . on the other hand, the dkk <dig> gene is present in a conserved region of size  <dig> mb in the human genome and its ortholog, dkk <dig>  is present in a conserved region of size  <dig>  mb in the mouse genome. several examples of such queries are available in the online help available at the cinteny web site.

using multiple genomes
the use of multiple genomes for genome rearrangement analysis has been proposed before, e.g., in order to derive relationships between canine and other mammalian genomes  <cit> . cinteny web server allows one to perform a 2-way  as well as multi-way  analysis. as an example, figure  <dig> compares the whole genome synteny between rat and mouse genomes, as identified using 2-way and 5-way strategies that utilize subset of markers common to two  or five genomes , respectively .

an intermediate aggregation level is used here for the two-way comparison , with min_len =  <dig> kb and max_gap =  <dig> kb, leading to a reversal distance of  <dig>  in figure 5b, the same setup of parameters is used, except that only orthologs common to the five mammalian genomes are used. in the latter case, the rd of  <dig> is obtained. in addition, one can see that there are, in general, fewer gaps  in the 5-way analysis , as a result of a natural coarse-graining due to selecting only highly conserved markers included in 5-way analysis.

thus, as illustrated above, the absolute values of reversal distances may vary significantly with different choices of markers and aggregation strategies. we would like to comment, however, that rd is much more sensitive to the choice of parameters  when using the 2-way approach, which can be easily verified using the cinteny server. it also interesting to note that in relative terms  the reversal distances appear to be quite constant for a range of aggregation parameters, especially when using the multiple genome approach . this may suggest that rds can be used to indicate evolutionary relatedness in relative terms, as long as proper parametrization of the problem is used. this is the subject of a future work.

to further illustrate the usefulness of multi-way approach, we performed a 5-way analysis for the x chromosome of mouse and rat without any aggregation, yielding the rd of  <dig> and  <dig> synteny blocks. comparison with figure 3b, as well as comparison of the number of synteny blocks and rds obtained using different aggregation strategies, suggests that using multiple genome approach provides a natural coarse-graining that allows one to select appropriate aggregation parameters for genomes of interest. additional examples, e.g., regarding fungal genomes that are characterized by very different gene densities and high levels of genome rearrangements , are included in the on-line help. we also comment that recent efforts to better and more fully annotate orthologous genes in hundreds of sequenced genomes  <cit>  will likely make tools for multiple genome-based analyses even more important.

CONCLUSIONS
the identification of synteny blocks, and the subsequent calculation of the reversal distance, is highly sensitive to the choice of parameters. therefore, sensitivity analyses and careful assessments of the choice of critical parameters are important for drawing meaningful conclusions from inter-genomic comparisons. we present a new tool which offers a flexible platform for such analysis, enabling customization of synteny block detection and sensitivity analysis for the resulting estimates of evolutionary relatedness and plausible scenarios of genome rearrangements from ancestral genomes.

cinteny performs all computations on the fly, allowing the parameters to be adjusted and the results recomputed interactively. since the computation of the reversal distance for a pair of mammalian genomes takes only about a few seconds, one can easily assess the effects of various approximations and different levels of coarse-graining. for example, blocks larger than  <dig> kb are typically used for analysis of mammalian genomes. however, a different threshold may be more appropriate for smaller genomes, e.g., fungal genomes. in particular, a natural aggregation of synteny blocks can be achieved using multiple genomes. in addition, the effect of paralogs may be assessed by choosing a range of options, from removing all paralogs to using the ones that are contained within the largest conserved blocks.

while some well-annotated genomes like human, mouse, rat, dog, chimpanzee, nematode, drosophila, fungal genomes, etc. are pre-loaded, cinteny also allows users to upload their own data. hence, it can readily be used for the analysis of newly sequenced genomes, with user provided set of markers. automated identification of conserved sequenced tags for multiple, unannotated  genomes is being implemented as an extension of the current work.

availability and requirements
• project name: cinteny

• project home page: 

• operating system: platform independent 

• programming languages: c++ and php

• other requirements: none

• license: gnu gpl

• restriction to use by non-academics: license needed.

list of abbreviations
rd – reversal distance

authors' contributions
jm conceived of the study. aus and jm designed the software and aus implemented it. aus and jm drafted the manuscript. all authors read and approved the final manuscript.

