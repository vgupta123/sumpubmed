BACKGROUND
during the last decade, high-throughput technologies have been extensively used to monitor the expression profile of known and predicted genes. those studies allowed to compare samples between healthy and pathologic tissues or cell-types, to monitor the effects of several drugs, and to describe sets of genes based on their implication in several biological processes  <cit> . as several microarray platforms are available , different preprocessing and statistical analysis tools were developed, according to the specificities of each system. here, we focus on the affymetrix genechip family products. the old generation chips used two types of probes to monitor the expression: perfect match probes  and mismatch probes , with the aim of characterizing non-specific binding thanks to the introduction of a mismatch in the central position of the probe. irizarry et al. showed that the mm signal is also dependent on the pm target concentration, thus leading to a more complex situation where each mm probe signal should be interpreted using specific and non-specific binding  <cit> . the original idea of subtracting mm signal to pm signal before statistical analysis thus evolved, in different directions: several groups recommended to use pm-only signal, where others used an adjusted mm signal  <cit> . mm probes were also used as weak specific binders to estimate the background and saturation level  <cit> . note that in its latest genechips for expression arrays affymetrix makes only use of pm probes, and completely redesigned probe sequences. in the newest chips, the probes are selected from the whole transcript and not from its 3'-end as it used to be the case. the non-specific binding is assumed to be common for all probes, and is assessed with a set of anti-genomic probes. such novelties in the design call for a new critical evaluation of preprocessing methods, which is the aim of this paper.

when comparing several samples, algorithms need to take discrepancies between arrays into account, such as a slight difference in the amount of hybridized material . the study of probe intensities thus traditionally implies a normalization step and/or the design of an appropriate statistical model. from a statistical point of view, several probes targeting the same transcript would ideally be jointly analyzed, using a multifactorial procedure - like the anova- <dig> procedure - to be able to compare the expression of a transcript between two conditions , and several samples . however, the probe-specific signal are not identically distributed, so that the iid requirement of anova- <dig> procedures is not met. discrepancies between pm probes targeting the same sequence have been reported by several authors. depending on probe-specific sequences, several processes have been reported to explain the important biases observed in pm signals  <cit> . first, thanks to a more refined knowledge about transcript sequences and their locations in the genome, many probeset definition have been redefined and many probes have been redesigned in the successive generations of arrays. to correctly analyse old-generation arrays, several authors used alternative chip definition files and probe annotation tables  <cit> . other sources of outlying effects have been reported by several authors. for instance, probes targeting distinct transcripts were found to be systematically correlated accross a large number of experiments, and fail to correlate with respect to the rest of the probes designed to target the same transcript   <cit> . cross-hybridization effects may occur, as probe sequence may complement parts of the sequence from other transcripts. listing all the factors that leads to outlying probe signals is not the purpose of this paper, but those examples illustrates the complexity of the models needed to analyse the data appropriately. most preprocessing methods adress this issue by summarizing the probe-level signal into a unique probeset-level score, and this step is performed by excluding outliers or giving them a smaller weight as compared to other probes   <cit> .

the aim of this paper is to provide a general test of performance of some preprocessing methods for genechips, focusing in particular on affyilm, an algorithm recently made available as a bioconductor package and developed by us. this algorithm is based on physical modelling of the hybridization process and uses a generalized langmuir isotherm  <cit>  to estimate the concentration of transcripts from the raw data, using thermodynamics principles. the inputs are hybridization free energies obtained from experimental values which measure the affinity for each probe to bind to the complementary transcript. several papers in the past decade discussed the physical modeling of the hybridization process in genechips  <cit> . affyilm is fully based on underlying thermodynamics of hybridization and the basic principles were discussed in previous publications . in this test of performance we considered old- and new-generation  chips and compared affyilm using several popular summarization methods , with other preprocessing methods   <cit> .

RESULTS
preprocessing microarray data is commonly performed on a four-step basis: background correction, pm/mm correction, normalization and summarization. several algorithms have been reported to treat each of those steps, and this field of research has evolved in a combinatorial way, to define the best strategy  <cit> . to improve the understanding of the results described in this article, we have compared the performances with regards to mas  <dig>  and plier , rma and gcrma, dchip and farms  <cit> . those softwares have been the most widely used over ten years, and were studied in several performances studies  <cit> .

our aim is to provide a preprocessing algorithm based on physical chemistry. we used the extended langmuir model, which is discussed in ref.  <cit> , to compute the physical concentration of the targets associated to each of the probes in the chip. assuming that the differences between arrays are due mainly to the variable amount of sample which is hybridized, we performed a global multiplicative rescaling of the estimated concentrations, so that the pairwise comparison of concentrations is characterized by a slope equal to one between arrays.

the estimation of non specific binding implies platform-generation-specific features. the use of the langmuir isotherm to estimate concentrations is presented here, first ignoring this background-correction step, so that interpretation of the results does not depend on a difference between algorithms used with regard to the specificities related to each generation of array. as a consequence, the variability of probe-specific concentrations may be somewhat over-estimated . for this reason, the individual analysis reported here has been performed using both the student t-test and variants of this test designed to stabilize the variance, at the probe-set level, using shrunken estimates of variability   <cit> .

correlation of differential expression analysis
to test the performance of affyilm, we selected the affymetrix tissue mixture study   <cit> . this study involves two different genechips: the old hg-u <dig> plus  <dig> and the new  hugene  <dig>  st array. table  <dig> summarizes the design of the tissue mixture study: heart and brain samples were mixed in various ratios. such a strategy allows to perform two types of comparisons:  within-platform comparisons quantifies the robustness of the methods against biologival noise and  between-platform comparisons quantifies the correlations between hg-u133plus <dig> and hugene  <dig>  st arrays. to quantify the performances of the differential expression analysis depending on the preprocessing strategy, we computed the correlation coefficient of pearson, kendall and spearman on the log <dig> value of the p-values resulting from the differential expression tests that are compared. all three correlation coefficients provided similar results. in general, the pearson correlation coefficient spanned the widest range of values, best highlighting the differences between the methods, and was therefore used in this paper.

each line refers to a mixture of brain and heart samples. for each mixture, the contribution of each sample  is given in the second and third columns. the mixture of equal amounts of brain and heart samples was conducted  <dig> times, leading to mixes  <dig> a,b and c. each mixture was then hybridized on  <dig> hg-u133plus <dig> arrays and  <dig> hugene  <dig>  st arrays.

differential expression analysis was performed between samples reported in table  <dig>  using the pure brain and heart samples as a reference . the correlation analysis between mixtures and reference samples quantifies the decrease in performance due to an increase in biological noise. highest correlation coefficients highlight the robustness of the algorithms against biological noise.

the results of the analysis are reported in tables  <dig>   <dig>   <dig>   <dig>   <dig> and  <dig>  tables  <dig> and  <dig> report the combination of affyilm with several summarization methods on old hg-u133plus <dig> and new hugene  <dig>  st arrays, respectively. for each combination, three differential expression analysis methods were used . more details can be found in methods.

we analyzed the hg-u133plus <dig> tissue mixture study  for differential expression, using student t-test, regularized t-test, and window t-test. summarization tests were performed on probe concentrations computed with affyilm. comparison between heart  and brain  is assumed to provide the reference list of p-values. for each combination of summarization/analysis steps , pearson's correlation coefficient has been computed on log <dig> between the reference analysis and several comparisons of mixtures . underlined characters highlight the top  <dig> correlation coefficients for each column. raw/scaled labels respectively refers to summarization tests performed with/without a scaling step between arrays.

we analyzed the hugene  <dig>  st tissue mixture study  for differential expression, using student t-test, regularized t-test, and window t-test. summarization tests were performed on probe concentrations computed with affyilm. comparison between heart  and brain  is assumed to provide the reference list of p-values. for each combination of summarization/analysis steps , pearson's correlation coefficient has been computed on log <dig> between the reference analysis and several comparisons of mixtures . underlined characters highlights the top  <dig> correlation coefficients for each column. raw/scaled labels respectively refers to summarization tests performed with/without a scaling step between arrays.

we compared the results of the differential expression analysis of the tissue mixture study between hg-u133plus <dig> and hugene  <dig>  st arrays, using student t-test, regularized t-test and window t-test. preprocessing was performed with affyilm. for each combination of summarization/analysis steps , and each comparison of mixtures , pearson's correlation coefficient has been computed on log <dig> between both types of arrays. underlined characters highlight the top  <dig> correlation coefficients for each column. the best match table provided by affymetrix has been used to map probesets between the two platforms. raw/scaled labels respectively refers to summarization tests performed with/without a scaling step between arrays.

we analyzed the hg-u133plus <dig> tissue mixture study  for differential expression, using student t-test, regularized t-test, and window t-test. several previously published preprocessing methods were compared. comparison between heart  and brain  is assumed to provide the reference list of p-values. for each combination of preprocessing/analysis steps , pearson's correlation coefficient has been computed on log <dig> between the reference analysis and several comparisons of mixtures . underlined characters highlight the top  <dig> correlation coefficients for each column. raw/norm labels refer to raw and normalized data, pm stands for pm-only and bg refers to background correction .

we analyzed the hugene  <dig>  st tissue mixture study  for differential expression, using student t-test, regularized t-test, and window t-test. several previously published preprocessing methods were tested. comparison between heart  and brain  is assumed to provide the reference list of p-values. for each combination of preprocessing/analysis steps , pearson's correlation coefficient has been computed on log <dig> between the reference analysis and several comparisons of mixtures . underlined characters highlights the top  <dig> correlation coefficients for each column. raw/norm labels refer to raw and normalized data, pm stands for pm-only methods.

we compared the results of the differential expression analysis of the tissue mixture study between hg-u133plus <dig> and hugene  <dig>  st arrays, using student t-test, regularized t-test and window t-test. preprocessing was performed with several popular methods. for each combination of preprocessing/analysis steps , and each comparison of mixtures , pearson's correlation coefficient has been computed on log <dig> between both types of arrays. underlined characters highlight the top  <dig> correlation coefficients for each column. the best match table provided by affymetrix has been used to map probesets between the two platforms. raw/norm labels refer to raw and normalized data, pm stands for pm-only methods.

the first three columns illustrate the correlations obtained when biological noise is added in equal amount in both samples. the following four columns illustrate the correlations computed when the analysis is performed between one sample  and the mixtures with 75% and 25% of each sample, respectively. the last six columns refer to the correlations measured on the comparisons between one sample , and  <dig> mixtures with 50% of each sample. the analysis shows that, whatever the differential expression analysis strategy, the best performances are obtained when the probe-level data is summarized using the medianpolish algorithm, followed by the 1-step tukey-biweight algorithm. in addition, whatever the summarization method, the best results are obtained when the data is analyzed with variance-stabilizing methods , as compared to the classic student t-test. as expected, the correlation decreases with increasing amounts of biological noise . affyilm concentrations analyzed with or without the scaling step leads to similar results, and the observed correlation is higher using scaled data for some comparisons, lower for the others. the same conclusions can be formulated for both generation of arrays, as shown by comparing table  <dig> and table  <dig>  the two types of arrays lead to similar performance results.

using table  <dig> to assess the performances of the individual methods leads to the same conclusions as from tables  <dig> and 3: best results are obtained when affyilm is used in combination with the medianpolish summarization.

tables  <dig>   <dig> and  <dig> report the correlations computed when the analysis is performed with current preprocessing methods, using the same  <dig> differential expression analysis methods. the highest correlations are observed when data is preprocessed using either rma or gcrma, both making use of the medianpolish summarization. the two methods provided by affymetrix leads to lower correlations , and plier seems more appropriate than mas  <dig> on the most recent array type . mas  <dig> leads to better results on hg-u133plus <dig>  only when the mismatch probes are ignored . taken together, all those correlations tests suggest that the best methods are rma, gcrma and affyilm, whatever the array type.

as expected, a decrease in correlation is observed for increasing amounts of biological noise. however, the comparisons between mixes and brain/heart samples reveals an unexpected behavior: 50/ <dig> mixes  leads to higher correlation values when compared with brain sample  than the correlation values obtained by comparison with heart sample . one explanation for this effect could be that the 50/ <dig> mixes are enriched in heart sample, thus the difference between the mixes and heart samples  may be lower than expected, and higher when compared to brain samples . this effect can also be observed with 75% - 25% mixes  when compared to brain and heart samples . as a consequence, we suspect that either the concentration of heart samples was under-estimated, or the concentration of brain samples was over-estimated, prior to the design of the mixes. alternatively, this effect could be due to a difference in the quality of heart and brain samples, with a higher level of biological noise in the brain sample than in the heart sample .

in the correlation study reported here, we tested affyilm in combination with the summarization steps used by other methods, to provide a fair comparison. the medianpolish summarization is associated to the best correlation coefficients, whichever preprocessing strategy is used. giorgi et al. recently reported that the medianpolish procedure induce inter-array correlation, and introduced trma, where the use of rows and columns is inverted with regards to the medianpolish used in rma and gcrma . this study also showed that the magnitude of the artifact associated with the medianpolish increases when the number of replicates is small, and is affected by an odd or even number of replicates  <cit> . in addition, in rma and gcrma, the medianpolish is performed on log-values . we extended our correlation studies on differential expression results to compare the performances of the medianpolish and the transposed medianpolish, in combination with affyilm, and applied these procedures to the concentrations and to the log of the concentrations. the results of the analysis are supplied in additional files  <dig>   <dig> and  <dig> . the transposed medianpolish and the medianpolish perform similarly, in agreement with giorgi's statement that the reported artifact should not affect differential expression analysis. our study also show that the medianpolish leads to higher correlation values when performed on log-values, in agreement with the model used by rma and gcrma.

performance evaluation on latin-square data
correlation results on the differential expression analysis are not sufficient to discriminate those three methods. to best characterize the performance of the differential expression tests, we used the well-known latin-square hgu- <dig> spike-in dataset, which offers the opportunity to compare the most significant probesets with the precise knowledge of the true list of spiked rna's. each pairwise differential expression analysis has been performed, leading to  <dig> distinct comparisons   <cit> . the results from the  <dig> pairwise comparisons have been merged in a single list of p-values, and compared to the associated list of spiked genes to compute the sensitivity ) and false discovery rate ), depicted in figure  <dig> using alternative roc curves for each tested preprocessing and differential analysis methods. those graphs are equivalent to precison/recall curves and compares the ability of the methods to find the truth with the price to pay for it, quantified by the proportion of errors in the top list, for increasing sizes of top-lists. the alternative roc curves  can be used to best discriminate methods and can be interpreted similarly to traditional roc curves ), using the same y axis, where the best performing methods are closer to the upper left corner of the graph .

as demonstrated in several papers, variants of the student t-test designed to stabilize the variance estimates outperforms the classic student t-test, whichever preprocessing strategy is used  <cit> . the best performing individual analysis reported in our study is conducted with the window t-test. comparing mas <dig>  rma, gcrma, plier and affyilm reveals that the best performances for the window t-test and regularized t-test are obtained with rma, affyilm and gcrma, as shown in figure  <dig>  most of the spiked probesets are detected with less than 5%-10% of error in the top list with the window t-test or the reguralized t-test, and the remaining probesets are progressively detected. no method is able to detect all spiked rna's. using rma, affyilm and gcrma in combination with the window t-test leads to a detection of more than 80% of the spiked genes with less than 5% of error in the top list. in conjunction with the window t-test, rma and affyilm display a better top list than gcrma, as the beginning of the curves is closer to the y-axis. in the second part of those curves, the progressive detection of the remaining genes can be tracked by the error associated with the detection of 90% of the spiked genes: the corresponding fdr is close to 20%, 30% and 90% respectively for rma, affyilm and gcrma. using the classic student t-test, the performances of affyilm decreases and are lower than gcrma, but still remains higher than plier and mas  <dig> .

the affycomp assessment of preprocessing methods allow to compare the performances of preprocessing methods by monitoring several descriptive statistics. although affyilm misses an appropriate background correction algorithm, we submitted affyilm to the affycomp iii assessment. the results of the assessment will serve as a basis for the evaluation of affyilm future developments. the aim of this paper was to assess the performances of affyilm with regards to differential expression. however, we provide the reports of affycomp using affyilm in the additional files  <dig> and  <dig>  respectively for the latin squares hg-u95a and hg-u <dig>  additional files  <dig> and  <dig> summarize the affycomp iii scores of affyilm and selected methods. the scores obtained reveal that methods can be splitted in two categories, and best methods are rma, gcrma, farms and affyilm, in accordance with our performance evaluation.

CONCLUSIONS
the aim of this paper was to perform a thorough performance analysis of affyilm, a bioconductor package designed to preprocess affymetrix genechip expression data. this model relies on the thermodynamics of hybridization and avoids complex statistical transformation as normalization steps used by other methods. to avoid biases due to the variability of the amount of hybridized material, the concentrations are scaled with an array-specific factor . to avoid biases due to the need for platform-specific background estimation algorithms, the background correction step has been ignored in our study. the study reported here adresses two main goals: evaluating the performances of affyilm with respect to differential expression analysis, and selecting the best summarizing strategy to avoid outliers-associated bias.

our correlation study on mixtures between two biological tissue samples first highlights that the medianpolish summarization leads to the best results in conjunction with the extended langmuir isotherm, followed by 1-step tukey-biweight algorithm and mbei, as seen from the data shown in tables  <dig>   <dig> and  <dig>  the comparison with other methods reveals that the correlations observed in our study are similar to the best performing methods. the performances are similar for hg-u <dig> plus  <dig> and the recent hugene  <dig>  st array type. the performance evaluation has been completed by an analysis of the hg-u <dig> latin square experiment, allowing to compare the most significant genes with the true knowlegde of spiked rnas. the package affyilm used in combination with variants of the student t-test that stabilizes the variance, provides a better top-list than gcrma, and is close to rma for this dataset. the three best methods relies on the medianpolish summarization, highlighting the importance of the summarization step. using the traditional t-test, performances of affyilm are lower, in agreement with our expectations, due to the absence of a background-correction step.

according to the statistical tests performed in this paper the accuracy of affyilm is similar to the best performing preprocessing algorithms . the advantages of affyilm is that it is entirely based on physical principles and does not make use of excessive parameters fitting. it runs equally well on a single experiment and it does not make use of heavy normalization, apart from global rescaling of the concentration levels. in addition, it provides to each measured expression level an error estimate  <cit> , which is useful to discriminate between the robust determined expression levels, from those with high error rates. the experience with other type of arrays  <cit>  suggests that the performance of affyilm could be further increased with a better parametrization of the hybridization free energies, which are used by affyilm to compute the concentrations from the langmuir isotherm. so far the free energy values used are taken from sugimoto et al. data  <cit> , obtained from experiments of hybridization between rna and dna strands in solution.

in the future, our efforts will be shared on two objectives. first, we will try to further improve the strategy by including a background-correction step. in our current implementation of affyilm, this step is not performed, causing a variable over-estimation of the concentration. second, we will try to simplify the analysis by testing an appropriate weighted multivariate analysis strategy from probe concentrations, instead of summarizing it. transcript concentrations are estimated from each probe, to get rid of a dependance between the intensity and the sequence-specific hybridization free energies. as estimated target concentrations are analysed in place of probe intensities, all probes targetting specificaly the same transcript should thus provide the same information and share the same biological variability. multivariate analysis procedures are typically used to analyse such data. this strategy should be more powerful, as a multivariate analysis uses more values in the test than an univariate analysis of summarized values. this strategy was previously used by barrera et al. on intensity values and proved to be efficient  <cit> . however, the univariate analysis reported here on summarized values shows that affyilm performs best in combination with the medianpolish, which highlights the impact of outlying probes during the summarization step. outlying probes reveal the presence of unexpected behavior . to avoid biases during multivariate analysis in the presence of outliers, we will focus on the definition of appropriate weighting factors for each probe.

