BACKGROUND
networks of interacting biomolecules are at the heart of the regulation of cellular processes, and stochasticity plays important roles in many networks, including those responsible for gene regulation, protein synthesis, and signal transduction  <cit> . the stochasticity originates intrinsically from the small copy numbers of the molecular species in a cell, which frequently occur when molecular concentrations are in the range of  <dig>  μm to 1nm   <cit> . for example, the regulation of transcriptions depends on the binding of often a few proteins to a promoter site; the synthesis of protein peptides on ribosome involves a small copy number of molecules; and patterns of cell differentiation depend on initial small copy number events. in these biological processes, fluctuations due to the stochastic behavior intrinsic in low copy number events play important roles.

the importance of stochasticity in cellular functions is well recognized. studies of network models show that stochasticity is important for magnifying signal, sharpening discrimination, and inducing multistability  <cit> . understanding the stochastic nature and its consequences for cellular processes involving molecular species of small copy numbers in a network is an important problem.

a fundamental framework for studying the full stochasticity is the chemical master equation  <cit> . under this framework, the combination of copy numbers of molecular species defines the microscopic state of the molecular interactions in the network. by treating microscopic states of reactants explicitly, linear and nonlinear reactions  can all be effectively modeled as transitions between microstates, with transition rates determined by the physical properties of the molecules and the cell environment. the probability distribution or potential landscape  <cit>  over these microstates and its time-evolving behavior provide a full description of the properties of a stochastic molecular network.

however, it is challenging to study a realistic system that involves a nontrivial number of species of small copy numbers. analytical solutions of the chemical master equation exist only for very simple cases, such as self-regulating genes  <cit> , and the toggle-switch network under certain restrictions  <cit> . instead of solving the master equation, a widely used method is to carry out monte carlo simulations using the gillespie algorithm  <cit> . this method generates samples from multiple runs of simulation, and statistics properties are calculated from the simulation trajectories, which provide characterizations of the network  <cit> . this approach has found wide applications, although it cannot guarantee a full account of stochasticity, as this method usually does not generate an exhaustive number of trajectories that cover all possible locations in the probability landscape. in addition, as monte carlo simulations follow high probability paths, it is especially challenging to sample adequately rare and critical events that may be important in determining cellular fate. it is also difficult to determine whether a simulation is extensive enough to obtain accurate statistics. the amount of computation necessary to obtain an accurate result may be too large to be completed in a reasonable amount of time, especially when the time scales of the various react ions involved are very different  <cit> . to address these issues, gillespie, petzold, and colleagues further developed numerical methods for speeding up the stochastic simulation  <cit> . munsky and khammash developed a method to approximate the solution of chemical master equation by projecting the whole state space of the system to a finite space  <cit> . samant and vlachos developed a multiscale monte carlo method for stiff systems where partial equilibrium occurs  <cit> . an alternative approach is to approximate the master equation using, for example, fokker-planck or langevin equations  <cit> . these are obtained by adding stochastic terms  to a deterministic equation  <cit> . salis and kaznessis improved the stochastic simulation method by partitioning the system into components with fast and slow reactions. the fast reactions are approximated by the langevin equations, and the slow reactions are analyzed by stochastic monte carlo simulations  <cit> .

a complete identification and characterization of the space of the microstates is a prerequisite for obtaining the full landscape probability distribution of a network. however, the state space of a network currently cannot be fully characterized in general. there is neither closed-form solution, nor computational algorithm describing the full state space. in this paper, we study the problem of enumerating the state space of a molecular network with small copy numbers of molecular species.

a naive method is to predefine the maximum copy number of the reactants, and bound the state space by the product of the maximum numbers. however, the size of state spaces estimated by this naive approach will be inflated to enormity. for example, if there are  <dig> species, and there is a total a maximum of  <dig> molecules in the whole system, this naive method does not take into consideration of the details of the network, and the state space will be estimated to be in the order of  <dig> =  <dig>  ×  <dig> states. this naive method is intrinsically inefficient: there may be many states which may never occur. for some states, no reactions may occur and therefore are not needed. for others, no reactions can lead to them under the specified initial condition. an alternative approach is carrying out simulation. one can simply follow explicitly simulated reaction events to whatever microstates of copy numbers the system reaches. however, this approach cannot guarantee that all reachable states will be explored, therefore cannot guarantee full characterization of rare events.

in this study, we develop an optimal algorithm that gives full description of the state space and the set of transitions. our method works for networks of small copy numbers under the condition that the net gain in newly synthesized molecules in the network does not exceed a predefined finite number. our algorithm is optimal in both memory requirement and in time complexity. all states reachable from a given initial condition will be accounted for by our method, and no irrelevant states will be included. all possible transitions will be recorded, and no infeasible transitions will be ever attempted. as a result, our algorithm can generate the full state-transition matrix under the framework of the chemical master equation. this matrix is compact without any redundant information. it is also of the minimal size. in addition, the computational time is optimal, up to a constant. we also describe how to obtain the mean landscape probability distribution over the enumerated state space of a network, which is the same as the landscape distribution of the steady state when it exists.

this paper is organized as follows. we first describe how our method can be applied to the simple examples of a self-regulating gene, a toggle-switch network, and the more complex example of the mapk network. this is followed by conclusion and discussion. we finally describe the technical details of the algorithm for enumerating the space of microstates, and introduce a simple method for computing the steady state landscape probability distribution.

RESULTS
molecular network models
we apply our algorithm to three network models: the self-regulating gene, the small toggle-switch network, and the mapk cascade network.

self-regulating gene
regulating the expression of even a single gene is a complex process. we study the network of an idealized self-regulating gene . as a basic unit in biological genetic networks, it consists of only one gene, and is the simplest molecular network. we follow the study of schultz et al and assume that the dominant form of regulation is the binding and unbinding of transcription factors to the operator site, which changes the rate of transcription initiation  <cit> . in this model, there are several stochastic processes: the synthesis and degradation of the protein transcription factor at the reaction rate constants of s <dig>  and d, respectively, and the binding and unbinding of the operator site of dna by the transcription factor at the reaction rate constants of b and u, respectively. these processes are illustrated in fig 1b. the binding state of the operator site is either "on/unbound" , or "off/bound" . the synthesis rate of transcription factor is either s <dig> or s <dig>  depending on the binding state of the operator site.

we first calculate the state spaces. we use the same initial condition of  <dig> copy of unbound gene,  <dig> copies of transcription factor and bound gene, and set the buffer size to allow different copy numbers of protein transcription factor to be synthesized. as there is only one copy of the gene in this model  <cit> , the size of the state space increases with the copy number of the protein transcription factor that can be synthesized. our results show that when the buffer capacity takes the value of  <dig>   <dig> , and  <dig> , the size of the state space is  <dig>   <dig> , and  <dig> , respectively. in this model, the size of the state space scales linearly with the copy number of the protein synthesized. in biological condition, the copy number of a transcription factor rarely exceeds  <dig> 

we then calculate the exact steady state probability distribution over the microstates of the self-regulating gene, namely, the exact steady state density function of different states of copy numbers of the transcription factor. in our calculation, the parameter values are chosen as u = d/ <dig> and b = d/ <dig>  in units of degradation rate d, following reference  <cit> . the steady state distributions p at different values of synthesis rates in on/unbound and off/bound states s <dig> and s <dig> are computed exactly and are shown in fig  <dig> for the case of buffer size of  <dig>  for illustration. here the marginal probability of having a specific number of free proteins in the system is plotted, regardless whether the gene is in off/bound or in on/unbound state. following reference  <cit> , we use three different network conditions:  = , , and  in units of degradation rate d, respectively. when the on/unbound state synthesis rate s <dig> is greater, the network is self-repressing. when the off/bound synthesis rate s <dig> is greater, the network is self-activating.

our results and the results of schultz et al obtained from multiple runs of gillespie simulations are identical  <cit> . as pointed out in  <cit> , the self-repressing and the self-activating genes can have overall similar distributions. this can be explained by the fact that the combined synthesis rate of the protein s <dig> + s <dig> =  <dig> is the same in both cases . closer examination shows that in the case of the self-repressing gene network , the first peak of probability at smaller copy number of the free protein is lower, and the second peak at higher copy number is larger when compared to the distribution of the self-activating gene . that is, the self-repressing network has a higher probability in producing more free proteins than the self-activating network. this can be explained by the difference between the protein-dna binding rate b and unbinding rate u. in this model network, unbinding rate u = d/ <dig> is  <dig> times greater than the binding rate b = d/ <dig>  as a result, this gene is more likely to stay in the unbound state. since the self-repressing network has a higher synthesis rate in unbound state , it will produce more free proteins. this results in an overall slightly higher probability for larger number of free proteins for self-repressing network. this small difference in probability distribution is also observed in  <cit> . as pointed out previously in  <cit> , when both synthesis rates are equal , the binding state transition do not change the synthesis/degradation process, and the network is a simple birth/death process, with a gaussian probability distribution for protein number centered at s <dig> = s <dig> .

toggle switch
a toggle switch is a small network consisting of two genes, a and b. the protein product of each represses the other gene. toggle switch is the smallest genetic network that can present bistability. the insightful study of schultz et al provided detailed analysis of the stochastic behavior of this model network  <cit> . to facilitate direct comparison, we adopt the same toggle-switch model developed by these authors . the molecular species and the network topology are shown in fig 3a. there are a number of stochastic processes: the synthesis and degradation of proteins a and b, with reaction constants denoted as s and d, respectively; the binding and unbinding of the operator site of one gene by the protein products of the other gene at rate b and u, respectively . the binding states of the two operator sites are "on-on/unbound-unbound" , "on-off/unbound-bound" , "off-on/bound-unbound" , and "off-off/bound-bound" . the synthesis rates of both proteins a and b depend on the binding state of the operator sites. the toggle switch model used in this study and all possible chemical reactions in the model are extracted directly from the master equations in  <cit> . in this model, no dimerizations are explicitly modeled, and the model assumes that binding of two proteins to the operator site simultaneously. this is a valid approximation when the dimerization reaction is fast compared to all other reactions  <cit> . even for this simple network, except for the special cases when "fast transition" between on- and off- operator states and "small noise" of high molecular concentration conditions are assumed, no exact solutions are known  <cit> .

we first calculate the state spaces under the initial condition of  <dig> copy of unbound gene a,  <dig> copy of unbound gene b,  <dig> copies of bound gene a and bound gene b, and  <dig> copies of their protein products. we set the buffer size to different copies of total protein a and protein b combined that can be synthesized. when the buffer capacity is  <dig>  the size of the state space is  <dig>  at buffer capacity of  <dig>   <dig>  and  <dig> copies of proteins, the size increases to  <dig> ,  <dig> , and  <dig> , <dig>  respectively.

we then calculate the exact steady state landscape probability of the toggle-switch network, namely, the exact steady state density function of different microstates of copy numbers of products of gene a and gene b. the steady state distributions p are shown in fig  <dig> for the case of buffer size of  <dig>  in our calculation, the parameter values are chosen as s = 100d, u = d/ <dig>  and b = d/ <dig>   <dig>  in units of degradation rate d. these are the same as those used in reference  <cit> .

it is clear that a toggle switch has four different states, corresponding to the "on/on", "on/off", "off/on" and "off/off" states. at the chosen parameter condition, the toggle/switch exhibits clear bi-stability, namely, it has high probabilities for the "on/off" and "off/on" states, but has a low probability for the "on/on" state. the "off/off" state is severely suppressed. our results are identical with the results of schultz et al obtained from multiple runs of gillespie simulations  <cit> .

mapk network
mapk cascade network plays important role in signal transduction. here our purpose is to explore how to apply our algorithm to more realistic network model. our goal in this paper is not to study the the stochastic nature and the dynamic behavior of mapk network.

the mapk cascade network  is taken from the biomodels database at ebi  <cit> . the molecular species and reactions are extracted from the sbml  model file. this network contains  <dig> molecular species with  <dig> reactions  <cit> . as there is no synthesis reaction, this particular network model is a closed system. abbreviations used in this model are listed in table  <dig>  fig  <dig> shows the topology of the model. all  <dig> molecular species are labeled with numbers from  <dig> to  <dig>  among them, mek  and mkp <dig>  are the key enzymes catalyzing all phosphorylation and dephosphorylation reactions in this network. the rest of the molecular species are substrates, intermediates, and products of mek and mkp <dig> induced reactions. most of the reactions in this model  are second-order.

simple initial conditions
we generate the state spaces of the mapk network for different initial conditions and record their sizes. we first increase the copy number for one species from  <dig> to  <dig>  and record the size of resulting state space, while keeping the copy numbers of all other species to  <dig>  we repeat this process for each of the  <dig> molecular species in turn. altogether, we have  <dig> ×  <dig> =  <dig> data points of sizes of the state space .

it is clear that different molecular species in this model affect the size of the state space differently. increasing the copy number of m-mek-y, m-mek-t, and mpp-mkp <dig> molecules  lead to large state spaces , while the initial conditions of  <dig> copies of any other species result in modest state spaces. for example, species  <dig>   <dig>   <dig> and  <dig> when given  <dig> copies have a state-space size of  <dig>  for species 1– <dig> , no reactions can occur at these initial conditions, and the state space contains only the the initial state.

the state space for each of the  <dig> initial conditions can be computed within one minute. we further found that when any of s <dig>  s <dig>  or s <dig> has an initial copy of  <dig> and all others  <dig> copies, the state spaces increases to  <dig> , <dig>  and the computing time also increase, although all can be computed within  <dig> minutes on a linux workstation.

biological initial conditions
we further calculate sizes of the state spaces with several biologically plausible initial conditions, in which species m, mek and mkp <dig> are all given an equal number of i copies, while all the other species start with zero copies. we increase i from  <dig> to  <dig>  these initial conditions correspond to a total number ranging from  <dig> ×  <dig> =  <dig> copies to  <dig> ×  <dig> =  <dig> copies of molecules of three species in the network. the size of the state space increases with the copy numbers. when there are  <dig> copy of m, mek, and mkp <dig> each, the size of the state space is  <dig>  for  <dig>   <dig>  and  <dig> copies of m, mek, and mkp <dig> each, the size increases to  <dig> ,  <dig> , <dig>  and  <dig> , <dig>  respectively. the computation of the state space at i =  <dig> and i =  <dig> requires  <dig> seconds and  <dig> seconds of cpu time on a linux desktop machine, respectively.

steady state distribution
we compute the steady state probability distributions of the microstates of the mapk network at the initial condition of  <dig> copies each of m, mek and mkp <dig>  that is, we obtain the exact steady state density function of different microstates of all possible  <dig> , <dig> combinations of different copy numbers of the  <dig> molecular species in the mapk network. the computation is efficient. at this initial condition, the dimension of the markovian transition matrix m is  <dig>   <dig>   <dig> ×  <dig>   <dig>   <dig>  with  <dig>   <dig>   <dig> number of non-zero elements. it takes  <dig>  seconds  of cpu time to compute the steady state probability distribution on a linux workstation.

as it is impossible to directly visualize the landscape density distribution in a 16-dimensional space, for ease of visualization, we plot the marginal distribution of different combinations of copy numbers of extracellular signal-regulated kinase  in unphosphorylated state, in single phosphorylated state, and in dual phosphorylated state. specifically, we plot the marginal probabilities of different copy numbers of unphosphorylated erk , and erk with either y or t site phosphorylated , after integrating different copy numbers of all other  <dig> molecular species in fig 7a. we plot the marginal distribution of different copy numbers of unphosphorylated erk , and erk with both y or t site phosphorylated  fig 7b. we plot the marginal distribution of different copy numbers of uni-phosphorylated erk with either y or t site phosphorylated , and erk with both y or t site phosphorylated  in fig 7c. at this parameter condition, the steady state distribution has a single peak centered around two copies of unphosphorylated erk , two copies of uni-phosphorylated erk , and zero copy of dual phosphorylated erk .

CONCLUSIONS
stochasticity plays important roles in molecular networks for processes involving small copy numbers of molecules. models of molecular networks based on macroscopic reaction rates and coupled ordinary differential equations are not applicable in these cases, as they can only model high concentrations of interacting molecules with negligible fluctuations.

the stochastic nature of molecular interactions at low copy numbers can be fully characterized if the time-varying landscape probability distribution on all of the microstates of a molecular network can be computed. this is a difficult task, as the state space of the combination of the copy numbers of molecular species needs to be explicitly enumerated, the probability distribution over these microstates and changes of this distribution across many decades of time scale need to be fully computed.

in this study, we have developed an algorithm to enumerate the state space of a molecular network of small copy numbers with a buffer containing a finite number of molecules that can be synthesized. it can also be used to find all possible transitions between states, and to compute the transition rates between these states. we also demonstrate how to obtain the steady state probability distribution based on the enumerated states when it exists.

our example of the toggle-switch network shows that this method can be used to study the rise of important network properties such as bistability. the enumeration of the full state space of the mapk cascade network at various initial conditions demonstrate that our method can be used to study a realistic network of nontrivial size, which is more complicated than the simple networks that are often studied for full stochasticity. although naively the state space at the initial condition of each of  <dig> copies of unphosphorylated, uniphosphorylated, and biphosphorylated erk kinase might be as high as  <dig> =  <dig>  ×  <dig>  a truly astronomical size, our method showed that the relevant space is only about  <dig>  ×  <dig>  which is amenable for computation using a desktop computer.

our method is applicable to study various carefully constructed model network systems. it complements the monte carlo simulation method, as it can be used to characterize the full probability landscape of networks with enumerable state space. for example, it will allow the calculation of the probabilities of the occurrence of rare and critical events. for theoretical studies, one can predefine a fixed number of net molecules that can be synthesized, and investigate the nature of the landscape probability distribution. this is similar to the studies of semi-grand canonical ensemble in statistical physics  <cit> . exact characterization of probability landscape is useful, as most network studies are based on stochastic simulation, and relative little is known at the level of the full stochastic landscape probability distribution, even for simple toy systems. for example, analytical solutions to the simple toggle switch model is known only when the model parameters follows the restrictions of small noise and fast transition  <cit> . we believe our method can be used to study well designed model systems beyond self-regulating genes and simple toggle switches, and the exact results obtained will be helpful for understanding the basic properties and design principles governing stochastic networks. a useful analogy to illustrate the utility of such model studies can be found in the field of protein folding, where a large number of studies using simple short chain hp lattice models revealed remarkable insights about how complex proteins fold  <cit> .

our method can also be applied to more realistic biological networks, such as the mapk network model, which is a closed system according to the annotated biomodels database  <cit> . such closed systems could arise when one focus on a submodule of a larger network. for the majority of realistic networks which are open systems, an important determining factor of the applicability of our method is the limit of the capacity of a buffer, which has to be greater than the maximum copy number of the net gain in protein molecules that can be synthesized. in a cell, this maximum number is determined by the life time of the cell, and the net synthesis rate of protein molecules. the latter depends on both protein synthesis and degradation rates. a simple approach is to estimate the net number of protein molecules that can be synthesized during the life time of a cell. for example, the lifespan of an e. coli cell is about  <dig> minutes  <cit> . estimation based on the rate limiting processes of transcription initialization and elongation indicate that the protein synthesis rate ranges from  <dig> /s   <cit>  to  <dig> /s for the cro protein  <cit>  in the lambda phage system. their degradation rates are about  <dig> /s and  <dig> /s, respectively  <cit> . this suggests that a useful bound of the copy number of newly synthesized molecules for studying the lambda switch network system could be in the order of 150– <dig> copies under reasonable initial conditions. naturally, the exact number will depend on the details of the chosen network model and the parameter values. for example, models of cells under stress with retarded synthetic rates may require a relatively small buffer capacity.

in this study, we have described a method to compute the steady state landscape probability distribution. steady state distribution is of general interests when it exists, as has been shown in previous studies  <cit> . for realistic network, another approach is to compute the time-dependent dynamic change of landscape probability distribution, using techniques such as those used in  <cit> . we will describe this approach in more details in future studies.

as the number of molecular species and their copy numbers increase, the state space will eventually become prohibitively large for explicit computation even with an optimal algorithm. in these cases, our method can be used to select important states and to control error bounds at a specific tolerance for developing approximation methods, an approach well demonstrated in  <cit> .

