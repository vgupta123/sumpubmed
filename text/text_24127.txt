BACKGROUND
it has long been recognized that protein-coding sequences show nonrandom, organism-specific patterns of codon usage  <cit> . codon usage bias is most pronounced in highly expressed genes  <cit> , where codon preferences are associated with the trna abundance within the cytoplasm  <cit> . measurement of codon selection is of interest because the extent to which different genes use the preferred codons is predictive of their expression levels and rates of evolutionary change  <cit> , and thus their relative importance  to the organism. comparative studies of codon selection have provided insight into the population structure and lifestyle of organisms  <cit> . numerous statistics have been devised to measure variation in codon selection among open reading frames  within a genome, yet none fully account for the evolutionary dynamics that shape codon usage bias, including compositional differences among genes and genomes. the simplest metrics evaluate how much codon usage frequencies of a gene deviate from expected frequencies. these methods, such as the effective numbers of codons  and the enc'  <cit> , incorporate no information about the fitness differences among synonymous codons. this limitation has been addressed by karlin and mrazek  <cit>  and supek and vlahovicek  <cit> , whose algorithms simultaneously compare each gene's codon usage both to genome-wide codon frequencies  and to codon frequencies in a defined set of genes believed to experience strong codon selection. however, this design has been criticized for failing to assign the most extreme values to the genes with the most extreme biases in terms of preferred or non-preferred codons  <cit> . this artifact results from the maximum possible value being assigned to genes with codon composition identical to pre-selected set of "optimized" genes, even though other genes may show more extreme enrichment of the optimal codons.

this irregularity is absent from statistics that are proportional to the frequency at which preferred codons occur within an orf. at their simplest, these statistics summarize the optimal codon frequency for each amino acid  while more complicated methods construct a scoring table for all codons, quantifying the relative importance of non-optimal codons and weighting the statistic so that it is influenced more by those amino acids for which the synonymous codons have a greater perceived fitness difference . one method for normalizing across amino acids is to compare the score of the observed codons against the maximum possible score for an orf with the same amino acid composition , producing a uniform maximum score for all orfs regardless of amino acid composition. however, this does not account for the fact that the probability of observing the optimal codon will vary according to amino acid composition, and the values assigned to non-optimal codons can vary greatly among amino acids  <cit> . despite the power of these methods for detecting codon selection, none of them quantify the stochastic variation that is expected to arise from mutation-selection balance, which is the primary explanation for the occurrence of non-optimal codons  <cit> . the selection-mutation-drift theory of synonymous codon usage describes an equilibrium condition where preferred and non-preferred codons occur in proportions determined by mutational biases, selection, and effective population size. recent studies have calculated the parameters of this model explicitly  <cit> , but only include codons for two-fold degenerate amino acids, limiting the information available to make inferences about individual genes. to date, no analytical method accounts for the variation in the codon usage statistic that arises from the stochastic nature of the selection-mutation-drift model.

here, we expand upon the scoring-table class of methods by introducing a new statistic that incorporates a table of expected codon frequencies, which amounts to a null hypothesis for codon usage. we present a stochastic model of codon usage, thereby allowing orfs to be evaluated in terms of their deviation from an expected codon composition. this not only allows us to measure the impact of selection against the background of genome-wide biases, but to normalize the values assigned to non-preferred codons of different amino acids so that amino acid composition does not affect the score under the null model. we also examine different algorithms for systematically assessing codon frequencies - either in the presence or absence of selection - using only the genome sequence of the organism being examined. by deriving the expected distributions of the statistic under a null hypothesis about codon frequencies, our statistical framework provides a means to compare the strength of codon selection within and between genomes.

RESULTS
below, we describe a statistic for summarizing the codon usage of an orf. the raw statistic is the sum of values assigned to each of the codons in the sequence and may be normalized according to its expected distribution. normalized scores for individual genes can be combined to summarize the magnitude of codon selection operating on the entire genome. we compare our measure to previously described codon usage statistics, both conceptually and empirically.

relative adaptiveness of synonymous codons
to quantify enrichment of a codon among genes experiencing codon selection, we define a score  for each codon cdn as,   

where cdnij is the jth codon of the ith amino acid and f is the expected frequency of that codon among its synonyms in genes that have  or have not  been optimized by codon selection. use of the logarithm enables us to express the codon optimization of a gene or set of genes as the sum of the individual scores of the codons comprising the gene, generating the summed codon bias . to facilitate examination of the stochastic properties of the scb, it is calculated as the sum of the composite scores for each amino acid , which are determined from the scores of their constituent codons as,      

where cij is the count of that codon within the gene being analyzed and ni is the number of synonyms for its encoded residue. merkl proposed a similar statistic, the gcb  arguing that this form of statistic is optimal for distinguishing between two populations <cit> . here, we use the sum because it has convenient properties in a stochastic model, described below, which we will use to normalize this continuous statistic. notably, the scb expresses codon usage bias as a function of the difference  between unselected  and selected  codon frequencies, rather than as a distance from them, thus avoiding shortcomings of other metrics  <cit> .

the scb is related to other scoring-table statistics by different normalization routines. merkl's gcb  <cit>  is the length-normalized form of the scb. the logarithm of the cai  <cit>  can be derived from the scb by calculating δij with a non-optimized table  showing no bias among synonymous codons, then calculating the difference between scb and the maximum possible value given its amino acid composition, and finally dividing by the number of codons in the orf, ignoring methionine and tryptophan.

crucially, scoring tables created from δij reveal which codons increase in frequency among the most optimized proteins, and to what degree. this is different from the relative synonymous codon usage values that are used to calculate the cai  <cit> , which reflect simply the abundance of codons in optimized genes without reference to their abundance in non-optimized genes. codons with greatest abundance in optimized genes may not have experienced the strongest selection for enrichment and, in the worst cases, may actually be disfavored. this adjustment to the estimate of codon adaptiveness should have the greatest effect in genomes where nucleotide composition shows the greatest deviation from equal usage.

to examine the effect of this difference between scb and cai, we evaluated multiple genomes by constructing fo from the synonymous codon frequencies of a set of  <dig> protein-coding genes whose products comprise the ribosome and other parts of the translation apparatus  <cit>   and constructing fn from all orfs in the genome. accounting for the biases in fn creates substantial changes in δ relative to the values obtained otherwise , even changing estimates of which codon is most preferred. in pseudomonas putida , for four amino acids, the synonymous codons that are enriched among ribosomal proteins and translation elongation factors are not the same as the synonymous codons that are most abundant among those proteins. these effects are also observed in genomes with less bias in nucleotide composition, such as bacillus subtilis  and escherichia coli , each of which had one amino acid where the most enriched codon is not the most abundant codon.

 <dig>  the fn table was constructed using all of the genes in the specified genome; nscu values are the frequency of each codon normalized to the largest value within each synonymous codon group

 <dig>  the fo table was constructed using the translation <dig> genes  <cit> .

 <dig>  the normalized δ values were calculated as the fo/fn ratio, thus correcting fo values to the codon composition of the genome as a whole.

 <dig>  bolded underlines indicate that the uncorrected table significantly underestimates selection against this codon and incorrectly denotes it as the preferred codon.

 <dig>  single underlines indicate that the uncorrected table significantly overestimates selection against this codon.

 <dig>  asterisks indicate that the uncorrected table significantly underestimates selection against this codon.

normalization to a theoretical distribution
rigorous interpretation of any codon bias statistic depends upon knowledge of its distribution given expected synonymous codon usage frequencies. issues as simple as discerning if one orf is more enriched for optimal codons than another cannot be resolved unless we know the values that are expected to arise from orfs that vary in amino acid composition but not synonymous codon frequencies. likewise, unless the variance of the summary statistic is known, variation between genes cannot be inferred to result from differences in the strength of selection between those genes rather than being due to the stochastic nature of mutation and drift.

the expected codon frequencies will depend upon the null hypothesis being tested. if the null hypothesis is that an orf has not been shaped by selection for optimal codons, then the table of expected codon frequencies for each amino acid is equivalent to fn, above. for now, we will use genome-wide codon composition as estimates of fn, although we will refine this estimate below. to estimate the distribution of the scb expected for a given orf, we first estimate the sampling distribution of the composite score for each amino acid . the expected score of each amino acid is the count  of that amino acid, multiplied by the weighted average of the scores of each of its codons , so that   

and   

where pij, the probability of observing that codon at random, is equivalent to fn. in our null model, the identity of the codon at each site is independent of those at other sites, meaning that the variance of the scb is the sum of the variance for each site, so that   

and   

being the sum of many independent random variables, the scb has an approximately normal distribution according to the central limit theorem  <cit> . many statistical tests assume a normal distribution, so we will describe a statistic derived from that distribution. the adaptive codon enrichment  is the difference between the observed scb and the expected scb for an orf:   

this may be normalized in two ways. first, it may be presented as a standard deviation score or z-value as,   

this statistic can be used in a z-test to evaluate the probability that the codon composition of a gene differs significantly from that predicted from mutational bias alone. alternatively, the ace may be unit normalized so that it reflects the deviation averaged per codon in the coding sequence as,   

because amino acids differ in their sensitivity to codon selection, they each contribute different amounts of variance to the final score, so normalization takes into account the variance contributed by each amino acid rather than simply dividing by the length of the encoded protein. the equation for aceu is equivalent to the average of the z-value for each individual codon. notably, the ace is indifferent to the inclusion or exclusion of methionine and tryptophan codons because, having only single codons, they influence the observed and expected values identically and thus contribute no variability. this is in contrast to statistics that are sensitive to the frequency with which the most preferred codon occurs, such as the cai, where methionine and tryptophan are explicitly ignored  <cit> .

to validate that ace statistics can be treated as random normal variables, we used monte carlo simulations to examine the properties of genes for which the scb fit this assumption. distributions were constructed from  <dig> monte carlo samples for each orf of e. coli and p. putida, using the expected codon distribution of the respective genome. the predicted mean and variance were universally accurate, while deviations from normality were only detectable within the gc-biased p. putida genome. d'agostino's k-squared test  <cit>  identified an excess of genes having non-normal scb null distributions , although the skewness and kurtosis values were universally small  and the worst approximations were concentrated among genes with less than  <dig> degenerate codons .

prediction of gene expression levels
using existing gene expression data, we examined the predictive power of several codon selection statistics and their robustness in the face of uncertainty regarding optimal parameterization. here we considered those methods that rely on information about the frequency with which each codon is used within a set of orfs optimized for translation . a robust method will generate a consistently high level of performance when the fo table is constructed with any set of orfs for which the codon usage has been biased by codon selection. we selected six datasets of transcript abundance data for evaluation: e. coli  <cit> , pseudomonas aeruginosa  <cit> , bacteroides thetaiotaomicron  <cit> , bacillus anthracis  <cit> , saccharomyces cerevisiae  <cit> , and schizosaccharomyces pombe  <cit> . these include both eukaryotes and bacteria from three phyla, with genomic nucleotide compositions ranging from strongly at-biased to strongly gc-biased.

for each dataset, we examined the correlation of the transcript abundance data relative to each codon optimization statistic  when the codon statistic was calibrated against the most abundant transcripts from the same dataset. here, our intention is not to actually predict the transcript abundance data, but to evaluate the behavior of each method under optimal conditions. by calibrating with the dataset that the statistics are tested against, we avoid arbitrary decisions in parameterization that may inadvertently favor one method over another. to examine how each statistic responds to decreased precision in identifying the optimal genes, the number of genes contributing codons to fo was gradually increased,  <dig> at a time, until it included half of all genes . for the statistics that require an estimate of codon usage in the absence of codon selection , we used the codon composition of the entire genome.

we observed substantial variation among codon bias statistics, with the highest correlations typically being produced by the aceu,gcb, and melp , and these correlations being more robust to the decreased resolution of "highly expressed genes". generally, cai had the weakest correlation with expression level, particularly for p. aeruginosa , which is expected given that this genome exhibits a strong bias in nucleotide composition  and cai does not incorporate any information about this bias  <cit> .

the ability of the aceu to predict gene expression levels in p. aeruginosa with such high accuracy  is surprising in light of previous studies suggesting that there is little codon selection acting in this genome  <cit> . grocock and sharp  <cit>  suggested that codon variation in p. aeruginosa was primarily due to the presence of genes with atypical nucleotide composition , with a secondary trend due to codon selection. recently acquired genes tend to be expressed weakly during growth in rich media, so that even in the absence of codon selection, a statistic that simply discriminated between native and foreign genes would be expected to correlate with expression levels. we tested whether this factor contributed to the high correlation by limiting the analyses to the  <dig> genes that are likely to be native to p. aeruginosa because orthologs were detected in each of four other diverse pseudomonas species: p. mendocina, p. stutzeri, p. entomophila, and p. putida . for the  <dig> genes in this set that also had transcript abundance values, the correlation coefficient actually increased to r =  <dig>  using the same fo, indicating that most of this correlation is indeed due to codon selection.

prediction of substitution rates
the degree of codon bias also correlates  with the degree of divergence among orthologs. this is typically attributed to different levels of purifying selection or different mutation rates resulting from different frequencies of transcription  <cit> . we estimated the between-species synonymous divergence  for genes in p. aeruginosa, b. subtilis, e. coli, staphylococcus haemolyticus, and lactobacillus gasseri relative to orthologs in other genomes, and calculated the correlation between ds and each of the codon selection statistics, using the translation <dig> genes for fo. the aceu generally produced a stronger correlation than the cai , was very similar to the gcb, and was sometimes exceeded by karlin's e and supek's melp, which incorporate the same information about the expected codon usage but are not monotonic functions of codon optimization .

 <dig>  genome from which codon bias statistics were calculated. all codon statistics were calculated using the translation <dig> gene set to construct fo and all orfs to construct fn.

 <dig>  average divergence  and correlation were measured among putative orthologs with ds <  <dig>  between reference and target genomes.

 <dig>  correlation to log of belonging to the core genome as classified by random forest classifier  <cit> ; rf values were calculated from a forest of  <dig> trees as reported by supek et al.  <cit> .

algorithms for creating reference sets of non-optimized genes
ace statistics rely on an expectation of the codon frequencies that would be observed in the absence of codon selection. other methods for quantifying codon selection share this requirement, and these frequencies are often estimated from the codon composition of the entire genome under the premise that the majority of genes experience little codon selection. yet genome-wide codon usage tables will be influenced both by genes experiencing strong codon selection and by genes recently introduced by lateral transfer whose codon usage patterns do not reflect the mutational history of their current genome. eliminating both of these gene sets from this reference table should produce better predictions of gene expression data from codon frequency data. to exclude these classes of genes, we removed compositionally atypical genes, identified as those with dinucleotide or codon usage patterns that were maximally different from genome-wide averages  <cit> ; as expected, this process excluded genes with extreme cai values or atypical gc compositions at third codon positions . using systematically smaller subsets of e. coli genes to estimate fn, we saw improvement in the correlation between mrna expression levels and aceu, melp, gcb and e . the optimal reference table was reached when the most atypical ~30% of genes were excluded; additional reduction in the size of the set did not result in significant improvement.

for genomes lacking expression data for calibration, we developed an algorithm to identify a reasonable set of typical genes. based on the assumption that removal of the most extreme 1% of genes produces more accurate δvalues, the algorithm continues to decrease the gene set by 1% increments as long as a significant majority of codons' δ values shift in the same direction as initially observed . for e. coli, this resulted in a reference table constructed from 77% of the genes , which is among the largest sets of compositionally typical, native genes that produced stronger correlations to expression data . therefore, this method provides a robust approach to selecting a less-biased and less noisy set of genes to approximate codon usage patterns produced by genome-wide processes alone.

algorithms for creating reference sets of selected genes
the ace, like other methods, compares each gene's codon usage to the codon usage of a reference set of genes believed to have experienced strong codon selection . this set can be assembled by choosing genes that are known empirically to be highly expressed during rapid growth. however, these data are both biased to the laboratory conditions under which the organism is cultured and unavailable for many organisms. to eliminate these constraints, we used a two-step method to create this reference set from genomic data alone. to create an initial fo set, we selected a set of genes that could reasonably be inferred to have experienced codon selection; we examined such criteria as strong tai  <cit> , high χ <dig> of codon usage  <cit> , high values of the p <dig> metric  <cit> , low values of enc  <cit>  or enc'  <cit> , atypical codon composition  <cit> , homology to genes encoding the translation apparatus , or strong conservation of amino-acid sequence in one or more genomes. second, we iteratively selected an optimized gene set for each genome. genes with the highest aceu values were selected to create the fo table for the next round of the iteration. the processes began by selecting the most biased 40% of genes and reduced this set over  <dig> iterations until the final table size  was reached and the fo tables stabilized; this approach is similar to those used elsewhere, but based on different statistics  <cit> .

throughout this iteration process, codon scores are adjusted for the genome-wide tendencies, so the iteration algorithm identifies those genes that most exemplify the broad trend revealed when the initial parameterization set was compared to the whole genome set. consequently, selection of the initial set is of utmost importance. initial data sets, each generated using a different criterion, led to identical or nearly-identical reference sets after iteration for the  <dig> genomes that we examined . the most robust results came from initial reference sets comprised of genes encoding ribosomal proteins , or genes which were most strongly conserved in the largest number of target genomes as determined by blast analysis ; in both cases, biologically plausible reference sets - as determined by the genes' likely functions in the cell - were reached in >95% of genomes tested. in addition, the other methods, especially the tai and p <dig> metrics, also converged on this same set of genes in most cases . the common iteration endpoint reached by multiple initial gene sets lends confidence that the final, iterated fo table is accurately reporting codon selection. as expected, the iterated fo table was similar to the translation <dig> set of translation genes in most bacterial genomes.

our ability to reach this endpoint without specifying particular genes sets  allows the method to be extended to genomes of bacteriophages and other entities wherein highly-expressed genes are more difficult to identify a priori. for example, a similar analysis of the bacteriophage λ genome identified genes encoding structural proteins as those under strongest codon selection, and dispensable genes of the nin region as those under the least selection . we examined the optimal size for the fo table by comparing the aceu obtained with fo tables containing different numbers of codons against the mrna transcript levels of those genes in e. coli and p. aeruginosa  <cit> . the optimal table size  was found to be between  <dig>  and  <dig>  codons .

summarizing genomic codon selection
the intensity of codon selection varies between genomes and several approaches have been implemented to measure these differences  <cit> . these studies have found that codon selection -- along with the number of trna and rrna genes -- increases in bacteria with faster growth rates, suggesting that codon adaptation is one of several genomic structures that minimize generation time under optimal growth conditions  <cit> .

unlike other measures of gene-level codon usage bias, the acez lends itself naturally to estimates of genome-wide codon selection. a χ <dig> distribution is defined as the sum of the squares of samples from a standard normal distribution. therefore, we can calculate a normalized χ <dig> statistic for each genome - measuring the overall degree by which genes deviate from the genome-wide expectation- by calculating the average of the squared z-scores for each gene g, as   

in the absence of codon selection, values should approach  <dig> , where the codon usage of each gene is a random sample  <cit> . the monte carlo simulations described above confirmed that when all orfs share the same codon composition, the acez distribution for the genome has a mean of zero and a variance of one, resulting in a normalized χ <dig> of  <dig> .

to validate the behavior of the aceχ <dig> on real genomes, we examined two genomes  that are known to exhibit substantial codon selection, and one  that is believed to experience negligible codon selection  <cit> . p. aeruginosa is of special interest because grocock and sharp  <cit>  demonstrated that highly expressed genes exhibit distinctive codon usage in this genome, but sharp et al.'s  <cit>  attempt to estimate the strength of codon selection on  <dig> translational proteins revealed no selection . this was attributed to the fact that s is based on the codons for only four amino acids, which did not include codons that were enriched in the highly expressed genes of p. aeruginosa  <cit> . because ace incorporates information from all synonymous codons, this limitation should be avoided.

the aceχ <dig> for the entire p. aeruginosa genome  was  <dig>  when the translation <dig> genes was used for fo, which is noticeably greater than the value expected in the absence of selection . to test if aceχ <dig> is responding to codon usage variation that results from the inclusion of non-native genes, we limited the analysis  to the  <dig> orfs with orthologs in the four other pseudomonas species; aceχ <dig> increased to  <dig>  . the great variation in aceχ <dig> values is illustrated by the b. aphidicola genome , where aceχ <dig> was  <dig>  when fo was calculated using the translation <dig> genes ; in contrast, the aceχ <dig> for e. coli k <dig>  was  <dig> . the differences in aceχ2values between these genomes is not an artifact of comparing non-orthologous genes, since the e. coli genes that can be matched to b. aphidicola genes actually have higher acez values, and therefore would create an even greater aceχ <dig> value .

a. acez values were calculated using the translation <dig> gene set to construct fo and all orfs to construct fn. number of genes is reported in parentheses.

b. putative orthologs of pseudomonas aeruginosa, p. mendocina, p. stutzeri, p. entomophila, and p. putida.

c. not applicable.

d. putative orthologs of e. coli, e. fergusonii, and e. albertii

the contrast between endosymbiotic and free-living enterobacteria was corroborated through comparison of four independent endosymbiont lineages  <cit>  against eleven diverse free-living genomes. we selected  <dig> sets of putative orthologs present in each genome and, using the translation <dig> genes to construct fo, calculated aceχ <dig> for these genes while using their combined codon composition as fn. these four endosymbionts had substantially lower aceχ <dig> than any of their free-living relatives .

to test the sensitivity of the aceχ <dig> to genome-wide selection for efficient translation of highly expressed genes, we examined the correlation between aceχ <dig> and trna gene copy number, which is the complementary side of codon bias  <cit> . to assure a large sample of orthologous genes and minimize phylogenetic non-independence between genomes, we limited each analysis to a single bacterial family - the enterobacteriaceae, mycobacteriaceae, and bacilliaceae . genomes  were selected such that no two genomes were separated by less than one substitution per synonymous site , assuring that no two genomes were closely related and a sufficient number of mutational events had occurred such that meaningful differences in trna count and codon usage are possible. unfortunately, we were unable to examine the relationship between codon optimization and maximal growth rate due to insufficient information about maximal growth rates in these groups  <cit> .

a. all codon statistics were calculated using the translation <dig> gene set to construct fo and the shared set of orfs to construct fn.

b. aceχ2core was calculated from all orthologues; aceχ <dig>  <dig> was calculated from translation <dig> genes.

c. probability of calculating a correlation coefficient this large in the absence of a true correlation; one-tailed test using fisher's z-transformed correlation.

to evaluate the enterobacteriaceae without the influence of endosymbionts, we recalculated aceχ <dig> without the four endosymbionts mentioned above, but added three more genomes from free-living bacteria . using the  <dig> genes shared among these  <dig> genomes, we still detected a substantial correlation between trna gene number and aceχ <dig> . noticeably, the relationship of aceχ <dig> among genomes is robust to the set of genes used to assign the fn frequencies; for the  <dig> genomes that were included in both analyses, the correlation of their values was  <dig> , despite being calculated with  <dig> vs.  <dig> genes. a significant correlation between aceχ <dig> and trna count is also seen for the bacilliaceae , while the correlation in the mycobacteriaceae  does not reach the standard significance cutoff of  due to both a smaller correlation and smaller sample size .

in contrast to the aceχ <dig>  other measures of codon selection detected little variation among genomes of non-endosymbiotic bacteria within the same family and none indicated a significant correlation with trna gene count . we examined dethlefsens and schmidt's Δn'c  <cit> , rocha's encdiff  <cit> , and sharp's s  <cit> , but excluded von mandachs and merkl's gcbeff  <cit> because it cannot be meaningfully calculated for many genomes. the enterobacteriaceae contain the greatest number of sequenced genomes with a substantial amount of synonymous divergence among them , so we focused on them for further investigation of the differences among the statistics . a fundamental difference between the aceχ <dig> and other statistics is that aceχ <dig> examines the codon usage variation for a large portion of the genome , whereas the previously described methods examine how the codon usage frequencies of a specified subset of genes differs from the genome-wide average  <cit> .

to test if this focus on the pre-selected set of optimized genes accounted for the differences between the statistics, we calculated aceχ <dig> for just the  <dig> genes that were used for the fo table, while continuing to use the  <dig> shared genes for fn. this statistic  had only a moderate correlation to the aceχ <dig> for the shared genes , indicating that focusing on this smaller set of genes can substantially distort estimates of genome-wide codon selection. however, this is not the only explanation for the difference between the aceχ <dig> and other statistics, as the aceχ <dig> has an even weaker correlation to encdiff and s, while being strongly correlated to Δn'c .

discussion
interpretation of ace
the ace measures the effect of codon selection on codon usage, which is a slightly different concept than the magnitude of selection  described in population genetic theory. we have taken care to remove the influence of amino-acid composition from the ace to provide a better prediction of physiological parameters such as gene expression levels. in contrast, an estimate of s should be sensitive to the amino acid composition, and a direct estimate of codon selection will likely provide better estimates of population diversity parameters such as the patterns of polymorphism  <cit> . moreover, the ace is a linear function of codon frequency; for an amino acid encoded by two codons, the contribution to ace is directly proportional to the frequency of the preferred codon . in contrast, selection is a non-linear function of p /] where k represents the mutational balance), according to sharp et al.  <cit> .

the ace uses an estimate of the codon composition specified as arising from genome-wide processes alone . we constructed a single table to reflect these codon frequencies, implicitly assuming that a uniform process is acting upon all genes in the genome. this assumption of mutational uniformity is less valid in some eukaryotic genomes that harbor isochores, but it is reasonable for bacteria once recently introduced genes are excluded. slight violations of this assumption arise from subtle strand variation and origin-to-terminus gradients  <cit> . however, this variability does not generally affect calculation of ace values; for example, while replication of firmicutes involves distinct forms dna polymerase iii on each strand, leading to strong strand bias  <cit> , the correlation between ace values and ds does not improve when separate fn tables are created from leading and lagging strand genes .

one final concern is that codons are not necessarily independent of their neighbors <cit> , or that synonymous sites may be constrained by functional demands aside from codon optimization for efficient translation. among these constraints are determinants of chromosome architecture  <cit> , mrna structure  <cit> , avoidance of ribosome-binding sites  <cit>  or homopolymeric tracts  <cit> , or even selection for the more slowly translated codon due to the kinetics of and protein synthesis  <cit> .

variance in ace
we modeled the stochastic distribution of the ace as though each gene had a constant amino acid composition and each amino acid could be encoded by any of its cognate codons with a probability given by genome-wide substitution parameters. of course, amino acids will vary stochastically in a constant regime of mutation and selection, and modeling such variation may increase the expected variance of the ace, though the normalization across amino acids should minimize any variance introduced by amino acid substitutions. regardless of that correction, amino acid composition can only crudely be modeled as a simple random variable because selective pressures acting on amino acid substitutions clearly are not uniform across the length of the protein.

selection acting on synonymous substitutions varies among sites within orfs  <cit> . the ace is robust to this complication layered on top of the mutation-selection-drift model, and can be interpreted as being proportional to the number of sites under strong selection for use of the globally preferred codon. such variation in the strength of selection among sites would reduce the stochastic variance in the ace and other codon bias statistics.

identification of genome-wide influences on codon usage
the construction of two different codon frequency tables  allows us to separate the genome-wide influences on codon usage from codon selection, which has the greatest effect on highly expressed genes, causing fo to deviate from fn. the use of fn to normalize the iteration process avoids identifying a set of genes that represent the "dominating codon bias"  <cit> , instead identifying a set representing codon selection  <cit> . the accuracy of fn has an important role in any analysis of codon selection. we demonstrated a method for identifying a set of genes that best represents the patterns of codon usage that would exist in the absence of codon selection. the codon usage in such genes is generally assumed to reflect mutational biases, but they may in fact be influenced by genome-wide selection for nucleotide composition or biased gene conversion  <cit> . such complications would not affect the suitability of these genes to represent codon usage in the presence of minimal codon selection.

comparisons of codon selection among genes
the statistical framework of the ace facilitates comparisons among genes within a genome. first, by accounting for the codon frequencies that are expected to be observed in the absence of codon selection, the ace avoids spurious differences that can result from variation in amino acid composition among genes. a more fundamental difference between ace and other statistics in this context is that the stochastic variation  in ace is approximately normally distributed, and its variance can be calculated despite each amino acid contributing a different amount of variation. for a given gene, the error variance of the ace can be estimated as the variance that would occur in the scb  when the expected codon frequencies are equal to the observed codon frequencies in that gene. the error variance of the aceu is then the error variance of the ace divided by the square of the denominator in equation  <dig> 

having an estimate of the error variance, and knowing that the variance is approximately normally distributed, we are able to compare genes using the t-test for two independent samples  <cit> . this provides a statistical test for whether genes experience different degrees of codon selection. for example, the aceu values for the independently transcribed methionine biosynthetic genes in e. coli range from - <dig>  to - <dig>  for the metabc genes to  <dig> - <dig>  for the meteh genes. while the aceu of the metabc genes are not significantly different from each other , all three are significantly different from those of the mete or meth genes . this difference is not surprising as the metabc genes are only expressed during methionine starvation whereas the meteh genes also function to recycle s-adenosyl-homocysteine, a function that is required even during periods of methionine excess. therefore, the significant difference in aceu values supports the hypothesis that the meteh genes would be expressed under a larger number of growth conditions and, as a result, experience greater codon selection.

comparisons of codon selection across genomes
the aceχ <dig> is fundamentally different from previous attempts to quantify variation in the strength of codon selection between genomes. three recently proposed methods have focused on a small fraction of the orfs in each genome  and used the deviation of their codon usage from the genome-wide average as an estimate of the efficacy of selection in each genome  <cit> . they interpret the strength of selection on a particular subset of orfs as being representative of, or proportional to, the strength of selection acting on all orfs in the genome. in contrast, aceχ <dig> can be calculated from all genes believed to be long-term residents of the genome. this greater inclusiveness may account for the fact that the aceχ <dig> generally correlates more strongly with the trna gene number than the other measures. the biological basis for the correlation between trna gene number and measures of codon selection remains unclear  <cit> , and the ability of the aceχ <dig> to quantify codon selection across large sets of genes may facilitate investigations of this relationship.

extension of the ace framework to other analyses
a strength of the ace framework is its null model, which allows rigorous statistical tests to be applied to acez, aceu and aceχ <dig>  this framework can be extended to other metrics. for example, the cai has inspired other measures of codon usage bias, such as the tai  <cit>  and the eai  <cit> . these statistics rely on scoring table values  that are derived from theories of how selection acts on the translational process, rather than being inferred from observed gene sequences. despite this difference, these statistics are still amenable to the statistical tools developed for ace, which may provide greater precision to the estimates of codon selection when investigating the molecular nature of codon selection .

CONCLUSIONS
we have presented a statistical framework for the interpretation of codon usage biases in microbial genomes, both within and between genomes. the proposed summary statistic for quantifying variation within a genome incorporates the strengths that were previously only found in separate statistics, furthermore this work incorporates an analytical description of the sampling variance for the statistic. the methods presented here can also be applied to genomes for which we do not have prior information about gene expression and codon selection.

