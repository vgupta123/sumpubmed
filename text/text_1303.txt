BACKGROUND
the g-protein coupled receptor  superfamily is comprised of an estimated 600– <dig>  members and is the largest known class of molecular targets with proven therapeutic value. they are ubiquitous in our body, being involved in regulation of every major mammalian physiological system  <cit> , and play a role in a wide range of disorders including allergies, cardiovascular dysfunction, depression, obesity, cancer, pain, diabetes, and a variety of central nervous system disorders  <cit> . they are integral membrane proteins sharing a common global topology that consists of seven transmembrane alpha helices, an intracellular c-terminal, an extracellular n-terminal, three intracellular loops and three extracellular loops. there are four main classes of gpcrs  defined in terms of sequence similarity  <cit> . their location on the cell surface makes them readily accessible to drugs, and  <dig> gpcrs are the targets for the majority of best-selling drugs, representing about 40% of all prescription pharmaceuticals on the market  <cit> . besides, the human genome contains several hundreds unique gpcrs which have yet to be assigned a clear cellular function, suggesting that they are likely to remain an important target class for new drugs in the future  <cit> . predicting interactions in silico between small molecules and gpcrs is not only of particular interest for the drug industry, but also a useful step for the elucidation of many biological process. first, it may help to decipher the function of so-called orphan gpcrs, for which no natural ligand is known. second, once a particular gpcr is selected as a target, it may help in the selection of promising molecule candidates to be screened in vitro against the target for lead identification.

in silico virtual screening of gpcrs is however a daunting task, both for receptor-based approaches  and for ligand-based approaches. the former relies on the prior knowledge of the 3d structure of the protein, in a context where only two gpcr structures are currently known . indeed, gpcrs, like other membrane proteins, are notoriously difficult to crystallize. as a result, docking strategies for screening small molecules against gpcrs are often limited by the difficulty to model correctly the 3d structure of the target. to circumvent the lack of experimental structures, various studies have used 3d structural models of gpcrs built by homology modeling using bovine rhodopsin as a template structure. docking a library of molecules into these modeled structures allowed the recovery of known ligands  <cit> , and even identification of new ligands  <cit> . however, docking methods still suffer from docking and scoring inaccuracies, and homology models are not always reliable-enough to be employed in target-based virtual screening. methods have been proposed to enhance the quality of the models for docking studies by global optimization and flexible docking  <cit> , or by using different sets of receptor models  <cit> . nevertheless, these methods have been applied only to class a receptors and they are expected to show limited performances for gpcrs sharing lower sequence similarity with rhodopsin, especially in the case of receptors belonging to classes b, c and d. alternatively, ligand-based strategies, in particular quantitative structure-activity relationship , attempt to predict new ligands from previously known ligands, often using statistical or machine learning approaches. ligand-based approaches are interesting because they do not require the knowledge of the target 3d structure and can benefit from the discovery of new ligands. however, their accuracy is fundamentally limited by the amount of known ligands, and degrades when few ligands are known. although these methods were successfully used to retrieve strong gpcr binders  <cit> , they are efficient for lead optimization within a previously identified molecular scaffold, but are not appropriate to identify new families of ligands for a target. at the extreme, they cannot be pursued for the screening of orphan gpcrs. in this paper, we present a contribution to the screening of gpcrs, that is complementary to the above docking and ligand-based approaches. the method is related to ligand-based approaches, but because it allows to share information between different gpcrs, it can be used for orphan gpcrs, possibly in parallel to docking methods in order to increase the prediction quality.

indeed, instead of focusing on each individual target independently from other proteins, a recent trend in the pharmaceutical industry, often referred to as chemogenomics, is to screen molecules against several targets of the same family simultaneously  <cit> . this systematic screening of interactions between the chemical space of small molecules and the biological space of protein targets can be thought of as an attempt to fill a large 2d interaction matrix, where rows correspond to targets, columns to small molecules, and the -th entry of the matrix indicates whether the j-th molecule can bind the i-th target. while in general the matrix may contain some description of the strength of the interaction, such as the association constant of the complex, we will focus in this paper on a simplified description that only differentiates binding from non-binding molecules, which results in a binary matrix of target-molecule pairs. this matrix is already sparsely filled with our current knowledge of protein-ligand interactions, and chemogenomics attempts to fill the holes. while classical docking or ligand-based virtual screening strategies focus on each single row independently from the others in this matrix, i.e., treat each target independently from each others, the chemogenomics approach is motivated by the observation that similar molecules can bind similar proteins, and that information about a known interaction between a ligand and a gpcr could therefore be a useful hint to predict interaction between similar molecules and similar gpcrs. this can be of particular interest when, for example, a particular target has few or no known ligands, but similar proteins have many: in that case it is tempting to use the information about the known ligands of similar proteins for a ligand-based virtual screening of the target of interest. in this context, we can formally define in silico chemogenomics as the problem of predicting interactions between a molecule and a ligand  from the knowledge of all other known interactions or non-interactions .

recent reviews  <cit>  describe several strategies for in silico chemogenomics. a first class of approaches, called ligand-based chemogenomics by  <cit> , pool together targets at the level of families  or subfamilies  and learn a model for ligands at the level of the family  <cit> . such strategies could be facilitated by the design of libraries of annotated ligands  <cit> . other approaches, termed target-based chemogenomic approaches by  <cit> , cluster receptors based on ligand binding site similarity and again pool together known ligands for each cluster to infer shared ligands  <cit> . finally, a third strategy termed target-ligand approach by  <cit>  attempts to predict ligands for a given target by leveraging binding information for other targets in a single step, that is, without first attempting to define a particular set of similar receptors. this strategy was pioneered by  <cit> .  <cit>  predicted ligands of orphan gpcr. they merged descriptors of ligands and targets to describe putative ligand-receptor complexes, and used svm to discriminate real complexes from ligand-receptors pairs that do not form complexes. a similar approach termed proteochemometrics was used in  <cit>  to correlate ligand-receptor descriptions to the corresponding binding affinities.  <cit>  followed a similar idea to  <cit>  with different descriptors, and showed in particular that the svm formulation allows to generalize the use of vectors of descriptors to the use of positive definite kernels to describe the chemical and the biological space in a computationally efficient framework.  <cit>  were not able to show, however, significant benefits with respect to the individual approach that learns a separate classifier for each gpcr . recently, in the context of predicting interactions between peptides and different alleles of mhc-i molecules,  <cit>  followed a similar approach and highlighted the importance of choosing adequate descriptors for small molecules and targets. they obtained state-of-the-art prediction accuracy for most mhc-i allele, in particular for those with few known binding peptides.  <cit>  on the other hand applied this approach to predict interaction between various potential targets including gpcrs, enzymes and ion channels. using general descriptors for targets, they obtained predictors that were more accurate than state-of-the-art individual methods both for the orphan targets and for the targets for which some ligands were already known.

in this paper we go one step further in this direction and present an in silico chemogenomics approach specifically tailored for the screening of gpcrs, although the method could in principle be adapted to other classes of therapeutic targets. we follow the idea of  <cit>  and the algorithmic trick of  <cit> , which allows us to systematically test a variety of descriptors for both the molecules and the gpcrs. we test 2d and 3d descriptors to describe molecules, and five ways to describe gpcrs, including a description of their relative positions in current hierarchical classifications of the superfamily, and information about key residues likely to be in contact with the ligand. we evaluate the performance of all combinations of these descriptions on the data of the glida database  <cit> , which contains  <dig> reported interactions between human gpcrs and small molecules, and observe that the choice of the descriptors has a significant impact on the accuracy of the models. however, in all cases, we obtained significant improvements of the prediction accuracy with respect to the individual learning setting.

data
we used the glida gpcr-ligand database  <cit>  which includes  <dig> known ligands for  <dig> gpcrs from human, rat and mouse. the ligand database contains highly diverse molecules, from ions and very small molecules up to peptides, and a significant number of duplicates. these redundancies were eliminated. elimination of duplicates present in the glida database was important here because it could have led to over-optimistic evaluation in the cross-validation procedure described below. the remaining molecules were further filtered in order to satisfy two constraints. first, our method relies on the evaluation of similarities between molecules using kernels, which makes sense only if the molecules are comparable in size. second, since the long term goal is to identify drug candidates targeting gpcrs, it was important to retain drug-like compounds, i.e. molecules having the adequate physico-chemical characteristics to be potential drugs candidates satisfying adme criteria  <cit> . therefore, to only keep drug-like compounds, we filtered the glida database using the filter program  with standard parameters, which removes molecules according to calculated properties such as molecular weight, hydrogen bond donor and acceptor count, number of rotatable bonds, ring size and number etc... as discussed in  <cit> . for example, only molecules of molecular weights ranging from  <dig> da to  <dig> da were kept , since the aim was to evaluate if statistical learning was possible on drug-like compounds. another example was the elimination of molecules with more than  <dig> rotatable bonds . indeed, they correspond to very flexible molecules that are not suitable for the use of 3d descriptors. overall these filters retained  <dig> molecules, available under a 2d description file in the glida data bank, and giving  <dig> interactions with the human gpcrs. the number of molecules retained is only a small fraction of the glida database, but it corresponds to all drug-like compounds of this database. for each positive interaction given by this restricted set, we generated a negative interaction involving the same receptor and one of the ligands that was in the database and that was not indicated as one of its ligands. this may have generated a few false negative points in our benchmark, and it would be interesting to use experimentally tested negative interactions. however, the mean similarity between the different ligands in the database using the tanimoto kernel, a classical normalized similarity measure for ligands which is later used in our method, is quite low . besides, only  <dig> % of the ligands have a mean similarity of more than  <dig>  to the other ligands. this suggests that even if false negative have to be expected, this method to generate negative interaction is a reasonable approximation. we loaded the sequences of all gpcrs that are able to bind any of these ligands, which resulted in  <dig> sequences, all corresponding to human gpcrs. the retained gpcrs were significantly diverse in sequence, most of them sharing 15% to 50% pairwise sequence similarities. furthermore, they belong to various families, according to the glida classification. they are found in several subfamilies of class a , classes b  and c . in the glida database, gpcrs are classified in hierarchy  which was also loaded for use in the hierarchy kernel.

methods
in this section, we first review the methods proposed by  <cit>  for in silico chemogenomics with svm, before presenting the particular descriptors we propose to use for molecules and gpcrs within this framework.

in silico chemogenomics with machine learning
we consider the problem of predicting interactions between gpcrs and small molecules. for this purpose we assume that a list of target/small molecule pairs {,...,}, known to interact or not, is given. such information is often available as a result of systematic screening campaigns in the pharmaceutical industry, or on dedicated databases. our goal is then to create a model to predict, for any new candidate pair , whether the small molecule m is likely to bind the gpcr t.

a general method to create the predictive model is to follow these four steps:

 <dig>  choose ntar descriptors to represent each gpcr target t in the biological space by a ntar-dimensional vector Φtar=,...,Φtarntar);

 <dig>  in parallel, choose nmol descriptors to represent each molecule m in the chemical space by a nmol-dimensional vector Φmol=,...,Φmolnmol);

 <dig>  derive a vector representation of a candidate target/molecule complex Φpair from the representations of the target Φtar and of the molecule Φmol;

 <dig>  use a statistical or machine learning method to train a classifier able to discriminate between binding and non-binding pairs, using the training set of binding and non-binding pairs {Φpair,..., Φpair}

while the first two steps  may be specific to each particular chemogenomics problem, the last two steps define the particular strategy used for in silico chemogenomics. for example,  <cit>  proposed to concatenate the vectors Φtar and Φmol to obtain a -dimensional vector representation of the ligand-target complex Φpair, and to use a svm as a machine learning engine.  <cit>  followed a slightly different strategy for the third step, by forming descriptors for the pair  as product of small molecule and target descriptors. more precisely, given a molecule m described by a vector Φmol and a gpcr t described by a vector Φtar, the pair  is represented by the tensor product:

  Φpair = Φtar ⊗ Φmol, 

that is, a -dimensional vector whose entries are products of the form Φtari×Φmolj, for  <dig> ≤ i ≤ ntar and  <dig> ≤ j ≤ nmol. a svm is then used as an inference engine, to estimate a linear function f in the vector space of target/molecule pairs, that takes positive values for interacting pairs and negative values for non-interacting ones.

the main motivation for using the tensor product  is that it provides a systematic way to encode correlations between small molecule and target features. for example, in the case of binary descriptors, the product of two features is  <dig> if both the molecule and the target descriptors are  <dig>  and zero otherwise, which amounts to encode the simultaneous presence of particular features of the molecule and of the target that may be important for the formation of a complex. a potential issue with this approach, however, is that the size of the vector representation ntar × nmol for a pair may be prohibitively large for practical computation and manipulation. for example, using a vector of molecular descriptors of size  <dig> for molecules, and representing a protein by the vector of counts of all 2-mers of amino-acids in its sequence  results in more than  <dig> k dimensions for the representation of a pair. as pointed out by  <cit> , this computational obstacle can however be overcome when a svm is used to train the linear classifier, thanks to a trick often referred to as the kernel trick. indeed, a svm does not necessarily need the explicit computation of the vectors representing the complexes in the training set to train a model. what it needs, instead, is the inner products between these vectors, and a classical property of tensor products is that the inner product between two tensor products Φpair and Φpair is the product of the inner product between Φtar and Φtar, on the one hand, and the inner product between Φmol and Φmol, on the other hand. more formally, this property can be written as follows:

  ⊗Φmol)⊤⊗Φmol)=Φtar⊤Φtar×Φmol⊤Φmol, 

where u ⊤ v = u1v <dig> + ... + udvd denotes the inner product between two d-dimensional vectors u and v. in other words, the svm does not need to compute the ntar × nmol vectors to describe each pair, it only computes the respective inner products in the target and ligand spaces, before taking the product of both numbers.

this flexibility to manipulate molecule and target descriptors separately can moreover be combined with other tricks that sometimes allow to compute efficiently the inner products in the target and ligand spaces, respectively. many such inner products, also called kernels, have been developed recently both in computational biology  <cit>  and chemistry  <cit> , and can be easily combined within the chemogenomics framework as follows: if two kernels for molecules and targets are given as:

  kmol=Φmol⊤Φmol,ktar=Φtar⊤Φtar, 

then we obtain the inner product between tensor products, i.e., the kernel between pairs, by:

  k, ) = ktar × kmol. 

in summary, as soon as two vectors of descriptors or kernels kmol and ktar are chosen, we can solve the in silico chemogenomics problem with an svm using the product kernel  between pairs. the particular descriptors or kernels used should ideally encode properties related to the ability of similar molecules to bind similar targets or ligands respectively.

in the next two subsections, we present different possible choices of descriptors – or kernels – for small molecules and gpcrs, respectively.

descriptors for small molecules
the problem of explicitly representing and storing small molecules as finite-dimensional vectors has a long history in chemoinformatics, and a multitude of molecular descriptors have been proposed  <cit> . these descriptors include in particular physicochemical properties of the molecules, such as its solubility or logp, descriptors derived from the 2d structure of the molecule, such as fragment counts or structural fingerprints, or descriptors extracted from the 3d structure  <cit> . each classical fingerprint vector and vector representation of molecules define an explicit "chemical space" in which each molecule is represented by a finite-dimensional vector, and these vector representations can obviously be used as such to define kernels between molecules  <cit> . alternatively, some authors have recently proposed some kernels that generalize some of these sets of descriptors and correspond to inner products between large- or even infinite-dimensional vectors of descriptors. these descriptors encode, for example, the counts of an infinite number of walks on the graph describing the 2d structure of the molecules  <cit> , or various features extracted from the 3d structures  <cit> .

in this study we select two existing kernels, encoding respectively 2d and 3d structural information of the small molecules:

• the 2d tanimoto kernel. our first set of descriptors is meant to characterize the 2d structure of the molecules. for a small molecule m, we define the vector Φmol as the binary vector whose bits indicate the presence or absence of all linear graph of length u or less as subgraphs of the 2d structure of l. we chose u =  <dig> in our experiment, i.e., characterize the molecules by the occurrences of linear subgraphs of length  <dig> or less, a value previously observed to give good results in several virtual screening tasks  <cit> . moreover, instead of directly taking the inner product between vectors as in , we use the tanimoto kernel:

  kligand=Φlig⊤ΦligΦlig2+Φlig2−Φlig⊤Φlig, 

which was proven to be a valid inner product by  <cit> , giving very competitive results on a variety of qsar or toxicity prediction experiments.

• 3d pharmacophore kernel while 2d structures are known to be very competitive in ligand-based virtual screening for identification of molecules presenting some given chemical, physical or biological properties  <cit> , we reasoned that the protein-ligand recognition process takes place in the 3d space. thus, we decided to test descriptors representing the presence of potential 3-point pharmacophores. for this, we used the 3d pharmacophore kernel proposed by  <cit> , that generalizes 3d pharmacophore fingerprint descriptors. this approach requires the choice of a 3d conformer for each molecule, in a context where there exists a large number of methods for exploring the conformation space, and where we lack significant data for bound ligands in gpcr structures. therefore, we chose to build a 3d version of the ligand database in which molecules are represented in the conformation proposed by the omega program , because it performs rapid systematic conformer search, and has been showed to present good performances for retrieving bioactive conformations  <cit> . for each of the  <dig> retained ligands, the conformer was generated using the standard omega parameters, except for a  <dig> Å rmsd clustering of the conformers, instead of the  <dig>  default value. partial charges were calculated for all atoms using the molcharge program  with standard parameters. this ligand database was then used to calculate a 3d pharmacophore kernel for molecules  <cit> .

we used the freely and publicly available chemcpp  software to compute the 2d and 3d pharmacophore kernel.

descriptors for gpcrs
svm and kernel methods are also widely used in bioinformatics  <cit> , and a variety of approaches have been proposed to design kernels between proteins, ranging from kernels based on the amino-acid sequence of a protein  <cit>  to kernels based on the 3d structures of proteins  <cit>  or on the pattern of occurrences of proteins in multiple sequenced genomes  <cit> . these kernels have been used in conjunction with svm or other kernel methods for various tasks related to structural or functional classification of proteins. while any of these kernels can theoretically be used as a gpcr kernel in , we investigate in this paper a restricted list of specific kernels described below, aimed at illustrating the flexibility of our framework and test various hypothesis.

• the dirac kernel between two targets t, t' is:

  kdirac={1if t=t′,0otherwise. 

this basic kernel simply represents different targets as orthonormal vectors. from  we see that orthogonality between two proteins t and t' implies orthogonality between all pairs  and  for any two small molecules c and c'. this means that a linear classifier for pairs  with this kernel decomposes as a set of independent linear classifiers for interactions between molecules and each target protein, which are trained without sharing any information of known ligands between different targets. in other words, using dirac kernel for proteins amounts to performing classical learning independently for each target, which is our baseline approach.

• the multitask kernel between two targets t, t' is defined as:

 kmultitask =  <dig> + kdirac. 

this kernel, originally proposed in the context of multitask learning  <cit> , removes the orthogonality of different proteins to allow sharing of information. as explained in  <cit> , plugging kmultitaskin  amounts to decomposing the linear function used to predict interactions as a sum of a linear function common to all gpcrs and of a linear function specific to each gpcr:

 f=w⊤Φ=wgeneral⊤Φlig+wt⊤Φlig. 

a consequence is that only data related to the the target t are used to estimate the specific vector wt, while all data are used to estimate the common vector wgeneral. in our framework this classifier is therefore the combination of a target-specific part accounting for target-specific properties of the ligands and a global part accounting for general properties of the ligands across the targets. the latter term allows to share information during the learning process, while the former ensures that specificities of the ligands for each target are not lost.

• the hierarchy kernel. alternatively we could propose a new kernel aimed at encoding the similarity of proteins with respect to the ligands they bind. in the glida database indeed, gpcrs are grouped into  <dig> classes based on sequence homology and functional similarity: the rhodopsin family , the secretin family , the metabotropic family  and some smaller classes containing other gpcrs. the glida database further subdivides each class of targets by type of ligands, for example amine or peptide receptors or more specific families of ligands. this also defines a natural hierarchy that can be used to compare gpcrs.

the hierarchy kernel between two gpcrs was therefore defined as the number of common ancestors in the corresponding hierarchy plus one, that is,

 khierarchy = ⟨Φh, Φh⟩, 

where Φh contains as many features as there are nodes in the hierarchy, each being set to  <dig> if the corresponding node is part of t's hierarchy and  <dig> otherwise, plus one feature constantly set to one that accounts for the "plus one" term of the kernel.

• the binding pocket kernel. because the protein-ligand recognition process occurs in 3d space in a pocket involving a limited number of residues, we tried to describe the gpcr space using a representation of this pocket. the difficulty resides in the fact that although the gpcr sequences are known, the residues forming this pocket are a priori unknown. however, mutagenesis data showed that the transmembrane binding site is situated in a similar region for all gpcrs  <cit> , and this information was confirmed by the two available x-ray structures. in order to identify residues potentially involved in the binding pocket of gpcrs of unknown structure studied in this work, we proceeded in several steps, somewhat similarly to  <cit> .  the two known structures, pdb entries 1u <dig> and 2rh <dig> <cit> , were superimposed using the stamp algorithm  <cit> . although retinal is an inverse agonist and form a covalent bond with rhodopsin, while carazolol is an agonist and binds non-covalently, root mean square deviation between these two complexed structures is only of  <dig>  Å in the transmembrane helices  <cit> . in the superimposed structures, the retinal and 3-propan-2-ol ligands are localized in the same region of the transmembrane space, which is in agreement with global conservation of binding pockets, as shown on figure  <dig>   the structural alignment of bovine rhodopsin and of human β2-adrenergic receptor was used to generate a sequence alignment of these two proteins.  for both structures, in order to identify residues potentially involved in stabilizing interactions with the ligand , we selected residues that presented at least one atom situated at less than  <dig> Å from at least one atom of the ligand. figure  <dig> shows that these two pockets clearly overlap, as expected.  residues of the two pockets ) were labeled in this structural sequence alignment. these residues were found to form small sequence clusters that were in correspondence in this alignment. these clusters were situated mainly in the apical region of transmembrane segments and included a few extracellular residues. indeed, it has been previously demonstrated that extracellular loops can play a role in ligand binding together with transmembrane regions  <cit> .  all studied gpcr sequences, including bovine rhodopsin and human β2-adrenergic receptor were aligned using clustalw  <cit>  with blosum matrices  <cit> . sequences which could not be correctly aligned  were discarded in order to only keep comparable sequences. we then checked that conserved residues according to  <cit>  of the transmembrane helices were correctly aligned, and local misalignments were corrected. in addition, the structural alignment of bovine rhodopsin and human β2-adrenergic receptor, and known conserved positions were used to locally correct misalignments. for each protein, residues in correspondence in this alignment with a residue of the binding pocket  of either bovine rhodopsin or human β2-adrenergic receptor were retained. this lead to a different number of residues per protein, because of sequence variability. for example, in extracellular regions, some residues from bovine rhodopsin or human β2-adrenergic receptor had a corresponding residue in some sequences but not in others. in order to provide a homogeneous description of the binding pocket for all gpcrs, in the list of residues initially retained for each protein, only residues situated at positions where no gaps were found in any of the gpcrs were kept.  each protein was then represented by a vector whose elements corresponded to a potentially conserved pocket. this description, although appearing as a linear vector filled with amino acid residues , implicitly codes for a 3d information on the receptor pocket, as illustrated in figure  <dig>  these vectors were then used to build a kernel that allows comparison of binding pockets. the classical way to represent motifs of constant length as fixed length vectors is to encode the letter at each position by a 20-dimensional binary vector indicating which amino acid is present, resulting in a 180-dimensional vector representations. in terms of kernel, the inner product between two binding pocket motifs in this representation is simply the number of letters they have in common at the same positions:

 kpb=∑i=1lδ, 

where l is the length of the binding pocket motifs , x is the i-th residue in x and δ  is  <dig> if x = x',  <dig> otherwise. this is the baseline pocket binding kernel. alternatively, using a polynomial kernel of degree p over the baseline kernel is equivalent, in terms of feature space, to encoding p-order interactions between amino acids at different positions. in order to assess the relevance of such non-linear extensions we tested this polynomial pocket binding kernel,

 kppb =  + 1)p. 

we only used a degree p =  <dig>  although a more careful choice of this parameter could further improve the performances.

RESULTS
we ran two different sets of experiments on this dataset in order to illustrate two important points. in a first set of experiments, for each gpcr, we 5-folded the data available, i.e., the line of the interaction matrix corresponding to this gpcr. the classifier was trained with four folds and the whole data from the other gpcrs, i.e., all other lines of the interaction matrix. the prediction accuracy for the gpcr under study was then tested on the remaining fold. the goal of these first experiments was to evaluate if using data from other gpcrs improved the prediction accuracy for a given gpcr. in a second set of experiments, for each gpcr we ignored ligand data available for this particular gpcr, we trained a classifier on the whole data from the other gpcrs, and tested on the data of the considered gpcr. the goal was to assess how efficient our chemogenomics approach would be to predict the ligands of orphan gpcrs. in both experiments, the c parameter of the svm was selected by internal cross validation on the training set among 2i, i ∈ {- <dig>  - <dig> ...,  <dig>  6}. the data and source code  are publicly available .

for the first experiment, since learning an svm with only one training point does not really make sense and can lead to "anti-learning" less than  <dig>  performances, we set all results r involving the dirac gpcr kernel on gpcrs with only  <dig> known ligand to max. this is to avoid any artefactual penalization of the dirac approach and make sure that we measure the actual improvement brought by sharing information across gpcrs.

the 3d kernel for the ligands, on the other hand, did not perform as well as the 2d kernel. this can be either explained by the fact the the pharmacophore kernel is not suited to this problem, or by the fact that choosing the conformer of the ligand is not a trivial task. this point is discussed below.

our second experiment intends to assess how our chemogenomics approach can perform when predicting ligands for orphan gpcrs, i.e., with no training data available for the gpcr of interest. table  <dig> shows that in this setting, individual learning performs random prediction. naive multitask approach provides modest improvement of the performance, but informative kernels such as hierarchical and binding pocket kernels achieve  <dig> % and  <dig> % of precision respectively, that is, almost 30% better than the random approach one would get when no data is available. here again, the fact that the binding pocket kernel that only uses the sequence of the receptor pocket performs as well as the hierarchy-based kernel is encouraging. it suggests that given a receptor for which nothing is known except its sequence, it is possible to make reasonable ligand predictions.

discussion
our results demonstrate that chemogenomic approaches outperform individual approach, in particular in cases where very limited or no ligand information is available, as shown in table  <dig> and figure  <dig>  in the case of well studied gpcrs, more classical ligand-based methods  may be better suited to predict new strong binders from a large number of known ligands, as shown in figure  <dig>  consistent with this observation, tables  <dig> and  <dig> show that in the two types of experiments, the improvement is observed for all subfamilies of gpcrs retained in this study. this is an interesting result since most of published virtual screening studies on gpcrs were applied to class a gpcrs.

mean prediction accuracy for each gpcr family for the first experiment with the 2d tanimoto ligand kernel and various target kernels. the numbers in bracket are the numbers of receptors considered in the experiment for each family. bp is the binding pocket kernel and pbp the poly binding pocket kernel.

mean prediction accuracy for each gpcr family for the second experiment with the 2d tanimoto ligand kernel and various target kernels. the numbers in bracket are the numbers of receptors considered in the experiment for each family. bp is the binding pocket kernel and pbp the poly binding pocket kernel.

since our chemogenomic approach is a ligand-based approach, it would probably be interesting to use it in combination with docking. indeed, although prior known ligands can help tuning docking procedures to the receptor under study, it can in principle be used with little or no ligand information. when more experimental 3d structures become available for gpcrs in the future, this will help building reliable models for a wider range of gpcrs that would be suitable for docking studies. joint use of ligand-based chemogenomic and docking would certainly improve predictions.

we chose to use a binary descriptor for the receptor-ligand interaction, while qsar or docking methods usually try to rank molecules according to their predicted affinity for the receptor. however, affinity prediction is still a subject of research at the level of a single receptor, at least when using methods whose calculation times are compatible with the screening of large molecular databanks. in this context, we feel that in chemogenomic approaches, where information is shared between different proteins, such quantitative prediction is even more challenging. this led us to retain the binary binding and non-binding descriptors, although it would formally have been straightforward to use a regression algorithm instead of a classification one to make quantitative predictions.

it is not always easy to compare the performances of a new method to other existing methods, and particularly in the case of gpcrs. indeed, at least to our knowledge, there is up to now no public complete data from previous screening studies available as a benchmark to compare different screening methods on the same data. this urged us to give public access to the ligand and receptor databases used in this study, to the detailed experimental protocol of the study, and to the predictions made by our chemogenomic approach for each gpcr  . this provides a benchmark which we hope will contribute to a fair evaluation of different methods and trigger new developments. this benchmark could be used to compare predictions made by other methods. our approach boils down to the application of well-known machine learning methods in the constructed chemogenomics space. we used a systematic way to build such a space by combining a given representation of the ligands with a given representation of the gpcrs into a binding-prediction-oriented gpcr-ligand couple representation. this allows to use any ligand or gpcr descriptor or kernel existing in the chemoinformatics or bioinformatics literature, or new ones containing other prior information as we tried to propose in this paper. our experiments showed that the choice of the descriptors was crucial for the prediction, and more sophisticated features for either the ligands or the gpcrs could probably further improve the performances. among these features, improvements in the 3d ligand descriptors could probably be obtained. indeed, 3d pharmacophore kernels did not always reach the performance of 2d kernels for the ligands. this is apparently in contradiction with the idea that protein-ligand interaction is a process occurring in the 3d space, and with previous work in our group  <cit> . different explanations can be proposed. first, it is possible that the bioactive conformation was not correctly predicted for all molecules used in this study. for the two ligands for which it was known, i.e., retinal and 3-propan-2-ol from pdb entries 1u <dig> and 2rh <dig> respectively, we found that the predicted conformation, using the same method as for all other molecules, was very close to the experimental conformation, with rmsd values of less than  <dig> Å. however, in absence of any other information on bound ligand conformations, it is not possible to rule out the possibility that for other molecules, the prediction was not correct. although more complete conformational space exploration for all ligands was clearly out of the scope of this paper and would be a study by itself, work in this direction could improve the method. in particular, since 2d ligand-based methods are not easily suitable to make predictions outside of the molecular scaffolds for which information is known, ligand-based methods using 3d description are of particular interest, because they are expected to allow better predictions on molecules presenting diverse molecular patterns. synergy between our method and docking would provide a means for the choice of a conformer. the principle could be to build homology models for the gpcrs, dock the molecular database in the modeled binding pockets, and derive a 3d database using, for each molecule, the conformer associated to the best docking solution. however, conformer generation and selection is a major drawback of using 3d descriptors, especially in the case of large ligands with many free torsion angles.

various evidence suggest that, within a common global architecture, a generic binding pocket mainly involving transmembrane regions hosts agonists, antagonists and allosteric modulators. in order to identify this pocket automatically, other studies report the use of sequence alignment and the prediction of transmembrane helices.  <cit>  detected hypervariable positions in transmembrane helices for identification of residues forming the binding pocket, although some positions were more conserved. indeed, conserved residues are probably important for structural stabilization of the pocket, while variable positions are involved in ligand binding, in order to accommodate the wide spectrum of molecules that are gpcr substrates. analyzing the positions of variable positions, these authors proposed potential binding pockets for gpcrs, and found that the corresponding residues were frequently in the grap mutant database for gpcrs  <cit> . interestingly, they pointed that residues at hypervariable positions were found within a distance of  <dig> Å from retinal in the rhodopsin x-ray structure, which is also a classical distance cutoff above which it is admitted that protein-ligand interactions become negligible. therefore, this inspired the simple and automatic method used in the present work for extracting gpcrs potential binding pockets, and our results are in good agreement with this study. it is also important to note that gpcrs are known to exist in dynamic equilibrium between inactive- and several active-state conformations  <cit> , and different ligands sometimes trigger distinct conformational changes and stabilize different receptor conformations  <cit> . taking into account receptor plasticity constitutes in itself a research domain in docking. its use is of particular interest for screening gpcr homology models since residue positions are not exactly known. therefore flexible docking procedures have been proposed and applied on gpcr proteins  <cit> . moreover, a modeling method has been proposed to get insights on transmembrane bundle plasticity  <cit> . in our case, receptor flexibility might influence the definition of the binding pocket, since it initially relies on the identification of residues in the two reference structures  that present at least one atom situated at less than  <dig> Å of the ligand. therefore, we made the implicit hypothesis that receptor conformational changes upon ligand binding does not drastically affect this list of residues. when more structures become available in this family of proteins, a better appreciation of such conformational rearrangements will be possible, which could be taken into account in the binding pocket definition and could help to improve the method.  <cit>  found that hierarchical tree representations of gpcr subfamilies calculated with full-length gpcr sequences or with only binding pocket residues were similar, and that locally, the latter was in better agreement with functional data although their binding pocket included only  <dig> residues. this result is also in good agreement with our finding that the hierarchy kernel based on full length sequence  and the kernel based on the binding pocket provided very similar performances. as mentioned in the results section, it is however important to note that the kernels based on the binding pocket were built without any ligand information that could lead to some bias and artificially better performance.

CONCLUSIONS
we showed how sharing information across the gpcrs by considering a chemogenomics space of the gpcr-ligand interaction pairs could improve the prediction performances, with respect to the single receptor approach. in addition, we showed that using such a representation, it was possible to make reasonable predictions even when all known ligands were ignored for a given gpcr, that is, to predict ligands for orphan gpcrs. our results demonstrate that chemogenomic approaches is particularly suited to cases where very limited or no ligand information is available, as shown in table  <dig> 

this chemogenomics approach is related to ligand-based approaches. however, sharing information among different gpcrs allows, in this case, to perform prediction on orphan gpcrs, which is also possible using target-based methods. nevertheless, the latter are limited by the number of known receptor structures and the difficulty to apply such methods on homology models.

interesting developments of this method could include application to other important drug target families, like enzymes or ion channels  <cit> , for which most of the descriptors used for the gpcrs in this paper could directly be transposed, and other, more specific ones could be designed. from a methodological point of view, many recent developments in multitask learning  <cit>  could be applied to generalize this chemogenomics approach using, for example, other regularization methods.

authors' contributions
lj, with the help and under the supervision of jpv, developed and implemented all the classification methods presented in the paper, and ran the experiments. bh and vs designed the benchmark and developed the binding pocket kernel and 3d ligand kernel. all authors contributed to writing the text, read and approved the final manuscript.

supplementary material
additional file 1
aligned receptor pocket residues. residues of 5-hydroxytryptamine 5a receptor, adenosine a2b receptor, gamma-aminobutyric acid type b receptor and relaxin  <dig> receptor  <dig>  aligned with β2-adrenergic receptor binding site amino acids. the binding pocket motif of β2-adrenergic receptor has been used as reference to determine residues involved in the formation of the binding site of the  <dig> other gpcrs. bold columns correspond to the residues shown on figure  <dig> 

click here for file

 additional file 2
source and data. source code  and benchmark used in the experiments in a compressed archive checker.tgz.

click here for file

 additional file 3
prediction accuracy by gpcr for the first experiment. mean prediction accuracy for each gpcr for the first experiment with the 2d tanimoto ligand kernel and various target kernels. the gpcr identifiers are the glida references. the numbers in bracket are the numbers ligands considered in the experiment for each gpcr. bp is the binding pocket kernel and pbp the poly binding pocket kernel.

click here for file

 additional file 4
prediction accuracy by gpcr for the second experiment. mean prediction accuracy for each gpcr for the second experiment with the 2d tanimoto ligand kernel and various target kernels. the gpcr identifiers are the glida references. the numbers in bracket are the numbers ligands considered in the experiment for each gpcr. bp is the binding pocket kernel and pbp the poly binding pocket kernel.

click here for file

 acknowledgements
we thank mines paristech and carnot mines for financial support to the project and funding of lj and bh.
