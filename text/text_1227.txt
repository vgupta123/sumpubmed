BACKGROUND
one of the primary goals of experiments involving dna microarrays is to find genes which are somehow similar across various experimental conditions. "similar" is usually taken to mean co-expressed, but it can be measured in several different ways. the distance  measure most commonly used is pearson correlation, though euclidean distance, cosine-angle metric, spearman rank correlation, and jackknife correlation are also used frequently.  for example,  <cit>  use pearson correlation in their gene network analysis;  <cit>  use pearson correlation  to cluster gene expression data. once the similarity or distance measure is chosen, the relationship between the genes is given by some sort of clustering algorithm  or gene network analysis.

clustering results can be highly dependent on the choice of similarity measure ; one or two outlying values can produce large changes in the value of some similarity measures. outlying data points can be real or noise, though microarray data are known to have substantial noise. the noise can occur during any of the stages in the experimental process, and the effect can be in any direction. for example, a large outlier might cause co-expressed genes to seem dissimilar while a different large outlier might cause dissimilar genes to look co-expressed. sometimes the outlying value is meaningful and important in which case the data should be included in the correlation. our flagging procedure lets the practitioner determine whether or not a flagged value should be removed.

the goal in our paper is to give a resistant correlation measure that can be used as a distance metric in any clustering or gene network algorithm which calls for some type of distance or similarity measure in order to identify the relationship between a pair of genes, across gene modules, or within a cluster of genes. tukey's biweight  <cit>  has been well established as a resistant measure of location and scale for multivariate data  <cit> . when considering  <dig> genes on n samples, the  <dig> ×  <dig> biweight covariance matrix that results from the biweight measurement of multivariate scale can be thought of as a resistant covariance between two genes . translating a  <dig> ×  <dig> biweight covariance matrix into a biweight correlation measure is simply a matter of taking the biweight covariance divided by the product of the individual gene biweight standard deviations  tukey's biweight is a type of m-estimate, a class of estimators which has been used in robust correlation estimates  m-estimates are consistent estimates of multivariate location and shape, so the biweight correlation is estimating the same parameter as the pearson correlation. we show that our robust correlation based on the biweight m-estimate is intuitive, flexible, and performs well under a variety of data distributions.

when considering the correlation between each pair of genes, we find that, although the biweight correlation and the pearson correlation usually agree, when they do not agree, there are often problems with the gene's  data which may indicate to the biologist that the gene should be removed from further study. our biweight correlation method provides two novel applications particularly suited to microarray analysis:  <dig>  we have created a similarity measure that is resistant to outlying data points , and  <dig>  by investigating gene pairs that have discrepant correlation values, we create a diagnostic procedure to identify values which may need to be flagged 

in the remainder of the paper, we provide details of the method and results. first, in section  <dig>  we discuss microarrays and their particular need for resistant measures. in section  <dig>  we explain tukey's biweight  we give our results in section  <dig>  showing that the biweight correlation can be used as a resistant similarity measure or a diagnostic procedure for flagging data. we then demonstrate, in section  <dig> , that our method is more efficient than spearman correlation  in section  <dig>  we show that the biweight correlation has empirically low bias and is superior to other robust measures. we conclude with some ideas of how to further develop our methods for other microarray applications.

 <dig>  why resistance is important in microarray analysis
microarray technology requires biologists and statisticians to work side by side in analyzing gene expression information. gene microarray chips measure, simultaneously, the expression levels of thousands of genes in an organism. comprehensive gene expression data is useful if one wishes to find clusters of genes with similar function. microarrays have been used to study the gene expression trends  in diseases and even to classify and diagnose different types of diseases, such as cancerous tumors  <cit> . for some organisms, microarrays enable biologists to monitor the entire genome of interest on a single chip in order to create a large picture of the interactions among thousands of genes simultaneously. a microarray is an orderly arrangement of spots that provides a medium for measuring known and unknown dna pieces  based on base-pairing rules. each microarray measures thousands of genes simultaneously, so resulting microarray data is typically on the order of thousands of genes by tens of samples.

although microarray technology has been very useful in discovering changes in gene expression, limitations of the technology have been observed: dye bias and relative gene expression levels having different sample variances due to differences in experimental conditions  <cit> ; differences due to laboratories and platforms  <cit> ; pixel saturation  <cit> ; low signal/noise ratio  <cit> ; and differences due to image analysis techniques  <cit> . researchers have worked to address the particular problems inherent in microarray analyses, but even after novel techniques  have been applied, microarray data remain noisy  <cit> .

some work has been done showing the need for resistant correlation metrics as similarity measures. in particular, heyer et al. give a jackknife correlation that is more resistant than the pearson correlation. however, as they state in their paper, the jackknife correlation is only resistant to single outliers  <cit> .

 <dig>  biweight as a resistant correlation measure
tukey's biweight has been used as a resistant estimator of location and scatter as well as a resistant estimator of regression parameters in a wide range of applications . the former approach has been used by affymetrix to normalize microarray data  <cit>  but not in applications of data distances.

m-estimators are a class of estimators of multi-dimensional location and scatter that provide for flexibility, efficiency, and resistance. the key to m-estimation is the ability of the estimator to down-weight points that are far from the data center with respect to the data scatter. because of the weighting, m-estimates are more resistant to outlying values than standard estimates  additionally, m-estimates use the actual data values in constructing location and scatter estimates and are therefore more efficient than estimators based on rank  m-estimators are defined iteratively using a weight function which down-weights data values that are far from the center of the data. we use the m-estimate of 2-dimensional scatter  to calculate a biweight correlation. details for the biweight are given in the appendix, and r code for the biweight is available from the corresponding author 

an important aspect of m-estimators is their resistance to outlying data values. one measure of the resistance of an estimator is its replacement breakdown, which is the smallest fraction of a data set that one could replace with corrupt data in such a way as to take the estimator over all bounds  <cit> . unlike the mean  or the median , the biweight is parameterized so that the breakdown can be adjusted over a range of values. adjusting the breakdown value will have implications in flagging data values .

the results of the biweight iteration scheme are a multivariate location estimate, t˜
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgubavgaacaaaa@2dec@, and shape estimate, s˜
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgtbwugaacaaaa@2dea@. letting s˜jl
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgzbwcgaacamaabaaaleaacqwgqbgacqwgsbabaeqaaaaa@3114@ be the th element of s˜
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgtbwugaacaaaa@2dea@, we can think of s˜jl
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgzbwcgaacamaabaaaleaacqwgqbgacqwgsbabaeqaaaaa@3114@ as a resistant estimate of cov   consequently,

 r˜jl=s˜jls˜jjs˜ll
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgybgcgaacamaabaaaleaacqwgqbgacqwgsbabaeqaaogaeyypa0zaasaaaeaacuwgzbwcgaacamaabaaaleaacqwgqbgacqwgsbabaeqaaagcbawaaoaaaeaacuwgzbwcgaacamaabaaaleaacqwgqbgacqwgqbgaaeqaaogafm4camnbagaadawgaawcbagaemibawmaemibawgabeaaaeqaaaaaaaa@3f8e@ 

is the biweight correlation between vectors j and l and is a more resistant estimate of correlation than the pearson correlation  because the components  are estimated using resistant techniques , we know the biweight correlation will be more resistant than the pearson correlation. note that |r˜jl
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgybgcgaacamaabaaaleaacqwgqbgacqwgsbabaeqaaaaa@3112@| ≤  <dig> 

using the biweight correlation  as a resistant estimate of the correlation measure, we can incorporate r˜
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgybgcgaacaaaa@2e28@ into clustering algorithms which depend on similarities or  <dig> - r˜
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgybgcgaacaaaa@2e28@ into clustering algorithms that depend on distances. in the next section we will demonstrate that the biweight correlation is clearly a better choice for a distance  measure than the pearson correlation .

 <dig> 
RESULTS
because our methods are most valuable when applied to noisy data, we applied our technique to a real microarray data set. the data set was chosen because it has been used widely in clustering applications  <cit>  as well as gene network applications  <cit> . the data are taken from an experiment on saccharomyces cerevisiae created to describe yeast genes with periodically varying transcript levels within the cell cycle  <cit> . the cell cycle data are based on a time course experiment, and so they are not independent and identically distributed  however, they are typical of many microarray data sets which are also not iid. the data are publicly available from the stanford microarray database   and include  <dig> samples on over  <dig> genes. we kept the default filters from smd, including using "log  of r/g normalized ratio " as our value of interest  transformation of the normalized ratio of the average red signal  and the average green signal .) typically, the red signal measures the amount of gene expression activity under an experimental condition, and the green signal measures the gene expression activity for a control. the value of interest is the relative expression measured by the ratio log <dig> . the only additional filtering we did was to eliminate genes that had more than ten missing values  note, also, that we have applied similar techniques to multiple other independent data sets, and the results are consistent across platforms , organisms, and normalization techniques 

 <dig>  biweight correlation as a resistant similarity measure
to demonstrate the difference between pearson correlation  and biweight correlation , we computed both correlations  on all 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqadaqaauaabeqaceaaaeaacqaixaqmcqaiwaamcqaiwaamcqaiwaamaeaacqaiyagmaaaacagloagaayzkaaaaaa@32ee@ pairs of genes from the top  <dig> most  <dig> variable genes  a scatterplot with all 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqadaqaauaabeqaceaaaeaacqaixaqmcqaiwaamcqaiwaamcqaiwaamaeaacqaiyagmaaaacagloagaayzkaaaaaa@32ee@ pairs of genes is given in figure  <dig>  the pc and bwc are highly positively correlated, with most of the correlations in relative agreement. however, in the corners and on the edges, we see numerous strong discrepancies between the pc and the bwc. a further investigation into those edge points gives clear evidence of why pc and bwc values differ.

before discussing the particular pairs of interest, we will break down the plot into four  groups:

 <dig>  gene pairs that give "consistent" pc and bwc

 <dig>  gene pairs that give "opposite" pc and bwc

 <dig>  gene pairs that give pc ≈  <dig> and large |bwc|

 <dig>  gene pairs that give large |pc| and bwc ≈ 0

we will discuss group  <dig> further in section  <dig> .

in groups 2– <dig>  the inability to consistently measure gene correlation can generate serious problems in clustering algorithms. we argue that for gene pairs in groups 2– <dig>  the bwc is a much better measure of distance than the pc.

consider points e, j, d, and k from figure  <dig> . for each pair of genes, there is an extreme outlying value causing the pc to be manipulated in the outlier's direction. the panel of plots in figure  <dig> shows the clear outlying values for each of the points in figure  <dig> identified as being in group  <dig> 

consider points i, a, b, and c from figure  <dig> . for each pair of genes, there appears to be an outlying point which is nullifying the existing  correlation. the panel of plots in figure  <dig> shows the existing correlation that has been calculated as low  because of the outlier.

consider points f, g, h, and l from figure  <dig> . for each pair of genes , there appears to be virtually no correlation though the pc calculates a strong correlation. the highly influential points in group  <dig> are those that we are most worried about. points in group  <dig> will show up as strongly co-expressed in either a cluster or a gene network and will give researchers misleading results. because of the high dimensionality of microarray data, already we often come across false positive results . using bwc instead of pc will help to reduce the number of false positives in any given application that are due to outlying values which produce misleadingly high pc.

 <dig>  using the biweight correlation to flag low quality data
our method of comparing pc and bwc can also be used as a data flagging method. for gene pairs that produce a relatively high correlation  and highly discrepant correlations across the two methods, we flag the gene pair for further investigation. note that we require the gene pair to yield a high correlation value , because we are not particularly interested in genes whose value flips, for example, from r =  <dig>  to r˜
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgybgcgaacaaaa@2e28@ = -  <dig> ; such a change will not have a strong impact in a clustering scheme because the similarity across the two genes is weak in both measures. we will flag points as outlying if

 <dig>  |r| >  <dig>  or |r˜
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgybgcgaacaaaa@2e28@| >  <dig> 

 <dig>  and |r - r˜
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgybgcgaacaaaa@2e28@| >  <dig> 

depending on how strict one wants to be at flagging possible outlying values, one may want to adjust the cutoffs in the above procedure. the quality of data will affect the size of the absolute difference |r - r˜
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgybgcgaacaaaa@2e28@|. therefore, if a data set has low quality , a resistant metric should be used and/or claims should only be made about genes for which the resistant and non-resistant metrics give similar results.

using the outlying flag procedure defined above, we identified  <dig> gene pairs  we can see that in the  <dig> pairs of genes, genes yol087c, ydr388w, and ygl157w were identified three times each. genes which get flagged as outlying when compared to multiple other genes are likely to have some poorly measured data or other outlying virtues. in order to find those genes which are repeatedly seen as outlying, we reduce the flag procedure to  <dig>  a single correlation being at least  <dig>  and  <dig>  a difference of at least  <dig> . we then identify  <dig> gene pairs  as possibly outlying. by tabulating the frequency of the  <dig> unique genes in the  <dig> plots of gene pairs, we are able to find genes which are repeatedly identified  the four most common gene outliers  all showed up in our more stringent outlier detection plot . these gene outliers could represent either noise or truly large values. follow-up experiments or other datasets would be needed to distinguish these two possibilities.

 <dig>  effect of breakdown in biweight correlation
as mentioned in section  <dig> , the breakdown controls the resistance of the estimator. for example, setting a breakdown at  <dig>  allows for up to 20% of the data values to be manipulated without being able to take the estimator across all bounds. naturally, the lower the breakdown, the less resistant the estimator. in our case, a breakdown of zero will give a bwc estimate almost equivalent to the pc  in a plot  of the pc vs. bwc at zero breakdown there are no points in the groups we had previously defined as  <dig>   <dig>  and  <dig>  conversely, the higher the breakdown, the more discrepant the pc and bwc will be  a higher breakdown will lead to flagging more genes as possibly low quality. depending on the noise level of the data, one may want to adjust the breakdown. ideally, the breakdown should be set only as high as the percentage of data which is outlying. a breakdown of  <dig>  gives a good balance between resistance and ability to make use of the bulk of the data in the estimation process. the breakdown value will have an effect on the correlation value that is used as a similarity measure. if the breakdown is not high enough, the metric will not be resistant. if the breakdown is too high, the technique will lose power. the effect of the similarity metric on a clustering or gene network will depend on the particular algorithm. however, if the similarities between two genes is estimated to be  <dig>  with the first measure and  <dig>  with the second measure , we would expect clustering algorithms to link the two genes with the first measure and not with the second  the effect of non-resistant similarity metrics on clustering results can be disastrous.

 <dig>  efficiency of the biweight correlation
we have demonstrated that the biweight correlation is effective as a resistant correlation as well as a tool for flagging low quality data  the spearman correlation, based on the ranks of the data, is also a resistant correlation technique. however, because the biweight incorporates the actual data values , the biweight correlation is more efficient than the spearman correlation. the efficiency of the biweight as a location and scale estimator has been well studied  <cit> . table  <dig> gives the efficiencies  for both the biweight and the spearman correlations. the efficiency is calculated from  <dig>  bivariate samples of a given size and correlation. the table values are each the ratio of the variance of the biweight  correlation across the  <dig>  samples versus the variance of the pearson correlation across the  <dig>  samples. particularly for high correlations , the biweight correlation is substantially more efficient than the spearman correlation.

additionally, in a plot of spearman vs. pearson correlations  for the yeast data, we see that the spearman and pearson correlations are more consistent with each other than the biweight versus pearson correlations were  for this noisy data. with clean data we would expect the pearson and biweight to be more consistent than the pearson and spearman. however, because the biweight is able to capture the large correlations that are seen as small with pearson, the biweight actually seems more different from the pearson than the spearman does. the efficiency of the biweight correlation helps us discover large correlations that the spearman correlation measure misses.

 <dig>  empirical consistency of biweight correlation under non-normal distributions
in order to assess the performance of the biweight correlation under different situations, we ran a series of simulations computing the empirical correlation for each of different true correlations, sample sizes, distributions, and correlation metrics. for a given true correlation, sample size, and distribution a pair of data were simulated; the empirical correlation was then calculated. in each of the simulations except the one-wild, the correlation structure was imposed after the data were simulated. for the one-wild distribution, the data were simulated with the appropriate correlation structure and then the wild observation was substituted randomly. the process was repeated  <dig>  times. the average of the  <dig>  simulations  are seen in tables  <dig>   <dig>  and  <dig>  three of the correlation metrics  have already been discussed. the fourth, the percentage bend correlation  <cit> , is an additional robust correlation metric based on m-estimation using huber's Ψ-function. the percentage bend correlation has an advantage over the spearman in that it uses the weighting of the m-estimation instead of just the ranks of the data, but it has a disadvantage over the biweight because the percentage bend is not iterative and can fail to be as resistant as the biweight.
at each sample size , correlation metric, and data distribution , the average correlation is reported  for  <dig>  random samples. the correlation metrics compared are pearson correlation, spearman correlation, percentage bend correlation, and biweight correlation at three different breakdown values. distributions compared are normal, lognormal , beta , slash , and one-wild . 
at each sample size , correlation metric, and data distribution , the average correlation is reported  for  <dig>  random samples. the correlation metrics compared are pearson correlation, spearman correlation, percentage bend correlation, and biweight correlation at three different breakdown values. distributions compared are normal, lognormal , beta , slash , and one-wild . 
at each sample size , correlation metric, and data distribution , the average correlation is reported  for  <dig>  random samples. the correlation metrics compared are pearson correlation, spearman correlation, percentage bend correlation, and biweight correlation at three different breakdown values. distributions compared are normal, lognormal , beta , slash , and one-wild . 
efficiency of biweight correlation  vs. spearman  correlation. all values are simulated variance of correlation of interest  divided by the variance of the pearson correlation. simulations are based on  <dig>  samples of standard normal bivariate data sets with the appropriate sample size and correlation.

the distributions of data are meant to cover a variety of situations. the lognormal data are skewed; the beta data have light tails. the slash distribution is created by dividing a standard normal deviate by an independent uniform  deviate and has much heavier tails than normal while being less pathological than the cauchy distribution. the one-wild distribution is a contaminated standard normal such that one value  is replaced with a random deviate from a uniform  distribution. from tables  <dig>   <dig>  and  <dig> we make the following observations:

• pearson correlation is seriously affected by heavy tails  and outliers 

• spearman and percentage bend correlations are quite resistant, but they tend to underperform the biweight .

• the biweight correlation performs well consistently across different distributions and sample sizes.

• though some efficiency is lost when the biweight is compared to the pearson, the improvement in performance for non-normal data is essential for applications to microarray data.

• the breakdown parameter alters the biweight correlation performance only slightly. as long as the breakdown percentage covers the amount of the contamination, the biweight correlation will have low bias and high efficiency.

 <dig>  convergence of the biweight
as described in section  <dig> , the biweight correlation is an iterative estimator. for a  sample size of  <dig>  it takes about  <dig> seconds to compute  <dig>  pairwise biweight correlations on a pentium  <dig>  3ghz computer with 2gb ram running windows xp  admittedly, the computation time is the shortcoming for the biweight correlation when computing all pairwise correlations across hundreds or thousands of genes. all simulations are done using r and would likely be considerably faster using a different programming language.

as mentioned in the appendix, the biweight correlation is computed by first finding an initial estimate of location and scatter. we have found that initializing the biweight using robust estimates of location and scatter of the median and mad  converge to the same biweight estimates as using the minimum covariance determinant  <cit>  location and scatter estimates  additionally, we have found  that running the iteration for 5– <dig> steps gives equivalent results . typically, for noisy data, the iteration scheme will take between 10– <dig> steps to converge fully. for a slash distribution with a sample of size  <dig>  it takes  <dig> seconds to compute  <dig>  pairwise biweight correlations which completely converge and  <dig> seconds when the iterations are capped at  <dig> 

 <dig> discussion
we have provided a novel resistant estimate of correlation based on a well-known multivariate location estimator of location and scale. tukey's biweight has been used as a resistant estimator in diverse contexts such as regression, analysis of variance, time series, and control charts to monitor product quality  <cit>  because of its resistance and efficiency properties. we have shown that the biweight is also a powerful technique to use when computing correlations between pairs of genes regardless of whether there is a significant amount of contamination or not.

additionally, the tuning parameters of the biweight allow for the estimates to be minimally or largely resistant to outlying values; the breakdown of the correlation  can be set to allow for a degree of resistance suitable for the analysis. we have found that setting our breakdown to  <dig>  works well in most situations.

not only does the biweight correlation give a resistant measure of correlation, but it also provides a data flagging method that  finds pairs of genes which give misleading pearson correlations, and  finds genes that, when compared to many other genes, consistently give misleading pearson correlations. the data flagging method can be used to improve the accuracy of secondary analyses  and to decrease the rate of false positives. the high dimensionality of microarray data produces a need for automated data cleaning, and we provide one way of examining the data for outlying values before analyses are performed.

because the biweight estimator is iterative, it is computationally more time intensive than either the pearson or the spearman correlation estimates. to save computation time, one might use the biweight as an initial estimate and an outlier detection method, and then progress to one of the other methods for analyses that require computing correlations multiple times in a row.

we have used microarray data to illustrate our methods. however, the methods can easily be applied to any data set, and they will be particularly useful for data sets where there is a large amount of noise and many distance pairs are being calculated. for example, we could use this method on other high throughput data like proteomic or metabolomic data. additionally, other disciplines with large data sets like astronomy and econometrics will also value a robust and systematic procedure for calculating distances. many supervised discrimination techniques use metrics/statistics which are similar to correlations. for example, fisher's linear discriminant analysis  is based on the mahalanobis squared distance. because the biweight is inherently a multivariate estimator, one could easily use the biweight to measure resistant mahalanobis squared distances to use in lda. additionally, popular methods like classification and regression trees  use regression models to partition samples into groups. biweight regression methods could also be used to make for more resistant partitioning in cart methods.

 <dig> 
CONCLUSIONS
tukey's biweight has been well established as a resistant estimation method in many fields. it has played a small role in the analyses of microarray data. however, the need for resistant methods in microarray data is great, and the biweight is a powerful tool that can provide improved methodology and results in many applications of microarray analyses. the methods shown here use tukey's biweight to give a robust and efficient estimate of distance between two genes on a microarray.

 <dig> availability
r code is available from the authors as well as in a supplementary file to this article.

 <dig> authors' contributions
jh conceived of the study, participated in its design and coordination, and wrote the manuscript. am, lh, and bvk contributed to writing the computer code, validating the method, and editing the manuscript.

 <dig> appendix
multivariate estimates of location and scatter given by constrained m-estimates are defined iteratively using a weight function, w , to down-weight data values that are far from the bulk of the data. using initial estimates of the location, t˜
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgubavgaacaaaa@2dec@, and shape, s˜
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgtbwugaacaaaa@2dea@, we calculate the distance of each point to the center of the data set,

 dj=′s˜−1
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgkbazdawgaawcbagaemoaaogabeaakiabg2da9maakaaabagaeiikagccbegae8hwag1aasbaasqaaiabdqgaqbqabagccqghsislcuwgubavgaacaiqbcmcapyaafagafm4uamlbagaadaahaawcbeqaaiabgkhitiabigdaxaaakiabcicaoiab=hfaynaabaaaleaacqwgqbgaaeqaaogaeyoei0iafmivaqlbagaacqggpaqkasqabaaaaa@4167@ 

for a given objective function, ρ , the constraint, parameterized by k,  is 

 n−1∑j=1nρ=bo
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgubgbdaahaawcbeqaaiabgkhitiabigdaxaaakmaaqahabaaccigae8xwdi3aaewaaeaadawcaaqaaiabdsgaknaabaaaleaacqwgqbgaaeqaaagcbagaem4aasgaaagaayjkaiaawmcaaawcbagaemoaaomaeyypa0jaegymaedabagaemoba4ganiabgghildgccqgh9aqpcqwgibgydawgaawcbagaem4ba8gabeaaaaa@42b2@ 

where bo = e  and n is the number of samples  and subsequently as below in equation , and k is found using equation  after bo and dj are determined.) bo is given as the product of the specified breakdown and the maximum value of ρ  <cit> . to find k, the expected value  is calculated under the assumption of multivariate normality . though we retain the convention, we do not presume to think that microarray data are normally distributed. the implication of an incorrect normality assumption will be a breakdown value slightly different from what we set. because our work does not focus on a particular breakdown value of interest , we are not bothered by a slight miscalculation of the breakdown value.

subject to the constraint in equation , the m-estimators of location and scale are given by the following iterative equations  <cit> 

 t˜=∑jw/k)xj∑jw/k)
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgubavgaacamaacaaaleqabagaeiikagiaemyaakmaey4kasiaegymaejaeiykakcaaogaeyypa0zaasaaaeaadaaeqaqaaiabdeha3jabcicaoiabdsgaknaadaaaleaacqwgqbgaaeaacqggoaakcqwgpbqacqggpaqkaagccqggvawlcqwgrbwadaahaawcbeqaaiabcicaoiabdmgapjabcmcapaaakiabcmcapgqabiab=hfaynaabaaaleaacqwgqbgaaeqaaaqaaiabdqgaqbqab0gaeyyeiuoaaoqaamaaqababagaem4dacnaeiikagiaemizaq2aa0baasqaaiabdqgaqbqaaiabcicaoiabdmgapjabcmcapaaakiabc+caviabdugarnaacaaaleqabagaeiikagiaemyaakmaeiykakcaaogaeiykakcaleaacqwgqbgaaeqaniabgghildaaaaaa@5aa7@ 

 s˜=∑jw/k)))′∑jv/k)
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgtbwugaacamaacaaaleqabagaeiikagiaemyaakmaey4kasiaegymaejaeiykakcaaogaeyypa0zaasaaaeaadaaeqaqaaiabdeha3jabcicaoiabdsgaknaadaaaleaacqwgqbgaaeaacqggoaakcqwgpbqacqggpaqkaagccqggvawlcqwgrbwadaahaawcbeqaaiabcicaoiabdmgapjabcmcapaaakiabcmcapiabcicaogqabiab=hfaynaabaaaleaacqwgqbgaaeqaaogaeyoei0iafmivaqlbagaadaahaawcbeqaaiabcicaoiabdmgapjabgucariabigdaxiabcmcapaaakiabcmcapiabcicaoiab=hfaynaabaaaleaacqwgqbgaaeqaaogaeyoei0iafmivaqlbagaadaahaawcbeqaaiabcicaoiabdmgapjabgucariabigdaxiabcmcapaaakiqbcmcapyaafaaaleaacqwgqbgaaeqaniabgghildaakeaadaaeqaqaaiabdaha2jabcicaoiabdsgaknaadaaaleaacqwgqbgaaeaacqggoaakcqwgpbqacqggpaqkaagccqggvawlcqwgrbwadaahaawcbeqaaiabcicaoiabdmgapjabcmcapaaakiabcmcapawcbagaemoaaogabeqdcqghris5aaaaaaa@6f76@ 

 dj=)′)−1)
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgkbazdaqhaawcbagaemoaaogabagaeiikagiaemyaakmaey4kasiaegymaejaeiykakcaaogaeyypa0zaaoaaaeaacqggoaakieqacqwfybawdawgaawcbagaemoaaogabeaakiabgkhitiqbdsfauzaaiawaawbaasqabeaacqggoaakcqwgpbqacqghrawkcqaixaqmcqggpaqkaagccuggpaqkgaqbaiabcicaoiqbdofatzaaiawaawbaasqabeaacqggoaakcqwgpbqacqghrawkcqaixaqmcqggpaqkaagccqggpaqkdaahaawcbeqaaiabgkhitiabigdaxaaakiabcicaoiab=hfaynaabaaaleaacqwgqbgaaeqaaogaeyoei0iafmivaqlbagaadaahaawcbeqaaiabcicaoiabdmgapjabgucariabigdaxiabcmcapaaakiabcmcapawcbeaaaaa@573b@ 

 to determine k, note that the value for k changes at each iteration) where xj is a gene of interest and

 ψ=∂ρ∂d
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfipqecqggoaakcqwgkbazcqggpaqkcqgh9aqpdawcaaqaaiabgkgi2kab=f8ayjabcicaoiabdsgakjabcmcapaqaaiabgkgi2kabdsgakbaaaaa@3b75@ 

 w=ψd
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg3bwdcqggoaakcqwgkbazcqggpaqkcqgh9aqpdawcaaqaaggaciab=h8a5jabcicaoiabdsgakjabcmcapaqaaiabdsgakbaaaaa@3865@ 

 v = d ψ 

the objective function for tukey's biweight  <cit>  is given by:

 ρ={c26|di|≤c16|di|>c
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfbpgccqggoaakcqwgkbazdawgaawcbagaemyaakgabeaakiabcmcapiabg2da9maaceqabaqbaeaabigaaaqaamaalaaabagaem4yam2aawbaasqabeaacqaiyagmaaaakeaacqai2agnaagaei4waslaegymaejaeyoei0iaeiikagiaegymaejaeyoei0yaaewaaeaadawcaaqaaiabdsgaknaabaaaleaacqwgpbqaaeqaaagcbagaem4yamgaaagaayjkaiaawmcaamaacaaaleqabagaegomaidaaogaeiykakyaawbaasqabeaacqaizawmaagccqggdbqxaeaadaabdaqaaiabdsgaknaabaaaleaacqwgpbqaaeqaaagccaglhwuaayjcsdgaeyizimqaem4yamgabawaasaaaeaacqaixaqmaeaacqai2agnaaaabawaaqwaaeaacqwgkbazdawgaawcbagaemyaakgabeaaaogaay5bslaawia7aiabg6da+iabdogajbaaaiaawuhaaaaa@5c20@ 

because e  is a function of c and the breakdown, we can use the newton-raphson method to find c using e  and the breakdown. for example, given a sample in dimension two , with a breakdown of  <dig> , c will be  <dig> .

the iterative scheme has the potential for the existence of multiple solutions, although multiple solutions essentially never happen in practice. after our iterative scheme has converged, we are left with a location vector and shape matrix. as seen in equation , the biweight correlation will be the biweight covariance divided by the product of the individual gene biweight standard deviations.

supplementary material
additional file 1
r-code for translated biweight. annotated r code for computing the translated biweight. includes both code and a worked example.

click here for file

  <dig> acknowledgements
we thank k. kafadar for sharing her profound knowledge on tukey's biweight; s. horvath for introducing us to the need for resistant correlations in the field of gene network analysis; and d.m. rocke for insightful conversations and help with r code of the biweight. funding for am, lh, and bvk was provided by a research experience for undergraduates grant from the national science foundation awarded to the claremont colleges.
