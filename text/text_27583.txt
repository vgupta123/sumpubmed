BACKGROUND
gene-set analysis  is a widely used category of bioinformatics methods and there are many available tools that perform gsa  <cit> . in gsa, genes known to contribute to a certain function, or share a relevant biological feature, are collected into sets. if these gene-sets are enriched by transcriptome or other high-throughput data, gsa directly highlights the most prominent among these sets, and thereby the underlying functions that are implicated by the data  <cit> . networks stand at the basis of complex biological systems  <cit>  and in many cases gene-sets represent elements that are connected, not simply because of gene overlap, but rather to exert a coordinated function through their interactions . examples of elements that can be used as gene-sets and where an interaction network can be defined include: transcription factors in a gene regulatory network  <cit> ; the hierarchical network of gene ontology terms  <cit> ; and metabolite gene-sets in a metabolic network  <cit> . in particular the last example provides a very useful case since metabolite gene-sets  are connected through reaction pathways, but will usually not share any common genes . thus, when several metabolite gene-sets in a pathway are significant their important biological connection will be lost, unless the gene-set interaction network is taken into account.

with this in mind, interpretation and visualization of the results from a gsa currently suffers from several limitations. typically, the results are presented as a list of the most significant gene-sets, or visualized in a heatmap where gene-sets are clustered according to either the pattern of significance across several conditions or their direction of regulation. in both cases, the biologically relevant connections between gene-sets, defined by their interaction network, are ignored. multiple connected significant gene-sets will likely represent an important biological process, but with the current visualization approaches these connections are lost and are tedious to elucidate manually.

on the other hand, it is not unusual to see gsa results presented as networks, with nodes representing the most significant gene-sets  <cit> . however, in these cases edges between nodes simply represent gene overlap. this can help to reduce the bias from redundant gene-sets by clustering gene-sets with overlapping gene content together. nevertheless, a network visualization approach where the edges represent gene-set interactions is advantageous in the context of biological interpretation. indeed, different tools can be used to visualize data on gene-set interaction networks  <cit> , although some of them are not specifically made for that purpose. unfortunately, these tools suffer from one or several of the following drawbacks:the tool is not made specifically to handle gsa data, which requires the user to tweak the input  in the best way possible to fit the framework of that tool.

the tool is only made for a specific type of network , constraining the user to only one single gene-set type.

the tool is not effectively reducing the network to highlight the significant results, but instead simply overlaying the data on the original, and potentially huge, gene-set interaction network.



here we address the current limitations by developing a new network-based visualization approach and implement it in the software tool kiwi. contrary to other available tools, kiwi explicitly embraces the paradigm that gene-sets can be biological entities that interact and it therefore aims at visualizing gsa results in the context of the gene-set interaction network in such way that the biological connections between all significant gene-sets become apparent. this is done by taking into account both the directionality and significance of the gene-sets and by removing non-interesting gene-sets from the visualized network. further on, kiwi is made as general as possible, in the sense that it accepts input from any gsa tool and any gene-set interaction network defined by the user. finally, since the biological measurements behind the data are made at the gene-level, kiwi enables the user to go from the visualization network of significant gene-sets back to the gene-level data, in order to detect driver genes behind the regulated biological elements that the gene-sets represent.

implementation
input data
the input to kiwi is at minimum the gene-set interaction network and a table of p-values for the gene-sets, which can be collected from the output of any gsa tool. apart from this, it is recommended to also supply the gene members of the gene-sets as well as the gene-level statistics  that were used as input to the gsa. full details and required format for the input files can be found in the online kiwi reference manual.

processing
an outline of the network visualization process performed by kiwi is shown in figure  <dig>  first, non-significant gene-sets are filtered out according to a user-set cutoff. the remaining gene-sets are used as nodes in a new visualization network. in this visualization network the edges between gene-sets should reflect how closely they interact. the shortest path length  measures the shortest distance between two gene-sets and is a property of the network that indicates whether the two gene-sets are interacting directly or indirectly via a certain number of intermediates. hence, the spl between all pair of nodes in the gene-set interaction network is calculated. if the spl between two gene-set nodes is below a user-set cutoff an edge is drawn between those nodes, with an edge thickness relative to the spl. the spl cutoff can be seen as a measure of the relatedness of two gene-sets in the gene-set interaction network, and it controls at what distance these gene-sets should not any longer be considered biologically connected. for each node, only the edge or edges with the lowest spl are kept, so that each node is connected only to its closest nodes of those present in the visualization network. finally, the visualization network is drawn using a force-based layout. nodes are resized to reflect the gene-set significance and color-coded to capture the general direction of change of the genes in the set .figure  <dig> 
overview of the kiwi workflow.  significant gene-sets are selected based on a user-set cutoff and used as nodes in the visualization network.  the shortest path length  between all node pairs in the gene-set interaction network is calculated. in the example, the spl between node a and b is  <dig>  and between node c and d is  <dig>  if the spl between two nodes is below a user-set cutoff , an edge is drawn between those nodes, with a thickness corresponding to the spl . in the example, the edges between nodes a and b, and c and d, respectively, are marked in red, corresponding to the spls shown in the gene-set interaction network.  to avoid a cluttered network with too many edges, only the best edges  are kept for each node. note that a node may still have multiple edges of different thickness if, for example, a thinner edge is the best one of a neighbouring node.   finally, the visualization network is drawn using a forced-based layout. nodes are resized according to the gene-set significance and color-coded in order to reflect the general direction of change of the gene-set.



output
kiwi produces two figures: a network and a heatmap. the network presents an uncluttered view where the most important features are highlighted. the node sizes and color-codes are adjusted according to the gene-set significance and general direction of change. the heatmap serves as a complement to the network by displaying the gene-level statistics for each gene-set in the network. the rows  and columns  are hierarchically clustered, which enables the identification of  gene-sets with similar gene content and  the significant genes that are driving the observed changes. both figures can be fine-tuned by the user through several parameters and the network can also be saved in graphml format and imported into cytoscape for further customization.

case studies
to illustrate the advantages of kiwi, we use two case studies. the first one is based on a differential gene expression dataset from lung adenocarcinoma vs. normal lung tissue  <cit> . metabolites from a human genome-scale metabolic model  <cit>  were used as gene-sets and the gsa was carried out using the bioconductor r-package piano  <cit> .

for the second case study we used gene expression data from a study on kras conditional activation in mouse xenograft tumors  <cit> . metabolites from a mouse genome-scale metabolic model, derived from the human genome-scale metabolic model used in case study  <dig>  using gene homology as described in  <cit> , were used as gene-sets. the gsa was carried out using the bioconductor r-package piano.

kiwi version  <dig> . <dig> was used for both case studies. the heatmaps and network plots shown in figure 2a,d and figure 3b,c are the direct output from kiwi, however, to provide as clear of a figure as possible, the node labels in the networks have been manually shifted. the data and scripts for running these case studies are available as additional file  <dig> figure  <dig> 
the output from kiwi in case study  <dig>  metabolic changes upon transformation to lung adenocarcinoma.  the kiwi network shows the significant gene-sets and their general direction of change. up-regulation: red, down-regulation: blue. two metabolically connected pathways emerge, a pattern that is not easily detected in  a traditional heatmap or  a gene-overlap network. green and orange indicate gene-sets of the two pathways, respectively.  the kiwi heatmap displays the individual gene-level statistics for each significant gene-set. it also clusters similar gene-sets based on gene overlap in order to identify driver genes or potential bias.
the output from kiwi in case study  <dig>  metabolic changes upon activation of kras in mouse tumors.  the significant gene-sets overlayed on the metabolite-metabolite network . as the network is too big and the gene-sets are too spread around the network it is not possible, in a simple way, to draw any biological conclusions about the data.  kiwi effectively reduces the gene-set interaction network and pulls out the significant gene-sets, while maintaining their biological relatedness given in the original network. here, kiwi outputs a network showing the steroid biosynthetic pathway, in line with the original study.  the heatmap for the gene-sets in the kiwi network shows that isopentenyl-ppp, 14-demethyllanosterol, squalene, and lanosterol are not overlapping in terms of gene members, yet they are connected in the kiwi network.



RESULTS
in order to show the advantages, in terms of biological interpretation, of using kiwi to visualize gsa results in the context of a gene-set interaction network, we performed two case studies. in both cases we used a genome-scale metabolic model to define a metabolite-metabolite network . a metabolite gene-set is defined by the group of genes that are associated with reactions in which the metabolite participates in.

metabolic changes associated with lung adenocarcinoma transformation
to illustrate the benefits of exploiting the gene-set interaction network, compared to only considering the gene overlap, we re-analysed a differential gene expression dataset from lung adenocarcinoma vs. normal lung tissue  <cit> . metabolites from the human genome-scale metabolic model hmr <dig>  <cit>  were used as gene-sets  and the gsa was carried out using the bioconductor r-package piano  <cit> , which produces files that can be directly imported by kiwi. the kiwi network  clearly identifies significant gene-sets composing two metabolically connected pathways. for example, 5-phosphoribosylamine and 1-pyrroline-5-carboxylate both participate in pyrimidine biosynthesis, but their relatedness becomes apparent if the underlying metabolic network that measures the mutual distance is considered. these important connections are lost when the results are presented as a traditional heatmap  or a network based on overlap of gene members of the different gene-sets . the kiwi heatmap  shows the gene-level transcriptional changes for each gene-set enabling the identification of interacting gene-sets without gene overlap, and their driver-genes. for example, 5-phosphoribosylamine is a significant gene-set because of gart and ppat up-regulation, while 1-pyrroline-5-carboxylate is significant due to lefty <dig> and pycr up-regulation. the heatmap also simplifies the detection of similar gene-sets, as e.g. nlc6cer and paragloboside.

metabolic changes associated with activation of oncogenic kras in mouse tumor xenografts
using a second case study we sought to test if kiwi is able to reproduce networks known to be informative in a certain condition. to this end, we re-analyzed gene expression data from a study where the oncoprotein kras was conditionally activated in mouse xenograft tumors  <cit> . the authors showed that activation of oncogenic kras entails extensive metabolic reprogramming, in particular up-regulation of steroid biosynthesis. we therefore performed gsa  <cit>  in the context of a mouse genome-scale metabolic network  and tested if kiwi could capture the relevant network of gene-sets upon kras activation. in line with the results in the aforementioned study, we observe the emergence of the steroid biosynthetic pathway, which is overexpressed in different steps . indeed, despite the fact that isopentenyl-ppp, 14-demethyllanosterol, squalene, and lanosterol are not overlapping gene-sets , kiwi relates the metabolites given their vicinity in the underlying mouse metabolic network. notably, contrary to the gene-set enrichment analysis used by the authors, kiwi also identifies which pathway among the different branches of steroid biosynthesis is truly up-regulated by kras activation, namely lanosterol synthesis.

CONCLUSIONS
kiwi is a new tool tailored for the visualization of gsa results in a gene-set interaction network context. as opposed to available tools, kiwi starts from the premise that gene-sets can be precise biological entities that achieve a certain function by means of their interactions, such as metabolites in a pathway. this paradigm significantly improves the interpretation of the effect of transcriptional regulation in a certain context, such as metabolism, because it adds an extra layer of information to the gsa results. as exemplified in the two case studies, such addition is fundamental to capture certain transcriptionally regulated processes. in the case of the transformation to lung adenocarcinoma, we observe that the up-regulation of pyrimidine biosynthesis is mediated by the connection provided by choloyl-coa. in the case of oncogenic kras activation in mouse tumors, not only do we reproduce the up-regulation of the steroid biosynthetic process, but we also report that this is ascribed mainly to the synthesis of lanosterol. in neither case could such results be highlighted by connecting gene-sets using gene overlap  or by overlaying the gsa results on the corresponding gene-set interaction network . in favour of a clean layout for enhanced interpretation, kiwi reduces the gene-set interaction network while maintaining and highlighting the important gene-set connections. it works with the output from any gsa tool and any collection of gene-sets that can be described as a network. for full usability, from raw data to final figure, it integrates seamlessly with the bioconductor r-package piano  and cytoscape . kiwi is available as a python package at http://www.sysbio.se/kiwi and an online tool in the biomet toolbox at http://www.biomet-toolbox.org  <cit> .

availability and requirements
project name: kiwi

project home page:www.sysbio.se/kiwi

operating system: platform independent

programming language: python

other requirements: kiwi depends on the following python packages: numpy > =  <dig> .0; matplotlib > =  <dig> .1; networkx > =  <dig> .1; mygene > =  <dig> .0; pandas > =  <dig> .1; scipy > =  <dig> . <dig> 

license: mit

any restrictions to use by non-academics: none

additional file
additional file 1: 
case study demo files.




leif väremo and francesco gatto contributed equally to this work.

competing interests

the authors declare that they have no competing interests.

authors’ contributions

lv and fg wrote the code and developed the software. lv drafted the manuscript. fg carried out the case studies and wrote corresponding parts of the manuscript. jn supervised the project. all authors read, edited and approved the final manuscript.

