BACKGROUND
mapping of loci controlling traits of interest in the malaria vector mosquito anopheles gambiae is dependent upon the availability of suitable genomic markers. quantitative trait locus  mapping analyses in an. gambiae have successfully employed polymorphic microsatellites  <cit>  – the utility of which can be readily predicted and verified – to study insecticide resistance  <cit> , plasmodium refractoriness and encapsulation  <cit>  or hybrid sterility  <cit> . however, microsatellites occur too infrequently in most genomes to permit fine scale mapping. by contrast, single nucleotide polymorphisms  are usually abundant; but extensive discovery and validation work is required before their application. this has represented a major obstacle to the development of association mapping approaches in an. gambiae.

the release of the complete genome sequence of the pest strain of an. gambiae in  <dig>  <cit>  provided significant information on polymorphism, with nearly  <dig>  snps reported. however, the pest strain is a cross between two molecular forms : a long-term m-form laboratory strain originating from nigeria and field-collected s-forms from western kenya, crossed with additional kenyan s-forms. as such, the snps identified in the pest sequence are expected to be biased towards those that segregate between the m and s molecular forms, rather than snps likely to be polymorphic within and among natural populations. in addition, snps are at relatively low frequency in the pest genome  and have an uneven distribution across the genome, resulting in a paucity of snps in many chromosomal divisions . to date, published resequencing studies in an. gambiae have validated some of the pest genome snps, uncovered additional snps, and provided additional information on polymorphism levels, but have been of small scale and/or focussed primarily on genes involved in immunity  <cit> .

we are interested in the factors controlling resistance to insecticides in an. gambiae. gene expression studies using the an. gambiae detox-chip  <cit>  – a microarray for the study of genes putatively involved in insecticide metabolism – have identified loci overexpressed in insecticide resistant strains  <cit> . however, gene expression studies are unable to detect resistance arising from allelic variants, or to locate the regulatory elements underpinning gene expression. association mapping has the power to detect such variants and therefore represents a powerful complementary approach. in its current form  the an. gambiae detox chip  <cit>  has probes for  <dig> genes including cytochrome p <dig> monooxygenases, glutathione-s-transferases and carboxy/cholinesterases, plus members of other gene families potentially involved in detoxification processes , and housekeeping loci which serve as controls.

the primary aim of our study was to resequence the suite of genes present on the detox chip microarray to provide data for development of a highly multiplexed snp array for association mapping of insecticide resistance in an. gambiae. our resequencing used pooled genomic dna  as template, and we also evaluate the performance of the pooling technique with respect to accuracy in allele frequency detection and type i and ii error rates for snp discovery. snps to be screened in highly multiplexed approaches, such as the illumina goldengate assay  <cit>  and affymetrix genechip assay  <cit> , must not only be identified, validated and exhibit suitable levels of polymorphism, but must also be flanked by sequences free of additional polymorphisms that may interfere with the assay. therefore, the other major aim of our study was to gain insight into the distribution of snps in the an. gambiae genome, and how this impacts the design of highly-multiplexed arrays. information on all snps discovered in the present study are freely available in public access databases.

methods
samples
in order to incorporate high diversity and reduce sequencing time and costs, two pools of gdnas were created from an. gambiae m- and s-forms of diverse geographical origin. the m pool consisted of samples from odumasy, coastal ghana , bonia, northern ghana  and koubri, southern burkina faso  and the s pool consisted of samples from odumasy, ghana , mampong, central ghana , asembo bay, kenya  and thyolo, malawi . dna from each sample was extracted using the ballinger-crabtree method  <cit>  and molecular form  determined with the method of fanello et al.  <cit> . the 2la+/2la inversion kayotype was determined using the pcr diagnostic developed by white et al.  <dig>  <cit> . frequencies in the pools were m-pool:  <dig> / <dig>  2la+/2la; and s-pool:  <dig> / <dig>  2la+/2la. following determination of dna concentrations using picogreen  <cit> , pools containing equimolar amounts of dna from each contributing sample were created and used for pcr.

pcr and sequencing of pooled samples
target loci were primarily selected to be coincident with the genes on the an. gambiae detox chip  <cit>  with additional loci sequenced to cover the paracentric inversion polymorphisms on chromosomes 2l and 2r  <cit> , which might aid future identification of inversion karyotypes from the linkage disequilibrium in these regions. details of genes studied are given in additional file  <dig>  primers were designed to generate amplicons of approximately  <dig> bp using primer <dig>  <cit>  and checked for unique binding to the vectorbase-ensembl agamp <dig> genome sequence using blast. our strategy was to amplify genic regions plus flanking regions approximately  <dig> kbp up- and down-stream in an attempt to capture variation potentially associated with nearby cis regulatory elements. where genes were >  <dig> kbp in length, primers were designed to amplify regions approximately every  <dig> kbp. in total,  <dig> primer pairs were designed . reactions were optimised to yield a single product, which was sequenced in both forward and reverse directions, using the amplicon-specific primers, by macrogen .

sequence traces were aligned with codoncode aligner  traces, or portions thereof, with low phred quality scores were automatically discarded. nucleotide positions exhibiting polymorphism within or between template dna pools, were identified with the aid of the mutation detection tool in codoncode aligner, and through manual inspection of all sequencing traces. we assigned a confidence score to each snp identified:  <dig> = a snp is identified with full confidence, being clearly apparent in both forward and reverse sequencing traces;  <dig> = a snp is identified with confidence but with the caveat that only unidirectional sequence is available;  <dig> = a snp is observed but with some cause for doubt, e.g. only unidirectional sequence with a relatively high background signal is available. since sequencing was undertaken on pcr products of pooled dnas, estimates of snp frequency were based on a visual estimate of relative peak height in ambiguous positions.

all snps have been submitted to dbsnp .

validation of the pooling approach
sequencing of the individual samples used to make up the pooled dna was undertaken for thirteen amplicons , cyp6m1_2). although some of these loci were chosen on the basis of biological interest, the only other criterion was that primers generated single, strong pcr amplicons. thus, the loci should comprise a representative sample of our pooled sequences. individual dna samples were amplified using the identical primers to those used on pooled dna templates. as before, individual sequences were aligned with codoncode aligner and mutations identified using the codoncode aligner mutation detection tool, with all calls checked by manual inspection. snp frequency from individual dnas was calculated and compared to the snp frequency estimates obtained via sequencing of pooled dna samples. in addition, to investigate how polymorphism in the mixed-template pools corresponded with polymorphism in natural populations, we also sequenced two pools  of field collected specimens from a single southern ghanaian population  and two pools  from cameroon  using the same  <dig> primer pairs. data from the two pools of n =  <dig> were combined for analysis.

data analysis
variability was calculated as the number of segregating sites  and the nucleotide diversity . although allele frequencies were determined through pooling, π can be estimated  <cit>  following li  <cit> . we adjusted our segregating site frequency  and nucleotide diversity figures to account for the false positive  and false negative rates  identified through comparison of individual and pooled sequences ; π = πestimated/). variability was determined across the total dataset, and was also analysed following subdivision into five categories of loci: cytochrome p <dig> mono-oxygenases; glutathione-s-transferases; carboxy/cholinesterases; other detoxification loci; and other loci with no known detoxification function. bootstrapped confidence limits of s were calculated using the poptools add-in for microsoft excel  <cit> . in order to estimate whether snps were distributed evenly across the regions sequenced, gap distances  were calculated for  <dig> snps . each value  was then compared to the average gap distance for the whole sequence, yielding a count of gaps lower and higher than the average in each sequence; measures which are independent of snp frequency. the null hypothesis of symmetry in the distribution of gaps around the average of each sequence was examined using a sign test in spss  <dig> , performed across all sequences.

design of illumina goldengate assay
all snps identified were submitted to the illumina assay design tool  to determine their suitability for genotyping with the goldengate assay. the adt assesses whether an illumina assay can be used to interrogate the snp, checking for duplicated regions, snps in flanking sequence, and whether probe melting temperatures are within assay limits.

RESULTS
evaluation of the pooling approach
overall, there was a good correlation between snp frequencies estimated from pooled and individual data . the rate of false positives, i.e. snps identified through sequencing of pooled templates that were not confirmed by sequencing of individual samples, was low at  <dig> %. sequencing of pooled dna generated a high rate of false negatives, with 30% of snps identified by individual template sequencing missed, but the median frequency of these snps was low . across sequences the majority of correlations between individual and pooled allele frequency estimates were consistently high and well predicted by confidence scores . however, several relatively poor correlations are evident , which were either impacted by high indel frequencies  or were of marginal sequence quality . similarly, mean confidence scores showed significant predictive value for false negative rates . perhaps most strikingly, false positive rates differed dramatically among confidence score classes with a  <dig> % rate for confidence score  <dig>  and a  <dig> % rate for confidence score  <dig>  but a  <dig> % false positive rate for confidence score  <dig> . clearly, therefore, snps assigned a confidence score of  <dig> should be avoided as target markers unless additional evidence of polymorphism is available.

relationship between polymorphism in m and s pools and single population samples
allele frequencies estimated from the diverse s-form pool correlated well with those in pools of samples from a single population collection of s-form samples from ghana  and moderately well with those in a pool of m-form samples collected from a single population in cameroon . allele frequencies in the diverse m-form pool were moderately correlated with those in the cameroon single population pool , and only weakly related to those in the ghanaian single population pool . correlations between the allele frequencies obtained from sequencing individuals comprising the m and s-pools and the cameroon and ghanaian pools were similar to those obtained when comparing pooled estimates. thus snps identified in the diverse s-form pool could be of greater general utility than those in the diverse m-form pool, though those present in both m- and s-form pools are likely to be of most widespread value.

properties and frequency of segregating sites
in total, sequencing was undertaken successfully on  <dig> loci , comprising  <dig>  bp. other pcr reactions failed to optimise, gave unusable sequence or were affected by multiple indel events which prevented analysis. sequencing of geographically diverse pools of m  and s  individuals revealed a total of  <dig> polymorphic features. sixty-seven  were indels, of which we could not determine the exact position for  <dig>  additional indels were inferred from rapid reductions in quality of sequencing traces, but neither the causative polymorphism nor its exact position could be determined. these are not included in the polymorphic feature count and thus we will have underestimated the true indel frequency. the remaining  <dig> polymorphic features were snps.  <dig> of the  <dig> features  already have dbsnp numbers from sequencing of the pest strain, whereas  <dig> are novel. sixty-seven triallelic and three tetrallelic snps were identified directly from sequencing traces. an additional  <dig> snps were inferred to be triallelic through discrepancies between the nucleotide variation we identified and that identified at the same snp position via sequencing of the pest strain. thus, we estimate that approximately 1% of all snps are multiallelic.

a polymorphic feature was found approximately every  <dig> bp , although lower frequencies of segregating sites were observed on the x chromosome and around centromeres . nucleotide diversity was similar in the m  and s pools  but there was significant variation among gene classes  with the cytochrome p450s and carboxylesterases much more polymorphic than other classes . of the  <dig> polymorphisms,  <dig>  were found to differentiate the m and s- form pools. whilst it would be unwise to regard these as fixed m- vs s-form differences because of the small sample sizes involved, it is interesting to note that many of these snps are located within the 'islands of speciation'  <cit>  on chromosomes 2l, x and 2r.

snp distribution
by comparing the distribution of gap lengths  to the average for each sequence we found that 60% of gap sizes fell below the average, with little variation among the locus classes . the distribution of gap widths was significantly less symmetric about the averages than expected by chance , indicating significant clustering of snps, with many exhibiting very small gap distances . thus, snps are clustered but not in a locus-type specific way, suggesting that, in contrast to snp frequency, snp clustering is a general feature of the genome, rather than being confined to certain gene families.

illumina goldengate assay design
to determine if the snps could be used for association mapping studies on the illumina goldengate platform we used illumina's assay design tool  algorithm . results are summarised in figure  <dig>  only 4% of all snps met the highest quality criteria for design recommended by illumina: well validated  and an adt score of ≥  <dig> . however, 23% of snps were considered suitable for assay design with adt scores ≥  <dig>  and confidence scores of  <dig> or  <dig>  since false positive rates for confidence score  <dig> are reasonably low . adt scores between  <dig>  and  <dig>  were less favoured but such snps may be used for design : 38% of snps with a confidence score  <dig> or  <dig> had an adt score of ≥  <dig> . illumina recommends that snps to be targeted in the goldengate assay should have a minimum of  <dig> bases of flanking sequence free of polymorphism on each side: the high and clustered nature of polymorphisms meant that only 5% of our snps fulfilled this criterion. nevertheless, it is interesting to note that, some flexibility in placement of one of the probes  in the assay design clearly permits many more acceptable assays to be designed than predicted by this strict  <dig> bp per flank criterion.

discussion
the development and application of high-throughput genotyping methodologies for the malaria mosquito anopheles gambiae depends upon the identification of snp markers. we have resequenced approximately  <dig> % of the an. gambiae genome in geographically diverse pools of an. gambiae m- and s-forms, identifying  <dig>  snps and  <dig> indels that could be mapped, and  <dig> indels that could not be precisely mapped . of the snps we identified, only 10% had been identified previously from sequencing of the pest strain genome. this suggests that the sequencing of this strain has dramatically underestimated the true snp frequency in an. gambiae. similarly, morlais et al., in sequencing of  <dig> lab strains , found  <dig> snps in  <dig> loci   <cit> . only 39% of these snps had been predicted by ensembl 

by sequencing the gdna of pooled individuals we substantially reduced the cost of the resequencing programme. through comparison of allele frequencies estimated from pooled dnas with those obtained from sequencing of individual templates it is apparent that pooling of template dnas yields relatively accurate allele frequency estimates and a very low rate of false positives. many low frequency snps that were identified through sequencing of individual dna samples were missed in the sequencing of pooled templates. however, since low frequency snps perform poorly in detection of linkage disequilibrium  <cit>  this is unlikely to be problematical when identifying snps suitable for use in association mapping studies. though essentially qualitative, our snp confidence scores proved valuable predictors of false positive rates, and should be considered when choosing from the snps we have identified, noting that snps with category  <dig> confidence scores are much less likely to be truly polymorphic than those with confidence scores  <dig> and  <dig>  in summary, pooling of gdna templates provided a useful technique in permitting analysis of polymorphism at a large number of genes in a total of  <dig> individuals , at one tenth of the cost of individual sequencing. if cost-reduction is not a major consideration and/or if detection of low frequency polymorphisms is a primary concern, sequencing of individual templates or the use of a next generation technology, such as  <dig> pyrosequencing , with pooled pcr products would be a preferred approach.

nucleotide diversity estimates in our study are comparable to those obtained in other studies of an. gambiae  <cit>  or other mosquitoes  <cit>  , particularly those employing similar sample sizes  <cit> . indeed, the only study recording much lower diversity  <cit>  involves either extremely low sample sizes or loci in a known area of low recombination . it is interesting to note that we observed the same pattern as cohuet et al.  <cit>  with respect to x-chromosome diversity: even allowing for smaller effective population size  of the x chromosome than the autosomes, nucleotide diversity is low. however, we did not observe the dramatically lower diversity in x chromosome divisions  <dig> and  <dig>  than divisions 1– <dig> reported by stump et al.  <cit> . we suspect that the greater degree of mixing of distinct populations in our study might reconcile these findings, since slowly recombining regions will tend toward loss of diversity within, and increased differentiation among, populations. mixing of populations will thus have a proportionately greater impact in such a genomic area since differentiation will inflate measures of diversity.

1recently colonised from field without dramatic bottleneck  <cit> ; 2centromeric x-chromosome loci; 3average n across loci; 4single pool of dna:  corrected for elevated type ii error rate.

polymorphism estimates based upon nucleotide diversity are less informative than the frequency of segregating sites for the design of high-throughput assays where variable bases close to the snp of interest can affect assay design and therefore should be avoided. on average we find a segregating site every  <dig> bp, a figure which compares favourably with previous estimates from mosquitoes. apart from the aforementioned exceptional figures associated with centromeres or a small sample, the range of estimates for segregating site frequency for the studies cited in table  <dig> are  <dig> snp per  <dig> to  <dig> snp per  <dig> bases. the problems for assay design resulting from this high snp frequency will frequently be exacerbated because snps show a clustered distribution. unrecognised non-target snps in probe-binding sites can appear as null alleles in illumina analyses  <cit> . whilst their effects on the use of affymetrix genechips for genotyping are unknown, non-target snps are detrimental to gene expression profiling on this platform  <cit> ; it is reasonable to assume they may also negatively affect genotyping accuracy. in addition to the impact of high snp density, the effect of multiallelic snps must also be recognised for probe design. multiallelic snps will also pose difficulties for genotyping with multiplex genotyping platforms as null alleles will be scored. although null alleles can be recognised with some platforms, and controlled for  <cit> , they could be problematical where not anticipated.

goldengate assays have, to date, been successfully applied to a variety of species, including humans, honey bee  <cit> , cattle  <cit> , spruce  <cit> , soybean  <cit>  and barley  <cit> . conversion rates of assays have been consistently high for these species, indicating that secondary polymorphisms or unrecognised multiallelic snps have not had a major impact on study success. however, all of these species either exhibit low polymorphism or studies were undertaken on inbred lines. for example, in the human genome, snps occur on average at  <dig> bp intervals . therefore, the high snp frequency in anopheles, and the coincident effect on goldengate assay design, is a far more significant problem than for previous studies. indeed, according to illumina's assay design tool, the majority of snps were unsuitable for goldengate assay probe design.

the anopheles/plasmodium affymetrix genechip, which was designed for gene expression studies, rather than as a genotyping tool, has been used to study the degree of differentiation between the m and s forms  <cit> . since the probe length for this assay is shorter  than in the illumina goldengate assay, the high snp frequency may be less problematical. however, since the array was not designed specifically for genotyping it is difficult to assess the inherent difficulties posed by the high diversity and clustering in anopheles for this assay. although quantitative extrapolation of our array design experience with illumina to other platforms is difficult, it seems clear that for anopheles, and probably other mosquitoes or species with high rates of genomic diversity, high throughput snp-typing will be negatively impacted, through loss of snps at the design stage and/or loss of data due to null alleles at the analysis stage. whilst somewhat speculative, it also seems likely that confident assembly of short-read fragments into contigs or onto the template of an existing genome assembly in massively parallel sequencing runs  <cit>  will be rendered difficult if multiple snps are present in many fragments. hopefully, a more comprehensive database of segregating sites in an. gambiae might ameliorate this problem.

in the present dataset, snp frequencies varied both physically and according to their location within or near gene classes. as reported elsewhere  <cit>  and predicted by lowered recombination rates within the regions, diversity was lower toward the centromeres of autosomes and on the x chromosome. diversity was significantly elevated in loci of the cytochrome p <dig> mono-oxygenase and carboxy/cholinesterase  families than in the glutathione-s-transferases and control loci, with a segregating site every  <dig> bp in the p450s and coes compared with every  <dig> bp overall. this higher snp frequency is likely to exacerbate the problems for assay design in these gene families, especially given the significant snp clustering in this genome. high rates of variability in human p450s have been reported  <cit>  but higher rates of polymorphism in mosquito p450s or coes have not been previously identified.

a higher rate of insertion of transposable elements in xenobiotic-metabolising p450s of drosophila  result in high rates of mutability of p450s  <cit>  indicating that the function of such p450s is more tolerant of polymorphism. also in drosophila, enzymes involved in xenobiotic metabolism exhibit a higher nonsynonymous: synonymous  ratio than the average over the dataset . the higher levels of dn/ds for xenobiotic enzymes may indicate that the higher polymorphism levels seen in p450s and coes reflects less stringent selection at these loci than others, perhaps because of flexibility in function among closely-related gene family members.

the high diversity in an. gambiae is likely related to large effective population size . nucleotide diversity is a product of mutation rate and ne and the highest recorded levels of polymorphism, for the urochordate ciona savignyi, are thought to be due to its high ne  <cit> . the estimates of ne available for an. gambiae suggest levels of ne equal to a few thousand  <cit> . however, ne is notoriously difficult to estimate accurately, particularly for species exhibiting often limited genetic population structure over wide geographic scales, such as an. gambiae. improved ne estimates would help elucidate the role of ne in explaining the high nucleotide diversity that we, and other authors, have observed.

in drosophila spp. recombination rates are positively correlated with nucleotide diversity  <cit> , especially at a fine-scale  <cit> , although the relative roles of selection and mutation generated by recombination in underpinning the pattern are controversial  <cit> . in an. gambiae, the first major study to estimate recombination rate indicated a small recombination map length of  <dig> cm over the  <dig> mb genome, or  <dig>  cm/mb  <cit> . this is lower than typical average figures of 1– <dig> cm/mb for most organisms and far less than the  <dig> cm/mb recorded in the honey bee  <cit> . thus, broad-scale recombination estimates in an. gambiae do not support a relationship between diversity and recombination rate. however, more recently, a survey of recombination rate along the x-chromosome, recorded an overall average recombination rate of  <dig> cm/mb, but with dramatic variation in local rates between  <dig>  and  <dig> cm/mb  <cit>  dependent on chromosome position. thus a link between sporadically high recombination rates – perhaps involving recombination hotspots – and high, clustered diversity could apply in an. gambiae. fine-scale estimates of recombination rate are now required to permit investigation of how the interplay between recombination and selection determines diversity.

CONCLUSIONS
by sequencing pooled template dna, we have identified nearly  <dig> snps in anopheles gambiae, primarily in or around detoxification-related genes. snp frequencies varied among gene families, being particularly high in members of the p <dig> monooxygenase and carboxyl/cholinesterase enzyme superfamilies. the snps identified represent a valuable resource for mapping studies, but a high snp frequency and clustered distribution in an. gambiae, which may be general features of mosquito genomes, present a significant challenge for the design of genotyping arrays.

authors' contributions
csw designed pcr assays, performed sequence alignments, analysed the data and wrote the manuscript. dw designed pcr assays, performed sequence alignments, analysed the data and co-wrote the manuscript. ks carried out molecular laboratory work. mjd participated in the design and coordination of the study and contributed to the manuscript. all authors read and approved the manuscript.

supplementary material
additional file 1
loci studied and snps identified

click here for file

 acknowledgements
we thank alexander egyir-yawson  who originally collected most of the samples we sequenced. we are also grateful to three anonymous reviewers for their constructive criticism of the manuscript. this work was supported by the innovative vector control consortium .
