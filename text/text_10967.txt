BACKGROUND
protein conformational dynamics are directly linked to protein functions  <cit> . they are sensitive to environmental changes, point mutations, ligand binding and post-translational biochemical modifications . atomistic molecular simulation is a method of choice to explore a protein’s conformational space. it has become increasingly popular with the recent advances in computational power, force field accuracy and sampling algorithm development  <cit> . the accumulation of molecular dynamics  data calls for the development of methods able to extract pertinent biological information and visualise it in a comprehensive way.

the representation of a protein as a graph unravels more easily and readily its properties at the atomic or residue level. typically, each node of the graph represents one residue of the protein and the edges represent non-covalent interactions that stabilise the protein three-dimensional structure  <cit> . information about the dynamical behaviour of the protein can also be integrated in several ways. for example, the edges can be constructed and weighted based on the persistence values of the interactions computed over a conformational ensemble instead of their presence/absence in a static structure  <cit> . other types of dynamic properties can be taken into consideration, such as dynamical correlations between residues . alternatively, every conformation of a md trajectory can be represented by a contact graph and the evolution of the graphs can be analysed over time to detect important structure-changing events  <cit> .

communication between residues results in allosteric coupling, i.e. the propagation of a perturbation signal between distinct sites, possibly located far away in the sequence and structure of the protein, that modulates the function of the protein. experimental evidence have demonstrated that protein residues communicate either through stable non-covalent interactions  <cit>  or via changes in their local atomic fluctuations  <cit> . previous methodological efforts were engaged by us and others toward the identification of clusters or chains of residues mediating long-range communication in proteins . in particular, the method moneta  <cit>  proved useful to identify communication routes in allosterically regulated proteins and to guide in silico mutagenesis  <cit> . moneta is intended to assist the analysis of md simulation data in a manually-guided way. it enables to focus on specific protein regions or residues provided that the user has some prior knowledge of the system. fixed values are encoded in the tool for most of the parameters, which limits its applicability and flexibility.

the present work builds up on these previous efforts to propose a systematic dissection of protein architectures from a dynamical perspective. we provide communication mapping , a method for analysing molecular dynamics-based communication in proteins and for mapping this information onto protein three-dimensional structures. comma introduces new measures and new algorithms, with respect to moneta, to dissect a protein’s architecture building blocks. it integrates different types of structural and dynamical information in a unified graph representing the protein. it detects communication blocks and communicating segments pairs from this graph, which are new concepts representing groups of residues or protein regions that mediate short- and long-range communication. comma allows to compare in a very straightforward way the conformational dynamics of different proteins or different states of the same protein. it provides mechanistic insights on the effects of deleterious mutations on the stability and internal dynamics of proteins by pinpointing residues playing key roles in the propagation of these effects. comma is fully automated and is intended for large-scale application. it only requires an ensemble of protein conformations as input. importantly, we have implemented an automated procedure to set all parameters depending on the properties of the protein analysed. here, we have applied comma on three case studies to illustrate its capabilities.

methods
comma workflow
the workflow of the comma method is depicted on fig.  <dig>  comma requires as input a conformational ensemble representing the protein of interest. typically, the method is intended to analyse all-atom md trajectories, but it is not restricted to this type of data. the analysis can also be performed on conformations obtained from another sampling method or on experimentally determined structures. the order of the input conformations does not influence the results. the ensemble can be divided into several sets, for example corresponding to several replicates of an md simulation. comma can handle most popular md trajectory file formats . comma algorithm proceeds as follows: 
a. it analyses the conformational ensemble and extracts five residue-based dynamic properties: local dynamical correlations, minimum distances, communication propensities, non-covalent interaction strengths and secondary structures .
fig.  <dig> schematic representation of comma workflow. starting from one or several md trajectories, comma computes matrices of residue-based dynamic properties: local dynamical correlations , minimum distances , communication propensities , non-covalent interaction strengths  and secondary structures . local dynamical correlations and minimum distances are used to identify independent cliques while communication propensities, non-covalent interaction strengths and secondary structures are used for communication pathway detection. a coloured graph, called protein communication network , is constructed from independent cliques  and communication pathways . the graph is analysed and two groups of communication blocks are extracted. the first group is made of clique-based blocks , and the second group is made of pathway-based blocks  where pathways have bounded length. in the schema, three different pathway-based blocks are displayed, corresponding to a minimal path length of  <dig> ,  <dig>  and  <dig>  respectively. communication pathways are also used to detect pairs of communicating segments, which are portions of secondary structure elements. residues belonging to pathways that cross two secondary structures are coloured. for each pair of segments, the communication strength of the interaction is evaluated, on a scale of strengths going from low  to strong  strength. the segments and their interaction strength between h1-h <dig>  h1-h <dig> and h2-h <dig> helices are shown



b. these properties are used to group residues into  independent cliques and  communication pathways . independent cliques are clusters of residues that display concerted atomic fluctuations while communication pathways are non-covalent chains of residues that move together .

c. the information obtained from the independent cliques and the communication pathways is integrated in a graph, called protein communication network  .

d. connected components are extracted from this graph to define protein communication blocks .

e. the communication pathways that link different secondary structure elements are used to define communicating segment pairs and measure the strength of the interaction .



comma allows to visualise communication blocks and communicating segment pairs by mapping them onto the protein average conformation.

step a. extraction of dynamic properties
comma defines several measures that reflect the dynamic properties of the query protein. these measures are computed from each input set of conformations. four measures are defined for pairs of residues and provide  <dig> distinct matrices. a fifth measure, which is new compared to moneta, evaluates the likeliness of a residue to belong to a secondary structure.

local dynamical correlations principal component analysis  is used to describe the atomic fluctuations of a protein through eigenvectors or modes. these modes are linear combinations of degrees of freedom. starting from n pca modes, describing the protein’s essential dynamics , we apply a statistical technique called local feature analysis   <cit> . lfa computes residual correlations corrlfa between residues i an j as: 
  corrlfa=∑d=13∑r=1nΨrΨr 

where d is the -coordinate index of each c α atom in a residue and Ψr is the pca rth eigenvector. the corrlfa matrix is characterised by sparse correlation patterns . the lfa formalism identifies a set of nseed residues that are highly fluctuating and representative of these correlation patterns.

minimum distances the minimum distance dijmin between two residues i and j is defined as the smallest distance between any pair of atoms  belonging to residues i and j respectively, averaged over the set of conformations.

communication propensities we evaluate the communication propensity cp of residues i and j as the variance of the inter-residue distance  <cit> : 
  cp=<2> 

where dij is the distance between the c α atoms of residues i and j and dij¯ is the mean value computed over the set of conformations. intuitively, the smaller the variance, the more efficient the communication. consequently, small values of cp are indicative of efficient signal transmission between residues i and j.

non-covalent interaction strengths we consider as non-covalent interactions hydrogen-bonds and hydrophobic contacts, detected using the hbplus algorithm  <cit> . h-bonds are detected between donor  and acceptor  atoms that satisfy the following geometric criteria:  maximum distances of  <dig> Å for d-a and  <dig> Å for h-a,  minimum value of 90° for d-h-a, h-a-aa and d-a-aa angles, where aa is the acceptor antecedent. hydrophobic contacts are identified with an inter-atomic distance lower than  <dig> Å. the detected non-covalent interactions are then classified as backbone-backbone, backbone-side chain and side chain-side chain. for a given interaction type, an interaction strength matrix int is computed, where each entry  describes the percentage of conformations in which at least one non-covalent interaction is formed between some pair of atoms  in residues i and j.

secondary structures secondary structures are defined from the backbone torsion angles of the protein by using the dssp algorithm  <cit> . three persistence values pα, pβ and pturn are computed for each residue. they reflect the percentage of conformations in which the residue is in a α-helix, a β-sheet or a turn, respectively. the secondary structure type that has the highest persistence value is assigned to the residue.

step b. identification of independent cliques and communication pathways
by combining the measures described above, comma identifies groups of residues that mediate communication across the protein structure, namely independent cliques and communications pathways. the computation is performed on each input set of conformations. these components are similar to the independent dynamic segments and communication pathways identified by moneta. what is new in comma is the automated set up of pertinent values for the parameters depending on the system studied .

independent cliques
it can happen that two seeds detected by lfa are very close in the sequence . in that case, only the seed with the highest fluctuations is retained. the corrlfa matrix is characterised by dense correlation patterns around every seed identified by lfa analysis. comma defines independent cliques as protein regions that correspond to these patterns. each seed is extended into an independent clique s of residues by means of an extension algorithm that progressively adds residues in such a way that:  have a minimum distance smaller than  <dig> Å and  display concerted atomic fluctuations, indicated by high local dynamical correlations, that is the mean correlation value computed over s must be higher than a threshold  <cit> : 
  1|s|∑i,jεscorrlfa≥corrcutlfa 

the set up of corrcutlfa is explained below . the extension algorithm terminates when no more residue can be added. at the beginning of the iteration, s is made by the starting seed. we obtain k≤n independent cliques, where n is the initial number of seeds. notice that the algorithm identifying the independent cliques uses information coming from the local dynamical correlation and the minimum distance matrices.

communication pathways
any two residues i and j are considered to communicate efficiently if their communication propensity is below a threshold, cp≤cpcut. they form stable non-covalent interaction if their interaction strength is higher than a threshold, int≥intcut. the set up of the parameters cpcut and intcut is explained below . starting from a given residue, the algorithm implemented in comma generates a tree of paths that satisfies the following conditions  <cit> : two consecutive residues in a path  are not adjacent in the sequence,  form stable non-covalent interaction and  communicate efficiently. we ask that all residues in a path communicate efficiently with each other by transitivity. notice that the algorithm identifying the pathway-based edges uses the communication propensity and the interaction strength matrices, and also the secondary structure information, that plays a role for the set up of cpcut .

step c. construction of a protein communication network
independent cliques and communication pathways are used to construct a protein communication network  that reflects the way information is transmitted across the protein 3d structure. a pcn is a coloured graph defined by nodes n that correspond to the residues of the protein and edges e that connect dynamically correlated residues. two types of edges are constructed: 
clique-based edges: two vertices representing residues i and j are connected by a clique-based edge if they belong to the same independent clique and if corrlfa≥corrcutlfa.

pathway-based edges: two vertices representing residues i and j are connected by a pathway-based edge if they are consecutive in some communication pathway.



the pcn is constructed by considering the union of all independent cliques and all communication pathways detected from every input set of conformations. let us stress that moneta  <dig>   <cit>  also provides a graph representing the protein, but it uses communication pathways and covalent bonds to construct it and the criteria employed are markedly different from those employed by comma to construct the pcn.

steps d and e. extraction of communication blocks and communicating segment pairs
comma final outputs consist in dynamics-based decompositions of the query protein 3d structure. two types of decompositions are produced. the protein is divided into:  communication blocks defined from the pcn,  communicating segment pairs defined from secondary structure elements and communication pathways. these two notions are completely new compared to moneta.

communication blocks
connected components in an undirected graph are isolated subgraphs. comma extracts connected components from the constructed pcn by using depth-first search  and defines protein communication blocks. different types of communication blocks are defined, namely clique-based blocks and pathway-based blocks. clique-based blocks are directly extracted by considering all clique-based edges. different kinds of pathway-based blocks are defined, either by considering all but very short  pathways, or by considering pathways longer than a fixed number of residues. an interesting threshold is given by mplcut as defined below .

communicating segment pairs
comma detects pairs of protein segments that are part of secondary structure elements  and that are linked by communication pathways. a sse is constituted by residues  that adopt the same secondary structure type. first the algorithm identifies all sses contained in the protein structure. then, it computes, for each pair  of sses:  the proportion prab  of residues from a  that are linked by at least a communication path to some residue from b ,  the number of pairs of residues  of a and b that are consecutive in a communication path, contab. the residues of a and b that are linked by at least a communication path constitute a communicating segment pair. the communication strength between the two segments defined from a and b is calculated as: 
  sab=prab∗prba∗contab 

visualisation
comma is interfaced with pymol  <cit>  to permit the visualisation of the communication blocks and the communicating segment pairs by mapping them on the protein average conformation. comma produces pymol files  that enable the following representations: 
communication blocks: the residues involved in communication blocks are coloured accordingly. residues that are not detected in a communication block are coloured in white. non-covalent interactions between blocks are shown as thick black lines.

communicating segment pairs: given a pair of sses, the residues involved in the communicating segments in these sses are highlighted in colours. pathways-based edges linking residues in the two segments are shown as thick black lines.



parameters
comma uses several parameters and allows the user to tune them depending on the question asked and on the system studied. however, to allow for a large-scale application of the method, we have implemented automated procedures to set up default values for all parameters.

corrcutlfa we define the lfa correlation threshold corrcutlfa to delimit protein regions of concerted atomic fluctuations. corrcutlfa is chosen such that  <dig> % of the values in the corrlfa matrix are higher than corrcutlfa .
fig.  <dig> parameters for protein a. a distribution of the local dynamical correlation  values. b distribution of the communication propensity  values. c size of the largest connected component  extracted from the adjacency graph constructed based on non-covalent interaction strengths. d size of the largest connected component  extracted from the pcn by considering communication pathways with different minimum lengths



cpcut we define a cutoff cpcut to determine whether the communication between two residues is efficient. the strategy employed to set the value of cpcut is inspired from  <cit> . intuitively, neighbouring residues in the sequence forming well-defined secondary structures are expected to communicate efficiently with each other. first, we evaluate the proportion pss of residues that are in an α-helix, a β-sheet or a turn in more than half of the conformations. then for every residue i, we compute a modified communication propensity mcp as: 
  mcp=18∑j=i−4j≠i;1≤j≤ni+4cp 

where n is the total number of residues. cpcut is chosen such that the proportion pss of mcp values are lower than cpcut . any two residues i and j for which cp<cpcut are considered to communicate efficiently.

intcut we define a threshold value intcut to filter out non-covalent interactions that are not relevant. for this, an adjacency graph is constructed from the int matrix by considering different cutoff values, ranging from  <dig>  to  <dig>  by increments of  <dig> , and the size of the largest connected component is computed . intcut is the largest interaction strength for which the size of the largest component is maximal  <cit>  .

mplcut we define a threshold mplcut to discriminate between short and long paths. for this, connected components are extracted from subgraphs of the pcn. the subgraphs are defined by considering pathway-based edges that are derived from communication pathways comprising at least n residues, n ranging from  <dig> to  <dig>  mplcut is chosen as the minimum path length for which we observe the largest reduction of the size of the largest connected component .

proteins studied
we applied the comma method to three archetypal proteins:  the b domain of staphylococcal protein a , a highly stable protein,  the dna-binding domain of the human tumour suppressor protein p <dig> , a highly flexible protein,  the cytoplasmic region of the receptor tyrosine kinase kit , an allosterically regulated protein.

molecular dynamics simulations
the same molecular dynamics protocol was applied to all studied systems. more details on the md trajectories of the wild-type kit and its oncogenic mutant d816v can be found in  <cit> .

set up of the systems
the 3d coordinates for the studied proteins were retrieved from the protein data bank   <cit> . all crystallographic water molecules and other non-protein molecules were removed. the structure of the dna-binding domain of p <dig> contains a bound zinc ion. at physiological temperature, zn 2+ rapidly dissociates from the protein and the resulting zn 2+-free p <dig> is folded and stable  <cit> . consequently, we removed the zinc ion from the initial pdb structure and simulated p <dig> in the apo form. the mutated form of kit was generated by in silico substitution of the aspartate  in position  <dig> into a valine  using modeller 9v <dig>  <cit> . all models were prepared using the leap module of amber  <dig>  <cit> , with the ff12sb forcefield parameter set:  hydrogen atoms were added,  na + or cl − counter-ions were added to neutralise the systems charge,  the solute was hydrated with a cuboid box of explicit tip3p water molecules with a buffering distance up to 10Å. the environment of the histidines was manually checked and they were consequently protonated with a hydrogen at the ε nitrogen. the details of structure preparation and solvent models are given in additional file 1: table s <dig> 

minimisation, heating and equilibration
the systems were minimised, thermalised and equilibrated using the sander module of amber  <dig>  the following minimisation procedure was applied:   <dig>  steps of minimisation of the water molecules keeping protein atoms fixed,   <dig>  steps of minimisation keeping only protein backbone fixed to allow protein side chains to relax,   <dig>  steps of minimisation without any constraint on the system. heating of the system to the target temperature of  <dig> k was performed at constant volume using the berendsen thermostat  <cit>  and while restraining the solute cα atoms with a force constant of  <dig> kcal/mol/Å <dig>  thereafter, the system was equilibrated for  <dig> ps at constant volume  and for further  <dig> ps using a langevin piston   <cit>  to maintain the pressure. finally the restraints were removed and the system was equilibrated for a final 100-ps run. backbone deviations obtained after equilibration are smaller than  <dig>  Å .

production of the trajectories
for every protein,  <dig> replicates of  <dig> ns, with different initial velocities, were performed in the npt ensemble using the pmemd module of amber  <dig>  the temperature was kept at  <dig> k and pressure at  <dig> bar using the langevin piston coupling algorithm. the shake algorithm was used to freeze bonds involving hydrogen atoms, allowing for an integration time step of  <dig>  fs. the particle mesh ewald method   <cit>  was employed to treat long-range electrostatics. the coordinates of the system were written every ps. standard analyses of the md trajectories were performed with the ptraj module of amber  <dig> 

stability of the trajectories
the simulations of wild-type and mutated kit were previously shown to have good stability  <cit> . to assess the stability of the b domain of protein a and of the dna-binding domain of p <dig>  the c α atoms root mean square deviation  from the equilibrated structure, the stability of secondary structures and the radius of gyration were recorded along each 50-ns md simulation replicate . the b domain of protein a deviates by no more than  <dig> Å  from the equilibrated structure and has an average radius of gyration of  <dig>  ±  <dig> Å . p <dig> dna-binding domain displays rmsd values in the range  <dig> – <dig> Å  and its radius of gyration values  <dig>  ±  <dig> Å . secondary structure profiles are highly stable for both replicates of both proteins . overall, the evolution of rmsd, secondary structure and radius of gyration shows that protein a and p <dig> are stable over the 50-ns runs. the systems are fully relaxed after  <dig> ns . consequently, comma was applied on the last  <dig> ns of every replicate. comma input sets for the three study cases are made of  <dig>  conformations.

convergence of the trajectories
to evaluate the convergence of the dynamic properties extracted by comma, a convergence analysis  <cit>  was applied to the md trajectories of the studied systems. the analysis comprises two steps:  a set of reference conformations are identified,  all md conformations from the trajectory are clustered into corresponding reference groups. each reference conformation is first picked up randomly and the conformations distant by less than an arbitrary cutoff r are binned with it. then the trajectory is split in two halves and conformations from each half are grouped based on their rmsd from each reference conformation. if the simulation has converged, then each reference cluster should be populated equally from both halves of the trajectory.

the rmsd was computed on the c α atoms and the cutoff r was empirically chosen so as to get a reasonable number of representative md conformations, typically between  <dig> and  <dig>  to reduce the bias resulting from the random choices of the references, the process was repeated  <dig> times for each analyzed trajectory. the convergence quality of each simulation was measured using a convergence criterion c defined as  <cit> : 
  c=1−15∑k=15## 

a lone reference conformation is a reference conformation that is not visited in one half of the trajectory . the convergence criterion c is comprised between  <dig> and 1; a value of  <dig> corresponds to an optimal convergence. all trajectories show good to very good convergence, with values of c ranging between  <dig>  and  <dig>  . this indicates that the conformational sampling furnished by the last  <dig> ns of each productive md run is sufficient to apply comma.

RESULTS
communication blocks in kit protein and its oncogenic mutant
kit is a receptor tyrosine kinase of type iii implicated in signalling pathways crucial for cell growth, differentiation and survival . the mutation of the aspartate located in position  <dig> to a valine leads to the constitutive activation of the receptor and is associated to mastocytoses and gastrointestinal stromal tumours  <cit> . it was shown experimentally that the mutation induces long-range effects that lead to a shift in the conformational equilibrium of the kinase away from the auto-inhibited state, resulting in a 536-fold increased activation rate  <cit> . comma was applied to the cytoplasmic region of kit , starting from  <dig> replicates of 50-ns md simulations of the wild-type and d816v-mutated proteins  <cit>  . the method identified  <dig>  communication blocks in the wild type  . these blocks reflect the way information is transmitted across the protein structure . they were mapped onto the average md conformations of the wild-type and mutated proteins for visualisation . they were also used to derive schematic representations of the two proteins .
fig.  <dig> dynamical architecture of wild-type kit and the d816v mutant. on top. wild-type protein. at the bottom. mutant protein. on the left. the communication blocks identified by comma are mapped onto the average conformation represented as a cartoon. the mutation site is represented by a sphere . the protein residues are coloured according to the block they belong to and the different blocks are labelled. see table  <dig> for details on the mapping between the two proteins. in the middle. schematic representations of the proteins depicting the communication blocks identified by comma and the connections between them. each block is represented by a round and is labelled. the larger the number of residues in the block, the larger the size of the round. overlapping blocks share some residues in common. contacting blocks are connected by covalent bonds. the black links indicate the presence of stable non-covalent interactions between blocks. notice that non-covalent interactions are formed between blocks that share some residues in common or contact each other, but they are not displayed for a sake of clarity. on the right. schematic representations of the proteins depicting the results obtained from moneta. the large round in green include all residues involved in some communication pathway. the smaller blocks in blue tones represent independent dynamic segments. the size of the round depends on the number of residues involved 

the overlap o
ij between two blocks b
i and b
j, identified in the wild type and in the mutant, is evaluated as: o
ij=2∗#/+#). two blocks are defined as counterparts, namely x and x’ if:  x’  yields the maximum overlap with x  over all blocks in the mutant  protein;  the overlap is greater than 60%



decomposition of kit dynamical architecture
kit communication blocks can be classified according to the structural and dynamical information used to identify them. in the wild type , blocks a to g  were obtained from independent cliques . these blocks represent protein regions whose internal dynamics are independent from each other and from the rest of the protein. blocks h , i , j  and k  were obtained from communication pathways, i.e. chains of dynamically correlated residues stabilised by non-covalent interactions . blocks i, j and k were identified by considering all but very short paths while block h comprises only long paths .

different types of connections are established between blocks , namely, from the strongest to the weakest:  inclusion, e.g. block h is included in block i,  overlap, e.g. blocks d and i share some residues in common,  contact, e.g. some residues from blocks b and i are adjacent in the sequence,  interaction, e.g. some residues in blocks a and c form a stable h-bond or hydrophobic contact. we observed that two blocks that share residues or contact each other  are also connected by non-covalent interactions .

the architecture of kit is composed of a core of long-range communicating residues forming block h, that represents more than one third of the protein . this core spans the two lobes of the protein and covers most of the enzymatic site . it is extended by a layer of short-range communicating residues contained in block k and is connected to several much smaller blocks. these small blocks establish few connections between them. however an interconnected set of small blocks  can be detected, that is constituted by residues from the n-terminal lobe and represents about  <dig> % of the protein.

comparison of wild-type and mutated kit
the communication blocks identified by comma in wild-type and mutated kit were compared. the pairs of blocks from the two proteins that are constituted in large part by the same residues were identified . overall, the composition of the blocks and their connections can vary substantially upon mutation . specifically, block m’  of the mutant comprises most of the residues constituting blocks a, e and f in the wild type. let us stress that the mutational position  <dig> is located in block e of the wild type protein and in block m’ of the mutant . interestingly, the protein regions comprised in block m’ were recently highlighted as forming an allosteric network in src kinase  <cit> . in addition to these changes, comma detected three long-range communication blocks in the mutant  instead of one in the wild type. block h’  is  <dig>  times smaller than block h. some residues from the n-lobe that were included in block h now form the disjoint block l’ . the residues forming block j’  communicate at longer range than the residues forming block j in the wild type. these three blocks h’, j’ and l’ are included in block i’, which is slightly bigger than i. consequently, the mutation induces a complete reshaping of communication blocks in kit, characterised by a reorganisation of the hierarchy between long-range and short-range communicating residues and the merge of three clique-based blocks.

comparison with other classifications
the definition of kit communication blocks provided by comma can be compared with the definition of kit regulatory regions reported in the literature . blocks b, c, d, e, f and l partially match the jm-switch , the jm-zipper , the kinase insert domain , the a-loop, the substrate-binding platform  and the c-helix respectively . block a contains the jm-proximal  and the glycine-rich loop . the blocks can also be evaluated based on the flexibility profile of the residues they contain. pathway-based blocks tend to contain rather rigid residues while clique-based blocks are highly flexible . from a secondary structure perspective, residues in pathway-based blocks tend to form stable secondary structures whereas residues in clique-based blocks are in solvent-exposed loops . we observed that these trends are general among the proteins we studied. these observations show that the identification of communication blocks by comma correlates positively with protein residue classifications based on the literature, on rigidity/flexibility or on secondary structures. furthermore, comma enables to go beyond such classifications by providing a more precise dissection of the protein’s dynamical architecture.

comparison with moneta
comma results were compared to those obtained with moneta  <dig>  . moneta identifies independent dynamic segments and communication pathways from all-atom md simulations  <cit> , which are similar to the independent cliques and communication pathways identified by comma . however, comma exploits these components for further analysis  in a way that is completely different from moneta  <cit> . figure 3c depicts schematic representations of the dynamic segments and communication pathways detected by moneta in kit. the green round corresponds to the ensemble of residues involved in some path . the rounds in blue tones represent dynamic segments. these components are substantially different from the communication blocks identified by comma  and moneta does not characterise the connections between them. from this comparison, it is clear that comma brings additional information on the definition and arrangement of the protein’s dynamical architecture building blocks, compared to moneta.

moneta previously permitted to put in evidence a crucial communication pathway in wild-type kit that links the a-loop and the jms through residue d <dig> from the catalytic loop  <cit> . the path was disrupted upon d816v mutation. in comma representation of wild-type kit , all residues participating in this path are contained in the long-pathway based block h , from d <dig> in the catalytic loop to v <dig> in the jms. by contrast, in the mutant , d <dig> is contained in the pathway-based block i’  but not in block h’ , indicating that this residue is involved in shorter communication pathways compared to the wild type, and that no pathway goes from d <dig> to the jms. comma results are thus in agreement with those obtained by using moneta. moreover, by identifying communication blocks, comma enables to pinpoint other long pathways that are interrupted in the mutant. specifically, the fact that the long-pathway-based block h in the wild type is divided in h’ and l’ in the mutant is associated to a disruption of the communication between residue n <dig> and residues i <dig>  h <dig> and k <dig>  interestingly, these residues were shown to form a network of interactions  crucial for the stability of the inactive conformation of tyrosine kinases  <cit> . consequently, comma analysis permits to put in evidence a deleterious effect of the activating d816v mutation on this ‘molecular brake’ which was not previously detected.

this analysis illustrates how comma can help dissect a protein 3d structure from a dynamical perspective and characterise the effect of a deleterious mutation on the structural dynamics of a protein. the information provided by comma was found in agreement with the previous findings on kit allosteric communication. it further allows a more systematic assessment of the differences between two proteins or two states of the same protein and permits to pinpoint with high precision regions or residues instrumental in the establishment or alteration of the protein communication.

communicating segment pairs in protein a
the b domain of protein a  from staphylococcus aureus is a small α-helical protein. it comprises  <dig> residues arranged in three helices, namely h <dig> , h <dig>  and h <dig> , linked by two turns, namely t <dig>  and t <dig> . the fast-folding kinetics of protein a have been extensively characterised through experiments and computer simulations , enabling to establish the following statements:  the isolated h <dig> has a higher stability and helical content compared to the two other helices,  h <dig> and h <dig> form a stable or marginally stable intermediate,  h <dig> is docked in the rate limiting step.

comma was used to identify communicating segment pairs in bdpa . for this, we performed  <dig> replicates of 50-ns md simulations, starting from an average nuclear magnetic resonance  structure . by analysing the md trajectories, comma detected five stable secondary structure elements  in the protein: three α-helices formed by residues 5- <dig>  25- <dig> and 39- <dig> and two turns formed by residues 2- <dig> and 56- <dig>  we focus here on the three α-helices, which match well the experimentally-defined helices h <dig>  h <dig> and h <dig>  three pairs of communicating segments were identified between h1/h <dig>  h1/h <dig> and h2/h <dig> . the communication strengths  for these pairs are  <dig> ,  <dig>  and  <dig>  respectively. the significantly higher strength of the segment pair corresponding to h2/h <dig> is the result of a larger number of residues involved in the communication and a larger number of direct links . let us remind that a direct link is a pair of residues from the two communicating segments that are consecutive in a communication path . moreover, one can observe that the communicating segments of h <dig> cover a significantly smaller portion of the helix compared to the segments of h <dig> and h <dig>  the communication blocks identified in protein a also show that the residues of h <dig> are involved in shorter paths compared to h <dig> and h <dig> . these observations are in agreement with the experimental evidence that h <dig> docks to a stable assembly of h <dig> and h <dig> during the folding process. let us stress that this result could not be obtained by simply analysing non-covalent interactions along the md trajectories: there are  <dig>   <dig> and  <dig> interactions for the h1/h <dig>  h1/h <dig> and h2/h <dig> pairs. this emphasises the importance of the notions of communication propensity and communication pathways in our analysis.

the role of pathway length and interaction type in p <dig> communication
the tumour suppressor p <dig> is a transcription factor regulating a wide range of genes involved in dna repair, apoptosis, senescence and metabolism . the p <dig> protein plays a crucial role in conserving the stability of the genome and preventing genomic mutation  <cit> . the loss of p <dig> tumour suppressor function is associated with cancer  <cit> . the sequence of p <dig> can be divided into an n-terminal transactivation domain, a dna-binding core domain , a tetramerisation domain and a c-terminal regulatory domain  <cit> . the dbd is intrinsically unstable and thus highly susceptible to oncogenic mutations  <cit> . the three-dimensional structure of the dbd comprises two antiparallel β-sheets, characteristic of the immunoglobulin-like β-sandwich fold . in total, it contains  <dig> β-strands and  <dig> α-helices linked by flexible loops . the dynamical architecture of p <dig> dbd  was characterised by comma, starting from  <dig> replicates of 50-ns md simulations . we investigated the evolution of the pathway-based communication blocks identified by comma when varying the minimum length of the pathways considered and the type of non-covalent interactions used to construct them .
fig.  <dig> influence of pathway length and interaction type on p <dig> dbd communication. a 2d topology diagram  and 3d structure  of p <dig> dbd. the diagram was taken from pdbsum  <cit>  and the colours were modified to put in evidence the s-type immunoglobulin-like fold of p <dig> dbd: the first β-sheet is in pink, the second β-sheet is in red. the 3d structure  is represented as a cartoon, where the  <dig> β-strands of the protein are coloured in grey tones and labelled. the clique-based communication blocks identified by comma are colored in blue tones. b–g pathway-based communication blocks identified by comma by using information from all non-covalent interactions  or only interactions involving side chains , and by considering only pathways longer than  <dig> ,  <dig>  or  <dig>  residues. the communication blocks are represented as subgraphs in the pcn  and are mapped on the average md conformation . the edges on the subgraphs and the residues on the 3d structure are coloured according to the communication blocks they belong to. the nodes in the subgraphs are coloured in grey tones, indicating the β-strand they belong to



hierarchical description of p <dig> communication
the ensemble of all but very short  communication pathways identified in p <dig> yielded one communication block , representing about  <dig> % of the protein residues. this block comprises the  <dig> β-strands of the protein, some residues from the loops that frame them and a portion of the helix h <dig>  the edges of the corresponding subgraph show that communication pathways go along individual β-strands  and also cross them. the edges linking different β-strands reflect well the interactions that stabilise the two β-sheets of the protein. filtering out pathways smaller than  <dig> residues yields a communication block twice as small . the β-strands s <dig>  s <dig> and s <dig> that form the first β-sheet  are completely absent from the block, as well as helix h <dig>  the block is further reduced by two times when keeping only very long  pathways . only a portion of the second β-sheet, composed of s <dig>  s <dig>  s <dig> and s <dig> , remain in the block. this region can be viewed as the communication core of the protein.

influence of non-covalent interaction type
secondary structure units  are stabilised by h-bonds formed between backbone atoms . we analysed the impact of disregarding information from these interactions on p <dig> dbd communication. only interactions involving side chain atoms were retained to construct communication pathways and the corresponding communication blocks were extracted . the obtained subgraphs show a significantly reduced number of edges linking different β-strands. this result is expected owing to the nature of β-sheets. more surprisingly, however, the smaller number of edges minimally impacts the communication within each β-sheet. this indicates that numerous interactions are established within the β-sheets, other than backbone-backbone h-bonds. by contrast, the loss of these interactions is determinant for the communication between the two β-sheets and results in each of them being detected as an isolated communication block . two communication blocks are also detected when pathways smaller than  <dig> residues are filtered out , instead of one with all interactions . this is due to backbone-backbone interactions being lost within s <dig> and between s <dig> and s <dig>  the communication core of the protein, obtained from very long pathways , is slightly smaller than when considering all interactions , due to missing interactions involving s <dig> 

this analysis unveiled the hierarchical roles played by the different structural units  of the p <dig> dbd in the protein’s dynamical architecture. specifically, the residues constituting the first β-sheet communicate at shorter range than those constituting the second β-sheet. furthermore, it showed the preponderant role of backbone-backbone interactions in establishing communication between the two β-sheets. these results illustrate how comma can be employed to contrast different protein regions from a dynamical point of view and to investigate the molecular determinants of protein communication at a precise level.

comparison of protein a and p53
the b domain of protein a and p <dig> dbd represent two archetypal proteins in terms of thermodynamic and kinetic stability. while the latter unfolds at just above physiological temperature  <cit> , the former presents fast and stable folding  <cit> . moreover, bdpa is composed of three helices while p <dig> dbd mainly contains β-sheets. consistently, our analyses of the two proteins show very different results. comma identified  <dig> very small clique-based communication blocks in bdpa, corresponding to the two extremities and representing  <dig> % of the protein residues. by contrast, the clique-based communication blocks identified in p <dig> dbd represent almost  <dig> % of the protein . they encompass all residues involved in the interaction with dna, namely the loops l <dig>  l <dig> and l <dig> and the helix h <dig>  which adopt variable conformations in the available experimental structures of p <dig> dbd  <cit> . comma also enabled to characterise the evolution of pathway-based communication blocks when varying the minimum communication pathway length. the communication core of bdpa, defined based on very long  pathways, comprises full-length helix h <dig> and some residues from h <dig> and h <dig> . this is consistent with experimental evidence showing that h <dig> is the most stable helix among the three  <cit> . p <dig> dbd presents a strikingly different dynamical behaviour, with a communication core composed of residues from different β-strands that form the first β-sheet . progressively filtering out communication pathways with increasing length results in residues, first from the loops that frame the β-strands, then from the extremities of the β-strands, to be excluded from the communication block . notice that the length of the pathways does not depend on the length of the β-strands, i.e. longer β-strands do not exhibit longer paths. these observations on bdpa and p <dig> dbd support the utility of comma to compare proteins of very different natures in a straightforward way.

the importance of the conformational sampling
the results obtained from comma directly depend on the extent and quality of sampling in the input conformational ensemble. in the case of md trajectories, the user must carefully check that they have converged before proceeding through comma analysis. in the present work, we have performed comma analysis on the conformational ensemble generated during the last  <dig> ns of two 50-ns md replicates for each studied system. we have assessed the stability of the studied systems in the chosen force field description  and the convergence of the md trajectories . we have also applied comma to the single trajectories and have obtained similar results . this indicates that our results are reproducible and robust to limited variations of the conformational ensemble. another important aspect is the number of input conformations. in order to get statistically significant results, in particular for the principal component analysis, the number of conformations shall in principle be larger that the number of degrees of freedom of the system studied. in the examples of application reported here, we have characterised the internal dynamics of three proteins on relatively short simulation times . consequently, we have illustrated how comma can reveal the dynamical dimension of a 3d structure representing a particular macrostate of the protein. nevertheless, the utility of comma is not limited to such type of analysis and the tool can be applied to atomistic simulations sampling large conformational changes.

related tools
as noted in the introduction, a number of previously developed methods are dedicated to the analysis of the dynamical behaviour of proteins and their inter-residue communication  <cit> . these tools however typically consider only dynamical correlations or/and non-covalent interactions, whereas comma combines four different dynamical properties in a unified framework . moreover comma describes communication at different levels, from individual residues to the whole dynamical architecture of the protein. in particular, the identification of communicating pairs of secondary structure elements is a unique feature of our method . finally, comma, which uses mdtraj python package  <cit> , does not depend on a particular md package and can handle most popular formats used in the protein structural dynamics community.
the technical characteristics and functionalities of comma and of five state-of-the-art methods are reported. the psn-enm method  <cit>  and the method proposed by taylor et al.  <cit>  are not implemented as software



CONCLUSIONS
we provide to the community a fully automated tool for analysing conformational ensembles of proteins. the power of the comma method resides in the fact that it computes a number of dynamic properties of a protein at the residue level and integrates them in a unified framework to dissect the protein dynamical architecture by identifying its building blocks and the connections between them. comma permits to enrich the knowledge of a protein structure by bringing precise, complete and synthetic information on/from its internal dynamics. moreover, the automatic set up of the parameters implemented in comma allows for an adapted modelling of the system under study and to contrast the roles of the different protein regions. comma can advantageously complement classical analyses of protein structures and simulations and help look at proteins as dynamical biological objects with a new eye.

availability and requirements
tool name: commadownload site: www.lcqb.upmc.fr/commaoperating system: platform independentprogramming language: c++ and python  <dig> external tools: pymol other requirements: mdtraj, eigen and numpy python packages

additional file
additional file  <dig> 
supplementary materials.


 from the fourteenth asia pacific bioinformatics conference sanfrancisco, ca, usa.  <dig> -  <dig> january 2016

competing interests

the authors declare that they have no competing interests.

authors’ contributions

yk, el and ac conceived the overall study and designed the experiments. yk implemented comma and performed computational analysis. yk, el and ac analysed the results. el and ac wrote the manuscript. all authors read and approved the final manuscript.

declarations

publication costs for this article were funded by the mapping project .

this article has been published as part of bmc bioinformatics volume  <dig> supplement  <dig>  2016: selected articles from the fourteenth asia pacific bioinformatics conference . the full contents of the supplements are available online at http://www.biomedcentral.com/bmcbioinformatics/supplements/17/s <dig> 

