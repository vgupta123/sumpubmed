BACKGROUND
sequencing microbial genes directly from the environment has uncovered a vast diversity of microbial lineages that had not been found by techniques that require cultivation  <cit> . the gene encoding the small subunit of ribosomal rna  has been especially useful as a marker for phylogenetic diversity  <cit> . although sequences are often used to catalogue the types of microorganisms present in a single environment, comparisons between sequences from multiple environments are increasingly important because they can test whether microbial community composition changes in response to specific environmental variables. such applications include testing how disease affects oral or gut microbial communities  <cit> , understanding industrial processes such as the different types of activated sludge in batch reactors  <cit> , understanding how pollution affects natural ecosystems  <cit> , and understanding the basic ecology and distribution of microbes  <cit> .

when comparing microbial communities, researchers often begin by determining whether each pair of communities is significantly different. however, to gain a broad understanding of how and why communities differ, it is essential to move beyond pairwise significance tests. for example, we might want to know whether differences between communities stem primarily from particular lineages of the phylogenetic tree, or whether there are environmental factors  that group multiple communities together.

here we introduce unifrac, a web application that allows researchers to address many of these broader questions about the composition and evolution of bacterial communities. for example, symbiotic communities associated with different animal species would be expected to show differences correlating with the evolutionary distance between the animals if most of the change is through divergence and vertical inheritance. however, if diet or geography influences the assembly of the communities more, we would expect the community differences to correlate more with these other factors. unifrac uses phylogenetic information and multivariate statistical techniques to determine whether microbial communities are significantly different, identify individual lineages that contribute to these differences, and reveal broad patterns relating many environmental samples. phylogenetic techniques for comparing microbial communities have only recently been introduced  <cit> , and can be more informative than traditional "species"-based methods such as the jaccard and sörenson indices . unlike phylogenetic techniques, species-based methods that measure the distance between communities based solely on the number of shared taxa do not account for the amount of evolutionary divergence between taxa, which can vary widely in diverse microbial populations. among the first applications of phylogenetic information to comparisons of microbial communities were the phylogenetic  – test and the fst test  <cit> . these tests were adapted from population genetics, and can be used to determine whether pairs of microbial communities differ significantly. the p-test, in particular, has been broadly applied in microbial ecology  <cit>  despite the absence, until recently  <cit> , of a convenient implementation. however, pairwise tests are limited because they can only reveal whether two samples differ from one another, and cannot be used to relate many samples simultaneously.

we recently introduced a new phylogenetic diversity metric called the unifrac metric, which allows multiple communities to be compared simultaneously  <cit> . the unifrac metric measures the distance between communities as the percentage of branch length that leads to descendants from only one of a pair of environments represented in a single phylogenetic tree, i.e. the fraction of evolution that is unique to one of the microbial communities. the metric thus reflects differences between the lineages that are adapted to live specifically in one environment or the others. the unifrac metric has been used to cluster many different environments according to shared similarities in community composition  <cit> . in this paper, we describe a web application that implements the unifrac metric and several other phylogenetic tests in a form easily accessible to microbiologists and that does not require any computer programming experience.

the unifrac web application allows researchers to compare many environments simultaneously using hierarchical clustering and/or principal coordinates analysis  <cit> . the significance of the clusters identified by this method can be established using sequence jackknifing, which tests whether the environments were sampled sufficiently to support individual clusters. unifrac can also determine whether community differences are concentrated within particular lineages of the phylogenetic tree by applying the g test for goodness of fit  <cit>  to all clades  within a tree at a defined distance from the tree root. the interface provides powerful graphics to visualize the differences in pca plots and phylogenetic trees/environment clusters that are highlighted by significance. finally, unifrac can determine whether microbial communities are significantly different using both the unifrac significance test  <cit>  and the p-test  <cit> , allowing direct comparisons of the two techniques. the unifrac interface makes the results of these procedures dramatically easier to interpret by providing visual presentations of the data rather than output files that must be plotted in other programs. thus, unifrac makes these phylogenetic methods far more broadly accessible to the community of microbial ecologists.

implementation
design requirements
based on user feedback and on our own experience using the original command-line implementation of these analyses, we identified six essential design requirements for the unifrac system. the system should:

 <dig>  be widely useful and usable by biologists without programming experience.

 <dig>  be fast, scalable, and support multiple simultaneous analyses on a dataset.

 <dig>  support trees from several common phylogeny programs, including arb  <cit> , phylip  <cit> , paup*  <cit> , raxml  <cit> , muscle  <cit>  and clustal w  <cit> .

 <dig>  combine a wide range of known and novel phylogenetic algorithms with powerful and easily understood visualization tools. for example, scatterplots of principal coordinates should be able to use either text labels or symbols, and trees should display both branch length and, where available, statistical support.

 <dig>  allow pairwise comparisons between all pairs of environments represented in the input phylogenetic tree to determine which pairs are significantly different after correcting for multiple comparisons.

 <dig>  determine whether community differences are concentrated within particular lineages of the phylogenetic tree.

we were able to meet these design requirements by implementing unifrac as a web application on a beowulf cluster . in particular, we achieve scalability by distributing individual components of the analysis to different cpus in the cluster, which also allows multiple analyses to be performed simultaneously. the web interface also provides an environment familiar to most potential users, and allows the results to be visualized as trees or graphs directly rather than requiring that the data be exported to other programs. unlike our earlier command-line implementation, the user need not install additional software to run the web version of unifrac, and the analysis is not limited to a single cpu.

data input
unifrac requires two input files: a single rooted phylogenetic tree that contains sequences derived from at least two different environmental samples, and a file describing which sequences came from which sample. the phylogenetic tree can be in either newick or nexus format, and can be generated by programs such as arb  <cit> , phylip  <cit> , paup*  <cit> , raxml  <cit> , muscle  <cit>  or clustal w  <cit> . the environment information must be provided in a text file in which each line contains a sequence name and an environment name separated by a tab. optionally, the environment file can include a third column describing the number of times the sequence was observed in each environment. this abundance data can come from restriction fragment length polymorphism  data or operational taxonomic unit  counts.

analyses
unifrac displays the uploaded data on a page that allows the user to choose among several analyses . a text representation of the input phylogenetic tree is displayed, including the environments to which each sequence was assigned and the number of times each sequence was observed . detailed information on the number of sequences in the tree that were assigned to each different environment can be obtained by selecting environment counts from the select analysis drop down menu .

significance tests
unifrac allows several different hypotheses about community structure to be tested, using two different methods of calculating significance and three methods for choosing the environments to be compared with one another .

unifrac can calculate whether two communities differ significantly using either the unifrac significance test  <cit>  or the p-test  <cit> . the p-test estimates similarity between communities using the number of changes from one environment to another along a branch that is required to explain the distribution of sequences between the different environments in the tree . the p-value is the fraction of trials in which the true tree requires fewer changes than trees in which the environment assignments have been randomized. the unifrac significance test measures similarity between communities as the fraction of branch length in the tree that is unique, meaning that it leads to descendants in one environment or the other but not both . the p-value is the fraction of trials where the true tree has more unique branch length than trees in which the environment assignments have been randomized.

in the unifrac interface, the number of permutations option selects the number of random permutations of environments used to calculate the p-values for the p-test and the unifrac significance test. both tests can be performed on all environments together or for each pair of environments. performing the analysis on all environments together tests whether the sequences from all of the different environments in the tree are significantly different from each other. for example, if there are sequences from  <dig> different environments in the tree, only one p-value is returned. this p-value indicates the probability that the sequences differ significantly across all  <dig> environments. a significant p-value can arise even if only one environment differs from the rest.

in contrast, performing the analysis on each pair of environments returns a p-value for each possible pair of environments in the tree. this option can be used to test which pairs of environments differ from one another. sequences present in neither of the two environments being compared are removed from the tree before calculating the significance. when making many comparisons, p-values must be corrected in order to maintain the desired type i error rate . we correct for multiple comparisons by multiplying the p-values by the number of comparisons that were made, otherwise known as the bonferroni correction  <cit> , and report both the corrected and uncorrected results of the analysis. this correction can make it difficult to obtain a significant p-value for trees with sequences from many different environments, even if the environments have very divergent communities. pairwise comparisons between more than  <dig> samples should use at least  <dig> randomized trees, because the minimum p-value that can be reported for  <dig> permutations is <=  <dig>  . because there are six ways to choose pairs for four samples for comparison, we would need to correct for multiple comparisons by multiplying this minimum value of  <dig>  by  <dig>  resulting in a p-value of <=  <dig> . thus, no individual pair could be shown to be significantly different at a  <dig>  cutoff.

the unifrac significance test also has the option to analyze each environment individually, which can determine if a significant p-value for all environments together is due primarily to a single environment. this could occur if one environment contains only sequences that also appear in the other , or if the sequences in one environment are more tightly clustered or are on longer branches. this analysis returns a p-value for each environment, indicating whether that environment has more unique branch length than would be expected if the sequences from that environment were randomly distributed in the tree. the calculations are similar to those for the unifrac significance test with all environments together, except that the fraction of unique branch length is calculated for each environment individually and compared to a random distribution for that particular environment, thus testing whether any single environment differs in phylogenetic distribution from the rest of the sequences overall. the all environments together option instead pools the unique branches for all the environments in the tree, thus testing whether any combination of environments is nonrandomly distributed.

note that whether or not sequences are dereplicated can have substantial effects on the statistical significance of the distance between samples, even though there will be no effect on the distance itself. for example, suppose you have two samples a and b. otu x appears  <dig> times in sample a, and does not appear in sample b. after dereplication, only one sequence from x in sample a remains in the data set. during the randomization, in which environment labels are assigned to each taxon independently, the original set  can have each of these copies assigned either to a or to b. because, on average, half the copies will be found in each environment, in most cases the branch length leading to x will be counted towards both a and b, and so the original data set  will appear to be highly unusual and thus statistically significant. however, in the dereplicated data set, in which there is only one copy of x, all of its branch length will be assigned either to a or to b, but never to both. consequently, x will always count as "unique branch length", and the real observations will appear no different from randomized observations .

lineage-specific analysis
if the communities from two environments are significantly different, the next step is to determine which lineages contribute to the difference. this is commonly done by binning the sequences by taxonomic group , and then comparing the percentage of sequences from each group in each environment using bar graphs or pie charts. for more detailed analysis, researchers often visually inspect the phylogenetic tree to identify lineages that are overrepresented in one environment, but this is seldom done with statistical rigor. unifrac's lineage-specific analysis determines whether particular lineages in the phylogenetic tree have an excess or deficit of sequences from a particular environment by applying the g test for goodness of fit to each lineage at a defined distance from the root. the g test is similar to the chi-squared test for goodness of fit, but is more accurate for small sample sizes  <cit> .

to apply the g test, the lineages are first separated by cutting the tree at a specified distance from the root, which can be entered numerically or chosen by clicking on a scale bar above the tree . choosing a small distance, which cuts close to the root, can perform a high-level analysis at the division level. choosing a large distance, which cuts far from the root, can perform a low-level analysis at about the family or genus level. for each lineage, we use the g test to generate a p-value that indicates the probability that the actual count of sequences in each environment is significantly different from the counts that would be expected if sequences were randomly distributed in the tree. as with the pairwise significance tests, the p-values are multiplied by the number of comparisons that were made  in order to maintain the desired type i error rate  <cit> . detecting significant differences is thus difficult when a large distance from the root is specified and many lineages are evaluated.

the lineage-specific analysis can use abundance information provided in the environment file. for instance, if rflp data indicate that a particular sequence was represented by  <dig> different clones, the program will count that sequence  <dig> times when performing the g test. after the lineage-specific analysis, each lineage that was evaluated is colored on the tree according to its level of significance. a table summarizing the p-value and expected and observed counts for each environment in each lineage is also provided .

comparing many environments simultaneously
unifrac can compare many communities simultaneously using hierarchical clustering with the upgma  algorithm  <cit>  and pca  <cit> . we have previously described these techniques and their application in detail  <cit> . briefly, a distance matrix between environments is made using the unifrac metric, calculating values for all possible pairs of environments in the tree. this environment distance matrix can be viewed by selecting environment distance matrix from the select analysis menu . the environment distance matrix is the input both for clustering with upgma, which is executed using the cluster environments analysis option, and for pca, which is executed using the pca analysis option. cluster environments outputs a text representation of a tree in which similar environments will be clustered together .

the unifrac interface also has the jackknife environment clusters option, which has been described in detail previously  <cit> . this option indicates how robust each environment cluster is to sample size and evenness by assessing how often it is recovered in randomly chosen sets of sequences . to perform this analysis, we randomly sample the same number of sequences from each environment , re-cluster the environments using these sequences, and calculate the fraction of times that each node in the cluster was recovered. by default, number of sequences to keep is set to the minimum number of sequences found in any environment in the tree. if an environment contains less than the specified number of sequences, all the sequences from that environment are removed, excluding that environment from the cluster output. number of permutations determines how many random samples are generated . the output is a tree in which each node is colored according to its jackknife support, i.e. fraction of the random samples that they were recovered in .

the environment distance matrix can also be used to cluster the environments using pca  <cit> . pca is a multivariate statistical technique for finding the most important axes along which samples vary. distances are converted into points in a space with a number of dimensions one less than the number of samples. the principal components, in descending order, describe how much of the variation each of the axes in this new space explains. the first principal component separates out the data as much as possible, the second principal component provides the next most separation, and so forth. the unifrac interface returns information on all principal component axes in a data table. it also allows easy visualization of that data in scatterplots that compare all pairs of the first three principal components . the points are either marked with text or colored symbols. symbols representing environments with similar names are assigned the same color, providing a convenient way to group environments visually by changing the names in the uploaded file. for example, if bin envs by: first underscore is selected, environments that have names containing the same prefix before an underscore will have the same color . if assign series by: first letter is selected, environments starting with the same first letter will have the same color . series can also be labeled with the first letter of their names rather than by different colors. pca often reveals patterns of similarity that are difficult to see on a tree, and the axes along which variation occurs can sometimes be correlated with environmental variables such as temperature or ph. however, when no single principal component explains much of the variance, the clusters generated with cluster environments can be a more useful guide to similarity than the lower-dimensional projections found by pca.

parallelization
many of the analyses in unifrac can be parallelized and distributed over multiple cpus after loading the initial tree and environment file. there are two types of parallelization used in unifrac: using a single cpu to perform a single analysis , and using multiple cpus to perform a single analysis . depending on the type of analysis requested by the user, one or more cpus are assigned to handle the request via jobs submitted to the pbs queuing system on our beowulf cluster. each analysis request is assigned a unique request identifier, which is then used to track the overall progress of the job or jobs that make up the request. once all of the jobs are finished running, the partial results are collected from each cpu and are combined before being sent to the user. a user may run several analyses at once .

RESULTS
comparing the p-test to the unifrac significance test
because the p-test and the unifrac significance test are evaluating different hypotheses, it is possible to get a significant p-value for one and not the other. fig. 3a describes an example of a tree that would have a significant p-test result and a non-significant unifrac result. the unifrac interface allows these two methods to be compared easily for the first time.

the p-test tests the hypothesis that fewer changes from one environment to another are required to explain the actual distribution of modern sequences in environments than would be required if sequences were randomly assigned to environments. a tree in which the sequences are clustered into monophyletic lineages would require few parsimony changes to describe the distribution . the p-test thus takes the tree topology, but not the branch lengths, into account.

in contrast, the unifrac significance test accounts for both the tree topology and the branch lengths, and tests the hypothesis that there has been more unique evolution within each environment  than would be expected if the sequences were randomly distributed among environments. a significant p-value thus indicates that the sequences from a particular environment are clustered into monophyletic lineages that represent a longer history of adapting to life in one environment versus the other.

usage example
to illustrate the utility of the unifrac interface, we reanalyzed sequence data generated in a study of bacterial communities in the columbia river, its estuary, and the adjacent coastal ocean  <cit> . crump et al, used filtration techniques to separate particle-attached and free-living bacteria from the three sites, and analyzed these populations separately. because the particle-attached bacteria in the estuary are 10– <dig> times more active than free-living bacteria, and because particles have a much longer residence time in the estuary than water , crump at al. hypothesized that the estuarial particle-attached but not free-living bacteria would form a unique community that is distinct from the river and coastal ocean source communities.

in order to test this hypothesis, crump et al. partially sequenced  <dig> 16s rrna clones from the particle-attached and free-living bacteria in the river, estuary, and coastal ocean, and characterized an additional  <dig> clones from the estuary using rflp band patterns. we downloaded the sequences from genbank, and used the author's annotations to assign each sequence to one of the  <dig> environments. rflp screening prior to sequencing was carried out only for the estuary. whether or not sequences are de-replicated can have substantial effects on the statistical significance of unifrac distances and the p-test, but only a minimal effect on the unifrac distances, so the pca and cluster environments  analysis results will be unchanged . in order to make the sequence collections comparable between the samples, we de-replicated the sequence data from each of the  <dig> environments individually by picking otus at 97% sequence identity using the "percent sequence identity with gaps" algorithm of fastgroupii  <cit> . alternatively, we could have used the rflp counts to produce a tree in which the same sequence was repeated multiple times, once for each rflp count. this approach better accounts for the abundance of particular types when assessing significance between samples. . for the de-replicated tree, we created an environment file that included only one representative of each otu, along with the number of times that each otu was observed. we aligned the sequences using the nast-alignment tool  <cit> , and used the parsimony insertion algorithm of the arb package  <cit>  to create a single phylogenetic tree that contained all of the sequences. we exported this tree in newick format for input into unifrac.

we successfully assigned environment information to all but  <dig> of the  <dig> clones using the authors' annotations. after loading the tree and environment information into the unifrac interface, we selected the environment counts analysis option to get detailed information on how many otus from each environment are in the study . this indicated that more otus from the estuary were evaluated than from the river or coastal ocean, and that screening for otus reduced the number of sequences in the tree from  <dig> to  <dig>  unifrac automatically removes sequences in the input tree that are not assigned to an environment before any analyses are performed.

in order to get an initial idea of how the  <dig> environments related to one another, we calculated raw unifrac values for all pairs of environments with the environment distance matrix analysis option . small unifrac values indicated communities that were more similar. a quick glance at the distance matrix, for instance, showed that the free-living bacteria in the estuary  were more similar to the free-living bacteria in the river  than in the ocean .

in order to better visualize the overall patterns of variation, we used this distance matrix to perform pca by selecting the pca analysis option. we produced a scatterplot of the first two principal coordinates and colored the points by environment  by selecting the scatterplot and assign series by: first letter option . pc <dig> and pc <dig> explained almost equal amounts of the variation in the data . pc <dig> separated free-living bacterial communities from particle-attached communities . pc <dig> separated the environments from the estuary, river, or ocean; bacterial lineages in the estuary were more similar to those in the river than to those in the ocean.

we also used the distance matrix to cluster the environments using upgma . at the same time, we determined the robustness of the results to sampling effort and evenness using the jackknife environment clusters analysis option with number of sequences to keep set to the default value of  <dig> and number of permutations set to  <dig>  we set number of sequences to keep to  <dig> because this was the number of sequences in the environment represented by the fewest otus  . if we had picked a number greater than  <dig>  all sequences from o_un would have been removed from the tree and o_un would have been excluded from the analysis.

like the pca results, the upgma results suggested that the estuary and river sequences from both the particle-attached and free-living bacteria were more similar to each other than they were to sequences from the ocean, since they clustered together to the exclusion of the ocean samples . when only  <dig> otus from each environment were considered, however, only the node that grouped the free-living bacteria in the estuary and the river together was supported > 50% of the time . this lack of bootstrap support indicated that more sampling would be required for confidence in the results for the other nodes.

we next used the unifrac significance and p test significance analysis options to determine whether the communities in the different samples were significantly different from each other. performing unifrac significance and p test significance on all environments together and number of permutations set to  <dig> resulted in a non-significant p-value for unifrac significance  and a significant p-value for the p-test . this result indicates that the sequences were significantly clustered by environment overall, but that these clusters did not represent a significant amount of unique branch length . performing unifrac significance and p test significance on each pair of environments with number of permutations set to  <dig> resulted in a significant p-value only for the comparison of free-living bacteria in the ocean  and particle-associated bacteria in the estuary  for both tests after correcting for multiple comparisons. the level of significance was much stronger with the p-test  than the unifrac significance test . to correct for multiple comparisons, all of the pairwise p-values have been multiplied by  <dig>  because that is the number of comparisons that were made. in the case of the o_fl, e_pa comparison, the p-value of <  <dig>  indicates that a lower number of parsimony changes was never observed in the  <dig> random permutations that were performed.

in order to determine if any particular environment was associated by more unique branch length than expected by chance, we performed unifrac significance on each environment individually . of the  <dig> environments, only the particle-associated bacteria from the estuary  had a significant difference . this result indicated that the sequences from this sample are associated with more unique branch length than would be expected if they were randomly distributed in the tree, suggesting that bacteria adapted to this environment seldom transfer to and survive in other environments .

finally, in order to identify lineages that are contributing to differences between environments, we performed a lineage-specific analysis with a branch length threshold of  <dig>  and minimum descendants set to  <dig>  the branch length threshold was chosen using the scale bar  to separate the tree into lineages that were at or slightly below the division level. the split divided the tree into nine nodes that each had at least six descendants . of these, four  had significant g test p-values. significant values indicated that the node had an excess or deficit of sequences in particular environments relative to chance expectations. the part of the table that describes the results for three of the four significant nodes is shown in fig.  <dig>  by examining its descendant sequences, we determined that node  <dig>  which had a g test p-value of  <dig> , represented the β-proteobacteria. comparing the observed and expected counts demonstrated that there were more β-proteobacterial sequences in the free-living components of the estuary and river than expected, and fewer in the other environments . node  <dig> had a g test p-value of  <dig> , consisted of members of the oceanospirillum group of the γ-proteobacteria, and only had sequences from the estuary. node  <dig> had a g test p-value of  <dig> , included more free-living ocean bacteria than expected by chance, and corresponded to the sar <dig> cluster within the α-proteobacteria. the rest of the α-proteobacteria were represented by node  <dig>  and do not show non-random distribution by the g test. the final significant node, node  <dig>  was overrepresented in the ocean samples and represented the cyanobacteria.

the analysis of these data using the unifrac interface provided insights that were not apparent from the initial data analysis by crump et al.  <cit> , which used other commonly employed techniques. these included 1) evaluating the identity of the top blast hit for each sequence in each environment, 2) comparing pie charts describing the distribution of sequences between division and subdivision groups in the different environments 3) visually inspecting phylogenetic trees to qualitatively determine whether sequences from the same environment clustered together, and 4) estimating the percentage of sequences in the estuary samples that clustered closely with river or ocean source communities in the phylogenetic trees. using these techniques, crump et al. concluded that the particle-attached bacteria form a uniquely adapted estuarine community, since 75% of the particle-attached clones in the estuary were rare or absent in the river or ocean . in contrast, they concluded that the free-living estuarine community was more of a sum of its source communities since about half of the free-living bacteria were similar to clones in the river or coastal ocean.

one conclusion that can be drawn from the unifrac analysis that was not apparent in the initial analysis is that the estuarine bacteria are more similar to the river bacteria than to the ocean bacteria, both for the particle-attached and free-living fractions. these relationships can be seen in both the upgma cluster and the pca plot. because unifrac considers phylogenetic lineages and not just shared otus, the results could not stem from the simple explanation that more individual species have the ability to live in both the river and the estuary. instead, they are consistent with the hypothesis that freshwater bacteria can more easily adapt to the estuarine environment than can ocean bacteria.

as suggested by crump et al., there is some evidence that the estuarine free-living bacteria are more similar to the source communities than are the particle-attached bacteria. however, the unifrac analysis shows that this evidence is limited to the river source. for instance, the estuarine and riverine free-living bacteria  formed the only jackknife-supported node in the upgma cluster, clustering more closely together than the estuarine and riverine particle-attached bacteria . the oceanic bacteria, however, did not cluster with either the free-living or the particle-attached estuarine bacteria. the results of the unifrac significance test on each environment individually also support the hypothesis that the estuarine particle-attached bacteria, in particular, form a uniquely adapted community. only this environment resulted in a significant p-value when compared against the rest of the tree, indicating that it has significantly more unique branch length than the other environments.

the lineage-specific analysis identified many of the same lineages that crump et al. described as being important for a particular environment. these lineages include the sar <dig> cluster for free-living marine bacteria, the β-proteobacteria for free-living freshwater bacteria, and the oceanospirillum group of the γ-proteobacteria for the estuary. notably, the g test returned a non-significant p-value  for the cytophaga-flexibacter group, a group that crump et al. concluded to be particularly important for the estuary. although the estuary sequences are abundant in this lineage, one would expect them to be abundant in any particular environment by chance because about three times as many sequences were sampled from the estuary as from the other environments. there was thus no statistical support for overrepresentation of estuarine sequences in this lineage.

CONCLUSIONS
phylogenetic comparisons among communities, especially those that allow the simultaneous comparison of many different communities, have until now been unavailable to research groups that lack programming expertise. by providing a convenient web interface, unifrac paves the way for a far broader application of these techniques in microbial ecology. in particular, the ability to cluster many communities according to the lineages they contain without needing to choose arbitrary otus will greatly enhance our ability to understand the factors that underlie similarities and differences in microbial community samples .

the unifrac web interface contains many enhancements over the command-line implementation of the unifrac metric we released last year  <cit> . these enhancements include additional functionality, in particular the taxon jackknifing and the lineage-specific analysis, improved accessibility, powerful visualization tools, and improvements in run-time both through parallelization and through code optimizations. in particular, optimizing certain tree handling routines improved the speed of some tests by a factor of  <dig> . the new visualization techniques, in particular, will greatly assist in exploratory analyses by providing the output in a form that can quickly be interpreted by researchers.

this web interface also provides the ability to compare significance tests based on the unifrac metric and the p-test within a single interface. future extensions will include the addition of other significance tests for comparing communities, such as those implemented by phylocom  <cit> . the availability of different tests in the same convenient interface will greatly assist the ability of researchers to compare the plausibility of different hypotheses about community structure. we thus expect unifrac to usher in a new era of community comparison studies, in which hypotheses about the factors underlying similarities and differences in multiple environments can be conveniently tested, and in which the lineages responsible can be rapidly unmasked.

availability and requirements
project name: unifrac

project home page: 

operating system: platform independent

programming language: python

licence: gpl

any restrictions to use by non-academics: none

authors' contributions
cl drafted most of the manuscript and the online help, wrote most of the code for the calculations, and aided in interface design. mh built the web interface, parallelized the code and improved the performance of the calculations, and contributed to other parts of the code. rk conceived of and coordinated the project, drafted parts of the manuscript and created the tutorial. all authors read and approved the final manuscript.

