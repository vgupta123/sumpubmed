BACKGROUND
advances in the field of polymerase chain reaction have enabled researchers to detect and quantify nucleic acids with increasing precision and accuracy. until recently, real-time quantitative pcr was the gold standard for determining the concentration of a known target dna or rna sequence in a sample  <cit> . more than two decades ago, digital pcr was introduced as a potential alternative for detecting and quantifying nucleic acids  <cit> . the proof of concept followed a few years later  <cit> . building on the necessary technological advances in the field of nanofluidics, commercially viable products were recently developed by  <dig> major players on the current market  <cit> .

promising applications are found in food safety  <cit> , forensic research, cancer diagnostics detection  <cit> , pathogen detection , rare allele detection  <cit> , development of biomarkers  <cit>  and sample preparation for next-generation sequencing  <cit>  among others. the most popular applications so far are low copy number detection  <cit>  and copy number variation  <cit> .

digital pcr uses microfluidic droplets or chips to divide a sample in hundreds, thousands or millions of tiny partitions. this is followed by a classical pcr amplification step. the endpoint fluorescence signal is used to classify partitions in two distinct groups: those that contain at least one target sequence and those that do not. from this, the percentage of partitions that are void of copies is obtained. the concentration of the target sequence can now be estimated as the number of copies per partition follows a poisson distribution under regularity conditions.

technical and biological factors that influence the concentration estimates have been studied extensively for quantitative pcr, which resulted in the formulation of guidelines for scientific authors  <cit> . similar efforts to raise awareness and formulate guidelines for digital pcr have been very recently published  <cit> . some of the relevant sources of variation largely remain to be explored however. one study examined the assumption that target copies are randomly distributed among partitions for a chip based system  <cit>  while another focused on the presence of variance components in a droplet based system  <cit> . experimental comparative studies between real-time quantitative pcr and digital pcr have found similar performance  <cit>  while others are claiming digital pcr can measure smaller copy number variations than quantitative pcr  <cit> . we study how the precision and accuracy of digital pcr results is affected by realistic levels of variation likely present in either system, and derive some guidelines for establishing more reliable estimates.

dpcr workflow
the digital pcr workflow allows for quick quantification of target sequences. the typical dpcr protocol reads as follows:  extracting rna or dna from the biological sample.  preparing the pcr master mix and including a quantity of extract.  dividing the reaction mix over a large number of partitions.  amplifying the target material present in the partitions over a selected number of amplification cycles and measuring the endpoint fluorescence.  estimating the target concentration and quantifying the uncertainty on the estimates.

below, we discuss the different steps in the dpcr workflow together with their key sources of variation in the data production process as visualized in figure  <dig> and summarized in table  <dig> figure  <dig> 
visualisation of the different steps in a typical digital pcr workflow. important variance components are included as arrows between the appropriate steps. the steps are:  extracting rna or dna from the biological sample,  preparing the pcr master mix and including a quantity of extract,  dividing the reaction mix over a large number of partitions ,  amplifying the target material present in the partitions over a selected number of amplification cycles and measuring the endpoint fluorescence and  estimating the target concentration and quantifying the uncertainty on the estimates. variance components are  technical variation: sampling variation and pipette error,  machine-specific variation: unequal partition size and possible partition loss, and  possibly user-optimized classification of endpoint fluorescence.


digital pcr workflow


a summary of the steps in digital pcr with associated variance components.

digital pcr starts from an extracted dna or rna sample in a similar fashion as qpcr . imperfections in the extract can lead to inhibited amplification of the target sequence. a dilution step may often be indicated.

next, a predetermined amount of the  na extract is mixed with the pcr master mix to create the reaction mix . the importance of transferring extracted na accurately into the reaction mix is well recognized, yet small pipette errors are unavoidable for volumetric dilutions. these errors are typically much smaller for gravimetric dilutions although errors due to the balance and measurement method may still exist. technical replicates of the same experiment may be prepared simultaneously, aiming for identical stochastic properties and sampling variation stemming from the poisson process only. in practice they are subject to additional technical variation as a result of pipette error and sample heterogeneity among other technical factors. the magnitude of pipette error can be estimated from known systematic and random errors of pipettes.

from this moment on, the digital pcr workflow deviates from classic pcr. in the following dpcr step, each replicate sample is divided into a large number of partitions . using microfluidics for instance, partitions are created which are either water-in-oil droplets or microchambers filled with reaction mix. the theoretical framework assumes that partitions are of equal size. in practice, droplets vary in size while chambers do not contain the exact same volume  <cit> . in  <cit> , the within-array coefficient of variation was estimated at around 10% for one of the chip-based systems.

the partitions are subsequently thermally amplified as in a classical pcr. fluorescence levels are read for each partition and at the endpoint only in most systems . as in classical pcr, the experimenter is free to choose the number of amplification cycles. most commercial machines include a default protocol with a fixed number of cycles.

between partitioning and the fluorescence measurement, partitions may be lost in a random fashion for various reasons. in droplet-based systems, this might be induced by droplets that stick to the sides of the tube, clog the reader or coalesce together. in chip-based systems, spatial effects may play a role as adjacent chambers are more likely to be both lost, for example because of small hairs. losses of about 30% seem normal for droplet-based systems  <cit> .

raw fluorescence levels are finally transformed into a binary variable by applying a threshold obtained through data-analysis. figure  <dig> illustrates the fluorescence pattern for an experiment with two dyes with arbitrary thresholds of  <dig> and  <dig>  when end-point fluorescence exceeds this threshold, the partition is labelled positive and assumed to have at least one initial target copy. meanwhile, a partition for which the fluorescence level does not reach the threshold is labelled negative and declared void of target copies. current systems embed their own thresholds before labelling fluorescence values obtained at the end of the amplification cycle as signal of target presence rather than noise. inhibition, slow starting reactions, primer depletion and other sources of technical and biological variation may result in misclassification for some partitions. the influence of inhibition on efficiency has been modelled for qpcr  <cit> . increased inhibition has been shown to slow down the reaction considerably. in digital pcr, inhibitors or slow starting reactions may result in misclassification as partitions fail to reach the fluorescence threshold while still containing at least one initial target copy. resulting false negatives hence reduce sensitivity for the detection of positive partitions.figure  <dig> 
example of the endpoint fluorescence for two dyes. in the left panel, the endpoint fluorescence of an artificial experiment without rain is shown, in the right panel the result of an artificial experiment with about 6% rain. for both dyes, the distribution is a mixture of two components, composed of output from both positive and negative partitions as shown with appropriate density functions on top and on the right of both graphs. an arbitrary threshold to separate both groups is added for each dye, dividing the area in four classification quadrants.



on the other hand, the presence of highly homologous sequences and other contaminations may lead to non-specific binding of primers and can cause positive signals in the absence of a target sequence. these false positives correspondingly reduce specificity.

from  <cit> , we see that the amount of false positives for ntc’s  is relatively small and often  <dig>  experiments on mutant dna that include a wildtype reference sample provide similar results. the amount of false negatives may be much larger as we often see a  bias  <cit> .

additionally, we noticed up to about 10% so called ‘rain’, which are partitions with an endpoint fluorescence measurement that can not be clearly classified as positive or negative based on the visible clusters. a visual example with about 6% rain can be seen in the right panel of figure  <dig>  the impact of changes in the threshold is confided to the labelling of observations in the rain as cluster members tend to be clearly positively or negatively labelled.

it was empirically verified in  <cit>  that an increased number of amplification cycles tends to increase the percentage of amplified partitions. consequently, the number of partitions that are difficult to classify, visualised as rain, are reduced and with it misclassification rates.

the choice of the threshold and subsequent labelling of the partitions is considered the first part of the data-analysis . although the cut-off is somewhat arbitrarily and automatically chosen in most systems, it is possible for the researcher to set a user defined threshold.

finally, the proportion of positive partitions is counted and the concentration of the target gene derived. define x as the number of copies in a partition and λ as our parameter of interest: the expected number of target copies per partition. when the number of copies in a constant volume of a homogeneous mix is poisson distributed  <cit> , we expect a proportion p=p=e-λ of partitions that is void of target copies. let k be the number of partitions with a negative signal and nr the total number of partitions for which results are returned. we can estimate p by , the proportion of observed partitions void of target copies in our sample and we have:
  

manufacturers of commercial systems provide an average partition size or volume v, in nanoliter say. the concentration estimate  of target copies per nanoliter then follows directly as . when the designated volume v is inaccurate, this leads to biased concentration estimates . this error is systematic and in addition to any random between-replicate variability on the average partition volume. in practice, small deviations exist. in  <cit> , an overall average droplet size of  <dig>  nl in  <dig> droplets was observed, not significantly different from the estimate  provided independently by the manufacturer. for a hypothetical sample with average partition size , the use of v= <dig>  leads to a  <dig> % downward bias of the concentration θ.

when technical replicates are available, results can be combined in two ways as shown in figure  <dig>  when the replicates are pooled, the formula above can be applied on the total number of partitions of all replicates to obtain a single concentration estimate. alternatively, the concentration estimates can be calculated separately for all replicates and combined into a single number by taking the empirical average.figure  <dig> 
comparison of 95
%
confidence intervals on the target concentration for different estimation procedures. the analysis per replicate shows typical 95% confidence intervals for single samples. each replicate presents a random sample with expected concentration λ= <dig>  target copies per partition and 5% pipette error. option  <dig> on the left shows the 95% confidence interval calculated with a single sample method pooling the partitions of the  <dig> technical replicates before estimating the concentration and its variance with poisson statistics. option  <dig> on the right uses a replicate based method to estimate a 95% confidence interval based on the  <dig> individual replicates. both the concentration and its variance were calculated using the empirical mean and variance of the concentration estimates of  <dig> independent replicates.



we simulate this digital pcr procedure while taking into account the different sources of variation to get a better understanding of the reliability of the proposed estimation procedures under the presence of these variation components. we quantify the influence of each source of variation on the accuracy and precision of the concentration estimates. some sources of variation may be fixed by manufacturers such as equal partition sizes, but most factors that strongly influence both the accuracy and precision of concentration estimates are under experimental control or can be if the manufacturer allows it. this includes the number of amplification cycles, dilution levels of the sample and the classification method to determine the percentage of negative partitions. we study the relative importance and discuss the ability to improve results by well-chosen experimental set-ups and corresponding analyses.

although the values in the simulation protocol below may not reflect the exact set-up of a specific machine, both the theoretical considerations and obtained results are relevant for all systems including, but not limited to, all commercial systems currently in use  <cit> .

methods
below, we detail our simulation set-up presenting plausible departures from the theoretical model described above. from each generated dataset, we estimate the number of target copies in the sample and derive the concentration of the original dilution relying on the assumptions of the simple working model, which may ignore components of variation in the data-generating model. for each set-up  <dig> simulations are run to get stable results.

data-generating model
we generate data according to the steps described in table  <dig> and figure  <dig> and evaluate multiple scenarios that combine different sources of variation in different simulations.

in step  <dig>  we simulate the process for several orders of magnitude of na concentration reflecting dilution levels used in practice. we therefore let the expected number of target copies per partition λ range from  <dig>   up to  <dig> 

in step  <dig>  we add random pipette errors to our simulations. pipette error results in a small deviation of the expected target sequence concentration in the reaction mix from the original concentration in the dilution. we simulate random pipette errors, without the non-stochastic systematic pipette error. our pipetted volume is normally distributed with a coefficient of variation of 0% to 10%. these deviations are based on the maximum allowed pipette error guidelines  combined with possible heterogeneity of the original dilution. all other sources of between-replicate technical variability, including between-replicate variation of partition size, are lumped in what we generally refer to as pipette error. in  <cit> , a between-well coefficient of variation of  <dig> % was found based on  <dig> wells in a droplet based system. in  <cit> , a between-array coefficient of variation of  <dig> % can be crudely estimated based on  <dig> arrays for a chip based system. in each simulation run, we consider  <dig> technical replicates from the same biological sample. consequently, they keep technical variability as a direct result of the pipette error described above among other sources of technical variation. hence, our simulations can be interpreted as repeated experiments under the same conditions performed by the same experimenter with the same pipette.

in step  <dig>  we study the difference in partition size, or equivalently in partition volume between the different partitions within a replicate. we assume that sizes vary independently and follow the same distribution in each replicate. we model this size as a log-normal distribution with parameters μ= <dig> and σ= <dig>  which is approximately equal to a normal distribution with a coefficient of variation of 10%. the expected number of target copies in a partition is modelled to be proportional to the size of the partition.

in step  <dig>  the fluorescence levels of all partitions are measured. during this process, some partitions may be lost for unknown reasons. we assume random loss implying missingness is completely at random with respect to outcome. if this is true, lost partitions are as likely to return a positive signal as returned partitions. this is equivalent to an experiment in which fewer partitions were created and none lost.

we did our simulations for a system with  <dig>  <dig> partitions. to examine the influence of random partition loss, we varied the number of returned partitions between replicates and simulations independently with an expected value and standard deviation of approximately  <dig>  <dig> and  <dig> respectively, as in  <cit> .

in additional file  <dig>  we derive precision estimates. for the large number of partitions currently generated, the anticipated loss imply but a slight loss in precision amounting to a negligible source of variation.

in step  <dig>  the fluorescence level of each partition is transformed into a binary 0/1-signal after applying a somewhat arbitrarily chosen threshold based on the data. in simple experiments, the positive and negative partitions can be easily separated by the observed fluorescence and as such the number and proportion of partitions with a positive signal can be determined with minimal error. this is shown in figure  <dig> on the left.

in our simulations, we look at a fixed underlying misclassification probability without appointing a specific cause for this misclassification. this allows us to study the effect of the misclassification itself without putting much emphasis on the reason behind it. every partition containing a target copy has a given conditional probability to return a negative signal  while every partition without target copy has a given conditional probability to return a positive signal . we assess the following false positive-false negative  combinations: , , , , , , , .

this set-up allows for a broad range for the false negative rate under a fixed specificity of  <dig> % as experiments tend to be more vulnerable to not detecting true positive partitions. the influence of the false positive rate is limited to smaller deviations with a specificity at least 99% in each simulation under a fixed realistic sensitivity of 99%.

we include the different variance components both in parallel simulations  as well as sequentially. in the latter case, sources were added in the following order: random partition loss, pipette error, unequal partition size, misclassification.

generated parameter estimates
we calculate a concentration estimate , the bias , the associated asymptotic variance and a 95% confidence interval for each of the  <dig> replicates of each experiment . we chose  <dig> replicates as the number of reactions that can run simultaneously by the different systems is typically a multiple of  <dig>  most systems use 12×8= <dig> well plates for preparing the reaction mix.

additionally, the results from the  <dig> simulations are combined in two different ways.

the first option that we consider, is pooling the replicates as if it were one sample with  partitions. the estimate, its bias, asymptotic variance and confidence interval are calculated, again as if it was one sample. this method is still used in the literature and stems from initial papers on digital pcr which deal with small numbers of partitions and pooled repeated experiments to obtain the required accuracy  <cit> .

as a second option, we study the variation between the replicates by assuming the  <dig> estimates stem from independent results, which may show some between-replicate variation. we calculate the empirical average and empirical variance of the  <dig> separate estimates and derive a 95% confidence interval under the assumption that the estimates of different replicates follow a normal distribution. this is a realistic assumption since the number of target copies in each replicate follows an approximately normal distribution  for a constant volume under the theoretical assumptions  <cit> .

RESULTS
in what follows, we discuss how the impact of each commonly encountered source of variation in the data generating process can be quantified. these results form a starting point for optimizing tuning parameters of the method and guide the experimental design.

optimal concentration and loss of partitions
the first simulated scenario follows the simple theoretical model which includes random partition loss as the only source of variation. when the loss is completely at random, the precision of the concentration estimate solely depends on the model-based variability for a given number of partitions. this describes the best-case scenario where random sampling variation as described by the poisson process is the only source of variation as in  <cit> .

since model-based variability is driven by the target dna concentration in the sample, an optimal proportion of positive partitions leads to the most precise estimates. this can be achieved for an average of  <dig>  target copies per partition . figure  <dig> shows theoretical relative boundaries of the confidence interval for any given concentration as a function of the true generated λ. the most narrow intervals close to the optimal concentration grow into much larger intervals as boundary conditions are reached with few negative or positive partitions.figure  <dig> 
theoretical confidence interval limits of the estimated concentration relative to the true concentration. the theoretical limits of a 95% confidence interval of the concentration estimate  divided by the true concentration λ as a function of this concentration  for  <dig>  <dig> analysed partitions. the limits are shown relative to the true concentration such that the precision of different dilutions of the same sample can be assessed on the same scale. although the application can be used for concentration ranges of up to  <dig> orders of magnitude, very precise estimates are theoretically only possible for about  <dig> orders of magnitude.



our simulations confirmed this trend. estimators are unbiased while the variance and thus the width of the 95% confidence interval decreases for increasing concentration until an optimum is reached around  <dig>  target copies per partition. from  <dig>  onwards the variance and ci width start to increase again. a more detailed figure is shown in additional file  <dig> 

a random loss of partitions translates into a small decrease of precision. we simulated samples under theoretical conditions with on average  <dig>  <dig> created partitions. randomly removing approximately 30% of the partitions increased the estimated asymptotic relative standard deviations under the poisson assumption by on average about 20%. the standard deviation based on estimates from  <dig> simulation runs was 44% higher. these numbers are consistent with theoretical expectations and small compared to other sources of variation discussed below.

pipette error leads to underestimation of the variation
in a next group of simulations, we study the impact of additional variation between technical replicates induced by pipette errors, sample heterogeneity and between-replicate variation in average partition size. this generates slightly different amounts of target na and varying volumes in each replicate. we expect the number of target copies in a constant volume to vary between replicates due to pipette errors and sample heterogeneity on top of the inherent poisson variability.

since the theoretical model does not account for variation between replicates , it underestimates the variance and overestimates the coverage of the confidence intervals as illustrated in figure  <dig>  this is most problematic for the concentrations where the poisson model yields the smallest confidence intervals. the theoretical model assumes that the model variance is lower close to  <dig>  copies/partition, but the technical variance as a result of pipette error is similar for most concentrations. both poisson and technical variability contribute to the total variation. the technical variation appears to dominate the poisson variation for concentrations close to the optimum under typical experimental conditions. consequently, the precision decreases considerably.

the extra variance can not be estimated from a single reaction but replicates allow for realistic estimates on the precision of the results. the replicate based variance estimator has the advantages of being unbiased and capturing the total variance. the resulting intervals do show a correct coverage, as illustrated on the right panel of figure  <dig>  naive pooling of partitions from different replicates seems to increase precision, but in fact it dramatically underestimates the variance and it must be avoided. in figure  <dig>  we see how the small confidence interval resulting from pooling  may not contain the true parameter value. the replicate based variance estimator  captures the variance both within  and between  replicates.figure  <dig> 
coverage of 95% confidence intervals of target concentration in the presence of pipette error. for a given concentration λ, the coverage was calculated as the ratio of the number of confidence intervals out of  <dig> simulations that contain the true concentration λ divided by the total number of confidence intervals calculated . the left panel shows results for confidence intervals calculated using a single sample method after pooling the partitions of the  <dig> technical replicates before estimating the concentration and its variance with poisson statistics. the right panel shows results for confidence intervals calculated using a replicate based method. the concentration and its variance were calculated using the empirical mean and variance of the concentration estimates of  <dig> independent replicates. the pooled method shows a dramatic loss of coverage while the replicate based method shows correct coverage.



since the width of a replicate based confidence interval is a decreasing function of the number of replicates m, a large number of replicates is preferred such that the confidence interval is as small as possible. conversely, we would like to keep m small for cost-efficiency. in table  <dig>  we calculated the width of the confidence intervals relative to the standard deviation and added the expected reduction of the width as a result of every additional technical replicate. it can be clearly observed that  <dig> or more technical replicates would be preferred to get a decent confidence interval, while more than  <dig> technical replicates does not improve the results considerably. additionally, biological repeats are essential in most applications to capture any existing between-sample variation. in the latter case, at least  <dig> technical replicates are advised for each biological repeat.table  <dig> 
width of a replicate based confidence interval


the relative width of a confidence interval  for a constant standard deviation is a function of the number of technical replicates and the t-quantile. the rightmost column gives the improvement  when increasing the number of technical replicates with one. note, that in this table we only consider uncertainty due to technical variability and that reducing technical variability does not eliminate biological variability. hence, in experiments for comparing nucleic acid content across biological conditions an appropriate number of biological repeats, each with technical replicates, will always be required.



unequal partition size leads to downward bias
in this section, we assume that the size for a given partition is no longer constant, but varies randomly, independent of any other variable. we assume that there is no intra- nor inter-run effect and thus the size follows the same distribution between replicates.

theoretical derivations  indicate that underestimation is to be expected especially for samples with high concentration. in figure  <dig>  relative estimates are summarized for normally distributed sizes with a relative deviation of 10%. the estimators show a systematic downward bias that is negligible for small concentrations and maximally  <dig> % for the highest concentration in this set-up. the variance is similar to that of the equivalent simulation with constant partition size although slightly lower for higher concentrations as it is directly related to the estimated concentration, which is in turn underestimated.figure  <dig> 
relative bias and rmse of the target concentration estimates in the presence of unequal partition size. when droplets or chips do not contain the same volume, bias is introduced. in the left panel, a boxplot shows relative estimates for  <dig> simulated experiments at given concentration λ . the relative bias is calculated using a replicate based method as  for  <dig> simulated experiments of  <dig> replicates. high concentrations show a downward bias. in the right panel, the associated root mean squared error  is shown, estimated as the square root of the sum of the relative variance and squared relative bias for s= <dig> simulated experiments of  <dig> replicates. for a given concentration λ, this combines the errors as a result of the variance and the bias in a single number based on the results of  <dig> simulated experiments. the best combination of accuracy and precision is achieved when the function hits its minimum.



we use the , estimated as the square root of the sum of the variance and the squared bias, to take both the variance and the bias into account and give accuracy and precision an equal weight. in the right panel of figure  <dig>  the rmse reaches its minimum around  <dig>  copies per partition with decent performance between  <dig>  and  <dig> target copies per partition for this specific set-up.

we note that the influence of unequal partition size is limited and can be easily avoided by diluting a sample. since this is a fixed machine setting, manufacturers should guarantee that sizes of the partitions created by or present in their products are somewhat comparable.

misclassification of target presence leads to bias
next, we study the misclassification. we assess the following false positive-false negative  combinations discussed above: , , , , , , , .

in the first data-generating model, misclassification is the only source of variation while in the other model all previously discussed sources of variation are included in addition to the misclassification.

in figure  <dig>  we see the results for the bias for simulations without other variance components. misclassification creates bias since false negatives lead to underestimation and false positives to overestimation of λ. a few false positives already have a big impact on samples with few target copies, while increasing false negatives especially has a very high impact on samples with a higher concentration.figure  <dig> 
relative bias of the target concentration estimates under theoretical assumptions and misclassification. the relative bias is calculated as  for  <dig> simulated experiments of  <dig> replicates without any additional sources of variation. as results are relative to the true concentration λ, the precision of different dilutions of the same sample can be assessed on the same scale. results were plotted for different misclassification probabilities  with fpr = false positive rate = 1-specificity and fnr = false negative rate = 1-sensitivity. false positives have considerable influence on the estimates for low concentrations, while false negatives substantially influence the results for highly concentrated samples.



since the variance is proportional to the rate itself, its estimate decreases as false negatives increase and increases with more false positives. the false negative  risk has a bigger impact with higher  concentrations.

interestingly, every line in figure  <dig> that includes both sources of misclassification crosses  <dig> at some point. this means that for a given combination of false positive and false negative risks, we can find a dilution for which the estimator is unbiased.

based on a dilution series with enough points, one of the patterns in figure  <dig> may be recognized when plotting the estimated concentration against the dilution rate. this is similar to the linearity and precision plots that are already used in the literature  <cit>  and may help the user to assess possible bias.

conversely, we can derive the ratio of false negatives over false positives that results in unbiased estimates for a given concentration . this too has practical relevance. the threshold to discriminate between positive and negative partitions can be manually adapted to allow more positive partitions when false negatives may be most problematic. this is assumingly the case in most experiments. the threshold should be increased to allow less positive partitions when false positives are expected to dominate the estimation error. this would be especially useful in experiments with small concentrations or that focus on detection.

users may choose to add a two-step procedure to improve the threshold in their protocol. in the first step, an initial concentration estimate can be obtained with the standard threshold. in the second step, the threshold may be changed based on the concentration estimate obtained in the first step and optional prior information on the expected misclassification rates.

the bias as a result of misclassification dwarfs any possible bias that may be present due to unequal partition sizes if the partition sizes are somewhat similar. in figure  <dig>  we see that the lines with respect to high misclassification rise quickly while the bias as a consequence of unequal partition size is hardly visible as it is a small part of the rise of the curves for high concentrations. this is more clearly visible in figure  <dig>  we see that a small, realistic false negative rate of 1% leads to increasing bias for increasing λ while the influence of unequal partition sizes is limited for average to small concentrations.figure  <dig> 
relative rmse of the target concentration estimates under realistic assumptions and misclassification. the  is estimated as the square root of the sum of the relative variance and squared relative bias for s= <dig> simulated experiments of  <dig> replicates. as results are relative to the true concentration λ, the precision of different dilutions of the same sample can be assessed on the same scale. results were plotted for different misclassification probabilities  with fpr = false positive rate = 1-specificity and fnr = false negative rate = 1-sensitivity and in the presence of pipette error and unequal partition size. when misclassification is limited, a relatively wide window of dilution exists in which high accuracy and precision can be achieved.
influence of different sources of variation on the width and location of confidence intervals for the target concentration. the influence of the different sources of variation is shown on the width of 95% confidence intervals calculated with the replicate based method for λ small , average  and large . unequal partition size is included in the misclassification examples.



the optimal window that gives a concentration estimate  with the highest precision is strongly dependent on the proportion false positives and false negatives. in figure  <dig>  all sources of variation discussed are combined and the relative rmse as a combined measure of the bias and variance is plotted against the true concentration. larger numbers of false positives and false negatives lead to smaller windows with optimal estimates. when there is limited misclassification, relatively large windows with both accurate and precise estimates exist.

note that one strategy to influence and reduce the misclassification rates in practice may involve changing the number of amplification cycles. additionally, reference materials, qpcr and no-template controls can help to assess the vulnerability of a sample to misclassification and may allow for a crude estimate of expected misclassification rates.

non-stochastic errors
while our simulations focus on stochastic settings, systematic errors may be present as well.

systematic pipette error, for instance, introduces underestimated  concentration estimates and data-analytic methods cannot correct for a lack  of na material in the reaction mix. systematic volumetric pipette error can however be estimated with gravimetric procedures and be reduced by recalibrating pipettes regularly.

the partition volume v supplied by the manufacturer enters in the denominator of the final concentration estimate as a constant assumed to be correct. when the actual mean partition volume deviates from v, systematic bias is added when the concentration θ is reported in copies per nanoliter, λ/v. we demonstrated how small deviations in partition volume within a replicate create only limited bias for high concentrations. systematic deviations of the average partition size from v can create a much larger bias. the small, non-significant difference of  <dig> % found in  <cit>  for instance induces more bias than 10% within replicate variation. it is therefore essential that manufacturers invest in accurate partition volume estimates.

combining sources of variation
in practice, all of the aforementioned sources of variation are present in experiments in one way or another. it is not feasible to describe all combinations jointly. additional file  <dig> provides the r-code used in this article and enables the user to simulate the outcome of an experiment with specific settings for each source of variation discussed above. additional file  <dig> consists of an interactive tool embedded in a mini-website that allows researchers to study results that can be expected from a useful range of combinations of these sources of variation. the tool provides valuable information on the joint effect of different realistic sources of variation present in most experiments. note, that our results can guide dpcr users to optimise their experiments with respect to signal bias or rmse. this is useful as our results show that a well-chosen threshold  combined with an optimal sample dilution  can improve accuracy and precision considerably.

CONCLUSIONS
we studied the influence of several sources of variation on estimators produced by digital pcr. we showed how some have higher impact than others and found certain background conditions to be more vulnerable to this than others. this impact may stay hidden to the naive user who could take away suboptimal results with a false sense of precision, accuracy and reliability.

a first source of variance is technical variation, which includes pipette error. although careful sample preparation can keep this error relatively small, it is unavoidable and reduces precision. this can not be captured with a single replicate and previously published asymptotic confidence intervals. replicates allow this source of variation to be included in the data-analytic process and provide correct precision estimates.

unequal partition size reduces the accuracy for highly concentrated samples. since this source of variation is dependent on the machine itself, it is one of the priorities for manufacturers to optimize it and keep the variation between partitions small. we have shown that the bias is small for realistic limited deviations and can be neglected when the concentration is not close to the upper limit. users are advised to avoid strongly concentrated samples and dilute samples when necessary.

the fluorescence threshold chosen for target detection drives the misclassification rates and has a high impact on the results, reducing accuracy. samples with few target copies and experiments with a very high concentration of target nucleic acid are especially vulnerable. in the former case, the focus may usefully shift to detection rather than quantification while in the latter, dilutions or qpcr may be advised. misclassification to some extent is unavoidable, but the informed user can do a lot to reduce it.

the underlying continuous distribution of the fluorescence is a mixture distribution composed of output from both positive and negative partitions. these two parts may be partially overlapping as a result of biological factors such as inhibition, contamination or primer depletion. the choice of the threshold results in corresponding false positive and false negative rates. the optimal trade-off naturally depends on the concentration of target copies in the sample. when the software allows it, users can calibrate the threshold to reflect expected misclassification rates of their application and get more accurate results.

additionally, dilution series may help to determine the concentration where the variance-bias trade-off is lowest and the measurement reflects the best combination of accuracy and precision. this is especially useful at high concentrations when the focus is on accurate quantification. users can achieve this by comparing precision and linearity plots to the patterns in figure  <dig> to picture the bias, while an estimate of the standard deviation follows from correctly analysed replicate experiments.

since we identified misclassification as the major bottleneck that induces the largest accuracy drop, methods to optimise classification and accuracy are promising topics of future research.

finally, it is worth emphasizing that our results have focussed on technical replicates involving variation in results generated by machine settings and human handling of a given biological sample. it is essential to acknowledge sources of variation such as systematic pipette error and correct for them when necessary. as for any biological measurement, additional sampling variation may be present in many experiments at several levels. this happens quite independently of the technology and is discussed widely in the literature  <cit> . a thoughtful protocol to correct also for this source of variation should be generally considered in addition to the specific digital pcr protocol.

digital pcr is a promising tool for high precision estimation. we showed how several sources of variation can influence results and can be accommodated with the correct knowledge such that accurate and precise concentration estimates remain possible. our findings indicate that reliability can be increased by well-chosen sample preparation and machine settings. machine calibration in theory allows the researcher to adapt the technology to yield results optimized for each specific setting. while it is of course essential to provide default settings to simplify the process for the users, it is at least as important that manufacturers provide detailed output to facilitate personalized treatment and thus enhance the quality of their results.

electronic supplementary material
additional file 1: mathematical derivations. this pdf file includes mathematical derivations on the theoretical confidence interval, optimization of the theoretical precision, decomposition of the variance in the presence of pipette error, a model for unequal partition sizes and theoretical methods to optimize the threshold in the presence of misclassification. 

 additional file 2: additional figures. this pdf file includes two additional figures on the width of confidence intervals. 

 additional file 3: r-script. users can simulate their own experiments with this code as well as reproduce all the numerical results discussed above. 

 additional file 4: interactive tool. in this mini-website, we provide an interactive tool to study the influence of specific sources of variation on the performance of the concentration estimators. this can serve as a guide when designing an experiment. all results are relative to the true concentration and based on  <dig> simulations with  <dig> technical replicates. 

 competing interests

the authors declare that they have no competing interests.

authors’ contributions

the concept was jointly developed by all authors. bj did the theoretical derivations, performed the simulation study and summarized the results. all authors analysed the results and formulated the conclusions. all authors had input in the writing. all authors have read and approved the final manuscript.

