BACKGROUND
by  <dig> the world population is predicted to reach  <dig>  billion, 34% higher than today, and to meet global demand will require an increase in food production of 70%
 <cit> . expansion of cultivation area is an increasingly unlikely and costly solution
 <cit>  and though gains can be achieved through improved agronomic management
 <cit> , current advances in genetics and genomics offer many opportunities not only for crop genetic research but also technology assisted cultivar development.

fundamental research in “model” plant species such as arabidopsis thaliana, the first plant for which a high quality genome sequence was obtained
 <cit> , has led to the identification of genes implicated in the control of many aspects of plant development, metabolism and environmental interactions. however, many of our most important crops, including bread wheat, potato, cotton and sugarcane are polyploids and many agronomic traits in crop species are typically controlled by multiple genes or quantitative trait loci . cost effective, efficient, high density marker platforms are therefore paramount in facilitating comparative genetic mapping and the identification of candidate genes and favourable alleles via qtl analysis, association studies or mutation screening. ultimately these platforms will also assist in the successful incorporation of this genetic variation into breeding programs and the development of superior cultivars, especially when introgressing traits with low heritability .

commonly used molecular markers such as amplified fragment length polymorphisms 
 <cit> , restriction length polymorphisms 
 <cit>  and simple sequence repeats 
 <cit>  have generally been assayed on low throughput agarose or acrylamide gel electrophoresis to detect size or conformation polymorphisms. multiplexing using capillary sequencing technology has been achieved by the incorporation of fluoro-labels to the pcr products. schuelke  developed a universal m <dig> tail, three primer marker system allowing the fluoro-labels to be used in combination with many different sets of specific primers and multiplexed in the most efficient permutations, reducing genotyping costs
 <cit> , however as an assay, they are still expensive per data point.

more recent developments in array technologies allow the screening of thousands of markers on an individual in a single hybridisation assay. diversity array technology  markers provide relatively low cost genotyping without prior sequence information and have been widely used for genotyping in crops
 <cit> ,
 <cit> . more recently, single nucleotide polymorphisms  have become the predominant marker type for crop improvement. illumina’s goldengate
 <cit> , one of the most popular technologies for analysis of snp markers, is based on beadarray/chips and offers genotyping with low costs per data point when large numbers of markers are assayed in parallel, but unlike dart requires previous sequence knowledge. genomic dna is bound to paramagnetic particles and an oligonucleotide pool is added that contains allele-specific primers with universal priming sites and snp-linked locus-specific primers carrying bead address sequences. following extension and ligation, an allele-specific fluoro-labelled pcr is performed and the resulting products hybridised against beads carrying locus address sequences arrayed on a glass slide. genotyping is then performed by reading the fluorescence at each address. fairly large collection of samples  can be genotyped for a customized pool of markers, up to  <dig> snps, simultaneously
 <cit> . building on this technology, illuminas infinium array also uses bead chips but is based on random amplification of fragments across the whole genome
 <cit> . each chip is divided into between  <dig> and  <dig> sections, each containing between  <dig> million and  <dig>  bead sites
 <cit> , and can either be used to genotype hundreds of thousands of snps via loading different bead pools/section for a single sample, or alternatively several thousands snps by loading different samples in each section. these high throughput snp genotyping technologies are efficient for scoring a large number of markers against relatively few individuals. however, for marker-led breeding, the requirement is more typically for the analysis of a few markers on thousands of individuals. as advances in our ability to identify the precise molecular bases of allelic variation continue to improve, the emphasis will shift from the development of linked anonymous markers to causative variation within genes, presenting particular problems in polyploid species, which will contain multiple very closely related genes that would interfere with assays.

high throughput second generation sequencing approaches, even the benchtop platforms of which can produce up to  <dig>  gb of sequence per run
 <cit> , have revolutionised our approach to undertaking genetic analyses, with genotyping by sequencing  becoming increasingly popular. step changes have been made using the illumina sequencing technology for snp discovery, linkage mapping and association genetics, even for polyploid species for which genome sequences are not available
 <cit> . although these sequencing technologies are extremely cost-effective for producing large quantities of sequence data from individual samples, they are not well-suited to producing modest quantities of sequence data from large numbers of samples. this is because the sequencing library preparation is expensive. attempts to circumvent this problem have to date focussed on various strategies of indexing or barcoding based on variant adapters, enabling the multiplexing of multiple samples per run of the instrument, and has been used for the analysis of modest numbers of amplicons in plants as well as in human genetic studies
 <cit> . the length and design constraints of the sequencing adapters, however, make such an approach too expensive for sequence variant identification in thousands of pcr products across large panels of target loci in crop species.

current approaches to detecting simple sequence variation in mutation screens relies on methods such as targeting induced local lesions in genomes 
 <cit> , which identifies sequence variants in locus-specific pcr products from pooled plants, representing coding regions of genes and typically employing an endonuclease  that cleaves at mismatches in heteroduplex dna
 <cit>  or conventional sanger sequencing of a target amplicon. these techniques, though well established, rely on the development of locus-specific amplicons within genes, which is often problematic in polyploid crops. tilling has been performed on mixed amplicons with very high level of conservation as demonstrated by wang et al.  who identified mutants in a mixed amplicon of the two bnfae <dig> genes, which show a sequence similarity of  <dig> %
 <cit> . however, screening such mixed amplicons by the conventional tilling approaches is rarely feasible as heteroduplex cleavage products are produced at every mismatch position throughout the amplicon, obscuring the much rarer  signals from mutations induced in the population.

in the present study we aimed to develop a fast, robust and low-cost technology for snp genotyping even within genes, so has the potential for deployment with “perfect” markers representing the causative changes underlying allelic variants. we based the methodology on illumina ngs platforms using as a representative polyploid the globally important oil crop, oilseed rape; species brassica napus. oilseed rape is a recently formed polyploid believed to have arisen less than  <dig>  years ago following hybridisation events between the diploid brassica species b. rapa  and b. oleracea . comparative mapping between the diploids and a. thaliana suggest that the brassica genomes are composed of three rearranged variants of an ancestral genome
 <cit> , further complicating b. napus genome architecture. because of this complexity, locus-specific pcr amplicons cannot always be obtained , limiting the number of sites in the genome that can be screened for sequence variation by conventional approaches. we developed an approach to incorporate oligonucleotide barcodes into pcr products, based on a well-established method for fluorescent labelling
 <cit> . the barcoded amplicons can be pooled from many separate reactions prior to sequencing library production and sequenced using standard illumina workflows. computational analysis of variants based on that developed for snp discovery in polyploids
 <cit>  were utilised for snp assay in mixed amplicons . for the study we chose loci close to members of two important fatty acid biosynthesis gene families: bnafad <dig> and bnasad <dig>  bnafad <dig> has four copies in b. napus located on linkage groups a <dig> , a <dig> , c <dig>  and c <dig>  and bnasad <dig> has six copies, located on a <dig> , c <dig> , a <dig> , c <dig>  and a <dig>  and c <dig> . mapping results were validated by converting markers to conventional goldengate assays. in addition, the methodology was also adapted to identify lesions in target gene families across an ems-treated population. these targets comprised a specific amplicon of bnac.gl <dig> b  and mixed products from three co-amplified copies of bna.fad <dig> 

RESULTS
barcoding of pcr products
an existing method for the addition of fluorescent labels to pcr products
 <cit>  was used as the basis for our method for the addition of oligonucleotide barcodes to pcr products. three oligonucleotides are used in the pcr reactions:  a sequence-specific forward primer with m <dig> tail at its 5’ end,  a universal m <dig> primer with oligonucleotide barcode tail at its 5’ end  and  a sequence-specific reverse primer. by limiting the amount in the reaction of the sequence-specific forward primer with m <dig> tail, pcr can be conducted in a single-stage reaction in which early rounds of amplification incorporate the universal forward primer and later rounds incorporate the bat primer. the barcoding process is shown schematically in figure 
 <dig>  with the bat experimental design illustrated schematically in figure 
 <dig> 

three hundred and twenty eight barcodes were tested for amplification and  <dig>  shown in additional file
 <dig>  which produced single, clean bands when amplified with seven test amplicons, were selected for further experimentation.

snp genotyping
the use of bat tailing for multiplexed genotyping was investigated by designing pcr amplicons that contain hemi-snp markers, i.e. loci that are amplified from both genomes of b. napus, only one of which shows allelic variation between cultivar accessions, which are the most abundant type of marker in polyploids
 <cit> . in all,  <dig> amplicons representing transcribed regions of genes, shown in additional file
 <dig>  were designed to contain hemi-snp polymorphisms detected previously
 <cit> . of these,  <dig> were shown by capillary sequencing of pcr products to contain the expected polymorphism , but polymorphisms could were not validated in the remaining  <dig>  which were assumed to be monomorphic. nevertheless, all  <dig> were used for the evaluation in order to increase the sequence complexity to more realistic levels. pcr amplification of all  <dig> amplicons was successfully conducted across a subset of  <dig> lines of the b. napus tndh mapping population  with pcr products amplified in many separate tubes  and combined for the production of an illumina sequencing library. the risk of the incorporation of the same base in a large proportion of clusters during one cycle of the illumina run triggering an error and terminating the run was prevented by the addition of a “spike” sequencing library designed to complement the base composition over the barcode and m <dig> region of the read. the spike  was added to the sample libraries at an approximately 1: <dig> ratio of final library molar concentration prior to cluster generation.

one lane  of illumina sequencing on a gaii platform produced  <dig> , <dig> single-end reads for genotyping. these were analysed for composition, with the results shown in table 
 <dig>  of the sequence reads,  <dig> %  corresponded to the ‘spike’ library and 22%  included the m <dig> sequence. of the latter, only  <dig> % carried an intact  <dig> base barcode,  <dig> % carried a  <dig> base barcode,  <dig> % carried a  <dig> base barcode and 37% had barcodes of less than  <dig> bases. this truncation of the barcodes is likely to have been due to exonucleases degrading the ends of molecules prior to ligation to illumina adapters. however, as only the final four bases of the barcode were needed for the address space used in the experiment, 63% of the reads carrying m <dig> tags were usable for genotyping. the sequences truncated to  <dig> or  <dig> bases were repaired  by the addition of  <dig> bases or  <dig> base  to restore the full  <dig> base barcode.

we developed a computational method to allow the robust detection of sequence variants, based on previously-reported methodology involving the mapping of illumina reads to reference sequences
 <cit> . sequence reads having complete/repaired 6-base barcodes were processed by having their barcodes replicated four-fold by a process termed “munging”. this munging ensures specific mapping of reads to the correct reference sequence, as four mis-matches  abolishes the mapping of reads. the munged reads were then mapped using maq v <dig> .1
 <cit>  to reference sequences comprising the specific amplified sequences plus m <dig> and four-fold munged barcodes of the occupied address space. in this way  <dig> %  of reads processed by maq were mapped to a reference sequence and associated with individual lines via the munged bat. a perl script was used to identify variants in amplified sequences relative to the ancestral reference sequence and call genotypes based on counts of the bases read at the snp position . conventional marker scoring strings were produced .

the resulting scoring strings for  <dig> markers  were successfully linkage mapped, as shown in figure 
 <dig> and listed in additional file
 <dig>  to the expected regions of the genome, i.e.  <dig> markers on linkage groups a <dig>  a <dig>  c <dig> and c <dig>  and  <dig> markers on linkage groups a <dig>  a <dig> and a <dig>  the remaining snps could not be mapped due to lack of polymorphism or because read depth was too low for robust allele-calling. for validation, illumina goldengate platform
 <cit>  markers were developed for eight of the unigenes containing snps mapped by the bat method and scored across the population. also, the scoring strings from the published oilseed rape snp map
 <cit>  for these eight unigenes were retrieved, and the scoring strings for both types of markers compared with those obtained by the bat method, as shown in additional file
 <dig>  the bat markers showed a high accuracy of scoring, with only  <dig> mis-calls in the  <dig> alleles scored .

mutation detection
the use of bat tailing for mutation detection was investigated by searching for ems-induced mutations in both a locus-specific 176 bp amplicon  and a 276 bp amplicon representing three co-amplified loci  in the ems mutagenised population jbncab_e . for each of three separate sets, each of which were pooled for the construction of an illumina sequencing library,  <dig> different bats were used for pcr amplification to screen  <dig>  lines of the population combined by one-dimensional 8-fold pooling. three illumina gaii sequencing lanes  were used to screen  <dig>  lines for mutations in the amplicons. an average of  <dig> , <dig> reads was obtained per lane. a summary of the analysis of reads and mapping is shown in table 
 <dig>  spike sequences, again added at 1: <dig> ratio of final library molar concentrations as described for snp genotyping, accounted for an average of  <dig> %  of the reads. m <dig> sequences were detected in  <dig> %  of the reads. exonuclease activity was greatly reduced compared to the initial experiment, following protocol improvements, with an average of  <dig> %  containing an intact barcode,  <dig> %  carrying a 5 bp code and  <dig> %  carrying a 4 bp code. these were repaired where possible. only  <dig> % had barcodes of less than 4 bp and so could not be repaired to allow line identification. as sequence end pairs can be identified, the m <dig>  sequence an adjacent barcode was computationally added to the paired end , resulting in an average of  <dig> %  being used for read mapping and mutation detection. mapping to the amplicon reference sequences resulted in an average of  <dig> %  of the  <dig> , <dig> ‘munged’ reads being successfully mapped, a similar proportion to the mapped reads in the snp genotyping analysis. however, reads were not distributed evenly across amplicons, with the fad <dig> orthologues bnaa.fad <dig> a, bnaa.fad <dig> b and bnac.fad <dig> a represented by averages of  <dig> %, 32% and  <dig> % of the reads, respectively. this may have been due to biases in pcr efficiency across the co-amplified loci. cluster generation from libraries was performed with a 3: <dig> molar ratio of bnafad <dig> library to bnagl <dig> library of the two amplicons. however, an average of  <dig> %  of the mapped reads was from the bnac.gl <dig> b amplicon.

following read mapping, maq was used to identify variants in amplified sequences relative to the wild-type reference sequences, with mutations called on the basis of a number of parameters. an appropriate set of criteria for calling a mutation in a particular pool of eight lines was found to be:  at least  <dig> reads carrying the sequence variant,  at least 1% of the calls showing the variant for the mixed amplicon target ; at least  <dig> % for the locus-specific target ,  the main variant from the reference base being at least 10-fold more abundant than any other variant bases called at that position,  the position should not correspond to that of an inter-paralogue  polymorphism. under these criteria, we detected  <dig>   <dig>   <dig> and  <dig> lines carrying mutations in bnaa.fad <dig> a, bnaa.fad <dig> b, bnac.fad <dig> a and bnac.gl <dig> b, respectively. a subset of these identified mutations was tested by pcr amplification from the original  dna samples using locus-specific primers. all of the  <dig>   <dig>   <dig> and  <dig> tested putative mutations in bnaa.fad <dig> a, bnaa.fad <dig> b, bnac.fad <dig> a and bnac.gl <dig> b, respectively, were confirmed to be present, as shown in table 
 <dig>  other mutations could have been present in the population but escaped detection as a result of too few sequence reads for some lines; a consequence of imbalances in the amounts of dna pooled per line for pcr amplification and/or that pooled for library construction, the latter of which was not normalised in this experiment.

CONCLUSIONS
we describe a robust and cost-effective methodology for oligonucleotide barcoding via one-step incorporation into pcr products suitable for illumina sequencing by standard workflows. computational methods then allow the deconvolution of the sequences and both the scoring of known polymorphisms and the detection of mutations. we have demonstrated the use of  <dig> base oligonucleotide barcode address space, but using this methodology much larger numbers of pcr products could be pooled and analysed if more of the address space of the tails  were used, although the inclusion of some unused bases helps mitigate the effects of any exonuclease contamination. the panel of  <dig> bat oligonucleotides synthesised and validated can be re-used with many different m13-tailed specific primers, making the approach much more cost effective than synthesising locus-specific pcr primers or locus-specific library adapters incorporating barcodes.

current multiplexing systems on next generation sequencing platforms rely on the barcoding of the library production adapters. barcoding the product before library construction provides a system of multiplexing with minimal library production costs. as it does not involve modification of adapters used for sequencing library production, pooled pcr products can be used in standard illumina workflows, including current indexing techniques, so can enable higher-order multiplexing within each lane of the sequencer and  the analysis of thousands of pooled samples in a single lane, involving the production of only tens of sequencing libraries. multiple different target loci can also be deconvoluted even when the same bats have been used .

our comparison of results between the goldengate snp platform and bat-tailing has shown the method provides a robust and economical system for snp marker genotyping, even in polyploid species. it is particularly suitable for applications such as marker-assisted selection within crop breeding programs as modest numbers of markers can be screened across thousands of individuals. indeed, the technology can be used to target and develop markers for causative sequence changes within genes, which are much preferred  as they are “perfect” markers, not subject to the breakdown often associated with markers based on polymorphisms that are merely linked genetically. although the lengths of amplicons that can be sequenced using low-cost platforms such as illumina are presently shorter than can be assessed for mutations by conventional tilling , advances in technology continue to increase read lengths with 400 bp now being achievable with the ion torrent platform, for example
 <cit> . already, however, the additional cost of amplifying multiple smaller amplicons for analysis involving bat-tailing is more than off-set by the efficiency of the process, which is able to detect mutations in multiple co-amplified pcr-products. the ability to use the methodology to detect mutations within mixed amplicons establishes bat-tailing as a valuable technique for exploiting mutation breeding approaches in polyploids.

