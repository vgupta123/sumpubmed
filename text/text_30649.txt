BACKGROUND
the combinatorial binding of trans-acting factors  is an important basis for the spatial and temporal specificity of gene regulation . combinations of tfs have been shown to regulate gene expression stripes in the drosophila embryo  <cit> , to generate cell-type-specific signaling responses  <cit> , and to program cell fates  <cit> . in this paper we call each distinct set of tfs that bind together to the same regulatory regions a regulatory module.

understanding the interplay among regulatory modules is essential to dissect the complexity of gene regulation. previous studies have found that tfs tend to bind in clusters, which are typically characterized by a large number of tf binding sites in a regulatory region . these co-binding tfs may belong to different functional modules that can be combined in regulatory regions to achieve specific functions. for example, gene regulation is initiated by the interaction of enhancer-bound tfs, promoter-bound tfs, and tfs that bring the enhancers and promoters together in three dimensions, such as mediator, ctcf, and cohesin . therefore, ctcf/cohesin modules may co-occur with enhancer-related modules, promoter-related modules, or both. such module co-occurrences suggest that combinatorial binding of tfs may be organized in a modular hierarchy: a regulatory region may use a combination of multiple regulatory modules, which are, in turn, combinations of multiple tfs.

however, previous methods for studying combinatorial binding do not consider the modular organization of tf co-binding. early work in discovering tf co-binding was limited to lower organisms or to the computational prediction of motif sites . the systematic discovery of regulatory modules in humans has recently become possible with large-scale efforts such as the encode project to comprehensively profile the in vivo binding of tens to hundreds of tfs in multiple human cell types  <cit> . initial analyses of the encode data were limited to either pairwise tf co-binding  <cit>  or tf co-binding in the genomic regions bound by a particular tf  <cit>  and thus did not allow comprehensive discovery of higher order combinatorial binding. hard-clustering-based methods have been applied to genome-wide binding data. for example, self-organizing maps  have been used to explore and visualize the colocalization patterns of tfs  <cit>  and k-means clustering has been used to characterize the combinatorial regulation of erythroid enhancers  <cit> . these methods model tf binding at a given region with a single module and consequently require a large number of modules to fully represent the complexity of tf combinatorial binding. for example, xie et al. applied som to a dataset from k <dig> cells and estimated the optimal number of neurons  for the resulting som to be  <dig>   <cit> . non-negative matrix factorization , a soft clustering method, has also been applied to infer tf interactions  <cit> . however, this work did not explicitly explore the issue of multiple module usage and predicted only a small number of tf combinations  <cit> . it notably failed to capture the well-studied ctcf/cohesin interaction  <cit> . therefore, we have found that existing methods are not suitable for modeling the modular structure of multiple regulatory modules in the same regulatory regions.

the need to model the modular organization of regulatory modules motivated us to use a probabilistic topic model that can represent modular tf co-binding in regulatory regions. topic models have been widely used to discover thematic structures in a large corpus of documents  <cit> . a topic model decomposes documents into a set of all shared topics, where a topic is a set of words that co-occur in multiple documents. the factoring of a document into multiple topics permits the discovery of compact and coherent topics that can be combined to accurately represent a document. this factoring results in better performance in predicting held-out data than mixture models  <cit> , which are hard-clustering methods that force a document to be described by a single topic. topic modeling has been used to discover gene expression programs  <cit>  and microrna regulatory modules  <cit> , but it has not yet been applied to study tf combinatorial binding.

regulatory module discovery  applies a topic model to systematically discover regulatory modules using a large compendium of in vivo tf binding data. we show that rmd discovers more compact and comprehensive modules than other methods. applying rmd to data from human k <dig> cells, we discovered diverse sets of regulatory modules and found that tens of thousands of regulatory regions use multiple modules in a modular manner. we found that, for certain tfs, direct  and indirect  binding of the tf associates with distinct sets of co-binding partners. finally, our analysis discovered cell-type-specific modules and shared modules, and that a given regulatory region can utilize different modules in different cell types. overall, our results provide comprehensive cell-type-specific global maps of regulatory modules and suggest a modular organization of tf combinatorial binding in regulatory regions.

RESULTS
regulatory module discovery  discovers more compact and comprehensive regulatory modules than other methods
rmd discovers regulatory modules given binding data for a large set of regulatory regions. rmd is based on hierarchical dirichlet processes  <cit> , a bayesian non-parametric topic model that automatically determines the number of modules based on the complexity of the observed data. to use conventional document topic model terminology, regulatory regions are “documents,” tf binding sites are “words,” and regulatory modules are “topics.” as in the document model, a regulatory region may utilize one or more modules, and a tf may participate in multiple modules.

the co-binding of tfs in regulatory regions across the genome can be represented without loss by a region-tf matrix. in the work below, a full region-tf matrix would be of size ~ <dig>  regions by  <dig> tfs and is difficult to directly interpret. using topic modeling, a large region-tf matrix is summarized into a compact module-tf matrix  and a tf site assignment table . the module-tf matrix describes the set of regulatory modules discovered, with each module represented as a probability distribution over all the tfs. the assignment table assigns each tf binding site from each region to one of the modules. the assignment table can be further summarized into a region-module matrix  that describes which modules each regulatory region uses.fig.  <dig> rmd discovers compact and comprehensive regulatory modules. a rmd discovers regulatory modules from regulatory regions across the genome. a region may use one or more modules. a factor may participate in one or more modules. rmd uses a topic model to summarize the binding data into modules and to assign binding sites to the modules. b the topic model re-capitulates the original binding data more accurately than k-means clustering and nmf. each point in the scatter plot represents the pearson correlation coefficient between a pair of tfs calculated using the original binding data  or calculated using the reduced data matrix  by topic model, k-means clustering, or nmf . c a heatmap shows the pearson correlations between topic model modules and k-means clusters . the modules are ordered as in fig.  <dig>  bottom bar chart shows the maximum correlation values for each k-means cluster. all k-means clusters are matched by at least one module, with a maximum correlation value larger than  <dig> . right bar chart shows the maximum correlation values for each module. ten modules cannot be matched by any k-means clusters




we first tested the ability of rmd, k-means clustering, and nmf to accurately capture tf-tf correlations that are present in the binding data. we used a compendium of chip-seq data from  <dig> tfs in human k <dig> cells  <cit> , and then pooled and merged all the tf binding sites into ~ <dig>  non-overlapping co-binding regions, each of which was required to contain at least  <dig> tf binding sites. we applied the three methods to these ~ <dig>  co-binding regions and constrained them to discover the same number of modules . then for each method, we evaluated how well the pairwise tf correlation scores from the module-tf matrix correlate to those from the original region-tf matrix. we found that the topic model modules more accurately recapitulate the pairwise tf co-binding relationship in the original data  than the modules learned from the other two methods  . when the number of modules k is increased to  <dig>  the performance of k-means clustering and nmf improves to r =  <dig>  and r =  <dig> , respectively . in addition, we observed that the k-means modules tend to be more similar to each other than those from rmd and those from the original binding data . because hard-clustering-based methods do not factor complex binding regions into multiple modules, they generally generate more similar modules and need more modules to represent the structure in the data than a topic model. however, the increase in module count makes the interpretation of the modules harder. in the limit, increasing k to the total number of regions will exactly recapitulate the original binding data but will not permit common patterns of co-binding to be observed.

given that rmd needs fewer modules to represent the binding data than k-means clustering, we then asked whether the rmd modules were sufficient to represent the clusters produced by k-means . for this analysis, we considered an rmd module to match a k-means cluster and vice-versa if the pearson correlation between the module/cluster vectors is greater than  <dig> . we found that all the k-means clusters  are matched by rmd modules, while  <dig> rmd modules are not matched by any k-means cluster for k =  <dig> . these unmatched rmd modules are used in small number of regions and often co-occur with other more widely used modules. for example, module  <dig>  binds in  <dig> regulatory regions that are highly enriched with genes involved in immune response  and interferon alpha/beta signaling , as shown by a great analysis of annotation enrichment  <cit> . two thirds of these regions also use other modules such as enhancer or promoter modules. other modules that are not identified by k-means include co-binding of zbtb <dig>  <cit>  and promoter associated factors , and of pol3 + bdp1 + atf <dig> . even when k is  <dig> for k-means,  <dig> rmd modules are not matched by any k-means cluster, while all the k-means clusters are matched by rmd modules . these comparison results are robust across different correlation cutoff values for matching the modules . the unmatched modules are missed by k-means clustering likely because they are over-shadowed by the other more widely used modules in the same regions.

in summary, our analysis shows that rmd is better at decomposing complex binding regions into a combination of specific modules and learning a set of more accurate, compact, and comprehensive modules than hard clustering and matrix factorization approaches.

a global map of regulatory modules in human cells
applying rmd to the k <dig> dataset, we discovered a global combinatorial binding map consisting of  <dig> regulatory modules . we also applied rmd to data from gm <dig> cells  and discovered  <dig> modules .fig.  <dig> 
trans-acting factors bind in a complex combinatorial and context-specific manner. rmd was applied to a compendium of chip-seq binding sites of  <dig> tfs  in human k <dig> cells and discovered  <dig> modules. each cell in the heatmap represents the z-score of the tf binding site count  of a tf  in a module . the bottom bar plot shows the total number of binding sites of the tfs. the right bar plot shows the number of regions that use the modules. the top and left dendrograms were computed by applying hierarchical clustering on the regulatory module matrix with pearson correlation distance and average linkage. the module and tf labels are colored according to the hierarchical clusters. selected groups of similar modules are labelled based on the major tfs participating in each module




we found that the discovered modules are easy to interpret and reveal coherent functional groups of co-binding tfs. the modules discovered from k <dig> cells capture known sets of factors that interact with each other or function as a complex, such as the following:the master regulators gata <dig>  gata <dig> and tal <dig>  <cit> ; and the enhancer-binding co-activator p300

the transcriptional machinery pol <dig>  tbp, and taf1; promoter-binding tfs such as e2f <dig>  <cit> ; and transcription start site associated chromatin regulators such as phf <dig>  <cit> , etc.

ctcf, cohesin subunits rad <dig> and smc <dig>  and znf <dig>  <cit> 

pol <dig> transcriptional machinery  <cit> 

ap- <dig> factors such as jun/junb/jund/fos/fosl  <cit> 

maf/bach1/nfe <dig>  <cit> 

myc/max/usf/e2f <dig>  <cit> 

spi <dig>  and elf <dig>  <cit> 




to further evaluate whether the discovered modules were consistent with known tf interactions, we compared tf co-occurrences in these modules with published in vivo protein-protein interactions assayed by antibody immunoprecipitation and mass spectrometry  in k <dig> cells  <cit> . because of the limited coverage of the ip-ms dataset, we were not able to evaluate the specificity of the tf combinations we discovered. similar to the original study  <cit> , we evaluated the sensitivity in recovering the ip-ms interactions using tf-tf associations discovered by rmd. among the  <dig> tfs we studied,  <dig> physical protein-protein interactions were identified in the published ip-ms dataset,  <dig> of these tf interactions are captured as tf combinations in the k <dig> regulatory modules  . the fraction of overlap is similar to the original study, which discovered tf co-binding as  <dig>  som neurons   <cit> . thus, rmd is able to recapitulate previous findings with a much smaller number of interpretable modules.

we then examined whether the discovered regulatory modules were consistent with the chromatin states of the regulatory regions that use them. we annotated regulatory regions by dnase hyper-sensitivity, histone modifications, and the genome segmentation annotations derived from them  <cit> . for the regulatory regions that utilize the same modules, we computed the fraction of the regulatory regions that overlap with these annotations. we found that for the regions using the same modules, the chromatin states of the regions are consistent with the functions of the tfs participating in the modules . for example, modules with master regulators of k <dig> cells and co-activator/co-repressors gata1 + gata2 + tal1 + p300 + rcor1 + tead <dig> are used in regions that are annotated with enhancer chromatin state and are enriched with h3k4me <dig> histone modification, while the pol2/promoter modules are used in the regions that are annotated with tss  chromatin state and are enriched with promoter-associated histone modifications such as h3k4me <dig>  h3k9ac, and h3k27ac. most regulatory modules are used by regulatory regions that are dnase hypersensitive, which may be explained by the preferential binding of tfs in open chromatin. consistent with a previous study  <cit> , the modules used in the non-dnase hypersensitive regions are pre-dominantly repressive modules with heterochromatin-bound factors, such as module  <dig>  and module  <dig> .fig.  <dig> epigenomic annotation and principal component analysis of the k <dig> regulatory modules. a a heatmap showing the fraction of regions using the same modules  overlapping the specific annotations . the modules  are ordered as in fig.  <dig>  the top dendrogram was computed by applying hierarchical clustering on the fraction matrix with pearson correlation distance and average linkage. b principal component analysis  was performed on the factor-module matrix. the pca loadings of the modules for the first four pcs. c the scatter plot shows the tf binding site counts projected on the principal components   <dig> and  <dig>  the percentage labels in the x and y axes represent the percentages of variance explained by the pcs  <dig> and  <dig>  respectively. d similar to c. the tf binding site counts projected on the pc <dig> and pc <dig>  cs: chromatin state; t: transcribed region; r: repressed region; pf: promoter flanking region; tss: promoter region including tss; e: enhancer region; we: weak enhancer or open chromatin region




to further characterize the potential functions of the regulatory modules we discovered, we performed systematic gene ontology  analysis using great  <cit>  on the genes proximal to the regions that use the same modules. we clustered the enriched go terms based on the fdr q-values of the enrichment across the  <dig> modules. we found that specific go terms are enriched in the regions using specific modules . for example, housekeeping functions are enriched in promoter modules; regulatory functions and cell-type-specific terms such as “hematopoietic or lymphoid organ development” are enriched in both the enhancer and ap <dig> modules.

to facilitate interpretation, we further clustered modules that are driven by similar sets of tfs into  <dig> module groups. the modules in the same group share the same set of main tfs, yet differ in some specific minor tfs. for example, in the ctcf group, modules  <dig> and  <dig> both contain the tfs ctcf, rad <dig>  smc <dig>  and znf143; module  <dig> includes arid3a and cebpb, while module  <dig> includes max, zbtb7a, myc, and yy <dig> 

rmd is able to discover widely used regulatory modules as well as very specific modules. for example, the promoter, enhancer, and ctcf modules are each used in more than  <dig>  regulatory regions. at the same time, a small and specific module, znf274 + trim28 + setdb <dig> , which has been shown to specifically bind at the 3′ ends of zinc finger genes and suppress their expression  <cit> , is used in only  <dig> regions.

to reveal the structure and importance of the discovered regulatory modules, we applied principal component analysis  to the module-tf matrix. we found that modules are reduced to principal components  that correspond well with the major module groups : the first pc is contributed mainly by the ctcf modules, explaining 35% of the total variance; the second pc is contributed mainly by the pol2/promoter modules, explaining 18% of the total variance; the third and fourth pcs are contributed mainly by the p300/enhancer and ap- <dig> modules, explaining  <dig> and 10% of the total variance, respectively. in total, the first four pcs account for 79% of the total variance. these results indicate the dominant roles in genome-wide dna binding of ctcf and cohesin, which have been suggested as key participants in shaping the three-dimensional genome structure  <cit> , followed by promoter-binding factors and enhancer-binding factors. we found that the relative influence of the modules is not correlated with the number of factors in the modules because fewer factors contribute to the ctcf modules than to the promoter or enhancer modules.

regulatory module analysis identified distinct binding partners of nfy in different regions
in addition to identifying the global trends in the regulatory modules, the combinatorial patterns for certain groups of tfs also generate hypotheses about tf interactions. the modules we discovered reveal context-dependent co-binding as reported in previous work. for example, we found that fos mainly participates in five modules , which recapitulate four categories of fos co-localization patterns reported previously  <cit> . although the fifth fos category “ap1-hot” does not directly correspond to a single module, it can be factored into ap <dig> and promoter modules that are mixed in those regulatory regions. in addition, we found that the category of fos + nfyb can be further divided into fos + nfyb + sp <dig>  and fos + nfyb + usf , which we discuss in more details below.

nfya and nfyb  both participate in modules  <dig> and  <dig>  together with the co-binding partner fos  <cit> . however, in module  <dig>  nfy and fos co-associate with usf <dig>  usf <dig>  atf <dig>  and max, while in module  <dig>  they co-associate with sp <dig> and sp <dig> . we verified that these two modules are used predominantly in different regions. more specifically, we found  <dig> regions that are bound by both nfy and usf <dig> but not by sp <dig>   <dig> regions that are bound by both nfy and sp <dig> but not by usf <dig>  and only  <dig> regions that are bound by nfy, and both sp <dig> and usf <dig> . the majority of the regions using the nfy + sp module are tss-proximal regions, while most of the nfy + usf regions are distal regions. furthermore, nfy and usf <dig> co-binding exhibits a strong spacing constraint, with  <dig> co-bound regions exhibiting a 21-22 bp spacing between nfy and usf <dig> motif-supported sites. on the other hand, nfy and sp <dig> co-binding does not appear to have a specific spacing constraint. enrichment analysis using great  <cit>  shows that: the nfy + usf bound regions are near genes with ontologies such as “nuclear estrogen receptor alpha network pathway” , “steroid hormone receptor binding”  and “homeobox protein, antennapedia type, protein family” ; while the nfy + sp bound regions are near genes with ontologies such as “krüppel-associated box protein family” , “positive regulation of nuclease activity”  and “cholesterol biosynthesis” . taken together, the regulatory module analysis identified that nfy and fos bind with distinct combination of factors in different types of regulatory regions that may regulate genes with distinct functions. nfy and sp <dig> have been shown to bind to promoters of a number of genes synergistically  or competitively  <cit> . nfy and usf co-bind as a complex to the promoter of hoxb <dig> gene in hematopoietic cells  <cit> . here we find extensive nfy + sp and nfy + usf context-specific co-bindings occur in a mutually exclusive manner in thousands regions, suggesting the possibility of different dna binding modes for nfy and different consequences of gene regulation. these results highlight that systematically discovered regulatory modules may be used to generate specific hypothesis that can be tested with more detailed analysis.fig.  <dig> regulatory module analysis identified distinct binding partners of nfy in different regions. a nfy  and fos participate in two distinct modules. they co-bind with sp <dig> and sp <dig> in module  <dig> while in module  <dig>  they co-bind with usf <dig> and usf <dig>  atf <dig> and other factors. the scatter plot shows the number of binding sites of each factor in the two modules. b nfyb binds exclusively with usf <dig> or sp <dig>  each with different spacing constraints. the first  <dig> columns show chip-seq read enrichment of nfyb, sp <dig>  and usf <dig> in a 1-kbp window around the nfyb binding sites. the 4th column shows sequence plots in a 100 bp window around the nfyb binding sites. the regions are centered at the nfyb binding sites and sorted by the distance between nfyb and usf <dig> or nfyb and sp <dig>  respectively. the sequence motifs for usf <dig> and sp <dig> can be observed around the nfyb motifs. green, blue, yellow, and red indicate base a, c, g, and t




the combinatorial rules of direct versus indirect binding
we next compared the co-binding partners of tfs when they bind directly  and indirectly  to the genome. we define direct binding as the binding of a tf at sites that contain the cognate motif of the tf, and indirect binding as binding at sites that do not contain a detectable cognate motif. previous studies have found that many chip-seq binding sites of sequence-specific tfs do not contain the cognate motif of the tfs, suggesting that binding may be indirect through the interaction with co-binding tfs  <cit> . understanding the combinatorial patterns of direct binding versus indirect binding may reveal the co-binding tfs that facilitate indirect binding.

for each sequence-specific factor x, the binding sites were divided into two groups: dx sites  where x motif is present; ix sites  where x motif is not present. for example, ctcf sites were divided into dctcf and ictcf sites. these two groups were then treated as binding sites of distinct tfs. for the k <dig> dataset, this motif-based division expanded the total number of the tfs to  <dig>  with  <dig> pairs of direct and indirect binding “factors” and  <dig> non-sequence-specific factors. applying rmd to these data, we discovered  <dig> modules with the expanded set of direct and indirect factors . we then investigated the presence of co-binding factors that are specific to direct or indirect binding. for example, previous work reported that fos co-localizes with nfyb  <cit> . our analysis showed that this co-localization mostly occurs between indirect fos binding and both direct and indirect nfyb binding  . to more systematically investigate the indirect binding of factors, we compute the pairwise correlation between all the  <dig> direct binding factors and all the  <dig> indirect binding factors across their module participation profiles . a high correlation means similar module participation, indicating that the indirect binding factor likely associates with the corresponding direct binding factor. we found several groups of such associations: indirect binding of fos with direct binding of nfy + sp1 + sp <dig>  indirect binding of e2f <dig> with direct binding of myc + max + bhlhe40 + usf + mxi1 + yy <dig>  and indirect binding of atf <dig> with fos + fosl1 + junb + jund + jun.fig.  <dig> direct versus indirect tf binding can be explained by the specific combination of co-binding tfs. a fos co-binds with different set of tf partners when binding directly or indirectly. a subset of the regulatory module matrix that involves fos binding are shown. each cell in the heatmap represents the tf binding site count of a tf  in a module . dtf  represents the direct binding sites. itf  represents the indirect binding sites. b rmd discovered specific combinations of tf indirect and direct binding. the heatmap shows the correlation between direct binding and indirect binding of  <dig> tfs based on their module participation. the top and left dendrograms were computed by applying hierarchical clustering on the correlation matrix with pearson correlation distance and average linkage. yellow boxes label combinations of tf indirect binding  and direct binding . c direct/indirect binding of some tfs can be predicted with high accuracy using the binding of co-binding tfs. a random forest classifier was trained to predict whether a tf binds directly or indirectly using the binding of the other tfs. each point in the scatter plot is a tf. for a tf, a larger difference between the modules of direct binding and indirect binding corresponds to a higher the prediction accuracy by the random forest




furthermore, we observed that the direct binding sites and indirect binding sites of some factors participate in very different modules. for example, direct fos binding co-occurs with ap- <dig> factors  and maf + bach1 + nfe <dig> , while indirect fos binding co-occurs with nfy + sp1 + sp <dig>  or nfy + usf1 + usf <dig>  .

with the observation that direct and indirect binding sites of some factors associate with different combination of factors, we reasoned that it would then be possible to predict whether a sequence-specific tf binds dna directly or indirectly based on the proximal binding of other tfs. to test this hypothesis, we trained a random forest classifier to predict whether a tf binding site is a direct or indirect site using the proximal binding of other tfs in the region. we quantify the difference between the direct and indirect binding partners of a tf by introducing a tf diversification score, which is defined as the pearson correlation distance between direct and indirect binding modules of the tf. for factors with high tf diversification scores, such as fos, jun, junb, jund, myc, srf, usf <dig>  and mxi <dig>  the classifier predicted the direct/indirect binding of the factors with 80-95% accuracy . furthermore, the ability to accurately predict direct and indirect binding of a tf is highly correlated to the tf diversification scores . the higher the tf diversification score, the higher the prediction accuracy of the random forest classifier . these results confirm that the direct and indirect binding of certain tfs can be explained by the specific combination of co-binding factors.

many regulatory regions use more than one module
to understand the interplay among regulatory modules in regulatory regions, we investigated the extent of multiple-module usage by regions. the multiple-module usage is a structure that cannot be discovered by previous hard-clustering-based approaches, but can be revealed by rmd. we found that  <dig>  regulatory regions  use more than one module . for example, we found  <dig>  regions that use both enhancer and ap- <dig> modules ,  <dig>  regions that use both promoter and ctcf modules, and  <dig>  regions that use both promoter and enhancer modules . notably, more than 63% the regions that use both enhancer and promoter modules are marked by both h3k4me <dig>  and h3k4me <dig>  histone modifications , but they are annotated as either tss/promoter or enhancer/weak enhancer chromatin states  <cit> . this represents a limitation of genome annotation methods that only assign a single label to a genome segment. furthermore, a module may co-occur with different other modules in distinct types of regulatory regions. for example, ap- <dig> modules co-occur with enhancer modules in the regions annotated with strong/weak enhancer chromatin states  <cit> , co-occur with ctcf modules in regions mainly annotated with ctcf state, and co-occur with promoter modules in regions mainly annotated with tss/promoter state . these different type of regions were also found to associate with different functional categories by a great analysis  <cit> : the ap- <dig> and enhancer module co-bound regions are enriched with genes involved in “platelet activation” , “regulation of inflammatory response” , “regulation of translation” , and “myeloid leukocyte activation” ; while the ap- <dig> and promoter module co-bound regions are enriched with genes involved in “viral process” , “protein kinase binding” , and “apoptotic signaling pathway” . these differences in functional enrichment suggest that ap- <dig> module carries out distinct functions when it is combined with different type of other modules.fig.  <dig> a large number of regulatory regions use multiple regulatory modules. a a histogram of the number of regulatory modules used in a regulatory region. b co-occurring modules partition the regions that use ap- <dig> modules into distinct functional categories. left panel: a heatmap showing the region-tf binding matrix of the regions co-bound by ap- <dig> and enhancer modules, ap- <dig> and ctcf modules, and ap- <dig> and promoter modules. the tfs are in the same order as in fig.  <dig>  right panel: a heatmap showing the chromatin state annotation of the same regions. e/we: enhancer/weak enhancer state; ctcf: ctcf state; tss: tss/promoter state. c an 80-bp region that contains binding sites assigned to a ctcf module  and a promoter module . note that the positions of the sites assigned to different modules are mixed spatially




to ensure that the discovery of multiple-module usage was not the result of inappropriate merging of proximal regulatory regions, we chose a more conservative inter-site distance, 50 bp, for merging the sites into regions. furthermore, we studied the positions of the binding sites that are assigned to different regulatory modules. in many cases, the binding sites assigned to distinct modules are spatially mixed. for example, in an 80 bp region on chromosome  <dig>  ctcf, ctcfl and rad <dig> sites from a ctcf module are mixed with pol <dig>  e2f <dig>  max, egr <dig>  and other sites from a promoter module . such co-occurrences between ctcf and promoter modules are consistent with previous findings that ctcf mediate long-range dna-looping interactions between enhancers and promoter  <cit> , and that znf <dig> binds directly to the promoters and occupies anchors of chromatin interactions connecting promoters with distal enhancers  <cit> .

in summary, our analysis suggests that multiple-module usage is a prevalent aspect of regulatory activities in the cells and it is revealed by rmd.

cell-type-specific regulatory modules
we next investigated if we could observe cell-type-specific and cell-type-common regulatory modules. we used chip-seq data of  <dig> tfs that were profiled in both k <dig> and gm <dig> cells  <cit> . following a previous approach  <cit> , we constructed the co-binding regions in each cell type separately  and then combined the data from all regions from both cell types for rmd analysis. rmd discovered  <dig> modules that describe the binding of the  <dig> factors in k <dig> and gm <dig> cells . to aid interpretation of the modules, we clustered them into  <dig> module groups. interestingly, the promoter-associated modules and ctcf-associated modules are each clustered into one group that is common to k <dig> and gm <dig>  while the enhancer-associated modules are clustered into two cell-type-specific groups.fig.  <dig> common and cell-type-specific regulatory modules. a rmd was applied to chip-seq binding sites of  <dig> tfs in human k <dig> cells and gm <dig> cells. each cell in the heatmap represents the z-score of tf binding site count  of a tf  in a module . the bottom bar plot shows the total number of binding sites of the tfs. the right bar shows the percentage of the sites contributed from k <dig> data for the modules. the top and left dendrograms were computed by applying hierarchical clustering on the regulatory module matrix with pearson correlation distance and average linkage. b a scatter plot showing that the cell-type-specific modules are preferentially used in the differentially bound regions in k <dig> cells and gm <dig> cells. c distinct cell-type-specific modules are used in the same genomic regions in different cell types. a set of  <dig> regions that are bound by k <dig> enhancer module factors in k <dig>  and by gm <dig> enhancer module factors in gm <dig> cells . the tfs are in the same order as in a





to investigate the degree of cell-type-specificity of the discovered modules, we computed the fraction of the binding regions that are contributed from the k <dig> data or from the gm <dig> data for each module. we found that some combinations of factors are mainly used in k <dig> cells and others are mainly used in gm <dig> cells even though all of the  <dig> factors bind regulatory regions in both cell types . in particular, many enhancer modules are preferentially used in one cell type. in k <dig> cells p <dig> co-binds with jund, jun, rcor <dig>  atf <dig>  fos, cebpb, mafk, max, and myc , but in gm <dig> cells p <dig> co-binds with mef2a, sp <dig>  spi <dig>  bclaf <dig>  bcl <dig>  and bhlhe <dig> . both cell types share other module groups, such as the promoter and ctcf module groups. in the regulatory regions that are bound in k <dig> or gm <dig> cells but not bound in both cell types, cell-type-specific modules are used preferentially by one cell type, while shared modules are used in both cell types .

we next investigated if a regulatory region that is bound in both cell types uses cell-type-specific regulatory modules. out of  <dig>  regions that are bound in both cell types, we found that  <dig>  regions use a different enhancer module in the two cell types . for these  <dig>  regions, module group  <dig> is used in the k <dig> cells and module group  <dig> is used in the gm <dig> cells. thus although these regions are bound in both cell types and may act as enhancers, as suggested by the binding of transcriptional co-activator p <dig>  they are bound by cell-type-specific combinations of factors in k <dig> and gm <dig>  in addition, we found  <dig>  regions that are bound by ctcf module factors in both k <dig> and gm <dig> cells, and also bound by the k <dig> enhancer module factors in k <dig> cells, suggesting the usage of k562-specific enhancers in these ctcf/cohesin bound regions. in summary, important differences can exist between the set of regulatory modules that bind the same regulatory regions in distinct cell types.

CONCLUSIONS
gene regulation specificity is orchestrated by the interactions among a complex group of trans-acting factors that we have organized into distinct combinable modules. previous methods have modeled tf combinatorial binding as pairwise interactions or as a single module at a given regulatory region; they are thus not able to capture the complexity of modular combinatorial binding. we have developed a new approach to summarize high-dimensional binding data into combination of combinatorial binding modules. our approach can provide important insights into the mechanisms of gene regulation not available with previous hard-clustering-based methods. the modules discovered are easy to interpret individually and as a whole, capturing key aspects of global combinatorial binding patterns and providing a resource for generating new hypotheses for tf interactions.

our analysis reveals that modular combinatorial binding occur in tens of thousands of regions and that specific combination of modules may regulate distinct functional groups of genes, suggesting that multiple-module usage is a prevalent aspect of regulatory activities in the cells. modeling tf combinatorial binding as regulatory modules helps to dissect the complexity of combinatorial binding of many tfs into compact and easily interpretable modules. moreover, such explicit modeling of modular structure helps to uncover specific modules that are combined with other modules and are easy to be missed by previous approaches. with a larger number of additional tfs being assayed by large-scale efforts such as the encode project  <cit> , we expect that rmd will be useful in revealing the complexity of combinatorial binding in these future data.

previous work attempted to distinguish between direct and indirect tf in vivo binding by integrating in vivo nucleosome occupancy data and in vitro protein binding microarray experiments  <cit> , or by using tf binding motifs and dnase-seq footprints  <cit> . in this work, we discovered that the direct and indirect dna binding of certain tfs is associated with distinct sets of co-binding partners and that without using motif information the co-binding partners alone can predict whether the tf binds directly or indirectly with high accuracy. in addition, our direct/indirect combinatorial binding maps allow prediction of co-binding tfs that may facilitate the indirect binding of tfs. the direct/indirect binding analysis was conducted with a simplified classification of the binding sites based on whether they contain a detectable cognate motif. recent studies show that clusters of low-affinity binding sites with degenerate motifs can be functional  <cit>  and that binding sites without consensus motifs may use dna shape to facilitate the in vivo binding of tfs  <cit> . future analyses that take into account the clustering of binding sites and the dna shape information may gain more insights on the role of combinatorial binding of co-binding factors on tf binding.

our method is a general method for studying tf combinatorial binding. it can be applied to various cell types and species  <cit>  where sufficient binding data are available. one potential limitation on studying combinatorial tf binding from chip-seq data is the relative scarcity of high quality antibodies. to expand rmd combinatorial binding analysis to more tfs or to cell types that do not have sufficient chip-seq data, one strategy is to augment or replace chip-seq data with tf binding predicted from dnase-seq  <cit>  or atac-seq  <cit>  data and tf motif information  <cit> .

