BACKGROUND
laboratories preparing dna for illumina sequencing have access to a quantity of protocols and commercial kits and their numbers are constantly increasing. these kits vary not only in price but also in their protocol. some of them follow the classical protocol of shearing, end-repair, a-tailing, adaptor ligation and amplification with clean-up between most or all steps, while others have bespoke adaptor ligation steps, or combine several of these steps into a single one, or don’t even require any amplification at all  <cit> . the nature of the protocol and reagents used might greatly affect the efficiency of the library preparation but very few laboratories conduct a quantitative comparison between several available kits before choosing the most appropriate one for their specific application .

we developed an assay based on droplet digital pcr  technology to measure the amount of dna remaining after each steps of a protocol, as well as the percentage of fragment bearing adaptors at their ends after the ligation step, or p5/p <dig> primers after amplification  <cit> . in contrast with qpcr, ddpcr doesn’t require the use of any standards to calculate the absolute number of specific molecules in a sample . this allows the quantification of not only the overall yield, as normally done with qpcr, but also of the yield of some critical intermediate steps such as the adaptor ligation .

we present here the quantitative comparison of  <dig> kits: nebnext and nebnext ultra from new england biolabs, sureselectxt from agilent, truseq nano and truseq dna pcr-free from illumina, accel-ngs 1s and accel-ngs 2s from swift biosciences, and kapa hyper and kapa hyperplus from kapa biosystems. all libraries were prepared using the same dna sample , and the different kits where compared in terms of overall and stepwise efficiencies, dna loss, protocol length, flexibility and complexity. we also noticed variations in the size of the final libraries despite the use of identical bead ratio during the clean-up steps. our results should help laboratories already present or entering the ngs field to choose the most appropriate kit for their specific applications and requirements.

RESULTS
dna library preparation kits for illumina sequencing
we tested  <dig> kits listed in table  <dig> following the protocol recommended in each manual but keeping the ratio of beads during the clean-up steps, the pcr reagents and settings for the amplification step identical between kits in order to allow a direct comparison between the ddpcr results. we made sure that these slight modifications always remained in the ranges recommended by the manufacturers. table  <dig> summaries the overall protocol for each of the kits and the total number of steps required. the total number of steps correlates well with the length of the library preparation both in term of overall preparation time and hands-on time. combining several steps into a unique one as it is done in the nebnext ultra and both kapa kits not only decrease the overall preparation time, it also improves the dna recovery as most dna loss occurs during bead clean-up steps  <cit> . the kapa hyperplus kit also contains a fragmentase step instead of the classical mechanical shearing step and post-shearing clean-up necessary before any other kit  <cit> . after fragmentase treatment, the sample can go straight into the end repair and a-tailing step, improving the dna recovery and reducing overall preparation time even further.table  <dig> list of the library preparation kits, dna inputs and adapters tested

accel-ngs 1s c
accel-ngs 2s c
kapa hyperd
kapa hyperplusd,e

aboth end-repair and a-tailing enzymes are combined in a single reaction mix


billumina recommends performing an upper and lower bead clean-up selection after the end repair step


cswift biosciences accel protocols follow different chemical steps than the classical end-repair, a-tailing, adaptor ligation and pcr


dkapa hyper and kapa hyperplus protocol don’t always require a pcr amplification step


ekapa hyperplus protocol starts with non-sheared dna. the 1st step of the protocol corresponds to the enzymatic shearing of the dna sample . this fragmentase step leaves blunt-ended dna fragments which don’t require end-repair and can go straight to a-tailing without any bead clean-up



certain kits offer more flexibility than others when it comes to the choice of adaptors. every kit except the kapa ones provides their own adaptors, however for most of them the users can decide to use their own if necessary. all the adaptors tested in this study exhibit identical sequence in the first dozen double-stranded bases directly involved in the ligation step, ensuring a similar behaviour independently of the adaptor chosen . the exception to this is the kits from swift bioscience where adaptor ligation is split into  <dig> sequential steps, on one dna strand and then the other, making it difficult for the user to use ones’ own adaptors.

yields and dna input
our droplet digital pcr assay allowed us to probe the amount of dna remaining in each sample after a-tailing, after adaptor ligation and after pcr . we also measured the amount of adaptor ligated dna after the ligation step and the amount of fragment bearing p <dig> and p <dig> primers after the pcr step . in the case of truseq dna pcr-free, the adaptor used already contained the p <dig> and p <dig> sequence so that the post-ligation sample is ready for sequencing.fig.  <dig> principle of ddpcr – the droplet generator creates an emulsion with the sample containing the dna, pcr enzyme and buffer, specific primers and taqman probe . only droplets containing a dna fragment will exhibit a high fluorescence after the pcr amplification . the sample is then analysed with a droplet reader which counts the number of fluorescence and empty droplets in a channel corresponding to the initial number of target molecule in the sample

fig.  <dig> schematic of the ddpcr assay to test the amount of dna remaining at each step of the library preparation  and to measure the amount of dna fragment bearing adaptors after the ligation step  and p5/p <dig> primers after the amplification step 

fig.  <dig> example of yield measurements obtained with the nebnext kit when comparing the amount of dna at each step versus the initial dna input . blue bars correspond to values measured using the phix specific primers and reflect the dna loss at each step mainly due to pipetting and bead clean up. the orange bar corresponds to the value measured with the adaptor specific primers and reflects the amount of dna in the sample bearing adaptor after the ligation step in comparison with the initial dna input. the green bar corresponds to the value measured with the p5/p <dig> primers and reflects the amount of sequencable dna in the sample at the end of the library preparation



during all the steps before ligation, low or no dna loss is observed except with the truseq dna pcr-free kit where more than 80 % of the initial dna was lost due to more numerous and stringent bead clean-up steps recommended   <cit> . this explains why the user is advised to start with 1 μg of dna for the truseq dna pcr-free protocol.fig.  <dig> bar charts showing the overall dna library preparation yields of the different tested kits in comparison with the initial dna input . except where mentioned otherwise all libraries were prepared using the original illumina paired end adaptor   <cit> . after end repair and a-tailing, the dna loss was estimated using the phix specific primers . after adaptor ligation, both the dna amount  and the adaptor ligation efficiency  were measured, except for the accel kits for which we were not able to measure directly the adaptor ligation efficiency as the adaptor sequences were unknown and are marked by a start . after pcr, both the total amount of dna  and the amount of dna bearing p <dig> and p <dig> primers at their ends were measured 



after adaptor ligation, we were able to both probe the amount of dna remaining and the efficiency of the ligation reaction itself, which, as expected, was the most critical step of all. unfortunately, in the case of the swift biosciences kits, we were not able to measurement the amount of dna bearing adaptors at their ends due to the specificity of the swift biosciences adaptor ligation chemistry which prevented us from using our own adaptors and primers. for the other kits, the variation of ligation efficiency was very marked; some kits exhibiting such low adaptor ligation yields that it could impair the final complexity of the library , while other performed extremely well. this remains the case even when looking at the yield in a stepwise manner  rather than the overall yield. for nebnext, sureselectxt, illumina truseq nano and kapa hyper, the ligation step yield varies from  <dig> to 40 %. a very low step yield of  <dig>  % was measured for nebnext ultra and in contrast 100 % ligation efficiency was observed for the kapa hyperplus kit.

such variation of ligation efficiencies can be entirely masked when focusing on the post pcr yields. most kits exhibiting an overall post pcr yield between  <dig> and 150 % after 10 cycles of amplification when measuring the amount of fragment bearing p <dig> and p <dig> primers versus dna input, at the exception of the kapa hyperplus kit for which the overall pcr yield is just above 800 %. however the stepwise yields of the pcr steps, when comparing with the amount of dna bearing adaptors just after the ligation, were much more variable with values ranging from 500 % to almost 4000 %. the yields of the pcr step also appeared anticorrelated with the yield of the ligation step.

for kits designed specifically for low dna input, we tested the same dna input as for any other kits, 500 ng, and compared with lower inputs . we noticed that the ligation step was slightly more efficient with the higher dna input, however the same high dna input led to lower pcr step yields . high dna input pcr can indeed inhibit the amplification reaction explaining the anticorrelation observed between ligation and pcr yields; very efficient ligation steps leading to high dna input for the pcr step. other factors such as limiting dntps or primers during amplification might also have a similar effect.

bias on the fragment size
during this study, sample fragment sizes were assayed using a bioanalyzer to check the profile of the input dna  and the final libraries  <cit> . we noticed that the profile of libraries prepared with different kits varied significantly despite the fact that both the dna input and the bead clean-up ratios were kept identical . all the libraries were started with an equimolar ratio of the  <dig> phix dna fragments used and we expect some slight variation after the library preparation as the smallest dna fragment might be prone to more loss during the bead clean-up steps. but the variation observed between kits was much more serious than just loss of the shorter fragments as it can obviously be seen when looking at the example of bioanalyzer traces in additional file 1: figure s <dig> 

to quantify this variation more accurately we calculated the ratio between the  <dig> phix fragments before library preparation  and post library preparation. we then plotted the variation between the pre- and post-library preparation ratios as show in fig.  <dig>  the libraries prepared with the truseq dna pcr-free kit were not included in fig.  <dig> due to the difference in the protocols which prevent us from doing any straight comparison.fig.  <dig> bar chart representing the percentage of variation between the  <dig> different phix fragments before and after library preparation with the different kits tested. for each sample, the molar concentration of the  <dig> phix fragments was estimated before and after library preparation on a bioanalyzer chip. the ratio between the  <dig> fragments before library prep was close to 33 % for each, but important variations were observed after library preparation. here we plotted the difference between the pre- and post-library preparation ratio as a percentage. all the libraries were prepared using the original illumina paired end adaptor  <cit>  except for the truseq nano kit and the swift kits



data quality
all the libraries prepared during this study were sequenced on an illumina miseq platform. to compare the data quality of different libraries, we compared the error rates such as insertions and mismatches . while all libraries performed well with overall error rates lower than  <dig>  %, we observed some differences between kits. both accel kits exhibit higher error rates than the other, above  <dig>  % while all the other kits lead to error rates below  <dig>  %. the main source of error for all the kits was always mismatches however, in the case of accel-ngs 2s kits, insertions were also observed. among the other kits, the neb, agilent and kapa ones had the best performance with error rates below  <dig>  %.fig.  <dig> comparison of sequencing data quality between libraries prepared with different dna library preparation kits. deletions were not detected while insertions  were extremely low for all kits. the most common source of error is mismatches  which vary between  <dig>  % and  <dig>  % depending on the kit used



discussion
we compared the practicability, reproducibility and quality of the libraries and sequencing data produced using  <dig> different kits to prepare illumina dna libraries. what we mean by practicality is the overall time required to prepare a library, the hands on time, and the number of steps involved in the process  <cit> . in our experience, overall preparation time correlates very well with the total number of steps in a protocol when including clean-up steps. therefore any kit combining several steps into a single ones and limiting the number of clean-ups should be favoured if preparation time is a critical parameter in the project. the fastest protocols are the nebnext ultra kit and the kapa kits, particularly the kapa hyperplus, and up to certain extend the illumina truseq dna pcr-free.

certain kits are specifically designed for low dna input such as the nebnext ultra and swift accel-ngs 2s, while others such as the kapa ones accept a wide range of dna input from a 1 ng to 1 μg. however if the ligation efficiency of a kit is very low  as it is the case for the nebnext ultra kit, or if the dna loss during the library preparation is high  as it is the case for the accel kits, the final amount of sequencable dna becomes worryingly low. it is important to highlight that this study focuses on evaluating the efficiency of each steps of different library preparation protocols and we did not assess directly the complexity of the library. bearing this in mind, the kapa hyperplus kit which exhibits a fully efficient adaptor ligation step and less than 10 % dna loss, appears as the kit of choice for any low dna input sample.

the truseq dna pcr-free kit is the only one recommending an input as high as 1 μg due to the stringent clean-up steps to remove both too long and too short dna fragments from the library. nonetheless avoiding any amplification step presents great advantages not only in terms of preparation time but also to minimise bias. the amplification step can indeed introduce artificial mutations which are difficult to distinguish from real snps  <cit> . the sample composition can also be affected by polymerases amplifying preferentially certain fragments over others, and this phenomenon can become very preeminent for non-gc neutral samples . although certain enzymes have been shown to exhibit very high fidelity and low bias even for at- or gc-rich dna, the possibility to simply avoid any amplification at all can drastically improve the data quality for such samples  <cit> . it is important to highlight that not only the truseq dna pcr-free kit but also any other kit exhibiting a high ligation efficiency could potentially be used without any pcr step, as long as the sequence of the used adaptors contains the p5/p <dig> primers sequence necessary for sequencing on an illumina platform.

another factor often ignored is the shearing step. most protocols necessitate already sheared and cleaned-up dna to start the library preparation, and sonication on a covaris instrument is often the method of choice due to its reproducibility and tunability  <cit> . enzymatic shearing presents several advantages such as low cost  and low dna loss   <cit> . however until recently most enzymatic shearing mix available exhibited high bias toward certain gc content samples and difficulties to control the average dna fragment size in a library. but the latest generation of enzymatic shearing mixes such as the fragmentase provided with the kapa hyperplus kit appears much more reliable, controllable and less susceptible to bias . kapa hyperplus isn’t the only kit using such a streamlined protocol and subsequently we have tested other kits such as the neb ultraii that also exhibits very high ligation yields in early testing .

we observed an interesting phenomenon when comparing the ligation and pcr yields of the different kits as both appear almost anticorrelated in our data . an explanation could be that when the initial dna input is low or when the ligation step efficiency is poor, the amount of adaptor ligated dna going into the pcr reaction is very little; on the other hand if the adaptor ligation is very efficient or the starting dna input very high, important amount of dna is going into the pcr reaction. yet high dna substrate isn’t recommended for pcr reactions as it is known to inhibit the amplification reaction. such phenomenon can hide differences between kits since a protocol exhibiting high ligation efficiency will produce a high concentration of pcr substrate  which can inhibit amplification, while on the other hand a kit exhibiting low ligation efficiency will lead to a very efficient pcr , both kits giving similar amount of final library product. a high ligation yield insures the preservation of the sample diversity and decreases the amount of amplification required, avoiding the introduction of additional bias during pcr  <cit> . in that respect the illumina truseq nano and pcr free kits, as well as the kapa hyper kit exhibited some of the highest ligation yields, above 30 %, and the ligation step with the kapa hyperplus was fully efficient.

finally we noticed variations in the ratios of our  <dig> control amplicons in the final libraries when prepared with different kits. we cannot discriminate the two possible sources of variation, fragment size or fragment sequence, and both are most probably playing a role here. to avoid introducing any bias in our comparison, we used the same spri ratio during the clean-up steps with every kit tested except truseq dna pcr-free. however the same truseq nano kit resulted in very different fragment ratios when using the sanger adaptors  <cit>  rather than the illumina adaptors  implying that the sequence of the adaptors and of the dna fragments involved in the library preparation does play a role and might introduce certain bias. the kits leading to the lowest variations  and therefore probably introducing the least bias were kapa hyperplus and nebnext.

CONCLUSIONS
we identified the kits that are the most practical and the most efficient, both characteristics often working hand in hand. using a novel ddpcr assay, we were able to deconvolute the influence of each intermediate step in the library preparation and highlight the significance of adaptor ligation efficiency which can be hidden when focusing only on the overall library preparation yield after amplification. unlike qpcr measurements  <cit> , our ddpcr assay doesn’t require any specific standards and can be used to assess the efficiency of any other kit or protocol not mentioned in this study or not realised yet, providing a great tool for direct comparison and objective selection. the emergence of pcr free protocols and simplified protocols merging several steps into one will certainly improve not only the workflow, overall and hand on times of dna library preparation, but also the chemical efficiency of these.

