BACKGROUND
the number of experimentally determined protein three-dimensional  structures deposited in the protein data bank   <cit>  is increasing exponentially over the years and being progressively automated. the vast majority of such 3d structures is produced by x-ray crystallography. in the case of limited resolution and imperfect phase information often available to the crystallographer, building and refining such a protein model is a process that can depend on the experimentalist. errors are almost unavoidable and the quality of the refined models has to be evaluated in order to assess their validity  <cit> . errors come in various classes  <cit>  and can nowadays range from mistraced segments of the protein to locally incorrect backbone and/or side chain conformations. identification of such errors can be achieved with a combination of experimental and computational parameters.

several quality measures based on experimental parameters exist for x-ray crystallography and have been reviewed  <cit> . x-ray resolution is an index of the quality of the experimental data. it is related to the amount of available data, i.e. to the parameter-to-observation ratio  <cit>  and is an indirect indicator of the maximum attainable details of the protein model. in contrast, the r-free value  <cit>  represents a measure of the fit between the refined structure and the electron density map, highlighting the quality of the refinement. the relationship with resolution is not straightforward, but it is generally assumed that higher resolution structures will produce lower r-free values  <cit> . a different type of information is contained in the luzzati  <cit>  and σa  <cit>  plots. these estimate the mean positional error for all atoms in the protein model. these parameters require the structure factors, but yield the expected uncertainty of atoms in the protein model in a single number estimate . a simpler estimation of the mean positional error is the diffraction precision index based on r-free , which can be computed from the readily available data contained in the pdb files  <cit> .

a wide range of computational quality parameters have been developed and reviewed over the years  <cit> . generally speaking, it is possible to distinguish geometric, energetic and conformational criteria. geometric criteria are mainly standard values for bond lengths and angles derived from small molecule data. these form strong restraints and are generally enforced during the refinement process, so they possess little validation power. energetic criteria are based on evaluation of interaction preferences or profiles  <cit> . while these methods can provide insight into the quality of the structure, their interpretation in experimental terms and feedback into the refinement process is rather difficult.

the most promising validation criteria are based on conformational criteria. the best example is the ramachandran plot  <cit>  of backbone  torsion angles. while each amino acid type may, in theory, adopt a large number of different conformations, large areas of the ramachandran plot are almost empty. this is due to steric clashes deriving from the local geometry of the polypeptide chain. the main chain  torsion angles are usually not restrained during refinement and this makes the ramachandran plot a powerful validation tool  <cit> . several tools have been developed to estimate the quality of a protein model based on the ramachandran plot  <cit> . of these, procheck  <cit>  and what_check  <cit>  are perhaps the most frequently used methods for validation in x-ray crystallography as they are used for judging structures to be deposited in the pdb, combining several stereochemical checks and measures of torsion angle compatibility. hoppscore  <cit>  has been recently developed to take into account higher order backbone torsion angle maps.

several of these methods  are able to pinpoint the really wrong structures through a detailed analysis of different aspects of protein structures. once a structure falls into the range of roughly plausible folds however the situation becomes more complicated. it is possible to construct structures with acceptable values for the standard criteria that are largely incompatible with the protein sequence. in the present work we focus on this aspect of experimental structure validation. given roughly plausible structures, is it possible to quantify the degree of "nativeness" and highlight the best structures?

one possible limit to the previous methods is the difficulty in establishing a quantitative correspondence scale between different structures. i.e. how much is score x for structure a better or worse than score y for structure b? the answer is not obvious, as the reference state is different for structures a and b. one solution would be a normalization procedure adapted to a particular structure. to the best of our knowledge, this has not been done yet. for this reason, we derive a novel measure of sequence to structure compatibility based on the normalization of torsion angle propensities including the side chain. the normalization involves definition of the global minimum and maximum of the protein sequence. the normalized propensity  will be shown to be more accurate than several previous methods at quantifying the degree of "nativeness" of a protein model in terms of commonly used experimental quality parameters on two test sets representing the full pdb database and obsolete pdb structures. a comparison with several energetic criteria on standard protein decoys and theoretical models has already been addressed elsewhere  <cit> .

RESULTS
baseline comparison on the all pdb set
available experimentally derived quality parameters for the all pdb set representing  <dig>  structures is summarized in table  <dig>  while the x-ray resolution information is available for all structures considered, some of the older structures are lacking an r-free value. the cross-validated luzzati and σa plots are present only in roughly one out of three structures, mainly because deposition was not mandatory for a long time. while it is possible to calculate both parameters from the structure factors, we have chosen to limit our comparison only to the publicly available cases.

the pearson correlation coefficients  between the different experimental quality parameters were calculated for the available data . as expected, the correlation between experimental parameters is usually very high . the main exception is r-free with cc <=  <dig>  to the x-ray resolution and dpi . as information contained in the various measures appears largely redundant, we restrict further analysis to resolution and r-free. r-free is not a perfect measure, but rather available for more structures and, perhaps, less inaccurate than the other quality parameters.

in order to estimate the performance of available computational methods, we compare our method with procheck  <cit> , what_check  <cit> , hoppscore  <cit>  and frst  <cit> . this covers all the range from energetic to geometric and conformational criteria. table  <dig> shows the pearson correlation coefficients between computational and experimental parameters for the all pdb set. the best performance is seen for methods using ramachandran plot analysis, i.e. tap and wc_rama, once again confirming its utility in structure validation  <cit> .

for the tap score, the intermediate  bin size of  <dig> degrees shows the highest correlation . a similar trend was already observed  <cit> . this probably maximizes the tradeoff between precise transitions and lack of data to discriminate certain sparsely populated regions in the ramachandran plot. note that a larger background distribution, e.g. covering the entire pdb, was excluded to avoid biasing the comparison.

it is apparent from table  <dig> that some methods work significantly better than others. the statistical potentials  and several geometric criteria do not yield good correlation coefficients. performance of the tap score against r-free is particularly interesting, as the correlation coefficients for r-free are overall lower. tap has a higher correlation against r-free  than the x-ray resolution  has. in order to evaluate the effect of the background distribution on the performance of tap, a further test was made using the tap score based on nmr derived torsion angles. the data reported in table  <dig> shows that, while the usage of high-quality data improves the performance, tap-nmr still significantly outperforms many other methods. for the sake of simplicity, further analysis was restricted to tap and the most diverse parameters. as conformational criteria we have chosen procheck, wc_rama, wc_chi1& <dig>  hopp <dig>  hopp <dig> and hopp <dig>  for the energetic criteria we have restricted our analysis to wc_pack <dig>  solv, rapdf and tors.

detailed comparison on the obsolete pdb set
a set of  <dig> pairs of obsolete pdb structures and their replacement was analyzed in order to evaluate the capacity of the tap score to discriminate better models for the same protein. figure  <dig> shows the number of times each method correctly assigned a better score to the newer, and therefore more accurate, model in the obsolete pdb set. the results for each individual methods and the combination with tap are shown. none of the methods discriminates all  <dig> structures, and the statistical potentials in particular have difficulty recognizing the improved structures, while tap has one of the highest single recognition rates. combining methods improves the overall performance, with tap typically contributing more unique information than the other method. figure  <dig> shows a different analysis of the data in terms of separation z-score, i.e. the normalized difference between the obsolete and replacement structure. here it is again apparent that the ramachandran plot based methods outperform the others, with tap coming a close second with wc_chi1& <dig> after wc_rama. taken together, the ramachandran plot based methods  seem able to qualitatively discriminate improved from obsolete structures.

quantifying absolute model accuracy
another interesting question related to structure quality is whether the methods under consideration are able to quantify the difference between structures, i.e. reliably identify the top x% structures present in the pdb. this problem was addressed in terms of fraction enrichment on r-free , with results shown in figure  <dig>  unsurprisingly, the statistical potentials perform worse than the conformational methods. of the latter group, it is worth noting how wc_chi1& <dig>  based on side chain rotamer preferences, performs worse than methods using backbone preferences. the difference between tap and wc_rama suggests that energy normalization is improving recognition especially with the highest quality structures. this idea is confirmed when comparing tap to tors, the torsion angle propensity energy before normalization.

confidence estimates
since it can be very useful to derive tap score threshold levels indicating the expected quality of a model, the all pdb set was used to derive confidence estimates. the resolution and r-free parameter distributions were analyzed on the all pdb set to estimate average and standard deviation  . three derived threshold levels are shown in table  <dig>  the medium quality class is based on commonly accepted conservative parameter settings, i.e. resolution <=  <dig>  a and r-free <  <dig> , and excludes the 25% lowest quality structures. the high quality class was defined to be just above the average for resolution and r-free, selecting ca. the 40% top structures. the very high quality class was defined at one σ above average and represents ca. the 10% top structures. the distribution therefore appears not to be truly normal, but somewhat skewed towards lower quality structures. similarly, tap score thresholds were chosen from the average to be –  <dig> σ ,  <dig>  and +  <dig> σ .

the results for tap on all three experimental quality classes are expressed in terms of accuracy and coverage  and shown in table  <dig> for the all pdb set. as can be expected, it becomes gradually more difficult for tap to discriminate the structures with increasing quality level. at the same time, coverage drops with increasing tap threshold. taking the intersection between both, tap recognizes ca. 90% of the medium quality structures with 90% accuracy. these values drop to ca. 75% for the high and 35% for the very high quality structures. even in the latter case it implies a significant enrichment in discrimination with respect to a random predictor. to the best of our knowledge, this type of analysis was not performed before. in the context of automated experimental structure determination, it will allow the user to isolate problematic structures for manual refinement and could prove a valid addition to the pdb data deposition procedures.

discussion
database effects vs. novel approach
the ramachandran plot, i.e.  torsion angle preferences, has been seen as a powerful tool for validating experimental protein models for a long time  <cit> . usually, the ramachandran plot is used only as a rather qualitative tool to discriminate grossly mistraced structures from plausible ones. procheck and hoppscore both consider a generic ramachandran plot for the twenty amino acids divided in discrete classes. what_check- <dig> uses a more sophisticated z-score analysis of the ramachandran plot. all of these do not appear to discriminate effectively the compatibility between sequence and structure, nor the subtle differences between amino acids.

the main advantage of tap consists in effectively measuring the compatibility of the sequence with the proposed structure in a detailed, quantitative way. energy score normalization is a novel concept which could be applied because tap is based on a single body potential. this is not usually applicable to pair wise  potentials, where it is difficult to estimate the maximum or minimum interaction between an amino acid and its surroundings. the benefits of energy normalization are apparent from the comparison between tap and tors, the torsion angle potential on which it is based. where tors gives rough indications, tap  has greater accuracy.

since torsion angles are not generally restrained in x-ray crystallography, this compatibility is orthogonal to the data used in refinement and should be expected to give a good indication of the degree of "nativeness" of the protein model. to support this view, rather than a simple improvement based on database growth, a variant of tap was derived from nmr data. even in this case, where the ramachandran plot is on average rather blurred, tap-nmr still outperforms other validation tools. this supports the idea that it is capturing the relationship between sequence and structure rather than a tighter clustering in torsion angle space.

perhaps the most important feature of the tap score is that it simultaneously combines five different torsion angles into a single pseudo-energy value. adding more torsion angles was previously shown to improve the overall discrimination of protein decoys  <cit> , as it captures the subtle interplay between them. for instance, it is known that the ω torsion angle varies slightly depending on the  angles  <cit> . even more widely used is the dependence of the χ torsion angles on , which is widely accepted in side chain modeling  <cit> . a tap variant based solely on the  angles performs significantly worse, with correlation coefficients of - <dig>  and - <dig>  for resolution resp. r-free. this view has been recently reinforced by an elegant statistical and conformational analysis of the electron density of protein side chains showing a vast majority of all residues in high resolution x-ray structures to have rotameric side chain positions  <cit> . therefore, where hoppscore successfully extends the concept of ramachandran plot to higher order  torsion angle pairs, tap score explores the avenue of capturing the interplay between protein backbone and side chain. figure  <dig> shows an example of tap score depending on χ <dig> side chain conformation.

the main limit of the tap score approach is the independence of subsequent residues in the calculation of the global minimum and maximum for normalization. these minimum and maximum are likely to be overestimated, as compatibility along the polypeptide chain is not guaranteed. this may result in impossibly "knotted" structures having the best pseudo-energy and the native structure being lower in normalized score. in principle, adding information about the preceding residue's  torsion angles would alleviate this situation and has been shown to yield more discriminative pseudo-energies  <cit> . however, it is only possible to calculate the global optimum for normalization precisely because it is a single body potential. adding a dependence on the preceding residue would transform it into a two-body potential, making the estimation of the global optimum problematic. calculating the global optimum on such a two-body potential is an optimization problem in itself.

the discriminative power of torsion angle propensities has implications for the accuracy of empirical force fields such as amber  <cit>  or charmm  <cit> . torsion angle propensities derive from the subtle interactions between neighboring residues which cannot be captured very precisely by currently available physico-chemical models  <cit> . this knowledge is one of the reasons for the success of modern de novo folding methods based on assembly of short peptide fragments  <cit> .

small changes in the amber torsion angle parameter between param <dig> and param <dig> have drastic effects on the energy landscape  <cit> . it may be argued that addition of a ramachandran plot propensity parameter could improve the capacity of a force field to capture the local geometric details more precisely. this approach is frequently selected in loop modelling  <cit>  where it is important to reconcile the structural restraints with sequence preference. the method of fiser and co-workers  <cit>  in particular uses the charmm bonded potential augmented by a ramachandran plot propensity term and statistical non-bonded potential to generate loop conformations by minimization. adding a properly calibrated  torsion angle propensity term to a force field may therefore help to improve convergence in energy minimization for molecular mechanics simulations. the option to calculate such values for every single residue also opens up the interesting possibility to use the tap score as a valuable tool during refinement of a crystallographic model, in addition to the already available geometric validation tools.

an interesting question is why some crystal structures exhibit higher tap scores than others. a cursory analysis reveals that the highest scoring structures are short helical bundles, e.g. hemoglobin. the lowest scoring structures are diverse and contain any combination of α-helices and β-sheets. even in the top500h database used for deriving the propensities, the tap scores vary between  <dig>  and  <dig>  . this is comparable to the tap score of very high experimental quality structures varying between  <dig>  and  <dig>  . this may be caused by the rough approximation of the global optimum overestimating some folds more than others due to some intrinsic feature, e.g. higher contact order or lower degree of flexibility. a better way to calculate the global optimum would be needed to exclude this possibility. as local interactions appear to impose the selection of certain amino acids at each structural position in the fold  <cit> , it will however be worth investigating whether proteins whose native structure lies closer to the global optimum could perhaps also have a better sequence to structure compatibility.

CONCLUSIONS
we have presented a novel method for the evaluation of the quality of protein models determined by x-ray crystallography, demonstrated both on a large-scale dataset and a set of obsolete pdb structures. the tap score is based on a relative pseudo-energy calculated simultaneously from the backbone and side chain torsion angle propensities, normalized against the global minimum and maximum for the protein sequence under consideration. our results show a quantitative relationship between tap score and the overall quality of experimental structures as expressed in terms of sequence to structure compatibility. tap score can improve the confidence in quality validation of protein models derived from automated experimental procedures.

