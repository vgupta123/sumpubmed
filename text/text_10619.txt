BACKGROUND
the environment experienced by particular populations often varies across the distribution range of a species, producing spatial heterogeneity in the direction and strength of natural selection. such divergent selection may lead to the evolution of traits beneficial under the environmental conditions specific to a particular population, a process known as local adaptation  <cit> . when adaptation occurs to a recurrent, well-defined habitat type , distinct ecotypes may form which are usually characterized by divergence in several traits  <cit> . the extent of adaptive differentiation between populations and ecotypes will often reflect a balance between differentiating effects of selection and homogenising effects of gene flow  <cit> . the relative importance of these two factors may be particularly amenable to study along environmental gradients where habitat changes occur at a small spatial scale relative to the dispersal distance of an organism.

theory shows that local adaptation can evolve along such gradients in the face of gene flow  <cit>  and can set the stage for ecotype formation and ecological speciation  <cit> . many empirical examples exist, where the frequency of a particular trait or allele changes along the gradient in a clinal manner , and examples exist too for ecotype formation along environmental gradients  <cit> . the ecological changes along environmental gradients may be very complex involving covariation between multiple abiotic and biotic variables. along altitudinal gradients, for example, we expect a pronounced decrease in ambient temperature with increasing altitude but concomitant patterns may include a reduction in the diversity and a change in the composition of local communities of prey, competitors, parasites and pathogens  <cit> . these changes are expected to result in divergent selection on a range of traits, and genetic changes correlated with altitude have been reported from various species  <cit> , including salmonid fishes  <cit> .

the european trout  lives in an environment that is heterogeneous at several different spatial scales. first of all, consistent environmental differences may exist between major european river basins, and trout populations may have evolved drainage-specific adaptations during extended periods of allopatric divergence. in fact, the major european drainages historically contained distinct trout lineages which probably split in the pleistocene some  <dig>  to  <dig> million years ago  and are mostly considered separate species in a recent taxonomic reassessment of european trouts  <cit> . the extent and nature of adaptive divergence between these lineages are poorly understood but lineage-specific differences in coding sequences  <cit>  may be the result of divergent selection between drainages. at a more local scale, the environment varies across the wide altitudinal range occupied by trout, with similar gradients replicated in each drainage.


during most of the evolutionary history of trout, the rates of gene flow will have been much higher within than among drainages, and this is particularly true in the alps. however, in the recent past , the isolating effects of spatial distance and physical barriers have been partly offset by human management practices. in switzerland, for example, large numbers of fish of atlantic origin , which were historically restricted to the rhine system and lake geneva basin, were introduced into the rhone and po until a change in fisheries legislation in  <dig> banned such translocations. several molecular studies showed that these introduced fish hybridised extensively with the native lineages and genetic variants historically associated with s. trutta now occur in all swiss drainages  <cit> . genetic variants typical of non-atlantic lineages, on the other hand, remain strongly associated with particular drainages  in the rhone; s. cenerinus  and s. marmorata  in the po; and s. labrax  in the danube; see figure 1). based on an analysis of putatively neutral and candidate microsatellite markers, we found in a previous study that the proportion of s. trutta-like alleles and genotypes varied between regions within the mediterranean drainages  <cit> . within the po system, this s. trutta contribution was considerably higher in one studied area  than another . in a river from the rhone drainage, we detected evidence for the coexistence of two distinct trout species, one corresponding to introduced s. trutta and the other most likely representing the native s. rhodanensis.

here, we extend the genomic coverage for a subset of the samples from keller et al.  with  <dig> amplified fragment length polymorphism  markers to investigate more specific hypotheses with respect to the role of phylogeographic history, environmental contrast and current gene flow on putatively adaptive population divergence. in particular, the higher genomic coverage substantially increases our power to detect patterns of parallel genetic divergence within rivers and provides an estimate of the proportion of loci potentially under divergent selection. a particular focus of the current analyses is on patterns of adaptive genetic divergence between major european drainage systems, a question that has not been addressed in detail before. specifically, we ask:

1) do we detect evidence of adaptive genetic divergence between trouts from different major european drainage systems? in the past, this would have amounted to a comparison between different trout species of pleistocene origin. today, it corresponds to a comparison between populations of pure s. trutta origin  and trout with a potentially admixed genomic composition . we expect loci involved in drainage-specific adaptation to have retained elevated levels of differentiation between drainages in the face of human-mediated gene flow. the coexistence of two partially isolated trout forms within the rhone provides a unique opportunity to investigate if the same genetic variants are repeatedly favoured in the same environment but different genomic backgrounds.

2) do we detect parallel associations between the frequency of particular genetic variants and altitude in different rivers? to this end, we compare patterns of genetic differentiation along altitudinal transects replicated in three major european drainage systems . parallel clines at the same genetic loci are expected if adaptation involves either genetic variants predating the split between the trout species, parallel mutation, or genetic variants historically associated with s. trutta, which were spread outside the rhine system through stocking and subsequently recruited for altitudinal adaptation.

3) how does i) the environmental contrast and ii) the potential for natural dispersal between sites influence the extent of adaptive divergence? specifically, we predict a positive correlation for the former if larger environmental differences lead to stronger divergent selection and a negative correlation for the latter if adaptive divergence is constrained by gene flow. to address these questions, we use the proportion of loci showing significantly elevated levels of between-population differentiation  as a measure of putatively adaptive divergence .

RESULTS
we sampled trout from  <dig> sites along altitudinal gradients replicated within and between three major european drainage systems, rhine, rhone and po . using  <dig> primer pairs, we obtained amplified fragment length polymorphism  data for  <dig> polymorphic loci in  <dig> individuals with a genotype reproducibility > <dig> %.

remnants of phylogeographic structure in spite of human-mediated dispersal
a bayesian clustering algorithm implemented in the software structure was used to investigate the genetic substructure in our dataset. we found that the support for a given number of clusters increased steeply up to k= <dig>  with a slight further increase of the likelihood up to k= <dig>  the geographical patterns were best resolved at k= <dig>  where the genetic subdivisions corresponded well with the major drainage systems. the rhine individuals, with the exception of population se, were fully assigned to a single genetic cluster , which was also observed at variable frequencies in all other drainages. a second cluster appeared in the rhone  and a third in the po , at considerably higher frequency in the poschiavino than in the ticino. in the rhone , the distribution of the inferred ancestry proportions appeared bimodal: some individuals were assigned mostly to the local cluster, others mostly to the cluster dominant in the rhine with only few intermediates, suggesting the coexistence of two distinct trout species, one corresponding to introduced s. trutta and the other most likely representing the native s. rhodanensis . one rhine population  showed evidence of genetic admixture between the rhine-like and the po-like clusters.


the results of an analysis of molecular variance supported the subdivisions indicated by structure. when sites were grouped by major drainages,  <dig> % of the variation was observed among drainages and  <dig> % among populations within drainages. an additional split between the two geographical regions sampled in the po drainage , increased the between-drainage component to  <dig> %. note that the poschiavino and ticino river systems are treated as separate drainages in all subsequent drainage-based analyses.

the number of polymorphic markers was highest in the poschiavino, intermediate in the rhone and lowest in the ticino and rhine . this pattern is, at least to some extent, contrary to the number of analysed individuals which was highest in the rhine and lowest in the rhone.


a) signature of selection : logarithm of the posterior odds for aflp markers detected as significant outliers in at least one drainage- or river-specific analysis. bold underlined font indicates tests significant at a threshold consistent with a false discovery rate of 20%.

b) genotype-altitude association: all: results of a permutation test assessing the association between aflp band frequency and altitude accounting for drainage structure. listed are all markers with a one-sided p-value ≤ <dig>  . rhi: p-values from a logistic regression testing for an association between aflp band frequency and altitude within the rhine. listed are all markers significant after bonferroni correction . bold type only indicates p-values ≤ <dig>  but not significant after multiple test correction.

to investigate the possibility of repeated but weak patterns, all results are shown for the listed markers. rhi rhine, rho rhone, t ticino, p poschiavino, a-rhi alpine rhine. na marker monomorphic or containing too much missing data.

divergent selection between drainages
we tested for signatures of adaptive genetic divergence between trouts from different drainages with outlier scans in bayescan. the two geographically  distinct regions from the po were treated as separate groups as were the two coexisting trout species, s. trutta and s. rhodanensis, within the rhone. we performed all possible pairwise outlier scans between these five groups, with populations within drainages pooled. the results from separate analyses based on microsatellites and aflps were combined.

both trout species from the secondary sympatry site in the rhone showed a high proportion of outliers in the comparison with s. trutta from the rhine , but not between each other . seven aflp markers were significant outliers in both rhone-rhine comparisons, and only two of these showed elevated but non-significant fst values also in the comparison between the sympatric rhone taxa . the most extreme aflp band frequencies at these seven loci were observed in s. trutta from the rhine and s. rhodanensis from the rhone respectively, with intermediate frequencies in s. trutta from the rhone . intermediate to high outlier proportions above 2% were observed in four of the comparisons involving drainages from opposite sides of the alps , and low values ≤ <dig> % in three pairwise analyses involving the ticino .


for outlier aflp loci with intermediate band frequencies within drainages , we calculated pairwise linkage indices  <cit>  to investigate potential associations between markers. overall, this analysis was constrained by the low levels of polymorphism often observed within individual drainages at the outlier loci. among the  <dig> linkage indices computed, around two thirds  fell between  <dig>  and  <dig> , and the most extreme value observed was  <dig> , suggesting limited linkage at least among some of these aflp outliers.

two outlier aflp markers  were regionally fixed for alternative variants . in both cases, the most pronounced difference was observed between the s. rhodanesis genotypes from the rhone and s. trutta from the rhine. the remaining markers were either polymorphic everywhere  or fixed in some area and polymorphic in others . overall, the average band frequency varied significantly more across the five groups for markers detected as outliers in at least one between-group comparison than for non-outliers .


bold font indicates fixed band absence  and underlined font fixed band presence . p=poschiavino; t=ticino; rhi=rhine; rho=s. trutta-like genotypes from rhone; rho=s. rhodanensis-like genotypes from rhone.

evidence of  adaptive divergence along altitudinal gradients
we used two complementary approaches to investigate replicated patterns of potentially adaptive genetic differentiation along multiple altitudinal gradients. first, outlier scans in bayescan were conducted within each drainage and, in a second step, within each of the three rivers sampled within the rhine. by far the highest number of outliers  was observed within the rhine system , while only one outlier was detected in the ticino and none in the rhone and poschiavino. the logarithm of the posterior odds  for markers significant in one drainage was typically around or below zero in all other drainages consistent with neutrality. separate outlier scans for the three rivers sampled within the rhine resulted in zero to five outliers per river , which did not correspond in all cases to the markers significant at the drainage scale .

in a second analysis, we tested each aflp marker for associations between band frequency and altitude of the sampling site using a permutation scheme which accounted for the hierarchical structure in the data. significant test results were obtained for  <dig> markers . at five of these loci, the same pattern  was replicated in each of the four drainages . to test for non-independence between these five markers, the linkage index of gaudeul et al.  <cit>  was calculated between all pairs with intermediate band frequencies  within a given population. in total,  <dig> estimates were obtained which all ranged between  <dig>  and  <dig>  suggesting only limited association between the markers where such a test was possible.


within the rhine alone, we tested for associations between altitude and aflp genotype using a logistic regression analysis and identified eight markers as significant . three of them also showed evidence of divergent selection in the outlier scans .

adaptive divergence does not increase with geographical distance or altitudinal contrast
within the rhine, we used a partial mantel test to investigate if the level of adaptive divergence between populations was influenced by the altitudinal or geographical distance between sites. adaptive differentiation was approximated by the proportion of aflp and microsatellite outliers identified in bayescan analyses of all  <dig> possible pairwise comparisons. neither of the two explanatory variables was significantly associated with the proportion of outliers with the two variables explaining only  <dig> % of the total variance.

discussion
remnants of phylogeographic structure in spite of human-mediated dispersal
historically, each of the three major european drainage systems examined in this study would have harbored different evolutionary lineages of trout  which were characterized by considerable genetic divergence  <cit>  and are considered four distinct species: historically allopatric s. trutta, s. rhodanensis and s. marmorata/s. cenerinus, where the latter two were historically sympatric within the po drainage. today, we still detect some genetic subdivision between major drainages most of which probably reflects differences in the relative contribution of these species to the local gene pools . however, the molecular data also clearly show that genotypes typical of rhine populations of s. trutta occur, at variable proportions, in the two mediterranean drainages. the frequency of s. trutta-like genotypes was particularly high in the ticino, which, historically, would have contained s. marmorata and s. cenerinus just as the poschiavino . these aflp-based patterns are fully consistent with previous results from allozymes and microsatellite markers  <cit> .

the area-wide distribution of s. trutta-like genotypes almost certainly reflects the directionality of historical stocking activities, which involved large-scale introductions of atlantic s. trutta into the mediterranean systems. occasional translocations in the opposite direction appear to have taken place as suggested by the detection of po-like genotypes in population se in the rhine . in fact, this population contains individuals with mitochondrial haplotypes typical of danubian trout and marble trout, s. marmorata, one of the two trout species endemic to the adriatic basin .

the observed geographical structure and directionality of gene flow suggests that the genetic variation now available to selection falls into two main groups: i) variants present in all major drainages and ii) variants restricted to the rhone or the po respectively. the first group would include ancestral variation and variants historically associated with the atlantic s. trutta, and it is for these variants that patterns of parallel adaptation would be most readily detectable in our analyses.

evidence of adaptive divergence between drainage systems
the extent and nature of environmental differences between drainages is not well understood. however, it seems likely that such differences do exist and that the extended periods of allopatric divergence between some of the trout species before human-mediated secondary contact and admixture would have facilitated the evolution of traits advantageous in a particular drainage. loci experiencing such long-term divergent selection would eventually become regionally fixed for alternative alleles producing a pattern where a given genetic variant is specific to a particular trout species. only two of our markers show such fixed differences between regions .

under an alternative and perhaps more likely scenario individual loci would experience directional selection in some environments  but no selection in others. if adaptation was often from standing genetic variation, this could lead to the fixation of the favoured variant in one region and the, at least transient, retention of ancestral variation in the other. consistent with such a scenario, 86% of the markers detected as outliers in at least one between-drainage comparison, were fixed for a particular variant in some region and polymorphic elsewhere . it is currently not possible to determine if, at these loci, ancestral variation has been retained in the mediterranean drainages but not in the rhine system or if novel variation has been introduced into the mediterranean systems by recent unidirectional gene flow as a result of human management practices.

still, it seems likely that a locus showing elevated between-population differentiation today compared to the genome-wide average has experienced divergent selection at least during some of its evolutionary history. however, in cases like the trout where diverged lineages came into secondary contact, it may be difficult to distinguish between historical and contemporary effects of selection, and hence the role of past versus current environments, based on the results of an outlier scan alone. on the one hand, the current outlier status of a marker in a zone of secondary admixture between historically divergent species may be indicative of contemporary divergent selection on this locus which may  have been selectively neutral in the past . alternatively, markers fixed or nearly fixed for alternative variants in different species - as a result of divergent selection in the past - may transiently retain elevated levels of differentiation after secondary contact and genetic admixture, even if selectively neutral today, representing the ‘ghost of selection past’ .


the history of unidirectional stocking and the associated current coexistence in secondary contact of two distinct genetic clusters within the rhone allow us to test if, at some loci, different genetic variants are favoured in the two drainages. in that case, we would predict that a locus should be detected as an outlier in both rhone vs rhine comparisons. within the rhone, however, the locally advantageous s. rhodanensis variant should be favoured also in individuals with an otherwise s. trutta-like genotype and, consequently, the marker would show low genetic differentiation between the two rhone groups. evidence for such a pattern is provided by five markers which were outliers in both comparisons across the drainage boundary but showed fst values around or below the average in the comparison between the two species in sympatry in the rhone . all of these markers are fixed or nearly fixed for alternative variants in the s. rhodanensis-like cluster from the rhone and s. trutta from the rhine while the s. trutta-like cluster from the rhone is intermediate , consistent with a pattern of adaptive introgression from s. rhodanensis into s. trutta within the rhone.

adaptive divergence and the potential for gene flow between populations
at a regional scale within the rhine drainage, we found that between  <dig> and 4% of the examined loci showed evidence of divergent selection between population pairs within and between rivers. however, this proportion was independent of both the potential for gene flow  and the altitudinal difference between sites. in contrast, many other studies have suggested that the homogenising effects of gene flow may often constrain adaptive divergence between natural populations . we see possible explanations for our different result.

first, our analysis implicitly assumes that the intensity of divergent selection between altitudes is relatively homogeneous across space. this assumption may be violated in some cases. in fact, the outlier behaviour of several markers appears to be driven by one  populations that differ markedly in average aflp band frequency from all other populations. similar patterns were observed at some microsatellite loci in an earlier analysis of a dataset from a larger number of populations in the same area , and they may point to differences in local selection regimes that are not consistently related to altitude, or to differences in the genetic mechanism of adaptation to the same local selection regimes. it is also likely that a certain proportion of the outliers detected in our analysis are false positives. in fact, a common approach to confirm the results of outlier scans is to look for replicated patterns in independent comparisons across similar ecological gradients  which, of course, is not possible in the case of local effects.

secondly, the rates of gene flow between the different rhine populations may have been too homogeneous to detect an effect on adaptive divergence. the proportion of outliers is certainly a crude measure of adaptive divergence and a wider range of parameter values may need to be investigated to detect significant patterns. indeed, a recent study at a larger geographical scale in denmark  did find a positive correlation between the number of outliers and the geographical distance between populations  <cit> . still, the proportion of outliers detected in a genome scan may be a useful measure of the extent of adaptive population divergence in many natural systems where it is not possible to perform reciprocal transplant experiments.

we find that the proportion of outliers increases when we compare populations  from different major drainages, which were fully isolated for extended periods in their evolutionary history. this is illustrated by the on average, higher proportion of outliers in the between-drainage comparisons  than along gradients within rivers , although these results may not be strictly comparable due to differences in statistical power. however, the pattern holds also in comparisons between pairs of populations. specifically, the average proportion of outliers between six randomly selected population pairs from different drainages was double that observed among the intraspecific s. trutta comparisons made within the rhine . these comparisons do not allow us to distinguish between the effects of variation in geographical isolation and the effects of variation in time available for divergence, both of which are generally much larger between these drainages than within. finally, the strength of divergent selection could be larger between drainages than within.

evidence of parallel adaptive divergence along altitudinal gradients
one of the strongest types of evidence for the action of natural selection is provided by patterns of parallel evolution . therefore, we concentrate our search for evidence of adaptive divergence along altitudinal gradients on trends in genotype-altitude associations that are paralleled across drainage systems. the most convincing support for such parallel patterns stems from the five markers where the frequency of the aflp band showed consistent trends with altitude in all four drainages . our analysis provided no evidence of linkage between these five markers. additional evidence for parallel altitudinal patterns of adaptive divergence comes from several outliers within the rhine drainage, which also show significant associations between aflp band frequency and altitude . finally, our previous analyses based on microsatellite markers detected replicated altitudinal changes for two alleles at a locus near the mhc i region  <cit> .

together, these results suggest that altitude may well be an important source of divergent selection within single rivers, and potentially acts on multiple independent loci. if we consider only the five markers showing consistent trends in all drainages , we obtain an estimate of ca. 2% of the markers responding to altitude. this value is identical to the proportion of markers identified as candidate loci underlying altitudinal adaptation in the frog rana temporaria <cit> . it is also in line with the proportion of loci exhibiting evidence of selection in some classical examples of divergent adaptation with gene flow, e.g. between sympatric sister species of african cichlids , host races of walking stick insects  or periwinkle ecotypes . in trout, with high rates of both natural and human-mediated dispersal, such divergent adaptation within species may exist in the face of extensive gene flow.

CONCLUSIONS
together, our results confirm that adaptive genetic divergence is common in alpine trout. the proportion of outlier loci was particularly high between drainages and associated species, suggesting that adaptive divergence may be facilitated by strong divergent selection, geographical isolation and/or time. still, parallel altitudinal changes of aflp band frequencies within multiple drainages indicate that altitude may well be an important source of divergent selection within rivers and suggest divergent adaptation in the face of gene flow. in general, the amount of gene flow against which adaptive divergence can be maintained varies by orders of magnitude between different study systems. in the future it will be important to investigate how much of this variation is due to variation in the intensity or dimensionality of selection and the genetic architecture of adaptation  <cit> . alpine trout could become an aquatic model system for investigating the relative importance of these constraints in adaptation to climate gradients.

