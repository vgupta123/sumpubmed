BACKGROUND
in vivo metabolic reaction flux data provides insight into the dynamic function of the cell  <cit> . one widely-used experimental method for measuring in vivo reaction fluxes is steady-state substrate 13c isotope labeling  <cit> . an overview of the general 13c methods is described in figure  <dig>  isotopomers, or isomers created from inserting labeled isotopes  at different positions in a molecule, provide a unique way to track the progress of carbon through a metabolic network. by measuring the enrichment for 13c in metabolite pools after growing on a 13c labeled substrate, inferences about the internal flux state can be made. the approach can be summarized as a data fitting problem between simulated and experimentally measured 13c labeled metabolite concentrations. an isotopomer model, describing the positional transfer of carbon atoms for all or a subset of reactions in the network, is used to simulate data . for a specified carbon input label, an isotopomer model enables the calculation of an isotopomer distribution vector  corresponding to a particular simulated steady-state flux distribution . mass spectrometry  experiments on 13c-labeled metabolites  generate fractional 13c enrichments from fragmented macromolecules, forming a mass distribution vector  . the error between the measured mdv and the mdv corresponding to the simulated idv summarizes how well the presumed flux distribution fits the 13c experiment. the flux distribution v that minimizes this error can be computed by solving a non-linear optimization problem. simulating 13c enrichment given a flux distribution is computationally inexpensive; however, the inverse problem of calculating the flux distribution that best fits a 13c experiment is both of greater interest and significantly more computationally difficult . a review of these methods and associated challenges can be found in  <cit> .

there are several distinct sources of variability in a 13c experiment that limit the confidence with which particular reactions can be determined. first, due to experimental accuracy limitations and biological variability, uncertainty arises in the experimentally measured mdv. second, due to alternate pathways present in metabolic networks, the mass balance equations underlying a metabolic steady-state are significantly under-determined  <cit> . while the full network flux distribution may not be resolved at high confidence by a given experiment, certain labeling patterns may resolve fluxes through certain pathways with greater confidence than other labeling patterns, as has previously been shown  <cit> .

for a given n-carbon compound, there are 2n possible 13c labeling states , and the choice of label is known to affect the ability to determine reactions fluxes  <cit> . as 13c methods are based upon computational modeling of isotopomer distributions, it is possible to computationally optimize the choice of substrate labeling pattern to enhance the information gained from an experiment. there are two primary motivations that drive such an endeavor. first, 13c experiments are expensive, so choosing the best experiment a priori is desirable. second, we can assess the capability of the steady-state 13c labeling approach towards determining reaction fluxes in an unbiased manner. the issue of optimization of 13c labeling experiments has been addressed in the literature  <cit> . however, the use of flux sampling for optimal isotopomer experiment prediction has not been explored previously, and this approach presents several unique advantages over previous methods.

we describe a monte carlo sampling-based method for choosing the optimal substrate label, based upon the constraint-based reconstruction and analysis  computational platform  <cit> . cobra methods use manually-curated biochemical network reconstructions of known reaction stoichiometries and measurable nutrient uptake and secretion rates to define feasible ranges for internal reaction fluxes. many of these reconstructions have been generated  <cit>  and the procedure is well-established  <cit> . these models can be used for methods such as computing growth rates  <cit> , predicting the effects of gene knockouts  <cit> , predicting the endpoint of adaptive evolutions  <cit> , and designing strains for industrial production  <cit> . a review of these methods can be found here  <cit> . monte carlo sampling of constraint-based metabolic models can be used to generate sets of biochemically feasible flux distributions that obey measured uptake and secretion rate constraints  <cit> . idvs generated from these flux distributions in an isotopomer model can then be compared against simulated 13c data to evaluate the ability of the experiment to determine reaction fluxes. monte carlo sampling takes advantage of the speed with which idvs can be simulated from putative flux distributions, making this approach suitable for large-scale analysis of in silico experiments.

a monte carlo sampling approach was implemented using a newly developed isotopomer model to evaluate the efficiency of different carbon labeling patterns toward determining reaction fluxes in e. coli. the dimensionality of simulated 13c data was calculated using singular value decomposition  for different substrate labeling patterns and compared to the number of undetermined dimensions in the network. 13c experiments were performed for three substrate labeling patterns to validate the prior theoretical analysis. the methods developed represent a flexible computational analysis that can be applied to various biological systems and experimental setups to estimate, a priori, the efficiency of isotopomer experiments in determining reaction fluxes.

RESULTS
expanded isotopomer model
an isotopomer model was constructed in two phases. first, a central metabolic isotopomer model that accounts for  <dig> reactions including glycolysis, the tca cycle, the pentose phosphate pathway, oxidative phosphorylation, pyruvate metabolism, and anaplerotic reactions was derived from the ijr <dig> e. coli reconstruction  <cit> . this initial model was equivalent in reaction content to commonly used isotopomer models for e. coli  <cit> .

an expanded model was then constructed that includes both central and biosynthetic pathways. the imc <dig> metabolic network  <cit>  was evaluated to determine which reactions can sustain non-zero fluxes during growth on glucose, acetate, or lactate when only certain by-products are allowed to be secreted . blocked reactions, which must have zero net flux at steady state, were subsequently omitted from consideration. groups of reactions that could be merged together without affecting model results  were combined in order to reduce the number of variables. large sets of biosynthesis reactions that produce phospholipids, nucleotides, co-factors were also combined, since there no experimental measurements existed for these high-carbon metabolites. however, by-products resulting from high-carbon metabolite production  that could enter back into the metabolic network were tracked. of the original  <dig> reactions in the complete metabolic imc <dig> network, nearly a third were represented in the biosynthetic isotopomer model, either individually or as grouped reactions.

the final isotopomer model accounts for a total of  <dig> irreversible reactions, including  <dig> which track carbon. inclusion of these additional pathways is likely important for accurate assessment of the flux-resolving power of 13c experiments both within and beyond central metabolism  <cit> . a complete listing of the reactions and metabolites in the biosynthetic network can be found in the additional file  <dig> 

monte carlo sampling approach
to compute possible flux distributions of the e. coli model, the network was sampled using a markov chain, monte carlo  sampling algorithm . the steady-state mass balance and uptake rate constraints for the metabolic network create a convex hyperspace that contains all biochemically feasible steady-state flux distributions  <cit> . monte carlo sampling generates a set of flux distributions that are spread uniformly throughout the feasible space. the inclusion of 13c experimental data reduces the feasible space in which the true flux state must lie by requiring that the idv calculated from the putative flux distribution must match the experimental data within error. while the space of feasible flux distributions depends only on reaction stoichiometry, the space of resulting simulated idvs differs depending on the input substrate labeling pattern. hence, different labeling patterns can have differing abilities to resolve each reaction flux.

here, we used monte carlo sampling of flux distributions to analyze the degree to which reaction fluxes can be determined by steady-state 13c labeling experiments in terms of several possible experimental objectives. for example, one possible experimental objective is to determine whether a particular reaction has a flux above or below a specified value. for this objective, a well-designed labeling pattern would be one in which flux distributions that have an objective reaction flux greater than the specified value can be easily distinguished from flux distributions with an objective reaction flux less than the specified value. as seen in figure  <dig>  a hypothetical experiment  <dig> produces measurement distributions which overlap whereas experiment  <dig> shows greater separation. if one were interested in differentiating between the two partitions, experiment  <dig> would be much preferable. this method allows for the scoring of any label for any given experimental objective without first knowing the true cellular flux distribution v.

generating and evaluating 13c experimental hypotheses
an experimental hypothesis is defined as a partition of the sampled flux distribution set. while many possible hypotheses could be considered, two rational hypotheses were studied. the first case attempts to elucidate whether a reaction has high or low flux . the solution space is partitioned into all points with vj >threshold versus vj <threshold. a different hypothesis is generated for each reaction j. the threshold was chosen to be the median of all vj so that half of all points would be in each of the two partitions. the second set of hypotheses tested consisted of biologically relevant flux ratios. for each point the ratio of two reactions, vi/vj, was determined to be above or below some threshold that formed a partition.

intuitively, a hypothesis score should be high if the isotopomer distributions coming from one partition are distinguishable from distributions in the other partition. while there are several ways of doing this, we chose a heuristic metric based on a z-score, which is commonly used to determine the difference between two samples. a z-score was calculated for each fragment  of the calculated mdv for each simulated flux distribution:

 zi=|x ¯hi-x ¯lo|shi2+slo2+σ <dig> 

where x ¯hi and x ¯lo are the average fragment enrichments for the upper and lower partitions, respectively, shi <dig> and slo <dig> are the variances of fragment enrichments for the upper and lower partitions, respectively, and the α is a constant equal to  <dig> . α is on the order of magnitude of the uncertainty in measurements. this slight modification to the standard z-score puts a lower bound on the expected experimental variation. the z-score of each fragment is added together to give the z-score of the experiment.

 z= ∑i∈fragmentzi 

using this approach, candidate flux states were sampled uniformly and experimental hypotheses tested. z-scores were calculated for the hi-lo hypothesis corresponding to 1) individual reactions 2) reaction ratios and 3) two 'random' reactions or ratios. random hypotheses were tested to estimate the level of noise associated with the set of flux distributions. raw and normalized z-scores are given in the additional file  <dig>  z-scores varied from the level of noise to a maximum of >20-fold the level of noise.

to illustrate the differences in label-dependent reaction resolving capacity, two sets of z-scores corresponding to  glucose and  glucose are plotted in figure  <dig>  lighter colors indicate higher z-scores and ease of measurement. in this case,  glucose scores higher at measuring the pentose phosphate pathway and most of lower glycolysis, whereas  glucose glucose scores much higher at measuring the glyoxylate shunt. the results suggest that there is no single label that yields a high score for all experimental objectives. for example, the exchange of formate  could be easiest measured with a  glucose; however, this labeling pattern is bested by  glucose for the measurement of reaction formyltetrahydrofolate deformylase  . this non-universality of labels is in line with expectations, as it has been previously shown that the choice of labels can affect the flux resolution. for many reactions, the best experiment that could be performed involves hypothetical  labels. one example is the ratio of phosphofructokinase  flux to fructose bisphosphate aldolase  flux. the best label for determining this ratio is  glucose , which gives a much higher z-score than the best commercially available label,  glucose . thus, there may be motivation to synthesize compounds with more complex labeling patterns than commonly used. additionally, there are certain reactions which are predicted to be difficult to measure with any labeling pattern. for example, the z-scores for each possible labeled glucose substrate for the reaction pyruvate oxidase  all lie within the level of noise, as determined by the comparison with random hi-lo experiment z-scores.

in addition to label-specific reaction flux elucidation properties, 13c experiments show a clear pathway bias regardless of labeling pattern. the maximum z-score of all labeling patterns was found for each reaction, giving a metric for the maximum potential for reaction flux determination using 13c-labeled glucose . then, the fraction of reactions that had a maximum potential at least twice the noise level was found for each subsystem . reactions that were stoichiometrically fixed by the measured constraints on acetate, glucose, d-lactate, oxygen, growth rate, and atp maintenance were also categorized by subsystem. stoichiometrically fixed  reactions have a confidence interval of zero, and thus are label-independent and receive no additional knowledge from 13c experiments. it was found that histidine, valine, leucine, and isoleucine metabolism fluxes are completely identified solely based on the flux constraints. on the other hand, prior constraints fix none of the fluxes in central carbon metabolic systems such as glycolysis, citric acid cycle, pentose phosphate pathway, and anaplerotic reactions; however, fluxes in these pathways are all predicted to be identifiable with a 13c experiment using optimal labeling patterns for each reaction. this result is expected as these identifiable pathways are the typical pathways being studied using 13c analysis. other pathways, such as cysteine, threonine, and lysine metabolism, are completely identifiable through a combination of prior stoichiometric constraints combined with well-chosen 13c experiments. however, many of the remaining subsystems have a fraction of reactions that cannot be determined using any 13c-labeling pattern of glucose. in particular, no additional information can be obtained from 13c-labeled glucose experiments about certain biosynthetic pathways, nucleotide salvage pathways, reductive citric acid cycle reactions, and certain alternate pathways peripheral to glycolysis, such as an alternate pathways from dhap to d-lactate. measuring metabolites other than amino acids may give more information on these pathways. note that in this discussion of identifiability, the z-score metric indicates that an experiment can significantly reduce the confidence interval of a particular reaction but does not specifically predict the value of the confidence interval. confidence intervals are directly calculated for experimental data sets in a later section and compared to the z-scores for the same labeling patterns.

dimensionality of isotopomer data
the monte carlo sampling approach enables the determination of the dimensionality of simulated 13c experiments for a particular substrate labeling pattern. the dimensionality gives an indication of the degree to which a particular substrate labeling pattern can specify the free dimensions inherent in a network structure, given a set experimental error. in an extreme case, if all the data falls on one point , no additional information is given from the data. similarly, a dimensionality of one indicates that the data can specify one degree of freedom. singular value decomposition  is a data reduction technique that allows the estimation of data dimensionality . a data matrix m of size , consisting of all sample points generated from monte carlo sampling, is decomposed into m = u · Σ · v t where u and v are orthonormal bases and Σ is a diagonal matrix containing singular values in descending order. the singular values are effectively weightings that describe the information content of the corresponding vectors in u and v towards reconstructing the full matrix m. a partial reconstruction of m is possible by taking only a subset of the singular values greater than some threshold. these thresholds have a direct interpretation as the uncertainty with which a data point can be measured. for example, a threshold cutoff of  <dig>  indicates that the remaining uncertainty of the data falls within  <dig>  or 1% error in the measurement of isotope enrichment.

to determine the dimensionality of the isotopomer data, svd was performed on 13c fragments derived from uniformly sampled flux distribution sets for several glucose labels. the results are summarized in figure 6b. globally, the choice of glucose labels affects the dimensionality of the resulting isotopomer data set. at the 1%  threshold, the label with the highest dimensionality was hypothetical  glucose with  <dig> dimensions. the three labels for which experimental data was measured in the subsequent section,  glucose,  glucose, and 20%  glucose, had dimensions  <dig>   <dig> and  <dig>  respectively, at this cutoff. these values are all significantly lower than the best label, and, in particular, the uniform labeled experiment only produces half of the dimensionality as the optimal experiment. this result is significant. while  <dig> dimensions  are required to specify a unique flux vector, the dimensionality of the 13c data for each label is significantly lower. the best labeling experiment specifies just over half  the degrees of freedom required, and 20%  glucose only specifies about one fourth of the possible degrees of freedom . it is worth noting that svd is a linear operation used to approximate properties of a non-linear system and the true degrees of freedom may be even lower than reported. svd serves as a useful upper bound on the dimensionality of data for non-linear systems, but the difference between svd dimensionality and true dimensionality may grow to be unacceptable for large systems. for the system studied here, svd was found to be of practical use.

experimental validation
in order to assess the agreement of computationally predicted flux elucidation capacity with experimental data, we took fluxomic measurements for three labeling patterns in e. coli. flux distributions that best explain each set of 13c data were calculated using a non-linear optimization problem:

 minverrorsubjectto:vmin<v<vmaxs⋅v= <dig> 

the function error is a score of how well a given flux distribution fits the experimental data. it is defined as:

 error =  ∑i∈fragments-measuredi)2σ <dig> 

where measured i is the measured fractional enrichment of fragment i, fragment i is the computed fractional enrichment of fragment i as a function of the flux distribution v, and α = 0: <dig> is the standard deviation of the fragments as calculated from experimental replicates.

reaction flux confidence ranges were then computed for all reactions using all three sets of 13c data and all combinations thereof. confidence intervals for reaction rates were computed by maximizing and minimizing the value of each reaction in turn subject to a slightly relaxed score.

 minα/maxαcit⋅n⋅αsubjectto:vmin≤n⋅α≤vmaxerror ≤errormax 

where ci =  is a vector of all zeros with a  <dig> in position i, and errormax was set based on the confidence value. because different data sets provide different levels of consistency, errormax was chosen to be  <dig> units greater than the minimum error found.

these intervals were compared with z-scores calculated through monte carlo methods to assess the ability of the z-scores to predict the size of experimental reaction ranges in a label-specific manner . the z-scores were found to be correlated with the relative flux ranges in a statistically significant manner . a receiver operating characteristic  curve suggests that the z-scores can identify with both sensitivity and specificity the reactions that can be elucidated in a label-specific manner, with better performance predicting ranges that are restricted more by data . these findings indicate that the z-score is indeed a useful predictor of the degree a flux range will be constrained by a particular 13c experiment and provide experimental support for the computational approach taken.

the number of reactions elucidated at particular confidence intervals was then found . using different labels provides different levels of reaction confidence . including no 13c data generates the largest flux ranges , while adding 13c data reduces the ranges and shifts the curve left. with almost no exception, including one experiment yields larger confidence intervals than any combination of two carbon sources which in turn is a larger range than including all three sets. of the single experiment curves, the 20%  glucose curve provides notably worse ranges than the other two experiments, consistent with the finding that 20%  substrate provides data with the smallest number of dimensions.

at a reaction confidence of  <dig> mmol · gdw-1·h- <dig> ,  <dig> reactions are specified simply from uptake rate data without any 13c data. performing the least informative 13c experiment, using 20%  substrate, yields  <dig> reactions that meet the confidence criterion, whereas the combination of all three 13c experiments yields  <dig> reactions that meet the criterion. in other words, performing all three experiments will increase the number of elucidated reactions by  <dig> reactions or about 50%. as the model used contains  <dig> carbon-tracking reactions and reaction groups, the increase in knowledge at  <dig> mmol · gdw-1·h- <dig> confidence from  <dig> to  <dig> reactions from using 13c data indicates that a large gap in the knowledge remains. it seems apparent that other methods must be developed to obtain flux information at the genome scale from single experiments, as would ultimately be desirable. however, as noted in the above section, the majority of reactions that are elucidated by 13c-labeled glucose experiments lie in central metabolic pathways, which tend to be both of high interest and not-specifiable by constraints alone.

CONCLUSIONS
we introduce a new framework for calculating the uncertainty inherent to 13c experiments using monte carlo sampling. this allows us to predict the success of experiments before performing them. the method used here 1) does not require experimental identification of the 'real' flux state a priori  <cit>  and 2) reports scores for the resolution capability for each reaction as opposed to boolean identification calls  <cit> . this framework reveals several key findings:

• the choice of input label is important, as different labels perform better than others. in particular, the commonly-used 20% mixture of uniform label + 80% natural label was shown computationally and experimentally to resolve significantly fewer reaction fluxes than either  glucose or  glucose. thus, the amount of information likely to be obtained by a 13c experiment can be predicted in a reaction-specific manner before having to carry out an experiment.

• there is no universally best label. the best label depends on the experimental objective. certain reactions are more precisely measured with some labels than others, and no label is best at elucidating all reactions. certain hypothetical 13c labels of glucose, for example  glucose and  glucose, are predicted to perform better than commercially available single labels for many reactions.

• the 13c data dimensionality is less than anticipated. whereas each 13c experiment can measure  <dig> pieces of information at a time, there is a high degree of interdependence. we measured the true data dimensionality to be between  <dig> and  <dig> dimensions for commercially available labels and as high as  <dig> for exotic labels. this high data redundancy can partially explain why 13c experiments yield many reaction rates with high uncertainties.

this study suggests limitations of steady-state 13c analysis using solely amino acids due to the lower than expected dimensionality of the isotopomer data. however, steady-state 13c analysis is clearly still useful elucidating reaction fluxes in e. coli metabolism. notably, as the study was conducted using only protein-derived amino acids, it would be of immediate interest to determine the additional benefit of measuring other classes of labeled metabolites, as well as the benefit of more recently developed experimental techniques such as multi-substrate  <cit>  and dynamic flux labeling  <cit>  experiments. monte carlo methods are generic and thus are well suited to be adapted to the experimental setup of interest. additionally, monte carlo methods are amenable to biasing the sampling space based on known data to improve results; however, this is expected to incur a corresponding cost in convergence time. possible sources of error in the current method include unwanted bias in the sampled flux space, possible inadequacy of the z-score as a statistical metric over more sophisticated tests such as the kolmogorov-smirnov test, and inadequacy of the distribution median as a threshold for use in hi-lo hypotheses. conducting monte carlo isotopomer analysis on new systems will become more accessible with the availability of the open source cobra toolbox v <dig>  for matlab, which includes the algorithms presented here  <cit> .

