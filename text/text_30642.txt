BACKGROUND
evolutionary transitions from outcrossing, where individuals mate and cross-fertilize each other, to self-fertilization  are in part responsible for the great diversity of animal and plant reproduction systems  <cit> . transitions to selfing have repeatedly occurred during evolution even though this breeding mode usually leads to inbreeding depression  <cit> , restricts the generation of potentially adaptive genetic diversity  <cit>  and may result in an increased probability of extinction  <cit> . countering these and other shortcomings of selfing, by being able to reproduce on their own, autonomous selfers may ensure the persistence of populations facing an environment where mates or pollination agents are unavailable  <cit> . ‘reproductive assurance’ could thus provide an explanation for transitions to selfing.

despite the considerable efforts trying to demonstrate the hypothesis of reproductive assurance, empirical evidence is mixed  <cit> , and whether individual selection can drive the transition to selfing has not been subject to direct experimental tests; but see  <cit> . this is partly because hermaphroditism and selfing occur in multiple forms, not all of which clearly assure population persistence in environments with limited opportunity for outcrossing  <cit> . perhaps more significantly, it has been difficult to disentangle individual selection among selfers and outcrossers from other processes that may also result in the evolution of increased selfing rates.

when mutation to self-compatibility is non-limiting  <cit> , increased selfing rates can evolve due to the numerical transmission advantage that a selfing allele has over an outcrossing allele, if selfers are also able to outcross with each other  <cit> . this process mitigates the ‘cost of meiosis’ that results from outcrossed progeny inheriting only half the gene complement of their parents when compared to selfed progeny  <cit> . second, and depending on the genetics of sex determination, increased selfing rates can result from the elimination of a ‘cost of males’, as male progeny cannot reproduce on their own but consume resources that may be critical for future generations  <cit> . third, increased selfing rates can evolve as a correlated response to density dependent selection for higher dispersal to and/or colonization ability of novel habitats  <cit> . this is the case, for example, in the evolution of selfing in metapopulations, where density dependent selection among selfing and outcrossing demes experiencing frequent extinction may be confounded with individual selection  <cit> . lastly, it is largely unknown how selection of standing genetic diversity specific to breeding mode  <cit> , such as the purging of deleterious recessive alleles  <cit>  or the maintenance of coevolved sets of loci  <cit> , relate to reproductive assurance and may feedback on the evolution of selfing rates.

if transitions to selfing result from individual selection among selfers and outcrossers in an environment where outcrossing is restricted, then successful transitions should lead to adaptation  <cit> . here, we perform experimental evolution in populations of caenorhabditis elegans nematodes to test this prediction of the reproductive assurance hypothesis.

c. elegans is an androdioecious nematode because males co-occur with self-compatible hermaphrodites  <cit> . since hermaphrodites cannot outcross each other, c. elegans lineages do not suffer from a cost of meiosis although they suffer a fitness cost when segregating males  <cit> . c. elegans sex determination is chromosomal, such that hermaphrodites are xx and males are xØ as a result of the non-disjunction of the x-chromosome during hermaphrodite gametogenesis  <cit> . in natural populations, males primarily arise from x-chromosome non-disjunction  <cit> . in recent years, however, it has been demonstrated in the laboratory that males can be maintained for relatively long periods at intermediate to high frequencies, from 10% to 50% for up to  <dig> generations, under several challenging circumstances, such as the presence of pathogens or genetic loads  <cit> .

within the caenorhabditis clade, androdioecy derived from male-female dioecy at least three times  <cit> . theoretical studies have supported the following model for these transitions  <cit>  . a mutant female turned self-compatible hermaphrodite invaded the ancestral dioecious population because the probability of females failing to reproduce was higher than that of hermaphrodites in environments with limited outcrossing. at this stage, individual hermaphrodites were selected owing to the reproductive assurance they afforded the dioecious population, despite inbreeding depression and despite population density dynamics; but see  <cit> . also during this stage, fitness components in selfing hermaphrodites traded-off with male and female fitness components, but the maintenance of trioecy  was unlikely to occur and hermaphrodites eventually displaced females. this is because females would need to evolve in a relatively short period at least double the reproductive output of hermaphrodites in order to be maintained; see  <cit>  for further discussion. after, maintenance of selfing and outcrossing under androdioecy would have been possible if males sired at least twice the number of selfed progeny, thus offsetting the cost of males. but effective monoecy and exclusive hermaphroditism was the probable end result of the transition, as in most extant populations males commonly appear through the non-disjunction of x-chromosome during hermaphrodite gametogenesis.figure  <dig> 
evolutionary transitions to selfing in
caenorhabditis
nematodes and the life cycle of a laboratory-adapted
c. elegans
population.  transitions in reproductive systems and breeding modes that three caenorhabditis nematode species may have undergone in their history . like most extant caenorhabditis species, the ancestral populations had a dioecious reproduction system until the appearance of a mutant female turned self-compatible hermaphrodite , which transformed them into trioecious populations. females and hermaphrodites can only mate with males. successful transitions to selfing imply invasion of hermaphrodites, loss of females and the maintenance of mixed selfing and outcrossing under androdioecy, or further loss of males and exclusive hermaphroditism .  the four-day discrete non-overlapping life cycle of a lab-adapted population, ancestral to all populations here constructed, experimentally evolved and characterised. with the exception of nacl, the life cycle and population census sizes were the same as the experimental evolution here reported. grey lines indicate the time points of experimental manipulation. between 24 hours of the life cycle, when the first larval staged l <dig> individuals are seeded in solid ngm-lite plates, until 96 hours, when adults reproduce and give rise to the embryos that will constitute the next generation, nacl concentrations in the media were 25 mm. increased nacl concentrations to 305 mm is here used as the novel environment.



following this framework, we conducted invasions of wild-type hermaphrodites in genetically transformed dioecious populations to test for transitions to selfing and subsequent adaptation in a novel environment where hermaphrodites provide reproductive assurance. to quantify the extent of selection on hermaphrodites, we submitted genetically transformed monoecious populations to experimental evolution in the same environment, and experimental evolution of androdioecious populations was also performed to determine whether the loss of males was sufficient to explain adaptation. genotyping of single-nucleotide polymorphisms across one autosome was done to test if selection of standing genetic diversity could influence the evolution of selfing rates during transitions. finally, we numerically modelled the evolution of fitness components expressed under outcrossing, during the trioecious phase of the transition, and asked if the experimental evolution of increased male performance under dioecy could determine the opportunity for reproductive assurance.

RESULTS
outcrossing is limited at high nacl concentrations
fortuitous observations suggested that nacl influenced the selfing rates of our laboratory adapted androdioecious population. this population had been cultured for  <dig> generations under discrete non-overlapping four-day life cycles, at constant and spatially homogenous densities, while keeping stable selfing rates   <cit> . nacl concentrations in the culture media plates during experimental evolution were 25 mm between the first larval stage  to adult reproduction . unlike natural populations, this lab-adapted population has abundant genetic diversity since it was originally derived from a cross of several natural isolates and was subsequently maintained at census sizes of n =  <dig> and effective sizes of ne approximately =  <dig>  <cit> .

in the lab-adapted population, we measured male proportions at 96 hours of the life cycle in two consecutive generations of culture at 305 mm nacl  or at the concentration to which they were adapted, 25 mm nacl . in the first generation of the assay, salt did not affect male proportions, a result indicating that the relative survivorship of males and hermaphrodites from the l <dig> larval stage to reproductive maturity is independent of salt . in the second generation, however, adult male numbers were lower in high salt when compared to low salt.figure  <dig> 
outcrossing is limited at high nacl concentrations.  development from the l <dig> larval stage  to the time of reproduction  in varying nacl concentrations did not affect male frequencies in the lab-adapted population . sex ratios in the following f <dig> generation were affected, however, with a high nacl concentration reducing population male frequencies when compared to a low nacl concentration : z-ratio test for a significant difference at f <dig> among salt environments: |z| = <dig> , p-value < <dig> , residual d.f. =91; see methods for justification of statistical modelling].  despite the large impact of high nacl concentrations in hermaphrodite fertility from 72 ± 2 hours to 96 ± 2 hours , outcrossed hermaphrodites had the same fertility as selfed hermaphrodites in high or low salt .  development to maturity since the l <dig> larval stage was retarded at 305 mm nacl since there was a reduced proportion of fertile hermaphrodites in the lab-adapted population at this concentration : main effect nacl |z| = <dig> , p-value = <dig> , residual d.f. =6). after 72 ± 2 hours of development in 305 mm nacl only 10% of the hermaphrodites were fertile when compared to the 40% in 25 mm nacl . however, after 96 ± 2 hours differences among nacl environments were no longer significant . for all panels, triangles, bars and standard errors depict ordinary least-square estimates; ***indicates p-values < <dig> . d.f., degrees of freedom.



selfing rates, calculated as one minus twice the male proportions at the second generation  <cit> , were  <dig>  ±  <dig> se in low salt and  <dig>  ±  <dig> se in high salt. these estimates assume that there were no mixed broods with selfed and outcrossed progeny, which is likely since once hermaphrodites mate with males, male sperm outcompetes self-sperm for fertilization  <cit> . further assays with increasing salt concentrations revealed that selfing rates exhibited a significant increase only above 275 mm , and that there were no maternal effects of salt on embryo-to-adult hermaphrodite survivorship . together these findings show that high salt limits outcrossing and favours selfing.

delayed hermaphrodite developmental time underlies limited outcrossing
differential survivorship of males and hermaphrodites does not seem to explain limited outcrossing in high salt, so we tested an alternative explanation—that hermaphrodite fertility is lower under outcrossing than selfing. . to test for hermaphrodite fertility, independently of male effects, hermaphrodites from the lab-adapted population were outcrossed to males from an unrelated green fluorescent protein  inbred tester. the resulting hermaphrodite progeny was then scored for fertility under outcrossing, when hermaphrodites were again mated to the unrelated gfp tester males, and under selfing . results from this assay showed that despite the large impact of salt on fertility, outcrossed hermaphrodites had the same fertility as selfed hermaphrodites in high or low salt .

several other trait changes can explain limited outcrossing in high salt. high salt concentrations are known to affect hermaphrodite survival, body size and chemotaxis  <cit> , traits that in turn can determine impaired male mating behaviour or hermaphrodite resistance to mating  <cit> . however, there may be simply a reduced time window for outcrossing if hermaphrodites take longer to reach maturity in high salt than low salt  <cit> . to confirm this, we scored the proportion of fertile hermaphrodites in the lab-adapted population at 72 hours and 96 hours of the life cycle . we observed that over both periods, high salt reduced fertility rates, revealing delayed developmental time to maturity . specifically, at 72 hours, almost 40% of the hermaphrodites were fertile after development in low salt but only approximately 10% were fertile in high salt. at 96 hours, all hermaphrodites were fertile in low salt and about 80% were fertile in high salt, although this difference was not statistically significant.

hermaphrodites provide reproductive assurance to a dioecious population
with limited outcrossing in high salt selfed hermaphrodites could provide reproductive assurance to a dioecious population exposed to this environment. to construct a dioecious population, we recurrently introgressed the self-sperm knockout allele, fog- <dig>  in the androdioecious lab-adapted population . fog- <dig> is a recessive autosomal allele that transforms hermaphrodites when homozygous  <cit> . in low salt, fog- <dig> is inconsequential to male or female reproductive success under the life-cycle we employed  <cit>  .

to test for reproductive assurance we first showed that females from the dioecious population do not have reduced fertility when compared to wild-type hermaphrodites. we characterised the fertility of hermaphrodites and females when mated with males from the dioecious population, for the 24 hours preceding population passage and after development to maturity since the l <dig> larval stage in high salt . this assay indicated that females had higher fertility than hermaphrodites when in high salt conditions .figure  <dig> 
reproductive assurance in a dioecious population.  in high salt, the fertility of females from the genetically-transformed dioecious population was higher than the fertility of hermaphrodites from the lab-adapted population .  in high salt and at the time of population passage, the fertility rate of the genetically transformed dioecious population was lower than that of the lab-adapted androdioecious population . for all panels, bars and errors show ordinary least-square estimates; *** indicates p-values < <dig> . d.f., degrees of freedom; glm, generalized linear model.



if females have higher fertility than hermaphrodites, then hermaphrodites can provide reproductive assurance to the dioecious population only when a higher proportion of females fails to reproduce than hermaphrodites. to show the possibility for reproductive assurance, we measured the fertility rates of the dioecious population in high salt conditions following the same protocol as above for the lab-adapted androdioecious population . results from this assay indicated that at 96 hours of the life cycle, the time of reproduction and population passaging under our imposed life-cycle , about 40% of females were fertile, a significantly lower proportion than the approximately 80% of hermaphrodites that were fertile in the androdioecious population .

it is unclear if the higher individual female fertility than individual hermaphrodite fertility compensates for the lower fertility rate of the dioecious population than the androdioecious population in high salt. the individual fertility assays were done under male density, population density and life cycle timing conditions that were not those of our standard population maintenance protocol, but that were followed in the population fertility rate assay . we, therefore, conclude that selfed hermaphrodites provide reproductive assurance to the dioecious population when in high salt since a higher proportion of females than hermaphrodites failed to reproduce at the time of population passaging.

experimental transitions to selfing
an intermediate stage in the construction of the dioecious population involved the creation of a trioecious population, where the wild type fog- <dig> selfing allele was at a frequency of  <dig>  × 10- <dig> and, therefore, where hermaphrodites were at an expected frequency of  <dig>  × 10- <dig> . this male-female-hermaphrodite population should mimic the ancestral dioecious reproduction system of caenorhabditis species, soon after the appearance of a mutant female turned self-compatible hermaphrodite that has not been lost by genetic drift  <cit>  . using replicates of this population we performed evolution experiments in three different salt regimes to test whether reproductive assurance results in transitions to selfing. importantly, except for salt concentrations and sex ratios, all environmental conditions and population census sizes during experimental evolution were the same as those employed during previous laboratory adaptation .

in the ‘sudden’ regime, populations were immediately introduced to, and subsequently cultured at, 305 mm nacl between 24 hours and 96 hours of the life cycle . here we expected selfing rates to greatly increase during the first few generations of experimental evolution. in the ‘gradual’ regime, populations were cultured at linearly increasing nacl concentrations until 305 mm at generation  <dig>  and were then maintained in high salt. here we expected males and females to persist at high frequencies until 275 mm nacl since only at or above this salt concentration is outcrossing limited . in the ‘control’ regime, populations were cultured in the same low salt conditions as the lab-adapted population. populations from this regime allowed us to control for any evolutionary changes associated with the introgression of the fog- <dig> allele in the lab-adapted population, and the new sex ratio condition, despite salt.figure  <dig> 
experimental transitions to selfing result in adaptation.  experimental design.  trioecious populations lost males when cultured at 305 mm nacl.  dynamics of the selfing allele. transition fitness was significantly different from zero in the sudden and gradual regimes  p-values < <dig> , residual d.f. =10). b and c, circles are the observed mean values of replicate populations with error bars one standard mean error among them.  fitness response of trioecious populations after  <dig> generations of evolution . a linear mixed effects model  shows that populations from all regimes adapted to 305 mm . post hoc tukey tests show that sudden populations had a higher fitness response than either gradual or control populations .  as panel d, but for monoecious populations. lmm shows a fitness response in 305 mm nacl by g <dig> in sudden and gradual populations . , as panels d and e, but for androdioecious populations. lmm shows a fitness response in 305 mm nacl by g <dig> in sudden and gradual populations . for panels d, e and f, bars and errors show lmm estimates. +, *, **, *** indicate, respectively, p-values of < <dig> , < <dig> , < <dig>  and < <dig> . d.f., degrees of freedom.



we measured both male and fog- <dig> genotype frequencies to describe transitions to selfing during experimental evolution. as expected, male numbers in the sudden regime rapidly declined, reaching negligible levels by generation  <dig> . following the expected dynamics, the fog- <dig> selfing allele increased in frequency and reached fixation by generation  <dig> . estimating fitness of selfing as the haploid coefficient describing the deterministic frequency change of the selfing allele relative to the resident fog- <dig> allele during experimental evolution  <cit>  results in a value of s = <dig>  ±  <dig> se .

in the gradual regime, male numbers began to decline only after generation  <dig> and at the final generation of culture  males were still present at intermediate frequencies. the selfing allele reached fixation in the gradual populations after approximately  <dig> generations in high salt, mirroring the observations made in the sudden populations. in the gradual populations, the transition fitness of the selfing allele was of s = <dig>  ±  <dig> se, a significantly lower value than the corresponding value in the sudden populations.

in the control populations, the male and the selfing allele frequencies remained at ancestral levels during experimental evolution.

despite the higher fertility of outcrossed females compared to hermaphrodites , hermaphrodites were able to invade and fix. experimental transitions to selfing were thus successful when populations were confronted with a high salt environment, from dioecy to monoecy, in the case of the sudden populations, and from dioecy to androdioecy, in the case of the gradual populations . control populations in turn maintained effective dioecy during experimental evolution.

transitions to selfing result in adaptation
the key prediction of the hypothesis of selection for reproductive assurance is that successful transitions to selfing result in adaptation to the environment where outcrossing is a limiting factor  <cit> . in contrast, populations that do not transit to selfing should not adapt through selection for reproductive assurance. they could adapt, however, to their new male-female sex ratio condition that the lab-adapted population had not experienced during its history. control populations, like the gradual populations, could only adapt to their new sex ratio condition that the lab-adapted population had not experienced during its history.

we measured fitness of the evolved populations at generation  <dig> in parallel with that of the lab-adapted ancestral androdioecious population under high salt conditions. fitness was estimated with competition assays between the experimental populations and a gfp androdioecious tester population which segregated 5% of males but was otherwise similar to the lab-adapted ancestral population . adaptation was then equated with the changes in the haploid coefficient describing the deterministic frequency change of the wild type allele relative to the gfp tester allele in the evolved populations relative to the ancestral populations  <cit>  .

populations from all regimes increased their fitness in high salt after  <dig> generations of experimental evolution . however, sudden populations increased their fitness to a greater extent than the gradual populations. control populations also increased their fitness and to a similar extent of the gradual populations. populations that had a successful transition to selfing, therefore, had higher adaptive rates than those that did not transit to selfing.

fitness responses in the gradual populations must have been due to selection on males and females, as they maintained effective dioecy until generation  <dig>  further, selection on males and females appears to have been independent of salt conditions since the control populations showed similar responses to those of the gradual populations, and they also maintained effective dioecy until generation  <dig>  following a similar reasoning, selection on males and females could also have contributed to the adaptive responses of the sudden populations, as males and females were maintained at relatively high frequencies until generation  <dig> . if so, alleles selected in this manner became associated with selfing in order for fitness differences to be detected by generation  <dig>  when there were only hermaphrodites. together with selection on hermaphrodites, selection on males and females may have thus been responsible for higher adaptive rates in the sudden populations than the gradual or control populations.

selection on hermaphrodites and adaptation
we have assumed so far that the sudden and gradual salt regimes imposed the same selection gradients on the relevant fitness traits  <cit> . it could be, however, that selection gradients under the gradual and control regimes were less steep than in the sudden regime, that is, selection on the relevant traits was weaker, thus explaining the relatively slower adaptive rates of gradual and control populations when compared to the sudden populations. to test this assumption for hermaphrodite traits, we conducted experimental evolution with  monoecious populations and subjected them to the sudden, gradual and control salt regimes. with the exception of those traits that are specific to the interactions between the sexes, similar traits should be expressed by hermaphrodites in the monoecious and the trioecious populations that underwent experimental evolution  <cit> .

to create the ancestral monoecious population, the male-killing mutant allele, xol- <dig>  was recurrently introgressed in the lab-adapted population . following the same protocol as above, we characterised adaptation to high salt with competition assays. after  <dig> generations of experimental evolution, monoecious populations had similar fitness responses when maintained in the sudden or gradual regime, while there was no fitness response in control populations . given these results, we can conclude that selection gradients on hermaphrodite traits expressed under selfing were of similar magnitude under the gradual and the sudden regimes. higher adaptive rates in the sudden regime were likely not due to selection differences to other regimes.

transitions to selfing and the cost of males
to address if fitness responses during the transitions to selfing could be explained by the loss of males and, consequently, an increase in the number of breeding individuals  <cit> , we did experimental evolution under androdioecy, also in the three different salt regimes. since there are no females under androdioecy, hermaphrodites do not reproductively guarantee population persistence. but as in the trioecious populations, males may impose an up to two-fold fitness reduction, that is, a cost of males, as sex ratio segregation is the same whether males outcross with females or with hermaphrodites  <cit>  and both trioecious and androdioecious populations started experimental evolution with similar sex ratios .

as with the trioecious populations, androdioecious populations of both salt regimes increased their selfing rates immediately upon culture in high salt . the gradual populations, in particular, maintained a high frequency of males until generation  <dig>  at which point male numbers declined. using the same competition assays as above to describe adaptation to high salt, we found that, unlike in the trioecious populations, both the sudden and the gradual androdioecious populations had similar fitness responses after  <dig> generations of experimental evolution . control androdioecious populations showed no sign of adaptation.

the fitness responses under androdioecy show that compromised adaptive rates in the gradual trioecious populations, which until generation  <dig> remained effectively dioecious, cannot be explained by the loss of males and, therefore, by the existence of a cost of males. the loss of males in the sudden trioecious populations, which by generation  <dig> had transitioned to selfing, did not facilitate adaptation. instead, we can conclude that facilitated adaptation in the sudden trioecious populations was due to displacement of females by hermaphrodites. in other words, transitions to selfing occurred because hermaphrodites provided reproductive assurance to the ancestral  dioecious population.

selection of standing genetic diversity
selfing structures standing genetic diversity in complex ways that could have contributed to the evolution of selfing during the experimental transitions, thus confounding the role of reproductive assurance  <cit> . one such possibility is that, once hermaphrodites became relatively common, increased segregation of homozygotes would allow efficient purging of deleterious recessive alleles, which would lead to increased selfing rates  <cit> . another possibility is that coevolved sets of loci present in the lab-adapted population were, by chance, adaptive in the novel high salt environment. if so, once hermaphrodites were relatively common, increased selfing would generate high linkage disequilibrium and reduce effective population recombination rates  <cit> , allowing maintenance of undisrupted coevolved sets of loci, which would in turn favour increased selfing rates  <cit> .

one can thus ask whether selection of standing genetic diversity determined adaptation independently of selfing. if that was the case, then population genetic processes can explain transitions to selfing despite selection for reproductive assurance. to address this question, we measured the levels and structure of genetic diversity in populations from all reproduction systems  and all regimes  at a generation that was late enough during the focal trioecious experiment for hermaphrodites to be common but early enough during the experiments for standing genetic diversity to influence adaptation at generation  <dig>  genotyping was done at  <dig> single-nucleotide polymorphisms  across chromosome iv at generation  <dig> of experimental evolution . these snps should mostly behave as neutral markers linked to selected alleles, and if there was selection on deleterious recessive alleles or on coevolved sets of loci, we expected the snp homozygosity or linkage disequilibrium at generation  <dig> to correlate with the fitness responses observed at generation  <dig> 

analysis of snp genotypes revealed that, by itself, selfing greatly increased homozygosity and linkage disequilibrium . this was more evident when comparing the monoecious populations to the ancestral lab-adapted population. however, when the effects of reproductive system on the fitness responses are taken into account and, therefore, the effects of selfing on structuring genetic diversity, neither the amount of homozygosity nor linkage disequilibrium explain the fitness differences between evolved and ancestral populations . we can thus conclude that selection of standing genetic diversity did not greatly influence the evolution of selfing during the experimental transitions.figure  <dig> 
selection of standing genetic diversity does not explain adaptation. bi-plots of the fitness responses at generation  <dig> of experimental evolution  with the homozygosity  or pairwise linkage disequilibrium  of single nucleotide polymorphisms genotyped at generation  <dig> . axes are truncated for clarity. symbols show the observed mean and the standard error of the mean among replicate populations of the three reproduction systems, as well as the mean of the lab-adapted androdioecious population, ancestral to them all. analysis of this data is presented in table  <dig> 
selection of standing genetic diversity does not explain adaptation



independent variable
d.f.
ss
ms
f-value
p
-value
table shows the two analyses of covariance done to test if the fitness responses at generation  <dig>  are explained by snp homozygosity  or pairwise snp linkage disequilibrium  at generation  <dig> . in each model, reproduction system  is treated as the fixed independent variable. ss and ms stand for sum-of-squares and mean-of-squares, respectively. error degrees of freedom  for the model testing the effects of linkage disequilibrium is  <dig> because two monoecious populations from the sudden regime had such low snp diversity that r
 <dig> could not be calculated .



modelling the evolution of the fitness components of outcrossing
during the transitions to selfing in the sudden regime, hermaphrodites displaced females and males soon after  <dig> generations of evolution in high salt . in contrast, males were still present at relatively high frequencies at the end of experimental evolution in the gradual regime. furthermore, transition fitness of the selfing allele was higher in the sudden than in the gradual regime. a reasonable hypothesis to explain these differences between salt regimes is that the evolution of traits expressed by the three sexes under outcrossing contributed to evolution of selfing rates during the transient trioecious phase, the more so in the gradual than in the sudden regime  <cit> . to illustrate the potential evolution of the fitness components of outcrossing during transitions , we asked how they could explain the observed frequency dynamics of the fog- <dig> selfing allele.

barring mutation in sex determination  <cit> , maintenance of androdioecy in c. elegans depends on the male reproductive success relative to the hermaphrodite reproductive success , on the embryo to maturity survivorship difference between hermaphrodites and males , on the proportion of non-cross-fertilised oocytes that are self-fertilised  and on inbreeding depression for fitness components . c. elegans hermaphrodites are protandrous in that they first produce sperm and then irreversibly switch to oogenesis upon reproductive maturation  <cit> . if these parameters do not depend on male or hermaphrodite density, then maintenance of androdioecy is possible when: α >2β, where ‘2’ accounts for the two-fold cost of males; see  <cit>  for details and further discussion.

we revised this androdioecious model to numerically simulate the experimental transitions to selfing by accounting for females in the segregation of fog- <dig> genotypes . for simplicity, we assumed no mixed broods so that when selfed each hermaphrodite was assigned 2β = <dig>  conversely, unmated females could not reproduce and were assigned 2β = <dig>  since, in the lab-adapted population, we did not find survivorship differences between hermaphrodites and males exposed to varying salt concentrations, we set σ = <dig> . we also considered that δ = <dig> since we found no signs of inbreeding depression in the lab-adapted population  and this parameter should not, in most cases, influence transitions to selfing, see for example  <cit> . finally, we defined α as the parameter representing all fitness components expressed under outcrossing rather than specifically modelling female survivorship. with these settings, androdioecy is maintained when the magnitude of outcross-fitness offsets the two-fold cost of males: α > <dig> 

individual-based monte carlo simulations were done following the experimental evolution life cycle and census sizes in order to obtain the expected fog- <dig> genotype frequency trajectories under several values of α . we then compared simulated with observed fog- <dig> genotype frequency trajectories. the maximum-likelihood  estimates that were most congruent with observations from the sudden populations indicated that outcross-fitness was insufficient to offset the cost of males  = <dig>  to  <dig> ). simulations for the gradual populations indicated that during their first  <dig> generations of evolution, before high salt exposure, upward evolution of α may have occurred, but to a degree still insufficient to offset the cost of males when populations subsequently experienced high salt .figure  <dig> 
expected
fog-2
genotype frequency dynamics during transitions.  compound likelihood curves of the outcross-fitness values  that in simulations of trioecious experimental evolution can explain the observed fog- <dig> allele frequency dynamics in the sudden population  and in the gradual populations . grey bars indicate the credible interval of -2lnlk around the maximum-likelihood  estimate. circle shows the expected outcross-fitness component value  with one se in the lab-adapted population, using the data from figure 2a .  deterministic fog- <dig> allele trajectories expected with the ml α estimates . circles and error bars are the observed trajectories . dashed lines illustrate the deterministic fog- <dig> frequency dynamics if there is no cost of males as modelled with α = <dig>  see also additional file 1: figure s <dig> for the sex ratio experimental evolution expectations. simulations assumed random mating and selfing and no sex segregation distortion .



our modelling of trioecy, with just the outcross-fitness parameter, appears to replicate accurately the experimental transitions to selfing. first, the ml estimate of outcross-fitness in the sudden populations closely matches the observed outcross-fitness value of the lab-adapted androdioecious population . second, we were also able to recover the observed fitness of the ancestral trioecious population, estimated from the competition assays, when explicitly simulating it with the sudden ml estimate of outcross-fitness .

because our modelling seems accurate, we examined the expected evolution of sex ratios during transitions to selfing. with the ml estimate of the sudden populations, populations would be composed exclusively of hermaphrodites by generation  <dig> . with the ml estimate of the gradual populations, and by the time the experiments were discontinued at generation  <dig>  males would be at about 7% and females at about  <dig> %. therefore, as observed during experimental evolution, for both the sudden and the gradual populations, females were lost from the populations before males and trioecy was not maintained  <cit> .

this last analysis suggests that monoecy should be the end reproduction system, as observed in the sudden populations. particularly in the gradual populations, however, simulations show that potential evolution of outcross-fitness during the period when populations were kept at high salt after generation  <dig> could have overcome the cost of males. if this was the case, then the evolution of outcross-fitness could have resulted in androdioecy with continued experimental evolution  <cit> .

evolution of male fitness components and the opportunity for reproductive assurance
possible evolution of outcross-fitness under trioecy raises the interesting possibility that the ancestral dioecious population could have been resistant to the invasion of a hermaphrodite if given enough time for adaptation to high salt before its appearance by mutation . to partially address this hypothesis, we performed  <dig> generations of experimental evolution under dioecy in the sudden regime and asked whether the improvement of male fitness components resulted in increased fertility rates, to the extent of reducing the opportunity for reproductive assurance by selfers .

after  <dig> generations of dioecious experimental evolution, we estimated ‘male fitness’ in high salt by the relative performance of males when in competition with gfp tester males for the fertilization of fog- <dig> tester females and relative progeny survivorship to adulthood . this assay showed that male fitness increased over the course of  <dig> generations of experimental evolution . further assays of dioecious female fertility showed that likely it did not evolve .figure  <dig> 
evolution of male fitness diminishes the opportunity for reproductive assurance.  experimental evolution of male fitness in 305 mm nacl of dioecious populations cultured for  <dig> generations under the sudden regime. there was a significant increase in male fitness during evolution .  experimental evolution of fertility rates in the sudden dioecious populations. after  <dig> generations there was an increased proportion of females that were fertile after development from the l <dig> larval stage  to the time of reproduction  in 305 mm nacl . differences in fertility rates between the evolved g <dig> dioecious population and the ancestral lab-adapted androdioecious population are not significant . for  and , bars and errors show ordinary least-square estimates. *, ** indicates, respectively, p-values of < <dig> , < <dig> . d.f., degrees of freedom; glmm, generalised linear mixed effects models; lmm, linear mixed effects model.



the improvement in male fitness may be enough to diminish the reproductive assurance that selfers could afford, were they to appear in the dioecious population, if the proportion of females that failed to reproduce in high salt was significantly reduced during sudden experimental evolution . to confirm this, we measured the fertility rates of the dioecious populations at the standard time of passage  and compared them to that of the lab-adapted androdioecious population . this assay showed that the proportion of fertile females after  <dig> generations of dioecious evolution in the sudden regime increased from about 40% to about 70% , a value that was not statistically different from the approximately 80% of hermaphrodites that were fertile in the lab-adapted population. these results indicate that evolution of male dioecious fitness may reduce the opportunity for reproductive assurance. we can, thus, predict that invasions of the ancestral hermaphrodites in the high salt adapted dioecious populations would be more difficult if we were to repeat experimental evolution.

CONCLUSIONS
we have presented comprehensive evidence supporting the hypothesis that individual selection among selfers and outcrossers can drive the transition from dioecy to androdioecy, or to effective monoecy, when there is limited outcrossing in novel environments. experimental transitions to selfing were due to reproductive assurance, notwithstanding selection of standing genetic diversity, the existence of a cost of males, and the potential for density dependent selection among selfing or outcrossing demes . our experiments further suggest that adaptation of dioecious populations, to the environment where outcrossing was once limiting to them, may reduce the opportunity for reproductive assurance that selfers can provide and, as a consequence, the probability of successful transitions to selfing.

our findings were obtained in highly contrived conditions. can they help explain transitions to selfing within the caenorhabditis clade? out of the  <dig> caenorhabditis species that have been discovered so far, three have probably evolved androdioecy from ancestors that had a dioecious reproduction system  <cit> . extant caenorhabditis species inhabit sparse and ephemeral habitats  <cit> , and a metapopulation structure with variable density dynamics is the norm  <cit> . instead of individual selection, transitions to androdioecy in natural caenorhabditis may have resulted from a correlated response to density dependent selection among demes for dispersal to and/or colonization of novel habitats where outcrossing was not necessarily limited  <cit> . the lack of a cost of meiosis in caenorhabditis, since hermaphrodites do not outcross each other, and the existence of a cost of males in outcrossing lineages would then make certain that the first selfing colonizers would outcompete outcrossers reaching the same habitat at a later time, see for example  <cit>  for an empirical example.

particularly in c. elegans, the assumed dispersal life history stage, the dauer, is a stage from which more males than hermaphrodites survive and reach reproductive maturity  <cit> . adult males are also more vagile than adult hermaphrodites  <cit> , and several evolution experiments have shown that they can be maintained at intermediate frequencies under a variety of novel environments  <cit> , some of which with varying density dynamics. these observations suggest that selection among demes for dispersal and/or colonization of novel habitats, not before experienced by the ancestral dioecious populations, would favour males over hermaphrodites and, as a correlated response, outcrossing over selfing. although it remains to be shown whether, in general, dioecious males likewise survive the dauer stage better and are more vagile than dioecious females, but see  <cit> , selection among demes is not necessary for the transition from dioecy to androdioecy in caenorhabditis. it is sufficient to speculate that in some of the novel environments the ancestral dioecious populations were challenged with restricted outcrossing.

in plants, most of the known transitions from outcrossing to selfing occurred from self-incompatible hermaphrodites that were able to cross-fertilize each other  <cit> . in this situation, a mutant self-compatible hermaphrodite that provided reproductive assurance when pollination agents were a limiting factor, and could outcross with other hermaphrodites, should have been favoured over a female-sterile hermaphrodite   <cit> . in these transitions it remains uncertain whether the cost of meiosis, cost of pollen production, selection among selfers and outcrossers or density dependent selection can explain them. yet, it appears that successful transitions rely on the short-term selective advantage of selfing over outcrossing, thus presumably on individual selection and reproductive assurance  <cit> . since in a few model plants, sex determination mutants can be obtained, and emasculation assays readily done, it would be valuable to perform evolution experiments similar in design to ours to disentangle the relative role of all the relevant processes that can explain transitions to selfing; see for example  <cit>  for experimental evolution under different reproduction systems using arabidopsis thaliana.

in a small number of plants and animals, known transitions from outcrossing to selfing were similar to those of caenorhabditis, from dioecy to androdioecy  <cit> . in these rare species, empirical evidence on population density dynamics and on the genetics of sex determination is scarce but individual selection could have been important for transitions to selfing. in the particular case of animals, their populations inhabit apparently homogeneous  environments and spawn in large numbers, both circumstances that would be conducive to a lesser role for density dependent selection among demes. also in common with caenorhabditis, the derived self-compatible hermaphrodites of these androdioecious animals are biased in their allocation of reproductive resources towards the female function, a condition that may reflect the limited mutational options that were available to the dioecious ancestor for the evolution of self-compatibility  <cit> .

the frequency of transitions to selfing is ultimately a function of mutation rates and of the genetic architecture of sex determination. in the dioecious c. remanei, at least two mutational steps are required to turn a wild-type female into a self-compatible and fertile protandrous hermaphrodite: one to repress oogenesis and initiate spermatogenesis, and another one to stop spermatogenesis, resume oogenesis and allow fertilization  <cit> . in addition, partially to complete recessive alleles at several loci may have determined autonomous selfing in the ancestral dioecious caenorhabditis  <cit> , a situation that likely would have reduced the probability of the establishment of hermaphrodites, especially if populations during transitions were small or highly structured  <cit> . in spite of the genetic architecture of selfing, however, as shown here, once these mutants escape genetic drift and became established in the resident population  <cit> , their fate due to selection would be contingent upon whether the ancestral dioecious population was already adapted to the environment where outcrossing was once limiting to them. the opportunity for reproductive assurance may, therefore, be circumscribed to very short evolutionary periods, which, together with limited and probably complex mutational options determining self-compatibility, can help explain why transitions from dioecy to androdioecy are the rarest of transitions to selfing in nature.

