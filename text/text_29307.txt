BACKGROUND
real-time pcr is one of the most sensitive and reliably quantitative methods for gene expression analysis. it has been broadly applied to microarray verification, pathogen quantification, cancer quantification, transgenic copy number determination and drug therapy studies  <cit> . a pcr has three phases, exponential phase, linear phase and plateau phase as shown in figure  <dig>  the exponential phase is the earliest segment in the pcr, in which product increases exponentially since the reagents are not limited. the linear phase is characterized by a linear increase in product as pcr reagents become limited. the pcr will eventually reach the plateau phase during later cycles and the amount of product will not change because some reagents become depleted. real-time pcr exploits the fact that the quantity of pcr products in exponential phase is in proportion to the quantity of initial template under ideal conditions  <cit> . during the exponential phase pcr product will ideally double during each cycle if efficiency is perfect, i.e. 100%. it is possible to make the pcr amplification efficiency close to 100% in the exponential phases if the pcr conditions, primer characteristics, template purity, and amplicon lengths are optimal.

both genomic dna and reverse transcribed cdna can be used as templates for real-time pcr. the dynamics of pcr are typically observed through dna binding dyes like sybr green or dna hybridization probes such as molecular beacons  or taqman probes   <cit> . the basis of real-time pcr is a direct positive association between a dye with the number of amplicons. as shown in figure , the plot of logarithm 2-based transformed fluorescence signal versus cycle number will yield a linear range at which logarithm of fluorescence signal correlates with the original template amount. a baseline and a threshold can then be set for further analysis. the cycle number at the threshold level of log-based fluorescence is defined as ct number, which is the observed value in most real-time pcr experiments, and therefore the primary statistical metric of interest.

real-time pcr data are quantified absolutely and relatively. absolute quantification employs an internal or external calibration curve to derive the input template copy number. absolute quantification is important in case that the exact transcript copy number needs to be determined, however, relative quantification is sufficient for most physiological and pathological studies. relative quantification relies on the comparison between expression of a target gene versus a reference gene and the expression of same gene in target sample versus reference samples  <cit> .

since relative quantification is the goal for most for real-time pcr experiments, several data analysis procedures have been developed. two mathematical models are very widely applied: the efficiency calibrated model  <cit>  and the ΔΔct model  <cit> . the experimental systems for both models are similar. the experiment will involve a control sample and a treatment sample. for each sample, a target gene and a reference gene for internal control are included for pcr amplification from serially diluted aliquots. typically several replicates are used for each diluted concentration to derive amplification efficiency. pcr amplification efficiency can be either defined as percentage  or as time of pcr product increase per cycle . unless specified as percentage amplification efficiency , we refer the amplification efficiency  to pcr product increase  in this article. the efficiency-calibrated model is a more generalized ΔΔct model. ct number is first plotted against cdna input , and the slope of the plot is calculated to determine the amplification efficiency . Δct for each gene  is then calculated by subtracting the ct number of target sample from that of control sample. as shown in equation  <dig>  the ratio of target gene expression in treatment versus control can be derived from the ratio between target gene efficiency  to the power of target Δct  and reference gene efficiency  to the power of reference Δct . the ΔΔct model can be derived from the efficiency-calibrated model, if both target and reference genes reach their highest pcr amplification efficiency. in this circumstance, both target efficiency  and control efficiency  equals  <dig>  indicating amplicon doubling during each cycle, then there would be the same expression ratio derived from 2-ΔΔct  <cit> .

ratio=Δcttarg⁡etΔctreference     equation 1
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgsbgucqwghbqycqwg0badcqwgpbqacqwgvbwbcqgh9aqpdawcaaqaaiabcicaoiabdweafnaabaaaleaacqwg0badcygghbqycqggybgccqggnbwzcqwglbqzcqwg0badaeqaaogaeiykakyaawbaasqabeaacqqhuoarcqwgdbwqcqwg0baddawgaaadbagaemidaqnagiyyaemaeiocainaei4zacmaemyzaumaemidaqhabeaaaaaakeaacqggoaakcqwgfbqrdawgaawcbagaemocainaemyzaumaemozaymaemyzaumaemocainaemyzaumaemoba4maem4yammaemyzaugabeaakiabcmcapmaacaaaleqabagaeuildqkaem4qamkaemidaq3aasbaawqaaiabdkhayjabdwgaljabdagamjabdwgaljabdkhayjabdwgaljabd6gaujabdogajjabdwgalbqabaaaaaaakiaaxmaacawljagaemyraukaemycaenaemydaunaemyyaemaemidaqnaemyaakmaem4ba8maemoba4maeeiiaaccbigae8xmaedaaa@79ac@

whereas Δcttarget = ctcontrol - cttreatment and Δctreference = ctcontrol - cttreatment

ratio = 2-ΔΔct     equation 2

whereas ΔΔct = Δctreference - Δcttarget

even though both the efficiency-calibrated and ΔΔct models are widely applied in gene expression studies, not many papers have thorough discussions of the statistical considerations in the analysis of the effect of each experimental factor as well as significance testing. one of the few studies that employed substantial statistical analysis used the rest® program  <cit> . the software presented in this article is based on the efficiency-calibrated model and employed randomization tests to obtain the significance level. however, the article did not provide a detailed model for the effects of different experimental factors involved. another statistical study of real-time pcr data used a simple linear regression model to estimate the ratio through ct calculation  <cit> . however, the logarithm-based fluorescence was used as the dependent variable in the model, which we believe does not adequately reflect the nature of real-time pcr data. it follows that ct should be the dependent variable for statistical analysis, because it is the outcome value directly influenced by treatment, concentration and sample effects. both studies used the efficiency-calibrated models. despite the publication of these two methods, many research articles published with real-time pcr data actually do not present p values and confidence intervals  <cit> . we believe that these statistics are desirable to facilitate robust interpretation of the data.

a priori, we consider the confidence interval and p value of ΔΔct data to be very important because these directly influence the interpretation of ratio. without a proper statistical modeling and analysis, the interpretation of real-time pcr data may lead the researcher to false positive conclusions, which is especially potentially troublesome in clinical applications. we hereby developed four statistical methodologies for processing real-time pcr data using a modified ΔΔct method. the statistical methodologies can be adapted to other mathematical models with modifications. sas programs implementing the methodologies and data control are presented with real-time pcr practitioners in mind for turnkey data analysis. standard deviations, confidence levels and p values are presented directly from the sas output. we also included analysis of the sample data set and sas programs for the analysis in the online supplementary materials.

RESULTS
data quality control
from the two mathematical models for relative quantification of real-time pcr data, we observe disparities between data quality standards. for efficiency-calibrated method, the author who described this procedure  <cit>  assumed that the amplification efficiency for each gene  is the same among different experimental samples . in contrast, whereas an amplification efficiency of  <dig> is not required, the ΔΔct method is more stringent by assuming that all reactions should reach an amplification efficiency of  <dig>  in other words, the amount of product should double during each cycle  <cit> . moreover, the ΔΔct method assumes that the pcr amplification efficiency for each sample will be  <dig>  if pcrs for one set of the samples reaches full amplification efficiency. however, this assumption neglects the effect of different cdna samples.

data quality could be examined through a correlation model. even though examining the correlation between ct number and concentration can provide an effective quality control, a better approach might be to examine the correlation between ct and the logarithm  transformed concentration of template, which should yield a significant simple linear relationship for each gene and sample combination. for example, for a target gene in the control sample, the ct number should correlate with the logarithm transformed concentration following the simple linear regression model in equation  <dig>  in the equation, xlcon represents the logarithm transformed concentration, β <dig> represents the intercept of the regression line, and βcon represents the slope of the regression line  <cit> . the acceptable real-time pcr data should have two features from the regression analysis. first, the slope should not be significantly different from - <dig>  second, the slopes for all four combinations of genes and samples as shown in table  <dig> should not be significantly different from one another. a sas program was developed to perform the data quality control in program1_qc.sas .

ct = β <dig> + βconxlcon + ε     equation 3

the input data is grouped as shown in table  <dig> and additional file  <dig>  each combination of gene and sample was classified in one group named from  <dig> to  <dig>  the sas procedure proc mixed was used for performing simple linear regression for each group based on the model described above. the 95% confidence levels for slopes were estimated, which are expected not be significantly different from - <dig>  the abbreviated sas output for the analysis of a sample data set is presented in sasoutput.doc . slopes for ct and logarithm transformed concentrations for all four groups were not significantly different from - <dig> based on 95% confidence level. in addition to the numeric output, the program also provides a visualization of data quality as shown in figure  <dig>  where the ct number is plotted against logarithm transformed template concentration. a simple linear relationship should be observed between the ct number and logarithm transformed concentration.

multiple regression model
several effects need to be taken in to consideration in the ΔΔct method, namely, the effect of treatment, gene, concentration, and replicates. if we consider these effects as quantitative variables and have the ct number relating to these multiple effects and their interactions, we can develop a multiple regression model as follows in equation  <dig> 

ct = β <dig> + βconxicon + βtreatxitreat + βgenexigene + βcontreatxiconxitreat + βcongenexiconxigene + βgenetreatxigenexitreat + βcongenetreatxiconxitreatxigene + ε     equation 4

in this model, ct is the true dependent, the β <dig> is the intercept, βxs are the regression coefficients for the corresponding x  terms, and ε is the error term  <cit> . the model considers the effect of concentration, treatment, gene and their interactions. we are principally interested in the interaction between gene and treatment, which addresses the degree of the ct differences between target gene and reference gene in treated vs. control samples: i.e., ΔΔct. ΔΔct can therefore be estimated from the different combinations values of βgenetreat. the four groups in table  <dig> also represent the options of combinational effects of treatment and gene. the goal is to statistically test for differences between target and reference genes in treatment vs. control samples. therefore, the null hypothesis is the ct differences between target and reference genes will be the same in treatment vs control samples, which can be represented by combinational effect  as: ce1-ce <dig> = ce2-ce <dig>  an alternative formula will be: ce1-ce2-ce3+ce <dig> =  <dig>  which will yield an estimation of ΔΔct. if the null hypothesis is not rejected, then the ΔΔct would not be significantly different from  <dig>  otherwise, the ΔΔct can be derived from the estimation of the test. in this way, we can perform a test of different combinational effects of βgenetreat and estimate the ΔΔct from it. as shown in the ΔΔct formula in equation  <dig>  if a ΔΔct is equal to  <dig>  the ratio will be  <dig>  which indicates no change in gene expression between control and treatment.

a sas program for multiple regression model
sas procedure proc glm was used for ΔΔct estimation in program2_mr.sas in additional file  <dig>  the multiple regression model is stated in a model statement. the combinational effect of gene and treatment are evaluated in the estimate and contrast statement. the null hypothesis of ce1-ce2-ce3+ce <dig> =  <dig> is tested in the contrast statement and the parameter estimation yield the ΔΔct value. the sas input file is available in additional file  <dig> and the sas output for the multiple regression is in sasoutput.doc .

the sas output gives a very comprehensive analysis of the data. we are interested in two aspects of the analysis. first, we want to test whether the ΔΔct value is significantly different from  <dig> at p =  <dig> . if the ΔΔct is not significantly different from  <dig>  then we conclude the treatment does not have a significant effect on target gene expression; otherwise, the inverse is concluded. if the effect is significant, we are interested in the standard deviation of ΔΔct value, from which we can derive the ratio of gene expression as discussed later. the sas output provides the point estimation  and standard error  for the ΔΔct. proc glm or proc mixed are interchangeable in this application. if the experiments involve multiple biological replicates, replicate effect can also be considered through modifying the sas program. then the estimation will be the combined effect of gene, treatment and replicate.

analysis of covariance and sas code
another way to approach the real-time pcr data analysis is by using an analysis of covariance . a simplified model can be derived from transforming the data into a grouped data as shown in table  <dig> and additional file  <dig> resulting in equation  <dig> 

ct = β <dig> + βconxicon + βgroupxigroup + βgroupconxigroupxicon + ε.     equation 5

we are interested in two questions here. first, are the covariance adjusted averages among the four groups equal? second, what is the ct difference of target gene value between treatment and control sample after corrected by reference gene? in this case, the null hypothesis will be - =  <dig>  and the test will yield a parameter estimation of ΔΔct as shown in the program3_ancova.sas .

the sas code implementing the ancova model is similar to that of multiple regression model. either sas procedures proc glm or proc mixed can be employed to implement the ancova model; and we used proc mixed here. the class statement defines which variables will be grouped for significance testing. in this case, the variables are concentration and group, and ancova assumes that these are co-varying in nature. the contrast and estimate statements were used to contrast the group effect, which will yield ΔΔct , as well as its standard error  and 95% confidence interval . the sas output with both confidence level and p value is presented in sasoutputs.doc .

simplified alternatives – t-test and wilcoxon two group test
more simplified alternatives can be used to analyze real-time data with biological replicates for each experiment. the primary assumption with this approach is that the additive effect of concentration, gene, and replicate can be adjusted by subtracting ct number of target gene from that of reference gene, which will provide Δct as shown in table  <dig>  the Δct for treatment and control can therefore be subject to simple t-test, which will yield the estimation of ΔΔct.

as a non-parametric alternative to the t-test, a wilcoxon two group test can also be used to analyze the two pools of Δct values. two of the assumptions for t-test are that the both groups of Δct will have gaussian distributions and they will have equal variances. however, these assumptions are not valid in many real-time pcr experiments using realistically small sample sizes. therefore a distribution-free wilcoxon test will be a more robust and appropriate alternative in this case  <cit> .

a sas program has been developed for both t-test and wilcoxon two group test as shown in the attached program program4_tw.sas . the sas procedures ttest and univariate were used to analyze the data. the sas macro 'moses.sas'  <cit>  in additional file  <dig> has been employed to derive the confidence levels. the sas input file is in additional file  <dig> and the sas output for sample data analysis is available in sasoutput.doc . since the estimate of difference derives from subtracting treatment from control sample, the actual ΔΔct should be the inverse of the output estimate.

comparison of four approaches and data presentation
a comparison of the four approaches is presented in table  <dig>  multiple regression and ancova yield exactly the same result for ΔΔct estimation, because both methods employ the same mathematical approach for parameter estimation. the t-test provides the same point estimation of ΔΔct, however, the standard error is slightly greater, which leads to a larger confidence interval. wilcoxon two group test provides a slightly smaller estimation of ΔΔct. the highly similar results from the four approaches validated the models and sas programs presented. the choice of the models and programs will depend on the experimental design and the stringency and quality of the experiment. however, the most conservative test, owing to its nonparametric nature, is the wilcoxon two group test, which is distribution-independent.

data quality control
many of the current real-time pcr experiments do not include a standard curve design, nor do they use a method to estimate the amplification efficiency. we argue here that real-time pcr data without proper quality controls are not reliable, since the efficiency of real-time pcr could have significant impact on the ratio estimation and dynamic range. for example, if a pcr has a percentage amplification efficiency  of  <dig>  , a Δct value of  <dig> can only be transformed into  <dig>  times differences in ratio instead of  <dig> times. this problem gets amplified when the ΔΔct or Δct values are larger and the amplification efficiency is lower, which could lead to severely skewed interpretations.

we therefore propose two standards for real-time pcr data quality control according to the model using the sas programs presented in this paper. first, experiments with a serial dilution of template need to be included in order to estimate the amplification efficiency of each gene with each sample. some researchers assume that the amplification efficiency for each gene is the same in different samples because the same primer pair and amplification conditions are used. however, we found that sample effect does have an impact on the amplification efficiency. in other words, the amplification efficiency could be different for the same gene when amplified from different cdna template samples. we therefore consider the experimental design with standard curve for each gene and sample combination as the optimal. second, under optimal conditions, if a plot of the ct number against the logarithm  template amount should yield a slope not significantly different from - <dig>  which indicates a nearly  <dig> amplification efficiency. even though both efficiency-calibrated model and modified ΔΔct model tolerates the amplification efficiency lower than  <dig>  it is most reliable to have all the reaction with amplification efficiency approximating  <dig> through optimizing primer choices, amplicon lengths and experimental conditions. from our experience, maintaining all the amplification efficiency near  <dig> is the best way to reach equal amplification efficiency among the samples and thus to ensure high quality data. it is also observed that a near  <dig> amplification efficiency can help to expand the dynamic range of ratio estimation.

p-value, confidence intervals and data presentation
the p-value is an important parameter for significance level, and confidence intervals help to establish the reliable range for ΔΔct estimation. most of current real-time pcr publications do not present p-values and confidence intervals  <cit> . we believe disclosing p-values is important when the researchers claim differential expression between the samples or treatments exists. in the program we present, all the p-values are derived from testing the null hypothesis that ΔΔct are equal to  <dig>  therefore, a small p-value indicates that the ΔΔct is significantly different from  <dig>  which demonstrates a significant effect. the interpretation of a p-value will depend on the experimental objectives. for example, at p =  <dig>  in a treatment versus control experiment, we can claim that the treatment has a significant effect; and in a tissue comparison experiment, we can claim that the gene expression is significantly different among the tissues.

some publications present a standard deviation of the ratio as a meaningful metric. however, we argue here that the standard deviation of ratio should be derived from the standard deviation of ΔΔct; and the confidence interval of the ratio should be derived from the confidence interval of ΔΔct. in other words, the point estimation of ratio should be 2-ΔΔct and the confidence interval for ratio should be . since ct is the observed value from experimental procedures, it should be the subject of statistical analysis. the practice of performing statistical analysis at ratio directly is not appropriate. the presentation of data needs to refer to the ΔΔct and subsequently the ratio and confidence intervals derived from 2-ΔΔct.

statistical analysis for real-time pcr data with amplification efficiency less than 2
as stated before, the pcr amplification efficiency can be optimized to be approximately  <dig> with proper amplification primers, rna quality, and cdna synthesis protocol. recent advancements in real-time pcr primer design have allowed easier experimental optimization  <cit> . however, less than ideal real-time pcr data can occur regardless the stringent control of experimental conditions. there are three scenarios for suboptimal real-time pcr data. in the first scenario, all of the pcr reactions have the same amplification efficiency, yet the efficiency differs from  <dig>  in the second scenario, the pcr amplification efficiency differs by gene only. in other words, the amplification efficiency is the same for the same gene in all the biological samples; however, the amplification efficiency varies among the different genes. in the third scenario, the pcr amplification efficiency differs both by gene and by sample. we considered the data in the third scenario as unacceptable as many others have reported  <cit> . in any of these scenarios, the adjusted ΔΔct can be derived from the ancova model by including the pe in the 'estimate' and 'contrast' statement of the sas program.

several approaches have been developed to calculate the amplification efficiency in the low quality data. one of such approach is so called 'dynamic data analysis', in which the fluorescence history of a pcr reaction is employed to calculate the amplification efficiency  <cit> . the advantage of the approach lies in the capacity to analyze low quality data and the economy in cost by avoiding the standard curve. however, due to the mathematical complexity and the reliability controversy, this method is not as widely applied as the traditional standard curve method  <cit> . in our method, a standard curve already exists and can be used to derive amplification efficiency . considering the simple linear regression model in equation  <dig>  if xlcon represents  <dig> based logarithm transformed concentration, the amplification efficiency  is 10- or 10−
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqaixaqmcqaiwaamdaahaawcbeqaaiabgkhitiabcicaoiabigdaxiabc+cavggaciab=j7ainaabaaameaacqqgjbwycqqgvbwbcqqgubgbaeqaasgaeiykakcaaaaa@3921@ according to ramussen  <dig> and pfaffl  <dig>  <cit> . in our model, xlcon represents the  <dig> based logarithm transformed concentration, the amplification efficiency  therefore is 2- or 2−
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqaiyagmdaahaawcbeqaaiabgkhitiabcicaoiabigdaxiabc+cavggaciab=j7ainaabaaameaacqqgjbwycqqgvbwbcqqgubgbaeqaasgaeiykakcaaaaa@3835@, where the pe can be represented as -.

in the first scenario discussed above, all pcr amplification have the same efficiency, but the efficiency is not equal to  <dig>  then the ratio of gene expression can be represented in the following equation.

ratio=e−ΔΔct=−ΔΔct=2−ΔΔct*pe     equation 6
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgsbgucqwghbqycqwg0badcqwgpbqacqwgvbwbcqgh9aqpcqwgfbqrdaahaawcbeqaaiabgkhitiabfs5aejabfs5aejabdoeadjabdsha0baakiabg2da9iabcufabjabikdaymaacaaaleqabagaeyoei0iaeiikagiaegymaejaei4la8cccigae8nsdi2aasbaawqaagqaciab+ngajjab+9gavjab+5gaubqabawccqggpaqkaagccqggdbqxdaahaawcbeqaaiabgkhitiabfs5aejabfs5aejabdoeadjabdsha0baakiabg2da9iabikdaymaacaaaleqabagaeyoei0iaeuildqkaeuildqkaem4qamkaemidaqnaeiokaoiaemiuaalaemyraueaaogaaczcaiaaxmaacqwgfbqrcqwgxbqccqwg1bqdcqwghbqycqwg0badcqwgpbqacqwgvbwbcqwgubgbcqqggaaicqgf2agnaaa@6aba@

whereas pe = -, and ΔΔctadjust = pe*ΔΔct

in the equation  <dig>  βcon is the pooled slope of the plot with ct against logarithm  <dig> based concentration. the βcon can be calculated with a correlation function in sas as shown in program5_lowqualitydata.sas in additional file  <dig>  in the second scenario, the amplification efficiency differs by gene only. according to equation  <dig>  we have the following equation, in which the β <dig> is the pooled slope of the plot of ct against log <dig>  for each gene.

ratio=Δcttarg⁡etΔctcontrol=Δcttarg⁡etΔctcontrol=2     equation 7
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgsbgucqwghbqycqwg0badcqwgpbqacqwgvbwbcqgh9aqpdawcaaqaaiabcicaoiabdweafnaabaaaleaacqwg0badcygghbqycqggybgccqggnbwzcqwglbqzcqwg0badaeqaaogaeiykakyaawbaasqabeaacqqhuoarcqwgdbwqcqwg0baddawgaaadbagaemidaqnagiyyaemaeiocainaei4zacmaemyzaumaemidaqhabeaaaaaakeaacqggoaakcqwgfbqrdawgaawcbagaem4yammaem4ba8maemoba4maemidaqnaemocainaem4ba8maemibawgabeaakiabcmcapmaacaaaleqabagaeuildqkaem4qamkaemidaq3aasbaawqaaiabdogajjabd+gavjabd6gaujabdsha0jabdkhayjabd+gavjabdygasbqabaaaaaaakiabg2da9maalaaabagaei4waslaegomaizaawbaasqabeaacqghsislcqggoaakcqaixaqmcqggvawliigacqwfyogydawgaaadbagaem4yammaem4ba8maemoba4maemivaqlagiyyaemaeiocainaei4zacmaemyzaumaemidaqhabeaaliabcmcapaaakiabc2fadnaacaaaleqabagaeuildqkaem4qamkaemidaq3aasbaawqaaiabdsha0jgbcggahjabckhayjabceganjabdwgaljabdsha0bqabaaaaagcbagaei4waslaegomaizaawbaasqabeaacqghsislcqggoaakcqaixaqmcqggvawlcqwfyogydawgaaadbagaem4yammaem4ba8maemoba4maem4qamkaem4ba8maemoba4maemidaqnaemocainaem4ba8maemibawgabeaaliabcmcapaaakiabc2fadnaacaaaleqabagaeuildqkaem4qamkaemidaq3aasbaawqaaiabdogajjabd+gavjabd6gaujabdsha0jabdkhayjabd+gavjabdygasbqabaaaaaaakiabg2da9iabikdaymaacaaaleqabagaeiikagiaemiuaalaemyrau0aasbaawqaaiabdsha0jgbcggahjabckhayjabceganjabdwgaljabdsha0bqabawccqghxiikcqqhuoarcqwgdbwqcqwg0baddawgaaadbagaemidaqnagiyyaemaeiocainaei4zacmaemyzaumaemidaqhabeaaliabgkhitiabdcfaqjabdweafnaabaaameaacqwgjbwycqwgvbwbcqwgubgbcqwg0badcqwgybgccqwgvbwbcqwgsbabaeqaasgaey4fioiaeuildqkaem4qamkaemidaq3aasbaawqaaiabdogajjabd+gavjabd6gaujabdsha0jabdkhayjabd+gavjabdygasbqabawccqggpaqkaagccawljagaaczcaiabdweafjabdghaxjabdwha1jabdggahjabdsha0jabdmgapjabd+gavjabd6gaujabbccaggqaciab+dda3aaa@f60b@

whereas petarget = -, pecontrol = -, and ΔΔctadjust = petarget*Δcttarget-pecontrol*Δctcontrol

in the equation  <dig>  βcontarget and βconcontrol are the pooled slope for the plot of ct against logarithm  <dig> based concentration for target gene and reference gene respectively. the slopes can be calculated by the program5_lowqualitydata.sas . the ΔΔctadjust can be calculated with the same program. theoretically, an equation can also be derived for the third scenario when pcr amplification efficiency differs both by gene and by sample. however, in actual application, we don't consider the data in the third scenario as acceptable due to the significant variation of the amplification efficiency  <cit> .

the program5_lowquatilitydata.sas in additional file  <dig> provides the solution to derive the adjusted ΔΔct in the first and second scenarios. a data set with amplification efficiency different by gene is provided in lowqualitydata.txt in additional file  <dig> to illustrate the use of the sas program. the data set is of lower quality mainly because of the limited number of replicates involved in the experiment. four steps are involved in calculating the ΔΔctadjust. the first step is to perform the data quality control test as shown in methods. from the sas output, we can conclude that the lowqualitydata dataset does not meet the requirements for 2-ΔΔct method, since one group of pcr has amplification efficiency significantly different from  <dig> as shown in the data quality control for lowqualitydata dataset part of sasoutput.doc .

the second step is to test the equal pcr efficiency  by observing the type iii sums of squares for lcon and class interaction. a low p value will indicate the interaction of different groups of pcr  with logarithm transformed concentration, which in turn indicates the unequal slope among different groups of pcr. if all pcr amplification efficiency are equal, then the pooled amplification efficiency can be calculated and integrate into the sas program for ΔΔctadjust calculation. in this set of data, the type iii sums of squares has a p value smaller than  <dig> , and the amplification efficiency are not equal for all pcrs. tests of equal slopes are then performed for each gene to decide whether pcr amplification efficiency is the same for each gene. for either gene, the amplification efficiency is not significantly different with an α of  <dig> . all of the type iii sums of squares outputs can be found in sasoutput.doc .

the next step is to calculate the pooled slope  for each gene to derive the percentage amplification efficiency ) for each gene. the pooled slopes are derived based on the correlation between ct and logarithm  <dig> based concentrations. the βcons for the two genes are - <dig>  and - <dig>  respectively as shown in sasoutput.doc  for the amplification efficiency calculation of lowqualitydata dataset. with the βcon, - or pe can be calculated for each gene as  <dig>  and  <dig>  respectively. the ΔΔctadjust can then be computed with pes substituting the  <dig> for each gene in the 'estimate' and 'contrast' statement. the sas program is as follows in additional file  <dig> 

title  <dig> 'calculate the deltadeltact with adjusted efficiency';

proc mixed data=tr <dig> order=data;

   class class con;

   model ct = con class con*class/solution noint;

   contrast 'intercepts' class  <dig>  - <dig>  - <dig>   <dig> ;

   estimate 'intercepts' class  <dig>  - <dig>  - <dig>   <dig> /cl;

run;

the sas output for the analysis is in sasoutput.doc . the ΔΔctadjust is therefore - <dig>  and the change is significant since p value is very small. the ratio can be represented as discussed in the standard ΔΔct method. the point estimation of the ratio in this example is  <dig> , and the 95% confidence interval is .

overall, in the less optimized pcr reactions, statistical analysis is not only complicated but also compromised for precision and efficiency. therefore caution should be exercised when performing statistical analysis with the low quality real-time pcr data, which may easily introduce error due to the efficiency adjustment  <cit> .

CONCLUSIONS
in this report, we presented four models of statistical analysis of real-time pcr data and one procedure for data quality control. sas programs were developed for all the applications and a sample set of data was analyzed. the analyses with different models and programs yielded the same estimation of ΔΔct and similar confidence intervals. the data quality control and analysis procedures will help to establish robust systems to study the relative gene expression with real-time pcr.

