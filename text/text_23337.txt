BACKGROUND
gene expression from dna microarray data offers biologists and pathologists the possibility to deal with the problem of cancer diagnosis and prognosis from a quantitative point of view  <cit> . conventional tumor diagnosis consists of the examination of the morphological appearance of tissue specimens by trained pathologists. it is subjective and generally it does not allow the establishing of a unique therapy as tumors with similar histopathological appearances can follow different clinical courses  <cit> . gene expression data provide a snapshot of the molecular status of a sample of cells in a given tissue, returning the expression levels of thousands of genes simultaneously. they make it possible to analyze the genes involved in a particular type of cancer  <cit>  as well as the classification of tumor specimens in different categories  <cit> . although dna microarray data offer enormous opportunities for the definition and understanding of several pathologies, they hide potential pitfalls in their analysis and interpretation  <cit> . a large number of overoptimistic results have been recently published in the literature regarding the possibility of constructing very accurate prediction rules for cancer from only a few genes. zhang et al.  <cit>  showed that a three gene classification tree had an error rate of 2% in colon cancer diagnosis, and guyon et al.  <cit>  showed that a support vector machine  trained on only two genes had a zero leave-one-out  error in classifying patients with leukemia.

there exists a twofold explanation for such misleading results. the first one concerns the data. normally, a typical experiment of cancer classification by gene expression data consists of a few number ℓ of specimens, between  <dig> and  <dig> examples, each one of which is composed of a large number d  of gene expression levels. we know that  <cit>  the vc-dimension of the class of linear indicator functions in ℝd is d +  <dig>  this means that the simplest classifier, consisting of a separating hyperplane living in the space of the input specimens, is able to separate d +  <dig> points independently of their labelling. in the application at hand, where the number of features  d is some order of magnitude greater than ℓ, the possibility of separating perfectly the specimens without errors is implied. this problem, known in machine learning literature as "overfitting", is exactly the kind of problem that should be avoided in order to construct predictors able to generalize, i.e. which are able to correctly predict the labels of new specimens.

the second reason concerns the methods of analysis. this can be better illustrated through some examples. it has just been said that the ultimate goal of a learning machine is that of generalizing. how is the generalization error of a predictor measured? what is the statistical significance of such a quantity given that it is measured by using only a few examples? different methodologies will return very different answers. it is well know that the loo-error provides an almost unbiased estimate of the generalization error of a predictor  <cit> . although the bias of the said estimator is low, it is highly variable  <cit>  and has little statistical significance  <cit> . on the contrary, the leave-k-out cross validation  error provides a more significant estimate of the generalization error and it should be used to assess the accuracy of a classifier  <cit> . one further example concerns the methods that select a subset of genes to work with to reduce the problem of overfitting and for finding informative genetic markers of a particular pathology  <cit> . as ambroise and mclachlan in  <cit>  have admirably pointed out, such methods should carefully avoid the selection bias problem if reliable estimations of the generalization error of predictors are to be obtained. in the present paper a general methodology for the statistical assessment of prediction rules trained by using gene expression data is described, which can be seen as a natural extension of  <cit>  and  <cit> . the method answers precise questions relevant to cancer diagnosis, avoiding the potential pitfalls connected to microarray data. in this study a new data set of gene expression data is used which was collected from  <dig> patients affected by colon cancer in "casa sollievo della sofferenza"  hospital, san giovanni rotondo , italy. the first set of questions posed concerns the data set. is the size of the available data set sufficient to build accurate predictors? in which ways does accuracy depend on the prediction model? what is the statistical significance of the prediction error measured? the second set of questions is about the number of gene expression levels. how many genes are correlated with the pathology? how do the accuracy and the statistical significance of the predictor change with respect to the number of the genes used? how does the adopted feature selection strategy influence the prediction error with respect to a random selection of genes? answers to these questions were provided by using well established models for the classification of gene expression data. in particular we resorted to weighted voting algorithm  classifiers  <cit> , regularized least squares  classifiers  <cit>  and support vector machine  classifiers  <cit> . for the assessment of the statistical significance of the classification errors measured, non parametric permutation tests  <cit>  were adopted.

RESULTS
data set description
study population
twenty-five patients , who underwent colonic resection for colorectal cancer  at css hospital, were prospectively recruited into this study. two samples from each patient were available, one from colon cancer tissue and one from normal colonic mucosa tissue. the samples had been obtained during the surgery, immediately frozen in liquid nitrogen and then stored at -80°c. all of them were reviewed by the same experienced pathologist to confirm the histological diagnosis. none of the patients suffered from hereditary crc or had received preoperative chemo-radiotherapy. informed consent to take part in this study was obtained from all the patients. the study was approved by the hospital's ethics committee.

rna extraction from fresh frozen tissue
total rna from 150– <dig> mg of fresh frozen tissue was isolated by phenol-chloroform extraction  and subsequently purified through column chromatography  according to the manufacturer's instructions. rna integrity was monitored using denaturing agarose gel electrophoresis in 1x mops. three neoplastic samples were discarded from the final analysis since their rna preparation was suboptimal.

microarray assays
biotinylated target crna was generated from  <dig> mg as described by the affymetrix expression analysis genechip technical manual . briefly, double-stranded cdna was synthesized from total rna using the superscript choice system , a primer containing poly and a t <dig> rna polymerase promoter sequence. in vitro transcription using double-stranded cdna as a template in the presence of biotinylated utp and ctp was carried out using bioarray high yield rna transcript labeling kit . the resulting biotynilated-crna "target" was purified and quantified. fifteen micrograms of biotinylated crna were randomly fragmented to an average size of  <dig> nucleotides by incubating in  <dig> mm tris-acetate, ph  <dig> ,  <dig> mm potassium acetate, and  <dig> mm magnesium acetate at 94°c for  <dig> minutes. the fragmented crna was hybridized for  <dig> hours at 45°c on human genome u133a genechips containing a total of  <dig>  probe sets and after stained in a fluidics station with streptavidin/phycoerythrin, followed by staining through a streptavidin antibody and streptavidin/phycoerythrin. arrays were scanned on a genearray scanner g2500a by using standard affymetrix protocols. absolute data analysis was performed using the affymetrix microarray suite  <dig>  software.

algorithms
estimating the number of training examples
we are given a data set s = {, , ..., } composed of ℓ labelled specimens, where xi ∈ ℝd and yi ∈ {- <dig>  1} for i =  <dig>   <dig> ...,ℓ. let us suppose we have ℓ+ positive and ℓ- negative examples, such that ℓ = ℓ+ + ℓ-. in order to estimate the minimum number of examples to be used for the training of a classifier with a low error rate and a high statistical significance we used a two-step method: a cross validation procedure for the estimation of the error rate of classifiers trained through a given number of examples, and a permutation test for the assessment of the statistical significance of the classification accuracy obtained. in particular, let n be the training set size, with n =  <dig>   <dig> ...,ℓ -  <dig>  for every value of n, s <dig> pairs  of training and test sets are built by random sampling without replacement into the data set s, with n and k as their respective examples, where ℓ = n + k. in the training/test split of the data, the same proportion of positive and negative examples as s is preserved. for every random split, a classifier is trained by using the examples in dn and its error rate eni
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwglbqzdawgaawcbagaemoba42aasbaawqaaiabdmgapbqabaaaleqaaaaa@3123@ is evaluated by testing it on tk. the selection of the parameter on which the classifier depends  is carried out by using the examples in dn only. in particular, the c parameter in svm is selected minimizing the three-fold cross validation error  <cit>  and the λ parameter in rls is selected minimizing the loo-error. note that in the case of rls, the evaluation of the loo-error requires just one training  <cit> . this procedure for selecting the parameter ensures that eni
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwglbqzdawgaawcbagaemoba42aasbaawqaaiabdmgapbqabaaaleqaaaaa@3123@ is unbiased as it does not involve the test set tk. so, for each value of n, the average error rate en=1s1∑i=1s1eni
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwglbqzdawgaawcbagaemoba4gabeaakiabg2da9maalaaabagaegymaedabagaem4cam3aasbaasqaaiabigdaxaqabaaaaowaaabmaeaacqwglbqzdawgaawcbagaemoba42aasbaawqaaiabdmgapbqabaaaleqaaaqaaiabdmgapjabg2da9iabigdaxaqaaiabdohaznaabaaameaacqaixaqmaeqaaaqdcqghris5aaaa@4080@ is evaluated. notice that when n = ℓ -  <dig>  the classical procedure for the measurement of the loo-error which involves s <dig> = ℓ training/test pairs  is used. the second step consists of evaluating, for every n, the statistical significance of the error rate en. in a nutshell, we are interested in measuring to what extent the accuracy observed is due to the existing correlation between gene expression levels xi and class labels yi, and how it is observed by chance because of the high dimensionality of the space where the examples live. in order to assess the statistical significance of the error rate the classical method of hypothesis testing is applied. let h <dig> be the null hypothesis in which it is assumed that the random variables x and y are independent. to evaluate the p-value corresponding to en, it is necessary to know the probability density function of en under the null hypothesis. since this is unknown, a nonparametric permutation test  <cit>  is needed, the latter being a method of estimating the empirical probability density function of any statistic under h <dig> from the available data. in the contest of classification, the method consists of a) permuting randomly the labels of the training set; b) training a random classifier on this randomly labelled training set and c) testing the classifier obtained on a test set having correctly labelled examples. the reason for this lies in the circumstance that under the null hypothesis all the training sets generated through label permutations are equally likely to be observed, given that the random variables x and y are independent. permutation test technique then allows us to determine the percentage of classifiers trained on randomly labelled data having an error rate less than en in classifying correctly labelled data. in particular the following steps are carried out. for every random split of s in training and test sets , we perform s <dig> random permutations of the labels of examples belonging to the training set dn. let dnπ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgebardaqhaawcbagaemoba4gabaaccigae8hwdahaaaaa@3113@ be the training set with randomly permuted labels. for every permutation, a classifier is trained by using dnπ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgebardaqhaawcbagaemoba4gabaaccigae8hwdahaaaaa@3113@ and the classifier itself is tested on the test set tk which has correctly labelled examples. even in such a case, the parameter on which the classifier depends is selected by using only the examples in dnπ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgebardaqhaawcbagaemoba4gabaaccigae8hwdahaaaaa@3113@. let us indicate with eni,j
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwglbqzdawgaawcbagaemoba42aasbaawqaaiabdmgapjabcycasiabdqgaqbqabaaaleqaaaaa@3360@ the error rate of the random classifier trained on n examples in the i-th cross validation and in the j-th random permutation. then the empirical probability density function of the error rate under the null hypothesis is:

pn=1s1s2∑i=1s1∑j=1s2δ     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbacdawgaawcbagaemoba4gabeaakiabcicaoiabdwgaljabcmcapiabg2da9maalaaabagaegymaedabagaem4cam3aasbaasqaaiabigdaxaqabagccqwgzbwcdawgaawcbagaegomaidabeaaaagcdaaewbqaamaaqahabaaccigae8htdqmaeiikagiaemyzaumaeyoei0iaemyzau2aasbaasqaaiabd6gaunaabaaameaacqwgpbqacqggsaalcqwgqbgaaeqaaawcbeaakiabcmcapawcbagaemoaaomaeyypa0jaegymaedabagaem4cam3aasbaawqaaiabikdayaqabaaaniabgghildaaleaacqwgpbqacqgh9aqpcqaixaqmaeaacqwgzbwcdawgaaadbagaegymaedabeaaa0gaeyyeiuoakiaaxmaacawljawaaewaceaacqaixaqmaiaawicacaglpaaaaaa@5a4e@

composed of a sum of delta functions centered on the errors measured. the statistical significance  of the error rate en is given by the percentage of error rates smaller than en.

estimating the number of genes
the procedure described in the previous section makes it possible to determine the number n of training examples to use for building, in principle, an accurate and statistically significant classifier. this section is focused instead on the following problems. how many genes are needed to classify a new specimen? what is the statistical significance of the error rate of a classifier trained by using n examples, each of which composed of a subset of g genes? in order to answer these questions a methodology is used similar to the one described in the previous section, with the main difference being that this time the specimens are composed of subsets of g genes. in particular, for every g =  <dig> ,...,d, where d is the total number of genes available, s <dig> pairs  of training and test sets are built by random sampling without replacement into the data set s, with n and ℓ - n examples respectively. also in this case, the same proportion of positive and negative examples as in s is preserved. it should be noted that here the number of training and test examples is constant. the training set is employed to rank the genes according to the value of the statistic  <cit> :

ts2n=μ+−μ−σ++σ−j= <dig> ,...,d     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqabeqacaaabagaemivaq1aasbaasqaaiabdofatjabikdayiabd6eaobqabagccqggoaakcqwgqbgacqggpaqkcqgh9aqpdawcaaqaaggaciab=x7atnaabaaaleaacqghrawkaeqaaogaeiikagiaemoaaomaeiykakiaeyoei0iae8hvd02aasbaasqaaiab=jhitaqabagccqggoaakcqwgqbgacqggpaqkaeaacqwfdpwcdawgaawcbagaey4kascabeaakiabcicaoiabdqgaqjabcmcapiabgucariab=n8aznaabaaaleaacqwfsislaeqaaogaeiikagiaemoaaomaeiykakcaaaqaaiabdqgaqjabg2da9iabigdaxiabcycasiabikdayiabcycasiabc6cauiabc6cauiabc6cauiabcycasiabdsgakbaacawljagaaczcamaabmgabagaegomaidacagloagaayzkaaaaaa@5d8b@

where j is the gene index. , σ+ ) and , σ- ) are the mean and the standard deviation of the expression levels of the j-th gene in the positive and negative examples respectively, belonging to the current training set. by using the gene list thus sorted, reduced training and test sets  containing the same examples as the current training and test sets are built, each of which is composed of the g genes that are most correlated with the class labels. in particular, each example in the reduced training and test sets contains the expression levels of the first g/ <dig> and of the last g/ <dig> genes in the list. such a gene selection strategy provides better results than those provided by ranking the genes according to the absolute value of  as reported also in  <cit> . for every random split, a classifier is trained by using those examples in d˜
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgebargaacaaaa@2dcc@n having g components, and its error rate egi
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwglbqzdawgaawcbagaem4zac2aasbaawqaaiabdmgapbqabaaaleqaaaaa@3115@ is evaluated by testing it on t˜
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgubavgaacaaaa@2dec@ℓ-n having examples with g components too. then, for every value of g, we evaluate the average error rate eg=1s1∑i=1s1egi
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwglbqzdawgaawcbagaem4zacgabeaakiabg2da9maalaaabagaegymaedabagaem4cam3aasbaasqaaiabigdaxaqabaaaaowaaabmaeaacqwglbqzdawgaawcbagaem4zac2aasbaawqaaiabdmgapbqabaaaleqaaaqaaiabdmgapjabg2da9iabigdaxaqaaiabdohaznaabaaameaacqaixaqmaeqaaaqdcqghris5aaaa@4064@. two observations should be made. the first is that the procedure of gene ranking involves the examples in the training set only. that is to say, for each iteration the set of g genes is determined on the basis of the training examples only. the test set is thus out of the selection process. this makes the estimated error rate selection bias free  <cit> . the second is that, in general, after each cross validation the list of the g selected genes changes.

the second step of the procedure consists in evaluating, for every g, the statistical significance of the error rate eg. for this purpose, for every random split of s, s <dig> random permutations of the labels of examples in the reduced training set d˜
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgebargaacaaaa@2dcc@n are performed. let d˜nπ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgebargaacamaadaaaleaacqwgubgbaeaaiigacqwfapacaaaaaa@3122@ be the training set with randomly permuted labels. for every permutation, a random classifier is trained by using d˜nπ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgebargaacamaadaaaleaacqwgubgbaeaaiigacqwfapacaaaaaa@3122@ and the classifier is tested on the reduced test set t˜
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgubavgaacaaaa@2dec@ℓ-n having correctly labelled examples. let egi,j
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwglbqzdawgaawcbagaem4zac2aasbaawqaaiabdmgapjabcycasiabdqgaqbqabaaaleqaaaaa@3352@ be the error rate of the random classifier trained on d˜nπ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgebargaacamaadaaaleaacqwgubgbaeaaiigacqwfapacaaaaaa@3122@ in the i-th cross validation and in the j-th random permutation. then the empirical probability density function of the error rate under the null hypothesis is:

pg=1s1s2∑i=1s1∑j=1s2δ     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbacdawgaawcbagaem4zacgabeaakiabcicaoiabdwgaljabcmcapiabg2da9maalaaabagaegymaedabagaem4cam3aasbaasqaaiabigdaxaqabagccqwgzbwcdawgaawcbagaegomaidabeaaaagcdaaewbqaamaaqahabaaccigae8htdqmaeiikagiaemyzaumaeyoei0iaemyzau2aasbaasqaaiabdegannaabaaameaacqwgpbqacqggsaalcqwgqbgaaeqaaawcbeaakiabcmcapawcbagaemoaaomaeyypa0jaegymaedabagaem4cam3aasbaawqaaiabikdayaqabaaaniabgghildaaleaacqwgpbqacqgh9aqpcqaixaqmaeaacqwgzbwcdawgaaadbagaegymaedabeaaa0gaeyyeiuoakiaaxmaacawljawaaewaceaacqaizawmaiaawicacaglpaaaaaa@5a36@

composed of a sum of delta functions centered on the errors measured. the statistical significance  of the error rate eg is given by the percentage of error rates smaller than eg.

frequency assessment of the genes selected
it has been stated that the list of g genes selected in each cross validation changes because the selection of n examples from the data set s is random. nevertheless, since the statistic  assigns high scores in absolute value to the genes most correlated with the class labels, the most informative genes are expected to appear in the first/last positions of the list, irrespective of the n examples used for evaluating the ts2n statistic. therefore the frequency fj of appearance of gene j in the lists of the genes selected during the cross validation procedure can be used as a measure of the importance of gene j in the problem at hand. fj is given by the ratio between the number of appearances of the gene j in the top g positions and the number s <dig> of cross validations. to assess the statistical significance of fj, it is necessary to resort to the permutation test. in particular, s <dig> random drawings of n examples from s are performed and for each one of them s <dig> random permutations of the labels of the n examples are carried out. for each random permutation of the labels, the genes are sorted according to the values of the statistic . the p-value associated to fj is given by the frequency of the gene j in the top g positions in the s <dig> × s <dig> random permutations of the labels.

testing
in this section we try to answer the numerous questions previously raised, showing the results of the methods described as applied to our colon cancer data set. irrespective of the classifier adopted, the genes are appropriately normalized to have zero mean and unit variance. in particular, for each training and test pair with n and ℓ-n examples respectively, the n training examples are employed to compute the mean and variance of each gene and these parameters are used to normalize the genes in both training and test set. moreover, linear kernels in rls and svm classifiers are used.

training set size
the first question posed concerns the data set size. how many examples are sufficient for an accurate classification of microarray data of colon cancer? the answer depends, of course, on the classification model adopted. table  <dig> shows the error rate e and the p-value p of three classification schemes, obtained by varying the number of training examples. the error values were estimated performing s <dig> =  <dig> cross validations and s <dig> =  <dig> random permutations of the labels. wva reaches its minimum error rate of e = 19% with n =  <dig> examples, but this estimate has a poor statistical significance . the best performance of this model on our data set is reached with n =  <dig> training examples, providing an error rate of e = 21% . this table shows that wva has a limited learning ability, because the error rate does not decrease significantly as the number of training examples is increased . rls and svm classifiers show a different behavior. both methods provide classifiers with error rates of e ≤ 19%  with only a few training examples, and their ability of separating tumor from normal specimens improves as the number of training examples increases. the best performances of these classifiers are obtained with n =  <dig> examples. moreover, the error rate does not improve by increasing the number of training examples, suggesting that n =  <dig> is the optimal number of examples to use for the training of accurate rls or svm classifiers . the behavior of the statistical significance of the three classifiers odopted as a function of the training set size is shown in figure  <dig>  as the picture shows, the loo error exhibits poor statistical significance. such evidence, reported in  <cit>  as well, seems counter-intuitive if associated to its having been obtained by using the maximum training set size. this is immediately evident if we associate it to the test set size. in the loo error procedure, the test set is made up of a single example and the likelihood that a random classifier can correctly classify the test example by chance is high. the likelihood decreases as the test set size increases. having the same the number of training examples, rls and svm classifiers show comparable p-values which are always smaller than those of wva. it should be noted that in all the classification schemes, the loo error , in spite of its poor statistical significance, shows values which are comparable to the ones of the lkocv error when n is  <dig> or  <dig>  this means that the loo error provides a good estimate of the generalization error of a learning machine  <cit>  and it can be used as a valid alternative to lkocv error to compare the performances of different classification rules. this aspect is relevant for rls classifiers which require just one training for the evaluation of the loo error  <cit> . moreover, our results coincide with the ones described in  <cit>  where it is shown that 10– <dig> examples suffice for the training of classification rules with a statistically significant error rate.

number of genes
the second question concerns the number of genes. how many genes are sufficient for an accurate classification of gene expression data of colon cancer? in order to be able to answer this question, we applied the method described in the section algorithms. first of all, the number of genes differentially expressed in our data set, i.e. the ones having a statistically significant value of the statistics  had to be determined. to do this, we evaluated  on the actual data set and determined the number of genes having a value of the statistics greater than a given threshold. the denoted curve "observed" in figure  <dig> depicts the number of genes as a function of the statistics ts2n in the actual data set. every point  of the curve represents the number y of genes g such that ts2n ≥ x. the same procedure was applied on data sets with randomly permuted class labels. every point  of the curve denoted 1%  in figure  <dig> represents the number y of genes g having ts2n ≥ x with p-value p ≤ 1% . in this analysis we carried out  <dig> random permutations of the labels of the whole data set. as shown in the picture , about  <dig> highly expressed genes  were found in the two classes:  <dig> genes more highly expressed in normal tissues  and  <dig> more highly expressed in tumor tissues .

frequency analysis of the genes selected
in order to analyze the frequency of appearance fj of the gene j =  <dig>   <dig> ..., d in the lists of the genes g selected in the cross validation procedure, s <dig> =  <dig> random drawings of n =  <dig> examples from the data set s were carried out; for each drawing, the genes were sorted according to the value of the statistic . the frequency fj was evaluated by counting the presence of the gene j in the top g =  <dig> positions  in the lists of the sorted genes. figure 4a) depicts the frequencies of all the genes available. it can be seen that more than half of the genes do not appear in the top g positions of the list. moreover,  <dig> genes were found  to have a frequency greater than 80%  and, among these,  <dig> had a frequency of 100%. aiming to assess the statistical significance of these frequencies, we performed s <dig> =  <dig> random permutations of the labels of the n examples in each random drawing. figure 4c) depicts the number of genes with fj ≥ 80% of which having a given p-value. thanks to this analysis,  <dig> statistically significant genes  were found.

biological analysis
among the statistically significant genes,  <dig> genes differentially expressed between normal tissue and matched tumour tissue, are reported in tables  <dig> and  <dig>  most genes have been already shown to be involved in colorectal tumorigenesis. a brief description of  <dig> genes up- and  <dig> genes down-regulated in tumour tissue, which could be used as diagnostic biomarkers or targets for therapy, is reported. at least  <dig> genes of cell cycle have been shown to be up-regulated in our colon cancer specimens. the mitotic checkpoint is an important signalling cascade that arrests the cell cycle in mitosis when even a single chromosome is not properly attached to the mitotic spindle  <cit> . it has been postulated that defects in the levels of mitotic checkpoint proteins could be responsible for mitotic checkpoint impairment and aneuploidy with disruption of genomic integrity. however, until now, no functionally significant sequence variations of mitotic checkpoint genes has been detected in colorectal cancer  <cit> . conversely, we found that  <dig> genes involved in the mitotic spindle checkpoint  are overexpressed in colon cancer specimens. very recently, an increased expression of mitotic spindle checkpoint transcripts has been reported in breast cancers with chromosomal instability  <cit>  suggesting that mitotic checkpoint impairment in human tumor cells  could be due to increased levels of mitotic checkpoint proteins rather than mutations in checkpoint genes. in tumour, these changes could occur through altered transcriptional regulation by tumour suppressors or oncogene products. drugs that specifically and efficiently interfere with mitotic checkpoint signalling could therefore be useful as anticancer agents. another process which is deeply disorganized in cancer is cell growth with several cellular processes and mechanisms that control cell cycle progression deregulated. in non neoplastic cells, these events are highly conserved due to the existence of conservatory mechanisms and molecules such as cell cycle genes and their products: cyclins, cyclin dependent kinases, cdk inhibitors  and extra cellular factors . at least  <dig> genes of cell cycle progression have been shown to be up-regulated in our colon cancer specimens. they include cdc <dig>  the universal inducer of mitosis, cyclin b and cdc <dig>  which interact with the cdc <dig> to regulate both g1/s and g2/m transitions  of the cell cycle, and the mcm genes which are required for the entry in s phase and for genome duplication.

four up-regulated genes involved in the cell cycle progression are of particular interest in colon tumorigenesis: cks <dig>  cks <dig>  skp <dig>  and foxm <dig>  both cks <dig> and skp <dig> are involved in regulation of g1/s transition and in degradation of cdkn1b  a putative gene suppressor. colorectal tumours with high levels of cks <dig> and skp <dig> generally exhibit a more aggressive behaviour and are associated with low levels of cdkn1b  and loss of tumor differentiation  <cit> . moreover, cks <dig> is expressed at significantly higher levels in colorectal tumors with liver metastasis  <cit> . apart from their prognostic significance, these genes could also represent optimal targets for gene therapy. recently, the effect of transfection of cks1-specific small interfering rna  in human cks1-overexpressing h <dig> lung cancer cell lines has been tested: cks <dig> sirna down-regulated cdc <dig> kinase activity and induced g2/m arrest. long-term treatment of cks <dig> sirna induced caspase activation and apoptosis  <cit> . the foxm <dig> gene is critical for g1/s transition and essential for transcription of cell cycle genes such as skp <dig> and cks <dig>  <cit> . other  <dig> up-regulated genes involved in cell mitosis are stk <dig>  srpk <dig> and top2a, and smc4l <dig>  cnap <dig>  hcap-g, and kif4a. all of them have been found overexpressed in some cancer lines and some tumour cells and may represent both prognostic indicators and molecular target for anticancer drugs. stk <dig> is a critical centrosome-associated kinase-encoding gene overexpressed in multiple human tumour cell types which is involved in the induction of centrosome duplication-distribution abnormalities, chromosomal instability, and aneuploidy in mammalian cells  <cit> . it could represent an optimal target for chemotherapy. srpk <dig> and top2a are part of a multisubunit complex, named toposome, containing atpase/helicase proteins , hmg protein , and pre-mrna splicing factors  which is involved in separating entangled circular chromatin dna during chromosome segregation. in particular, srpk <dig> plays a central role in the pre-mrna splicing, a critical step in the posttranscriptional regulation of gene expression. aberrant patterns of pre-mrna splicing have been established for many human malignancies. recently, it has been shown that srpk <dig> is overexpressed in tumors of the pancreas, breast, and colon and sirna-mediated down-regulation of srpk <dig> in tumour cell lines results in a dose-dependent decrease in proliferative capacity and increase in apoptotic potential  <cit> . these findings support srpk <dig> as a new, potential target for the treatment of cancer.

finally, smc4l <dig>  cnap <dig>  and hcap-g are components of the condensin complex, which also contains other four subunits: smc2l <dig>  brrn <dig>  caph, and capd <dig>  <cit> . kif4a is proposed to be a motor protein carrying dna as cargo in condensed chromosomes throughout mitosis interacting with condensin complex  <cit> . the condensin complex is required for conversion of interphase chromatin into mitotic-like condense chromosomes. interestingly, cdc <dig>  the universal inducer of mitosis, phosphorylates hcap-g, cnap <dig>  and brrn <dig>  thus activating the condensin complex and chromosome condensation. among the up-regulated genes in colorectal cancer, we found  <dig> genes involved in signal transduction , transcription , nuclear transport  and cellular transport . tdgf <dig>  a growth factor with an egf-like domain, is over-expressed in breast, cervical, ovarian, gastric, lung, colon, and pancreatic carcinomas in contrast to normal tissues where tdgf <dig> expression is invariably low or absent. tdgf <dig> is released or shed from expressing cells and may serve as an accessible marker gene in the early to mid-progressive stages of breast and other cancers  <cit> . enc <dig> is another transduction gene probably involved in differentiation of epithelial cells as well as in cell proliferation. enc <dig> is regulated by the beta-catenin/tcf pathway and up-regulated in colorectal cancer where it may suppress differentiation of colonic cells  <cit> . sox <dig> is a transcription factor and seems to be expressed throughout the intestinal epithelium under the control of the wnt-pathway. its function may be to maintain healthy and tumor epithelial cells in undifferentiated state  <cit> . myc and hgfr/met are two well-known oncogenes which activate the transcription of growth-related genes. overexpression of myc and hgfr/met is implicated in the aetiology of a variety of tumours and would serve as an important therapeutic target. eight genes involved in nucleocytoplasmic transport were up-regulated in colon cancer. nuclear-cytoplasmic transport, which occurs through special structures called nuclear pores, is an important aspect of normal cell function, and defects in this process have been detected in many different types of cancer cells.

overproduction of nuclear transport factors such as kpna <dig>  ranbp <dig>  ntf <dig>  and cse1l/cas may disrupt the nuclear import and export machinery leading to loss of nuclear transport of several proliferation activating proteins, transcription factors, oncogene and tumour suppressor gene products and, finally, to cell transformation  <cit> . one up-regulated gene with transport function has been detected: slco4a1/oatp <dig> belongs to a membrane transport systems superfamily with multiple expression in the liver, kidney, small intestine, and choroid plexus barrier. it acts as a mediator in the sodium-independent transmembrane solute transport and has a strategic position for absorption, distribution and excretion of xenobiotic substances  <cit> . at least  <dig> genes involved in apoptosis have been shown to be down-regulated in our colon cancer specimens. fas and casp <dig> are involved in the activation cascade of caspases responsible for apoptosis. both could be involved in tumour progression and poorer prognosis as shown in urothelial cancer  <cit> . pdcd <dig> is a well known tumour suppressor gene involved in apoptosis and inhibition of protein translation. loss of pdcd <dig> is associated with tumour progression and prognosis  <cit>  while overexpression of pdcd <dig> in human colon carcinoma cells is able to suppress tumour progression by inhibiting c-jun and ap- <dig> pathways  <cit> . these findings implicate a potential value of pdcd <dig> as a molecular target in cancer therapy. molecular transport and cell metabolism are strongly impaired in cancer cells. consequently it is not surprising that microarray analysis revealed down-regulation of several genes coding for proteins of transport and metabolism. loss of carriers profoundly affects the intracellular concentration of solutes such as sodium, potassium, hydrogen, and bicarbonate which are involved in several metabolic pathways. loss of enzymes which control the most important metabolic pathways have a negative influence on cell physiology and, most importantly, might render cancer cell less sensitive or resistant to anticancer drugs.

of relevance is the down-regulation of most carbonic anhydrases which control ph homeostasis and modulate the behaviour of cancer cells. in our specimens, several isozymes of carbonic anhydrases  were down-regulated implying a pathogenic role in cancer development or progression. several genes coding for proteins involved in intracellular and cell surface signalling pathways were down-regulated in colon cancer. in our analysis, down-regulation of genes such as map2k <dig>  rps6ka <dig>  mef2c, shoc <dig> produces a serious impairment of the mapk signalling cascade involved in cell growth and differentiation. similarly, other down-regulated genes such as ppp2r3a, muc <dig>  socs <dig> and smad <dig> may contribute to impair wnt, erb <dig>  gh, and tgf-beta pathways involved in several cellular processes. ndrg <dig>  epb41l <dig>  mtus <dig> are three down-regulated genes implicated in cell differentiation. they represent three candidate tumour suppressor genes and are often inactivated in tumours  <cit> . their relevance in colon cancer progression and prognosis is still to be determined. other three down-regulated genes implicated in negative control of cell growth have been identified by microarray analysis: fam107a , btg <dig>  and klf <dig>  tu3a has been found also down regulated in renal cancer cells  <cit> : even if its molecular function is unknown, it could represent a novel suppressor gene. btg <dig> is an antiproliferative protein involved in apoptosis. its role in colonic carcinogenesis is still to be elucidated. finally, klf <dig>  an inhibitor of the cell cycle, has been recently found down-regulated in colonic  <cit>  and gastric cancer. loss of expression of klf <dig> is associated with cancer progression  <cit> .

discussion and 
CONCLUSIONS
the present paper describes a general methodology for the assessment of the statistical significance of prediction rules trained to classify dna microarray data. the method, which can be considered a natural extension of the ones proposed in  <cit> , provides statistically significant answers to precise questions relevant to the diagnosis and prognosis of cancer. the method has been applied to a new dna microarray data set collected in casa sollievo della sofferenza hospital, foggia – italy, relative to patients affected by colon cancer. we have found that it is possible to train statistically significant classifiers for colon cancer diagnosis with as few as  <dig> examples. this result agrees with the one described in  <cit>  and it bears out the empirical observation that tumor morphological distinctions  are, in general, easier to deal with than those concerning the treatment outcome prediction. in our case, the best classification performance was achieved by training an svm classifier with  <dig> examples, which produced an error rate of e = 11% . this shows that the size of our data set is sufficient to build statistically significant classifiers for colon cancer diagnosis.

concerning the problem of determining a sufficient number of genes to be used for an accurate classification of colon cancer, our results suggest that it depends on the accuracy required. in fact, the error rate ranges between e = 11% , obtained training svm classifiers with g =  <dig> genes, and e = 16%  obtained training rls or svm classifiers with only g =  <dig> genes. this result indicates that a remarkable number of genes are altered in the pathology and that a lot of them convey useful information for the classification of new specimens. in order to verify such a result, the following experiment was carried out. we trained an svm classifier with  <dig> examples each of which composed of  <dig> genes randomly drawn from the set of all the genes available, thus obtaining an error rate of e = 23% . this value, although higher than the one obtained by using gene lists ranked with the ts2n statistic , indicates that many different sets of  <dig> genes can be used to build accurate classifiers. the behavior of e as a function of g is consistent and has been pointed out by other authors. for example,  <cit>  finds a decreasing behavior of the error rate w.r.t. g by analyzing three microarray data sets, with different gene selection criteria. in conclusion, our results indicate that a highly accurate and statistically significant classification of colon specimens is possible even when a small number of genes is employed.

some conclusions can be drawn concerning the classification models involved in our analysis. wva classifiers show poor generalization ability and they are greatly influenced by the noise embedded in the microarray data. they rarely provide statistically significant classification performances and, for these reasons, they should not be used as predictors of dna microarray data. on the contrary, rls classifiers performances are comparable to those of svm classifiers, the state-of-the-art supervised learning machines in many application domains, including cancer classification by dna microarray data  <cit> . the main advantage of rls machines in solving a classification problem lies in their employment of a linear system of order equal to either the number of genes or the number of training examples. this property is extremely important and reduces the computational cost of the permutation test because, for a fixed random split of the data, the coefficients of random classifiers are obtained by multiplying a constant matrix with vectors of randomly permuted labels  <cit> . moreover, rls machines allow us to get an exact measure of the loo error with just one training. for all these reasons and because of their simplicity and low computational complexity, rls classifiers provide a valuable alternative to svm classifiers with regard to the problem of cancer classification by gene expression data. moreover, rls classifiers show generalization abilities comparable to the ones of svm classifiers even when the classification of new specimens involves very few gene expression levels. the last consideration concerns the way in which these two classification schemes represent the solution. svm tends to give sparse solutions in terms of number of training examples and rls tends to give sparse solutions in terms of number of features used for classifying.

colorectal cancer is the third most common cancer in men and women and accounts for 11% of all cancer deaths. whereas the 5-year survival rate is extremely favorable when detected at a localized stage , most colorectal cancers are either locally or distantly invasive at diagnosis, limiting treatment options and lowering survival rates. clearly, a more comprehensive view of the molecular events associated with colorectal tumorigenesis is needed to identify tumours earlier and to treat colorectal tumours more effectively. microarray technology has the potential to detect tumour-specific genes which can be used as biomarkers for early diagnosis and specific treatments. potential uses of this technology include determining who will benefit from chemotherapy, further classifying patients into responders and nonresponders, predicting apoptotic response, developing classifiers to recognize chemosensitive tumors, identifying genes that portend a poor prognosis, revealing genes associated with metastases, predicting the outcome according to clinical stage, and avoiding surgery in patients who would not benefit from resection.

in this study, by means of specific statistical methods, we have found several genes up- and down-regulated in colon cancer which could be used as diagnostic biomarkers or therapeutic targets. among the up-regulated genes, the most representative are those implicated in mitotic checkpoint signalling cascade and those controlling cell cycle progression. inhibition of overexpressed genes is potentially useful to control cancer growth. among the down-regulated genes, the most interesting for their potential therapeutic implication are those of apoptosis, intracellular and cell surface signalling, and cell arrest. reactivation of their function could be useful to suppress cancer development or progression. a few of these up- and down-regulated genes have not been described in colon cancer yet. further studies focused on these genes and related transcripts are necessary to better elucidate their pathogenic role in colon cancer disease and their clinical relevance in diagnostics and therapeutics.

authors' contributions
na and fp conceived the study. na, rm and ad designed the algorithms and conduced the experiments and, together with sl and gp, they evaluated and compared the experimental results. ap, rc, ms and mc were mainly involved in the population study, rna extraction and the provision of the final dna microarray data set. all the authors contributed to the drafting of the article. all authors read and approved the final manuscript.

