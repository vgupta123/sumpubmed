BACKGROUND
mathematical modeling of cellular regulatory networks is a challenge due to two opposite requirements: the aim to describe the biological complexity in all necessary detail and the need for simplicity that makes model analysis and simulation feasible.

many signaling pathways and regulatory networks have been described with sets of ordinary differential equations . these models enable a representation of their general wiring and of the kinetics of individual reactions, and can be simulated to follow the dynamics of the investigated system . a frequently used framework to describe the dynamics of gene regulatory networks is boolean modeling .

both approaches helped to elucidate dynamic features of cellular networks, but both have their limitations. ode models quickly become difficult to handle in larger networks. boolean networks, on the contrary, are suitable to model larger networks because they simplify the potential values to binary on or off, representing the activity or presence of compounds. this simplification enables us to describe and to analyze the dynamics of rather large networks, but neglects intermediate values, which may be of biological relevance.

when modeling signaling networks, the formation of protein-protein complexes and multiple phosphorylation or other modification steps quickly leads to a combinatorial explosion in the number of states. we have previously developed a method to cope with the biological complexity provided by the multitude of states of proteins, of interactions between proteins and dependencies restricting potential state changes. in the reaction-contingency  formalism, all potential states and state transitions are listed together with the conditions  under which they can occur  <cit> . as a consequence, the state transitions are only executed if relevant conditions are met, i.e., when educts are present and contingencies are fulfilled. this description is similar to rule based models, and reduces the complexity drastically compared to a full ode system  <cit> . the rxncon format is tailor made for formalization of biological knowledge from literature, and a rxncon based description can be used to automatically generate models that correspond to the network definition. with a recently presented bipartite boolean model export, the resulting models can be simulated over time in a boolean fashion  <cit> .

in this paper, we extend this bipartite boolean modeling formalism with probabilistic model export and simulation, as used in probabilistic boolean networks   <cit> . pbns are extensions of boolean networks , in which each node can have several update functions  <cit> . one of these is chosen randomly in each time-step according to the probabilities assigned beforehand, which makes state transitions non-deterministic. however, the model can also be interpreted quantitatively by averaging over a number of parallel realizations. hence, this extension enables a semi-quantitative probabilistic simulation of regulatory networks in a bipartite pbn format.

here, we use this concept to enable a quantitative probabilistic simulation of regulatory networks. it is based on the description in rxncon format and the boolean model export and assigns probabilities to reactions. this way, it allows for a stochastic simulation of the reaction system and, hence also for a quantitative analysis. using this method the contingency of a reaction on a modifier can be modeled as a certain probability p that the reaction depends on the modifier.

we benchmark the capabilities of the approach  with an example of an oscillatory system in the form of an isolated map kinase pathway with negative feedback, and  by applying the method to the full mapk network of saccharomyces cerevisiae to investigate under which conditions the signal is reliably transmitted. taken together, these examples demonstrate that the method scales with network size: it is largely insensitive to the assumption on parameter values, and can efficiently simulate large networks.

methods
a network definition in the rxncon formalism uniquely defines a bipartite boolean model
we previously defined the rxncon formalism for the representation of biological networks and described a way to generate boolean models from it that can be simulated directly  <cit> . briefly, the rxncon language describes a network in terms of decontextualized elemental reactions, their corresponding elemental states, and contingencies that define the contextual constraints on elemental reactions  <cit> . an elemental state has a single molecular property defined, such as a specific phosphorylation of protein-protein interaction, and hence is a set containing all specific states that include this particular property. elemental reactions define state transitions that produce or consume elemental states, and hence correspond to all specific reactions that change that particular property – regardless of the presence or absence of any other elemental state. instead, such contextual conditions are provided by the contingencies, which define when reactions require or are enhanced by the existence or absence of other elemental states. together, the elemental reactions and contingencies fully define the network, and can be directly exported to a bipartite boolean model with a unique truth table  <cit> .

the logic of the bipartite boolean model is encoded in the rxncon language. importantly, each reaction has a specific type that gives it certain properties , but no parameters or kinetic laws are required. the reaction types include covalent modifications ), intra- and intermolecular interactions ), production and consumption reactions ) and translocation reactions ). which products a reaction creates depends on its type, e.g., a protein-protein-interaction of a and b  generates all complexes in which a binds to b . the contingencies determine if a reaction can take place given other states in the system . contingencies can be absolute requirements, as denoted by an exclamation mark , absolute negative as denoted by an “×”, or quantitative contingencies that only express a quantitative influence which are denoted by k+/k-. the quantitative contingencies mean that the reaction rate switches between two non-zero levels. there are also contingencies that exclude any influence  or imply unknown connections , which are both treated as no effect.

given such a network, we can derive a bn that can be used to simulate the network dynamics using a set of rules. the resulting bn has a bipartite structure split into reaction nodes and state nodes . the update function for a reaction depends on its substrates and its contingencies while the update function for a state depends on the reactions connected to it. the product states of non-reversible reactions require active degradation, and are only set to false if there is an active consumption reaction and no producing reaction. hence, these states need to have a memory, which is implemented as self-dependence in the model. reversible reactions must be true for their product states to stay true, and their products are assumed to degrade when they are false. we give a short example in rxncon formatfig.  <dig> principles of the rxncon formalism and the bipartite boolean modeling. a bipartite boolean modeling based on rxncon format. two protein-protein interactions between b and c , and between a and b , produce the b--c and a--b complexes, respectively. note that these complexes are not mutually exclusive. instead, they correspond to all complexes containing b & c and a & b. the trimeric a-b-c complex corresponds to the intersection between these two sets. the symbol “*=” means that the value of left side at time t +  <dig> will be equal to the value of right side at time t. b in a specific state description, these reactions translate into a network with three possible complexes  and four different reactions. hence, the elemental reactions in  are generic statements that map to several distinct specific reactions in . if the specific reactions corresponding to a single elemental reaction occur with different rates, then the elemental reaction is contingent on one or more of elemental states. there are six such possible contingencies ; absolute requirement ); positive effect ); neutral ); negative ) and absolutely inhibitory ). unknown effects  are treated as neutral. in a qualitative boolean model, only absolute requirements or inhibitions affect the update functions, while the probabilistic model can account also for the quantitative modifiers , as can be seen in the direct comparison between the two model formats c: in this table, protein-protein interaction b_ppi_c is omitted. the false rules  correspond to noise in biological systems, and can be set to any value between  <dig>  and  <dig> . the second boolean functions in the rows “a_ppi_b; k+ b--c” and “a_ppi_b; k- b--c”  only appear in the probabilistic model, allowing it to account for quantitative modifiers , which was not possible with the qualitative version. in the probabilistic boolean modeling, one of the boolean functions is chosen randomly at each time step according to the probability assigned to it



b_ppi_c

a_ppi_b; ! b--c,

where “ppi” is a protein-protein-interaction and a, b, and c are protein components of the system. following this definition, b and c can always interact to form the complex “b--c” which in turn enables the interaction between a and b if present. it is important to stress that the complex b--c is not a specific state, but rather the entire set of states that includes b bound to c . the resulting boolean network from this definition would be: b−−ct+1=b_ppi_cta−−bt+1=a_ppi_bta_ppi_bt+1=at∧bt∧b−−ctb_ppi_ct+1=bt∧ct with t being the current time-step. so we get an update function for the two possible states and their producing reactions.

if a rxncon definition contains a reaction that degrades or synthesizes a component, we need to add more logic to the update functions to ensure that a state is only true if these functions are in the right configuration. essentially, states require their components to be there. hence, if a component belonging to a state is degraded and not synthesized at the same time it cannot be true, regardless of any other reactions.

the differences in the update functions for other types of contingencies are shown in fig. 1c. as shown there, non-absolute contingencies that represent a gradual influence of a state on a reaction are simply ignored in this approach, which is a strong limitation for the results. we address this shortcoming using the probabilistic approach presented here.

extension towards probabilistic simulations enables the use of quantitative modifiers
in the probabilistic boolean network approach each node × can have more than one update function and each of the update functions fi has an assigned probability pi to be chosen in each time-step. we use a synchronous updating scheme and an instantaneously random probabilistic boolean network  without changes to the probabilities over time and thus produce a markov chain. to be able to represent quantitative contingencies in boolean simulations, we assign each reaction that depends on a quantitative contingency at least two update-functions; one depending on the contingency and one that does not . we use the functions' probabilities as parameters for how strong the reaction relies on the contingency, so that a reaction depends on a contingency only with the probability pi and is independent with the probability 1-pi.

to be able to model a small random failure of the whole reaction and test the models robustness we add one update function that always evaluates to false and which has a probability of pfalse.

for complicated cases  multiple boolean functions are generated depending on the number of positive and negative effectors and different probabilities are assigned to them . let p <dig> and pfalse be the probabilities assigned to the boolean function without contingencies and the false function, respectively, then p <dig> is given by the following equation:fig.  <dig> the probabilistic bipartite boolean modeling method can handle complex cases. here, we consider a reaction with one absolute requirement , two positive quantitative modifiers , two negative quantitative modifiers  and one absolute inhibition . the boolean functions are generated according to the number of positive  that are true and negative effectors  that are false. the probability assigned to each boolean function, except for the false function, increases k times as the number of fulfilled quantitative conditions in a set  increases, where the total probability of the boolean functions  is 1

 p0=1−pfalse/∑i=0nki, where n is the total number of positive and negative quantitative modifiers. the parameter k scales the probability differences between the update functions so that each probability pi is k times larger than the probability pi- <dig>  the i-th boolean function is assigned a probability of pi = p <dig> · ki. for k >  <dig>  this scaling guarantees higher probabilities for more restrictive update functions , because these are ordered by stringency. in each update function fi , we include the conjunction of i contingencies. for each fi this leads to ni possible combinations of contingencies. we require at least one of these combinations to be true by taking their disjunction. the update functions become more restrictive for larger i by requiring at least i. modifiers to be true, meaning that if fi = true it follows that fi- <dig> = true. in summary, this means that each update function fi requires at least i contingencies to be true and has a probability to be chosen that is proportional to ki. if we consider the simple example above and add different quantitative contingencies

b_ppi_c

a_ppi_d

a_ppi_b; k+ b--c; k- a--d

we get to the following update functions for the reactions following the rules above with the parameters k =  <dig> and pfalse =  <dig> : a_ppi_dt+1=a∧dt <dig> a_ppi_dt+1= <dig> a_ppi_bt+1=at∧bt <dig> a_ppi_bt+1=at∧bt∧b−−ct∨¬a−−dt <dig> a_ppi_bt+1=at∧bt∧b−−ct∧¬a−−dt <dig> a_ppi_bt+1= <dig> b_ppi_ct+1=bt∧ct <dig> b_ppi_ct+1= <dig>  

the number of boolean update functions for a reaction with n quantitative modifiers is n +  <dig> as we iterate the number of required modifiers from  <dig> to n, plus the pfalse function. it is worthy to note that we only need two parameters  to generate a simulation-ready model, but the user is able to change each of the update probabilities to their needs in the output file.

implementation
the rxncon tool is published as open source software . the tool as well as its source code can be downloaded freely from http://www.rxncon.org. the standard boolean model is generated in booleannet format  and simulated in booleannet  <cit> . since booleannet does not provide probabilistic boolean simulation, we added the capability to simulate probabilistic boolean models using boolnet  <cit> , an r  package for probabilistic boolean networks. accordingly, the rxncon tool was modified such that it can create a model in the boolnet format.

the rxncon tool is implemented in python and javascript. here, we added the probabilistic model generation to the rxncon tool . the tool can be used online and we provide a desktop version for all major platforms as a download.

RESULTS
in the methods section, we introduced the concept of probabilistic simulation of a rxncon-derived boolean network and assigned probabilities to execute reactions according to their rules or to contradict them . below, we exemplify the approach for selected signaling networks in order to analyze the effect of assigning false-rates and a k-base for combining probabilities for multiple contingencies. we illustrate the effect of parameter choices on the oscillatory behavior of a pathway with negative feedback. finally, we demonstrate that the approach can be applied to a large signaling network.

application: oscillatory system representing simplified signaling pathway with negative feedback
to show the capabilities of our probabilistic approach, we used the simplified high osmolarity glycerol  pathway of s. cerevisiae as an example of oscillatory system   <cit> . the simplified hog pathway consists of two modules: a phosphotransfer module and a map kinase module. a signal from an external module leads to inactivation of the phosphotransfer module and activation of the map kinase module, and then the output of the signal cascade in the map kinase module feeds back to the phosphotransfer module via glycerol accumulation . the rxncon definitions of the pathway are illustrated in fig. 3b and implemented as a qualitative  or quantitative model .fig.  <dig> the probabilistic method can simulate dampening of oscillations in a linear signaling pathway with negative feedback. a simplified model of the high osmolarity glycerol  pathway visualized as a regulatory graph  <cit> . the simplified hog pathway consists of two modules: a phosphotransfer module and a map kinase module  <cit> . when turgor is sufficient, the phosphotransfer module is active and keeps the downstream map kinase module inactive. on the other hand, increased external osmolarity causes loss of turgor, which leads to inactivation of the phosphotransfer module and activation of map kinase module. the output of the signal cascade activates the phosphotransfer module again via glycerol accumulation, which leads to turgor recovery. b descriptions of the simplified hog pathway in the rxncon format. the upper panel displays the qualitative hog model, and the lower panel the quantitative hog pathway in which all contingency symbols were changed from “!” or “×” into “k+” or “k-”, respectively, indicating a certain probability of the occurrence of a reaction if its contingencies are met or not met. c, d results of the time course simulation of the qualitative hog model with a non-zero failure rate  and the quantitative hog model. the average probabilities of being active or inactive are calculated over  <dig> time series of  <dig> time points. c the amplitude and phase for the 1st and 7th periods are represented by the size and colors of nodes, respectively. the parameters p and k shown in each panel indicate false-rate and k-base value, respectively. d individual state transitions of hog1-{p} with different probabilities of false-rate and different scale factors of k-base. the upper  and lower  panels show the average value for the phosphorylated state of the terminal map kinase  in the qualitative hog model and the quantitative hog model, respectively



we analyzed time series of the qualitative and quantitative hog pathway with fixed start states. to be able to follow the dynamics of the network, we simulated  <dig> runs of the probabilistic model and averaged over the boolean state of each node in all simulations to calculate a probability of activation. in a standard simulation only the network nodes that were defined as components in the rxncon system  were set to true in the start state. the simulation results are shown in fig. 3c and d. they reveal that high false-rates and low k-base values lead to a fast convergence of the system to a steady state  after averaging over  <dig> simulations. however, what appears to be dampened oscillations is an effect of a loss of synchrony of oscillations between the single simulation runs. for the qualitative model , when false-rate was  <dig> , the system converged gradually to a state around  <dig>  . on the other hand, when the false-rate was  <dig> , oscillations broke down early because of rapid desynchronization. compared to that, synchronous oscillations were kept for a long time when k-base value was high. this is because the model with high k-base values well approximates the qualitative model. finally, we used a low false-rate  and a high k-base value  and generated time series. in this case, oscillations were kept in early stage and the system converged gradually . these results revealed that our approach, with appropriate false-rates and k-base values, enables more realistic boolean simulation of biological systems .

scalability: the method can be used to simulate the entire map kinase system
we applied our probabilistic approach to map kinase network of baker’s yeast as an example of realistic signaling networks. the map kinase network is related to control of cellular functions such as stress response. as described in  <cit> , the first rxncon model of the map kinase network was constructed based on literature, and contains  <dig> components,  <dig> states, and  <dig> reactions. we later translated this network into a qualitative bipartite boolean model, in which all contingencies are absolute, and made minor adjustments because the bipartite boolean modeling approach cannot deal with quantitative models  <cit> . this work also extended the network model to encompass  <dig> components,  <dig> elemental states, and  <dig> elemental reactions, in order to make the pathways functional in the model. we used this previously published network and further modified it to a quantitative model by reverting to the original quantitative contingencies  <cit> .

state evolution of the map kinase network and individual state curves of phosphorylated hog <dig> and slt <dig> with varying k-base are shown in fig.  <dig>  this comparison shows the effect of different parameter sets on the output signal of the network. the deterministic simulation uses absolute contingencies without false-rates as shown in  <cit> . as a negative control, we used a modified version of the same map kinase network model in which the effects of quantitative modifiers was not taken into account . this modification completely removes the effect of the quantitative modifiers in the network, and destroys the information transfer ability of the pathways that no longer respond to perturbations. in these simulations, we ran the model to steady state where we turned off turgor at time t =  <dig>  switched it on again at time t =  <dig>  and then turned on mfalpha at time t =  <dig> in order to analyze the cross-talk effects. the simulation results show that the state evolution gets smoother as the k-base value becomes smaller, while the system becomes noisier. we explored a range from almost deterministic simulation  to equal chances of choosing rules with no bias depending on the number of fulfilled contingencies . however, the signal can be seen even when the k-base value is  <dig>  in spite of very high background. this indicates that the system is quite robust against change of k-base value.fig.  <dig> the probabilistic method scales efficiently, and can be used to simulate the entire yeast map kinase network. the complete map kinase network  <cit>  was used to generate models with variable k-base values. the top panels show the state evolution of all model species in the map kinase network model as a heat map. the average probabilities of active or inactive are calculated over  <dig> time series of  <dig> time points. as the average probability increases, the color changes from blue  to yellow  gradually. p and k indicate false-rate and k-base, respectively. the initial setting was  = , but turgor was turned off at time t =  <dig>  then switched on again at time t =  <dig>  <cit> . mfalpha was added at time t =  <dig>  the individual state transitions of hog1_-{p} and slt2_-{p} are shown in the middle and bottom panels. the rightmost panel shows a negative control in which all “k+” and “k-”contingencies were deleted



CONCLUSIONS
the probabilistic approach enables quantitative analysis of rxncon-derived boolean networks
the presented extension of the boolean approach to a probabilistic boolean network allows for a stochastic simulation of regulatory and signaling networks, which are already presented in the rxncon formalism. it can, hence, respect important biological details and contingencies, but also include probabilities for the occurrence of reactions.

we have demonstrated the impact of the probabilistic simulation for a small example and a large realistic map kinase network. it can be noticed that the non-deterministic simulation can exhibit system properties that will not occur in a deterministic simulation. for the isolated hog pathway with artificially introduced negative feedback we observed de-synchronization and hence a dampening of the oscillations in the simulated ensemble, while the oscillations are stable in the deterministic system. the full mapk system showed, on the ensemble level, that a visually detectable signal is transmitted even with very low k-values, which could be interpreted in the sense of robustness of the signaling network.

to get statistically meaningful results in stochastic simulations one usually averages over large numbers of replicates, as we have also done here. this enabled to see in the mapk network visually distinguishable signals in the pathway output even with no bias towards choosing rate laws with fulfilled contingencies . there are various ways to interpret these results and it is common to regard each iteration as the pathway output in one cell and consider the result as a population mean. however, the iterations could also be interpreted as isolated instances of signaling pathways in one cell, in which case multiple parallel pathways compensate for high noise levels. such pathways would need to be insulated from each other ).

depending on this interpretation, the obtained probabilities in pathway output correspond to a quantitative simulation of either the behavior of many pathways in one cell or an average over many cells. while this modeling strategy cannot compare to the precision of ode models, it provides a much closer approximation than classical or binary reaction-contingency based boolean modeling.

the probabilistic boolean approach based on rxncon is automated and can be reused
model generation and parameterization is generally a major challenge, even given a reasonable base of knowledge about the system. typically, structuring and parameterization require a large efforts and even boolean models need decisions on exact truth tables. the challenge is even more daunting in quantitative models. this has been tackled in approaches such as ode-fy  <cit>  or squad  <cit> , where at least threshold levels or kinetic parameters such as hill coefficients or km values must be set. in ode models in general, parameter estimation is an art even given a fully determined model structure  <cit> . here, using a special case of pbn modeling, we parameterize a full mapk network model using only two parameters, and show that the qualitative outcome is robust against large changes in both. hence, the proposed method supports full automation of model generation from a biological knowledge database . given sufficient suitable experimental data, however, further more detailed parameterization is possible.

the direct link to an underlying database is specifically useful in the light of network reconstruction and curation in combination with model quality assurance, which is a time consuming work requiring knowledge and effort of experts  <cit> . the fact that models can be easily reused is of great importance for an ongoing description of biological network  <cit> . here, it is exemplified for networks of the yeast s. cerevisiae, but would be of even greater importance for human signaling networks relevant in health and disease. our approach is in line with standardization efforts as supported by sbml and it enables model annotation. the method offered here has the advantage that it is based on a database format that allows high level of annotation, and that can be used for other exports, i.e., into sbml or various visualization tools, such as cytoscape. hence, a model developed in this format can also serve as a database and can easily be reused and extended in other contexts.

the framework allows for scalable quantitative modeling
perhaps the premier challenge for formulating appropriate mathematical models is the complexity of signaling networks, especially due to formation of multiple complexes and many different post-translation protein modifications. while methods for compact model definition have been developed  <cit> , the computational demand on simulating large complex networks is daunting. e.g., the yeast pheromone model contains a single map kinase pathway with  <dig> species, but the reaction rules correspond to over  <dig>  specific states . here, we model the complete map kinase network consisting of a much larger number of components. despite the large network size, both model generation and simulation are quick . the main advantage with the reaction-contingency based model structure is that it avoids the combinatorial explosion of the possible interactions and modifications, hence models scale very nicely with the number of components and reactions, and the method will be computationally efficient also for much larger models.

abbreviations
bnboolean networks

hoghigh osmolarity glycerol pathway

mapkmitogen-activated protein kinase

odeordinary differential equations

pbnprobabilistic boolean networks

tomoya mori and max flöttmann contributed equally to this work.

competing interests

the authors declare that they have no competing interests.

authors’ contributions

mf, tm, mk, and ek designed and conceived the method. tm implemented and tested the method. mf participated in the implementation. ek and mf wrote the manuscript. ta revised the manuscript critically. all authors read and approved the final manuscript.

