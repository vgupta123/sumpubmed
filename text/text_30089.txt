BACKGROUND
elucidating how genes are regulated is an important step in understanding the processes of life. one approach to infer gene regulation and regulatory networks is to predict transcription factor binding sites  in genomic sequence data. these tfbss may be located upstream or downstream of known genes, or be part of their utrs . there are already tools available for searching genomic regions from multiple species for tfbss such as mapper  <cit>  or genomatix matinspector  <cit> . these tools use tfbs models represented by hidden markov models , position specific weight matrices , or iupac consensus sequences  to predict tfbss in a dna sequence. in case of mapper, the source of models are jaspar  <cit>  and transfac  <cit> ; genomatix uses a database of tfbs developed in-house. the dna motif that these tools are designed to match is usually short  and thus it is not surprising, that there are many false positive matches. we showcase that the visualization and study of the evolutionary history of regulatory regions can be insightful, and that it helps to separate the wheat from the chaff. we argue that beyond evolutionary conservation of binding sites, plausible patterns of common gain and loss of tfbss in evolution ease this separation.

an evolutionary approach for tfbs prediction is phylogenetic footprinting  <cit> , based on the idea that the sequences coding a regulatory element should be preserved across different species. phylogenetic footprinting methods try to discover tfbs in a set of orthologous regulatory regions from multiple species, by identifying the best conserved motifs in those orthologous regions  <cit> . we propose here to make a step forward with respect to already well-established phylogenetic footprinting servers such as footprinter  <cit> , providing a tool for analyzing and visualizing the evolution of the binding sites. up to now, large and even small amounts of data had to be digested and visualized manually for this task, by writing down all predictions for each sequence, positioning these in the alignment, and annotating a trusted species tree with them. the annotated alignment then highlights conserved tfbss and the annotated tree describes the evolution  of binding sites.

with the exception of mulan  <cit> , visualization approaches published up to now do not calculate nor consider phylogenetic trees. moreover, there is no tool that can annotate phylogenetic trees with tfbs information, nor is there a multiple alignment visualization that also presents a multiple alignment of the tfbss.

in particular, conreal  <cit>  gives an alignment overview for two sequences only. similarly rvista  <cit>  only handles pairwise sequence comparison. in contrast, multitf  <cit>  displays tfbss and conservation for multiple species, but without considering tfbs predictions separately for each species, they are all listed in one track. mulan  <cit>  produces an annotated alignment, but it uses only pairwise alignments of each sequence with a reference sequence; multitf identifies conserved tfbs in the mulan output, and displays the result pairwise using rvista  <cit> . it displays an unannotated distance tree of the sequences to inform the user about the phylogenetic relationship of the sequences. prodoric  <cit>  is suitable for bacterial genomes only. the ecrbrowser  <cit>  is a genome browser showing only sequence conservation and tfbs predictions that are precomputed, just like ucsc  <cit>  and ensembl  <cit> .

to fill some of the gaps not covered by the tools listed above we have written rexspecies with the following specification.

 <dig>  import tfbs predictions from different sources ;

 <dig>  filter tfbs predictions to extract the relevant ones;

 <dig>  visualize evolution of tfbss using an annotated tree and an annotated alignment;

 <dig>  analyze validity of the tfbs predictions by calculating trees out of the tfbs predictions, the sequence alignment and/or a concatenation of both using mrbayes  <cit> ;

 <dig>  provide access via a web front end;

 <dig>  provide a modular design to make extensions possible;

 <dig>  offer a simple wiki and functionality to share results.

a significant limitation in the understanding of gene regulation and regulatory networks is the lack in visualizing and mastering patterns associated with the very large amounts of data generated by technology such as dna sequencing, chip on chip, chip-seq, and microarrays. rexspecies is intended to reduce this limitation. it can be accessed via a web front end  <cit>  and a tutorial is available there  <cit> .

implementation
rexspecies workflow
to automate digestion and visualization of the evolution of regulatory regions, we have developed rexspecies . the software can be used via a web front end  <cit> . rexspecies is divided into different modules. most important modules are the rendering module, the alignment module, the tfbs module, and the file module. the common work flow is to upload the data using the file module, manage the data using the alignment and the tfbs module and finally combining the data with the rendering module; see figure  <dig> for details.

input and output
the input for rexspecies are a set of homologous sequences, predicted tfbss for these sequences , and a phylogenetic tree . sequences in fasta format can be read, but rexspecies can convert other formats to fasta. if the sequences are not aligned, rexspecies can align them using muscle  <cit> .

the most simple format for tfbs predictions that rexspecies can read is the mapper output format . moreover, rexspecies can read genomatix-generated html tables directly. last but not least, xml import/export of tfbs predictions is possible, see  <cit> . phylogenetic trees can be read in newick or nexus format.

rexspecies generates html output containing an annotated alignment and an annotated tree as described below. these html documents may be saved locally by current web browsers.

annotated alignment
to provide an overview over the tfbs predictions, the sequence alignment annotated with tfbs predictions can be calculated and displayed for comparison across species, see figure  <dig> and additional file  <dig> for an example of the annotated alignment of an upstream regulatory region of the pluripotency gene nanog. the alignment makes available additional information about the tfbss when the mouse pointer moves over a prediction.

filtering
to reduce the number of tfbs annotations, we filter them based on the e-value of the matches by setting a threshold. predictions with an e-value larger than a given threshold are hidden. because the prediction of tfbss based on a short motif in a long sequence is not very accurate, this filter should not be set too strict. in case of mapper we take the e-values as provided. to generate e-values for the genomatix  <cit>  predictions, we use a patched version of the implementation of the extreme value distribution  method in bioperl-ext  <cit> .

moreover, a filter routine based on regular expressions  <cit>  is implemented. it can hide tfbss based on any field in the mapper/genomatix tfbs prediction record, which contains information about the name of the tfbs, the position of the tfbs in the sequence investigated, and the score of the match. another relevant field in the filter tool is the set of species the tfbs model is made from; for example all plant tfbss can be filtered out if mammals are investigated only, because most likely all predictions of plant tfbss in a mammalian sequence are false positive.

grouping
tfbs predictions in the same species may belong to slightly different models of the same factor, and predictions in different species may belong to orthologous factors, and we may wish to group them together if they occur at approximately the same position. positions may vary slightly, because the alignment is unaware of the tfbss, or because models are slightly different. moreover, such slightly different models for the same or for an orthologous transcription factor may have very different names derived from synonyms, e.g. pou5f <dig> versus oct <dig> 

we therefore use a simple heuristic approach that groups tfbss together if they have the same transcription factor name and at least one coordinate  in common. this is a heuristic, but otherwise, if we simply check for overlap, we may group two predictions in cases where the first ends at a position where the second one just begins. we also allow the user to specify rules for grouping factors, if they have different names. such rules may be "pou <dig> starting at alignment position  <dig> is the same as pou <dig> starting at alignment position  <dig> ", "pou5f <dig> starting at alignment position  <dig> is the same as oct <dig> starting at alignment position  <dig> ", or even "pou5f <dig> starting at alignment position  <dig> is the same as oct <dig> starting at alignment position  <dig> " see also figure  <dig> for a screenshot of the form for grouping.

tree reconstruction
if a species tree is not part of the initial input, rexspecies can build it from the aligned sequences that are forming the conserved part of the regulatory region investigated, and/or from the tfbs predictions in that region. to calculate a tree from the tfbs predictions, we have implemented an interface to mrbayes  <cit> . we calculate a feature bitmap  from the below-threshold predictions. each column refers to a tfbs at a specific alignment position and each row corresponds to a sequence  in the alignment , where we set  <dig> if the tfbs is predicted and  <dig> otherwise. orientation of binding sites is taken into account, if they are not grouped with others . without grouping, if a binding site is present at a sequence position in both orientations, it is listed twice. the resulting bitmap can be given to mrbayes  <cit>  for tree calculation alone or combined with the sequence alignment. retrieving more plausible results  using the bitmap than without using it implies that the predicted tfbss contain some phylogenetic information. in turn, including the sequence alignment as part of the input data usually leads to a more plausible tree because it contains some phylogenetic information outside the tfbs motifs.

annotated tree
to infer hypotheses about the evolution of the regulatory region in question, rexspecies labels the leaves of a tree for the species investigated with the filtered tfbs predictions and the internal nodes  with the gain/loss information based on parsimony . currently fitch parsimony  <cit>  and dollo parsimony  <cit>  are implemented. fitch parsimony places labels so that it minimizes the number of changes that have to be supposed to explain the data. dollo parsimony places labels so that it minimizes the number of changes under the assumption that feature loss and re-gain of the same feature later is impossible, see also figure  <dig> 

technical details
software architecture
rexspecies consists of a number of modules written in perl extending the web-application base class using multiple inheritance. these modules should only contain callback functions  to register them in the menu or to generate their user interface. all other functionality should be kept separate in private objects. the web-application class provides persistence, user management, and objects of common classes for perl cgi scripts.

for calculations that last too long to be done interactively  we have implemented a job spooler running as a server process.

dependencies
due to the large set of bioinformatics libraries available, we decided to use perl. we use many modules from cpan   <cit>  available under various open source licenses, e.g. bioperl  <cit> . the tree rendering is done by an overloaded version of bio::phylo  <cit> . the database back end is currently based on mysql  <cit> . for user management there is a module supporting a ldap   <cit>  user database.

RESULTS
reliability of predicted tfbs
before reporting and discussing evolutionary hypotheses based on predicted transcription factor binding sites, we would like to show that these predictions are not random, despite the high rate of incorrect predictions. towards this aim, we calculated species trees using a homologous regulatory region from different species, with and without considering the array of binary values  derived from the tfbs predictions. as shown in figure  <dig>  a mrbayes tree of the highly conserved part of the 3'utr regulatory region of the cftr  gene based on sequence alone has very low resolution, but a tree based on both sequence and predictions is much more resolved and it comes closer to the species tree, taking the ncbi taxonomy  <cit>  as reference. similar improvements can be obtained for the other regulatory regions we investigated . we note that consideration of tfbs predictions is more than an implicit up-weighting of the sub-regions of the regulatory region carrying them, because all subsequences matching a tfbs up to the pre-specified threshold are considered equivalent. in other words, the subsequence giving rise to the tfbs prediction is considered twice for calculation of the phylogeny, but its consideration as a tfbs prediction glosses over the exact sequence of dna bases by converting it into a higher-level feature. in any case, improvement of trees demonstrates that while a lot of the predictions are noise, it will be worthwhile to analyze them in detail, because at least some of them are meaningful.

stem cells and pluripotency
stem cells are currently a major topic of interest and in this section we use rexspecies to explore the regulation of genes involved in mammalian stem cell pluripotency. we define pluripotency as the ability to undergo self-renewal and the potential to form all different cell types of the body  <cit> . embryonic stem cells  are pluripotent and they are important for the development of cellular regenerative therapies for medical conditions with irreversible tissue damage or loss  <cit> . efforts to realize this potential and to be able to reprogram somatic cells to pluripotent like cells with properties similar to escs require a better understanding of the interplay of the transcription factors and their binding sites involved in the regulation of the transcriptional network that is behind the ability of escs to maintain the pluripotent state  <cit> . in the last years, the transcription factors oct <dig>  sox <dig> and nanog have been identified to be master regulators of pluripotency, providing escs with extensive self-renewal potential/capacity  <cit> . for these three key regulators, tfbs models are available for searches by mapper  <cit>  and genomatix  <cit> . for octamer binding in general, there are  <dig> hmm models in mapper and  <dig> models in genomatix available, but there is no oct4-specific model. for sox, there are  <dig> models in mapper and  <dig> models provided by genomatix. to be as specific as possible for sox <dig>  we include a sox <dig> hmm model based on the binding site data in  <cit> . for nanog, only genomatix offers a single model that is not very sensitive, however; we found matches only in lemur .

evolution of the cftr 3' utr regulatory region
we have chosen to analyse the evolution of the 3'utr of the cftr  gene, since the genomic region containing cftr was an early whole-genome sequencing effort, where targeted genomic regions in multiple vertebrates were sequenced and compared  <cit> . this effort generated over  <dig> megabases  of sequences from  <dig> model species, all derived from the genomic region orthologous to a segment of about  <dig>  mb on human chromosome  <dig> containing ten genes, including the gene for cystic fibrosis. these sequences were shown to have conservation reflecting both, functional constraints and the neutral mutational events that shaped the genomic region. moreover, we selected cftr because the 5'utr of cftr has been analyzed in phylogenetic footprinting studies  <cit> . here, we will discuss the sox/oct predicted binding sites in the 3'utr regulatory region of the cftr gene that we found conserved for  <dig> model species. the region is found conserved in the amniota. the region is not found in other vertebrata; for example it is not found in fugu . the annotated alignment and the annotated tree can be found in figures  <dig>   <dig> and  <dig>  for these figures, the following standard filters were applied to consolidate the tfbs predictions. the e-value threshold was set empirically to  <dig>  plant, fly and yeast-specific tfbs were eliminated using a regular expression. grouping was done as described in additional file  <dig> 

interestingly, in figure  <dig>  the predicted oct binding site at position  <dig> and the sox <dig> binding site at position  <dig> of the alignment are inferred to be present for the ancestor of the amniota, and they get lost together for platypus  and mouse . similarly, the predictions "oct at position 86" and "sox <dig> at position 167" are both inferred to be appear along the lineage from amniota to mammalia, and they are both lost for marsupialia . such patterns of common gain and loss are giving credibility to these tfbs predictions. curiously, the "oct at position 86" prediction goes together with the prediction of an upstream sox <dig> binding site in platypus, cow, sheep and mouse. in contrast to the "oct at position 86" site, this predicted sox <dig> binding site has probably evolved independently four times, since its position varies. only in case of mouse, the "oct at position 86" binding site consists of a regulatory pore-like sequence  previously identified in the gene osteopontin  <cit> . as expected, an intact pore-like sequence corresponds to strong homodimer  formation  <cit> , confirmed by electromobility shift  experimental data . moreover, there is a predicted "oct at position 86" site if and only if emsa data report strong monomer oct <dig> protein binding in the genomic region orthologous to the segment containing the mouse pore-like sequence for platypus , cow , sheep  and mouse , but not for the other species, see figure  <dig>  finally, for these four species, there is a predicted "homf at position 43" binding site if and only if experimental data report heterodimer oct4/sox <dig> binding. the latter prediction provides the experimentalist with a hypothesis regarding the cooperative binding of transcription factors; "homf"  is a binding site model  defined by genomatix that includes various homeodomain transcription factors, namely barx <dig>  gsh <dig>  hoxb- <dig>  hoxc <dig>  phox2a  and phox2b  <cit> . the pig sequence is very different from the other sequences and it does not carry any oct/sox predicted binding sites ; this corresponds to the lack of strong binding in figure  <dig>  which may be triggered by divergent tfbs for which the e-value is too large. finally, we found matches of the nanog tfbs  only in lemur, at positions 2– <dig> .

evolution of the nanog 5' regulatory region
in addition to oct4/sox <dig>  nanog is a key player of pluripotency  <cit> . the evolution of the first upstream conserved part of its 5' regulatory region is visualized in figures  <dig> and  <dig> . the most prominent observation is the large number of predicted tfbss of stem-cell relevant transcription factors appearing on the lineage from theria to eutheria which may be associated with the developmental changes that occurred during the evolution from theria to eutheria. these predictions are found to appear in a region conserved for all theria; this region comprises, in part, the region shown in figure  <dig> and the first quarter of the region shown in additional file  <dig>  in particular, "smad at position 14" is found from eutheria onwards with the exception of insectivora, "oct <dig> at position 53" is found in all eutheria except e. europaeus  and carnivora, denoted by the synonym octb. curiously, "sox <dig> at position 57" first appears closeby for the same set of species with the caveat that it was lost in rodents. "otx <dig>  at position 84" is also found for all eutheria, except e. telfairi, denoted by a genomatix family of weight matrices called hoxf. very recently, zhou et al  <cit>  identified otx <dig> as a "core regulator in mouse esc" , noting that it had not "been implicated in esc maintenance" before. finally, outside of the region conserved in all theria, within the last three quarters of the region shown in additional file  <dig>  we find a plethora of other relevant predictions, e.g. predicted binding of "eklf"  in pluripotency was shown  <cit> ). however, their uniqueness to eutheria is not as clear as in the cases described above, because no homologous region could be obtained for the non-eutherian opossum , and it is possible that the region in question still exists in opossum, and that it did not evolve in eutheria.

preliminary analyses of conserved regulatory regions of other key pluripotency genes yield further interesting observations that may give rise to hypotheses about the regulation of pluripotency. downstream of the oct <dig>  gene we find conserved predicted tfbss of stem-cell relevant transcription factors such as sox, stat, smad, eklf, sp <dig>  pax and fkhd. downstream of the sox <dig> gene the most interesting finding is that among all amniota, only human has a predicted oct/sox binding motif .

caveats in interpreting predicted tfbs
we already discussed the most obvious problem with using genomic  data and associated predicted binding sites, namely the large number of mis-predictions. we would like to exemplify two further problems. first, we have to consider that the set of transcription factors and tfbs known for various species is incomplete, so we never know whether we are dealing with orthologous tfs or paralogous tfs . in fact, our sox <dig> binding site predictions are based on a model that may also match binding sites of other sox factors; it is even possible that sox <dig> does not bind at tfbss predicted using this model, but other sox factors do. recently, it was shown that sox binding sites found adjacent to oct binding sites of genes involved in pluripotency are not functionally important  <cit> . other sox factors  may bind, and sox <dig> was shown to be an upstream regulator of pluripotency instead. however, while such insights may modify the evolutionary analysis, they do not usually invalidate it.

secondly, significance of our observations is hard to quantify. as in many areas of scientific investigation, the "wheat", i.e. the observations deemed valuable and subsequently reported, may simply be chance findings that are to be expected if a large amount of data is analyzed. in other words, looking at sufficiently many predicted tfbs, we are doomed to find chance correlations that seem to make evolutionary sense, e.g. common gain and loss of tfbs. therefore, we should not get tired to stress that all in-silico analysis should be followed up by experimental validation. evolutionary patterns can narrow down true positive predictions, but they cannot identify them. a combined analysis of in-silico and experimental data is yet another approach, and it is important future work to add experimental tfbs data  to our visualizations, aiming at a deeper understanding of the evolution of biological features such as the regulation of pluripotency.

CONCLUSIONS
the rexspecies web-server is able to give deeper insights into the evolution of regulatory regions by providing sequence alignments and phylogenetic trees annotated with predictions for tfbss and their gain or loss. in the future we plan to automate more tasks so that finally the input will only be a gene and the output will be an overview of its putative regulatory regions across different species annotated with tfbs predictions, a tree labeled with those predictions including gain/loss information at the edges, and possibly even a regulatory network inferred from the tfbs predictions. towards this end, automation of the retrieval of sequence information and tfbs predictions is planned. moreover, we wish to add more tree estimation tools besides mrbayes  <cit> , e.g. raxml  <cit> , and add likelihood based methods for labeling, as well as add tfbs prediction modules to enable use without genomatix or mapper access, automated grouping by clustering of tfbs predictions, and import of experimental  data.

availability and requirements
project name: rexspecies

project home page: http://sourceforge.net/projects/rexspecies

url: http://bio.math-inf.uni-greifswald.de/rexspecies

operating system: web application running on linux

programming language: perl

other requirements: bioperl, muscle, mysql, ldap, mrbayes

license: gnu lgpl

source code of the version used for this article: see additional file 4

authors' contributions
ss designed and wrote the software and wrote parts of the paper. mjab wrote parts of the paper and tested the software. rar and hrs contributed to the results and discussion section and provided the experimental data, and gf supervises the project and wrote large parts of the paper. all authors have read and approved the final manuscript.

note added in proof
an improved version of the rexspecies server is available since march  <dig>   <dig>  most importantly, we now offer direct calculation of transcription factor binding site predictions using possum  <cit> .

supplementary material
additional file 1
full image for figure 2

click here for file

 additional file 2
full image for figure 5

click here for file

 additional file 3
manual groups for the cftr annotation

click here for file

 additional file 4
source code of rexspecies  <dig> . to install rexspecies on a web server, please refer to the file install in this tar.gz archive.

click here for file

 acknowledgements
we thank e. klassen, m. kabisch, a. seeland, c. scheuner for assistance. rar was supported by the following grants to ileana zucchi, cnr, milan, italy:  firb internazionali grant rbin04cbsm  <dig> and  n.o.b.e.l. grant funded by fondazione cariplo.
