BACKGROUND
synthetic biology is being used for therapeutic production either to develop cell factories using industrial microorganisms  <cit>  or to synthesize genetic circuits allowing in situ therapeutic delivery  <cit> . recombinant dna technology has already provided the ability to genetically engineer cell strains in order to import pathways from other organisms capable of producing small molecule chemicals into microbial chassis. moreover, to estimate the efficiency of the overall process, metabolic engineering-based tools consider models of cell metabolism as a whole, allowing the identification and redesign of bottlenecks in the biosynthetic pathways. therefore, the next challenge ahead remains the integration of all these design steps into a flexible and automated biosynthetic manufacturing pipeline of molecules.

in recent years, many successful examples of bioproduction of chemicals with therapeutic interest through metabolic engineering have been reported. among others, plant secondary metabolites that are of medicinal value, such as the terpenoids artemisinic acid  <cit>  and paclitaxel   <cit> , benzylisoquinoline alkaloids  <cit> , and flavonoids  <cit>  have been successfully produced by metabolically engineered microorganisms. similarly, heterologous production of therapeutically important antibiotics such as aminoglycosides derivatives, which include ribostamycin  <cit> , neomycin, gentamicin and kanamycin, as well as other natural products like polyketides  <cit>  and nonribosomal peptides  <cit>  have been reported. flexible production of novel antibiotics is of special interest in order to fight against the increasing emergence of multidrug-resistant pathogens  <cit> .

in an attempt to rationalize the biosynthetic design process, metabolic engineering models the metabolic network of the cell as a whole  <cit> . a suitable topological representation of the metabolic network can be achieved by using directed hypergraphs  <cit>  where catalytic reactions are hyperedges connecting node substrates to products. moreover, genome-wide reconstructions of an organism's metabolism with explicit reference to the stoichiometry of the reactions can be studied in order to estimate steady-state fluxes  <cit> . sensitivity analysis of fluxes provides a systematic way to determine production bottlenecks, where gene overexpression or repression might enhance production for the target compound  <cit> . in addition, stochastic and deterministic system dynamics methods are used to simulate enzymatic reaction kinetics  <cit> .

through metabolic modeling, the repertoire of biochemical transformations in de novo biosynthetic pathways are extended beyond what is present in metabolic databases like kegg  <cit>  and metacyc  <cit> . in silico methods for de novo pathway prediction and optimization are mainly based on two approaches: homologies of chemical structure transformation patterns  <cit> , and knowledge-based expert systems  <cit> . retrosynthesis algorithms  <cit>  perform a backward search for biosynthetic routes leading from a target compound to the host metabolites through iterative application of a defined set of biochemical transformation rules. one approach is bnice  <cit> , where molecules and reactions are represented by bond-electron matrices   <cit> . bem entries correspond to the covalent bond order between atoms, whereas the dugundji-ugi model for a metabolic reaction is implemented through the matrix difference between the bem of products and substrates. with bnice, reactions in the kegg database  <cit>  are represented through approximately  <dig> unique elementary transformations, which approximately correspond to the classification at the 3rd ec digits  <cit> . in the same fashion, the molecular signature descriptor  <cit>  is an algorithm that returns for a given target compound fourth and third ec digits, respectively, of predicted enzymes capable of producing the structure. similarly, other retrosynthetic framework has been proposed based on  <dig> reaction rules  <cit> .

a retrosynthetic search in the metabolic hypergraph might lead to a combinatorial explosion. for instance, using only  <dig> reaction rules,  <dig>  reaction routes were predicted for the production of isobutanol  <cit> , far more than what could be realistically tested in the laboratory. thus, in order to find a trade-off between the inherent complexity of de novo pathway design and the use of experimental information, we present here a tool based on the coding of compounds and reactions through molecular signatures  <cit> . the molecular signature is a canonical representation of the subgraph surrounding a particular atom in a molecular structure up to a predefined diameter or height h. a metabolic reaction signature is given by the difference between the signatures of products and substrates  <cit> . as further described in the methods section, the signature coding system can be made more or less specific to compounds and reactions by selecting the height, low heights are less specific  and high heights are specific , thus the numbers of de novo reactions and consequently de novo pathways can be controlled.

once metabolic models for the heterologous biosynthesis of target compounds have been determined, individual performances for the predicted pathways need to be characterized in order to prioritize the engineering of the most promising routes into the chassis organism. several computational frameworks have proposed different factors that might influence the performance of an engineered strain. pathminer introduced a path cost associated with the number of heterologous enzymes measured through a chemical distance  <cit> . bnice applied the group contribution method  <cit>  for reactants and products in order to rank pathways based on the thermodynamic favorability  <cit> . other aspects influencing the pathway performance are pathway length, organism specificity  <cit> , heterologous expression, growth rate, and precursor supply  <cit> . in addition, many other factors might be considered, for instance, pathologic defined  <dig> pathway features that may be relevant to the pathway ranking problem  <cit> . therefore, subsequent optimization of the heterologous engineered strain through genetic, metabolic and enzyme design approaches would be usually necessary in order to attain the desired final yields in the production of the target compound. moreover, increasing efficiency levels for rate-limiting enzymatic reactions involved in the pathway is an additional strategy for the rational design of industrial strains  <cit> . we present here a unified framework that combines several techniques involved in the design of heterologous biosynthetic pathways through a retrosynthetic approach in the reaction signature space, enabling the flexible design of industrial microorganisms for the efficient on-demand production of chemical compounds of interest.

RESULTS
the extended metabolic reaction space 
our method starts by mapping the metabolic network into the signature space in order to build an extended representation of the metabolic reaction space . molecular signatures, which are a representation of the molecular graph, can be used in order to code reactions  <cit> . this process is illustrated in figure  <dig>  canonical molecular signatures identify unique compounds when they are computed at the height h of the maximum diameter of the molecular graph, whereas signatures at lower height h provide a way to search for and enumerate similar chemical compounds. likewise, reaction signatures, which are biochemical reactions coded into the molecular signature representation , are used in order to search for and enumerate similar reactions. we define the extended metabolic reaction space  as the set of all possible reactions that can be generated from signatures contained in the metabolic network. therefore, the emrs consists of both reactions in the metabolic network and additional putative reactions, which are assumed to be promiscuously catalyzed by enzymes present in the organism. given a finite height h, novel reactions are discovered through this method by performing a search in the metabolite signature space of combinations of stoichiometric coefficients of metabolites having the same signature as either the substrates or the products. figure  <dig> shows the metabolic reaction map of the  <dig> endogenous metabolites in e. coli  and of the additional  <dig> compounds that are reachable from e. coli after the generation of the emrs .

an illustrative example is the metabolite signature space of height h =  <dig>  in this space, compounds are represented by their elemental formula. similarly, the combination of the substrates and products in the reaction are represented by their total molecular formula. thus, any combination of compounds satisfying the elemental formula is considered a putative set of reactants. in order to compute the emrs of height h =  <dig>  we need to solve diophantine equations in the signature space of height h =  <dig> that generally lead to a set of solutions too large to be of use. in the case of h =  <dig>  the number of newly created reactions is still significantly large . this number, nevertheless, becomes tractable once we consider heights higher than h =  <dig>  which corresponds to a  <dig> % increase in the number of reactions with respect to nominal reactions, as it is shown in table  <dig>  starting from the list of coded reactions, the iterative backward application of the biochemical transformations to compounds of interest allows the identification of enzymatic routes linking the desired compound to precursors that are endogenous to the chassis organism. each of these routes constitutes an exogenous biosynthetic pathway for that compound. in the next sections, we present an approach for ranking the biosynthetic pathways of a given compound in order to select the best pathways to engineer in the chassis organism.

number of novel generated putative reactions in the emrs for different heights h.

decision flowchart for selecting and ranking best pathways
the emrs introduces putative novel reactions that share the same signature as their parent nominal reactions at the chosen height h of molecular resolution . those putative reactions generated by our molecular signature-based algorithm need to be validated and ranked. figure  <dig> shows the decision flowchart used in our approach in order to accept or reject putative reactions in a pathway as well as to score its overall performance once inserted into the chassis organism. reactions are first tested for their thermodynamic feasibility. next, if no known enzyme sequences are available in the database, the enzyme sequence space is searched in order to find candidate sequences that might catalyze the given reaction as a promiscuous activity. gene compatibility, enzymatic performance, toxicity of products and steady state fluxes are finally estimated in order to score the pathway.

we introduce the following function to quantify the cost of inserting an exogenous enzyme sequence si processing the reaction r* in the pathway:   

where promis is the predicted enzyme promiscuity for the sequence si, perf is the estimated catalytic performance of the given sequence si for reaction r*, and het is the gene compatibility of the sequence si. ωp, ωe are parameters used in order to weight the contribution of each term to the cost function. all three terms are normalized before entering the expression so that each score is always given by a value in the same range between  <dig> and  <dig>  therefore, the cost function in equation  <dig> is always defined positive and bounded. promiscuity contributes negatively to the cost function because enzymes with higher level of promiscuity are considered better candidates for catalyzing the desired transformation r* as a side reaction. in the same fashion, enzyme performance contributes negatively since reactions with higher performance are considered less expensive in terms of the cost of insertion. once all terms are defined for each reaction r* in the emrs, this strategy enables the determination of those gene sequences s* that minimize the insertion cost:   

furthermore, several additional adverse effects may be hindering the successful expression and performance of inserted enzymes, while the toxicity of intermediate metabolites might impede cell survival and growth. these effects need to be taken into account in order to rank the pathways. for instance, an estimate of toxicity values  for the intermediates p in the chassis organism, may be obtained either from experimental databases  <cit>  or from structure-activity relationship models  <cit> . in addition, compound yields from inserted pathways are rarely additive, since other routes may be competing with the target pathway and inhibiting the production of the desired compound  <cit> . here we use a multi-criteria approach in order to score the cost of pathway insertion with respect to the general goal of producing a target molecule c, with a cost function defined as follows:   

where w considers the following effects: vc, nominal yield of compound c in pathway ρ; , minimum cost of insertion of each enzyme in the pathway as given by equation 1; and tox, the inverse of the ic <dig> value. parameters  need to be adjusted in function of the desired weight given to the costs of pathway insertion and metabolite toxicity. in our method, these parameters were optimized so that pathways that are fully annotated in the reference database, for instance kegg, are ranked first with respect to predicted pathways .

the minimum of this cost function w) at the optimal pathway:   

provides a trade-off between the simultaneous goals of obtaining the maximum nominal yield while keeping the overall process efficient and side effects attenuated. in the following sections, we present our approach in order to quantify each term in the pathway cost function w in equation  <dig> 

predicting enzyme activity in promiscuous putative reactions
our method provides for each reaction in the emrs a ranked list of candidate sequences, as given by the score in equation  <dig>  along with their predicted catalytic efficiencies. when there is no sequence information in databases about enzymes catalyzing the desired reaction r*, we must rely on the prediction of enzymes as putative candidates to process other substrates  or to catalyze a promiscuous reaction other than their native ones  <cit> . furthermore the thermodynamic feasibility of that reactions as well as the performance of the predicted promiscuous enzymes need to be evaluated. these preliminary evaluations, which are described next, are carried out in order to implement an early rejection of false hits, as shown in the flowchart of figure  <dig> 

thermodynamic feasibility
putative reactions need to be validated for their directionality or thermodynamic feasibility. we performed this validation assuming that the metabolites' concentration are spatially invariant and that temperature and pressure are constant. under these assumptions, standard gibbs free energies of reactions can be estimated using a group contribution approach  <cit> . only reactions estimated to be thermodynamically feasible are added to the emrs.

enzyme promiscuity
as part of our methodology for biosynthetic pathway design, candidate enzyme sequences catalyzing feasible reactions in the emrs have to be identified from the set of known enzymes. namely, our procedure for extending the metabolic network relied on the underlying assumption that reactions with the same signature are likely to be processed by similar enzyme sequences  <cit> , which in turn implies that the ability to catalyze the putative reaction is already present in the enzyme in the form of latent promiscuous activity. we have shown in a previous study  <cit>  that enzyme multispecificity and promiscuity are properties that can be characterized by using a molecular signature representation. thus, those multiple reactions generated in the emrs from a nominal parent reaction can be interpreted as promiscuous activities predicted to be present in the set of known enzymes. therefore, as shown in the decision flowchart in figure  <dig>  in order to consider a given sequence as a potential candidate that processes the putative reactions, a preliminary requirement has been introduced in the decision chart so that the enzyme should exhibit promiscuous activity based on the estimations performed by a molecular signature-based predictor .

tensor product
the next step consists of searching for candidate enzymes to process a given reaction in the emrs. in case that no known enzyme sequences were available for the reaction, candidate enzymes were determined by a signature-based enzyme-reaction predictor by following the procedure known as the tensor product  <cit> . we assumed that best candidate enzyme sequences for a putative reaction were more likely to belong to the list of sequences known to catalyze reactions that are chemically similar to the given reaction.

therefore, reactions generated by the enumeration algorithm in the emrs were first clustered into groups of similar reactions by a distance metrics, which was defined as the tanimoto similarity of reaction signatures  <cit> . the tensor product procedure  was then used in order to locate best enzyme sequence candidates within the reaction cluster.

enzyme performance
in addition, performance of exogenous enzymes needs to be evaluated. we have developed a decision tree learning method to estimate enzyme activity  <cit>  using kinetics information from the brenda database  <cit>  . as shown in figure  <dig>  predictions of enzyme performance perf for the list of candidate enzymes entered into our decision flowchart in order to score the sequences in equation  <dig> 

quantifying the compatibility between the host and heterologous genes
another aspect to be addressed when considering the overall enzyme cost defined in equation  <dig>  is the effect of inserting heterologous genes, since the diversity of base-pair content is organism-specific. by minimizing this difference, expression levels can be maximized  <cit> . in order to quantify the compatibility between the host and heterologous genes, we have implemented a machine-learning approach based on several descriptors: gene sequence descriptors ; organism specificity ; probability of protein expression as inclusion bodies; protein descriptors ; and secondary structure distribution. these descriptors were computed for the entire kegg database of non-redundant enzyme sequences and then used in order to train support vector machine-based predictors for the chassis organisms of interest .

furthermore, the successful expression of a heterologous gene depends on several additional sequence-independent factors, such as an adequate selection of promoters, rbs, and codons  <cit> . in some cases, we should also consider the need for some other type of specific modifications depending strictly on the type of compound to be synthesized, such as protein engineering of p450s  <cit>  or modular design for the complex assembly machinery involved in the production of secondary metabolites like polyketides  <cit>  and nonribosomal peptides  <cit> , which need to be evaluated on a case-by-case basis in order to rank and select the best genes to engineer.

predicting compound toxicity
exogenous enzymes inserted in the chassis might catalyze reactions synthesizing new products in the organism. as a side effect, however, intermediate metabolites involved in the exogenous pathways as well as any other side product of the new reactions may induce undesired toxic responses in the cell. therefore, it is necessary to consider toxicity effects of the compounds. for this purpose, we have developed a structure-activity relationship model based on a library of  <dig> tested compounds covering a wide range of toxicity levels  <cit> . the model was built by using several molecular descriptors including molecular signatures as input descriptors, achieving a performance of q <dig> =  <dig> . for any given reaction in the emrs, toxicity was given by the sum of the predicted toxicity for each product, allowing us to identify pathways involving highly toxic metabolites in order to rank them with lower score.

special consideration when predicting compound toxicity should be given to those cases when genes encoding for resistance to the compound are going to be engineered as part of the biosynthetic gene cluster. for instance, when producing an antibiotic in e. coli such as penicillin, it is necessary to introduce genes that code for β-lactam resistance in the organism in order to make bacteria immune to that antibiotic. therefore, if resistance to some product is going to be inserted into the strain, the attenuation effects in toxicity for that family of compounds has to be updated into the model.

estimation of nominal fluxes
the insertion of new reactions into the chassis organism can perturb its metabolic network and therefore the equilibrium of the steady-state fluxes might be altered  <cit> . by using a constraints-based flux analysis on a genome-wide reconstructed metabolic model of the engineered strain, we obtain the solution space within cell's capacity. our objective is to maximize the production of the desired compound while keeping cell growth. for each engineered strain, we obtained an estimate of expected net yield of product, which is not further metabolized, at the given controlled media conditions. in addition, flux balance analysis is a flexible analytical technique that can also be applied in other ways in our design framework for biosynthetic pathways. for instance, it can be used in a systematic way in order to perform a sensitivity analysis to determine production bottlenecks, where overexpression and gene knockouts might enhance production for the target compound  <cit> .

pathway enumeration and optimal search in the emrs
given a biosynthetic pathway ρ that produces a compound c, we have shown in the previous sections how to estimate the individual contributions to the cost function . by using the cost function, thus, biosynthetic pathways ρ can be ranked. however, in order to rank all viable biosynthetic pathways ρ for a compound c of interest, the problem of pathway enumeration needs to be addressed. for this purpose, modeling of the metabolic network in the emrs was done by using directed hypergraphs, where reactions are represented by hyperedges that connect sets of vertices  to disjoint sets of vertices   <cit> . directed hypergraph formalism, though more complex than simple-graph models, provides a complete representation of all compounds involved in biochemical transformations. by using the hypergraph formalism, we implemented a retrosynthetic algorithm that enumerates all pathways starting from target compounds of interest. one main advantage of the pathway enumeration in the emrs is that complexity can be controlled by tuning the atomic height h of the molecular signatures. higher values of h imply that the number of pathways between two metabolites is approximately the same as the number of possible pathways in metabolic networks of annotated databases such as kegg  <cit>  or metacyc  <cit> , while lower h values generate more novel reactions and therefore more possible pathways are formed between those two metabolites. this result is illustrated for the case of pathway enumeration between chorismate and tyrosine in e. coli for different heights h using a reaction representation at the level of the 3rd digit in the ec number classification . in general, the possible number of pathways that can be formed between these two metabolites increases exponentially with the number of reaction steps. when values of the molecular signature height are high , new reactions are unlikely to be generated and therefore the number of pathways becomes the same as the number of pathways available in kegg ; whereas as the height h decreases, the number of new reactions and, thus, the number of pathways starts growing while getting closer to those results that were obtained in bnice by using bem matrices  <cit> .

in a general setting, the problem of finding the optimal pathway ρ* in equation  <dig> that produces the target compound c is equivalent to finding the shortest hyperpath in a weighted hypergraph. this problem is known to be an np-hard problem  <cit> , although it can be reduced to a polynomially solvable problem if the cost function in equation  <dig> is reformulated as an additive objective function  <cit> . in the emrs approach, complexity can be controlled by varying the specificity of the molecular signature. this flexibility allows us to follow the strategy of enumerating all biosynthetic pathways ρ and computing their associated costs w in equation  <dig> 

validation test for auxotrophic production in e. coli
a validation test for the ranking score was carried out by testing its ability to identify native biosynthetic pathways for several essential metabolites  in auxotrophic strains of e. coli. these strains were rendered unable to synthesize those essential compounds by inactivation of the enzymes that natively produce them. we assumed that native pathways, which have been selectively conserved under evolutionary pressure, are efficient ways to produce the compounds while keeping cell growth. the validation, thus, consisted of checking if the pathways that were ranked at the top of the list correspond to native pathways. in order to find all possible ways to synthesize the amino acids, we ran the retrosynthetic search in these auxotrophic strains. the output results of the search, which are given in table  <dig>  provided both native and alternative pathways connecting the auxotroph to the compounds. the results of this test showed that in 98% of the cases native pathways were found within the top  <dig> ranked pathways for each amino acid.

biosynthetic pathways for the  <dig> amino acids, citrate and atp/adp and gtp/gdp enumerated for e. coli strains where enzymes producing the compounds have been deleted. for each test, columns correspond to: total number of enumerated pathways; number of native pathways in the wild-type strain; percentage of native pathways in the top  <dig> best ranked pathways; and p-values for the number of genes in e. coli strains top ranked with respect to the total enzyme genes in the database.

an additional validation test was performed in order to evaluate the accuracy of the gene compatibility predictor. the result of this test, summarized in table  <dig>  showed that genes from the full list in the database that were predicted to be the best candidates to be inserted in the auxotroph strains corresponded significantly  to native genes of e. coli. these results are significant since the sequences under test were not part of the training set used for building the gene compatibility predictor. in summary, this test showed that the proposed ranking function can potentially identify heterologous biosynthetic pathways to insert in an organism to produce a desired compound while selecting the ones that are close to native pathways in the chassis.

the retropath webserver
as shown in previous sections, the procedure of pathway selection by retrosynthesis is a complex task that implies the adoption of several design decisions, some of them on a case-by-case basis. in order to help on the decision-making process, we have developed an online tool: the retropath webserver that guides the designer through the retrosynthesis process. the design starts by choosing the target compound, which can be given as an sdf molecular file. additionally, the user decides the level of molecular resolution to use in the molecular signature representation. for instance, we have analyzed the set of molecular structures in drugbank  <cit>  as initial target compounds. for this set, we found that more than 50% of reactions producing these compounds belong to the e. coli emrs of height h =  <dig>  furthermore, the distribution of the number of alternative biosynthetic pathways in the compound set follows a power law, as it is shown in figure  <dig>  which means that in some cases there might be thousands of alternative pathways that have to be ranked according to the ranking function in equation  <dig> to search for the optimal pathway.

in order to illustrate the design process, we next present three examples of heterologous pathway design using the retropath webserver, the production of two β-lactams antibiotics in e. coli , and of one antitumor drug  in yeast.

design examples of retrosynthetic pathways
production of β-lactams in e. coli
the industrial production of penicillin g occurs via fermentation using the filamentous fungus penicillium chrysogenum. a recent study has opened up the possibility of producing penicillin g in an organism that is used as a producer of pharmaceuticals; the yeast hansenula polymorpha  <cit> . interestingly, the biosynthetic pathways of penicillin g are shared by another β-lactam antibiotic, cephalosporin, which is produced in the fungus acremonium chrysogenum and synthetised from isopenicillin n, the penultimate precursor for penicillin production  <cit> .

using the retrosynthetic method that we have developed, retrosynthetic graphs were generated for β-lactam antibiotics, in particular penicillin and cephalosporin . the chosen chassis organism was e. coli. four different pathways were found at a signature reaction height of h =  <dig> for penicillin n production and in particular one involving the nonribosomal peptide synthetase δ--l-cysteinyl-d-valine synthetase  and isopenicillin n synthetase . these pathways are the same as those that were implemented in the aforementioned studies in yeast and fungi to produce the isopenicillin n. in the cephalosporin biosynthesis pathway the isopenicillin n is converted into penicillin n, itself transformed into deacetoxycephalosporin. the retrosynthetic maps of height h =  <dig> for heterologous production of penicillin n and deacetoxicephalosporin in e. coli are shown in figure  <dig>  in the retrosynthetic graph, the enzyme deacetoxycephalosporin-c synthase  is the one responsible of the deacetoxycephalosporin formation. table  <dig> ranks the  <dig> pathways in the map leading to penicillin n according to the cost function in equation  <dig>  toxicity values for intermediates were predicted by using our model built from an experimental library of toxicity values in e. coli while fluxes were estimated from a reconstructed metabolic model of e. coli, as described in the methods section. the optimal pathway involves five exogenous enzymatic steps, while the alternative pathways involves up to seven steps. in table  <dig>  the alternative routes for the production of penicillin n are generated by the synthesis step of the precursor l-2-aminoadipate-6-semialdehyde, where the retrosynthetic search identified several enzymatic routes that can be connected to precursors in e. coli.

each row corresponds to the insertion of one enzyme in the pathway in order to produce the given intermediate product in the second column. the estimated cost and product toxicity are given in the third column. the last two rows provide the estimate of maximum flux vc for the pathway, and the total cost w according to equation  <dig>  c06564: penicillin n; c05557: isopenicillin; c05556: δ--l-cysteinyl-d-valine; c00956: l-2-aminoadipate; c04076: l-2-aminoadipate-6-semialdehyde; c00450: - <dig> , <dig> -tetrahydropyridine-2-carboxylate; c00408: l-pipecolate. starred ec numbers correspond to putative enzymes.

production of taxol  in yeast
taxol  is an anticancer drug first isolated from the pacific yew tree taxus brevifolia. today, taxol derives largely by semisynthesis from the advanced taxoid 10-deacetylbaccatin iii obtained from the european yew tree taxus baccata  <cit> . currently its production has a limiting rate as it depends on plant cell processes as well as chemical and biotechnological semisynthesis processes. for the past few years, a number of studies have been contributing to the elucidation of the biosynthetic mechanism of taxol and efforts have been made in order to attain cost-effective production through heterologous biosynthesis of taxol and its analogues  <cit> . the retrosynthetic graph for yeast  which was computed for a signature height h =  <dig>  , goes from the isopentenyl to taxol and contains  <dig> different pathways with  <dig> and  <dig> steps, respectively, that share most of the intermediates and only differ at two steps:

 <dig>  from isopentenyl  to taxadien-5α-ol: the isopentenyl, native to yeast, undergoes  <dig> reaction steps to form the taxadien-5α-ol. those are catalyzed by the geranylgeranyl-diphosphate  synthase  that forms the ggpp   <cit> , by the taxadiene synthase  that forms taxa- <dig> diene   <cit>  and finally by the taxadiene 5α hydrolase  that forms the taxadien-5α-ol  <cit> . the first two reactions have been reportedly implemented in e. coli  <cit>  and, furthermore, were subject to engineering in order to optimize the taxadiene pathway production  <cit> .

 <dig>  from the taxadien-5-α-ol to taxol: from the taxa- <dig> -dien-5α-ol two pathways are possible, producing either taxa- <dig> -dien-5α,13α-diol by the taxane 13α hydrolase  or the taxa- <dig> -dien-5α-yl acetate by the taxadien-5α-o-acetyl transferase  <cit> . taxane 10β hydroxylase  is producing the taxa- <dig> -dien5α,10β-diol  <dig> acetate  <cit> . this part of the pathway was implemented in the yeast saccharomyces cerevisiae  <cit> . the next steps described successively the formation of 10-deacetyl-2-debenzoylbaccatin iii , the 10-deacetylbaccatin iii  catalyzed by taxane 2α-o-benzoyltransferase , and the baccatin iii catalyzed by taxane 2α-o-benzoyltransferase  <cit>  to finally form the taxol.

each row corresponds to the insertion of one enzyme in the pathway in order to produce the given intermediate product in the second column. the estimated cost is given in the third column  <dig>  the last two rows provide the estimate of maximum flux vc for the pathway, and the total cost w according to equation  <dig>  c07394: paclitaxel; c11900: baccatin; c11700: 10-deacetylbaccatin; c11899: 10-deacetyl-2-debenzoylbaccatin; c11898: taxa- <dig> -dien-5α-acetoxy-10β-ol; c11897: taxa- <dig> -dien-5α,13α-diol; c11896: taxa- <dig> -dien-5α-yl; c11895: taxa- <dig> -dien-5α-ol; c11894: taxa- <dig> -diene; c00353: geranylgeranyl. starred ec numbers correspond to putative enzymes.

CONCLUSIONS
we presented in this work an automated protocol to assist synthetic biologists and metabolic engineers in the design and insertion of efficient heterologous biosynthetic metabolic pathways in chassis organisms. our method is based on the retrosynthesis algorithm, an idea borrowed from the allied field of synthetic chemistry. in order to perform this analysis in metabolic networks, we used the molecular signature descriptor, a 2d representation of molecular graphs that provides a characterization of compounds and reactions in the network. molecular signatures provide a homogeneous way to represent through hypergraphs the set of chemical species and transformations present in cell's metabolism. the representation in the molecular signature space is also an efficient way to measure chemical similarity between compounds and reactions. we use this framework to develop an algorithm to generate putative novel reactions between compounds in the network, leading to the extended metabolic reaction space . the algorithm consists of searching for all combinations of compounds with the same signature as known metabolic reactions.

in order to explore new biosynthetic pathways for compounds, we implemented a retrosynthetic algorithm in the emrs to build the map of all reachable compounds from the chassis organism through biochemical transformations. the complexity of the retrosynthetic search, a problem that has been limiting so far the adoption of the retrosynthetic approach into the manufacturing pipeline, has been efficiently addressed in our method through the atomic height h of the molecular signature. as h increases, the number of possible pathways converges to the annotated pathways in metabolic databases. lowering h, in turn, leads progressively to a combinatorial explosion with multiple alternative pathways containing putative reactions, as the ones obtained in the bond-electron and atom tracking models of the metabolic graph.

the retrosynthetic map contains both annotated and putative reactions catalyzed by identified exogenous enzymes, providing several alternative pathways leading to the target compound. we associated a cost of insertion to each pathway based on several criteria such as gene insertion cost, expression levels, enzyme efficiency and nominal fluxes. furthermore, an algorithm similar to the shortest pathway search has been implemented in order to rank all possible pathways. we showed that the distribution of alternative biosynthetic pathways for e. coli in the list of compounds of medicinal interest in drugbank follows a power law, being in some cases in the order of thousands. therefore, it is necessary to implement an efficient ranking function as the one presented here in order to select the best heterologous pathways to insert in the chassis organism. for instance, we applied the retrosynthetic algorithm in order to search for heterologous biosynthetic pathways for two compounds in drugbank: penicillin n and taxol. in both cases, several alternative pathways for bioproduction were found. the identified pathways contained both known biochemical transformations previously reported as well as other alternative pathways. in order to select the best combinations to engineer, pathways were ranked according to several cost factors such as number of inserted enzymes, gene compatibility, toxicity, and nominal fluxes. the individual contribution of these factors to the ranking function was optimally adjusted so that native pathways were ranked first with respect to predicted pathways. our multi-criteria approach can be easily tuned depending on the data available for organisms, as it was illustrated by the optimal adjustment of the weighting parameters for different combinations of factors. the ability of the ranking function to identify native pathways was tested and validated in the case of biosynthetic pathways of several essential metabolites  in auxotrophic strains of e. coli. in this test, native enzymes were correctly ranked by means of our methodology at the top of the enumerated biosynthetic pathways.

even though our methodology searches for enzymes providing the best performance for the overall process, we might be interested in some cases in increasing the efficiency levels for some of the promiscuous reactions involved in the pathway due to their poor performance, a rate-limiting factor in the production of the target compound. in that case, it would be necessary to introduce mutations in order to re-engineer enzyme variants with detectable levels of the desired catalytic activity. using protein molecular signatures and kernel methods, we already proposed a methodology to search for promiscuity hot-spot residues in the enzyme sequence and outlined a method to find variants with enhanced promiscuity levels  <cit> , which might be applicable in this case. therefore, this work provides a full biosynthetic automated pipeline for the design and production of therapeutics and other compounds in flexible on-demand cell factories. going beyond classical metabolic engineering, our synthetic biology approach meets the expected requirements of reusability and modularity that will become integral part of next generation biosynthetic devices.

