BACKGROUND
high-throughput genotype  data has been intensively used in genetic and genomic studies to unravel the genetic background and control mechanisms of complex diseases and traits in humans, plants, animals and many other organisms. as the genotyping costs decrease rapidly, htg data is a favourable source of data to collect on a routine basis in many research, development and innovation industries. the main method used to identify genes associated with the disease or trait of interest has been genome-wide association  studies. however, the published gwa studies have, so far, typically identified genes with a low relative genotype risk and overall results only explain a small part of the predicted heritability  <cit> . the gwa study is a single-step approach, which means that each single nucleotide polymorphism  is tested with the trait of interest. this test is repeated for all snps on the snp chip, which causes the multiple-testing problem and subsequently, very stringent cut-off values result in many biologically relevant snps being missed  <cit> . another, potentially larger, problem is the failure to explain entire underlying genetic variation in complex diseases and traits due to its inability to fit genome-wide genetic interactions  <cit> . several studies have stated the importance of the interaction effects between genes, especially in complex diseases and traits  <cit> . by including the detection of gene x gene interactions in gwa studies, the power to detect biologically relevant snps is increased  <cit> . several studies have detected the gene x gene interactions in two-stage models  <cit> ; however, only two snps are taken into account at a time. analysing many more than two snp combinations in one model results in an exponential increase of the sample size needed, referred to as the curse of dimensionality  <cit> . in conclusion, sample size requirements and statistical-computational limitations increase the need for a method  which reduces the multiple-testing problem and takes interaction effects into account when analysing htg data.

systems genetics approaches focus on the network of interactions between genes and phenotypes in order to understand the complexity of diseases and traits  <cit> . several approaches have been used to distinguish networks, functional pathways, and underlying causal genes to unravel the biological and genetic background of complex diseases  <cit> . often, gene interaction occurs by the influence of several genes on a specific protein, resulting in activation of the protein. as we know that a particular phenotype is the result of the presence or level of expression of several genes, it is beneficial to understand how gene networks exist and behave under specific circumstances. the knowledge about pathways in the gene networks could help us to improve our understanding of the complexity of diseases and complex traits  <cit> . however, the relationship between genes and the disease or trait is often not straightforward. as several genes and their interactions result in a disease in one individual, a  different set of genes may lead to the same disease in another individual. by defining modules and pathways and relating them to various diseases or trait of interest , a better biological understanding of complex diseases and traits would be possible. in addition, focusing on snp modules and their pathways instead of single snp effects is a network-based systems genetics technique which will alleviate the multiple-testing problem of gwa studies and consequently increase the power to detect biologically relevant genes.

using microarray gene expression data, langfelder and horvath  <cit>  proposed the weighted gene co-expression network analysis  method, whereby the pairwise pearson's correlation between gene expression values reveals the interaction between genes. the main assumption of wgcna is that genes with similar expression patterns in a number of individuals are interconnected. detection of genes that are highly interconnected will result in detection of gene modules which potentially represent biological pathways. wgcna has been extensively used and has proven ability to identify pathways and potential genetic biomarkers in several traits and complex diseases  <cit> . wgcna has also been compared to other category of scale-free network approaches in the context of its ability to retain important gene modules and detect biologically relevant hub genes and biomarkers. results show that wgcna is superior to other scale-free approaches  <cit> . we propose that the main assumption of the wgcna approach for clustering gene expression data can be used for htg data. with that approach, we can detect highly interconnected snp modules that may work cooperatively in a pathway, eliminating the multiple-testing problem of gwas and giving new opportunities to analyse whole genome htg data using a systems genetics approach. the main objective of this study was to develop a scale-free weighted genetic interaction network method using whole genome htg data in order to detect biologically relevant genetic modules, pathways and potential genetic biomarkers for complex diseases and traits. we achieved this objective by modifying and extending the wgcna method to suit genetic interactions/correlations derived from htg data and by defining genome-wide module association tests .

RESULTS
the wish network method can be applied to htg data using two different ways of detecting the interaction patterns between snps: 1) based on genomic correlations and 2) based on their epistatic interactions. the wish network based on genomic correlation was applied directly to real data. the wish network method based on epistatic interactions was tested first on simulated data and afterwards applied to real data. all results are presented here.

application of the wish network method based on genomic correlations
the wish method based on genomic correlations was tested using htg data of an f <dig> pig resource population  <cit> , with carcass weight as the trait of interest. the adjacency matrix  was created by calculating the correlations between the snp genotypes and based on scale-free topology. the a matrix was raised to the power  <dig>  based on the connectivity of individual snp with all the other snps in the network , the top  <dig> highest connected snps were selected for the network construction. after snp dendrogram was created, we detected  <dig> snp modules each containing at least  <dig> snps based on topological overlap measure  and the dynamic tree cut method for dendrograms  <cit>  .

for selection of biologically relevant modules, the genome-wide module association test  was performed to detect potential biologically relevant modules, relating the module eigengenes to the complex trait observations on individual pigs . in total, three modules were selected for functional enrichment using the gene ontology enrichment analysis software toolkit   <cit> : the blue module , the cyan module  and the turquoise module . genes present in the modules and corresponding pathways were determined and annotated using the ncbi2r r-package. in total,  <dig> snps  of the blue module,  <dig> snps  of the cyan module and  <dig> snps  of the turquoise module were present in or near one or several genes. functional enrichment of the genes in the selected modules resulted in the identification of various pathways, which could be related to carcass weight. the majority of the detected pathways tended to be related to carcass weight. we also found highly enriched gene ontology  terms associated with muscling, e.g., actin filament processes ,  growth, e.g. transforming growth factor  beta-activated receptor activity  and with fatness, e.g., glucose catabolic process  . identified significant go terms using goeast are presented in additional file  <dig>  in conclusion, results of the wish network analysis showed that the biologically relevant snp modules and pathways associated with carcass weight could be detected.

the wish network method based on simulated epistatic interactions data
the wish method could be improved by replacing the correlations between snp genotypes with the actual epistatic interaction effects between snp pairs. to test this assumption, we simulated pairwise epistatic interaction effects between  <dig> snps based on distributional assumptions for epistatic interactions described in cheverud et al.  <cit>  which follows a normal distribution with values between - <dig> and  <dig>  this is similar to estimated regression coefficients from a linear regression model, fitting a pairwise snpi x snpj interaction terms to phenotypes that are centered to have n  distribution. after raising the adjacency matrix to the power  <dig> , the connectivity of the simulated data show that the network is scale-free  . using clustering of interconnected snps based on the dissimilarity tom, ten modules were detected . these results show that the wish network method based on inputs from pairwise snp x snp epistatic interactions results in identification of "highly interactive" snp modules underlying complex traits.

the wish network based on real epistatic interactions data
the same f <dig> pig resource population and carcass weight data used in the wish based on genomic correlations were also used to perform the wish network method based on epistatic interactions. in total,  <dig> snps  were tested in an epistatic model and the regression coefficients of the snpi x snpj component were used as input for the wish network. to test if the network is scale-free, the connectivity was calculated and the power Î³ of  <dig> was applied, resulting in the highest scale-free topology index: r <dig> =  <dig> . in total, five modules were created with at least  <dig> snps in each module . out of five modules, one was appropriate for further downstream analysis based on their gmat with the ebvs for carcass weight: the red module . significant pathways in this module were detected using the ncbi2r r-package. two pathways were significantly present in the red module: the pi3k-akt signalling pathway  and the synaptic vesicle cycle  which have been associated with cell growth and insulin resistance.

discussion
since  <dig>  several microarray gene co-expression studies have successfully used the wgcna method to detect biologically relevant pathways  <cit> . we have presented an extension of the wgcna method from using transcriptomic datasets to htg datasets by developing the wish network method. the wish network method makes it possible to create a genetic interaction network and identify biologically relevant pathways using htg data. wish network method starts by reducing htg data using the genome-wide significance and the variance of the snps in a certain population, for computational as well as biological reasons. computationally, network construction is difficult, if we want to use all genome-wide markers on a snp chip ; therefore, a data reduction method is necessary. the number of snps used for network construction determines the size of the network and consequently the number of modules detected and the number of snps per module. biologically, only those snps with acceptable genome-wide statistical significance would make any sense for further biological interpretation. furthermore, snps with limited amount of genetic variation in the population were deselected, as they will make limited sense using a network approach. in rare cases, two snps which are individually not genome-wide significant may show a significant interaction effect, but they may be excluded from the analysis based on the significance threshold. this is a drawback of snp selection because of computational limitations. however, we have minimised this problem by selecting all "marginally significant" snps whose significance levels were way below the genome-wide significance levels; hence we believe this is a valid selection criteria. potentially, individuals can be selected for data reduction and to simultaneously increase the power of module detection. for instance, comparing two extreme phenotype groups will result in more extreme differences in interaction effects. we also constructed wish network based on the interactions between snp-pairs, estimated using real data in pigs as well as the simulated datasets. this showed the possibility to detect modules, clusters of highly interacting snps that are involved in creating complex trait variation. the modules detected by the wish method were further analysed using functional enrichment analysis which led to the detection of biologically relevant pathways and potential genetic markers for carcass weight. both methods, wish based on genomic correlations and wish based on epistatic interactions, result in the construction of a scale-free network. a large difference found between the two methods, was the number of identified modules . we believe this is mainly due to the limited number of snps in the epistatic network to estimate the interaction effect, which limits the information of the clustering of snps. both resulted in the identification of snp x snp interactions between and within chromosomes, and moreover, complement each other by finding different modules of biologically relevant modules.

an assumption made in gene co-expression studies is that similarly expressed genes over different treatment groups are functioning together in pathways. this assumption gives the possibility to reduce data, define disease subclasses and eventually identify pathways  <cit> . so far, possibilities for clustering using htg data based on snp x snp interactions are not at all available, but the proposed wish network method provides those opportunities. the critical assumption in wish is that highly interconnected  snps are expected to be involved in similar genetic and molecular mechanisms affecting that phenotype. this is similar to the assumption made about gene expression values in wgcna. furthermore, fitting genome-wide genetic  interactions in standard gwa study models is difficult because of exponential increase in sample size requirement, statistical inference and computational issues  <cit> . hence, our wish network method could be seen as a post-gwa study method to unravel genome-wide genetic interactions and explain more underlying genetic variation. previously, the association weight matrix   <cit>  has also been proposed as a post-gwa study method. the awm uses the allelic substitution effects per gene  per trait. by calculating correlation between allelic effects of snps between two traits, awm re-generates polygenetic correlations between traits and by clustering allelic effects of all snps across phenotypes, awm creates pleiotropic genetic network. wish network aims and methods are different to awm. first, wish is not dependent on the estimation of the allelic substitution effects from gwa study and second wish is intended to build genetic networks within one complex trait but not across multiple traits. the wish network method only uses the genotype data, or the epistatic interaction data on one phenotype, to create an interaction network, in contrast to the awm which uses the gwa study results on several traits to detect the network of snps that are pleiotropic . the awm method is not weighted, nor does it follow scale-free topology. this means that wish network construction and module detection is done without using prior knowledge. hence, the wish network method is hypothesis-free and will provide the opportunity for new insights in complex diseases and traits. at a later stage, the network can be related to the phenotype to detect potential biologically relevant modules. to reveal the biological relevance of detected modules, analysis is largely dependent on existing functional annotation, which could be a limiting factor. on the other hand, the identification of pathways could also help us further in the functional annotation of snps and genes.

the wish network method detects clusters of highly interacting snps. previous studies have indicated that the structure of haplotypes, clusters of loci on the chromosome that are transmitted together, can increase the power of gwa studies. however, haplotypes only take the "correlations" between loci into account  which are physically attached to each other. however, previous research has shown that linkage disequilibrium  can also be measured across different chromosomes, and may explain more genetic variation in complex, polygenic phenotypes  <cit> . the wish method detected interactions of snps across different chromosomes  and was not limited by the physical location of the snps. the involvement of snps from various chromosomes was seen in all detected modules and was very clear in the turquoise module , which consisted of  <dig> snps spread over  <dig> chromosomes. this distant physical locations of snps in snp modules created by the wish method shows that it detects interactions along the whole genome.

we tested the wish network method on an f <dig> pig resource population with carcass weight as the trait of interest. for this trait, we also performed a gwa study, using the r-package genabel. this resulted in the discovery of eight genome-wide significant snps, three of which were located on chromosome  <dig> , three on chromosome  <dig> , one on chromosome  <dig> and one on chromosome  <dig>  using ncbi2r, three genes were detected: kiaa <dig> , klc <dig>  and loc <dig> . as a result of functional annotation, only the klc <dig> gene can be related to biological function in relation to carcass weight, as it is known that kinesin acts as a molecular motor generating atp-dependent movement of vesicles and organelles along the microtubules. in total the wish network method detected three snp modules that were significantly associated with carcass weight. after functional annotation, we found some pathways which could be biologically related to carcass weight, e.g., actin filament processes and tgf beta-activated receptor activity. nevertheless, the klc <dig> gene was not found in one of these modules, neither in the wish based on genomic correlations nor in the wish based on epistatic interaction. this implies that the wish network method can be used as a supplementary analysis, detecting different snps for the trait of interest. whereas a gwa study detects single snps, the wish method detects groups of highly interconnected snps which are often present in the same pathway. besides carcass weight, we tested the wish network method on several other traits present in the f <dig> pig resource population , and they all revealed biologically relevant results .

although we have shown the creation of one network using one single phenotype, several other ways of analysing phenotypes are possible using the wish method. as proposed by the founders of wgcna, a differential network can be created by comparing, for example, case and controls, using the same input data , but creating two networks using two groups of individuals . several measurements, such as differential connectivity, can be used to identify modules with a different snp effect profile between the two groups. the wish network method can also be used as a multi-trait network approach. after network creation and module detection, the gmat of detected modules with other  phenotypes can be calculated. by comparing the relatedness of modules with different phenotypes, the wish network method could possibly be used to identify endophenotypes and subsequently pathways of endophenotypes of complex diseases.

the wish network method based on epistatic interactions is theoretically a promising approach to cluster snps based on their interconnectedness. it has been shown in the simulation data that the epistatic data follows scale-free topology and clear clusters of highly interconnected snps are detected. however, the use of real data did not represent a clear scale-free network and consequently less clear modules are detected with lower correlations with the trait of interest. this could be due to several reasons. first, the number of snps in the network limits the size of the network. in the wish based on genomic correlations the connectivity is measured over >  <dig> snps and the most highly connected snps are concordantly selected for network construction. because of computational and time limitations, we used only the top  <dig> snps for the wish network based on epistatic interactions. secondly, we used all individuals present in the dataset to estimate the epistatic interaction effect to increase the power. however, the wish network based on genomic correlations is created based on extreme phenotypes . this will result in more extreme interaction effects; however, due to a limited number of individuals in our dataset, this was not possible in this study.

the wish network method was tested on real data, using an f <dig> pig resource population, and was able to detect biologically relevant pathways using htg data. we propose the wish network method as a new systems genetics tool to investigate htg data in order to improve understanding of the biological and genetic background of complex diseases and traits.

CONCLUSIONS
we report here the development and application of a new systems genetics tool - the wish network method - for building networks using htg data obtained from genetic study populations. the basic principle of wish network method is based on the existing wgcna method for building co-expression networks using transcriptomic data. this study addresses the long gap or a need in studying genome-wide genetic interactions in the context of genetic  networks underlying complex trait variation. the proposed wish network method has been tested using simulated datasets as well as applied to real experimental data obtained from a pig resource population, genotyped using 60k porcine snp chip and extensively phenotyped for obesity and obesity-related traits. results have shown that wish detects biologically relevant modules for carcass weight  and other obesity-related traits . the wish network method can be used in human genetics to detect pathways of complex diseases as well as in animal and plant genetics to unravel the genetic background and detect genetic biomarkers of economically important production traits. by analysing various traits within the same network, the wish network method is able to detect endo-phenotypes which could be valuable for treatment of individuals with complex diseases. moreover, a differential wish network method can be used in a case-control design to identify conserved pathways in the different groups or to identify pathways that behave differentially between the cases and controls.

materials and methods
the wish network method is an extension of the r-package wgcna  <cit>  using htg data from snp genotyping arrays instead of gene expression data from microarray studies . the wgcna method relies on the assumption that genes with correlated expression levels in given treatment or biological state in a group of individuals or replicates are functioning cooperatively in pathways, contributing to the condition or trait of interest. we extended this assumption to snps and assume that snps which are highly correlated  among each other are functioning cooperatively and similarly in pathways.

data reduction
for computational reasons not all genome-wide markers on a snp chip can be used and therefore a data reduction step is necessary. also, only those snps that have an acceptable  genome-wide statistical significance would make any sense for further biological interpretation, and snps without a reasonable amount of genetic variation provide little information in a network setting. hence, we select a number of top snps fulfilling both criteria for wish network construction; 1) reaching a genome-wide significant p-value and 2) possessing sufficient amount of variation among the individuals in the population, based on their genotype. depending on the size of the dataset, individuals can be optionally selected based on extreme phenotypic values.

wish network method based on genomic correlations
the wish network describes the relationships between snps by specifying an n x n dimensional adjacency matrix a = aij, where aij states the connection strength between snpi and snpj. the connection strength between the snps is defined by the absolute pearson's correlation between the number of allele copies of pairs of snps for all snp pairs in the data, creating a weighted network with values for aij between  <dig> and  <dig>  this adjacency matrix is raised to the power Î³ . the connectivity of a snp  can concordantly be calculated by taking the sum of connection strengths between a snp and all other snps. snps with a high c can be called hub snps, which may be of biological importance to the trait of interest  <cit> . a wish network follows scale-free topology, meaning that the network will consist of a few highly connected snps  and many low connected snps. in the case of a scale-free network, the frequency distribution of c ) follows a power law. the power Î³ should be chosen in such a way that r <dig>  approaches one, which means the network is approximately scale-free  <cit> . the assumption of scale-free topology can be tested by plotting p and by plotting log) versus log. optionally, data can be further reduced by using a threshold value for selection of snps based on c, to eliminate the snps with an extremely low c.

the adjacency matrix is used to detect the relatedness between pairs of snps based on their shared neighbours by calculating the topological overlap measure   <cit> .

 tomij=nij+aijmin{ci,cj}+1-aij 

where nij is the number of snps to which both snpi and snpj are connected, aij is the adjacency between snpi and snpj, and c is the connectivity. the tom of two snps represents the number of shared neighbour-snps as a value between  <dig> and 1; here a tom of  <dig> means that a pair of snps shares the same neighbour-snps and a tom of  <dig> means that a pair of snps shares no neighbour snps at all. the tom is resulting in a more robust network in the case of many zeroes among the elements in the adjacency matrix or when elements are prone to noise  <cit> . using the dissimilarity tom , a snp dendrogram was created whereby branches of the dendrogram were cut off by the dynamic tree cut algorithm  <cit>  representing the snp modules . each module was assigned to a colour. by plotting the tom as a heat plot, modules can be visualized, and the right cut-off method can be chosen.

a module is defined as a cluster of highly interconnected snps, forming a sub-network which may correspond to a pathway or protein complex, resulting in substantial practical importance in biology. a second visualization to control the detection of modules by the chosen cut-off method is plotting the correlations between module eigensnps. the module eigensnp is the first principal component of the module and can be seen as a representative effect of the module on the trait of interest. optionally, modules with a strong correlation can be merged. secondly, the module eigensnp can be used to examine the relationship between the trait of interest and the module, resulting in a genome-wide module association test  to identify which modules are relevant for downstream analyses.

after detection of the potentially interesting snp modules via gmat, genes in the snp modules have to be detected. to detect the positions of the snps and the genes present in those regions, we used the r-package ncbi2r  with default parameters which uses a list of snps as input and gives  the genes and their annotation in the indicated region. the flanking distance could be changed depending on the species used in the study. in the next step, the genes in those snp lists can be used for functional annotation analyses, for example using the gene ontology enrichment software toolkit  with default parameters, which will reveal if identified snp modules are biologically relevant to the trait of interest. goeast detects highly enriched go-terms in the genes present in the snp modules and defines highly enriched pathways, which can help to understand the results biologically. enriched go-terms with a p-value  below  <dig>  were assigned to be significant.

wish network method based on epistatic interactions
the second option for creating a network using htg data is creating an adjacency matrix based on the epistatic interactions. we used a linear model to estimate the regression coefficient for the epistatic  interaction:

 Î³=Î¼+snpi+snpj+snpi*snpj+Îµ 

where Î³ is the trait of interest or a trait pre-adjusted for systematic environmental effects, Î¼ is the intercept, snpi and snpj is the genotype coded as 1/ <dig> / <dig> , snpi*snpj is the interaction between the pair of snps as a covariate, and Îµ is the residual component. this analysis was performed using the r-package asreml-r  <cit> . in total, four data frames were needed to run the epistatic model: 1) snp: snp information , 2) gwas: gwas results, e.g. from genabel, 3) phen: data frame with one column for the individual id, one column for the sex, and afterwards the columns for the phenotypes and/or fixed effects, and 4) gen: a genotype matrix of m-by-n with m the number of animals and n the number of snps. r-codes using those four data frames are provided in figure  <dig> 

the regression coefficient resulting from the snpi*snpj component is used as input for the adjacency matrix. the regression coefficients are normalized to create a data matrix with values between  <dig> and  <dig>  from here on, the methods are comparable to the methods used in the wish based on genomic correlations. first, we detected which power Î³ results in the highest scale-free topology index  and we raised the adjacency matrix to this power. secondly, the tom was calculated and the dissimilarity-tom was used to create a snp dendrogram. modules were again detected using the dynamic tree cut algorithm. thirdly, potential biologically relevant modules were detected by calculating the gmat. for the calculation of the module eigengenes, the genomic matrix of m-by-n was used to calculate the module eigengene per module, per individual. modules with a significant gmat above a certain threshold were selected for downstream analysis. at last, genes and kegg-pathways in the modules were detected using the r-package ncbi2r, where kegg-pathways with a bonferroni corrected p-value below  <dig>  were assigned to be significant.

materials
phenotype and genotype data  of an f <dig> pig resource population were available to test and assess the wish network on real data  <cit> , and in this study we selected carcass weight at slaughter as phenotype of interest to test the method. carcass weight had an estimated heritability of  <dig>  , which indicates a high degree of genetic variation for this trait in the pig resource population. after adequate quality control measurements, the gwa study was performed using  <dig>  snps using the r-package genabel <cit> . based on the gwa results, snps were selected on the basis of their genome-wide significance. one dataset was created with one genotype value per snp, by calculating the average of the  <dig> alleles . secondly, in concordance with wgcna, which selects genes based on their variance, the most varying snps in the population were selected due to computational limitations. in the wish network based on genomic correlation, a total of  <dig> snps and  <dig> animals from the duroc*gÃ¶ttingen minipigs based on their estimated breeding values  for carcass weight  were selected for network construction. in the wish network based on epistatic interactions a stricter threshold had to be chosen for the selection of snps because of computational limitations, resulting in  <dig> snps. all animals from the duroc*gÃ¶ttingen minipigs population were used for the estimation of epistatic interactions to increase the power.

authors' contributions
hnk conceived the original idea of wish networks and gmat. ljak and hnk developed the wish methodology and ljak implemented the methodology on experimental data. ljak wrote the first draft of the manuscript. both authors wrote, read, and approved the final version of the manuscript.

competing interests
the authors declare that they have no competing interests.

supplementary material
additional file 1
goeast results on carcass weight 

click here for file

 declarations
the authors would like to thank abdirahman a. ali and peter c. thomson for their help in the r-codes for the epistasis association model to estimate interaction regression coefficients. we thank merete fredholm for testing our method on collected phenotype data on the pig population and the biochild consortium http://www.biochild.ku.dk for the use of the high-throughput genotype data on those animals. we thank sameer d. pant for useful discussions. lisette j. a. kogelman was financially supported by a phd stipend awarded to her by the university of copenhagen. haja n. kadarmideen is a recipient of the eu-fp <dig> marie curie actions - career integration grant  which partially funded this work. the publication cost of this article was partially supported by cost-bmbs, action bm <dig> "next generation sequencing data analysis network", seqahead.

this article has been published as part of bmc systems biology volume  <dig> supplement  <dig>  2014: selected articles from the high-throughput omics and data integration workshop. the full contents of the supplement are available online at http://www.biomedcentral.com/bmcsystbiol/supplements/8/s <dig> 
