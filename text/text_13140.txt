BACKGROUND
an insertion sequence  is a small transposable element that encodes the proteins required for its own transposition. the isfinder database  <cit>  currently contains over  <dig> distinct is. during transposition some iss create direct repeats, or target site duplications, in the sequences into which they are integrating. the presence and length of these duplications vary widely between iss and are characteristic of individual is  <cit> . rates of transposition vary between iss and host species, but are frequently in the order of the rate of nucleotide substitutions, making is activity one of the more dynamic evolutionary forces at play in many bacterial genomes. the movement of iss can also have functional consequences for bacterial genomes. iss have been implicated in large changes to genome structure, by expanding in copy number in microbial genomes, with subsequent loss of iss resulting in inactivation of genes, pseudogene formation, mediating deletion of intervening sequences between two copies of the is, or rearrangements of the genome  <cit> .

in addition, is insertions upstream of protein coding sequences can result in their enhanced expression, leading to different phenotypes depending on the function of the over-expressed gene. there are several known examples of is-mediated gene expression leading to clinically important increases in antimicrobial resistance. for example, increased resistance to fluoroquinolones such as ciprofloxacin can result from the insertion of is <dig> or is <dig> upstream of the acref efflux pump in salmonella typhimurium  <cit> , or the insertion of is <dig> upstream of the acrab efflux pump in escherichia coli  <cit> . in acinetobacter baumannii, insertion of isaba <dig> or isaba <dig> upstream of the intrinsic beta-lactamase ampc can cause resistance to third generation cephalosporins including ceftazidime and cefotaxime  <cit> . insertions of the same is in nearby locations can generate a composite transposon, capable of mobilizing the intervening sequence and transferring it to new genomic locations. for example, the composite transposon tn <dig> was generated spontaneously via insertions of isaba <dig> on either side of ampc, including one copy of isaba <dig> that upregulates ampc expression  <cit> . tn <dig> has then transferred into different a. baumannii backgrounds, conferring horizontally-acquired resistance to third generation cephalosporins  <cit> .

is insertions also result in the upregulation of virulence genes in clinically important human pathogens. for example, an outbreak of tuberculosis in spain in the 1990s was associated with the b strain of mycobacterium bovis carrying an insertion of is <dig> in the promoter region of the virulence gene phop, resulting in its upregulation  <cit> . in neisseria meningitidis, insertion of is <dig> in the middle of the capsule locus has been shown to cause increased expression of operons on either side of the is, contributing to protection from the human immune system and enhanced pathogenicity  <cit> . iss have also been shown to enhance niche adaptation in bacteria, for example is <dig> insertion upstream of dhlb in xanthobacter autotrophicus results in increased resistance to bromoacetate  <cit> . this region has also been mobilised by the is and transferred to a plasmid  <cit> . in e. coli, is <dig> has been shown to up-regulate threonine expression, allowing the bacteria to adapt to a low-carbon environment and utilise threonine as its sole carbon source  <cit> .

the profiling of is insertion patterns has been used for typing purposes in numerous bacterial species of importance to human health. for example, copy number and position of is <dig> in salmonella enterica  <cit> , is <dig> in mycobacterium tuberculosis  <cit> , is <dig> in vibrio cholerae  <cit>  and isaba <dig> in a. baumannii  <cit>  has been used to profile these bacterial pathogens, allowing the identification and tracking of distinct subtypes. to date, is-based typing schemes for various bacteria have relied on digesting the genome followed by either hybridizing is probes to fragments in a gel or pcr probing . the detection of precise insertion sites can be achieved using pcr, and may be done for typing purposes  <cit>  or for the detection of functionally important insertions  <cit> .

with the advent of cheap high-throughput short-read sequencing, whole genome sequencing  of bacteria is increasingly common and is replacing traditional methods for characterizing and typing bacterial genomes. unfortunately the detection of iss is complicated wherever read lengths are shorter than the length of the is, as is the case for platforms that are currently most widely used – illumina and ion torrent. is insertion sites can readily be identified in finished bacterial genomes or in draft assemblies of genomes with single-copy iss, using tools such as nucleotide blast or isfinder  <cit> . however where multiple copies of the same is are present within a single genome , this complicates assembly of short-read data and makes is insertion sites difficult to identify reliably. the is detection problem can be resolved using long-read sequencing technologies such as the smrt cell  or minion  platforms; however given the relative cost efficiency and reliability of short-read sequencing, together with the current widespread use of illumina for bacterial wgs and wealth of available short-read data for clinically important bacteria, there remains a need for a simple tool to identify is insertion sites from short-read data.

several studies report the use of mapping-based approaches to identify is insertion sites from bacterial short-read data  <cit> , however none provide software code or validation of the approach used. there are tools available for detecting transposons or structural variation in genomes, for example mindthegap  <cit> , breakdancer  <cit> , and mobster  <cit> , however these do not perform well in the identification of is in bacterial genomes nor were they designed to do so. some programs could potentially be used for this purpose, such as relocate  <cit>  and retroseq  <cit> , however these require additional input or prior knowledge about the is which may not always be available. tif   <cit>  and breseq  <cit>  could potentially be used for the detection of is insertion sites in bacterial genomes, however they were not designed specifically for this purpose and did not perform well on our data sets .

here we present a rapid and robust tool for accurate detection of iss, including insertion site and orientation, direct from short-read data. the method is freely available in the form of open-source code called ismapper, and here we validate its use via analysis of simulated and real short-read data from a range of iss and bacterial species. ismapper requires short reads and query is sequences as input, and can be used either for typing against a reference genome or to assist with manual resolution of complex short-read assemblies.

implementation
an overview of the ismapper workflow is shown in fig.  <dig>  ismapper takes as input:  a set of paired end illumina reads for an isolate of interest,  an is query sequence in fasta format, and  either a reference genome  or an assembly of the read set , in genbank or fasta format . paired end illumina reads are mapped to the is query sequence using bwa-mem   <cit> . from the resulting alignment file , unmapped reads whose pairs map to the end of the is query sequence  are extracted using samtools view   <cit>  to retrieve reads based on sam flags . specifically, left flanking reads  are extracted using flag ‘–f 36’ and right flanking reads are extracted using flag ‘–f  <dig> –f 4’ and stored in separate bam files, which are then converted to fastq format using bedtools   <cit> . in addition, samblaster   <cit>  is used to extract from the sam file any reads that map to the end of the is and extend into the neighbouring sequence . the resulting fastq file is filtered using biopython to extract the soft clipped portion of reads, where those sequences fit a specified size range . the resulting sequences are sorted into left and right flanking sequences; these are each mapped separately to the reference genome or assembly using bwa-mem, to identify the location of the query is in the genome under analysis . insertion site information is extracted from the resulting alignments using bedtools  to summarise coverage of the reference by left and right flanking reads; these are filtered by read depth  to minimize false positive hits, and regions that overlap or are separated by a short distance  are merged using bedtools . pairs of left and right flanking regions that likely represent either side of the same is insertion are identified on the basis of positional information, using bedtools . left and right regions that overlap are considered to indicate a novel is insertion not present in the reference, with the overlap resulting from target site duplication arising during is transposition . coordinate x refers to the left side of the target site duplication, and y refers to the coordinate of the right side of the target site duplication. in cases where the left and right flanking regions are extremely close but do not overlap, x refers to the inner end of the left-most region, and y refers to the inner end of the right-most region . where left and right regions are separated by a sequence that is approximately the length of the is query, the intervening sequence is extracted and compared to the is query using nucleotide blast+   <cit>  to confirm whether this is a known insertion site that is present in the reference . in this case, coordinate x refers to the inner end of the left-most block, and y refers to the inner end of the right-most block. coordinate x is always the smallest number and y always the largest, regardless of is orientation.fig.  <dig> workflow for ismapper. a inputs are reads  and an is query , as well as either a reference genome to compare to or an assembly of the reads . b reads are mapped to the is query using bwa  and their pairs  are retreived from the resulting sam file using mapping flags . the unmapped component of soft clipped reads , identified from the sam file using samblaster) are also retrieved using biopython. c flanking and softclipped read sequences are then mapped to either the reference genome or the read assembly , and the final mapping output is then filtered for depth to remove low coverage regions. left and right end blocks are extracted from the resulting bam file  and compared to one another to find either intersecting regions, indicating a novel is position, or close regions, indicating a known is position in the reference. in a novel position, overlapping sequences from the left and right ends most likely indicate the target site duplication generated during is transposition . d results are tabulated, indicating the position and orientation of each site, whether it is novel or known, and information about the genes flanking the insertion site



extensive testing of ismapper revealed that it was sometimes unable to resolve is positions that were adjacent to a repeat region . this is because when the is-flanking reads were mapped back to the reference genome, those that belonged to the neighbouring multi-copy sequence were randomly assigned by bwa-mem to the various locations of the repeat sequence, resulting in low read depth at the ‘true’ is-adjacent copy of the multi-copy sequence, which can fall below the minimum depth filter . in such cases, the sequence on the other side of the is is usually not a multi-copy sequence and thus does not suffer the same problem, and so is usually identified as a confident is-flanking region without a corresponding partner region . therefore, when ismapper identifies an un-partnered is-flanking region, it checks the original alignments for evidence of a nearby low-coverage partner region that failed to pass the depth filter and returns this as a potential but uncertain is location, indicated by a ‘?’ character in the results table .fig.  <dig> issues can arise in the second mapping step of ismapper if the is insertion is next to a region that occurs more than once in the reference genome. in this example, the left flanking reads  have mapped to all possible copies of the repeat sequence  and are each randomly assigned to a repeat copy by bwa, resulting in each copy falling below the read depth cut-off . to overcome this, where an unpaired flanking region is identified , ismapper searches for a potential low-depth partner flanking region that is close to or intersecting the confident region . this is recorded as an uncertain call, labelled in the output with the ‘?’ character



ismapper generates two main output files summarizing the results:  a genbank file of the reference sequence, annotated with the is-flanking regions and  a table indicating the locations and characteristics of each is-flanking region identified . the table includes details of the location of the is insertions ; the distance between the left and right flanking regions ; a call as to whether the insertion is present in the reference or is a novel insertion site ; and details of the gene closest to the is insertion site . insertions are also marked to indicate less confident calls. a ‘*’ indicates an imprecise hit; i.e., where the gap between left and right regions is larger than expected for a novel insertion, but is not consistent with an is insertion at that location in the reference. a ‘?’ indicates an uncertain hit, where only one end  passes the minimum read depth threshold; this often occurs when the is is inserted within or adjacent to a multi-copy sequence, as described above . when run in assembly improvement mode, the table produced is simpler and indicates which contigs are predicted to end adjacent to the is , assisting the user to decide whether some contigs could be joined together based on the available is evidence.

ismapper is lightweight code – a test run on a laptop computer  with 8gb of ram and a  <dig> ghz i <dig> processor was able to analyse a read set comprising  <dig>  million 100 bp paired-end reads in approximately ten minutes for a single is query. because ismapper analyses each read set and query is independently, screening of multiple read sets and query is can be easily performed in parallel across multiple cores. to facilitate easy compilation of results from multiple jobs, ismapper includes a python script to cross-tabulate results from multiple read sets, generating a single summary table per query is .

RESULTS
validation of is detection using simulated reads
nine publicly available finished genomes from a variety of bacterial genera, and including both chromosomes and plasmids, were downloaded from ncbi . isfinder  <cit>  was used to identify the iss present in each finished genome sequence. all sequences that had >50 % identity to a sequence in isfinder and were present in at least two copies were tested using ismapper . nucleotide blast+ was used to confirm the precise locations and orientations for each query is in all genomes . short reads  were simulated from each genome sequence using the wgsim command in samtools , with default parameter settings.table  <dig> validation of ismapper using simulated reads



b 



a

a
a, b 
a


a, b 

aindicates ismapper was unable to resolve some is positions due to repeat regions


bindicates ismapper incorrectly identified an insertion site, the number of these sites are indicated in brackets



ismapper was run with default parameter settings on each combination of genome, query is and simulated reads. ismapper was able to accurately locate each is position and its orientation  for the majority of genomes . in total, 97 % of is insertions were correctly detected, with a false positive rate of  <dig>  % . the exceptions occurred in three genomes , in which ismapper correctly identified  <dig> is insertion sites and failed to identify nine . closer inspection revealed that the missed is were each located next to multi-copy repeat sequences, complicating the second mapping step as discussed above and outlined in fig.  <dig>  switching on reporting of all alignments above a mapping score threshold of  <dig>  enabled the detection of a further is <dig> site in y. pestis. by default this option is turned off in ismapper as it tends to create noise in the mapping, making it more difficult to distinguish true and false positives; however this can be useful if an is site of interest is known or suspected to be flanked by further repeats.

validation of is detection using real illumina read sets derived from isolates with finished genomes
next we validated ismapper using six finished genomes for which both illumina read data and finished genomes were publicly available . each finished genome sequence was analysed with isfinder  <cit>  to identify query iss for testing as described above, and nucleotide blast was used to confirm the precise locations and orientations of each is in each genome. the resulting test set comprised  <dig> insertions of  <dig> query iss. using default settings, ismapper was able to accurately identify each is insertion site and its orientation, between  <dig> and  <dig> per genome, for the majority of genomes . in total,  <dig>  is insertions were correctly detected by ismapper, with  <dig> is insertions falsely detected . three of four is431mec insertions in staphylococcus aureus tw <dig> were correctly detected, however the fourth was missed by ismapper as it was flanked by another is431mec and further repeat sequences. two of three is <dig> insertions in salmonella typhi ct <dig> were correctly detected however a third, located between tvie and tvid, was problematic. ismapper identified the region flanking the is at tvie, but did not detect any corresponding region in tvid. to investigate why, we mapped the entire illumina read set to the ct <dig> chromosome reference sequence, which showed that there were no reads derived from the region between tvid to tvia. therefore this region appears to have been deleted during culture in the laboratory prior to the extraction of dna for illumina sequencing. this region encodes the biosynthesis of the vi capsule of s. typhi, and is known to be lost sporadically during culture  <cit> . this illustrates that situations where one end of the is is detected but the other is not can often be ‘accurate’ in the sense that the result reflects underlying structural variation in the genome, including potentially is-mediated deletions.table  <dig> validation of ismapper using real illumina reads for which finished genomes were also available





a


aindicates ismapper was unable to resolve some positions due to repeat regions


bindicates ismapper incorrectly identified an insertion site, the number of these sites are indicated in brackets



detection of antibiotic resistance-mediating is insertions in acinetobacter baumannii, confirmed by pcr
the genomes of seven ceftazidime resistant a. baumannii isolates, belonging to global clone   <dig>  were sequenced via illumina hiseq to generate 100 bp paired end reads. resistance gene screening of the illumina data using srst <dig>  <cit>  and the arg-annot database  <cit>  confirmed earlier pcr data indicating that none of these isolates carried acquired extended spectrum beta-lactamase  genes that can confer resistance to third-generation cephalosporins. however, it is known that the insertion of isaba <dig> upstream of the intrinsic chromosomally encoded ampc beta-lactamase gene can cause increased resistance to third-generation cephalosporins in a. baumannii  <cit> .

we used ismapper to screen for the isaba <dig> query sequence , sourced from isfinder  <cit> . using default parameters, ismapper identified isaba <dig> insertions in all seven gc <dig> genomes. is positions were assessed relative to the finished genome sequence of a. baumannii gc <dig> reference a <dig> . ismapper found between  <dig> and  <dig> isaba <dig> insertions in each gc <dig> isolate, including an insertion upstream of ampc in all  <dig> genomes that was in the orientation required to induce upregulation and explain the observed cephalosporin resistance phenotype . in addition, out of  <dig> total isaba <dig> insertions, ismapper was able to correctly identify  <dig> target site duplications . all isaba <dig> insertions were novel compared to the reference genome a <dig>  and were confirmed using pcr, as described in  <cit> .fig.  <dig> isaba <dig> positions detected in seven acinetobacter baumannii genomes. the a <dig> reference genome is indicated by the outer black circle, tick marks indicate genome coordinates , genes targeted in the two available mlst schemes are marked in blue for orientation purposes. isaba <dig> detected within the individual test genomes are shown on inner rings , orientation of the is is indicated by shading . novel is insertions were identified upstream of the beta-lactamase ampc  in all isolates, explaining the observed phenotypic resistance to third generation cephalosporins



impact of read depth on ismapper performance
to test the effect of read depth on the performance of ismapper, each of the seven gc <dig> a. baumannii read sets were randomly subsampled to depths of approximately 10x, 15x, 20x, 25x, 50x, 75x and 100x, with ten replicates per depth level per read set. ismapper was then run using default settings to screen for isaba <dig> insertions. the results indicated that at mean genome-wide read depths of approximately 20x, ismapper was able to identify 95 % of insertions correctly . however, all of these calls were either imprecise  or uncertain . an average genome-wide read depth of ~50x was required to find all insertions, with confident calls for >60 %, however there was clearly some variation depending on read quality . to achieve 100 % detection with high confidence, average genome-wide read depths of >75x were required .fig.  <dig> isaba <dig> detection rate as a function of read depth, for seven a. baumannii gc <dig> genomes sequenced with illumina. mean  and standard deviation  proportions of is insertions correctly detected per genome, amongst  <dig> replicate read sets sampled at each depth level . blue, is insertion site detected; red, detected with high confidence; purple, detected with low precision ; green, detected with low confidence 



comparison of ismapper with tif and breseq
the seven a. baumannii gc <dig> genomes were used to test both breseq  <cit>  and tif   <cit> . breseq uses split read mapping to a reference genome along with statistical models to determine new junctions and deletions in the isolates of interest. as input, breseq takes paired end reads in fastq format, and a reference genome in genbank format. the breseq manual indicates that new insertions of mobile elements can determined by looking for ‘jc jc’ evidence types in the final html output. all seven a. baumannii isolates were screened using default parameters and the reference genome a <dig> . in all cases, breseq was unable to identify any mobile element insertions, including no structural variation at the known isaba <dig> insertion sites, although many other types of structural variation were detected.

tif requires as input paired end reads , the head and tail sequences  of the is of interest as well as the size of the target site duplication the is makes during transposition. tif uses regular expressions to search for the head and tail sequences in the reads, and these reads are then extracted and grouped by their target site duplications. unfortunately, following communication with the authors, we were unable to get tif to output any results using our data. other disadvantages of tif are the requirements to  specify the size of target site duplications ,  manually extract subsequences of the is rather than inputting the complete sequence, and  manually edit a perl script in order to specify inputs to the program.

example use case: exploration of is <dig> insertions in mycobacterium tuberculosis
while is insertions are thought to be important for shaping the evolution of bacteria in a variety of ways, high-resolution comparative genomic studies of bacterial pathogens have largely ignored iss due to the difficulties associated with accurate detection of insertion sites from high-throughput short read data. an important example is is <dig> in m. tuberculosis  <cit> . profiling of is <dig> insertions using pcr and restriction fragment based polymorphism  based methods has been reported for typing purposes  <cit> , and specific insertions have been linked to clinically relevant changes in function including in outbreak strains  <cit>  however while numerous studies have reported the genomic analysis of hundreds of m. tuberculosis isolates sequenced on the illumina platform, these have not included analysis of is <dig> insertions. thus, to demonstrate the utility of ismapper for comparative profiling of iss in an important bacterial pathogen, we analysed the distribution of is <dig> within  <dig> publicly available genomes representing the major lineages of m. tuberculosis  <cit> . paired-end illumina reads were downloaded from ncbi . a core genome phylogeny was generated from these reads by snp  calling against reference genome h37rv  , followed by maximum likelihood phylogenetic inference on the snp alignment using raxml  to build a genome-wide phylogenetic tree. ismapper was run with default settings to screen for insertions of is <dig>  in each read set, relative to reference genome h37rv.

a total of  <dig> unique is <dig> insertion sites were identified by ismapper, approximately one per  <dig> kbp of the  <dig>  mbp reference genome. the frequency of each insertion within each of the six main global lineages is shown in fig. 5b. the data indicate multiple lineage-specific is <dig> insertions in lineages 2– <dig>  but none that were shared by multiple lineages, suggesting that is <dig> insertions began to accumulate only after m. tuberculosis diverged into these distinct lineages. isolates in the “modern” lineages 2– <dig> and in the west african lineage  <dig> had more is <dig> insertions overall, with far fewer insertions observed in the “ancient” east and west african lineages  <dig> and  <dig> . lineage  <dig>  which includes the highly successful beijing sublineage, had the highest number of is <dig> although it was not the most common lineage in the collection ; it could be that these insertions contribute to the adaptive fitness of the beijing lineage.fig.  <dig> analysis of is <dig> insertions in a diverse set of m. tuberculosis genomes. analyses are based on ismapper analysis of publicly available illumina paired end data from  <dig> genomes. a phylogenetic tree for m. tuberculosis based on genome-wide snp calls, with midpoint rooting and collapsed to lineage level. number of isolates analysed in each lineage  is indicated in brackets. b heat map indicating the frequency of each is <dig> insertion site  detected in each lineage , according to inset legend . c boxplots show number of is <dig> insertions detected per genome, for each lineage. black line, median; boxes, interquartile range; whiskers, minimum and maximum values. d histogram of is <dig> insertions in 1000 bp windows along the m. tuberculosis chromosome. dashed line, threshold for defining insertion hotspots



the spatial distribution of unique is <dig> insertions within the m. tuberculosis genome  revealed several clusters of insertions detected by ismapper. many of these clusters comprised multiple independent insertions into pe/ppe genes , as well as the membrane associated proteins mmps <dig> and mmpl <dig>  there was substantial clustering of is <dig> insertions interrupting genes encoding the crispr machinery, which is involved in immunity to bacteriophage and other foreign dna. further, all three phospholipase genes, which are involved in virulence by inducing cell death in macrophages  <cit>  and are encoded by the plcabc operon, contained multiple is <dig> insertions detected by ismapper. this locus is a known hotspot for is <dig> insertions and has been shown to mediate deletions of segments of this region  <cit> . is <dig> insertions upstream of phop, which have been associated with upregulation and enhanced virulence in m. tuberculosis  <cit> , were identified in multiple lineages  and may be indicative of positive selection for enhanced phop expression and virulence. these findings from ismapper analysis are consistent with those reported from pcr-based screens of smaller sets of isolates, but provide a more comprehensive picture of is dynamics in m. tuberculosis that could be extended to much larger genomic data sets and other important pathogens.

CONCLUSIONS
ismapper is a lightweight and reliable tool for the detection of is insertion sites in bacterial genomes using high-throughput short-read sequencing data, which is now ubiquitous in microbial research and clinical investigations. ismapper performed well on real and simulated data from  <dig> different iss and  <dig> bacterial species, detecting all but the most complex instances involving multiple neighbouring is insertions or other repeated sequences. ismapper was able to detect antimicrobial resistance-associated isaba <dig> insertions in a. baumannii, with all sites detected by the program being subsequently confirmed by pcr. compared to other tools such as breseq and tif, ismapper is ideal for detecting new positions for known iss in bacterial genomes. in addition, ismapper was able to rapidly produce a wealth of data on is <dig> insertions in m. tuberculosis, allowing quick identification of lineage-specific insertions and specific regions enriched for insertions that may be functionally significant.

availability and requirements
project name: ismapper

project home page:https://github.com/jhawkey/is_mapper

programming language: python v <dig> .5

operating system: platform independent, requires python  <dig>  and dependencies

other requirements: biopython v <dig> , bwa v <dig> . <dig>  samtools v <dig> , bedtools v <dig> . <dig>  blast+ v <dig> . <dig>  samblaster v <dig> .21

license: modified bsd



competing interests

the authors declare that they have no competing interests.

authors’ contributions

jh developed the code, analysed data and wrote the paper. keh conceived the study and helped to draft the manuscript. hbj participated in design and coordination of the study and contributed to data interpretation. rrw and dje developed code. mh performed pcr and sequence analysis. rmh provided sequence data and isolates for validation and contributed to data interpretation. all authors read and approved the final manuscript.

