BACKGROUND
cultivation-independent studies are revolutionizing our understanding of global biodiversity, and offering new insights into the roles that microbes play in the planet’s biogeochemical cycles. however, many microbial habitats of recent interest can be considered “low biomass” systems, as these sample types may only allow access to a few thousand cells. such environments include the atmosphere  <cit> , the deep subsurface  <cit> , the built environment  <cit>  and free viral communities  <cit> , among others. while each of these environments is physically distinct, they all require exceptionally large sampling volumes in order to obtain sufficient quantities of dna for downstream processing. for example, many cubic meters of air are required for an atmospheric sample  <cit> , hundreds of liters of fluids for a subseafloor sample  <cit> , and even larger volumes for viral communities  <cit> . even at these large sampling volumes, dna extractions from low biomass samples rarely produce more than a few picograms of dna, the equivalent of a few thousand microbial cells   <cit> . while such ultra-low dna quantities may easily enable amplicon sequencing, as witnessed by the wealth of data on the types of microbes that exist in these systems, a typical metagenomic library preparation requires as much as a microgram of input dna  <cit> .

the desire of the scientific community to move beyond pcr-based surveys to understand the community functional attributes in low biomass ecosystems has gone hand-in-hand with recent efforts by commercial vendors to develop low dna template sequencing library protocols. methods to enrich or amplify dna from low biomass environments are presently available, however each of these has its own set of biases. for example, multiple-displacement amplification  uses phi <dig> dna polymerase to produce millions of copies of template dna and has been previously used to increase template quantities in samples prepared for metagenomic sequencing  <cit> . however, mda specific biases include non-uniform coverage of mda templates  <cit> , shifts in gc profiles and as a result, an altered microbiome  <cit> , yet in some environments, this bias is thought to be minimal  <cit> . linear amplification for deep sequencing   <cit>  and linker amplification   <cit>  have been developed to decrease some of these biases, although significant laboratory expertise and handling time are required. an interesting alternative is the malbac  method of genome amplification, which uses a semi-linear amplification to reduce amplification bias and increase genome coverage  <cit> , however this method has yet to be tested on mixed cell populations .

each of the methods described above requires significant laboratory manipulation, which makes production level scaling challenging. two low template library preparation methods that may be amenable to higher throughput are illumina’s nextera xt kit and nugen’s mondrian microfluidics workstation in conjunction with the nugen ovation library preparation kit. importantly, these kits also dramatically reduce the amount of hands-on laboratory prep time, which naturally decreases contamination risks. the nextera xt kit uses a transposase mediated reaction that combines polishing and ligation into a single 5-min reaction. the mondrian microfluidics system together with the ovation library prep protocol takes advantage of microfluidics to automate many of the steps involved in a typical next-gen library preparation. both nextera xt and mondrian microfluidics systems have made considerable strides towards reducing input requirements, as both kits currently recommend a minimum of 1 ng input dna.

nevertheless, 1 ng is still orders of magnitude higher than the amount of dna typically extracted from a low biomass sample. therefore, either amplification methods with minimal bias, or library preparation protocols with even lower input requirements are urgently needed. while amplification methods without bias are currently not technically realistic, reducing input requirements to levels below those recommended by the manufacturers may be possible when contaminant levels are kept low. for example, work by chafee et al.  <cit>  demonstrated that high quality metagenomic libraries can be constructed from as little as 50 pg of input dna with the nextera xt kit , solonenko et al.  <cit>  generated viral metagenomes with as little as 10 pg starting material using the linear amplification  method, and adey et al.  <cit>  demonstrated that the nextera protocol can be used on just three copies of the human genome without significant coverage bias, the equivalent of 10 pg of genomic dna.

despite these advances, to our knowledge no study to date has systematically benchmarked and analyzed multiple library preparation protocols across a gradient of input dna levels and tested the limits thereof. using a defined mock metagenomic community of  <dig> taxa, we evaluated the performance of three distinct low dna template sequencing library preparation protocols: the nextera xt, the mondrian microfluidics system and the malbac single- cell technology. library preparation performance and the resulting mock metagenome sequence data were evaluated across a range of template quantities spanning 50 ng to 1 pg and compared to a 200 ng unamplified truseq control library.

RESULTS
general library statistics
for our defined mock community of  <dig> microorganisms encompassing  <dig> bacteria and  <dig> archaea, we generated and sequenced illumina libraries using nextera xt, mondrian and malbac protocols for serial template dilutions ranging from 50 ng - 1 pg . following read trimming and quality filtering, all datasets were randomly subsampled to  <dig> million reads and all downstream analyses were performed on the subsampled data. total read counts and the percentage of reads following retained trimming and quality filtering are reported in additional file 1: table s <dig> fig.  <dig> sample overview. each tube on this plot represents a mock metagenomic library preparation. the control library is an unamplified truseq library of the same mock community sample generated from 200 ng input dna



the percentage of reads lost to trimming and quality filtering was fairly consistent across library types and input quantities, where 11 % of reads were removed from the control library and a similar fraction was removed from the mondrian, malbac and high input nextera xt libraries. however, with decreasing input levels in the nextera xt libraries, the fraction of reads removed increased , which is likely a result of the increased activity of the transposase mediated fragmentation reaction at the lowest inputs. the percentage of reads retained following read qc differed between library types  and this difference appears to be driven by the percentage of reads removed from the nextera xt libraries as compared to the mondrian and malbac libraries . in addition to the percentage of reads retained following trimming and quality filtering, the percentage of duplicate reads also differed across library types . this was especially noticeable in the nextera xt libraries , although all libraries generated a fairly large fraction of duplicate reads, which may be related to the low diversity of our mock community.

insert size variability
library preparation had a strong effect on library insert sizes  . the mean insert size of the control truseq library was 237 bp, which approximates the desired insert size as the truseq library contained sufficient starting material  and no pcr enrichment cycles. the mean insert size for the nextera xt, mondrian and malbac libraries were  <dig>   <dig> and 208 bp, respectively. conversely, input level did not have an effect on insert size distributions   . the largest differences in insert size distributions occur between libraries originating from covaris sheared input dna and libraries prepared by the nextera xt tagmentation procedure. the effect of library type on insert size was evaluated further using pairwise comparisons and bonferroni adjusted p-values indicating that the nextera xt peak insert sizes significantly differed from both mondrian and malbac insert sizes  while the mondrian and malbac insert sizes were not statistically distinct  . these results are expected given that enzymatic shearing is generally more biased with regard to dna fragmentation, as compared to mechanical methods, such as sonication  <cit> .fig.  <dig> 
a insert size and  gc profiles of illumina sequence data from each of the three different library preparation methods. unamplified control library is represented by the red dashed line



gc shifts with decreasing input levels
gc profiles showed minor differences between the three library types, however shifts were apparent within the nextera xt and mondrian dilution series . as input level decreased, a shift toward a more gc rich community was observed. the gc profile of the unamplified truseq control contained a dominant gc peak at 43 % and a minor peak at 58 %. the malbac libraries displayed a very different profile than the control, while nextera xt and mondrian libraries gradually shifted to gc rich profiles where the libraries with the highest gc content correspond to the lowest input quantities . to analyze these profiles statistically, we performed a simple anova on the dominant gc peak  containing the highest number of reads  across the three library types and the three input levels . library type had no statistical effect on gc profiles , while input level did exhibit an effect  . following a bonferroni p-value adjustment for multiple tests, no significant pairwise comparisons were observed, although the high versus low and high versus medium comparisons  suggest the potential for shifting gc profiles from low to high gc %, reflecting the trend that the high input libraries were more similar to the control than the lowest input libraries. this pattern is likely the result of an increase in pcr enrichment cycling just prior to flow cell loading and sequencing. to analyze this effect in more detail, we plotted the number of reads that mapped to each reference organism, and arranged the reference taxa from low to high gc %, which enabled the determination of the taxa driving the shift in overall metagenome gc profiles. the abundances of low and high gc organisms changed through the dilution series , where a gradual drop in abundance was observed in the following low gc organisms: clostridium perfringens, streptococcus pyogenes, ferividobacterium pennivorans and clostridium thermocellum with a concomitant increase in the high gc organism abundances including halovivax ruber, olsenella uli and segniliparus rotundus. furthermore, the gc profiles of all reads that failed to map to the references  were also skewed toward high gc content . together, this suggests a shift in gc content and a corresponding shift in mock taxa abundances that will eventually lead to artificial shifts in overall metagenome composition.fig.  <dig> relative abundances of each mock community member and the unmapped reads with the exception of nocardiopsis dassonvillei . individual gc plots corresponding to the high and low gc references are displayed in additional file 1: figure s <dig>  which further illustrates the shift in relative abundance from low to high gc organisms across the dilution series. unamplified control library is represented by the red diamond



read mapping to reference genomes reveals differences between library preparations and input levels
compared to the unamplified truseq control, the nextera xt and most mondrian libraries  produced very few  unmapped sequence reads  and the taxonomic distributions were similar to the unamplified control library , although as stated above, taxa abundances did change with decreasing input levels. in contrast, the malbac libraries differed from the unamplified control throughout the dilution series. for example, meiothermus silvanus was consistently enriched in the malbac libraries, while the relative abundances of natronobacterium gregoryi, olsenella uli, segniliparus rotundus, halovivax ruber and desulfotomaculum gibsoniae decreased  when compared to the control library. the number of unmapped reads in the malbac libraries was also relatively high, above 1 % across all libraries and nearly 30 % in the 1 pg library. to further characterize the unmapped reads, the unmapped sequences were reclassified with focus, a short read classifier based on a database of  <dig> reference genomes  <cit> . this allowed us to determine if reads were simply below the quality required for mapping or if they represent common contaminants that overwhelm the target dna during library preparation. the unmapped reads identified in the malbac libraries represented a relatively large proportion of total reads , and many of these reads were surprisingly reclassified to meiothermus silvanus, a member of the mock community, which implies that these reads were below the quality required for the initial reference based read mapping. the remaining unmapped reads from the malbac libraries were reclassified with focus to a variety of taxa not included in the mock community , which likely represent reagent and/or lab contaminants that become more pronounced at the lowest dilutions, which is one of the inherent risks when working with low-biomass samples. by contrast, the majority of the unmapped reads from the  <dig> and 1 pg mondrian libraries  could not be assigned to the focus database with the exception of some mycoplasma pneumoniae assignments, indicating low quality reads at the lowest inputs .fig.  <dig> 
a mock community relative abundances across each library prep kit and across each dilution including the truseq 200 ng control library . b principal coordinates analyses of euclidean distances derived from mapping reads to the mock community reference genomes  and of k-mer frequencies . individual samples are colored by either library preparation  or starting input quantity . the unamplified 200 ng control library is represented by the red point in each ordination



to further explore whole library differences where each sample represents an individual microbial community, we computed euclidean distances of all pairwise library comparisons, and performed principal coordinates analyses  on these distances to determine whether library type and/or input level had an effect on the overall composition of the mock metagenomes. based on the euclidean distance pcoa plot in fig. 4b , the nextera xt and mondrian libraries appear highly similar to the control library while the malbac libraries formed their own distinct cluster . these patterns were supported using permanova statistics on the distance matrices with library type as the grouping factor, excluding the control sample as n =  <dig> . both nextera xt and mondrian libraries significantly differed from the malbac libraries . when libraries were grouped by input level , no effect was observed , however there does appear to be a within library gradient where libraries of higher input are more similar to each other than they are to the lower input libraries .

sequence signatures demonstrate compositional differences between library types
to supplement the community comparisons using read abundances, we also used k-tuple frequencies to determine the effect of library type and input level on the resulting metagenomic composition irrespective of reference database. this approach calculates k-mer frequencies across a range of k-mers , then generates distance matrices used as input for ordinations and multivariate statistical analyses  <cit> . the results indicate similar patterns to the read mapping results, as library type , but not input level  significantly influenced the k-tuple frequency of the mock metagenomic libraries. however, there again appears to be a slight gradient where the higher input mondrian and nextera xt libraries cluster closer to the control than the lower input libraries . we justified the grouping of different k-mer length profiles by performing a procrustes analysis on small , medium  and large  k-mer length profiles in order to ensure reproducibility of community profiles at different k-mer lengths. as observed in additional file 1: figure s <dig>  the effect that library type had on metagenomic sequence composition is present regardless of k-mer length.

assembly quality varies across library type and input level
de novo assemblies were generated for each sample and the associated assembly statistics are presented in additional file 1: table s2 and table s <dig>  the control unamplified truseq library had an overall assembly size of 60 mb, total number of contigs was  <dig> , contig n <dig> was 1271 bp, largest contig was  <dig>  mb and 95 % of reads could be mapped back to the assembly. overall, the assembly stats of the three tested library preparations were variable , although there are a few consistent patterns worth noting. the percentage of reads that mapped back to the corresponding assemblies gradually declined with decreasing dna input. moreover, the largest contigs for each of the tested library types were considerably smaller than the largest contig generated from the unamplified control library.

reference independent binning produces near complete genomes of many of the dominant mock community microbes
to complete our current analyses, we binned genomes from each of the low input metagenomic libraries and compared the distribution and completeness  of the extracted bins to the bins extracted from the unamplified control library. the employed binning tool, metabat, uses a reference independent approach to bin genomes based on coverage and tetra-nucleotide frequency  <cit> . provided that our low input library comparisons required subsampling to allow sample to sample comparisons, our intent was not to assemble all the genomes present in the mock community, but instead to make meaningful comparisons between the bins extracted from the ideal unamplified control library to the low input libraries. based on the binning results and bin quality assessments, ten near complete, taxonomically distinct genome bins were extracted from the control library. a very similar genome bin profile was observed in the nextera xt libraries down to 5 pg, however no bins could be extracted from the 1 pg library . interestingly, the mondrian libraries produced high quality bins in the middle of the dilution series while few bins could be extracted from the highest and lowest input samples. this observation appears to mimic the assembly statistics derived from the mondrian libraries, where the best assemblies were obtained from the libraries between  <dig> and 50 pg input material. consistent with the read and composition based analyses described above, the malbac libraries were the most biased of the three tested protocols. only one taxonomic bin could be successfully extracted , a meiothermus silvanus bin, which is expected based on the over-representation of this mock community member in the malbac libraries .fig.  <dig> heatmap noting the completeness of genomic bins extracted from each of the low input metagenomes. the color bar on top of the figure refers to each of the three tested library types and control library . samples are also arranged where the highest input quantity is located on the left side of each library type



discussion
based on insert sizes, gc content, read mapping, k-mer frequency and assembly statistics, the low biomass libraries with the highest similarity to the 200 ng unamplified control were the nextera xt libraries followed by the mondrian libraries, and finally, the malbac libraries. while no library type achieved best results across all metrics used in our current study, the nextera xt libraries performed topmost, as the only quality metrics significantly departing from the control were peak insert size, gc content at the lowest inputs, and some of the assembly statistics.

tagmentation produces variable insert sizes
enzymatic fragmentation based on the tn <dig> transposase has been described as a highly efficient library preparation method  <cit> , with the main obstacle being the control of library insert size. the nextera xt transposase produced insert sizes that were on average considerably smaller than the other library types , which is consistent with the observations noted by chafee et al.  <cit>  and adey et al.  <cit> , suggesting increased activity and the potential for slight sequence dependent biases at the lowest template levels. few studies have analyzed the effect of over fragmentation in nextera xt libraries, however work by marine et al. found that even the smallest inserts  recruited to viral reference genomes at a similar frequency to the longer sequences used in their study   <cit> . this is similar to our own read mapping results, as a high fraction of reads were mapped back to the respective assemblies throughout most of the dilution series with the exception of the lowest input, 1 pg library . however, paired-end 150 bp reads may result in truncated reads when inserts are < 150 bp, and redundant sequence data when inserts are < 300 bp; reduced efficiency of small inserts may explain the slightly poorer assembly results from the nextera xt data.

variation in library gc content may be related to increased pcr cycling at the lowest inputs
while pcr enrichment is an often necessary step in the production of sufficient adapter ligated library molecules for sequencing, this step can lead to an artificial, albeit stochastic shift in gc content  <cit> . for example, aird et al. examined sources of potential bias through the course of an illumina library preparation including mechanical shearing, ligation of adapters and the pcr enrichment step. they noted that pcr led to the largest bias, as the coverage of both at and gc rich portions of the e. coli k <dig> genome dropped dramatically following as few as  <dig> pcr cycles  <cit> . interestingly, the three tested library types in our current study each had a significant gc shift below 500 pg input dna . similarly, chafee et al.  <cit>  observed a gc shift in arabidopsis associated metagenomic communities with decreasing input. while the direction of the gc shift observed by chafee et al. was the opposite direction of our current analyses , this shift may be organism specific  <cit> , and is therefore difficult to generalize across whole microbial communities. what can be generalized is that some form of pcr amplification bias is occurring, which leads to slightly altered abundance profiles at the lowest input levels . consequently, the number of pcr cycles used prior to and following adapter ligation should be kept to a minimum to avoid gc-based shifting community composition, which would make quantitative analysis prohibitive.

taxonomic assignment of reads to references is minimally biased in the nextera xt and mondrian libraries down to picogram levels
since this work was performed on a defined mock community, our analyses represent a systematic overview of the factors with the greatest impact on the subsequent metagenomic sequence data. the mapping of reads to references demonstrated that the nextera xt libraries were most similar to the unamplified control library with the fewest unmapped reads throughout much of the dilution series . the number of unmapped reads observed in the mondrian samples exceeded 1 % in the  <dig> and 1 pg libraries, while all malbac libraries contained high levels of reads that could not be mapped back to the reference genomes, suggestive of significant biases associated with the malbac amplification procedure. the malbac procedure is intended to reduce bias by suppressing the over-amplification of abundant template molecules, has recently been shown to produce unbiased coverage across human cancer cell lines  <cit>  and has performed as well as other single-cell amplification methods such as mda on single-cell templates  <cit> . however, both studies examined the value of the malbac procedure on isolated single cells, not mixed metagenomic populations. based on our current work, this method clearly over-amplifies some taxa at the expense of others, making it unsuitable for use on low biomass environmental samples .

the rather small increase in the number of unmapped reads at the lowest nextera xt inputs and the slightly larger increase in unmapped reads in the  <dig> and 1 pg mondrian libraries suggests that low input libraries using either the nextera xt or mondrian systems are suitable for picogram range dna samples with the understanding that some biases may occur as the number of pcr enrichment cycles is increased. however, as other recent microbiome studies have pointed out, contaminants become increasingly important and problematic at low target dna quantities . therefore, both wetlab scientists and bioinformatic analysts need to be aware of the effect of additional pcr cycling on overall community composition, and the increasing influence of contaminants with low amounts of starting material.

comparative metagenomics using community based analyses
in addition to the general library statistics and taxonomic read mapping, we also took a community ecology approach to assess the variability between library types and input quantities. based on these analyses, we found that library type had a significant effect on metagenome composition . while input level had no significant effect, a slight gradient separating the high and low input levels in the k-mer based principal coordinates plots was apparent . although chafee et al. used a slightly different experimental approach, they too did not observe a significant effect of either input level or pcr cycle number on nextera xt metagenomes  <cit> . in our current work, we could not decouple the effect of pcr cycle number and input quantity, as an increase in pcr cycles was needed for library production from the lowest inputs. the malbac procedure clearly generated the most distinct libraries of the three tested protocols, and these libraries were also clearly different from the unamplified control library . while this technology has been previously shown to produce similar results to other single-cell amplification methods  <cit> , our results suggest that this method is not well suited for low biomass metagenome studies .

assembly quality varies across library types with potential impact on downstream analyses
assembling reads into larger contiguous fragments is becoming increasingly important in metagenomic studies. read lengths will continue to increase and assembly algorithms specific for metagenomes are now being developed . in our current study, the assembly statistics for both nextera xt and mondrian libraries were acceptable, however neither library produced the assembly quality of the unamplified 200 ng control library . to further assess assembly quality, we binned the contigs from each library into distinct genomic bins and determined the corresponding bin completeness using sets of lineage specific co-located marker genes  <cit> . ten taxonomically distinct bins were created from the 200 ng unamplified control library, which was mirrored in the nextera xt libraries with the exception of the 1 pg library. the same genome bins were extracted from the middle input  mondrian libraries . the drop off in binning efficiency at the lowest input levels is likely the result of decreased assembly quality at the lowest inputs as noted in additional file 1: table s <dig>  in contrast, the malbac libraries only produced a single meiothermus silvanus bin throughout the dilution series, which likely reflects the compositional bias associated with this library preparation procedure . overall, our current work suggests that satisfactory assembly quality can be achieved using the nextera xt kit down to  <dig> picograms of input dna with little effect on downstream analyses such as extracting genomes from metagenomes . high quality assemblies are often a prerequisite for meaningful functional annotation, as annotation based on either short reads or many short contigs will likely result in fragmented gene predictions or may fail proper annotation altogether. therefore, based on our current work, the nextera xt protocol produces high quality, low input metagenomic libraries at extremely low inputs suitable for a variety of downstream analyses.

CONCLUSIONS
the motivation behind our current work was to determine the lower limits of metagenomic library preparation protocols and to assess which library prep performed best down to single picogram dna input levels. we show that despite the typical biases associated with the pcr enrichment step, high quality metagenomic libraries can be produced at low picogram levels, although more dna is desirable to minimize the risk of contamination and maximize the read and assembly quality metrics as discussed. of the three tested library preparation protocols, the nextera xt and mondrian protocols produced the highest quality libraries across all dilutions. from a production standpoint, the nextera xt library preparation kit is most amenable to a high throughput workflow, as it is a quick library preparation procedure that can be performed in 96-well format with limited hands-on time. this study lays the groundwork for the continued metagenomic exploration of low biomass ecosystems without the use of pre-enrichment steps such as mda. lastly, as the field of microbial genomics is moving towards the isolation and sequencing of microbial aggregates, microcolonies and/or single cells where mda has been a requirement to date, we are gradually transitioning to a new sequencing era where the output of as, ts, gs and cs will no longer be limited by the amount of starting material.

