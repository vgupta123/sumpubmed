BACKGROUND
in recent years, metabolic flux analysis  has become an important tool for quantifying metabolic pathways which is essential for in-depth understanding of biological systems. among the developed tools, 13c flux analysis utilizing 13c labeling patterns of metabolic products that result from feeding 13c-labeled substrates provides detailed information about intracellular pathway fluxes in vivo  <cit> 

13c-based mfa requires carbon flux modeling through the metabolic network, which describes the mathematical relationship between unknown fluxes and the available measurement data set. it requires modeling two connected equation systems, which describe reaction stoichiometry between metabolites and between carbon isotopomers, respectively. using the model, fluxes can be computed from the measurements by solving a nonlinear least-squares problem . the stoichiometric network is a linear equation system of material balances given for the reactions between metabolites, i.e., s·ν =  <dig> with s denoting the stoichiometric matrix and ν the fluxes. the fluxes consist of non-measured intracellular fluxes νu and measured effluxes νm, i.e., ν = t. typically, realistic models are underdetermined, that is, the rank of s is smaller than the number of entries in νu  <cit> . this difference between rank and the number of entries of νu equals the number of fluxes that have to be chosen as the design parameters Θ  and are required when parametrizing the network such that ν = fflux.

typically, modeling carbon isotopomer networks involves an equation system containing a few to several hundred variables to balance reactions between isotopomers  <cit> . the equation system of carbon isotopomer reactions is an implicit function fcarbon =  <dig>  bilinear but square with respect to carbon isotopomer fractions  and nonlinear with respect to fluxes, where x consists of non-measured xu and measured xm. among the available tools, the cumomer concept developed by wiechert et al.  provides explicit solutions for carbon isotopomer fractions  by transforming the bilinear system into a cascade of linear systems  <cit> . in addition to this, the explicit partial derivatives of the cumomer network with respect to fluxes are obtainable, which is useful for gradient-based optimization algorithms. when 13c labeling information is applied, intracellular fluxes are determined by means of numerical optimization that seeks a constrained minimum of independent flux variables  to an objective function, e.g.,

 min⁡Θ∈ℜmf=12)t⋅Ση−1⋅)subject to ν≥ <dig>  

here f denotes the objective function to be minimized with respect to Θ and f  signifies the model function corresponding to the measured data set η = t consisting of measured 13c labeling data . such data are typically received as mass isotopomer distributions measured by mass spectrometry  and/or fractional carbon labeling measured by nuclear magnetic resonance  techniques, and effluxes . the measurement error ε is typically assumed to have a normal distribution such that ε ∈ n, where Ση is the covariance matrix of measurements.

for 13c-based mfa, the applied algorithms for numerical flux estimation are mainly gradient-based local optimization  <cit>  or gradient-free global optimization  <cit>  such as simulated annealing  or genetic algorithms . also, a hybrid technique of global-local optimization has been applied  <cit> . such algorithms are described in detail elsewhere  <cit> . the stochastic global optimization methods can be inefficient due to the time required to obtain the so-called asymptotic convergence or reachability in high dimensional parameter spaces  <cit> . moreover, such algorithms of random nature may fail to find the global solution unless the number of samplings tends to infinity, which is practically impossible  <cit> . in comparison, the gradient-based local optimizations have a much higher convergence speed, but the solution quality depends heavily on starting points  <cit> . further to this, reaching the global optimum is ensured only for convex problems, whereas it is nontrivial to determine the convexity of general nonlinear problems with nonlinear constraints  <cit> . thus, one may obtain solutions that are not necessarily global  <cit>  and that might vary depending on starting points.

in this regard, a robust method is highly desirable which guarantees a convergence with speed and accuracy for the nonlinear flux estimation problem. in the present work, we developed a method for efficient parametrization of metabolic network by compactification. additionally, a mathematical method is suggested for model identification that solves a priori flux identifiability problems regarding 13c labeling experiments in terms of model linearization. on this basis, an optimization algorithm was developed that hybridizes two gradient-based optimization tools. the developed approaches were evaluated using the central metabolism of bacillus subtilis with succinate and glutamate feeding as the only carbon sources. we examined whether global flux solutions are obtainable using the gradient-based deterministic algorithm.

RESULTS
in this section, we describe the mathematical and computational procedures developed and their application to the nonlinear problem of metabolic flux estimation in a realistic metabolic network of bacillus subtilis. the model represents an inherent difficulty arising from only succinate and glutamate feeding as carbon sources. succinate is a symmetric molecule having only two distinguishable carbon atoms. on the other hand, glutamate is also converted into succinate. due to this, the information that is introduced by the 13c-labels of the substrates is severely limited.

parametrization of stoichiometric network
to formulate a non-linear least squares problem , the system of interest has to be parametrized. the stoichiometric network, which is a rank-deficient linear system , was parametrized using the following three steps.

step 
the stoichiometric matrix s is transformed into its reduced row echelon form srre using gauss-jordan elimination with partial pivoting. subsequently, each row and column of srre is analyzed to identify the dependent and independent variables. the first non-zero element in each row of srre that is always  <dig> is called 'leading 1'. if the ith column of srre contains only zeros and one leading  <dig>  then the ith element of ν is dependent, otherwise it is independent. the number of fluxes selected as independent equals the degrees of freedom in the stoichiometric network, that is, the difference between the number of variables and the rank of s. once this step has been completed, we will see that certain intracellular fluxes and all effluxes  are chosen as independent.

step 
physiologically, metabolic fluxes are constrained such that  <dig> ≤ ν < ∞, if reversible reactions are considered as two independent reactions. for the effluxes, the corresponding measurements are available. hence, the effluxes can be bounded, e.g., mean value ± χ <dig> φ <dig> × standard deviation, where χ <dig> φ <dig> denotes the inverse of χ2-cumulative distribution function at a certain confidence level of φ, and the resulting range covers  <dig> × φ % of possible experimental observations.

the intracellular fluxes selected as independent can be compactified using a single rule such that:

 ϕi=νiα+νiwith0≤νi<∞∧α>0⇒ϕi∈[ <dig>  1). 

the above compactified flux variables ϕ, the [ <dig>  1)-fluxes, are a bijection of [ <dig>  ∞) domain onto [ <dig>  1) range: if νi →  <dig>  ϕi →  <dig> and if νi → ∞, ϕi →  <dig> for a certain real positive number of the parameter scaling constant α. these [ <dig>  1)-fluxes can potentially elevate the output sensitivity and, thus, the convergence speed. the output sensitivities of a carbon flux system with respect to fluxes and [ <dig>  1)-fluxes are ∂xm/∂ν and ∂xm/∂ϕ, respectively, where the latter equals · by the chain rule. differentiating νi with respect to ϕi results in

 dνidϕi=α <dig> 

from . if α >  <dig> holds and, thus, dνi/dϕi >  <dig>  the sensitivity given by ∂xm/∂ϕ = · increases. particularly, a higher sensitivity can always be obtained by setting α ≥  <dig> due to finite values of fluxes, that is,  <dig> ≤ νi < ∞ or  <dig> ≤ ϕi <  <dig>  hence, setting the parameter scaling constant α ≥  <dig> is more preferable for numerical optimization than α >  <dig>  moreover, the mapping such as  has proven to yield an extremely low curvature of 13c labeling in the parameter space and is advantageous for model linearization  <cit> . the constant α can be adjusted during the optimization. this is described in detail in the appendix.

step 
by symbolically solving the equation system consisting of stoichiometric balances and flux constraints such as  for the dependent fluxes , we get explicit expressions for all dependent fluxes such that νdepend = fflux with Θ = t.

flux identifiability by model linearization
one important question to be answered prior to the numerical flux computation is the a priori parameter identifiability. to this end, the so-called buchberger's algorithm  <cit>  can be applied to compute the gröbner basis  <cit> . however, this polynomial algebraic method can be very time consuming and, thus, is restricted to small systems, corresponding to the fact that the gröbner basis can be extremely large for a metabolic carbon labeling system  <cit> .

in previous works  <cit> , the jacobian matrix of the measurement model has been utilized for model identification: the matrix determinant or rank were applied to the flux identifiability analysis in carbon labeling systems. however, these approaches do not tell how to sort out identifiable flux variables in case not all fluxes are identifiable.

as an alternative, the first order optimality condition and null space analysis can be applied to model identification. for this purpose, the linear algebra approach is now extended to answer the question of the a priori flux identifiability problem regarding 13c isotopomer analysis, which begins with model linearization. at the solution of the nonlinear problem , the gradient ∇f is expected to be  <dig> by the first order optimality condition, as in:

 ∇f=jt⋅Ση−1⋅−η)= <dig>  

here, j represents the jacobian matrix that equals ∂f/∂Θ evaluated at Θ^. assuming that the parameter estimate Θ^ is close to its true value Θ^, the above equation can linearly be approximated in the neighborhood of Θ^ by the first-order taylor series expansion such that:

 jt⋅Ση−1⋅+j⋅ΔΘ^−η)= <dig>  

solving the above equation for ΔΘ^ gives the particular solution of  as follows:

 ΔΘ^=t⋅Ση−1⋅j)−1⋅jt⋅Ση−1⋅). 

assuming that the above linearization is a good approximation in the vicinity of solution, the a priori identification problem can be answered using linear system theory, similarly as applied for stoichiometric metabolite balancing  <cit> . the theory is now extended to the linearized carbon labeling system: the general solution of  can be formulated as a linear combination of the particular solution  with its homogeneous part, i.e.,

 ΔΘ^=t⋅Ση−1⋅j)−1⋅jt⋅Ση−1⋅)+null)⋅β. 

here, null) is the null space of j and β is a vector containing arbitrary non-zero values. the ith element of the search step ΔΘ^ whose corresponding row of null) consists of zeros can be determined uniquely from the measurement η. thus, the unique solution of the corresponding ith design parameter can be computed numerically.

hybrid optimization algorithm
due to the parametrization introduced above, the flux estimation problem  can now be formulated such that:

 min⁡Θfsubject to{νdepend≥00≤ϕi<1max⁡≤νm≤χ <dig> φ2σm, 

where f denotes the objective function specified in  and Θ = t the design parameter vector consisting of the [ <dig>  1)-fluxes ϕi. the effluxes νm comprise substrate uptake as well as product and biomass formation with known standard deviation σm, and νdepend corresponds to all unknown intracellular fluxes.

to solve the above constrained nlsp, we developed a logical algorithm  that interactively hybridizes two gradient-based local optimization methods, that is, the sequential quadratic programming   <cit>  and the subspace trust-region method based on the interior-reflective newton method   <cit> . the developed method performs a series of sub-optimization trials by interactively switching between sqp and strin using the following features.

analytical gradient and hessian
typically, a gradient-based optimization problem is solved more accurately and with higher efficiency when analytical gradients are provided compared to numerical gradients, which are calculated by finite-difference approximation. by providing the analytical jacobian matrix consisting of ∂xm/∂ϕ and ∂νm/∂Θ, the gradient of the objective function formulated in  of the appendix can be calculated. the analytical hessian  is calculated when strin is used. in comparison to this, sqp updates the hessian using the broyden-fletcher-goldfarb-shanno  formula based on linearization of the gradient  <cit> .

adjustment of tolerance and parameter scaling constant
usually, the tolerances placed on parameters or on the objective function which are utilized as termination criteria for numerical optimization cannot clearly be defined in advance. they depend on the errors associated with user-supplied data as well as output sensitivities. thus, tolerances are set rather empirically. here, we suggest a method to adjust tolerance values and find a proper value by repeatedly restarting optimization trials. the tolerance adjustment by the restart is implemented in the developed algorithm as shown in figure 1-e. due to this, the complete process consists of a series of sub-optimization trials. at each kth trials, tolerance values are adjusted.

further to this, the parameter scaling constant α is also adjusted during the optimization. as mentioned in the previous section, α ≥  <dig> is the preferable choice due to the finite values of metabolic fluxes. in practice, α is regulated to render the model's jacobian matrix into better condition. this is obviously advantageous for the gradient-based method, which typically involves matrix inversion to compute the search direction as shown by . the exact procedure how to adjust tolerance and the parameter scaling constant is described in the appendix.

hybridization
sqp represents the state-of-the-art for solving constrained nonlinear optimization problems. by introducing the lagrangian function, sqp solves a series of quadratic programming sub-problems, each involving the minimization of a quadratic approximation of the objective function subject to a linear approximation of the constraints. it shows its strength when solving problems with significant nonlinearity and from remote starting points  <cit> .

strin solves a nonlinear large problem by linear approximation and the method of preconditioned conjugate gradients. this algorithm is based on the trust-region algorithm, is computationally inexpensive, and provides rapid convergence in the vicinity of the solution. a downside of strin is that it accepts any direction of negative curvature, even when this direction gives an insignificant reduction in the objective function  <cit> 

the key concept of the developed algorithm is hybridizing the merits of these two optimization algorithms, i.e., the loose starting-point-dependency of sqp and the convergence speed of strin in the solution vicinity. during the optimization trails with the tolerance adjustment, we get a feasible point that may be a more suitable initial guess for the next trial. accordingly, we initiate a few trials under "relaxed" tolerance conditions using a robust algorithm that is less dependent on the quality of the initial points. subsequently, the local minima obtained can be tested by another algorithm whether it gives a significant improvement with a rapid convergence.

in this context, the hybridization is carried out as shown in the flow chart in figure  <dig>  the algorithm is forced to initiate within the feasible region by generating an arbitrary starting point Θ <dig> subject to the inequality constraint νdepend ≥  <dig> . this can be done by generating random numbers of design parameters within their bounds given by . for cases in which the random generation is expensive, e.g., when a design parameter has a very narrow range that satisfies the constraints, a deterministic method might be employed to get a starting point in the physically possible region. this is discussed in the appendix.

as soon as a feasible set of initial values is obtained, the optimization starts using the sqp algorithm under relaxed tolerance criteria . after a few successful trials, an upper limit  that schedules the initiation of strin is placed, e.g., half of the current objective function value, χ2ul = 1/ <dig> f, where Θ*k is the local minimizer isolated from the kth sub-optimization trial. afterwards, if the objective value f resulting from the current sqp trial  is smaller than χ2ul, the strin optimization is activated ; otherwise, the sqp is repeated. during the strin optimization, the progress of trials is monitored to prevent the non-reducing problem associated with the strin algorithm mentioned above. as a criterion of the progress check, the relative improvement of |f - f|/f can be measured at each strin termination. if the improvement is insignificant, i.e., less than a user-specified value , the strin receives penalty. in case a few successive trials show insignificant improvement, the algorithm sets a new upperlimit χ2ul and returns to the sqp optimization. for the restart, the tolerance of the previous sqp trial is reutilized. this prevents too large changes in tolerance, which can be caused by the strin trials with insignificant improvement.

as a termination criterion of the hybrid optimization, the changes in local optima are measured , e.g., the absolute value of the slope resulting from the linear regression of y = , f,...f)t with respect to x = t. if the absolute slope is less than a user-specified small value for a few further trials, the optimization can be terminated ultimately.

application to bacillus subtilis metabolic network
to evaluate the developed methods, a metabolic network of the wild type b.subtilis was constructed as shown in figure  <dig> based on the kyoto encyclopedia of genes and genomes  database specified for the strain. the network is composed of catabolic reactions of the central metabolism incorporating glycolysis/gluconeogenesis, pentose phosphate pathway, tca cycle, c3/c <dig> inter-conversion and anabolic reactions. all effluxes including the biomass yield yxs in figure  <dig> were assumed to be measured experimentally from a batch-cultivation on succinate and glutamate as carbon sources. all flux values specified in figure  <dig> are generated from arbitrary values of Θdefault and normalized by the glutamate uptake rate. note that each anabolic flux given in figure  <dig> is the product of yxs  and a value that specifies the precursor requirement for growth  adopted from literature data  <cit> . for bidirectional reactions, the fluxes in the gluconeogenetic direction were declared as forward.

parametrization
the metabolic network in figure  <dig> has  <dig> intracellular fluxes ,  <dig> effluxes, and  <dig> anabolic fluxes expressed in terms of yxs. for  <dig> intracellular metabolites defined in the network,  <dig> flux balances were set up that are linearly independent of each other . the stoichiometric matrix s was obtained by symbolic differentiation of the balances with respect to the whole fluxes including yxs. when considering that the flux of glutamate uptake is unity due to the normalization, the network owns  <dig> degrees of freedom. accordingly,  <dig> intracellular fluxes ν2r, ν3r, ν4r, ν5r, ν6r, ν7r, ν8r, ν <dig>  ν14r, ν15r, ν <dig>  ν17r,  <dig> effluxes, and yxs were recognized as independent variables from the reduced row echelon form srre of s. these independent intracellular fluxes were transformed into [ <dig>  1)-fluxes as given by . note that the counterpart of a backward flux of a bidirectional reaction can also be selected as an independent variable. this just depends on how to arrange the entries in the flux vector. for instance, when ν2r is followed by ν <dig> in the flux vector, ν <dig> will be recognized as an independent variable instead of ν2r.

solving the equation system of the flux balances  and the [ <dig>  1)-flux equations for the dependent fluxes gives their explicit analytical expressions with respect to design parameters, i.e., νi = nflux with  <dig> design parameters of Θ = t. the parameters pco <dig>  and pco <dig>  estimate the co <dig> labeling pattern for each 13c labeling experiment: co <dig> has only one carbon and is incorporated into other metabolites by carboxylation. thus, its labeling state can simply be determined from other 13c labeling data as an additional parameter of nlsp in case it is not measured.

for flux re-estimation studies, the default values of the design parameter were Θdefault =  at α =  <dig>  which results in the flux values given in figure  <dig> 

model identification
for the identifiability studies, the main question was whether Θ has one unique solution set that can be estimated from the available mass isotopomer measurements in terms of the gradient-based optimization. the effluxes  and yxs are excluded for the identifiability analysis because they can be estimated as long as the corresponding measurements are available. to examine various flux scenarios,  <dig> stochastic simulations were performed for each of the  <dig> possible 13c-experimental designs. to this end, uniform random numbers between  <dig> and  <dig>  were created for Θ. at each simulation the null space of j was calculated.

according to the stochastic simulations, none of the designs had an empty null space and the entry of null) corresponding to ϕ2r was always non-zero disregarding the flux state and designs. most designs, including the design considered here, yielded an identical null space of:

 null) = t. 

accordingly, the design parameter ϕ2r is not expected to have a unique solution, i.e., it has infinitively many solutions. except ν <dig> and ν2r, other fluxes were not functions of ϕ2r. this means that the bidirectional glucose 6-p isomerase cannot be determined from any 13c substrates or dual substrate combinations. only the net flux of the reaction can be calculated from the stoichiometry. therefore, one can either regard the glucose 6-p isomerase as a unidirectional reaction or set ϕ <dig> as an arbitrary constant. this renders the carbon flux network to have an empty null space of j, i.e., full rank for j, and all other design parameters are theoretically expected to have unique solutions. this theoretical expectation is examined later using the developed algorithm.

hybrid optimization with tolerance adjustment
to evaluate the efficiency of the developed optimization algorithm, the flux values calculated in advance were re-estimated numerically from the carbon mass isotopomer distributions  of output metabolites matching the default flux values . to this end, the default flux values, depicted in figure  <dig>  were calculated by the flux function fflux obtained by parametrization. subsequently, the 13c labeling data of output metabolites were calculated from νdefault and Θdefault. the default fluxes were re-estimated by solving the constrained nlsp  whose inputs  were the effluxes, yxs, and the mdvs.

prior to testing the hybrid optimization with tolerance adjustment , we examined whether the tolerance adjustment is beneficial for optimization. this was checked by performing the sqp optimization by providing the gradients for the objective function and for the flux inequality constraints t) analytically. as shown in figure 3-a, the objective function value f of each optimization trial decreased with respect to tolerance adjusted at each optimization restart. it was observed that f <f always holds when starting the kth trial from the th local minimizer Θ*k- <dig>  restarting the failed th trial from the feasible iterate Θ° recorded for the smallest function value up to the current trial and increasing the tolerance was observed to give the same result, i.e., f <f. the efficiency of tolerance adjustment was further compared to the sqp optimization carried out at a constant tolerance of  <dig> × 10- <dig> . the sqp using the tolerance adjustment was observed to be more efficient in accuracy but more time-consuming than the case without adjusting. the sqp without adjustment reached a local minimum of around 10- <dig> much more rapidly but did not result in any further improvement, whereas the sqp with adjustment made slower but continuous progression. this gives an idea that the tolerance adjustment strategy might be useful to escape from possible local stationary regions and to achieve a lower minimum.

using the tolerance adjustment, the hybrid algorithm consisting of sqp and strin  was compared with its parent algorithms and two global optimization methods. all optimizations except the genetic algorithm  were initiated from an identical starting point for the numerical flux re-estimation. the ga applied does not need an external initial value set. at each initiation of the hata trials, α was updated by choosing an integer between  <dig> and  <dig> that yields the best-conditioned jacobian matrix of the model as mentioned previously. as shown in figure 4-a, hata accomplished the re-estimation with the best efficiency regarding its accuracy and speed. it took about  <dig> seconds until the objective function became 10- <dig>  the sqp optimization with analytical gradient  yielded the next satisfactory result. in comparison, the sqp optimization using the numerical gradient obtained by the finite difference  resulted in a poorer progress and was much slower and less accurate than hata or sqp ∇user. during the optimization using sqp ∇finite, we observed a discrepancy between the gradient obtained by the finite difference and the analytical approach . the inaccuracy of the finite difference seemed to cause the poorer result of sqp ∇finite.

the worst algorithm among the local methods was the strin using analytical gradient and hessian . it was rapid at the beginning but improved the objective only from  <dig> to  <dig>  afterwards, the optimization crashed with the carbon labeling system becoming completely singular. as previously mentioned, this seems to be due to the strin limitation of accepting any direction of negative curvature even if it does not give significant reduction in the objective function. also, the global optimization methods tested, which were the ga and the sa, were notably time-inefficient compared to the local methods. for  <dig> seconds of optimization time, the objective function was very slowly decreased by two orders of magnitude only. sa decreased f only to  <dig> ×  <dig> after  <dig>  hours and ga to  <dig> ×  <dig> after  <dig>  hours. thus, global optimization is expected to demand much greater time to get the equivalent result as hata.

hata optimization from different starting points
the flux re-estimation was also performed from  <dig> different starting points created randomly and by simultaneously generating uniform random numbers for the [ <dig>  1)-flux ϕ2r = ν2r/. this was to examine whether the quality and speed of convergence has any starting-point-dependency and whether ϕ2r, which a priori expected to have infinite solutions, has any influence on optimization results.

all  <dig> optimization runs using the hybrid algorithm were terminated successfully. on average, hata required  <dig>  ±  <dig>  min to converge to a weighted objective function value smaller than  <dig> × 10- <dig>  which equals the non-weighted sum of squares less than  <dig> × 10- <dig>  as shown in figure 4-a,  <dig>  % of the flux re-estimations were completed within  <dig> min and about  <dig> % in less than  <dig> min.

further to this, the flux re-estimates resulting from the  <dig> random simulations were compared with the true flux solutions calculated from Θdefault in advance. as shown in figure 5-a, all fluxes except the flux pairs of transketolase  <dig>  and transaldolase  could be re-estimated correctly. when plotting the flux re-estimates versus the true flux values given in figure  <dig>  the data points except ν <dig>  ν3r, ν <dig>  and ν4r lie exactly on a line with a slope of  <dig> . in comparison to this, only the net fluxes of the tk <dig>  and ta  reactions could be recalculated properly: the net fluxes could be calculated from stoichiometric relations with other flux re-estimates. the same was observed for the net flux of glucose 6-p isomerase, of which [ <dig>  1)-flux ϕ2r had an arbitrary value at each simulation run.

by the null space investigation  based on , the design parameters ϕ3r and ϕ4r were not expected to be correlated. in accordance with this, the fluxes could rarely be re-fitted in case one or both of these parameters were set arbitrarily. this indicates that the parameters ϕ3r and ϕ4r have a certain significant correlation that must be fulfilled at termination to yield unique solutions for other fluxes. as expected, the flux estimates of tk <dig> and those of ta were found to be nonlinearly correlated with each other as depicted in figure 5-b for ν3r and ν4r. the true solution,  =  also lies on the curve. at the termination, it is obvious that the output sensitivities of ∂xm/∂ϕ3r and ∂xm/∂ϕ4r are low: the objective function reached a very small value of nearly zero  <  <dig> × 10-10) and we get arbitrary but correlated values for ϕ3r and ϕ4r. due to this, we cannot practically get ϕ3r and ϕ4r estimated correctly and, accordingly, ν <dig>  ν3r, ν <dig>  and ν4r, while the corresponding net fluxes can always be calculated from other correct flux estimates in terms of stoichiometry.

we observed that a unique estimation of all four fluxes would be possible only if the mass isotopomers of sedoheptulose 7-phosphate were additionally measured. it was observed that providing these mass isotopomers renders the output sensitivities of ∂xm/∂ϕ3r and ∂xm/∂ϕ4r much less dependent on starting points. in contrast, the output sensitivities vary strongly and even become zero when the mass isotopomers of sedoheptulose 7-phosphate are not involved in the objective.

further to this, the fluxes were not found to be influenced by the glucose 6-phosphate isomerase fluxes represented by ϕ2r. disregarding the random values of ϕ2r, the fluxes except ν <dig>  ν3r, ν <dig>  and ν4r converged to their true values. also ϕ3r and ϕ 4r did not show any correlation with ϕ2r as depicted in figure 5-c and figure 5-d, respectively. hence, we can conclude that the observed nonlinear correlation between ϕ3r and ϕ4r becomes visible solely from using the different starting points for the optimization. in addition, including ϕ2r as an additional design parameter gives the same result for the fluxes, whereas ϕ2r results in randomly distributed values without any obvious pattern. this shows that the flux identification carried out by the model linearization and null space investigation is appropriate for its practical use.

discussion
the tradeoff between robustness and convergence speed is a central issue in numerical optimization  <cit> . the developed method fulfills both criteria and enables exact metabolic flux estimation. this was accomplished on the basis of parametrizing the metabolic flux network by compactification and hybridizing the merits of two different gradient-based algorithms. interestingly, hata, which hybridizes the worst local method with sqp ∇user and utilizes the tolerance adjustment strategy, has proven to be superior to other approaches. this may be by virtue of providing strin with a more appropriate starting point advanced by sqp. thus, because strin is computationally inexpensive and rapid in the vicinity of solution, it achieves a fast convergence. furthermore, the interactive switching between the algorithms prevents strin from accepting an unfavorable search direction without significant objective improvement.

further to this, we observed that the parametrization by the compactification of independent [ <dig>  ∞)-fluxes into [ <dig>  1)-variables is advantageous compared to the non-compactified case. when the optimization was performed by selecting the [ <dig>  ∞)-fluxes  directly as design parameters, the convergence took drastically longer  than the cases using the compactified fluxes. moreover, optimization runs often failed to converge or terminated at suboptimal points. in comparison to this, introducing [ <dig>  1)-fluxes improved both the robustness and speed of convergence as demonstrated above. the same advantage is probably achieved when using the [ <dig>  1)-compactifications such as exchange fluxes or flux partitioning ratios applied elsewhere  <cit> . our compactification approach allows a straight parametrization because independent fluxes can easily be recognized from the stoichiometric matrix and compactified using a single rule of . moreover, it is straightforwardly differentiable when considering that compactified [ <dig>  1)-fluxes are continuous and smooth in the [ <dig>  ∞)-flux space and vice versa.

the parameter scaling constant α introduced during the compactification provides a way to implement numerical flux estimation with efficiency. in particular, the parameter scaling constant α is updated during optimization to render the model's jacobian matrix into better condition. this is advantageous for the gradient-based methods for computing the search direction because it typically involves the inverse of the jacobian matrix as given by . we examined whether different α values affect the efficiency of optimization. the α value was observed to affect the convergence speed but not the accuracy of the optimization. when starting from the same initial guess applied to the optimization trial in figure  <dig>  the fastest convergence speed was obtained when α is fixed at  <dig>  < 10-14). the speed efficiency decreased if α is smaller or larger than  <dig>  a trial with α adjustment initiated at α =  <dig> automatically updated α to  <dig> after a few sub-optimization trials and took about  <dig> s to achieve f < 10- <dig>  although it was slower than when α was fixed at  <dig>  the proposed strategy with α adjustment recognized the optimal value. among the  <dig> hata optimization runs with α adjusting between  <dig> and  <dig> initialized with α =  <dig>   <dig> cases updated α to  <dig> after a few to several sub-optimization trials while α remained  <dig> in  <dig> cases. moreover, the time taken for the optimization runs using different starting points was not necessarily shorter when α was updated to  <dig>  this indicates that the most adequate α value for the optimization may depend on starting conditions.

we could find unique flux solutions except the fluxes recognized a priori as non-identifiable or those that were a posteriori found to have a significant nonlinear correlation. such nonlinear parameter correlation can be identified only by the tedious process of executing flux estimation using different sets of starting values a posteriori  <cit> . the non-correlated [ <dig>  1)-fluxes of which true values could be re-estimated, e.g., ϕ5r and ϕ6r, give a unique minimum of f, which is obviously achieved disregarding starting points . in comparison to this, the nonlinearly correlated [ <dig>  1)-fluxes ϕ3r and ϕ4r result in an infinite number of minima that meet the correlation shown in figure 5-b depending on starting points . because the objective function value is nearly zero at each minimum  <  <dig> × 10- <dig> with a weighting factor of 108), the system can be considered to have an infinite number of global minima when parameters are nonlinearly correlated. in this case, a global optimization method can be extremely expensive for identifying such unknown parameter correlations due to its time-inefficiency. as a consequence, a fast and reliable numerical method of flux estimation is highly desirable to repeat optimization runs at different starting points.

one interest of numerical optimization is whether the global solution can be obtained by the algorithm applied. we observed that the local minimizers from  <dig> random simulations agreed with each other and also with the true flux values, the global solution. depending on experimental noise or metabolic state, the problem may contain a few to several local saddle points. in this case, one can consider a further hybridization with a global optimization approach. global optimization algorithms are inefficient in terms of convergence speed. on the other hand, gradient-based algorithms can converge rapidly but lack a global perspective for non-convex problems. also in other cases, the combination of global and local search procedures has proven to offer the advantages of both methods while offsetting their disadvantages  <cit> . such hybridization with a global optimization algorithm is useful for non-convex problems containing several local minima and can be done in many ways  <cit> . for instance, the local minima obtained from a gradient-based method can be used to update the individuals in the population to prepare the next generation when combining with the ga  <cit> . because we could prove the speed and accuracy of the developed optimization method, we consider it very useful for investigating metabolic fluxes and for developing efficient algorithms combined with a global optimization method.

in practice, the quality of the flux fitting can be judged by the χ2-test  <cit>  when using noisy measurement data. in our case, the upper critical χ <dig> limit is  <dig> at  <dig> % confidence level at the given degree of freedom of  <dig> . hence, if the weighted objective value  is smaller than the critical value of  <dig> , the fit can be regarded as acceptable. this value can also be used as a termination criterion for the optimization control in figure 1-e. as shown in figure 4-a, the value was achieved at  <dig> s by hata, at  <dig> s by sqp with ∇user, and at  <dig> s of optimization time by sqp with ∇finite. in comparison to this, ga or sa was expected to achieve the acceptable f after 7- <dig> hours or more with respect to optimization time). hence, an efficient monte carlo simulation cannot be carried out by the global optimization approaches.

further, we compared hata with sqp with ∇user by conducting  <dig> stochastic simulations under identical conditions. at each simulation run, normal random numbers were generated for the experimental data set  by assuming a unit standard deviation of  <dig> × 10- <dig> and uniform random numbers for the starting points of design parameters. subsequently, parameter re-estimation was performed in terms of hata and sqp with ∇user, respectively. each optimization run was stopped if f becomes smaller than the critical χ <dig> limit of  <dig> or does not give any further improvement. on average, f at termination was  <dig> ±  <dig> for hata and  <dig> ±  <dig> for sqp with ∇user, and the time taken for the optimization was  <dig> ±  <dig> s for hata and  <dig> ±  <dig> s for sqp with ∇ user. the results support that the developed hybrid algorithm using tolerance adjustment will be more efficient and robust when computing metabolic fluxes from noisy experimental data in a real-case application. in contrast, the efficiency of the sqp algorithm seems to be affected by initial conditions  when considering the large variation in f as well as in the computation time. in this regard, hata will also achieve the most efficient optimization in the practical sense whenever repeated optimization runs are necessary. a further reduction in computation time can be obtained by utilizing a minimal set of isotopomer balances described by antoniewicz et al.   <cit> .

CONCLUSIONS
we developed and examined a developed hybrid algorithm for numerical 13c flux estimation using a metabolic network model parametrized using a single compactification rule. we could prove its practical usefulness using the central metabolic network of bacillus subtilis, which is a prokaryotic model organism and an industrially relevant strain. based on the parametrization by compactification and model identification, the hybrid algorithm with tolerance adjustment allowed a fast and robust flux computation from the 13c labeling data created from 13c-labeled succinate and glutamate feeding. such fast optimization was also found to be essential for the a posteriori identification of possible parameter correlations and also for the monte carlo approach to obtain statistical qualities for metabolic flux estimates. therefore, this work represents an important contribution to the quantitative study of metabolic networks in the framework of systems biology.

