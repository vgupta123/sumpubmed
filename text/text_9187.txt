BACKGROUND
quantitative polymerase chain reaction, qpcr, has become a common tool of molecular biology to determine the absolute or relative concentrations of particular dna sequences in samples. the method gives fluorescent values for each of a number of consecutive cycles beginning with cycle  <dig>  before cycle  <dig> the initial concentration of double-stranded dna target sequence is t <dig> and its concentration is amplified in successive cycles to produce a high concentration of the target sequence. at each cycle, the efficiency of amplification  is the ratio of the amount of newly synthesized target at the end of the cycle to the amount present at the beginning, thus the amount of target at the end of the cycle is  times the amount at the beginning. if every single-stranded target molecule re-associates with exactly one primer molecule and all these structures are extended by polymerase to completely synthesize the complementary target strand, the value of e is  <dig>  which is its theoretical upper limit. the increase in dna concentration is monitored by a detection system which generates fluorescence in proportion to the concentration of target dna sequence. several different types of detection systems are in common usage that generate fluorescence through different types of reactions. i present here two models of qpcr for use when the detection systems uses dna binding dyes such as sybr green or syto- <dig>  during early cycles of the amplification, the concentration of target is too small to produce measurable fluorescence and is called the lag phase . during lag phase the concentration of target sequence increases by  fold in every cycle, but the initial concentration of the double-stranded target sequence  is so small that even with repeated increases of  fold in every cycle the target concentration is not high enough to be measurable. thus, no information on e can be obtained from the amplification curve during lag phase. when target is present in quantities sufficient to be measured, the increase in fluorescence is approximately exponential over a number of successive cycles and the reaction is said to be in the exponential phase . fluorescence values during the exponential phase may be used to estimate e and most models of qpcr use only this part of the curve to estimate e and then assume the estimated value applies throughout the lag phase as well. after exponential phase, the efficiency progressively declines due to changes in the concentrations of reactants. eventually the reaction enters stationary phase, during which e approaches zero and increases in fluorescence are minimal .
.

models of qpcr assume total fluorescence, f, is due to two sources: baseline fluorescence, bf, and target fluorescence, tf, thus total fluorescence is f = bf + tf. baseline fluorescence is due to all sources other than target and is assumed to be constant throughout the qpcr experiment. target fluorescence is generated by reaction of the detection system with target sequences and is generated in proportion to target concentration. thus, tf = kft where t is the concentration of the double-stranded target and kf is a constant that converts the target concentration to fluorescence. total fluorescence at the end of the nth cycle is:

  fn=bf+kftn 

where tn is target concentration at the end of the reassociation/extension step of cycle n. at the beginning of the nth cycle, target dna is present at concentration tn- <dig> and is replicated with amplification efficiency en. target concentration at the end of cycle n is then: tn=tn−11+en

which has the solution:

  tn=t0∏i=1n1+ein= <dig> , <dig> … 

since tfn=kftn then tfn=tf0∏i=1n1+ei and

  fn=bf+tf0∏i=1n1+ein= <dig> , <dig> … 

where tf <dig> is the amount of fluorescence that could be produced by the target sequence before cycle  <dig>  values of en are defined as en=tntn−1− <dig> for n =  <dig>   <dig>  . . . and if equation  <dig> holds then en may be estimated from the observed fluorescence values as:

  en=fn−bffn−1−bf−1forn= <dig> , <dig> .. 

equation  <dig> is useful when fn can be reliably distinguished from bf, which is possible only during exponential phase and later. models of qpcr describe how en changes with n and use equation  <dig> to determine the target concentration or equation  <dig> to determine target fluorescence at each step of the process. some models of qpcr model tfn instead of tn and thus use the estimate of tf <dig> instead of t <dig> <cit> . the estimated tf <dig> values can be converted to t <dig> by dividing by kf when a value for kf is available. the primary goal in analysis of qpcr data is to estimate t <dig> or tf <dig> from the qpcr curve as accurately as possible. frequently, two or more qpcr curves are analyzed with a goal of determining the value of the ratio of two t <dig> values when kf is not known. the ratio of two t <dig> values is estimated by the ratio of two tf <dig> values provided kf values are the same in the two qpcr experiments. this principle is often used in qpcr analyses to compare two or more samples by estimating the ratio of two t <dig> values by the ratio of two estimated tf <dig> values  <cit> .

numerous approaches to modeling the qpcr process are present in recent literature and involve three different general approaches. first the ct and linear regression approaches assume constant efficiency and estimate it by linear regression of ln on cycle number using only values from the exponential phase of the curve   <cit>  . second, the sigmoidal function approach has used to fit a variety of sigmoidal functions to approximate the qpcr curve  and estimate tf <dig> as the intercept of a sigmoidal function  <cit> . the sigmoidal functions used are described in the literature and none are based on a mechanistic model of the reactions in qpcr. thirdly, kinetic models are a mechanistic approach to modeling the process and several such models have been proposed  <cit> . the work i present here extends the kinetic approach to modeling qpcr by including primer concentration in the model and providing analytical equilibrium solutions for the re-association phase. i also introduce the use of simultaneous analysis of qpcr curves which have common values for rate constants in the kinetic models.

current models
the models presented here may be regarded as an extension of the models presented by smith et. al.   <cit>  and boggy and woolf   <cit> . though the models presented here are similar to those of smith et. al.   <cit>  for hydrolysis probe detection systems, they differ in that they are designed for intercalating dye detection systems such as sybr green. they also use analytical solutions for equilibrium concentrations in the annealing step. one of the models is the same as that of boggy and woolf   <cit> , however, a more general solution for equilibrium values for the annealing step is presented here that includes primer concentration and gives improved fit to data. two stepwise kinetic equilibrium models are presented in which efficiency of amplification at each cycle depends on the concentrations of target and primers at that cycle. events in a single cycle are modeled and then used in iterations to model the entire process. in each cycle, the re-association and the primer extension steps are modeled separately and consecutively. double-stranded target dna is denoted a1a <dig> where a <dig> and a <dig> are complementary single strands. primer that hybridizes with a <dig> is denoted a <dig> and primer for a <dig> is denoted a <dig>  primer-template hybrid molecules are denoted a1-a <dig> and a <dig> -a <dig>  respectively.

re-association step
at the end of the dissociation step of cycle n, the concentration of all double-stranded structures is zero and concentrations of single-stranded molecules a <dig>  a <dig>  a <dig>  a <dig> are s1n, <dig>  s2n, <dig>  p1n, <dig> and p2n, <dig>  respectively, with units of concentration being moles/liter. at the end of the re-association step, the concentrations of a <dig>  a <dig>  a <dig>  a <dig>  a1-a1a2-a <dig> and a1-a <dig> are assumed to be at their equilibrium values s1n,e, s2n,e, p1n,e, p2n,e, q1n,e, q2n,e, and dn,e, respectively. two different kinetic models are each used to obtain these equilibrium concentrations as a function of the initial concentrations s1n, <dig>  s2n, <dig>  p1n, <dig> and p2n, <dig>  the initial target is entirely double-stranded at the beginning of cycle  <dig>  so the two complementary target strands, a <dig> and a <dig>  are initially present in equal concentrations. primers, a <dig> and a <dig> are assumed to be present in equal concentrations at the beginning of cycle  <dig>  equally effective in forming double-stranded structure with the target sequences, and equally effective in initiating synthesis with the polymerase. under these assumptions, s1n,e = s2n,e = sn,e, p1n,e = p2n,e = pn,e, and q1n,e = q2n,e = qn,e for all n .

model  <dig> reversible re-association
reversible dissociation/re-association reactions and rate constants are shown in figure 2a. formation of a1-a1a2-a <dig> and a1-a <dig> from a <dig>  a <dig>  a <dig>  a <dig> during the re-association step is assumed to follow the law of mass action and described by the rate equations given in figure 2b. at equilibrium, all net rates are zero and equilibrium values of the state variables sn,e, pn,e, qn,e and dn,e and are found as the simultaneous solution of equations in figure 2b when each equation is set equal to zero. through a series of substitutions and rearrangements of these equations , a cubic polynomial in sn,e is obtained with coefficients containing only rate constants and initial concentrations sn, <dig> and pn, <dig> and is given as equation a <dig>  in additional file  <dig>  the relevant root of the cubic equation is found using the cubic formula given in equation a <dig>  of additional file  <dig> and equilibrium values for the remaining state variables may be found by substituting the value of sn,e into equations also given in additional file  <dig>  thus sn,e, pn,e, qn,e and dn,e are expressed as a known function of the rate constants ka <dig>  kd <dig>  ka, and kd and the initial concentrations sn, <dig> and pn, <dig> 

model  <dig> non-reversible re-association
non-reversible re-association reactions and rate constants are shown in figure 3a. reactions are again assumed to follow the law of mass action and rate equations are given in figure 3b. at equilibrium, all net rates are zero; however, equilibrium values of the state variables sn,e, pn,e cannot be found as the simultaneous solution of equations in figure 3b when set equal to zero. since ka >  <dig>  ka12 >  <dig>  pn ≥ <dig> and sn ≥ <dig> then sn,e =  <dig> is the only possible equilibrium solution and with sn,e =  <dig>  any value of pn will satisfy the equilibrium equations. this result is also expected on purely scientific grounds as annealing without dissociation will always eventually reduce the single strand template concentration to a concentration of zero. the equilibrium value, pn,e, is found by expressing the rate of change in pn as a function of sn and then integrating over sn as it goes from sn, <dig> to zero. the solutions for pn,e, qn,e and dn,e are given as equations a <dig> , a <dig>  and a <dig> , respectively, in additional file  <dig> which are all known functions of ka, ka <dig>  sn, <dig> and pn, <dig> .

extension step
the proportion of target/primer duplexes a1-a <dig> and a2-a <dig> that produce full length products in the primer extension step depends on the concentration of the polymerase and the concentration of dntp’s. if both are in sufficiently high concentration the proportions will be near  <dig>  however, if either or both are sufficiently low the probabilities will be less than  <dig>  here it will be assumed there is always sufficient polymerase and dntp concentration to ensure complete extension of all primers in target/primer duplexes. with this assumption, at the beginning of the next cycle the concentrations of a <dig> and a <dig> are each given by equation  <dig>  and the concentrations of a <dig> and a <dig> are each given by equation  <dig> .

  sn+ <dig> =sn,0+qn,en= <dig> ,.. 

  pn+ <dig> =pn,0−qn,en= <dig> ,.. 

the whole process
the whole qpcr process is modeled by iteration of equations  <dig>  and  <dig>  with qn,e determined by equation a <dig>  for model  <dig> or equation a <dig>  for model  <dig> . before cycle  <dig>  the concentrations of single-stranded target and primer are s <dig>  and p <dig> , respectively. the efficiency of amplification for single stranded template at cycle n is - <dig> which may be obtained from equation  <dig>  as

  en=qn,esn,0n= <dig> , <dig> … 

and fluorescence at cycle n is found using equation  <dig> as

  fn=bf+kf2qn,e+dn,en= <dig> , <dig> … 

since equation  <dig> is defined only for n =  <dig> ,3… it cannot be used directly to obtain a value of tf <dig>  however, fitting equation  <dig> to an actual qpcr curve provides an estimate of s <dig>  which is the initial concentration of each of a <dig> and a <dig>  if the initial target sample is all double-stranded then s <dig>  is also the concentration of the double-stranded molecules, so t0 = s <dig> . defining tf <dig> as kfs <dig>  provides a measure of total initial target concentration in fluorescence units. this is the amount of fluorescence that would be due to the target if it is all double-stranded. if tf <dig> could actually be measured it would be kfdo,e where do,e is the concentration of double-stranded target dna before cycle  <dig>  most likely nearly all of the target is double-stranded before cycle  <dig> but, since the total amount of target is what is desired using kfs <dig>  as the estimate of tf <dig> is preferred.

relating model  <dig> to boggy & woolf 
model  <dig> annealing kinetics have been analyzed by boggy & woolf  <cit>  who give an approximate equilibrium solution for the re-association step and use it to obtain a recurrence formula for double stranded target concentration over successive cycles. their approximation is obtained by removing primer concentration from the model to obtain a simpler set of differential equations which they solve to get an approximate solution. i show in additional file  <dig> that my solution for model  <dig> becomes equivalent to theirs if kaka12−ka is small and their parameter k is set to kaka12−kapn,e. this result indicates the rate constant, k, for the approximate solution found by boggy & woolf  <cit>  depends on primer concentration and ignoring primer concentration in the analysis will cause at least some error in parameter estimates. boggy and woolf   <cit>  note that their parameter k varied from one analysis to another, a result they did not expect, and this is likely due to variations in the amount of primer available. this finding suggest the analysis for model  <dig> presented here is a more accurate solution for model  <dig> kinetics than that of boggy and woolf   <cit>  process since it includes variation in primer concentration.

restricting model fit to only part of the qpcr curve
since models  <dig> &  <dig> both include the effect of declining primer concentration during pcr they predict a different shape of the qpcr curve between lag and stationary phase for solutions that differ in primer concentration. consider two solutions, one with low s <dig>  and one with high s <dig>  and with identical primer concentrations. allow the one with low s <dig>  to undergo enough cycles so its current target concentration is equal to the initial target concentration for the solution with higher s <dig>  . if primer concentration is not limiting in any way then the two solutions would have identical qpcr curves from that point on. if primer concentration is limiting in some way then the qpcr curve for the solution with lower s <dig>  will at that point rise more slowly than that for the solution with higher s <dig>  due to lowered primer concentration. when fitting models  <dig> and  <dig> to data it is thus desirable to include as much of the exponential phase as possible to allow changing primer concentrations to affect the analysis. including most of the exponential phase is desired, however, in late exponential phase effects not included in the model also begin to occur and may cause the model to have poor fit. effects in late exponential phase not modeled include reduced amount of dntps, reduced amount of polymerase due to decay and possibly partially replicated templates. in order to restrict analyses to only part of the exponential phase, models were fit to qpcr curves for cycles in the lag and exponential phase for which / ≤ l, where bf, and fmax are baseline fluorescence and maximum fluorescence achieved in stationary phase. the value, l, is the proportion of increase of fn above bf and is a cut off value used to restrict the analysis to the first parts of the qpcr curve up to a point in the exponential phase where the model is thought to be valid. when choosing l, a compromise between these opposing effects is necessary and is done here by choosing the highest value for l that allows good fit to qpcr curves. to accomplish this, the models were fit to qpcr curves using a range of l values from  <dig>  to  <dig>  and the goodness of fit and estimated initial concentration determined for each l value. both model  <dig> and  <dig> generally gave poor fits for l ≥  <dig> . the value of  <dig>  was chosen for presentation here because the msresidual values for most qpcr curves increased for values of l higher than  <dig>  and also because the accuracy of estimates of initial target concentration was better for l values near  <dig> . the question of how much of the qpcr curve to use in analysis is a problem inherent to most methods used for interpretation of qpcr curves. boggy and woolf   <cit>  choose the point of maximal increase in fluorescence as their cut-off point for all curves which corresponds roughly to a value of  <dig>  for l. their rational for using only about half the exponential phase is that the effects of declining primer concentration are not likely to affect the shape of this part of the curve. the ct method uses a different cut-off for every curve which is invoked when the ‘window-of-linearity’ is chosen.

methods for incorporating experimental design into the data analysis
kinetic models of qpcr allow more sophisticated and powerful analyses than are possible with other models. if a group of solutions have exactly the same chemical components except for possibly differing in initial target concentration, then all the kinetic parameters should be the same for all the solutions. the rate constants may then be estimated by fitting several or many qpcr curves simultaneously to get better estimates of rate constants and initial target concentrations. in such fits the kinetic parameters are common to all the different qpcr curves in the analysis but each curve may have a unique value for initial target concentration. also kinetic models such those presented here allow an analyst to adjust the model to accommodate different experimental designs. i present four different estimation methods  which are used here to fit models to qpcr data which have different experimental designs.

standard curve method 
this method may be used only when the true initial target concentrations are known for each curve in the analysis . all initial conditions of the qpcr, other than initial target concentration are assumed to be the same for all curves. all curves are analyzed simultaneously in a non-linear fit in which the estimated rate constants apply to all curves and the initial target concentration is held constant at its known value for each curve. the fitting process minimizes the cost function over all cycles in all curves. the advantage of this method is that it pools the information of all the curves to give a single best estimate for each model parameter. the predicted fluorescence values provided by the analysis may be compared to the observed fluorescence values to assess how well each qpcr curve is fit by the model. the value of this method is that it may be used for estimation of initial target concentration for samples with unknown initial target concentration provided all other conditions of the pcr are the same as those used in the standard curve. this is done by doing a non-linear fit to the qpcr curve of the unknown sample in which only the initial target concentration, s <dig>  , is estimated while using the estimated parameters from the standard curve analysis as constants. to assess how well the models presented here estimate s <dig>  , each qpcr curve in the known samples was treated as an unknown sample and the estimated s <dig>  value compared to the known value for s <dig> .

dilution curve method 
this method may be used when a standard curve is not available but a dilution series of the unknown sample is available. here the absolute target concentration in the undiluted sample is unknown and denoted s <dig> ,max. the absolute target concentration of the ith diluted sample is dis <dig> ,max where di is the dilution ratio for the ith sample. the qpcr curves from the diluted samples are analyzed simultaneously using non-linear curve fitting. rate constants apply to all curves in the analysis and a single concentration parameter s <dig> ,max is estimated with the initial concentration for each sample set at dis <dig> ,max. in general usage of this method the estimated s <dig> ,max would be the end result. to assess the accuracy of this method in this study the known absolute target concentrations for the data sets used here are ignored but their ratios are used to obtain values for di. simultaneous fitting of all the curves was done as described above to estimate s <dig> ,max and all the rate constants. next the estimated rate constants are treated as constants in a second non-linear fit of each qpcr curve separately in which an s <dig>  value is estimated for qpcr curve. these estimated s <dig>  values are compared to the known values to assess the accuracy of method b.

simultaneous curves method 
this method may be used when two or more samples are to be analyzed that may have different initial concentrations and a standard curve is not available nor are any dilutions of either sample available. the samples are assumed to be subject to qpcr with identical conditions except for the fact they may have different initial target concentrations. in this method all samples are analyzed simultaneously with estimated rate constants applying to all samples, but each sample has a unique s <dig>  value to be estimated. to assess the accuracy of this method with the data sets analyzed here all information on initial target concentration is ignored and the estimated s <dig>  values for each sample is then compared to the known values.

separate curves method 
this method does not assume any similarity of rate constants among any of the samples and does not analyze samples simultaneously as methods a, b, and c do. each sample is analyzed separately with all parameters estimated independently for each qpcr curve. here the accuracy of method c is assessed by comparing the actual s <dig>  values to the estimated ones. this is the type of analysis that is conventionally done when analyzing qpcr curves.

methods
data sets
both models  <dig> and  <dig> were fit to two different data sets for which the actual initial concentrations of target are known. the model of boggy and woolf   <cit>  was also fit to the same data sets and is called model  <dig>  the data sets used are: 1) data of boggy and woolf   <cit> , 2) data of rutledge   <cit>  and are referred to as data set  <dig> and  <dig>  respectively. the data of boggy and woolf   <cit>  are for a  <dig> base pair synthetic target sequence with the following conditions for pcr: reaction vol =  <dig> μl, primer concentration =  <dig> nm each, detection system is syto- <dig> dye with concentration =  <dig> μm, dntp concentration =  <dig>  mm each. six different absolute target concentrations range from 5 ×  <dig> to 5 ×  <dig> molecules per reaction volume at  <dig> fold increments. the data of rutledge   <cit>  is for the  <dig> base pair k1/k <dig> target sequence with the following conditions for pcr: reaction vol =  <dig> μl, primer concentration =  <dig>  μm each, detection system is syber green dye. six different absolute target concentrations ranged from  <dig>  ×  <dig> to  <dig>  ×  <dig> molecules per reaction volume at  <dig> fold increments. data set  <dig> has  <dig> replicate qpcr curves for each target concentration and data set  <dig> has  <dig> replicates for each target concentration.

determining baseline fluorescence
before fitting a model the baseline fluorescence was determined for each qpcr curve by fitting the sigmoidal function given in equation  <dig> below.

  fn=bf+fmax−bf1+exp−n−c1/2ks 

the first term on the right side of equation  <dig> is the baseline fluorescence, bf . the second term is a modified sigmoidal function describing the increase in fluorescence due to polymerase chain reaction where fmax is the maximum fluorescence, c1/ <dig> is the cycle number at which fn is midway between bf and fmax, and ks is a scale parameter. parameters in equation  <dig> and bounds used in the non-linear estimation program are bf ≥  <dig>  fmax > bf , c1/2 >  <dig>  and ks >  <dig>  equation  <dig> is fit to each entire qpcr curve by nonlinear estimation of the parameters using least squares as the criterion for fit with the proc nlin procedure of the sas program version  <dig>   <cit> . each observation was weighted by the reciprocal of the observed fluorescence. the value of bf is estimated separately for each qpcr curve and then treated as a constant for that curve when estimating parameters of models  <dig>   <dig>  and  <dig>  in preliminary analyses for this study the baseline fluorescence was estimated as a parameter in the model with each qpcr curve having its own unique value. in the resulting fits some qpcr curves were found to have baseline values that were not consistent with the observed values in the lag phase. this is due to the estimation procedure selecting a baseline value that gives the best overall fit to the curve rather than just in the lag phase. ruijter et. al.   <cit>  have shown that baseline estimates can affect the quality of fit in the exponential phase for the ct method and this same effect is likely occurring in fits of the models here. they also point out inherent problems with estimating baseline fluorescence from a fixed number of points in early cycles. rutledge and stewart   <cit>  showed sigmoidal functions similar to equation  <dig> give very good fit to the observed values of qpcr curves. the use of the sigmoidal function given in equation  <dig> is found to always give values that fit well to data in the lag phase and is not affected much by peculiar changes in fluorescence often seen during the first few cycles.

estimation of model parameters
methods described here are used to determine how well each model explains the shape of each qpcr curve and also to determine how accurately each model estimates initial target concentration for each of the two data sets. each model,  <dig>   <dig> or  <dig>  was fit to qpcr data by nonlinear curve fitting with proc nlin of sas version  <dig>   <cit>  using the marquardt optimization method and the mean sum of squared differences between the observed and predicted fluorescence values  as the measure of goodness-of-fit. mean square residual  is a measure of how well a model explains the qpcr curve. a msresidual value near zero indicates a very good fit in which the model predicted values are all very close to the observed values and higher values indicate a poorer fit. up to  <dig>  iterations were used for each fit. the parameters estimated and bounds imposed during estimation are: s <dig>  >  <dig>  k >  <dig> for model  <dig>  s <dig>  >  <dig> , kf > <dig>  ks > kd <dig> > <dig> for model  <dig>  and s <dig>  > <dig> , kf > <dig> , and k > <dig> for model  <dig>  the initial concentrations of primers were set to the values reported by the authors providing the two data sets and expressed as nmoles/l. additional file  <dig> contains sas code that fits model  <dig> and  <dig> to a sample data set.

effect of varying l
to determine the effect of the choice of the value of l on the results of the analysis, the entire analysis was done separately for each of a range of values for l. specifically, each of the three models  was fit using each of the estimation methods  to each of the two data sets  for each of the l values of  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> . the msresidual and fold error for each fit were averaged over replicates  <dig> and  <dig> for each data set and the resulting means plotted versus l for each dilution separately.

effect of errors in estimation of baseline fluorescence
analyses were done to assess the effect of errors in the estimation of baseline fluorescence, bf, on the goodness of fit of the model and the estimated initial target concentration. the estimation procedure used to estimate bf provides the standard error of the estimated value. fits of the models and estimation of initial target concentration was done using bf values  <dig> and  <dig> standard deviation units above and below the estimated value. plots of the mean msresidual and fold error in estimation of initial target concentration versus the bf value used were used to assess the effect of errors in estimation of bf.

RESULTS
for each of the three models , each of four methods for parameter estimation were used for each data set. here every model and estimation method was used to fit the same data and msresidual is used to compare models and methods in their goodness of fit to the data. a value of msresidual was computed for every qpcr curve for each model and for each estimation method. plots of msresidual versus log <dig> are given in figure  <dig> for data set  <dig> and figure  <dig> for data set  <dig>  data set  <dig> has two replicate msresidual values for each target concentration and data set  <dig> has  <dig>  these figures show that for both data sets and for all  <dig> methods of estimation, models  <dig> and  <dig> are very similar in fit to qpcr curves and both give better fit than model  <dig>  the poorer fit for model  <dig> is always due to the predicted fluorescence being too high for low cycle numbers and too low for high cycle numbers. this pattern of lack of fit for model  <dig> is shown in figure  <dig> which shows the fits for each model and estimation method for the first replicate of the sample with 5* <dig> molecules in data set  <dig> and is representative of the fit found for all samples in both data sets. note that in figure  <dig>  models  <dig> and  <dig> fit the data well for all estimation methods  while model  <dig> gives poor fit with methods a and b, moderately good fit with method c, and good fit only with method d.

estimation of absolute target concentration
the estimates of initial target concentrations and the known initial target concentrations are denoted s <dig>  and t <dig>  respectively. plots of log <dig> vs log <dig> for each model and estimation method are given in figure  <dig> for data set  <dig> and figure  <dig> for data set  <dig>  here means are over replicates for each sample. figures  <dig> and  <dig> indicate all three models give s <dig>  values that have a good linear relation to the true values, t <dig>  for estimation methods a and b with both data sets. for estimation methods c and d the linear relation between s <dig>  and t <dig> holds well for all three models when applied to data set  <dig> ,however, for data set  <dig> model  <dig> and  <dig> are very linear, but model  <dig> gives non-linear results. the high linearity of these log-log plots is not a good indication of the accuracy of the estimation because the estimates can be linear but at the same time be biased. a measure of the accuracy of the estimation is the fold error, which is the ratio of the estimated value to the true value . fold error is computed for each model and estimation method and given in figure  <dig> for data set  <dig> and figure  <dig> for data set  <dig>  figures  <dig> and  <dig> show that for both data sets estimation methods a and b give similar results and model  <dig> gives more accurate estimation of t <dig> than the other two models. estimation method c generally gave less accurate estimates than methods a and b and model  <dig> performed best. when using estimation method d, again model  <dig> gave the most accurate estimates over both data sets and model  <dig> was the least accurate for both data sets.

effect of varying l
the plots of the mean ms residual vs l and mean log vs l for the samples with dilution factor  <dig>  in data set  <dig> are given in figures  <dig> and  <dig>  respectively. this plot as well as plots for all dilutions in both data set  <dig> and  <dig> are given in additional file  <dig>  the plots given in figures  <dig> and  <dig> were chosen because they show patterns which are representative of most of the plots given in additional file  <dig> 

effect of errors in estimation of baseline fluorescence
plots of mean msresidual and fold error in estimated initial target concentration versus baseline fluorescence for estimation methods a, b, and d are affected very little by variation in the value of bf used . when using estimation method c, the msresidual values were not affected much by variations in the bf but the initial target concentrations were over-estimated when using low values of bf. increases in fold error by a factor of up to  <dig> was found in some plots when a bf value two standard error units below the estimated value was used.

discussion
fit to qpcr curves
the two models presented here have both been shown to give good fit to the lag and exponential phase of qpcr curves over a wide range of initial target concentrations while using a single set of rate constants. the lack of fit of model  <dig> to qpcr curves seen in figures  <dig>   <dig> and  <dig> is likely to be due to the same cause as the variation in k values pointed out by boggy and woolf   <cit>  . the derivation of the boggy and woolf  <cit>  formula assumes their parameter k = ka/ka <dig> where ka and ka <dig> are the rate constants of model  <dig> . thus the same value of k should apply to all qpcr curves that are identical except for initial target concentration. i have shown that the parameter k of the boggy and woolf   <cit>  model is not constant but depends on the primer concentration during the pcr process. estimation methods a, b, and c force model  <dig> to use the same k value for all curves and thus each curve gives a poorer fit than it would if allowed to have a unique k value for each curve. these results suggest the boggy and woolf   <cit>  assumption that primer concentration is sufficiently large that it can be ignored is not met in these data sets.

estimation of t0
the results here indicate the best methods for estimation of target concentration in an unknown sample is to use a standard curve that has a range of values for initial target concentration or to use a dilution curve composed of a series of dilutions of the original sample and analyze the qpcr curve with estimation methods a and b, respectively. figures  <dig>   <dig>   <dig>   <dig>   <dig>  and  <dig> indicate these two methods  are essentially equivalent in their accuracy of estimation. note that with the dilution curve method, b, the absolute initial concentrations of target are estimated independently of the known values. only the dilution ratios are used in the simultaneous fit to the data. the best way to estimate target concentration of an unknown sample when a standard curve is not available is to make a series of dilutions of the sample and then apply qpcr to each dilution and use the dilution curve method described here to estimate the target concentration of the undiluted sample. the separate curves method, d, worked well for data set  <dig> for both models  <dig> and  <dig>  and worked moderately well only for model  <dig> for data set  <dig>  lastly, estimation method c gave good estimates for data set  <dig> but poorer estimates for data set  <dig>  more sources of data need to be studied to determine the suitability of estimation methods c and d with these models.

the poor fit of the boggy and woolf   <cit>  model to qpcr curves with estimation methods a, b, and c suggest it will give poorer estimates of initial target concentration than models giving good fit. estimation method d allows each curve to have unique parameter values and gives much better fit to qpcr curves when using model  <dig>  however, the accuracy of estimates is not as good as those for models  <dig> and  <dig>  the non-linearity of initial target concentration estimates for model  <dig> with method d using data set  <dig> as seen in figure  <dig> panels c and d data is different than the result reported by boggy and woolf   <cit>  who obtained a very linear relationship using method d. the reason for this difference is not clear but may be due to the fact that model fitting is done differently. boggy and woolf   <cit>  estimated baseline fluorescence as a parameter in the model. i estimate baseline fluorescence before fitting the model and treat it as a constant during model fitting. other minor differences in the programs used for fitting and the searching routine may have also caused some difference in the result.

effect of varying l
figures  <dig> and  <dig> as well as those given in additional file  <dig> indicate the effects of variation of l depend on the estimation method used and to a lesser extent on the concentration of initial target sequence. examination of the plots in additional file  <dig> indicate the effects of l can be variable but some general patterns are present which are shown in figures  <dig> and  <dig>  first, for all models, all methods and all dilutions, msresidual increases with increasing l. all the plots involve a log scale and show an approximate linear increase of msresidual with l indicating an underlying exponential increase of msresidual with l. thus when l has values of  <dig>  and higher the fits to qpcr curves are much worse than with lower values of l. secondly, the effect of l on the accuracy of the estimated initial target concentration depends strongly on the estimation method used. estimated target concentrations obtained with estimation methods a and b show remarkably little dependence on the value of l used for either of the data sets analyzed. there is a consistent trend for a slight over-estimation of target concentration for l values above  <dig>  with the amount of over-estimation increasing with increasing l. the dependency of the accuracy of estimation by methods c and d on l was more variable, however, both methods showed a patterns similar to that present in methods a and b, but more extreme over-estimation of initial target concentration when l values above  <dig>  are used. for these reasons the value of  <dig>  was used for l in the analyses presented here. though the use of l =  <dig>  gave good fits to qpcr curves and accurate estimates of initial target concentration, investigation of other methods for restricting analysis to only parts of the qpcr curve may be worthwhile.

effect of errors in estimation of baseline fluorescence
estimation methods a, b and d are robust to errors in baseline fluorescence. estimation method c is less robust to such errors.

general comments
the models presented here assume the annealing of single-stranded dna to double-stranded molecules reaches equilibrium at each cycle. this assumption may not be true, however, the ability of the present models to fit qpcr curves as well as they do suggests it may be approximately true. model  <dig> gave slightly better fits to qpcr curves and slightly better estimates of initial concentration than model  <dig> when estimation methods a and b were used. this result suggests the reversible reactions assumed in model  <dig>  may be a better model than the non-reversible reactions assumed in model  <dig> . it is thought the dissociation constant for double-stranded templates is so small that the annealing of templates is effectively non-reversible  <cit> . however, the annealing of primer and template may produce a much less stable double-stranded structure such that the reversible reaction model is more reasonable. a model in which template-template molecules are completely stable and primer-template molecules are not is not useful when considering equilibrium solutions, as equilibrium then occurs only when the concentration of primer-template molecule is zero. to use such a model, a non-equilibrium solution would need to be found. it is also possible that there is not enough time allowed during the experiments for the re-association reactions to reach equilibrium. whether or not dna re-association achieves equilibrium or not during pcr is not clear. smith et. al.   <cit>  offer some analysis suggesting that equilibrium does occur.

an advantage of the mechanistic approach to modeling qpcr curves is that models describe actual events of the process and thus may be expanded to include other effects that may improve accuracy. kinetic models naturally allow simultaneous estimates of common parameters which will increase accuracy. this is extremely difficult or impossible with other methods used for modeling qpcr. because the kinetic models account for variable efficiency by kinetic theory they may give better estimates of initial target concentration than other approaches. another advantage of kinetic models is that parameters of the model may be estimated by dedicated experiments distinct from the qpcr curve experiment. for example, the parameter kf present in both models  <dig> and  <dig> converts double-stranded dna concentration into amount of fluorescence for a particular experimental system. the value of kf could be determined in experiments separate from qpcr and then used as a constant in the analysis of a qpcr curve, thus increasing the accuracy of estimation of the kinetic parameters and target concentrations. lastly, kinetic models uniquely allow estimation of absolute initial concentrations of target sequence without use of a standard curve of any type. the accuracy of estimation with kinetic models is enhanced greatly by the use of a standard curve, but it is not required. in fact the dilution curve method gave fits essentially as good as the standard curve method. the mechanistic models developed here offer a more complete description of the amplification occurring in qpcr, fit observed data very well, and allow more accurate estimation of initial target concentration than other methods.

CONCLUSIONS
two stepwise kinetic equilibrium models of qpcr are presented and analytical solutions are given for equilibrium values during annealing of single stranded to double stranded molecules. the models are amenable to different types of non-linear fitting which include fitting several curves simultaneously when they have common parameter values. both models are shown to give very good fit to qpcr data with a wide range of initial target concentrations with a single set of values for rate constants. the two models also give accurate estimates of initial absolute target concentration using several different methods for estimation. using the models with data from a standard curve gives accurate estimates of initial absolute target concentration. in the absence of a standard curve, a dilution curve method also provided accurate estimates of the initial absolute target concentration. in the absence of either a standard or dilution curve the models provide estimates, though less accurate, of absolute initial target concentration. these models presently give the best unified theory for the interpretation of qpcr data in that they explain well the shape of the qpcr curve and how it is affected by variation in the initial target concentration.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
gary cobbs did the entire project.

supplementary material
additional file 1
finding equilibrium for model  <dig> 

click here for file

 additional file 2
finding equilibrium for model  <dig> 

click here for file

 additional file 3
relating model  <dig> to the results of boggy and woolf   <cit> .

click here for file

 additional file 4
sas commands for models  <dig> and  <dig> 

click here for file

 additional file 5
effect of varying l on msresidual and fold error.

click here for file

 acknowledgments
i thank dr. james alexander, dr. robert page, dr. david schultz and  <dig> reviewers for critically reviewing earlier versions of this manuscript.
