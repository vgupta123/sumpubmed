BACKGROUND
the biologist conrad hal waddington, in the course of a career spanning four decades , attempted a bold synthesis of the fields of genetics, embryology and evolution  <cit> . the centerpiece of his vision was the idea of the "epigenetic landscape", first described in an introduction to modern genetics  <cit> , and elaborated in subsequent monographs  <cit> . waddington portrayed the epigenetic landscape as an inclined surface with a cascade of branching ridges and valleys , which in the context of cell lineage selection, represent the series of "either/or" fate choices made by a developing cell. he envisioned that on this landscape, "the presence or absence of particular genes acts by determining which path shall be followed from a certain point of divergence  <cit> ", thus providing in a single image an appealing, and influential, metaphor for the connection between genotype and phenotype.

in the quantitative view of a cell as a dynamical system governed by genetic interaction networks  <cit> , an intuitive association can be made between the valleys  on the epigenetic landscape and the trajectories leading to the attractors, or stable steady states, of the gene networks that regulate cell fate  <cit> . but can we quantitatively map the undulating surface of the landscape, thereby providing a predictive model of the "directionality" of cellular differentiation? waddington himself cautioned that the epigenetic landscape, while useful as a "rough and ready picture" of development, "cannot be interpreted rigorously  <cit> ". the mathematician rené thom, in his formulation of catastrophe theory inspired by waddington's ideas, proposed that a generalized "potential surface" could be derived for any dynamical system  <cit> . however thom's later writings suggest that he did not believe it possible to quantify the epigenetic landscape  <cit> . this view has been echoed by other authors, who have described the landscape as a "colorful metaphor  <cit> " with "no grounding in physical reality  <cit> ".

huang, wang and colleagues have recently proposed a probabilistic "pseudo-potential" to quantify the epigenetic landscape for a gene network regulating cell fate, where the elevation of the surface is inversely related to the likelihood of occurrence of a particular state in phase space  <cit> . in this formulation a stochastic potential energy landscape is characterized for a gene network, based on a hartree mean-field approximation of the underlying master equation  <cit> . such stochastic formulations have also been used to derive probabilistic potential landscapes for the lysis-lysogeny switch in bacteriophage lambda  <cit> , the mitogen-activated protein kinase  signal transduction network  <cit> , biochemical oscillations  <cit> , and the predator-prey system  <cit> .

here we propose a simple numerical method to map the epigenetic landscape that is not based on a probabilistic or master-equation approach. instead, a quasi-potential surface  is derived directly from the deterministic rate equations governing the dynamic behavior of a gene regulatory circuit. we then use stochastic simulations to show that the elevation of this computed landscape correlates to the likelihood of occurrence of particular cell fates, with well-populated low-lying valleys representing stable cellular states and higher ridges acting as barriers to transitions between the stable states.

finally, we discuss ways in which this quantitatively mapped landscape may help predict the efficiency of cellular de-differentiation or trans-differentiation, and identify optimal routes of cell fate reprogramming. recent discoveries have challenged the dogma of cell fate determination as a unidirectional and irreversible process. even terminally differentiated adult cells have now been shown to retain considerable phenotypic plasticity and the ability to be reprogrammed into pluripotent stem cell-like states  <cit>  or into alternative differentiated lineages  <cit>  by forced expression of a single gene or a small number of genes. these findings have led to a resurgence of interest in waddington's ideas about cell lineage choice, with several authors invoking the image of the epigenetic landscape  <cit> . however the theoretical basis of plasticity in cell fate is still not fully understood, and the efficiency of reprogramming in these studies is often quite low  <cit> . a quantitative understanding of the "forces" that drive cell differentiation, and the "barriers" that separate stable cell states, is urgently needed. such understanding may eventually enable us to predict the relative ease or difficulty of de-differentiation or trans-differentiation among multiple cellular states.

RESULTS
derivation of the quasi-potential landscape
we first illustrate our quantitative approach with a simple circuit of two genes x and y that inhibit each other, forming a double-negative feedback loop structure . this circuit works as a toggle switch with two stable steady states: one state with high y and low x expression, and the other state with high x and low y expression  <cit> . such "bistable" switches formed by mutual antagonism of a pair of key regulatory genes underlie many binary cell fate choices  <cit> . the circuit can be described as a two-variable dynamical system, with the rate of change in expression of each of the two genes given as a function of their expression levels:   

if we were able to derive a closed-form potential function v for the system in eq.  <dig> that satisfied the conditions:   

then the local minima on the two-variable potential surface v would correspond mathematically to the stable steady states of the system, given that at the local minima on the surface , the rates of change in expression of both genes x and y would be zero . but such a closed-form potential function can be derived only in the case of a gradient system, defined by the condition  <cit> :   

in general, condition  will not be valid for an arbitrary circuit of two genes x and y that regulate each other as per eq.  <dig>  making it impossible to derive a closed-form potential function.

therefore, given that a gene circuit is in general a non-gradient system, we define a term vq that changes incrementally along a trajectory followed by the system in x-y phase space  as follows:   

where Δx and Δy are sufficiently small increments along the trajectory such that  and  can be assumed to remain unchanged over the interval . the quantities Δx and Δy are obtained as the products  and , respectively, where Δt is the time increment. we use the term "quasi-potential" to describe vq, to emphasize its distinction from a closed-form potential function.

the change in the quasi-potential, Δ vq, can be rewritten from eq.  <dig> as:   

for positive increments in time Δt, Δ vq is thus always negative along an evolving trajectory, ensuring that trajectories flow "downhill" along a putative "quasi-potential surface". stable steady states of the system  would correspond to local minima on this quasi-potential surface, given that at these states Δ vq =  <dig> . the overall change in the quasi-potential along a trajectory can then be calculated by numerically integrating the quantity Δ vq in eq.  <dig> from a given initial configuration up to a stable steady state, thereby allowing us to map out a temporal trajectory along the putative quasi-potential surface . the quasi-potential thus defined is a measurable quantity that is minimized along a trajectory from any initial condition to an attractor in the phase space of the two genes, and is in effect a liapunov function of the dynamical system represented by the two-gene circuit  <cit> .

the procedure described above was repeated to evaluate the change in the quasi-potential along trajectories originating from different points in x-y phase space. to derive a quasi-potential surface from multiple trajectories, we then make the following assumptions:  two trajectories with different initial conditions that converge to the same steady state must also converge to the same final quasi-potential level ;  two trajectories that originate from "adjacent" initial conditions that are sufficiently close in x-y phase space, but converge to different steady states, must start from the same initial quasi-potential level . observation  allows us to map out a basin of attraction from multiple trajectories converging to a single steady state; while observation  enables the alignment of two adjacent basins of attraction along their shared basin boundary, or separatrix.  and  together amount to the assumption that the putative epigenetic landscape is continuous.) the quasi-potential surface can then be obtained by interpolation among the aligned trajectories , yielding the epigenetic landscape with its characteristic ridges and valleys .

the same procedure can be applied to systems with more than two stable steady states - for instance, a "tristable" system produced by a circuit of two genes that induce their own expression, in addition to mutual inhibition . this system has three steady states - two of which represent alternative differentiated cell lineages, while the third state depicts the common progenitor cell of the two lineages  <cit> .

quantitative interpretation of the quasi-potential landscape
to establish that the "elevation" of the computed landscape at a given location in x-y phase space correlates inversely to the probability of occurrence of the corresponding network state, we used stochastic simulations  <cit>  of the underlying gene network. these simulations, which take into account fluctuations in gene expression levels  <cit>  in a population of simulated "cells" , showed that the "valleys" of low elevation on the computed epigenetic landscape correspond to stable cellular states, with "deeper" valleys associated with higher probability of occupancy than shallower valleys . on the other hand, the "ridges" separating the valleys represent barriers to stochastic transitions between multiple steady states. varying the parameters in the network model to increase the height of the ridges relative to the valleys dramatically reduced the probability of transitions between the steady states , even though there was no appreciable change in the relative distance between the steady states on the x-y phase plane .

the "third dimension"  of the landscape represented by the quasi-potential, although directly derived from the dynamic rate equations without any additional information, thus yields an interpretation of cellular stability not immediately apparent from two-dimensional phase portrait analysis. the analysis above supports the contention that the length of the "least action trajectory" along the contours of the epigenetic landscape is more important in predicting transitions between alternative cellular states than the simple "aerial distance" in state space  <cit> . it is also interesting to note that the contours of the quantitatively mapped epigenetic landscape act as a constraint on the extent of stochastic fluctuations in protein levels, with simulated cells "smeared out" on the surface of a shallower basin  compared to a tighter distribution of cells on a deeper valley .

these results suggest that calculating the relative heights of the ridges and valleys on the computed epigenetic landscape of a multi-gene system can help predict the probability of trans-differentiation from one cell lineage to another, or de-differentiation of a particular cell type to its progenitor state. current efforts to reprogram cell fate with potential application in regenerative medicine suffer from a low rate of successful reprogramming  <cit>  and a trial-and-error approach to choice of a reprogramming strategy  <cit> . computing the epigenetic landscape for the critical gene interactions regulating the transition between two cellular states may indicate particular genetic manipulations that would lower the barriers separating the two states, thereby increasing the efficiency of the reprogramming process. it can also help characterize the relative ease or difficulty of alternative routes of cell fate transition  <cit> . for instance, comparison of the elevation of the barriers separating two terminally-differentiated cell lineages on the epigenetic landscape might suggest that de-differentiation of cells of one lineage to the common progenitor cell of the two lineages followed by redirection to the second lineage would lead to more efficient reprogramming than direct trans-differentiation .

a dynamic landscape
the computed epigenetic landscape derived above should not be interpreted as a static surface  <cit> . alterations in gene interactions in course of development or experimental manipulation will change the shape of the landscape, in turn altering the stability of individual steady states or creating novel steady states. for instance, increasing the basal expression of one gene in the tristable gene network sharply lowers the elevation of the corresponding attractor state relative to the other attractors . as a result, cells located in the shallower attractor are destabilized and "roll into" the valley representing the deeper, more stable attractor state. this may explain the phenomenon of trans-differentiation of cells of one lineage into another by forced expression of a gene regulating the second lineage or by conditional deletion of a gene required for the first lineage  <cit> .

interestingly, this flexibility of the quasi-potential surface under gene manipulation gives a quantitative interpretation of the revised image of the epigenetic landscape proposed by waddington , which showed an array of pegs representing genes, holding up a sheet of fabric  through a network of guy ropes  - meant to convey the idea that "the modelling of the epigenetic landscape ... is controlled by the pull of these numerous guy-ropes which are ultimately anchored to the genes  <cit> ". similar changes in the shape of the epigenetic landscape may also be brought about by external signals - for example endogenous cytokines or environmental chemicals - which by transiently altering the landscape could have an instructive effect on cell fate choice.

CONCLUSIONS
in this work, we have defined a deterministic quasi-potential that is minimized along a temporal trajectory followed by a gene network, and used it to quantitatively derive the corresponding epigenetic landscape. a gene network not being a mechanical system, this quasi-potential should not be confused with a potential energy function. it is rather a liapunov function of the dynamical system represented by the gene network, along which trajectories flow monotonically "downhill" towards the steady states of the network  <cit> . other investigators have used a term analogous to the quasi-potential difference Δ vq in eq.  <dig> to calculate the "energy landscape" for concentrations of one component in a gene network  <cit> . here we have used the concept of alignment of multiple trajectories to interpolate the epigenetic landscape of a two-variable system.

this novel and simple process for deriving the surface of the landscape from a path-integral quasi-potential is not restricted to two-gene systems. while the landscape cannot be visually rendered for circuits with more than two genes, the rates of transition across the potential barriers between multiple steady states in the system can still be computed to predict optimum routes of cell fate reprogramming.

however, many binary branching points in development, particularly in blood cell lineage specification, are governed by mutual antagonism of only two transcription factors associated with alternative lineage choices  <cit> . mapping the epigenetic landscape of pairs of such cross-inhibitory "master regulators" should therefore be of particular interest in understanding both normal development and induced cell fate reprogramming, and can be greatly aided by detailed quantitative characterization of the interactions between these regulators.

