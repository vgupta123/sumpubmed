BACKGROUND
the hla  system, the group of genes in the human mhc  located on chromosome vi, encodes the cell-surface antigen-presenting proteins. hla antigens are the major determinants used by the body's immune system for recognition and differentiation of self from non-self  substances. this system consists of numerous snps  encoding more than  <dig>  known alleles  <cit> . the allelic composition in the hla loci, or the hla type, varies significantly within the population. research has identified a direct correlation between an individual's hla type and his susceptibility to disease including hodgkin's lymphoma  <cit> , preeclampsia  <cit> , diabetes  <cit> , and alzheimer's  <cit> . an individual's response to viral infection or drug treatment is also affected by their hla type, e.g. variability in the course of human immunodeficiency virus type  <dig>  infection was shown to be partially the result of particular polymorphism in the hla regions  <cit> . furthermore, a single allele-level mismatch between a transplant donor and acceptor can dramatically reduce the survival rate of the recipient. the hla types of the donors and acceptors have a significant effect on the occurrences of graft-versus-host disease , engraftment failure, and graft-versus-leukemia effect  <cit> .

several different techniques have been explored for hla typing. historically, serological analysis of allele-specific sera was used to identify the structural differences on the surface of the hla molecules due to the nucleotide present at the site of the polymorphism. this method, however, is limited by the availability of allele-specific sera and by its inability to discriminate between allelic subtypes within each serologic family  <cit> . an alternative means of typing is sequencing of the polymorphisms within the hla loci  <cit> . for hla class ii genes, many of the polymorphisms are contained within exon  <dig> thus necessitating sequencing of only a few hundred bases. in contrast, the polymorphisms of class i genes require several exons to be sequenced which in turn introduces an increase in cost as well as the probability of sequencing errors. furthermore, sequencing-based typing also suffers from inherent issues in resolving some sequencing miscalls. despite this, sequencing has a substantially higher resolution than is possible with serological methods.

numerous nucleic acid-based approaches have also been used for genotyping the hla loci. one such approach, pcr-ssp , employs specific primers targeting a particular polymorphism such that the presence of the polymorphism results in amplification of the product  <cit> . because the number of primers required depends upon the number of polymorphisms in the particular locus of interest, a large number of pcr reactions are typically needed to complete the hla typing. pcr-ssop , another nucleic acid-based method, relies on pcr amplification of the locus of interest followed by probing with oligonucleotides designed to recognize specific snps  <cit> . the pcr step is essential for boosting the signal intensity and signal to noise ratio. direct hybridization between ssop and genomic dna resulted in low signal intensity and the low signal to noise ratio, which may make the results difficult to interpret  <cit> . the resolution of both pcr-ssp and pcr-ssop typing is low to medium as snps that are shared by several subtypes of the alleles often result in ambiguities. because a simple pcr-ssp or pcr-ssop hybridization might not result in the assignment of the hla type, nucleic acid-based assays using the microarray technology have been tested for hla typing within the past few years  <cit> . microarrays are ideally suited for the high-throughput requirements by offering the convenience of miniaturization and the ability to perform thousands of hybridizations in a single experiment. this highly parallel nature of the microarrays and their unique format makes them ideally suited for field use as well. microarray-based typing methods thus far discussed in the literature have thus far been able to identify only 6% to 33% of the allelic variations in the loci of interest.

herein, a novel three-step approach for the development of high-throughput microarray assays for hla typing is presented. first, candidate probe sequences  are selected which contain the known snps present in the allelic sequences of the locus  of interest. next, each candidate probes sequence is compared to the collection of sequences which are likely to be present in the sample , including the remainder of the human genome and human-associated microbial genomic sequences. the distance, or the number of base changes that are necessary for a candidate probe sequence to be "converted" to the nearest sequence present in the synthetic background, is calculated for each probe. the candidate probes which are significantly distant from the background are less likely to misprime with, for instance, human genomic dna. such candidate probes are "ultraspecific" for identification of the allele even when foreign genomic material is present. it is possible that use of such ultraspecific probe sequences may eliminate the need of pcr amplification of the hla region. lastly, the smallest set of ultraspecific probes is selected such that the highest resolution typing can be achieved with a minimal cost in producing the assay. as an example, the proposed approach was applied to the most polymorphic region of the hla system, the hla-b locus.

RESULTS
the proposed method comprises of three steps.

 <dig>  selection of candidate probes: select all short subsequences  of length  <dig> to  <dig> nucleotides  containing each snp in the allelic sequences producing the set of all candidate probes.

 <dig>  identification of ultraspecific probes: exclude from consideration all candidate probe sequences which are present in or can be converted to a subsequence in the synthetic background given any combination of two or more base change as such sequences are likely to have a high probability of mispairing with non-target dna present in the sample. the results of this most computationally intensive step is the set of ultraspecific candidate probes or those sequences which are "distant" from the background collection.

 <dig>  selection of optimal set of ultraspecific probes: determine the set of ultraspecific probe sequences which requires the minimum number of members such that each known allele is expected to hybridize with a specific subset of probes.

for each of the  <dig> alleles within the hla-b locus, the set of all 16- through 22-mer sequences were identified as candidate probe sequences. thus, multiple n-mers containing the same snp for the same allele were identified in which both the location of the snp within the n-mer and the length of the n-mer vary. to utilize these probes as markers of the hla-b specific polymorphisms, each of the candidate probes were compared to the background collection – the remainder of the human genome which includes the other highly similar hla loci  and known polymorphisms outside of the hla-b region. with regards to the ability to detect the set of alleles, all of the alleles contain 16- through 22-mers that are at least  <dig> change away. table  <dig> lists the percentage of the alleles which can be detected by probes of a particular size and distance from the background; a complete listing of the number of candidate probes for each of the individual  <dig> alleles and distance values can be found in additional file  <dig>  to reduce the likelihood that probes would hybridize to non-target sequence by tolerating single base mispairing, we stipulate that ultraspecific n-mers must be  <dig> or more changes away from the background.

while these ultraspecific probe sequences, when incorporated in a microarray assay, are expected to be able to detect all of the  <dig> alleles considered, it is not guaranteed that a single assay could distinguish between different alleles. thus, the set of ultraspecific probe sequences was analyzed using a greedy algorithm  in order to generate the minimum set of ultraspecific probes required such that all of the alleles can be detected with the highest typing resolution possible. based upon the results of our computations, a probe set including  <dig> ultraspecific probes was identified. ultraspecific probes included in the set were selected based upon their ability to both detect the  <dig> alleles as well as their ability to provide resolution for distinguishing between alleles. each allele is expected to hybridize with between two to  <dig> different probes in this set. while all ultraspecific probes are able to distinguish one to many different targets, not all members of the set provide the ability to indentify a particular allele . this set will produce distinctive hybridization patterns for  <dig> out of the  <dig> alleles such that  <dig> % of the alleles can not only be detected but also definitively typed; the remaining  <dig> alleles, while detectable by this probe set, will not hybridize to any unique or unique combination of ultraspecific probe sequences.

as shown in figure  <dig>  the first five probes selected in the set are able to detect alleles but do not provide any distinction between the alleles detected; with the inclusion of the sixth probe, however, it is now possible to distinguish between the expected hybridization patterns of the b_ <dig> and b_ <dig> alleles from all other alleles considered. while the complete set of  <dig> ultraspecific probes can recognize  <dig> alleles,  <dig> of these ultraspecific probes are actually able to individually distinguish between  <dig> alleles . additional file  <dig> lists each of the ultraspecific probe sequences included in the set. the percentage of the  <dig> distinguishable alleles each of these probes is expected to hybridize with is shown in figure  <dig>  as is shown in this figure, nearly half  of the probes included in the set are only expected to hybridize with a single allele thus generating a unique hybridization pattern such that the particular allele can be uniquely identified from all of the other alleles considered.

in silico assays for the  <dig> ultraspecific probe set and each of the alleles were conducted. as one would expect, it is the groups of highly similar alleles that the ultraspecific probe set is unable to distinguish between. in order to visualize the degree of similarity between the alleles based upon their expected hybridization patterns, we calculated the distance  between any two patterns as:

 d=1−n12min⁡, 

where n <dig> and n <dig> are the numbers of probes present in each of alleles being compared and n <dig> is number of probes present in both alleles simultaneously. by computing the distances between each pair of  <dig> patterns  with phylip's neighbor program  <cit> , we were able to group alleles using the publicly available njplot software package  <cit>  based on the distances between patterns observed on the microarray. the tree was generated for the set of alleles which cannot be individually typed. figure  <dig> illustrates a subtree in this tree; the newick file for the complete tree can be found in additional file  <dig> 

discussion and 
CONCLUSIONS
the microarray of  <dig> probes represents what many researchers can produce in-house at low cost. while unable to uniquely identify every allele, the probe set presented here provides a higher resolution than has previously been developed and includes more alleles than previously considered. for the  <dig> alleles which cannot be distinguished, the nucleotide present at the polymorphic positions defining the allele are included in candidate probe sequences that did not meet the ultraspecificity criteria. incorporating probe sequences expected to hybridize within these polymorphic sites have a greater likelihood of interacting with regions outside of the hla-b exons. as our goal here is to develop an assay such that amplification of the hla loci exon prior to assaying is not necessary, such nonspecific probe sequences are excluded from the set. in the event that the assay generates a hybridization pattern common amongst several known alleles, further high resolution typing may be required. furthermore, this assay lends itself towards exploratory typing. in the event that a novel hybridization pattern is observed, subsequent sequencing can be performed to determine the sequence of the new allele; when a known allele is encountered, however, the cost of this additional sequencing can be avoided. based upon the results of in silico experiments as well as preliminary experimental results , we believe that the proposed approach can be readily applied to the entire hla system as well as other highly polymorphic gene systems. we are in the process of developing an "hla-chip" to enable population-scale hla typing in a portable, field-ready environment.

