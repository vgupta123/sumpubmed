BACKGROUND
the oriental fruit fly  is an important agricultural pest in asia, africa, and the pacific, impacting over  <dig> fruits and vegetables in tropic and sub-tropic regions  <cit> . in addition, b. dorsalis is established across the hawaiian islands and is a species of concern in the continental united states, with numerous interceptions and detections made annually, often triggering eradication efforts and quarantines . in addition to being an important pest species, b. dorsalis, as a member of the family tephritidae, can serve as an important species for comparison to the well characterized drosophilid group, having diverged from drosophila approximately  <dig> million years ago  <cit> .

despite its importance as an agricultural pest, little functional genomic information is available for the species outside of a collection of sequences used for phylogenetic analysis of the genus. the addition of functional genomics information can lead to development of new control strategies, a basic understanding of the biology of the insect, and expansion of the techniques used in research. with the advent of high-throughput sequencing technology, there is increased ability to obtain cost-effective sequence data from non-model organisms, including sequencing from total rna libraries to target coding genes at particular time points. while collection of this data is fairly straightforward, in order to accurately predict gene models and transcripts, much attention must be given towards assembly and analysis of the data. while this shotgun de novo approach to sequencing potentially allows for collection of full length genes, detection of splice variants, and calculation of differential expression between tissues, it can also lead towards assembly of partial gene fragments, erroneous assembly fragments, and mis-assemblies . many rna-seq experiments report a large number of small transcript fragments, sometimes numbering in the hundreds of thousands, with a small proportion likely to be full length transcripts. this can make it difficult to calculate meaningful expression values, accurately identify transcript isoforms, and limit the utilization of the resulting dataset in downstream functional genomics experiments. for example, for b. dorsalis there are several published experiments that have performed de novo transcriptome assembly, presented tens of thousands of assembled contigs, but did not publish gene models or transcript sequences as part of their experiment . this makes it difficult to utilize the research and limits the application of the research. as an alternative, we attempted to analyze rna-seq data to produce a high confidence transcript set consisting of full length or near full-length transcripts with strong support for their accuracy. the resulting dataset can be used as a foundation for expanding on the b. dorsalis gene set without concerns that the dataset contains erroneous data.

our approach was to perform comprehensive rna sequencing on a laboratory colony of b. dorsalis with a focus on attempting to capture expression of as many genes and gene splice variants that represent the entire developmental life history. de novo transcriptome assembly and analysis of the resulting sequence were performed with a focus on identifying full length gene and splice variants, and then annotating through identification of orthologs in drosophila gene sets. high confidence genes were filtered from potentially erroneously assembled transcripts based on homology to known proteins and read coverage of the transcript. the result produced a high quality reference transcript set for this species for comparative analysis with d. melanogaster. this transcriptome can be used as a foundation for functional genomic and population genetic experiments. further development from other lines of evidence can be used in the future to broaden this gene set.

RESULTS
sequencing and quality filtering
in total, approximately  <dig> million paired 100 bp reads were obtained from illumina gaiix sequencing, totalling over  <dig> gb of data . these reads were evenly distributed between all of the libraries sequenced . all raw reads were submitted to the ncbi sequence read archive under accession numbers srx261507-srx <dig> associated with bioproject prjna <dig>  after quality filtering and removing low quality reads, approximately 84% of reads remained and were used for assembly and mapping. while filtering provided little improvement to the quality of the beginning of the read, it dramatically increased the quality score of the end of the read from an average q <dig> score of  <dig>  at base  <dig> in unfiltered reads to average q <dig> score of  <dig>  in filtered reads . filtering also had no dramatic effect on gc content of the data, suggesting there was no bias to the reads that were removed during filtering. in silico normalization using the trinity normalization tool dramatically reduced the number of input reads into the assembly without adversely influencing the kmer abundance from those reads. from ~ <dig> , <dig> raw read pairs, filtering and normalization reduced the read abundance to  <dig> , <dig>  reads used as input into the trinity assembly, greatly reducing the computational requirements for assembly and avoiding complicated de bruin graphs created by low quality sequence or overabundant sequence kmers.table  <dig> 
quality filtering of illumina gaiix data before assembly and mapping




de novotranscriptome assembly and transcript filtering
the b. dorsalis transcriptome was reconstructed using the trinity assembly pipeline with all filtered reads from all libraries pooled into one dataset  <cit> . this raw assembly yielded  <dig>  contigs, with an n <dig> contig size of  <dig>  bases,  <dig>  contigs greater than 1000 bp, and a transcript sum of  <dig>  mb. while not all assembled contigs produced by trinity represent true transcripts in b. dorsalis, this contig set was used as a starting point for defining the transcriptome present in our sample. filtering based off of read abundance and component isoform percentage removed  <dig>  sequences, leaving  <dig>  remaining. further filtering through identification of likely coding sequence based on orf prediction identified  <dig>  genes containing a complete orf ) with  <dig>  isoforms giving complete orfs. in addition,  <dig>  genes only contained a partial orf  with  <dig>  isoforms identified in those genes, giving a total of  <dig>  transcripts across  <dig>  genes, with an n <dig> transcript size of  <dig>  bp and transcript sum of  <dig>  mb. while trinity assembled an additional  <dig>  contigs, these were discarded by the above filtering because they lacked a likely coding sequence or did not have significant read coverage. while in some cases these may contain partial gene fragments, we chose to exclude them from further analysis as the majority consist of short, low read count data with low blast homology to known proteins in d. melanogaster . in contrast, the majority of the retained transcripts had a significant number of reads mapping to them, with full length transcripts being longer, and having a higher alignment percentage to known drosophila proteins when compared to the partial transcripts .figure  <dig> 
comparative evidence for filtering of
de novo
assembly. lines represent retained unigenes  or transcripts discarded based off of lack of evidence of coding region or due to low expression values. a) proportion length of b. dorsalis putative transcripts relative to highest scoring blast alignment to d. melanogaster proteins. b) length distribution of transcripts. c) relative log read count expression values of transcripts.



read abundance based expression analysis across developmental stages
stage specific expression values were calculated for each developmental library as tmm normalized fpkm values. unique genes were classified with the modencode fpkm expression categories  utilized by flybase.org with the same fpkm expression level calculations and category bins used in drosophila
 <cit> . distribution of expression categories across developmental stages are presented in figure  <dig>  from this, genes were categorized as constitutively expressed in all libraries, stage-specific or expressed across several stages. constitutive highly expressed genes were defined as those genes having an expression level of "moderately high" or higher in all  <dig> samples. under this definition, we identified  <dig>  constitutive highly expressed genes in our dataset. stage specific genes were defined as those that are "moderately expressed" or higher in one library and “low” or "very low" in the other  <dig> libraries. a total of  <dig> unigenes were declared stage specific. finally, genes expressed across two, three, four, or five libraries were also calculated, as many genes may be expressed during several related libraries that could constitute a biologically relevant developmental stage. this identified  <dig> genes expressed at least moderately high in two libraries compared to very low in the rest of the libraries,  <dig> genes with this same pattern in three libraries,  <dig> in  <dig> libraries and  <dig> in  <dig> libraries. the majority of the genes in the combined transcriptome dataset were found constitutively expressed at a low level . a breakdown of the number of stage specific genes is listed in table  <dig>  and a matrix of stage specific and constitutively expressed genes is provided in additional file  <dig> figure  <dig> 
distribution of expression categories across
b. dorsalis
developmental stages. placement of unigenes across modencode expression categories, separated by developmental stage.


number of unigenes present in expression level categories



all stages:

single stages:
lists of genes present in each category is provided as matrices in additional file  <dig>  constitutive highly expressed genes have modencode expression values of “high” or greater across all stage specific samples. sparsely expressed genes have a value of “low” or lower.

using the same classification described above, the number of genes falling into each of the expression level categories for each stage was compared with that of d. melanogaster , demonstrating strong similarity of distribution of gene expression levels in both species. while this result helps to corroborate the expression values presented for b. dorsalis, it additionally highlights the intra-species conservancy of expression levels for the majority of transcripts, suggesting stage-specific functional conservation between the identified genes in b. dorsalis and d. melanogaster .figure  <dig> 
comparison of expression level distribution between
b. dorsalis
and
d. melanogaster
utilizing modencode expression categories. numbers below bars represent modencode expression categories as follows: 1- no expression, 2- very low, 3- low, 4- moderate, 5- moderate high, 6- high, 7- very high, 8- extremely high. frequency of all b. dorsalis unigene models were compared to all gene level expression values derived from the d. melanogaster modencode project.



another complementary approach to compare expression between stages was employed through hierarchical clustering of the gene expression values between libraries, and then defining subclusters that share similar expression patterns across libraries. from the hierarchical clusters,  <dig> subclusters were created by splitting the tree at clusters that shared 45% of the tree height. these subclusters were visualized by plotting the median centered fpkm values . in this case, expression patterns are not focused specifically on the most highly expressed genes as in the first approach, but rather on genes that exhibit a change in expression based on median-centered values, regardless of the level of expression. some of the defined clusters did not clearly describe a stage specific expression pattern such that no expression values were distributed significantly outside of the median ; others, however, showed clear differences in expression between libraries. these patterns are highlighted as inset figures in figure  <dig>  and a list of genes present in each cluster is provided as supplementary data .figure  <dig> 
two dimensional cluster of expression profiles of unigenes in
b. dorsalis
across developmental stages. two dimensional clustering of developmental stages by expression patterns of the  <dig>  unigenes identified. vertical cluster of unigenes sub-clustered into unigenes of similar expression profile, subclusters color coded on vertical bar adjacent to heatmap, and cluster expression profiles presented as inset figures a-s. vertical axis of inset figures is log <dig> 



putative unigenes orthologous to d. melanogastergenes
a set of  <dig>  putative orthologous genes were identified in our b. dorsalis dataset through reciprocal blast alignment with the d. melanogaster protein set. we anticipate this number to be an underestimation of actual ortholog representation, as utilizing an rna-seq assembly increases the chance for multiple unigenes. expression levels in terms of normalized fpkm values were compared between the putative orthologs by plotting the data along a regression curve. a strong linear relationship was observed between the expression values of orthologs . to identify orthologous proteins with potential difference in expression between the two species, a 95% interval was calculated along the regression. a conservative approach was taken to avoid the identification of false orthologs, and at times this approach may not identify true orthologs. this is particularly true when using de novo assembled rna-seq data, which commonly has a large proportion of extraneous or superfluous transcripts assembled due to genetic heterogeneity of the sample, sequence error, and/or relaxed transcript reconstruction parameters of the software. by filtering the assembly to the approximate expected unigene and transcript density, over  <dig>  putative orthologs were identified. through linear regression analysis between expression values of the orthologs in b. dorsalis and d. melanogaster, we found a strong linear correlation at each developmental stage. of the unigenes falling outside of the confidence interval of the regression, a significant proportion were identified as constitutive low expression. this bias seems largely due to a large number of unigenes with higher expression  in b. dorsalis compared to d. melanogaster and are likely not biologically relevant. in contrast, there are  <dig>  unigenes  that are always within the confidence interval and about 25% that are conversely outside in at least one developmental stage . only  <dig> unigenes were consistently outside of the confidence interval in all  <dig> developmental stages. this strong homology in expression patterns between b. dorsalis and d. melanogaster for the putative orthologs suggests conserved functions between species. of course, this is biased, as additional unigenes that may be orthologs were not identified by our analysis, and it is possible that those may be enriched for proteins that have modified function or expression patterns, and may not have passed the threshold set. despite some genes not falling within the confidence interval of the regression, pearson correlation values  at a p <  <dig>  were calculated and both data sets were found to have a strong correlation. both the regression and the correlation support assembly accuracy and relative completeness. for genes outside of the confidence, while considered potential orthologs, may have different functions or temporal expression patterns between the two species, or may be more sensitive to external variables that potentially differed between rearing conditions.figure  <dig> 
regression analysis of log expression values between orthologous unigenes in
b. dorsalis
and
d. melanogaster
across developmental stages. linear regression represented as solid line with 95% confidence interval indicated with dashed lines. each b. dorsalis unigene with putative ortholog identified in d. melanogaster developmental stage was plotted against the putative ortholog based off of log expression values. detailed list of each unigene outside of the confidence interval is presented in additional file  <dig> 



functional annotation
a large proportion of the transcripts assembled and retained after filtering were able to be functionally annotated through blast homology to proteins in the uniprot swiss-prot database and the d. melanogaster protein set or hmm profiles in pfam-a. further, when possible, gene ontology, kog, and cog terms were added. in total,  <dig>  transcripts  were annotated from blast homology to swiss-prot with a qualified gene name, whereas  <dig>  transcripts  had significant alignment to d. melanogaster proteins , encompassing  <dig>  proteins from  <dig>  unique gene models in d. melanogaster, and representing 65% of known d. melanogaster genes. in contrast,  <dig>  transcripts were annotated with pfam domains, encompassing  <dig>  unique pfam identities.

identification of transcription factors in the b dorsalisgenome
spatial and temporal patterns of gene expression are in part regulated by transcription factors. transcription factors  were searched in our dataset initially by using the gene ontology annotations and further curated using pfam. genes with go terms corresponding to: go: <dig> , go: <dig> , and go: <dig>  were selected and pfam annotations were used to curate and classify the selected list of genes. a total of  <dig>  transcripts were classified as tfs, roughly 6% of the transcriptome. this percentage is comparable with the number of tfs estimated in d. melanogaster
 <cit> . the  <dig>  identified sequences corresponded to one of  <dig> unique domains. the most abundant tfs corresponded to zinc finger domains, followed by homeobox domains and helix-loop-helix proteins . it is worth noting that several sequences may be false positives. for the purposes presented here, transcription factors were defined as dna binding domains, however several proteins exist that possess motifs similar to dna binding factors and yet may be unrelated. similarly, several true transcription factors might be missing from the analysis.table  <dig> 
classification of transcripts annotated as transcription factors


distribution of transcription factors. the eleven most abundant domain classes are listed, but  <dig> unique domains in total were identified. transcripts belonging to classes not specifically listed were identified by fewer than  <dig> unique transcripts and pooled into the “other” category.



detoxification genes in b. dorsalistranscriptome
an important aspect of insect evolutionary adaptation is their ability to remove acquired toxic compounds and protect the organism. to identify genes related to detoxification in b. dorsalis, genes linked with phases i and ii in mammalian detoxification pathways were mined from the transcriptome dataset through sequence homology. cytochrome p <dig> monooxygenases  accounted for  <dig> transcripts in  <dig> unique unigenes, approximately equating the  <dig> genes found in drosophila from this superfamily  <cit> . these  <dig> unigenes belong to  <dig> families . while many p <dig> proteins are known to be involved in detoxification, the superfamily consists of a wide array of enzymes with distinct functions  <cit> . this is not the first report of characterization of p450’s in b. dorsalis, with previous research reporting as many as  <dig> unigenes to as few as  <dig> from shotgun transcriptome experiments  <cit> . inconsistent database deposition of sequences obtained in previous reports makes it difficult to make comparisons and draw conclusions across the respective studies. in one case, multiple p450s were verified through cloning  <cit> , and  <dig> p450’s were reported from the olive fly b. oleae
 <cit> . the overall consensus suggests strong consistency in the diversity and abundance of p450’s in b. dorsalis and d. melanogaster.table  <dig> 
distribution of detoxification annotations in
b. dorsalis
transcriptome including cytochrome p <dig>  glutathione s-transferases, and udp-glucuronosyltransferases


α

αbreakdown of individual unigenes annotated to each class available in additional file  <dig> 


βfor gsts,  <dig> contained only n-terminal domains,  <dig> only c-terminal domains and  <dig> genes encompassed both domains.



glutathione-s-transferases  and udp-glucuronosyltransferases
 constitute phase ii of the mammal detoxification pathway, usually by mitigating the effects of the oxygen radicals produced by phase i  <cit> . our transcriptome profiling detected  <dig> unique gsts domains,  <dig> of which had both n- and c- terminal domains and eight with homology to either the c-terminal region only or the n-terminal region . this is comparable to a previous report that identified  <dig> unigenes with gst domains  <cit> . additionally,  <dig> ugts were found . furthermore, data from a d. melanogaster microarray experiment designed to profile genes in the cncc/keap <dig> pathway was obtained  <cit> . the cnc/keap pathway is presumably the central pathway for detoxification in d. melanogaster and has little evolutionary relationship with detoxification in mammals. the data was cross-referenced with our identified orthologous genes in b. dorsalis. among the genes that changed in expression in response to cncc/keap pathway activation in d. melanogaster,  <dig> appear to be present in b. dorsalis with most constitutively expressed  across all stages, with no specificity to their expression pattern .

sex determination transcripts
genes involved in sex-determination can be used to develop pest control tools as well as to improve the existing sterile insect technique   <cit> . to identify sex-determinant genes, amino acid sequences of  <dig> transcripts corresponding to  <dig> genes known to be involved in sex determination in d. melanogaster
 <cit>  were used to search our b. dorsalis transcriptome dataset trough blastp . this resulted in  <dig> b. dorsalis unique transcripts with high sequence similarity to at least one of the d. melanogaster peptide sequences .

the genes sex lethal  and notch  had the highest number of transcripts with high sequence similarity in b. dorsalis. the gene transformer  was not found in our transcriptome assembly, and only two transcripts matched transformer  <dig>  . the gene tra <dig> was found to be critical for sex-determiantion in anastrepha fruit flies  <cit>  but needs to interact with tra. while tra was found to be present in another bactrocera species, b. oleae
 <cit> , it may not have been actively expressed in the samples we tested, despite our effort to include as many developmental stages as possible. a previous report investigated reproduction and development in b. dorsalis utilizing rna-seq, but did not investigate sex-determination  <cit> . additionally, putative sex determinant d. melanogaster orthologs and transcripts with sequence similarity to other species were mined from the annotation output and the d. melanogaster orthologous datasets. the total number of genes, transcripts and orthologs found are in additional file  <dig> 

CONCLUSIONS
the sequencing of stage-specific messenger rna from the fruit fly b. dorsalis allowed for the construction of a transcriptome that when compared with d. melanogaster allowed for the identification of  <dig>  transcripts across  <dig>  unigenes. this is comparable to the current genome annotation derived d. melanogaster transcript set, which includes  <dig>  genes,  <dig>  isoforms, n <dig> isoform length of  <dig>  and an isoform sum of  <dig>  mb. utilizing binning expression nomenclature utilized by the modencode project, 65% of the unigenes identified were expressed at a constitutively low level . in addition, the relative distribution of unigenes across bins throughout the developmental life history in b. dorsalis is very similar in pattern to the distribution seen in d. melanogaster across the same developmental stages. despite this, distribution does not directly demonstrate similarity between species at a gene or unigene level, so putative orthologs were identified using a reciprocal blast approach.

functional annotation of the transcriptome yielded a large diversity of functions. the focus of this study was on proteins related to dna binding, detoxification, and sex determination. this analysis demonstrates the utility of a d. melanogaster based annotation approach for closely related species, and potentially that functions or processes in drosophila will largely translate to tephritide flies. despite this, direct transfer of drosophila annotations is not always sufficient for inferring function. for example, genes involved in sex-determination are potential targets for the development of novel control strategies and the improvement of the sterile insect technique  in tephritids. orthology to drosophila should be used with caution, as sex determination is highly diverged among dipeteran insects. for example, sxl in tephritids is not regulated in a sex-specific fashion; rather the sxl transcript is present in both sexes. to address this point, further studies utilizing more accurate and sensitive techniques will be needed to validate and verify the expression patterns of genes of interest throughout the life history of b. dorsalis. in addition, functional genomic approaches will lead to a better understanding of the similarities and differences between tephritids and drosophilids and serve as a foundation for developing new control techniques for pestiferous true fruit flies.

