BACKGROUND
bacteriophages, which are defined as viruses that infect and replicate within bacteria, constitute the largest known group of viruses
 <cit> . they occur everywhere in the biosphere where bacteria are found, their habitats being as diverse as oceans, topsoils, plants or animals. the total number of phage species is estimated to reach millions
 <cit> , and their classification remains a challenge nowadays. whereas molecular biology has permitted for most living organisms a progressive shift from character-based classifications to classifications based on genetic markers
 <cit> , no satisfying method for classifying phages exists at present. phages were initially sorted according to two characters: the nature of their encapsidated nucleic acid and their virion morphology. more than 96% of them are tailed phages: they constitute the caudovirales order
 <cit> . they encapsidate double stranded dna genomes. moreover, their viral particle is formed by a head, mainly constituted by an icosahedral capsid that protects the viral genome, and a tail specialized in dna delivery inside the bacterial host. caudovirales are divided into siphoviridae, myoviridae and podoviridae families depending on the nature of their tail, which is respectively long and non-contractile, long and contractile, or short. phenotypic observation does not permit finer grained structural distinction among these tailed phages, so that molecular tools are needed to further classify them
 <cit> . at this family level, some classification problems arise, as some phages can be separated into sipho-, myo- and podoviridae, while having closely related genomes
 <cit> .

phage hierarchical trees were obtained from the analysis of capsid proteins
 <cit> . terminase
 <cit>  and portal
 <cit>  proteins were further described as potential markers of phage diversity, as well as tape measure proteins in long-tail bacteriophages
 <cit> . however, the selected gene is sometimes not detected in some of the phages, thus excluding these phages from the classification
 <cit>  and limiting the use of the gene as a marker for biodiversity studies
 <cit> . moreover, a single gene does not provide a global view of the virion architecture, thus hindering phage classification as a function of a general virion structural organisation.

phage hierarchical trees were recalculated based on whole genome analyses
 <cit> . to some extent this approach permitted the definition of some genera and subfamilies among myo- and podoviridae, but it seemed unsuccessful with respect to siphoviridae. decisive in such approaches is the capacity to group together large enough sets of orthologs, which remains difficult given the remarkable level of sequence divergence between phage proteins. not only do phage genomes mutate more rapidly than bacterial genomes, but they also recombine more readily, so that the notions of phage species and hierarchical classification can be questioned. using a similar estimate of relatedness based on the amount of shared genes, but departing from the hierarchical classification, an attempt at representing phage relatedness with graph theory revealed a densely connected network of all caudovirales <cit> . however, it is difficult to extract from such an analysis the relationship between phage classification and specific phage properties as for example virion morphology. in order to understand how highly divergent phages encode for a virion capable of infecting bacteria, we focused the analysis on a set of genes belonging to the “structural” module involved in virion assembly and host infection.

despite phage divergent and complex evolution, the thorough molecular analysis of a few paradigmatic tailed phages belonging to different morphological classes, such as siphoviridae spp <dig> and λ, myoviridae t <dig> and podoviridae p <dig> and Φ <dig>  suggested that only a limited number of structural solutions are used in order to produce a functional virion
. to challenge this hypothesis, we searched for homologs of a set of virion proteins functionally characterized through the study of the assembly pathway of the corresponding phages . protein names sometimes differ for the various model phages that were studied, and are unified in figure 
 <dig> for the sake of clarity. proteins from the head  and the tail  of bacteriophages are generally well conserved, and could be detected with standard bioinformatics strategies. in contrast, proteins lying at the interface between the head and tail components, the so-called ad, hc and tc head-to-tail connection proteins , can be much more difficult to detect due to drastic sequence divergence.figure  <dig> 
assembly pathway of tailed bacteriophages. in the tailed phages, capsid assembly starts with the construction of an icosahedral protein lattice called procapsid, essentially composed of a major capsid protein . at a specialized vertex of the procapsid, the dodecameric portal protein  forms a channel which is the docking point for an atpase complex called terminase. this complex normally contains multiple copies of a large subunit with atpase and endonuclease activities , and a small dna binding subunit that recognizes the cognate viral dna sun et al. <cit> . it translocates viral dsdna into the procapsid cavity through the portal channel. when dna packaging is completed, the terminase motor disassembles and the portal dodecamer recruits head-completion proteins to prevent leakage of the viral dna. one such protein directly binds to the portal: it is called the adaptor protein ; it can also be supplemented with the so-called head-closure protein 
. altogether the head-completion proteins provide a platform for completion of short tail assembly in podoviridae <cit>  as well as for docking of pre-assembled long tails in sipho- and myoviridae. located at one end of the sipho- and myoviridae long tails, the tail-completion protein  allows for the tail attachment to the head. head- and tail-completion proteins form the head-to-tail connection and, together with the portal protein, constitute the virion’s neck. the major tail protein  is the main component of the tail tube structure. in myoviridae, the surrounding tail sheath protein  contracts upon host infection, initiating viral dna injection in the host cell.


functionally characterized head- and tail-completion proteins of tailed bacteriophages classified in aclame


siphoviridae
gp15
1
gp16
2
gp17
3
siphoviridae
gpw
gpfii
2
gpu
3
siphoviridae
gp6
1
myoviridae
gp15
3
podoviridae
gp4
1
podoviridae
*refers to a protein identified through this study.


head- and tail-completion proteins extracted from the literature are listed in this table. proteins of known 3d structure are indicated in bold. structural homologies between proteins that were experimentally demonstrated are indicated by similar numbers in superscript. neck types result from the current analysis. in particular, spp <dig>  λ and hk <dig> are gathered within the same phage type because they are predicted as exhibiting homologous head- and tail completion proteins. gpw of siphoviridae phage λ corresponds to a rare alternative playing the role of spp <dig> gp <dig> at the head-to-tail connection .

to obtain a global view of the “structural module” in bacteriophages and probe whether newly sequenced phages can be assigned to already known systems, we developed a specific computational strategy able to cope with the high divergence and plasticity of phage genomes. a sensitivity-enhanced bioinformatics approach based on profile-profile comparisons was initially used
 <cit> . we further improved this method by performing systematic gene context analyses and successfully detected the head-to-tail connection proteins in 91% of  <dig> genomes of tailed and unclassified phages. based on the occurrence of these proteins, phages were classified into  <dig> types and their relationships with known morphological subfamilies  were defined. next, a similarity metric between phages, combining profile-profile comparison scores with sequence identities, was developed to provide a finer classification of virion architectures within every type. for the latter step, not only proteins from the head-to-tail connection  were considered but also components of the head and the tail. as a result, the most abundant type  <dig> could be divided into  <dig> clusters, some exclusively containing siphoviridae or myoviridae, and others aggregating both sipho- and myoviridae. we developed a webserver, called virfam, to map any novel phage genome on our classification scheme. by testing this server on  <dig> phage genomes from the ncbi database not yet included in our dataset, we confirmed the large applicability of our classification approach, as 93% of them could be classified within one of the type/cluster classes. beyond phage classification, this study also provides insights into the possible organization of ancestral neck modules in caudovirales.

implementation
hmm profiles generation for proteins of the learning database
for all the  <dig> phage sequences contained in the aclame database 
 <cit> , a profile was built following the protocol described in
 <cit> . in the latest release of aclame ,  <dig> bacterial phage genomes are accessible but only  <dig> fulfilled the criteria of being bacteriophages  with treatable sequences . briefly, for every sequence, a  <dig> iteration psi-blast
 <cit>  search was performed against the non-redundant ) database using a cutoff e-value of 10- <dig>  whenever an iteration retrieved more than  <dig> homologs, the previous iteration was kept so as to prevent divergence issues. the resulting multiple sequence alignment was filtered so as to keep the  <dig> most diverse sequences and was converted into a hidden-markov model profile using the hhsuite programs
 <cit>  integrating the secondary structure prediction from psi-pred
 <cit> . the detailed bioinformatics procedure described below was followed for each of the different component of the head-neck-tail module. to evaluate the sensitivity gains provided by profile-profile comparisons  with respect to profile-sequence ones , as presented in table 
 <dig>  we followed the procedure described in additional file
1: method s <dig> table  <dig> 
detected head- and tail-completion proteins of aclame


*including  <dig> gpw-like ad <dig> 

head- and tail-completion proteins detected using either the profile-sequence comparison tool psi-blast, the profile-profile comparison tool hhsearch with a threshold of 90% or an approach combining the hhsearch tool at a threshold of 70% with analysis of the gene contexts are detailed . proteins counted in the “exceptions” column correspond to proteins that were manually detected, either because their hmm profile was built from very few sequences  but they showed consistent secondary structure prediction and genome localisation, or because they were detected by hhsearch but their genome positioning slightly deviated from the canonical positioning. the aclame references of the detected neck proteins, as well as of the identified head and tail proteins, are displayed in additional file
2: table s <dig> 



detection of the head and tail proteins within the learning database
we first searched for the major capsid proteins, portal proteins, terminases, major tail proteins and sheath proteins within aclame  <dig> . the various components of the head and the tail were identified starting from proteins whose 3d structures were solved and using our iterative profile-profile comparison procedure with a probability confidence threshold of 90% as described in
 <cit> . in the case of the major capsid proteins, the 3d structures are known from x-ray data for the siphophage hk <dig> and the myophage t <dig>  the hk <dig> and t <dig> major capsid proteins exhibit a similar polypeptide fold
 <cit> . consistently, they were detected as related by hhsearch with a confidence score of 93%. we used their profiles as starting points in order to detect other proteins belonging to the major capsid superfamily.  <dig> major capsid proteins were identified, including the capsid proteins of the siphophages spp <dig>  λ, Φϵ <dig>  the myophages p <dig>  mu and the podophages t <dig>  t <dig>  ϵ <dig>  p <dig>  pza. for several of these phages, a high resolution em structure of the capsid is available, and the em data are consistent with the existence of a common major capsid protein fold
. in the case of the portal proteins, the 3d structures are known for phages Φ <dig>  spp <dig> and p <dig>  the portal proteins of these phages exhibit a common fold
 <cit> . we used their profiles as starting seeds and identified  <dig> portal proteins, including those of phages hk <dig>  λ, Φϵ <dig>  t <dig>  p <dig>  mu, t <dig>  t <dig> and ϵ <dig>  3d structures of terminase large subunits are known for phages t <dig>  and spp <dig> . here again, despite a very low sequence identity, the fold of the nuclease domain is conserved. using the profiles of the spp <dig> and t <dig> terminases as starting point,  <dig> large terminases were identified, including those of phages hk <dig>  λ, Φϵ <dig>  p <dig>  mu, t <dig>  t <dig>  p <dig> and ϵ <dig>  we did not find the terminase of Φ <dig>  consistent with a previous bioinformatics study that clearly demonstrated the existence of two structurally distinct families of large terminases, one of these families being found in most tailed bacteriophages, and the other family being only found in Φ29-like phages
 <cit> . in the case of the major tail proteins, only one 3d structure is available, that of gpv from phage λ
 <cit> , from which we detected  <dig> tail proteins, including those of the siphophage spp <dig> and the myophage p <dig>  however, we did not identify major tail proteins for t4-like myophages. thus, we also searched homologs for the well-characterized t <dig> major tail protein gp <dig> and found  <dig> additional homologous tail proteins. search for the fold of these proteins using hhpred
 <cit>  against a profile database derived from the protein data bank revealed that t4-like mtp likely share the fold of phage λ major tail protein gpv . this suggests that myophages of the t <dig> family also present a tail protein evolutionary linked to that of the siphophages. finally, regarding sheath proteins, the 3d structures are known for phages t4
 <cit>  and phikz
 <cit> . these structures exhibit a common structural core
 <cit>  that was not detected by hhsearch.  <dig> sheath proteins were identified starting from the t <dig> protein, out of the  <dig> myophages in aclame. only  <dig> sheath proteins were identified starting from the phikz protein, corresponding to the giant phages phikz and phiel. within the  <dig> myophages left without any assigned sheath protein, c-st was experimentally shown to be a myophage and should have a sheath protein. on the opposite, p <dig> is a satellite bacteriophage coding for  <dig> proteins, which consistently lacks a sheath protein. at this stage, we identified head, neck and tail proteins within most of the  <dig> phages of aclame.

detection of the head- and tail-completion proteins using remote homology search and genetic context
a bioinformatics procedure was designed in order to systematically detect the phage head-completion and tail-completion proteins, also called head-to-tail connection proteins, within the aclame database . to do so, the characterized head-to-tail connection proteins of phages spp <dig>  λ, hk <dig>  t <dig>  p <dig> and Φ <dig> were taken as starting point. next, their profiles were compared to the database of  <dig> hmms profiles using the profile-profile comparison algorithm hhsearch
 <cit> .figure  <dig> 
identification of head-to-tail connection proteins in tailed bacteriophages and representativeness of the different phage types.  schematic representation of the bioinformatics pipeline used to identify remote homologs of head-to-tail connection proteins. reference hmm profiles of known head-to-tail connection proteins , as well as hmm profiles of each of the  <dig> protein sequences contained in the aclame database, were calculated using psi-blast . these profiles were compared using hhsearch with a stringent probability threshold of 90%, and proteins detected as related to the reference head-to-tail connection proteins were iteratively used as probes in order to detect further homologs . inter-genes distances were then learned  and applied as constraints to faithfully retrieve more remote homologs detected at a lower probability threshold  .  components of the four neck types are represented using the color code defined in figure 
 <dig>  their mean inter-genes distances and standard errors were calculated as illustrated in step  <dig> of panel a.  quantitative distribution of the tailed bacteriophages of known morphology and recognized neck type. sector color code is the following: white, siphoviridae of type 1; light gray, myoviridae of type 1; dark gray, myoviridae of type 2; hatched, podoviridae of type 3; black, podoviridae of type  <dig>  dotted surfaces in type  <dig> sectors correspond to phages with incomplete necks, for which one to two canonical components of the neck were not identified.



type 1
first, all possible head-to-tail connection proteins ad <dig>  hc <dig> and tc <dig> were identified among the  <dig> genomes by searching for homologs of the spp <dig> gp <dig>  gp <dig> and gp <dig> proteins using the program hhsearch with a high confidence probability threshold of 90%. next, the inter-gene distances between the detected ad <dig>  hc <dig> and tc <dig> proteins were calculated and averaged on all genomes. the resulting mean inter-gene distances were  <dig>   <dig> and  <dig> for the ,  and  couples, respectively, corresponding to the gene ordering: ad1-hc1-x-tc <dig>  they could be organised into a mean distance matrix characteristic of type  <dig> neck gene organisation. we also calculated for each couple the standard deviation on the inter-gene distances. from these calculations we deduced a tolerated distance matrix, formed by adding to each mean distance matrix term twice the inter-gene distance standard deviation. the tolerated distance matrix terms were  <dig>   <dig> and  <dig> for the ,  and  couples, respectively. finally, we repeated the iterative profile-profile search with hhsearch, relaxing the probability threshold from 90% to 70%, and keeping only the detected proteins whose gene position was consistent with the tolerated matrix distance. as a result, more than  <dig> neck proteins were recovered .

to control that no false positives were recovered by our relaxed conditions, we checked that we never detected more than one ad <dig>  one hc <dig> or one tc <dig> per phage. we also verified our results in the light of well characterized phages. tc <dig> being a tail completion protein involved in long tail assembly
 <cit> , we anticipated that a neck containing tc <dig> would not be found in podoviridae phages. consistently, no neck containing tc <dig> proteins could be detected in podoviridae phages. some phages do not encode the whole ad <dig>  hc <dig>  tc <dig> panoply. for instance, the neck of phage λ is made of an hc <dig> , a tc <dig>  but no ad <dig>  instead, the gpw protein, with no sequence or structural similarity to ad <dig>  is required for stabilization of the dna within the head and for addition of the hc <dig> protein. this typical case of functional replacement suggests that gpw is positioned in the virion between the portal and the hc <dig> proteins
 <cit> . in our study, a small group of  <dig> siphoviridae and myoviridae phages exhibit hc <dig> and tc <dig> proteins but no ad <dig> proteins. within these phages,  <dig> siphoviridae  and  <dig> myoviridae encode a protein similar to gpw using a confidence threshold of 95% and systematically located at distances of  <dig> to  <dig> from hc <dig> and  <dig> from tc <dig>  thus, our procedure did not detect any spurious remote homologs in the particular cases of necks comprising a gpw-like protein.

we specifically analyzed the genomes lacking only one of the ad <dig>  hc <dig> and tc <dig> elements. searching within the limits imposed by the tolerated distance matrix,  <dig> ad <dig>   <dig> hc <dig> and  <dig> tc <dig> proteins were identified in siphoviridae. these proteins were predicted as having the same secondary structure patterns as the missing ones and were located at distances from the other identified neck proteins compatible with the tolerated distance matrix. they were not automatically selected by our initial profile-profile procedure because their hmm profile was built from a too limited number of sequences . similarly, we identified  <dig> ad <dig> and  <dig> tc <dig> protein in myoviridae phages exhibiting less than  <dig> homologous sequences in their hmm profile. finally,  <dig> additional ad <dig> were identified in myoviridae phages exhibiting a tc <dig> protein, which are separated by  <dig> to  <dig> proteins from tc <dig> . in the latter case, the  <dig> ad <dig> belong to an aclame family also comprising  <dig> other proteins previously identified as ad <dig>  all these neck proteins are described in table 
 <dig> and additional file
2: table s <dig> 

type 2
the head-to-tail connection proteins ad <dig>  hc <dig> and tc <dig> were identified by searching for homologs of the t <dig> gp <dig>  gp <dig> and gp <dig> proteins using the program hhsearch with a 90% confidence threshold. inter-gene distances were calculated between the identified proteins resulting in mean distances of  <dig>   <dig> and  <dig> for the ,  and  couples, respectively. this corresponds to the ordering: ad2-hc2-tc <dig>  the tolerated distance was calculated as above by summing the mean and twice the standard deviation inter-gene distances. the tolerated distances were  <dig>   <dig> and  <dig> for the ,  and  couples, respectively. as for type  <dig>  we constrained the search using this inter-gene tolerated distance matrix and repeated the iterative profile-profile search with hhsearch, relaxing the probability threshold from 90% to 70%. as a result, we identified  <dig> type  <dig> neck proteins .

type 3
the head-to-tail connection proteins ad <dig> and hc <dig> were identified by searching for homologs of the p <dig> gp <dig> and gp <dig> proteins with hhsearch and a 90% confidence threshold. a tolerated inter-gene distance of  <dig> was calculated and used to constrain the search while relaxing the probability threshold of hhsearch at 70%.  <dig> additional type  <dig> neck proteins were thus detected.

we searched for missing ad <dig> and hc <dig> proteins using the secondary structure predictions and the knowledge of their relative positions in the phage genomes. we identified  <dig> additional ad <dig> protein with consistent predicted secondary structure pattern and inter-gene distance to its hc <dig> neighbour. here again lack of homologous sequences in the original profile hindered the homology detection by the hhsearch algorithm. moreover, in  <dig> additional podoviridae, ad <dig> and hc <dig> were identified but their relative distance was comprised between  <dig> and  <dig>  finally, in  <dig> additional phages ,  <dig> ad <dig> and  <dig> hc <dig> were identified per phage, the  <dig> ad <dig> having a relative distance of  <dig> to  <dig> and hc <dig> having a relative distance to ad <dig> of  <dig> to  <dig>  all these neck proteins are described in table 
 <dig> and additional file
2: table s <dig> 

type 4
for this last type, ad <dig> proteins were searched using the Φ <dig> gp <dig> protein as a seed for the iterative profile-profile procedure. ten ad <dig> proteins were detected, that all belong to podoviridae .

scoring of the evolutionary divergence between head-neck-tail modules for phage classification
our analysis identified a set of  <dig> classes of proteins of the head-neck-tail module comprising  <dig> classes from the head ,  <dig> from the neck  and  <dig> from the tail . every class encompasses a number of aclame protein families that were previously thought unrelated and which are now connected through remote homology relationships by the procedure described above. taking advantage of this global view of the head-neck-tail organisation, we searched for a metric which would account for the evolutionary divergence between the phage components of the head-neck-tail module. we used a score depending both on the hhsearch probability  but also on the sequence identity  for closely related sequences.
  <dig>  

the weight of  <dig>  assigned to the percentidentity factor ensured that the latter term only contributes when probahhsearch caps at 100% because values of probahhsearch below 100% generally correspond to remote homology relationships with percentidentity below 25%. for every pair of phages and for all the components of the capsid-neck-tail module , a similarity score was calculated using equation  <dig>  the mean value of all these scores was computed over all the components of the module common to both phages  in order to yield the similarity score between the pair of phages. it was calculated by adding scores corresponding to superfamilies detected in both phages and ignored superfamilies only detected in one of them.

the mean value was used as a metric of similarity of the capsid-neck-tail module between two phages and a nxn matrix of averaged scores was built from the systematic cross-comparison of all n phages of each type. to group together phages sharing similar average scores, the nxn matrices were then clustered using a hierarchical agglomerative clustering with wpgma method  together with euclidian distance and a tree corresponding to each neck type was built from these calculations using the ete <dig> library
 <cit> .

for the phage classification step, we took into account all phages with at least two detected head-to-tail connection proteins in the case of type  <dig> and  <dig> phages , and one detected protein in the case of type  <dig> and  <dig> phages . in the webserver, in order to increase sensitivity, all head-to-tail connection proteins detected with a hhsearch threshold higher than 70% are displayed.

automatic identification of neck proteins and classification of necks in tailed bacteriophages through the virfam server
to enlarge our study to newly sequenced phages, we built the virfam webserver interface through which users can  detect the proteins involved in the neck structure of their phage of interest,  identify the type of neck, and deduce the likely morphological family of the phage,  display the organisation of the genes encoding the major capsid protein, large terminase, portal, neck, major tail and sheath proteins and  locate the given phage within the classification built in this work. after submission through this interface, each input protein is aligned using an hhsearch-based protocol against the virfam collection of  <dig> profiles generated for the present work. phage neck proteins are thus automatically identified and the phage neck architecture is described.

RESULTS
detection of head and tail proteins within the learning dataset
our structural classification of phages relies on the detection of  <dig> genes coding for head, neck and tail proteins. we first searched for homologs of  <dig> head and tail proteins using the homology detection tool hhsearch
 <cit> , which relies on the comparison between pairs of multiple sequence alignments . this tool can reveal more remote homologies between proteins than the profile-sequence comparison tool psi-blast
 <cit> . it was used with a high confidence probability threshold of 90% to search for the portal, large terminase subunit  and major capsid protein  on the head side, the major tail  and sheath proteins on the tail side, among a set of  <dig> complete phage genomes, including  <dig> tailed phages ,  <dig> non tailed phages and  <dig> uncharacterised phages . the  <dig> head and tail proteins could be detected in most tailed phages. details about the initial sequences used for the search, corresponding to proteins of known 3d structures, are given in the experimental procedure section and the complete list of detected proteins can be found in additional file
2: table s <dig> 

detection and classification of head- and tail-completion proteins within the learning dataset
once the head and tail proteins were identified, we focused on the head-to-tail connection proteins to capture the diversity of neck organisations in tailed phages. we concentrated on the identification of a maximum of highly divergent head-to-tail connection proteins. therefore, we identified from the literature several proteins characterized as head- and tail- completion proteins in a number of model phages , and we search for homologs of these proteins within the genomes of the same  <dig> completely sequenced phages. our homology search was performed using the homology detection tool hhsearch, which was now used iteratively to detect highly remote homologs . a stringent confidence probability threshold of 90% was again chosen to identify homologs of our list of starting proteins  among the  <dig> proteins encoded by the  <dig> phages. we detected  <dig> phage head- and tail-completion proteins . most of them were highly divergent from one another . however, despite this drastic divergence, the  <dig> detected proteins combined into a limited number of  <dig> major neck architectures, or neck “types” .table  <dig> 
detected neck modules in the phages classified in aclame



siphoviridae

myoviridae

podoviridae

unassigned
the  <dig> phages in which neck proteins could be detected are detailed. the distribution of the neck proteins in each phage was interpreted in order to assign a neck architecture  to the phage. from the neck architecture and the presence or absence of a sheath protein, the morphology of the phage  could be deduced. for most phages, the morphology obtained from our analysis fits with that proposed by the ncbi . to highlight the consistency between our classification and that of the ncbi, we present in the following table the number of aclame phages as a function of their proposed neck architecture  and ncbi morphological class . more details about the proteins detected for each phage can be found in the additional file
2: table s <dig> and on the virfam webserver.



these neck types display different complexities: they involve one to three head-to-tail connection proteins . type  <dig> necks  are found in siphoviridae and myoviridae. they adopt a structural organisation similar to that of the siphoviridae phage spp <dig> and comprise three head-to-tail connection proteins: two head-completion proteins homologous to spp <dig> gp <dig>  and spp <dig> gp <dig>  and a tail-completion protein homologous to spp <dig> gp <dig> . exception to this rule is found for  <dig> phages , which exhibit an adaptor homologous to gpw of phage λ, a protein with a structure distinct from that of spp <dig> gp15
 <cit> . for these  <dig> phages, the difference is limited to the adaptor since bona fide homologs of hc <dig> and tc <dig> are detected. type  <dig> necks  are only found in myoviridae. they comprise two head-completion proteins homologous to t <dig> gp <dig>  and t <dig> gp <dig> , and a tail-completion protein homologous to t <dig> gp <dig> . finally, type  <dig> , and type  <dig>  necks are mostly found in podoviridae. type  <dig> necks have only two head-completion proteins, homologous to p <dig> gp <dig>  and gp <dig> , and type  <dig> necks have just one connection protein, homologous to Φ <dig> lower collar/tail tube protein gp <dig> 
 <cit> .

using the gene context to detect additional head- and tail-completion proteins within the neck module
at this stage, we observed that several phages could be assigned to one of the four types defined above but lacked one of the neck gene. in particular, about  <dig>   <dig> and 24% of type  <dig> necks lacked an ad <dig>  hc <dig> and tc <dig>  respectively, and about 85% of type  <dig> necks lacked an ad <dig> when using hhsearch with a confidence probability threshold of 90%. we wondered whether absence of these neck proteins was real or due to, once again, the huge sequence divergence.

to further explore the existence of putative very remote homologs, we lowered the confidence probability threshold of hhsearch to 70%. however, such a threshold was found too permissive in some cases and led to the detection of spurious homologs. to improve the detection specificity, we implemented an additional constraint related to the conserved head-to-tail connection module organisation observed among most of the phages . in practice, the distances between the previously detected head-to-tail connection genes were calculated from their positions in the genomes. figure 
2b summarizes the mean distances  observed between type  <dig>   <dig>   <dig> and  <dig> detected genes. we observed strong constraints on the relative position of the head-to-tail connection protein genes, from which we defined distance interval thresholds, corresponding to the mean +/- two standard deviations. using these distance thresholds, we could decrease the hhsearch confidence threshold from 90% down to 70% and detect additional head-to-tail connection proteins without inclusion of spurious homologs.

as presented in table 
 <dig>   <dig> ad <dig>   <dig> hc <dig>   <dig> tc <dig> and  <dig> ad <dig> additional proteins could be identified. in total,  <dig> head-to-tail connection proteins were found. we detected these proteins in  <dig> phages, which were unevenly distributed: type  <dig> neck phages were the most prevalent , while type  <dig>   <dig> and  <dig> necks were found in  <dig>   <dig> and  <dig> phages, respectively . the specificity of our procedure was controlled by the fact that head-to-tail connection proteins were never identified in phages annotated by the ncbi as non-tailed phages: they were all detected in caudovirales or unclassified phages. furthermore, as already noticed, the proposed type classes are consistent with the morphological subfamilies siphoviridae, myoviridae and podoviridae. two exceptions were identified corresponding to phages that are most probably mis-assigned in the ncbi database as deduced from recent experimental data:   <dig> phages annotated as siphoviridae for which we detected podoviridae-like ad <dig> and hc <dig> proteins specific to type  <dig> neck; these phages are stx <dig> and stx <dig> converting phages, which are closely related to 933 w unambiguously recognized as a podoviridae <cit> ;   <dig> phage annotated in ncbi as siphoviridae for which we detected type  <dig> neck proteins and a sheath; this phage was recently reported as a myoviridae by
 <cit> .

detection of a new ne <dig> superfamily gene in the neck module of type  <dig> phages
we analyzed the genome organisation of the head, neck and tail proteins in the  <dig> neck types, and deduced their corresponding average gene organisation . we further explored whether any unannotated gene superfamily might emerge in the vicinity of the neck genes. typically, in all type  <dig> phages, an unannotated gene encoding a protein homologous to spp <dig> gp <dig> , designated hereafter ne <dig> , was detected between the head and tail genes, most frequently positioned as ad1-hc1-ne1-tc <dig> . ne <dig> proteins exhibit an amazing versatility of sizes, ranging from  <dig> to  <dig> residues, which probably precluded their previous identification as belonging to the same protein superfamily. however, most ne <dig> proteins were detected with a hhsearch confidence threshold higher than 95% . the remarkable systematic presence of their gene in type  <dig> neck modules suggests a critical role in the head-to-tail connection assembly or function.figure  <dig> 
classification of the type  <dig> bacteriophages.  tree representation of type  <dig> phage similarities, built from a hierarchical agglomerative clustering procedure applied to a matrix of similarity scores between pairs of phages  and represented using the ete <dig> library
 <cit> . the different branches of the tree were sorted into  <dig> clusters, highlighted by different background colors. phage names labelled by black circles filled in grey indicate the myoviridae phages. bacterial hosts of the phages are indicated in the bottom for each cluster with the same color code as in the classification tree, in order to highlight the consistency between the cluster and host phyla.  gene organisation of a representative phage of each cluster. a more complete view of gene organisation sorted by clusters is presented on the virfam webserver, in order to highlight the consistency between the cluster and neck gene order distributions.



scattered experimental data exist on the function of ne <dig> proteins. in the siphophage λ, in the absence of the ne <dig> protein gpz, viral particles are produced, but they have low infectivity
 <cit> . gpz was proposed to be part of the virion tail
 <cit>  and to represent a conserved family of tail proteins
 <cit> , although the systematic presence of a remote homolog in almost all type  <dig> phages remained hidden due to sequence divergence. the phenotype is slightly different in mutants of the ne1-encoding gene gps of myophage p2: phages form tails that are unable to attach to heads, and are non-infectious, suggesting a defect in the head-tail joining process
 <cit> . because of the systematic presence of the ne <dig> gene in the neck module and of the few experimental data pointing towards an important role of ne <dig> in virion head-to-tail connection assembly and infectivity, we further included the ne <dig> gene in our description of type  <dig> necks .

phage classification from the “head-neck-tail” module analysis
from our analysis of phage necks, we deduced that type  <dig> necks are the most prevalent. considering the large size of this group, we further subdivided it according to a metric which accounts for the “average” evolutionary divergence among the various proteins composing the defined head-neck-tail module. the probability that two protein profiles are similar as calculated by the hhsearch program is an interesting metric for quantifying the degree of remote homology between proteins. however, in case of close homology, typically above 35% of sequence identity, hhsearch probabilities peak at 100% and are not discriminative. to account for the whole spectrum of sequence divergence, we used a similarity score primarily driven by the hhsearch probability but with an additional contribution of sequence identity to properly recognize closely related phages . for every pair of phages, similarity scores were calculated between all components of the head-neck-tail module  and then averaged to yield a mean score reflecting the similarity between the head-neck-tail modules of the phage pair. from this metric, a hierarchical agglomerative clustering procedure was used to obtain a tree representation of phage similarities .

the clustering procedure discriminated ten major clusters within the type  <dig> phage family. inside each cluster, hhsearch probabilities between homologous proteins are often close to 100%, but even in these cases, identities between protein sequences can be very low  . between distinct clusters, hhsearch mean probabilities are on average below 50%, and the connection between these groups is achieved through a limited number of proteins bridging together the whole ensemble .

as illustrated in figure 
3a, the clusters group together phages that infect hosts from the same phylogenetic clades supporting the consistency of the classification. a characteristic of type  <dig> phage is that their hosts spread over the whole bacterial phylogenetic tree which is not the case for all the types defined in our study . also, genome organization of the head-neck-tail module is partitioned in a homogeneous manner among the clusters although no prior constraint related to gene order or to inter-gene distance was included in the clustering metrics . an additional remarkable feature standing out from this classification is that phages from the myoviridae family do not tend to cluster together. phages with a sheath in their genome are spread over more than half of the clusters, namely clusters  <dig>   <dig>   <dig>   <dig>   <dig> and  <dig>  together with closely related phages deprived from a contractile system. such versatility in the presence/absence of a sheath protein had previously been noticed in the case of phages related to mu 
 <cit>  and appears as a general property of type  <dig> phages.

automatic identification of neck proteins and classification of necks in tailed bacteriophages through the virfam server
our analysis and resulting classification enabled to classify  <dig> phages within  <dig> tailed and unclassified aclame phages. to enlarge our study to newly sequenced phages, we built the virfam webserver interface . we challenged the robustness and representativeness of our webserver by investigating  <dig> new phage genomes available at the ncbi . within these phages,  <dig> are annotated as non-tailed phages, and indeed could not be classified by our approach. the  <dig> remaining phages are either described as caudovirales  or unclassified by the ncbi . 93% of these phages could be sorted among the four neck types by our approach . interestingly, the distribution of the different types of phages is similar to that observed in the learning phage database. some phage subfamilies are enriched. for example, at least 7 n4-like phages
 <cit>  are now found within type  <dig> neck phages, and they all lack hc <dig>  thus confirming that the head-closure protein of n4-like phages is highly divergent. in the case of type  <dig> phages, the distribution within clusters is also similar to that observed for the learning set: 89% of these phages could be assigned to one of the previously defined clusters. we conclude that the classification constructed on the  <dig> aclame phage genomes is relevant for a global classification of most of the  <dig> newly analyzed genomes. the virfam server is thus a robust tool for the classification of novel tailed phages and the identification of their structural organization at the head-to-tail interface.figure  <dig> 
typical analysis of a phage that is unclassified in the ncbi database, as provided by the virfam webserver. the virfam webserver can be used to identify the head-neck-tail module in any bacteriophage genome from the set of ordered protein sequences. in the output, the type and cluster inferred from the detected superfamilies will be returned together with  a graphical representation of the components identified in the genome,  a clustering of the query phage with respect to those of same type in the aclame database,  a detailed report from the hhsearch analysis providing the corresponding alignments,  a warning in case unusual inter-gene distances are detected,  a list of the most similar proteins present in the aclame database with a connexion to the corresponding phage and its pre-computed head-neck-tail module analysis page.


neck modules detected through the web server in phages classified in the ncbi database but not in aclame



siphoviridae

myoviridae

podoviridae
percentages are calculated within the siphoviridae, myoviridae and podoviridae subfamilies described by the ncbi. total percentage corresponds to the number of assigned phages  compared to the total number of caudovirales and unclassified phages of the analyzed ncbi database .

discussion
understanding the genomic and structural diversity of phages is a critical challenge, stimulated by the increasing number of available phage sequences. 96% of the bacteriophages isolated so far are tailed bacteriophages. here, we described the structural diversity of a set of proteins essential for tailed phage virion assembly and function, comprising both the semi-conserved capsid, portal, terminase, major tail and sheaths proteins and the more divergent head-to-tail connection proteins. neck proteins are particularly important for capsid completion, hence for the phage life cycle: they form a channel between the head and the tail, that has to close rapidly after dna packaging in order to avoid dna leakage and to reopen after recognition of the targeted bacteria in order to allow infection. despite their diversity, they are thus submitted to significant evolutionary constraints which we attempted to reveal by combining profile-profile comparisons with gene context analyses. our ambition was to evaluate the protein sequence and composition diversity at the head-to-tail connection and to use this knowledge to propose a detailed phage classification related to phage morphology.

robustness of the proposed classification
we first successfully detected a large set of structural proteins present in  <dig> phages, comprising 92% of the siphoviridae, 86% of the myoviridae and 98% of the podoviridae of our learning database . we identified a type and thus a neck architecture for these phages, and proposed a classification within phages of the same type and thus with the same neck structure. this approach enabled classification of 91% of the caudovirales and unclassified phages of the learning database and 93% of the caudovirales and unclassified phages of the ncbi database . the higher success of our procedure in the case of the ncbi database is linked to an overrepresentation of type  <dig> phages, which are more closely related and thus easier to detect.

interestingly, we find that the resulting phage classification is correlated to the targeted bacteria phylogenetic tree: if type  <dig> phages infect a very large number of hosts spanning the whole bacterial phylogenetic tree and in particular cyanobacteria, proteobacteria and firmicutes, type  <dig> and type  <dig> are only found so far to infect cyanobacteria and proteobacteria and type  <dig> are only detected as infecting firmicutes .

it was proposed that within the neck, the portal protein alone is already an efficient marker for phage classification as a function of virion architecture . using our scoring function calculated on the portal protein alone, we built a tree of all the aclame phages . the resulting type classification is similar to that described in our study . using the three mcp, portal and terml protein markers did not improve the discrimination of types . we also observed an overall good consistency between the portal classification and our type  <dig> tree generated using multiple markers.

however, significant discrepancy is observed in the phages hosted by actinobacteria , which were found to group in clusters  <dig> and  <dig> in our type  <dig> multi-protein classification. if only the portal is used, many phages populating cluster  <dig> are spread in different branches of the tree irrespective of the nature of their hosts . moreover, phages giles and min <dig> that were connected to cluster  <dig> are not anymore clustered with phages from actinobacteria. therefore, observations on highly divergent phages from podoviridae or from clusters  <dig> and  <dig> show that the strategy we propose, using neck proteins, is able to discriminate phages hosted by bacteria from the same phylum. the issue noticed for members of clusters  <dig> and  <dig> can also be perceived for cluster  <dig>  which tends to mix within cluster  <dig>  in the portal-only tree . altogether our results show that the portal protein may diverge in evolution while head-to-tail connection proteins still show consistent evolutionary links with proteins from other phages . the metric used to establish the phage similarity matrix account for that property. the fact that our multi-protein classification in four types is  globally consistent with portal-only classification  successful in difficult cases in recognizing phages hosted in bacteria of the same phylum supports the idea that neck proteins bring useful signal to the classification of phages.figure  <dig> 
interest of using a multi-protein analysis for phage classification when portal sequence diverged more than other proteins of the head-neck-tail module. four pairwise comparisons between the head-neck-tail modules of phages whose portal proteins have significantly diverged with respect to other proteins of the head-neck-tail module.  phage phi  <dig>  assigned to type  <dig> cluster  <dig>  has a portal sharing less than 25% identity with any other protein in aclame database. its terml, ne <dig>  tc <dig> and mtp proteins present a significantly higher conservation profile. in particular, compared with hk <dig>  ne <dig> and tc <dig> share 76% and 49% identity with their homologs in phi  <dig>  respectively, while portal only shares 22%.  phage cjw <dig>  assigned to type  <dig> cluster  <dig>  has a portal sharing less than 23% identity with any other protein in aclame database. proteins such as hc <dig> or mtp share a higher conservation profile. in particular, they share 37% and 34% identity with ne <dig> and tc <dig> of phage omega, respectively while the portal only shares 18%.  phage pap <dig>  assigned to type  <dig>  has a portal sharing less than 17% identity with any of the other proteins of aclame database. in contrast, its terml diverged to a lesser extent sharing 35% identity with that of phage st64t.  rm  <dig> is among the most divergent phages assigned to type  <dig>  only an ad <dig> protein could be detected when searching for its head-to-tail connection proteins. although its portal shares at most 22% identity with the closest portal of other phages of aclame, its ad <dig> protein could be recognized with higher identity  providing stronger support for the assignment of this phage to the type  <dig> category.



comparison to previously described whole genome classifications
previous studies have shown that podoviridae and myoviridae could be classified using blast-based tools and phage distance calculations based on global shared genes
 <cit> . these phages were divided into subfamilies, which were recognized as biologically significant and are available on the ictv website
 <cit> . podoviridae were classified into two main subfamilies, picovirinae  that corresponds to the present type  <dig>  and autographivirinae  that perfectly matches with one branch of our type  <dig> . other groups of the type  <dig> classification are close to the tentative p22-containing subfamily and to several of the unclassified genera . hence, our analysis connects in a hierarchical and consistent manner several independent groups of podoviridae, such as autographivirinae and p22-like phages, on the basis of the similarities between their head-to-tail modules.

the ictv classification of myoviridae is more difficult to overlap with ours. these phages were previously classified into three main subfamilies, peduovirinae , teequatrovirinae  and spounavirinae 
 <cit> , plus several other independent genera. the teequatrovirinae subfamily corresponds to the type  <dig> category of our classification. but in our type  <dig> class, myoviridae from the other subfamilies or genera are often mixed with siphoviridae in type  <dig> clusters, suggesting that their contractile character has been acquired or lost in a versatile manner throughout phage evolution. consistent clusters were however retrieved within these myophages. p2-like, mu-like and aaΦ23-like phages that were described as very different, based on blast- analyses
 <cit>  are well partitioned into different type  <dig> clusters. peduovirinae perfectly matches type  <dig> cluster  <dig>  while four previously independent genera of myoviridae are now grouped into type  <dig> cluster  <dig>  finally, the spounavirinae subfamily is left as a special category in which only one ad <dig> component could be identified but no hc or tc subunits recognized so far. although recognized as type 1-like, they could not be further clustered and will be interesting to investigate further.

altogether, our automatic classification tool consistently retrieved the known phage subfamilies as they were described for podoviridae and myoviridae. the remote homology analysis further provides evidence on how to connect independent subgroups based on their neck architecture similarities. moreover, it supports a classification for the siphoviridae and highlights the neck structural relationships between sipho- and myoviridae.

a common structural core for all neck types?
our classification highlights the representativeness of four different types of neck architecture. each type is characterized by a set of specific head-to-tail connection proteins. it is also characterized by a specific distribution of phage genome sizes. tiny phages  generally exhibit type  <dig> necks, common size phages  present either type  <dig> or type  <dig> necks, and large phages often show type  <dig> necks . physical explanations might be discovered in the future that explain this correlation between neck proteins and genome size. interestingly, our scoring of phage protein homologies also suggests that the different neck types might share some common structural properties. indeed, structural analogies exist within each category of neck components, the so-called ad, hc and tc. for instance all four ad <dig>  ad <dig>  ad <dig> and ad <dig> exhibit  <dig> to  <dig> predicted α-helices and hhsearch confidently predicts homology between an ad <dig> and an ad <dig> . comparison between ad <dig> and ad <dig> protein structures consistently revealed that they share the same α-helical bundle fold . similar observations were made on the hc <dig>  hc <dig> and hc <dig> proteins: they are all predicted to fold into a β - strand rich structure and hhsearch suggests homology between a hc <dig> and a hc <dig> . as regards tc <dig> and tc <dig>  secondary structure prediction and our hhsearch calculations again predict that they share a common structural core. moreover, recent determination of the three-dimensional structure of a tc <dig> protein  uncovers its structural analogy with a tc <dig> protein, gpu from phage λ fokine et al.
 <cit> . altogether, these observations support the existence of structural similarities between the components of the various neck types classified in this work and advocate for the existence of a common, highly remote, virion ancestor showing neck structural characteristics close to those highlighted in this study. given the huge diversity of type  <dig> phages highlighted in this work, their ability to populate all bacterial phyla and some archaeal ones , these phages are well suited to represent the ancestral neck organization in caudovirales.

CONCLUSIONS
through the virfam webserver, it is now possible to detect both the relatively well-conserved capsid, large terminase and tail genes and the highly diverse head-to-tail connection genes. differences at the head-to-tail connection in protein number and fold were highlighted within tailed phages, and large differences were observed between phage subfamilies . we showed that these proteins are crucial to define the type of morphology a phage likely adopts. we reasoned that going further into the description of the phage head-to-tail differences should provide a classification based on detailed virion morphology. our study demonstrated that a combination of sequence and profile-profile comparison scores can be used to delineate consistent subgroups in the remote homology space of caudovirales virions. given the high detection rate of the neck genes provided by virfam, most new phages can now be positioned within a “head-neck-tail module based” classification. outside this specific module it is clear that each phage has also evolved and adapted to its specific environment. versatility and reshuffling of gene functions in phage genomes, which often confuse a phylogenetic classification of phages, may have been less intense in the head-neck-tail module. this module may thus serve as a probe for further exploring the evolution of phages.

our methodology enables classification and comparison of viromes. terminases and major tail proteins were previously proposed as phage markers. unlike these single gene approaches, our characterisation of the phage head-neck-tail module is not hindered when one of the genes is particularly divergent, and this gene can even be detected, provided its genome position is canonical. identification of neck genes within a phage genome further suggests that this genome codes for a functional virion, thus differentiating phages and other mobile genetic elements. altogether, as the virfam server allows for an automatic classification of phages, it should facilitate assignment of viromes and detection of functional phages from bacterial metagenomic samples.

availability and requirements
the virfam webserver is accessible at the following address: http://biodev.extra.cea.fr/virfam/. the input is a phage genome. the order of the genes must be preserved because it is used in our analysis. further information on the input format is available by clicking on the “how to proceed” button of the main page.

electronic supplementary material
additional file 1: figure s1: mean arrangement of the neck genes relatively to the head and tail genes in type  <dig> siphoviridae, type  <dig> myoviridae, type  <dig> myoviridae, type  <dig> podoviridae and type  <dig> podoviridae:  inter-genedistance matrices resulting from the analysis of the aclame genomes,  graphical representation ofthe average gene organization for each neck type. figure s <dig>  secondary structure analysis of type  <dig> neck ne <dig> proteins identified in  siphoviridae and  myoviridae.
figure s <dig>  matrices of profile-profile comparison and identity scores  within a typical type  <dig> cluster  <dig> and  between type  <dig> clusters. figure s <dig>  relationship between the identified phage neck types and the host bacteria phyla. figure s <dig>  global tree calculated using only  the portal or  the mcp-terml-portal triad to compute the similarity matrix between phages. figure s <dig>  tree representation of the clustering applied to bacteriophages belonging to the type <dig>  type <dig> and type <dig>  figure s <dig>  distribution of the aclame phages of known morphology as a function of their genome size and neck type. text s <dig>  relationship between neck structural organisation and genome size in tailed bacteriophages. text s <dig>  structural analogies between the different neck types. method s <dig>  procedure to assess the sensitivity of psi-blast search for table 
 <dig>  tables s <dig>  profile identifiers used to test the procedure of remote homology detection using psi-blast. 

 additional file 2: table s1: table of the  <dig> phages from aclame with all proteins assigned by the virfam strategy. 

 additional file 3: table s2: table of the  <dig> most recent phages from the ncbi with all proteins assigned by the virfam strategy. 

 competing interests

the authors declare that they have no competing interests.

authors’ contributions

al encoded the bioinformatics approach and analyzed the results, pt and map contributed to the data analysis, rg designed and encoded the bioinformatics approach and contributed to the bioinformatics analysis. szj conceived the project, analyzed data, supervised the entire project. map, rg and szj wrote the manuscript. all authors read and approved the final manuscript.

