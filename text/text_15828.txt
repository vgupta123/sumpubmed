BACKGROUND
agilent- <dig> whole human genome microarray  <dig> × 44k g4112f consists of  <dig>  oligonucleotides  <dig> nucleotides in length, most of which are annotated as corresponding to the sequence of a known or predicted human gene, along with a number of probes that function as controls. agilent supplies an annotation file for the array. the file provides the sequence of each oligonucleotide, its position on the ncbi human reference assembly, and the gene and transcript putatively associated with it. the annotation file states "this multi-pack  formatted microarray represents a compiled view of the human genome as it is understood today." from here on, we refer to each oligonucleotide as a "reporter", rather than the more commonly used terms oligo, probe, or 60-mer, to indicate that each oligonucleotide is supposed to "report" the expression of a single gene unambiguously. some reporters unambiguously distinguish between transcripts of a single gene, but others hybridize with more than one transcript of the same gene.

we sought to validate the annotations against the current information for the human genome. preliminary analysis showed that a substantial number of reporter annotations are questionable, and that other reporters may not be a specific representation of a unique gene. moreover, some reporter annotations are incomplete and fail to provide a discernible link between an oligonucleotide and a human rna. we therefore validated the reporter annotations against the data present in the ncbi entrez  <cit>  database http://www.ncbi.nlm.nih.gov. because numerous reporters were annotated with an identifier from the gene index project but not recognized by entrez, we used the gene index project  <cit>  as an additional source of transcript data.

entrez is a collection of related databases of biological data, among which are the entrez nucleotide database of biological sequences, the refseq  <cit>  database providing reference chromosome assemblies and transcribed sequences for several species, and the entrez gene  <cit>  database cataloging known genes. agilent includes the refseq rna identifier and entrez gene identifier as standard fields in the annotation file. the refseq identifier is, however, supplied for only approximately two thirds of the oligonucleotides on the chip.

the entrez databases are frequently updated. as our knowledge of the human genome increases, rna and gene records are added and edited. unreliable records are deleted or suppressed. major changes to the data of a gene merit a change in the identifier of the refseq rnas, or even of the entrez gene record. we therefore sought to associate the oligonucleotides on the array with human genes using the blast  <cit>  and splign  <cit>  alignment algorithms, and cross references between current database records, rather than relying on the given identifiers. since entrez databases have been updated multiple times after the agilent annotation file was prepared, some discrepancies were expected. in concept, this study is similar to a study performed by gaj et al.  <cit>  who evaluated the annotations against protein databases, which do not include the increasing number of non-protein coding genes. the method and programs  used to perform this validation should be applicable to other gene chips.

RESULTS
we partitioned the reporters into five distinct categories of descending confidence: fully valid; refseq rna valid; other gene valid; possibly valid; and invalid. lists of these reporters, and where possible, the associated genes and transcripts, are provided as additional files  <dig>   <dig>   <dig>   <dig> and  <dig>  counts of the number of reporters in each category are shown in table 1; for all tables, our results were tabulated by chromosomes, but since we detected no chromosome-specific effects, only genome-wide totals are shown. fully valid reporters can be associated with the transcripts of a single gene and with chromosomal locations that lie within the same gene. refseq rna valid reporters are associated with the refseq rna transcripts of a single gene, but for one of the reasons described below cannot be placed within the chromosomal extent of a single gene. other gene valid reporters can be placed on the chromosome within the location of a single gene, but the reporter either lies in an intron of that gene or in a transcript not yet in refseq. possibly valid reporters can be placed at a unique location on the human reference assembly, but this location is not the position of a gene currently in entrez gene. despite the lack of solid evidence to associate a possibly valid reporter to a gene, for studies relating expression levels to genomic positions , it makes sense to include these reporters. the division into categories is dependent on the current contents of the refseq and entrez database, which are frequently changing.

the far right column shows the total number of eligible reporters, and the other entries show the total number of reporters in each category.

as explained in methods, we restricted our analysis to the  <dig> reporters labeled as being on an autosome or on the x chromosome. we consider  <dig>  reporters to be fully valid and associated with a single gene in refseq. a fully valid reporter must have megablast alignments to the refseq rna transcripts of exactly one gene in entrez gene, and at least one of those alignments must be high-quality as defined in methods. an example of a reporter that fails the uniqueness test is 1591a because it has 100% identical matches to two related genes prame <dig> and prame <dig>  the alignment to a transcript should be in the forward  direction; reporters that have only alignments in the reverse direction are invalid. if a reporter has alignments in the reverse direction, but also has at least one high-quality forward alignments to a refseq rna whose status is more definite than "model", then the reverse alignments are ignored and the reporter remains under consideration for being fully valid or refseq rna valid. table  <dig> summarizes the results of aligning reporters to refseq rna. the distinction between fully valid and refseq rna valid is that fully valid reporters are placed by splign on the reference assembly of chromosome specified by agilent and within the entrez extent of exactly one gene, which must be the same gene found by alignment to refseq rna. fully valid reporters are permitted to have additional alignments to their corresponding gene, to the reverse complement of a different gene, to intergenic regions, or to untranscribed pseudogenes.

the first column show the total number of eligible reporters. the second column shows the number of reporters eliminated because they align to the reverse complement of a refseq rna. the third column shows the number of reporters eliminated because they align to the transcripts of more than one gene. the fourth column lists the number of reporters that align to the transcripts of a single gene. the fifth column shows the number of reporters that did not have a sufficiently high-scoring alignment to a refseq rna. reporters that could be counted in more than one column of the third through fifth columns are counted in the leftmost column.

there are  <dig>  reporters that align to the transcripts of a single refseq gene, but that splign did not place within the accepted extent of exactly one gene. we do not consider such reporters to be fully valid, but rather place them in the category of "refseq rna valid." reporters in this category fall into four distinct classes . the first class consists of reporters not placed within the accepted extent of any gene. for example, id 22872b is supposed to match gene slc35d <dig>  but maps approximately  <dig>  kbp away from the refseq extent of slc35d <dig>  the second class includes reporters placed within the extent of more than one gene. the additional alignments may be to introns, or may instead be parts of transcripts not yet included in the refseq rna database. the third class includes reporters that are placed at a single location on the reference assembly, but this position lies within the extent of more than one gene because the genes themselves overlap. for example, reporter 5099c matches gene kti <dig>  which lies in an intron of another gene txndc <dig>  we consider it likely that reporters in this third class identify the transcripts of a single gene, but to avoid potential confusion we do not include these reporters in the list of those that are fully valid. the fourth class consists of reporters that align to a different gene than the one found by aligning to rna transcripts. we did not need to consider the class of genes on chromosome x that are duplicated on the y chromosome; no reporters mapped to the positions of these genes.

the first column is the total number of eligible reporters, which is the same data as the fourth column of table  <dig>  the second column shows the number of reporters that have a valid placement in a unique gene; this is the same data as the first column of table  <dig>  the third column shows the number of reporters that did not have a high-quality placement. the fourth column shows the number of reporters that have multiple placements and are placed in the location of more than one gene. the fifth column shows the number of reporters with a single placement, but a placement within overlapping genes. the sixth column shows the number of reporters placed in a single gene, but not the same gene as found by alignment to rna. the sum of the four rightmost columns gives the  <dig> rna valid reporters in table  <dig> 

we do not require that the geneid associated with a reporter during the validation process matches the geneid supplied by agilent, nor that the chromosomal positions match exactly. geneids may differ because the entrez and refseq databases are not static, and sometimes updates to records merit changes in an identifier. the positions found by splign sometimes disagree with the positions supplied by agilent because a splice site occurs within the alignment, and splign resolves the splice differently. there are also  <dig> reporters that are fully valid, but align to more than one position within their identified gene.

excluding the  <dig>  fully valid and refseq rna valid reporters leaves  <dig>  reporters. among those,  <dig> were found to be invalid by the tests of alignment to refseq rna , leaving  <dig> reporters for further evaluation. we were able to associate  <dig> of these with a putative transcript included in entrez nucleotide or the gene index database  <cit>  using the identifier provided in the annotation file; the remaining  <dig>  reporters were considered invalid and were excluded from further consideration by rules described in methods .

the first column shows the number of reporters that did not have an alignment with a refseq rna; these data are also shown as the fifth column of table  <dig>  the second column shows the number of reporters that had no discernible identifier in the annotation file. the third column shows the number of reporters for which the annotated identifier had been suppressed or removed in entrez nucleotide. the fourth column shows the number of reporters that did not align with the annotated sequence. the fifth column shows the number of reporters that could be associated with a putative transcript. reporters that could be counted in more than one of the second through fourth columns are counted in the leftmost column.

we used splign to place the remaining  <dig> reporters on the human reference assembly. table  <dig> summarizes the results of performing this placement. of the  <dig> reporters,  <dig> are placed within the extent of exactly one gene, and this gene is on the chromosome specified in the annotation file. we refer to these reporters as "other gene valid". reporters that also align to the reverse complement of a gene are not included in this category, because we do not have sufficient evidence to suggest that the forward copy, rather than the reverse, is transcribed. moreover,  <dig> of the  <dig> reporters may be placed at a single position on the reference assembly, though this position is not the location of a known gene. we categorize these reporters as "possibly valid" . any secondary placement of a reporter suffices to exclude it from this category, because entrez gene does not provide sufficient evidence to determine which unit of transcription, if any, the reporter measures.

the first column is the total number of eligible reporters, which is the same data as the fifth column of table  <dig>  the second column shows the number of reporters that could not be placed. the third column shows the number of reporters that have multiple placements and are placed in the location of more than one gene. the fourth column shows the number of reporters with a single placement, but a placement within overlapping genes. the fifth column shows the number of reporters with a unique placement on an unexpected chromosome. the sixth column shows the number of reporters that could be associated with a unique gene and thus are considered positionally valid. the seventh column shows the number of reporters that could be associated with a unique placement, not on a gene. the sixth and seventh columns of this table are the same as the third and fourth columns of table  <dig>  reporters that could be counted in more than one column of the second through fifth columns are counted in the leftmost column.

discussion
we initiated a study to re-evaluate published expression data that were suspicious because they suggested that some mouse genes hybridized better to the agilent  <dig> ×  <dig> chip than the orthologous human gene, even though the chip is designed to hybridize to human genes  <cit> . preliminary sequence analysis showed that some of the reporters did not align to any known human rna, and others aligned only to reverse complements. therefore, we decided to check the annotation file reporter by reporter. to our surprise, approximately 23% of the reporters failed basic tests and could not be assigned any meaning. thus, the signal intensities of these reporters, which we call "invalid", do not provide useful information as to the expression level of a specific gene. while we had expected some reporters to be problematic - perhaps 5-10% - due to updates to information about the human genome, we did not, however, expect that as much as 40% of the reporters on a 44k gene expression array would for one reason or another yield uninterpretable data. the distinction between 40% uninterpretable and the earlier 23% includes reporters that map uniquely to the human genome but not to a region covered by a refseq transcript; for example, this includes reporters that map to an intron.

a search with pubmed and google found that numerous studies have used agilent  <dig> × 44k human expression chips; we cite  <dig> examples from different research groups  <cit> . each paper has a small subsection in methods explaining how the  <dig> ×  <dig> arrays were hybridized and how the data were analyzed. none of these  <dig> studies seems to have considered the possibility that the annotations provided do not correspond unambiguously to human genes. the methods in two studies  <cit>  describe some steps to restrict analysis to those reporters for which the agilent annotation includes a human gene symbol. another study  <cit>  used a pre-established list of genes, but does not explain how gene identifiers were matched to the annotation file. the lack of a gene symbol in the annotation file eliminates  <dig> of the  <dig> reporters we consider invalid, and also eliminates  <dig> of the  <dig> fully valid reporters,  <dig> of the  <dig> refseq rna valid reporters,  <dig> of the  <dig> other gene valid reporters, and  <dig> of  <dig> possibly valid reporters. of the  <dig> reporters with a gene symbol, we consider  <dig>  fully valid. our validation of the annotated transcript identifier invalidates fewer reporters than a test for the presence of a gene symbol, and would not, by itself, be an effective filter. an example of a fully valid reporter that is not annotated with a gene symbol or the identifier of a transcript is reporter id  <dig>  which aligns perfectly to transcripts of the gene rpp <dig> .

standards for microarray experiments, such as miame  <cit> , are evolving. generally, these standards seek to ensure that the experiments and data analysis are sufficiently detailed so as to be reproduced at another site. the miame paper  <cit>  does recognize the potential for annotation problems, stating, for example, that "because references to an external gene index may not be stable, it is essential to physically identify each element's composition. disclosing the nature of the relationship between an array element and its cognate gene's transcript allows informed assessment..." however, there seems to be no easy-to-enforce mechanism to ensure that the annotations that come with an expression array are internally consistent, let alone consistent with changing external genomic databases. so long as researches follow miame and deposit data in detail, it is possible to apply reporter validation post-facto.

CONCLUSIONS
we hope that our reporter-by-reporter validation of the  <dig> × 44k array annotations will prove useful for labs using these chips. our recommendations are the following:

 <dig>  it is safe to use the  <dig> fully valid reporters.

 <dig>  it is unsafe to use the  <dig> invalid reporters.

 <dig>  the  <dig> reporters that are either refseq rna valid or other gene valid might be used for gene-based studies.

 <dig>  the  <dig> reporters that are in any of the three intermediate categories  might be used for position-based studies.

 <dig>  in any study that uses reporters in the three intermediate categories and reports either genome-wide or chromosome-wide results, the analysis should be repeated with the fully valid reporters only to verify that this more reliable subset provides qualitatively identical results.

