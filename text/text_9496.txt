BACKGROUND
thousands of prokaryotes have been cultivated and sequenced to explore the extent of biological diversity of the microbial world  <cit> . however, studies based on 16s ribosomal rna approaches estimate that only a small fraction of the living microbes can be easily isolated and cultivated in laboratory conditions, thus single genome sequencing is not applicable for the majority of microbial species  <cit> . it means that the current knowledge of genomic data is highly biased and do not represent the true picture of the microbial species  <cit> . in addition, single genome sequencing ignores the interactions such as coevolution and competition between organisms living in the same habitats, which fail to reveal the real state of microbial organisms in nature.

these limitations can be circumvented by metagenomics, a methodology for studying microbial communties by directly sampling and sequencing shotgun dna fragments from their natural environments without prior cultivation  <cit> . it is becoming a powerful method to reveal genomic sequences from organisms in natural environments, especially for communities resided in or on human bodies that are closely related to human health. with the evolutionary development of sequencing technologies, dna sequences can be produced at much higher throughput with much lower prices than before. so far, hundreds of samples from various environments, such as, acid mine drainage  <cit> , sargasso sea  <cit> , minnesota soil  <cit>  and human gut microbiome  <cit>  have been sequenced by traditional sanger sequencing and the next-generation sequencing  technologies like roche <dig> and illumina.

accurate gene prediction is one of the fundamental steps in all metagenomic sequencing projects. however, it is more complicated in metagenomes than in isolated genomes. firstly, most fragments are very short. many sequences in metagenomic sequencing projects remain as unassembled singleton reads or short-length contigs. therefore, lots of genes are incomplete with one or two ends exceed the fragments, which is not a problem in complete genomes. also, a single fragment usually contains only one or two genes, non-supervised methods for single genomes which require an adequate number of genes for model training are inapplicable for this situation  <cit> . secondly, the anonymous sequence problem, which means the source genomes of the fragments are always unknown or totally new  <cit> , brings challenge on statistical model construction and feature selection.

two types of approaches are commonly used for predicting genes from metagenomic dna fragments. one is the evidence-based method that relies on homology searches. it includes comparisons against known protein databases by blast packages, critica  <cit>  and orpheus  <cit> . usually, it is able to infer functionalities and metabolic pathways of the predicted genes via significant targets with a high specificity if the threshold is stringent. however, only the genes with previously known homologs can be predicted by this means, while the novel genes, which are very important to metagenomic studies, will be overlooked. therefore, ab initio algorithms that can present much higher sensitivity along with sufficient high specificity are indispensible.

despite the anonymous and short fragmentary nature of sequences, several ab initio methods have been specially designed for metagenomic fragments in recent years  <cit> , reporting that the performance on 3' end of genes is comparable with it on single genomes. most of these previous methods based on modeling sequences in a markov architecture of various orders. for example, metagenemark incorporates a hidden markov model to depict the dependencies between the frequencies of oligonucleotides with different length and the gc% of a nucleotide sequence by using direct polynomial and logistic approximations. it is found that the fifth-order markov model obtained by logistic regression of hexamer frequencies performs the best  <cit> . glimmer-mg was developed based on the glimmer framework, which uses the interpolated markov models with variable-order for capturing sequence compositions of protein-coding genes  <cit> . orphelia is a recently proposed metagenomic gene finder based on the machine learning approach that by pass the markov model  <cit> . it integrates mono-codon and di-codon usage, sequence patterns around tiss, orf length and gc content into an artificial neural network to estimate the probability of an orf to be protein-coding.

to overcome the anonymous sequence problem, metagene and metagenemark train separate models for archaea and bacteria as studies have shown that the dependency patterns of oligonucleotides from gc content are different in the two domains of life  <cit> . an incoming fragment will be predicted by both models and the one with the higher score is chosen. in metaprodigal, current complete genomes are firstly classified into  <dig> clusters according to the gene prediction similarity of prodigal training files. then, these clusters are used for learning another  <dig> training files for gene prediction in metagenomic fragments. a given fragment will be scored by the training files within a range of its gc content  <cit> . glimmer-mg reported that the integration of sophisticated classification and clustering schemes based on interpolated markov models to parameterized gene prediction models produces much better results than using gc-content  <cit> . in one of our previous works, metatisa introduced a k-mer method for binning sequences before tis relocating. it also works well to achieve substantial improvement for tis prediction  <cit> . in this article, we present a novel gene prediction method metagun for metagenomic fragments based on a machine learning approach of support vector machine . three sets of statistics are integrated to depict the coding potential for a candidate orf, the edp of codon usage, the tis scores and the orf length. the triplet nucleotides pattern is one of the most important statistic properties for discriminating protein-coding sequences from non-coding dna. different from most of the current metagenomic gene finders, metagun describes the codon usage of orfs by using an edp model instead of the markov model. the edp model was used to measure the coding potential of orfs based on the amino acids usage for single genomes in our previous works  <cit> . to be more sophisticated, the edp model is extended to base on the codon usage for metagenomic fragments. sequence patterns around tiss are also important signatures that can improve gene prediction performance  <cit> . in this work, we implement a tis scoring strategy based on hundreds of precomputed tis parameters trained by the tritisa program to get the tis scores for a given orf  <cit> . the length of an orf is the third integrated feature that has been reported to be another important measure for distinguishing genes from random orfs in both isolated and metagenomic genomes  <cit> . recently, special efforts have been made in predicting correct tiss by some current metagenomic gene finders with substantial achievements  <cit> . in metagun, an upgraded version of metatisa is employed for adjusting the tiss for predicted genes. to identify protein-coding sequences, metagun builds two gene prediction modules, the universal module and the novel module. the former is based on  <dig> prokaryotic genomes representatively covering a wide range of phylogenetic clades, genomic gc content and varied living environments. the latter is designed to find potential functionary dna sequences with conserved domains.

metagun is freely available as open-source software from http://bioinfo.ctb.pku.edu.cn/metagun/ under the gnu gpl licenses.

materials and methods
data sets
genomic data and annotations of  <dig> complete genomes  are obtained from ncbi refseq database for training the supervised svm classifiers and the fragments classification model.  <dig> species  used in previous methods are also chosen for evaluating the prediction performance here  <cit> . since the genomes of the  <dig> species are included in the training set, it is worth noting that we excluded them from the training data when assessing the performance on these genomes. the  <dig> genomes with experimentally characterized gene starts are used for evaluating tiss accuracy  <cit> . two samples of human gut microbiome are used for investigating novel gene discovery ability of current methods  <cit> . genomic sequences and corresponding annotations of them are obtained from img/m website.

architecture of metagun algorithm
to predict genes, metagun runs in three stages. firstly, a k-mer based naïve bayesian sequence binning method is employed to assign all incoming fragments into phylogenetic groups just like in our previous work metatisa  <cit> . in metagun, it is worth noting that fragments are assigned into both the genus level and the domain level . the former is used for supervised tis scoring parameters selection and tis prediction, and the latter is applied to determine the svm classifiers for gene prediction. secondly, all possible orfs  are extracted from the fragments and scored by their feature vectors with svm classifiers of supervised universal prediction module and sample specific novel prediction module for each domain independently. that is, a regressive probability is assigned to an orf depending on its distance from the separating hyperplane in the feature space of the svm classifier  <cit> . the orf with a probability larger than the given threshold is regarded as protein-coding. finally, a modified version of metatisa is used to relocate the tiss of all predicted genes to obtain high quality tis annotations.

fragment classification
since fragments in metagenomes can originate from diverse species, one of the most challenges is how to train statistical models that can properly capture features of sequences from different source genomes. moreover, the short nature of metagenomic fragments further complicates this problem. most published gene finders for metagenomes incorporate a sequence classification procedure implicitly or explicitly. for example, metagene and metagenemark train separate models for two domains. since they are based on the markov model, input sequences are assigned to the domain whose model gives a higher score implicitly while predicting  <cit> .

we employ a k-mer method based on a naïve bayesian classifier for sequence binning before gene prediction  <cit> . the binning model is trained on complete sequences of the selected  <dig> genomes by calculating the frequencies of k-mer oligonucleotides for each of them. for a given fragment s with the length of n bases, the probability of finding it in one of the  <dig> genomes can be calculated according to the overlapping  oligonucleotides by using bayesian classification. then, the fragment s is regarded as originating from the genome with the highest poster probability . it has been successfully implemented in our previous work metatisa  <cit> . to predict genes, we follow the strategy to train separate gene prediction models for archaea and bacteria that metagene and metagenemark have applied. therefore, the fragments will be also clustered into two different domains according to the phylogenetic relationships of the assigned genomes, and predicted by corresponding gene prediction models independently.

feature selection for svm
the support vector machine approach has been widely used in solving prediction problems in bioinformatics that can be represented in the form of a binary classification, such as gene identification, protein-protein interaction prediction and horizontally transferred gene detection  <cit> . it can learn more accurate classifiers for patterns that cannot be easily separated in the input space by transforming the input patterns into a feature space using a suitable kernel function . selecting relevant features for machine learning approaches is important for a number of reasons such as generalization performance, running efficiency and feature interpretation. the support vector machine method makes no exception. in this work, we utilize three sets of statistics to elucidate the coding potential, the edp description of codon usage, the tiss scores and the orf length.

edp description of codon usage
the difference of sequence composition is the primary feature for discriminating protein-coding genes from non-coding sequences. this statistical property has been frequently used for gene prediction of prokaryotic genomes for a long history including both the isolated genomes and the metagenomes  <cit> . in our previous works of gene prediction in complete genomes, the edp model was used to describe the global properties of orfs for calculating the coding potential on the basis of the amino acid usage  <cit> . its success validates the hypothesis that the protein-coding genes distribute separately from the non-coding orfs in the edp phase space, which may be caused by different selection pressures during the evolution  <cit> . to be more sophisticated, the edp model was extended to be based on the 61-dimension codon usage and was found to be more accurate. so that the edp {si} of an orf in this article is defined as:

  si=-1hcilogci 

where ci is the abundance of the ith codon obtained by counting the number of it in the sequence divided by the total number of codons, i =  <dig>   <dig>  ...,  <dig> represents the index of the  <dig> codons , and h=-∑i=161cilogci is the shannon entropy.

translation initiation site scores
the common motifs and surrounding sequences around the tiss are also important signatures of protein-coding genes  <cit> . to integrate this feature into metagun, we implement the metatisa algorithm in a supervised manner to get the tis scores. for each candidate tis in an orf, the probabilities to be the true tis , to be the start codon from non-coding region  and to be the start codon from coding region  are estimated by metatisa according to the precomputed tis parameters of the  <dig> training genomes. the choice of the tis parameters are determined by the fragment classification results of the genus level. the one with the highest pt will be regraded as the predicted tis in this stage, and the three probabilities of this tis are treated as the tis scores of the orf. figure  <dig> shows the distinguished distributions of the three tis scores in protein-coding genes and non-coding sequences of artificial fragments sampled from escherich coli k <dig>  however, note that many orfs in metagenomic fragments are incomplete with no leftmost candidate starts or even no candidate starts for the short lengths. to avoid complicating the problem by estimating whether the true tiss run off the edges of the fragments or not, we simply construct separate models for these two types of orfs. that is, the tis scores are ignored for the orfs with incomplete 5' ends. actually, the true tiss of genes with missed 5' ends are not included in the fragments in most cases because tis prefers to be the leftmost of a gene  <cit> .

the length of orfs
the orf length is another useful feature that has been frequently used for the discrimination of protein-coding and non-coding orfs  <cit> . it is reported that the average length of genes in complete genomes is about  <dig> bp, which is much longer than random orfs  <cit> . in some current methods, a log-odds score or log-likelihood ratio is assigned to a given orf according to the distributions of protein-coding genes and non-coding orfs that are trained on complete genomes  <cit> . however, the difficulty in integrating the orf length feature is that a lager number of orfs are incomplete for the short nature of metagenomic fragments  <cit> . this phenomenon indicates that the complete and the incomplete orfs should be treated separately. since metagun is built on a machine learning approach of the svm, it is very convenient to accomplish the complete and incomplete issues in orf length for they can be treated as two separate features. hence, two values are assigned as orf lengths, one for complete and the other for incomplete. for a specific orf, the value of the corresponding type is set as the actual orf length, while the other value is set to zero.

the composition patters of sequences from archaeal and bacterial genomes have been reported to be different, and tests have shown that the prediction scores will be degraded if models from the wrong domain are employed for scoring  <cit> . therefore, separate svm classifiers for achaea and bacteria are trained on corresponding training genomes to server as gene prediction models in metagun.

gene prediction model training
to identify protein-coding genes, metagun comprises two gene prediction modules namely the universal module and the novel module. svm classifiers of the universal gene prediction module are trained based on complete genomes with the purpose of capturing the universal features of current known genes. in this work, to build the universal prediction module,  <dig> species are selected from ncbi refseq database release  <dig>  according to the 'one species per genus' rule  <cit> . the selected  <dig> species cover a wide range of phylogenetic clades, gc content and are isolated from varied environmental conditions, which can serve as good representatives for sequenced microbes. the amount of sequenced complete microbial genomes is growing dramatically with the revolutionary development of sequencing technology, however, we have found that our method based on these training genomes performs good results , which indicates that the selection of training genomes do capture the universal features of current known genomes. moreover, many metagenomic sequencing projects aim to study the unculturable microorganisms, whose complete genomic sequences are currently unavailable. in these studies, the discovery of new genes with novel functionality is one of the principle objectives  <cit> . methods have been developed for the detection of the novel genes based on searching for conserved domains against known databases  <cit> . the domain-based searches have been reported to be more sensitive to target genes than sequence similarity based methods like blastp because conserved domains other than the whole sequences are compared  <cit> . for instance, bork et al. applied the conserved domain analysis to rcae proteins, and predicted  <dig> novel domain architectures that may have potential novel functionalities in habitats with little or no light  <cit> . in our work, in an effort to address the novel gene prediction issue, a sample specific novel prediction module based on domain searches is incorporated.

universal prediction module
to train svm classifiers of the universal gene prediction module, artificial shotgun fragments are randomly sampled from the complete genomic sequences for each of the  <dig> training genomes by metasim to form 3x coverages  <cit> . we generate fragments with lengths ranging from  <dig> bp to  <dig> bp in order to simulate dna sequences from different sequencing technologies. then, all complete and incomplete orfs are extracted from these fragments and represented as input feature vectors for training svm classifiers. those can originate from the annotated genes are used as training instances of protein-coding class, whereas others are treated as items of non-coding class. orfs less than  <dig> bp are ignored, for they are too short to provide useful information. the training data of bacteria and achaea are constructed by mixing together the feature vectors of orfs from the same domains, and svm classifiers are then trained independently. different types of discriminatory functions can be learned by the svm algorithm with the combination of a number of kernel functions, such as linear kernel, polynomial kernel and gaussian kernel. meanwhile, the performance usually gets better if more training items are included, however, the training time grows exponentially along with the size of training data. since the amount of training items in each domain is large, especially for bacteria because hundreds of species are involved, we need to learn sufficient good classifiers with proper training size, as well as finding the most suitable kernel function for metagenomic gene prediction. hence, experiments are carried out to evaluate the prediction accuracies on simulated fragments of the  <dig> testing genomes, with svm classifiers trained on different kernel functions and various training data size. the results  show that the non-linear kernels  behavior much better than the linear kernel, and between non-linear kernels, the performance on gaussian kernels are slightly better. meanwhile, we find that  <dig>  m is a proper training size of both sufficient and efficient since the observed accuracy improvements brought by larger training size are marginal. therefore, in this stage, a subsets of training data is randomly sampled into  <dig>  m for each domain to train svm classifier with gaussian kernel function separately.

the gene prediction methods are denoted by abbreviations. mg: metagun, mgc: complete version of metagun that trained on all  <dig> training genomes, mp: metaprodigal, glm: glimmer-mg, mgm: metagenemark, fgs: fraggenescan, mga: metageneannotator, net: orphelia.

novel prediction module
in the purpose of predicting genes that might be difficultly recognized by the universal gene prediction module, the sample specific novel module is then incorporated into metagun based on the domain search approaches. firstly, the extracted orfs are translated into amino acid sequences and searched for conserved domains against the conserved domain database  database. those carrying detected domain motifs with significant e-values  are treated as training data of genes. to obtain the training instances of non-coding orfs, we follow gismo to implement the 'shadow' rule  <cit> . that is, an orf overlapping more than  <dig> bp with a targeted gene in another reading frame is regarded as a non-coding orf. then, the training data is clustered into two phylogenetic groups of archaea and bacteria according to the fragments classification results, and is employed as input feature vectors for training svm classifiers for each domain independently. if the size of training items is larger than  <dig>  m, a subset of  <dig>  m will be randomly sampled for training svm classifier according to the experience in the universal prediction module; otherwise, the whole training set will be used.

libsvm package is employed in our work to train the svm classifiers with gaussian kernel function for both the universal prediction module and the novel prediction module  <cit> . in each training procedure, a grid search of feature space is firstly implemented to find the most suitable gaussian kernel parameter γ and svm parameter c . then all items in the training set of both the protein-coding and non-coding classes are implicitly mapped from the input space to the feature space that is determined by the gaussian kernel under the learned best γ and c. finally, a hyperplane  is learned by the svm training program that optimally separates all training protein-coding and non-coding items.

translation initiation site prediction
accurate gene starts prediction is also a very important issue in metagenomic sequencing projects which is indispensable for experimental characterization of novel genes, however, has not been studied much in the literature  <cit> . tis prediction for complete genomes has a long history and a number of tools have been developed  <cit> . the difficulty of tis prediction in prokaryotic genomes is the divergency of the regulatory signals which indicate divergent translation initiation mechanisms. studies have revealed that in the upstream of the tiss there are sd motifs for leadered genes and non-sd signals for leaderless genes  <cit> . however, the short and anonymous nature of metagenomic fragments present more challenges.

in one of our previous works, metatisa has been built to accomplish this problem and has greatly improved the tis annotations for metageneannotator  <cit> . recently, two works have paid special attentions to the tis prediction and have achieved substantial progresses  <cit> . for example, metaprodigal follows the same strategy as prodigal, its version for isolated genomes, to use a tis scoring system that integrates default scoring bins based on prior rbs motifs and rigorous searches for alternative motifs if no sd motifs appears  <cit> . it also reported that the published metatisa tends to predict starts to downstream start codons for the genes whose true tiss are close to or run off the edge of the fragments  <cit> .

according to exhaustive analysis, we modify metatisa by amending two settings and the supervised tis parameters when dealing with incomplete genes. in previous metatisa, the distribution of pco is used for estimating whether the 5' most candidate tis is from coding regions or not for genes incomplete in their 5' ends  <cit> . however, it is too stringent to set the confidence level at 99%. many candidate tiss actually locate in coding region are regarded as upstream candidates, and then the algorithm runs to find the false tiss downstream in the coding area. tests on simulated sequences from e. coli k <dig> show that the threshold should be loosen to the confidence level at 95% to achieve the best results. another practical problem for some genes is the insufficiency of upstream bases for tis scoring. the published metatisa requires  <dig> bp upstream sequences of a candidate tis to calculate the three poster probabilities. as a result, tis candidates not satisfying this requirement will be overlooked. experiments are performed to obtain the optimal value of the minimal requisition of upstream bases . moreover, various orders of markov models and the supervised tis parameters that trained on different annotations  are investigated. based on the performance shown in figure  <dig>  we determine to set the minimal requisite length of upstream sequence as  <dig> bp, the maximum order of markov model to be  <dig> and all precomputed tis parameters are trained on tritisa annotated genes.

RESULTS
due to the lacking of experimentally characterized genes and translation initiation sites in metagenomic sequencing projects, the performance of current methods are all evaluated on simulated fragments  <cit> . however, two significant drawbacks of this methodology should be noted. firstly, most annotated genes in ncbi refseq and genbank database have not been verified by experiments. annotation errors have been reported in some species, especially for the genomes with high gc-content  <cit> . so, in recent studies of metagenomic gene finders, annotated hypothetical genes are removed from the benchmarks for reliable assessment  <cit> . secondly, the reliability of tis annotations in public databases is also suspicious. large scale computational evaluation has been reported that refseq's tis annotations biased to over-annotate the leftmost start codons and under-annotate the atg start codons  <cit> . here, in the performance comparison of gene prediction, we follow metagene and orphelia to choose the  <dig> genomes which have a good coverage of archaea and bacteria, as well as varied levels of gc content. considering the mentioned problems in refseq annotations, we follow the same strategy as metagenemark to discard the fragments containing any annotated hypothetical genes  <cit> . moreover, the tis prediction accuracy are not evaluated on these genomes for the unreliability of tis annotations. instead, we use the  <dig> genomes where experimentally characterized gene starts are available for tis prediction assessment  <cit> .

gene prediction performance on artificial shotgun sequences
we compare the prediction performance of metagun on 3' end of genes with  <dig> current metagenomic gene finders in this section. artificial shotgun fragments with 3x coverage are simulated for each of the  <dig> testing genomes. to demonstrate sequences produced by different sequencing technologies, three kinds of simulation are created with different sequence lengths  according to the settings in glimmer-mg  <cit> . in addition, fragments with length of  <dig> bp are also simulated in order to investigate the performance on assembled contigs of larger size. predictions with exactly matched 3' ends or matched reading frame if 3' ends are missed are regarded as correctly predicted genes, that is, the true positives. the sensitivity  and the specificity  are defined as the true positives in all annotated genes and in all predicted genes, respectively. we also use the harmonic mean value as a composite measure of sensitivity and specificity, which is defined as  <dig> snsp/. note that unlike the comparisons in glimmer-mg, simulated fragments overlapping annotated hypothetical genes are excluded from the testing sets in this work, hence the benchmarks are complete and the measures of sensitivity and specificity are both meaningful.

the predictions of other methods are obtained by local running. the 'complete' model parameter trained for error-free sequences is set to run fraggenescan  <cit> , and both the 'net700' and 'net300' model are used for running orphelia and the better result is chosen for comparison  <cit> . others are implemented by default settings. for comprehensive investigation, we run two versions of metagun, one is trained on all  <dig> training genomes which denotes as 'mgc' in table 1; the other is trained on genomes excluding  <dig> testing genomes which denotes as 'mg'. the comparisons with other methods is based on the 'mg' version. in addition, since most metagenomic gene finders overlook genes less than  <dig> bp, we only evaluated genes with length more than that.

the accuracies are shown in table  <dig>  for fragments of longer length, that is  <dig> bp,  <dig> bp and  <dig> bp, metagun outperforms other gene finders in harmonica mean with values over 96%. while for shorter fragments of  <dig> bp, performance falls severely for all methods, especially orphelia. this illustrates one of the challenges for predicting genes on short sequences is the uninformative incomplete orfs. at this length, metagun and glimmer-mg achieves comparable performance with more than 91% in harmonic mean, which is much better than other methods. it is worth noting that metagun always makes the best specificities among all simulations with different fragment lengths, which means its prediction is the most reliable. the orphelia method, the other one based on the machine learning approach, also exhibits good results in specificity in longer fragments. however, its sensitivities are usually lower than others. the comparison on the results of 3' ends indicates that metagun makes better predictions among existed algorithms for longer fragments that are produced under sanger and roche <dig> sequencing platforms, as well as longer contigs after assembly. despite the performance is not superior to glimmer-mg on the shorter fragments corresponds to illumina sequencing platform, it is still much better than others. moreover, with the aid of deep sequencing and effective assembly, the length of contigs will get longer. in a recent study on human gut microbiome with deep sequencing, qin et al. reported that as much as  <dig> % of the illumina ga reads have been assembled to contigs longer than  <dig> bp, with an n <dig> length of  <dig>  kb  <cit> . meanwhile, the sequencing technologies are developing to produce longer reads in which metagun can perform better than others.

a practical problem of metagenomic fragments is the sequencing errors. the error rates of raw data are reported to range from  <dig> % to 1% for sanger sequencing, and from  <dig> % to  <dig> % for pyrosequencing  <cit> . prior work has shown that sequencing errors present severe impact on gene prediction, especially the frame shifts  <cit> . two of previously mentioned metagenomic gene finders, fraggenescan and glimmer-mg, have specially designed models to address this issue and have achieved better accuracies than other methods when running on error-prone fragments  <cit> . however, in this work, we concentrate on predicting genes on error-free fragments for following reasons. firstly, most low-quality nucleotides locate around the ends of the reads, and can be cut out by quality trimming and vector screening, or can be corrected by sequence assembly  <cit> . secondly, separate software has been developed for identifying frame shifts for metagenomic fragments. it can be implemented prior to gene prediction to reduce the influences of sequencing errors  <cit> . moreover, it is promising that frame shift can be greatly decrease with the aid of deeper sequencing, effective assembly and future improvements of sequencing technologies.

tis prediction performance on experimental data
since many environmental sequencing projects are aiming at studying gene functions by experimentally characterization, accurate prediction of tiss is very important for correct tiss is indispensable for expressing genes  <cit> . to investigate the tis prediction performance, we implement almost the same strategy applied in metatisa with two adjustments. firstly, we follow hyatt et al.  <cit>  to assess the tis accuracy on both the internal tiss and the external tiss. an internal tis is a tis locates inside a fragment, and an external tis is that exceeds the edge of a fragment. secondly, the simulated fragment lengths are  <dig> bp and  <dig> bp. shorter fragment is not considered in tis assessment as it is too short that the true tis exceeds the fragment in most cases.

the performance of tis prediction is shown in table  <dig>  in which the accuracy is the ratio of correctly predicted tiss from successfully identified genes. based on the results, metagun achieves to correctly predict  <dig> % of the tiss for both simulations, which is the best performance among current metagenomic gene finders. metaprodigal and glimmer-mg also predict tiss in a high accuracy at over 95%, due to the integration of tis scoring module. in detail, metaprodigal always shows the best results for external tiss; while metagun has the highest accuracy for internal tiss which is much higher than others, and shows an average performance for external tiss. since experimental characterization and sequence analysis around tis for studying translation initiation mechanisms rely more on accurate position of internal tiss than invisible external tiss, the superiority of internal tiss by metagun might have more biological significance.

the abbreviations of gene prediction methods are the same as in table  <dig>  we follow hyatt et al.  <cit>  to assess the tis accuracy on both the internal tiss and the external tiss. an internal tis is a tis locates inside a fragment, and an external tis is that exceeds the edge of a fragment. the total means the overall accuracy of both the internal and the external tiss.

application to human gut microbiome
in order to investigate the application on real environmental sequencing projects, two samples of human gut microbiome from two healthy humans are selected for analysis  <cit> . each sample consists of around ten thousand contigs with an average length of about  <dig> bp. gene annotations are obtained from the img/m website. the annotated genes are identified by both the automatic ab inito gene finding softwares such as fgenesb, glimmer and genemark, and similarity comparison approaches like blastx running against known protein databases  <cit> . metagun and  <dig> other gene finders are then applied to predict genes for both samples. table  <dig> shows the analysis results. in both samples, most of the annotated genes are successfully predicted, with comparable coverages among different methods. meanwhile, thousands of additional genes are predicted in each sample when compared to the annotations. to examine the reliability of the additional genes, similarity search by blastp are then carried out against ncbi non-redundant database. genes with significant hits  are regarded as 'annotated missed genes'. results show that metagun and orphlia predict less additional genes than other methods. however, on the aspect of the percentages of the annotated missed genes among all additional predicted genes, the results of metagun are higher than others in both samples. it indicates that metagun tends to produce more reliable predictions which are consistent with the assessments on simulated fragments. one of the principle objectives for metagenomic sequencing projects is the discovery of novel genes. however, due to the lacking of experimentally verified genes in real samples, it is a difficult task to obtain an comprehensive evaluation like assessments of the gene and the tis predictions in previous sections. in this section, we are trying to provide a clue on novel gene discovery ability with the aid of domain-based searches. the domains are functional units within proteins, which are usually conserved as building blocks during molecular evolution. sometimes, the arrangement of domains varies to form proteins of different functions  <cit> . therefore, domain-based searches are more sensitive for catching novel genes than protein sequences based searches  <cit> . we define 'potential novel genes' as follows. firstly, all possible orf are extracted and translated into amino acid sequences for domain searching against cdd, those with targeted domain motifs with an e value less than 10- <dig> are denoted as potential functional genes. the img/m annotated genes and the genes with targets in the nr database are treated as known genes. then, a potential functional gene which is not a known gene is regarded as a potential novel gene. from table  <dig>  we can see that metagun predicts the largest amount of potential novel genes in both samples benefit from the integration of novel prediction module. further analysis are then carried out to infer probable functionality for potential novel genes predicted by our method according to the targeted domains. we find that most targeted domains originate from proteins in bacterial genomes. such as, infb, corresponds to the translation initiation factor if- <dig>  which is different from the similar proteins in the archaea and eukaryotes and acts in delivering the initiator trna to the ribosome; prk <dig>  corresponds to the transcriptional terminator factor rho; as well as several domains from dna polymerase like prk <dig>  prk <dig>  it seemed that these potential genes should be identified by most gene finders and the sequence based similarity searches since they are essential for the survival of bacteria. however, they are categorized as potential novel genes for two possible reasons. in one situation, the targeted domain belongs to a actual novel protein which also consists of multiple unknown domains with novel functionality. in the other situation, the targeted domain belongs to a known protein which is truncated and too short for the identification by other methods.

in this experiment, orphelia runs used 'net700' parameter and fraggenescan runs used 'complete' mode for sequences in these samples are highly assembled. others run under default settings. percentages in the column 'predicted genes' are ratios of successfully predicted genes to annotated genes; and percentages in the column 'additional genes' are the ration of annotated missed genes to additional genes.

it is widely accepted that microorganisms in human gut microbiome can contribute certain vitamins to the host  <cit> . we have found an interesting case that can provide a clue. a domain named cobn, which usually exists in cobn genes that involved in cobalt transport or b <dig> biosynthesis in a number of species like actinobacteria, cyanobacteria, betaproteobacteria and pseudomonads. moreover, domains involved in short-chain dehydrogenase are also detected in some genes, which is reported to be used by gut bacteria for fermentation to generate energy and converting sugars  <cit> . similar to the phylogenetic distribution of genes analysis on img/m website, domains originated from eukaryotes and viruses are also detected, like atg <dig> , dank  and pat <dig> .

CONCLUSIONS
in this article, we present a novel method for identifying genes in metagenomic fragments. it comprises three steps for gene prediction by firstly classifying input sequences into different phylogenetic groups, then identifying genes for each group independently with both universal prediction module and novel prediction module and finally relocating tiss employing a modified version of metatisa. we compared the prediction results with  <dig> current metagenomic gene finders. for the performance on 3' end of genes, metagun are better than other methods on longer fragments and are comparable with glimmer-mg which are much better than others on shorter fragments. a notable advantage is that metagun always makes the best reliable predictions. for the assessments of 5' end of genes, metagun outperforms others on the overall tiss and especially predicts much more correct internal tiss. the application to  <dig> samples from human gut microbiome also shows that metagun predict more reliable results. furthermore, we have attempted to investigate the novel gene discovery ability on these  <dig> real samples. with the effective integration of the novel prediction module, metagun can find more potential novel genes than others. detailed analysis of the discovered potential novel genes shows that there exists a number of biological meaningful cases. overall, metagun makes substantial advances for gene prediction in metagenomic fragments with three notable contributions: the improvements for both the protein-coding sequences and the translation initiation sites, and the greater ability for novel gene discovery. we believe that metagun will serve as a useful tool for both bioinformatics and experimental researches.

authors' contributions
hqz and ycl, gqh conceived the study, ycl and jtg designed the algorithm and performed the simulations and data analysis, ycl drafted the manuscript, hqz supervised the progress of the work. all authors read and approved the final manuscript.

competing interests
the authors declare that they have no competing interests.

supplementary material
additional file 1
metagun additional file. this addition file consists of  <dig> parts. the first is the fragment classification strategy, which describes the detailed strategy of the bayesian methodology based on a k-mer method. the second is the svm algorithm in metagun, which describes the svm algorithm, its integration into metagenomic gene prediction and the training procedure of svm classifier in our work. the third is supplementary table  <dig> which illustrates the performance of universal module with svm classifiers trained on various training size and difference types of kernel functions.

click here for file

 acknowledgements
we wish to thank prof. chunting zhang of tianjin university, prof. xuegong zhang of tsinghua

university for interest to the project and useful discussions. we also thank dr. xiaobin zheng, binbin lai, longshu yang, luying liu, qi wang and xiaoqi wang for their helps to the work.

declarations
publication of this article was supported by the national key technology research and design program of china , national natural science foundation of china , national basic research program of china , and excellent doctoral dissertation supervisor funding of beijing .

this article has been published as part of bmc bioinformatics volume  <dig> supplement  <dig>  2013: proceedings of the third annual recomb satellite workshop on massively parallel sequencing . the full contents of the supplement are available online at http://www.biomedcentral.com/bmcbioinformatics/supplements/14/s <dig> 
