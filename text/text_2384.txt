BACKGROUND
most non-bacterial epidemic outbreaks are caused by single stranded rna  viruses. typically, these viruses undergo rapid genetic mutations that result in a large and dynamic population diversity, which are seen as different virus strains utilizing multiple hosts  <cit> . relationships among the strains are usually inferred through conventional homology based comparisons using complete capsid sequences or other genomic regions. such comparisons seek to identify clusters of similar sequences that comprise major groups  and sub-groups . these groupings are targeted by various diagnostics  <cit>  to recognize and classify the viruses.

four calicivirus genera  and nine picornavirus genera  are known  <cit> . further divisions of these genera reflect more detailed sequence relatedness among these viruses. for example, among caliciviruses, noroviruses are divided into two genogroups gi and gii each of which contains seven sequence clusters   <cit> , sapovirus sequences are grouped into 2– <dig> genogroups, of which, each contains several clusters  <cit> , vesivirus sequences are known to contain at least  <dig> immune response related antigenic serotypes and lagovirus sequences cluster into proposed sero-specific groups  <cit> . similarly, the  <dig> picornavirus genera are classified into several species, each of which consists of a large number of serotypes .

abbreviations for species are shown within parentheses and the number of serotypes for given species are shown boldfaced within # signs.

the total number of genera, species, serotypes and the associated strains may be taken as a measure of the diversity of a given virus family. based on this measure, the picornaviruses and the caliciviruses are two of the most highly divergent ssrna virus families  <cit> . within the genomes of these two virus families, the coat protein sequences show the lowest overall identity, possibly due to the large number of mutations that the viruses undergo to evade host immune responses.

the coat protein consists of a single subunit for the caliciviruses and four subunits  for the picornaviruses  <cit> . structures of picornavirus coat protein  <cit>  show that the exposed parts of vp <dig> subunits contain most of the important neutralization sites  <cit>  thus making vp <dig> the immunodominant regions. additionally, in comparison with the other genomic regions, vp <dig> sequences show the strongest statistical and phylogenetic support in establishing consistent genetic and antigenic relationships among picornaviruses  <cit> . therefore, vp <dig> sequences are most frequently used in molecular evolution and strain characterization studies in picornaviruses.

although caliciviruses appear to be relatively simpler because of the presence of only one coat protein sequence whose structure is known for a human and an animal strain  <cit> , experimental difficulties arise in identifying strains of human caliciviruses as these viruses cannot be antigenically characterized due to their non-cultivability. consequently, computational techniques offer the most feasible ways to recognize and predict strains of these viruses. among the different parts of the genome, the coat protein sequences offer the best choice in computation-based strain prediction methods in caliciviruses, mainly because, of their highest overall variability and antigenic correlations as compared with sequences of the other genomic regions. this is true even for the human caliciviruses for which antigenic relationships are often deduced on the basis of antigen and antibody elisas using expressed capsid proteins as has been done for noroviruses  <cit> . we examine here a computational approach to predict strains in both picornaviruses and caliciviruses on the basis of capsid sequences.

strain predictions critically depend on sequence information. most existing prediction methods for caliciviruses and picornaviruses use sequence similarity cut-off values derived from homology-based sequence comparisons between target sequences and known reference sequences  <cit> . although recent reports indicate reliable estimation of such cut-off values in distinguishing three peak regions that correspond to the genogroups, clusters and strains in noroviruses  <cit> , no uniform criteria exist to accurately estimate these values for the other caliciviruses. additionally, these cut-off values may be impossible to estimate when different virus genera or families are analyzed together. these difficulties are further compounded when only partial sequences from smaller and relatively more conserved regions are available  <cit> . even for complete capsid sequences, homology based similarity scores pose limitations in determining strains of viruses due to the exponential dependence of computation time on the sequence lengths and the number of sequences thereby negatively impacting prediction accuracy.

one approach to address the computational bottleneck is to efficiently align sliding windows of target virus sequences against databases of reference sequences and use the highest overall alignment scores to genotype the target sequences  <cit> . however, such methods critically depend on parameters such as window sizes and reference sequences. incorrect choice of these parameters may introduce error-inducing biases while significantly increasing the computation time due to repetitive runs using different trial values of these parameters  <cit> .

thus, strain recognition methods using sequence identity scores have not been easily amenable to reliable and robust automation across ssrna virus families. based on an earlier analysis of noroviruses  <cit> , we describe here an implementation of a residue-wise comparison approach to automate strain predictions using both complete and partial amino acid capsid sequences of caliciviruses and picornaviruses.

implementation
method
basis
the method is demonstrated using calicivirus and picornavirus capsid sequences. defining some of these sequences as references, phylogeny based databases of capsid residues that uniquely distinguish among the reference sequences were created. residue-wise comparisons of the input target sequences with the databases identify those phylogenetic branches whose reference sequences most closely resemble the target sequences. these branches, in turn, yield the genogroup and other classification characteristics of the target sequences thereby identifying their strains.

phylogenetic trees of caliciviruses and picornaviruses
partitioned phylogenetic trees were constructed for each of the  <dig> calicivirus genera and the  <dig> picornavirus genera following the procedure described earlier  <cit>  based on evolutionary trace approaches  <cit> . the virus sequences, obtained from public databases  <cit> , were aligned using clustalw  <cit>  in which the gonnet- <dig> distance matrix model  <cit>  was used with penalties for gap opening, closing, extension and separation set to  <dig>  - <dig>   <dig>  and  <dig> respectively.

the fitch-margoliash distance matrix was calculated for each set of aligned sequences and phylogenetic trees were constructed for each such distance matrix using the neighbor-joining kitsch algorithm of phylip package  <cit>  as implemented on the cambridge server  <cit> . the mutation rate was assumed constant throughout the tree. each tree was displayed with the branches horizontal, the 'root' on the left and the tips on the right.

the topology of these trees, defined in terms of the connectivity and the relative branch lengths, was compared with those of other trees generated using other neighbor joining methods including the unweighted pair group method with arithmetic mean  distance criterion and the minimum evolution criterion using poisson distance models of amino acid residues as implemented in the mega <dig> package  <cit> . similar comparisons were also done between the capsid sequence trees and the trees constructed using non-capsid sequences such as those of the rna-dependent rna polymerase regions or of the non-coding regions. because the topology of capsid trees alone remained almost insensitive to the method used, it was deduced that the capsid sequences were phylogenetically most robust. therefore, any of the neighbor joining methods could be used to draw the trees for capsid sequences, and the fitch-margoliash based trees were chosen for further analysis. in contrast, the topologies of the non-capsid trees were quite sensitive to the tree construction method used and hence, these trees were not considered.

partitioning of phylogenetic trees yield groups of similar sequences
the trees were divided into ten equally spaced partitions p01–p <dig>  the inter-partition spacing was calculated from the maximum evolutionary distances within the trees. ten partitions were optimum for all trees as no significant changes in node distributions were observed in any tree with a further increase in partition numbers. the sequences used to construct the trees are called "reference" sequences and the corresponding trees are called "reference" or "genus" trees because each reference tree represents a calici or a picornavirus genus.

each partition acts as a "similarity filter" by creating different sequence groups each of which contains similar sequences emanating from a given node within the partition. examples of such sequence groups are illustrated for a hypothetical representative tree . starting from the root node, partition  <dig> contains all of the aligned sequences. sequence comparisons in this partition, therefore, are equivalent to conventional sequence comparisons that consider all of the sequences together. partitions  <dig> and  <dig> are identical and contain the sequence groups s1–s <dig> and s <dig> belonging to nodes a and b respectively. similarly, the two nodes c and d belong to partition  <dig> while nodes e and f belong to partition  <dig>  node c of partition  <dig> contains sequence groups s <dig> and s <dig> while node d of the same partition contains nine  of the remaining groups. similarly, the eight groups  in partition  <dig> belong to node e while group s <dig> belongs to node f in the same partition . henceforth, sequence clusters or sequence groups will be referred to simply as groups.

comparisons among sequence groups reveal characteristic residues within genus trees
for each tree, sequences belonging to different groups of a given partition were separately aligned and the resulting aligned classes were compared to obtain the consensus residues for that partition. these consensus residues were identified as "characteristic residues" that are conserved within each group but not among the different groups of the partition. for example, characteristic residue x <dig> at location  <dig> of partition  <dig> of a given tree may be a conserved ala for group a of node a in contrast to a conserved gly  for group b of node b . such residues were partition-wise generated for each tree.

database creation
entire information about the genus trees including their partitions, all sequence groups for each partition and all of the characteristic residues taken group-wise, were stored in multiple 2-dimensional arrays that formed the calici and the picornavirus databases.

strain identification through partition-wise comparisons
to identify the strain of the input query  sequence whose genus is known, the program matches the target residues with the characteristic residues of each group of a given partition stored in the appropriate genus database. this is done by first aligning the target sequence with a database reference sequence. next, starting with the second partition from the root , each characteristic residue of a given group in this partition is compared with the target residue at the corresponding location. such comparisons are carried out for all partition  <dig> groups. the input target sequence is assigned to the partition  <dig> group with the maximum number of matches.

the program proceeds to the next partition, where, instead of testing all partition groups, the program tests only those that are directly tree-linked with the most recently accepted group. this greatly reduces the number of groups to be searched. the process continues until all partitions have been searched. testing only a limited number of connected groups per partition guarantees an optimal tree search time, thereby making the program computationally efficient.

within a given partition, once input target sequence residues are matched, they are flagged as "marked" and not considered in subsequent partitions. exceptions to the flagging procedure are carried out only in case of ambiguities. for example, if all of the groups in a partition show an identical number of characteristic residue matches, an ambiguity is declared and no match is flagged. this ensures that all such matched residues of the input sequence are available again for matching purposes in subsequent partitions thereby helping resolve the ambiguity. ambiguities may also occur when all groups within a given partition show no matches with the input sequence, or, if two successive partitions show identical numbers of characteristic residue matches. in both these cases, the program ignores the ambiguous partition and proceeds to the next one without marking any residue. this allows all of the unmarked residues in the current partition to be compared in subsequent partitions.

to illustrate the method, consider an input sequence corresponding to a known genus whose characteristic residues x <dig>  x <dig> and x <dig> for partition  <dig> are ala, pro and ser respectively for group a and the corresponding group b residues  are gly, thr and met respectively . if the aligned target sequence shows more matches for x <dig>  x <dig> and x <dig> of group a in comparison with that of x1', x2' and x3' of group b, it implies that the input sequence belongs to group a in partition  <dig> and not to group b. thus, residues x <dig>  x <dig> and x <dig> are flagged and comparisons in subsequent partitions follow along those branches that are connected to group a . the program therefore proceeds to groups c and d in partition  <dig> ignoring partition  <dig> as it is identical to the previous partition  <dig> .

in partition  <dig>  if both groups c and d show equal number of matches i.e. say, x <dig> and x4' are both trp and x <dig> and x5' are both leu  and the aligned target sequence also contains trp and leu at these locations, then the program will not flag these characteristic residues but will instead carry them over to partition  <dig> where these residues will again be matched in groups e and f  to determine which of these two groups maximally matches the target sequence. similar comparisons in subsequent partitions 6– <dig> unambiguously identify the database strain that most closely resembles the input target sequence thereby yielding its strain characteristics.

when the genus of the target sequence is not known, the sequence is first compared with groups of representative reference sequences  from each of the genus trees in the database using clustalw  <cit> . alignment scores are computed for each group. the highest alignment score is used to select the most appropriate genus tree from the databases. detailed strain identification is then conducted as described earlier. the use of a small number of representative sequences per group ensures rapid genus determination regardless of the number of reference sequences present in the genus tree.

detecting recombination and spontaneous mutations
partition-wise comparisons allow recovir to detect abrupt changes in phylogenetic sequence groupings among trees constructed using sequences from different genomic parts. assuming that absence of recombination creates similar phylogenetic relationships among sequences from different regions of multiple sequence alignments, these abrupt changes or incongruities indicate nodes that may possibly contain recombination sites. for example, an abrupt change is schematically shown using a pair of hypothetical phylogenetic trees constructed using sequences from two different genomic regions of a given set of virus strains . a simple incongruity has artificially been built in by interchanging sequences s <dig> and s <dig> between the two trees. consequently, sequences belonging to nodes a and b that are distinguished by residues  and  in the two trees will not define the recombination sites. however, subsequent nodes c, d, e and f which reflect the incongruity between the two trees up to partition  <dig>  will likely define the recombination sites . for example, if nodes c and d are distinguished by residues  and  in one part of the genome  and by  and  in the other part , recombination events must involve some of these residues to explain the incongruity between the trees. similarly, nodes e and f that are distinguished by residues  and  in one part of the genome  and by  and  in the other part must include the recombination sites . similar systematic comparisons of the strain distinguishing residues in nodes g through t of the remaining partitions show that recombination events can not involve sequences s3–s <dig> and s11–s <dig> as the topology of the nodes involving these residues are identical in both trees . instead, interchange of region  <dig> between sequences s <dig> and s <dig> may be a possible recombination mechanism that leads to the incongruence between the two trees .

in contrast, if there are changes in some of the strain distinguishing residues of a given region without changes in the tree topology, it indicates possible spontaneous mutations. detection of possible recombination or spontaneous mutations is done manually at present as an automated version of this feature has not yet been built into the software.

program testing and validation
recovir was initially validated by identifying the closest strains for five noroviruses and five enteroviruses of known genera from their respective complete and partial amino acid sequences of the capsids . these viruses were chosen because of their sequence diversity and the availability of sequences of a large number of strains or serotypes in public databases. the enteroviruses included the complete vp <dig> sequences of poliovirus- <dig> , human enterovirus -b including the coxsackie viruses, serotypes of the hev-d species and the simian enteroviruses.

input complete capsid sequences are shown in cols  <dig> and  <dig> while the input partial sequences are shown in cols  <dig> and  <dig>  the corresponding closest database strains detected by the program are shown in the last  <dig> cols whose headers are color matched with those of the input sequence cols. the ncbi accession codes are enclosed within square brackets for all capsid sequences except for norwalk virus whose pdb code is correspondingly shown. the enterovirus capsid sequences refer to those of vp <dig> subunits. abbreviations used: hev: human enterovirus; cox; coxsackievirus.

recovir was further validated using more than  <dig> complete and partial sequences of different caliciviruses and more than  <dig> such picornavirus sequences. among the calicivirus sequences, nearly  <dig> were of norovirus strains with the remaining ones being of other caliciviruses. of the picornavirus sequences, nearly  <dig> were enterovirus partial sequences including those of echoviruses and other hev-b serotypes  <cit> , with the remainder chosen from other picornavirus genera and species . most of the partial sequences were randomly chosen from different regions of the capsid with some of the partial sequence lengths being only ~20% of the complete capsid sequence lengths. all norovirus and enterovirus sequences were selected from the ncbi databases  <cit> . none of the selected sequences were among those from the program databases to minimize possible errors due to biased sequence choices.

software description
all functional modules of recovir were written in perl programming language on windows xp and the linux platforms. a java-based graphical user interface  has been designed to access all functionalities through user-friendly i/o options .

program input and output
input selections on the gui have been divided into three categories: sequence, databases and options to control output . any number of query sequences may be input by either pasting them on the white board area or by browsing one or more directories for single or multiple sequence files. there is no limit to the number of input sequence files. the present version reads sequences only in fasta format ignoring all white spaces and non-alphabet characters.

a dropdown menu in the gui database section allows specifying the input sequence genus, if known . a default reference sequence, used for aligning the input sequences and for assigning the aligned location numbers to the input sequence, then pops up in the "select a reference" box . the default reference sequence may be changed if required. in case the genus of the input sequence is not known, the "unknown" option in this box  allows the program to automatically determine the genus and reference sequence from the built-in databases.

the "run" button activates the program, displays a progress bar of the percentage of input sequences processed and displays results in the output section of the gui . depending on the "view results" options chosen, the output includes only a summary or the complete details of partition-wise matches between the database residues and the residues of the input sequences. different gui options allow many other details of such matches to be viewed .

RESULTS
strain identification of complete and partial norovirus capsid sequences
databases
detailed strain identification results are described here for selected norovirus strains among the caliciviruses and some enterovirus strains among the picornaviruses. complete details for the other caliciviruses and the picornaviruses can be found with the authors.

sequences belonging to the norovirus genus tree have been described elsewhere  <cit> . briefly, these sequences form a single group in partition p <dig> . partition p <dig> splits this sequence group into the  <dig> known major genogroups gi and gii of noroviruses   <cit> . group gi further divides into gia and gib in partition p <dig> while group gii divides into giia and giib in partition p <dig>  . partition  <dig> further splits both gi and gii groups. group gia is divided into gia <dig> and gia <dig> while group giia splits into  <dig> groups . in partition  <dig>  group gia splits into  <dig> groups gia1–a <dig> while giia <dig> splits further into the giia3_ <dig> and giia3_ <dig> groups . groups gib, giia <dig> and giib do not split up any further in this partition. details of the remaining partitions p8–p <dig> are available with the authors.

characteristic residue comparisons and strain identification for complete sequences
the characteristic residues of the norovirus genus tree stored in the program databases unambiguously identified the closest strains of target norovirus complete capsid sequences . for example, comparisons of the characteristic residue locations with the corresponding residues of the norovirus "seacroft" sequence  showed that the maximum number of matches in partition p <dig> occurred in the aligned locations 70v and 203t of group gii and not for gi . the corresponding gi locations were 70i and 201v respectively when mapped to the unaligned reference norwalk virus  sequence . thus, the program searched only along the gii branch of the norovirus genus tree in subsequent partitions. in partition p <dig>  the query sequence maximally matched the gii characteristic residues 4a, 5s, 36v, 44p, 104a, 106g, 205s, 446i, 455p, 508r, 511n and 519f while the corresponding gi residues in the reference norwalk virus sequence are 4a, 5s, 36v, 44a, 104v, 106n, 203a, 405l, 414f, 460h, 463d and 471g respectively . in partitions p <dig> and p <dig>  the maximum number of matches  occurred in giia, indicating that further database searches in subsequent partitions should be restricted only to those groups that originate from giia.

of the  <dig> possible giia choices  in the following partition p <dig>  the maximum number of characteristic residue matches occurred in group giia <dig>  corresponding to residues 11s, 13d, 82d, 83l, 103w, 181r, 185m, 227k, 250i, 306g, 329h, 397s, 409v, 436l, 492p, 516v and 519a of the unaligned reference sequence . comparisons in partition p <dig> showed that of the  <dig> groups giia3_ <dig> and giia3_ <dig> originating from the giia <dig> group of the previous partition p <dig>  the giia3_ <dig> group maximally matched the characteristic residues . these matches occurred at 63a, 84s, 110r, 119t, 125v, 126s, 133g, 139i, 145f, 154t, 163e, 184c, 192t, 193g, 207m, 218f, 229r, 236l, 257p, 259n, 347t, 402a, 419v, 420f, 447s, 448e and 504v of the unaligned reference sequence . similar comparisons in partitions p8–p <dig> conclusively showed that the query sequence is most similar to the minireovirus-like norovirus strain 

similarly, the input appalachicola bay, the baltimore 'a' and 'b' and the boxer strain sequences most closely resembled the chiba, minireovirus and the potsdam strains of noroviruses . strains were also correctly predicted after removing random stretches of 10– <dig> amino acids from these sequences indicating thereby that the strain prediction capability of the program is quite robust and is independent of the locations of the input target sequences.

strain identification of input partial amino acid target sequences of noroviruses
strains of five partial amino acid capsid sequences of noroviruses were consistently predicted using both the "noro" and "unknown" database options of the gui . only one of the  <dig> input sequences  explicitly included the n-terminus residues while the remaining sequences 2jp <dig>  3jp <dig>  4jp <dig> and 5tp <dig> were from different capsid regions .

ambiguities detected during search process:

**: equal number of characteristic residue matches found in all of the groups

blank entry: no matches found for the characteristic residues

--: identical to previous partition

##: ambiguity detected: more than one relevant group had equal no. of highest matches

in table , the maximally matching sequence groups for each partition are shown within parentheses. residues and sequence groups in table  use notations of figs. 2a & 2b. residues are color matched in tables  & . one of the mutated residues in the simulated sequence 6st <dig> is highlighted in green.

despite the short sizes of the input partial sequences and the variations in their capsid locations, the program unambiguously recognized the strains of all of them from their matches with the characteristic location residues. location  <dig> in partition p <dig> determined the major genogroup in all but one sequence. sequences 1uk <dig> and 5tp <dig>  both containing 70v, belonged to genogroup gii while 2jp <dig> and 3jp <dig> belonged to genogroup gi based on the corresponding 70i residue . all of the gi residues  contained 20q in partition p <dig>  however, the major genogroup of sequence 4jp <dig> appeared to be ambiguous as it showed features of both gi and gii groups in partition p <dig> . it contained not only 70v, which is typical of gii sequences, but also the gi-indicator 20q. in addition, this sequence also presented the additional ambiguity of having an equal number of characteristic residue matches in both gi and gii groups for partition p <dig> . to resolve this ambiguity, the program carried over the partition p <dig> matches of this sequence  to partition p <dig> 

in partition p <dig>  the program examined characteristic residue locations  <dig>   <dig>   <dig>   <dig> and  <dig> for all of the sequences . residue  <dig> unambiguously confirmed the distinction between the gi and the gii group sequences in this partition. sequences 2jp <dig>  3jp <dig> and 4jp <dig>  by virtue of 44a, were all characterized as gi sequences similar to the reference norwalk virus sequence . in contrast, sequences 1uk <dig> and 5tp <dig>  containing 44p, are genogroup gii sequences. in addition, because 1uk <dig> has 4a and 5s and sequences 2jp <dig>  3jp <dig> and 4jp <dig> have 26n in partition p <dig>  choices of their genogroups were unambiguously confirmed in this partition . residue 36v, being conserved in all of the sequences in p <dig>  was not of much help in determining the sequence groups in this partition .

the program ignored partitions p <dig> and p <dig> for the 1uk <dig> and 5tp <dig> sequences due to ambiguities in residue matches. the next partition p <dig> showed another ambiguity of having more than one group with the highest number of matches for both these sequences . however, matches in partition p <dig> clearly indicated that sequence 1uk <dig> belongs to giia <dig> while 5tp <dig> belongs to group giia3_ <dig> . further matches in partitions p8–p <dig>  confirmed that 1uk <dig> and 5tp <dig> were most similar to the beeskow and the bitburg strains respectively .

thus, the identified strain of the partial sequence 1uk <dig> is consistent with its ncbi classification as a member of the gii. <dig> cluster. however, 5tp <dig> appears to belong to the gii. <dig> sequence cluster according to the present analysis and not to gii. <dig> as shown in the ncbi database. similarly, partitions p6–p <dig> allowed the program to confirm that the remaining sequences 2jp <dig>  3jp <dig> and 4jp <dig> indeed belong to genogroup gi  which is consistent with the ncbi classification of these sequences. in addition, the program determined from residue comparisons that these sequences 2jp <dig>  3jp <dig> and 4jp <dig> are most similar to the norovirus gi chiba, norwalk and the potsdam strains respectively . such detailed strain information is seldom available for partial sequences in public domain databases.

strain detection for complete and partial amino acid sequences of enterovirus and other picornavirus capsids
the program first correctly identified the strains for  <dig> complete and  <dig> partial enterovirus capsid sequences. the complete capsid sequences were those of the vp <dig> subunits of poliovirus, simian enterovirus, echovirus and the coxsackievirus strains  . different reference sequences were tested for use in alignment with the target sequences. the target sequence strains were all correctly identified regardless of the choice of the reference sequences . as an example, strain identification for the poliovirus strain  using the porcine enterovirus- <dig> sequence  as reference is briefly described. the second partition p <dig> of enteroviruses contains only  <dig> reference groups  <dig> and  <dig> in the program database . of these, group  <dig> contains only the porcine enteroviruses  serotype  <dig>  indicating that the pev- <dig> strains are distinct from the other enterovirus strains all of which  belong to group  <dig>  this group is characterized by nine residues 40p, 42l, 44a, 46e, 48g, 72e, 124t, 125y, 127r, 150q, 155p, 157g, 169w, 176s, 191p, 199y, 202f and 203y  in the database . because all of these residues match the corresponding locations in the target poliovirus sequence, the program assigns group  <dig> to the target sequence in partition p <dig> and skips the next partition p <dig> as it is identical to p <dig> .

**: ambiguity:  <dig> or more groups have identical number of matches in both these partitions.

¶: porcine enterovirus 

£: no matching reference group for partitions p <dig>  p <dig> due to ambiguity; strains not shown for these two partitions. all strains of poliovirus serotypes  cluster as an independent group in partition p <dig> 

the complete capsid sequence of input pv- <dig> target sequence  was used as input. symbol pn+: indicates "including all matching residues of the earlier partition pn".

the program detects the separation of group  <dig> into two groups 1a and 1b in partition p <dig>  this creates a total of  <dig> groups  in this partition . while group 1a contains only the pev- <dig> sequences which have independently diverged from group  <dig> of partition p2/p <dig>  group 1b contains the remaining group  <dig> sequences of these partitions. group  <dig> of partition p2/p <dig> remains unaltered in partition p <dig>  on comparing the characteristic residues of these three groups, the program determines that the target sequence most closely resemble group  <dig> in partition p <dig> because of the matches with residues 61l, 62q, 78l, 106s, 115s, 131d, 152l, 170n and 174s  that characterize this group . similarly, matches with residues 43t 55g 64t 84l 156h in partition p <dig> allow the program to assign group  <dig> to the target sequence in this partition which contains nearly  <dig> other similar enterovirus sequences including those of polioviruses . similarly, residue 158g distinguishes group  <dig> as the maximally matching group out of the eight groups in partition p <dig>  this group includes many similar strains in the program database including  <dig> strains of different coxsackievirus serotypes, one echovirus strain and strains of all  <dig> poliovirus serotypes .

the three poliovirus serotypes, which remain clustered with several other human enteroviruses in partition p <dig>  finally separate as an independent group in partition p <dig> . however, partitions p <dig> and p <dig> showed an ambiguity with reference to the input target sequence. both of these partitions have more than one group having an identical highest number of residue matches with the target. this ambiguity did not allow the program to decide the best group in these partitions. consequently, all group information of these partitions was carried over to the subsequent partition p <dig> .

partition p <dig> contains a total of  <dig> sequence groups including an independent group  containing only the poliovirus- <dig> strains. the program detected this group to be the maximally matching group for the target sequence and this detection was confirmed in the next partition p <dig>  thus, the input target sequence was correctly detected as a poliovirus- <dig> strain . strains for the remaining picornaviruses  were also unambiguously detected regardless of the choice of the reference strains.

spontaneous mutations and recombination
spontaneous mutations
partition-wise matches for the norovirus partial sequence 6st <dig> indicated spontaneous mutations. while residue 20q in partition p <dig> indicates that 6st <dig> belongs to gi, residue 70v in the same partition indicates that this sequence may belong to gii as seen for sequence 5tp <dig> . the program, therefore, checks both these possibilities for maximum number of matches in subsequent partitions. each subsequent partition confirms that this sequence indeed belongs to gi and is closest to the potsdam strain . therefore, location  <dig>  which is an isoleucine for other gi sequences , may be a spontaneous mutation site given the relatively large number of matches found which, in turn, are expected to maintain the topology of the tree. however, a complete sequence would be required to completely rule out the involvement of this site in recombination events.

residue-wise comparisons may suggest that a few spontaneous mutations may be sufficient to force recovir to detect a wrong genogroup of the target sequences. for example, it may appear that the single mutation 44a to 44p in sequence 6st <dig> might switch it to a gii group . however, the fact that the program checks the maximum number of matches of strain diversifying residues in each partition ensures that such single mutations within the capsid does not randomly change the strain type of the sequence. this is one of the major strengths of the present method.

for the software to branch off to a different strain on the phylogenetic tree, several mutations are usually required. for example, if locations  <dig>   <dig> and  <dig> of sequence 6st <dig> are mutated without changing the rest of the sequence, it results in the synthetic gi sequence 6st <dig> belonging to group gia <dig> in partition p <dig> instead of gia <dig> that corresponded to 6st <dig> . comparisons of strain diversifying residues in further partitions result in sequence 6st <dig> belonging to a different gi cluster than that of 6st <dig> . thus, the present method is able to identify spontaneous mutations that may lead to subtle changes in the phylogenetic groups of partial sequences.

recombinations
only a few enterovirus strains could be analyzed for recombination using recovir due to the manual nature of such analysis in the present version of the software. partition-wise comparisons of strain diversifying residues of vp1–vp <dig> genes of the hepatitis-a  strains at the nucleotide and the amino acid levels indicated that the slf <dig>  and the mbb  strains may be putative parental strains that yield the recombinant product strain 9f <dig>  . this is consistent with recent results obtained using conventional topology comparisons of phylogenetic trees by sliding windows across the corresponding multiple aligned sequences  <cit> .

despite the limited results, it appears that the present approach may be more efficient in detecting recombination sites than current methods which are inherently time consuming as their accuracy depends on detailed topological comparisons obtained from multiple runs using different sequence windows. in addition, the entire procedure must be repeated every time a new sequence needs to be analyzed. in contrast, the present method does not repeatedly compare phylogenetic trees using sliding sequence windows. instead, it efficiently performs node-wise comparisons of the trees using a one-time created database of strain distinguishing residues.

approximate processing times
the program rapidly identified the calicivirus and the picornavirus strains. in typical runs on outbreak sequence data available from public databases, it took only  <dig> and  <dig> minutes of real time respectively to identify the strains of a number of norovirus sequences contained in  <dig> files. the first file had  <dig> complete norovirus capsid sequences while the second file had  <dig> norovirus capsid sequences of which  <dig> were complete sequences while the remaining  <dig> were partial sequences each of which was between  <dig> and  <dig> residues long. this indicates a real time  of approximately  <dig> seconds per sequence. comparable speeds were also observed in processing mixtures of calicivirus and picornavirus sequences when the "unknown" database option  was required. complete benchmark details of such strain identification runs are available with the authors.

advantages of the software
trees based on complete capsid sequences are robust
a significant computational advantage of using complete capsid sequences to construct the recovir databases is that these databases are very robust with respect to the method used to construct the database trees. the overall topology of the trees, described by the relative branch lengths and the connectivity among the branches, remain essentially unchanged regardless of the neighbor-joining method used to draw the tree. for example, in all of the trees constructed using the complete capsid sequences, the sequence groups and the characteristic residues of the groups remain unchanged for partitions p2–p <dig>  only the p <dig> sequence groups show minor changes depending on the tree construction method used . consequently, strain identification results using recovir are very reliable.

in contrast, trees constructed using a partial capsid sequences or using amino acids of more conserved and relatively smaller non-capsid regions  are relatively unstable because the topology of these trees critically depend upon the method of tree construction. therefore, databases generated from such trees are not as reliable as the ones generated using trees of complete capsid sequences.

tree-structured databases
the partitioned residue databases in recovir confer important advantages to this software over existing homology-based strain identification techniques. because each partition and its nodes highlight branching orders that provide evolutionary context of sequence relationships, the databases in recovir most likely indicate biologically significant residues as seen for the noroviruses  <cit> .

more practically, searches using the database residues are able to show increasing similarities between the target sequences and appropriate database sequences as subsequent partitions are considered. consequently, ambiguities in strain identification, such as those occurring due to the partial nature of the sequences or those due to possible mutations in the target sequences, may be resolved at least in the first few partitions where appropriately matched sequence groups are found. such matches are not possible using conventional homology based sequence comparisons.

advantages in classification
residues of the recovir databases may be used to determine relatedness among the corresponding sequence groups in a partition-dependent manner thus helping in virus classification. for example, while the database residues of p <dig> distinguish among two of the major norovirus groups and the murine norovirus group, the corresponding residues in subsequent partitions distinguish among the more closely related sequence groups. such residue-based distinctions among the sequence groups provide useful ways to uniquely identify many tentatively classified sequences like those of the bovine and the alphatron noroviruses.

bovine and the alphatron norovirus groups
our earlier analysis had indicated that the bovine noroviruses may belong to genogroup i while the alphatron-like sequences may belong to genogroup ii  <cit> . one way to understand this is to compare the inter-group evolutionary distances, measured in evolutionary units , between gi, gii and the groups containing the bovine and the alphatron sequences. these distances refer to the number of mutations among the sequences. in trees constructed using neighbor-joining methods and gonnet- <dig> distance matrices, the gi-gii distance, calculated between the gi and the gii groups after excluding the bovine sequences, is  <dig> eu while the corresponding gi-bovine distance, calculated between the gi and the bovine groups, is  <dig> eu . thus, the difference between these distances  is less than the partition width which results in clustering the bovine sequences together with the gi sequences in the same p <dig> group. similarly, the gi-gii distance, calculated after excluding the alphatron-like sequences, is more than the gii-alphatron distance calculated between the gi and the alphatron groups thereby clustering the alphatron-like sequences in the gii group of partition p <dig>  thus, the phylogenetic distances are consistent with the proposal that the bovine sequences appear to share sequence similarities with the gi genogroup while the alphatron sequences share gii sequence features  <cit> .

these relative phylogenetic distances among the sequence groups may be further understood by comparing the sequences of the p <dig> groups. on aligning the three different p <dig> sequence groups, the conserved residues among the bovine sequences show significant similarities with those of the gi sequences but not with the conserved sequences of gii. for example, the conserved gi residues 45t, 46a, 47g, 48q, 49v and 50n  are also conserved in the bovine sequences . similarly, the alphatron sequences show more residue similarities with the gii sequences than with those of gi . such similarities are further confirmed in subsequent partitions p3–p <dig> of recovir. therefore, the software places the bovine-like sequences in gi and the alphatron-like sequences in the gii group. although these assignments are consistent with our earlier analysis  <cit> , they do not agree with recent sequence clustering studies that assign independent genogroups to the bovine and the alphatron sequences  <cit> . experimental determination of the possible biological roles of the conserved residues  will help resolve the issue.

other advantages
many of the recovir database residues are involved in putative capsid related functions in noroviruses  <cit> . this indicates that these residues and the corresponding sequence groups may critically identify subtle changes in capsid related functions among the genogroups, species and serotypes. hence, recovir may provide functional insights not currently available with current classification schemes of caliciviruses and picornaviruses.

software limitations
a limitation of the present version of the software is that the implemented residue databases may become outdated given the rapidly increasing number of emerging strains of calici and picornaviruses. therefore, the databases need to be regularly upgraded. however, upgrades should be carried out only when changes become statistically significant. in our experience, this would mean that at least 50% of the emerging sequences must show changes in the same residue locations before those residues are considered reliable enough to be incorporated in the databases.

CONCLUSIONS
a software package recovir that can efficiently and accurately characterize strains of the highly divergent caliciviruses and picornaviruses is described. in contrast to current techniques that largely rely on sequence similarity scores to identify strains, recovir implements a method indicated previously for noroviruses  <cit> . the software creates partitioned databases of capsid residues that unambiguously distinguish among a large number of calicivirus and the picornavirus reference strains. using efficient tree-based search techniques, residues of target capsid sequences are compared with the residue databases to rapidly identify strains of the target sequences of all caliciviruses and picornaviruses. strains of more than  <dig> complete and partial capsid sequences of calici and picornaviruses were successfully identified with an average time  of approximately  <dig> seconds per sequence. the method is general enough to be applicable to the nucleotide sequences of calici and picornavirus capsids thereby providing rapid and powerful alternatives that complement current strain determination and classification techniques of these and other ssrna viruses.

availability and requirements
• project home pages: 

• operating systems: windows-xp and linux

• programming language: perl and java

• other requirements: x-windows support  is needed for remotely running the program under linux environment.

competing interests
the author declares that there are no competing interests.

authors' contributions
dz coded the software and designed the gui. sc developed the concept, designed the algorithm and its implementation and created the initial databases. sc and dz performed extensive troubleshooting with both synthetic and real data. sc and gef wrote the paper. all authors suggested improvements at different stages of manuscript preparation and read and approved the final version of the manuscript.

supplementary material
additional file 1
partitioned distribution of norovirus strains. supplementary table showing detailed distribution of norovirus strains in different sequence groups for partitions p2–p <dig> 

click here for file

 acknowledgements
this research was funded in part by grants from the texas learning and computational center  and a grant from the national aeronautics and space administration office of exploratory research  and the department of homeland security advanced research projects agency .
