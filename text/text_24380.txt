BACKGROUND
fueled by rapid advances of sequencing techniques  <cit> , culture-independent community-wide methods  have been commonly used to study the microbial community in different environments, such as in soil  <cit> , ocean  <cit> , freshwater  <cit>  and human-associated communities  <cit> . large scale surveys of human microbiomes through the human microbiome project   <cit>  and the metahit project  <cit>  have provided great resources for studying the diversity and complexity of human microbiomes and their potential impacts on human health and diseases. comparison of human gut microbiomes of individuals with type ii diabetes  against those of normal controls have revealed important taxonomic and functional differences of the microbial communities that might be correlated with t2d  <cit> .

while metagenomic sequencing revealed important functional properties encoded in microbial communities, characterization of these properties requires direct analysis of the active component of the metagenome, through meta-omic techniques such as metatranscriptomics or metaproteomics. bacteria have low inventories of short-lived mrnas so that fluctuations in their mrnas pools provide a highly sensitive bioassay for environmental signals  that are relevant to microbes  <cit> , and the collective interaction among microbial organisms in response to the changes of their environment .

in a common metatranscriptomic study , total rna is first isolated from the sample and structural rnas are then removed to enrich for mrna, which is then reverse transcribed into cdna subject to dna sequencing using next generation sequencing  platforms like illumina sequencers  <cit> . metatranscriptomic data indicate which of the genes encoded in a metagenome are actually transcribed, and which of the potential metabolic pathways are active  on the basis of their transcriptions within a microbial community under certain environmental condition. hmp ii, the second phase of the human microbiome project  plans to generate coherent meta-omic  datasets acquired from the same cohorts of healthy human subjects and patients with certain diseases .

in addition to elucidating functional characteristics of microbial communities, metatranscriptomic data provides valuable information for accurate annotations of genes and studies of their regulation in the community that are complementary to metagenomic sequencing. metatranscriptomic sequences can be assembled into transcripts, each encoding one or more genes that are transcribed together . in the latter case , the intergenic regions between coding genes are relatively short. in comparison, metagenomic sequences are assembled into contigs of genomic segments, many of which may contain long non-coding intergenic regions. in addition, current metatranscriptomic studies adopt the stranded rna-seq protocol  <cit> ; as a result, the genes should be encoded on the positive strand of the assembled transcripts in metatranscriptomic sequences, while in metagenomic sequences, genes can be encoded in either strand. these features of metatranscriptomic data can significantly improve the gene prediction accuracy in metatranscriptomic sequences, and thus should be incorporated into gene predictors specifically designed for metatranscriptomic data. furthermore, because of the strand-specificity in metatranscriptomic data, antisense rnas , which are encoded on the dna strand opposite to a protein coding  gene, and play various, important regulatory roles by forming extensive base-pairing interactions with the corresponding sense rna  <cit> , can be revealed in metatranscriptomic sequences. antisense rnas range in size from tens to thousands of nucleotides, complementing with part of a gene, a complete gene or a group of genes  <cit> . although asrnas were first observed in bacteria more than  <dig> years ago  <cit> , most studies of asrnas in bacteria are rather recent, and have been applied mainly to single bacterial species, including chlamydia trachomatis  <cit>  and escherichia coli  <cit> . metatranscriptomics research is creating an unprecedented opportunity to gain knowledge about the gene regulation for the vast majority of uncultured microbial species.

in this paper, we present a gene finding software tool  specifically designed for metatranscriptomic sequences that addresses all features described above. transgenescan incorporates strand-specific hidden states, representing coding sequences in sense and antisense strands in a hidden markov model , which is different from the hmm that we used in fraggenescan  <cit> . as a result, transgenescan can predict a sense transcript containing one or multiple genes  or an antisense transcript. we note that transgenescan inherits the advantage of fraggenescan in that the parameters of the hmm can be computed based on the gc% of the input sequences and therefore no trainings on specific data sets are needed, a desirable feature for gene finding in metagenomic/metatranscriptomic sequences. we tested transgenescan on a mock metatranscriptomic data set containing  <dig> bacterial genomes, and compared its performance with metagenomic gene finders metagenemark  <cit>  and fraggenescan  <cit> , as well as glimmer  <cit>  and genemark  <cit> , gene finders trained for each specific bacterial genome . the results showed that trangenescan performs much more accurately than metagenomic gene finders on metatranscriptomic sequences, and achieves comparable or even higher accuracy than gene finders for microbial genomes. these results imply, with the assistance of metatranscriptomic sequencing, we can obtain a broad and precise picture about the genes  in a microbial community.

methods
transgenescan takes as input a set of transcript sequences, and reports the annotation of these sequences, either sense rna , or asrnas with regulatory functions. it is built upon a hidden markov model that considers each input transcript sequence as an observation sequence, and computes the most likely hidden sequence, representing the annotation of the sequence. the metatranscriptomic sequences acquired by using a stranded rna-seq protocol will be first assembled into transcripts by a reference-mapping approach  or by a de novo assembly approach, e.g., by using velvet  <cit> , trinity  <cit>  or oases  <cit> . we tested transgenescan on a metatranscriptomic data set acquired from a mock community consisting of three bacterial species: escherichia coli, rhodobacter sphaeroides, and prochlorococcus marinus  <cit> . to evaluate the performance of transgenescan, we focused on the accuracy of the protein-coding genes on the predicted mrna transcripts, where the currently annotated genes in each of the three genomes are considered to be true positives. we also analyzed the asrnas and operons predicted by transgenescan. below, we describe these methods in details.

transcript assembly
in this study, we adopt an ad hoc reference-based assembly algorithm for reconstructing transcript sequences from metatranscriptomic data. transcriptome assemblers are available for processing rna-seq data, including reference-based transcriptome assemblers such as cufflinks  <cit>  and de novo assemblers such as velvet  <cit> , trinity  <cit>  and oases  <cit> . these algorithms were designed for eukaryotic transcriptome assembly, and thus focused on the challenge of reconstructing alternative splicing forms. on the one hand, the assembly of bacterial transcriptomes might be less challenging because of the lack of splicing; but specific issues like overlapping transcripts and alternative operon structures may complicate the problem  <cit> . as a result, fine-tuned algorithms may be needed for metatranscriptome assembly. nevertheless, we stress that implementation of a metatranscriptome assembler is beyond the scope of this paper, and hence, we adopt a simple approach to this problem, as described below.

given a set of rna-seq sequences, we first align them onto reference genomes by using bwa  <cit> . to obtain the start and end positions of transcripts from the mapped reads, we partition the reads into two sets using samtools  <cit> : the first set contains reads contributed by transcripts transcribed from the positive strand of the reference genome , and the second set contains reads contributed by those transcribed from the negative strand . because the stranded rna-seq protocol is used, this partitioning can be easily achieved using the samtools flag-filters based on the rules as shown in supplementary table s <dig> . in the next step, for each set, we mark regions in the reference genome supported by at least one read from the respective set. then, we extract contiguous marked regions that are ≥  <dig> base pairs long. these sequences are considered as potential transcripts and input to the gene prediction programs. since we know that the transcripts assembled from the second set of reads correspond to transcripts from the negative strand, these transcripts are converted into their reverse complements before giving as input to the prediction programs. the gene annotations for the transcripts are obtained from the corresponding annotations for the reference genome, which are downloaded from genbank . we used the reference genomes to achieve a well-assembled set of transcripts, for the purpose of evaluating the gene-prediction accuracy in metatranscriptomic data. in practice, complete reference genomes may not be available for metatranscriptome studies. in this case, one can use transcripts assembled by de novo assembly algorithms  as input to transgenescan.

hidden markov model for gene finding
in transgenescan, we extended the hidden markov model  used in fraggenescan to the gene finding in metatranscriptomic sequences. fraggenescan hmm incorporates codon usage bias, sequencing error models and start/stop codon patterns in a unified model for gene finding in short, error-prone metagenomic sequences  <cit> . the model parameters  were not learned from training data, but were estimated by using a linear regression to the gc% of the input genomic sequences. we modified the fraggenescan by removing the frameshift states , and incorporating the strand specificity of the transcript. as shown in figure  <dig>  the hmm employed in transgenescan consists of  <dig> super-states in two modules:  <dig> super-states in the sense  strand module, representing coding regions, start codons, stop codons and un-translated regions, respectively; and  <dig> super-states in the antisense strand module, representing start codons, stop codons, coding regions, and un-translated regions, respectively. the un-translated regions in the antisense strand are represented as two distinct states, one for the 5' un-translated region and one for the 3' un-translated region to prohibit the transition from the coding regions in one gene to those in another . furthermore, an idle start state is used to ensure that the annotation  sequence can only initiate from the un-translated regions in positive strand . we removed transitions from the forward strand to the backward strand and vice versa making the top and the bottom half of the model mutually exclusive. each of the two super-states for coding regions consists of six consecutive match states  represented by diamonds, allowing different parameters to be used for each position in a di-codon, which collectively model the codon bias in coding regions. we used the same regression models as used in fraggenescan to obtain transition and emission probabilities for the match states  <cit> .

to annotate transcript sequences, the viterbi algorithm is used to obtain the most likely path of hidden states that generates the input nucleotide sequence. in this study, we output coding sequences of length greater than  <dig> base pairs that start in a start state  and end in a stop state . a length of  <dig> bps is chosen to ensure the transcript contains at least two overlapping reads, since the length of illumina reads is about  <dig> bps. genes predicted in the strand opposite to the native strand of the transcript  are reported as antisense transcripts. while more than one open reading frames are allowed to be predicted in the native strand of a transcript , at most one is allowed in the antisense strand.

transgenescan is implemented using c and perl, and is available as open-source software on sourceforge at https://sourceforge.net/projects/transgenescan/.

performance evaluation and comparison
the performance of gene prediction is measured in terms of sensitivity, precision and accuracy. sensitivity  is computed as the ratio of true positives versus all annotated genes and precision  is the ratio of true positives versus all predicted genes. the accuracy is measured using the f-score defined by,

  f=2⋅pr⋅snpr+sn 

the performance of transgenescan is compared with genemark, glimmer, metagenemark and fraggenescan. the parameters used for these programs are shown in table  <dig>  all the programs are given the same input transcript sequences. partial gene predictions are removed from the output of all programs for the purpose of performance evaluation.

RESULTS
we analyzed rna-seq reads from a mock bacterial community containing three bacterial species 
 <cit> : 
escherichia coli , 
prochlorococcus marinus 
and rhodobacter sphaeroides .
the set of raw rna reads  were downloaded from short reads archive , which contains  <dig> , <dig> paired-end reads of  <dig>  mbps with the average insertsize of  <dig> bps. the reads were mapped to the three reference genomes by using bwa  <cit> , and a total of  <dig> , <dig>   <dig> , <dig> and  <dig> , <dig> reads can be mapped to the genomes of e. coli, p. marinus and r. sphaeroides, respectively. these mapped reads were further assembled into the transcripts representing genomic sequences continuously covered by mapped reads in each genome . these transcripts were provided as input to transgenescan, which classified each transcript as a sense transcript or an antisense transcript. for sense transcripts, transgenescan also reported the protein-coding genes in them.

accuracy of protein-coding gene prediction
we first evaluate the prediction accuracy of transgenescan on protein-coding genes. the performance is compared with two metagenomic gene finders metagenemark and fraggenescan, and two gene finders for microbial genomes, glimmer and genemark. the default parameters were used for transgenescan, metagenemark and fraggenescan, and thus are independent of the input sequences used here for performance evaluation. notably, the parameter used in transgenescan for estimating transition and emission probabilities are inherited from fraggenescan  <cit> , which were trained on a set of genes in bacterial genomes with various gc-content  <cit> . the parameters of glimmer and genemark were self-trained on protein-coding genes in each respective bacterial genome, and as a result, different model parameters might be used in the gene prediction on transcripts from each of the three bacterial genomes. we note that, in practice of metatranscriptomic gene prediction, the bacterial genomes from which some transcripts are transcribed may not be known; as a result, glimmer and genemark may not perform as well as reported here.

the performance of these five programs were measured on sensitivity, precision and accuracy , as shown in table  <dig>  a gene annotated in a respective reference genome is considered to be positive if it is fully contained in an assembled transcript. a total of  <dig> ,  <dig> and  <dig>  genes can be recovered in the assembled transcripts of the metatranscriptome sequences in the bacteria e. coli, p. marinus and r. sphaeroides, respectively. a predicted gene is considered to be true positive if it completely overlaps with  an annotated gene in the corresponding frame in the respective reference genome. the rest of predicted genes are counted as false positives. we found that a significant proportion of false positives correspond to predictions in partial genic regions at the 5' end of the transcripts. for these genes, the stop codon is predicted correctly in the correct frame; but the start codon is picked from the middle of the gene since the transcript does not cover the entire gene. because these genes can neither be counted as true positives nor as false positives, they are excluded from the performance evaluation for each of the five programs. a gene is considered to be false negative if it is covered by a transcript, but does not completely overlap with  a predicted gene in the corresponding frame.

∗the numbers of positive genes recovered in the assembled transcripts.

from the results, we observe that transgenescan performs significantly better than metagenomic gene finders , especially with respect to sensitivity. it performs comparable to genemark and glimmer with some tradeoff between sensitivity and precision . the overall accuracy of transgenescan is better than that of genemark and glimmer. it was observed that gene prediction accuracy in metagenomic sequences is typically lower than that in microbial genomes, because the average model parameters are used for different bacterial genomes potentially present in the input data  <cit> . our results, however, indicate that with the assistance of metatranscriptomic data, bacterial genes can be predicted accurately in metagenomes, with comparable or even higher prediction accuracy  than that in bacterial genomic sequences . we attribute this improvement to the transgenescanentary signals in the metatranscriptomic sequences: 1) the boundary of transcripts help to define the appropriate reading frame as well as the start codon; and 2) the stranded data help to distinguish the true coding strand. we stress that we used the reference genome here only for evaluation purpose, i.e., by considering annotated genes in the reference as the golden standard. in practice, one can use transgenescan to directly predict genes in assembled transcripts from metatranscriptomic sequences without additional training, and the prediction accuracy should not be substantially worse than the results described here. finally, gene prediction in a particular metatranscriptomic data set may not cover all genes encoded in the community , because 1) only a fraction of genes are transcribed, and 2) due to the sequencing depth, some transcribed genes with low abundances in the sample may not be fully recovered. therefore, multiple metatranscriptomic studies of the same community are needed to achieve a comprehensive annotation of the genes in the community.

predicted antisense transcripts
in addition to sense transcripts, transgenescan predicted a substantial number of antisense transcripts: among  <dig> ,  <dig>  and  <dig>  transcripts predicted in e. coli, p. marinus and r. sphaeroides,  <dig>  ,  <dig>   and  <dig>  were predicted as putative antisense transcripts, respectively. a majority of these putative antisense transcripts  overlaps partially with one real gene  in the opposite strand, while do not overlap with any gene in the same strand;  <dig>  ,  <dig>  and  <dig>  of those cases are in e. coli, p. marinus and r. sphaeroides, respectively. these predicted transcripts are likely true positives, although the remaining predictions are not necessarily false. only very few  predicted antisense transcripts contain complete annotated genes , which are likely mrnas instead of asrnas, and thus are false positives. the numbers of asrnas reported for different bacteria vary extensively, but hundreds and even thousands have been suggested in some species  <cit> . our analysis suggests a widespread antisense transcription in e. coli, which is consistent with the previous systematic studies that report thousands of asrnas in this species  <cit> . we also found prevalent asrnas in the less studied bacterial species . we report these predicted asrnas in our website , which will provide important resources for further studies of the gene regulation in these species.

predicted operons
transgenescan can predict more than one gene in a given transcript, which indicates a putative operon structure . we observed a total of  <dig>   <dig> and  <dig> putative operons predicted in e. coli, p. marinus and r. sphaeroides, respectively. we compared the  <dig> operons predicted in e. coli with the known operons curated in regulondb  <cit> . out of  <dig> predicted putative operons,  <dig>  matched with at least 80% overlap of those in regulondb, and  <dig>  matched completely with known operons. among the remaining  <dig> predicted operons,  <dig> were fully contained within the operons in the regulondb predominantly with at least 30% overlap. these cases may indicate incomplete coverage of the transcripts containing these operons in the data set due to low sequencing depth, or potential alternative operon transcription in the experiment. there were two predicted operons that span across multiple known operons: one contains the genes ygbk and ygbl, spanning two operons ygbjk , and ygblm  in regulondb; the other one contains the genes yjem , yjen and yjeo, spanning the two operons yjem  and yjeno . the intergenic distances in the known operons are - <dig> ,  <dig> and - <dig> between the pairs of genes of ygbjk, ygblm and yjeno, respectively, whereas in the two predicted operons, the intergenic distances are  <dig>  and  <dig> , respectively. these two cases may represent novel alternative operon structures, or artificial transcripts that merge two overlapping transcripts . nevertheless, our results showed that most of the putative operons predicted in e. coli by transgenescan agreed with the ones collected in regulondb. hence, transgenescan prediction on metatranscriptomic data may provide useful information to detect active operons in a microbial community. the full list of operons in all three genomes are shown in our website .

CONCLUSIONS
in this paper, we present transgenescan, a software tool specifically designed for finding genes in metatranscriptomic sequences. transgenescan can predict protein-coding genes as well as antisense rnas solely from metatranscriptomic sequences without additional training. the testing results showed that trangenescan achieves comparable or even higher accuracy than gene finders for individual microbial genomes, implying that, with the assistance of metatranscriptomic sequencing, we can predict accurately the genes in a microbial community, and thus reveal a precise picture of its functional properties.

list of abbreviations
hmp: human microbiome project; t2d: type ii diabetes; ngs: next generation sequencing; asrna: antisense rna; hmm: hidden markov model; sn: sensitivity; pr: precision: ac: accuracy; tp: true positives; mgm: metagenemark; fgs: fraggenescan; tgs: transgenescan.

competing interests
the authors declare that they have no competing interests.

authors' contributions
ht, yy and wmi designed the study. wmi contributed tools for the analysis. wmi, ht and yy analyzed the data, and wrote the paper.

supplementary material
additional file 1
supplementary tables. pdf file containing supplementary table s <dig> 

click here for file

 acknowledgements
we are grateful to dr. mina rho for her development of the software fraggenescan, of which some code and parameters were used in transgenescan. this work is supported by national science foundation under grant number dbi- <dig> 

declarations
publication of this article was supported by national science foundation under grant number dbi- <dig> and recomb conference.

this article has been published as part of bmc bioinformatics supplement: proceedings of the fourth annual recomb satellite workshop on massively parallel sequencing .

this article has been published as part of bmc bioinformatics volume  <dig> supplement  <dig>  2014: proceedings of the fourth annual recomb satellite workshop on massively parallel sequencing . the full contents of the supplement are available online at http://www.biomedcentral.com/bmcbioinformatics/supplements/15/s <dig> 
