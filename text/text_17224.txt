BACKGROUND
a key focus of modern genetic research is the relationship between genomic variations and phenotypes, including susceptibilities to common diseases  <cit> . recent advances in genome-wide association studies  have greatly enhanced our understanding of such genotype-phenotype relationships . in many cases, however, a large portion of the expected heritability information remains to be discovered. it has recently been shown that meta-analyses involving increasingly large sample sizes can yield many additional loci of statistical significance  <cit> . another potential source of such ‘missing heritability’ is the contribution of rare variants not detected by population-based genotyping platforms. recent studies based on exome and whole-genome sequencing data combined with statistical tests including burden tests  <cit> , c-alpha test  <cit> , and sequence kernel association test  <cit>  are beginning to address such possibilities. it is also expected, however, that the limitation of independent single nucleotide polymorphism  analyses, where each locus is considered separately to evaluate its association with disease using trend tests or logistic regression models  <cit> , and possible effects of epistasis also contribute to the limited degree of biological effects uncovered so far.

many studies have addressed the issue of incorporating such inter-variant interactions, or epistasis, in gwas  <cit> . main approaches include machine-learning techniques , entropy-based methods  <cit> , principal component analyses , and the genome-wide interaction analysis considering all distinct pairs of snps . one useful strategy, in particular, is to extend parametric models to many snps that have been suitably selected, and inferring interaction effects under a multivariate statistical setting. previous works within this framework include those based on lasso-penalized logistic regression  <cit> . under the setting of inference on many interacting snps, the dimensionality of the underlying model is of the order of m <dig>  where m is the number of snps that are considered simultaneously, with m= <dig> and  <dig> corresponding to the independent-snp and pairwise tests, respectively. to prevent model overfitting, high-dimensional inference with limited sample sizes requires regularization, whose values can be determined by cross-validation. ayers and cordell performed a comprehensive study of the performance of different penalizer choices on noninteracting snp inferences  <cit> .

this class of methods within the context of gwas so far exclusively used logistic  regression analyses for case-control  data, which parallels their similarly widespread adoption in the general statistical learning literature. one may note, however, that the actual training data sets in gwas are collected from case and control populations with distinct genotype distributions. the likelihood of the data to be maximized for inference is given by the joint probability of both genotypes  and phenotypes . in  regression, this joint probability is replaced by the probability of phenotypes conditional to genotypes, and the marginal probability of genotypes is assumed to be uniform.

in statistical learning, discriminant analysis is another widely used option for classifying continuous random variables in addition to logistic regression . this class of inference methods offers alternative approaches that fully model the joint distribution of predictor and response variables  at the expense of assuming specific predictor distributions . it has been estimated that, for continuous variables, the accuracy of logistic regression models can be lower by ∼ <dig> % than that of discriminant analyses for a given sample size  <cit> .

genotype distributions within populations from which gwas samples are collected are also far from uniform, and it is of interest to examine the utility of discriminant analysis-type approaches to disease association inference under high-dimensional settings, which is the main focus of this paper. the standard discriminant analysis, however, is applicable only for continuous variable predictors. a related approach, the discriminant analysis of principal components by jombart et al.  <cit> , applies discriminant analysis to principal components  of allele frequencies for unsupervised learning of population structures. we report here, as a major innovation, an adaptation of discriminant analysis to the case of discrete genotype data .

our inference includes the causal effects of both marginal single-snp terms and their interactions. these effects are estimated simultaneously, rather than separately as in independent-snp and pairwise analyses. we refer to such combined effects of single-snp and interaction contributions as the collective effects of disease association. this level of description is analogous to that of the logistic regression inference performed by wu et al.  <cit>  in terms of the nature of snp effects included in the modeling. association studies have two distinct but related goals: inference and prediction. in inference , one aims to identify a subset of snps that are deemed to be causal, while in prediction, the goal is to apply the trained model and predict the disease status of unknown samples. independent-snp analyses widely performed in gwas, either based on trend tests or logistic regression models with marginal snp effects only, are mainly geared toward inference. in contrast, the penalized logistic regression including collective effects  <cit>  is more suited to prediction, because the disease risk parameters are optimized directly via maximum likelihood without reference to population structures.

our method offers a comprehensive approach achieving both inference and prediction by training models to genotype distributions of case and control groups separately under penalizers. the regularization using cross-validation optimizes prediction capability, while for inference, we derived effective p-values of the overall single-snp  and interaction effects using likelihood ratio tests. to our knowledge, the performance comparison of interaction effect detection between pairwise tests and  collective inference has not been reported yet. our results based on simulated data indicate that collective inference provides far higher sensitivity for interactions than pairwise tests. compared to penalized logistic regression, dda yielded further advantages in sensitivity and specificity.

our current collective inference implementation allows for the maximum likelihood inference of systems containing up to ∼ <dig> snps. however, evaluating interaction p-values of snp pairs by permutation resampling increases the computational cost by orders of magnitude, limiting the number of snps that can be considered in practice. in addition, the requirement for pre-selection of variants based, for example, on independent-snp p-values, limits the possibility for discovering novel loci whose effects are significant only when interactions are taken into account. to deal more directly with genome-wide data in an unbiased fashion, we describe a second mode of dda application where ∼ <dig> snps are grouped into  subsets based on phenotype-independent criteria , the collective inference is applied to each subset, and their relative importance in disease association is evaluated based on cross-validation prediction score. this protocol significantly expands the power of snp-based pathway analysis beyond existing enrichment-based methodologies  <cit>  by allowing for the incorporation of collective interaction effects within each pathway.

by applying our algorithm to the disease data of age-related macular degeneration   <cit> , we demonstrate that the enhanced ability to account for interaction effects can translate into novel biological findings. amd is a progressive degenerative disease affecting individuals in old age, characterized by the accumulation of deposits  in the retina or choroidal neovascularization, which can lead to vision loss. genome-wide studies of amd constitute one of the earliest and most successful applications of gwas , where strong associations were detected and later validated at variants including those near complement pathway genes cfh, c <dig>  and c <dig>  in addition to the arms2/htra <dig> loci. however, direct molecular mechanisms tying these associated loci into disease pathogenesis remain unclear. using amd case-control data, we first analyzed detailed interaction patterns within snps selected based on independent-snp association strengths. these interactions were enriched in loci epigenetically active in tissues including adipocytes, mesenchymal stem cells, and the liver. we then applied dda to pathway-based groups formed from genome-wide data and found high association with pathways involved in phospholipid synthesis, cellular stress response, apoptosis, and complement activation.

RESULTS
our algorithm  extends the discriminant analysis to discrete genotype data. its overall steps are summarized in fig.  <dig> and described in methods .
fig.  <dig> discrete discriminant analysis algorithm. empirical characteristics  of case  and control  data are used to fit their genotype distributions with parameters hi and jij, each roughly determining the position and width of the distribution. disease risk parameters are given by their differences, whereas the likelihood ratio  statistic q is obtained from the difference between the sum of two contributions and the corresponding pooled value



independent snps
when interactions between the loci are turned off, dda can be solved analytically , whereas logistic regression is always numerical. we first compared this special case of dda and logistic regression without interaction and found the odds ratio and power to be identical for all conditions for binary models , which implies that the effect of marginal genotype distributions ignored in logistic regression is negligible for a single non-interacting locus. however, since dda can yield p-values of each locus without numerical optimization, it leads to considerable computational speed-up even when interactions are not included.

simulation
we compared pairwise tests, logistic regression, and dda in similarly well-controlled but high-dimensional conditions in which collective effects can play important roles. in the following, unless otherwise specified, logistic regression refers to the collective inference including both marginal and interaction terms and a penalizer . we used simulated data that faithfully reflected prescribed genotype distributions of given sample sizes. a genotype distribution for a binary model with m loci has m single-snp and m/ <dig> interaction parameters. we specified these parameters randomly from normal distributions, generated genotype samples of size n based on these distributions, performed pairwise marginal inference, logistic regression, and dda, and compared inferred parameters with the true values . our simulated data include linkage disequilibrium : if one approximates the genotype distribution as a continuous-variable normal distribution, the correlation within a single group  would be proportional to the matrix inverse of interaction parameters specified, and the overall r <dig> would correspond to the sample size-weighted average over case and control groups.

for a given sample, we first determined the optimal penalizer  value by cross-validation. with increasing λ, the mean square error and the area under the curve  of the receiver operating characteristics generally showed a minimum and maximum, respectively, at λ∗ . the value of λ∗ decreased as the sample size n increased. this trend implies that for small n, an aggressive regularization is needed  to minimize overfitting, while for larger n, more interaction terms are inferred with sufficient significance, leading to smaller λ∗.

accuracy of inference we compared results of pairwise marginal tests using plink  <cit> , logistic regression, and three versions of dda  in two different simulation settings. in the first case , we used m= <dig> snps with parameters chosen such that all sites had relatively large and strong single-snp and interaction effects. we used the dominant model in these simulations in order to facilitate sampling, which requires exhaustive enumeration of all genotypes . pairwise tests derive odds ratios and p-values for each snp pair separately, and the logarithm of the interaction odds ratio corresponds to the interaction parameter. the mean square error of pairwise inference decreased slightly from sample size n= <dig> to  <dig> but showed little improvement for larger sample sizes. outcomes from logistic regression and dda exhibited auc values  increasing with n for n≤ <dig>  the aucs from logistic regression were slightly lower for n≤ <dig> than dda and comparable in larger sample sizes. the mean square error of logistic regression and dda steadily decreased  over all n ranges examined. error levels of dda from three methods were similar to one another. when compared to logistic regression, the accuracy of dda was comparable at larger n and better at smaller n. however, the logistic regression results showed much larger variances  for small n than dda.
fig.  <dig> inference accuracy, sensitivity, and specificity of pairwise and collective inference on simulated data. a–b the mean square error and auc versus sample sizes using pairwise test , logistic regression , and the three methods of dda . simulated genotypes were generated for  <dig> snps with parameters h¯y=, j¯=, σ
h=σ
j= <dig>  . c-d analogous results for  <dig> snps with h¯y=, j¯=, and σ
h=σ
j= <dig> . we set Δ
h= <dig> , Δ
j= <dig>  for the first  <dig> snps and their interactions and Δ
h=Δ
j= <dig> otherwise. e-f sensitivity and specificity of disease-associated interaction pairs. simulated data were generated with parameters h¯=, j¯=, σ
h= <dig> , σ
j= <dig>  for m= <dig> snps, except the interaction between the first two snps, for which we set j¯=. interaction p-values for all pairs were calculated either by pw or by regularization to determine λ
∗ followed by the construction of null distribution under λ
∗  for lr, pl, and ee. the distribution of p-values for the true causal interaction pair and those of non-causal pair  are shown in e and f, respectively. the dominant model was used in all cases



in the second setting , we enlarged the system to m= <dig> snps , and set the parameters such that only  <dig> snps contributed to disease association. the auc values were smaller in comparison to the first setting for smaller n, which reflects a weaker overall strength of disease association, but otherwise showed similar trends. the accuracy of pairwise tests, logistic regression, and dda also exhibited trends similar to simulations in fig. 2a: both logistic regression and dda significantly outperformed pairwise tests, while dda consistently showed slightly better accuracy than logistic regression. the variances in mean square error were smaller than in the first setting, which suggests that these variances correlate with the number of causal snps. for n= <dig>  logistic regression results had a variance much larger than dda for small n.

these simulations demonstrate that when both marginal single-snp and interaction effects are included, the accuracy of collective inference approach is much higher than that of pairwise tests. the dda generally provides a further edge for smaller sample sizes in comparison to logistic regression. the comparison of two different simulation settings in fig. 2a–b and c–d demonstrates that this trend is not significantly altered with increases in the number of snps and the fraction of causal snps among them. the accuracy  remained at similar levels when the underlying model was changed from dominant to genotypic models .

statistical tests we then examined the performance of collective inference methods in evaluating the statistical significance of individual interactions. in gwas, the significance of snps and their interactions are tested either by contingency table or likelihood ratio tests  <cit> . the presence of the penalizer λ complicates this approach in collective inference. in their study of lasso-penalized logistic regression collective inference, wu et al.  <cit>  adopted the approach of first selecting significant snps of a certain size using regularization, and then calculating p-values of interactions with the penalizer turned off. a disadvantage of this approach is that the information of the relative importance of each interactions reflected in the penalized model is lost when λ is set to zero.

the  likelihood ratio tests rely on the asymptotic distribution of the likelihood ratio statistic q : as n→∞, the distribution of q under the null hypothesis approaches the χ2-distribution with degrees of freedom  given by the change in the number of parameters between the null and alternative hypotheses  <cit> . in practice, however, with a finite n, the deviation from this asymptotic limit can be significant. we found the null distribution to show increasingly large deviations from the asymptotic limit as λ increased. we therefore based our statistical tests in the presence of a non-vanishing penalizer on empirical null distributions of qij constructed by permutation resampling .

we then sought to evaluate the sensitivity of causal interaction identification within different inference methods using simulations. we created simulated data of m= <dig> snps, this time with random parameters with mean values that were identical for both case and control groups, except a single snp pair for which the case group had stronger interactions than the control . for collective inference , we first performed cross-validation for each sample to determine optimal λ∗, and then constructed the empirical null distribution under this λ∗  to calculate p-values of the causal and non-causal interaction pairs . we selected the simulation parameters such that the snps were fairly strongly coupled via ld in each of case and control groups, but these interaction effects were expected to cancel out except for the single causal pair. the pairwise test results remained insensitive to this causal interaction for all sample sizes. the logistic regression, dda pl, and ee methods detected this interaction fairly robustly for n≥ <dig>  in all cases, dda had higher sensitivity than logistic regression. the p-values for the non-causal interactions mostly followed the expected null distribution qualitatively. however, the distributions from logistic regression were significantly broader  than dda for all sample sizes.

in applications to actual disease data, where one aims to identify statistically significant pairs of interactions based on p-values, the enhanced sensitivity and specificity of detection shown in fig. 2e are of more interest than the parameter prediction accuracy in fig. 2a, c. our results suggest that the sensitivity of detecting disease-associated interactions among mostly non-causal snp pairs from noisy data is significantly higher with collective inference than with pairwise tests. the dda inference furthermore allowed for consistently higher sensitivity and specificity than logistic regression.

age-related macular degeneration
independent-snp we first analyzed amd data under the independent-snp assumption and compared the logistic regression and dda results. analytic expressions are available for the odds ratio and p-values for dda . genome-wide p-values derived from dda  were consistent with published results  <cit> . the p-values from independent-snp logistic regression using plink and those from dda for three main associated genomic regions  were the same for most loci except those with strongest associations, for which p-values from dda were slightly smaller . differences in p-values were larger with the genotypic model than with the dominant model . thus, when interactions are not included, dda gives nearly the same results as the logistic regression inference. this feature allows one to directly interrogate how collective interactions modify association.

collective inference for  <dig> snps we then examined the performance of dda on amd data under the first mode of application, where detailed interaction patterns within a relatively small set of pre-selected snps are inferred. we selected m= <dig> amd snps using the variable selection program gwaselect  <cit>  , which covered most regions previously identified as strongly associated with amd risks . the independent-snp p-values of this set are shown in fig. 3c. for the majority of loci , the risk allele was the major allele, and odds ratios were smaller than  <dig>  as stated above, under this condition of no interaction, the p-values from logistic regression  and those from dda  were nearly the same.
fig.  <dig> collective inference applied to pre-selected m= <dig> amd snps. a–b regularization via cross-validation. dominant  and genotypic  models were used with logistic regression , dda pl , and mf . independent-snp limit is reached with λ→∞ and ε→ <dig>  because of the pre-selection of snps using phenotype information, the prediction score  derived from 5-fold cross-validation over-estimates the true auc. the maxima in pauc correspond to optimal regularization. c–d single-snp and interaction p-values of the optimized  model under pl . the p-values from independent-snp and pairwise tests are also shown for comparison in c and d, respectively. see additional file 1: table s <dig> for the independent-snp results and snp list



we applied collective inference  to this 20-snp set using logistic regression and dda. we first performed cross-validation to determine the optimal penalizer λ∗ . it should be noted that because the pre-selection of snps in this case used phenotype information of the entire sample, the cross-validation prediction score is not an unbiased estimate of the true auc and is generally higher in value  <cit> . in our application, this procedure merely allows for the identification of optimal regularization levels for collective inference. we denote the prediction score derived after such pre-selection using sample phenotypes as pseudo-auc  in order to distinguish it from the true estimate of auc. unbiased estimates of auc, if desired, can be obtained, for example, by performing independent-snp p-value-based filtering based only on training sets of each cross-validation sub-division  <cit>   or by using selection criteria unrelated to sample phenotypes .

as observed with the simulated data, when dda was used, the pauc values with varying regularization levels showed a maximum , which corresponds to the optimal degree of interaction effects to be included in genotype distributions. for pl , the maxima were located at λ∗= <dig>   and λ∗= <dig>   for the dominant and genotypic models, respectively. the slightly higher pauc suggests that for this data set, the genotypic model provides a better fit. for dda, we verified that in the large- λ limit, the inference outcome approaches the independent-snp result. the difference between this limit and the maximum pauc is a measure of the relative importance of interactions in disease association.

we also applied logistic regression-based collective inference to the same data set. cross-validation yielded similar differences between the dominant and genotypic models . however, pauc did not exhibit pronounced maximum, instead approaching a large- λ limit nearly monotonically. this limit was slightly higher than the corresponding dda maximum, which is consistent with the expectation that logistic regression can yield better prediction performance because it maximizes the prediction score . on the other hand, the absence of pronounced maximum in pauc as a function of λ indicates a loss in sensitivity in logistic regression for the detection of interaction effects. this conclusion can be rationalized in terms of the algorithmic difference between logistic regression and dda: in dda, case and control group genotype distributions are fit separately in terms of their respective single-snp and interaction parameters, whereas logistic regression optimizes the prediction score with respect to the net differences in those parameters. with more flexibility to account for differential population structures, dda has higher sensitivity to detect interaction effects.

we used the optimal penalizer value to determine the parameters and p-values for this 20-snp data set under the genotypic model using dda pl. the p-values, representing the statistical significance of the individual terms included in the model, consist of two classes: single-snp and interactions. the single-snp p-values represent the significance of marginal single-site effects  or βi). they are analogous to the independent-snp p-values of each snp, but having been inferred in the presence of interactions, they also indirectly reflect interaction effects. strictly speaking, the presence of penalizer λ also affects the distribution of the likelihood ratio statistics qi and it is desirable to estimate their p-values using permutation resampling. however, since we did not impose penalty to single-snp terms directly , we expect this effect to be moderate. in practice, these p-values tend to be much smaller than  <dig> for snps selected based on independent-snp properties, and they are difficult to estimate using resampling. we chose to use the asymptotic χ2-distribution to estimate these single-snp p-values under collective inference. these are therefore expected to be upper-limits  based on the observation that the penalizer tends to suppress null distributions to lower q-region.

we then performed resamplings of this data set to obtain interaction p-values , which indicated strong interactions within the cfh gene group in chromosome  <dig>  c <dig> in chromosome  <dig>  and arms2/htra <dig> group in chromosome  <dig>  in contrast, pairwise test p-values detected strong interactions only within the last group of loci, between rs6585827/rs <dig> and rs2014307/rs <dig> . these short-range interactions suggested by dda tended to be correlated with ld: because the net disease association is related to the difference in snp correlation patterns between case and control groups , we interpret these short-range interactions as the consequence of differential ld-patterns in case and control individuals. the absence of such signals in pairwise test p-values suggests that such differences get averaged out when represented only by marginal snp-pair distributions.

we sought to further test whether such increased sensitivity toward interactions was achieved with adequate control for false discovery rates. the selection of m= <dig> snps in fig. 3c–d comprises snps with highest association. for comparison, we made a random selection of m= <dig> snps from the genome-wide data and performed dda as well as pairwise test. the quantile-quantile plot  showed that p-values for interactions between these random snps were distributed close to the null distribution. in particular, dda and pairwise outcomes were similar, except for one pair for which dda predicted p∼10− <dig>  in contrast, the distribution of interaction p-values for the highly associated m= <dig> snps  from dda deviated significantly from the null , whereas the pairwise test outcome remained similar to random snps except for ∼ <dig> snp pairs. these results suggest that dda achieves increased sensitivity for interactions while adequately controlling for false positive rates.
fig.  <dig> quantile-quantile plot of interaction p-values. a distributions for interactions among m= <dig> snps randomly selected from genome-wide data. b distributions for interactions among  <dig> snps with high association  and a larger set . see additional file 8: figure s <dig> for pairwise  results for m=96



large-scale collective inference the analysis described above used a fixed number of pre-selected snps to perform cross-validation and inferences. we next enlarged the size of snp sets by controlling it using an independent-snp p-value cutoff pc; with the cutoff specified, in each cross-validation run, the training set was used to obtain independent-snp p-values, filter snps, and perform inferences, and the test set was used for prediction. the prediction score derived under this protocol is an unbiased estimate of the true auc. the auc values  showed qualitative trends similar to fig. 3a; the auc maximum relative to the non-interacting limit was more pronounced, while its height showed a moderate decrease with increasing snp numbers: inclusion of less-significant snps diluted the overall effects. we chose a snp-set size of m= <dig>  for interaction pattern analysis. the interaction p-value computation for m snps entails a multiplication of the single-inference computing time by m/ <dig>  times the necessary random resampling size  for p-value estimation, thus limiting model sizes that can be considered to m∼ <dig> 
fig.  <dig> collective inference with snp selection based on independent-snp p-values. a auc with varying penalizer λ under pl inference, where independent-snp p-value cutoff p
c indicated was used to filter snps from the full genome-wide set in each cross-validation run. the mean snp number m¯ is the average over  <dig> runs. b auc optimized over regularization  with varying model sizes controlled by p
c. snp selections were made from the full genome-wide data  and subsets generated by pruning based on ld thresholds indicated. note that the maximum auc position shifts to lower m¯ with increasing degree of pruning  and that an optimal level of pruning  exists for highest performance. vertical lines are  <dig> % c.i



the resulting single-site and interaction p-values are shown in fig.  <dig>  where the bottom panel compares the independent-snp/collective single-site p-values. as in fig. 3d for the smaller snp set, the collective single-site significance of strongly associated snps was generally reduced in strength compared to the non-interacting case. however, rs <dig> in chromosome  <dig> had a comparable p-value  and many snps originally with weaker associations in the non-interacting case became stronger under collective setting. the interaction landscape shown on the top panel of fig.  <dig> retained the qualitative trend of the results from the smaller data set in fig. 3d, but with much more detail; we confirmed the presence of local interactions within the cfh, c <dig>  and arms <dig> gene groups. in addition, we observed numerous ‘long-range’ interactions that were absent in the m= <dig> results: rs <dig> in cfh interactions with rs <dig> and rs <dig> in c <dig>  and there were additional distributed interactions between the cfh loci and the arms <dig> gene group. the distribution of interaction p-values was similar to that for m= <dig> in the quantile-quantile plot . the pairwise test p-value landscape for the same data  was also qualitatively similar to the m= <dig> case .
fig.  <dig> interaction and single-site p-values for m= <dig> amd snps. the bars  and the heat map  show the single-snp and interaction p-values, respectively. hollow and solid bars represent the independent-snp and collective inference p-values respectively. dda pl was used for collective inference



the overall picture of disease-associated epistatic interactions from our small and larger-scale collective inferences in figs. 3d and  <dig> provides a plausible explanation of the recent observation by hemani et al.  <cit> , who detected many epistatic snp pairs leading to differential gene expressions within the human genome by exhaustive searches using pairwise tests. wood et al.  <cit>  then observed that many of these effects could be explained by single untyped third snps in ld with the interacting pairs. here, we observed both from simulations and amd snp analyses that pairwise tests  detect only a subset of statistically significant interactions, and a portion of the interaction patterns uncovered from collective inference parallels that of the underlying ld : snps with strong overall correlations often also have differential ld between case and control groups. it is thus understandable that interacting pairs of snps identified in marginal pairwise tests turn out to be in ld with other hidden variants. our results in fig.  <dig>  however, demonstrate a strong presence of interactions beyond both the population ld  and the reach of pairwise tests .

disease-associated epigenomes most of the disease-associated loci from gwas reside in non-coding regions, presumably exerting their effects through modifications of gene regulatory action  <cit> . the overlap of epigenetic signatures with disease-associated snps and their interactions can provide important biological insights to the underlying disease mechanism. we sought to identify tissue and cell type-specific interaction patterns associated with amd phenotypes using the snp interaction map we derived above . we used the recently published nih roadmap epigenomics consortium data  <cit>  to first calculate the enrichment p-values of the transcribed/enhancer states among the selected  <dig> amd snps within each of the  <dig> reference epigenomes . we combined the actively transcribed and enhancer states of the  <dig> chromatin state annotations of the reference epigenomes to define the ‘active’ state. for each amd-associated snp, we identified the group of all known snps that were strongly correlated , obtained the distribution of epigenetic states over these snps within a given epigenome, and tested the over-representation of the active state against the background distribution. this enlarged search over the set of all known snps in ld with the locus included in inference is crucial to address the issue of the incomplete coverage of genotype data.
fig.  <dig> enrichment p-values of active epigenetic states among amd-associated snps. the set of  <dig> snps in fig.  <dig> was used. the reference epigenome labels are as defined in fig.  <dig> of ref.  <cit> . es, embryonic stem cell; es-deriv., es cell-derived; hsc, hematopoietic stem cell; ips, induced pluripotent stem cell; msc, mesenchymal stem cell; neurosph., neurosphere



the most prominent feature in fig.  <dig> is the strong enrichment of active epigenetic states among amd snps within the liver tissue , followed by ovary . two additional epigenomes, embryonic stem cell-derived neuronal progenitor cultured cells  and bone marrow-derived mesenchymal stem cells , were also notable, but their enrichment p-values on the single-snp level were comparable to other tissues.

we then hypothesized that the statistically significant interactions between snps identified in fig.  <dig> would provide additional information of the cell-type specificity of epigenetically active states and their interactions. we selected the snp pairs with interaction p<10− <dig> from fig.  <dig> and, assuming that each groups of ld-correlated snps came from specific cell types , tested the enrichment of active state pairs. the p-values derived then reflect the statistical significance of the epigenetic modifications enabling the interactions occurring between two cell types that are disease-associated.

the resulting landscape shown in fig.  <dig> exhibited strong interactions involving the liver tissue, consistent with the single-snp result in fig.  <dig>  however, clear patterns not seen on the single-snp level also emerged: bone-marrow derived mscs  and adipose nuclei  also featured prominently in the interaction landscape; the bulk of interactions involving the liver tissue was accounted for by those with msc, adipocytes, and muscle tissues. embryonic stem cell h1-derived mscs  showed interactions that were weaker but similarly distributed in comparison to bone-marrow derived counterparts. the ovary followed patterns similar to the liver but was less pronounced than in fig.  <dig>  in addition, lung  and placenta  showed some interactions with adipocytes and mscs. all of these tissues strongly interacted with themselves: interacting snps in these tissues are highly likely to be active epigenetically.
fig.  <dig> enrichment p-values of active epigenetic state pairs among amd-associated snp interactions. the snp pairs with interaction p-value <10− <dig> in fig.  <dig> were tested for enrichment within each reference epigenome pairs



snp selection from genome-wide data collective inference without interaction p-value computation can be applied to snp sets of sizes up to m∼ <dig>  the prediction auc as the main outcome for each snp selection then allows for the comparison of the relative strengths of disease association of different snp groups. in such applications, the performance of dda could depend on  processing applied to genome-wide data in selecting snp sets for analysis. we evaluated this second mode of dda application and assessed how its performance varied depending on the degree of ld within snp sets. we generated different subsets of genome-wide snps by pruning, removing variants that had ld with neighboring snps higher than a threshold . the auc obtained with snps selected from the full genome-wide data peaked around the mean number of snps m¯∼ <dig>  as suggested also by fig. 5a. with ld-based pruning, the position of maximum shifted to levels up to m¯∼ <dig>  which suggests that about  <dig> snps in linkage equilibrium account for the bulk of the association. the height of the auc first increased with the data pruned with r2< <dig>  compared to the full set and then decreased with r2< <dig> , indicating that there is an optimal level of pruning beyond which key causal snps begin to be removed. overall, the relatively small model size ranges where collective inference performance is maximized in fig. 5b suggests that amd is only weakly polygenic with dominant contributions from a few loci. analyses of the type demonstrated in fig. 5b thus allows one to assess the polygenicity of the phenotype under consideration and choose suitable strategies for snp selection.

pathway-based snp selection an obvious criterion for grouping genome-wide snps into subsets for collective inference-based evaluation is the proximity to gene sets belonging to known biological pathways. from the full amd genome-wide data, we generated  <dig>  snp sets corresponding to  <dig>  reactome pathways  <cit> , each containing from  <dig> to ∼ <dig> snps. we then applied dda mf inference and derived optimized auc values for each pathway . the majority of the pathways had association levels  close to the null value of  <dig> . the differences in collective inference auc relative to independent-snp results ranged from  <dig> to ∼ <dig> . reflecting the dominance of the complement-related genetic loci, regulation of complement cascade  and complement cascade  showed top association levels clearly separated from the rest. these auc values were similar to the levels observed in pc-based sampling in fig. 5b adjusted to their corresponding snp numbers. we used a selection of pathways with low auc values to sample their null distributions and connect auc  and p-values corresponding to the overall association of each snp set . the − log10p values monotonically increased from  <dig> as auc increased from  <dig> , and became highly linear for auc> <dig>  . we used this linear regression formula to translate auc into p-values. the bonferroni correction with  <dig>  pathways to the nominal false discovery rate indicated a threshold of auc> <dig> , which led to  <dig> pathways above the threshold shown in table  <dig> 
fig.  <dig> amd association of pathways under collective inference. a auc score versus pathway size . symbols show collective and independent-snp inference aucs under 5-fold cross validation. vertical lines are  <dig> % c.i. the horizontal line represents the bonferroni-corrected nominal discovery threshold based on the p-value estimates. b regression of auc versus pathway p-values. the latter were obtained for a selection of pathways via phenotype-label reshuffling using auc as the statistic. dotted line is the linear fit for auc> <dig> . c–e pathways with association strength auc> <dig> , grouped according to the top hierarchical classes they belong to. we excluded pathways in the disease class. dendrograms below the bars show their hierarchical relationships. abl, abl tyrosine kinase; activ., activation; assoc., association/associated; biosynth., biosynthesis; c <dig>  complement component 3; c <dig>  complement component 5; cct, chaperonin-containing t-complex polypeptide 1; cell., cellular; chrebp, carbohydrate response element-binding protein; ecm, extracellular matrix; ehmt <dig>  euchromatic histone-lysine-methyltransferase 2; elong., elongation; er, endoplasmic reticulum; ercc <dig>  excision repair cross-complementation group 6; expr., expression; form., formation; hsf, heat shock factor; ifn, interferon; indep., independent; lys, lysine; mda <dig>  melanoma differentiation-associated gene 5; med., mediated; metab., metabolism; myd <dig>  myeloid differentiation primary response 88; nfkb, nuclear factor- κ b; pa, phosphatidic acid; pkmt, protein lysine methyltransferase; pol, polymerase; proc., processing; reg., regulate/regulation/regulated; rig-i, retinoic acid-inducible gene-i; rip, receptor-interaction protein; robo, roundabout; sasp, senescence-associated secretory phenotype; sig., signaling; smac, second mitochondrial activator of caspases; synth., synthesis; sys., system; thru, through; tp <dig>  tumor protein p53; transc., transcription/transcriptional; tric, t-complex polypeptide  <dig> ring complex; zbp <dig>  z-dna-binding protein-1

p-value b

a <dig> % c.i. in parentheses


bestimated from the regression in fig. 9
b


c <dig>  complement component 3

c <dig>  complement component 5

tp <dig>  tumor protein p53



amd disease mechanism we sought to gain insights to molecular-level disease mechanisms of amd by examining the pathways in table  <dig> along with additional pathways near the threshold and grouping them into hierarchical classes . there are two primary types of amd, the ‘dry’ and ‘wet’ forms  <cit> . the dry amd more commonly occurs in earlier stages, where retinal pigment epithelium  cells supporting photoreceptors in the retina undergo degeneration, often accompanied by the accumulation of drusen in the area between rpe and the bruch’s membrane separating the retina from the choroid. the wet amd is characterized by invasive choroidal neovascularization of the retina. in both forms, cellular stress factors exacerbated by aging are the primary causes leading to rpe dysfunction. the normal functioning of photoreceptors, bombarded by light and highly susceptible to oxidative damage, relies on continual recycling of their spent outer segments via phagocytosis by rpe cells  <cit> . peroxidation products of phospholipids, the key ingredients of photoreceptors, often end up as major components of drusen, and serve as damage-associated molecular patterns activating innate immune receptors, including toll-like receptors  as well as complement factor h   <cit> . the latter has been shown to bind malondialdehyde  derived from docosahexaenoic acid  <cit> . in addition, phosphatidylserine is the main ‘eat-me’ signal toward phagocytes when displayed on the extracellular membrane of dying cells  <cit> . consistent with these aspects of amd pathogenesis, we found associations with phospholipid metabolism pathways , and in particular, synthesis of phosphatidic acid, which suggests that disease risk is affected by genetic variants modifying the ability to supply these phospholipids.

phospholipid synthesis requires the supply of fatty acids, synthesized in the liver. the causal link to this process of lipogenesis is suggested in fig. 9e by the pathway carbohydrate response element-binding protein  activates metabolic gene expression. chrebp is a key transcription factor in hepatocytes, responding to glucose uptake and activating genes involved in lipogenesis  <cit> . fatty acids thus synthesized are transported into the bloodstream in the form of very low density lipoproteins and stored as triacylglycerols in adipocytes  <cit> . the suggested amd risk association of the fatty acid supply from the liver and adipocytes for phospholipid synthesis provides an explanation of our earlier finding in fig.  <dig> that snp interactions associated with amd are epigenetically active in the liver and adipocytes.

oxidative stress is often accompanied by disruptions to protein folding, which can lead to protein aggregation and autophagy when refolding by chaperones proves inadequate  <cit> . we found association in protein folding pathways , and in particular chaperonin-mediated protein folding, which primarily targets actins and tubulins, the major ingredients of cytoskeletal networks  <cit> . this observation suggests that rpe stress from protein misfolding affects amd risk via its effect on phagocytic function, which relies heavily on actin filament and microtubule remodeling dynamics  <cit> . also closely related is the regulation of heat shock factor  1-mediated heat shock response in fig. 9e, which describes the transcriptional activation of heat shock protein  expression under stress. the latter pathway belongs to the cellular responses to stress group, in which we also found association with senescence-associated secretory phenotype . senescence is one of the possible fates of cells under stress, where normal cellular growth is arrested in preparation for clearance by phagocytes  <cit> . sasp refers to a complex suite of inflammatory cytokines, chemokines, and growth factors facilitating the process, and we infer that senescence in rpe cells under oxidative stress plays a part in amd.

apoptosis, or controlled cell death  <cit> , is another major stressed-cell response, and was also represented in our results . a large body of direct evidence points to apoptosis as one of the main routes of rpe degeneration in amd  <cit> . induction of apoptosis upon stress is dictated by the action of master regulator p <dig>  and it was recently shown that aging increases the activity of p <dig> in rpe cells and the likelihood for apoptotic cell death  <cit> . consistent with this evidence, we found association with pathways in transcriptional regulation by tp <dig> group . in particular, regulation of tp <dig> activity through methylation was among the top pathway in our association analysis , suggesting that p <dig> modification by methylation and the closely related histone modifications  play important roles in rpe apoptosis regulation. in the intrinsic apoptotic pathway induced by oxidative stress, cytochrome c is released from mitochondria into the cytosol, binding and activating caspases, the main proteases central to apoptotic action. we found association in pathways involving ‘inhibitor of apoptosis’  and its negative regulator ‘second mitochondrial activator of caspases’   <cit> , which suggests that disruption to regulatory mechanisms preventing apoptosis in rpe cells may play roles in amd.

rpe degeneration and drusen formation can lead to inflammation, the main innate immune response involving a wide range of pattern-recognition receptors  and complement activation  <cit> . most of known prrs were represented in our results , including tlrs, advanced glycosylation endproduct receptors, rig-i-like receptors, and cytosolic dna sensors  <cit> . complement factors constitute the soluble counterparts of prrs, and regulation of complement cascade showed the highest association due to the contribution of cfh, as well as activation of c <dig> and c <dig>  cfh normally protects self tissues from complement-induced destruction by binding to a range of surface signals including glycoproteins and c-reactive protein. in addition to the binding of cfh to mda noted above, it was also reported that cfh inhibits lipoprotein binding toward bruch’s membrane  <cit> . the breach of bruch’s membrane and the intrusion of blood vessels into the retina are the hallmarks of wet amd  <cit> , which are consistent with our finding of high association in degradation of extracellular matrix and common pathway of fibrin clot formation in fig. 9e.

CONCLUSIONS
in this paper, we first described and tested discriminant analysis-based algorithms inferring collective disease association effects applied to intermediate-sized snp sets. using simulated and actual disease data, we provided evidence suggesting that collective inference methods outperform pairwise tests and logistic regression in incorporating interaction effects in disease association.

we demonstrated two different modes of applying dda in the analysis of actual disease data: one in which detailed interaction patterns within a relatively small set of snps are inferred, and the other where genome-wide snp data are grouped into different subsets of snps and collective inference is used to compute the degrees of disease association of each subset. our results applied to amd in fig.  <dig> based on pathway-based snp selection, in particular, show that the latter protocol allows us to identify pathways encompassing a large fraction of disease mechanisms previously established by non-genetic means. based on current study, we propose the following approach to deal with novel gwas case-control data using dda: first, characterize the degree of polygenicity of the data set with independent-snp and collective inferences employing pc-based snp selection and optimize the density of snps using ld-based pruning . second, classify snps into pathway-based groups, score them using collective inference, and seek insights to the underlying disease mechanisms by analyzing the results within the pathway hierarchy.

