BACKGROUND
in a wide variety of animals, mainly germline expressed small rnas - named piwi interacting rnas because of their interaction with effector piwi proteins - play an important role as guiding rnas in safeguarding the genome from the detrimental effects of actively transposing elements  <cit> . most pirnas are encoded in strand specific genomic clusters ranging from <1kb to >100kb. beside mono-directional clusters encoding pirnas on only one strand, there are also bi-directional clusters whose halves encode pirnas on opposite strands and where transcription starts in opposite directions from a centrally located promoter. in general, pirna clusters are assumed to be transcribed into long single stranded precursors that are subject to subsequent processing, leading to mature pirnas. in a process referred to as ping pong cycle  <cit> , pirna guided piwi proteins cleave te transcripts thus producing a second population of te derived pirnas. although pirna genesis shows signs of a quasi-random mechanism with partially overlapping sequences, pirnas exhibit typical sequence characteristics, e.g. position specific frequency patterns. in mice, the cluster derived pirna population exhibits a strong bias for uridine at the 5'-end, whereas the transposon derived population is biased for adenine at position  <dig>  in drosophila, the situation is converse  <cit> . however, many questions concerning this process, as well as the functional role of pirnas beyond transposon silencing  remain elusive.

research on pirna biogenesis and function, as well as the successful targeting of questions related to the possible coevolution of the piwi/pirna system, will involve comparative studies of homologous pirna clusters  <cit> . therefore, a reliable bioinformatic pirna cluster detection tool is imperative, especially in light of the ever exceeding amount of data obtained from next generation sequencing  that requires robust automated bioinformatic solutions.

present studies identified pirna clusters in the human, mouse and rat genome using different methods, starting with varying mismatch stringency when mapping the obtained sequence reads from pirna transcriptome analyses to genomes. in addition, pirna clusters were annotated at pirnabank  <cit>  using the available data . the hitherto applied algorithms basically rely on finding regions that exhibit a high density of mapped pirna sequences and respective threshold values depend on the amount of mapped sequences and are mostly determined in a heuristic manner, depending on whether the main focus lies on specificity or sensitivity. however, a considerable fraction of pirna sequences, especially te related sequences, also maps to regions in the genome that are most likely not transcribed to pirna precursors, hence do not represent formal pirna clusters. purely by chance, these hits can accumulate e.g. in regions that exhibit a high amount of tes and may accidentaly be annotated as pirna cluster. in this context, stringent criteria such as used by girard et al.  <dig>  <cit>  and lau et al.  <dig>  <cit>  ensure high specificity by precluding sequence reads with high abundance or requiring a minimum number of single-copy pirna loci respectively. on the other hand, they may lead to the exclusion of clusters that arose from recent duplication events  <cit>  hence harboring no or only a few pirna loci whose sequence is unique within the genome. furthermore they may fail to identify all existent pirna loci within a given cluster, when frequently mapped reads are a priori excluded from the analysis  <cit> . less stringent criteria, relying solely on a high amount of pirna loci such as used by lakshmi and agrawal  <dig>  <cit> , potentially increase sensitivity at the expense of specificity since frequently mapped sequence reads in particular can cumulatively map to regions in the genome that are not transcribed to pirna precursors. consequently, many of the annotated clusters at pirnabank indeed exhibit an appropriate number of putative pirna loci within a small genomic region, but e.g. do not exhibit the mono- or bidirectional organization which is typical for pirna clusters.

*method not explained in more detail, ** based on hit density for each organism  <cit> .

based on the imperfection of the currently available algorithms, and since the essential differences between them may hamper upcoming comparative studies in this field, we developed the user-friendly cluster detection software protrac, which uses seqmap output files  <cit>  for fast and customized detection, visualization and analysis of pirna clusters in genomes, ensuring reproducibility and comparability. protrac analyzes the entirety of mapped sequence reads and identifies clusters based on significant deviations from the hypothetical uniform distribution regarding the density of mapped reads, strand asymmetry, frequency of putative pirna loci with t at position  <dig>  or a at position  <dig> , as well as the amount of putative pirna loci within the typical pirna length range and the quantity of loci corresponding to infrequently mapped reads. the latter criterion represents a convenient benchmark since many pirna loci sequences within one cluster exhibit low redundancy or are even unique within the genome. this causes an increased number of normalized hits within a pirna cluster  as compared to the value that one would expect if a corresponding number of hits was randomly selected from the entirety of mapped reads. in the following we show, that the protrac algorithm provides considerable advantages compared to the currently applied methods.

implementation
workflow
accepted input files are specially formatted seqmap output files  which can be obtained by running seqmap with the option/output_all_matches. eland <dig> files contain a list of mapped sequences and associated coordinates in genome coordinate order, each line corresponding to one mapped sequence read. protrac basically operates with a sliding window while reading the input file. the window size in lines is given by the required minimum number of mapped sequence reads per cluster. if the region encompassed by the first and last coordinate of the sliding window is small enough to exceed the minimum density of mapped reads , the respective loci are tagged. contiguously tagged loci are assembled to cluster candidates being subject to a subsequent verification process. the required minimum number of putative pirna loci  and minimum hit density depend upon the provided dataset and the stated minimum score values, which are explained in more detail below. in order to determine the minimum hit density, protrac examines the distribution of mapped sequence reads for each chromosome or scaffold and specifically calculates a significant hit density by stepwise computation of the probability to observe an increasing number of hits within a 1kb window on the given chromosome or scaffold assuming a uniform distribution of mapped sequences .

in order to obtain hit density threshold values with a resolution more precise than in steps of  <dig> hit/kb, protrac calculates probabilities  for non-integer hit numbers  per kb with an increment of  <dig>  by using factorials deduced from the gamma function: Γ = !. the stepwise calculation of p continues until the probability reaches the significance level. then, the minimum hit density is defined as k hits/kb.

the minimum number of putative pirna loci per pirna cluster corresponds to the minimum number of loci needed to reach all stated score values  with the given dataset.

if necessary, since overlapping sections of proper hit density can result in one large cluster candidate which in sum falls below the minimum hit density, protrac performs a stepwise clipping of peripheral hits to find the largest possible cluster candidate. during a progressive process with an increasing number of hits, in each step all possible combinations of upstream and downstream hits are clipped from the cluster candidate ends and the effect on hit density is assessed for each combination. this process continues until a sufficient combination with the minimal number of hits is found and the hit density of the remaining cluster, comprising the highest possible number of putative pirna loci, exceeds the required minimum. the removed hits, potentially forming a separate cluster, are assessed subsequently as a separate cluster candidate.

since pirna clusters are typically organized in a mono- or bidirectional manner protrac determines directionality by comparing the degree of mono- and bi-directionality. the degree of mono-directionality is simply given by the proportion of sequence reads encoded on the main strand . to determine the degree of bi-directionality, each cluster is split stepwise between every pair of hits that yields two fragments with each fragment comprising at least 25% of all hits or at least  <dig> hits respectively. subsequently, the proportion of sequence reads encoded on the main strand is computed independently for each fragment and summed pro rata. the highest attainable value accounts for the degree of bi-directionality. if one or both values exceed the user defined directionality threshold, the cluster is assigned to the respective directionality category. otherwise it is assessed to be non-directional.

not to rely solely on tracing regions that exhibit a high hit density, and rather additionally consider the characteristics of the clustered putative pirna loci, protrac now verifies each cluster candidate by examining its: i) number of normalized hits to total hits ratio, ii) extent of strand bias, iii) proportion of putative pirna loci with 1t or 10a respectively and iv) proportion of putative pirna loci within the typical length range. for each parameter protrac assigns score values based on a probabilistic scoring system which evaluates the probabilities to obtain the observed cluster characteristics in the light of the given dataset . regarding strand bias, we assume equal probabilities for one mapped sequence read to be encoded on either plus- or minus strand. furthermore, we presume that the number of hits per cluster is very small compared to the total number of mapped sequence reads, so that protrac can calculate probabilities in a sampling-with-replacement fashion, which accelerates computation without a noticeable effect on the results.

score values for strand bias , enrichment of putative pirna loci with optimal length  and enrichment of putative pirna loci with 1t or 10a  are calculated using the following equation: score=log⋅rk⋅n−k)− <dig> where n is the total number of hits in the cluster. the score value for enrichment of putative pirna loci with 1t or 10a automatically scores either 1t or 10a enrichment , so that it is suitable for datasets comprising primary as well as secondary pirnas in both vertebrates and flies. for reasons of computational speed, protrac performs an approximate calculation of the score value for enrichment of putative pirna loci corresponding to infrequently mapped reads as measured by the normalized-hits/total-hits ratio . therefore, instead of considering the exact number of genomic hits produced by each read, which would lead to an exorbitant number of possible combinations per cluster, the entirety of mapped sequence reads  is sorted into  <dig> groups based on the number of genomic hits per read . the number of groups was chosen as a suitable tradeoff between precision, which asymptotically increases, and computational speed, which exponentially decreases with a growing number of groups. for each of these groups containing r1-r <dig> reads, the average number of genomic hits per read is calculated  and this number is ascribed to each read of the group. for each cluster comprising n putative pirna loci, protrac then calculates the minimum number of sequence reads from group  <dig> ,  <dig> ,  <dig>  and  <dig>  to obtain an ntr greater or equal than the observed ntr, under the assumption that all remaining reads are from group  <dig>   <dig>   <dig> and  <dig> respectively: mi=⌈ntr−1ai+4⋅n−1−−1⌉ {i∈ℕ| <dig> }. finally, protrac calculates the score based on the probability to obtain an ntr equal to or greater than the observed ntr by summating the probabilities for each sufficient combination: score=log⋅k⋅n−k)− <dig> 

in general, the calculation of score values implies calculation of factorials corresponding to the total number of loci within one cluster, which gets computationally more expensive with an increasing number of hits per cluster candidate. if one cluster candidate comprises more than  <dig> putative pirna loci, its total number of putative pirna loci is set to  <dig> and the other parameters are scaled down accordingly. this may lead to an underestimation of score values. however, this will not lead to rejection of true clusters, since the computation of probability by default aborts once the probability falls below 1/ <dig> , which is often the case with clusters of this size. moreover, the minimum set score values should reasonably not exceed  <dig> 

since it is possible, that real pirna clusters are concealed by the presence of loci that correspond to frequently mapped sequence reads that do not originate from the cluster in question but distort its strand asymmetry, protrac optionally reevaluates rejected cluster candidates in that case, considering only loci that correspond to sequence reads that mapped not more than a stated maximum times to the genome, similar to the method applied by girard et al.  <dig>  <cit> .

once clusters are identified and validated, protrac calculates the probability for each cluster, whether any of its observed deviations from the hypothetical uniform distribution came off by chance and deduces the probability for  <dig>  1-or-more and 2-or-more mistakenly annotated clusters within the obtained set of detected clusters.

output
if the initial sequence dataset that is mapped to the genome via seqmap contains transcriptional information , this information can be readout from the resulting eland <dig> file by protrac and used to display transcription rates of different putative pirna loci within one cluster. in addition, loci corresponding to multiple mapping reads can be highlighted and their transcription rate can be normalized by the number genomic hits produced by the sequence read in question. different pirna cluster visualizations are displayed in figure  <dig> 

beside a separate fasta file and picture file for each cluster, protrac can optionally output a summary file which lists all detected clusters with corresponding cluster data, optionally sorted by the summed score values.

RESULTS
initial testing of program performance
in order to test the performance of protrac and to determine suitable thresholds for score values, nonredundant human , mouse  and rat  pirna sequences downloaded from national center for biotechnology information  nucleotide database  <cit>  were mapped to the respective genomes  via seqmap  and the seqmap output files were used as input files for protrac.

protrac was performed three times for each dataset applying increasingly stringent thresholds. assuming that the downloaded and mapped sequences contain pirnas exclusively, we did not expect a deviation of putative pirna loci with either t at position  <dig> or a at position  <dig>  in pirna clusters as compared to the entirety of mapped sequences. hence, calculation of the score value for enrichment of putative pirna loci with 1t/10a was based on random base composition . the results are shown in table  <dig>  the protrac summary files containing a list of all detected clusters with the related quality characteristics including the respective score values are available for each species . additionally, the respective zip-compressed protrac result folders containing a.png picture file and a fasta sequence file for each cluster are available as additional files  <dig> , <dig> .

*significance level for increased hit density/minimum score for strand bias, enrichment of loci corresponding to infrequently mapped reads and enrichment of putative pirna loci with 1t/10a. **depending on chromosomal pirna density. ***mono-, bi-directional: >75% of mapped sequences located on the main strand.

the inquiry of up to four different score values, corresponding to a particular probability, as well as the applied significance-based minimum hit density for each cluster, lead on to the statistical problem of multiple testing. according to the bonferroni correction, we obtain the significance level α =  <dig>  for the whole family of n  tests by applying a significance level of  <dig>  for each individual test . on this basis, we assume α =  <dig>   and score values ≥ <dig> to be suitable thresholds to yield results of adequate reliability.

for further assessment, we compared protrac results obtained with these thresholds with the clusters annotated at pirnabank as well as the results from lau et al.  <dig>  <cit> . finally we repeated cluster detection with protrac taking only those sequence reads into account, that mapped 1- <dig> times to the genome, since only these sequence reads were considered by girard et al.  <dig>  <cit> . the resulting pirna clusters were checked for the absence of loci that correspond to the excluded sequence reads.

protrac results compared to pirnabank annotation
protrac results apparently differ from pirnabank annotation. beside a number of pirna clusters that are present in both, protrac detects clusters not annotated in pirnabank and rejects other clusters annotated at pirnabank . in addition, some clusters detected with protrac are annotated as multiple clusters in pirnabank or vice versa. running protrac without minimum probabilistic score values led to the detection of previously rejected clusters that are annotated at pirnabank. these clusters were found to exhibit characteristics casting doubts on their validity. either, the putative pirna loci do not show the typical mono- or bi-directionality and/or the ntr value does not significantly exceed the value that would be expected if a corresponding number of hits was randomly selected from the entirety of mapped sequence reads. figure 4a and 4b examples show two human pirna clusters, the first one detected with protrac and not annotated at pirnabank, the second one annotated at pirnabank and rejected by protrac. in addition, pirnabank annotation splits this cluster into two separate clusters . the  <dig> hits within the second cluster  amount to only  <dig>  normalized hits  and therefore this cluster might simply constitute an accumulation of loci that correspond to frequently mapped reads that does not represent a formal pirna cluster being transcribed to a pirna precursor transcript. this finding is also supported by the atypical non-directional topology of the cluster .

*if several clusters detected with protrac were annotated as one cluster in pirnabank or vice versa, these clusters were counted as one cluster.

protrac results compared to results from lau et al.  <dig>  <cit> 
the pirna cluster criteria applied by lau and colleagues  are very stringent and suitable to mostly avoid false positive pirna cluster annotation. however, they may lead to being insensitive regarding pirna clusters that arose from recent paralogization events thus harboring no or only a few single-copy pirna loci.

we searched for pirna clusters applying the same sequence datasets as used by lau and colleagues . protrac confirmed all previously annotated clusters with the only exception of the x-chromosomal rat pirna cluster  <dig> which undercuts the minimum required hit density of  <dig>  hits/kb for the x chromosome . in addition, protrac detected  <dig> further mouse  and  <dig> further rat  clusters. as an example, figure 4c shows two mouse pirna clusters on chromosome  <dig>  with the upper cluster arising from a  <dig> kb duplication of the lower cluster. although the duplicate harbors  <dig> putative pirna loci , it is not annotated as pirna cluster by lau et al.  <cit>  since it contains only  <dig> single-copy loci as a consequence of duplication.

protrac results compared to results from girard et al.  <dig>  <cit> 
in order to avoid false positive pirna cluster annotation, girard et al.  <cit>  considered only sequence reads that mapped 1- <dig> times to the genome. we reproduced this method by running protrac taking only these infrequently mapped reads into account and applied a minimum hit density of  <dig> hits/kb and a minimum of  <dig> hits in total per pirna cluster  with the aim to assess the implications of rejecting those reads from the analysis. excluding frequently mapped reads led to a decrease of the total number of detected clusters from  <dig> to  <dig>  withal  <dig> of which were prior rejected because they lack a significant strand bias.

regarding the assigned reads of the remaining  <dig> clusters identified with both methods, the total number of assigned reads that mapped once to the genome increased slightly from  <dig> to  <dig> which is caused by the lower hit density threshold  that led to an extension of pirna cluster borders. however the number of assigned multiple mapping reads decreased drastically from  <dig> to  <dig>  excluding frequently mapped reads may also have a substantial influence on the resulting sequence composition of clustered pirna loci since this will automatically exclude sequences that match to tes with high copy number like lines or sines. in this way sequences that contribute to a major function of the piwi-pirna system, which is posttranscriptional silencing of actively transposing elements could be accidentally underrepresented.

protrac performance in de novo pirna cluster detection
in order to evaluate the performance of protrac in de novo pirna cluster detection in comparison to previously applied methods of cluster detection, we mapped pirna like sequences obtained by 454-ngs of rhesus macaque testes rna to the macaque genome  with seqmap  and detected clusters with protrac and the methods applied by girard et al.  <cit>  and lau et al.  <cit> . a detailed description of small rna library preparation is available as additional file  <dig> . the chromosomal distribution of the detected clusters is displayed in figure  <dig>   <dig> clusters could be detected using the method applied by lau et al.  <cit> . each of these clusters was also detected using either protrac, which detected  <dig> clusters comprising  <dig> putative pirna loci  or the method applied by girard et al.  <cit>  which detected  <dig> detected clusters comprising  <dig> pirna loci , albeit cluster borders and the number of assigned sequence reads can differ between methods. if several adjacent pirna clusters detected with one method were identified as one cluster by any other method, these clusters were counted as one cluster.

four small putative pirna clusters  were detected with the method from girard et al.  <cit>  but were rejected by protrac. three of them because they lacked a significant strand bias, the forth because the respective putative pirna loci did not show a significant enrichment for 1t or 10a. seven clusters  were solely detected with protrac since each of them harbours less than ten loci that correspond to sequence reads producing 1- <dig> genomic hits. nonetheless they exhibit all typical pirna cluster characteristics. figures and fasta sequence files as well as a summary file of the detected pirna clusters in rhesus macaque are available as additional file  <dig> .

in order to assess the effect of rejecting frequently mapped reads to sequence composition of pirna clusters regarding the content of repeat matching pirnas, clustered sequences were mapped to primate te sequences downloaded from repbase  <cit>  . mapped sequence reads that match perfectly to tes are virtually absent in clusters detected with the girard et al.  <cit>  method comprising  <dig> % of all clustered sequence reads compared to  <dig> % in clusters detected with protrac. the amount of te matching sequence reads increased when we allowed up to two mismatches including insertions and deletions  but nevertheless is considerably lowered in clusters detected with the girard et al.  <cit>  method.

furthermore, the sequence composition regarding different te classes is apparently biased. while alu related sequence reads constitute the major fraction of mapped sequence reads that match perfectly to tes  in clusters detected with protrac, alu matching sequence reads are completely absent and ltr matching sequence reads make up the vast majority of te matching sequence reads in clusters detected with the girard et al.  <cit>  method. caused by the extremely high copy number of alu elements in primate genomes, being the most abundant mobile element of all  <cit> , every alu related and clustered sequence read from our dataset mapped more than five times to the macaque genome and hence was excluded from the dataset for cluster detection with the girard et al.  <cit>  method. obviously, drawing conclusions in relation to specific pirna functions from pirna sequence composition relies on an unbiased representation of all existing pirna loci in detected clusters which is one of the advantages of the protrac software. in summary, protrac detected more clusters than could be detected using the method applied by lau et al.  <cit>  and assigned more sequence reads to clusters than the method applied by girard et al.  <cit>  were rejection of frequently mapped reads led to an inadvertently underrepresentation as well as compositional bias of te matching sequence reads.

CONCLUSIONS
protrac provides a powerful tool for detection, visualization and analysis of pirna clusters. unlike hitherto applied methods for pirna cluster identification, the protrac algorithm considers all hitherto described crucial pirna cluster characteristics. thus, pirna clusters detected with protrac are well supported by comprehensible probabilistic parameters. in addition, protrac retains more information since it does not a priori preclude frequently mapped reads, which exclusively contribute to posttranscriptional transposon silencing, which was shown to lead to more assigned sequence reads per cluster in most cases and prevents accidentally underrepresentation and compositional bias of te matching sequence reads. moreover, protrac potentially allows clusters with only a few or even without single-copy loci, which leads to the detection of pirna clusters arisen from segmental duplications that are passed over when using algorithms that require a fixed minimum number of single-copy loci.

availability and requirements
project name: protrac

project home pages:

https://sourceforge.net/projects/protrac/

http://www.uni-mainz.de/fb/biologie/anthropologie/472_eng_html.php

operating system: platform independent 

programming language: perl

other requirements: perl 

license: academic free license 

any restrictions to use by non-academics: for commercial use please contact dr.

authors' contributions
dr is responsible for the development of the protrac software, performed the comparative analysis and drafted the manuscript. hz participated in drafting the manuscript and made substantial contributions to the conception of the study. all authors read and approved the final manuscript.

supplementary material
additional file 1
protrac output summary file that contains a list of all human pirna clusters detected by protrac.

click here for file

 additional file 2
protrac output summary file that contains a list of all mouse pirna clusters detected by protrac.

click here for file

 additional file 3
protrac output summary file that contains a list of all rat pirna clusters detected by protrac.

click here for file

 additional file 4
protrac results folder containing a picture and a fasta file for each detected human cluster. after decompression, the folder can be opened as former session in protrac. alternatively, each file can be opened separately with any standard text-editor or graphic-viewer respectively.

click here for file

 additional file 5
protrac results folder containing a picture and a fasta file for each detected mouse cluster. after decompression, the folder can be opened as former session in protrac. alternatively, each file can be opened separately with any standard text-editor or graphic-viewer respectively.

click here for file

 additional file 6
protrac results folder containing a picture and a fasta file for each detected rat cluster. after decompression, the folder can be opened as former session in protrac. alternatively, each file can be opened separately with any standard text-editor or graphic-viewer respectively.

click here for file

 additional file 7
this document contains information on how the macaca mulatta small rna library was prepared and sequenced.

click here for file

 additional file 8
protrac results folder containing a picture and a fasta file for each detected macaca cluster. after decompression, the folder can be opened as former session in protrac. alternatively, each file can be opened separately with any standard text-editor or graphic-viewer respectively.

click here for file

 additional file 9
this folder contains the protrac software with all required files and a sample eland <dig> input file. the perl script  contains the source code of the software that can be run on any platform. executing perl scripts requires the installation of a perl interpreter which is part of a standard perl distribution like the freely available strawberry perl . perl is preinstalled on most macintosh and linux systems. the folder also contains an executable file  which runs on windows systems without any further requirements.

click here for file

 acknowledgements
thanks go to nadir kucun and markus pauly for discussion and helpful advice related to the mathematical issues. the staff of the working group zischler is gratefully acknowledged for helpful advice. sincere thanks are given to michael eichert for proofreading the manuscript and providing conducive improvement suggestions. finally, our thanks go to the anonymous reviewers for their constructive criticism that contributed to the improvement of the manuscripts quality. this work was supported by the schwerpunkt "rechnergestuetzte forschungsmethoden in den naturwissenschaften ", johannes gutenberg-university mainz, germany.
