BACKGROUND
the microarray technology  <cit>  is now a standard technique in many genomics laboratories due to the high-throughput capacities and relatively low cost in detecting gene expression levels en masse. since the introduction, a vast number of biological studies have utilized the technology to identify regulatory patterns in various organisms  <cit> .

in the commonly used spotted microarray platform, probes are attached to a solid surface on pre-defined positions. sample rna is reverse transcribed to cdna, labeled with fluorescent dyes and allowed to hybridize to the probes. after washing away superfluous material, the remaining fluorescence signal from the probes is assumed to reflect the relative expression levels of the sample rna. typically, two rna samples, labeled with different fluorophores , are measured in parallel on the same surface to partially compensate for variability in probe dispersion and concentration. extensions from the current two-channel standard into a multi-channel platform have recently been gaining in popularity  <cit> .

during data generation, numerous factors alter the outcome through the introduction of systematic biases. different properties of the dyes , irregular or overall disparities of the slide surfaces, variation in printing as well as scanner-introduced bias influence the rna quantification process. we will generally refer to the main effects as dye, spatial and array bias in the following sections, which have been shown to be the most influential forms of systematic biases present in data from the spotted cdna microarray platform  <cit> .

as a means to identify and remove systematic biases, data normalization is typically performed. a considerable amount of published studies concern the subject of microarray normalization, see for instance  <cit>  for a comprehensive comparison of existing methods or  <cit>  for a review.

the most widespread normalization methods aim to address the dye and possibly also spatial effects within each array. we will refer to these methods as within-array normalization methods in the following text. global median normalization is a straightforward normalization method that addresses labeling issues by adjusting the median intensity value within each array. global loess normalization  <cit>  appeared early on as a means to address intensity-dependent dye bias. subsequently, the loess method was applied locally within each print-tip group to additionally assess fixed spatial effects  <cit> . the methodology of local regression normalization has recently been generalized to handle non-fixed dye and spatial effects in the olin normalization method  <cit> . all of the mentioned methods explicitly or implicitly assume that the majority of the genes on the array  are unaffected, i.e. that the log-transformed ratios m = log <dig> are centered at zero.

as typical microarray experiments involve multiple arrays to characterize multiple samples, systematic differences between the arrays  are frequently introduced. several normalization methods for independently addressing this bias have been suggested in the literature  <cit> . we will refer to these methods as between-array normalization methods. between-array normalization methods are typically applied subsequent to within-slide normalization methods. the general strategy has been to normalize the empirical distributions of intensities across arrays, such as the aquantile normalization  <cit>  that ensures that distributions of a = log <dig>  values are maintained across the slides without altering the dye ratios. another, closely related approach is the tquantile normalization methodology  <cit>  that performs quantile normalization separately per group, where a group is defined as an arbitrary collection of quantified rna samples .

different approaches to microarray normalization have emerged that do not easily fall into any of these groups. for instance, the vsn normalization method  <cit>  performs channel-wise linear and non-linear transformations to reduce the mean value and variance dependence. potentially powerful is the analysis of variance  approach  <cit>  where all effects are assessed simultaneously in one global model. wolfinger et al. explicitly used two interconnected models; one for normalization purposes and the later for identification of differential expression . the anova approach is conceptually related to the presented methodology. consequently, similarities and discrepancies will be elaborated further in a suitable context.

orthogonal signal correction   <cit>  is a technique originally developed and used for spectral data. the general concept of osc is straightforward: structured variation that is orthogonal  to a given problem is identified and can subsequently be studied and discarded. formally rephrased, systematic variation in the descriptor matrix x  is recognized by utilizing information in the response matrix y . orthogonal projections to latent structures   <cit>  was later introduced as an extension to the supervised multivariate regression method partial least squares   <cit>  featuring an integrated osc-filter. opls employs information in the y matrix to decompose the x matrix into correlated, orthogonal and residual structures of information, respectively. further details of the opls method and related methods are described in the upcoming paragraphs.

the following notation will be used throughout. vectors are denoted by bold, lower-case letters and are assumed to be column vectors unless indicated by a transposition, e.g. pt. matrices are denoted by bold upper-case letters, for instance x, with optional dimensionality information, e.g. . matrix inverses are denoted by x- <dig>  all matrices are assumed to be column-wise mean-centered unless explicitly stated.

linear regression methods
linear regression relate two data matrices x  and y  on the general form in equation  <dig> 

 y = xb + f  

the difficulty in linear regression lies in identifying b  while maintaining certain objectives, such as minimization of the residual f , high-quality predictions of future  ypred as well as high interpretability of b. one of the most frequently employed methods for estimating b is the multiple linear regression  method. as mlr is a least-squares solution, b is resolved so that the sum of squares of the residual matrix f is minimized . the x+ matrix denotes the generalized  inverse .

 b = x+y  

 x+ = -1xt  

if x is rank-deficient, - <dig> will be undefined and, consequently, the method inapplicable. this generally happens when there is strong multi-collinearity between the columns  in x. this scenario is typical for data matrices in the areas of biology and bioinformatics as biological systems are inherently full of co-variance patterns stemming from pathway regulations.

one alternative to traditional mlr is employing latent variable regression  methods. the general assumption behind lvr methods is that a system can be described in terms of a small number of latent variables that characterize the main properties of the system. multi-collinearity is, in such a system, both expected and handled appropriately. this is, for instance, employed in the pls regression method  <cit>  where x is decomposed into latent variable structures t and thereby circumvents the problems with potential rank-deficiency in x .

 x = tpt + e  

the definition and calculation of b is distinctly different  by utilizing the latent variable structures in t.

 b = w-1ct  

 c = -1tty  

in equations  <dig>   <dig> and  <dig>  t  is the score matrix, describing properties at a sample  level, pt  is the loading matrix, describing properties at a variable  level, w  is a weight matrix describing covariance between x and y, e  is the residual matrix of x. n denotes the number of observations  and k the number of variables . a is the number of latent variables and thus determines the latent variable rank of the solution, which is typically far less than the algebraic rank. a suitable value of a is determined using resampling methods such as cross-validation  <cit>  or similar. see the supplied reference for further details.

the opls method
opls is a multivariate lvr method where the objective function is to find predictive components that simultaneously maximize the covariance and correlation between x and y as in equation  <dig>  compared to the pls representation of x , opls utilizes information in the response matrix y to further decompose the x matrix into three distinct structures as described in equation  <dig>  here, tp  denotes the predictive score matrix for x, ppt  denotes the predictive loading matrix for x, to  denotes the corresponding y-orthogonal score matrix, pot  denotes the loading matrix of y-orthogonal components and e denotes the residual matrix of x.

 x = tpppt + topot + e  

important to note from equation  <dig> is that tpppt contains systematic covariance and correlation structures in relation to y, topot contains systematic y-orthogonal  variation and the residual matrix e contains the remaining un-modeled variation. the ap and ao parameters define the rank of the solution and will be discussed in more detail at a later point. more explicit information regarding the algorithm for identifying tp, ppt, to and pot, respectively, are described in  <cit> .

study summary
we will, in the upcoming sections, show how proper construction of the x and y matrices and subsequent use of opls can be utilized as an efficient normalization step for multi-channel microarray data. dual-channel microarray data will primarily be used in direct comparison with a set of common normalization methods to highlight differences. additional data sets, both dual-channel and single-channel, have been evaluated and are presented in additional data file  <dig>  the evaluation will primarily be based on differential expression for external controls where the true ratios are known a priori.

RESULTS
a brief summary of the outlined strategy is provided in the next paragraphs; for a more comprehensive description, consult the methods section.

the presented methodology identifies joint variation within biological samples to enable removal of sources of variation that are mathematically independent  to the within-sample variation. this ensures that systematic variation related to the underlying biological samples is separated from the remaining, bias-related sources of structured variation. the raw microarray data is, in the following text, contained in the x matrix whereas information regarding the different biological samples is contained in the y matrix. the systematic covariance and correlation structures associated to the biological samples are characterized by the predictive score matrix tp  and predictive loading matrix ppt  from the opls model. here, the tp matrix describes relations at a sample level whereas the ppt matrix describes corresponding characteristics at a variable  level. the bias-related variation, henceforth referred to as the y-orthogonal variation, is captured in the y-orthogonal score matrix to  and the y-orthogonal loading matrix pot . in a similar fashion, the to matrix describes relations at a sample level whereas the pot matrix describes corresponding characteristics at a variable  level. dimensionality of the solution is primarily related to the data set specific parameter ao that is estimated by means of monte carlo cross-validation   <cit> . please consult additional data file  <dig> for further information regarding the cross-validation procedure.

in the presented study, we will explicitly illustrate the effects of the suggested normalization methodology primarily on a public dual-channel data set. this data set, which we will refer to as the h8k data set, contains  <dig> two-channel cdna microarrays from a previously published study  <cit> . the experimental design is a traditional dye-swap design containing a treated sample and a reference sample measured using technical replication. further details regarding the data set are available in the supplied reference.

we have further evaluated two different data sets using the presented methodology. the first is an in-house produced dual-channel data set , whereas the second is a public single-channel affymetrix  spike-in data set, available at the affymetrix web page  <cit> . characteristics and results for these two data sets are mainly available in additional data file  <dig> 

the data has been normalized in parallel using a set of existing normalization methods of varying categories, which we believe to be in common use. properties of the evaluated normalization methods and a list of abbreviations are available in table  <dig>  note that we by no means aim to provide a comprehensive comparison of normalization methods; see  <cit>  for such a study.

x and y matrices for the h8k data set were constructed as described in the methods section and fitted with an opls model with one predictive component and  <dig> y-orthogonal components  as recommended by group-balanced mccv. consult additional data file  <dig> for details regarding the cross-validation. the total number of elements determined as differentially expressed for each method based on all microarray elements is available in figure 1a. the tn and tp rates for each method, based on the external controls, are available in figure 1b. one can see that the total number of identified differentially expressed genes is highest with the opls method while maintaining tn and tp rates at a high level. the tn rate of the opls methods is lower than some methods  but the tp rate is  <dig> %.

the information in the y-orthogonal topot matrices is readily accessible for interpretational purposes. recall that the to matrix describes relations at a sample level whereas the pot matrix describes characteristics at a variable  level. for this particular data set, to is composed of  <dig> score vectors that are orthogonal to y and individually orthogonal to each other. we will explicitly interpret a selection of y-orthogonal vectors to justify the discarded variation as well as to demonstrate the powerful interpretational alternatives available when employing opls as a normalization method.

the first y-orthogonal score vector to, <dig> is depicted in figure  <dig> in parallel with the average a values, representing the average intensity level of a slide, for each of the  <dig> slides. the pearson correlation coefficient between the two series is  <dig> , implying that the vector mainly identifies a baseline difference between the arrays . the corresponding loading vector po,1t displays no systematic trends , which suggests that there are no evident array-dye or array-spatial interaction effects. the variation captured in this vector account for  <dig> % of the total variation in x, which is by far the single highest source of structured variation in the data set.

in the second y-orthogonal score vector to, <dig>  we noted that the score value of the sample labeled with the cy <dig> dye was consistently higher than the sample labeled with the cy <dig> dye placed on the same slide . this suggests that an independent dye-effect is contained in this vector, which accounts for  <dig> % of the total variation in x. remaining score and loading vectors describe various forms of dye-spatial effects which are primarily constrained to several problematic print-tip groups. this is most noticeable in the eighth y-orthogonal loading vector po,8t, shown in figure  <dig>  the print-tip effect partly explains the success of print-tip based normalizations as compared to global normalizations.

the encouraging results from the h8k data set are supported by results from the dual-channel, in-house produced pop <dig>  data set as well as the public single-channel hgu <dig> data set . for the pop <dig>  data set, opls-normalized data exhibits leading average tp and tn rates. furthermore, the first score vector to, <dig> characterizes a distinct array bias, consistent with the behavior of the h8k data set. for the hgu <dig> data set, opls-normalized data displays leading average tp and tn rates; signifying that the method is applicable also for single-channel data.

discussion
microarray measurements frequently host various forms of systematic and data-set specific experimental errors that limit the accuracy and precision of the results. we have outlined a strategy based on recent advances in multivariate regression for identification of such bias. using the opls method  <cit> , information across biological samples is employed to discard non-correlated information. with a sound underlying experimental design, this y-orthogonal information will contain various forms of biases , which can subsequently be discarded from the data.

the general form of the methodology arguably makes it likely to be of broad utility, which we discuss in more detail in the upcoming paragraphs.

first, the methodology is intensity-based and thus not restricted to two-channel data and the explicit formation of ratios . the main rationale behind usage of ratios is related to biases originating from spot size and overall intensity baseline disparities across arrays, but this effect is clearly captured with the present methodology . the intensity-based approach has obvious auxiliary advantages, in particular when it comes to evaluation of complex designs where treated samples are not consistently hybridized against a reference sample. furthermore, the general arrangement supports normalization of single-channel data; such a setup is shown in additional data file  <dig> with promising results. moreover, the intensity-based approach enables future extensions to data containing more than two channels, which is presumably becoming an increasingly attractive choice. the extra information in the additional channel could be used to increase the number of measurements  <cit>  or for quality control  <cit> .

second, the methodology does not rely on assumptions that the majority of genes on the array, globally or in localized regions, are non-differentially expressed. thus, the approach is also applicable to custom-made arrays where the majority of genes are in fact assumed to be de . this is not true for the majority of the currently available methods, although recent extensions of the loess normalization method support such data  <cit> . there is an apparent danger in applying traditional normalization methods if this underlying assumption of abundance of non-de genes is not met. specifically, true biological effects will be eliminated by the normalization to an unknown extent in such situations, which may ultimately obscure the final interpretation of the results. furthermore, it is not always evident beforehand if the assumption is valid without prior knowledge of the studied system and the anticipated effects.

third, the methodology does not assume presence or absence of certain categories of biases  or characteristics of these biases. for instance, assume that there exists an  structured variation related to the production of the microarray slides in different batches. this variation will not be captured by the general anova model unless such an effect is anticipated; which is not true for the opls model. the only prerequisite for the present methodology to fully identify and discard bias-related variation is that it is orthogonal to the differences related to the biological samples and is systematic .

the evaluation and rationale behind the potential strengths of the method is, to a great extent, based on the use of external controls to certify the reliability of the results. we believe that the employment of external  controls is a very powerful approach as one estimates the accuracy of the arrays, not only the precision across replicates. see also  <cit>  for useful discussions regarding evaluation of microarray performance and external validation.

one common criticism concerning the usage of global models, such as anova, for normalization purposes is that the construction and evaluation requires statistical expertise . for the outlined method, the only prerequisite by the user is a specification of the sample groups. the remaining tasks, including model fitting, are fully automated using mccv and need not be any more complicated for novice users than methods for within-slide normalization based on local regression. model evaluation, as described in the results section, is a recommended but not mandatory step in the outlined strategy if high-throughput is required.

one known limitation of the methodology arises in situations where the group information is unavailable. this applies in unsupervised analyses, for instance when one is interested in detecting subclasses of a particular cancer type. as the true origin of the samples is unknown, this information cannot be utilized for normalization purposes.

in the main text, we have briefly discussed the similarities of the outlined method as compared to a two-step anova approach as described in  <cit> . from a conceptual point of view, the approaches are related as both techniques aim to assess specific effects that can subsequently be retained or discarded. in the first step  of the two-step anova approach, various forms of bias are explicitly characterized. in the second step, the biological effects are estimated on the remaining sources of variation . the presented opls approach roughly operates in the reverse order, as the biological effects are estimated at an initial stage and the systematic y-orthogonal effects  are discarded at a subsequent step. the opls normalization procedure could analogously be arranged to explicitly model unwanted effects in y  and subsequently retain topot + e posterior to modeling. differences in the results are essentially related to overlapping covariance structures. assume that there exists structured variation in a data set that is co-varying with both a biological effect as well as an unwanted effect. in the two-step anova approach, this variation will be identified and discarded in the first  step. consequently, systematic biological information can be discarded if co-varying with unwanted effects, which is a stringent normalization criterion. in the presented opls approach, only variation that is completely unrelated  to the biological sample variation will be discarded. using the same hypothetical example as for the two-step anova approach, the opls method will thus retain the biological variation in the data set after normalization. we see that in some cases  this approach can be more powerful in identifying differential expression. this is essentially a consequence of the fact that if we are not aware of all the present bias-related effects, then explicit modeling is not viable in practice.

one could easily imagine situations where one is interested in non-categorical information, for instance exact spike-in sample concentration gradients for the single-channel platform. it is certainly possible to use opls for such purposes; specifically to calibrate the measured concentrations to the known concentrations and subsequently predict the unknown  concentrations according to the same model. this is an example of multivariate calibration  <cit> , which is an established field of linear modeling. however, since this would involve a different setup, aim and partly also notation compared to the presented method, we will not discuss such a potential normalization strategy in detail.

several remaining features of the opls methodology, when utilized for normalization purposes, are left un-evaluated in this study. as the normalization is model-based, a finite model space is covered where the regression is defined to be valid. this implies that one can test for model outliers, which can for instance be exploited as a quality control step to detect flawed hybridizations. furthermore, the outlined strategy makes no explicit use of the predictive information in tpppt, reflecting biological differences at a sample  and variable  level. in relation to the two-step anova method, this would roughly correspond to the second step where biological effects are differentiated. the opls method host numerous capabilities for interpretation of this information , but remains the scope of a future paper.

CONCLUSIONS
presented is a methodology for normalization of microarray data using multivariate regression as implemented in the opls method. the strengths of the strategy are demonstrated based on both public and in-house produced data, where identification of known differential expression is shown to be augmented compared to other evaluated methods. illustrated examples are based on data from the dual-channel microarray platform but the general setup of the strategy allows simple extensions to multi-channel platforms as well.

