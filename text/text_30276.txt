BACKGROUND
discovery of new biological information and knowledge extracted from all kinds of biological entities has been hotspot in recent biomedical researches. these entities have included macromolecules , subcellular structures , cells, tissues, organs, and so on. much effort has been made in finding the connections between phenotype and genotype, between function of a biological system  and its properties . obviously, cell viability is one of the basic properties indicating the physiological state of the cell, thus, has long been one of the major considerations. recently lots of projects have been carried out on studying mechanisms of cell death  <cit> . in general, viable cells can be distinguished from dead ones according to either the physical properties, like membrane integrity, or their metabolic activities, such as cellular energy capacity, macromolecule synthesis capacity, or hydrolysis of fluorogenic substrates. conventional methods for extracting information about cell viability usually need reagents to be applied on the targeted cells, and comprehensive reviews of these methods can be found in ref  <cit> . these reagent-based techniques are reliable and versatile, however, some of them might be invasive and even toxic to the target cells.

much effort has also been made in developing noninvasive, reagent free methods for measuring cell viability, because the latter are more suitable for on-line or in situ monitoring of cells, for instance, in bioreactors. typical on-line instruments are based on, e.g., capacitance , infrared sensing , and turbidity . recently an in situ dark field microscopy probe for online monitoring of cell density and viability in bioreactors has been proposed  <cit> . with the rapid progress in machine learning and pattern recognition, more and more biological research can be carried out via image-based techniques  <cit> . wei et al. developed a method to detect cell viability based on evaluation of time series images  <cit> , in which multiple micrographs captured at different time points are needed to extract information for cell classification. here, a machine vision system  is proposed for automated noninvasive assessment of cell viability. this mvs employs dark field microscopy plus modern image processing. it need not use time series images, but distinguishes live and dead cells by analyzing only micrographs captured at a single time point. in contrast to the system developed by long et al.  <cit> , which employs iterative training procedures to choose the most representative samples for the decision boundary, our system is focused on selection of the features of cell images that support the best classification of cell viability.

RESULTS
the implemented microscope uses a dark field condenser with an numerical aperture  of  <dig>  and a 40× objective that has an na of  <dig> . the light source is a halogen reflector lamp. a ccd camera  is installed to capture the micrographs. this camera is working in visible light range.  <dig> probes are sampled from the all-live culture and imaged with the ccd camera, and the resulting micrographs are analyzed by the mvs. in the cell detection procedure of the mvs, a reading window of  <dig> ×  <dig> pixels is used to scan the images, and  <dig> live cells are recognized in these images. analogously,  <dig> dead cells are detected in the images of  <dig> samples of the all-dead culture. from these,  <dig> live cells and  <dig> dead cells are used to generate the training set; while the remaining  <dig> live cells and  <dig> dead cells are used to generate the test set. feature selection is performed and the svm  classifier with a linear kernel is trained with these datasets. the best subsets of wavelet features are selected with the sbfs algorithm, in which a criterion function is defined in the form of eq. . the selection results are shown in figure  <dig>  the optimum is found when the number of features is  <dig>  with a criterion value of - <dig> . it is evident that the decline of the criterion within 10% is tolerable , as a result, the best choice of the feature number should be  <dig>  which leads to a criterion of - <dig> , within the tolerable region. in this 12-featured subset, features  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig> are included. when too many features are discarded the criterion declines significantly, especially when the feature number is less than  <dig> 

in order to evaluate the performance of the mvs with cultures of given viability, mixed cultures are prepared. mixed cultures are obtained by mixing all-live and all-dead cultures at a series of ratios . for each mixture, the reference viability is determined by taking the average of five manual counts based on the fun  <dig> stain. the numbers of live and dead cells in these counts and standard deviations are shown in table  <dig>  as the cell density of the all-live cultures is slightly different from that of the all-dead cultures, the outcome viability is slightly deviated from the nominal value of the mixing ratio. for instance, the nominal viability of the 2: <dig>  mixture is  <dig> , while the actual value is nevertheless about  <dig> . the viability determined by the fun  <dig> stain is regarded as the gold standard and compared with that by the mvs. for each mixture, five samples are investigated by the mvs and the viability values are averaged.

the correlation of the results given by the mvs and those by the gold standard is displayed in figure  <dig>  the total number of the cells in the test sets of all mixed cultures for the mvs is  <dig>  the system performance is evaluated in three different cases. in figure  <dig>  the training set and test set of the classifier are composed of only raw image patches . in figure  <dig> the complete set of  <dig> wavelet features is used. in figure  <dig> a selected subset of  <dig> features is used. the effect of feature extraction can be recognized in these figures. comparing figure  <dig> with  <dig>  it can be seen that the use of wavelet features leads not only to stronger correlation with the gold standard, but also to lower variances. by comparing figure  <dig> and  <dig>  it is clear that discarding  <dig> features  does not impair the system's performance. on the contrary, the selected feature set helps not only to increase the accuracy of the measurement, but also to reduce the variance in spite of a slightly increased variance at the viability of  <dig> .

* mr: mixture ratio; ** ml: mean percentage of live cells; *** sd: standard deviation

in the course of feature selection, after each backward step a number of forward steps are performed as long as the resulting subsets are better than those previously evaluated at that level. with this so-called floating search mechanism, it will often achieve results close to the optimum, thus, it is valuated as one of the currently best sub-optimal methods for feature selection  <cit> . in this sense, the features most frequently selected at all levels  can be considered as carrying the most important information. in our case, features  <dig>   <dig>   <dig>   <dig>   <dig>  and  <dig> are the most frequently selected ones. referring to the definitions in subsection "wavelet packet feature analysis", these features are associated to subimages , ,  and  of the wavelet packet decomposition. the physical significances of them are given in table  <dig> according to the principle of wavelet packet decomposition. these subimages contain the most important discriminative information. it is evident that higher order details in horizontal and diagonal direction , ) and vertical details at a low level ) are critical for classifying live and dead cells.

this opinion can be supported by a reconstruction of cell images in following steps. firstly, any of the original cell images is decomposed using fwt. secondly, a value of zero is assigned to each pixel in subimages , , and . thirdly, an inverse fwt  is used to obtain a reconstructed image, which has lost all the most important discriminative information. the comparison between original and reconstructed images is shown in figure  <dig>  it can be seen that the reconstructed live cells  exhibit more "grid effect" than the reconstructed dead cells , which leads to a greater difference between the reconstructed and original live cells  than that between reconstructed and original dead cells . that may serve as evidence for supporting the assumption that live cells contain more detail information than dead ones. based on figure  <dig>  it is also clear that with the loss of the information in subimages ,  and , which benefits viability classification, live cells are hardly to be distinguished from dead ones.

following a similar idea, a value of zero is assigned to each pixel in all the subimages except , , , and . this attempt discards all information that is of less significance for distinguishing cell viability. the comparison between the original and reconstructed images is shown in figure  <dig>  it is clear that the differences between the original and the reconstructed cell images is not so significant as those shown in figure  <dig>  it is also implied that containing only information in the subimages , , , and , live cells can still be distinguished from dead ones.

for an extended feature analysis, the distribution of the features for live and dead cells from the training set is displayed in a parallel coordinate plot in figure  <dig>  each thin, red, solid line represents a live cell, and each thin, black, dashed line represents a dead cell. the mean feature value over all live cells is displayed with a thick, white, solid line, while that over all dead cells is displayed with a thick, white, dashed line. referring to the definition of features, it is clear that with any energy feature , live cells have a higher mean value. that means, on average live cells look brighter than dead cells , and contain more details . it is also clear that with any entropy feature , live cells have a lower mean value . it implies that live cells contain more inhomogeneous fine structures than dead cells.

in the aforementioned attempts dead cells in both the training sets and test sets have been thermally treated. however, it is yet unclear whether the mvs based measurement is still applicable on cell populations, in which cell death is induced by a different mechanism. in order to validate our methodology, we have tested the mvs on another image set containing cells that have died naturally.

in this scenario the implemented microscope uses the same light source and ccd camera as before, however, it uses a dark field condenser with a numerical aperture  of  <dig>  and an 10× objective that has an na of  <dig> . five probes are sampled from the all-live culture and imaged, and  <dig> cell positions are found by the mvs, in which  <dig> recognized cells are used to generate the positive training set. analogously, five probes are sampled from the all-dead culture, which is thermally treated, and imaged.  <dig> out of  <dig> recognized cells are selected to generate the negative training set. besides, the remaining  <dig> cells from the all-live culture and  <dig> cells from the all-dead culture are added to the test sets for feature selection.

in addition, a naturally grown cell culture k <dig> with a known viability of  <dig>   is also sampled and imaged. in k <dig> five probes are taken and in total  <dig> cells are recognized  as additional test sets for feature selection. the best subsets of wavelet features are selected also with the sbfs algorithm with a criterion function defined in the form of eq. . the optimum is found by sbfs when the number of features is  <dig>  in this best subset, feature  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig> and  <dig> are included. this subset is different from that one determined in the previous scenario, probably because of the different microscopy settings .

in order to evaluate the performance of the mvs, not only all-live and all-dead cultures, but also k <dig> and k <dig> have been used. the numbers of live and dead cells in these counts and standard deviations of k <dig> and k <dig> are shown in table  <dig> 

*sd: standard deviation

the correlation of the results given by the mvs and by the gold standard is displayed in table  <dig>  it can be seen that not only is mvs reliable for measuring cell viability in all-live  and all-dead cultures , but also in k <dig> and k <dig>  which contains cells that are naturally dead.

* sd: standard deviation

from the results it can be seen that the mvs is reliable in measuring cell viability. although it learns from examples of dead cells that were thermally killed , it is able to predict accurately the viability of the cells that have not been thermally treated. despite of the fact that the selected feature subsets in these two scenarios are different – in this sense, no universal feature subset has been found that is applicable in both cases, it is still evidence that it needs only to train the system with new datasets to have it adapted to a new scenario; however, not a single part of the system framework itself requires any change.

CONCLUSIONS
it has been shown that a machine vision system based on dark field microscopy in conjugation with wavelet feature selection has very good performance in cell viability assessment.

wavelet features are found to be suitable to describe the discriminative properties of the live and dead cells in viability classification. according to the analysis, live cells exhibit morphologically more details and are intracellularly more organized than dead ones, which display more homogeneous and diffuse gray values throughout the cells.

feature selection increases the system's performance. the reason lies probably in the fact that feature selection plays a role of excluding redundant or misleading information that may be contained in the raw data, and leads to better results.

feature selection also reduces the dimensionality of the datasets. that enables the implementation of svm classifiers with a linear kernel, which are supposed to be unsuitable for high-dimensionality cases. one of the advantages of using linear kernel is that the choice of the proper parameters of a kernel, like the width of the envelop of a gaussian kernel, can be avoided.

