BACKGROUND
transcriptome analysis of a tissue or cell type has been widely used since the development of methodological approaches for the large-scale study of gene expression such as sage  <cit> , mpss  <cit> , microarray  <cit> . the next-generation sequencing technology has been adapted to transcriptome analysis and the ability to accurately measure mrna signals must provide unprecedented impact on gene expression analysis  <cit> . thus, it is accepted that high-throughput data represents the starting point to predict further our understanding of molecular disorders associated with the physiopathology of a given phenotype.

the most classical application to the analysis of gene expression focuses on the identification of genes differentially expressed between two biological conditions. at this stage, a large number of statistical tests is used for a precise identification of candidate genes  <cit> . the network of biological processes involved in the evolution of a tumor or in tissue differentiation is extremely complex and requires the development of mathematical models for a simultaneous analysis of a set of genes in two or more biological conditions. analyses of this nature are currently performed using standard methods designed for paired analyses. thus, it is highly necessary to develop methods for analysis of multiple expression of a gene. we shall define the approach in the current study as multiple differential expression .

an example of the application of mde approach may be illustrated by the following question: what genes have shown an increasing level of expression in three libraries  representing the stages  of a tumor? to answer this question, the usual procedure analyses couples of libraries separately and makes conjunctions or disjunctions of the relations found, e.g. a > b and b > c. in fact, this analysis is traditionally used to select any g gene with an expression profiles such as ag >bg >cg. in this type of paired analysis, the main problem is the sensitivity and specificity of statistical tests used to detect what genes are differentially expressed  <cit> . these statistical measures are closely related to the concepts of type i and type ii errors and they are potentiated when more than two biological conditions are analyzed simultaneously. to address this shortfall, we introduced a bayesian model to compute the generalization of the pairwise comparisons in order to perform mde analysis. it is a new probabilistic method for targeted gene selection on two or more classes through an intuitive approach involving a question formulation process, and a probability linked to it. in summary, all genes in accordance with the previously formulated question will be ordered on the basis of the probability that the question is true.

we presented a web-based system named probabilistic functional analysis system tool  that permits suitable mde analysis on a global scale. this tool differs from others  <cit>  by permitting the investigator to analyze the global gene expression in different biological conditions using private and/or public data, integrating it into a set of functional pieces of information including gene ontology  <cit> , kegg  <cit>  and biocarta  <cit> . within this context, the tool becomes useful for the disclosure of genes related to biological processes that are active during the cell differentiation and growth, as well as during organogenesis. probfast is designed primarily for sequencing-based data, including data from next-generation sequencing technology.

implementation
design functionality
probfast is a tool which uses the client-server architecture . the back-end consists of a set of mysql  <cit>  relational tables that store functional information extracted from the kegg, biocarta and gene ontology repositories. furthermore, all the expression data of gene expression omnibus   <cit>  generated by the counting technique are stored, including  <dig>  sage and mpss libraries of approximately  <dig> species. all databases are monthly updated, ensuring the access to the most recent information. the server side is composed of three main interfaces that enable remote use with convenient data uploading and result visualization features.

the analysis starts with a friendly interface for the inclusion of the project name and parameters to the preprocessing and upload of libraries . in the upload process, two options are available: 1) import data from geo: a search interface allows displaying a list of expression profile experiments related to organism and keywords filter, and 2) the upload option to analyze a new experiment that is not included in the geo database. to do that, the user needs to submit a file with a predefined format . the file may be uploaded compressed in gz, zip, or rar format. the gene identifiers supported by probfast include ncbi id, gene symbol, tag sequence or unigene accession.

after the submission, users must formulate question by a comprehensive frame box and define the parameters for enrichment analysis . the parameters are preconfigured and can be adjusted according to their stringency criterion. finally, after processing the user will be informed about the result by e-mail. the results are provided in three analysis aspects:

• gene search: the user can select one of the questions formulated and adjust the probability  of interest. all genes will be listed according to the cutoff related to the question .

• enrichment analysis: this option permits the user to select the question formulated and the functional category of interest. the result will reveal the enriched functional categories ordered according to the level of significance  .

• functional screening: the functional categories with the largest number of genes with probability above the predefined cutoff will be listed here .

in the options enrichment analysis and functional screen, the functional categories can be ordered according to the total expression level, total number of genes and enrichment score .

by clicking on the +info key, a window will appear with the sum of the expression levels of the genes related to the formulated question. several links will permit the user to access external information about the genes and the functional categories.

the web interface is implemented in the perl language and the common gateway interface  protocol was used to permit the access to the services of data submission and result visualization. the web interface is based on the new technology web  <dig>  ajax.

statistical analysis
the data obtained by counting techniques such as sage, mpss, rnaseq and the next-generation sequencing technologies generate a simple enumeration measurement that can be modeled in a probabilistic manner. the expression of a given gene g  in the ith experiment is estimated by the abundance of messenger rna levels  π and is commonly modeled by a bernoulli process  <cit> . this means that the probability of observing a tag for that gene is proportional to π and we see the sequencing processes as if it was a urn. inside this imaginary urn, the different colored balls would represent different tags and the number of each ball in the urn is proportional to the mrna abundance. if we knew π, it would be easier to determine the probability l of observing n tags after sequencing a total of t tags:   

where n are the counts for a specific tag that is the proxi for the considered gene, t is the total number of sequenced tags and c is a constant for which the actual value is not relevant.

the following urn-like model is well-known in bayesian statistics and the inference about the abundance π is performed, with the aid of an uniform prior, using baye's rule:   

which can be re-written as:   

where a = n +  <dig>  b = t - n +  <dig> and b = .

or in usual statistical notation:   

here we extended this basic model by considering a mixture of beta densities as a way to encode the information from several sequenced libraries  from the same group :   

where   

b is the beta special function, ai = ni +  <dig>  bi = ti - ni +  <dig>  the sub-index i denotes the ith library and m is the number of libraries that compose a single group, i.e. the components of the mixture. note that there is no sub-index to denote a gene  in these equations because it is implicit that a given gene is our focus.

it is somewhat easy to derive an estimate for a given probabilistic question provided that one knows how to generate random deviates from all atomic parts of the question. if the group at hand is composed of just one library m =  <dig>  then the model reduces itself to the usual beta random variable which can be easily simulated. on the other hand, for a real mixture  m >  <dig>  the simulation can be more computationally expensive, but also easy. our mathematical code implemented in r language automatically switches between these two modes and simulates random variables properly.

once a sufficient amount of random variables for all atomic elements in the probabilistic question are in place, the probability estimation is trivial: , where st is simulations number for which the question returns true and sn is the total number of simulations.

to assess the efficiency of our method, comparing it to approaches reported in the literature  <cit> , we performed a simulation study . the sensitivity and specificity of all methods were evaluated and compared by receiver operating characteristic  curves  <cit> .

to perform mde analysis with data generated by counting techniques, we developed the probmde algorithm to compute the generalization of the paired analyses according to the probabilistic model above. the r code, with the complete and self-contained implementation of our model, can be downloaded in  <cit> .

next, using these probabilistic results, we incorporated enrichment analysis for the functional categories gene ontology, kegg, and biocarta using the methods and source-code available by the tool probcd  <cit> . this is an efficient approach for considering the rate of error included in all annotation process  <cit> . the user can also upload other probabilistic annotation values for the functional categories available in probfast. the statistical significance for the enrichment is obtained as in probcd tool  <cit> : a null distribution for the statistical association measure is created using a randomization approach. the measured association is then compared with the null to derive p-values. a term is significantly over-represented  depending on the user-defined thresholds for significance and/or association.

RESULTS
to evaluate the efficacy of probfast in order to provide meaningful insights biologically, we first compared the results obtained by probfast with data previously reported in the literature  <cit> . we also found new targets when reanalyzing public dataset. we showed three of several applications of probfast. all the results presented can be accessed by pid  <dig>   <dig> and  <dig> respectively at the visualize analysis section at the website of the project  <cit> .

1) up and down-regulation
lee et al  <cit>  measured the effect of radiofrequency  on gene expression at the genome level. they observed that using rf of  <dig>  ghz,  <dig> genes presented abnormal gene expression after 2h of exposure and  <dig> genes showed abnormal expression after 6h of exposure. using gene expression as the indicator to determine if there were any biological effect of rf, three samples were used for the analysis: a control with 2h sham exposure , a sample of hl- <dig> cells exposed for 2h  and a sample exposed for 6h .

we used the same data set and raised two questions to offer a genome-wide scenario of genes that were up-regulated on  and down-regulated on . we launched into probfast all the tags reported by those authors and we divided the results into up and down-regulated ones. afterwards, we selected the first  <dig> genes with a cutoff > =  <dig> criterion from each group obtained by our analysis and compared them to the genes reported by the authors. we were able to obtain the same genes reported by lee et al  <cit>  and, fortunately, we were able to observe new genes that have not been described by those authors. such genes changed their expression due to rf exposure. among the new genes we would like to describe ptma and eif <dig> genes that were down and up-regulated respectively.

prothymosin-alpha or ptma  was identified in the thymus gland while producing several hormones or hormone-like substances known as prothymosin-alpha. regarding its role, jiang et al  <cit>  identified a pathway that regulates mitochondria-initiated caspase activity. in this pathway, ptma negatively regulates caspase- <dig> activation by inhibiting apoptosome formation. elimination of ptma expression by rna interference sensitized cells to ultraviolet irradiation-induced apoptosis. another example of the relation between the ptma gene and the radiosensitivity is the finding of ojima et al  <cit> , who used microarray to determine if the expression levels of specific genes could predict clinical radiosensitivity in human colorectal cancer. they found that ptma was up-regulated in the resistant cell lines and suggested that ptma may be a novel marker for predicting the effectiveness of radiotherapy in clinical cases of colorectal cancer.

the other gene revealed by probfast was eukaryotic translation initiation factor  <dig> a or eif5a . eif5a is an essential protein tightly linked to cellular homeostasis, and its protein may be also involved in nucleocytoplasmic mrna transport. recent studies have indicated that eif5a may play a role in cell death, as its over-expression was found to induce apoptosis in lung cancer  <cit> . all these reports corroborate the role of these genes in regulating the apoptosis process. in addition, both are modulated by radiation or rf exposure. these findings are good examples of which genes should be found by a functional analysis tool and we would like to emphasize that probfast was able to detect these genes.

2) next-generation sequencing
currently, the next-generation sequencing is more frequently found in laboratories and these laboratories must be able to deal with a great amount of data from this new high-throughput platform. we carried out an analysis to detect which genes were up-regulated  in human solexa longsage from cancer genome anatomy project sage library collection. three samples were used: a control n - skin normal/gsm <dig>  s <dig> - stage  <dig> melanoma skin/gsm <dig> and s <dig> - stage  <dig> melanoma skin/gsm <dig> 

we have detected some genes from mage family such as maged <dig>  maged <dig>  magef <dig>  mageh1; these genes show that probfast is able to detect genes accurately once they are melanoma associated antigens and they are expected to be found in the question n <s <dig> <s <dig>  another expected gene was mcam which is a melanoma cell adhesion molecule and it was also detected by probfast. interesting was the detection of rgs <dig> and spp <dig> genes. both genes were detected as over-expressed genes in melanoma and data from literature has already reported that both genes are considered great markers for melanoma while investigating malignant melanoma and benign nevi  <cit> .

3) analysis of one or more groups of biological replicates
probfast tool is also able to analyze groups of libraries. in order to prove this skill, we selected four sage libraries and the analysis was performed while clustering the tumoral colon libraries  in one group and two normal libraries  within the other group. the question loaded to probfast was . the analysis was performed with 80% probability cutoff.

we found a group of transcriptions factors and the most expressed were tgfbi, srcap, gtf2a1l and sox <dig>  tgfbi proteins can modulate cell adhesion due to its inhibition  <cit> . gtf2a1l protein has a role in the assembly and stability of the rna polymerase ii transcription pre-initiation complex on a eukaryotic core promoter  <cit> . sox proteins are implicated in cell fate decisions in a wide range of developmental processes. sox transcription factors have diverse tissue-specific expression patterns during early development and it was proposed that they acted target-specific transcription factors and/or as chromatin structure regulatory elements. sox <dig> expression in various tissues also suggests a role in both differentiation and maintenance of several cell types  <cit> .

we also detected a group of genes highly expressed in the tumoral libraries which has a direct role in tumorigenesis. these genes are brms <dig>  greb <dig> and prr <dig>  brms <dig> reduces the metastatic potential, but not the tumorogenicity of human breast cancer and melanoma cell lines  <cit> . greb <dig> is an estrogen-responsive gene that is an early response gene in the estrogen receptor-regulated pathway. this gene may play an important role in hormone-responsive tissues and cancer  <cit> . prr <dig> gene encodes a protein with a proline rich domain. this gene is located in a region of chromosome  <dig> reported as containing a tumor suppressor gene that may be involved in breast and colorectal tumorigenesis  <cit> .

our tool also detected some other genes more expressed in the tumoral libraries and have important roles in cell progression, proliferation and differentiation. these genes are trim <dig>  bp <dig>  cad and s100a <dig>  trim <dig> gene encodes a protein that mediates transcriptional control by interaction with a repression domain found in many transcription factors. there are new findings suggesting that this transcriptional repressor plays a role in cell proliferation  <cit> . bp <dig> gene is also a member of a family of translation repressor proteins. this gene has been already reported as having a role in the progression of breast neoplasms through cell signaling  <cit> . on the other hand, cad gene encodes a protein which is required by mammalian cells to proliferate  <cit> . s100a <dig> proteins are located in the cytoplasm and/or nucleus of a wide range of cells, and are involved in the regulation of a number of cellular processes such as cell cycle progression and differentiation. s100a <dig> is also associated with human colorectal adenocarcinoma tumorigenesis and invasion/metastasis  <cit> .

CONCLUSIONS
probfast is a web application that facilitates the analysis of enumeration gene expression data generated by high-throughput technologies. it supports a flexible bayesian method that assigns a probability for each gene analyzed according to a previously defined question, and aims to bring a top-down approach to carry out mde analysis according to the investigator's background.

future directions
probfast currently supports statistical analysis for enumeration data and our goal is to extend this capability for microarray data.

availability and requirements
• project name: probfast - probabilistic functional analysis system tool

• project home page: http://gdm.fmrp.usp.br/probfast

• operating systems: unix-like platforms

• programming languages: perl and r

• other requirements: mysql

• license: gnu general public license

authors' contributions
its designed and implemented the project. rznv proposed the beta-mixture extension and wrote r code. tyko and its set up the web-page interface. gam and its performed and analyzed the data shown in the result section from real data. was contributed with ideas and requirements. all authors read and approved the final manuscript.

supplementary material
additional file 1
probfast architecture and simulation study. the file shows the client-server architecture of the tool probfast and roc curves analysis from simulation study.

click here for file

 acknowledgements
the authors would like to thank all members of the laboratory of molecular genetics and bioinformatics for their contributions during the development phase and further, we thank dr. junior barrera for the exciting discussions over the years. this work was supported by inctc/cnpq, center for research on cell-based therapy/cepid/fapesp and fundaç ão hemocentro de ribeirão preto.
