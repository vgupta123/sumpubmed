BACKGROUND
rapeseed  is an important oilseed crop throughout the world, serving as source for edible oil and renewable energy. it is an amphidiploid  species which originated from a few interspecific hybridizations between b. rapa and b. oleracea  <cit> . this in turn led to a low genetic diversity in b. napus. the occurrence of two bottlenecks during rapeseed breeding, i.e. the selection for low erucic acid and low glucosinolate content further reduced the genetic diversity in modern elite varieties  <cit> . low genetic diversity leads to genetic vulnerability  <cit>  and reduces response to selection . therefore, it is desirable to introduce diverse germplasm into elite genetic material in rapeseed breeding programs and subsequently screen the material for performance traits.

the majority of phenotypic variation in natural populations and agricultural plants is due to quantitative traits  <cit> . an important step in genetics and breeding is to identify the genes contributing to the variation of such traits  <cit> . linkage analysis and association mapping are two commonly used approaches to dissect the genetic basis of these quantitative traits  <cit> . in rapeseed, linkage mapping is a well-established approach and has been successfully applied for quantitative trait locus  mapping in bi-parental crosses . recently, association studies have become a promising approach in plant genetics to connect genetic polymorphisms with trait variations in diverse germplasm sets . in rapeseed, several association studies have been carried out on the candidate-gene  <cit>  or on a genome-wide scale . nested association mapping  has been suggested as a strategy to combine the high power of qtl detection from linkage analyses with the high mapping resolution of association mapping approaches  <cit> . in order to successfully use nam, multi-parental mapping populations and statistical models are required.

various mating designs were proposed for multi-parental mapping populations . among them, the nam mating design has been successfully applied in maize  <cit> . to the best of our knowledge, no earlier study examined the possibility as well as the suitability of different mating designs for creating nam populations in rapeseed. moreover, as the current nam mating design based on recombinant inbred lines  required several generations to develop rils, new mating designs, which can shorten the time for generating nam populations  lines) or can increase the genetic background of common parent in the nam progenies to fit for different types of germplasm resources, have not been examined yet.

various statistical procedures have been applied for nam. these qtl mapping methods included single marker models  <cit> , interval mapping  <cit> , composite interval mapping   <cit> , and recently proposed inclusive composite interval mapping   <cit> . such statistical models, however, should be examined for their usefulness in a specific species, especially under the situation of currently available high density linkage maps and large mapping data sets. furthermore, in the context of nam, the influence of qtl × genetic background interaction and varied sample sizes of subpopulations on the power of qtl detection has not yet been examined.

the objectives of this research were to compare the power of qtl detection 1- β∗  of two mating designs, double haploid  and backcross , for the creation of nam populations in rapeseed,  of different statistical models, and  for different genetic situations including various extents of qtl × genetic background interactions.

methods
parental genotypes
the computer simulations of this study were based on empirical data of  <dig> rapeseed genotypes of the pre-breeding collection, which was constructed by norddeutsche pflanzenzucht hans-georg lembke kg and german seed alliance, germany from a world-wide diverse germplasm to catch maximum diversity. these genotypes can be divided into two panels. panel  <dig> included the inbred entries pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  and pby <dig>  panel  <dig> included pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig>  pby <dig> as well as the common parental line pby <dig>  the genotypes in panel  <dig> were genetically diverse but winter rapeseed inbreds adapted to german climate conditions, while the genotypes in panel  <dig> were exotic inbreds including winter, spring, and swede rapeseed. the common parental line pby <dig> was an elite winter rapeseed parent and wildly used as parent for commercial hybrid varieties.

computer simulations of parental genotypes
the single nucleotide polymorphisms  were extracted from the sequences of the  <dig> conserved genes  in all  <dig> genotypes. these genes were selected to get a population structure information of rapeseed germplasm resources that was influenced not too strongly by any recent selection effects. based on the  <dig> conserved genes, the snps for the founders are homozygous. snps with a minor allele frequency of less than  <dig> % as well as the snps with  <dig> % of missing data were excluded from the study. altogether  <dig> original snps were used for further analysis . genetic map distance information for these snps was lacking. therefore, their genetic distance was calculated from the physical distance by a linear transformation with a rate of  <dig>  mb/cm according to  <cit> . the squared correlation of allele frequencies  between snp loci pairs was calculated to measure the level of linkage disequilibrium   <cit> . this measure was chosen as it can be interpreted as the proportion of variance which the allele frequency of the first marker explains of the allele frequency of the second marker  <cit> . a nonlinear regression of r <dig> versus the genetic map distance  or physical distance  was performed according to  <cit> . furthermore, the modified rogers distance  was calculated  <cit> . the distance was chosen because it is one of the most appropriate distance for codominant markers, such as ssr and snp markers, and it has the euclidean property which is important for principal coordinate analysis . pcoa  <cit>  based on mrd estimates between all pairs of inbred lines was performed for population structure.

because of the limited number of snps available at the time when the study was performed, a total of  <dig>  snps were simulated from the original snps. the simulated snps were evenly distributed across the genome. the number of snps on each chromosome was proportional to the length of the chromosome  <cit> . in order to create a set of snps that has similiar properties as the original set with respect to population structure and ld decay, the following strategy was applied. for each of the  <dig>  snps, one snp was randomly selected from the original snp set and assigned to the simulated snp locus. to break the strong ld between the original snps, random mating among the  <dig> parental inbreds was simulated to generate a random mating population with a total of  <dig> individuals. then  <dig> further generations of random mating were simulated among the random mating popolation with a constant population size of  <dig> individuals. from each of these  <dig> individuals, one dh line was simulated. a random sample of  <dig> individuals from the dh lines was drawn, and these simulated individuals were arbitrary assigned to each parent and considered in the following as the simulated parental inbreds. the analysis of the ld decay against genetic map distance and population structure within the simulated parental inbreds was performed with the aforementioned methods.

mating designs
the  <dig> simulated parental inbreds were used to examine two different mating designs using computer simulations. for the dh-nam mating design, the  <dig> parental inbreds from panel  <dig> were crossed with the common parent pby <dig>  resulting in a total of  <dig> different f <dig> hybrids. a total of  <dig> dh individuals were generated from each f <dig>  the final dh-nam population consisted of a total of  <dig> individuals. the mating design and the sample size were chosen because a population of such a size was under development in the framework of the pre-breedyied project supported by german federal ministry of education and research.

for the bc-nam mating design, the  <dig> parental inbreds from panel  <dig> were crossed with the common parent pby <dig>  resulting in a total of  <dig> different f <dig> hybrids. each hybrid was backcrossed once with the common parent pby <dig> and generated  <dig> bc <dig> hybrids. the bc <dig> hybrids were selfed for two generations using the single seed descent  method to create a set of bc1s <dig> individuals. the final bc-nam population consisted of a total of  <dig> individuals. the bc1s <dig> generation was chosen to balance the percentage of homozygous lines in the population and the time for developing the population as well as because a population of such a size is under development in the frame of the pre-breedyied project.

to compare the power of qtl detection 1- β∗ of different mating designs with the same total population size, all  <dig> parental inbreds from both panels were applied to generate  <dig> dh-nam subpopulations and  <dig> bc-nam subpopulations using the two mating designs, respectively. in a scenario in which we compared the power of qtl detection 1- β∗ of the two mating designs and the nam mating design based on recombinant inbred lines   <cit> ,  <dig> ril-nam subpopulations were also simulated using all  <dig> parental inbreds, whereas the f <dig> hybrids were further selfed for  <dig> generations and created by ssd method. in a scenario in which we examined the influence of varied number of parental inbreds and mapping population sizes on the power of qtl detection 1- β∗, a subset of the size of  <dig> and  <dig> subpopulations with  <dig> individuals per subpopulation was randomly selected from all the subpopulations. a subset of the size of  <dig> subpopulations but only  <dig> individuals per subpopulation was also randomly selected. the power of qtl detection 1- β∗ of these mapping populations as well as all the  <dig> subpopulations was examined. in a scenario in which we examined the influence of unbalanced sample sizes of subpopulations on the power of qtl detection 1- β∗, a set of unbalanced sample sizes from a normal distribution with certain standard deviations  was applied to subpopulations while keeping the total number of individuals in the mapping population to  <dig> 

calculation of genotypic and phenotypic values
a total of  <dig> simulation runs were performed for each of the examined mating designs. for each run, three subsets of snps of the size l  were randomly sampled without replacement from the genome and defined as qtl. the maximum genotypic effect per qtl q was drawn randomly without replacement from the geometric series  <dig>  with a =  <dig>  for  <dig> qtls, a =  <dig>  for  <dig> qtls, or a =  <dig>  for  <dig> qtls  <cit> . to simplify, we treated rapeseed as a double diploid because its genome a and c have big difference, which is reasonable as current sequencing technology can effectively identify the snps from genome a or c. therefore, for each snp locus, only two alleles were assumed. the qtl effects for the two alleles were randomly given either by the maximum genotypic effect per qtl q or zero. the genotypic value of an individual was the sum of all of its qtl effects. phenotypic values were generated by adding a realization from a normal distribution n σg2/h2) to the genotypic values, where h <dig> denotes the heritability, and σg <dig> is the genetic variance of all parental inbreds  <cit> . for our simulations h2=  <dig>  and h2=  <dig>  were assumed.

when examining the qtl × genetic background interactions, a total of  <dig>   <dig>   <dig>  and  <dig> qtls were randomly selected from the scenario of  <dig> qtls. each of these qtls was assumed to have interaction effects with all the other non-qtl markers . the proportion of total variance explained by the qtl × genetic background interaction was scaled to  <dig>   <dig>   <dig>   <dig>   <dig>  and  <dig> % of the total genotypic variance.

qtl mapping
joint mapping, i.e. mapping using all populations at once, was used to identify qtls. four statistical models were used for qtl mapping. the first model was 
 y=b0+afuf+xqbq+e,  denoted as single marker model  <dig>  where y was the vector of phenotypic values, b <dig> was the intercept, uf was the effect of the cross of the founder f with the common parent, af was the incidence matrix relating each uf to y, xq was a matrix of genotype of each individual in the subpopulation of the founder f at marker q, bq was the expected substitution effect of marker q in the subpopulation of the founder f, and e was the vector of residual variance. the second model was 
 y=b0+afuf+xqbq+e,  denoted as single marker model  <dig>  where y, b <dig>  uf, af, and e were as described in single marker model  <dig>  xq was a vector of genotype of each individual at marker q, bq was the expected substitution effect of marker q. the third model was 
 y=b0+afuf+xqbq+∑c≠qxcbc+e,  denoted as joint composite interval mapping  model  <dig>  where y, b <dig>  uf, af, xq, bq, and e were as described in single marker model  <dig>  xc was a matrix of genotype of each individual in the subpopulation of the founder f at cofactor c , bc was the expected substitution effect of cofactor c  in the subpopulation of the founder f. the fourth model was 
 y=b0+afuf+xqbq+∑c≠qxcbc+e,  denoted as jcim model  <dig>  where y, b <dig>  uf, af, xq, bq, and e were as described in single marker model  <dig>  xc was a vector of genotype of each individual at cofactor c , bc was the expected substitution effect of cofactor c .

cofactor selection was performed using the lasso function in the r package “lars”  <cit> . for doing so, a coefficient of variation for 10-fold cross-validation using the command cv.lars with default settings was computed and used for the lasso function to select those independent variables  which have impact on the dependent variable . in order to effectively screen cofactors in a large snp set across the whole genome at lower computational cost, two methods were used for cofactor selection. we first cut each chromosome into  <dig>  cm segments. this number was selected to balance the genomic interval density and the marker numbers for later calculation. then, for the method  <dig>  one marker was randomly selected from each segment for lasso selection. those markers having non-zero coefficients were kept as cofactors . based on the result of method  <dig>  method  <dig> was applied to examine all the markers on the target segments which contained cofactors by method  <dig>  all the markers on these target segments were selected and used for lasso selection. those markers having non-zero coefficients were kept as cofactors . in brief, the method  <dig> detected whether there was one cofactor from each examined segment, while the method  <dig> detected whether there were more than one cofactor from those segments which contained cofactors by the method  <dig> 

for qtl mapping, one by one of the  <dig>  snps was used to fit the statistical models. for jcim model  <dig> and  <dig>  cofactor selection was performed prior to qtl mapping. during qtl mapping, when examined a certain snp, the cofactors linked to the snp within 5cm were excluded. the probability and effect for each examined snp was obtained by analysis of variance  of the full model  against the residuals model .

power estimation method
the power of qtl detection 1−β∗ was calculated as follows, where β∗ is the empirical type ii error rate and the symbol ∗ meant an empirical rate. as the snps that were considered as qtls as well as the non-qtl markers were known in our computer simulations, we calculated the quantile of  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> , and  <dig>  of the probabilities for non-qtl markers  and used the quantiles as the signicance threshold to identify a qtl, thus, a fixed empirical type i error rate α∗ of  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> , and  <dig>  was obtained. when a qtl had a probability less than the relavant quantiles, it was counted as a correctly identified qtl. the power of qtl detection 1−β∗ was calculated on the basis of these α∗ levels as proportion of correctly identified qtls from the total number of qtls  <cit> . this meant, the false positive rate was set to a known level  when we calculated the power of qtl detection. the effects for the correctly identified qtls  were taken to calculate the differnce of qtl effect, which was calculated by the following formular: d=t−et× <dig>  where d was the difference of qtl effect, t was the true  qtl effect, and e was the estimated qtl effect by the models.

in a case where we compared the power of qtl detection 1−β∗ between the joint inclusive composite interval mapping  model and the jcim models, a same data set, i.e.  <dig> bc-nam subpopulations with  <dig> qtls, heritability h2= <dig>  randomly selected from a total of  <dig> bc-nam subpopulations, was used for both models. the analysis with jicim model was followed by the manual of the software qtl icimapping  <cit> . the missing phenotype was replaced by the mean of the trait as well as a step of  <dig> cm, a pin value of  <dig>  for stepwise regression selection, a logarithm of odds  threshold of  <dig> , and the mapping method icim-add  were selected. for jcim analysis , only the cofactors selected by the method  <dig> were used. all the non-polymorphic snps were excluded from the analysis. similar to aforementioned method, the power of qtl detection 1−β∗ for the jicim model was the proportion of correctly identified qtls from the total number of qtls. the empirical type i error rate α∗ was calculated by the proportion of false identified qtls by jicim model from the total number of non-qtl markers. the empirical type i error rate α∗ was further used to calculated the power of qtl detetion for the jcim models according to the aforementioned method.

all the settings for the examined paraments were summarized in table  <dig>  if not stated differently, all analyses were performed with the statistical software r  <cit> .


RESULTS
a total of  <dig> snps were detected from the sequence of  <dig> conserved genes for the  <dig> parental inbreds, with a polymorphic rate of  <dig>  %. altogether  <dig> snps were retained after removing loci with a minor allele frequency of less than  <dig> % and used for the computer simulations. based on these original snps, pcoa for the original parental inbreds revealed that the germplasm of panel  <dig>  and the germplasm of panel  <dig>  were located in two distinct clusters , and that the latter was more diverse than the former. strong ld was observed between closely linked loci pairs . ld decayed to r2= <dig>  within  <dig> bp, which corresponds approximately to a genetic map distance of  <dig>  cm. based on the  <dig>  simulated snps distributed across the genome , the pcoa for the simulated parental inbreds revealed a pattern of population structure similar to that of the original parental inbreds . ld decayed to r2= <dig>  within  <dig>  cm .
fig.  <dig> principal coordinate analysis of the  <dig> parental inbreds based on  the original  <dig> snps from  <dig> conserved genes and  the simulated  <dig>  snps. pc  <dig> and pc  <dig> refer to the first and second principal coordinates, respectively. the numbers in parentheses refer to the proportion of variance explained by the principal coordinates. colors and symbols identify different sets of germplasm. the number 1– <dig> indicates the  <dig> of parental inbreds, i.e. pby001- <dig>  pby <dig>  pby010- <dig>  pby017- <dig>  pby021- <dig>  pby <dig>  pby031- <dig>  pby043- <dig>  respectively . number  <dig> is the common parental inbred used to simulate the nested association mapping populations

fig.  <dig> nonlinear regression of the linkage disequilibrium measure r
 <dig> against physical distance   based on the  <dig> original snps of the  <dig> parental inbreds and  based on  <dig>  simulated snps of the simulated  <dig> parental inbreds. the red line is the nonlinear regression trend line of r
 <dig> vs. physical distance



for the scenario with  <dig> individuals in each of the  <dig> bc-nam subpopulations,  <dig> qtls, and h2=  <dig> , the power of qtl detection 1−β∗ decreased with the empirical α∗ level decreasing from  <dig>  to  <dig>  . the statistical power of qtl detection 1- β∗ of single marker model  <dig> and  <dig>  which did not include cofactors, was significantly lower than that of jcim model  <dig> and  <dig>  which included the selected cofactors. the statistical power of qtl detection 1- β∗ of the models using cofactor selection method  <dig> was slightly higher than that for the models using cofactor selection method  <dig>  in case of a pure additively inherited trait, the statistical power of qtl detection 1- β∗ for the models considering the marker or cofactor effects nested within subpopulations  was lower than that for the models considering marker or cofactor effects across subpopulations . the power trends were similar for other examined scenarios, irrespective of mating designs, sample sizes, qtl numbers, and heritabilities. moreover, for the difference between the estimated qtl effects by the statistical models and its relevant true  effects, the statistical model which had higher power of qtl detection  also had a lower difference of qtl effect than those models with lower power of qtl detection .
fig.  <dig> power of qtl detection 1−β
∗ of four statistical models combined with two cofactor selection methods at different α
∗ levels in a scenario with  <dig> qtls, heritability h
2=  <dig> , and  <dig> backcross nested association mapping  subpopulations which were randomly selected from a total of  <dig> bc-nam subpopulations. jcim represents joint composite interval mapping. colors indicate different statistical models. vertical lines at each point indicate the standard errors
∗ of four statistical models combined with two cofactor selection methods  at different α
∗ levels in a scenario with  <dig> qtls, heritability h
2=  <dig> , and  <dig> backcross nested association mapping  subpopulations which were randomly selected from a total of  <dig> bc-nam subpopulations, where α is the mean nominal type i error rate across the performed  <dig> simulation runs, α
∗ is the empirical type i error rate, s <dig> and s <dig> refer to single marker model  <dig> and  <dig>  j <dig> and j <dig> refer to joint composite interval mapping model  <dig> and  <dig>  for details see ‘methods’


α
∗
α
∗
α
∗
α
∗
α
∗
α
∗
α
∗


however, the power of qtl detection 1- β∗ for jcim model  <dig> was higher than that for jcim model  <dig>  when examing a scenario in which a few  qtls had additive effects as well as qtl × genetic background interaction effects with a few background markers  and with a proportion of  <dig> % of the total variance explained by the interaction , or a scenario in which there were interaction effects by many qtls  with more than  <dig> background markers and the proportion of the total variance explained by the interactions was higher than  <dig> % .
fig.  <dig> power of qtl detection 1- β
∗ of joint composite interval mapping  model  <dig>  and  <dig>  with cofactor selection method  <dig> at different α
∗ levels in a scenario with heritability h
2=  <dig> ,  <dig> backcross nested association mapping  subpopulations and   <dig>  of explained ratio by qtl × genetic background interactions to the total genetic variance, where  <dig> qtl interacted with  <dig> background markers;   <dig>  of explained ratio by qtl × genetic background interactions to the total genetic variance, where each of  <dig> qtls interacted with  <dig> background markers. vertical lines at each point indicate the standard errors



in a scenario in which the population sizes corresponded the sizes used in the pre-breedyield project to create  <dig> dh-nam and  <dig> bc-nam subpopulations  were examined, the latter showed a significantly higher power of qtl detection 1- β∗  than the former . when the number of involved parental inbreds and sample size was adjusted to the same value for both mating designs, dh-nam and ril-nam mating designs showed a slightly  higher power of qtl detection 1- β∗ than bc-nam mating design . the trends for the power of qtl detection were similar, irrespective of qtl numbers, heritabilities, the numbers of parental inbreds, and sample sizes. the power of qtl detection 1- β∗ decreased significantly when the number of simulated qtls increased from  <dig> to  <dig> . further, the power of qtl detection 1- β∗ significantly increased when the heritability was increased from  <dig>  to  <dig> . similarly, the power of qtl detection 1- β∗ increased when the numbers of parental inbreds increased from  <dig> to  <dig> and the mapping population sizes increased from  <dig> to  <dig> . with a constant total population size, the mapping population consisted of  <dig> subpopulations with  <dig> individuals per subpopulation showed a slightly  higher power of qtl detection 1- β∗ than the mapping population consisted of  <dig> subpopulations with  <dig> individuals per subpopulation . the stronger the unbalancedness of the size of the individual subpopulation was, the lower was the power of qtl detection 1- β∗ .
fig.  <dig> power of qtl detection 1- β
∗ of joint composite interval mapping model  <dig> with cofactor selection method  <dig> for  <dig> double haploid nested association mapping  vs.  <dig> backcross nested association mapping  vs.  <dig> nest association mapping based on recombinant inbred lines  subpopulations at different α
∗ levels in a scenario with  <dig> qtls and heritability h
2=  <dig> . the  <dig> dh-nam, bc-nam or ril-nam subpopulations were randomly selected from a total of  <dig> relevant dh-nam, bc-nam, or ril-nam subpopulations. colors indicate the dh-nam, bc-nam or ril-nam population. vertical lines at each point indicate the standard errors

fig.  <dig> power of qtl detection 1- β
∗ of joint composite interval mapping model  <dig> with cofactor selection method  <dig> for different numbers of qtls  and different heritabilities  at different α
∗ levels in a scenario of  <dig> backcross nested association mapping  subpopulations. colors indicate combinations of different number of qtls and heritabilities. vertical lines at each point indicate the standard errors

fig.  <dig> power of qtl detection 1- β
∗ of joint composite interval mapping model  <dig> for different numbers of parental inbreds and backcross nested association mapping  subpopulations  at different α
∗ levels in a scenario with  <dig> qtls and heritability h
2=  <dig> . vertical lines at each point indicate the standard errors

fig.  <dig> power of qtl detection 1- β
∗ of joint composite interval mapping model  <dig> with cofactor selection method  <dig> for varied sample sizes of subpopulations with a standared deviation from  <dig> to  <dig> at different α
∗ levels in a scenario with  <dig> qtls, heritability h
2= <dig> , and  <dig> backcross nested association mapping  subpopulations. colors indicate different standard deviations for generating varied sample sizes of subpopulations. vertical lines at each point indicate the standard errors



the power of qtl detection 1- β∗ decreased when the proportion of the total genetic variance explained by qtl × genetic background interactions was increased from  <dig> to  <dig> , irrespective of the mating designs, qtl numbers, heritabilies, and mapping population sizes .
fig.  <dig> power of qtl detection 1- β
∗ of joint composite interval mapping model  <dig> with cofactor selection method  <dig> for different explained ratio  by qtl × genetic background interactions to the total genetic variance at different α
∗ levels in a scenario with  <dig> qtls, heritability h
2=  <dig> , and  <dig> backcross nested association mapping  subpopulations. colors indicate different explained ratio by qtl × genetic background interactions to the total genetic variance. vertical lines at each point indicate the standard errors



a further comparison was performed for the power of qtl detection 1- β∗ between the jicim model and jcim model using the same mapping data  . when the lod value was set to  <dig>  for jicim, the empirical α∗ was close to  <dig>  and the average power of qtl detection 1- β∗ was  <dig> , which was much lower than those for jcim model  <dig> ad  <dig>  at the same empirical α∗ levels.

discussions
simulation of parental inbreds
rapeseed is one of the most important oilseed crops in the world. in order to efficiently select rapeseed varieties with improved yield and agronomic traits through marker or genomics-based selection, mapping of elite genes in diverse germplasm is required. this can be achieved by applying appropriate statistical methods that evaluate the association between genomic polymorphisms and phenotypic variation in different types of mapping populations  <cit> .

recently, the nested association mapping strategy was suggested to combine the high power of qtl detection from linkage analyses with the high mapping resolution of association analysis  <cit> . the strategy is based on ril populations derived from crosses between a set of parental inbreds and one common parent from a diverse germplasm set. however, the evaluation of the nam strategy or other nam-like strategies requires developing, genotyping, and phenotyping large ril populations, which in turn requires large financial resources . therefore, computer simulations are mandatory for examining the properties and evaluating the performance of the different described statistical models and methods.

we observed a total of  <dig> snps from the sequences of  <dig> conserved genes for the parental inbreds, with a polymorphic rate of  <dig>  %, which means about  <dig> snps per  <dig>  bp. the polymorphic rate found in our study was considerably higher than that reported in prevous stuides  <cit> . the difference might be explained by the large number of inbreds  and the highly diverse germplasm  that was used for snp detection in our study.

to check ld decay, we made a nonlinear regression of r <dig> versus the genetic map distance  or physical distance  according to  <cit>  and calculated the distance when r2= <dig> . we observed that ld decayed on average within  <dig> bp to r2= <dig> . this number of bp corresponds roughly to  <dig>  cm. the ld decay in our study was much faster than in the studies of  <cit>  and  <cit> , where  <cit>  found that the expected r <dig> declined to the significance threshold  within about  <dig> cm in a diverse germplasm set, and  <cit>  found high levels of ld extending over about  <dig> cm in a set of  <dig> winter oilseed rape types. the difference might be explained by the following reasons. firstly, different thresholds were applied to measure ld decay. secondly, in our study ld decay within conserved genes was examined, whereas the previous researches studied genome-wide ld decay inferred from molecular markers. thirdly, all studies were done on different sets of germplasm.

based on the global ld decay  in a large and diverse rapeseed population, assuming a genome size of at least  <dig>  cm, and aiming at a coverage of at least  <dig> marker per cm, the research of  <cit>  suggested that considerably more than  <dig>  markers would be required for genome-wide association studies. at the beginning of our project, we only had the sequences of the  <dig> conservative genes. with the information from these sequences, we could well examine the population structure of the founder lines and know the allele frequencies among the founder lines as well. this information provided the basis for our computer simulations. though  <dig> conserved genes do not reflect the true genomic situation, however, it reflects better the genomic situation than ignoring this information. therefore, a total of  <dig>  <dig> snps were simulated based on the original snps from the conserved genes. such a simulated snp set should have as similar properties as possible as the original set with respect to population structure and ld decay. we observed that our simulated parental inbreds maintained allele frequencies, and therewith also population structure, similar to the original parental inbreds . the ld decay in the simulated parental inbreds is about  <dig> times slower than that in the original parental inbreds . though we could make more generations of random mating to get the same ld decay as the original snp set, this would require considerable computational time and resources. this has the potential to lead to a higher power of qtl detection when using the simulated parent inbreds as the parents of nam population rather than the original parental inbreds for all examined scenarios. however, the ranking for the power of qtl detection 1- β∗ for the examined scenarios is expected not to change. therefore we think that the simulation of parental inbreds is a legitimate approach for the questions to be examined in our study.

comparison of power of qtl detection 1- β∗ of the examined statistical models for nam
the single marker model was frequently used in the early association mapping research. this model was used in our study as a reference. we further introduced the jcim model in our study, where, similar to cim, markers were chosen as cofactors to control the genetic variation of the genetic background. considering the structure of the nam populations, we included a subpopulation effect in all examined models.

as  the ranking of the examined statistical models with respect to the power of qtl detection 1- β∗ was the same in all examined scenarios except the scenarios with qtl × genetic background interactions, and  the bc-nam mating design is important for plant breeder to make use of the exotic germplasm resouces, we discuss in the context of the comparison of statistical methods for qtl detection only the results of the scenario with  <dig> bc-nam subpopulations ,  <dig> qtls, and heritability h2= <dig> .

we observed that the power of qtl detection 1- β∗ for the jcim model  <dig> and  <dig>  which used cofactors, was significantly higher than that of single marker model  <dig> and  <dig>  which did not use cofactors . however, the former statistical models required much more computational effort to screen cofactors than the latter. the higher power of qtl detection 1- β∗ for the jcim models than the single marker models can be explained by the fact that cofactors not only corrected for population stratification, but also for the genetic variation of other possibly linked or unlinked qtl which led to an increasing qtl detection power and better estimation of qtl effects  <cit> . moreover, we observed a high power of qtl detection 1- β∗ using cofactor  <dig>  and smaller difference of qtl effects between the estimated and true qtl effects than those using cofactor  <dig> . this might be explained by the difference of the two cofactor selection methods. the method  <dig> detected only one marker from each examined segment to be cofactor or not, whereas the method  <dig> used all markers for cofactor selection from the segments containing cofactors previous identified by the method  <dig>  therefore, more appropriate markers were used as cofactors from each examined segment for the latter than the former. however, the latter required much more computational effort to screen cofactors than the former. our results indicate that the proposed cofactor selection method, which was executed by lasso function  <cit> , was highly efficient with regard to computation time even when dealing with a large number of variables. in the following we only discuss the results of the jcim models with cofactor selection method  <dig> 

we observed that the power of qtl detection 1- β∗ for the jcim model  <dig> was significantly lower than that for the jcim model  <dig> when the qtls had only additive effects . this was also true when the qtls had additive effects plus interaction effects with a low or medium proportion of the total genetic variance explained by many qtls × genetic background interactions. the former model considered marker or cofactor effects nested within subpopulations, whereas the latter model considered marker effects across subpopulations. this might be because more parameters need to be estimated for the former than the latter model, which in turn reduces the power of qtl detection.

however, the power of qtl detection 1- β∗ for jcim model  <dig> was higher than that for jcim model  <dig> when examing a scenario in which there were interaction effects by a few  qtls interacting with a few background markers   as well as a scenario in which there were interaction effects by many qtls  with more than  <dig> background markers and the proportion of the total variance explained by the interactions was higher than  <dig> % .

in a nam population, not all families have segregating alleles at a given snp locus, which might result in different degrees of freedom of tested models and different levels of probabilities for examined markers. however, this will not affect the ranking of the examined statistical models with respect to the power of qtl detection 1- β∗ in our study. the reasons are:  in our simulations, the power to detect qtl at certain empirical type i error rates α∗ were compared. the power of qtl detection 1- β∗ mainly relies on the ranking of probabilities for non-qtl markers, which will not be affected by the degree of freedom of the tested models ;  furthermore, when we compared the qtl detection power to detect qtl for each scenario, we were based on the same segregating families, which had the same segregation alleles at a given snp locus.

in empirical studies where the extent of qtls × genetic background interactions is unknown, the jcim model  <dig> is suggested to be applied for a primary scan, as the model in most cases showed a higher power of qtl detection than jcim model  <dig>  based on the results from the primary scan, a secondary scan is suggested to be applied using the jcim model  <dig> in a scenario in which there were interaction effects by a few  qtls interacting with a few background markers  as well as a scenario in which there were complicated interaction effects such as many qtls  with several background markers.

moreover, we observed that our proposed jcim models showed higher power of qtl detection than the existing jicim model . the reason might be due to that  our proposed cofactor selection methods could effectively select cofactors to control the variation of genetic bakcground during qtl mapping, and  our proposed models could effectively control the impact of population structure. however, as the examined parameters and mapping procedures are different for these models, a comprehensive comparison among the existing statistical models for nam analysis should be performed in future.

influence of mating designs on power of qtl detection
in the pre-breedyield project, two different sets of germplasm, namely adapted and exotic germplasm, were used. accordingly, a dh-nam mating design was applied to the adapted germplasm because it required little time to create fully homozygous genotypes via dh development and thus make use of the elite germplasm resources. however, for the exotic germplasm, due to the likely reasons of low compatibility, hybrid sterility, linkage drag, and inferior performance of hybrids, it might require more generations of backcrossing and selfing to overcome these obstacles. in such cases, the bc-nam mating design might be appropriate when using exotic germplasm as introgression donor parents. therefore, the power of qtl detection 1- β∗ for the two mating designs were compared in the study.

in a scenario of  <dig> dh-nam vs.  <dig> bc-nam subpopulations with  <dig> qtls, heritability h2=  <dig> , and  <dig> individuals per subpopulation, we observed that the dh-nam mating design showed a slightly, but not significantly, higher power of qtl detection 1- β∗ than the bc-nam mating design, irrespective of qtl numbers and heritabilities examined . this difference in power estimates between the two mating designs might be due to that the average allele frequencies for the dh-nam population were close to  <dig> , whereas for the bc-nam design the common parental inbred had a higher allele frequency than the donor parental inbreds. this in turn leads to a higher power of qtl detection for the dh-nam mating design than for the bc-nam mating design. the explanation could be supported by the findings of  <cit> , who observed that the differences in allele frequencies for different crossing schemes contributed to the difference in power estimates.

influence of different genetic parameters on power of qtl detection
in this study we examined the influence of  the genetic architecture of the examined traits,  the mapping population size and the number of parental inbreds, and  unbalancedness of the size of the subpopulations on the power of qtl detection 1- β∗.

genetic architecture of the trait: we observed a higher power of qtl detection 1- β∗ for the traits assessed with a high heritability than for the traits assessed with a low heritability . similiar trends were observed for the traits controlled by a low number of qtls than for the traits controlled by a high number of qtls. the reason is that in the former case each qtl explained a higher proportion of the phenotypic variance than in the latter. for the traits influenced by qtls with both additive effects and qtl × genetic background interaction, the power of qtl detection was significantly lower than for those influenced by qtls with purely additive effects . moreover, the higher the proportion of the total variance explained by qtl × genetic background interaction was, the lower was the power of qtl detection 1- β∗. our observation was similar to the research of  <cit>  and could be explained by the fact that a high proportion of the total variance by qtl × genetic background interaction reduced the proportion of the phenotypic variance explained by each qtl, and thereby reduced the power of qtl detection  <cit> .

mapping population size and the number of parental inbreds: across all examined scenarios, a higher power of qtl detection 1- β∗ was observed for the mapping populations with a higher number of individuals and parental inbreds . this observation was in accordance with the results of  <cit>  and could be explained by the fact that in this case allele effects are estimated more precisely, and that a higher number of parental inbreds increased the number of polymorphic qtl  <cit> . furthermore, with a constant total population size, the mapping population consisted of  <dig> subpopulations with  <dig> individuals per subpopulation showed a slightly  higher power of qtl detection 1- β∗ than the mapping population consisted of  <dig> subpopulations with  <dig> individuals per subpopulation . the reason for this might be that a higher number of subpopulations leads to a higher number of parental inbreds and polymorphic qtl in the total mapping population for the former than the latter, and this in turn inceases the power of qtl detection 1- β∗.

unbalancedness of the size of the subpopulations: we further examined the influcence of unbalancedness of the size of the subpopulations on the power of qtl detection 1- β∗. our results suggested that a mapping population with an unbalanced size of the subpopulations had a significantly lower power of qtl detection 1- β∗ than that with a balanced size of the subpopulations, although the total size of the mapping population was the same . the reason for this might be that an unbalanced size of subpopulations leads to an unbalanced frequency of the alleles of the individual parental inbred in the total mapping population, and this in turn has the potential to reduce the power of qtl detection 1- β∗.

as no earlier studies reported results from nested association mapping in rapeseed, our research is indispensable to draw conclusions about the prospects of nested association mapping in rapeseed. the results of our study support the optimal design as well as analysis of nam populations, especially in rapeseed. as nested association mapping can efficiently combine the advantages of linkage mapping and association mapping, the developed statistical models for nam in this study is of importance for detecting novel qtls and preparing marker assisted selection programs in rapeseed.

CONCLUSIONS
our research showed that a joint composite interval mapping  model had significantly higher power of qtl detection than a single marker model. dh-nam mating design showed a slightly higher power of qtl detection than the bc-nam mating design. the jcim model considering qtl effects nested within subpopulations showed higher power of qtl detection than the jcim model considering qtl effects across subpopulations, when examing a scenario in which there were interaction effects by a few qtls interacting with a few background markers as well as a scenario in which there were interaction effects by many qtls  each with more than  <dig> background markers and the proportion of total variance explained by the interactions was higher than  <dig> %, vise versa. the results of our study support the optimal design as well as analysis of nam populations, especially in rapeseed.

availability of supporting data
the data sets supporting the results of this article are included within the article and its additional files .

additional files
additional file  <dig> 
table s <dig>  the information of the  <dig> conserved genes and their annotations in arabidopsis thaliana genome. description: for those having no gene annotation in a. thaliana genome, the start and end positions in a. thaliana genome were given. 



additional file  <dig> 
table s <dig>  genotypes for the  <dig> parental inbreds at the original snps. 



additional file  <dig> 
table s <dig>  a map file for the original snps. 



additional file  <dig> 
table s <dig>  genotypes for the simulated  <dig> parental inbreds at the simulated  <dig> k snps. 



additional file  <dig> 
table s <dig>  marker name and its position at chromosome for the simulated  <dig> k snps. 



additional file  <dig> 
table s <dig>  genotypes for the  <dig> bc-nam subpopulations, where  <dig> and  <dig> denote the homozygous gentoype of parents, respectively, while  <dig> denotes the heterozygous genotype. 



additional file  <dig> 
table s <dig>  phenotypes for the  <dig> bc-nam subpopulations in a scenario where qtls =  <dig>  h
2= <dig>  with  <dig> replications. 



additional file  <dig> 
figure s <dig>  percentage of difference between estimated and true  qtl effects for joint composite interval mapping  model  <dig> and  <dig> with cofactor selection method  <dig> and  <dig> in a scenario with  <dig> qtls, heritability h
2=  <dig> , and  <dig> backcross nested association mapping  subpopulations. description: colors indicate different statistical models and different cofactor sets. vertical lines at each point indicate the standard errors. 



additional file  <dig> 
table s <dig>  phenotypes for the  <dig> bc-nam subpopulations in a scenario where qtls =  <dig> which interacted with  <dig> background markers, h
2= <dig> ,  <dig>  of explained ratio by qtl × genetic background interactions to the total genetic variance with  <dig> replications. 



additional file  <dig> 
table s <dig>  phenotypes for the  <dig> bc-nam subpopulations in a scenario where qtls =  <dig>  h
2= <dig> ,  <dig>  of explained ratio by qtl × genetic background interactions to the total genetic variance, each of  <dig> qtls interacted with  <dig> background markers with  <dig> replications. 



additional file  <dig> 
table s <dig>  genotypes for the  <dig> dh-nam subpopulations, where  <dig> and  <dig> denote the homozygous gentoypes of parents, respectively. 



additional file  <dig> 
table s <dig>  genotypes for the  <dig> ril-nam subpopulations, where  <dig> and  <dig> denote the homozygous gentoype of parents, respectively, while  <dig> denotes the heterozygous genotype. 



additional file  <dig> 
table s <dig>  phenotypes for the  <dig> dh-nam subpopulations in a scenario where qtls =  <dig>  h
2= <dig>  with  <dig> replications. 



additional file  <dig> 
table s <dig>  phenotypes for the  <dig> ril-nam subpopulations in a scenario where qtls =  <dig>  h
2= <dig>  with  <dig> replications. 



additional file  <dig> 
table s <dig>  phenotypes for the  <dig> bc-nam subpopulations in a scenario where qtls =  <dig>  h
2= <dig>  with  <dig> replications. 



additional file  <dig> 
table s <dig>  phenotypes for the  <dig> bc-nam subpopulations in a scenario where qtls =  <dig>  h
2= <dig>  with  <dig> replications. 



additional file  <dig> 
table s <dig>  phenotypes for the  <dig> bc-nam subpopulations in a scenario where qtls =  <dig>  h
2= <dig>  with  <dig> replications. 



additional file  <dig> 
table s <dig>  phenotypes for the  <dig> bc-nam subpopulations in a scenario where qtls =  <dig>  h
2= <dig>  with  <dig> replications. 



additional file  <dig> 
table s <dig>  phenotypes for the  <dig> bc-nam subpopulations in a scenario where qtls =  <dig>  h
2= <dig> ,  <dig>  of explained ratio by qtl × genetic background interactions to the total genetic variance with  <dig> replications. 



additional file  <dig> 
table s <dig>  phenotypes for the  <dig> bc-nam subpopulations in a scenario where qtls =  <dig>  h
2= <dig> ,  <dig>  of explained ratio by qtl × genetic background interactions to the total genetic variance with  <dig> replications. 



additional file  <dig> 
table s <dig>  phenotypes for the  <dig> bc-nam subpopulations in a scenario where qtls =  <dig>  h
2= <dig> ,  <dig>  of explained ratio by qtl × genetic background interactions to the total genetic variance with  <dig> replications. 



additional file  <dig> 
table s <dig>  comparisions of the power of qtl detection 1- β
∗ among the joint inclusive composite interval mapping  model, joint compositve interval mapping  model  <dig> and  <dig>  description: the comparisons were performed in a scenario with  <dig> qtls, heritability h
2=  <dig> , cofactors selected by the method  <dig>  and  <dig> backcross nested association mapping  subpopulations which were randomly selected from a total of  <dig> bc-nam subpopulations. the empirical type i error α
∗ was calculated based the mapping results from jicim model and the segregating markers and qtls within the mapping population. for details see methods. 



abbreviations
anovaanalysis of variance

bc-nambackcross nested association mapping

cimcomposite interval mapping

cmcenti morgen

dhdouble haploid

dh-namdouble haploid nested association mapping

iciminclusive composite interval mapping

jcimjoint composite interval mapping

jicimjoint inclusive composite interval mapping

lassoleast absolute shrinkage and selection operator

ldlinkage disequilibrium

lodlogarithm of odds

mrdmodified rogers distance

namnested association mapping

pbypre-breed yield

pcoaprincipal coordinate analysis, qtl: quantitative trait locus

rilrecombinant inbred line

ril-namrecombinant inbred lines nested association mapping

ssdsingle seed descent

snpsingle nucleotide polymorphism

competing interests

the authors declare that they have no conflict of interest.

authors’ contributions

jl carried out the computer simulations, analyzed and interpreted the data, drafted the manuscript. ab participated in analysis and interpretation of the data, and revised the manuscript. vs provided and analyzed the sequence data. bs conceived and supervised the study, interpreted the data, and revised the manuscript. all authors read and approved the final manuscript.

