BACKGROUND
one of the main goals of genomic and metagenomic analyses is to extract the comprehensive functions  harbored in an individual organism or a whole community in various environments. however, evaluating the potential functionome is still difficult when compared with the functional annotation of individual genes or proteins; i.e. based on a similarity search against a reference database such as the ncbi-nr database of non-redundant protein sequences  <cit> , usually employing a variant of the blast program  <cit> , or on the protein domain search against a protein family database such as pfam  <cit> . this is mainly because a standard methodology for extracting functional category information, such as individual metabolism, energy generation and transportation systems, has not yet been fully established. traditionally, clusters of orthologous groups  have been used for functional classification of proteins, particularly in microbial genome sequencing projects. the cogs database provides  <dig> functional categories for orthologous groups in order to facilitate functional studies and serves as a platform for functional annotation of newly sequenced genomes and studies on genome evolution  <cit> . although the cog functional categories are often used within standards in genomic sciences  as a standard analysis, through combination with the integrated microbial genomes  system  <cit> , no large functional differences are usually observed in such broad categories; even between phenotypically different organisms  and also whole microbial communities in different environments  <cit> . thus, it is difficult to differentiate the functional potentials between different genomes and metagenomes by analysis based on cog classification.

recently, more detailed and comprehensive functional categories facilitated in kegg  <cit>  and seed  <cit>  have been used for comparative genomics and as metagenomics tools to highlight functional features represented by kaas   <cit> , mg-rast   <cit>  and megan  <cit>  . they all employ a similarity-based method for functional annotations, but utilize different databases for protein sequences, default threshold values and orthology ids for mapping annotated sequences to functional categories depending on their desired outputs, namely pathways in kegg or subsystems in seed. notably, kaas has been applied to protein coding sequences from several metagenomic samples, and their annotated kegg pathways and other classifications are already available .

the outputs of these systems include functional distributions of each sample by hierarchical classification using kegg and/or seed and comparisons between several samples when necessary. however, it is still difficult to evaluate the functional potentials via the current classification systems  because the functional information from different organisms such as microbes, plants, and animals has been mixed up. on the other hand, kegg module, a database that collects pathway modules and other functional units, presents a promising tool for functional classification  <cit> . pathway modules in kegg module are smaller pieces of subpathways, manually defined as consecutive reaction steps, operon or other regulatory units, and phylogenetic units obtained by genome comparisons . this database also contains molecular complex modules, comprising multiple molecules such as the subunits of transporters and receptors, functional sets, and signature modules . as of december  <dig>   <dig> pathway modules have been defined for energy, carbohydrate, lipid, nucleotide, and amino acid metabolism, including genetic and environmental information processing pathways. in total,  <dig> kegg modules  can be accessed through the website .

this background motivated us to develop a new evaluation method using the kegg module database to differentiate the comprehensive and detailed functional potentials between different genomes and metagenomes. in this study, we first calculated the completion ratio of each kegg module in reference species whose genomic sequences have been completely determined. then we characterized the functional potentials between phenotypically different bacilli and human gut microbiomes from  <dig> healthy individuals. finally, we validated the effect of database dependency on the accuracy of ko assignment.

RESULTS
distribution patterns of the module completion ratio in  <dig> prokaryotic species
kegg modules are modular functional units derived from the kegg pathways, and are categorized into pathway modules, structural complexes, functional sets and genotypic signatures. each kegg module is designed for automatic functional annotation by a boolean algebra-like equation of kegg orthology ids . however, it remains un-catalogued as to which species possess common modules or if certain modules demonstrate universality or rareness between specific species, phyla etc. specific information regarding the phylogenetic profiles of each module holder would be especially useful for annotating metagenomes.

thus, we first examined distribution patterns of the completion ratios of the kegg modules in the  <dig> prokaryotic species whose genomic sequences have been completed . although distribution of the module completion ratios in the  <dig> species varied greatly depending on the kind of module , we found that it could be categorized into  <dig> patterns  regardless of the module type , when considering 70% of all species to represent a majority measurement for the patters .

 shows total number of the kegg modules containing branched modules. “rare” indicates the modules completed by less than 10% of  <dig> prokaryotic species. universal: the modules completed by more than 70% of  <dig> prokaryotic species, restricted: the modules completed by less than 30% of  <dig> prokaryotic species. diversified: the modules that varies in the module completion ratio among  <dig> prokaryotic species, non-prokaryotic: the modules not to be completed by any prokaryotic species.

pattern a defined as “universal” comprised modules completed by more than 70% of the  <dig> species , and more than 70% of the  <dig> species possessed a module completion ratio of >80% . of  <dig> pathway modules containing submodules, modules grouped into pattern a account for only  <dig> %  and mainly belong to the categories of central carbohydrate metabolism and cofactor and vitamin biosynthesis. although there are many species, more than 70% of the  <dig> prokaryotes possessed a module completion ratio of 80%, species with 100% completion ratio is very limited in the pattern a- <dig>  m00019_ <dig>  shown as a representative of pattern a- <dig> , is a pathway module for leucine biosynthesis comprising  <dig> reaction steps. the 1st reaction in this module, from pyruvate and thiamine diphosphate to 2- thiamine diphosphate plus co <dig> is catalyzed by acetolactate synthase  comprising  <dig>  subunits. however, since most of the species, except for  <dig> species within gammaproteobacteria, do not have the genes assigned to k <dig> of the acetolactate synthase ii small subunit, the module completion ratio in the remaining  <dig> species becomes  <dig> %. thus, this small subunit may not necessarily be crucial for the pyruvate and thiamine reaction to occur in these species. pattern b defined as “restricted” comprised modules completed by less than 30% of the species , and accounted for  <dig> % of all the pathway modules, and  <dig> modules were rare modules completed by less than 10% of the  <dig> species . pattern c defined as “diversified” accounted for  <dig> % of all the pathway modules, and comprised modules ranging widely in completion ratios. m00012_ <dig>  is one of representatives of pattern c . as shown in figure s <dig> .  <dig> or several ko identifiers were assigned to each reaction in this module; however, ko identifiers, except for k <dig> and k <dig> assigned to the 3rd and 4th reactions, were also assigned to other pathway modules such as the tca  cycle , 1st carbon oxidation , 2nd carbon oxidation , reductive tca cycle  and c4-dicarboxylate cycle +-malic enzyme type) . some ko identifiers assigned to many of the modules, categorized into pattern c, were also assigned to several other independent modules. thus, when the module completion ratio is low, the relationship between the module completion ratio of the targeted module and others to which the same ko identifiers are assigned should be considered. pattern d, which accounted for  <dig> % of all pathway modules, comprised nonprokaryotic modules that are not completed by prokaryotic species .

of the  <dig> structural complex modules containing submodules redefined from modules with various complex patterns,  <dig> modules were categorized into pattern b  and  <dig> were rare modules . pattern c accounted for only  <dig> % in the structural modules compared with  <dig> % in the pathway modules. thus, it was hypothesized that most of the structural complex modules, except for pattern d, are shared only in limited prokaryotic species.

non-prokaryotic modules account for  <dig> % of pathway and  <dig> % of structural complex modules respectively, and other modules were classified into various taxonomic patterns such as prokaryotic, bacteria-specific and archaea-specific based on the module completion profiles as shown in table  <dig>  these  <dig> patterns indicate the universal and unique nature of each module and also the versatility of the ko identifiers mapped to each module. thus, the  <dig> criteria and taxonomic classification for each module should be helpful for interpretation of results based on module completion profile. a breakdown of all the modules grouped into the  <dig> patterns is summarized in table s3-s <dig> .

 shows total number of the kegg modules containing branched modules.

comparative functionome analysis of bacilli based on the kegg modules
bacillus and its related species in genera such as oceanobacillus and geobacillus reclassified from genus bacillus  are known to thrive in a wide range of environmental conditions: ph 2– <dig>  temperatures between 5–78°c, salinity from  <dig> to 30% nacl, and pressures from  <dig>  mpa  to at least  <dig> mpa   <cit> . the genome structure of these species within family bacillaceae is comparatively similar, and the core structure comprising more than  <dig>  orthologous groups is well conserved among bacillaceae <cit> . therefore, moderately related bacillar genomes from  <dig> species with different phenotypic properties were selected to test our evaluation method for potential functionome using kegg modules, in order to differentiate the functional potentials harbored in their genomes.

the gene products from  <dig> bacillar genomes were assigned to ko identifiers constructing each module in  <dig> pathway and  <dig> structural complex modules as shown in figure s <dig> . there was significant difference in the module completion ratio by  <dig> bacilli in terms of at least  <dig> pathway and  <dig> complex modules . in particular, the completion ratio in oceanobacillus iheyensis, a mesophilic, extremely halotolerant alkaliphile  <cit> , was very low in  <dig> modules for thiamine biosynthesis , nad biosynthesis , phosphatidylethanolamine biosynthesis  and biotin biosynthesis . these  <dig> modules were completed by all bacilli except for o. iheyensis although they are categorized into one of the diversified modules . in addition, all bacilli almost completed the module for c <dig> isoprenoid biosynthesis , categorized into one of the universal modules  in spite of very low module completion ratio by o. iheyensis. conversely,  <dig> modules belonging to pattern c for tryptophan biosynthesis  and ketone body biosynthesis  were completed by only o. iheyensis, although other species partially completed them. through these results it was evident that o. iheyensis differs from other bacilli in its metabolic potentials.
.

some of the completed structural complex modules were found to be shared in bacilli with the same phenotypic properties, or to be independently species specific . for example, the firmicutes-specific modules for the teichoic acid transport system  were shared only among  <dig> mesophilic neutrophiles , although this module is widely shared in other genera such as staphylococcus, clostridium, and listeria within phylum firmicutes. similarly, bacillus-specific uncharacterized atp-binding cassette  transport system  was also found to be shared among  <dig> mesophilic neutrophiles. on the other hand,  <dig> other modules, the iron  transport system  and phosphonate transport system  which are shared in many prokaryotic species within various phyla and belonged to pattern c, were shared only among  <dig> mesophilic alkaliphiles . although it has been previously reported that the orthologous genes for the phosphonate transport system were shared between o. iheyensis and b. halodurans <cit> , it could be easily visualized using our new evaluation method that this system was also shared in other mesophilic and alkaliphilic b. pseudofirmus, whose genome sequence has been completed recently. in addition, another putative phosphonate transport system  and the n-acetylglucosamine transport system  categorized into one of the restricted modules  were found to be conserved only in o. iheyensis. although how the differentiated functional modules confer phenotypic properties directly or indirectly is still unclear, a series of the above results should be helpful in better understanding of the physiological properties.

comparative functionome analysis of humans and human gut microbiomes
the completion ratio of each kegg module was compared between humans and human gut microbiomes to illustrate their metabolic linkage. the metagenomic data of gut microbiomes from  <dig> healthy japanese individuals, previously reported on, was used  <cit> . detailed information for all metagenomic samples are summarized in table s <dig> . the gene products from metagenomes of the microbiomes from the  <dig> individuals were assigned to ko identifiers constructing each module in  <dig> pathway and  <dig> structural complex modules as shown in figure s <dig> . similarly, the gene products from the human genome were completely or partially assigned to ko identifiers in  <dig> pathway and  <dig> structural complex modules. there was a significant difference in the module completion ratios of  <dig> individuals in terms of at least  <dig> pathway modules .

the most complete 16s rrna gene sequence-based enumerations available in human gut microbiomes indicate that more than 90% of phylotypes belong to just two of the  <dig> known divisions of bacteria, the bacteroidetes and the firmicutes, with the remaining phylotypes distributed among eight other phyla  <cit> . pairwise comparison of the completion ratio of the kegg module clearly demonstrated the well-recognized functional complementation of the gut microbiome to the human host, which includes essential amino acid and vitamin biosynthesis . the contributors completing the modules for vitamin production are firmicutes, bacteroidetes, actinobacteria, and gammaproteobacteria. completion patterns of the kegg module for these amino acids and vitamins mainly fall into patterns c  and d  except for riboflavin biosynthesis  belonging to one of the universal modules , indicating that these modules are involved in the nutritional supply for the gut microbiome as well as for the host . inter-individual variation was also evident in the completion ratio of the module for vitamins. for example, the module  belonging to pattern c for pyridoxal  biosynthesis was mainly attributable to bacteroidetes in adults and gammaproteobacteria in infants; however, its completion ratio in  <dig> male infants  was extremely low  . inter-individual variations in completion ratios were also observed in modules  for polyamine biosynthesis, for example, putrescine, spermidine, and spermine. similarly, the completion ratio of the kegg modules  for γ-aminobutyric acid  varied among individuals, and gammaproteobacteria mainly contributed to gaba production. because these polyamines and gaba are essential biological substances that act as cell growth promoters and inhibitory neurotransmitters respectively, in humans, these variations may be linked to susceptibilities to certain diseases. indeed, a recent report on metabolic changes in gut microbiomes after bariatric surgery for obese patients demonstrated their potential for polyamine production in the gut; elevated protein putrefaction because of the bypassed food passage promoted putrescine and gaba production from gut microbiota  <cit> .

interestingly, gut microbiomes showed preference for amino acid catabolism. as shown in figure 5c, the gut microbiome did not seem to utilize exogenous lysine , leucine , and aromatic amino acids such as tryptophan  and tyrosine . to our knowledge, this is a novel finding on the nutritional preference of gut microbes. this may be one of the mutualistic representations of gut microbiomes to avoid nutritional competition with the host because these aromatic amino acids are precursors of various biological substances such as catecholamines, melatonin, serotonin, thyroid hormones, and nad. to assess the taxonomic composition of gut microbiomes, the module for glycolysis  was analyzed . each gene product mapped to this module was taxonomically assigned, and distribution at the phylum level was calculated. consistent with a previous report  <cit> , adult and child gut microbiomes are constituted by  <dig> major phyla, firmicutes and bacteroidetes. analysis of the module for glycolysis clearly differentiated the gut microbial composition between adults and infants as well as among infants. in particular, it was highlighted that actinobacteria was a major phylum in breast-fed infants, whereas gammaproteobacteria was predominant in a bottle-fed infant. it was also evident that the microbial composition in an infant with mixed feeding  showed a pattern intermediate between those in breast- and bottle-fed infants. thus, the new evaluation method based on the kegg modules is expected not only to highlight the metabolic linkage between host and commensal microbes but also to identify microbiome-based biomarkers for particular diseases.

CONCLUSIONS
we developed a new evaluation method for potential functionomes based on the kegg modules. modules with branching or different component structures in a complex were redefined depending on the number of branching or types of component structures. the module completion ratio was calculated by counting the number of genes assigned to ko identifiers constructing each module defined by a boolean algebra-like equation.

using this new method, we found significant difference in module completion ratio by  <dig> bacilli in terms of at least  <dig> pathway and  <dig> complex modules, although how the differentiated functional modules confer phenotypic properties directly or indirectly is unclear thus far. because the coverage of kegg modules over whole metabolic and signaling networks is continuously increasing, differences in module completion ratio will provide some important clues to the understanding of phenotypic properties. furthermore, variations in the functional potential of human gut microbiomes from  <dig> healthy individuals could be characterized by the pathway and structural complex module units, and the complementarity between biochemical functions in human hosts and nutritional preferences in human gut microbiomes identified. in addition, taxonomic variation of the contributors to each module clarified by this method will prove informative when considering ecological dynamics.

functional annotations to metagenomic sequences remain difficult because metagenomic data targeting various environments still contains incomplete genes from various unidentified species, absent in a reference database. in this study, we used the kaas system for functional annotation to the human metagenomes and also attempted to estimate database dependency on the accuracy of the ko assignment using the e. coli draft genome. as a result, the kaas system could correctly assign to ko groups with an accuracy rate of approximately 80%, even if the gene hosts were not classified into known phyla within the reference database . thus, our method will work well for comparative functional analysis in metagenomics, able to target unknown environments containing various uncultivable microbes within unidentified phyla, although further verification studies on database dependency for metagenomics should be performed.

