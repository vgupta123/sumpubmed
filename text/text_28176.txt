BACKGROUND
understanding the driving forces of speciation processes is a primary goal of evolutionary biology  <cit> . various mechanisms can lead to the evolution of reproductive isolation between populations and ultimately to speciation  <cit> . one of these mechanisms is ecology-driven diversifying selection imposed by the demands of adapting to niche-specific biotic and abiotic factors . one major target of these adaptive processes is the evolution of life history traits such as lifespan, growth, development and plasticity  <cit> . according to life history theory organisms try to optimize their survival and reproduction, thus their fitness, by following a species specific pattern in allocating resources to life history traits  <cit> . for example developmental rates and growth are dependent on prevailing ecological conditions, and influence size and age at maturity  <cit> . ecological conditions affecting developmental timing and growth include predator prevalence  <cit> , nutrition  <cit> , as well as climate variables  <cit> .

ultimately, most local environmental variables are affected by climate, which is especially the case in fresh water systems where climate is a major driver of abiotic and biotic processes  <cit> . apart from the obvious impact of precipitation on freshwater systems, the temperature of a given stretch of stream or river varies seasonally, weekly and daily and is dependent on a number of factors, including air temperature, but also depth, flow, elevation, latitude, water input  and the type and extent of riparian vegetation  <cit> . variation in air temperature not only leads to changes in water temperature but might also lead to alterations in additional water body conditions such as reduced oxygen availability, increased salinity and the desiccation of the water body.

due to the large number of ecological variables organisms are exposed to, it is not always possible to accurately determine the respective selective regimes acting in a system. it is thus often difficult and sometimes misleading to reconstruct post hoc the evolutionary forces that lead to the separation even of closely related lineages. “reverse ecology” is one way to obtain plausible hypotheses on the driving processes of reproductive isolation  <cit> . this approach uses comparative genomic data to identify genes and their functions whose evolution has been driven by positive selection  <cit> . under the assumption that those genes most likely code for important ecological phenotypes  <cit>  they can help to infer the response of organisms to their environment. recent developments in next-generation sequencing technologies have led to the availability of genomic resources for many non-model organisms, allowing us to apply the reverse ecology approach to a wider range of organisms  <cit> .

in this study we make use of the reverse ecology approach to gain insights into the role of ecological factors leading to species divergence in the pond snail genus radix montfort  <dig>  the genus radix is part of the lymnaeidae family  and contains air-breathing, simultaneously hermaphroditic snail species, which are distributed throughout the paleartic  <cit> . shell size, coloration and genital anatomy are highly variable even within species  <cit>  and often overlap between species, rendering morphological delimitation of species rather difficult  <cit> . a coi based barcoding effort based on specimen from north western europe resulted in five “molecularly defined taxonomic units” , some of which could be attributed to existing species  <cit> . the type of water bodies occupied by the different species varies from deep, permanent waters , to clear and cold streams , to slow flowing rivers, ditches and ponds   <cit> . moreover, the distinct distribution ranges  <cit>  may indicate climatic niche differences among species, mirrored on the genomic level. we may thus expect to find positively selected genes with biological functions related to energy metabolism, desiccation resistance or salinity tolerance. indeed, climate is known to affect such ecologically relevant fitness traits in other aquatic gastropods .

we use an rna-seq approach to obtain the transcriptomes of r. auricularia, motu <dig> and motu <dig> to obtain ortholog gene sequences for the selection analyses. in addition, we reconstruct the full mitochondrial genomes for each of the four species, since mitochondrial genes are known to play a central role in temperature dependent metabolism of ectotherms  <cit> . three different tests for selection are applied to identify possible candidate genes involved in species divergence in the genus radix.

RESULTS
for this study we sequenced the transcriptomes for three central european radix species. motu <dig> and r. auricularia were sequenced on the roche  <dig> and motu <dig> on the illumina hiseq  <dig> platform. the sequencing effort resulted in more than  <dig>  to over 100mio reads respectively. accession numbers, summary on the number of reads, as well as summary statistics on the de novo assembled contigs can be found in additional file  <dig>  the transcriptome and assembly information of r. balthica has been published in a previous study  <cit> .

mitochondrial genomes
as intergenic regions in mitochondrial genomes are rather small, it was possible to assemble a large part of the mt-genomes based on transcriptome contigs. the remaining gaps were closed by additional sanger sequences, which we also used for sequence verification. the length of the mt-genomes was  <dig>  bp in r. auricularia ;  <dig>  bp in motu <dig> ;  <dig>  bp in motu <dig>  and  <dig>  bp in r. balthica . mitochondrial genome nucleotide divergence ranges from  <dig>  % between the two sister species r. balthica and motu <dig> and  <dig>  % between motu <dig> and r. auricularia. the location and orientation of all  <dig> protein coding genes and the two rrnas is identical in all four species. in contrast, the gene order within a cluster of seven trnas between the coii and atp <dig> is variable . both observations resemble the findings of a previous comparative analysis of mt-genomes in a study of three basommatophoran genera  <cit> . using r. auricularia as reference, the trna-cys was shifted two positions towards the 5′-end of the trna cluster in motu <dig>  again with r. auricularia as reference, trna-trp shifted two positions towards the 5′-end in both, r. balthica and motu <dig> .fig.  <dig> schematic overview of the gene order in mitochondrial genomes of the four radix species investigated. gene orientation is indicated by arrows. inferred trna rearrangements are indicated by arrows in the detailed section. tree topology inferred from phylogenetic analysis 



phylogenetic relationships
with biomphalaria glabrata as an outgroup, both phylogenetic reconstructions lead to the same phylogenetic relationship among species ; reconstruction with additional  <dig> nuclear loci ). the trees consistently identify r. balthica and motu <dig> as sister species, as expected from pfenninger et al.  <cit> . r. auricularia constitutes the earliest branching lineage among the four radix species.

climatic niche differentiation
an analysis of  <dig> climatic variables  <cit>  at  <dig> sampling sites of the four radix species was conducted to determine climate niche differences between species. a principle component analysis revealed significant differences in pca <dig>  =  <dig> ; p =  <dig> ) as well as pca <dig>  =  <dig> ; p =  <dig> ) between the distribution areas of the four radix species. motu <dig> inhabits the warmest and driest region, while motu <dig> can be found in the coldest habitat with the highest amount of precipitation .

ortholog gene clusters and tests for positive selection
we used the tool hamstr  to search for ortholog sequences in the radix transcriptome data. for  <dig> genes an ortholog was detected in all four species. for an additional  <dig> genes we detected orthologs in each of the two sister species r. balthica & motu <dig> 

three different methods  were applied to test for positively selected genes among the four species. in total  <dig> clusters were identified as positively selected by at least one of the three methods . of these,  <dig> were identified by a single method only, and five clusters by all three methods . with the paml method  <dig> clusters  were classified as positively selected . the number of selected clusters per branch ranged from two in motu <dig> to  <dig> in motu <dig> . there was no difference in the frequency of the four most abundant functional gene ontology categories among the branches  growth : x2 =  <dig> , df =  <dig>  p =  <dig> ; reproduction: x2 =  <dig> , df =  <dig>  p =  <dig> ; hermaphrodite genitalia development: x2 =  <dig> , df =  <dig>  p =  <dig> ), indicating their relevance in species divergence among all four species. with treesaap  <dig> unique clusters fulfilled the criteria for positive selection. the number of positively selected treesaap clusters per branch ranged from zero on the branch leading to r. auricularia to  <dig> on the branch to r. balthica . the pair-wise comparison between the two sister species r. balthica and motu <dig> was based on  <dig> ortholog clusters, of which  <dig> were identified as positively selected according to the mcdonald-kreitman test . none of the  <dig> genes with signatures of selection are of mitochondrial origin.fig.  <dig> number of selected gene clusters  with respective association to the four most abundant functional categories. selected genes were identified with three different methods: paml ; treesaap ; mk-test ; d = “development” ; r = “reproduction” ; ge = “genitalia development” ; gr = “growth” ; n = node# as referred to in the selection analyses. note that a single cluster can belong to multiple functional categories. )



functional enrichment analyses
we conducted an enrichment analysis to test for over-representation of functional categories among the complete set of positively selected genes and among subsets according to branches. the construction of clusters with hamstr is based on a set of core-orthologs which are evolutionary conserved genes. the sequences/contigs used in the analyses are transcriptome based and hence a subset of all genes. we might thus introduce a systematic bias in functional categories associated to subsets of contigs. to account for these possible biases we conducted enrichment analyses with the set of contigs with and without signatures of selection against the background set of all  <dig> contigs each. functional categories identified in both sets of contigs might be due to the above mentioned systematic bias and are excluded from further discussion. in the clusters without signature of selection,  <dig> functional categories are overrepresented  when tested against the background set . only two categories overlap between the cluster sets with and without signatures of selection, namely “growth” and “post-embryonic development”.table  <dig> summary of enriched functional categories  overrepresented in cluster-sets with and without selection. in italic, functional categories enriched in both types of clusters

growth
growth

growth

post-embryonic development
post-embryonic development


excluding the two overlapping functional categories, seven categories are exclusively overrepresented in the complete selected cluster set , which are mainly involved in the regulation of growth  and larval development . when excluding the mk-test identified genes based on motu <dig> and r. balthica only, the development related functions dropped out, but the growth  related functional categories are still overrepresented in this smaller cluster-set  . in the cluster set with the  <dig> selected genes identified between r. balthica and motu <dig> by the mk-test, none of the functions appears to be overrepresented.

with respect to our initial hypothesis that genes involved in metabolism could play a role in species divergence, we could not identify any metabolism related overrepresented functional category in the selected gene clusters. however, out of the  <dig> genes with signs of positive selection, seven are involved in metabolism related functions such as “oxidation reduction process” and “metabolic process”. three of these seven show signs of selection on the branch to r. balthica, and two more between r. balthica and motu <dig> by the mk-test. thus only two of the seven genes are found on branches other than r. balthica, namely r. auricularia and the branch leading from r. auricularia to the other species.

discussion
understanding the underlying forces leading to species divergence is of great interest in evolutionary biology. one possible mechanism is ecological speciation, defined as the evolution of reproductive isolation between populations as a result of ecologically-based divergent natural selection  <cit> . we set out to determine genes possibly involved in species divergence among four freshwater snail species of the genus radix inhabiting distinct distribution ranges. we hypothesized that the distribution ranges differ in climatic niche properties, leading to species divergences based on selection on species specific physiological traits. we show here, that indeed distribution ranges of the four species differ significantly in their climatic conditions, mainly in precipitation and temperature. however, genes relevant in physiology and metabolic related processes only seem to play a minor role.

as mitochondrial genes are major players in the respiratory cascade and are thus involved in metabolic processes  <cit> , selection on some of these genes involved in oxidative phosphorylation may lead to adaptation to different environments  <cit> . the comparison of the four mitochondrial genomes revealed rather large congruence among species. while the gene order of protein coding genes is identical among species, the position of four trnas , within a cluster of seven trnas varies between species. even though the radix species investigated here inhabit distinct climatic niches, none of the mitochondrial genes, central in energy metabolism, shows signatures of selection among the radix species.

function and relevance of nuclear genes with signs of positive selection
in contrast to the mitochondrial genes, we were able to identify  <dig> nuclear genes with signs of positive selection between the four species. seven of these genes are related to metabolism and oxidation processes and thus might indicate physiological adaptations in respect to temperature differences. many of these were detected between the two sister species r. balthica and motu <dig>  this corroborates findings of a recent study investigating a hybrid zone between these two species, where precipitation and temperature were the environmental factors explaining species and hybrid zone distribution  <cit> . amongst the genes with signs of positive selection we also identified functions related to reproduction and hermaphrodite genitalia development. genitalia morphology is one of the most species specific characteristics, and plays a major role in species divergence . genitalia morphology is known to be subjected to rapid evolution through sexual selection  <cit> , which is especially wide spread in animals with internal fertilization  <cit> . our findings might indicate a role of ongoing active enforcement of mechanical reproductive isolation in the radix complex, albeit considerable inter- and intra-specific morphological variations for the bursa position and bursa duct  <cit> .

however, the most frequent and overrepresented functions among the selected genes are larval development and  growth . these functions are well known life-history traits. based on life-history theory, it is generally assumed that organisms are facing numerous trade-offs due to a limited amount of resources  <cit> . for example, long lived organisms usually produce only a small number of offspring, whereas short lived organisms produce comparatively many. in general, body size is positively correlated with survival and fecundity, however larger size often requires additional time for growth, thus leading to older age at maturity  <cit> . on the other hand, when the risk of mortality increases in the larval environment, faster development at the cost of smaller body size may still be favored  <cit> . thus depending on the available resources and environmental conditions, organisms need to trade off which of the trajectories they will follow.

with respect to larval development, two factors play a crucial role; timing and rate. developmental timing  is a complex trait  <cit> . it can lead to shifts in timing of gene expression and result in morphological alterations  <cit> , even though the underlying genes are shared among distantly related groups  <cit> . in fact, recent publications on several gastropod species, and radix in particular, have uncovered inter- and intraspecific variation in embryonic development  <cit> , and a correlation between developmental timing and genetic differentiation in r. balthica populations  <cit> . thus the variation in developmental timing in combination with genetic differentiation could serve as raw material for natural selection and drive species divergence  <cit> .

developmental rate, the time elapsed from embryo to the reproductive phase, shows considerable variation in natural populations  <cit> . developmental rate genes have pleiotropic effects on several adult traits and the action of most of them is sensitive to temperature during development  <cit> . in this respect the role of environmental conditions has been suggested as a selective force driving the differentiation of embryonic development in a number of species, such as nematodes  <cit> , lizards  <cit>  and various gastropod taxa  <cit> . interestingly, developmental rates are under strong selection in a number of aquatic organisms facing the threat of desiccation, since it allows organisms and their live stages to avoid unfavorable conditions  <cit> . for example killifish embryos decrease their developmental rates leading to a developmental arrest in early stages of development in response to desiccation  <cit> . on the other hand, many amphibians accelerate development to avoid desiccation, often at the cost of body size . in gastropod species life stage, as well as individual size have a large intra-specific effect on desiccation resistance . in snails, an increase in shell size can be a mechanism of desiccation resistance due to reduced water loss as a result of a better surface-volume ratio  <cit> . from these examples it becomes clear that the interplay between developmental timing, the rate of development, growth rate and size may indeed play an important role in shaping the fitness landscape of aquatic organisms.

as mentioned before, the hybrid zone between the sister species r. balthica and motu <dig> is best explained by local climatic factors, namely precipitation and temperature  <cit> . the great number of positively selected genes with functions in development and growth  together with the above examples and the pronounced climatic differences between the distribution areas of the four radix species, leads to the hypothesis that species divergence is mainly driven by a trade-off in life-history parameters leading to niche adaptation. for example in hot and dry environments a quick development with fast growth might prevent susceptible larvae and small individuals from desiccation. cold environments, on the other hand, might lead to slow development, smaller shell and smaller clutch sizes, however might result in longer lifespan  <cit> .

CONCLUSIONS
based on pronounced differences in climatic niche properties between the four radix species, we expected to find genes involved in physiological and metabolic traits to be under selection. however, the results from our study suggest that species divergence in radix is mainly driven by selection on life-history traits, mainly development and growth, rather than physiological properties. as climate is known to have direct effects on various water body properties and therefore also on ecologically relevant fitness traits in aquatic gastropods, such as desiccation tolerance , we hypothesize that developmental rate and individual size might be of high adaptive importance in the genus radix. the bottom up approach applied here provides a number of unexpected results and new hypotheses, which can now be tested in follow up functional experiments. this reverse ecology approach has thus proven valuable for hypotheses generation in evolutionary research.

