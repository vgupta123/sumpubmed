BACKGROUND
disentangling the roles of geography and ecology driving population divergence and speciation has been a common goal among evolutionary biologists  <cit> . several studies spanning diverse taxa suggest that the influence of these factors is often hierarchical: geography, landscape features, and vicariance may be important at larger spatial scales, whereas ecology and life history may be important at finer spatial scales . hierarchical structure and divergence below the species level have key implications for conservation and the definition of evolutionary significant units  <cit> . for management applications, a hierarchical distribution of population-level diversity has been deemed critical for the resilience of commercially exploited species, which some authors have defined as biocomplexity  <cit> ; hierarchical structure may also provide a strong buffer against interannual fluctuations in abundance or 'portfolio effect', therefore ensuring long-term sustainability of wild populations in an era of growing anthropogenic impacts  <cit> .

research on salmonid systems has greatly enhanced our understanding of hierarchical divergence; in fact, genetic variance is normally larger between salmon populations inhabiting different basins than between salmon populations from the same basin that differ in ecological attributes  <cit> . this configuration is likely a result of historical contingency  and contemporary evolution of life history types  <cit> . anadromous salmon populations are highly philopatric; adults return to their natal sites in freshwater to reproduce, thus promoting genetic isolation and local adaptation  <cit> . in particular, adult sockeye salmon  spawn among tributaries, outlet rivers, beaches, and even glacial habitats  <cit>  after typically spending  <dig> or  <dig> years in the ocean  <cit> . a combination of natural and sexual selection appears to maintain phenotypic divergence between populations, but especially between those using different types of spawning habitats . in addition, the timing of spawning often differs systematically between habitat types, and the regularity in timing of migration and spawning is critical to the structure and conservation of populations  <cit> .

molecular tools have become instrumental for quantifying population divergence and reproductive isolation in applied evolutionary biology studies. single nucleotide polymorphisms  are now the marker of choice among many geneticists for addressing evolutionary questions  <cit> . the majority of studies using these abundant bi-allelic markers have hitherto focused on model organisms  <cit>  with fewer applications to nonmodel taxa . because snps can be linked to functional genes, it is important to determine which markers have been likely targets of selection, otherwise, estimates of gene flow may be compromised  <cit> . so-called 'genome scans' have enabled identification of putative markers under selection exhibiting larger or smaller estimates of divergence--often referred to as 'outliers'--than selectively neutral markers  <cit> . outliers have been related to adaptive divergence in several studies  <cit> ; nevertheless, demography and neutral processes can leave similar signatures to selection in the genome. population bottlenecks or expansions can be mistaken for selective sweeps  <cit> . furthermore, recent models of hierarchical structure suggest that, when gene flow occurs predominantly within rather than between groups of demes, the number of outliers could be upwardly biased  <cit> .

here we employed multilocus genotypes from  <dig> nuclear and three mitochondrial snps isolated for sockeye salmon  <cit>  to typify  <dig> spawning populations throughout the kvichak river, which drains into bristol bay, southwest alaska . our primary goal was to assess the differential roles of geography  and ecology  driving the spatial distribution of genetic diversity as revealed by snps. the kvichak river is divided into two major subdrainages, each containing multiple lakes . subdrainages and lakes should represent natural landscape boundaries driving genetic diversity within and between o. nerka populations because  they were likely recolonized at varying times through different founding events as ice sheets sequentially retreated at the end of the late wisconsin glacial maximum ;  lakes provide nursery habitat for juvenile sockeye salmon growth, and also, an opportunity for strong olfactory imprinting, a crucial aid for adult homing behaviour  <cit> ; and  they may be isolated by the presence of waterfalls  that delay or deter upstream migration of returning adults, especially during years with increased river runoff  <cit> . lakes in turn harbour locally adapted populations that spawn among diverse environments, including mainland-beach, island-beach, and tributary habitats  <cit> . some of these populations have discrete patterns of migration and spawn timing  <cit> , which adds a temporal dimension to spatial divergence  <cit> . both ecological attributes--spawning habitat and timing of reproduction--predict that dispersal is most likely to occur between populations spawning in the same habitat, at the same time, or both, and this has found empirical support  <cit> . dispersal in salmonids may also follow an isolation-by-distance pattern if migration and drift have reached equilibrium  <cit> , implying that gene flow is more efficient between nearby populations than those far apart  <cit> . we hypothesize that both geography and ecology should interact to influence large-  and fine-scale dispersal  but we expected their importance to vary depending on the spatial scale: geographic attributes should be more important at larger scales, whereas ecological characteristics should be more important at finer scales.

*after excluding two outlier snps and three mitochondrial snps . n, sample size; ar, allelic richness or number of alleles corrected for a minimum sample size of  <dig> diploid individuals; he, unbiased expected heterozygosity; hwe, goodness-of-fit to hardy-weinberg equilibrium expectations. §e = early migrants; l = late migrants. †mbea = mainland beach; ibea = island beach; trib = tributary. ‡historical dates of peak spawning activity.

our secondary goal was to evaluate the scope of neutral vs. adaptive differentiation in sockeye salmon as revealed by locus-specific estimates of divergence. here we used two outlier detection methods to identify and characterize potential candidate snps responding to environmental selection, emphasizing which mechanism may maintain the genetic variation of outlier loci. these analyses were conducted and reported first  in order to avoid estimates of  divergence that may be biased by selection. emphasis was placed on violations of the demographic assumptions of outlier detection models, including potential bottlenecks and hierarchical structure between populations  <cit> . we subsequently conducted exploratory analyses of hardy-weinberg and linkage disequilibrium, estimated genetic diversity and differentiation, and tested for the relative effects of geography and ecology on population divergence, using snp sets that included or excluded these outlier loci.

RESULTS
detection and characterization of outliers
bayescan  <cit>  suggested seven candidates for diversifying selection and one candidate for balancing selection . it quickly became apparent, though, that the majority of outlier snps were driven by a few divergent populations from lake clark . when lake clark populations were removed, four loci no longer appeared as outliers ; their allele frequencies were very similar and showed strong differences  only between lake clark and the rest of populations . lake clark populations further showed the lowest estimates of diversity within populations , possibly indicating presence of bottlenecks. marked allele frequency differences between subdrainages  characterized other outliers, such as one_gph- <dig>  and one_stc- <dig> , suggesting that gene flow was more predominant within subdrainages than between subdrainages. simulations in arlequin  <dig>   <cit>  confirmed that one_gph- <dig> and one_stc- <dig> were no longer outliers assuming hierarchical structure between subdrainages . therefore, only one _mhc2- <dig> and one_mhc2- <dig> consistently appeared to be under diversifying selection .

*using bayescan  <cit>  and arlequin  <dig>   <cit> .

outlier snps were annotated to protein-encoding sequences with three exceptions . even though most mutations were intronic, one_mhc2- <dig> was located in exon β <dig> of the major histocompatibility complex  class ii which corresponded to a nonsynonymous substitution  in the putative antigen recognition site  <cit> . only  <dig> nucleotides separated this and the paired locus one_mhc2- <dig> located within an intervening intron  <cit> . interestingly, allele frequencies appeared uncorrelated between one_mhc2- <dig> and one_mhc2- <dig> for some populations ; for instance, they fluctuated greatly between sixmile lake populations . also, a group of populations from the east end of iliamna lake  had much higher frequencies than the remaining populations for one_mhc2- <dig> , but not one_mhc2- <dig> .

hardy-weinberg equilibrium and linkage disequilibrium tests
no significant  departures from hardy-weinberg equilibrium were observed in any population or locus following exclusion of three mitochondrial snps . however, we detected highly significant linkage disequilibrium for  <dig> nuclear locus-pairs across populations after a sequential bonferroni correction for k tests : one_mhc2- <dig>  and one_mhc2- <dig> ; one_tf_ex10- <dig>  and one_tf_ex3- <dig> ; one_gpdh  and one_gpdh <dig> . based on the information content per locus, i , both one_mhc2- <dig> and one_mhc2- <dig> were kept for subsequent analyses, while one_tf_ex3- <dig> and one_gpdh <dig> were excluded from further analyses. exclusion of these loci decreased the pool of nuclear snps from  <dig> to  <dig> 

genetic diversity and differentiation
estimates of snp diversity and differentiation were obtained for three distinct nuclear sets of markers to account for possible effects of selection: 'no outliers' or the putatively neutral set , 'outlier 1' , and 'outlier 2' . differences between sets were emphasized if present; otherwise 'no outliers' should be considered the default set.

allelic richness  ranged between  <dig>   and  <dig>   and expected heterozygosity  varied between  <dig>   and  <dig>  . both metrics were highly correlated across all populations . we also detected differences in ar  and he between lakes . the lowest diversities were found within clark and battle, whereas the highest were in sixmile and iliamna . diversity contrasts between subdrainages  were also significant .

*using  <dig> snps. ar, allelic richness; he, expected heterozygosity.

estimates of global divergence were slightly higher for 'outlier 1'  and 'outlier 2'  than for the 'no outliers' set . pairwise fst for the entire drainage were significantly correlated between snp sets based on simple mantel tests and pearson correlation coefficient, r . global differentiation among mitochondrial snps was also highly significant  but lower than estimates found for nuclear snps.

pairwise fst values were consistently significant between populations located in different lakes for all three snp sets, even though multiple population comparisons within iliamna lake suggested no differentiation . notable examples included:  1-battle lake beach and 2-battle lake tributary, two populations that spawn in contrasting habitats but are in close geographic proximity;  5-moraine creek and 6-moraine creek early, and  7-nanuktuk creek and 8-nanuktuk creek early, which may represent either two discrete populations migrating at different times or one large population with a protracted spawning period.

effects of geography at large spatial scales 
simple and partial mantel tests suggested that geographic distance played a greater role than spawn timing influencing genetic distances for the entire drainage, albeit the effects of both variables were significant at this scale . we also found strong evidence for hierarchical structure in both nuclear and mitochondrial snps through an analysis of molecular variance ; significance of variance components was found in all three snp sets. lakes harboured the highest percentage of genetic variance , whereas subdrainage variance was similar to that found between populations within subdrainages. however, subdrainage structure became important after markedly differentiated lake clark populations were excluded. yet, between-lake genetic variance was consistently higher than subdrainage variance, even when lake clark was excluded .

*p <  <dig> , **p <  <dig> , ***p <  <dig> . †mantel tests .

an unrooted neighbour-joining tree using cavalli-sforza & edwards  <cit>  chord distances revealed that spatial structure was largely driven by marked differences between populations inhabiting distinct lakes, followed by less pronounced differences between populations within lakes ; this result was consistent with the hierarchical amova. within the alagnak subdrainage, a long branch separated nonvianuk lake from the rest of the populations; for the kvichak subdrainage, lake clark showed the longest branch indicative of strong reproductive isolation. also, a tree r <dig> =  <dig>  indicates that branch lengths explained a substantial amount of the variation present in the matrix of population distances  <cit> .

effects of ecology at fine spatial scales 
simple and partial mantel tests performed within the population-rich iliamna lake suggested that spawn timing had a higher degree of correlation with pairwise genetic distances than geographic distances, albeit only for the 'outlier 2' snp set . the effects of geography were still evident at this scale, however, despite the fact that they exhibited lower correlation values .

principal coordinate analyses  from pairwise fst within iliamna lake showed that spawning habitat explained a great extent of fine-scale clustering patterns . island beaches  comprised a genetically homogeneous group  that was markedly distinct from populations spawning in tributaries and mainland beaches. tributary spawners comprised a homogeneous cluster despite some exceptions, namely 16-chinkelyes creek , 17-copper river  and 23-iliamna river ; the latter population spawns later in the season than the majority of iliamna lake tributary populations. no significant divergence was evident between mainland-beach sites 20-finger beach and 24-knutson beach , and both appeared significantly differentiated from tributaries for 'outlier 2' with exception of 16-chinkelyes creek , but less for the other two sets .

we found a significant isolation-by-distance relationship between iliamna lake populations even if we ignored habitat differences between them, although determination coefficients were low for all three sets . these values underwent a two- to five-fold increase once we conducted separate isolation-by-distance analyses for different spawning habitats . dispersal was thus more likely to occur between tributary populations only than between tributary and island-beach populations, or between tributary and mainland-beach spawners, though only for the 'outlier 2' set .

discussion
hierarchical divergence between alaskan sockeye salmon populations: the roles of geography and ecology at varying spatial scales
our premise, that geography and ecology should hierarchically influence population divergence between kvichak river sockeye salmon populations, was largely supported by various spatial analyses using snps. simple and partial mantel tests suggested a greater role of geographic distance than differences in spawn timing for the entire drainage. the positive relationship between large-scale genetic and geographic distances was likely driven by discrete genetic differences between lakes as hierarchical amova and the neighbour-joining tree implied: the largest differentiation occurred between populations from distinct lakes followed by differences between populations within lakes. differences between the two subdrainages in the region  were prominent as well, especially after accounting for the differentiation of lake clark.

large-scale divergence between sockeye salmon populations in the kvichak river may have initially evolved from historical contingency, followed by contemporary adaptation. recolonization of lakes and subdrainages was likely sequential as ice sheets retreated after the late wisconsin glacial maximum  <cit> . the best example to illustrate this point is lake clark: glacier retreat has only occurred during the last few hundred years in some areas, such as the 13-upper tlikakila river  <cit> . lake clark sockeye salmon populations may have therefore become established only very recently. areas of difficult migratory passage on the newhalen river below lake clark and sixmile lake may have also caused bottlenecks during or after the colonization events. consistent with these findings, lake clark populations harboured the lowest estimates of snp genetic diversity in our study; moreover, an earlier survey using microsatellite dna indicated widespread presence of bottlenecked populations throughout lake clark  <cit> . differences in he and ar were also noticeable between the alagnak and kvichak subdrainages, which can be attributed to differences in both number and size of populations. for instance, sockeye salmon have historically been much more abundant in the kvichak than the alagnak systems  <cit> , though recently there has been a surge in abundance among alagnak populations  <cit> .

contemporary adaptation to distinct limnetic environments may also help explain the high fidelity of returning adults. reproductive isolation between nursery lakes is typical of lake-type sockeye salmon, which spend half of their lives rearing in freshwater before migrating to sea  <cit> . lake-type sockeye salmon are characterized by a low tendency to disperse, limiting gene flow and enhancing reproductive isolation between populations  <cit> . olfactory imprinting during juvenile stages allows lake-type adult salmon to recognize their natal sites  <cit> . in addition to homing, timing of spawning further isolate populations occupying different lakes  <cit> , although its importance may be secondary as suggested by mantel tests. for instance, lake clark populations tend to spawn during early fall, in contrast to populations from sixmile and iliamna lakes that spawn from middle to late summer, thus supporting the idea that temporal segregation reduces gene flow  <cit> .

the role of ecology  was more prominent at fine scales or for intralake patterns of divergence, with geographic distance having a significant but secondary role. this conclusion was drawn from analyses conducted within iliamna lake, a large and population-rich lake harbouring three different spawning habitats. mantel tests for one snp set  strongly suggested that variable timing of spawning, particularly among populations of the three spawning-habitat types , may be the most important barrier to dispersal between these populations. salmon populations are generally composed of early, late, and even intermediate migrants that breed asynchronously  <cit> . variable timing of reproduction between spawning-habitat types is thought to be function of historical thermal regimes at the incubation sites of the progeny  <cit> . temperatures and various other physical attributes vary substantially among tributary, mainland-beach, and island-beach habitats . island-beach populations spawn during an unusually contracted period , from early to middle august, in mild wind-circulated water. temperatures in the range  <dig> - 13°c allow embryos to hatch prior to freezing in early december; conversely, embryos hatch much later among mainland beaches and tributaries  <cit> . island-beach sockeye salmon are also younger and smaller for a given age than tributary sockeye salmon, suggestive of distinct norms of reaction between growth and maturation  <cit> . island and mainland beaches further differ in gravel size of incubation sites, which selects for larger eggs among females in island- than mainland-beach spawners  <cit> .

differences between mainland beaches and tributaries were more obvious for 'outlier 2'  than for the other two sets: 'no outliers'  suggested mild separation, whereas 'outlier 1'  indicated no clear separation. assuming mhc introns have shorter coalescent times than exons , populations from mainland beaches may have diversified only recently from tributaries, and different snp sets reflect different times since divergence. consistent with this hypothesis, mainland beach populations appeared undifferentiated from 16-chinkelyes creek, a tributary of the iliamna river, implying that habitat-driven isolation is incomplete. it is possible that populations from 16-chinkelyes creek and adjacent tributaries colonized 20-finger beach given that only ca.  <dig> km separates it from the mouth of iliamna river, where 16-chinkelyes creek drains. interestingly, 23-iliamna river also clustered more closely to mainland beaches than the majority of tributary spawners. we speculate that the four populations from the east of iliamna lake  shared a common ancestor. likely, divergent attributes of their breeding sites as well as discrete patterns of spawn timing have driven them apart over time.

overall, the fact that geography and ecology have influenced genetic divergence and structure of kvichak river sockeye salmon in a hierarchical manner has fundamental and applied implications. first, it provides a compelling mechanism for reproductive isolation at varying scales, including isolation-by-distance  <cit>  and isolation-by-time  <cit> . also, and because there is substantial phenotypic divergence between spawning ecotypes , it is possible that gene flow is maladaptive between these populations . this hypothesis is consistent with findings from another lake system that drains into bristol bay, where dispersers between beach and tributary habitats resemble phenotypically their recipient rather than their source populations  <cit> . second, it reinforces the importance of maintaining the integrity of all hierarchical levels of intraspecific biodiversity or biocomplexity  <cit> , which have evolved during thousands of years  <cit> , but are currently threatened by anthropogenic changes that have intensified during the last century  <cit> .

nonsynonymous and linked snps in the mhc class ii: evidence for adaptive divergence at the molecular level?
two snps found in one exon  and one intron  within the mhc class ii locus appeared robust to violations of demographic assumptions  and consistently appeared as outliers during genome scans. mhc class ii genes are translated on the surface of antigen-presenting b cells and macrophages and play a key role in the successful mounting of the immune response of vertebrates  <cit> . several investigations support the adaptive nature of mhc polymorphisms resulting from pathogen-mediated selection  <cit> . adaptive variation in the mhc is thus likely to affect mate choice, because parents would try to increase pathogen resistance in the offspring, avoid inbreeding, or both  <cit> . miller et al.  <cit>  concluded that balancing selection is a strong candidate to maintain the allele diversity of the mhc class ii locus in fraser river sockeye salmon , including the substitution found at one_mhc2- <dig> located in the antigen recognition site. yet, evidence for diversifying selection or neutrality of alleles could not be ruled out for some populations  <cit> .

we hypothesize that large fst estimates for mhc snps  in comparison with putatively neutral loci are consistent with signatures of diversifying selection; such force is expected to drive adaptive mutations and tightly linked sites to fixation by positive selection, hence increasing differentiation between populations  <cit> . kvichak river sockeye salmon populations may have evolved resistance or immunocompetence to specific pathogens that vary in space  <cit> . three other studies in salmonids have found signatures of diversifying selection at mhc class i and ii gene-linked markers that were also characterized by elevated estimates of population differentiation  <cit> .

even though the argument for diversifying selection seems compelling, it is based on a genome scan involving only  <dig> nuclear loci, a limitation of most genetic surveys in nonmodel organisms  <cit> . evaluating alternative hypotheses for the evolution of mhc genes among kvichak river sockeye salmon populations may be appropriate in the light of some additional findings. in particular, we found that nuclear snp sets with and without outliers were significantly correlated for the entire drainage. landry & bernatchez  <cit>  compared mhc class ii and microsatellite alleles for atlantic salmon  from central québec , and concluded that between-river differentiation was highly correlated between alleles of different marker types, whereas within-river differentiation was not. for kvichak river sockeye salmon, it is feasible that neutral evolution has played a more prominent role than selection influencing large-scale divergence. moreover, recent studies argue that the evolution of mhc variation may proceed in neutral fashion: estimates of population divergence from mhc genes appear no different from estimates using neutrally evolving microsatellite dna markers  <cit> .

could differences between snp sets found at fine spatial scales be also attributed to selection at the molecular level? within iliamna lake only, differences were evident among 'no outliers', 'outlier 1', and 'outlier 2' sets, including results from pco and mantel tests relating spawn timing and genetic distances. these differences were expected if diversifying selection affects those sets containing mhc outliers  but not the putatively neutral set . the observed dichotomy between sets containing the mhc exon  and mhc intron  was however unexpected based on the premise that diversifying selection should fix variation in tightly linked sites around the adaptive mutation; here, we have assumed that the mhc exon may have a selective advantage, whereas the mhc intron is subjected to hitchhiking selection  <cit> . we propose that differences between 'outlier 1' and 'outlier 2' may reflect varying coalescent times and thus provide distinct measures of time since population divergence. introns coalesce more rapidly than exons, because variation in the latter can be maintained by balancing selection, a mechanism that has been demonstrated in mhc exon-intron boundaries where recombination occurs  <cit> .

in summary, diversifying selection--as suggested by outlier analyses--acting on two snps found in the mhc class ii locus complex remains one possible hypothesis with support from other three studies in salmonids. however, neutral evolution of these polymorphisms and impacts of balancing selection represent alternatives that may operate at varying spatial scales. resolving between these hypotheses is beyond the scope of this investigation; we encourage further studies in sockeye salmon that address mate choice  <cit>  as well as pathogen-host interactions  <cit>  to discern between these alternatives.

CONCLUSIONS
two main conclusions emerge from this study. first, we have demonstrated that geography and ecology have hierarchically influenced genetic divergence between kvichak river sockeye salmon populations depending on the spatial scale. contrasts between lakes, subdrainages, and geographic distance dominated large-scale differentiation, whereas differences in the timing of spawning linked to discrete spawning habitat dominated fine-scale  differentiation. second, we determined signatures of selection in two snps located in the mhc class ii that appeared robust to violations of demographic assumptions. we propose that one possible mechanism that has driven the evolution of these snps is diversifying selection in response to local pathogens; however, neutral evolution of these polymorphisms at large spatial scales, as well as effects of balancing selection at fine spatial scales, cannot be ruled out at this stage. both conclusions imply that historical contingency and contemporary adaptation have driven differentiation between kvichak river sockeye salmon populations, as revealed by a suite of snps. our findings highlight the need for conservation of complex population structure, because it provides resilience in the face of environmental change, both natural and anthropogenic.

