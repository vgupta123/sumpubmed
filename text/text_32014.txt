BACKGROUND
in recent years, high-throughput rna sequencing  has become the method of choice to accurately probe the transcriptome of any biological specimens . this method quantifies the expression levels of thousands of rna transcripts within a single assay, while simultaneously allowing unbiased discovery of splicing variants  <cit> , rare and novel transcripts  <cit> , non-coding rnas , and nucleotide changes  <cit> . in discovery settings rna-seq replaced the use of microarrays  <cit>  to study human diseases  <cit>  or to identify novel drug targets , biomarkers  <cit> , and compound mechanisms of action  <cit> . more recently, rna-seq is transitioning from a discovery to a diagnostic tool with clinical utility in patient stratification, diagnosis, and individualized treatment  <cit> . however, working with human tissue specimens available from centralised biobanks, hospitals, research centres, or universities, can often result in poor quality and low yields of rna due to pre-analytical factors  that can ultimately affect gene expression analysis.

several next generation sequencing protocols are currently available for the profiling of rna samples, each with its own strengths and weaknesses. these methods use different strategies to reduce the representation of abundant ribosomal rnas  in rna-seq libraries prior to sequencing. poly + enrichment using oligo-dt coated beads is the most common approach to quantify the polyadenylated rna fraction of the transcriptome including coding mrnas. however, this method fails at profiling other rna populations  and suffers from biases when applied to low quality or low quantity rna samples . ribosomal rna depletion methods are better suited for the sequencing of rna samples with lower quality since they reduce the highly abundant ribosomal rnas from the total rna samples using capture probes and offer an attractive option for the simultaneous detection of coding and non-coding rnas  <cit> . finally, rna capture is a novel approach used to profile poor quality rna samples like those extracted from formalin-fixed, paraffin-embedded  tissue samples  <cit> ; this method uses capture probes targeting known exons to enrich for coding rnas. the “truseq” stranded mrna kit, the “ribo-zero” rrna removal kit, and the “rna access” library prep kit represent respectively implementations of the poly + enrichment, ribosome depletion and exome-capture approaches. these kits are commercial products  with standardized, reproducible and easy to implement protocol steps and therefore suitable for any research laboratories conducting gene expression studies.

numerous recent studies have compared different rna-seq library preparation protocols. some of these focused on degraded input rna  <cit> , some others on low input rna , or on general characteristics of the protocols  <cit> . for low input amounts , only protocols including a whole transcriptome amplification  step, such as nugen’s ovation or clonetech’s smarter  <cit> , have been investigated. these protocols rely on additional pcr steps that are known to introduce amplification biases in the gene expression data  <cit> . a simultaneous assessment of both low and degraded input has been so far performed only by adiconis et al.  <cit> ; however, these authors considered samples with simultaneous low and degraded input only for one protocol and a single input amount   <cit> .

despite these comparative efforts and in the light of new protocol developments, there are fundamental technical questions that remain still unanswered. for instance, how does the newly available rna access protocol perform on degraded samples? and, does it provide any advantages over ribosomal rna depletion methods? furthermore, how does the performance of these different approaches change when lowering the input rna quantity even below the recommended amounts? these questions become especially relevant in the clinical context where, for instance, processing of human biopsies often results in low amount and very heterogeneous quality rna samples.

here, we designed a study to evaluate the performance of the truseq, ribo-zero, and rna access library preparation kits on human reference rna samples from the microarray/sequencing quality control consortium   <cit>  over a wide range of total rna input amounts  and across three degradation stages . to our knowledge this is the first analysis which compares the recently commercialized rna access with the well-established truseq and ribo-zero protocols on the largest sample set of low quantity and low quality rna samples ever investigated so far. moreover, we went beyond the recommended amounts of each protocol to determine the minimum rna quantities that can still deliver accurate gene expression results. finally, we took advantage of the taqman qpcr values of about  <dig> genes available for the seqc samples to compare the three rna-seq protocols to an orthogonal gold-standard. based on our results, we provide the scientific community with a guidance on which protocol to use in relation to the quantity and quality of their rna samples.

RESULTS
to evaluate the performance of rna-seq methods in profiling non-optimal samples, we conducted a technical assessment of the three different rna library preparation protocols mentioned above, namely truseq, ribo-zero and rna access, on two human reference rna samples previously used in the maqc/seqc studies; these samples are the universal human reference rna  and the human brain reference rna   <cit> . figure 1a shows a schematic of the workflow and the different input choices considered at each step.fig.  <dig> generation of sequencing libraries and experimental design. a schematic representation of the workflow to generate the sequencing libraries. rna of the seqc samples a and b is heat degraded to obtain three distinct rna input qualities. several input amounts between 1 ng and 100 ng are selected from the degraded rna in triplicate and used for the library preparation with one of the three protocols . b overview of the combinations of degradation stage, input amount, and library preparation protocol considered in this study. a green tick indicates a combination that was sequenced, a blue cross indicates a combination for which we decided not to generate a library either because the input amount was higher than the maximum recommended input amount  or because previously published studies suggested inferior performance on degraded samples , and a red cross indicates a combination for which no library was generated because libraries with higher input amounts already performed poorly




overall we prepared a total of  <dig> sequencing libraries from  <dig> different combinations of degradation stage, input amount, and library preparation protocol each of which was applied to both samples in triplicate. figure 1b gives an overview of the conditions selected in the study. the rna libraries were sequenced on an illumina hiseq <dig> in paired-end mode to a length of 76 bp × <dig> generating a total of 3242 m reads. the sequencing depth of the different libraries ranged from ~19 m to ~95 m reads with an average of 49 m for the rna access samples, 39 m for the ribo-zero samples, and 43 m for the truseq samples. we used this comprehensive data set to benchmark the rna-seq library preparation protocols on their efficiency to generate high-quality reads and consistent alignment rates, their ability to cover full-length annotated transcripts, their specificity in profiling protein-coding and non-coding rnas, their accuracy in detecting gene expression changes by comparing them to taqman data, and their reproducibility and similarity by measuring the correlation of log fold changes within the same protocol at different input amounts and degradation levels as well as between the different protocols.

alignment statistics
we initially examined the overall alignment rates to the human genome . our results confirmed that the three library preparation protocols perform equally well on intact input rna at the amounts recommended by the manufacturer . this is indicated by the high alignment rates ranging from ~96% to ~ <dig> % for all three approaches. however, the protocols behaved differently when the input amount was reduced or the sample quality decreased. for intact rna, the alignment rate of rna access remained largely constant across all input amounts whereas we found a loss of about 3–4% aligned reads for truseq and about 10–15% aligned reads for ribo-zero with decreasing the input amounts down to 1 ng. when we considered the sample quality, the alignment results for degraded samples were comparable to the results of the intact samples for all three protocols. this is in agreement with previous studies  <cit> . however, for the highly degraded samples, the picture changed considerably. whereas with rna access only a slight decrease of 2–4% aligned reads was observed even at the lowest input amount  for seqc-a  and seqc-b  respectively, we found a substantial drop of mapped reads  at input amounts of 10 ng and 20 ng of highly degraded rna input processed with the ribo-zero kit. based on this poor performance, no further libraries were generated for lower input amounts and this degradation level with ribo-zero.fig.  <dig> bargraph of the alignment statistics for the seqc-a sample and all three protocols. each bar represents the averaged values across the three technical replicates per condition. the percentage of total aligned reads is represented by the height of the bar, and the percentage of reads aligning to exons is in red, introns in blue, and intergenic regions in green. the alignment statistics graph for the seqc-b sample can be found in additional file 1: figure s4




in addition, the protocols showed marked differences in the percent of reads aligned to exons, introns, and intergenic regions. for rna access the percentages of intronic and intergenic reads were both ~1% across all input amounts and sample quality categories, thus indicating high efficiency of the exome pull down by the capture approach. for truseq the percentage of intronic reads decreased with the sample quality from ~6% for intact samples to 2–3% for degraded samples, whereas the percentage of intergenic reads increased from ~2–3% for 100 ng input to ~6–10% for 20 ng and less. for ribo-zero the proportion of reads aligned to exons was considerably lower and dependent on the sample as previously reported . as expected with a total rna sequencing approach, we observed between half to two thirds of the reads mapping to exons while the rest mapped to mostly intronic regions  and to some extent to intergenic regions in intact and degraded samples. for highly degraded samples, the percentage of reads mapping to exons, introns, or intergenic regions was much more variable across technical replicates and input amounts; for seqc-a the percentage was similar to the intact and degraded sample qualities but for seqc-b up to 80% of the reads were mapped to intergenic regions.

all together these results indicate a consistent mapping performance of the rna access approach throughout all input amounts and degradation states, while the ribo-zero approach performed less well on highly degraded samples and at very low input amounts.

transcript coverage
we next measured the variation in 5′ to 3′ coverage along each transcript . overall we observed similar and uniform transcript coverages for rna access and ribo-zero, independent of the degradation stage of the sample. in contrast, the truseq protocol had a marked difference between intact and degraded rna, where the latter showed a strong 3′ bias; in other words, the proportion of sequences mapping to the 3′ regions of transcripts was largely increased compared to the 5′ regions. this bias is due to the 3′ oligo-dependent selection used in the poly + approach and underlines the limited use of this protocol on degraded rna or in general on samples of heterogeneous quality. in contrast, the rna access method showed a slight 5′ bias. the consistency of the coverage profiles across the different degradation stages suggests that the ribo-zero and rna access protocols are better suited for the profiling of degraded or heterogeneous rna sample populations than the standard truseq method.fig.  <dig> normalized transcript coverage plot. plot of the normalized average coverage of the  <dig> most expressed transcripts for each sample condition as created by picard




gene level comparison
we first investigated which annotated genes are detected by the three different protocols , including protein coding genes, non-coding rnas, and pseudogenes. to this purpose, we considered an arbitrary cutoff of  <dig>  fpkm to call a gene ‘expressed’. overall, rna access detected the least number of gene with an average of  <dig>  expressed genes, followed by truseq with  <dig> , and ribo-zero with  <dig> . the number of detected genes was largely independent of the input amount and the sample quality. rna access showed a minor reduction in the number of detected genes at the lowest input amount of 1 ng; similarly, ribo-zero also showed a minor reduction at lower input amounts for highly degraded samples. the overall differences were reflecting the nature of the different protocols: total rna sequencing with ribo-zero could detect the largest transcript population, truseq identified most of the polyadenylated transcripts  and rna access captured rnas that are targeted by the design of its probes. protein coding genes are clinically the most relevant and most studied category. among protein coding genes, rna access detected an average of about  <dig>  k genes which represents 97% of the  <dig>  k protein coding genes detected by ribo-zero. the number of detected genes for truseq is in between with an average of  <dig>  k. in all the other categories, the unbiased ribo-zero approach was more sensitive than the targeted protocols truseq and rna access. for example, a higher number of pseudogenes was detected with ribo-zero with an average of  <dig>  k genes over  <dig>  k for rna access and  <dig>  k for truseq; ribo-zero is by far the best protocol to profile long non-coding rnas  as reflected by the high number of detected transcripts: on average  <dig>  k lncrnas for ribo-zero,  <dig>  k for rna access and  <dig>  k for truseq. these three categories covered over 95% of all detected genes for all three protocols. for the remaining categories, ribo-zero could detect 41% and 63% more small rnas than rna access and truseq respectively, as well as an average of  <dig> miscrnas against  <dig> for truseq and  <dig> for rna access.fig.  <dig> bargraph of the number of detected genes across different protocols, degradation stages, and input amounts. the bar segments with the number of detected genes are listed by simplified ensembl “gene type” categories and the average number of detected genes per protocol is indicated by a black line. a gene is considered “expressed” if it has a fpkm value of at least  <dig>  in one of the three technical replicates of at least one of the two samples 




we further investigated the overlap of detected genes between the different protocols. due to the very heterogeneous characteristics of the different protocols on other gene categories, we focused this comparison on the protein coding genes and compared them with the recommend input amounts for intact rna . the vast majority of the protein coding genes  was detected by all three protocols, while a small percentage of protein coding genes  was specific to each protocol. in addition, the exclusive overlap between truseq and ribo-zero  was slightly larger than the exclusive overlap between rna access and truseq  or rna access and ribo-zero . when we considered degraded samples with the same input amounts, we observed a very similar distribution of the overlap of detected genes between the different protocols .fig.  <dig> venn diagram of the protein coding genes detected by each of the three protocols. venn diagram of the protein coding genes detected by each of the three protocols on intact samples at the recommended input amounts . a gene is considered “expressed” if it has a fpkm value of at least  <dig>  in one of the three technical replicates of at least one of the two samples 




comparison to taqman qpcr data
to assess the accuracy of each protocol in detecting differential expression, we used publicly available qpcr data obtained for  <dig> genes on seqc-a and seqc-b samples and generated by the maqc consortium  as a gold standard reference. to this purpose, we compared the log fold-change values of the seqc samples generated with the three rna-seq methods to the taqman log fold changes since fold changes – as opposed to the direct comparison of absolute expression values – are a crucial parameter in the analysis of differentially expressed genes. in a differential expression analysis fold changes are usually accompanied by a measure of significance, such as a p-value, to capture the biological variability. however, in this study we did not include p-values in our assessment since the seqc rna-seq data consist only of technical replicates with no biological variability.

we performed pairwise comparisons of log fold changes between the individual technical replicates and the taqman qpcr fold change values . at recommended rna input levels and on intact samples, truseq correlated better with the taqman qpcr data than the other two protocols . the concordance with qpcr fold changes decreased consistently with lower input amounts for all three protocols on intact samples. the log fold change correlation for the rna access protocol remained stable until the low input amount of 5 ng and then dropped considerably at 2 ng . a similar behaviour was observed for truseq where the log fold change correlation was high at input amounts of 100 ng and 20 ng  and then dropped to  <dig>  at 5 ng and to  <dig>  at 1 ng. instead, ribo-zero showed only a slight decrease in the correlation of log fold changes down to the lowest input amount of intact rna .fig.  <dig> boxplot of the coefficients of determination  of the rna-seq log fold change values vs taqman qpcr measurements. the boxes are coloured by protocol: red for rna access, green for ribo-zero, and blue for truseq. darker shades indicate boxes for samples to which a more severe degradation protocol was applied




the correlation profiles for degraded sample inputs were similar to the intact rna profiles . truseq had the highest agreement with taqman at the recommended input amount ; r
 <dig> values for the rna access protocol again declined sharply at inputs of 2 ng and 1 ng, while similar to intact sample inputs the r
 <dig> values for ribo-zero went down gradually with decreasing input amount, being the best performing protocol at the lowest input amount .

finally, when considering highly degraded rna input, we observed a marked difference between the rna access and the ribo-zero protocols where the latter displayed a very high variability and lower median r
 <dig> values at all tested inputs . the rna access approach, in comparison, performed much better on the highly degraded material. while the median r
 <dig> values decreased from  <dig>  for 20 ng down to  <dig>  for 5 ng and dropped further at 2 ng and 1 ng to an r
 <dig> value of  <dig> , we found much less variability among the value distribution as compared to the ribo-zero method.

overall our data suggest that all three protocols are robust and comparable on intact rna samples and down to 10 ng of input. going further down with the amounts, ribo-zero outperforms the other two protocols at 1 ng. in addition ribo-zero performs equally well on degraded rna, closely followed by the rna access method. on severely degraded samples, where the rna fragments are shorter than  <dig> nucleotides, ribo-zero reaches its limits and becomes much less reproducible. here the rna access approach represents the best choice, still generating reliable data down to 5 ng input.

agreement between protocols
to assess the similarity between the three protocols we computed the coefficients of determination  of the log fold changes of the seqc samples for every combination of protocol, sample quality, and input amount . for each condition, we first calculated the log fold changes and the corresponding r
 <dig> values of each of three technical replicates separately. we then averaged the individual r
 <dig> values of the three technical replicates to calculate the mean r
 <dig> values reported in fig.  <dig> fig.  <dig> heat map of the coefficients of determination  of the log fold change values of the pairwise comparison of all protocols. each colored box represents the coefficient of determination  between two conditions which are given by the labels on the x and y axes. the r
 <dig> value is color-coded on a scale where blue represents the lowest, grey the median, and red the highest observed value




overall we found that the similarity between samples increases with the input amount, and independently of the protocol and the sample quality. we then assessed the sample similarity within each protocol separately. for rna access the results on intact samples for 20 ng, 10 ng and 5 ng are highly similar  whereas the similarity drops significantly at 2 ng  and 1 ng . these results are similar to those observed for the correlation with the taqman qpcr data. there was almost no difference between the intact and degraded samples resulting in r
 <dig> values from  <dig>  to  <dig>   – independent of which combinations were considered; however, there was a significant drop for the highly degraded samples with r
 <dig> values ranging from  <dig>  to  <dig>  .

among ribo-zero samples the similarity values were also very high  for input amounts of at least 5 ng but the decrease in self-similarity to 2 ng  and 1 ng  was not as drastic as for rna access. again, the r
 <dig> values of the intact and degraded samples were essentially interchangeable with respect to other ribo-zero samples as well as other protocols. but for the highly degraded samples only the log fold changes of the input amount 100 ng showed some agreement with the higher input amounts  of the intact and degraded ribo-zero samples . in terms of self-similarity the achieved r
 <dig> values  were comparable to the self-similarity r
 <dig> values of the rna access protocols for input amounts that were an order of magnitude lower .

for truseq we found a very good agreement of the log fold change values for input amounts of 100 ng down to 10 ng  and then a significant drop for 5 ng and lower with self-similarity r
 <dig> values from  <dig>  down  <dig> . similar to the comparison with the taqman qpcr data, we again found an excellent agreement between the degraded and the intact samples despite the 3′ enrichment that we observed for the degraded sample.

when comparing the different protocols between each other, ribo-zero and truseq were more similar to each other than to rna access with the r
 <dig> values ranging from  <dig>  to  <dig>  for intact samples and input amounts of 10 ng and above. for the same input amounts, rna access achieved only r
 <dig> values of  <dig>  to  <dig>  with ribo-zero and  <dig>  to  <dig>  for truseq.

overall the reproducibility of the three protocols was very good even for small input amounts down to 5 ng but the gene expression values exhibited considerable protocol specific biases leading to a reduced agreement between the different protocols. in general, the expression values generated by truseq and ribo-zero were more similar to each other than they were to those from rna access.

discussion
with the substantial reduction in the cost of sequencing, rna-seq has fast become more affordable and gained popularity as major tool for research and potential clinical applications in medicine  <cit> . while many studies have demonstrated its applicability for the discovery of disease-specific markers and therapeutic targets , new efforts are underway to expand this technology into clinical practice towards the establishment of rna-seq-based clinical gene tests in regulated environments  <cit> . the wealth of valuable gene expression knowledge that can be gained with rna-seq is however critically dependent on the quality and amount of the samples employed in the study.

when planning a gene expression profiling study by rna-seq, the investigator is usually confronted with several decisions about the experimental design including the choice of the sequencing protocol. several commercial protocols can be used depending on the quantity and quality of the rna samples. in some cases, for instance when working with precious patient samples, it may be difficult to obtain enough rna amount or material of sufficient quality to meet the vendor criteria for using standard kits such as the illumina poly-based truseq stranded mrna kit  or the illumina ribo-zero rrna removal kit . if the rna quantity available for the experiment is significantly below the recommended starting amount of these kits , amplification methods like the nugen ovation or the clontech smarter can be applied to picogram amounts of the rna samples. this extra amplification, however, invariably incorporates additional biases to those normally introduced by the library construction and sequencing procedures, and hence should be avoided if possible. on the other hand, if the rna quality is low, the ribo-zero kit and the new illumina rna access kit  may represent valid options for the study but have not been comprehensively evaluated for accuracy and performance on low quantity and low quality rna thus far.

in this study, we performed a comprehensive and systematic assessment of two of the most commonly used commercial sequencing kits truseq and ribo-zero as well as the relatively new rna access kit covering a wide range of input amounts from 100 ng down to 1 ng and three sample quality stages from intact to highly-degraded. this input range is one of the most difficult to work with since the rna amount is mostly below the sample requirements of the truseq and ribo-zero protocols, but still in an area where it would be ideal to avoid rna amplification. we further aimed at understanding how the performance of these three protocols changes when the quality of the samples is not optimal or even heterogeneous across the rna sample population. a summary of the results of the protocol assessment is presented in table  <dig> table  <dig> summary of the assessment of the three protocols for different input amounts and sample degradation stages

-captures polyadenylated rnas only
+captures all rnas 
+compares well to mrna protocol
+well suited for degraded samples
-requires higher sequencing depth
+requires less sequencing depth
+suited for degraded and highlydegraded samples
-captures only preselected rnas and is only available for human samples
a +, ++, or +++ indicates that the protocol performed  well on the input, = indicates borderline performance, and a – or – – indicates an unsatisfactory performance. the symbol * is used to indicate input conditions that were not tested




as already noted in previous studies  <cit> , in the ideal situation with enough input material and good sample quality, the choice of the sequencing protocol depends largely on the questions addressed by the study. for the input amounts recommended by the manufacturer, if the focus of the analysis is mainly on protein coding genes, then truseq is the protocol of choice due to its high alignment rate against exons  and slightly better concordance with taqman qpcr data . if other rna species are also of interest, then ribo-zero is preferable as it can detect the largest transcript population capturing all coding and non-coding rnas . however, the ribo-zero protocol requires a higher sequencing depth as about 30% of the reads align against introns  and are, thus, non-informative for the quantification of gene expression. this may have a small or large impact on the cost of the sequencing experiment depending on the sample size of the study. for low quantity inputs and down to 5 ng, all three tested library preparation protocols performed similarly well on intact rna, despite being at much lower input quantities than the recommended amounts. at very low input amounts such as 1 ng and 2 ng, ribo-zero showed clear performance advantages over the other two protocols and still provides accurate gene expression change levels .

if we consider degraded samples, then according to adiconis et al.  <cit> , the best rna sequencing protocol for degraded samples was rnase h in  <dig>  this protocol is a custom solution and not necessarily suitable for all laboratories or clinical centres. the commercial illumina ribo-zero approach performed almost as well as rnase h on degraded samples in their hands. we herein confirm that the illumina ribo-zero ribosomal rna depletion kit is a robust approach that worked well on very low input amounts down to 1 ng as well as on degraded samples . however this approach did not perform well on highly degraded samples where the mean size of the library fragments is shorter than  <dig> nucleotides . these short degraded rna fragments tend to be removed during the library preparation steps, introducing a bias for accurate quantification.

the capture based approach of the rna access kit, which enriches for reads mapping to exons performed very well even on severely degraded samples and at medium to low input amounts down to 5 ng . moreover, this kit showed the most consistent mapping rates across the wide range of input amounts and quality levels tested . because of the rna exome enrichment step, this protocol requires lower sequencing depth per sample than ribo-zero to generate high-quality data in high-value content regions. it therefore represents a more cost-effective solution if the cost of the enrichment kit is distributed across a large sample set.

CONCLUSIONS
in summary, we conclude that rna access represents an attractive alternative for those studies in which the sample quality is severely compromised. for its broad application across the entire sample set, this protocol is also suited for the profiling of very heterogeneous rna sample populations covering a wider range of low quantity and extremely low quality samples thus ensuring high accuracy and comparability of the results within the study.

