BACKGROUND
the biology of the development of any multisystem life form is fundamentally grounded in systematic cellular differentiation. this is essentially defined by lineage commitment of cells whose origin can be traced to a pluripotent progenitor and is marked by mitotically heritable epigenetic changes that reflect complex transcriptional programming of gene expression within the individual cell
 <cit> . one such epigenetic mark is dna methylation, which is tightly associated with alterations in the nucleosome dna scaffold  that is responsible for coordination of gene expression in individual cells
 <cit> . it is now appreciated that differentially methylated dna regions  distinguish cell lineages with high sensitivity and specificity
 <cit>  and considerable research is now underway to delineate precise dmrs that define and specify a particular cell lineage. the most developed understanding of epigenetic markers of lineage commitment to date is perhaps that of immune cell subclasses defined by populations of distinct circulating blood cells
 <cit> .

pluripotent hematopoietic stem cells residing in the bone marrow continually give rise to the entire hierarchy of blood cell subclasses through a developmental process known as hematopoiesis. leukocytes, commonly called white blood cells, are critical in the host response to pathogens and foreign antigens and are divided into two compartments, the myeloid lineage and lymphoid lineage . the composition of leukocyte populations is well known to reflect disease states and toxicant exposures and can be altered by signaling cascades that prompt migration of whole classes of cells into or out of tissues. several dmrs that serve as reliable biomarkers of individual human white blood cell types have already been identified
 <cit> . individual assays identifying cell-specific dmrs have proven useful for quantifying individual cell types in human tissues and peripheral blood. however, these assays are limited to detecting the relative proportion of one individual cell type compared with all others. on the other hand, simultaneous quantification of fluctuation in overall lymphocyte population composition can be accomplished only by using methods based on flow cytometry, which require large volumes of fresh blood and involve laborious antibody tagging. hence, an approach that allows for the simultaneous quantification of the entire distribution of cell types, using an array of biomarkers based on generally available technology, would be considerably more informative, especially in studies of human disease and exposures.

in some instances, it is generally the overall balance of leukocyte subclasses in circulation or tissue that most prominently influences pathogenesis. for example, although incipient cancer cells are recognized and eliminated by cytotoxic t-cells  and natural killer  cells, tumorigenesis is also promoted by certain other inflammatory cells, including b-lymphocytes, mast cells, neutrophils, regulatory t-cells , and numerous others. all of these cells have been shown to promote angiogenesis, tumor cell proliferation, tissue invasion and metastasis
 <cit> . likewise, while higher levels of nk cells and ctls circulating in the blood and residing in adipose tissues are associated with lower incidence of metabolic diseases such as type ii diabetes
 <cit> , higher levels of m <dig> macrophages in adipose tissue can induce inflammation and insulin resistance
 <cit> . these examples illustrate incredible potential for methods of quantifying the composition of lymphocyte populations to critically inform the underlying immuno-biology of disease states as well as the immune response to almost all chronic medical conditions. in addition, they offer great potential for predicting therapeutic outcomes
 <cit> .

here we employ the concept of dmrs as markers of immune cell identity using a high density methylation platform, and propose a set of analytical tools for estimating the proportions of immune cells in unfractionated whole blood that does not require fresh cells. the backbone of the approach is the dna methylation signature of each of the principal immune components of whole blood . we essentially seek a form of regression calibration, where we consider a methylation signature to be a high-dimensional multivariate surrogate for the distribution of white blood cells. in turn, this distribution is of interest for predicting or modeling disease states. as a surrogate, the dna methylation signature is assumed to be a highly correlated, yet imperfect, measure of leukocyte distribution, and thus fits into the framework of measurement error models, where the use of a noisy surrogate marker to investigate an association with a disease outcome of interest results in biased estimates, unless internal or external validation data can be obtained to “calibrate” the model and correct the bias
 <cit> . however, in this case, the problem is complicated by the extremely high dimension of the surrogate, so we propose an alternative to the traditional regression-calibration procedure that circumvents these complications but still allows us to extract the desired biological information.

we note that since we began this work, a small number of authors have published similar deconvolution algorithms using gene expression data
 <cit> . the techniques are similar to the quadratic programming method we describe below in methods for deconvolving a single sample, but none comprehensively addresses statistical properties or employs data from dna methylation.

methods
in this section we describe our proposed statistical methods, the data sets used to demonstrate their utility, and finally the design of simulation studies we have conducted to investigate statistical properties of our proposed algorithms.

statistical methods
let y0h be an m ×  <dig> vector of methylation assay values, e.g. average beta values from an infinium bead-array product corresponding to a purified blood sample consisting of a homogenous cellular population , with the qualitative characterization of cell type  indicated by a d <dig> ×  <dig> covariate vector wh. here, h∈{ <dig> …,n0}, where n <dig> is the number of specimens and the m individual values correspond to cpg sites on a dna methylation microarray, possibly pre-selected to correspond to putative dmrs for distinguishing different cellular types. correspondingly, let y1i be an m ×  <dig> vector of methylation assay values for the same cpg sites  as y0h, but corresponding to a heterogeneous mixture of cells  from a human subject. here, i∈{ <dig> …,n1}, n <dig> is the number of target specimens, and z1i is a d1× <dig> covariate vector representing phenotypes or exposures corresponding to the subject, e.g. d <dig> =  <dig> for a simple case/control study without confounders. our goal is to understand the associations between y1i and z1i in terms of associations between y0h and w0h, i.e. to infer changes in mixtures of cell types associated with phenotypes or exposures, using dna methylation as a surrogate measure of cell mixture. thus, we have two data sets, s <dig> = {,…,}, the set of data from “purified” cell samples effectively representing external validation or gold-standard data, and s <dig> = {,…,}, representing surrogate data collected from a target population. to this end, we posit the following linear models: 

  y0h=b0w0h+e0hy1i=b1z1i+e1i, 

where b <dig> and b <dig> are, respectively, m × d <dig> and m × d <dig> matrices and e <dig> and e <dig> are error vectors. for simplicity we assume a one-way anova parameterization for w, though in the additional file
 <dig> we describe slight generalizations to account for design complications met in practice. we also assume a reasonable regression parameterization for z, including an intercept, and for convenience, denote the first column of b <dig> as μ <dig>  the m ×  <dig> intercept. the error vectors e <dig> and e <dig> may reflect independence among arrays h and i, or else may have more complex random effects structure accounting for technical effects or biological replication; however, their substructures are incidental to this analysis, with the exception of the fine details of the bootstrap procedure proposed below.

to implement a surrogacy relation, we propose the following linking regression model: 

  b1=1mγ0t+b0Γ+u, 

where Γ is a d <dig> × d <dig> matrix that summarizes associations between the rows of b0j and b1i and u is a matrix of errors. substituting equation  into , writing b <dig> =  explicitly in terms of its columns and writing
Γt=, it follows that 

  y1i=∑l=0d0b0l+z1i+e1i. 

to impart a biological interpretation, we assume that the dna assayed in s <dig> arises as a mixture of dna from cell types profiled in s <dig>  with mixture coefficients whose population averages, conditional on z, are
{ω <dig> …,ωd0}, so that 

  e=ξ+∑l=1d0b0lωl, 

where the m ×  <dig> vector ξ represents cell types excluded from consideration among the purified samples in s <dig>  or else non-cell-specific methylation, including alterations at the molecular level in the maintanence of dna methylation patterns themselves . it follows from  and  that the mixture coefficients are recoverable from Γ,
ωl=γltz1i, provided ξ is orthogonal to the column space of b <dig>  as we discuss in detail in the additional file
 <dig>  bias can arise if differences in ξ between distinct values of z have nonzero projection onto the column space of b <dig>  although the magnitude of anticipated biases can be assessed through sensitivity analysis.

it is possible to assign interpretations to the components of variation in . let sso represents overall variability in y1i, i.e.
sso=∑i=1n1∥y1i−μ¯1∥ <dig>  where
μ¯1=e. from multivariate probability theory it is straightforward to show that sso = sse + ssv + ssu, where
sse=∑i=1n1∥e1i∥ <dig> 
ssv=∑i=1n1tΓtb0tb0Γ, and
ssu=∑i=1n1{tutu+mtγ0γ0t}. sse measures variation unexplained by the covariates z1i, presumed to represent a combination of technical noise and unsystematic biological heterogeneity. ssv measures variability explained by mixtures of profiles in the set s <dig>  while ssu measures variability in systematic biological heterogeneity that nevertheless remains unexplained by mixtures of profiles in s <dig>  presumably due to some process other than differences in mixtures of cell types. thus we propose two partial coefficient of determination measures:
r <dig> =ssv/sso, which represents the proportion of total variation in s <dig> explained by s <dig>  and
r <dig> =ssv/, which represents the proportion of systematic variation in s <dig> explained by s <dig>  note that
r <dig>  is poorly defined when sso≈sse.

estimation procedes by applying an appropriate linear model, e.g. ordinary least squares, linear mixed effects models
 <cit> , limma
 <cit> , or surrogate variable analysis
 <cit> , to obtain estimates
b^ <dig> and
b^ <dig>  estimates of γ <dig> and Γ are then obtained by projecting
b^ <dig> onto the column space of
b~0=, as described in detail in the additional file
 <dig>  standard errors can be obtained in one of three ways. the simplest estimator, se <dig>  is the “naive” estimator from simple least-squares theory, ignoring the fact that
b^ <dig> and
b^ <dig> are estimates, i.e. potentially variable. to account for variation in estimating
b^ <dig>  a simple alternative is to use a nonparametric bootstrap procedure. for each bootstrap iteration t, we sample with replacement from s <dig>  to obtain
s <dig>  producing bootstrap estimates
b^ <dig> from which “single-bootstrap” standard errors se <dig> are computed. finally, it is possible to account for variation in estimating b0by also bootstrapping s0; because of potentially small sample sizes n <dig>  we propose using a parametric bootstrap. a“double-bootstrap” standard error estimator, se <dig>  is computed from these two sets of bootstraps. the double-bootstrap has the additional benefit over the single-bootstrap, in that it can be used to assess bias due to measurement error  in
b^ <dig>  estimation details are provided in the additional file
 <dig>  as are the results of simulation studies.

beyond bias due to measurement error, which is easily corrected using the double-bootstrap procedure, there are additional sources of potential bias. for example, consider a univariate z1i representing case/control status, where
δ≡ξ−ξ=b0α for some d <dig> ×  <dig> vector α ≠ 0; i.e. δ is the mean difference in dna methylation between a case and control, contributed by cell mixtures that remain uncharacterized or non-cell-specific methylation. in such a situation, there will be a bias equal to α in estimating the mixture differences. the additional file
 <dig> provides a detailed analysis of such biases, and proposes a sensitivity analysis procedure for assessing the magnitude of possible bias in a given data set.

while the focus of this paper is analysis of population data, it is possible to use s <dig> to predict distribution of leukocytes in a single sample having dna methylation profile y∗. equating the intercept term of b <dig> in  with y∗ and applying , we obtain mixing proportion estimates
Γ∗=−1b~0ty∗. estimates can be further refined with the use of quadratic programming techniques
 <cit> , restricting the components of Γ∗,γl∗ ≥  <dig>  in minimizing
∥y∗−b~0Γ∗∥ <dig> with respect to Γ∗. such individual projections of methylation profiles on the column space spanned by s <dig> facilitate the application of the fundamental ideas proposed above to individual, clinically-based diagnostic procedures. note, however, that dna methylation arrays are typically focused on the comparison of methylated to unmethylated cpg dinucleotides, not quantifying actual amounts of dna. therefore, information on cell mixtures from dna methylation is limited to distributions, not actual counts, as one might obtain from flow cytometry. finally, we remark that it is possible to model z1i directly as a function of mixture coefficients Γ∗ obtained individually via the constraint γl∗ ≥  <dig>  but the inferential implications are less clear, and we view the proposed approach for populations as more statistically robust.

implementation
we describe several examples using existing methylation data sets as benchmarks for validating the proposed method, in order to demonstrate its clinical or epidemiological utility. first we describe the validation data set s <dig> used in all examples. next we describe a laboratory reconstruction experiment, which validates our fundamental proposition that dna methylation retains substantial information about cell mixtures. finally we describe the results of applying our methodology to several different target data sets s <dig>  for the head and neck cancer and ovarian cancer data sets, from which bead chip data were available, a linear mixed effects model with a random intercept for bead chip was used to estimate the corresponding row of b <dig>  for the remaining data sets, no bead chip data were available; consequently, ordinary least squares was used.  <dig> bootstrap iterations were used for each example and each of the two bootstrap methods of standard error estimation.

validation data
all data analyses involve dna methylation data obtained by the infinium humanmethylation <dig> beadchip microarrays from illumina, inc. . we used a subset of m =  <dig> cpg sites on the array, selected as described below. in all of our examples, s <dig> consisted of  <dig> white blood cell samples, de-identified specimens that were not subject to human subjects review by an institutional review board . the sorted, normal, human, peripheral blood leukocyte subtypes were purchased from allcellsⓇ, llc  and were isolated from whole blood using a combination of negative and positive selection with highly specific cell surface antibodies conjugated to magnetic beads; materials and protocols were obtained from miltenyi biotec, inc. . these  <dig> samples are summarized in table
 <dig> and depicted by the clustering heatmap in figure
 <dig>  note that t lymphocytes that express cd <dig> or cd <dig> constitute over 95% of the t cell class, and that the pan-t cell type was further refined to cd4+, cd8+, and “other” pan-t cells subtypes. in summary, the covariate vector whconsisted of indicators for five cell types and another two indicators for cd4+ and cd8+ t cell subtypes. a generalization of the one-way anova parameterization assumed above for wh, described in the additional file
 <dig>  was necessary to account for the ambiguous status of some pan-t cells. for each cpg site, a linear mixed effects model with a random intercept for bead chip was used to estimate b0;  <dig> additional whole blood control samples  were used to assist in estimating chip effects, since otherwise the data set would have been sufficiently sparse to risk confounding between cell type and chip. these “array controls” were indicated with an additional term in w0h. for each cpg site, a linear mixed effects model with a random intercept for bead chip was used to estimate the corresponding row of b0and b <dig>  from s <dig>  f statistics  were computed and used to order each of the  <dig>  autosomal cpgs by decreasing level of informativeness with respect to blood cell types. as described in the additional file
 <dig>  we determined that maximum informativeness was provided by the top m =  <dig> −  <dig> cpg sites, with m >  <dig> reflecting diminishing returns from adding additional cpgs. therefore, we chose a moderately low value in this range, m =  <dig>  consistent with the size of a small custom microarray chip.

1considered as a member of the “pan-t-cell” group.

2pan-t-cell further refined as also belonging to the “cd4+” group.

3pan-t-cell further refined as also belonging to the “cd8+” group.

cell mixture experiment
proof of the utility of the proposed methods in predicting leukocyte distributions for individual samples requires extensive, detailed reconstruction experiments beyond the scope of the present paper. however, to provide evidence that such experiments are worthwhile and show promise of positive results, we conducted a simple experiment involving six known mixtures of monocytes and b cells and six known mixtures of granulocytes and t cells. the results of this experiment are described below in results.

head and neck cancer
our first target data set s <dig> consisted of arrays applied to whole blood specimens collected in a random subset of individuals involved in an ongoing population-based case-control study
 <cit>  of head and neck cancer :  <dig> cases and  <dig> age and sex matched controls. the study was approved by brown university irb, protocol # <dig>  blood was drawn at enrollment . mean age among the subjects arrayed in this study was  <dig> years, and there were  <dig> females and  <dig> males, consistent with the higher incidence of the disease in men. thus, the covariate vector zconsisted of an indicator for case/control status, an indiator for male sex, and age  centered at the mean. the clustering heatmap in figure
 <dig> depicts the raw dna methylation data in s <dig> 
yij= <dig>  black = partially methylated
yij= <dig> , blue = methylated
yij= <dig>  the annotation track above the heatmap indicates case-control status .

ovarian cancer
we next applied our method to an ovarian cancer data set
 <cit> . dna methylation data for blood samples are available from gene expression omnibus . we used only those cases having blood drawn pre-treatment. after removing  <dig> arrays with a preponderance of missing values, the data set consisted of  <dig> controls and  <dig> cases having blood drawn prior to treatment. a clustering heatmap displaying the dna methylation data appears in the additional file
 <dig>  in this analysis, zconsisted of case-control status, age , and  <dig> bisulfite conversion efficiency measures.

down syndrome
we also applied our method to a trisomy  <dig>  data set
 <cit>  consisting of  <dig> total peripheral blood leukocyte samples from down syndrome cases and  <dig> controls, as well as  <dig> t cell samples from cases and  <dig> t cell samples from controls . because of the potential for bias induced by copy number amplification, we excluded  <dig> cpg sites on chromosome  <dig>  resulting in m =  <dig> cpg sites used for analysis. a clustering heatmap displaying the dna methylation data appears in the additional file
 <dig>  in one analysis, we compared cases and controls using the total leukocyte samples only, and in another we compared total leukocytes to t cells, pooling cases and controls. the additional file
 <dig>  presents coefficient estimates.

obesity in african americans
finally, we applied our method to an obesity data set
 <cit>  consisting of  <dig> lean african-americans and  <dig> obese african-americans . a clustering heatmap displaying the dna methylation data appears in the additional file
 <dig>  in this analysis, zconsisted of obesity status.

additional analyses
if the subject population for which z =  <dig> is sufficiently homogeneous with respect to blood cell distribution to admit sensible characterization of that distribution, then it is possible to recover estimates from
Γ^. the additional file
 <dig> reports the results of such an analysis applied to the hnscc case/control data set. finally, we conducted an additional analysis where we took s <dig> to consist of only samples with pure cd4+ or cd8+ cells and s <dig> to consist only of samples having the less purified t-lymphocytes. for such s <dig>  there were no covariates, so zconsisted only of an intercept.

simulations
we conducted extensive simulation studies in order to verify the finite-sample statistical properties of our proposed methodology. simulation parameters were obtained from the hnscc data set, and most simulations assumed no sources of biological bias . in every simulation, we specified s <dig> to consist of  <dig> b-cell samples,  <dig> granulocyte samples,  <dig> monocyte samples,  <dig> nk samples,  <dig> general “pan-t” t-cell samples,  <dig> specific cd4+ t cell samples, and  <dig> specific cd8+ t cell samples. estimates from the external validation set s <dig>  described above, were used for mean methylation profiles among wbc types, using the m =  <dig> most informative cpg sites.

we specified n1/ <dig> cases and n0/ <dig> controls, n0∈{ <dig> ,500}. among the controls, methylation profiles were generated by a white blood cell population of 7% b-cells, 62% granulocytes, 6% monocytes, 2% nk cells, and 13% were t-cells, of which 65% were cd4+ cells and 35% were cd8+ cells, and the remaining 5% were unspecified . among cases, we specified one of the following scenarios: a 4% reduction in cd4+ cells, a 2% reduction in cd8+ cells, and an 8% increase in granulocytes ; a 6% reduction in cd4+ cells, and an 8% increase in granulocytes ; a weaker alternative with half the effects of strong alternative i ; and two null scenarios with no changes in cell population, each with a different assumption about δ. note that these changes reflect absolute changes in percentage points, not relative changes. note also that these values were actually used to generate dirichlet-distributed mixture weights for each simulated subject, with dirichlet parameters equal to a precision parameter  times the mean weight described above. residual effects
ξi for controls were set equal to  <dig>  times estimated intercept estimate
μ^ <dig> obtained from the hnscc data set, while residual effects
ξi for cases were set equal to  <dig>  or  <dig>  times
μ^ <dig> plus multiples 10θ of the column of
u^ corresponding to case. the constants of proportionality  <dig> ,  <dig> , and  <dig>  were chosen to correspond to assumed contributions of ξ to an overall methylation signature presumed to be dominated by profiled populations of white blood cells in specified proportions, with  <dig>  used for the strong alternatives and  <dig>  used for the mixed alternative. the constant  <dig> was used to amplify the scale of δ so that its effect could be detected in simulation; note that
u^ was orthogonal to the white blood cell profiles, by construction. the multiplier θ =  <dig> was used for strong alternatives, and the “strong null” case  while θ =  <dig>  was used for the mixed alternative, and θ =  <dig> was used for the “mixed null” with case/control differences not mediated by cellular population differences. a simple normal error structure for e0h and e0i was specified, with no chip effects, but with variance equal to the sum of chip and residual variance estimated  for the hnscc data. for each simulation,  <dig> bootstraps were used to estimate standard errors.  <dig> simulations were run for each scenario.

RESULTS
in this section we report the results of the data analyses described above in implementation, as well as the results of our simulation experiments.

cell mixture experiment
as figure
 <dig> suggests, accuracy is within 10%, and often less than 5%, with the largest errors occuring for granulocytes, as shown in table
 <dig>  note that the sum of the individual observed predictions for each individual profile ranged from  <dig> % to  <dig> % , even though the constraints of the projection do not explicitly constrain the sum to 100%; this provides additional evidence that the dna methylation profile captures a great deal of information about cell mixtures.

*|observed%−expected%|.

head and neck cancer
table
 <dig> presents coefficient estimates
Γ^ for case status, double-bootstrap bias estimates , as well as naive, single-bootstrap, and double-bootstrap standard error estimates. each of these quantities is measured in percentage points . estimates of bias arising from measurement error  were almost always less than half a percentage point, and for significant coefficient estimates, always towards the null. the proportion of cd4+ t-lymphocytes decreased in cases compared with controls, with a bias-corrected estimate of − <dig>  percentage points and approximate 95% confidence interval ; the proportion of nk cells decreased, with a bias-corrected estimate of - <dig>  percentage points and 95% confidence interval ; and the proportion of granulocytes increased, with a bias-corrected estimate of  <dig>  percentage points and 95% confidence interval . there was also somewhat weaker evidence of an increase in cd8+ t-lymphocytes, with an estimate of  <dig>  percentage points and 95% confidence interval . as reported in the complete set of results appearing in the additional file
 <dig>  the proportion of cd4+ t-lymphocytes decreased by  <dig>  percentage points  per decade of age, while cd8+ t-lymphocytes increased by  <dig>  percentage point  per decade. all other coefficients were insignificant.

for this analysis,
r <dig>  was estimated at  <dig> %, while
r <dig>  was estimated at  <dig> %. thus, a small but non-negligible proportion of total variation  appeared to be driven by changes in cell population between cases and controls and as a result of aging. note that sse comprised 85% of total variation, so a substantial portion of variability in dna methylation appeared to remain unexplained . however, almost all of the systematic variation appeared to be explained by changes in cell population.

these results were consistent with previous studies, as hnscc patients are known to display an absolute and relative increase in myeloid derived granulocytes
 <cit>  while also displaying an alteration in lymphoid t-cell homeostasis that leads to decreases in cd4+ t-cells
 <cit> . in addition, the proportion of treg cells  is known to decrease from infancy to adulthood
 <cit> .

the bias estimates obtained from the double-bootstrap procedure allow the correction of bias arising from measurement error. however, there is no statistical procedure for correcting the other possible sources of bias, those arising from changes in distribution among unprofiled cell types as well as non-immune-mediated methylation differences. the additional file
 <dig> presents a detailed sensitivity analysis, from which we show that the magnitude of the resulting bias is likely to be small, less than a percentage point.

ovarian cancer
table
 <dig> presents results for case-control status, with the remaining results appearing in the additional file
 <dig> 
r <dig>  was estimated at  <dig> %, while
r <dig>  was estimated at  <dig> %.

est = regression coefficient estimate .

bias <dig> = double-bootstrap bias estimate .

se <dig> = naive standard error .

se <dig> = single-bootstrap standard error .

se <dig> = double-bootstrap standard error .

p-values were computed using se <dig> 

est = regression coefficient estimate .

bias <dig> = double-bootstrap bias estimate .

se <dig> = naive standard error .

se <dig> = single-bootstrap standard error .

se <dig> = double-bootstrap standard error .

p-values were computed using se <dig> 

compared with controls, cases showed significant increases in granulocytes and significant decreases in b cells, nk cells, and cd4+ t cells. cases also showed marginally significant increases in monocytes. these results are consistent with previous literature, where it has been demonstrated that ovarian cancer patients experience decreases in b and t lymphocytes
 <cit> , increases in monocytes
 <cit>  and  increases in eosinophil granulocytes
 <cit> . additionally, there were significant systematic decreases in cd4+ t cells with increasing age, with a gradient consistent in direction and somewhat consistent in magnitude with the corresponding effect found in the hnscc data set. though most of the cd8+ t cell coefficients for age were not significant, they were all positive, with gradient consistent in direction and somewhat consistent in magnitude with the corresponding effect found in the hnscc data set. as reported in the additional file
 <dig>  no bisulfite conversion coefficient was significant, and all coefficients were of small magnitude .

down syndrome
the only significant difference between cases and controls was in b cell distribution, with bias-corrected estimated decrease of  <dig> %, 95% confidence interval . this result is consistent with known immune characteristics of down syndrome, including deficiencies in both b and t cells
 <cit> . however, in the comparison between total leukocytes and t cells, all coefficients except b cell and nk were highly significant, in directions consistent with comparison of a sample of purified t cells to a generic whole blood sample. in fact, an estimate of the cellular composition of the t cell samples can be obtained by a simple linear transformation of Γ estimates ; this operation produces values that are not significantly distinct from zero for all cell types except cd4+ and cd8+, whose bias-corrected estimates were, respectively,  <dig> %, 95% confidence interval  and  <dig> %, 95% confidence interval , consistent with the known distribution of these t cells. for the analysis of case vs. control within total leukocytes,
r <dig>  was estimated at  <dig> %, while
r <dig>  was estimated at  <dig> %. for the analysis of total leukocyte vs. t cell with pooled cases and controls,
r <dig>  was estimated at  <dig> %, while
r <dig>  was estimated at  <dig> %. the latter set of coefficients of determination indicate that a substantial portion of variation is explained by composition of leukocytes, which is the expected result for such an analysis.

obesity in african americans
obese subjects had an estimated increase of  <dig> percentage points in granulocytes, bias-corrected 95% confidence interval  and an estimated decrease of  <dig> percentage points in nk cells, bias-corrected 95% confidence interval . no significant differences were found for other blood cell types. note that the specific immunological differences estimated by the method are consistent with known immunological perturbations associated with type ii diabetes
 <cit> . complete results are provided in the additional file
 <dig> 

additional analyses
we obtained the following unnormalized bias-corrected estimates:  <dig> % cd4+, 95% ci , and  <dig> % cd8+, 95%ci . this is consistent with known proportions of these specific cell types among t lymphocytes.

results of simulations
table
 <dig> presents results for n <dig> =  <dig> with precise mixture weights , while table
 <dig> presents results for n <dig> =  <dig> with noisy mixture weights . the tables show mean estimate, simulation standard deviation, median estimates for the three types of proposed standard errors, and proportion of p-values  falling below α =  <dig>  and α =  <dig> . in all cases, the bias in estimation was negligible. both bootstrap procedures produced similar standard error estimates, which were close to the simulation standard deviation but often quite different from the naive standard error estimate. under null scenarios, the rejection probabilities were tolerably close to their nominal values, and for alternatives, power could be quite high, even with this modest design. results for the coefficients of determination are provided in the additional file
 <dig>  scenarios with n1∈{ <dig> } produced similar results, with simulation standard deviations and power adjusted accordingly, but still having practical utility.

est = men regression coefficient estimate ; sd = sd regression coefficient estimate .

se <dig> = naive standard error ; se <dig> = single-bootstrap standard error .

se <dig> = double-bootstrap standard error .

pow = pr{p <dig> < α}, where p <dig> is the p-value computed from se <dig> 

est = mean regression coefficient estimate ; sd = sd regression coefficient estimate .

se <dig> = naive standard error ; se <dig> = single-bootstrap standard error .

se <dig> = double-bootstrap standard error .

pow = pr{p <dig> < α}, where p <dig> is the p-value computed from se <dig> 

discussion
in this paper, we employ the concept of dmrs as markers of immune cell identity using a high density methylation platform, and propose a set of analytical tools for estimating the proportions of immune cells in unfractionated whole blood. the backbone of the approach is the dna methylation signature of each of the principal immune components of whole blood . the examples we have provided above serve to illustrate that our proposed methodology produces parameter estimates consistent with the literature, thus validating its utility.

our proposed method resembles regression calibration, where we consider a methylation signature to be a high-dimensional multivariate surrogate for the distribution of white blood cells. in turn, this distribution is of interest for predicting or modeling disease states. as a surrogate, the dna methylation signature is assumed to be a highly correlated, yet imperfect, measure of leukocyte distribution, and thus fits into the framework of measurement error models, where the use of a noisy surrogate marker to investigate an association with a disease outcome of interest results in biased estimates, unless internal or external validation data can be obtained to “calibrate” the model and correct the bias
 <cit> . however, in this case, the problem is complicated by the extremely high dimension of the surrogate. measurement error problems are typically formulated as a set of relationships between z, the disease outcome , ω, the gold standard , and y, the surrogate . of interest is e, which may be difficult to estimate due to the cost or logistical complications involved in obtaining ω in a large number of samples. typically, it is possible to collect sufficient data for modeling e, which provides information about e through the  association e, which is inferred from an external validation sample
 <cit> . unfortunately, the high-dimensional nature of y renders e difficult to formulate. while multivariate methods of measurement error correction exist, even in a high-dimensional context
 <cit> , they require an explicit specification of e, requiring a large number of parameters even for a main effects regression model, and many more in order to account for interactions. this becomes unwieldy when each component of y contributes a small amount of information about z, and both dimension-reduction strategies and constrained regression strategies entail substantial loss of information and may be extremely computationally intensive. existing measurement error formulations
 <cit>  would have required us to specify a logistic regression model for case/control status, conditional on dna methylation signature, a computationally difficult task that would have extreme vulnerability to model mis-specification. on the other hand, our method requires specification of e, which is natural and straightforward. note that in some treatments of regression calibration, e is used as a surrogate for ω in regression models for z <cit> ; our treatment essentially assumes a linear form for e and effectively obtains e by projecting y onto the column space of resulting matrix. we note that it is possible using existing methods to qualitatively describe immune response contributions to dna methylation. this is typically done by conducting a pathway analysis along the lines of one of the methods described in
 <cit> , the best option of which is gene set enrichment analysis 
 <cit> . for example, teschendorff et al. 
 <cit>  use gsea to qualitatively motivate an immunological explanation. however, these methods do not directly quantify the immunological contribution.

an important consideration in the measurement error literature is that of transportability of model parameters
 <cit> . in our setting, an important consideration is whether the methylation profiles obtained from the purified blood cells used to assemble s <dig> would be representative of the white blood cells measured within s <dig>  because of the biological assumptions inherent in the dmr literature and underlying current understanding of hematopoeisis and lineage commitment, this assumption is reasonable, provided our method is used to detect abnormal mixtures of normal white blood cells. however, methylation abnormalities in the white blood cells themselves constitute a form of non-cell mediated alteration , and contribute to bias in our methods, as described briefly above and in detail in the additional file
 <dig> 

note that our formulation respects the study design . an alternative strategy outside the measurement error literature but within the larger missing-data literature might have been the use of an expectation-maximization  algorithm to integrate over the missing data ω <cit> . however, by design, the distribution of ω varied substantially between the data sets s <dig> and s <dig>  severely complicating the approach; notably, an would be the introduction of feedback from s <dig> to s <dig>  contaminating the gold-standard status of s <dig>  an alternative, might be the use of an empirical bayes procedure, reminiscent of existing mixture-model approaches
 <cit> . however, difficulty in specifying the distribution of “remainder terms”  render this approach untenable, and in simulations , attempts to impute ωamong s <dig> samples using parameters obtained from s <dig> samples resulted in extremely biased estimates of ω.

the most significant aspect of the current study is our development of a method for inferring changes in the distribution of white blood cell types between different human populations  using dna methylation signatures; an approach guided by an external validation set consisting of methylation profiles from purified white blood cell components. dna methylation in peripheral blood is a potentially powerful new biomarker for clinical and epidemiological investigation. by example, numerous studies have now attempted to distinguish cancer cases from controls using whole peripheral blood assayed via dna methylation arrays, including ovarian
 <cit> , bladder
 <cit> , and pancreatic
 <cit>  cancers. while these studies have demonstrated good to excellent discrimination of cases from controls, sound evidence for a biological mechanism has been elusive. presumably, disease associated alterations in blood methylation have several etiological components driven by inherent genetic, environmental and disease specific factors. given the known developmental associated differences in dna methylation among specific blood cell types, changes in the distributions of blood cell types alone could account for disease associated dna methylation. while numerous authors provide a qualitative discussion that includes the possibility of immune-related dna methylation differences , none to date has specifically quantified the contribution from immune response. on the other hand, the many diverse types of immune cells in blood make this issue highly complex and problematic to tackle using single cell type assays. therefore, it is crucial to the development of this new avenue of biomarker research to delineate effects due to the immune cell distribution itself from other “non cell type” alterations in dna methylation. we term the differences among human populations attributed to cell distributions to be “immunologically mediated”. our solution to partition this component of variation in methylation from other determinants are multivariate analytic tools including regression coefficients and associated inference, as well as coefficients of determination measures. taken together these provide a means for evaluating whether the observed dna methylation differences are due to an immunologically mediated response.

in our additional file
 <dig> we provide a detailed analysis of potential sources of bias in our analysis. one obvious biological source of bias is age of the subjects contributing cells for validation. at certain cpg loci, dna methylation is known to change with age
 <cit> , especially in t cells
 <cit> . in the additional file
 <dig> we demonstrate that any age-related associations with dna methylation in our top  <dig> cpgs were too weak to be detected with the current validation sample, and thus unlikely to bias the results of our analyses . however, we remark that with larger sample sizes, adjustments for age can be incorporated with an appropriate additional term in the linear model  for y0h.

similar methods based on mrna have been employed
 <cit> . the statistical principles described in this article would apply, wholesale, to mrna expression profiles, but with two cautionary statements. the first is mathematical: mrna is typically analyzed on a logarithmic scale, yet the assumptions of the proposed methodology involve linearity on an arithmetic scale, since the mixing coefficients are assumed to act linearly on absolute numbers of nucleic acid molecules; thus, the proposed methods would require analysis of untransformed fluorescence intensities, whose skewed distributions would result in numerical instabilities. the second is biological: there is no necessarily linear relationship between cell number and mrna copies, since proteins may be translated as a consequence of an initial burst of mrna transcription upon cellular development, after which significant mrna degradation is possible. in contrast, one would expect the average beta value provided by illumina bead-array products  to scale in proportion to the actual fraction of methylated nucleic acids; in addition, an assumption of two dna molecules per cell seems biologically reasonable. in the additional file
 <dig> we provide an example of an application of our methods using mrna data.

going forward there are two issues that require further experimental and analytical refinement. first, although the current studies suggest group level comparisons of blood cell dna methylation can reveal important immune alterations, it will be important to provide methods for individual level immune cell profiling, since clinical and detailed analytical epidemiologic applications that examine individual risk factor information will be the subject of future studies. as we have demonstrated above, individual immune profiles are theoretically achievable but will require extensive validation, with a wide array of mixture combinations, before gaining widespread acceptance. secondly, there is intense interest in minor immune cell fractions and their role in disease, though the signal strength of cell types comprising < 5% of the total white cell compartment may be difficult to quantitate. examples of such cell types include the regulatory t-cell or nk cell fractions, which are implicated in autoimmune and malignant diseases. optimization of platforms for technical sensitivity to minor subtypes combined with statistical optimization of signature recognition are needed to enhance the approach for testing highly targeted immune hypotheses.

CONCLUSIONS
the method we present here has potentially far reaching implications for rapid, simple and complete assessment of the composition of human white blood cell populations, i.e. the immune profile. currently, assessment of the cellular composition of peripheral blood cannot be accomplished without the use of freshly drawn venous blood that is immediately prepared in a specially equipped laboratory. a complete assessment of the entire immune profile requires extensive flow cytometric measurements based on protein epitopes on leukocyte membranes that distinguishes subtypes of immune cells that are either too rare or too similar in appearance to be distinguished using simple microscopic approaches. in particular, flow cytometry is limited by the following:  cells must be separated, requiring large volumes of fresh cells;  detection can be accomplished only by the fluorescent antibody tags available, which require expensive technology to read;  the outer cell membrane must be intact, mandating limited utility in many instances . in contrast, our method requires the application of these labor-intensive or expensive steps only in the construction of the validation set s <dig>  which need only be developed once. once s <dig> is available, subsequent interrogation is based on the chemically stable cpg methylation of dna; thus our method obviates the need for fresh blood and the preservation of labile protein epitopes. it is also able to simultaneously assess all of the individual components of the peripheral blood using a highly multiplexed molecular platform and is thus very straightforward logistically. furthermore, the statistical methodology presented here can be implemented easily with the instrumental output of the methylation arrays, which simplifies the interpretation of the immune profile data from the operators point of view. this method can be immediately deployed in a research framework to cost effectively assess human immune profiles , exploring their potential as biomarkers, and addressing key questions regarding disease pathogenesis. furthermore, our approach is readily suited for rapid translation to a broad base of clinical applications such as disease monitoring, diagnosis, prognosis, and response to therapy.

our approach makes research on biobanked specimens possible, now making a vast array of prospective studies that could not otherwise be done, possible. software and sample data are provided in additional file
 <dig> 

abbreviations
ctl: cytotoxic t-cells; cpg: cytosine-phosphate-guanine; dmr, differentially methylated region; hnscc: head and neck squamous cell carcinoma; nk: matural killer.

competing interests
a patent is pending on the work contained in this article. the authors have no other competing interests.

authors’ contributions
eah conceived of the statistical model, developed the algorithms, conducted the simulations, applied the methods to proprietary and publicly available data sets and authored major parts of the manuscript. wpa conducted the laboratory experiments and authored parts of the manuscript. jkw and ktk conceived of the laboratory experiments and provided grant support for the research. dck provided indispensible feedback on statistical methodology. bcc, cjm, and hhn provided indispensible feedback on scientific issues and interpretation. all authors read and approved the final manuscript.

supplementary material
additional file 1
houseman-wbc-bmcbioinformatics- supplement.pdf. additional theoretical details, simulation descriptions and results, and additional figures and result tables
 <cit> .

click here for file

 additional file 2
houseman-wbc-bmcbioinformatics-software-v <dig>  sample r software .

click here for file

 acknowledgements
this work was funded by nih grants ca <dig>  ca <dig>  ca <dig>  and ca <dig> 
