BACKGROUND
dynamic models in systems biology as well as in other fields become increasingly complex as more detailed knowledge is incorporated. the massive presence of nonlinear relationships between their high-dimensional parameter- and solution- spaces is a key characteristic of such systems. moreover, dynamic models typically generate multidimensional blocks of temporal data. clearly it is very challenging to obtain a comprehensive overview of the behavioural repertoires of such models across the high-dimensional input parameter space, including the sensitivity of the model output to changes in the various input parameters, as well as interactions between input parameters and correlation patterns between model outputs. for dynamic model construction and validation, sound handling of such information is crucial. since most of the existing methods for parameter estimation and sensitivity analysis are appropriate only for systems of relatively low output dimensionality and typically focus on one output variable at a time  <dig>  a generic methodology for analysis of model behaviour that is able to handle the entire range of model complexities and give a comprehensive overview of the relationships between the input parameters and all model outputs, is sorely needed.

statistical approaches are gaining acceptance as a means for analysis of input-output relationships of complex dynamic models  <dig>  and statistical emulation of dynamic models  has been demonstrated to be a useful tool both for speeding up computations  <dig> and as a basis for sensitivity analysis  <dig> and uncertainty assessment  <dig>  multi-way  methods have previously been shown to be effective for data integration in e.g. systems biology  <dig>  we therefore hypothesise that n-way approaches will be especially advantageous for metamodelling of dynamic models due to the capability of integrating temporal data from several output state variables simultaneously while retaining the information about which state trajectory that corresponds to which state variable throughout the analysis . consequently, a more detailed exploration of the temporal dimension of dynamic models is possible. this is important in order to obtain a comprehensive overview of how variation in the input parameters is manifested in the model output. moreover, methods utilising several model outputs simultaneously have already been demonstrated to reduce the model sloppiness by imposing more constraints on the system  <dig> 

the n-way hierarchical cluster-based partial least squares regression  presented here is designed for efficient handling of block-wise nonlinear data structures, and works by combining several regional n-way partial least squares regression   <dig> models within which the mappings between input parameters and output state variables can be more adequately represented than in a global nplsr model. the nonlinear capabilities of this metamodelling approach are obtained by combining clustering and generation of local linear metamodels for the various cluster regions. this is an n-way extension of our previously published method hierarchical cluster-based partial least squares regression   <dig>  hc-plsr is based on separate  plsr  <dig> analyses of distinct regions of the parameter space , while in n-way hc-plsr, the separated regions are defined according to the dynamic behaviour of the output state variables and the output from the dynamic model is represented as an n-way array ). a common metamodel based on all state variable trajectories can thereby be generated. this allows simultaneous analysis of nonlinear relationships between all model outputs and input parameters of complex dynamic models, in a low-dimensional subspace spanned by estimated latent variables . the nplsr factors represent the features that are most important for the covariance between the inputs and outputs . the method is therefore suited for visualising covariance structures both within and between the input parameters and the model outputs, and thereby also useful for finding and removing possible redundancies  and prioritizing experiments for e.g. model validation by identification of key inputs and outputs describing the system behaviour. hence, this can also guide experimentalists in the choice of quantities to measure when studying a biological system. moreover, the nplsr approach provides considerable dimension reduction possibilities through projection of the data into a low-dimensional subspace. in our opinion, this methodology should be considered as particularly useful in future multivariate metamodelling for analysis of complex spatiotemporal models. in n-way metamodelling, the three spatial dimensions can be included as separate modes in the n-way analysis, in addition to the temporal dimension on which we focus in this paper. the spatial structure of the data can thereby be kept throughout the analysis. we hypothesise that this will be a great advantage in the analysis of spatiotemporal models.

traditionally, metamodelling is carried out in the causal direction, predicting model outputs as functions of the input parameters using e.g. regression methods. application of metamodelling in the reverse direction is, however, also of potential interest  <dig>  the two modelling directions can be understood as extensions of the classical/inverse calibration modelling  <dig>  accordingly, we refer to the causal direction as classical metamodelling, and the reverse direction as inverse metamodelling, and in our application of the n-way hc-plsr we demonstrate how their combination provides more detailed insight into the complexity of the mapping between input parameters and model outputs. inverse metamodelling may also facilitate fitting of nonlinear models to large amounts of experimental data. given that the results from the computations can be substituted with relevant experimentally measured data or quantities calculated from measurements, these can be used to predict corresponding parameters. moreover, combinations of classical and inverse metamodelling can identify the key metrics to measure in order to validate the models. a more comprehensive introduction to the multivariate metamodelling methodology is given in additional file 1: section s <dig> 

as long as they handle high-dimensional data with nonlinear relationships and yield interpretable representations, a wide variety of statistical methods can be effectively used for multivariate metamodelling. we have recently shown that multivariate metamodelling based on plsr and our nonlinear extension hc-plsr  <dig> provides good approximations of the input-output mappings  <dig> as well as informative insight into complex interaction patterns between parameters  <dig> of advanced nonlinear dynamic models. plsr can use multiple response variables simultaneously and utilise inter-correlations between them for model stabilisation. plsr analysis has been shown to effectively reveal covariation patterns in large and complex data sets, and extract correlations between possibly noisy and partially redundant input variables and outputs  <dig>  the success of plsr in the context of sensitivity analysis and for constraining input parameter values from dynamic model outputs has also been demonstrated by sobie et al.  <dig>  highly nonlinear input-output structures may, however, be difficult to model adequately with linear models such as plsr, even with polynomial extensions. to confront these problems, hc-plsr was introduced  <dig>  heterogeneity in model sensitivity to certain parameters between various regions in the parameter space of a dynamic model of the mouse ventricular myocyte was identified by hc-plsr-based sensitivity analysis in  <dig>  similarly, zooming into different regions of the state variable behavioural domain provides the opportunity to identify regions where the relationship between certain parameters and the model output is less ambiguous, indicating that these parameters are especially important for defining a specific type of temporal model behaviour. in cases where variation in the input parameters can be directly related to genotypic variations, this may provide valuable information about how a specific genotype can be of particular importance for the manifestation of certain phenotypic characteristics.

here, we combine three different aspects of multivariate metamodelling: 1) description of highly nonlinear input-output relationships by regional metamodelling, 2) nplsr, allowing a retention of a tensor data structure throughout the analysis and 3) inverse metamodelling in addition to the classical approach, providing more confident conclusions and a more comprehensive model overview. moreover, particularly complex details are pursued by more detailed metamodelling of individual outputs and their relationships to the varied input parameters. altogether, this provides a powerful, robust and efficient approach to exploration of the behavioural repertoire of complex dynamic models.

we illustrate our methodology by an application to a complex dynamic model of the mammalian circadian clock developed by leloup and goldbeter  <dig>  which is a well-established and validated model. models of circadian rhythms have e.g. been used for identifying mechanisms of chronotolerance and chronoefficacy for anticancer drugs  <dig>  the dynamic model we analyse describes circadian oscillations of cellular activity in conditions of continuous darkness, and consists of  <dig> coupled ordinary differential equations  describing the dynamics of three genes through intertwined positive and negative feedback loops. by combining the classical and inverse approaches of the n-way hc-plsr, we capture several interesting parts of the present complex input-output relationships, which are difficult to deduce directly from the model’s differential equations.

RESULTS
in silico data set
the analysed mammalian circadian clock model consisted of  <dig> linear and nonlinear odes coupled together through numerous feedback mechanisms. to analyse the behaviour of this complex nonlinear dynamic model, nine of the model input parameters were systematically varied at eight equally spaced levels each in an optimised multi-level binary replacement  design  <dig>  using the ranges given in table  <dig>  this resulted in  <dig> simulations with the circadian clock model,  <dig> % of which  converged to a stable limit cycle. the results of these  <dig> simulations, represented as a 3-way array of  <dig> observations x  <dig> state variables  x  <dig> time points in each trajectory, were related to the matrix of input parameter combinations  in the metamodelling study described below.

a separate test set based on  <dig> parameter combinations found by random monte carlo sampling  <dig> within the same parameter levels as used in the calibration set was also generated, resulting in  <dig> converging simulations.

results from the n-way hc-plsr metamodelling of the mammalian circadian clock model
a combined classical  and inverse  metamodelling with n-way hc-plsr was carried out, in order to assess the complex input-output map of the mammalian circadian clock model. the developed methodology is illustrated in figure  <dig> and described in more detail in the methods section and in additional file 1: section s <dig>  the n-way hc-plsr metamodels each contain both a global nplsr model, and several regional nplsr models calibrated within clusters corresponding to different model behaviour. here we present the results from the global nplsr metamodelling first, and the additional insights provided through the regional metamodelling thereafter. the statistics of the global metamodels can be found in additional file 1: section s <dig> 

the low percentage explained y-variance  showed that the global metamodelling was inadequate in both the classical and inverse direction. however, before proceeding to improved, regional metamodelling, the dominating relationships and patterns between the  <dig> input parameters and the  <dig> output state trajectories of the mammalian circadian clock model were assessed using the global approximations.

input-output map characteristics revealed by the global classical and inverse metamodels
the dominating input-output covariation patterns
in nplsr, like in other subspace regression methods, the high-dimensional data is projected into a low-dimensional subspace spanned by estimated latent variables that represent the most relevant patterns of input -output  covariation . the couplings between the original variables and the latent variables are called loadings. the global relationship patterns between the  <dig> varied mammalian circadian clock parameters  and the  <dig> state variables  were assessed through plots of the first three global second mode nplsr loadings for the output state variables and the input parameters . variables placed close to each other in the loading plots are positively correlated, while variables placed opposite each other are negatively correlated in the nplsr factor space.

the  <dig> state variables correspond to the  <dig> odes in the mammalian circadian clock model.

within the parameter space analysed here, the parameters vmb , vmc  and vmp  had the highest correlation to the circadian clock state variables along the first three global nplsr factors, both in the inverse  and classical  metamodelling. the same over-all covariation patterns could be seen both in the inverse and the classical global metamodelling, since the orthogonal design in the parameters used in the global metamodelling has no dominant covariance directions, and both the inverse and classical nplsr metamodels will consequently be dominated by the covariance structures of the state variables . the input parameter vmb were e.g. negatively correlated with the state variables bc, bn, bnp and bcp in the nplsr factor space, which was not surprising since these state variables represent the dynamics of the phosphorylated and non-phosphorylated protein bmal <dig> concentrations in the cytosol and nucleus  <dig>  similarly, vmp was negatively correlated with the state variables mp  and pcp , while vmc was negatively correlated with mc  and pccp . these patterns were all in concordance with our intuition of the mammalian circadian clock model.

prediction results from the global inverse metamodelling
the test set prediction results from the inverse metamodelling shown in figure 4a, indicated that the input parameters vmb, vmc, vmp and k <dig>  were predicted with reasonably high accuracy -values higher than  <dig> ) from the circadian clock state trajectories, indicating that the circadian clock model was highly sensitive to changes in these input parameters and that the relationship between these parameters and the model output was quite linear. for the input parameters vdpcn, vdin, k <dig>  k <dig> and k <dig>  the prediction error was high using global nplsr metamodelling.

prediction results from the global classical metamodelling
the results from the test set prediction of the state variable trajectories from the input parameters in the classical metamodelling shown in figure 4b, indicated that the temporal behaviour of the following state variables could be predicted with high accuracy from the input parameters using global nplsr: bn, mc, mb, bc, bcp and bnp, while the prediction error was especially high for the state variables pc, pcc, cc, pcn, pcnp and in.

analogous to the results from the inverse metamodelling described above, the matrix plot of the global nplsr-estimated sensitivities  of the model output state variables to the nine varied parameters in figure  <dig> indicated that the circadian clock model was only sensitive to the input parameters vmb, vmc, vmp and k <dig>  however, the predictive ability obtained with the global metamodelling was not adequate, and important patterns of variation were therefore left un-described. hence, the parameter-state variable map of the circadian clock model was relatively complex and nonlinear. since the analysed model was deterministic, we assumed that a higher number of state trajectories would be predicted with high accuracy from the input parameters using a nonlinear metamodel. we therefore hypothesised that hierarchical cluster-based metamodelling would reveal more details of the input-output relationship of the mammalian circadian clock model through regional metamodelling.

separately analysed output space regions in the hierarchical cluster-based metamodelling
to facilitate comparison, it was decided to use the same grouping  of the observations in both classical and inverse metamodelling. the state variable nplsr x-factors from the inverse metamodelling were more directly related to the state variable behaviour than the y-factors representing the state variables in the classical metamodelling due to the asymmetric nature of the nplsr models . the inverse metamodelling was therefore carried out first, i.e. the clustering of the  <dig> calibration set observations was carried out on the inverse metamodelling x-factors obtained from the output state trajectories , thereby ensuring that the clusters represented different model behaviours. the same clusters were then also used in the classical n-way hc-plsr metamodelling. this was chosen due to that clustering on the x-factors or the predicted y-factors  in the classical metamodelling  would both make the clustering more related to the designed parameter combinations instead of the state variable behaviour, since the predicted y-factors were here predicted as linear combinations of the x-factors that are related to the parameter combinations . predicted y-factors would have to be used in the clustering instead of the y-factors directly calculated from the state variable data in the classical metamodelling, since otherwise the classification of new observations  would not be possible on variables equivalent to those used to cluster the calibration set observations.

based on an assessment of the ability to constrain parameters from the state trajectories using from  <dig> to  <dig> clusters , using six clusters was considered optimal in order to balance between predictive ability and interpretational complexity. as seen from figure  <dig>  some of the parameters and state variables could be predicted even more accurately using a higher number of clusters in the n-way hc-plsr, but that would lead to a more complex model that would be more difficult to interpret in a sensitivity analysis. keeping the number of clusters as low as possible also helps avoiding overfitting of the data. we therefore assumed that the most important input-output map characteristics could be revealed using six regional nplsr models in the n-way hc-plsr.

the clustering of the calibration set observations used in the final n-way hc-plsr metamodelling is illustrated in figure  <dig> both in the nplsr factor spaces from the inverse  and classical  metamodelling and in the original state variable trajectory space . figure 7b illustrates that the nplsr y-factors from the classical metamodelling were  highly related to the designed parameter combinations, and hence did not give as good representation of the state variable behaviour as the x-factors from the inverse metamodelling. as described above, the clustering was therefore based on the latter both in the classical and the inverse metamodelling. figure 7c confirmed that the six clusters represented different types of dynamic behaviour for the mammalian circadian clock model. for example, cluster  <dig> was characterised by e.g. an especially large spread in the values of the state variable cc, while cluster  <dig> was characterised by high values of several of the circadian clock state variables . the parameter ranges for the clusters are given in table  <dig>  and showed that the clustering of the observations had a close relation to the values of the parameters vmb, vmc and vmp, which also spanned the first three global nplsr factors both in the inverse and classical metamodelling.

the mean values are given in parenthesis, while the ranges give the minimum and maximum parameter values observed in each cluster.

additional input-output map characteristics revealed by the regional classical and inverse metamodelling
prediction results from the hierarchical inverse metamodelling
the test set prediction results from the hierarchical inverse metamodelling shown in figure 8a indicated that the two input parameters k <dig>  and k <dig>  were predicted with considerably higher accuracy in the hierarchical metamodelling compared to the global metamodelling. figure  <dig> indicated that increasing the number of clusters in the n-way hc-plsr had a large effect on the prediction accuracy for these two parameters; r2-values higher than  <dig>  could be achieved using  <dig> clusters. however, the increase in prediction accuracy obtained also using only six clusters indicated that the circadian clock model was sensitive to these two parameters, in contrast to what the global metamodelling indicated. hence, the hierarchical metamodelling could provide additional insights into the input-output map of the analysed model.

the three parameters vdpcn , vdin  and k <dig>  were predicted with low accuracy also in the inverse hierarchical metamodelling. this indicated that either the circadian clock model was relatively insensitive to variations in these input parameters, or our metamodelling was not able to describe the complex relationships between these parameters and the model outputs. this has been assessed in more detail below.

prediction results from the hierarchical classical metamodelling
several of the circadian clock state variable trajectories could be predicted with considerably higher accuracy in classical metamodelling using n-way hc-plsr compared to the global nplsr . only the state variables pcc , pcn  and in  were predicted with low accuracy , indicating that the metamodelling with n-way hc-plsr was able to capture the main features of the input-output mappings for most of the  <dig> circadian clock state variables.

detailed interpretation of the revealed model sensitivity patterns
the parameter- and state variable prediction results within each of the regional nplsr metamodels, shown in figure  <dig> and figure  <dig>  indicated clear regional differences in the state variable space with regard to the prediction accuracy for the different parameters and state trajectories. this may be used to identify the parameters that are especially important for certain types of model behaviour. we recently showed that regional differences in model sensitivity to the input parameters also represent complex interaction patterns between the parameters  <dig>  in order to illustrate the usefulness of the methodology in providing biological insight, we give below some examples of detailed interpretations of the sensitivity patterns illustrated in figures  <dig>   <dig> and  <dig> 

as shown in figure  <dig>  the temporal behaviours of the state variables pcc and pcn were predicted with higher accuracy by all regional metamodels except regional model  <dig> and  <dig> , compared to the global nplsr. however, the state variable in was predicted with very low accuracy in all the regional metamodels, and the parameters vdpcn, vdin and k <dig> could not be well predicted in any of the regional inverse metamodels . two of the parameters that were predicted with low accuracy, vdin and k <dig>  appeared in the differential equation corresponding to the state variable in. hence, the low prediction accuracy was probably due to an insufficiently described mapping between in and these parameters in the n-way hc-plsr.

in order to reveal the sensitivity patterns for the state variable in, a separate sensitivity analysis of the relationship between in and the circadian clock input parameters was carried out using 2-way second order polynomial hc-plsr analogous to the analysis presented in  <dig>  but with the parameter ranges given in table  <dig>  this showed that in order to be well-predicted, the state variable in had to be logarithmised prior to the analysis. this might explain why this state variable trajectory could not be well described together with the other state variables in the n-way hc-plsr. the results are given in additional file 1: section s <dig> , and indicated that the parameters having the largest effects on the in state trajectory were vmb, vmc, vmp, vdin, k <dig> and k <dig>  several interactions between these input parameters were also identified.

the parameter k <dig>  was also involved in the differential equations representing the dynamics of the concentration of non-phosphorylated bmal <dig> protein in the nucleus   <dig> and the concentration of the non-phosphorylated per-cry protein complex in the nucleus , in addition to in. pcn was not well described by the classical metamodelling, but bn was predicted with high accuracy from the parameters . hence, the low prediction accuracy for k <dig> indicated that the state variable bn was relatively insensitive to the parameter k <dig> according to our analysis , even though the differential equation for this state variable involved k <dig>  this was confirmed by the plot of the model sensitivities estimated from the regional metamodels shown in figure  <dig> , as well as the separate sensitivity analysis for the state variable bn described in additional file 1: section s <dig>  . this illustrates how a combination of a classical and inverse metamodelling can provide more confident conclusions about model behaviour and sensitivity patterns.

the third parameter that could not be constrained from the state variable data was vdpcn , which was only involved in the differential equation describing the dynamics of the concentration of the phosphorylated per-cry complex in the nucleus . this state variable was predicted with an r2-value of approximately  <dig>  in the classical metamodelling, which is not particularly low. thus our results indicated a low sensitivity of pcnp to the rate of degradation of the corresponding protein. this result was confirmed by the results shown in figure  <dig> and the separate sensitivity analysis for the state variable pcnp described in additional file 1: section s <dig> . this was not straight-forward to explain, and calls for a more comprehensive analysis of the relationship between the state variable pcnp and the input parameter vdpcn. possible explanations might be that our analysis did not cover the relevant range for this parameter, causing the model sensitivity to this parameter not to be detected, or that its input-output relationship is very complex.

as seen from figure  <dig>  the parameter vdpcn seemed to have negative impact on the state variable pc  in regional nplsr model  <dig>  even though neither this parameter nor the state variable pcnp , appeared in the differential equation representing pc. both pc and pcnp were related to the per protein, though. in this region of the state variable space, the effect of vdpcn on pc was either more pronounced, or the relationship between these variables was less complex and therefore more visible in the analysis. as seen from figure 7c, cluster  <dig> was characterised by high values of several of the circadian clock state variables .

the input parameter k <dig>  had a large negative effect on ccp that was visible only in cluster  <dig> . this could be explained by the fact that k <dig> was involved in the equation for cc, which was part of the differential equation for ccp. furthermore, vdin  seemed to have a slight negative effect on pcnp in cluster  <dig>  this result was not easily deducible from the equation structure of the circadian clock model, and could not be detected in the global metamodelling. cluster  <dig> was characterised by e.g. an especially large spread in the values of the state variable cc.

the parameter k <dig>  seemed to have a positive effect on the state variable cc  in regional metamodel  <dig>  however, since the inactive per-cry-clock-bmal <dig> complex represses the per and cry genes in the nucleus, a positive effect of k <dig> on cc seemed unlikely. an additional sensitivity analysis was therefore carried out by adding eight simulations to the data set, keeping all parameters except k <dig> constant at the mean values found for cluster  <dig>  the results are shown in additional file 1: section s <dig> , and indicated that increasing k <dig> resulted in a very small decrease in cc and ccp, had a clear positive effect on in , and a negative effect on pcn and pcnp. in order to try to explain the positive effect of k <dig> on cc seen in cluster  <dig>  a separate 2-way plsr-based sensitivity analysis was therefore also carried out for the state variable cc in cluster  <dig> . the effects of vmb, vmc, vmp and k <dig> on cc indicated for cluster  <dig> were also manifested in the 2-way plsr analysis, but a positive main effect of k <dig> was not confirmed. however, several interaction terms involving k <dig> seemed to have effects on cc, such as the interaction between vmp and k <dig> . since cross-terms between the input parameters were not included in the n-way plsr analysis, confounding of these interaction effects with the main effect of k <dig> may explain the positive sensitivity to k <dig> indicated by the n-way plsr. the indication of a positive effect of k <dig> on cc could also have been caused by other sources of uncertainties in the nplsr analysis.

analogous to the increased prediction accuracy obtained for the two parameters k <dig> and k <dig>  model sensitivity to these parameters could be revealed in several local regions of the state variable space , even though this was not evident from the global metamodelling . according to figure  <dig>  the model seemed to be insensitive to these parameters in the region represented by cluster  <dig>  however, the inverse metamodelling indicated that also in cluster  <dig> these parameters could be predicted with a much higher accuracy than by the global nplsr metamodel, indicating model sensitivity to these parameters also in this region of the state variable space. this illustrates the importance of carrying out both classical and inverse metamodelling to gain a more detailed insight into the sensitivity patterns of a complex model.

discussion
the main traditional approach to analysis of input-output relationships has been to use aggregated outputs derived from the state trajectories, representing the dynamics of the state variables. for instance, in their original publication of the mammalian circadian clock model  <dig>  the authors employed a sensitivity analysis of only one aggregated output – the circadian clock period– a very important trait, but too aggregated to give sufficient overview of the entire model behaviour. multivariate metamodelling has, at least in principle, the capacity to reveal the relationships between all input parameters and all model outputs simultaneously. this has here been illustrated for the nine input parameters assumed to be most interesting for the mammalian circadian clock and the  <dig> state variables of the model, where the generated n-way metamodels allowed flexible quantitative input-output regressions yielding informative graphical insight into the main underlying input-output map characteristics. in our example n= <dig>  but the analysis can be extended to more than three modes.

our analysis confirmed the main conclusions from the original classical sensitivity analysis of the circadian clock period carried out by leloup and goldbeter  <dig>  namely that the mammalian circadian clock model was highly sensitive to parameters related to synthesis and degradation of the protein bmal <dig> and its mrna. however, our analysis improved the overview of the input-output relationships on which the circadian clock period is based. the main patterns found in our previous analysis of the same model, using conventional  plsr  <dig>  were also confirmed in the global nplsr metamodelling. however, the present cluster-based n-way analysis revealed additional aspects of the input-output relationships, for example the negative effect of increasing vdpcn on the state variable pc in the part of the model output space defined by cluster  <dig>  hence, the n-way hc-plsr-based metamodelling worked as intended in this illustration example. in the example used here, the focus was on oscillating state variables. other types of behaviour of nonlinear dynamic systems such as multiple steady states could potentially lead to additional nonlinearities in the input-output mapping, probably increasing the gain of using a cluster-based approach compared to a global analysis.

an alternative to using nplsr would be to unfold the state variable trajectory array by concatenating all the trajectory data into one 2-way matrix and use 2-way hc-plsr to analyse the data. however, the information about related trajectories for different state variables would then be left unused, leading e.g. to loss of the opportunity to visualise covariance structures. in order to evaluate the gain of keeping the 3-way structure in the data, the same analysis was carried out using 2-way hc-plsr on unfolded state trajectory data as well as on aggregated outputs calculated from the state trajectories. the clustering results from these analyses  indicated that the increased resolution achieved using n-way hc-plsr could not be achieved when the state trajectory array was unfolded into two dimensions or transformed into aggregated outputs, due to a less reasonable clustering of the observations. hence, using the nplsr factors seems to enable identification of more relevant clusters in which to carry out regional metamodelling. the global parameter prediction accuracies obtained were comparable to those obtained with the global inverse n-way plsr. however, in the hierarchical metamodelling, neither the unfolded state trajectories nor the aggregated outputs could predict the circadian clock parameters with as high accuracy  with 2-way hc-plsr as with the n-way hc-plsr.

in contrast to the results obtained using n-way hc-plsr, our previously published metamodelling of each of the circadian clock state variables separately  <dig> showed that all circadian clock state variables could be predicted with high accuracy from the parameters . however, there is a clear gain of using a common metamodel for all state variables in terms of obtaining overview of the input-output relationships as well as covariance patterns between the state variables. nevertheless, as demonstrated here, a separate analysis of the input-output relationships for insufficiently described state variables should accompany this type of analysis in order to gain a more complete insight into the input-output relationships. this was illustrated in our application example for e.g. the state variable in, which had to be logarithmised and analysed separately in order for its relationships to the input parameters to be adequately described.

in nplsr, relations between model outputs and input parameters are easily interpretable through plots of the loadings, in contrast to results produced e.g. by genetic algorithms which are often more difficult to interpret . moreover, due to the decomposition of the data into estimated latent variables, nplsr can provide efficient dimension reduction possibilities in high-dimensional systems. however, since the nplsr models presented here used a high number of factors to explain the input-output covariance, the dimension reduction possibilities of nplsr may not have been fully utilised. this was caused by the differences in the time-to-peak for the different state variables, which the nplsr uses many factors to describe. hence, a more careful pre-processing of the data would probably result in nplsr models using fewer factors, perhaps through shift correction as described by westad and martens  <dig>  work is in progress on testing whether this allows the nplsr models to use fewer factors while still keeping the same predictive ability. however, even when using relatively many factors, the nplsr models still enable great dimension reduction possibilities.

in regional regression modelling, there is a risk that the variance in some input- or output variables is highly reduced in the regional models compared to the entire data set. hence, the robustness of the predictions may decrease and the regression coefficients as well as the r2-values may be misleading for these variables. however, as shown in table  <dig>  the criterion used for defining local clusters  ensured that variances in the nine input parameters did not differ much between the clusters, and were about the same in the calibration set and the test set; the only parameters for which the variance decreased in the clusters compared to in the original datasets were vmb, vmc and vmp. this was not surprising, since these three parameters had the largest impacts on the first three nplsr factors of the global nplsr models, and hence the clustering using the nplsr factors was mostly based on these three parameters. however, since these three parameters were also predicted with high r2-values in the global inverse metamodel, high r2-values were not artefacts of low cluster variance in this study. this is primarily a problem occurring when using small test sets, and here the test set was of approximately the same size as the calibration set .

since the selection of data subsets in n-way hc-plsr is based on fuzzy clustering, no prior knowledge about the structure of the data is needed. hence, this method automatically detects regions of different model behaviour. the number of clusters to use in the hierarchical metamodelling was here specified in advance, based on exploration of the predictive ability of metamodels of varying complexity. however, using instead an optimisation algorithm to find the optimal number of clusters would make semi-automatic exploration of input-output relationships of computational models possible.

CONCLUSIONS
the n-way hc-plsr method presented here provides the opportunity to improve both prediction accuracy and analytical insight by identification of regional subsets of the data within which the relationships between input parameters and model outputs are more transparent than in a global regression analysis. this was exemplified by the model sensitivity to the two parameters k <dig> and k <dig> that was detected in the regional analysis but not in the global metamodelling.

our results also indicate that analysing all state trajectories simultaneously using n-way methodology is more effective for identification of different behavioural domains for a system and regions where input-output mappings can be predicted with higher accuracy, than unfolding the state trajectory array into two dimensions or transforming state trajectories into aggregated outputs prior to the analysis. this is due to a more reasonable clustering of the observations. moreover, application of the method for metamodelling in both the classical and the inverse direction represents a more comprehensive approach to the analysis of complex relationships between the model inputs and the temporal behaviour of the outputs, and allows more confident conclusions. our results showed that the mammalian circadian clock model was highly sensitive to parameters related to the protein bmal <dig>  as previously found by leloup and golbeter  <dig>  but in addition our approach revealed also more complex sensitivity patterns of the model.

based on these results, we believe that the presented n-way hc-plsr method will be instrumental for effective construction and validation of complex models. due to its efficient handling of n-way data structures, demonstrated here in the analysis of the temporal model behaviour, we hypothesise that n-way hc-plsr will be an especially useful tool for multivariate metamodelling of spatiotemporal models, a large future application area.

