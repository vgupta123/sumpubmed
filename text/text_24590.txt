BACKGROUND
development is surprisingly robust to environmental stress, intrinsic fluctuations, and genetic variability in populations. these facts, together with the observation that cell type is a discrete rather than continuous property, led c. h. waddington to propose that developmental processes have innate error-correction properties, which he called "canalization"  <cit> . waddington visualized error correction in terms of an "epigenetic landscape," in which the developmental state of an organism is analogous to a ball rolling down a sloping landscape containing multiple "hills" and "valleys": as development progresses, cells take different paths down this landscape and so adopt different fates. uncontrolled differentiation does not occur because the hills act as barriers and the state remains near a valley floor. this picture has natural corollaries in terms of genetic variability and evolution. although the shape of the landscape may alter slightly in the face of genetic variation, the tendency of the system to stay near the valley floor will buffer the phenotypic consequences of these variations. even under larger changes over evolutionary time, the tendency of the system to stay close to the valley floors will preserve and buffer developmental pathways in the face of evolutionary change.

we recently demonstrated the existence of canalization at the molecular level in the segment determination system of the fruit fly drosophila melanogaster  <cit> . we showed that with respect to the gap gene system, canalization was a consequence of gap gene cross-regulation  <cit> , and furthermore that it was associated with error correction by dynamical attractors  <cit> , a precise mathematical formulation of waddington's ideas about hills and valleys  <cit> . that work remains incomplete for reasons involving both broad biological considerations and specific mathematical points. with respect to large scale biological issues, the fact that canalization is under the control of natural selection means that all regulatory systems in an organism are in some sense selected for canalizing properties. in a general evolutionary context, canalization tends to appear as a multigenic trait involving the buffering of underlying genetic variation  <cit> . in a specific example concerning the segmentation system, it was shown that the differing proportional placement of even-skipped stripes in three lines and two species of drosophila  <cit>  depended on differences in the maternally expressed genes of flies in these lines, rather than the zygotic gap genes, the cross-regulation of which we have shown to ensure proportional spacing  <cit>  because of the alternating arrangement of strongly mutually repressing gap gene expression domains  <cit> .

in comparing our results to those of lott and coworkers, we note that we considered the canalizing behavior of a specific zygotic component of the segmentation system, while the study of lott et al. looked at the canalizing behavior of the full set of organismal genes, many subsets of which are presumably engaging in their own form of canalizing behavior. closing the gap between the genetic control of canalization at the level of populations versus the well defined small networks of genes considered in developmental genetics will require finding the specific genes responsible for population effects as well as taking the complementary step of incorporating additional mechanisms and genes into the well characterized systems arising in a developmental genetics context.

in  <cit> , we used the "gene circuit" approach to demonstrate that the reduction in variance of gap gene expression was a consequence of gap gene cross regulation. gene circuits  <cit>  are dynamical models that can reproduce observed gene expression patterns by reconstituting the required set of genetic interactions in silico. our model accounts for the expression of four mutually interacting gap genes, hunchback , krüppel , giant , and knirps , and takes into account the expression of the genes bicoid , caudal , and tailless  as external inputs. parameter values in the model were calculated by fitting solutions to mean time dependent expression levels from zygotic and maternal/zygotic genes and bcd expression from a single embryo. the resulting model, when run with bcd gradients from many individual embryos, correctly predicted the variance in position of six gap gene borders. analysis of model behavior at the numerical level showed that the observed variance was a consequence of gap gene cross regulation  <cit> . to further elucidate the general nature of the mechanisms controlling variance, we turned off diffusion and analyzed the circuit in individual nuclei using ideas from dynamical systems theory.

this analysis showed that the observed reduction in variation of gap gene expression patterns is a consequence of the action of robust attracting states  <cit> . the formation of borders of gap gene expression domains could be understood in terms of three qualitative dynamical mechanisms:  the movement of attractors;  selection of attractors;  selection of states on a one dimensional attracting manifold. the last of the three mechanisms also causes the domain shifts of the gap genes.

there were two limitations to this analysis. first, the dynamical interactions underlying the observed reduction in variance were elucidated by performing the dynamical analysis on one particular circuit controlled by the median bcd gradient used for the fit. as a consequence, the variance reduction analysis described in  <cit>  was shifted towards considering only how attractors canalize the variance of initial conditions in the dynamical system, without characterization of bcd dependence of these attractors. it is possible that other bcd gradients may entail different dynamical mechanisms of pattern formation. a second limitation is that the individual bcd gradients used in the analysis had certain systematic scaling errors that exaggerated the variation in threshold location  <cit> . in this paper we extend the dynamical analysis to multiple bcd gradients, revealing additional dynamical mechanisms which nevertheless work in a coordinated manner to reduce variance. moreover, we extend the analysis to a system in which the systematic exaggeration of bcd variance has been removed.

the key idea of this extended analysis is to express gene expression variability in terms of such basic objects of the dynamical systems theory as attractors and attraction basins. the canalization will be explained by specific geometrical properties of these objects. we demonstrate the applicability of this approach using hb border formation as an example. we analyzed how this border forms in terms of the phase portrait of the gap gene dynamical system for various bcd profiles. we find two specific mechanisms responsible for canalization of the variance, both connected to the phase portrait geometry.

methods
the ensemble of bcd concentration profiles
two sets of spatial profiles of the bcd concentration were obtained by the numerical processing of raw bcd data from individual embryos in two different ways. one set was identical to that previously described  <cit> : the bcd profiles were retrieved from  <dig> embryos in the flyex database  <cit> , with the background removed by basic normalization as described  <cit> . this method as applied to bcd profiles assumes that the bcd profile is exponential and that the background profile is quadratic, a point independently supported by staining in null mutants. one embryo was rejected because of a nonexponential profile  <cit> , thus in total  <dig> profiles were used in the study. for crosschecking purposes, we applied an alternative normalization method to the same raw bcd data set as described  <cit> . the method adjusts both concentration scale and levels of constant background to minimize variance in the ensemble. this way of renormalizing data is useful because it is clear from comparison to in vivo work that our profiles exaggerate variance in bcd amplitude. however, because there is no independent reason to believe that background should be adjusted to minimize variance, the in situ data processed in this manner should be viewed as a lower limit on embryo to embryo variation of the bcd profile.

the normalized bcd profiles were approximated by exponential functions vbcd = a exp with x varying along the a-p axis of the embryo. we obtained in this way a set of  <dig>  bcd parameters {a, l} . the bcd concentrations in different nuclei at the a-p axis were calculated as , where xi was the position of ith nucleus. we selected a "median" bcd profile by picking an embryo with parameters {a, l} closest to the centroid point in the set of all {a, l} values. this median profile was used to fit the gap gene circuit as described  <cit> .

the gap gene circuit
we modeled the expression of the network of four gap genes hb, kr, gt, and kni with the following equations  <cit> :   

where  is the concentration of protein encoded by gene a  in nucleus i ) along the a-p axis of the embryo. the model incorporates nuclear divisions, number of nuclei m and diffusion coefficients da depend on the cleavage cycle number n. the function  has a sigmoidal graph and describes regulated scaling for the maximal rate ra synthesis of the ath protein. the argument u of g contains inputs from various transcriptional regulators. the first input is a linear combination of all  from the network with parameters tab, which thus quantify the regulatory interactions between the genes. the bcd concentration profile  is a time invariant maternal input to the system. the term  is a given time-dependent external input from the transcription factors caudal  and tailless . the function χ equals one during interphase and zero during mitosis, accounting for the fact that synthesis shuts down during this period. coefficient  equals zero if i =  <dig>  and one otherwise, preventing protein diffusion outside of the spatial domain. coefficient λa is the rate of protein degradation, and constant ha adjusts the threshold of the regulation function.

the initial conditions in the model consist of a spatial gradient of maternally expressed hunchback  protein concentration and zero concentrations of the other three proteins. these conditions correspond to the state of the gap gene system at the start of cleavage cycle  <dig>  the solutions in the model are biologically meaningful until the end of cleavage cycle 14a, at which time the midblastula transition occurs and many properties of the embryo change. the nuclei range along the a-p axis within the spatial domain from 35% to 92% of the embryo length  where the gap genes express  <cit> . this spatial domain includes  <dig> nuclei in cleavage cycle  <dig> and  <dig> in cycle 14a.

all gene expression levels  are on a scale of 0- <dig> chosen to maximize dynamic range in the experimental data without saturation. these levels are called relative concentration units throughout the paper. time dependent inputs for  and  were obtained from the data by averaging cad and tll expression patterns over individual embryos at various time points, as described in details in earlier work  <cit> . the background was preliminary removed from the individual cad and tll patterns as described  <cit> . the parameters for the model with bcd normalized as described  <cit>  were those reported in . for the alternative normalization procedure, we selected a new median bcd profile from the renormalized data and fitted the model with that profile to the same time dependent averaged gap gene data used previously by either serial or parallel lam simulated annealing  <cit> .

simplified equations
we considered a simplified version of the model without diffusion, called the "shorted model" as in previous work  <cit> , keeping the parameter values equal to those found by the fitting procedure in the full model . neglect of the diffusion term in  decouples nuclei and reduces  <dig> × m model equations to m independent systems of four equations, each system corresponding to one nucleus. we investigated only a restricted region of the a-p axis surrounding the posterior border of the anterior hb expression domain. the region ranges from 37% to 57% el, about  <dig> nuclei in width in cleavage cycle  <dig> and  <dig> in cleavage cycle 14a. tll does not act in this region and can be omitted  <cit> . we can then analyze shorted equations  <cit>  given by   

where index x indicates the parametric dependence of solutions. it stems from the dependence of bcd and cad protein concentrations on spatial position as determined from experimental data. such dependence can come directly from experimental data in nuclei, for which x = i, or as a continuous real-valued interpolation x.

the earliest observable indications of the mid-blastula transition, which include decay of the bcd gradient, are evident after time class  <dig>  of cycle 14a, about ten minutes prior to the onset of gastrulation  <cit> . for this reason, we represent the time dependence of vcad from the beginning of cleavage cycle  <dig> to the end of time class t <dig>  thereafter we take vcad = vcad and χ =  <dig> for times t >t <dig>  thus, the shorted equations  are nonautonomous until t <dig> and autonomous later.

attracting sets, basins of attraction, and hb border positions
we analyzed the dynamical system  for spatial position x from 37%-57%el region in two mutually complementary directions. we performed a bifurcational analysis in the autonomous version of the system , in which χ ≡  <dig> and vcad was replaced by value vcad. the bifurcation structure in the system was studied on the bcd-cad plane, which is the plane with coordinates vbcd and vcad , by means of the auto package  <cit> . in this way, all equilibria and domains of their existence on the bcd-cad plane were calculated and all bifurcations separating these domains were elucidated. from another direction, at each spatial position of eleven nuclei in cycle  <dig> and for each of the  <dig> bcd profiles , we calculated basins of attraction for each point attractor. this was done by evaluating the equations until late times when the solution is stabilized, with  <dig>  <dig> random initial conditions uniformly distributed in the biologically relevant subspace of the initial conditions Ω = { <dig> ≤ vhb ≤  <dig>  vkr = vgt = vkni = 0} . each point attractor is the asymptotic limit at late times of dynamics starting from the initial conditions which are grouped in a certain part of Ω, and we call this part the basin of attraction for the attractor. to get a more spatially refined picture, we also performed a calculation of attraction basins at thirty spatial positions in the range 37%-57%el for the bcd ensemble normalized by the basic method.

for each bcd profile and fixed spatial position x, the attraction basin of each attractor can be represented as an interval , c2) on the hb axis, as all other protein concentrations are zero in Ω. the values vhb = c <dig> and vhb = c <dig> are lower and upper boundaries for the basin, respectively. we used linear spatial interpolation for these values in order to study the attraction basin boundaries as continuous functions of x for each bcd profile. some attraction basins consist of more than one disjoint interval on the hb axis. in this case, the basin boundaries comprise the boundaries of each connected part of the basin.

we calculated approximations for 1d unstable manifolds of saddles s having a single eigenvalue with positive real part by solving the simplified model equations from two initial conditions s ± w, where w is a scaled eigenvector  of the jacobian at the saddle.

in order to calculate the hb border positions in solutions exhibited at the onset of gastrulation, we used spatial interpolation of first and third order for solutions in the shorted and full models, respectively. the orders are different for the two models since the solution in the shorted model is less smooth in space than in the full one because of the absent diffusion term, and the use of high order interpolation schemes could lead to artifacts. as a consequence, we computed the border positions in different ways for the two models. the hb border position in the spatially interpolated solution of the shorted model was defined as the point in the spatial domain at which hb concentration reached its half-maximal value, and in the full model as the local inflection point.

RESULTS
we extend the dynamical analysis reported previously for the median bcd profile  <cit>  to the entire ensemble of bcd profiles first introduced in  <cit> . we placed exponential approximations of bcd profiles from individual embryos in the model  with the parameter values calculated by manu et al.  and investigated characteristic features of the phase portraits in the model at various spatial positions.

in visualizing the results of our analysis, it is useful to consider two equivalent representations of the spatial information coded in eqs. , either an explicit parameter x denoting a-p positions in the range 37%-57% el or a point on the bcd-cad plane . we further use the bcd-cad plane to show the bifurcation diagrams and discrete spatial positions for presenting attraction basins.

for the median bcd profile, the gap gene expression patterns generated by eqs.  from 35% to 71% el occur in the same order and locations as those generated by the full model equations . the only exception is that the borders become very sharp and domains tend to be mutually exclusive . over the full ensemble of bcd profiles, we found three classes of behavior associated with the qualitatively different expression patterns of genes kr and gt in the anterior vicinity . these classes were visible, but blurred by diffusion, in our previous study of the numerical behavior of the full model .

attracting sets and various mechanisms of border formation
for each bcd gradient, we performed an analysis of how border formation was driven by dynamical attractors. because different bcd profiles lie on different portions of the bcd-cad plane, we first characterized which combinations of attractors are present in different parts of this plane by performing a bifurcational analysis  of the shorted model . we then calculated the basins of attraction for all attractors at a discrete set of eleven positions corresponding to cycle  <dig> nuclei in the bcd-cad plane with initial conditions varied in Ω = { <dig> ≤ vhb ≤  <dig>  vkr = vgt = vkni = 0}.

there are four stationary attractors  in the portion of the bcd-cad plane shown in figure  <dig>  the attractors can be coded with quadruples consisting of  <dig>  x, or  <dig> for each attractor component by inspecting whether the corresponding protein concentrations have small, intermediate, or large values at the attractors . for example, a <dig> =  <dig> means that kr is highly expressed at this attractor with the other genes staying repressed. a <dig> is the only attractor that continuously changes its code with varying bcd and cad concentrations. there are six domains on the bcd-cad plane in which various combinations of a1-a <dig> exist . attractor a <dig> exists inside the entire portion of the considered plane, while the other attractors are involved in the bifurcations at the borders of their existence domains. there are three types of bifurcations found affecting attractors: saddle-node, hopf, and bogdanov-takens bifurcations . a limit cycle appears at the hopf bifurcation, which is a nonstationary oscillating attracting state. however, we have not found any oscillatory attractors when the initial conditions are varied in Ω, and, therefore, we exclude this type of attractor from the analysis. the gray dots in figure  <dig> show the late time values of the external input in eqs.  used in the calculations of attraction basins for eleven nuclei positions and all of the bcd profiles. the location of the grey dots on the bifurcation diagram indicates the existence of specific attractors in the phase space for a given nucleus. however, not all of these attractors can be reached under the given biological initial conditions in Ω, as attraction basins of some attractors are disjoint with Ω .

a component of an attractor is assigned the code value '1' if the concentration of the corresponding protein is larger than  <dig> relative concentration units, value '0' if it is smaller than  <dig> relative units, and value 'x' if it is between  <dig> and  <dig> . all attractors except a <dig> preserve a single code across the considered ranges for bcd and cad concentrations. attractor a <dig> changes its state from  through  to  due to continuous increase of the gt concentration for this attractor on the bcd-cad plane . all listed attractors exist in the model corresponding to the alternative normalization method, and only a1-a <dig> in the model associated with the basic method.

as shown elsewhere  <cit> , the dynamics in the model for the median bcd profile is qualitatively different in parts of the a-p axis which are anterior and posterior to the position of the bifurcation annihilating a <dig>  this position appears as a diagonal line running from the upper left to lower right of figure  <dig>  the anterior and posterior dynamical regimes are characterized by different types of attracting sets governing the solution dynamics. solutions at the end of cycle 14a  are very close to point attractors in the anterior regime and to attracting manifolds in the posterior one . we found that these dynamical regimes are preserved across all the individual bcd profiles.

to study the dynamical mechanisms of hb border formation, we examined the phase portraits in the shorted model at spatial positions on either side of the border. the mechanism determining the border was found by inspecting which attracting sets govern the solution dynamics from the biological initial conditions in the two nuclei, a hb-expressing border nucleus placed just anterior to the hb border position and a hb-nonexpressing border nucleus just posterior to that. border formation is interpreted in these terms as a switch of solution between attracting states in these two nuclei.

we found four qualitatively different mechanisms of hb border formation for bcd profiles from the ensemble, depending on the type of attracting sets approached by the solutions in the two nuclei by t = τ . for example, figure 4b shows that for corresponding bcd profile the border forms by a solution switching from attractor a <dig> =  <dig> in the hb-expressing border nucleus to a hb-off state at the unstable manifold of one of the saddles in the hb-nonexpressing border nucleus. other panels in the figure can be interpreted in a similar way.

there are  <dig> bcd profiles associated with the phase portraits which exhibit the attractor-attractor switch mechanism of border formation  and  <dig> profiles corresponding to the attractor-manifold switch mechanism , which make these two mechanisms predominant for the bcd ensemble. the other mechanisms shown in figure 4c, d are rare and occur for only one bcd profile each. the distribution of the four mechanisms over the three solution classes from figure  <dig> is summarized in additional file 8: table s <dig>  for all bcd profiles, only attractors a <dig>  a <dig>  and a <dig> participate in hb border formation. a <dig> contains a nonempty attraction basin in Ω for only a few nuclei which lie in a portion of the bcd-cad plane that never contains the hb border .

spatial configuration of attraction basins
to further investigate how the border formation mechanisms imply the observed hb border variance, we calculated the spatial and bcd dependence of attraction basin boundaries. we visualize the way that the biological initial conditions choose a basin in different nuclei and try to connect it to the appearance of the hb border in the solution by the time t = τ. we construct graphs combining the initial hb profile and the attraction basins for all attractors at different spatial positions, and highlight the range of positional variance for hb. typical examples of these graphs are shown in figure 5a,b.

for all but one of the bcd profiles, hb border formation is associated with the transition of the initial hb profile from the basin of one point attractor to the basin of another point attractor. this can be seen by comparing the attraction basins of the initial hb concentration values in the two nuclei surrounding the hb boundary position. for example, the transition in figure 5a is from the basin of a <dig> in the hb-expressing border nucleus to the basin of a <dig> in the hb-nonexpressing border nucleus ; the transition in figure 5b is from the basin of a <dig> to the basin of a <dig> . the basin-to-basin transitions can also be detected in figure  <dig>  where the solutions in the two nuclei go to different point attractors. bcd profile # <dig> provides the only exception from this basin-to-basin transition rule. for this bcd profile, the solution trajectories in both hb-expressing and hb-nonexpressing border nuclei eventually end up at the same point attractor a <dig>  the hb border forms in this case according to the mechanism from figure 4b  with the only difference that the solution trajectory in the hb-nonexpressing border nucleus is attracted to a hb-off state on an unstable manifold which connects a saddle and attractor a <dig> . this bcd profile was excluded from the further analysis. for all cases with the a <dig> → a <dig> transition, attractor a <dig> is in the state  for the hb-expressing border nucleus. the a <dig> → a <dig> and a <dig> → a <dig> transitions are similar in the sense that they both correspond to the switch from an attractor with hb-on state to an attractor with hb-off state. we found  <dig> bcd profiles in the ensemble associated with either of these two transitions. we call these profiles family i in what follows. these transitions can hypothetically correspond to any of the four mechanisms possible for the hb border formation, because the attracting invariant manifolds may also participate in the border formation in this case . on the other hand, the a <dig> → a <dig> transition from figure 5b describes the transition of the initial hb concentration between the basins of attractors which both have the hb component in an 'on' state. the hb border forms in this case by the attracting manifold which provides the necessary hb-off state at t = τ . we found a total of  <dig> bcd profiles leading to the a <dig> → a <dig> transition. we refer to these profiles as family ii. among these profiles,  <dig> are associated with the state  and  <dig> profiles with the state  for the hb-nonexpressing border nucleus. the basin of a <dig> in figure 5a stops to exist for nuclei located posterior to 51%el. the system is in the basin of a <dig> for these positions and approaches a hb-off state by t = τ with the help of an attracting manifold. this participation of an attracting manifold in attaining a hb-off state is the distinctive feature of the aforementioned posterior dynamical regime.

the mechanisms are labeled as follows: attractor-attractor switch , attractor-manifold switch , manifold-attractor switch , and manifold-manifold switch .

variability of basin boundaries and hb border positions
the fact that the hb border forms according to the basin-to-basin transition of the initial hb profile implies that this profile crosses a boundary between two basins. therefore, we can relate the border position to the position of the intersection point between the initial hb profile and the spatial profile of the basin boundary . one can speculate that these two positions are the manifestation of two levels of positional information readout in the gap gene circuit. in this subsection, we compare the positional variability for hb predicted by the model for these two levels. we calculated the spatial profiles of the basin boundaries for all bcd gradients. the ranges of the border positions corresponding to the two bcd families are shifted with respect to each other, and the same shift is observed at the level of the basin boundaries . as expected, the positions of the hb border and basin boundary intersection points exhibit strong correlation for both bcd families . note that the step-like form of the correlation curve in the figure follows from two factors, the discrete spatial positions used in calculations and the absence of diffusion in the model equations .

this correlation means that the intersections between the initial hb profile and specific basin boundaries encode the hb border positions. as shown in table  <dig>  the canalization of bcd variation takes place both at the level of the basin boundaries and at the level of hb border in the simplified model. the variabilities of the intersection points and the hb border positions are approximately the same for each bcd family and between the families. on the other hand, the bcd positional variance is significantly different in the two families.

variability of the hb border positions in the simplified model and the intersection points between the initial hb profile and the attraction basin boundaries  for two bcd families and for the whole bcd set, in comparison with the positional variability of threshold bcd concentration. the bcd threshold value for a family was chosen by picking a bcd profile corresponding to the mean position of the hb border for that family; then, the threshold value was equal to the value of this bcd profile at that position. the full range  and standard deviations  are given in % of embryo length. the standard deviation for the hb border is  <dig> % in solutions of the full model and  <dig> % in data  <cit> .

a nonlinear curve of hb border response to bcd variation
the bcd dependence of hb border can also be investigated by inspecting the curve representing the response of hb border position to bcd concentration levels in a vicinity of this position. we studied this response prescribed by the model for bcd profiles from the ensemble .

the response curve exhibits a specific nonlinear form which is the same in the simplified model  and in the full one . it persists even if we recalculate the curve by using the normalized individual bcd profiles instead of their exponential approximations , indicating that the results are independent of the nuclear noise present in the non-approximated bcd data.

the nonlinear form of the curve is the result of the reaction to bcd variation from the whole gap gene network. as a consequence, we have a linearly increasing response curve when gap gene cross regulation of hb is removed from the full model equations . in that case, the gradually increasing amplitude  of bcd profile across the ensemble results in gradual posterior shift of the hb border . this happens because bcd is an activator of hb and the spatial profiles of both bcd and hb concentrations are monotonously decreasing in the vicinity of hb border position. in contrast, there can be reversed  shifts of the hb border for some range of bcd concentration in the presence of gap gene cross regulation .

the inset in figure 6a shows an example for one spatial position of how the attraction basin boundary depends on bcd concentration. this dependence locally represents the response curve at the level of attraction basins in the model. the specific form of the curve in the inset underlies the nonlinear form of the response curve for the intersection points and border positions.

results for the alternative bcd normalization method
as the bcd variance can be exaggerated in the data normalized by the basic method, we considered the same ensemble of bcd profiles but normalized by the alternative artificial normalization method, which minimizes variance in the ensemble . we studied the model on the newly normalized bcd profiles in order to crosscheck our results. the corresponding parameters a and l of exponential approximation for the bcd profiles are shown in additional file 1: figure s <dig>  we calculated a new set of parameter values  in the full model  with new median bcd profile by fitting to the same gap gene expression data that were used previously  <cit> . main qualitative features of these parameter values and corresponding solution of the simplified equations   are very close to those in the above study  <cit> .

due to the specific statement of the alternative normalization method, the bcd positional variance in the ensemble became much lower: the standard deviation σ =  <dig> %el. the corresponding positional variance for hb in the full model equals to σ =  <dig> %el.

we calculated a new bifurcation diagram on the bcd-cad plane for the simplified model . there are two new attractors, a <dig> =  <dig> and a <dig> =  <dig>  in addition to attractors a1-a <dig> which are analogs of the corresponding attractors to the above study. attractor a <dig> exists in a very narrow domain on the bcd-cad plane, where it coexists with attractor a <dig> at the state  . thus, the attractor  <dig> is unique in this domain. the calculations of attraction basins at discrete spatial positions did not detect a <dig>  since the newly normalized bcd concentrations never entered the existence domain for this attractor . as in the above study, only attractors a1-a <dig> are important for the process of hb border formation. the spatial dependence of these attractors is mostly similar to the previous results, except that the bifurcations changed their positions at the a-p axis . despite the difference in the bifurcation structure, new calculations also revealed the existence of an attracting invariant manifold governing the dynamics in a posterior spatial region, which is the analog of the previously found manifold  <cit> . this manifold has similar geometrical properties, reflecting the fact that it is responsible for the observed anterior shifts of the posterior gap domains taking place in cycle 14a  <cit> .

three of the four mechanisms shown in figure  <dig> exist for the new parameter values and for various newly normalized bcd profiles: the attractor-attractor , manifold-attractor , and manifold-manifold  switches. analyzing how the initial hb profile chooses the attraction basin in the nuclei neighboring the hb border, we detected  <dig> bcd profiles leading to the a <dig> → a <dig> transition,  <dig> bcd profiles leading to the a <dig> → a <dig> transition, and  <dig> profiles which were not associated with the change of basins across these nuclei  . the model demonstrates a picture of the initial hb profile crossing the attraction basin boundaries similar to the first family case in figure 5c, but with a smaller variance . the bcd response curve for the hb border in the model with the new parameter values is also not linear .

discussion
mechanisms of border formation
we presented the dynamical analysis of the simplified model of the gap gene network on the ensemble of early drosophila embryos. the main goal was to decode the mechanistic basis of the gap gene border formation and stability under the bcd morphogen variance. the hb border formation mechanisms were described in terms of attracting sets and their attraction basins calculated in the nuclei surrounding the border position.

the results reveal that the border formation can be associated with the event of intersection between a boundary separating the attraction basins of two different point attractors and the initial hb profile presenting the input from the maternally expressed hb gene. attracting sets of another type, the unstable manifolds of saddle equilibria, actively participate in the adjustment of the border position. they do so by attracting the solution trajectories in the nuclei surrounding this position. the model predicts that these attracting manifolds can be involved in the border formation for some bcd profiles.

the hb border correctly forms in the model by the onset of gastrulation for all individual bcd profiles. for about a half of these profiles, however, the kr and gt patterns in the solutions exhibit defects in the anterior part of the spatial domain . it turns out that the hb border formation mechanism involving the attracting manifolds is mostly associated with these cases. this may lead to the conclusion about restricted applicability of this mechanism in the case of hb expression. however, this mechanism exists and plays an important role for the gap domain borders in a posterior part of the embryo, where the domains form and vary in time under the control of an unstable manifold  <cit> . to analyze canalization for the posterior borders, the variation for external inputs from cad and tll should be taken into account, where these transcription factors are among the key regulators, and a modified model should be considered including an input from the terminal gene huckebein  <cit> .

mechanisms of canalization
as previously reported, the model exhibits a significant filtration  of the bcd positional variability at the level of hb border formation  <cit> . our results show how this filtration stems from the stable behavior of the attraction basin boundaries. it was shown in  <cit>  that the mutual regulatory repression between the gap genes accounts for the observed variance reduction, thus presenting a buffering mechanism for canalization  <cit> . we translated this buffering mechanism to the level of attractors and their attraction basins. as the hb border position is well encoded by the intersection between the initial hb profile and corresponding attraction basin boundaries, the stability of hb border predicted by the model can be explained by inspecting the geometrical properties of these attraction basins.

from this inspection, we can elucidate the following two mechanisms responsible for the observed robustness. first, the initial hb profile is a monotonously decreasing function of a-p position, while the basin boundary to be crossed is a monotonously increasing one , i.e., these curves have opposite dependencies on the a-p position. this purely geometrical fact evidently prescribes a smaller variation of the intersection point when the basin boundary is changing due to the variance of bcd concentration, as opposed to the case if the curves would jointly rise or jointly fall along the a-p axis .

the second mechanism is associated with the specific nonlinear form of the response curve from figure  <dig>  the gap gene cross regulation of hb bends the response line exhibited in absence of this regulation . this bending effectively reduces the hb positional variance by about half. in terms of attractors, this bending is controlled by the fact that a basin boundary responsible for the hb border formation does not change monotonously, but oscillate in the state space with the changing bcd profile.

the results show that the full range of the hb positional variance is broken down into two almost equal parts, the anterior and posterior ones . these parts are associated with two families of the bcd individual profiles  and two different mechanisms of hb border formation. the bcd profiles from family i lead to the hb border formation as a switch from a hb-on attractor in a hb-expressing nucleus to a hb-off attractor in a hb-nonexpressing nucleus, while for family ii the border forms with the help of an attracting invariant manifold in a hb-nonexpressing nucleus. since the difference between the two families is in the amplitude of the bcd profiles, we conclude that bcd profiles of high amplitude canalize by a dynamical mechanism different from those of lower amplitude. each dynamical mechanism provides only half of the full variance for the hb border, but in two adjacent spatial domains. therefore, the change of the dynamical mechanism that happens with rising bcd amplitude effectively doubles the variance.

the hb border positions from the more posterior range are placed posterior to the spatial position of a bifurcation annihilating attractor a <dig>  this bifurcation position delimits the anterior and posterior dynamical regimes in the model, as described previously  <cit> . therefore, the bcd profiles from the second family shift the hb border to the posterior dynamical regime, which is characterized by an active role of an attracting invariant manifold in the pattern formation.

the results indicate that the posterior range of hb positional variation is almost equal to the anterior one only due to smaller variation of the bcd profiles in family ii compared to family i. this suggests that the solutions in the anterior and posterior dynamical regimes have quite different sensitivity rates to variation of the bcd concentration. for family i, the standard deviation for the hb border position is  <dig>  times less than for the bcd threshold position, while it is only  <dig>  times less in the case of family ii. this difference can be explained by an observation that bcd profiles of higher amplitude correspond to the linear part of the response curve from figure  <dig>  and this is a consequence of specific regulatory interactions in the gap gene circuit as explained further.

we have used the model  to study the canalization mechanisms based on the assessment that the model provides one of the best spatio-temporal precision for the description of gap gene expression  <cit> . this model is an approximation to a more general model of gene regulation, which should be grounded on the statistical-mechanical formalism. one possible limitation is the linear approximation for the argument of the nonlinear regulation function g. the canalization mechanisms described in terms of attractors and attraction basins generally depend on the structure of the model that predicts these attracting states. therefore, an important direction for future investigations should be verification of the proposed mechanisms in a phase space of a more general model.

response curve
the nonlinear nature of the bcd readout by the gap gene circuit is clearly represented in a specific nonlinear form of the response curve showing the bcd dependence of the hb border position in the model. the nonlinear part of the curve can be explained by the regulatory actions on hb from the other gap genes. in particular, a regulatory analysis in the full model revealed that the regulatory interactions between hb, gt, and kr underlie the folding part of the response curve . the gap gene cross-regulation also participate in the linear parts of the response curve by tuning the incline of these parts.

it was previously pointed out that the gt and kr expression borders in the anterior part of the a-p axis show large variation in the model in response to bcd variation because the model is missing some regulators in this part  <cit> . for example, these gt and kr borders are absent in the solutions from class iii. this fact raises doubts on the specific folding part that the response curve exhibits in the middle range of the bcd concentration values. on the other hand, the folding part exists only for the bcd profiles associated with the solutions from class i, with all expression borders formed correctly, which means that an essential portion of the artificial variation of the gt and kr borders can be excluded from the consideration without affecting the folding form of the curve.

comparison of results for two normalization methods
we investigated the model on the ensemble of bcd profiles normalized by the alternative method, which provided lower bcd variance  <cit> . one used this method as an artificial limit case, in which we dealt with the ensemble possessing minimal bcd variance, and applied it for the crosschecking purposes.

we have not found any essential discrepancy in the mechanisms of hb border formation and canalization for the two normalization methods. a distinct bifurcation structure in the model with the new parameter values does not lead to changes in the solutions during the biologically important time. the model preserves an attracting invariant manifold related to the posterior dynamical regime. the same border formation mechanisms appear except the one associated with the attractor-manifold transition. it is important that, even though the second family of bcd profiles does not appear in the alternative normalization case, the invariant manifolds still play their role in adjusting the border position. the model also demonstrates an essentially nonlinear response curve for the hb border. therefore, our conclusions formulated above are robust with respect to the choice of the normalization method, and, in more general terms, they should be valid for different estimates of the actual bcd variance.

this correspondence can be explained by the fact that the parameters a and l obtained for the alternatively normalized bcd profiles form a subset in similar parameters obtained in the case of the basic normalization method . roughly speaking, we can associate the alternatively normalized bcd profiles with family i. in particular, this means that the bcd data rescaled according to the alternative algorithm support the conclusion formulated above about different dynamical mechanisms of canalization for bcd profiles of different amplitude.

there is an important issue concerning the comparison of the bcd variance filtration rates. the calculations reveal that, for the basic normalization method, the hb positional variation of  <dig> %el in the model output follows from the bcd positional variation of  <dig> %el, thus implying that more than 70% of the positional variance has been filtrated. the same calculations for the alternative normalization method give the filtration rate of approximately 60%. therefore, the filtration still happens in the model even if we normalize bcd profiles according to the precisionist hypothesis  <cit> . this result is quite expected since the reported dynamical mechanisms underlying the processing of the bcd variation in the model are valid irrespective of the absolute variation range. whatever actual variation the bcd morphogen exhibits, the nonlinear model response translates it to a smaller variation of the target gene patterns.

CONCLUSIONS
the formation of hb border is coded by the intersection between the maternal hb gradient and a boundary between attraction basins in the gap gene dynamical system. small positional variance for hb border can be explained by the geometrical properties of this basin boundary and its nonmonotonic dependence on the bcd concentration. main features of the phase portraits underlying the canalization mechanisms do not depend on the normalization method for bcd.

authors' contributions
vvg, m, and jr conceived and designed the course of the study. vvg performed calculations of attractors and attraction basins, model optimization, and analysis of data and results. lp carried out the bifurcational analysis and calculated the phase portraits. emm applied alternative normalization to the bcd data and analyzed the data. mgs and jr performed biological analysis of the results. vvg and lp made the figures. ams, mgs, and jr supervised the work. vvg, lp, jr, mgs, and ams wrote the paper. all authors read and approved the final manuscript.

supplementary material
additional file 1
parameters a and l of exponential approximation of individual bcd profiles for two normalization methods.

click here for file

 additional file 2
the bifurcation diagram for the new parameter values.

click here for file

 additional file 3
the spatial dependence of attractors in the shorted model for the median bcd profile.

click here for file

 additional file 4
the spatial dependence of attractors in the shorted model with the new parameter values and for the median bcd profile.

click here for file

 additional file 5
detailed description of the bifurcations in the model .

click here for file

 additional file 6
the bifurcation diagram with more details.

click here for file

 additional file 7
the existence domains on the bcd-cad plane for attractors a1-a <dig> following from calculations at discrete spatial positions.

click here for file

 additional file 8
the distribution of bcd profiles over the four mechanisms of hb border formation and over solution classes i-iii.

click here for file

 additional file 9
the response curve for the normalized individual bcd profiles instead of their exponential approximations.

click here for file

 additional file 10
new parameter values in the model obtained by optimization with a median bcd profile from the bcd data normalized by the alternative method.

click here for file

 additional file 11
the solutions of the full model equations and their simplified version for the new parameter values.

click here for file

 additional file 12
the bifurcation diagram for the new parameter values with more details.

click here for file

 additional file 13
detailed description of the bifurcations for the new parameter values .

click here for file

 additional file 14
the existence domains on the bcd-cad plane for attractors a1-a <dig> in the model with the new parameter values following from calculations at eleven spatial positions.

click here for file

 additional file 15
classification results for the bcd profiles in the case of the alternative normalization method.

click here for file

 additional file 16
the spatial configuration of attraction basins in the model with the new parameter values.

click here for file

 additional file 17
the response curve for the new parameter values.

click here for file

 additional file 18
schematic illustration of the first canalization mechanism.

click here for file

 additional file 19
the regulatory analysis of the response curve .

click here for file

 acknowledgements
the study was supported by nih grant rr <dig>  crdf gap award rub1-1578-st- <dig>  and rfbr grants 08-01-00315a, 08-04-00712a, 10-01-00627a, 11-01-00573a, and 11-04-01162a. we thank konstantin n. kozlov for the help with the parameter optimization code and johannes jaeger for valuable feedback on the manuscript. the optimization calculations were partly performed at the joint supercomputer center of the russian academy of sciences.
