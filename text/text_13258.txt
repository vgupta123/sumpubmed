BACKGROUND
with the development of quantitative functional genomics approaches, it has become possible to analyse the cellular adaptation of cell physiology to altered environmental conditions experimentally, by monitoring changes in fluxes, metabolites, proteins or mrnas. such adaptations tend to occur at multiple regulatory levels if not simultaneously, then subsequently, depending on the time scales of observation
 <cit> . in principle, an adaptive change in the rate of an enzyme  can be mediated by changes in  the concentration of metabolites  with direct, cooperative and allosteric effects on the activity of the enzyme
 <cit> ,  changes in the concentration of the enzyme through gene-expression alterations, and  covalent modification via signal transduction. the first is termed metabolic  regulation. the second is known as gene-expression  regulation and the third as signal-transduction  regulation. because of similar properties, the latter two types of regulation have been considered together under the term ‘hierarchical regulation’
 <cit> . although in this paper only the former two types of adaptive changes will be discussed explicitly, because of the above-mentioned similarities, the third type is addressed implicitly. until now, significant progress has been made on the modelling of genome-scale metabolic networks in microorganisms integrating metabolic and gene-expression regulation
 <cit> . the steady-state properties of a number of representative metabolic regulatory mechanisms, such as end-product inhibition, have been investigated substantially both in terms of metabolic control analysis 
 <cit>  and by the supply–demand theory championed by hofmeyr and cornish-bowden
 <cit> . in order to take gene-expression regulation into account, hierarchical control analysis 
 <cit>  has been developed as an extension to mca, but it has not yet been linked up with the supply–demand theory. developing such a link would seem useful as in quantitative experimental studies gene-expression regulation turned out to be as important as metabolic regulation
 <cit> .

the adaptive changes of reaction rates through metabolic and genetic regulation are usually due to feedback and/or feed-forward mechanisms. in biology, there is a perception that evolutionary optimization has made these mechanisms perfect. if this were so, this would suggest that such mechanisms might be identical to ‘perfect’ regulatory mechanisms designed by control engineering
 <cit> . indeed, csete and doyle
 <cit>  have suggested that such a convergent evolution of engineering and biology may have occurred. in particular, they came with an integral control structure containing both an actuator unit  and a controller/sensor unit. they showed that this regulatory structure would lead to a phenomenon called perfect adaptation and then proposed that such structures should be common to biology. in systems biology contexts, several biochemical processes have been discussed in terms of their control system structures. for example, robust perfect adaptation in bacterial chemotaxis signalling system, in mammalian iron and calcium homeostasis, and in yeast osmoregulation, have been interpreted as integral feedback control systems
 <cit> , without however proving that they corresponded precisely to the very same regulatory topology or even performance. a recent study identified the three different types of control structures used in control engineering, i.e. proportional, integral, and derivative control, in the regulation of energy metabolism
 <cit> . with the exception of
 <cit> , the above work focused only on metabolic regulation, whereas
 <cit>  did not compare metabolic regulation with gene-expression regulation. in this study, the integration of metabolic and gene-expression regulation plus the integration between metabolic control analysis and control engineering will be investigated.

control engineering has examined which network structures may make adaptation of a network upon a sustained perturbation of a network component, ‘perfect’. perfection was defined as the phenomenon that some important system variables  should be completely robust to the perturbations, i.e. with steady states values unaffected by the perturbations. such perfect robustness can be achieved when a time integrator is applied to any variation of the controlled variable . this control feature is known as ‘integral control’. through this time integral, the network would continue to change until the controlled variable is restored completely to its initial value. because there must be some compensation for the perturbation, a different system variable then has to move away from its initial state. this so-called ‘manipulated variable’ is non-robust  to the perturbation, but enables the controlled variable to be robust.

if the control action is proportional to the variation of the perturbed variable itself, or a function thereof that is zero when that variation equals zero, the ultimate deviation of the controlled variable from its value before the perturbation, will be nonzero. this is the so-called ‘proportional control’ of control engineering. perturbations may also result in a sustained oscillation of the controlled variable and to prevent this from happening, the third type of control focused on by control engineering can be useful, i.e. so-called ‘derivative control’ , which will not be discussed in this paper, but has been exemplified in reference
 <cit> .

as mentioned above, the mechanism of integral control is often referred to as ‘perfect adaptation’. other authors have referred to similar network behaviour that was not based on the same integrative mechanism by the same phrase of perfect adaptation. one such case is that all steps in a metabolic pathway are regulated identically, i.e. their activities being modulated by the same factor. tyson et al.
 <cit>  referred to this as perfect adaptation, but the mechanism hinges on precise regulation of various steps, we would suggest to refer to this as ‘perfect regulation’ since the adaptation part is not crucial. kacser and acerenza
 <cit>  called this the universal method for metabolic engineering. fell and thomas
 <cit>  proposed that this may be a common motif in biological regulation and adamczyk et al.
 <cit>  elaborated it into the stealthy engineering principle. this paper will not discuss this perfect regulation mechanism, but focus on the robust perfect adaptation mechanism operating through integral control loops.

in this work, we shall try to bridge two rather unconnected approaches in analysing regulation of network properties. the one is that of control engineering which has devised networks structures that lead to perfect or imperfect adaptation. the other is that of biochemistry with mca and supply–demand theory, as well as true-to-life examples of intracellular biochemical networks involving both metabolism and gene expression. we shall focus on pathways synthesizing precursors for macromolecule synthesis  in which that precursor often inhibits an enzyme early in the pathway, both directly and through gene expression. such end-product regulatory structures allow for some simplifications
 <cit> . this makes them suitable for illustrating our relatively simple conclusions that are however valid more generally. we shall hypothesize that because a time integration of protein synthesis is involved, gene-expression regulation should be a prime example of integral control, whilst metabolic regulation is our candidate for the role of proportional control. we shall then interpret both these steady-state robustness properties and the control properties in terms of a new hierarchical supply–demand framework.

methods
kinetic description and classical control analysis
in this section, we demonstrate that the unique steady state of a metabolic network under regulations can be analysed by both the kinetics-based analysis and by metabolic  control analysis. a hierarchical supply–demand theory linking hierarchical control analysis with classical supply–demand analysis, is developed for when gene-expression regulation is active. as a result the steady state properties of a metabolic network subject to various regulatory mechanisms can be analysed within a unified theoretical framework.

basic regulatory architecture and kinetic analysis
the overall regulatory behaviour of a pathway can be decomposed into a number of elementary structures. feedback inhibition by end-product has been reported for quite a few metabolic pathways, particularly in anabolism
 <cit> . another regulatory motif is the feed-forward activation of downstream enzymes . in addition, in many metabolic pathways one or a few reactions are product insensitive. the reactions catalyzed by hexokinase, phosphofructokinase, and pyruvate kinase in mammalian glycolysis
 <cit>  and several steps in the central carbon metabolism in b. subtilis <cit> , constitute examples. the activities and concentrations of some of these enzymes are regulated by allosteric effectors, covalent modification or transcription. in this study we take a linear pathway with metabolic and gene-expression regulation of the first reaction through the end metabolite as the example of choice
 <cit>  . the first reaction  is assumed to be insensitive to its immediate product. with this example we will be able to illustrate the essence of the principles we are after.

the following differential equations describe this end-product regulation pathway:

  x˙2t=e1t⋅f1x1t,xnt,pt-e2t⋅f2x2t,x3tx˙3t=e2t⋅f2x2t,x3t-e3t⋅f3x3t,x4t⋮⋮⋮x˙nt=en-1t⋅fn-1xn-1t,xnt-ent⋅fnxnte˙1t=gxnt-ked⋅e1t 

here, we assume that the concentration of the substrate x <dig> is not influenced by the pathway and that only e <dig> is regulated through gene-expression. xi is the concentration of ith metabolite, and fi describes the kinetics of the ith reaction. parameter p corresponds to other factors that could affect the activity of the first enzyme, e.g. co-factors or external metabolic modulators. such effects on other enzymes are not addressed here. the gene expression function g is here assumed to depend on the ultimate metabolite only, the latter acting on the synthesis of the first enzyme. more realistic situations involving the dynamics of mrna will be discussed in later sections. this paper is relevant for gene-expression regulation in general, i.e. includes regulation at the level of transcription, translation and post-translational modification, but our examples will mostly deal with only one type of these at a time and mainly consider transcription regulation. ked is the degradation rate constant of the first enzyme. in fast growing organisms and for stable proteins ked may merely represent the dilution effect due to cell growth and division 
 <cit> , but in other cases it will depend on proteolysis, which will be discussed later.

by definition of the steady-state in living cells
 <cit> , x <dig> and p are constants at steady state, i.e.
x1t=x¯ <dig> and
pt=p¯. similarly, the concentrations of the enzymes are constants and equal to
e¯ <dig> …,e¯n respectively. accordingly, if such a constant steady-state regime exists, and it is the unique solution of the following equation:

  f1x¯ <dig> x¯n,p¯⋅gx¯nked=e¯n⋅fnx¯n 

which only depends on the first and the end enzyme features and is only a function of the end product concentration xn. usually, both
f1x¯ <dig> xn,p¯ and g are monotonically decreasing functions of xn, which describe the negative, metabolic and gene-expression regulation, respectively. likewise, fn is usually a monotonically increasing function of xn. as shown by equation , the steady-state regimen corresponds to the intersection of the two functions, and is unique due to the monotonic characteristics of f <dig>  fn and g, as illustrated in figure 
 <dig> 

alternatively, if the ith reaction  is product insensitive but the first reaction is not, then f <dig> is re-defined and it also becomes a function of x <dig>  while the kinetic function of the ith step only depends on xi. it can be proven that at steady state, x <dig> then only depends on functions f <dig>  …, fi and is independent of fi +  <dig>  …, fn -  <dig>  this conclusion is both theoretically attractive and practically useful, because the steady state properties of an otherwise complex metabolic pathway may only depend on a limited number of enzyme features
 <cit> . this is a case where the complexity of a pathway is limited; its flux and the concentrations of the upstream metabolites are only controlled by the properties of the upstream enzymes and the corresponding genes.

we will now examine how metabolic control analysis and supply–demand theory deal with these types of metabolic control structures.

metabolic regulation: mca and the supply–demand theory
metabolic control analysis  has mostly dealt with the steady state properties of the metabolic part of schemas such as the ones mentioned in the previous subsection. modular mca
 <cit>  has divided metabolic networks of this type into modules with relatively autonomous activities, connected through well-identified metabolites. in the supply–demand theory, hofmeyr and colleagues
 <cit>  have used a similar simplification to demonstrate much of the essence of the regulation of cell function. according to the latter, the metabolic part of the end-product pathway in figure 
 <dig> can be partitioned into a two-step linear pathway with supply and demand blocks as shown in figure 
 <dig> 

the concentration and flux control coefficients of metabolic control analysis measure the steady state change in the concentration of a metabolite x and flux j, respectively, in response to a change in the activity of a process i. that change in activity may be effected by changing a parameter pi  that is specific for step i:

  cix=∂lnx∂lnpi/∂lnvi∂lnpi=∂lnx∂lnvicij=∂lnj∂lnpi/∂lnvi∂lnpi=∂lnj∂lnvi 

the vi is an activity rather than the rate of reaction i at steady state. when the parameter pi is changed, vi is not equal to the resultant change of the steady-state rate of reaction i; it is the change in that rate only if all the other variables that affect that rate been kept constants. the concentration control coefficients of the aforementioned supply–demand system can then be defined as
csxn=∂lnxn/∂lnvsupply and
cdxn=∂lnxn/∂lnvdemand, and the flux control coefficients,
csj and
cdj similarly. these control coefficients describe the control exercised by a specific reaction or enzyme on the overall system variables or fluxes, while the ‘local’ regulatory properties of individual enzymes are quantified by the elasticity coefficients, such as

  ϵxns=∂lnvsupply∂lnxn,ϵxnd=∂lnvdemand∂lnxn 

ϵxns and
ϵxnd measures how the reaction rates of the supply and demand blocks are influenced by the end product concentration xn. because the rates are those of blocks rather than of single enzymes, these elasticities are named ‘overall elasticities’
 <cit> . they can be further expressed into more, though not quite elemental elasticity coefficients:

  ϵxns=c1j1⋅ϵxnv1+cn-1j1⋅ϵxnvn-1ϵxnd=ϵxnvn 

where
ϵxnv <dig> denotes the total elasticity of the first reaction with respect to xn through the metabolic regulation. the lowercase flux control coefficients c now refer to the local control within the supply module only . they can be obtained from summation and connectivity theorems as control coefficients of the module . when assuming the first reaction is product insensitive, the supply modular elasticity in  can be further simplified as

  ϵxns=c1j1⋅ϵxnv <dig> 

in such a case, the first enzyme has the full control of flux  within the supply module, such that
c1j1= <dig> and

  ϵxns=ϵxnv <dig> 

using the summation and connectivity theorems in mca, all the four concentration and flux control coefficients can be expressed in terms of the elasticity coefficients . for the concentration control of the supply step and the flux control of the demand step this becomes, using  and :

  csxn=1ϵxnd-ϵxns=1ϵxnvn-ϵxnv1cdj=cvnj=ϵxnsϵxns-ϵxnd=11+ϵxnd/ϵxns=11+ϵxnvn/ϵxnv <dig> 

these equations show that if the first reaction has complete flux control within the supply module, the control of steady state end-product concentration and flux are only functionally depend on two elasticity coefficients, i.e. the ones that correspond to the first and last reactions. when the feedback is very strong, i.e.
ϵxnv1≫ϵxnvn, the control of the demand flux
cdj is close to  <dig>  the mca and supply–demand simplification thereof discussed in this section partially explain the state-steady properties of the aforementioned full regulatory system, but only for the case of metabolic regulation. when including the gene-expression regulation, a more complete interpretation can be achieved by using the hierarchical control analysis and a new ‘hierarchical supply-demand’ theory as investigated in the next subsection.

gene-expression and metabolic regulation: hierarchical supply–demand theory
westerhoff and coworkers have developed hierarchical control analysis , an extension of mca that can take gene-expression regulation and signal transduction into account
 <cit> . we shall here implement this by extending the meaning of the elasticity coefficients in the previous subsection to include regulation through gene expressions.

when considering the metabolic part of the network alone, i.e. if gene expression were always the same, the control on the concentration of intermediate x in a supply–demand system follows . if the roles of the synthesis and degradation of metabolic enzymes are considered explicitly, as illustrated in figure 
 <dig>  hca has to be introduced, and the corresponding hierarchical control coefficient becomes:

  hsx=∂lnx∂lnvsupply=1ϵxd-*ϵxs 

capital h is here used for the hierarchical control coefficients as defined in table 
 <dig> 
*ϵxs is an “overall” elasticity coefficient, including a classical ‘direct elasticity’ only related with metabolic responses ) and an ‘indirect elasticity’ due to gene-expression regulation:

x or x
i
  ϵxs*=ϵxs+ϵess⋅caes⋅ϵxa 

the lower case c is used for ‘metabolic control coefficients’ , i.e. control coefficients that only take the local network  into account.
ϵess is often equal to  <dig>  i.e. when the rate of the reaction in isolation is proportional to the concentration of the enzyme catalyzing it.

using metabolic control analysis for the gene expression part of the network, the control coefficient of the protein synthesis reaction with respect to the concentration of the protein synthesized is:

  caes=1ϵesb-ϵesa 

combining the above expressions, one can express the hierarchical coefficient quantifying the control exerted by the supply enzyme on the concentration of the metabolic intermediate x in terms of all the elasticity coefficients in the network:

  hsx=1ϵxd-ϵxs-ϵess⋅ϵxaϵesb-ϵesa=1ϵxd+-ϵxs+ϵess⋅-ϵxaϵesb+-ϵesa=-hdx 

the terms in parentheses are usually positive. the equation shows that the control by supply  decreases with the absolute magnitudes of the elasticities with respect to x of the supply, of the demand, and of the protein synthesis, but  increases for increasing elasticities of the protein synthesis and degradation reactions with respect to the concentration of the enzyme. the equation also shows that for finite non-zero magnitudes of the elasticities, the hierarchical control coefficients for control by supply may be decreased by elasticities in the gene-expression network, but is usually not brought down all the way to zero. the same applies to the control by demand, which is equal to minus the control by supply.

now let us recall the end-product module with both metabolic and gene-expression regulatory feedbacks of figure 
 <dig>  as the end product  regulates the first reaction through both metabolic regulation and gene-expression regulation, the corresponding ‘overall’ elasticity  of the first reaction can be expressed as:

  *ϵxnv1=ϵxnv1+ϵe1v1⋅cvtranse1⋅ϵxnvtrans 

where
ϵxnv <dig> denotes the elasticity through metabolic regulation,
cvtranse <dig> denotes the control of gene expression  on the concentration of the first enzyme
 <cit> . by replacing the
ϵxnv <dig> in  with the more complete expression , i.e. using
ϵxns=*ϵxnv <dig>  the hierarchical control coefficient
hsxn can be expressed into elasticity coefficients, in a similar manner as . since both metabolic and gene-expression regulation constitute negative feedbacks,
ϵxns is negative and becomes more negative with increasing xn due to increasing product inhibition.
ϵxnd is positive and decreases asymptotically to zero with increasing xn. therefore, the relationship between the reaction rate and end product concentration can be described in terms of the elasticities as depicted in figure 
 <dig>  figure 
 <dig> explains the unique steady-state results obtained from classical steady state analysis .

an illustration of the supply–demand relationship similar to figure 
 <dig> has been presented in
 <cit> . however, here we extend the interpretation of the system and corresponding elasticity coefficients to the more general case that includes gene-expression regulation. as an extension to the classical supply–demand theory, the analysis given in this section can be named the ‘hierarchical supply-demand’ theory.

control engineering
the discipline of control engineering first identifies a so-called controlled variable, which it sees as the output of the system. in metabolic biochemistry, output often relates to a flux, but can also be the concentration of an important metabolite in the pathway. control engineering next examines the various categories of mechanism that may contribute to the capability of the network of maintaining the controlled variable close to its original steady state value when the system is subject to a sustained perturbation. the ‘error ’ is the deviation  of the value of the controlled variable  from its value before the perturbation, or the difference to a reference signal r. the network ‘adapts’ to the perturbation of the controlled variable, i.e. to the error function, in a so-called ‘control action’. rna polymerase plus the ribosomes that together translate changes in the concentration of metabolites to changes in gene expression, or direct metabolic regulation of the activity of an enzyme correspond to such control actions. the output of the control action  is often named the manipulated variable. in metabolism, reaction rates v are variables manipulated either by the concentration of metabolites ) or by the concentration of the enzyme that catalyses the reaction concentration . a mechanical control system often includes an actuator that converts the control signal into some kind of mechanical motion. for a biochemical system discussed in this study, this may correspond to the enzyme catalysing the reaction synthesizing or degrading x. usually there exists a sensor measures the controlled variable and translates its error function into the input signal of the controller. in a gene-expression regulation, the transcription factor can be regarded as the sensor.

the three most widely used categories of control are the proportional, integral, and derivative  control mechanisms
 <cit> . they differ depending on whether the control system’s response is a function of the ‘error function’ itself, the time integral thereof or the time derivative thereof, respectively. in systems biology literature, the proportional control mechanism has already been referred to in terms of metabolic regulation
 <cit>  . however, when control engineering discusses proportional control mechanisms, response is proportional to the error function. in actual biochemistry, enzyme activity is rarely a linear function of the concentrations of metabolites x, which includes the enzyme’s substrate, its product and allosteric modifiers. mca accommodates this nonlinearity by allowing the elasticity coefficient to differ from  <dig>  metabolic regulation by the ‘error function’, is part of the nonlinear dynamics of the process or system, i.e. f, both conceptually and in the mathematical modelling. it would seem therefore that the proportional control of control engineering can be nonlinear in biochemical networks.

integral control action through the accumulation of molecules in the metabolic process has also been reported
 <cit> . here the systems response should be a function not of the error function itself but of the integral of that error function. in the present study we examine gene-expression regulation from this point of view, since protein synthesis requires time integration and depend on the error function, and because changes in protein concentration directly affect the rate of the reaction the protein may catalyzes. we may expect that this integral control somehow corresponds to the ‘indirect elasticities’ of hca. whether indeed gene-expression regulation corresponds to an exact  integral control mechanism will be further discussed in the results and discussion section. whether there exists a derivative control action and whether it relates to a specific type of regulation in a metabolic pathway will not be investigated in this paper. reference
 <cit>  already identified an example.

considering the dynamics of a metabolic system, we can write the time dependence of the concentrations of its metabolites as:

  x˙=n⋅vx,e=n⋅e⋅fx 

n is the stoichiometry matrix. e is a diagonal matrix with the concentrations of the enzymes that catalyse the various reactions along its diagonal. f is a vector function of the concentrations of the metabolites and kinetic parameter values. the regulated metabolic pathway can be described in terms of a closed-loop feedback control system, as indicated in figure 
 <dig>  in which kp, ki and kd are the pid control parameters. we here note that figure 
 <dig> and subsequent figures refrain from biochemical detail. this is because the analysis in the present paper aims at obtaining a set of conclusions with general significance. being specific in the schemes we use as illustrations would detract from this aim.

when considering a sustained perturbation γ∙δp  and denoting by δ the  deviation from the steady state prior to this perturbation, the time dependent variation in the metabolite concentrations may be observed:

  δx˙=n⋅δvx,e=n⋅ess⋅f′x⋅δx+n⋅fxss⋅δe+γ⋅δp 

the subscript ss refers to the steady state values. by substituting the time integration of gene expression, i.e.
ki⋅∫0tqτ⋅dτ, for δe, and assuming the proportional and derivative actions a part of the metabolic process ,

  δx˙=n⋅ess⋅f′x⋅δx+n⋅fxss⋅ki⋅∫0δφx⋅dt+γ⋅δp 

this describes the overall dynamics of a closed-loop metabolic system under perturbation as a sum of three terms. the first term of these is a nonlinear function of  the perturbation of the controlled variable  δx. this term describes all the direct elasticities, including non-regulatory system kinetics such as substrate and product effects, and  metabolic regulation such as allosteric activation. the second term corresponds to a time integral of a function of the perturbation of the controlled variable δx, and can also depend on other system variables as discussed in the results and discussion section.

we shall now examine whether these two terms in the equation , correspond to the proportional and integral control loops of control engineering.

RESULTS
a simple example of combined metabolic and gene-expression regulation of an important intracellular process: atp  metabolism
let us consider the simple example given in figure 
 <dig>  i.e. a two-step pathway with atp and adp as combined intermediate and with the expression of the gene encoding the first enzyme e increasing in proportion to the concentration of adp. the ‘moiety conservation sum’ c is the sum of the concentrations of atp and adp and a constant here  because the reactions only convert the one into the other. the metabolic regulation addresses the interplay between the supply and demand processes .

the dynamics of adp and enzyme e are here assumed to follow mass action kinetics:

  dadp/dt=-ks⋅e⋅+kd⋅de/dt=ka⋅adp-kb⋅e-k <dig> 

the degradation of the enzyme is here written as the sum of two terms, which will serve to emphasize the implication of this degradation to be independent  or dependent  on the enzyme concentration. the first order degradation rate reflects the assumption that there is a rather unspecific protease activity for which the particular enzyme e we are considering here is a minority substrate. the zero order degradation would reflect a case where there is a specific protease system for enzyme e  that is saturated by the already high concentration of the enzyme relative to the km of the ubiquitin transferase. in  all rate constants are considered non-negative and k0 =  <dig> whenever e is non-positive. the closed-loop control system structure of the pathway can be represented as in figure 
 <dig> 

the control system diagram suggests that the adp concentration is the controlled variable and the enzyme concentration e a manipulated variable in the gene-expression control loop. the zero order degradation rate k <dig> can be treated as a reference signal to the system. the metabolic regulation is included as a part of the adp kinetic process. by considering a perturbation of kd from its steady state value , and reformulating the kinetics of adp and e , we have

  δadp·=-ks⋅ess+kd⋅δ-ks⋅ss⋅∫0∞ka⋅δadp-kb⋅δe⋅dt+⋅δkd 

comparing this to a general closed-loop control system , with adp for x, we recognize on the right-hand side first a proportional response term, then an integral response term, and then the perturbation term. the proportional response corresponds to the direct ‘elasticity’ of the supply and demand reactions with respect to the error function δ, which is a metabolic and instantaneous regulation. the integral response is related to the protein synthesis and degradation and thus to gene-expression regulation.

when the degradation of enzyme is zero order in terms of e , the gene-expression regulation becomes an ideal integral control loop, and the metabolic network can exhibit robust perfect adaptation to the external or parametric perturbations. this can be understood by requiring  to be valid in a steady state, i.e. with time independent values for  and e. because the time integral reaches to infinity this requires that the argument of the integral, i.e. ka ⋅ δ - kb ⋅ δe, must equal zero. the mechanism for this perfect adaptation is that after the perturbation the concentration of the enzyme will vary until it makes the time dependences equal zero by itself, forgoing the more usual process in metabolic regulation that changes in the controlled variable arrange for the steady state to be re-attained in the presence of the sustained perturbation.

for the more general case where the enzyme degradation may depend on the enzyme’s concentration, the  control of the enzyme level by the demand reaction can be expressed in terms of the kinetic parameters and the steady-state adp concentration :

  hkde=∂lne∂lnkd=ks⋅kakb⋅adpss2kd⋅c+ks⋅adpss2⋅kakb=1-11+ks⋅adpss2kd⋅c⋅kakb 

the flux control exercised by the demand reaction is quantified by:

  hkdj=∂lnj∂lnkd=1-adpssc1+ks⋅adpss2kd⋅c⋅kakb 

both the control of enzyme level and the control of demand flux by the perturbation equal  <dig> minus a hyperbolic function of kb. for the ideal integral control scenario of kb =  <dig>  the enzyme concentration e tracks the activity of the pathway degrading atp perfectly, i.e.
hkde= <dig>  more importantly, the pathway flux perfectly tracks the perturbation in the demand flux and
hkdj= <dig>  this is the case of robust perfect adaptation. for other cases when kb ≠  <dig>  the adaptation of the pathway to the perturbation will not be perfect and both control coefficients are smaller than  <dig> 

also the robustness coefficient
 <cit>  of the adp concentrations vis-à-vis perturbations in the demand reaction can be expressed in terms of kinetic constants and the concentration of adp :

  ℜkdadp=1∂lnadp∂lnkd=kd⋅c+ks⋅adpss2⋅kakbc-adpss⋅kd 

only if kb =  <dig>  kd =  <dig>  or ss = <dig>  the adp and atp are perfectly robust  versus perturbations. the fragility
 <cit>  of the adp concentration vis-à-vis perturbation in the demand reaction, which is the inverse of the robustness, can be quantified by the concentration control coefficient for the concentration of adp with respect to the degradation process. it reads as:

  fkdadp≡1/ℜkdadp=∂lnadp∂lnkd=c-adpssc+adpss2⋅ks⋅kakd⋅kb 

this fragility is a hyperbolic function of the first order degradation rate constant of the enzyme and hence zero when that degradation is zero-order . the fragility has the atp/ ratio as its maximum value /atp ratio). half maximum fragility is attained for:

  kb=adpss2c⋅ks⋅kakd 

this means that the fragility may be low for a substantial magnitude of the first order rate constant of protein degradation if the rate constant for protein synthesis is also high. the control coefficients for the enzyme level
hkde and the demand flux
hkdj attain a maximum of  <dig> and a value of ½ when the fragility of adp is half maximal.

these conclusions can be generalized somewhat by directly implementing hca and hierarchical supply–demand result given in . for the above model the elasticity coefficients assume the following magnitudes:

  ϵadps=ϵadpa=ϵes=1ϵea=0ϵadpd=-adpc-adp 

for the robustness of the adp concentration vis-à-vis increased demand one then finds:

  1hdadp=-ϵadpd+ϵadps+ϵes⋅ϵadpaϵeb-ϵea=cc-adp+1ϵeb 

this shows that robustness is infinite if the enzyme degradation reaction is zero order , and that the robustness becomes smaller with increasing order  of this reaction.

the most important conclusion here is that there is no discontinuity in the ability of integral control loops to lead to good adaptation. the closer the degradation of the enzyme that enables the adaptation is to a zero-order reaction, the stronger its tracking of the perturbation in the demand flux, and the higher the robustness of the variable that is to be kept homeostatic. important perhaps is the phenomenon that the robustness is not determined by the magnitude of the degradation reaction but by its kinetic order . the corresponding conclusions pertain to the tracking of the demand by the enzyme level e and the control of the pathway flux by the demand reaction.

a further issue in control engineering is the robustness of systems versus perturbations at various frequencies. in engineering, an airplane wing has to be robust to variations of air pressures at high frequencies, as well at low frequencies. in order to achieve this combined robustness, different control loops may have to be put in place simultaneously, although a trade-off limits what one can do
 <cit> . in systems biology, this can be illustrated for the end-product feedback regulation in figure 
 <dig>  if the flux demand of the pathway increases rapidly, the concentration of the end product decreases rapidly and as a result of the direct allosteric product inhibition effect, the activity of the first enzyme will increase quickly too. this metabolic control of enzyme activity is a fast actuator of the system. however, if there is a further increase in the flux demand, the first enzyme may ‘lose’ its control capacity since its activity may be approaching its maximum capacity . at this stage, the system may then undergo a second ‘adaptation’ through gene expression which should be expected to be slower because the cell has to produce enzyme, but still ultimately lead to an increase in the concentration of the first enzyme. this increase should then decrease the direct metabolic stimulation of the catalytic activity of the enzyme discussed above. in this sense, the regulation of the first enzyme of the pathway is bi-functional in dynamic terms
 <cit> : the metabolic regulation rapidly rejects high frequency perturbations but possibly with small amplitude or capability, while the gene-expression regulation is slow to adapt, but may be able to reject very large constant perturbations.

conditions for integral and pseudo-integral control: end-product pathway
in this section, we recall the end-product module example  to analyse gene-expression regulation in a more general metabolic pathway. in particular, the conditions will be identified for which the gene-expression regulation constitutes ideal integral control or pseudo-integral control will be discussed. a simple but representative end-product example is given in figure 
 <dig>  i.e. a linear pathway with three metabolites, where for all the three enzymes the gene expression is regulated by the last metabolite. the kinetic model of this example with all the parameters is provided in
 <cit> .

gene transcription and translation are modelled here explicitly by further including the dynamic function of mrna as

  r˙=vtrsc-vrd=gtrscx3-krd⋅re˙=vtrnl-ved=gtrnlr-ked⋅e 

here gtrnl = ktrnl ⋅ r is a function of mrna concentration r. ked essentially consists of three parts. one term is due to dilution, which is proportional to the specific cell growth rate μ. the other terms correspond to proteolysis, as below:

  ked=μ+kproteolysis1+kproteolysis0/e 

the final term denotes the zero order proteolysis as would be caused by proteases that are saturated with the protein of interest. we here assume that the specific growth rate μ is independent of the activity of the pathway under study, an assumption that is sometimes but not always realistic. since after multiplying with e the last term is independent of the protein concentration, it is convenient to move this term into the protein synthesis function gtrnl. hence, the new protein degradation rate can be defined as,

  ked=μ+kproteolysis <dig> 

and the protein dynamics can be re-written as,

  e˙=gtrnlr-ked⋅e=ktrnl⋅r-kproteolysis0-μ+kproteolysis1⋅e 

in the exponential growth phase or if proteolysis is first order , the above pathway example corresponds to a pseudo- or non-integral control scenario. the control structure of the regulatory system is then given by figure 
 <dig>  the dynamics of the ‘sensor’ is decomposed here by addressing both transcription and the translation through mrna. at steady state, often gtrnlss = ked ⋅ ess ≠  <dig>  therefore, after perturbation of a system parameter , the new steady state values of x <dig>  r, and gtrnl will no longer be the same as the old steady state values, which indicates that then the regulatory system does not achieve perfect adaptation. however, when ktnd is very small, near-perfect adaptation behaviour should be observed.

an ideal integral control scenario will happen only when cell enters a stationary phase and there only exists zero order proteolysis, i.e.
ked=μ+kproteolysis1= <dig>  in such case, at steady state, gtrnlss ≡  <dig> due to integral control, and r and x <dig> will also always keep the same constant values at steady state, no matter how the system parameters are perturbed. the adaptation of the system is then perfect in the sense of making the system properties r and x <dig> robust against the perturbations. the functions gtrnl and gtrsc can also be multivariate, i.e. contain other system variables. only if those variables do not depend functionally on the protein concentration , the adaptation vis-à-vis perturbations of the system kinetic parameters will remain perfect.

the ideal integral control scenario that we considered above led to the perfect robustness of certain system variables with respect to certain  perturbations. a second aspect of the perfect adaptation scenario is the perfect tracking by a second system variable of perturbations. perfect tracking means that the relative change in the variable is identical to the relative change in the perturbing parameter. if the parameter is the activity of a process, then this means that the corresponding control coefficient is equal to  <dig>  the perfect tracking of references and the perfect robustness of controlled variables to perturbations are two aspects of integral control systems, i.e. the two features can be observed simultaneously for the same system. a specific pathway then shows perfect robustness of a system variable vis-à-vis multiple perturbations  but perfect tracking with respect to only a limited set of parameters .

for the aforementioned example, the zero order proteolysis can be regarded as a ‘reference’ signal
r=kproteolysis <dig>  effectively perturbation of this rate constant corresponds to an external perturbation of protein synthesis. the effect is that even at an ideal integral control case, i.e. when ked =  <dig>  the steady state concentration of mrna will not become  <dig>  rather, it will always ‘track’ the reference r  whenever
e˙ss= <dig>  the reference tracking control system structure is included in figure 
 <dig> with reference r referred to by a dashed arrow, and with gtrnl then representing ktrnl ⋅ r.

practical concerns and assumptions on degradation rate constant ked
in general,
ked=μ+kproteolysis1> <dig>  it may seem that the condition of integral control can be approached, when either i) ked < <α with α a very small positive value, or ii) ked < <ktrnl ). in the latter case, for the level of protein to remain bounded, there should be a background degradation rate of the protein independent of the concentration of that protein. this would be so if:

  μ+kproteolysis1≪kproteolysis0/e 

during the exponential growth phase of bacteria such as e. coli less than 1% of a protein may be degraded during a cell division cycle
 <cit> . consequently the major term in the protein degradation is the dilution term μ and this term is generally very small. indeed, by definition, eμ ⋅ t =  <dig>  where t is the doubling time of the bacteria and then μ = ln2/t. practically, the smallest value for t is close to 20 minutes
 <cit> , which corresponding to the fastest growth rate of e. coli:

  μ≈ln2/20×60= <dig> ×10-4s- <dig> 

such a growth rate in microbes such as e. coli and yeast, which is fast for organisms but slow at the time scale of rna and protein synthesis, produces a small effective degradation rate constant for the proteins. below we shall see whether such a small degradation rate constant suffices to produce near-perfect adaptation behaviour in practice, which would be interpreted as a quasi-perfect integral control system.

simulation study
in this section, both the integral and the non-integral control scenarios are simulated based on the example given in figure 
 <dig> with all the kinetic parameters given in
 <cit> . three different systems are considered, with ked =  <dig>   <dig> , and  <dig> , respectively. all three systems are simulated from the same initial condition. the concentration changes of mrna, e and x <dig> are shown in figure 
 <dig>  after a period of time  the three systems reach different steady states. then at 50 seconds we perturb one system parameter  by 20% for all three cases. after a while the three systems reach new steady states. after perturbation only the system with zero order protein degradation , returns to the same steady state values for mrna and x <dig> as those before perturbation, which indicates perfect adaptation: this is an ideal integral control system. in this case the manipulated variable, the enzyme level e, varies strongly. its adaptation enables x <dig> and mrna to be completely robust vis-à-vis the perturbations of the kcat of the third reaction. in the other two cases , the change in enzyme level is smaller, but the new steady state values of mrna and x <dig> deviate from their previous steady-state values and adaptation is not perfect. however, the deviations are not large; only 3% for x <dig> and 4% for mrna when ked =  <dig> , and 4% for x <dig> and 8% for mrna when ked =  <dig> .
x

 <dig> 
under perturbation with different 
k

ed 
values.

now let us consider the reference tracking scenario. the responses of enzyme and mrna to a 20% perturbation in the protein stability  at t = 50 seconds, are given in figure 
 <dig> for three different rate constants of enzyme degradation ked. only when ked =  <dig> the mrna concentration tracked the reference value with zero steady state ‘deviation’. this indicates the existence of a perfect integral action of the feedback regulatory system. when ked was not equal to zero , the mrna response did not track the reference signal, indicating that in these two cases the controller of the system was not an ideal integral controller, although it changed less than did the reference signal.

hca and an hierarchical supply–demand interpretation
this simulation example can be represented by a hierarchical supply–demand structure such as in figure 
 <dig>  to obtain ideal integral control, both protein synthesis and protein degradation should be independent of the concentration of the protein that is being degraded . since this implies that protein degradation is zero order in protein concentration:

  ϵesb=ϵesa= <dig> 

so that the hierarchical control coefficient of the metabolite concentration becomes

  hsx=1ϵxd-ϵxs-ϵess⋅ϵxaϵesb-ϵesa=1ϵxd+-ϵxs+ϵess⋅-ϵxa0= <dig> 

here
ϵesa=ϵevtrnl,
ϵesb=ϵeved,
hsx=h3x <dig> for the biosynthetic pathway example. because the hierarchical control by supply and demand must add to zero , also the control by demand on the metabolite concentration becomes precisely equal to zero in the zero order protein degradation case.

feed-forward activation: a case study of a leucine biosynthetic pathway
in previous sections, either a metabolic intermediate  or a penultimate product  inhibited or repressed upstream enzymes. in this section a different regulatory structure is investigated, one in which a metabolite activates downstream enzymes through gene-expression. a simplified mathematical model describing the leucine biosynthetic pathway in saccharomyces cerevisiae <cit>  is used to demonstrate that the analysis integrating hierarchical supply–demand theory and control engineering continues to apply. the pathway converts pyruvate to leucine by the sequential reactions described in figure 
 <dig>  there are two major regulatory mechanisms in the pathway. one is a metabolic feedback inhibition of leu <dig> and leu <dig> by leucine, which is an end-product module similar to the ones discussed above. the other is the transcriptional  activation of downstream enzymes leu <dig>  and leu <dig>  by αipm  , which we shall call initial-product modules . the model predictions fit the experimental data and all the parameter values have been estimated and provided in
 <cit> .

the hierarchical control coefficient quantifying the control of supply enzymes es with respect to the concentration of i <dig>  can be expressed into the various elasticity coefficients ,

 hsi1=1ϵi1d+ϵe1dca1e1ϵi1a1+ϵe2dca2e2ϵi1a2-ϵi1s=1ϵi1d-ϵi1s+ϵe1d⋅ϵi1a1ϵe1b1-ϵe1a1+ϵe2d⋅ϵi1a2ϵe2b2-ϵe2a <dig> 

and its value can be computed from the simulation of the pathway model by perturbing eu and recording the changes in the steady state value of i <dig>  this led to
hsi1= <dig> . the hierarchical control coefficient is small but not zero, which indicates that the regulatory network can react and adapt to this external perturbation although the adaptation is not ‘perfect’.
 <dig> 

the closed-loop control system structure of the downstream gene-expression activation is the same as that of the upstream inhibition case described in figure 
 <dig> . it is still a negative feedback control rather than a feed-forward control in the control context: for a negative feedback control system, a change  in some controlled variable will result an opposite change  in the operation of the process itself in such a way as to reduce changes. for the end-product module given in , when e <dig> increases the concentration of the end product xn also increases, whilst as xn increases e <dig> would decreases as a result of negative feedback inhibition . hence this is a negative feedback control system, since when e <dig> increases the system attempts to reduce such an increase. for case of the positive activation of downstream enzyme by a metabolite upstream of that enzyme ), when e <dig> increases the concentration of x <dig> decreases since it is a downstream enzyme, while e <dig> would also decreases as x <dig> decreasing because of the positive feed-forward activation. this gives the same result as the end-product case. herewith, both two systems are negative feedback control system in the control context and both can be represented by the same feedback control structure as given in figure 
 <dig> 

in this model, the protein degradation rates purely depend on the dilution effects, and the estimated growth rate of μ =  <dig>  min-1 =  <dig>  × 10-5 s- <dig> is very small as compared to metabolic turnover times and may imply the existence of a quasi-integral control scenario. for testing, a simulation study is provided where a 50% increase on the kcat of the first reaction is applied at 800 minutes as an environmental perturbation, the calculated concentration changes of the intermediate metabolites are shown in figure 
 <dig>  this perturbation could be due to an allosteric activation by a substance added to the system. the concentrations of both αipm and βipm reach new steady states. the differences between the new and the old steady-state values are around 7% and 20% respectively. again, the adaptation is imperfect; the two concentrations are robust but not infinitely so.

CONCLUSIONS
in this paper, two existing approaches to the analysis of the robustness and adaptation of networks have been integrated: control engineering and mca. the former designs control structures for networks that lead to optimal behaviour, for instance in terms of ‘perfect adaptation’ leading to infinite robustness. the latter quantifies the extents to which processes in a network determine fluxes and concentrations and identifies the molecular interactions that determine the corresponding distributions of control. two extensions of mca have also been integrated into our analysis, i.e. hca adding the possibility to analyse regulation through gene expression, and supply–demand theory, greatly simplifying the analysis towards understanding of the essence. we also integrated the two latter approaches into a novel hierarchical supply–demand theory. the steady state properties of exemplary metabolic pathways served as test cases; they were analysed in terms of the robustness of their steady state properties. they included a pathway of free energy transduction, a pathway with feedback inhibition and repression, and a pathway with feed-forward regulation. most substrates for the synthesis of macromolecules such as proteins and nucleic acids are the end product of such pathways, making this analysis important for the understanding for the control of cell growth.

we then used the resulting framework to address the question whether metabolic pathways regulated by both metabolic interactions and through gene expression, come close to the ideal control structures designed in control engineering. we focused on the control structures leading to so-called ‘perfect adaptation’ , as defined by  complete robustness of the concentration of the pathway’s end product towards perturbations in supply and demand,  perfect tracking of perturbations by variables involved in the adaptation. control engineering distinguishes between proportional, derivative and integral control and showed that of these only integral control loops produce perfect adaptation. in a hierarchical control analysis, in a hierarchical supply–demand analysis, as well as in a number of computer simulations, we showed that such perfect adaptation  should not be expected for the usual gene-expression regulation pathways, even though they seem to engage in integral control. although that integral control increased the robustness of the concentration of the pathway product vis-à-vis perturbation in the activities of metabolic enzymes, that robustness was not perfect, except for the singular case where the metabolic enzymes would be infinitely stable. for complete steady states, such infinite stability should not be considered realistic.

we expected that for cases where proteins are highly, adaptation of the anabolic networks studied should be high even if not quite perfect. this was however not much observed. hca can show that this is not to be expected either. the perfectness of the adaptation of the networks in complete steady state should not be a function of the magnitude of any first-order protein degradation rate constant, but rather a function of the order of the protein degradation reaction, or to be precise, of its elasticity coefficient: the protein degradation should be zero order in protein concentration for the adaptation to become perfect.

because gene expression regulation involves a time integral that is a function of changes at the level of the metabolic pathway, we suggest that at least when applied to biological systems, control engineering is extended so as to explicitly include such ‘integral control’ loops even if they do not lead to perfect adaptation. by adding the subtlety of hca one can then analyse how perfect the adaptation furnished by the integral control loop actually is. we propose a simplification of the control-engineering concept of ‘proportional control’ to the more general case where the adaptation is any function of the displacement of the controlled variable but neither a function of the time integral nor the time derivative of that displacement. that function could be more complex than the proportionality used in control engineering and thereby be realistic for biochemical networks, thereby making control engineering much more useful for the life sciences. perhaps the terms ‘proportional control’ should then be replaced by ‘direct or metabolic control’ , referring to the direct nature of the interactions.

metabolic networks typically have more than one metabolic intermediate and when the network is perturbed by affecting a process activity, many metabolite concentrations tend to change. if it is of particular interest to maintain one of these as constant as possible whereas variations in other metabolite concentrations are less detrimental to biological function, then the former may be designated as the ‘controlled variable’ and the latter as ‘manipulated variables’ in the control engineering analysis. because many enzymes do not serve a function other than through the reaction they catalyse, they may be the more obvious ‘manipulated variables’. on the other hand it may well be that some metabolite concentrations serve as ‘manipulated variables’ with the sole function of providing near perfect control loops. camp might be an example.

integral control loops do not require gene-expression regulation. also in exclusively metabolic networks, integral control may arise. an example would be a linear pathway with the penultimate metabolite affecting the first reaction of the pathway, whilst its degradation rate is independent of its concentration. if the first step of the pathway is then perturbed, the concentration of the penultimate metabolite will be a function of the time integral of the perturbation of the first metabolite concentration in the pathway, and it may effect perfect adaptation. on the other hand, if the degradation rate of that penultimate metabolite were first order, then that concentration would be a direct function of the concentration of the first metabolite of the pathway, and the regulation would turn into proportional rather than integral control. in hindsight, reference
 <cit>  was an early example of this.

as shown at length in the present paper, gene-expression regulation does not always lead to perfect adaptation. indeed, if protein degradation is first order, then the deviation in the concentration of the enzyme may well be proportional to the perturbation in the controlled variable and one effectively obtains ‘proportional control’ through gene-expression regulation. we conclude that whether control loops correspond to the integral or proportional category of control engineering depends on the elasticity coefficients  of the reactions involved with respect to the controlled variable, rather than on time integration being involved. the extension of control engineering with hierarchical control analysis that was initiated here, may well provide the subtlety that helps analyse the complex networks that mankind is confronted with today, both in the life sciences and in economics and environmental sciences. it may also help design new and better networks, if only for synthetic biology and biotechnology.

we intend the present work to serve as a beginning of a development where multiple principles of control engineering may be compared with achievements by biological evolution. one example where the present work may be extended to is the case where rather than that one piece of dna encodes three metabolic enzymes , one metabolic enzyme catalyses reactions in three metabolic modules in the metabolic network: a multifunctional enzyme. the gene expression of that enzyme may be regulated by metabolites in all three modules. this is a type of network structure that control engineering may come up with as serving a function of coordination. and it will be of interest whether this type of network may serve a similar function in biology.

appendices
a. the initial-product module

the initial-product feed-forward regulation module given in figure 
 <dig> can be mathematically described by the following differential equations:

  x˙1t=v0-e1f <dig> p)x˙2t=e1f <dig> p)-e2f <dig> x3)⋮⋮⋮x˙nt=en-1fn- <dig> xn)-enfn)e˙1t=g)-kede <dig> 

the first reaction here is still assumed product insensitive and other factors p can act on the enzyme. different from the end-product module, the function g is assumed to be an increasing function of its argument. it has been demonstrated in
 <cit>  that if a constant steady-state regimen exists, the following simple relationship should be satisfied, with
e¯1=gx¯1/ked and
gx¯1/ked⋅f1x¯1=v <dig>  here, it is assumed the intermediate reactions of the metabolic pathways do not ‘saturate’.

b. calculation of global and local control coefficients in a supply–demand system
according to the summation and connectivity laws, for a supply–demand system, we have

 cdj+csj=1cdxn+csxn=0cdj⋅ϵxnd+csj⋅ϵxns=0cdxn⋅ϵxnd+csxn⋅ϵxns=- <dig> 

by solving the above four equations, the ‘global’ concentration and flux control coefficients with respect to the supply and demand steps can be derived as

 csxn=1ϵxnd-ϵxns,cdxn=-1ϵxnd-ϵxnscsj=-ϵxndϵxns-ϵxnd,cdj=ϵxnsϵxns-ϵxnd 

the expressions of the ‘local’ flux control coefficients given in  can be obtained by solving the following summation and connectivity laws with respect to the local linear pathway within the supply module as given in figure 
 <dig> 

 c1j1+c2j1+⋯+cn-1j1=1c1j1ϵx2v1+c2j1ϵx2v2=0⋮cn-2j1ϵxn-1vn-2+cn-1j1ϵxn-1vn-1= <dig> 

c. steady state analysis of the atp metabolism example
the steady state values of adp and e before the perturbation are determined when d/dt =  <dig> and de/dt = 0:

  ess=kd⋅c-adpssks⋅adpssadpss=kb⋅ess+k0ka 

and

  k0=ka⋅adpss-kb⋅kd⋅c-adpssks⋅adpss 

it is assumed that cell function requires adp concentration to be at a certain level  and that in the absence of the perturbation; the cell has adjusted ess and the rate constant k <dig>  to meet this requirement. we assume that the cell will do this also at different values of kb. the implication is that if different values of kb are considered, ka is also different as defined by .

considering a perturbation of kd from its steady state value, one finds for the time dependence of the variation in the enzyme level:

  δe˙=ka⋅δadp-kb⋅δe 

and for the time dependence of the variation in the level of adp:

  δadp·=-ks⋅ess+kd⋅δadp-ks⋅adpss⋅δe+c-adpss⋅δkd 

by integrating the time dependence of the change in enzyme level δe in  into  one finds . by substituting the steady state condition of ess in ,

  δadp·=-kd⋅c⋅δlnadp-ks⋅adpss⋅δe+c-adpss⋅kd⋅δlnkd 

for that change in adp level to be time independent, the integrand in the integral control term should equal zero around steady state, so that:

  δe=kakb⋅δadp 

by using this expression to eliminate the change in enzyme level from  for the time dependence of the change in adp level and set the latter to zero, the robustness coefficient in  can be obtained. similarly, by using  to eliminate the change in adp level from , the control of enzyme level  can be obtained.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
fh and hvw jointly discussed and developed the main ideas of paper, and both authors wrote the manuscript. fh developed the hierarchical supply–demand theory, proposed the control engineering analysis of the regulatory systems, and implemented the simulation studies. hvw provided the mca and hca analysis, developed the first atp metabolism example, identified the three terms in control analysis, and interpreted the results biochemically. vf contributed to the kinetic analysis of the end-product and initial-product modules. all authors read and approved the final manuscript and hvw rewrote the final version.

