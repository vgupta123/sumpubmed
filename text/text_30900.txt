BACKGROUND
the high-throughput and cost-effectiveness of dna pyrosequencing using  <dig> life sciences technology  <cit>  has been successfully applied to large-scale est sequencing in maize  <cit> , medicago  <cit>  and arabidopsis  <cit> , resulting in a significant contribution of additional ests for these species. however, these studies were carried out on organisms with extensive transcriptome sequences already available. pre-existing sequences support the assembly of  <dig> reads into contigs, thereby minimizing the drawback of short average read length  produced by the pyrosequencing technology. however, the benefits from recent improvements in sequencing technologies may be even more valuable for plant species with high economic value but limited genomic resources. yet, it has not been shown whether the primary limitations of the pyrosequencing method – short read lengths and ambiguous homopolymer reads – can be overcome to produce useful information for species with essentially no prior gene sequence information.

the  <dig> sequencing also provides an opportunity to identify allelic variants by sequencing and aligning ests from several haplotypes. recently, two  <dig> cdna sequencing runs, each interrogating a single maize inbred line, were used to identify over  <dig>  putative single nucleotide polymorphisms   <cit> . snp discovery with  <dig> technology could also be accomplished by simultaneously sequencing multiple genotypes to sample the nucleotide diversity of an organism  <cit> . however, the assembly of individual haplotypes is not feasible when sequencing a cdna pool from highly heterozygous individuals. the unavailability of haplotype sequences hinders the use of most statistics to calculate genetic diversity. therefore, new models are needed to estimate population genetic parameters.

here we describe sequencing, assembly, and snp discovery from 454-derived est sequences of eucalyptus grandis, a species with virtually no public genome sequence information. eucalyptus is the most widely planted woody angiosperm in the world  <cit> . because of its value as a renewable source of raw material for wood, paper products, and biofuels, e. grandis has been selected for sequencing by the u.s. department of energy/joint genome institute for completion in  <dig>  <cit> . accurate annotation of the e. grandis genome sequence will rely heavily upon a repository of expressed sequences, as was demonstrated during the annotation of the arabidopsis  <cit>  and populus  <cit>  genomes. however, only  <dig>  e. grandis expressed sequence tags  are currently deposited in the national center for biotechnology information  database. thus, rapid development of a large est sequence collection will be crucial to support the e. grandis genome sequence annotation and for continued advancement of eucalyptus genomics research.

with the purpose of generating the first broad survey of genes in a eucalyptus species, we sequenced and assembled  <dig> mbp of e. grandis ests from two gs- <dig> and one gs-flx  <dig> pyrosequencing runs. assembled sequences  were deposited in the genbank representing a 37× enrichment in publicly available expressed sequences for the species. sequences were generated from a normalized cdna pool comprised of multiple tissues and genotypes, promoting extensive gene discovery and a comprehensive survey of allelic variation in the transcriptome. we demonstrate that  <dig> reads can be reassembled into contigs without utilizing traditional cdna sequences as scaffolds. in addition, we show that snps detected from pyrosequencing a pool of genotypes are useful to reveal selection signatures among genes. pyrosequencing technology can rapidly provide a foundational public genomic resource for an economically important but previously uncharacterized species.

RESULTS
 <dig> pyrosequencing and assembly of e. grandis ests
an e. grandis normalized cdna library was synthesized from rna of vegetative tissues sampled from  <dig> different genotypes. two gs- <dig> and one gs-flx  <dig> pyrosequencing runs performed on the normalized cdna pool generated  <dig> , <dig> reads comprising  <dig>  mbp of sequence . the gs-flx platform produced more reads than the gs- <dig> and an average read length 2× longer. to compare the length distributions of contiguous sequences  using the different  <dig> platforms, we separately assembled the reads from the two gs- <dig> runs, the gs-flx run alone, and from all the three sequencing runs combined . the two gs- <dig> runs generated contigs measuring  <dig> bp on average, with 95% of the contigs being shorter than  <dig> bp. despite generating only 25% more sequence than the gs- <dig> runs combined, the longer reads obtained with the gs-flx platform render contigs that average almost three times longer . the gs-flx run allowed assembly of the e. grandis 454-derived expressed sequences into long contigs that could be more accurately annotated. assembly of all three pyrosequencing runs generated  <dig>  contigs with an average length of  <dig> bp, of which  <dig>   measure more than  <dig> bp. the addition of gs- <dig> reads increased the number of short contigs in the full assembly, resulting in shorter average contig length when compared to the assembly with gs-flx reads only.

 summary of the e. grandis expressed sequences generated with gs- <dig> and gs-flx pyrosequencing runs, and control ests obtained from dideoxy-based sequencing of an analogous eucalyptus library

next we compared the sequences from  <dig> with  <dig>  ests obtained from a proprietary database derived from sequencing a broad set of eucalyptus cdna libraries using conventional  dideoxy-based sequencing . the comparison shows that although sanger contigs were built from a dataset with only one third the total basepairs of that derived from  <dig>  they are on average more than twice as long . however, the larger number of reads generated by the  <dig> technology substantially improves the efficiency of gene discovery, as demonstrated below.

annotation of the e. grandis ests
an e. grandis unigene set was generated by combining all  <dig>  assembled contigs and  <dig>  non-assembled reads  generated by the three  <dig> runs. the unigene set was annotated by searching for sequence similarities using blastx against arabidopsis , populus  and oryza  gene models. as expected, the likelihood of finding similarity to previously described gene models is highly dependent on the length of the query sequence . logistic regression testing the effect of sequence length on whether or not the query sequence have at least one blastx hit  was highly significant . for instance, sequences longer than  <dig> bp have significant similarity  with gene models from all three species in 96% of cases, whereas 88% of sequences shorter than  <dig> bp have no similarities to any annotated gene model. among  <dig>  unigenes longer than  <dig> bp 38% have similarity to at least one gene model at an e value of 10- <dig>  28% at an e value of 10- <dig>  and 15% at an e value of 10- <dig> . the low proportion of blastx hits is mainly due to the high frequency of shorter sequences .

next, we determined the proportion of annotated gene models for which homology was detected among e. grandis unigenes measuring over  <dig> bp. homology was detected to 45% of arabidopsis, 39% of populus, and 22% of oryza gene models . the higher proportion of arabidopsis genes that are apparent homologues to eucalyptus is expected as the two species are more phylogenetically related than to populus or oryza  <cit> . arabidopsis gene models are also more refined than those from the other plant species. analyzing only the  <dig>  arabidopsis gene models for which there is any detected transcript evidence  leads to a higher proportion of homologies: 58% with e value 10- <dig> and 39% with e value 10- <dig> . finally, we utilized the gene ontology  classifications from the arabidopsis best-hit gene models . proportions of best hits in each go category were generally similar to those found in the arabidopsis genome annotation . the go annotation analysis reinforces the inference that a broad diversity of genes was sampled in our multi-tissue normalized cdna pool.

number and percentage of gene models with matches against the e. grandis  <dig> unigenes and against the control sanger sequenced eucalyptus unigenes using three different blastx thresholds. the number of genes in each organism is presented in parenthesis in the first column.

efficiency of gene discovery:  <dig> and sanger sequencing comparison
to compare the efficiency of gene discovery in the two sequencing platforms  we established a unigene set for the sanger sequenced ests by combining the  <dig>  contigs with  <dig>  singlets. the sanger unigene set has a total of  <dig>  mbp, and is therefore comparable to the  <dig>  mbp in the e. grandis  <dig> unigenes measuring over  <dig> bp. we first aligned the two unigene sets to each other using blastn , and detected 84% of the sanger unigenes having a match to the  <dig> dataset but only 41% of the  <dig> unigenes having homology to the sanger sequences . this is an indication of a greater coverage of distinct cdnas in the  <dig> derived sequences. however, it is possible that the higher frequency of shorter sequences found in the  <dig> dataset contributed to an increased number of no-hits, as shorter sequences are less likely to align with a significant e-value. to rule out this possibility, sanger unigenes were also used in an analogous blastx against the arabidopsis, populus and oryza gene models. for all organisms and all blast thresholds applied, a larger number of gene models had similarity to the  <dig> unigenes than those generated by sanger sequencing . therefore, the large number of reads generated by  <dig> pyrosequencing appears to maximize gene discovery in est sequencing projects. on the other hand, mean blast alignment lengths using the  <dig> unigenes are approximately 2× shorter than for the sanger unigene set . thus, although the  <dig> unigene set samples a broader diversity of transcriptional units, this occurs at the cost of decreased length of sequence of the individual genes.

snp detection and validation in the e. grandis 454-generated ests
the gs reference mapper  software was used to identify polymorphisms among ests by aligning individual reads against contigs from the assembly. for a sequence difference to be declared a true polymorphism, at least two individual reads aligning to the consensus must have the variant allele and at least two others must have the allele of the consensus. by applying this criterion,  <dig>  variants were detected in  <dig>  contigs . we analyzed only single nucleotide polymorphisms  and excluded all  <dig> indels and  <dig> variants involving more than one nucleotide. also, we considered only  <dig>  higher confidence snps for which both alleles were present in at least 10% of the reads aligned at the polymorphic locus. although this requirement reduces the sensitivity in detecting rare snps, it increases the specificity of true snp detection by lowering the likelihood of including false variants that arise due to sequencing errors. among both high and low confidence snps, the proportion of transition nucleotide substitutions  was greater than the proportion of transversions .

 number of detected polymorphisms and affected contigs by variant type. the higher confidence snps were selected for further analysis

to validate snps detected by gs reference mapper, we pcr amplified a sample of  <dig> contig sequences from the normalized cdna used in the  <dig> sequencing. each amplicon was sequenced bidirectionally  using standard dideoxy-based sequencing in an abi <dig>  sequencing chromatograms were analyzed with chromas  <dig>  , and snps were identified as overlapping nucleotide peaks. the number of putative snp loci encompassed in the sequences of each amplicon ranged from  <dig> to  <dig> . of  <dig> snp loci predicted to reside in the amplified sequences,  <dig>  were validated.

number and percentage of non-validated and validated snps for each of the  <dig> amplicons sequenced with dideoxy-based method

analysis of synonymous and non-synonymous snps in e. grandis genes
the proportion of mutations that change amino acid sequence  relative to those that do not  can indicate whether a gene is under purifying, neutral or diversifying selection  <cit> . the large number of ests sequenced from a mixture of genotypes could provide information for a genome-wide analysis of gene evolution based on the ratio of non-synonymous  to synonymous substitutions . to carry out this analysis, we initially determined whether snps introduce synonymous or non-synonymous mutations by  defining the sequence reading frame with a blastx alignment against arabidopsis peptides,  isolating codons containing snps, and  comparing the translated amino acids for each allele. next, the degeneracy of nucleotides in the contigs' coding sequence was evaluated to estimate non-synonymous to synonymous substitution rate . we estimated ka/ks for  <dig>  e. grandis contigs that have at least three high confidence snps and one positive blastx hit against arabidopsis gene models  . distribution of ka/ks among these contigs was right-skewed, with estimates ranging from  <dig>  to  <dig>  and averaging  <dig> , suggesting that the majority of the genes are under purifying selection.

gene ontology  categories associated with contig annotations derived by homologies to a. thaliana gene models allowed us to compare frequency of go class representation in the extremes of the ka/ks distribution. two binary variables  were created to classify contigs according to their ka/ks – contigs with ka/ks smaller than  <dig>   were classified as "purifying", while those with ka/ks greater than  <dig>   were defined as "diversifying". ka/ks >  <dig>  may be an overly stringent criterion of positive selection when estimated for the whole coding sequence  <cit> , and therefore we utilized a lower threshold  for this analysis. a fisher's exact test for each binary category was used to statistically define go biological process classes enriched in the ka/ks distribution extremes. table  <dig> depicts go classes enriched  among contigs on the two ka/ks extremes. genes encoding proteins of the ribosome complex and involved in translation are the most significantly enriched  within the "purifying" classification. in addition, genes encoding proteins involved in nucleosome assembly, chromosome organization and proteosome complex also appear to be constrained by purifying selection. among go categories of genes undergoing diversifying selection, there is enrichment for only those with unknown function and organismal development.

a the "purifying" extreme is composed of contigs with ka/ks smaller than  <dig> , while the "diversifying" extreme has contigs with ka/ks greater than  <dig> .

biological process go categories enriched  in each of the two extremes of ka/ks distribution.

nucleotide diversity among the e. grandis genes
in addition to the ratio of non-synonymous to synonymous substitutions , a measurement of nucleotide diversity can also reveal differences in selection pressure acting on different genes. however, since our sequencing method generated ests from a pool of  <dig> e. grandis genotypes, identification of the genotypic origin for each read becomes impossible. as a result the assembly of individual haplotypes is unfeasible and exact estimation of standard nucleotide polymorphism parameters such as theta   <cit>  could not be obtained. thus, we developed a relative measurement of nucleotide diversity, referred hereafter as beta , which normalizes the number of polymorphisms detected relative to the sequence length and depth of each contig. sequence length and depth are variables affecting the likelihood of finding snp when it is present in a given contig. the parameter β is estimated by the equation:

 β=∑i=1d− <dig> 

where s is the number of snps detected in the contig, l is the contig sequence length and d is the sequencing depth estimated by the average number of reads aligned to each nucleotide position during assembly of the contig. the constant  <dig> was added to the number of snps in the numerator to enable comparisons with contigs containing no detected snp. contigs with extensive length and depth but for which no snp is detected represent highly conserved genes.

there is one important distinction between β and the traditional nucleotide polymorphism estimate θ. when calculating θ, the average sequencing depth  variable in β is, instead, the number of different sampled haplotypes. these two variables are different because sequence reads from  <dig> represent a random sample from the pool of haplotypes in the cdna library. therefore some haplotypes may be sequenced multiple times, while others may not be sampled at all. although this complicates comparisons with θ estimates from other studies, β is useful as a relative measurement to compare the nucleotide diversity between contigs generated within this project.

we estimated β for the  <dig>  contigs with coding sequence measuring more than  <dig> bp and an average sequencing depth of at least  <dig> reads/nt . these thresholds reduce imprecision in the proportion of snps per nucleotide as well as the likelihood that all reads aligned to the contig on a given nucleotide arise from the same haplotype. three β parameters were calculated for each contig: βt, which estimates the diversity on the entire contigs, including its non-coding regions; βn, which estimates the diversity in non-synonymous sites; and βs, which estimates the diversity in synonymous sites. as observed for the ka/ks ratio, the distributions of all three nucleotide diversity parameters  were right-skewed, suggesting that the majority of e. grandis transcribed regions are constrained by purifying selection. average values of βs were more than 4× larger compared with diversity in non-synonymous nucleotides , offering further evidence for the action of natural selection on the genetic diversity detected in these genes.

distribution summary of three nucleotide diversity parameters estimated for  <dig>  contigs.

the annotation of each contig from homology to a. thaliana gene models was again used to compare go categories enriched in the extremes of the βn distribution. similarly to ka/ks, two binary variables were empirically created to identify genes on the "conserved" and "diverse" extremes of the βn distribution. the "conserved" classification has  <dig> contigs with βn smaller than  <dig>  × 10- <dig>  the "diverse" classification has  <dig> contigs with βn greater than  <dig>  × 10- <dig>  fisher's exact test for each binary category detected go classes enriched among each of the two βn extremes . as suggested by the ka/ks analysis for genes undergoing purifying selection, the "conserved" extreme of βn is also enriched for genes encoding proteosome core factors involved in protein degradation. in addition, in the conserved extreme we also found enrichment for genes involved in malate metabolism. among contigs classified as "diverse", there is enrichment for genes of unknown function and for genes involved in defense response, including response to biotic stimuli.

a the "conserved" tail is composed of contigs with βn smaller than  <dig>  × 10- <dig>  while the "diverse" tail has contigs with βn greater than  <dig>  × 10- <dig> 

biological process go categories enriched  in each of the two extremes of βn  distribution.

discussion
our analysis of  <dig>  mbp of e. grandis expressed sequences generated with three  <dig> sequencing runs demonstrates that short reads produced with pyrosequencing technology can be assembled de novo into reasonably long contigs; an advantage for species with limited public genomic resources. the  <dig>  mbp comprised in our unigene set represents an enrichment of 37× in the amount of publicly available e. grandis expressed sequences, and will provide substantial support for the genome sequencing and annotation that are currently under way  <cit> . longer reads from the gs-flx were essential to assemble a reasonable proportion of biologically relevant contig sequences. although our sequencing effort produced three times more sequence  than the control dideoxy-based est library , the  <dig> short read-based contigs average only one third of the size. despite this limitation, a substantial gain occurs at the level of gene discovery – the large number of reads in our  <dig> dataset leads to sampling of sequences from a much broader variety of genes. therefore, 454-based gene discovery projects represent a viable and, perhaps favorable alternative to sanger-based sequencing of est libraries when a diverse sampling of genes is more important than obtaining transcript-length contigs. as gs-flx becomes the standard  <dig> pyrosequencing platform, large-scale est sequencing and gene discovery projects will be more successful in assembly of transcript-length contigs.

we also demonstrated that the detection of valid snps is possible by sequencing a pooled sample of highly heterozygous genotypes. by aligning the reads derived from cdna of  <dig> e. grandis genotypes, we were able to detect  <dig>  snps and validate 83% of a sample of  <dig>  therefore, approximately  <dig>  of the detected snps may be false positives, possibly arising from sequencing errors or alignment of paralogs. paralogs that share high levels of sequence similarity may have been assembled in the same contig because they cannot be distinguished due to the short read length of  <dig> pyrosequencing. this would lead to the detection of false snps. on the other hand, a higher stringency of assembly raises the possibility of the opposite problem: the separate assembly of haplotypes from highly polymorphic genes. however, the assessment of the est assembly quality in this study is difficult due to the lack of a reference genome sequence. nonetheless, the validation rate observed here was similar to the 85% reported for maize, where snps were detected by comparing sequences from two separate  <dig> runs, each interrogating a different inbred homozygous line  <cit> .

a significant number of polymorphisms in our sample may have been overlooked because of the stringent methodology used to declare snps. for contigs with reasonable sequence coverage  and depth  we detected one snp for every  <dig> bp on average. this rate of snp discovery appears low compared to previous reports of one snp every ≈  <dig> bp in coding sequences of eucalyptus  <cit>  and other forest species  <cit> . there are at least three foreseeable reasons for missing true snps that are intrinsic to our experimental methodology and snp detection approach. first, because  <dig> was used to randomly sequence cdnas, not all genotypes were sequenced for every snp locus – in fact, the average sequencing depth  in our experiment is far lower than the number of possible haplotypes in our sample. secondly, the requirement that a snp be observed in at least 10% of the reads aligned to a polymorphic site compromised the sensitivity required to detect rare alleles. studies have demonstrated an excess of rare alleles in natural populations of forest tree species  <cit>  which are probably largely discarded by our approach. additionally, there is a relatively high level of relatedness among the  <dig> individuals utilized in our study. the sampled genotypes come from seven open-pollinated families – i.e. seven groups of three individuals share one common maternal parent, limiting the genetic diversity sampled relative to what might be present in a similarly sized sample of unrelated trees. finally, the detection of polymorphisms was likely hindered by the requirement that at least two reads containing the variant alleles have at least  <dig> nucleotides of conserved sequence upstream and downstream of the locus. this requirement is intended to minimize the discovery of false polymorphisms due to the alignment of paralogs – a potentially significant problem when aligning short sequence reads. therefore, only nucleotide variants in relatively conserved or recently derived paralogs may have been incorrectly identified as snps. the drawback is that true snps in hotspots of genetic diversity or genes under high diversifying selection  may be discarded. considering the high diversity found in forest trees  <cit> , the requirement for sequence conservation in regions surrounding a snp may be too conservative.

high throughput dna sequencing and snp discovery from a pool of multiple genotypes may be a powerful approach for rapid assessment of genetic diversity and selection in a genomic scale. genome-wide surveys of genetic diversity have only recently been reported in the model plant arabidopsis  <cit> . here we attempted to generate an approximate estimate of genetic diversity for a broad sample of genes by adapting existing parameters of genetic diversity to our experimental methodology. the most commonly used measure of genetic diversity, the nucleotide diversity parameter theta , is an estimate of the number of polymorphic sites in a random haplotype sample from a population and is independent of the allele frequencies  <cit> . in our study, the number of independent haplotypes sampled is unknown, as the same haplotype may be sampled repeatedly. therefore we developed a modified nucleotide diversity estimator beta  based on snps detected by randomly sequencing a multi-genotype cdna pool. β is always underestimated relative to θ, because the number of reads at a given snp position is always equal or smaller than the effective  number of genotypes. the lower sensitivity to detect snps discussed previously also contributes to the underestimation of β. therefore, the average β reported here  is, as expected, much lower than the average θ estimated for genes of populus by 9×  <cit> , douglas fir by  <dig> ×  <cit> , loblolly pine by  <dig> – <dig> ×  <cit>  and norway spruce by  <dig> ×  <cit> . although it is not possible to compare estimates of β to the commonly used θ, they are useful for a comparison of nucleotide diversity among genes in this project.

in addition to the nucleotide diversity  we also estimated the proportion of non-synonymous to synonymous substitutions . as observed in other plant species  <cit>  most genes of e. grandis appear to be under purifying selection and, accordingly, ka/ks distribution averages  <dig>  and is heavily right-skewed. among genes predicted to be under strong purifying selection based on the ka/ks ratio, there is enrichment for go categories involving essential biological processes conserved across kingdoms, such as translation, ubiquitin-dependent protein degradation and nucleosome assembly by histones. rrna and ribosomal proteins have been shown to be highly conserved between species and to evolve under strong purifying selection  <cit> . several studies also confirm that histone genes evolve constrained by negative selection  <cit> .

among genes classified as diverse and/or under positive selection based on βn and ka/ks distributions, there is enrichment for genes classified as unknown biological process, defense response and response to biotic stress, and multicellular development. other researchers have already reported an excess of unknown function among genes under positive selection  <cit> . a possible explanation for this overrepresentation is that the category of uncharacterized genes may be enriched for duplicated genes where relaxed selection constraints are leading their diversification and/or eventual silencing  <cit> . in fact, the category may include pseudogenes and transcribed but untranslated loci. it is also possible that duplicated genes might have higher nucleotide diversity due to the assembly of paralogs. however we do not anticipate false snps to bias ka/ks estimates because they are not expected to occur more or less frequently in synonymous versus non-synonymous sites by chance.

genes acting in defense response/response to biotic stimulus are frequently positively selected for diversification to compete with rapidly evolving avirulence genes of pathogens  <cit> . we did find extensive diversity in non-synonymous sites  of most defense response genes, but the diversity was also high among synonymous sites and, as a result, these genes were not enriched among those under diversifying selection . similar results were reported in another study  <cit> . one possible explanation is that positive selection generally only operates in certain domains ) of resistance genes  <cit>  and we estimated ka/ks over the entire coding sequence. the multicellular development go class which is enriched among genes under diversifying selection is mainly due to the presence of nac transcription factor genes. transcription factors have been demonstrated to have an excess of positively selected genes in humans  <cit> , and specifically one member of the nac family was shown to be evolving rapidly in arabidopsis  <cit> . finally, the literature survey supports our results and demonstrates that the proposed nucleotide diversity estimator  accurately depicts relative differences of variability within gene sequences.

CONCLUSIONS
the unigene sequences being released from this study will provide a much needed public resource for eucalyptus research and will be important for the annotation of the forthcoming e. grandis genome sequence. 454-based est sequencing and de novo assembly can provide a foundational transcriptome resource when limited prior sequence information is available. lastly, we showed that nucleotide diversity of an organism can be sampled by high-throughput sequencing a pool of genotypes, and that this strategy is useful for detecting evolutionary signatures in a large number of genes that are in agreement with smaller scale traditional sequencing projects.

