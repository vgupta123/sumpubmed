BACKGROUND
all of the species living within a particular environment comprise a complex biological community. various and complicated interactions exist between all the species in the community. ecology is the scientific analysis and study of the interactions between living organisms, including humans, and their physical surroundings. it is the branch of biology concerned with the relations between organisms and the environment. traditionally, ecological research strategies have been limited to organisms with well-characterized habitats. this strategy, however, can only be applied on a small scale and to relatively well-understood biological systems. unfortunately, very few  microbial organisms can be cultured in a laboratory, and, therefore, most have not been adequately characterized, particularly from an ecological perspective  <cit> .

with the development of next-generation sequencing technologies and community genomics, the full genomic information for species whose ecology and habitat are largely uncharted can now be easily collected. specifically, next-generation sequencing-based metagenomic sequencing now allows researchers to investigate the genomes of all species present in a given complex environment. this technology enables microbiologists to study unculturable microorganisms that have previously not been well studied. metagenomics advances the study of microbial communities on the most fundamental genomic level, and has emerged as a powerful tool for research of the microorganisms living in microbial communities. the structure of complex biological systems in microbial communities reflects not only their diversity and function, but also the environments in which they live  <cit> . however, most recent metagenomics research has primarily focused on species diversity analysis and the functional study and identification of marker genes correlated with host state detection, and neglects the interactions between various species and their natural environment. a systematic approach for describing microbiome ecologies and the interactions between microbiota is lacking. to address this challenge, a systems biology approach called reverse ecology has been developed to study the complex interactions and species composition of microbial communities  <cit> . reverse ecology uses genomics to study community ecology with no a priori assumptions about the organisms under consideration. researchers can use it to infer the ecology of a system directly from genomic information. the reverse ecology framework uses advances in systems biology and genomic metabolic modeling and the system-level analysis of complex biological networks to predict the ecological traits of poorly studied microorganisms, their interactions with other microorganisms, and the ecology of microbial communities. several studies have applied this approach to investigate the interactions between microorganisms and their surroundings on a large scale  <cit> .

several network-based reverse ecology tools, such as netseed  <cit>  and netcooperate  <cit> , have been developed for studying the species interface with its environment and interactions with other species. unfortunately, neither netseed nor netcooperate support the metabolic network reconstruction of species, and both are limited to small-scale analyses. here, we describe revecor, a freely available, easy-to-use software for studying the interface between species and their environments on a large scale, and also for predicting the interactions between species in a given environment. revecor implements the reverse ecology framework allowing users to reconstruct the metabolic networks and study the ecology of poorly characterized microbial species from their genomic information. it has substantial potential for microbial community ecological analysis. see the revecor vignette included with the download for full function and application descriptions. an installation guide and various generic use case examples are also described in the vignette provided with the software.

implementation
this package uses genome-scale metabolic network models to predict the species interactions. to this end, functional annotated genomic data is used to reconstruct the metabolic network for each species. seed set algorithm  <cit>  is then employed to identity the species exogenously acquired compounds from its surroundings. based on the species seed set, two interaction indices, competition and complementarity index are calculated for pair of species. revecor employs igraph  <cit>  to store the metabolic networks for making network analysis efficiency, portability and ease-to-use. and data manipulation functions are built upon hadlyverse packages to make our package easy to extend, such as purrr  <cit> , plyr  <cit>  and stringr  <cit> . in the following we explain the three main features of the package mentioned above. figure  <dig> shows the revecor analysis flow chart.fig.  <dig> revecor analysis flow diagram



metabolic network reconstructions
a graph-based algorithm is used to reconstruct the genome-scale metabolic network. as shown in fig.  <dig>  there are several ways to obtain the metabolic data for metabolic network reconstruction. both the kyoto encyclopedia of genes and genomes   <cit>  and the integrated microbial genomes database   <cit>  collect complete high-quality genome sequences and metagenome sequences offering a comprehensive set of publicly available bacterial, archaeal, eukaryotic, and phage genomes, as well as engineered, environmental, and host-associated metagenome samples. all the sequences and functional annotation profiles can be downloaded directly. in revecor, function getorgmetablicdata utilizes kegg rest api to obtain the metabolic data of specific species from kegg database. in addition, users can annotate their private genomic data with kegg orthology terms on img systems or on their local machine to obtain annotation profiles.

after the microbial metabolic data are obtained, users can then reconstruct the metabolic network, in which nodes represent compounds involved in metabolism, and direct edges from node a to node b indicate that compound a is a substrate in some reaction that produces compound b.

predicting exogenously acquired compounds
exogenously acquired compounds are specified as the seed set  <cit> . the seed set is defined as the minimal subset of compounds involved in an organism’s metabolism that cannot be synthesized from other compounds in the network, and all other compounds in the network can be produced by the presence of the seed set. the seed set of a given network is predicted based on the metabolic network topology. it represents the externally acquired compounds of the species, serves as the interface between species and their environments, and can be used to calculate interactions between various species. revecor uses the kosaraju algorithm  <cit>  to decompose the metabolic network into strongly connected components. a strongly connected component  is a maximal set of vertex with no additional edges or vertices from the network can be included in the subgraph without breaking its property of being strongly connected. the seed set of the given network comprised sccs without incoming edges and at least one outgoing edge. all sccs form a collection of candidate exogenously acquired compounds. it should be noted that the seed set compounds must include exactly one compound from each scc, since if one compound in a scc can be produced then all others will be produced as well. all compounds in a given scc has the same probability be identity as a seed compound. here, we assigned a confidence score: 1/ to each seed compound, to measure the probability of each seed compound. a versatile data structure, the r s <dig> class, was taken to manage the seed set.

calculating species interactions
species in complex biological systems are able to communicate with each other. microbial ecology research has revealed that there are two primary routes of species interaction: competition and complementarity. species interactions are reflected in the topology and calculated from the seed set of species metabolic networks, based on the reverse ecology method. thus, two topology-based metrics, a competition index and a complementarity index, quantify the interspecific interactions between pairs of species  <cit> . the competition index is defined as the fraction of compounds in species a’s seed set that are also included in species b’s seed set, and provides a measure of competition between species a and b. similarly, the complementarity index is defined as the fraction of compounds in species a’s seed set appearing in the metabolic network, but not appearing in species b’s seed set, and is used to measure the support capability from species b to a  <cit> . notably, the two interaction indices are calculated as a normalized weighted sum for each seed compound is associated with a confidence score.

RESULTS
revecor software can be used for pairwise species interaction predictions from whole-genomic data. in this section, we briefly demonstrate the results from applying revecor to two datasets, a simple dataset containing seven species, and a large-scale dataset consisting of a human gut microbiome.

predicting species interactions
we applied revecor to predict cooperation among several human oral microbiota species whose co-occurrence patterns have previously been described  <cit> . human oral microorganisms have been extensively cultured and characterized, and oral species not amenable to growth in culture have been described using culture-independent molecular methods such as metagenomic sequencing  <cit> . our seven sample oral species metabolic dataset was downloaded from the img server; it consists of the following genomes online database   <cit>  img identification numbers: gc <dig>  gi <dig>  gi <dig>  gc <dig>  gc <dig>  gi <dig>  and gi <dig> 

function getseedsets is used for seed set prediction. with a valid dataset, the seed sets  were identified using the following code:

interactions among various species is calculated using the function caculatecooperationindex. species interactions can affect the evolution of species and the development of an environment, as well as the species composition in an ecosystem. both the competition and complementarity indices can be calculated using this function . 

we found that streptococcus oralis and streptococcus gordonii had the lowest complementarity index  and the highest competition index  among all pairs. this indicates that these two species are antagonistic, which is consistent with previous findings  <cit> .

comparing predicted interactions and co-occurrences
subsequently, revecor was used to investigate species interactions in a large-scale human microbiome dataset containing  <dig> samples. we focused on a list of  <dig> prevalent gut species, whose genome sequences are available in the img database and that possess sequence coverage of more than 1 % in at least one metagenomic sample of  <dig> individuals. genome annotation profiles for these  <dig> species were collected from the img database and used to calculate the interactions  for all pairs of species . abundance of these species across  <dig> samples was obtained from metagenomic analysis  <cit> . co-occurrence scores, which are calculated based on species abundances across all samples and measured by the widely-used jaccard similarity index  <cit> , were collected from carr and borenstein  <cit>  . a comparison of species interactions and co-occurrences allowed us to predict whether species competing with one another tended to co-occur or be excluded by the competitor. we found that the competition index is significantly and positively correlated with co-occurrence , whereas the complementarity index is significantly and negatively correlated with co-occurrence .

moreover, we developed a shiny-based  <cit>  application based on top of the revecor r package for the rapid, reproducible, and interactive exploration of reverse ecology analysis. shiny is an interactive web application framework for r, which is cross-platform compatible, and can be launched locally in any r environment or hosted by a remote web server. this means users without a computational background can quickly and easily perform reverse ecology analysis with shiny revecor. more details and an in-depth manual are available on the revecor app webpage . figure  <dig> shows the revecor user web interface.fig.  <dig> revecor user web interface



CONCLUSIONS
revecor delivers a graph-theory based approach to facilitate the analysis of microbial communities on a large scale. revecor can deepen our understanding of microbial community ecology, enabling the prediction of a variety of interactions in complex systems. moreover, the reverse ecology framework can also be applied to predict complex community-level differences between microbial communities  and their environments. therefore, revecor will prove useful for the analysis of microorganisms, and specifically the human microbiome.

note the current version of revecor has two limitations that we will address in future. one limitation is the computation speed, seed set identity and the p value calculation of species interaction is the main cause of slow computation. we plan to take c++ api of r in a new version of our package that alleviates the computation efficiency. the second limitation is the initial input of the software must be the annotated metabolic data, which requires extra data processing procedures to prepare the data. we are currently developing modules that will achieving this process in r.

availability and requirements
project name: revecor

project home page: https://cran.r-project.org/web/packages/revecor/index.html

operating system: platform independent

programming language: r

other requirements: r  <dig>  or higher

license: gnu gpl v.  <dig> 

any restrictions to use by non-academics: none

abbreviations
gold, genomes online database; img, integrated microbial genomes database; kegg, kyoto encyclopedia of genes and genomes; scc, strongly connected component

additional files
additional file 1: table s1: the seed sets of seven oral species. seed represents the exogenous required compound from its environment, and confidence represents the compounds probability of being a seed. table s2a-d. the competition and complementarity index of seven oral species. 

additional file 2: additional information on  <dig> gut prevalent species, including species names, species interactions and co-occurrence scores. 



