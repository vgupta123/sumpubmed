BACKGROUND
applications of the association rule have been made across multidisciplinary fields  <cit> . in biological sciences, it has been applied to analyze gene expression data. for example, becquet et al.  <cit>  developed the min-ex algorithm which applied on human sage data. this algorithm can be used for mining rules in dense boolean matrices to eliminate redundant association rules. since explore association rules is a huge computational work when boolean matrices is large, their algorithm also efficiently reduces the size of the search space. creighton and hanash  <cit>  implemented a database application with the apriori algorithm  <cit>  which is often used to explore association rules. they applied this algorithm to mine association between genes. these two examples could identify rules that contained a set of proteins with potential interactions. park et al.  <cit>  applied fuzzy association rule mining techniques to handle continuous numerical values in time series microarray data. it successfully discovered several gene expression patterns over times that were supported by yeast cell cycle data.

the goal of association rules mining is to establish the relationship between a set of input variables and a set of output variables. some packages have been developed for computational purpose. for example, hahsler et al.  <cit>  developed an r package, called ‘arules’, to manipulate input data sets and analyze the resultant item sets and rules. palanisamy  <cit>  modified a well-known association rule mining algorithm, apriori, to deal with input constraints. two important indices for an association rule are support and confidence. for any association rule to be meaningful, it is critical to have sufficiently high values of support and confidence.

in data mining, currently the thresholds for the support and the confidence are set arbitrarily by users, so that different sets of support and confidence will lead to different results. users have to try different settings in order to have a better result. therefore, the results are difficult to interpret. how to determine the thresholds remains an important issue in association rules mining.

in this paper, we propose a statistical way based on the concept of confidence interval and hypothesis testing to determine the minimum support and the minimum confidence for an association rule. we also show how to estimate the minimal support and the minimal confidence for a given set of data. a rule is meaningful only if the support and the confidence are both significantly greater than the minimal thresholds. we then apply the method to gene expression data analysis.

gene expression analysis is a common way to characterize gene expression profiles and to identify a specific expression profile associated with a disease or trait. dna microarrays were commonly used in gene expression analysis before the next generation sequencing era. a dna microarray is a collection of dna probes which are orderly attached on a solid surface  <cit> . each probe represents a detector for a gene with a distinct sequence. therefore, a whole-genome expression microarray can measure the expression level of every gene on the chip at once  <cit> . the next generation sequencing  technology has advanced rapidly since the first rna-seq paper was published in  <dig>  <cit>  and has almost completely replaced the microarray approach. instead of studying expression profiles by hybridizing with known probes on microarrays, one can acquire the actual rna sequences expressed in cells using a ngs platform  <cit> . for rna-seq data, the expression level of a gene can be expressed in terms of reads per kilobase per million mapped reads   <cit>  or fragments per kilobase per million mapped fragments   <cit> . to take account of differences in the coverage/depth of reads in different samples or experiments, normalization and bias correction methods have been developed  <cit> . the differential expression of a gene between experimental conditions could then be assessed using statistical tests, e.g., the t-statistics or the likelihood ratio test based on a generalized linear model.

in gene expression analysis, a popular issue is to look for a set of significant genes corresponding to a specific phenotype. researchers use gene expression data to determine whether the induction/repression of a gene is informative to diagnose the symptoms of a disease . statistics play an important role in such a gene selection problem. the main statistical techniques currently used are multiple t-tests, factor analysis, principle component analysis and other dimension reduction methods  <cit> . these methods can extract a subset of genes that are relevant to the disease or phenotype. however, they do not inform us of causality between genes and phenotypes. therefore, we propose the dynamic association rule algorithm , called dar algorithm, which preserves the causality of genes and symptoms.fig.  <dig> the distribution of confidence for all combinations of p1 =  and p2 =  under independence when n = 50



first, we establish all possible association rules between gene expression levels and phenotypes. for example, one of the specific association rules can be expressed as follows: +1genea→diseasegroup. 

this rule indicates that if gene a is over-expressed, labeled as +1genea, then it implies a disease group. here “imply” means “causation”. it gives us information in biological sense. support and confidence are used to measure the strength of an association rule. here support measures the joint probability of +1genea and the phenotype, while confidence measures the conditional probability of observing the phenotype given +1genea.

second, we apply the minimum support and minimum confidence concept to find “significant rules”.

third, we screen out those impossible  rules. for example, if both rules, “-1genea, 1gene b → disease group” and “-1genea, 1gene b → non disease group”, are significant, we consider them ambiguous rules because the two rules are conflicting.

finally, we construct the final rules and determine the final significant genes

with the proposed dar algorithm, we can find a set of genes that are related to the phenotypic difference between groups. we demonstrate the approach using microarray datasets for high-density lipoprotein -deficient mice  <cit> , mouse embryonic stem cells   <cit> , and the bone marrow of leukemia patients  <cit> , and the rna-seq data from a mouse genomic imprinting study  <cit> . in all four applications, our proposed method can capture the influential genes and the underlying biological functions known in literature, and can provide additional influential genes that other methods failed to identify. in addition, a comparison with t-test is made, using the expression data from the bone marrow of leukemia patients  <cit> .

methods
model
let i =  be a set of k elements, called items. a basket dataset b =  is any collection of n subsets of i and each subset bi ⊆ i is called a basket of items. given support s and confidence c, we say there is an established association rule  <cit> 

a  → b  if

a. a and b occur together in at least s · 100 % of the n baskets.

b. among those baskets containing a, at least c · 100 % also contain b.

here support=transactionsthatcontaineveryiteminaandballtransactions 

and confidence=transactionsthatcontaineveryiteminaandbtransactionsthatcontaintheitemsina. 

mathematically stated, the confidence is the probability that the items in the antecedent a appear together with the items in the consequent b. the significance of an association relationship between a and b can be measured by the support and the confidence. the probability representations of the support and the confidence are, support=pa∩b,andconfidence=pb|a 

consider the association rule a → b. let n be the total number of items in the population, na be the total number of items in a, and nab be the total number of items in both a and b. then numerically the support and the conference are estimated as follows: support=nabn,andconfidence=nabna 

currently, the thresholds of the support and the confidence are set arbitrarily by users and it is very difficult to interpret the result. if the thresholds of the support and the confidence are set too low, many rules will be established. on the other hand, if the thresholds are set too high, no rules may be established. therefore, how to determine the thresholds of the support and the confidence becomes an important issue in the study of the association rules mining. the idea behind our proposed algorithm is as follows. when the antecedent follows a specific distribution, we can first compute the distributions of the support and the confidence, and then determine the thresholds of the support and the confidence by the concept of confidence interval. all rules have to meet the minimal support and the minimal confidence in order to be meaningful.

suppose indicator functions ia ~ bernoulli  and ib ~ bernoulli . under the independence assumption, we have the indicator function iab ~ bernoulli . let n, na, nb and nab be the total number of items in the population, the total number of items in a, the total number of items in b, and the total number of items in both a and b, respectively. we can derive the distribution of the support  as follows. s=nabn∼1nbin∼1nn)∼nn). 

here bin stands for the binomial distribution with parameters n and p <dig>  and nnp <dig> np121−p <dig> stands for the normal distribution with mean np <dig> and standard deviation np121−p <dig>  note that, such an approximation is in general appropriate because we are dealing with a large n . see, for example, arnold   <cit> . therefore, the theoretical minimal support under the assumption of independence  is its  · 100 % upper bound, with α being the statistical significant level.

that is,  <dig> p1p2+zap1p21−p1p2n 

for the distribution of confidence, suppose x is the number of a ∩ b, then x ∼ bin , which is the binomial distribution with parameters n and p <dig>  let z be the number of a, then z ∼ bin . the confidence, c, then becomes c = x/z. technically, c is a defective random variable, as the event z =  <dig> is ignored here. because the probability p  is rather small, the truncated distribution is nearly identical to the un-truncated distribution. it is known that the distribution of x given z = z is a binomial distribution with parameters z and p2| <dig>  where p2| <dig> is the conditional probability of b given a.

under the independence assumption, for any specific value c, we have pxz=c=c=∑zpxz=c|z=zpz=z=∑zpx=cz|z=zpz=z=∑z=1nbinzczp2binnzp <dig> where bin  = zczp2cz1−p2z−cz and bin  = nzp1z1−p1n−z.

unlike the distribution for the support, the minimum confidence does not have a direct formula like ; however, numerical results are always possible and will be illustrated below.

for example, the distribution of the confidence is the sum of product of two binomials. figure  <dig> displays the exact distribution for all combinations of p1 =  and p2 =  when n =  <dig>  it is clear that the distribution is symmetric in p <dig>  that is, given a fixed p1=p <dig>  the distribution of the confidence when p2 = p* is the same with the distribution of  when p2 = . for example, as in fig.  <dig>  given p1 =  <dig>  , the distribution of confidence for p2 =  <dig>  is identical to the distribution of confidence for p2 =  <dig> . likewise, the distribution of confidence for p2 =  <dig>  is symmetric of confidence for p2 =  <dig> . furthermore, for larger n, the distribution is approximately normal as can be seen in fig.  <dig> fig.  <dig> the distribution of confidence under independence when n = 1000



the variance of confidence  is p2e. when n is large enough, z~nnp <dig> np11−p <dig>  it can be shown that e does not exist, and thus var  does not exist. therefore, we can only resolve the problem numerically. for example, the minimum confidences are tabulated in table  <dig> for n =  <dig>  for large n , the values given in table  <dig> can be a good approximation.table  <dig> critical value when n = 1000

p2


example
given a dataset of size n, to verify any association rule of “if a then b”, in general, we first obtain the following estimates p^a=nan 

and p^b=nbn 

where na is the number of records that belongs to the event a. likewise, nb is the number of records that containing event b. the minimum support is then smin=p^ap^b+zαp^ap^b1−p^ap^bn 

and the minimal confidence can be obtained from table  <dig> 

for example, a dataset of size n =  <dig> with na =  <dig> and nb =  <dig>  we will have

p^a=3001000= <dig>  and p^b=7001000= <dig> .

thus, smin= <dig> × <dig> + <dig> .3× <dig> − <dig> × <dig> = <dig>  

and from table  <dig>  the minimum confidence =  <dig> .

any association rule must beat these minimal support and minimal confidence values to be meaningful.

RESULTS
first, we normalized gene expression data to remove systematic bias. next, we re-labeled expression levels with categorical variables. for example, in the apoa <dig> knockout mice data  <cit> , we applied lowess fit on the expression data for normalization  <cit> . then we re-labeled the expression level with − <dig> ,  <dig> , and  <dig> . for a specific rule, we first calculated the estimated support and confidence from the data, and the theoretical minimum support and the theoretical minimum confidence from the methods that are described in the method section. we kept those rules whose estimated support and confidence are, respectively, larger than the theoretical minimum support and the theoretical minimum confidence. we then removed those ambiguous genes and kept the remaining genes as the final set of genes for further analysis. the steps of the algorithm proposed in the paper are shown in fig.  <dig> fig.  <dig> the dar algorithm for microarray data analysis



analysis of the apoa1-knockout mice data  <cit> 
the dataset was collected from the apoa <dig> knockout experiment of callow et al.  <cit> . apolipoprotein a <dig>  is a gene known to play a pivotal role in hdl. callow et al.  <cit>  identified the underlying genes and pathways using apoa <dig> knockout mice. the purpose was to identify genes with altered expression in the livers of apoa <dig> knockout mice compared to the control inbred mice. a total of  <dig> mice were divided into a group of  <dig> control mice and a group of  <dig> apoa <dig> knockout mice. there were  <dig> genes involved in this study. to conduct the association rules analysis, we preprocess the data. the first step is normalization and we follow the method proposed by callow et al.  <cit> : log2rg→log2rg−cja, where a = log2rg and cj  is the lowess fit for log <dig> r/g vs. a.

the second step is to discretize the data. if the normalized log value is ≧ <dig>  we label it as 1; if it is ≦ −  <dig>  we label it as −1; and if it is between − <dig> and  <dig>  we label it as  <dig>  if the expression level is labeled as  <dig>  we classify the gene as “over expressed” in this sample; if the expression level is labeled as − <dig>  we classify the gene as “under expressed”; all other genes are “not differentially expressed”.

given a threshold setting of the confidence and the support , the well-known apriori software automatically tries all possible association rules and keeps those rules with the support and the confidence higher than the respective thresholds. with different combinations of the threshold settings of the confidence  and the support , we wrote the matlab codes to run the single antecedent analysis and the double antecedent analysis. the numbers of resulting rules are listed in table  <dig>  table  <dig> shows that the number of meaningful rules decreases rapidly as the support increases from 10 % to 20 %.table  <dig> the results of the single antecedent rules mining when the dar algorithm is applied to the data of callow et al.  <cit> 



next, we applied our method to compute all possible rules that passed the estimated theoretical minimal support and minimal confidence. some rules are not meaningful in biology, so we classified them as ambiguous and removed them. for example, if one rule tells us “highly expressed gene a implies disease significantly”, but another rule tells us “highly expressed gene a implies control significantly”, then they are conflicting and ambiguous for biological interpretation. we screened out such ambiguous rules.

figure  <dig> shows the flowchart from normalizing the microarray data, discretizing the raw data, applying the dar method to obtain the meaningful rules, and then screening out the ambiguous rules. the results of applying our method to the dhl-deficient mice data are given in table  <dig>  it shows that the number of meaningful rules changes due to the different combinations of the cutoff points of support and confidence. with the dynamic support and confidence, however, it gives the number of meaningful rules to be  <dig>  which can be found when the cutoff points were set to be s = 30/c =  <dig>  the number of the final significant genes is  <dig> 

the result of single antecedent rules mining using the dar algorithm is listed in table  <dig>  it shows that the gene expression level of hdl-deficient mice had significant differences in  <dig> expressed sequence tags . five of them violated the ambiguous rules and were eliminated from the final result. in the published mice data analysis,  <dig> ests were identified to be influential in hdl-deficient mice  <cit> . importantly, all  <dig> ests that were found to be significantly influential in the source study  <cit>  were obtained in our study . there were four underlying genes for the influential ests, which were apoa <dig>  apociii, sterol c <dig> desaturase  and spermatogenesis associated 5-like  <dig> . the most underrepresented gene that was kept under the dynamic rule association was the apoa <dig> gene. the expression level of apoa <dig> in the knockout mice was 20-fold lower than that in the control mice  <cit> . the expression level of the apociii gene, only 4 kb away from the apoa <dig> gene on chromosome  <dig>  was also decreased. sc5d is a catalase that dehydrogenizes c5- <dig> of lathosterol into double bonds in cholesterol synthesis  <cit> . est id  <dig>  known as spermatogenesis associated 5-like  <dig> , is a member of the atpase protein family. in addition, a new est associated with apoa <dig> knockout, caspase  <dig> , was significant in a single antecedent with an under-represented expression level in knockout mice. casp <dig> is one of the caspase families that play a central role of proteolytic activities during cell apoptosis. it has been found that the oxidized ldls  can trigger er stress and lead to dysfunction and apoptosis of cells  <cit> . on the other hand, hdls display protective effects against oxldls toxicity. this may imply that cells are easier to undergo apoptosis in the hdl deficient model. however, the regulation of effector caspase casp <dig> and the role in hdl deficiency need to be clarified by more experiments. here the dar algorithm shows high reproducibility of the original experimental data.table  <dig> the influential genes found when the dar algorithm was applied to the data in callow et al.  <cit> 



the results of the double antecedent association rules mining can be found in table  <dig>  it shows that  <dig>  rules had passed the threshold of the dar algorithm. after screening out those ambiguous rules, only  <dig> final rules remained and they included all  <dig> influential ests in the result of the single antecedent rules mining. the result of the double antecedent rules mining enhances the significance of the dynamic association rules mining in biological meaning. two of the five additional ests were “blank” in the hybridized microarrays, implying no expression sequence . there were  <dig> blank cells in each array. these cells would also be detected and transferred into intensities as background signals. in our normalization, there is still a chance to be significantly different in very low intensity but in a large ratio between knockouts and controls stochastically. one interesting additional est is est id  <dig>  which represents catalase  and plays a major role as antioxidant enzyme against oxidative stress. catalase converts the hydrogen peroxide to water and oxygen for alleviating the toxicity in cells. it was noticed that hdl prevented the increase of intracellular reactive oxygen through catalase activity, decreasing egfr activation triggered by oxidized low-density lipoprotein  and h2o <dig>  <cit> . it implies that catalase is regulated by hdl. when the hdl level decreases, the expression of catalase should be up-regulated to compensate the antioxidant activity and also lose the control by hdl regulation. we also apply multiple t test with adjusted p-value. the results are listed in table  <dig>  in table  <dig>  dystrobrevin binding protein  <dig> , known as dysbindin, is a protein of dystrophin-associated protein complex  in skeletal muscle cells. it is also a part of lysosome-related organelles complex  <dig>  and plays a role in intracellular vesicle trafficking, neurotransmitter release  <cit> . male germ cell-associated kinase  is a serine/threonine protein kinase involved in the cell cycle. it expresses primarily in germ cells. however, the function of dtnbp <dig> and mak involved in liver cells of hdl deficiency needs to be studied further.

analysis of the data of mouse embryonic stem cells  <cit> 
zhou et al.  <cit>  conducted the whole genome expression to identify the gene network in mouse embryonic stem cells . two major properties of esc are pluripotency and capability of propagating indefinitely  <cit> . esc cells form the inner embryo mass of blastocyst by proliferation and have the potential to differentiate into specific cell type for the development of embryo under an extremely strict control  <cit> . the regulation of transcription factors and the interaction with epigenetic factors form a gene regulatory network to control the pluripotency and differentiation of esc cells. four transcription factors , oct <dig>  sox <dig>  klf <dig> and c-myc, play an important role of maintaining esc cells at the pluripotent state  <cit> . additional tfs are also involved in the regulation of esc  <cit> . an esc cell is also capable of proliferating and self-renewal  <cit> . thus, esc cells are widely used in developmental biology and stem cell research  <cit> .

in zhou et al.  <cit> , the status of mouse esc was assessed by sorting the expression level of oct4-gfp mouse esc  using flow cytometry. with a non-gfp mesc line as a negative control, they studied the status of mesc by the expression level of the oct <dig> gene. the total rna samples were extracted from  <dig> sorted cell samples to study the expression profiles on genome 430 v. <dig> affymetrix microarrays. eight profiles were marked as oct <dig> positive , implying that the cells retained the attributes of esc. other  <dig> profiles were sorted with low oct <dig> expression . the analysis was performed by dchip, a microarray analysis tool developed by li and wong  <cit> . the fold change was calculated by the expression level in oct4+ samples over that in oct4- samples, and noted as the ratio r. the p-value of the average difference between two groups was calculated by the welch modified two-sample t-test. the oct4-sorted + subset was defined as the ones with r >  <dig> and p-value < <dig> , while the oct4-sorted- subset as the ones with r < <dig>  and p-value < <dig> .

with the dar algorithm, we first transformed and discretized the data to  <dig>   <dig>  and − <dig>  with the same criterion  as in zhou et al.  <cit> . the average probe hybridization intensity of the  <dig> oct4- samples served as the baseline for each gene. next, every data point was divided by the baseline in that probe. if the ratio r was larger than  <dig>  the data point was labeled as ‘1’; if it was smaller than  <dig> , it was labeled as ‘-1’; all other data points were labeled as ‘0’. all gene symbols and refseq annotation were obtained from the supplement data of zhou et al.  <cit> . the aim of this analysis was to figure out the significantly different genes in expression level between oct4+ and oct4-. since the normalization is based on the average expression level of oct4- for discretization, the significant association rule in ‘ <dig> to oct4+’ is sufficient to signify that the expression level of oct4+ is significantly larger than that of oct4-, and it can be considered as the genes in the oct4-sorted + subset in zhou et al.  <cit> . similarly the significant rule ‘- <dig> to oct4+’ means that the expression level of oct4+ is significantly lower than that of oct4-.

for the mouse esc dataset, there were  <dig> significant association rules in ‘ <dig> to oct4+’, while the subset ‘- <dig> to oct4+’ had  <dig> significant rules under the 95 % confidence interval of support and confidence. in fig.  <dig>  there were four subsets for each venn diagram, respectively. the lists of differentially expressed genes from expression profiles that were treated by oct <dig> rnai knockdown and retinoic acid  induction were reported from ivanova et al.  <cit> . the expression of oct <dig> rnai suppresses the level of oct <dig> in esc, so oct <dig> ri + can be considered as similar to oct4- in zhou et al.  <cit> . in comparison, the expression level of oct <dig> in esc remains relatively high without the expression of oct <dig> rnai, which is comparable to the samples of oct4+ in zhou et al.  <cit> . expression of retinoic acid  induces differentiation of esc into specific cell types. the gene regulation of ra+ can also be compared to the samples of oct4- in esc  <cit> . after excluding the redundancy by refseq id and eliminating the blanks, there were  <dig> significant genes in the subset of ‘ <dig> to oct4+’. compared to the  <dig> genes listed in the oct4-sorted + subset, there were  <dig> genes  that appeared in both subsets. out of the  <dig> intersected genes,  <dig>  genes are shared with the oct4-sorted + subset. on the other hand, subset oct4-sorted- and subset ‘- <dig> to oct4+’ contain  <dig> and  <dig> genes, respectively, and the two subsets shared  <dig> genes, which contain  <dig>  % of the ‘- <dig> to oct4+’ gene set. there were  <dig> out of the  <dig>  genes shared between oct4-sorted- and ‘- <dig> to oct4+’. the high proportion of intersection indicates that the association rules select significant genes efficiently and have good reproducibility to the subsets listed by t-test. jarid <dig> was listed in the unique genes  that were identified only by the association rule approach. jarid <dig> is an at rich interactive domain-containing protein that functions as a dna-binding protein  <cit> . pasini et al.  <cit>  demonstrated that jarid <dig> could recruit the polycomb repressive complex  <dig> , which plays a crucial role in regulating gene expression essential for development and differentiation in pluripotential cells  <cit> , to facilitate histone methylation. the additional genes that the dar algorithm identified in this data set need further experimental analyses to address the roles of genes that involved in the regulation of escs.fig.  <dig> overlaps between the gene sets in significant association rules, oct4-sorted, oct4-rnai, and ra-induction. the number in the venn diagrams shows the intersection set of the contiguous regions



zhou et al.  <cit>  chose  <dig> genes as esc and  <dig> differentiated cell markers. oct <dig>  sox <dig>  nanog, esrrb, tcl <dig>  dppa <dig>  and utf <dig> showed more than  <dig> fold changes in the positive direction in the raw data and were selected as esc markers in the significant list of oct4-sorted+. we also apply multiple t test with adjusted p-value. the results are listed in table  <dig>  as shown in table  <dig>  six out of the seven chosen genes were significant in the subset of ‘ <dig> to oct4+’. the confidence level of sox <dig> failed to pass the minimum support and minimum confidence under the 95 % confidence interval. for the differentiation markers, all seven genes were listed in the subset of “oct4-sorted-” and expressed higher than  <dig> fold changes in the negative direction. however, the test of tgfbr <dig>  does not pass the minimum of support  in association rule ‘− <dig> to oct4+’ under the 95 % confidence interval because high variation of expression level among the eight oct4- samples gave rise to a low support level in the ‘− <dig> to oct4+’ rule. in terms of confidence, tgfbr <dig>  did pass the minimum confidence  at the 95 % confidence level. if we adjusted the criterion to the 90 % confidence level, reducing the minimum support to  <dig>  and the minimum confidence to  <dig> , tgfbr <dig> would be significant. this indicates that the criteria should be chosen properly depending on the type and the property of the dataset. moreover, zhou et al.  <cit>  listed  <dig> regulators that were involved in the states of esc . eleven of the  <dig> genes are significant in both gene subsets. out of the four insignificant genes, stat <dig> and sall <dig>  that were not significant in all association rules, were also excluded from significant subsets in the original paper. otx <dig> was as insignificant as sox <dig> in the rule of ‘ <dig> to oct4+’ with the 95 % confidence level.table  <dig> the results of the marker genes of esc or differentiation from the dataset of zhou et al.  <cit> 



analysis of the expression profiles among the cohort of leukemia patients  <cit> 
the classification of tumor types has been a challenge for pathologists to decide a specific cancer treatment for patients. the knowledge-based molecular markers are critical for the clinical treatment. acute leukemia has been classified into acute lymphoblastic leukemia  and acute myeloid leukemia  by enzyme-based histochemical diagnosis  <cit> . in  <dig>  golub et al. introduced gene expression profiling as an approach to validate the outcome of clinical diagnosis  <cit> . thirty-eight acute leukemia cases from diagnosed patients  were acquired in that study. thirty-eight total rna samples extracted from acute leukemia patients’ bone marrow were hybridized to affymetrix microarrays with probes for  <dig> human genes.

identifying differentially expressed genes with statistical significance has been a crucial step of microarray analysis. since a large number of replicates in one treatment group of acute leukemia was conducted  <cit> , the gene expression data set has been used as a good training set for statistical method development. many statistical methods have been published for identifying differential gene expression in microarray  <cit> . here we compare the dar algorithm to one of the methods listed in kim et al.’s paper. the lists of significant genes were obtained by the t-test and by our proposed association rule approach.

the normalization of the raw data was conducted for each sample by subtracting its median and dividing it by its quartile range. the t-statistic is provided in pan  <cit> , which is used to identify differently expressed genes between two groups with a 95 % confidence level. for the association rule method, after normalization, the discretization step follows the transitional state discrimination method  in pati and das  <cit> . for each gene, we subtracted its mean and divided it by its standard deviation. if the normalized value was ≧ <dig>  we labeled it as 1; if it was ≦ −  <dig>  we labeled it as −1; otherwise, we label it as  <dig>  based on these labeled data, the proposed procedure can be applied to find out the significant rules with a 95 % confidence level.

in order to mine the biological information in the final gene list, pathway analysis was conducted to map these genes to known pathways . if the genes set is too small, some potential significant pathways may not be discovered. therefore, unlike pan  <cit> , we did not apply the p-value adjustment in the multiple comparisons when selecting significant genes.

with the 95 % confidence level, there were  <dig> significant association rules in ‘ +  <dig> to aml’ and  <dig> in ‘− <dig> to aml’. because no significant rules in ‘ +  <dig> to all’, ‘− <dig> to all’, ‘ <dig> to aml’ and ‘ <dig> to all’ were found at the 95 % confidence level, the rule of’ +  <dig> to aml’ can be interpreted as aml > all, whereas the rule of’− <dig> to aml’ as all > aml. the significant gene lists selected by t-test with α = . <dig> had  <dig> probes in aml > all and  <dig> probes in all > aml . for the significant gene in aml > all, our association rule had  <dig> out of the  <dig> non-redundant genes in common with the gene list selected from t-test. as for all > aml,  <dig> out of  <dig> non-redundant genes were reported by both statistical methods. the fixed number of degree of freedom in t-test could be the factor to the agreement of acquiring genes between association rule and t-test. table  <dig> listed over-represented pathways in gene ontology . although a low proportion of common genes were reported by both methods, the gene list from association rule in all > aml and those from t-test have a strong agreement in pathway analysis. among  <dig> significant go pathways  in the over-representation test by using the significant gene list from the association rule,  <dig> pathways were also reported as over-representation pathways from the t-test significant gene list . this indicates that the pool of genes in both methods play similar roles in the biological functions even though the number of common genes was low. that is, most of the genes in these two subsets, even the common set is small, involve in similar pathways in the cells. the significant pathways in both gene lists of aml > all did not have many overlaps simply due to the limited gene list selected by the t-test, giving rise to only one significant pathway found in pathway analysis. furthermore, the significant biological processes, e.g., hemopoiesis and developmental process indicate the fundamental differences of cell regulation between myeloid and lymphoid cells according to the overrepresentation test of gene list that was identified by the association rule approach. nevertheless, it is worth noticing that this comparison had relatively minor input to the biology and clinic since there is lack of a cohort of baseline to calibrate the expression profile between aml and all samples.table  <dig> number of significant probes and non-redundant genes under tested methods


aaml >all 

ball >aml 

anumber of ensembl genes that was expressed higher significantly in aml than in all 


bnumber of ensembl genes that was significantly up-regulated gene in all than in aml 


metabolic process
metabolic process

primary metabolic process
primary metabolic process

nucleobase-containing compound metabolic process
nucleobase-containing compound metabolic process

cell cycle
dna metabolic process

protein metabolic process
cell cycle

dna metabolic process
dna repair

cellular component organization or biogenesis
dna recombination

cellular process
cellular process

chromatin organization
dna replication

rna metabolic process

organelle organization

cellular component organization
rna metabolic process

dna repair
cellular component organization or biogenesis
cellular component organization

dna recombination
protein metabolic process

dna replication
organelle organization

transcription, dna-dependent
chromatin organization
transcription, dna-dependent
cellular process

cellular process
bolded terms indicate the significant pathways appeared in both dar and t-test



an application to the rna-seq data of genomic imprinting study  <cit> 
genomic imprinting is an epigenetic system that is inheritable from parents in diploid organisms. it is important for mammalian development and embryonic growth. the epigenetic tags on imprinted genes of a one-cell embryo were fully established during the paternal and maternal germ cell developmental process  <cit> . dynamic reprogramming, such as active and passive demethylation of both parental genomes, is crucial for imprint maintenance throughout development . during the formation of gonads in the embryo, primordial germ cells  undergo epigenetic erasure to recover pluripotency  <cit> . according to previous studies, gene tet <dig> may be involved in the erasure of genomic imprinting in the pgcs in e <dig> - e <dig>  mouse embryos  <cit> . yamaguchi et al.  <cit>  found that the paternalko  mice had significantly fetal and postnatal growth defects. to link the phenotypic changes to the dysregulated erasure of imprinted genes on paternal alleles, yamaguchi et al.  <cit>  performed the rna-seq analysis of e <dig>  embryonic pgcs on  <dig> tet <dig> paternalko and three control mice. the normalized expression level was calculated in terms of fpkm and was log <dig> transformed. the cutoff of significantly altered genes of the paternalko compared with the average expression level of the control samples was the fold-change of  <dig> . we followed the criteria of yamaguchi, et al.  <cit>  to discretize the data. if the expression level of the gene was more than  <dig>  times over the average expression level of control samples, it was labeled as  <dig>  whereas if the expression level was less than two-third of the average expression level of the control samples, it was labeled as − <dig>  otherwise, it was labelled as  <dig> 

the 75 % confidence level was set to select genes in the dar algorithm. there were  <dig> meaningful rules found in the rule of “ <dig> genea implies paternalko”, representing the significantly up-regulated genes in paternalko mice. four hundred and fifty-six meaningful rules were found in “- <dig> genea implies paternalko”, which represent significantly down-regulated genes . in yamaguchi et al.  <cit> ,  <dig> up-regulated and  <dig> down-regulated genes were identified. the percentages of overlaps in up-regulated and down-regulated genes between the two studies are  <dig>  % and  <dig>  %, respectively. in yamaguchi et al.  <cit> , genes were identified as significant as long as at least two of the ten paternalko embryos analyzed had a fold-change  larger than  <dig>  times to the average of the control embryos. the stringency of selecting rule from the original paper was relatively relaxed than it was in our method. this may be the reason why the overlaps of the resulting genes from two methods are small.table  <dig> number of significant dar rules using five different confidence levels



another list of expressed imprinted genes was ranked by the fpkm value. in yamaguchi et al.  <cit> ,  <dig> expressed genes were found to be related to the regulation of genomic imprinting. by applying the same criteria of being a significant gene , we found  <dig> genes to be significantly expressed in paternalko mice . applying our proposed method, we found  <dig> out of the  <dig> genes to be marked as significant association rules either in “ <dig> genea implies paternalko” or “− <dig> genea implies paternalko”. the number of genes shared by the two methods is low. the criteria to select the genes in yamaguchi et al.’s study  <cit>  did not have statistical support and only considered if two individuals had a fc larger than  <dig> . the loose criterion may explain the low overlaps. furthermore, some of the genomic imprinting related genes were assigned as activated and inhibited significantly at the same time  based on the criteria of the paper of yamaguchi et al.  <cit> . such genes were considered as ambiguous if one only mines significant single antecedent rules. however, in theory they can be captured if we consider higher leveled antecedent rules mining when the genes have significant interaction with the other significant genes. the multiple t test with adjusted p-value has been applied to analyze as well. the results has been listed in table  <dig> table  <dig> expressed imprinted genes in the rna-seq data of yamaguchi et al.  <cit> 



microarray quality control  data sets  <cit> 
in  <dig>  microarray quality control  consortium launched a series of analyses across different platforms of microarrays  <cit> . they used four defined samples to acquire the expression profiles from eight commercialized microarray platforms. the overall objective of this project is to evaluate the sensitivity and reproducibility among microarray platforms. those samples include 100 % universal human reference rna , 100 % human brain reference rna , 75 % uhrr: 25 % hbrr  and 25 % uhrr: 75 % hbrr . five replicates of every sample were tested on one chip in one platform and three chips of every platform were conducted in this project. this resulted in  <dig> replicates for every sample in one microarray platform. in the same project, they also used three qpcr assays to validate  <dig> genes selected from the common probes among microarray platforms. according to the single gene quantification study  <cit> , the expression level qpcr can serve as great standard to evaluate the sensitivity and accuracy of microarray platforms. in total, they quantified  <dig> genes with taqman gene expression assays ,  <dig> genes with standardized rt  rt-pcr assays  and  <dig> genes with quantigene assays . the number of genes is  <dig> in union  <cit> .

in order to compare different statistical methods for determining differentially expressed genes , kadota and shimizu  <cit>  selected taq and gex assay data to compare the deg determined by t-test and average difference  methods. they further used benjamini and hochberg approach to calculate the false discovery rate  for the p-value from the t-test  <cit> . they selected five microarray platforms from maqc project  <cit>  including applied biosystems , affymetrix , agilent technologies for one-color array , ge healthcare  and illumina . among these platforms, they compared the specificity and sensitivity of gene ranking methods for analyzing two-class data: weighted average difference , average difference , fold change , rank product , moderated t statistic , significance analysis of microarrays , shrinkage t statistic , and intensitybased moderated t statistic   <cit> .

we tested the reproducibility of degs by dynamic association rule  with taq data, and selected ilm microarray assay to screen the degs by dar and compared the result with three gene ranking methods in kadota and shimizu’s work  <cit> . the taq data had four replicates for sample a and four for sample b. in that study, the average expression level of sample b was divided by that of sample a to calculate the significant degs if the absolute value of ad was larger than one. the degs were selected in t-test when the fdr is smaller than  <dig> . to select the significant dars from taq data, we discretize the taq data by dividing gene expression level of each replicate by the average expression level of sample a that is similar to the calculation of ad method. the genes in taq data were assigned as up-regulated gene if the average expression level of sample b is larger than that of sample a, and labeled as down-regulated gene if the average expression level of sample a is larger than that of sample b. 70 % and 90 % confidence level were used to carry out the lists of deg by dar method. the result shows that almost all genes that listed as deg by dar method with 90 % confidence level were included in the lists of deg by ad and t-test method . the lists of deg by dar method with 70 % confidence level covered all genes listed in ad method and had several unique genes against the lists of deg by t-test method in up-regulated degs and down-regulated degs.fig.  <dig> number of common genes between dar and compared methods in taq data. a dar method with 90 % confidence level; b dar method with 70 % confidence level



the normalized ilm microarray data set that had  <dig>  detecting probes was obtained from the published work of kadota and shimizu  <cit> . it left  <dig>  probes after excluding non-detectable probes, which determined by all  <dig> detections having flag detection value less than  <dig> . the wad and fc statistic were re-calculated following the description in kadota et. al’s study  <cit> . in brief, the fc for each gene was calculated as average non-log expression value for  <dig> replicates of sample b divided by the average expression value for  <dig> replicates of sample a. the wad statistic was calculated as average log value of sample b divided by that of sample a, and weighted by the range of average log value for  <dig> detections value across all ilm detectable probes  <cit> . the discretization for dar method was calculated as the log expression value of each replicate divided by the average log expression value of sample a. the cutoff of absolute value larger than  <dig> was used for categorization. among  <dig>  probes,  <dig> dars were found to pass the minimum support and minimum confidence in rule’ <dig> genea implies to sample b’ under 99 % confidence level, which could also be inferred as up-regulated genes. there were  <dig> dars were found in rule’- <dig> genea implies to sample b’, and interpreted as down-regulated genes.

since the wad and fc statistic were used only for ranking, it did not assign a cutoff for deg in kadota et al.’s work  <cit> . here we simply selected top  <dig> probes and bottom  <dig> probes for comparison after ranked with wad and fc statistic. the intersection number of up-regulated and down-regulated probes between dar and fc was  <dig>  and  <dig> . the intersection number of up-regulated and down-regulated probes between dar and wad was  <dig>  and  <dig> .

CONCLUSIONS
our association rules can be applied to gene expression data analysis with high confidence and reproducibility. we took advantage of the well-established association rule mining technique from marketing to develop an improved method and algorithm, the dar algorithm, to mine significant association rules between gene regulation and trait. in particular, we derived the distributions of support and confidence for the association rule “if a then b” under the assumption of independence between a and b. based on these distributions, we could then determine the minimal support and the minimal confidence. that is, for any association rule to be meaningful, their minimal support and minimal confidence must be higher than the theoretical upper limits under the independency assumption. while finding important association rules remains a challenging problem, we provided a formal procedure for testing whether a rule is meaningful. certainly, when other sources of information is possible , it is possible that an association rule is meaningful, even without beating this minimal value. our conclusion here is purely data driven.

the issue of multiple hypothesis testing has been ignored here. the theory developed here would generally be applicable to test any given value on “is this value meaningful?” in many applications, a very large number of association rules are searched. the following minimal support and confidence may be called for. given a pre-specified value of minimal support s for finding all association rules “if a then b”, we can back solve the equation for screening purpose - this can save a significant amount of time. for example, from the method section, given s and a , we have p1⋅p2+zap1p21−p1p2n=s 

and thus n+za2p2−2ns+za2p+ns2= <dig> 

where p = p1 · p <dig> .

suppose p∗ is the root for the above equation, then p <dig> must be larger than p∗ / p <dig> for the rule to be meaningful. thus, we can ignore all events b whose p <dig> is smaller than p∗ / p <dig> 

the analysis results from the four datasets used above show the power of assessing gene regulation by the dar algorithm. the influential genes relative to hdl deficiency are distinguished from est-based microarrays. the regulatory network of esc including a few crucial transcription factors is also revealed by well-defined mouse microarrays. the agreement of the pathway analysis is evident between the association rule algorithm and the t-test in the leukemia dataset, although the proportion of intersected genes is small between the two lists of significant genes. the association rule approach that applies to the rna-seq data also identifies a set of significant gene lists that has a moderate agreement with the results from the source study  <cit> . in this analysis, we extended the established data mining technique of association rules borrowed from market basket analysis to transcriptome analysis. a method was developed to normalize, transform, discretize, and add identification techniques to the data. a computer program produces many association rules. having the originally produced rules that numbered in the hundreds, the theoretical minimum support and theoretical minimum confidence were used to trim rules. the resulting rules were found to be statistically significant and left to the investigator to determine whether they are significant biologically. traditional statistical techniques were employed to validate the finding of the association rules with mixed results mostly stemming from the unique makeup of the data. association rules mining is an alternative approach to hypothesis development and can facilitate researchers to consider alternative genes and relationships that would otherwise be ignored in gene expression data analysis.

availability of supporting data
the code and dataset can be downloaded from www.mixturetree.net.

abbreviations
dardynamic association rule

ngsnext generation sequencing

maqcmicroarray quality control

rpkmreads per kilobase per million mapped reads

fpkmfragments per kilobase per million mapped fragments

hdlhigh-density lipoprotein

escembryonic stem cells

apo a1apolipoprotein a1

estsexpressed sequence tags

sc5dsterol c <dig> desaturase

spata5l1spermatogenesis associated 5-like 1

casp6caspase 6

oxldlsoxidized ldls

dtnbp1dystrobrevin binding protein 1

dpcdystrophin-associated protein complex

bloc-1lysosome-related organelles complex 1

makmale germ cell-associated kinase

mescmouse esc

oct4+oct <dig> positive

oct4-low oct <dig> expression

raretinoic acid

allacute lymphoblastic leukemia

amlacute myeloid leukemia

tsdtransitional state discrimination

gogene ontology

pgcsprimordial germ cells

fcfold-change

uhrruniversal human reference rna

hbrrhuman brain reference rna

fdrfalse discovery rate

abiapplied biosystems

afxaffymetrix

ag1agilent technologies for one-color array

gehge healthcare

ilmillumina

wadweighted average difference

adaverage difference

rprank product

modtmoderated t statistic

shrtshrinkage t statistic

ibmtintensitybased moderated t statistic

competing interests

the authors declare that they have no competing interests.

authors’ contributions

sc carried out the proof of the minimum support and minimum confidence. sc and th proposed the algorithm. th and ch ran the analysis and summarized the results of data analysis. wh proposed the work in next generation sequencing data analysis. sc and wh wrote the manuscript. all authors read and approved the final manuscript.

