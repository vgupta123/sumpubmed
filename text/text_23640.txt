BACKGROUND
recent advances in high-throughput genotyping have made large-scale genetic association studies possible. genome-wide association studies  for complex disease have met with unprecedented success in identifying common susceptibility variants. however, the discovered common-frequency single nucleotide polymorphism  associations do not account for a large proportion of the genetic component of disease. the field is now focusing on the analysis of low frequency and rare variants  ≤ <dig> ) to investigate if they will help explain the missing heritability in complex trait etiology  <cit> . while the sample sizes currently investigated are large enough for a well-powered gwas of common variants, they are not large enough to provide sufficient power for the single-point analysis of low frequency/rare variants with small to moderate effect sizes  <cit> . we have developed association analysis software, ccravat  and qutie , which allow the large-scale analysis of low frequency/rare polymorphisms. the software increases power over single marker analysis of these variants by pooling the low frequency/rare variants within defined regions and treating them as a single "super-locus"  <cit> . these software tools are suitable for the analysis of snp data from both commercial gwas platforms as well as of variants discovered from resequencing projects. the programs find loci where the low frequency/rare variant content is significantly different between cases and controls, or where the means of a quantitative trait differ between groups with and without these variants.

implementation
ccravat and qutie are linux command-line based utilities written in perl. the scripts utilize the getopt, posix, and gd perl modules. the gd module is necessary to produce the graphical output, and the posix module is used to calculate the logarithm base  <dig> of the p values. the tools have been tested on a variety of gwas datasets and the system requirements depend mainly on the size of the study . the software requires that the data be separated by chromosome for efficiency. for a genome-wide dataset separated by chromosome consisting of  <dig>  snps typed in  <dig>  individuals, ccravat requires ~ <dig> mb of ram. the software development and testing of the applications were performed on machines with dual-core athlon processors. the scripts can take a variable amount of time to run depending on the options used. the run time for a typical gene-centric genome-wide analysis, using approximately  <dig>  snps and  <dig>  individuals separated by chromosome, is less than  <dig> hours. permutation testing can add considerably to the computing time depending on the number of regions analyzed and the numbers of permutations run.

RESULTS
the statistical properties of the low frequency/rare variant collapsing  association test that we have implemented have been described previously  <cit> . although methods for how to analyze low frequency/rare variants have been developed, to our knowledge there are no published software packages that implement them. this lack of software tools motivated the development of ccravat and qutie.

analytical framework
input files
ccravat and qutie require two input files per chromosome: a map file and a pedigree file. the map file contains information about the markers analyzed and their position along the chromosome. ccravat and qutie allow both a  <dig> column and a  <dig> column formatted map file, as seen in table  <dig>  the  <dig> column map file illustrated in table 1a contains information on chromosome, marker name, and base pair  position of analyzed markers. the  <dig> column map file shown in table 1b is the map file format used by the program plink  <cit>  and contains the chromosome, marker name, genetic position and bp position of analyzed markers. the pedigree file holds information about the individuals and their genotypes. the pedigree file is a white-space delimited  file that needs to be in the standard pre-makeped linkage format described and illustrated in table  <dig>  if performing a gene-centric analysis an additional file defining gene names and coordinates is required. this file is a white-space delimited file  and illustrated in table  <dig>  the software download includes the gene files for both build  <dig> and  <dig> of the genome.

 <dig> column map file that contains the chromosome, marker name, and base pair position of each marker. the header row is for display purposes only and should not appear in the actual file.

 <dig> column map file that contains the chromosome, marker name, genetic position, and base pair position. the four column format is the same used by the genetics software package plink. the header row is for display purposes only and should not appear in the actual file.

pedigree file that contains genotype data for  <dig> snps and  <dig> individuals . the first column is for pedigree ids, the second for individual ids, the third for paternal id, the forth for maternal id, the fifth for sex code, and the sixth for disease designation or quantitative phenotype value. column  <dig> starts the genotype data for the markers, with each allele of each genotype in its own column . the header row is for display purposes only and should not appear in the actual file.

program options
ccravat and qutie provide users with  <dig> command-line options, all detailed in the users manual, allowing the analysis to be tailored to specific interests. the options belong to three broad categories: altering the definitions of a region, low frequency/rare variant; altering significance levels and defining statistical analysis method, and altering the appearance of the graphical output.

fundamental to the collapsing method is the definition of the region within which the accumulation of low frequency/rare variants will be examined. ccravat and qutie provide the user with two options for defining the locus of interest, either through defining regions based on known gene coordinates or by employing a sliding window approach. if the analysis is based on sliding windows, the user defines how large the analysis windows should be. if a gene-based analysis is undertaken the user can also define how further upstream and downstream from the transcription start and stop sites to extend the analysis. the user can adjust the maf cut-off that determines which markers are considered to be low frequency/rare variants and therefore included in the analysis.

unlike association tests of common variants, there is no well-defined significance threshold for the analysis of multiple low frequency/rare variants. the programs allow the user to define a significance threshold that produces separate files for significant regions, allowing the researcher to focus on top hits without having to troll through all the data. the researcher can also set significance thresholds to select regions for follow-up by undergoing permutation analysis. the number of permutations can also be preset. as chi-squared test results can be unreliable with low cell counts, ccravat provides an option for the user to set a minimum number of cell counts; the fisher's exact test is then implemented for any region that falls below this value. the standard analysis of qutie is a linear regression, but qutie provides an option to additionally carry out a two-sample t-test.

to assist researchers in interpreting the results, ccravat and qutie produce visual output summaries. the programs allow the user to define a significance threshold to highlight loci in the manhattan plot on the basis of their p value, as well as to manipulate graphical parameters such as the height, width, and size of data points of the figures. the programs also provide an option to produce figures based on previously run analyses.

output files
ccravat and qutie produce text-based summaries and graphical summaries of the analysis results. the format of the ccravat output file that provides summary statistics for all genes/windows that achieved a user-specified level of significance is displayed in table  <dig>  the same summary file produced by qutie is illustrated in table  <dig>  the results of permutation testing for all regions that reached the significance threshold are demonstrated in table  <dig>  ccravat and qutie produce comprehensive output including summary statistics for all analysed genes/windows on each chromosome and this output is summarized in tables  <dig> and  <dig> . the programs also produce a list of snps that were analyzed within each significant region, and the format of that file is shown in table  <dig>  in addition to these output files, ccravat and qutie produce a manhattan plot that visually summarizes the significance of all analyzed regions . qutie produces two additional graphic summaries . the histogram shown in figure  <dig> shows the distribution of quantitative trait values for all individuals in the pedigree file. figure  <dig> is an example of the histogram that qutie produces for every region achieving a user-specified level of significance, and shows the distribution of trait values of individuals with  and without  low frequency/rare variant minor alleles. the output for a genome-wide, gene-centric scan for low frequency/rare variant  analysis typically totals less than  <dig> mb for all files. the output size for sliding windows-based analysis genome-wide depends on the size of the intervals examined and the maf threshold imposed. this usually ranges from  <dig> to  <dig> mb for all files.

gene file that defines the genes to be analyzed and their coordinates to allow the collapsing of the correct markers defined in the map file. the first five columns of the file must be: gene id, gene name/symbol, chromosome, start bp position, end bp position. additional columns will be ignored.

this file provides summary statistics for all genes that achieved a p value ≤ the p value set by the -pout command line option. the summary file is a tab-delimited file with  <dig> columns: gene/window name, chromosome, starting bp position, end bp position, number of snps in the gene/window, number of cases with low frequency/rare variant minor alleles, number of cases without low frequency/rare variant minor alleles, number of controls with low frequency/rare variant minor alleles, number of controls without low frequency/rare variant minor alleles, chi-squared value, chi-squared p value, fisher exact p value.

this file provides summary statistics for all genes that achieved a p value ≤ the p value set by the -pout command line option. the summary file is a tab-delimited file with  <dig> columns: gene/window name, chromosome, starting bp position, end bp position, number of snps in the gene/window, number of individuals with low frequency/rare variant minor alleles, number of individuals without low frequency/rare variant minor alleles, the mean qt value of individuals with low frequency/rare variant minor alleles, the mean qt value of individuals without low frequency/rare variant minor alleles, the p value of the linear regression, the beta coefficient from the linear regression, the standard error of the beta coefficient, the lower and upper 95% confidence intervals of beta, the t-statistic, and the t-statistic p value.

this file provides summary statistics for all genes that achieved a p value ≤ the p value set by the -pperm command line option, which initiates permutation testing. the summary file is a tab-delimited file with  <dig> columns: gene/window name, chromosome, starting bp position, end bp position, summary of the number of cases and controls that have low frequency/rare variant minor alleles, the original p value, summary of permutations run, and permutation p value. the output file for qutie is the same except that column  <dig> contains the number of individuals with and without low frequency/rare variant minor alleles and corresponding qt values.

this file provides summary statistics for all genes analyzed on each chromosome and is the most comprehensive output file. the summary file is a tab-delimited file with  <dig> columns: gene/window name, chromosome, starting bp position, end bp position, number of snps in the gene/window and the number that are low frequency/rare, number of cases with low frequency/rare variant minor alleles, number of cases without low frequency/rare variant minor alleles, number of controls with low frequency/rare variant minor alleles, number of controls without low frequency/rare variant minor alleles, chi-squared value, chi-squared p value, fisher exact p value, and a description of any permutations run.

this file provides summary statistics for all genes analyzed on each chromosome and is the most comprehensive output file. the summary file is a tab-delimited file with  <dig> columns: gene/window name, starting bp position, end bp position, number of snps in the gene/window, number of individuals with low frequency/rare variant minor alleles, number of individuals without low frequency/rare variant minor alleles, mean qt value for individuals with low frequency/rare variant minor alleles, mean qt value for individuals without low frequency/rare variant minor alleles, linear regression p value, beta coefficient from linear regression, standard error of the beta coefficient, the lower and upper 95% confidence interval s of beta, t-statistic, and t-statistic p value.

this file provides summary statistics for all snps that reside within a gene or region with p value ≤ the p value set by the -pout command line option. the file is tab-delimited with  <dig> columns: marker name, chromosome, bp position of marker, and the minor allele frequency  considering all analyzed individuals.

data quality control
performing the collapsing analysis based on low frequency and rare variants  requires special attention to quality control. genotype calling algorithms for gwas chips perform well for common variants, but are known to be error-prone for loci with low maf. therefore, we recommend users that have performed the analysis based on gwas chip data to check the cluster plots for all variants contributing to interesting signals, exclude any poorly clustering variants and rerunning the analysis for the specific regions of interest to ensure the association is robust to these exclusions. quality control is also an important consideration when analyzing sequencing data. major considerations are the effects of small insertions-deletions leading to false positive snps, read depth at variant sites, mapping quality score, and snp quality score.

CONCLUSIONS
in this paper we have described two novel analysis tools, ccravat and qutie, for investigating low frequency/rare variant associations in gwas and resequencing data. both programs employ a simple collapsing method to increase power over single point analysis. ccravat analyzes case/control data and investigates significance using pearson's chi-squared and fisher's exact tests. qutie analyzes quantitative trait data and implements a linear regression and student's t-test. both ccravat and qutie are easy-to-use linux command line tools that use standard files typically employed in common variant gwas analysis. ccravat and qutie can be used as a complement to existing common disease gwas by analyzing low frequency/rare variant associations or in analyzing sequence-based low frequency/rare variant genotype calls in regions of interest or genome-wide. these tools are important first steps in the analysis of rare variants. we are currently developing more powerful natural extensions to the current methods as well as novel approaches that incorporate weights based on quality metrics.

availability and requirements
project name: ccravat and qutie

project homepage: http://www.sanger.ac.uk/resources/software/rarevariant/

operating system: linux/unix

programming language: perl

license: gnu gpl

list of abbreviations
ccravat: case control rare variant analysis tool; qutie: quantitative trait; qt: quantitative trait; gwas: genome-wide association study; snp: single nucleotide polymorphism; maf: minor allele frequency; bp: base-pair; chr: chromosome; pos: position; gen: genetic; aff stat: affection status; rv: rare variant; cont: control; chisq: chi-square statistic; fisherex: fisher's exact test; wind: window; coef: coefficient; ster: standard error; ci: confidence interval; av: average; regpval: regression p-value.

authors' contributions
rl wrote the code for ccravat and qutie. adw wrote the documentation, developed the homepage, and drafted the manuscript. kse compiled and created the gene files for the gene-centric analysis. apm supervised the development of ccravat and qutie. ez supervised the development of ccravat and qutie and drafted the manuscript. all authors have read and approved this manuscript.

