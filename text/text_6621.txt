BACKGROUND
there is a growing interest in performing meta-analysis of sequencing studies to discover rare variants that influence complex diseases and traits. four major software packages — mass  <cit> , metaskat  <cit> , raremetal  <cit> , and seqmeta  <cit>  — have been developed for this purpose. these packages perform two separate tasks:  study-level analysis — computation of summary statistics for each sequencing study; and  meta-analysis — combination of summary statistics to perform gene-based association tests. for mass and raremetal, the first step is supported by separate software programs score-seq/score-seqtds  <cit>  and raremetalworker/rvtests, respectively. for metaskat and seqmeta, the first step is supported by certain functions in the corresponding r packages. to simplify description, we will use the name mass or raremetal to denote both the study-level analysis programs and the meta-analysis software itself when the distinction is not necessary.

because of incompatible file formats and non-equivalent summary statistics, the output files from the study-level analysis of one package cannot be directly used to perform meta-analysis in another package. thus, all participating studies in a consortium are required to use the same package. this requirement is highly undesirable for several reasons. first, participating investigators may not be familiar with the package selected by the consortium. second, no single package can handle all types of traits  or study designs . third, summary statistics need to be recalculated when investigators join a new consortium that adopts a different package.

to avoid the aforementioned requirement, we developed a c++ program called premeta. this program converts between the file formats of the four packages and translates the summary statistics to a common form, so that the summary statistics from different packages can be properly combined for meta-analysis. premeta operates as an open source stand-alone software program designed for easy installation, simple interface, and high performance. with this tool, participating studies are allowed to use the packages of their choice, and the results can be used in future meta-analysis without re-doing the study-level analysis.

implementation
the files of summary statistics generated by the four software packages have different formats. specifically, mass uses one text file to provide score statistics, gene-based covariance matrices, and genotype information, including minor allele frequency , minor allele count, count of non-missing genotypes, and counts of homozygous reference, heterozygous, and homozygous alternative genotypes. raremetal uses two compressed text files: the.cov file tabulates sliding-window covariances; and the.score file contains score statistics, genotype information  p-value, and the information in the mass file), and trait information . metaskat uses two specialized files:.mssd is a binary file with gene-based covariance matrices; and.minfo is a text file with score statistics and genotype information . seqmeta uses an r data file containing score statistics, gene-based covariance matrices, maf, and standard error of the residuals. a major function of premeta is to convert between the four file formats.

the four software packages present the score statistics and covariance information in various forms. for each gene, mass and metaskat provide the score statistic normalized by the residual variance and the corresponding covariance matrix. seqmeta provides the unnormalized score statistics, their covariance matrix, and the residual variance. raremetal provides the normalized score statistics and the corresponding covariances divided by the sample size in a sliding-window format. for studies of unrelated subjects, the older versions of raremetal  provides unnormalized score statistics. premeta translates the score statistics and covariance information from one form to another.

when converting the gene-based covariances to the sliding-window format, there is not enough information to produce the covariance between two single nucleotide polymorphisms  that lie in one window but on two different genes. premeta sets the covariance to zero for any such snp pair. this implementation will correctly recover the gene-based covariance in the meta-analysis if the same gene grouping is adopted.

inverse normal transformation  is commonly used to yield normal distributions for quantitative traits. this transformation alters the scale of measurement for the genetic effects and thus tends to reduce the power of meta-analysis. one may restore the original scale of measurement by multiplying the transformed trait values with the standard deviation of the original trait values. premeta allows this rescaled int  to be performed at the meta-analysis stage by rescaling the score statistics and covariance matrices.

the four packages generate a variety of auxiliary information, which may not be equivalent. if a particular field in the target files is essential for the corresponding software to perform meta-analysis but cannot be retrieved or derived from the provided files, then premeta will request additional information from the user. for instance, the reference and alternative alleles are required for meta-analysis by raremetal and metaskat but are not available in the files of mass and seqmeta. in this case, premeta will request an additional file with the allele information when converting files from the mass or seqmeta format to the raremetal or metaskat format. if a particular field in the target files is not essential for meta-analysis, then premeta will recover this field whenever possible and insert pseudo values that are compatible with the target format otherwise. for example, the hwe p-value is provided by raremetal but not by the other three packages. premeta will calculate the hwe p-value based on the heterozygous and homozygous counts when converting files from the mass format and will set it to be one when converting files from the seqmeta or metaskat format because the information in these files are not sufficient to calculate hwe p-value and raremetal does not allow this value to be missing.

premeta is a freely available c++ program that runs on unix and linux systems. it is a stand-alone executable and can process  files produced by other packages: text files produced by mass and raremetal, binary files produced by metaskat, and r data files produced by seqmeta. the basic command is:





the software argument specifies the target software, the version of which can be specified by the version argument. premeta currently supports four target software packages: v <dig>  of mass, v <dig> . <dig> of raremetal, v <dig>  of metaskat, and v <dig>  of seqmeta. the script argument specifies a file that lists the input files to be converted by premeta and is formatted as described below.

the script file contains a block of keywords and values, with one block for each study; see table  <dig> and fig.  <dig>  the keyword software indicates the software program that was used to generate the files for the study. this keyword is required to appear before all other keywords in each block. the keyword version indicates the version of the software. premeta currently supports five software programs: v <dig>  of mass, v <dig> . <dig> and v <dig> . <dig> of raremetal, v <dig>  of metaskat, and v <dig>  of seqmeta. the old version of raremetal  is supported by premeta as input format to facilitate meta-analysis directly using the summary statistics in the old format of raremetal and thus avoid re-running the study-level analysis to create files in the current format. the raremetal v <dig> . <dig> is not supported by premeta as output format because the current meta-analysis should use the new version of raremetal. the files to be converted are specified with keywords prefixed by file ∗; the specific keywords depend on the software. if software = mass, then the file from mass should be specified via the keyword file. if software = raremetal, then three files must be provided: the covariance and score files from raremetal should be specified via the keywords file_cov and file_score, respectively, and a gene grouping file must be specified via the keyword file_group. this third file is necessary to convert the sliding-window covariances to the gene-based covariance matrices of the other three packages. the file_group file is not necessary if the target software is also raremetal, e.g., when using premeta’s rescale functionality or converting the old raremetal format to the newer format. if software = metaskat, then the.mssd and.minfo files should be specified via the keywords file_mssd and file_minfo, respectively. if software = seqmeta, then the rdata containing the seqmeta object should be specified via the keyword file_rdata. finally, the keyword rescale is used to implement r-int by specifying the original trait variance.
fig.  <dig> the analysis pipeline for the meta-analysis of all the esp and charge studies on body mass index, with the esp phenotype groups and charge cohorts stratified by race  and gender





an additional keyword snp_info is required in the script file if the target software is raremetal or metaskat and the software for the study-level analysis is mass or seqmeta. this file specifies the reference and alternative alleles for all snp positions. an optional function of the snp_info file is to provide mapping between the study-specific snp id and meta-analysis snp id, such that premeta can unify different forms of the snp id across studies. for example, the snp id in the raremetal takes the form of chr:pos, so snp_info needs to contain the meta-analysis snp id in the form of chr:pos if the study-specific snp id is not in this form.

premeta identifies allele mismatch across studies. it generates an allele reference list from the input files using the reference and alternative alleles of the first occurrence as the gold standard. such list can also be provided by specifying the global_snp argument on the command line, in which case premeta flags the reference and alternative alleles that are not consistent with the list. in addition, premeta corrects the relevant summary statistics on the occasion that the reference and alternative alleles are switched.

RESULTS
premeta played an important role in the meta-analysis of exome sequencing data from the national heart, lung, and blood institute  exome sequencing project  and the cohorts for heart and aging research in genomic epidemiology  consortium. raremetal was chosen to perform meta-analysis of rare-variant associations. however, raremetal is not appropriate for the nhlbi esp because it does not support extreme-trait sampling. in the nhlbi esp,  <dig>   <dig>  and  <dig> individuals were sequenced because of extremely high or low values of body mass index, low-density lipoprotein, and blood pressure, respectively. thus, we used score-seqtds to generate summary statistics for the nhlbi esp and raremetalworker for the charge studies. we then used premeta to convert the files from the mass format to the raremetal format and rescaled the score statistics and covariances to implement r-int for all studies. finally, we uploaded the resulting files in raremetal to perform meta-analysis. figure  <dig> shows this analysis pipeline.

to evaluate the performance of premeta, we used the four packages to generate summary statistics for the female european americans in the esp’s deeply phenotyped reference , which is a random sample of individuals with measurements on a common set of phenotypes. we used premeta to convert the output files from one format to the other formats. figure  <dig> shows the sizes of the output files from different packages when analyzing chromosome  <dig> . it also shows the premeta runtime for converting between any two formats on an ibm hs <dig> machine, which amounted to essentially a few seconds. the original prototype of premeta was written in an r script. the processing speed using the r script is slow in the real-data analysis, which prompted us to program premeta and its speed is much satisfactory.
fig.  <dig> premeta runtime in reformatting summary statistics from the dpr female study




to investigate the intrinsic differences among the four packages and to illustrate the reformatting function of premeta, we performed meta-analysis of the female samples and the male samples from the dpr using the sequence kernel association test . we first used each package to perform both the study-level analyses and the meta-analysis. the results from the four packages are almost identical . we then converted the files for the female study from the formats of the other software packages to the format of the target package and repeated the analyses. we used the target package for the study-level analysis of the male study and the meta-analysis. the meta-analysis results based on the converted files are highly consistent with the results using files directly generated by the target package . we examined the few inconsistent points, and they were all caused by the fact that metaskat flipped reference and alternative alleles when maf >  <dig>  in the study-level analysis and removed snps with mismatched alleles among studies.
fig.  <dig> skat p-values in -log <dig> scale from meta-analysis of the dpr male and female studies by mass v <dig> , raremetal v <dig> . <dig>  metaskat v <dig> , and seqmeta v <dig> . the same software package was used to generate summary statistics for the studies of female and male european americans in the dpr phenotype group of the nhlbi esp and to perform the meta-analysis


fig.  <dig> skat p-values in -log <dig> scale from meta-analysis of the dpr male and female studies by mass v <dig> . the summary statistics of the female study were generated in turn by mass v <dig> , raremetal v <dig> . <dig>  raremetal v <dig> . <dig>  metaskat v <dig> , and seqmeta v <dig> . premeta converted these summary statistics to the mass v <dig>  format. mass v <dig>  was used to generate the summary statistics of the male study and to perform the meta-analysis by combining the reformatted summary statistics from each software package for the female study and the summary statistics for the male study


fig.  <dig> skat p-values in -log <dig> scale from meta-analysis of the dpr male and female studies by metaskat v <dig> . the summary statistics of the female study were generated in turn by mass v <dig> , raremetal v <dig> . <dig>  raremetal v <dig> . <dig>  metaskat v <dig> , and seqmeta v <dig> . premeta converted these summary statistics to the metaskat v <dig>  format. metaskat v <dig>  was used to generate the summary statistics of the male study and to perform the meta-analysis by combining the reformatted summary statistics from each software package for the female study and the summary statistics for the male study


fig.  <dig> skat p-values in -log <dig> scale from meta-analysis of the dpr male and female studies by raremetal v <dig> . <dig>  the summary statistics of the female study were generated in turn by mass v <dig> , raremetal v <dig> . <dig>  raremetal v <dig> . <dig>  metaskat v <dig> , and seqmeta v <dig> . premeta converted these summary statistics to the raremetal v <dig> . <dig> format. raremetal v <dig> . <dig> was used to generate the summary statistics of the male study and to perform the meta-analysis by combining the reformatted summary statistics from each software package for the female study and the summary statistics for the male study


fig.  <dig> skat p-values in -log <dig> scale from meta-analysis of the dpr male and female studies by seqmeta v <dig> . the summary statistics of the female study were generated in turn by mass v <dig> , raremetal v <dig> . <dig>  raremetal v <dig> . <dig>  metaskat v <dig> , and seqmeta v <dig> . premeta converted these summary statistics to the seqmeta v <dig>  format. seqmeta v <dig>  was used to generate the summary statistics of the male study and to perform the meta-analysis by combining the reformatted summary statistics from each software package for the female study and the summary statistics for the male study




CONCLUSIONS
due to ethical and logistical difficulties in sharing individual-participant data, the use of summary statistics is strongly preferable when synthesizing results across studies. the summary statistics generated by the four software packages for meta-analysis of rare-variant associations are not compatible in format or content. premeta processes these summary statistics to make them compatible and avoids the need to redo study-level analyses. as different versions of a particular package may adopt different formats, we will periodically review the formats employed by new releases of the four packages and update premeta accordingly.

availability of data and materials


project name: premeta


project home page:
http://dlin.web.unc.edu/software/premeta



operating system: unix/linux


programming language: c++


license: gpl-3


availability: premeta, including source code, documentation, and examples, is freely available for non-commercial use with no restrictions at http://dlin.web.unc.edu/software/premeta.




abbreviations
chargecohorts for heart and aging research in genomic epidemiology

dprdeeply phenotyped reference

espexome sequencing project

hwehardy-weinberg equilibrium

intinverse normal transformation

mafminor allele frequency

nhlbinational heart, lung, and blood institute

r-intrescaled inverse normal transformation

skatsequence kernel association test

snpsingle nucleotide polymorphism

