BACKGROUND
mathematical models are a natural approach to improve our understanding of complex biological systems, and ultimately enabling us to predict their behavior and control them  <cit> . in particular, the intricacies and nonlinear nature of the mammalian immune response have attracted considerable attention over the years  <cit> , in no small part due to the role of the immune response in a variety of relevant human conditions. in addition, the existence of a mathematical model allows one to explore the known differences in immunity development between human and non-human species  <cit>  by altering or excluding specific pathways, as dictated by experimental findings. the basic components of interest would in principle include: cellular or cytotoxic responses , humoral responses  and signaling features   <cit> .

in general, the development of quantitative models is often based on the selection of features of interest and their description in mathematical form, followed by their functional integration into a model that can be interrogated and/or used to predict features of interest. such features can then be compared to experimental data. similar procedures are followed for immune response models, but due to the system’s complexity, modeling and simulation efforts have focused on specific subsets of the system, such as the cellular responses  <cit> , humoral responses  <cit>  and/or cytokine networks  <cit> , while sometimes excluding or simplifying other components from the model. as a general consideration, the development of comprehensive models is difficult and has to contend with the integrated network nature of the system, where the addition of one novel component necessarily requires defining the interactions of the new item with the remainder of the network.

several modeling formalisms have been used in developing models of the immune system. historically, these have been mostly categorized as differential equation models or agent-based models. agent-based models or cellular automata models of the immune response have attracted great interest  <cit>  since very early studies  <cit>  and have been refined and proposed over the years in a manner that is responsive to new knowledge  <cit> . their greatest strength is their flexibility and relative ease of use  <cit> , which makes them suitable to model very complex systems without having to mechanistically specify the known component interactions. instead, the system is defined in terms of “computer agents”, which are sets of rules by which individual actors  are created, interact and are destroyed. the modeling effort then focuses on monitoring the interactions among agents, which gives rise to complex, sometimes emergent behaviors that, depending on the rule base, can provide a striking similarity to the temporal evolution of the system being represented. such models can then be used to develop answers to complex problems, including therapy optimization  <cit> . as others have pointed out  <cit> , despite their power, challenges remain with agent-based models, including the availability of widely accepted software and of model checking and goodness of fit strategies that resemble those commonly used for differential equation models. differential equation models have provided tremendous insight in the dynamics of complex immunological networks  <cit>  and are still widely used, relatively easier to communicate and more readily shared than agent-based models. some of these models can achieve remarkable degrees of complexity and realism  <cit> . in addition, differential equations form the backbone of translational pharmacokinetic-pharmacodynamic  models  <cit> , the class of models that describe how drug dose influences response through quantitatively linking the drug dose to exposure  and the exposure to response  in a living system. these historically are the models of choice in drug research and development.

the integration of multi-scale, realistic models of physiology with pharmacotherapeutic models is a desirable goal that would allow more mechanistic, predictive and overall useful models for drug research and development  <cit> , in addition to enhancing collaborative efforts between biology and modeling. this effort is receiving renewed attention through the area of “systems pharmacology”  <cit> , as explored in two successful interdisciplinary workshops hosted by the national institutes of health in  <dig>  and  <dig> . issues related to efficient model sharing and model construction are also the purview of the interagency modeling and analysis group  . building these models accurately and efficiently represents a significant challenge. this has prompted the development of sophisticated software to facilitate integration of separate submodels  <cit>  and parallel computation  <cit> .

the recent availability of computational environments to functionally connect submodels without having to write ad hoc computer code is well complemented by the development of approaches to supervised “monolithic”  <cit>  model integration. in our case, a differential equation framework was chosen for the development of an integrated immune response simulator, coupled with a useful framework, found in systems biology, for integrating multiple subset models into a coherent whole. in this framework, connectivity matrices are built to describe the global network structure, followed by introduction of rate laws to seamlessly integrate multiple biological processes  <cit> .

the fully-integrated immune response modeling  simulator is a differential equation based integration of multiple existing models of the immune system  <cit> . it accounts for both the humoral and cellular immune response systems and attempts to parsimoniously represent the spatially distributed nature of the system. the goal of this integrated model is to specify antigen exposure over time and calculate predicted antibody levels and cell concentrations following biological perturbations such as immunization or infection. to develop firm, we used a pharmacokinetic / pharmacodynamic modeling approach to combine previously published individual models of humoral and cellular response with antigen exposure. firm includes both the antigen-specific antibodies and cell populations, and accounts for cytokines and adjuvant components as needed. it is a hybrid construct incorporating structures and parameter values from published models in multiple mammalian species.

this report outlines the stepwise integration of networks describing the cellular dynamics for both t and b-cell responses to bacterial infections and to tumor growth in a target organ. in addition, to illustrate the incorporation of novel mechanisms, we propose and integrate within the framework a new hypothesized model of regulatory t-cell kinetics accounting for immunoevasion.

methods
model formulation and content
the process of building an integrated simulator starts with the definition of the underlying physiological structure. this preliminarily defines the existing interrelations among all the variables of interest as a “superset” of cellular and molecular populations and reactions. second, all the cellular and molecular state variables are identified and the interrelationships  between them determined. the structure of the networks is thereby specified. third, the mathematical forms of the equations that describe the fluxes are then formulated and their numerical values determined . usually, the first two steps involve the determination and selection of existing relationships that have a physiological basis. as such, they are somewhat easier than the third step, where such relationships need to be made specific and quantitative. the availability of plausible numerical values is a well-known rate limiting step in the definition and assembly of kinetic models, and in the rest of this section we will outline the approach we followed to inform firm’s parameterization.

mathematical formalism
all the models we considered for integration obey the general governing equation to describe dynamics of cell and mass balance models:

 dx/dt=s.vx;k 

where x is the vector of state variables  and v is the vector of fluxes from one state to the next . s is a matrix that describes the structure of the network and its topology. every column in s represents a flux and every row represents a state variable. the vector k contains the numerical values of the kinetic and physical constants . in general, the vector of fluxes v is a function of the state variables and the kinetic and physical constants characterizing transport and reaction processes.

three published models of the immune response, each highlighting different features of the system  <cit> , were identified for inclusion in firm. the reconstructed network for the immune response is shown in figure 1a for the cell populations involved in the system and in figure 1b for the cytokines relevant to the model. an explanation of the abbreviations is included in the figure legends. volume heterogeneity in the model is accounted for and described in the next section. in addition, there were fluxes in the reconstructed network that are inactive in the final firm model’s computational  implementation. the reasons for inactive fluxes vary, including for example: redundancy, namely their function is accounted for elsewhere in the model; removal or inactivation of a node; lack of data to properly inform the flux. full details of inactive fluxes, and the reasons for deactivation, can be found in the supplemental material . since some fluxes were inactivated, not all the nodes we initially considered as part of firm were active in the final structure: specifically, the function of mapc  is incorporated in the dendritic cell population and not explicitly accounted for; and, the function of th <dig> in the humoral response was not included due to lack of quantitative information regarding this component. consequently, the relevant cytokine network components are also inactive.

the matrix s, the state variables and the fluxes corresponding to the final structure of the firm model are found in supplemental additional file 1: tables s <dig>  s <dig> and s <dig>  the mathematical form of all the flux variables are given in additional file 1: table s <dig>  and the numerical values and their literature sources are found in additional file 1: table s <dig> and s <dig> 

spatial distribution features
to account for known features of the spatial distribution of the immune response components in our simulations in a parsimonious manner, the firm model has five separate tissue spaces where the cell and cytokine populations can travel: lung , blood , lymphoid tissues relevant to the cellular  and humoral response  and the sites of immune recognition . as populations of cells and molecules travel between biological spaces, their concentrations are multiplied by the respective volumes of distribution so as to maintain mass balance. this was particularly important for the population of infected macrophages, which changes dynamically as bacterial infection progresses and turns out to have a time-dependent variable volume of distribution whose features needed to be accounted for in the simulation. additional file 1: table s <dig> in the supplementary material contains the various tissue space volumes.

it is worth noting that this is a parsimonious representation since, to accurately represent spatially differentiated behaviors, one would have to define biological spaces for each spatially  separate component of each organ or tissue that has a distinct pattern or behavior from other parts of the organ or tissue under consideration. these spaces would be defined so as to have different volumes, rate constants for accessibility, etc., to reflect their heterogeneous physical structure and, given the number of parameters required, would require detailed experimental information at the cellular and molecular level. in this sense, firm is a parsimonious model and does not reach this level of granularity, although the model structure is amenable to be extended and incorporate such considerations where warranted, required by the purpose of the modeling exercise and supported by the data.

simulation platform and integration procedure
mathematica  was used as the model-building platform. the integrated model was assembled in a stepwise fashion. specifically, the concentration and flux vectors in the model structure were populated step-by-step with the appropriate features and components, as illustrated in figure  <dig>  firm was built in mathematica  <dig> . the mathematica workbook that resulted was used to generate all graphs in this paper from firm simulations. the simulator is portable to other simulation platforms: a matlab  version of the firm simulator was also generated. additional file 1: tables s <dig> to s <dig> contain a full specification of the firm simulator, suitable for implementation in other matrix languages.

RESULTS
 procedure for integrating multiple dynamic models from different sources
as described in the methods section, the dynamic simulator is expressed as a series of balance equations. mathematically:

 dx/dt=s.vx;k 

where x is the vector of state variables  and v is the vector of fluxes from one state to the next . s is a matrix that describes the structure of the network and its topology. every column in s represents a flux and every row represents a state variable. the vector k contains the numerical values of the kinetic and physical constants. the contents of all these mathematical objects are found in additional file 1: tables s <dig> , additional file 1: table s <dig> , additional file 1: table s <dig> , additional file 1: table s <dig> , additional file 1: table s <dig> , and additional file 1: table s <dig> .

the reconstructed network is shown in figure 1a. it includes all the major t and b-cell types, the pathogens , as well as tumor and its debris. the regulatory effects of the major inflammatory growth factors and cytokines are shown in figure 1b. these graphs highlight the boundaries of firm. the processes that we considered for inclusion have been described multiple times  and relate to humoral and adaptive immunity. briefly, the humoral side of the system describes the activity of b-cells that, when in contact with an antigen/pathogen, secrete antibodies which are essentially a secreted version of their receptor compatible with the antigen). the antibodies bind to the antigens and neutralize them. the link between the humoral and the cellular components of the system is provided by helper t-cells, which activate b-cells. this function is currently not included in the model since it was not a part of the constituent submodels. the cellular side starts with naïve t-cells recognizing antigen epitopes through antigen presentation via dendritic cells and macrophages and subsequently developing a t-cell driven response to the antigen. this process is particularly important when the pathogen is a cell, such as in cancer and bacterial immunity, which are both described in firm. t-cells can also differentiate to regulatory t-cells, which essentially mute features of the immune response.

the firm simulator was built in a step-by-step fashion, summarized in figure  <dig>  from both constituent models that have appeared in the literature  <cit>  and novel mechanisms. a summary of those steps is below.

immune response to tuberculosis  infection <cit> : cellular response to bacterial challenge. the model integration in firm started with a published model for tb infection of the lung . this model described the activation of macrophages, their infection, and the antigen presentation by dendritic cells that leads to differentiation of t-cells in lymphoid tissue; these cells then migrate to the lung where they differentiate into t <dig> and t <dig> helper cells. the scope of this subset model is described in figure  <dig>  the mk model also included a rather detailed representation of the cytokine signaling network following infection, which is not shown in figure 1a for simplicity .

the mk model state variables and fluxes were introduced into the network and used to specify the x and v vectors in the overall mass-balance model. this was done in a step-wise fashion and the process was quality controlled at each step. briefly, to ensure quality control of the implemented model, all fluxes in the network are turned off except one at a time  and conservation of mass is checked for. this is repeated every time a new population of either cells or molecules is introduced in the model, thus ensuring that no arbitrary gains or losses occurred at any step during model building. a sample qc/qa document is provided in additional file 1: figure s <dig>  there were several issues and simplifications associated with mapping the mk model onto the unified network structure at the basis of firm. these included changes in basal states , accounting of cell population dynamics to obey mass balance  and accounting for the variable volume of distribution of the infected macrophages and for the appropriate volume ratios for cell and molecule migration. as a final check, the simulations of this initial model were compared with those available from the original publication . while the agreement was not exact, this was to be expected given that changes were made to the original model formulation. details regarding the mapping of the mk model onto the firm framework are provided in the table  <dig> 

immune response to tumor formation <cit> : cellular response to tumor challenge. the second subset model identified for inclusion in the integrated model  described the inflammation response to the presence of a tumor. its components were the growth of tumor mass, the activation of macrophages in response to the tumor cells, the proliferation and differentiation of cytotoxic and t <dig> helper cells, and the killing of tumor cells creating tumor debris. the original formulation of this subset model had all tracked populations in a single biological space; therefore, the cell populations described in the model had to be mapped to their appropriate organs. the scope of this model can be seen in figure  <dig>  together with its overlap and points of contact with the mk model. once again, the state variables and fluxes associated with the content of this subset model were added to the model network.

the inclusion of the db model marks the first integration in the firm system of two separately developed and reported kinetic models . the integration of two kinetic models resulted in some complexities, reflecting in turn: the state of biological knowledge revealed by the models, the assumptions made, the structure of the network, and the detail of the quantitative information. the process of integrating models from various sources and built for different mammalian species requires explicit and sometimes implicit biological and structural assumptions. we summarized those choices as “integration issues” and they are reported in detail in the table  <dig>  the resolution of integration issues is critical to the construction of an integrated model such as firm. for example, the db model included processes and parameters which tended to be descriptive as opposed to mechanistic, reflecting the knowledge of immunology at the time. therefore, the issues involved with the addition of the db model included integrating phenomenological parameters into the firm state variable and rate law structure , selecting a value for kinetic constants that appear in both models, and including new network fluxes, mostly cellular, as necessary to integrate the models to ultimately ensure balance of mass.

b-cell response to antigen <cit> : humoral response to antigen challenge. the third subset model that was included in firm  details the b-cell and antigen response to the presence of an antigen in the system. included in the bl model is the exposure of naïve b-cells to antigen, the activation of b-cells that migrate to the lymphoid b via the blood, the differentiation of activated b-cells to plasma and memory b-cells, and the production of antibodies by said b-cells. lastly, the antibodies work to eliminate the antigen from the blood and the target organ. this model’s components are again shown in figure  <dig>  which also highlights commonalities with the mk and db models.

again, the integration of the bl subset model into the framework of firm led to some integration issues. the bl model had a rich level of molecular detail when describing the interaction of b-cell receptors, antibodies, and antigens. these interactions were simplified in the original model through the use of quasi-equilibrium assumptions. given the level of granularity in firm, these assumptions could be relaxed and the full details of the underlying molecular processes are described. therefore, the network structure accommodates antigen and antibody binding . the inclusion of this subset model in the network was a major integration issue with firm, since the network had to be substantially expanded to include all of these detailed processes. integration issues are reported in detail in the table  <dig>  briefly, antigen-antibody binding reactions  include: a free antibody binding to a free antigen creating a single-bound antibody; a single bound antibody binding to a free antigen creating a double-bound antibody; the removal/clearance of a single-bound antibody; and the removal/clearance of a double-bound antibody.

the incorporation of the bl model essentially completed the firm structure based on published models. figure  <dig> shows a simulation of the fully integrated firm model at nominal parameter values . this is a base case simulation with an initial load of  <dig>  infecting bacterial cells in the target organ. the bacteria cells are allowed to migrate into the blood as well, thus triggering a strong antibody response. the b-cell receptor density for the bacteria is assumed to be  <dig> molecules/ml, in keeping with the bl model.

it should be mentioned at this point that the constituent models composing firm were not necessarily tailored to a particular animal species. the bl model description mentions data being obtained in rabbits, but it also states that the model recapitulates essential features of the mammalian immune response. the db model is based on data in mice, while the mk model was built to be applicable to humans. this makes firm a hybrid model containing features of a few mammalian species. that being said, validation of models against data is a tool of paramount importance in model development. firm provides predictions of timing and extent of immune respone, which can be compared against experimental data. while we propose here the firm structure and have strived to maintain consistency of units across the models, we make no attempt at validation and later we propose approaches to test this important question.

addition of tregand tgf-β: with the integration of the mk, db, and bl models, we have created a platform with which basic immunological simulations can be performed. the firm platform is flexible enough to easily introduce new information and physiological responses. this section demonstrates that principle through addition of regulatory t-cells . treg play an important role in the immune system’s response to a tumor. treg are a rather new discovery in the immunological field, and considered to be of great importance. therefore, treg were selected to be the first addition when expanding the firm platform beyond the original publications.

there are two sources of treg in the body: the first source is from the lymphoid t and the second source is a resident population in the target tissue  <cit> . treg, much like the tcp and thp, will also have a constant differentiation from the naïve t-cell population in the lymphoid t that will travel into the blood. treg account for 5%-10% of the t-cells in the blood in a normal state  <cit> . the differentiation in the lymphoid t was calibrated appropriately to reflect these levels. once the treg reach the site of the tumor, they produce tgf-β, a cytokine that has a down-regulatory effect on the proliferation of cytotoxic t-cells. cytotoxic t-cells assist in killing tumor cells, so it stands to reason that tumor cells play a role in the proliferation of treg in the target tissue. a visual representation of the treg addition can be seen in figure  <dig>  treg exist in the lymphoid b, the blood and the target organ. naïve t-cells differentiate to treg in the lymphoid t; they migrate to the blood where they are subject to removal or recruitment to the target organ; they can also proliferate in the target organ. tgf-β is produced and decays in the target organ, where it exerts its effect on t-cell kinetics. the majority of rates and parameters used in the rate laws were assigned values based on approximations. these approximations were picked to be similar to the values of the rates associated with other t-cell lineages and cytokines in firm. the exact numerical values of the rates and parameters are still a subject of evaluation and examination of relevant literature and future experimentation.

the basal state: as with all kinetic models, firm has a basal  state. in this particular case, the basal state represents the immune system components’ baselines when there is no antigen present. such a basal state reflects steady state homeostasis and was calculated using the nominal parameters and running the model to stable steady state conditions. calculated basal state cell populations include:  <dig> resting macrophages in the target organ, 5 ×  <dig> dendritic cells in the target organ, ~8 ×  <dig> naïve t-cells in the lymphoid t, ~103 t helper precursor cells in the lymphoid t, 3 × 103 t helper precursor t cells in the blood, ~2 ×  <dig> naïve b-cells in the site of recognition, ~ <dig> cytotoxic t precursors in the lymphoid t, 5 ×  <dig> cytotoxic t precursors in the blood, ~3 ×  <dig> molecules of il- <dig> and ~3 ×  <dig> of tgf-beta in the target organ,  <dig> treg in the blood, 2 ×  <dig> in the lymphoid t and  <dig> in the target organ, and ~2 ×  <dig> free receptor sites on the naïve b-cells in the site of recognition. the treg in the blood account for about  <dig> % of all t cells circulating in the blood  <cit> . in the basal state, the system is free of antigens, and, therefore, antibodies. this basal state can then be perturbed by exposure to antigen reflecting various stimuli or pathological situations. the response to one or many antigens can be simulated.

the final version of the firm simulator has  <dig> nodes ,  <dig> distinct processes and  <dig> parameters. as defined and with the postulated interactions and parameter values described above, the firm simulator is an initial step towards a simulator of the immune response capable of representing a variety of putative challenges. to demonstrate the use of firm we present four case studies that illustrate its different features and capabilities.

 use of the simulator – case studies
based on the full model, changes in network structure and parameter values can be defined to mimic known occurrences in immune response modulation. within firm, completely different situations involving immune system cells, and foreign and endogenous molecules, can be modeled in a few steps. deactivating one or two fluxes can drastically change the conditions of a simulation. among many possible simulations, four cases of interest are explored:

 <dig>  tb infection;

 <dig>  blood borne pathogen infection;

 <dig>  spontaneous tumor rejection;

 <dig>  influence of treg on tumor rejection.

the first two case studies represent confirmatory simulations for comparison with the original mk and bl model results.

tb infection
to simulate a pure tb infection,  <dig>  extracellular bacteria were introduced into the lung  and flux v <dig> was deactivated. flux v <dig> represents the permeation of extracellular bacteria between the target organ and the blood . flux v <dig> was thus deactivated to prevent the bacteria from migrating away from the lung. the tb infection is known to stay local in the lung and not permeate into the blood. firm was then simulated with its nominal parameters.

as shown by the mk model, a tb infection is thought to be dealt with exclusively by the cellular response with no response from the humoral system. a chronic infection is simulated. the t-cell response that is solicited by the immune system is enough to prevent runaway growth by the bacterial population in the lung. even though the cellular response prevents runaway growth, the levels of infected macrophages are rather large and stay constant. the results can be seen in figure  <dig>  as one would expect, the simulation results closely resemble the mk model, which was specifically developed to represent tb  <cit> . this simulation illustrates that the integrated firm can still recapitulate the trends initially found with the mk model.

blood borne pathogen
in this simulation, a blood borne pathogen originates in the blood and remains confined within the circulation. for simplicity, the increase in antigen load prior to the induction of an immune response is represented as a spike  increase. an example of this situation would be a viral infection. the pathogen does not permeate into the tissue to infect, for example, resident macrophages. to simulate a blood borne pathogen in firm, fluxes v <dig> and v <dig> were deactivated. these two fluxes model the access of antigen between the target organ and the blood. this simulation used nominal parameter values and an initial condition of  <dig>  antigen molecules in the blood. the results of the simulation can be seen in figure  <dig> 

the humoral  response was used by firm to eliminate the infection. in fact, in the case study, as expected, the cellular response is virtually non-existent. the antigens never come in contact with the dendritic cells in the tissue. therefore, there is little antigen presentation to the t-cells in the lymphoid t to drive differentiation of the naïve t-cells. the graphs in figure  <dig> show a fast humoral response flooding the blood vessels with antibodies. the antigens are quickly bound to the antibodies in the blood and are removed from the system as antibody-antigen complexes. this simulation resembles the behavior of the original bl model, confirming the performance of the integrated firm against the individual submodels.

tumor removal
since no tumor-antibody interaction is defined in firm at this point , simulations of tumors will not include migration of tumor antigens  into the blood from the target organ. therefore, the flux v <dig> was deactivated for this case study. additionally, we changed the half-life of all t helper cells to  <dig>  day- <dig> from  <dig>  day- <dig> . the updated half-life was derived from the db model, while the previous half-life was derived from the mk model. as a justification, through successive model runs we observed that an elevated half-life for the t-cells prevented them from encouraging proliferation of cytotoxic t-cells and therefore prevented tumor kill. this shows that tumor removal by the immune system may be influenced by the kinetics of these cells and also points to features of the model that greatly influence its predictions.

firm was then simulated with one initial tumor cell in the target organ. this simulation scenario  highlights the multi-scale temporal characteristics of the firm simulator. initially, the tumor grows at a rapid rate, seemingly unchecked. the growth is quickly suppressed by a macrophage response. the activated macrophages reach a level at which the tumor cells are no longer growing, rather settling around a small population size. after this initial response by the macrophages, the presence of the tumor triggers a cellular response. this t-cell response requires a longer time period in order to proliferate to a population size capable of eliminating tumor cells in the target organ. once the cytotoxic t-cells reach a critical level, the cellular response is able to eliminate the tumor. once the tumor has been eradicated, the cell populations move back to their steady state levels. this simulation calls into play the features of the db model  <cit> , with one important difference. while the db model contained phenomenological features, these have been mostly replaced in the integrated firm with more mechanistic cell populations and fluxes which better reflect physiology. it is reassuring that the outcome of the simulation resembles the original model, but it does so with more mechanistic detail about the cellular populations involved. generic inflammatory signals are still used to represent the kinetics of il- <dig> and il- <dig>  it is worthwhile to mention that tumor secretion of tgf-β would be expected to contribute to these processes by promoting immunoevasion: this is discussed in the next case study, where regulatory t-cells are integrated in the simulation.

what truly happens in the mammalian immune system following challenge with a single proliferating tumor cell is unknown. however, it has been assumed that the immune system regularly removes tumor cells that may arise spontaneously . if anything, this simulation highlights the role played by the t helper population interaction with the tumor. in our hands, a change in this population’s reported half life to  <dig>  day- <dig> from  <dig>  day- <dig> was sufficient to produce a more realistic output; however, the model structure may also have been incorrectly specified in the original models. overall, these considerations point to experimental and research areas of focus. in addition, other parameters in the model may have similar strong influences on the model predictions.

influence of treg on tumor rejection
regulatory t-cells are resident in tissues and can also be activated through differentiation in lymph nodes through antigen presentation by dendritic cells, with subsequence migration to the site of action. several cytokines are now known to be involved in this process. the introduction of treg and tgf-β into the system has a profound effect, as can be seen in figure  <dig>  the tumor profiles behave similarly as to the previous scenario until about day  <dig>  the tumor experiences growth and is then rejected. the delay in the rejection of the tumor is due to the hampered proliferation of the t-cell population in the target organ, caused by having added treg and tgf-β dynamics to the model. it essentially takes the t-cell population over 60 days to reach an effective tumor killing level, while previously that took only 45 days.

the treg addition had a profound effect on how the comprehensive system reacts to the presence of a tumor. as such, it is a good example of how the firm simulator can be expanded to include additional, more realistic characteristics of immunological responses. this addition reduces to practice how firm could be expanded towards the ultimate goal of building a more comprehensive mathematical representation of immune system features.

CONCLUSIONS
inflammation and immune response are thought to be a common denominator in human disease. a comprehensive simulator of the immune response in human tissues is thus a needed tool for a variety of applications. firm was undertaken as an initial step towards meeting this need. the development and use of firm showed that:  already developed and proven methods from systems biology could be used to facilitate the construction of a platform for the integration of subset models each focusing on a feature of the immune response;  these methods can be successfully implemented to generate an integrated simulator; and  that firm can account for a variety of challenges to the human immune system through its multi-scale characteristics. a structure such as firm can be used prospectively for iterative model building, as the scope of the simulator grows and as new discoveries are made and integrated in the framework; at the same time, the predictions from firm can be compared against experimental data, to improve the model and, consequently, mechanistic understanding of its underlying biology.

as molecular systems biology has developed over the past decade, large-scale and even genome-scale models have been formulated  <cit> . these models are formed from reconstructed networks based on biochemical, genetic and genomic data, and thus have been able to compute a variety of phenotypic functions. this process has been particularly successful for metabolic models  <cit> . since such models are mostly based on the universal principles of flux or mass balance, this process can be applied to systems analysis of complex dynamic systems, such as the immune response. we were able to build firm based on a reconstructed network of the main cellular and molecular components involved in the immune response. the key challenge over the individual component models is that firm is built on multiple tissue spaces of different volumes, even varying volumes in some cases. additionally, the model equations are formulated in terms of total counts of each variable in a given tissue space. this allows for complete and accurate accounting and balancing of all state variables. concentrations of cellular and molecular species can then be computed by simply dividing the total amount at each time point with the biological volume of the space, thus allowing for direct comparison to experimental measurements.

the reconstructed network was then populated with information from published models that describe subsets of the immune response. these published models contained detailed information about the mathematical form of the flux equations. in addition, numerical values for all the parameters are provided in these subset models that are typically obtained from measurements or the available experimental literature.

the putative reconstructed network allows the mapping of multiple subset models and their ready integration under a unified format. in principle this is a simple process, but in practice it has been implemented as a stepwise procedure that reveals subtle integration challenges as additional subset cellular and regulatory processes are added. one of the major integration problems arises when discrepancies in the numerical values for the same parameter appear in different subset models. for example, in some cases, assumptions about the physiological processes accounted for in a subset model were not needed in the comprehensive network reconstruction and thus had to be relaxed or otherwise modified  from macrophage activation in the db model). this was relatively easy to accomplish since the network reconstruction has a manageable amount of biological and biochemical detail.

integration of three t-cell responses, the full b-cell response and the regulatory action of key growth factors was performed. all these subsets of the immune response form a postulated, coherent whole as described by firm, which by its integrated nature is more comprehensive than any of the individual subsets and can be further expanded for additional realism. firm is thus capable of simulating both tumor and pathogen challenges to the immune system, either separately, or simultaneously. when firm is applied to simulate such challenges, it displays appealing multi-scale  characteristics. this was demonstrated through case studies representing the formation and eradication of a tumor, and the response to tb infection. the challenges encountered in integrating the firm network and its component models are actually representative of the obstacles that can be encountered when attempting to synthesize published mathematical models in a cohesive whole. all biological system models are usually delimited by the boundaries of the system being studied – they are not comprehensive because they cannot be. their scope is usually limited to the original question they were designed to answer. the biological modeling community is currently entering a new stage: it already moved from the development of individual models to the definition of databases and repositories for these models to be shared; the next evolution is to provide robust tools for on-demand component model integration. this task is addressed in this work. when performing model integration, care must be taken not to reach over the scope of the original component models, especially by trying to incorporate or match aspects that cannot be generalized. this is best decided on a case by case basis. firm is a starting point for the modeling community to consider these issues.

given its current state and the iterative model building enabled by the systems biology approach used in its development, firm can and should be expanded to account for additional components of the immune response as new knowledge becomes available. an important area where firm could be expanded is the innate response, including natural killer  cells. models have been recently developed  <cit>  to characterize this response component. it would also be useful to examine the behavior of firm in the context of reinfection, through refinement of the memory b-cell models and kinetics. in addition, a mechanism for antibody-dependent cellular cytotoxicity  would provide an unambiguous link between the db and the bl model and would enrich the firm structure. perhaps the most important missing feature from firm is the activation of the b-cell cascade by the t-helper  <dig> cells, which is a known, essential mechanism for humoral response initiation. all these remain important areas for further development, whose investigation is made somewhat easier by firm’s modular structure.

since it is possible that a range of parameter values could provide similar unperturbed state values, another area of future investigation would involve sensitivity analysis of the model. to explore this, the model could be expanded to include stochastic behavior so as to account for random variation of the state variables around a physiological set point. additionally, the model could incorporate expected daily fluctuations, such as e.g. circadian changes, to account for the fact that basal states exhibit a range of behaviors around a baseline. such analyses might be best performed when the model is used in conjunction with experimental studies, such that development of firm  can be supported by joint simulations and experimentation.

this work exemplified an approach to constructing large-scale integrated simulators of complex dynamic structures such as the immune system. ours is a hybrid approach bringing together conventional differential equation-based models with methods developed in systems biology over the past decade. the implementation of this approach leads to a postulated representation of the immune system that incorporates the underlying cellular processes and cytokine regulation based on elements of mammalian physiology. the simulator provided by firm is well suited to go through an integrated and interactive model building process with experimental validation to reach an increasing state of completion, similar to what as has been accomplished for genome-scale models of metabolism  <cit> .

competing interests
th, ep, mz, kj, po, mes and pv are or were employees of pfizer.

authors’ contributions
sp, th, ep, mz, kj, po, mes, bop and pv designed the research; sp, th, ep, bop and pv performed the research and sp, th, ep, mz, kj, po, mes, bop and pv wrote the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
supplemental figures and tables. firm manuscript supplemental figures.

click here for file

 acknowledgments
initial discussions with kenneth luu on model development and the support of scott fountain are gratefully acknowledged. this work was partially presented at the american conference of pharmacometrics  held in san diego, ca, april 3– <dig>   <dig> and was published in the conference proceedings in abstract form.
