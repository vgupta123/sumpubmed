BACKGROUND
the cdna microarray is a widely used high-throughput technique for gene expression profiling, especially for organisms whose genome sequences are unavailable. however, in microarray experiments, there exist many non-random variations and systematic biases, which can confound the extraction of the true fluorescence intensity signals, and thus compromise downstream data analysis and interpretation of the experimental data. therefore, proper data normalization is required to remove these biases before accurate identification of differential gene expression  <cit> .

the main objective of normalization is to ensure that measured intensities within and across slides are comparable. based on different biological or statistical assumptions about data distribution or experimental design, various normalization methods have been proposed. the housekeeping gene method  <cit>  is an early normalization method, which assumes that the expression levels of housekeeping genes remain constant even when the expression of many other genes is substantially changed. however, many so-called housekeeping genes have been reported to exhibit considerable variability under different experimental conditions and different tissues  <cit> , making them unsuitable and unrepresentative of the whole expression intensity range. the global normalization approach  <cit>  assumes that the center  of the distribution of log ratio m values in each slide is zero. however, the global normalization method does not consider intensity-dependent and spatially-dependent effects, which are usually major biases among the slides. in order to remove such biases, yang et al.  <cit>  proposed one local regression smoothing procedure  that is applied to each slide separately to normalize the log ratio intensities. lowess normalization has been one of the most popular methods but it has two important assumptions. lowess assumes that most genes on the array are not differentially expressed across the experiments and also that the numbers of up- and down-regulated genes at each intensity level are roughly equal in each slide. other methods including the semiparametric  <cit> , neural network  <cit> , and common array dye-swap methods  <cit>  have been proposed to remove intensity-dependent biases.

these various methods can effectively remove the intensity-dependent or spatially-dependent biases within each slide. however, they do not account for the intensity-dependent differences across multiple slides, which can introduce undue weighting of some slides to an average of log-ratios across slides in the subsequent data analysis  <cit> . scale normalization  <cit>  is one popular approach for such across-slide normalization  <cit> , in which log ratio intensities are assumed to follow a normal distribution with expectation zero and homogeneity of variance across replicated arrays. other effective across-slide normalization methods include quantile  <cit>  and variance stabilization normalization   <cit> . quantile normalization was initially developed for the affymetrix single channel chip  <cit> , and then extended for two colour cdna microarrays in the limma package of the bioconductor project  <cit> . it relies on the assumption that the probe intensities for each array in a set of replicated arrays are approximately equally distributed. the goal therefore is to adjust for the difference in distribution among multiple slides, and data points are shifted such that the sample densities of slides are identical. in contrast, the vsn method assumes that most of the genes on the arrays are not differentially expressed in a given experiment and utilizes the arcsine rather than log transformation to stabilize the variance so as to remove the dependence of the variance on the total intensity. this gives genes with higher intensities an equal chance of being ranked high as genes with lower intensity. vsn has been used for both the affymetrix  <cit>  and cdna microarray platforms  <cit> .

while many different normalization methods are available and diverse strategies are implicated, most of them require certain critical biological or statistical assumptions about data distribution. for example, one usual assumption underlying the global, scale, lowess and vsn methods is that the array contains many non-differentially expressed genes. the assumption on data distribution inherent in these methods may not be valid in practice. for example, in custom-made boutique arrays most of genes are expected to be differentially expressed  <cit> . most of the above normalization methods are inappropriate. although some novel methods have been proposed for such boutique arrays, including the housekeeping gene  <cit> , zipf's law  <cit>  and the mixture model based methods  <cit> , they still have their own assumptions. the commonly used housekeeping gene method assumes that a set of prior housekeeping genes exists in the microarray in similar expression patterns, and could be utilized for lowess normalization. however, the hybridization signals from these proposed housekeeping genes may not span the entire fluorescence range produced by boutique arrays. zipf's law method  <cit>  assumes that the microarray data set exhibits an observed power-law distribution with an exponent close to - <dig>  whereas the mixture model based method  <cit>  assumes that the log ratio of intensity in each channel has a gamma distribution. although many available normalization methods are effective for removing some types of biases among arrays, their own assumptions about data distribution may limit their application, or even introduce new biases. there is a clear need for developing versatile and robust methods for normalization of microarray data.

here we present evidence to show that the generalized procrustes analysis  <cit> , or gpa, is a powerful statistical method for normalization of microarray data. the gpa method differs from other methodologies in that it has no assumptions about data distributions, which delineates its main advantage over the other methods. procrustes analysis is one of the least-squares methods for translation, rotation, scaling and aligning matrices of corresponding coordinates to maximize their agreement  <cit> . the transformation parameters are computed in a direct and efficient manner based on a selected set of corresponding point coordinates. microarray data are matrices of colour intensities. replicated slides are matrices of similar configurations and are therefore amenable to procrustes analysis. on the basis of publicly available and simulated data, our gpa-based normalization strategy is systemically compared with six other popular normalization methods including two within-slide methods , three across-slide methods , and one boutique array specific housekeeping gene method. the assessment of these methods is based on three empirical criteria: variability among replicated slides  <cit> , the kolmogorov-smirnov statistic  <cit>  and the mean square error  <cit> .

RESULTS
generalized procrustes analysis  in normalization of microarray data
gpa is a standard multivariate statistical method widely applied in shape analysis to find the optimal superimposition of two or multiple configurations  <cit> . the algorithm involves three transformations: translation, rotation and scaling. translation is a movement in which the centroid of each configuration is shifted to the common origin by subtracting centroid coordinate. rotation is a fixed displacement of all points by a constant angle, keeping the distance of each point from the centroid unchanged. scaling is a stretching or shrinking of all points by a constant amount in a straight line from the point to the centroid of the configuration. the optimal transformation is defined as one with the smallest sum of the squared distances among corresponding points in the configurations. in our study gpa method is used to minimize the deviation of signal intensities among microarray slides. a detailed geometric transformation of microarray m-a plots in gpa normalization is illustrated in figure  <dig> with one set of simulated microarray data. figure  <dig> shows the transformations for one slide and figure  <dig> shows the superimposition among multiple slides  after each gpa transformation procedure. two characters of gpa normalization are that it does not change the relative position of points  within each m-a plot and the transformations  are based on a global optimization instead of local optimization.

strategy for comparison of normalization methods
based on the different data sets, we compared our gpa-based method with six other normalization methods, including global  <cit> , lowess  <cit> , scale  <cit> , quantile  <cit> , vsn  <cit> , and the housekeeping gene method for boutique array  <cit> . the comparison includes three levels. we firstly evaluated the performance of these different normalization methods in removing biases individually, no matter what strategies are behind them. thereafter, we systematically compared several pairs of within-slide and across-slide normalization methods to  evaluate the potential of combinations of different methods in normalization procedures, and  assess the ability of decreasing across-slide bias of the gpa method compared to other across-slide normalization methods based on the same within-slide normalization background. this bears significance in practice since it is often necessary to combine different normalization strategies to decrease variation and potential bias within each slide and across slides. thirdly, for the boutique data in which common normalization methods are not suitable, we evaluated the gpa method with the housekeeping gene normalization method without other methods involved.

we first evaluated the performance of these normalization methods on two real microarray data sets through comparing data variability and similarity of data distribution among replicated slides. the rationale behind these two criteria is that an effective normalization method should result in lower replicate variability, and more similar  data distributions for replicated slides. then we applied two simulation methods to simulate several types of microarray data. mean square error  was used to evaluate different normalization methods through calculating the true difference between simulated data and normalized data. for the boutique array type, both real data and simulated data were utilized and subjected to these three empirical criteria. in addition, the differential effects of these normalization methods on m-a plots for both real data and simulated data are showed in additional files  <dig>   <dig> 

comparison based on the criterion of replicate variability
the criterion of replicate variability is based on the rationale that the expression level of a gene should ideally remain the same across multiple replicated slides. for n replicated slides, the variability of n values for each gene can therefore be used to compare normalization methods  <cit> . the standard deviation for gene g  can be estimated as

  σ⌢g=1n−1∑i=1n <dig> 

where n is the number of replicates in the data set, mgi∗ is the normalized log <dig> value for gene g in slide i, while m¯g. is the average log ratio intensity over the slides for gene g. a smaller σ^g is indicative of a more effective normalization procedure. the mean of such σ^g estimates over all genes is a global measure of the performance of the normalization methods, with smaller mean σ^g indicative of better performance of the normalization methods.

when we compare the across-slide normalization methods based on the same within-slide normalization background , we can see  different combinations of within- and across-slide normalization methods can further reduce the variability values , and  the gpa method can result in a greater decrease than scale and quantile do . it is particularly evident in the combination of lowess and gpa methods compared with other dual normalizations including global-scale, global-quantile, as well as lowess-scale, lowess-quantile pairs. it is also somewhat better than that of the vsn method  . in conclusion, our gpa method provides greater reduction of replicate error individually and in combination with other methods such as lowess.

comparison using the kolmogorov-smirnov  test
the kolmogorov-smirnov  test is a goodness-of-fit test of two continuous distributions. it is used as a criterion for assessing normalization methods and is based on the rationale that an effective normalization procedure should result in two similar  distributions with a small, ideally zero-valued, k-s statistic  <cit> . in contrast, two different distributions will generate a large k-s statistic.

comparison using the mean square error  criterion
we used a data simulation study to further test the gpa method. the advantage of using a simulated data set is that the true intensities are known, so we can assess the accuracy and precision of normalized data more systematically. mean square error  is a widely used comparison criterion, which can calculate the true difference between simulated and normalized data  <cit> . denote mji as the true expression log-ratio for the j-th gene of i-th replicate, m^ji as the estimated value for mji, and m¯j. as the mean of m^ji in n replicates. mse for the j-th gene is defined as

  msej=1n∑i=1n2=1n∑i=1n2+1n∑i=1n2=var+bias <dig> 

note that mse is decomposed into variance and squared bias. the variance component  is an index of precision and the bias component  is an index of accuracy. obtaining data with satisfactory precision and accuracy has been one of the biggest challenges in the application of microarrays. for this reason, mse is an excellent criterion for evaluating alternative normalization methods  <cit> , with smaller ν and β values indicating better normalization.

two different methods to simulate microarray data were used: one is a parameterized random signal model from the study of  <cit> , which is flexible and has been widely utilized; the other is recently published simage method  <cit> , which simulates microarray data based on the estimated parameters from real microarray data. based on the first method, two types of data are simulated, one without dye bias and one with the banana-shaped dye bias. four different levels  of differentially expressed genes are considered. the ratio of the up-regulated genes to the down-regulated genes is 1: <dig>  the mse values for the data set with 5% differential genes following different normalization methods are shown in table  <dig>  in both cases, the median of variance  is several times lower with the gpa normalization individually than with the other normalization methods. the median of bias  with gpa normalization is also significantly lower than with the other methods . this trend is observed for other data sets with  <dig>   <dig>  30% differentially expressed genes . based on the simage method, three sets of microarray data are simulated with  <dig>   <dig>   <dig> % differential expressed genes . as shown in table  <dig>  our gpa method produced the lowest ν and β values compared with all other methods in three data sets . these results indicate that the gpa method performs effectively and consistently better in reducing across-slide variability and removing systematic bias.

 ν and β : the median of variance and bias, respectively, of mse.

 percentage of differentially expressed genes

 ν and β: the median of variance and bias, respectively, of mse

since the accuracy and efficiency of across-normalization method may depend on the number of replicate slides, we also conducted a series of simulation studies to verify the effect of number of replicate slides on the performance of the gpa method compared with other methods. in practice, four slides are commonly considered as the minimum number for one reliable cdna array experiment. for this reason we have simulated microarray data from four to eight replicates. we found that, with replicate slides from  <dig> to  <dig>  the gpa method yields lower mse  than other methods. in general, gpa has the best and most consistent performance in decreasing variance and bias across slides . given these results, we recommend using the gpa method with within-slide normalization methods such as lowess whenever feasible, especially when the number of replicate slides is smaller than four.

application of the gpa method for boutique arrays
being relatively assumption-free, the gpa method may be particularly useful in analyzing boutique arrays where the majority of genes may be differentially expressed. here we show that the gpa method is superior to the popular housekeeping gene normalization approach. we used one real apoptosis microarray data set to evaluate these two methods. the hypothesis behind this type of microarray data is that the expression of most genes changed significantly, so most normalization methods are not appropriate. table  <dig> shows that our gpa normalization can yield lower replicate variability and more similar data distribution  compared to housekeeping gene normalization. this is further supported in the simulated boutique arrays with two simulation methods . the simulation data sets used here are an extreme example for boutique arrays. approximately  <dig> percent of the genes are differentially expressed and three different values  are applied for the ratio of up-regulated to down-regulated genes. the medians of ν and β are smaller with gpa normalization than with the housekeeping gene normalization for diverse cases. these results demonstrate that the gpa method performs better, with consistently smaller ν and β values, than the housekeeping gene method.

 ratio of up- to down-regulated genes

 ν and β : the median of variance and bias, respectively, of mse

 ratio of up-regulated to down-regulated genes

 ν and β: the median of variance and bias, respectively, of mse

in order to further test the ability of gpa on boutique arrays and illustrate its advantage of being assumption-free, we simulate another extreme example of boutique arrays with 90% up-regulated genes at  <dig> fold and 10% down-regulated genes at  <dig> fold. in this case, the housekeeping gene normalization method cannot work since there are no assumed prior housekeeping genes in the experiment, whereas the gpa method can solve this problem. figure  <dig> shows a geometric transformation of such extreme boutique arrays after gpa normalization procedures.

discussion
we demonstrate the potential of a gpa-based method for normalizing microarray data. data normalization is an essential step for the spotted cdna array and exerts important effects on the subsequent data analysis leading to identification of differentially expressed genes, and clustering and pathway analyses. many normalization methods have been proposed, however, almost all the available normalization methods are based on biological or statistical assumptions about data distribution which are often not valid in practice. for example, the usual assumption that the array contains a large enough assortment of random genes, most of which are not differentially expressed across the experiments, is inherent in many existing methods including the global, scale, lowess and vsn methods considered here. the assumption is particularly problematic for custom-made boutique arrays where most genes are expected to be differentially expressed, or are directly implicated in the biological process being studied. although some novel methods have been proposed for such boutique arrays, including the housekeeping gene method  <cit> , zipf's law method  <cit>  and the mixture model based method  <cit> , these too have their own assumptions about data distribution and suffer from similar problems. therefore normalization methods without such assumptions must be developed. we were motivated to address this question largely because we have developed a custom cdna array  <cit> . with gpa normalization, there is no need to assume that expression data follow any particular distribution, for example, that the distributions of up- and down-regulated genes are symmetric.

procrustes analysis is a powerful least-squares approach by translating, rotating and isotropic scaling to achieve a better fit among matrices of similar configurations. it has been widely applied in many fields such as statistical analysis of shapes  <cit> , analytical chemistry  <cit> , photogrammetry  <cit>  and protein structural alignment  <cit> . its strength in dealing with similarity among shapes or configurations led us to consider its potential for microarray data normalization analysis in balancing signal intensity level across different slides. the gpa method only requires replicate slides in the experiment, but conducting replicate experiments is a very popular experimental design since it can greatly ascertain experimental errors and reduce noise bias in the measurement and greatly help us to analyze the variability across slides.

we utilized both the real and simulated data to compare the gpa-based approach with six other normalization methods: global, lowess, scale, quantile, vsn, and one boutique array specific housekeeping gene method. for both real data sets, the gpa method showed a relatively better performance in decreasing replicate variability and increasing similarity of data distribution than other methods. global and scale methods performed worse in both criteria. both vsn and quantile performed best only in one case of variance or k-s statistic because their assumptions specifically favour one of them. although the lowess method can decrease variability, it showed no advantage in decreasing discrepancy of data distribution. a better performance of gpa than other across-slide based methods can still be observed on the same within-slide normalization background. the lowess-gpa pair performed better than other dual normalizations, implying a better combination potential. furthermore, we utilized two different parameter models to simulate several types of microarray data, which were used to accurately evaluate normalization effects through assessing true difference between known true data and normalized data. the results indicate that our gpa method outperformed other methods in reducing across-slide variability and removing systematic bias in microarray data. overall the gpa normalization can effectively decrease the replicate variability, discrepancy of data distribution among slides and retrieve underlying biological information. it not only can be used individually to balance the bias across slides, but also in practice can be combined with other methods such as lowess to produce better results. moreover, the combination of gpa with lowess can reduce discrepancies in data distribution as a result of lowess. this is logical because lowess and gpa have different within-slide based and across-slide based strategies. furthermore, the application of gpa normalization in analyzing the boutique array was demonstrated in both the real and simulated boutique arrays. the gpa method not only performs consistently better than the popular boutique array-specific housekeeping gene normalization method, but can also be used where other methods are inapplicable.

CONCLUSIONS
we have shown that gpa is a promising normalization method for microarray data analysis. in particular, gpa method is free of assumptions about data distribution inherent in other existing approaches. this makes gpa versatile and robust for diverse types of array sets, especially for custom-made boutique arrays where the majority of genes may be differentially expressed.

