BACKGROUND
whether species or clades retain or shift their environmental niche space over time is a key question relevant to our understanding of speciation and large-scale patterns of diversification . at the species level, the ability of populations to colonize and spread into new  niches supports a role for ecological speciation in which divergent natural selection on ecologically important traits promotes population isolation through adaptation to new environments . by contrast, niche conservatism is the inability of populations to adapt to new environmental conditions and but nonetheless may facilitate allopatric speciation by maintaining ancestral niches and niche-related traits over time  <cit> . moreover, at the phylogenetic level, geographical patterns of niche shifts versus niche conservatism can offer insights into the environmental processes fuelling lineage diversification and may also provide important information on the range dynamics of species and ecosystems over geological time . however, few phylogenetic-dating studies have explicitly addressed this latter issue in tropical biota, and those that did, mainly focussed on animals .

madagascar is one of the world’s richest biodiversity hotspots  <cit> , with about  <dig>  % and  <dig>  % of the estimated global total for number of species of vascular plants and vertebrates, respectively  <cit> . this rich tropical species diversity is commonly attributed to the island’s long-term geological isolation from africa  and india , a high geological and topographical complexity, and regionally pronounced and locally steep environmental  gradients . originally, the forest ecosystems and climates of madagascar, like elsewhere in the tropics, were believed to have been relatively stable through most of their cenozoic history, thus allowing the built-up of high species diversity . however, madagascar’s pollen and vertebrate subfossil record is scarce , which makes it difficult to formulate a priori hypotheses about the impact of past vegetation-climate changes on the niche evolution of local biota. nonetheless, in agreement with the few palaeo-data available , there is growing evidence from phylogeographical studies of forest-dwelling plants and animals  that dramatic vegetational shifts took place in madagascar during the climatic fluctuations of the quaternary . furthermore, using palaeoclimatic modelling, rakotoarinivo et al.  <cit>  have shown that quaternary changes in vegetation-precipitation relationships in madagascar exerted a strong influence on plant species richness, as exemplified by palms  of the island’s eastern rainforest biomes. it is feasible, therefore, that madagascan forest ecosystems underwent repeated range expansion/contraction cycles due to quaternary palaeoclimatic change, which in turn promoted phylogenetic niche shifts along steep environmental gradients . an alternative, mutually non-exclusive hypothesis is that niche conservatism had likewise a role in facilitating speciation and lineage divergence through the maintenance of long-term allopatry in proposed glacial refuge locations  <cit> , notably habitat isolation caused by aridification of low-elevation/montane river catchments  <cit> .

molecular phylogenetic tools are increasingly used to examine patterns and processes of diversification in plant and animal groups from madagascar . however, to our knowledge, no study to date has specifically examined niche evolution within a madagascan clade using phylogenetic reconstruction and ecological modelling as integrative tools of the emergent field of ‘phyloclimatic analysis’ . for example, if niche shifts play an important role in phylogenetic history, we would expect that species niches have non-overlapping geographical distributions and are phylogenetically over-dispersed ; conversely, under phylogenetic niche conservatism, species sharing the same niche will be phylogenetically clustered  <cit> . another prediction of the niche shift hypothesis is that the distribution of niche variables across a phylogenetic tree is not significantly different from a random distribution, while under niche conservatism one would expect a strong tendency of related species to resemble each other in such variables more than if taken at random from the tree  <cit> .

here, we adopted a phyloclimatic analysis approach to determine broad-scale patterns of niche evolution during the diversification of a well-defined clade of the pantropic genus bulbophyllumthouars  from madagascar and adjacent islands. with about  <dig> to  <dig> described species, bulbophyllum is one of the largest genera within the orchid family, and has a major center of diversity in madagascar , where species mainly occur as epiphytes in a wide range of rainforest habitats . based on molecular phylogenetic evidence , madagascan bulbophyllum forms a monophyletic group of late miocene age  with two major lineages: a species-rich core clade  mainly distributed in eastern rainforest of mid-to-high elevation , and a species-poor clade  that is eco-geographically more varied . that said, new species of bulbophyllum continue to be discovered in madagascar and the mascarenes  but are rare and threatened with extinction, as typical for other rainforest taxa of these islands .fig.  <dig> members of madagascan bulbophyllum clade c in their different forest habitats.  b. complanatum from the seasonally dry region of northwest madagascar,  b. elliotii from the humid rainforest of the eastern coast,  b. occultum from the mid-to-high elevation humid rainforest of the eastern slopes. photos by g. a. fischer



in this study, we used a time-calibrated species-level phylogeny of madagascan bulbophyllum ‘clade c’ , previously constructed from plastid and nuclear markers  <cit> , as a framework to examine patterns and processes of niche evolution during the clade’s plio-/pleistocene diversification . in general, we used a broad-scale, macroecological perspective at the clade-level rather than looking at the niche space of individual species, as the majority of bulbophyllum species have small to very small ranges, so that sample sizes would be too low to implement such an approach for most species . accordingly, based on georeferenced occurrence data and bioclimatic/elevation variables of the entire clade, we first identified and characterized the major partitions of the dataset in terms of their  realized niche space   <cit>  and predicted niche occupancy  profiles  <cit> . second, we traced transitions between these realized niches across the tree and used a bayesian modelling framework to test for a general trend in the direction of niche change through time. finally, we assessed the extent of phylogenetic signal in variables of the clade’s niches. together, our results reveal that niche transitions occurred frequently and asymmetrically within this madagascan orchid clade, and in particular over quaternary time scales. this supports the emerging idea that climate-induced vegetational shifts in the recent geological past gave rise to current eco-geographical patterns of biota in this tropical biodiversity hotspot.

methods
study system and phylogenetic framework
taxonomically, madagascan bulbophyllum ‘clade c’ comprises members of sects. bifalcula, humblotiorchis, and calamaria with altogether  <dig> recognized species . these leaf-succulent epiphytes  are mainly restricted to northwest/east madagascar  and/or adjacent islands , with two found in madagascar and/or east africa . preferential habitats range from seasonally dry to coastal/littoral and humid evergreen forests at various altitudes  . as typical for bulbophyllum, most clade c species are adapted to insect  mediated outcrossing , excepting eight species  that are polymorphic for both outcrossing and selfing variants  <cit> . this intra-specific mating type polymorphism, however, is not correlated with the macroecological niche states and their contributing variables reported herein , and thus will not be considered further.table  <dig> niche-cluster membership of  <dig> data point localities itemized per species of bulbophyllum clade c , and outgroups, used as tip-states for the reconstruction of ancestral niche states a, b, and c . note, two clade c species are not included in the present study 


bifalcula
 
 
b. complanatum
 
 
 
b. sp. nov. a
 
b. sp. nov. b

calamaria
 
b. bicoloratum
 
 
 
b. erectum
 
 
 
 
 
 
 
b. obtusatum
 
b. occultum
 
 
b. pusillum
 
b. quadrifarium
 
 
 
 
b. sp. nov. c
 
b. sp. nov. d
 
b. sp. nov. e1
 
b. sp. nov. e2
 

humblotiorchis
 
b. humblotii

alcistachys
 

inversiflorum
 

kainochilus
 

aclade c species polymorphic for  mating type  <cit> 



the present study capitalizes on a nearly complete molecular phylogeny of clade c  as previously reconstructed from an eight-gene dataset of five plastid and three nuclear markers  <cit> . phylogenetic analyses, using maximum parsimony   and bayesian inference  , were conducted on the combined plastid/nuclear dataset . bayesian posterior probability  and parsimony bootstrap percentage  were used as estimates of strong clade support. the trees retrieved identified sects. bifalcula  and humblotiorchis  as successive sister taxa to sect. calamaria . an estimate of absolute age for each node was obtained from a relaxed molecular clock analysis in beast v.  <dig> . <dig>  <cit>  using multiple fossils and geological events for calibration . the resulting maximum clade credibility  chronogram is used here to represent the clade c phylogeny and to trace the history of niche shifts across this phylogeny .

identification and characterization of macroecological niches
the fundamental niche space of species or higher taxa can be separated into variables of biotic interactions and resource-consumer dynamics  or into variables of broad-scale environmental conditions   <cit> . the interplay between ‘eltonian’ processes , ‘grinnellian’ factors  and others , defines the realized niche  <cit> . for the purpose of this study we rely on a reasonable approximation of the realized niche based on climatic and elevation variables of a comprehensive locality dataset for all  <dig> clade c species   <cit> . this database was assembled from two main sources:  own field data gathered during expeditions in madagascar  and la réunion ; and  voucher specimen data  obtained from herbaria . specimen localities without coordinates were geotagged using an internal gazetteer of kew royal botanic gardens, topographical maps of madagascar , and googleearth™. we discarded duplicate presence records per species as well as implausible locality data . in total, the final dataset comprised  <dig> georeferenced point localities , with the number per species ranging from  <dig> to  <dig> .

for each locality in the database, we extracted altitude and  <dig> bioclimatic  data layers for current conditions  at  <dig> arc-seconds resolution from the worldclim database v.  <dig>  , using the r-package raster v.  <dig> - <dig>  <cit> . to investigate how these  <dig> data points group in multi-dimensional environmental space into a specific number of different clusters, we used fuzzy c-means  clustering . compared to conventional  clustering methods, fcm clustering has the advantage that it allows gradual memberships to clusters measured as degrees   <cit> . this ‘degree of belonging ’ is defined by a membership coefficient , which quantifies a data point’s membership to all the given clusters. fcm clustering is usually regarded more ‘natural’ than ‘hard’ clustering, especially when based on continuous  variables as used here  <cit> .

the  <dig> data points were fuzzy clustered on the basis of their euclidian distances calculated from the environmental variables  using the vegdist function of the r package vegan v.  <dig> - <dig>  <cit> . the resultant distance matrix was multi-dimensionally scaled using the cmdscale command in r . we employed seven different fuzzy validity indices  to determine the number of clusters existing in the dataset using the functions cmeans and fclustindex of the r package e <dig> v.  <dig>   <cit> . the number of clusters  was set to vary from  <dig> to  <dig>  each combined with a fuzziness scheme at ten steps , resulting in a total of  <dig> combinations. each cmeans run converged before the maximum of  <dig> iterations was reached. overall, this fcm analysis identified three clusters  to which samples were assigned according to their maximum m value .

we compared the environmental space between the three fcm clusters using principal component analysis  in r . the pca was performed on the matrix of variables  and the component scores of each data point were projected in two dimensions. for each cluster pair, we assessed significance between the first two components  using mann–whitney u tests. this non-parametric approach was used because pc <dig> did not fulfil the parametric assumption of normal distribution based on kolmogorov-smirnov tests .

enms were built independently for each fcm cluster using maxent v.  <dig> .3e  <cit> , a maximum entropy method frequently employed for species distribution modelling  . based on the locality data assigned to each cluster, enms were developed using the  <dig> bioclim data layers plus altitude  to visualize the geographic space and overlap of these clusters, and to compare their ranges with known phytogeographical zones in madagascar. for each cluster, model performance was assessed using  <dig> bootstrap replicates . the area under the ‘receiver operating characteristic  curve’  was averaged across replicates to determine if models should be removed . maxent outputs of continuous probabilities for habitat suitability were converted to presence/absence predictions using a logistic threshold maximizing the absolute value of training sensitivity plus specificity .

using the approach of evans et al.  <cit> , we further characterized each fcm cluster by predicted niche occupancy  profiles for particular environmental variables using the r package phyloclim v.  <dig> . <dig>  <cit> . as input, this program uses maxent raw data  for creating ‘unit area histograms of suitability’, which illustrate the predicted occupancy of an environmental variable by a given set of locality data . as predictive variables we selected six that received relatively high loadings in the pca .

ancestral niche reconstructions and testing alternative models of niche transition
we used the submodule multistate of bayestraits v.  <dig>   to reconstruct ancestral niche states under a continuous-time markov model of discrete character evolution. for each clade c  species, we coded niche state according to the majority of localities per species falling within a certain fcm cluster , and as’polymorphic‘if at least one third of those localities fell into a different niche . probabilities of transitions were calculated together with the probabilities of niche states for all internal nodes of the last  <dig> post-burn-in trees from the bi analysis of clade c , which thus accounts for uncertainty in the phylogeny’s branch lengths and topology. the markov chain monte carlo  analyses were run for  <dig> , <dig> generations, with a ratedev parameter of  <dig> , a reversible-jump hyperprior with an exponential prior , and a burn-in of  <dig>  generations. the reconstructed ancestral niche states were plotted onto the beast-derived  chronogram of clade c. phylogenetic niche shifts were quantified by comparing the most probable states between ancestral and descendant nodes  <cit> .

we used a modelling framework within bayestraits to estimate niche transition rates  and to detect any general trend in the direction of niche change . specifically, we compared a full  model that allowed transitions to vary freely to  each of six models with zero uni-directional transitions in all pairwise combinations of states ; and  one model with zero bi-directional transitions from c . note, this latter model was guided by our ancestral niche reconstructions . we used tracer v.  <dig>   <cit>  to compute the marginal likelihoods of the full and constrained models. for model comparison, we used the bayes factor  ‘test statistic’ of  <dig> log – log . evidence against the constrained model  was considered to be ‘positive’ , ‘strong’ , or ‘very strong’ .table  <dig> results of testing alternative models of niche transition in bayestraits using logarithmic bayes factor  comparisons

q
ab
q
ac
q
ba
q
bc
q
ca
q
cb

q

q

q

q

q

q

q


phylogenetic signal in environmental variables
to provide a complementary perspective on the clade’s niche evolution, we used blomberg’s k  <cit>  to test for correlations between environmental variables and phylogenetic relatedness. in general, this test statistic is used to assess phylogenetic signal by asking whether a given phylogeny  better fits a set of quantitative tip data than expected for data randomly permuted across the tips of the tree  <cit> . values of k range from zero to infinity, where k <  <dig> indicates weak phylogenetic signal, and k >  <dig> strong signal, implying that close relatives are, respectively, more or less divergent for traits than expected under a brownian model . first, based on the locality data, we calculated the centroid value of each principal component  per fcm cluster, and also the median values of environmental variables  for each clade c species. those ‘trait’ values were then used as input data of the r package picante v.  <dig> - <dig>  <cit>  for calculating values of k for each trait over  <dig> trees from the bi analysis . significance of k was assessed by comparing observed patterns of the variance of independent contrasts of the trait to a null model by shuffling taxa across the tips of the phylogeny .

RESULTS
macroecological niche identification and characterization
our results of the fcm cluster analysis offered more than one optimal solution for partitioning the  <dig> occurrence data of madagascan bulbophyllum clade c  in environmental space . in detail, of the seven validity measures employed, two  suggested clustering of the samples into three groups , while two others  favoured k =  <dig> with m =  <dig> . by contrast, the remaining indices suggested k =  <dig>   <dig>  or  <dig> as best partitions . however, we favoured k =  <dig>  as suggested by the majority of validity indices  when considering their next to optimal values . accordingly, the  <dig> locality data were assigned to three clusters depending on the maximum m value per sample .

figure 2a shows the two-dimensional pca plot of the  <dig> samples as assigned to their respective fcm clusters . samples of clusters c and b mainly differed along the first component , which was positively correlated mainly with altitude, measures of temperature , and precipitation  . by contrast, samples of a and b were largely separated along pc <dig> , which was mainly positively correlated with temperature seasonality  but negatively with both precipitation seasonality  and isothermality ; . as a consequence, clusters a and c differed along both pc axes. however, all pairwise comparisons between clusters revealed significant differences for each of the two axes tested .fig.  <dig> macroecological clusters viz. niches  of bulbophyllum clade c from madagascar and adjacent islands . a principal component analysis  biplot of  <dig> occurrence data  of clade c species  based on  <dig> bioclimatic variables  and altitude . each data point is coloured according to its hard cluster membership as defined by fuzzy c-means  clustering. coloured crosses indicate centroids. . b binary ecological niche models  for clusters a, b, and c using a maximum training sensitivity plus specificity logistic threshold. c range overlap between the enms of clusters  based on the same threshold



spatial-climatic niche characterisation
the enms generated for clusters a, b, and c had high auc values , indicating good predictive performance. based on these models, the predicted distributions of these clusters in madagascar  are largely parapatric with little spatial overlap . considering further the pno profiles of each cluster for selected environmental variables , as well as phytogeographic provinces in madagascar , the predicted distributions of clusters a, b, and c  can be characterized as follows. niche a occupies the seasonally dry region of northwest madagascar at low-to-mid elevations  , and is characterized mainly by constantly high temperatures, coupled with low annual precipitation that markedly varies across seasons . phytogeographically, niche a largely coincides with the ‘sambirano’ rainforest domain  <cit> , which receives heavy seasonal rainfall due to the influence of both easterly trade winds and indian monsoon currents, but also extends into the western seasonally dry forest at about the same elevation . by contrast, niche b coincides with the ‘eastern lowlands’  of coastal  forest, intersected by marshland, and humid rainforest at low-to-mid elevation . when compared to niches a and c, niche b is intermediate in both annual temperature and temperature seasonality; however, it receives the highest annual precipitation, which is continually supplied throughout the year . finally, niche c largely coincides with the eastern slopes and plateau of the ‘central highlands’   characterized by, respectively, mid-to-high elevation humid rainforest and sclerophyllous forest/mountain  scrubland  <cit> . in terms of annual temperature regime, niche c is the coldest and most variable one; it receives similar levels of annual precipitation as niche a but at a more constant rate throughout the year .fig.  <dig> predicted niche occupancy  profiles of niche clusters a, b, and c of madagascan bulbophyllum clade c : for  altitude,  temperature seasonality ,  annual mean temperature ,  precipitation seasonality ,  annual precipitation , and  isothermality 



ancestral niche reconstructions and patterns of niche transition
the bayesian mcmc reconstruction of ancestral niche states  along the chronogram of clade c  placed its crown node  in either a or b with near equal probabilities. this analysis further revealed frequent niche transitions within this clade, especially in more recent geological times. if we consider only transitions associated with well-supported sister species or subclades , then niche shifts may have occurred up to  <dig> times independently, and all but one of those fall into the quaternary . altogether  <dig> transitions appear on internal nodes, including eight from a to b or vice versa, but only one each from a and b to c, and one from c to b. the  <dig> remaining transitions are located on terminal tip branches , including six , three from a to b or vice versa, and only one from c to b. clearly, these inferences about the number of independent transitions and reversals have to be treated with some caution because ancestral states at several nodes appeared equivocal . nonetheless, these results qualitatively suggest frequent niche transitions between a and b and almost irreversible transitions from mainly b to c.fig.  <dig> niche shifts of madagascan bulbophyllum clade c. bayestraits mcmc reconstruction of ancestral niche states  plotted onto a beast-derived chronogram of madagascan bulbophyllum clade c with branch lengths proportional to time . boxes at tips correspond to the character state coding , while pie charts at nodes represent probabilities for ancestral states. niche shifts and their directionality are indicated at internal branches or next to taxon names if associated with tip branches. stippled lines indicate phylogenetic posterior probability  support below  <dig> . horizontal bars indicate 95 % highest posterior density  for node ages



estimates of transition rates in bayestraits  confirmed this partly asymmetrical niche change within clade c. according to the unconstrained  model, transitions were most probable between niches a and b, followed by those from either b to c or from a to c, whereas reversals from c were rendered highly unlikely . note that this analysis assigned high probability to a to c transitions, despite being observed only two times along the phylogeny . when we compared the fit of the full model against each of the seven models with asymmetrical transitions , there was ‘positive’ to ‘strong’ evidence against all four models with zero  transitions from a or b . however, none of the remaining models, constraining either uni- or bi-directional transitions from c, provided a worse fit than the full model  .fig.  <dig> transition probabilities between niche states . the size of the arrows is proportional to the pairwise transition rates  estimated by bayestraits, whereas the dashed lines indicate transition rates not significantly different from zero 



phylogenetic signal
we found no phylogenetic signal of blomberg’s k for the two principal components  and their constituent variables  . moreover, for pc <dig> and all variables, the observed distribution of values across the tips of the phylogeny was not significantly different from a random distribution in most of the  <dig> bi trees analyzed . by contrast, for pc <dig>  the percentage of trees rejecting the null hypothesis of a random signal was relatively high , indicating an even lesser amount of phylogenetic clustering than would be expected by chance .table  <dig> tests for phylogenetic signal of blomberg’s k for the centroid values of principal environmental components  per cluster , and the median values of contributing variables  per species, over  <dig> bayesian trees of bulbophyllum clade c 


apercentages of trees not rejecting the null hypothesis of random signal for given variable



discussion
although tropical environments comprise numerous biodiversity hotspots  <cit> , it is precisely in such environments where least is known about the patterns and processes that drive lineage diversification and niche evolution . this is the first study to integrate time-calibrated phylogeny, ancestral niche reconstructions, and hypothesis testing of niche transitions to explore the relative importance of niche conservatism versus niche divergence in the evolutionary history of a plant lineage from the tropical biodiversity hotspot of madagascar. based on the evidence from bulbophyllum orchids, our results reveal an exceptionally high number of broad-scale macroecological niche shifts during the plio-pleistocene diversification of ‘clade c’  in general, and over quaternary time scales, in particular. furthermore, this pattern is accentuated by partly asymmetrical niche transitions with little evidence for reversals from highland to lowland areas. although there are limitations to the methods used , our broad-scale patterns and estimates provide novel insights that can be used for more explicit hypothesis testing to understand historical and ecological factors driving plant diversification in madagascar.

niche differentiation and lability within madagascan bulbophyllum clade c
although all clade c species occur in tropical forest biomes, our fcm clustering in conjunction with the pca  and our enm results  revealed the presence of three macroecological niches , with ‘parapatric’ but de facto non-overlapping ranges  thereby largely coinciding with major provinces for the phytogeography of madagascar . interestingly,  <dig> of the  <dig> species included in this study can be assigned unequivocally to one of these three niches , suggesting that  niche conservatism prevails at the intra-specific level. conversely, those species featuring multiple niche states  should be ideal candidates for fine-scale studies of incipient ecological speciation.

our ancestral state reconstructions  revealed significant evolutionary lability of niches  within clade c. nonetheless, in several cases, niche conservatism has possibly been important in facilitating species divergence through the maintenance of long-term allopatry . however, across the entire clade, bioclimatic niche conservatism outweighs respective niche shifts by a ratio of only 2: <dig>  which is considerably lower than the ratio previously reported  for vascular plants at a global scale  <cit> . in fact, the total number of  <dig> transitions inferred for clade c is exceptionally high when compared to other, similar-sized plant lineages that have been identified as undergoing bioclimatic niche shifts over late tertiary/quaternary time scales. as for two examples, six biome shifts were reconstructed within a clade of african coccinia  <cit> , and just only two within a clade of south american leucocoryne  <cit> . clearly, these inferences about the number of independent transitions and reversals in bulbophyllum clade c have to be treated with some caution due to the ambiguity in ancestral character reconstruction. in general, this difficulty to estimate ancestral states with confidence can have many different causes . in the present case, we suspect this uncertainty is most likely caused by the high rates of transition among niche states , as also inferred from the results of our bayestraits analyses . however, the statistical nature of this inference needs to be explored in more detail using simulations.

in view of the high number of niche shifts within madagascan bulbophyllum clade c, it is not unexpected that we found no phylogenetic signal of blomberg’s k for principal environmental components  and all their contributing variables . such lack of phylogenetic signal in ecological traits is generally interpreted as being indicative of high rates of niche evolution  among closely related species that rapidly diversified to fill new and/or empty niches  <cit> . this also accords with altogether ten niche transitions associated with tip branches of the clade c phylogeny , suggesting that niche shifts had a significant role in recent species diversification .

but what factors then could have promoted these frequent niche transitions? one possible explanation is that these tropical orchids possess a suite of characteristics that make them better suited for such transitions than other plant groups. for instance, bulbophyllum species, like other orchids, possess dust-like and wind dispersed seeds . this high dispersal ability may facilitate both habitat selection and stabilizing selection on phenotypic  traits  <cit> . additionally, bulbophyllum produces pseudobulbs with water-storage tissue, which indicates tolerance to drought stress  <cit> . notably, too, this genus is highly variable in photosynthetic assimilation pathways, with species exhibiting c <dig>  cam , and/or c3-cam intermediate pathways . although little is known about this physiological variation in madagascan bulbophyllum , cam is generally believed to assist species in occupying a wider range of habitats, including both semiarid and  tropical environments  <cit> . together, these general characteristics may help explain the evolutionary versatility of clade c species to exploit new environmental niches and adapt to novel selective regimes . although the species-specific  traits involved remain unknown, they likely interacted in a complex way with both ecological  as well as historical  factors to generate the remarkable pattern of niche shifts exhibited by this group .

directionality of niche transitions
given the high number of niche shifts and the lack of a phylogenetic signal for environmental variables within bulbophyllum clade c, one may conjecture that niches varied at random along the phylogeny  <cit> . this, however, was not observed as we detected several trends in the direction, frequency, and timing of particular niche shifts in this orchid group. both ancestral niche reconstructions  and bayestraits analyses  concurred in that niche shifts within clade c mainly took place from niche a to b, and in the opposite direction, with either niche or, as observed, predominantly b acting as ancestral source for transitions into c. remarkably, however, reversals back from the dryer and colder high-elevation niche c to the warmer lowlands  were hardly observed , and also deemed improbable by the hypothesis testing framework .

the pca results  offer some tentative explanation for the above transition patterns in suggesting differential constraints along the major environmental trajectories  linking the three niches. accordingly, shifts between the lowland niches a and b would need to overcome constraints only along pc <dig>  which may have required adaptive responses to differences in seasonality  and isothermality. by contrast, shifts from b to c mainly proceed along pc <dig>  implying adaptations to overall temperature regime, precipitation, as well as higher elevation. finally, shifts between a and c would require adaptations along both trajectories , and likely therefore are the most severely constrained. in fact, transitions from a to c are rarely observed across the phylogeny , despite being rendered highly probable by bayestraits .

however, apart from these different ecological constraints, historical factors may have had a role in shaping the direction and frequency of niche transitions. for instance, madagascan pollen fossil records, even though scarce, suggest that the primary forest vegetation of the ‘central highlands’ was more widespread at lower elevation during the colder  periods of the late quaternary, while receding towards the upper slopes of mountains during warmer inter-/postglacials . more recently, this ‘quaternary vegetational shift’ hypothesis has gained support from population genetic studies of forest-dependent rodent species from northern madagascar  <cit> . for bulbophyllum, there is likewise preliminary evidence from species-specific enms for the last glacial maximum  that suitable habitat of high-elevation forest-dwellers  expanded downwards at that time . it is feasible, therefore, that during the quaternary climate-induced vegetational shifts  promoted niche shifts in bulbophyllum not only between lowlands  but also from lowland  to highland  areas. in addition, our results show that 90 % of all speciation events within clade c  fall into the quaternary, and when associated with niche shifts, they mostly occur from b to c . this trend in the timing and frequency of low-to-highland transitions further supports the hypothesis that quaternary vegetational shifts had an influential role not only in promoting niche shifts per se but also in driving ecological speciation in madagascan bulbophyllum.

an outstanding question is why reversals back to lowland niches, i.e., from c to a or b, were hardly observed  and modelled with zero probability . given the high frequency of b to c transitions, and lesser abiotic  constraints along this trajectory relative to those from a to c , one would have expected c to b reversals to occur at least to some extent. of course, this asymmetry might simply reflect insufficient time elapsed for relevant physiological traits to evolve in response to warmer and wetter lowland  conditions. on the other hand, we may exclude the possibility that reversals are limited by higher extinction rates in niche c, because the time-calibrated phylogeny of the entire clade  best fits a constant-rates model of diversification without extinction  <cit> . in other words, niche c is probably not a mere biogeographical ‘sink’ where extinction exceeds colonization. however, with recourse to the ‘quaternary vegetational shift’ hypothesis, a viable historical scenario is that, associated with inter-/postglacial change to a warmer climate, the upward retreat of the lower limits of the central highland forest vegetation severed habitat connections to the eastern lowland forest  <cit> . in the case of bulbophyllum, this hypothesis implies that, in addition to climate and topography, historical factors likewise imposed constraints on niche shifts from c to b. however, it is also possible that any asymmetry in niche shifts in this plant group from highland to lowland forests may have more to do with biotic interactions  than it does with physiological adaptation to lowland climates and/or the fragmentation of past migration routes .

clearly, a full understanding why clade c species exhibit frequent yet irreversible transitions to higher elevation habitats  over geologically recent  time scales would require fine-scaled analyses. this, for instance, may involve sister-species or species populations distributed on either side of the b–c niche boundary , and including genetic, phenotypic, ecological, and distributional  data for present and past  climate conditions to test for asymmetric migration and dispersal rates. it also needs to be explored in more ecological detail which biotic factors may have a major role in disconnecting the fundamental and realized niches of these tropical orchids, especially due to the role of competitors and/or pollinators. nevertheless, the present results concur with phylogenetic reconstructions in other plant and animal taxa from tropical and extra-tropical regions, showing a general trend of niche transitions from lower to higher elevation habitats , whereas well-supported cases of reverse shifts seem to be rare . whether this reflects actual patterns or bias in data collection remains unclear, and is worth addressing in greater depth .

CONCLUSIONS
on this broad macroecological scale, our findings highlight an unusually high incidence of niche transitions in an epiphytic orchid lineage from madagascar, which seems to overturn the long-held paradigm of long-term stability in tropical forest ecosystems ; but see . over the entire plio-/pleistocene history of bulbophyllum clade c, the highest transitions rates were between the two lowland rainforest niches, northwest ‘sambirano’  and ‘eastern lowlands’ , and into the mixed-forest/scrubland niche of the ‘central highlands’ , with extremely low rates out of the latter. intrinsic features germane to this orchid group  as well as extrinsic factors  likely interacted to generate this partly asymmetrical niche transition pattern. our results also tend to suggest that quaternary vegetational shifts had an important role in promoting niche transitions in general, and shaping recent speciation via eastern lowland-to-central highland shifts in particular. the generality of these patterns and timings awaits the availability of additional comparative studies in other madagascan plant endemics, which might also shed light on the central highland biome as a possible ‘end of the colonization road’. finally, this work clearly demonstrates the need for species-level sampling and molecular ecological analyses of bulbophyllum clade c to better understand the relative importance of historical and contemporary factors driving speciation in this orchid group.

availability of supporting data
the data sets supporting the results of this article are included within the article . the phylogenetic data sets  <cit>  supporting the results of this article are available in the dryad digital repository .

additional files
additional file 1: 
fuzzy c-means  clustering analysis of  <dig> locality data points of 
bulbophyllum
clade c . 

additional file 2: 
rankings of loadings for the first two principal components  of  <dig> 
bulbophyllum
clade c  locality values of  <dig> environmental variables . 



competing interests

the authors declare that they have no competing interests.

authors’ contributions

ag, hpc and gaf conceived and designed the experiments. ag performed the experiments. ag and hpc analysed the data. ag and hpc drafted the manuscript. all authors read and approved the final manuscript.

acknowledgment
we like to thank members of the botanical garden of vienna university , the parc botanique et zoologique de tsimbazaza , and the université de la réunion  for general support and help with fieldwork in madagascar and la réunion; the département des eaux et fôrets  and the parc national de la réunion for issuing collecting permits; the curators of herbaria  for the loan of specimens; and elisabeth egger and her team for cultivation of bulbophyllum at salzburg botanical garden . we extend special thanks to h. peter linder  and hanno schäfer  for stimulating discussions on this research topic, to mark pagel  for help in interpreting the niche transition rates, and two anonymous reviewers for very insightful comments on earlier versions of this manuscript. this study was funded by the fwf  grants p20726-b <dig>  and p17124-b <dig>  and by the stiftungs- und förderungsgesellschaft der paris-lodron-universität salzburg.
