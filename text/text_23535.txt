BACKGROUND
during the last decade, the wide availability of high-throughput biological data has made it possible to produce new knowledge via a systems biology approach  <cit> . the inference of biochemical networks  is therefore a question of key importance in the field. during the last decade, many methods have been developed to solve the network-inference  problems arising in e.g. gene expression  <cit> , signal transduction  <cit>  and metabolic networks  <cit> .

in this context, it is particularly worth mentioning the dream initiative   <cit> , which targeted the problems of cellular network inference and quantitative model building in systems biology. dream tries to address two fundamental questions:  how can we assess how well we are describing the networks of interacting molecules that underlie biological systems? and  how can we know how well we are predicting the outcome of previously unseen experiments from our models? interestingly, one of the main conclusions of the dream <dig> event was that the vast majority of the teams' predictions were statistically equivalent to random guesses. moreover, even for particular problem instances like gene regulation network inference, there was no one-size-fits-all algorithm  <cit> .

the use of a performance profiling framework with the dream <dig> benchmark problems revealed that current inference methods are affected by different types of systematic prediction errors  <cit> . these authors conclude that reliable network inference from gene expression data remains an unsolved problem. further, they highlight two major difficulties in the case of gene-network reverse engineering: limited data , and the difficulty of distinguishing direct from indirect regulation. prill et al  <cit>  further explored the issue of intrinsic impediments to network inference, designating identifiability of certain network edges and systematic false positives as the main barriers. in this paper, we consider the widely used reaction kinetic formalism, where dynamic models of biological networks are described by a set of ordinary differential equations . in particular, we consider the central question of the identifiability of such a network as understood in the systems and control area  <cit> .

identifiability analysis studies whether there is a theoretical chance of uniquely determining the parameters of a mathematical model assuming perfect noise-free measurements and error-free modeling  <cit> . one of the early approaches for identifiability testing of nonlinear models is based on the taylor-series expansion of the system output using the fact that the taylor coefficients are unique  <cit> . a similar but more general method uses the generating series or volterra-series coefficients of the system which is the nonlinear generalization of the laplace-transform method used for linear systems  <cit> . in  <cit>  a similarity transformation approach is proposed that gives necessary and sufficient conditions on local and global identifiability through the checking of nonlinear controllability and observability conditions. the appearance of differential algebra methods in systems and control theory  <cit>  opened the possibility for new types of identifiability tests that have gained significant popularity  <cit> . further theoretical developments in the field include the identifiability conditions of rational function state space models  <cit> , the possible effect of initial conditions on identifiability  <cit> , and the application of lie-algebras  <cit> . while identifiability is the property of a certain parameterized model, a related notion called distinguishability addresses the problem whether two or more parameterized models  can produce the same output for any allowed input  <cit> . the literature about identifiability and distinguishability of biological and chemical system models is relatively wide: compartmental systems  are studied in  <cit> . the authors treat general nonlinear crns in  <cit>  and  <cit>  where it is shown that for thermodynamically meaningful models, nonlinearity reduces the chance of indistinguishability compared to the linear case  <cit> . geometric conditions for the indistinguishability of crns are given in  <cit>  with a related comment in  <cit> . computer algebra tools can be successfully used for the symbolic computations needed for identifiability and distinguishability testing of complex models  <cit> .

the importance of identifiability has been recognized previously in systems biology, too  <cit> . however, and despite a number of works illustrating ways to test the structural and practical identifiability of models  <cit> , a significant portion of modeling studies in systems biology continue to ignore this key property.

it has been known for long that chemical reaction networks with different structure and/or parametrization may produce the same dynamical models describing the time-evolution of species concentrations  <cit> . a related problem, namely the non-unique structure of petri nets associated to reaction network dynamics, is studied in  <cit> . additionally, the value of prior information in biological network inference was clearly shown in  <cit>  by applying bayesian network models. however, a constructive optimization-based approach for the study of dynamically equivalent  reaction networks is a recent development  <cit> , which we further extend in this paper.

as a novelty, we present in this paper the definition and a computational method to find the so-called core reactions that are present in any dynamically equivalent reaction network if the set of complexes is given a priori. moreover, a computationally improved method is introduced for the computation of dense realizations of crns together with a modified algorithm to check the uniqueness of a constrained reaction network structure. structural non-uniqueness and the use of the proposed computational methods will be illustrated with the help of biological models known from the literature.

the structure of the paper is the following. the 'methods' section introduces the notions of chemical reaction networks, structural identifiability and distinguishability of dynamical models. moreover, it contains the procedures to obtain core reactions of a network and its sparse and dense representations, which rely on standard methods of linear programming  and mixed integer linear programming   <cit> . the analysis of four biological system models can be found in the 'results and discussion' section, followed by the conclusions.

methods
the model class considered in this paper is of the following form

  ẋ=f,x=x0y=h, 

where x ∈ ℝn is the state vector, y ∈ ℝm is the output, u ∈ ℝk is the input, and θ ∈ ℝd denotes the parameter vector. we assume that the functions f and h are polynomial in the variables x, u and θ. clearly, mass action type crns described in the following subsection , and simple deterministic models of gene regulation such as the one in example  <dig> belong to this model class.

basic notions and known results related to mass-action models
in this subsection, the basic definitions for the description of crns will be given together with the already published results on finding dynamically equivalent network realizations with certain prescribed properties.

structural and dynamical description of mass-action networks
following  <cit>  and several other works, we will characterize crns with the following three sets.

 <dig>  s={x <dig> …,xn} is the set of species or chemical substances.

 <dig>  c={c <dig> …,cm} is the set of complexes. formally, the complexes are represented as linear combinations of the species, i.e.

  ci= ∑j=1nαijxj,i= <dig> …,m, 

where αij are nonnegative integers and are called the stoichiometric coefficients.

 <dig>  r={|ci,cj∈c, and ci is transformed to cj in the crn} is the set of reactions. the relation ∈r will be denoted as ci → cj. moreover, a nonnegative weight, the reaction rate coefficient denoted by kij is assigned to each reaction ci → cj. naturally, if the reaction ci → cj is not present in the crn then kij =  <dig> 

the above characterization naturally gives rise to the following graph structure  of a crn  <cit> . the weighted directed graph g =  of a crn consists of a finite nonempty set v of vertices and a finite set e of ordered pairs of distinct vertices called directed edges. the vertices correspond to the complexes, i.e. v = {c <dig>  c <dig>  ... cm}, while the directed edges represent the reactions, i.e.  ∈ e if complex ci is transformed to cj in the crn. the positive reaction rate coefficients kij are assigned as weights to the corresponding directed edges ci → cj in the graph.  a set of complexes {c <dig>  ..., ck} is called a linkage class of a crn, if the complexes of the set are linked to each other in the reaction graph but not to any other complex. it is remarked that loops  are not allowed in reaction graphs.

assuming mass-action kinetics, the following dynamical description will be used to describe the time-evolution of species concentrations  <cit> :

  ẋ=y⋅ak⋅ψ, 

where xi denotes the concentration of species xi. let us denote the transpose and the th element of an arbitrary matrix w by wt and wi,j, respectively, where i is the row index and j is the column index. the jth column of y contains the composition of complex cj, i.e. yi,j = αji. the structure and parameters of the reaction graph are stored in the column conservation matrix ak  as follows

  i,j=-∑l= <dig> l≠imkil,ifi=jkji,ifi≠j. 

finally, ψ : ℝn ↦ℝm is a monomial-type vector mapping defined by

  ψj= ∏i=1nxiyi,j,j= <dig> …,m. 

dynamical equivalence of mass-action networks
as it is known even from the early literature  <cit> , crns with different structures and/or parametrization can give rise to the same kinetic differential equations. therefore, we will call two crns given by the matrix pairs ,ak) and ,ak)dynamically equivalent, if

  yakψ=yakψ=f,∀x∈ℝ¯+n, 

where for i= <dig> ,y∈ℝn×mi have nonnegative integer entries, ak are valid kirchhoff matrices, and

  ψj= ∏k=1nxkk,j,i= <dig> ,j= <dig> …,mi. 

in this case, ak) for i =  <dig>   <dig> are called realizations of a kinetic vector field f . it is also appropriate to call ,ak) a realization of ,ak) and vice versa.

we will assume throughout the paper that the set of complexes  is fixed and known before the computations. in this case, the condition  for dynamical equivalence can be written as

  y⋅ak=y⋅ak=:m, 

where ak and ak are valid kirchhoff matrices and m is the invariant matrix containing the coefficients of the monomials.

among the dynamically equivalent realizations, it is important to recall the following characteristic ones described in  <cit> . a sparse realization contains the minimal number of reactions that is needed for the exact description of the corresponding dynamics . a dense realization contains the maximal number of reactions among dynamically equivalent realizations with a fixed complex set given by y. while sparse realizations are generally structurally non-unique , the structure of dense realizations with a given complex set is unique, and it contains every possible dynamically equivalent structure as a proper subgraph   <cit> .

known computation approaches for finding preferred crn realizations
here we briefly summarize the already published results corresponding to the computation of preferred dynamically equivalent crn realizations . the computation of dense and sparse realizations can be traced back to mixed integer linear programming  where the decision variables are the non-diagonal elements of ak, the linear constraints encode the kinetic properties of the model, and the objective function contains integer variables for minimizing/maximizing the number of nonzero reaction rate coefficients  <cit> . it is remarked that the computation of sparse realizations is an np-hard problem, where generally mixed integer linear programming cannot be avoided  <cit> . there exist certain conditions under which the problem can be solved in polynomial time  <cit>  but these are often not fulfilled in the case of crns. moreover, there are effective heuristics to address the problem  <cit> , but convergence to one of the truly sparsest structures is not guaranteed. luckily, the milp-based computation of sparse crn realizations can be parallelized effectively thus allowing a larger number of complexes to be treated. the computation of realizations having the minimal/maximal number of complexes or the reversibility property can also be solved in the milp framework  <cit> . moreover, it was shown in  <cit>  that finding detailed balanced and complex balanced realizations of crns is a simple linear programming  problem. finally, weakly reversible dynamically equivalent crn realizations can also be determined  using milp  <cit> .

constrained realizations of crns and testing their structural uniqueness
the following is a straightforward extension of the results published in  <cit> . to prove the uniqueness of a crn structure given a set of simple constraints, we have to extend the notions of dense and sparse realizations. the constraint set denoted by k will be used for the exclusion of selected reactions from the crn, i.e. it is of the form:

  k={i <dig> j1= <dig> …,is,js=0}, 

where s is the number of individual constraints, and ik ≠ jk for k =  <dig>  ..., s. now we can introduce the following definitions. a dynamically equivalent constrained realization of a crn  is a reaction network  such that y⋅ak=y⋅ak′ and the prescribed constraints k in the form of eq.  are fulfilled for ak′. a dynamically equivalent constrained dense realization of a crn  is a constrained realization that contains the maximal number of nonzero elements in ak′. similarly, the constrained sparse realization is a constrained realization with the minimal number of nonzeros in ak′. to characterize constrained dense/sparse realizations, the results of  <cit>  can be adapted easily as follows.

p <dig> given a crn  and a constraint set k, the unweighted reaction graph of any constrained realization is the subgraph of the unweighted reaction graph of the constrained dense realization.

p <dig> if the sets of complexes and constraints are fixed, then for any crn, the structure of the constrained dense realization is unique.

p <dig> the reaction graph structure of a crn with given sets of complexes and constraints is unique if and only if the unweighted directed graphs of its constrained dense and sparse realizations are identical.

the proofs of p <dig>  p <dig> and p <dig> follow similar  lines that were published in  <cit> , and they are given for convenience in the appendix at the end of the paper.

new concepts and computation results related to dynamically equivalent networks
this subsection contains new methodological contributions that extend the previously published results.

making the computation of dense realizations more efficient
computing dense realizations is treated originally also in a milp-framework in  <cit> . however, using the structural uniqueness of such realizations given by p <dig>  it is easy to give a polynomial-time algorithm based on a finite series of linear programming  optimization steps. the idea of the improved algorithm is simple: the reaction ci → cj belongs to the  dense realization if and only if there exists any dynamically equivalent  realization where j,i > <dig>  the result directly follows from the fact that the unweighted reaction graphs of  dense realizations give a unique super-structure. this allows us to formulate a polynomial-time method based on pure lp to determine  dense realizations as follows.

the task of determining which reactions of a crn belong to the dense realization can be effectively solved through the following problem set consisting of m lp computation steps, where m is the number of complexes in the crn.

  for each p,q= <dig> …,m,p≠qdo:maximize fpq=p,qsubject to:y⋅ak=m,∑i=1mi,j= <dig> j= <dig> …,m,0≤i,j≤uij,i,j= <dig> …,m,i≠j,i,i≤ <dig> i= <dig> …,m, 

where the decision variables are the off-diagonal entries of ak, and uij are appropriately large positive upper bounds for i,j to exclude the possibility of unbounded feasible solutions. the reaction cq → cp is in the dense realization if and only if the maximal objective function value for fpq in  is positive. let us denote the solution of  corresponding to , p ≠ q by a¯kpq. since the linear equality and inequality constraints in  are trivially convex, we will use the average of the obtained solutions a¯kpq as a lower bound to compute a possible dense realization in the final optimization step. for this, we define

  εij=1m∑p,q=1p≠qmĀkpqi,j,i≠j. 

by construction, εij ≥  <dig> ∀i ≠ j, and εij > <dig> if and only if the reaction cj→ci is in the dense realization. then the actual dense realization can be determined by solving the following lp feasibility problem for ak :

  y⋅ak=m,∑i=1mi,j= <dig> j= <dig> …,m,εij≤i,j≤uij,i,j= <dig> …,m,i≠j,i,i≤ <dig> i= <dig> …,m. 

it is important to remark that the definition of εij in the form of  guarantees the solvability of . naturally, the above described method can also be used for determining constrained dense realizations by adding constraints of the form  to the lp problems  and .

using the notion and described properties of constrained realizations, we are now able to test the structural uniqueness of given crns. to accomplish this, only the  dense and sparse realizations have to be computed and compared . this method will be illustrated in example  <dig> 

definition and computation of core and non-core reactions
we will call a reaction a core reaction, if it is present in any dynamically equivalent realization of a crn with a given complex set . other reactions, the rate coefficient of which can be zero in certain realizations, are called non-core reactions. it clearly follows from the definition, but is remarked separately that the set of core reactions is generally not identical to the set of reactions of a sparse realization. the identification of core reactions of a crn has not been published yet, therefore we give the outline of the corresponding computation method. firstly, a dense realization of the network has to be computed to get all the mathematically possible reactions. then, for each reaction cp → cq in the dense realization, the feasibility of the following constraint set has to be checked:

  y⋅ak=m 

  ∑i=1mi,j= <dig> j= <dig> …,m 

  i,j≥ <dig> i,j= <dig> …,m,i≠j,≠ 

  i,i≤ <dig> i= <dig> …,m 

  q,p= <dig>  

where the matrix ak contains the decision variables, and the known matrices are y and m. it is well-known that this task is equivalent to an lp problem where the objective function is an arbitrary linear function of the elements of ak  <cit> . then, reaction cp → cq is a core-reaction if and only if the set defined by - is empty , because in this case there is no dynamically equivalent crn realization where cp → cq is not present. we remark here that the presented procedures for determining constrained dense realizations and computing core reactions are parallel in their original forms since the individual lp steps are independent of each other. therefore the proposed methods can be very effectively implemented in a grid or multi-core hardware environment  <cit> .

basic concepts on structural identifiability and distinguishability
let us recall eq. . shortly speaking, global structural identifiability means that

  ŷ≡ŷ⇒θ′=θ″, 

where

  ŷ=h,u,θ), 

and x denotes the solution of  with parameter vector θ. according to , a structurally non-identifiable model can produce exactly the same observed output with different parametrization. this is clearly a fundamental obstacle of determining the true model parameters from measurements even if the selected model structure is considered to be correct.

let us denote two parameterized models with possibly different structure by m <dig> and m <dig>  respectively, where θi denote the parameter vector. then m <dig> is called distinguishable from m <dig> if for any θ <dig>  there is no θ <dig> such that the input-output behaviour of m <dig> and m <dig> is the same  <cit> . clearly, if m <dig> and m <dig> are indistinguishable and both model structures are feasible in a certain application, then there is no way to decide from input-output measurements to which one corresponds to the true model that generated the data.

in the case of crns, we will assume that all species concentrations are measured , the input is zero , and that the set of possible chemical complexes is given. generally, the model parameter vector θ is the set of reaction rate coefficients which are the off-diagonal elements of ak. clearly, if a crn has several different dynamically equivalent realizations, then these realizations are not distinguishable without additional constraints, and the model cannot be identifiable if all the rate coefficients are to be determined  <cit> . this situation can be improved by using prior knowledge in the form of adding further constraints on the model parameters such as the simple ones given by eq. . this way, the number of parameters to be estimated can be reduced and/or their feasibility region can be shrinked. it is important to note that although the structural uniqueness of a crn definitely reduces the degree of non-identifiability , it does not necessarily imply structural identifiability  <cit> , and this latter property has to be checked by further numerical methods  <cit> .

RESULTS
in this section, the application of the previously mentioned methods for finding different dynamically equivalent structures will be illustrated using biological models taken from the literature. the detailed numerical data corresponding to examples 1- <dig> are contained in a standard spreadsheet form with brief explanations in additional file 1: crn_data.xls.

example 1: a positive feedback motif
the first example is a positive feedback motif shown in figure 1a and taken from  <cit>  containing  <dig> species,  <dig> complexes and  <dig> reactions. this basic motif is also discussed in  <cit> . the network contains a gene that promotes its own transcription and translation after dimerization. in the model, x <dig> and x <dig> denote the concentrations of protein monomers and dimers, respectively. x <dig> and x <dig> are the concentrations of unoccupied and occupied promoters, respectively, and x <dig> corresponds to the mrna. the degradation of dimers is ignored. the roles of the reaction rate coefficients are the following: k <dig> and k <dig> are the dimerization and re-dimerization rates, respectively. k <dig> and k <dig> are the binding and dissociation rates of the dimer to the promoter, while k <dig> and k <dig> denote the activated and basal transcription rates, respectively. k <dig> is the degradation rate of the mrna, k <dig> is the degradation rate of the monomer, and k <dig> denotes the translation rate. the time-evolution of the species-concentrations is described by the following odes:

  ẋ1=-2k1x12+2k2x2+k9x5-k8x <dig> 

  ẋ2=k1x12-k2x2-k3x2x3+k4x <dig> 

  ẋ3=-k3x2x3+k4x <dig> 

  ẋ4=k3x2x3-k4x <dig> 

  ẋ5=k5x4+k6x3-k7x <dig>  

our starting point is that we have a dynamic model of the process in the standard polynomial form of -, the parameters of which are known from the results of identification and/or from literature. as we will see below, without well-defined constraints on the possible set of complexes and reactions, exactly the same dynamics can be realized in principle by a wide range of mechanisms.

the matrices characterizing the stoichiometry and graph structure of the system are the following :

  y= <cit>  

   <dig> =k <dig> ,2=k <dig> ,3=k <dig> ,4=k <dig> ,4=k <dig> ,6=k <dig> ,8=k <dig> ,10=k <dig> ,8=k <dig>  

we used the following parameter values that were taken from the appendix of  <cit> .

  k1=k2=k3=k4= <dig> k5= <dig> ,k6= <dig> ,k7= <dig> ,k8= <dig> ,k9= <dig> , 

where the units of measure are  for k <dig>  ..., k <dig>  and  for k <dig>  ..., k <dig>  the dynamically equivalent dense realization of the network is shown in figure 1b, where the  <dig> core and  <dig> non-core reactions are indicated separately. the three different sparse structures are shown in the subplots of figure  <dig>  the first subplot is identical to the original structure shown in figure 1a. this means that the mechanism cannot be described exactly with less than  <dig> reactions. it turns out from the second and third subplots that , the degradation of mrna is dynamically not a necessary element of the model. however, the biological plausibility of the mathematically possible structures and reactions always has to be carefully examined.

as it is expected, the possible structures of sparse/dense realizations and the corresponding core and non-core reactions can change with the modification of parameter values. this is illustrated in figure 3a, where the following randomly generated parameter values were used:

  k1= <dig> ,k2= <dig> ,k3= <dig> ,k4= <dig> ,k5= <dig> ,k6= <dig> ,k7= <dig> ,k8= <dig> ,k9= <dig> . 

it is visible that the structure of the dense realization is the same as in figure 1b but the core reactions are different from the ones shown there. here the degradation of mrna is described by a core reaction but interestingly, the reaction corresponding to translation is not a core one. naturally, this implies that the possible sparse realization structures with the second parametrization are different from the ones shown in figure  <dig>  note that here the only goal was to illustrate the possible change of core and non-core reactions, and therefore the biological relevance of the parameter values in eq.  is not assumed in this case.

in the next step, let us assume that another complex, namely x <dig> + x <dig> is allowed in the model . with the addition of this new complex, the stoichiometric matrix of the system can be written as

  y′=200001000110000011000100000101001000001100010000010000001010t. 

the dense crn realization of the dynamics - with the updated y' matrix given in eq.  using the original parameters described in  is shown in figure 3b, where the core and non-core reactions are again indicated. it is apparent that now there are only  <dig> core reactions, and none of the remaining  <dig> reactions are essential to represent the dynamics -. this means that the introduction of a new complex increased the flexibility of the network . of course, not any combination of the non-core reactions can be omitted from the network, because the sparse realizations show that at least  <dig> reactions are needed to keep dynamical equivalence. it can be computed easily that the theoretical maximum number of sparse realizations with different structures is 1217-9= <dig>  however, as the numerical experiments show, majority of these structures do not give a practically feasible dynamically equivalent realization.

the above results clearly show that certain mechanisms may remain undetectable  even if we have complete species concentration measurements and full information about possible complex formation, that are not very realistic assumptions. moreover, the sparsest dynamically equivalent structure of mass-action models is not unique, therefore sparsity enforcing approaches for determining 'true' reaction structures are not enough in themselves without the necessary amount of prior information given in the form of additional constraints. the practical situation is most often even worse than that, since the measurements are typically incomplete, noisy and sometimes dynamically not rich enough, that may introduce further obstacles to the structure/parameter estimation process  <cit> .

example 2: a biochemical switch in yeast cells
the following example is taken from  <cit>  and it describes a 'switching device' in yeast cycle regulation. the detailed system description can be found in  <cit>  and in the accompanying supporting information document. the order of state variables, corresponding to concentrations, is the same as in the original article, and is shown below:

x1: , x2: , x3: , x4: , x5: , x6: , x7: , x8: , x9: . the original structure with  <dig> reactions is shown in figure 4a. the y matrix of the network is given by

  y=010000000000000000100000000101000000000100000001000000011000000000010000001100000000000001001010000010001000000000100100001000000011000000000010000101000t. 

the non-zero off-diagonal elements of ak are :

   <dig> =k <dig> ,3=k <dig> ,2=k <dig> ,5=k <dig> ,4=k <dig> ,5=k <dig> ,8=k <dig> ,8=k <dig> ,7=k <dig> ,10=k <dig> ,9=k <dig> ,10=k <dig> ,13=k <dig> ,12=k <dig> ,13=k <dig> ,16=k <dig> ,15=k <dig> ,16=k <dig>  

since there are no parameter values published in  <cit> , we used the following randomly selected rate coefficients:   

the structure of the dense realization indicating the  <dig> core and  <dig> non-core reactions can be seen in figure 4b.

it can be shown using the computational methods described in the 'methods' section that the only possible sparse realization structure is identical to that of the original network. therefore in this special case, there is only one possible reaction structure containing the minimal number of reactions. a straightforward approach to ensure the structural uniqueness of the whole network is to exclude all reactions that are not meaningful from the examined application's point of view or that are contradictory to modeling assumptions. for the current example, the removal of an unexpectedly low number of reactions is enough to obtain a unique structure. it can be shown by computing the corresponding constrained dense and sparse realizations, that excluding the reactions x <dig> → x <dig> + x <dig>  x <dig> → x <dig> + x <dig>  x <dig> + x <dig> → x <dig> + x <dig>  and x <dig> + x <dig> → x <dig> + x <dig> is enough to make the reaction structure unique that is identical to the original structure shown in figure  <dig>  in other words, the exclusion of  <dig> well-selected reactions leads to the removal of an additional  <dig> reactions leaving only  <dig> 

example 3: a repressilator structure with  <dig> nodes and auto-activation
consider the repressilator model shown in figure  <dig> with  <dig> nodes where also auto-activation is assumed. similarly to  <cit> , we make the following assumptions: cooperative regulator binding, genes are present in constant amounts, transcription and translation are modeled by single-step kinetics, and finally, proteins are degraded by first order reactions. we note that complex dynamic phenomena such as multiple steady states or oscillations have been shown with a wide range of parameters in similar systems, especially in the case when the number of genes is odd  <cit> . we also assume that there is some protein production  when both the activator and the repressor are bound to the genes . it is clearly shown in  <cit>  that kinetic models with simple mass-action kinetics very effectively describe complex dynamics in genetic regulatory networks, therefore we follow the same modeling methodology. using the assumptions listed above, the crn describing the system is the following:

  gi+pi ⇄ki,2ki,1gia 

  gia →ki,3gia+pi 

  gi+pj ⇄ki,5ki,4gir 

  gir+pi ⇄ki,7ki,6giar 

  gia+pj ⇄ki,9ki,8giar 

  giar →ki,10giar+pi 

  pi →ki, <dig> 

for the index pairs  ∈ {, , , , }. in eqs. -, gi and pi represent the ith gene and protein, respectively. for the genes, superscripts a and r refer to activated and repressed states, respectively. let us denote with ri,k the reaction with rate coefficient ki,k in eqs. -.

two cases with different sets of randomly selected rate coefficients were studied, and the structures of the obtained results were the same. the numerical details can be found on the 3rd sheet of additional file 1: crn_data.xls. the total number of reactions for the repressilator model is  <dig> that is equal to the number of reactions in the sparse realization. the dense realization contains  <dig> reactions which means that there are a maximum of  <dig> more mathematically possible reactions while maintaining exactly the same dynamics as the original biological model. these additional reactions are the following:

  giar→gir,pi+gir→gir,pi+gir→pi+giar,fori= <dig> …, <dig>  

the number of core reactions in the model are  <dig>  the set of non-core reactions  is given by

  giar⇆gir+pi,i= <dig> …, <dig>  

in particular, it is easy to show  that reactions giar→gir+pi and giar→gir are always indistinguishable. similarly, the reaction gir+pi→giar can be substituted with the combination of reactions gir+pi→gir and gir+pi→giar+pi. it can be seen from these results that in order to have a model with unique structure, it is very important to a priori exclude all reactions that are not meaningful for the particular application.

example 4: sparse linear gene regulation network models
for structural identification, gene regulation networks are often modeled as linear time-invariant systems  <cit>  of the form

  ẋ=ax+bu, 

where a ∈ ℝn×n contains the connectivity information of the network. ai,j > <dig> indicates activation from node j to node i, while ai,j < <dig> means repression, diagonal elements of a represent auto-activation or auto-repression depending on their sign. x ∈ ℝn is the fully or partially measurable state of the system describing the time evolution of concentrations, and the input part bu represents experimental perturbation  of the genes. it is also a common assumption that the network is 'sparse' which means that there are only a limited number of activation or repression links between the nodes . but assuming sparsity can be a serious obstacle to identifiability as it will be shown.

first, consider the 'true' genetic network structure that was simulated and inferred in  <cit>  and that is redrawn in figure 6a. from the figure, we can reconstruct the structure of the corresponding a matrix as follows 

  *0000000+00000000++000*00-0000000000+00+000+000-0000000*00+000++0000000000-0-00000000-+000000000+- <dig>  

where '+', '-' and '*' represent positive, negative and nonzero  parameter values, respectively. if there are no prior assumptions about the structure of the interconnection matrix or about the relations between certain parameters, we can easily test the structural non-identifiability of the model by checking whether all nodes are reachable from the perturbed node on a directed path in the interconnection graph or not  <cit> . the reachability of nodes can be tested by several methods, e.g. a depth- or breadth-first-search  of the corresponding directed graphs that are fast polynomial-time algorithms  <cit> . to give a very simple example, it is clear from figure 6a, that if nodes  <dig> or  <dig> were excited by an input signal, then the connections between the other nodes  would be undetectable by any method, however sophisticated it is. to examine whether situations like this one are common, we generated  <dig> random state space models using the same method, and assuming zero initial conditions as in  <cit> . the connectivity of the corresponding directed graphs was tested using dfs. for  <dig> nodes and  <dig> nonzero elements in each row of a , we obtained that  <dig> % of the generated models are structurally non-identifiable. the histogram showing the number of reachable states is shown in figure 6b. the situation is dramatically improving if k is increased to  <dig> as shown in figure 6c. in this case, around 17% of the models are structurally non-identifiable. when we have  <dig> nodes and  <dig> nonzero elements in each row of a , then only  <dig> % of the generated models are structurally non-identifiable. the results show that 'sparsity' has a clearly negative effect on structural identifiability because of limited information transmission between nodes. and finally, we did not speak at all about practical identifiability which is known to be a challenging issue even if the required structural properties are fulfilled  <cit> .

relation between high level networks and crn structure
as shown in example  <dig>  the various possible dynamically equivalent crn structures do not correspond to a different grn structure, if all species concentration measurements are available and the mapping described in  <cit>  is used for transforming the models into each other. hence, exact matching of the dynamics of different grn structures may generally be a too severe restriction. to extend this line of research, the relaxation of dynamical equivalence to 'close dynamical similarity' seems to be more meaningful but the corresponding definitions and computational methods are much more complex than in the case of dynamical equivalence. one promising recent approach to assess dynamical similarity of crns  is the concept of 'linear conjugacy'  <cit> . however, it might happen that dynamically completely equivalent grn structures will be shown in the future.

CONCLUSIONS
it has been shown in this paper using illustrative examples that biological network structures modeled by crns often cannot be uniquely determined even if the structure of the corresponding mathematical model is assumed to be known and all dynamical variables are measurable. the structural uniqueness and identifiability of the models often require additional constraints.

the main new contributions of the paper are the following. firstly, core reactions present in any dynamically equivalent crn realizations with a given complex set have been defined and a simple procedure with polynomial time-complexity has been given for determining them. clearly, the core reactions are mandatory elements of every dynamically equivalent crn realization assuming a fixed complex set. secondly, a polynomial-time method based on linear programming for computing dense realizations has been outlined that is more scalable and therefore presents a clear improvement over the previously used milp-based method. as an additional minor extension of previous results, constrained realizations of crns have been defined, and a computational method has been proposed to check the uniqueness of constrained realizations.

the presented concepts and algorithms were illustrated on previously published models describing biological processes. it was shown that the set of core reactions may change with the modification of the complex set. the examples also show that the frequently applied sparsity assumption alone is not enough for structural uniqueness of crns. moreover, in the case of simple linear genetic network models, too sparse structures can degrade identifiability properties. the results further support the fact that as much prior information as possible should be incorporated in structural and parametric inference problems.

competing interests
the authors declare that they have no competing interests.

authors' contributions
all authors contributed to the conception and design of the work. jrb and gs selected and evaluated the examples. gs performed the numerical computations. all authors contributed to the writing of the manuscript. all authors read and approved the final manuscript.

a appendix
proof of p <dig>  let us denote the ith column of any matrix w by w·,i. the proof is based on the following well known fact of linear algebra. consider an inhomogeneous set of linear equations:

  ax=b 

if x = p is any particular solution of  then the entire solution set for  can be characterized as

  {p+v|visanysolutionofax=0} 

the matrix equation y · ak = m  and ) obviously defines m sets of linear equations of the form

  y⋅⋅,i=m⋅,i,i= <dig> …,m 

let us choose any i indexing the sets of equations in . for simplicity, let p = ·,i, b = m·,i. let us assume that there are z elements of the constraint set  where jk = i for k =  <dig>  ..., s.  these constraints can be expressed by further linear equations of the form:

  h,i= <dig> h= <dig> …,z 

the equation sets  and  can be written into a single set of equations as

  Ȳ⋅p=b¯ 

where Ȳ∈ℝ×m and b¯∈ℝn+z. let us assume now that p is a dense solution for , i.e. it contains the maximal possible number of nonzero elements. if p has no zero elements, then the result to be proved is trivially satisfied. therefore, without the loss of generality we can assume that the first l < m elements of p are nonzero, while the rest are zero, i.e. pj ≠  <dig> for j =  <dig>  ..., l, and pj =  <dig> for j = l +  <dig>  ..., m. this can always be achieved by the appropriate reordering of the elements of p. assume now that p' ∈ ℝm is also a solution for , but pc′≠ <dig> for some c ∈ ℤ, l +  <dig> ≤ c ≤ m. then p' = p + v, where Ȳ⋅v= <dig>  and vc ≠  <dig>  in this case, p″ = p + λ · v is also a solution for  for any λ ∈ ℝ and λ can always be chosen so that pj″≠ <dig> for j =  <dig>  ..., l, and there is at least one index l +  <dig> ≤ c ≤ m for which pc″≠ <dig>  however, this contradicts to the assumption that p is a dense solution for .

proof of p <dig>  this is a straightforward consequence of p <dig>  since the unweighted directed graphs of all constrained dense realizations must be identical.

proof of p <dig>  if the graph structure of the constrained realization is unique, then it trivially implies that the structures of the constrained dense and sparse realizations are identical, since there exists only one possible constrained reaction structure. if the structures of the constrained dense and sparse realizations are identical, then the number of nonzero reaction rates is the same in any constrained realizations including the constrained dense ones. then it follows from p <dig> that the constrained reaction structure is unique.

supplementary material
additional file 1
detailed numerical data of the crns shown in examples 1- <dig>  this file contains the detailed data  of the dynamically equivalent reaction networks studied in examples  <dig>  and  <dig>  the individual sheets correspond to the different examples.

click here for file

 acknowledgements
this work was financially supported by project cafe  fp7-kbbe-2007- <dig> . the authors acknowledge the support by the spanish government, micinn project 'multisysbio' , and by csic intramural project 'bioredes' . gs acknowledges the partial support of the hungarian scientific research fund through grant no. k <dig>  the authors thank dr. irene otero muras  and prof. zsolt tuza  for the fruitful discussions. the authors wish to thank the anonymous reviewers for their helpful comments.
