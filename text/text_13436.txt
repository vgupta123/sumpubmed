BACKGROUND
animal mirnas are small molecules with ~22-nt in length playing an important role in the post-transcriptional regulation of gene expression. they originate from the maturation of larger precursor molecules called pre-mirnas with ~70-nt in length and a typical foldback structure. these stem-loops can be excised from larger primary transcripts often containing several precursors in tandem  <cit> , or from the introns of protein-coding genes .

the biological function of mirnas is defined by the genes they target by imperfectly pairing with binding sites located primarily in the 3'utr region of the target gene  <cit> . a set of these regulators will usually act in coordination to dampen or abolish the expression of a common target, although a single mirna may efficiently silence a gene  <cit> .

the identification of the full set of mirnas of an organism is an important step towards the understanding of complex gene regulatory networks of which mirna-dependent silencing is a crucial aspect. since mature mirnas are too small to exhibit distinguishable features, the computational search for these regulators has focused on the identification of their larger precursors and their characteristic hairpin secondary structure  <cit> .

despite a growing list of mirnas, identified either by experimental assays or using current computational tools, the goal of enumerating the full catalogue of mirnas of any single organism has proven to be difficult, requiring different approaches to identify a decreasing number of novel regulators. a recent thorough experimental study of mammalian mirnas did find new regulators, but it also showed that several annotated sequences were likely not mirnas  <cit> . the difficulties are two-fold. on the one hand, purely experimental detection is limited to mirnas which are expressed at relatively high levels and in broad cellular types/conditions. recent deep-sequencing techniques tackle these limitations but require extensive computational analyses  <cit> . on the other hand, computational mirna gene finding tools are strongly dependent on conservation criteria and other sequence/structure similarities with previously identified mirna precursors which limits their power to identify novel mirnas, particularly those which are not conserved  <cit> .

single-genome approaches are increasingly necessary given the fact that a growing number of genome sequencing projects are under way for which no evolutionarily close genome is available and for which one cannot otherwise hope to thoroughly explore the mirna landscape.

considering that we have but rudimentary models of mirna precursor evolution, which makes it hard to interpret the biological significance of conservation data, and that we lack a deep understanding of the structural requirements for efficient pre-mirna processing, we believe that if we are to increase our knowledge of the mirna repertoire of an organism, our efforts should privilege general properties that are known to characterise mirna precursors. these properties should not necessarily emerge from rules learnt from the detailed analysis of previously known precursors, but should rather focus on features that, in principle, distinguish pre-mirnas for other hairpins.

in this paper, we propose a method to score pre-mirna candidates from a single genome by combining four robustness/stability measures that are known to distinguish mirna precursors from other genomic stem-loops. we use these measures to greatly reduce the initial set of candidates and we show that it consists of a high-sensitivity approach which is able to recover known mirna precursors in a. gambiae and d. melanogaster. furthermore, we apply our method to the newly sequenced genome of anopheles darlingi where we show that our combined score  performs well by identifying  <dig> clear homologs of known pre-mirnas in anopheles gambiae amongst the top-scoring candidates. in addition, our approach is compared to a well-known single-genome method - triplet-svm  <cit>  - and to a recent and sophisticated hhmm-based classification approach - hhmmir  <cit> .

this work is part of a framework under development, named cravela http://www.cravela.org, which purports to identify and evaluate mirna regulatory modules relying on heterogeneous sources of data.

RESULTS
the precursor candidate enumeration method recovers known pre-mirnas
most known pre-mirnas are matched by precursor candidates
in order to evaluate the sensitivity of this procedure, it is necessary to assess whether known precursors are found amongst the extracted candidates. the number of known precursors and precursor candidates extracted from the datasets using the enumeration procedure described in the methods section are shown in table  <dig> 

the table shows the number of elements in the positive and negative sets, the number of candidates overlapping elements of the positive set and the total number of extracted candidates for each dataset. for a. darlingi, the positive set is the set of clear homologs to a. gambiae pre-mirnas whereas in all other datasets the positive set corresponds to the known precursors. in all cases, the negative set consists in the presumptive non-precursor candidates which do not overlap precursors in the positive set.

annotated sequences may or may not include sequences flanking the pre-mirnas because the precise coordinates of the precursor hairpins are not always experimentally determined. the stem-loops identified by our enumeration strategy are extended stem-loops in the sense that they are the largest stem-loops contained in their local genomic contexts, and will therefore tend to be larger than precursor hairpins. in both cases, if the flanking sequences are short with respect to the actual precursor, the impact on the candidate evaluation procedure is likely to be modest.

only very few known precursors are not matched by any candidate . since the enumeration procedure can only identify canonical stem-loops, some of these cases refer to multi-loop structures that share a common stem but with relatively small secondary stem-loops which fail to pass the minimum length criterion. others are short structures which are filtered by the - <dig> kcal/mol stability criterion .

additionally, the vast majority of annotated precursors with known mature sequences has a best match which includes the mature sequence in one of its stem arms . it is worth to point out that in most cases a best match noted as not including the mature sequence in the stem arm in fact only misses the start or end of the mature sequence by a few nucleotides  because of a missed dangling end.

a combination of measures scores bona fide pre-mirnas above most precursor candidates
the measures used in this paper purport to assess whether the candidate precursors possess certain features that have been shown to distinguish pre-mirnas from other stem-loops and are related to their stability and robustness.

it was shown that mirnas have an adjusted minimum free energy  that is lower than that of other stem-loop structures  <cit> , i.e., when normalised for length, other genomic stem-loops tend to be less stable than mirna precursors. similarly, it was established that mirna precursors tend to preserve roughly the same secondary structure in the face of variations in their genomic context  <cit> , presumably as an evolved robustness to mutations in their flanking sequences . likewise, it was shown that mirna precursor structures are usually also robust with respect to mutations   <cit> , possibly as a result of second-order evolutionary processes. to these three measures, we add the requirement for robustness of folding observing that a true mirna precursor should fold into a stable stem-loop structure for the most part of the structures in the thermodynamic ensemble where the molecule is found in physiological conditions.

from the combination of these four measures, it is possible to derive a single score for each precursor candidate and rank the stem-loops extracted from the datasets. our single score not only combines the information provided by each measure, but it does so against a background of hairpins extracted from a random sequence with the same dinucleotide distribution of the original genome. this procedure compensates for hairpin robustness provided by genome composition alone.

in order to separate the problem of correctly identifying candidate precursors with that of assessing the performance of our evaluation measures, we take the known pre-mirnas in each dataset as the positive set, and the negative set is made of all the candidates which do not overlap the coordinates of known precursors. the number of elements in the positive/negative sets for each dataset is shown in table  <dig>  the negative sets may include several yet unidentified precursors whose identification would have an impact on our performance assessment. to mitigate this problem and to assess the stability of the cutoff value for each measure as well as the combined score, and, more importantly, to deal with the greatly uneven positive/negative set sizes, we have adopted an undersampling procedure for the negative sets. in this procedure, we randomly extract  <dig>  <dig> samples from the negative set each having the size of the positive set.

the combined score performs better than any individual measure
figures  <dig> and  <dig> and table  <dig> show the performance of the evaluation measures for the a. gambiae and d. melanogaster datasets, respectively.

the average optimal cutoff value for each dataset over the  <dig>  <dig> samples, alongside the average sensitivity and specificity values at that cutoff level.

the amfe  <cit>  measure performs best in the a. gambiae dataset. the fact that this measure does not compensate for gc content, which has a significant impact on folding free energy values, may explain the disparity of the results. the d. melanogaster dataset includes both euchromatic and heterochromatic sequences with different gc content, the latter having considerably lower values. the procedure used to combine the evaluation measures partially compensates for the lack of gc content normalisation because the randomised dataset is generated maintaining the same dinucleotide distribution of each of the original sequences. replacing the amfe with a modified version of the mfei  <cit>  measure, which does compensate for gc content and is discussed in the methods section, had no discernible impact on the combined score .

in both the a. gambiae and d. melanogaster datasets, the robustness of folding and the robustness to context measures have comparable performances in terms of average auc, which summarises the relation between the true/false positive rates across all possible cutoff values for each of the samples of the negative set.

the robustness to mutations measure performs well with the a. gambiae dataset but the performance in the d. melanogaster dataset is negatively influenced by the presence of several long inverted repeats  that are resilient to point mutations and thus attain a high score for this measure. these sequences should not be summarily excluded as they can include true mirna precursors.

the results for the combined score  for both datasets are shown in figures  <dig>  and  <dig>  in both cases, the cscore performs better than any individual measure in terms of average auc, which means that, in general, for the same false positive rate ) one can attain higher sensitivity  or, conversely, for the same true positive rate ) one can expect better specificity  =  <dig> - fpr).

if we take the average optimal cutoff value for the cscore on each dataset, we obtain a reduced set of  <dig>  <dig> candidates for a. gambiae and  <dig>  <dig> for d. melanogaster. if we further eliminate all candidates whose genomic locations are overlapped by other candidates with higher cscore, the total number of candidates is reduced to  <dig>  <dig> for a. gambiae and  <dig>  <dig> for d. melanogaster.

the combined score performs well compared to other methods
only a few classification methods can be readily compared to our combination of measures due to both the lack of use of conservation information and the need to evaluate a large number of candidates.

triplet-svm  <cit>  is a fast and well-known binary classification method that uses a support vector machine  to learn sequence/structure features of pre-mirnas in order to distinguish them from other genomic stem-loops. the feature vector used to train the svm considers the pairing states of every three nucleotides  plus the identity of the nucleotide at the middle. the results presented here were obtained using the method with default parameters and the svm model provided by the authors. being a binary classification method, triplet-svm cannot be used to generate roc curves for a direct comparison with our method. hhmmir  <cit>  is a sophisticated method based on hierarchical hidden-markov models.

this method tries to learn the distinctive sequence/structure characteristics of different regions of the mirna precursor. hhmmir scores each candidate by calculating the ratio of the log-likelihoods generated by the positive and negative models .

unlike with triplet-svm, the fact that hhmmir can associate a score with each candidate elicits a direct comparison with our approach using roc curves. like before, the results presented for hhmmir were obtained using default parameters and the maximum likelihood models provided by the authors.

the results presented in figures  <dig> and  <dig> show the comparative performance of the cscore, triplet-svm and hhmmir. the graphs illustrate the fact that triplet-svm tends to sacrifice sensitivity in order to obtain better specificity. in all datasets, the average performance of cscore always outperforms the average performance attained by triplet-svm.

the performances of the cscore and hhmmir are quite similar in terms of average auc. the cscore slightly outperforms hhmmir for the a. gambiae dataset, whereas the reverse is seen in d. melanogaster. it is nonetheless surprising that a scoring scheme such as cscore, which makes no prior assumptions about precursor stem-loops except that they ought to be stable and robust, exhibits a performance comparable to a classifier that has been trained on known pre-mirnas and is capable of sophisticated modelling of precursor sequences.

both triplet-svm and hhmmir are supervised learning methods which rely on training sets to produce a decision rule. in both cases, their ability to find novel mirnas is dependent on how representative positive and negative examples turn out to be. the results presented here show that an approach that requires no prior training performs as well as the best of the two methods.

exploration of precursor candidates in a. darlingi
our candidate enumeration and evaluation procedures were applied to the newly sequenced a. darlingi. a total of  <dig>  <dig>  <dig> precursor candidates were identified as shown in table  <dig>  to test our approach on a non-annotated genome, we analyse the performance of our cscore on three groups of candidates: those that are identified as homologs of known precursors from a. gambiae, those that are conserved in both genomes , and those which show low or no conservation .

we found clear homologs of  <dig> a. gambiae pre-mirnas supported by both high-quality mutually best alignments and the observation that in all cases the mature sequence is perfectly conserved. the list of homologs and the alignment of the mature sequence with the homologous precursors is shown in the supplementary materials. the number of homologs identified corresponds to 67% of the pre-mirnas known in a. gambiae, which is the closest sequenced genome to that of a. darlingi. all remaining known precursors in a. gambiae except one, despite not having clear homologous precursor sequences, do have identical mature sequences within the stem-arm of a precursor candidate in a. darlingi, which could indicate homology through conservation at a structural level. additionally, we identified  <dig>  <dig> precursor candidates conserved in both genomes .

the analysis of the distribution of the cscore for the three groups of candidates shows that the median scores are  <dig> ,  <dig> , and  <dig>  for the homologs, conserved and non-conserved candidates, respectively. the conserved and non-conserved stem-loops have similar cscore distributions, but the scores for the set of homologs, however, are distinctively higher. the fact that the score distribution for conserved and non-conserved candidates is very similar reinforces the idea that conservation criteria alone are not sufficient to identify good precursor candidates.

there are  <dig>  <dig> candidates above the average optimal cutoff for the a. darlingi dataset, which can be reduced to  <dig>  <dig> by eliminating candidates overlapped by candidates with higher scores. of these,  <dig> are found amongst the list of candidates conserved with respect to a. gambiae.

CONCLUSIONS
common computational strategies to address the problem of mirna gene discovery usually involve the identification of a set of candidates that are subsequently filtered by their similarity with previously known pre-mirnas and their degree of conservation in close species.

although these approaches have vastly expanded the list of known mirnas, relying merely on our general knowledge of the mirna silencing pathway and arguments of similarity and conservation, they generally fail to integrate and use a growing amount of knowledge about these regulators. more significantly, these methods have introduced a strong bias favouring pre-mirnas exhibiting extensive conservation and sharing a number of features with previously identified precursors. to varying degrees, their ability to discover non-conserved or non-canonical pre-mirnas is therefore greatly reduced if not completely suppressed. this is not to say that one expects pre-mirna features to vary greatly, but rather that the bias may not reveal the adequate learning set.

the method presented in this paper is part of a framework named cravela which purports to be able to draw from heterogeneous sources of data and to offer an evidence-based tool to estimate the likelihood that a given set of precursor candidates are indeed pre-mirnas. here we have restricted our analysis to the portion of the framework responsible for extracting and sieving through a set of precursor candidates originating from a genome-wide search.

in this paper we show that by combining different robustness and stability measures, one can obtain a scoring scheme that outperforms any individual measure. there is, however, room for improvement. the procedure used to combine the different measures for each dataset relies on the measure distributions calculated for stem-loops extracted from artificial sequences generated with the same dinucleotide distributions observed in the original genome. as suggested by the relatively poorer results obtained for the d. melanogaster dataset, which includes both euchromatic and heterochromatic sequences, genome heterogeneity may warrant the generation of multiple artificial sequences with their respective measure distributions in order to obtain a scoring scheme able to cope with variations in sequence features for different regions of the genome.

the combination of measures that we present in this paper shows that there is a strong bias towards robust mirna precursors and that this information can be used to reduce the vast number of stem-loops that are found in metazoan genomes. nonetheless, given the number of precursor candidates that remain after sieving through those which were identified in the three datasets we have presented, one cannot claim that we are in the presence of a mirna gene finding method. we have, however, reduced the number of candidates by one order of magnitude, without resorting to classic approaches and retaining most known pre-mirnas in each dataset. the main advantage of the adopted score is that it relies on intelligible criteria based on arguments of biological plausibility. for annotated genomes, further reductions of the number of candidates can readily be used, namely by eliminating all candidates overlapping regions with annotations incompatible with the presence of a pre-mirna. for genomes that have transcription data made available, that information can be used to restrict the candidates to those for which there is evidence of transcription.

over this reduced set of candidates one can now apply any number of structure/sequence features analyses, conservation criteria, or other filters depending only on the information that is available for the genome under study.

