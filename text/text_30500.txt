BACKGROUND
gene expression profiles give a snapshot of mrna concentration levels as encoded by the genes of an organism under given experimental conditions. early studies of this data often focused on a single point in time which biologists assumed to be critical along the gene regulation process after the perturbation. however, the static nature of such experiments severely restricts the inferences that can be made about the underlying dynamical system.

with the decreasing cost of gene expression microarrays time series experiments have become commonplace giving a far broader picture of the gene regulation process. such time series are often irregularly sampled and may involve differing numbers of replicates at each time point  <cit> . the experimental conditions under which gene expression measurements are taken cannot be perfectly controlled leading the signals of interest to be corrupted by noise, either of biological origin or arising through the measurement process.

primary analysis of gene expression profiles is often dominated by methods targeted at static experiments, i.e. gene expression measured on a single time-point, that treat time as an additional experimental factor  <cit> . however, were possible, it would seem sensible to consider methods that can account for the special nature of time course data. such methods can take advantage of the particular statistical constraints that are imposed on data that is naturally ordered  <cit> .

the analysis of gene expression microarray time-series has been a stepping stone to important problems in systems biology such as the genome-wide identification of direct targets of transcription factors  <cit>  and the full reconstruction of gene regulatory networks  <cit> . a more comprehensive review on the motivations and methods of analysis of time-course gene expression data can be found in  <cit> .

testing for expression
a primary stage of analysis is to characterize the activity of each gene in an experiment. removing inactive or quiet genes  allows the focus to dwell on genes that have responded to treatment. we can consider two experimental set ups. firstly, we may be attempting to measure the absolute level of gene expression . in this case a quiet gene would be one whose expression level is indistinguishable from noise. alternatively, we might be may be hybridizing two samples to the same array and quantifying the ratio of the expression levels. here a quiet gene would be one which is showing a similar response in both hybridized samples. in either case we consider such expression profiles will consist principally of noise. removing such genes will often have benign effects later in the processing pipeline. however, mistaken removal of profiles can clearly compromise any further downstream analysis. if the temporal nature of the data is ignored, our ability to detect such phenomena can be severely compromised. an example can be seen in figure  <dig>  where the temporal information is removed from an experimental profile by randomly reordering its expression samples. disregarding the temporal correlation between measurements, hinders our ability to assess the profile due to critical inherent traits of the signal being lost such as the speed and scale of variation.

failure to capture the signal in a profile, irrespective of the amount of embedded noise, may be partially due to temporal aggregation effects, meaning that the coarse sampling of gene expression or the sampling rates do not match the natural rates of change in mrna concentrations  <cit> . for these reasons, the classification scheme of differential expression in this paper is focused on reaching a high true positive rate  and is to serve as a pre-processing tool prior to more involved analysis of time-course microarray data. in this work we distinguish between two-sample testing and experiments where control and treated cases are directly-hybridized on the microarray . the two-sample setup is a common experimental setup in which two groups of sample replicates are used  <cit> ; one being under the treatment effect of interest and the other being the control group, so to recover the most active genes under a treatment one may be interested in testing for the statistical significance of a treated profile being differentially expressed with respect to its control counterpart. other studies use data from a one-sample setup  <cit> , in which the control and treated cases are directly hybridized on a microarray and the measurements are normalized log fold-changes between the two output channels of the microarray  <cit> , so the analogous goal is to test for the statistical significance of having a non-zero signal.

a recent significant contribution in regards to the estimation and ranking of differential expression of time-series in a one-sample setup is a hierarchical bayesian model for the analysis of gene expression time-series   <cit>  which offers fast computations through exact equations of bayesian inference, but makes a considerable number of prior biological assumptions to accomplish this .

gene expression analysis with gaussian processes
gaussian processes  <cit>  offer an easy to implement approach to quantifying the true signal and noise embedded in a gene expression time-series, and thus allow us to rank the differential expression of the gene profile. a gaussian process is the natural generalisation of a multivariate gaussian distribution to a gaussian distribution over a specific family of functions -- a family defined by a covariance function or kernel, i.e. a metric of similarity between data-points .

in the context of expression trajectory estimation, a gaussian process coupled with the squared-exponential covariance function  -- a standard covariance function used in regression tasks -- makes the reasonable assumption that the underlying true signal in a profile is a smooth function  <cit> , i.e. a function with an infinite degree of differentiability. this property endows the gp with a large degree of flexibility in capturing the underlying signals without imposing strong modeling assumptions  but may also erroneously pick up spurious patterns  should the time-course profiles suffer from temporal aggregation. from a generative viewpoint, the profiles are assumed to have been corrupted by additive white gaussian noise. this property makes the gp an attractive tool for bootstrapping simulated biological replicates  <cit> .

in a different context, gaussian process priors have been used for modeling transcriptional regulation. for example in  <cit> , while using the time-course expression of a-priori known direct targets  of a transcription-factor, the authors went one step further and inferred the concentration rates of the transcription-factor protein itself and  <cit>  extended the same model for the case of regulatory repression. the ever-lingering issue of outliers in time series is still critical, but is not addressed here as there is significant literature on this issue in the context of gp regression, which is complementary to this work.

for example  <cit>  developed a probabilistic model using gaussian processes with a robust noise model specialised for two-sample testing to detect intervals of differential expression, whereas the present work optionally focuses on one-sample testing, to rank the differential expression and ultimately detect quiet/active genes. other examples can also be easily applied;  <cit>  use a student-t distribution as the robust noise model in the regression framework along with variational approximations to make inference tractable, and  <cit>  employ a student-t observation model with laplace approximations for inference. the standard gp regression framework is straightforward to use here with a limited need for manual tweaking of a few hyper-parameters. we describe the gp framework, as used here for regression, in more detail in the methods section.

RESULTS
we apply standard gaussian process  regression and the bayesian hierarchical model for the analysis of time-series  on two in-silico datasets simulated by bats and gps, and on one experimental dataset coming from a study on primary mouse keratinocytes with an induced activation of the trp <dig> transcription factor, for which a reverse-engineering algorithm was developed  to infer the direct targets of trp <dig>  <cit> .

we assume that each gene expression profile can be categorized as either quiet or differentially expressed. we consider algorithms that provide a rank ordering of the profiles according to which is most likely to be non-quiet . given ground truth we can then evaluate the quality of such a ranking and compare different algorithms. we make use of receiver operating characteristic curves  to evaluate the algorithms. these curves plot the false positive rate on the horizontal axis, versus the true positive rate on the vertical axis; i.e. the percentage of the total negatives  erroneously classified as positives  versus the percentage of the total positives correctly classified as positives.

from the output of each model a ranking of differential expression is produced and assessed with roc curves to quantify how well in accordance to each of the three ground truths  the method performs. the bats model can employ three different noise models, where the marginal distribution of the error is assumed to be either gaussian, student-t or double exponential respectively. for the following comparisons we plot four roc curves, one for each noise model of bats and one for the gp. we demonstrate that the ranking of the gp framework outperforms that of bats with respect to the tsni ranking on the experimental data and on gp-sampled profiles.

simulated data
the first set of in-silico profiles are simulated by the bats software http://www.na.iac.cnr.it/bats/ in accordance to the guidelines given in  <cit> . in bats  <cit>  each time-course profile is assumed to be generated by a function expanded in an orthonormal basis  plus noise. the number of bases and their coefficients, are estimated with analytic computations in a fully bayesian manner. thus the global estimand for every gene expression trajectory is the linear combination of some number of bases whose coefficients are estimated by a posterior distribution. in addition, the bats framework allows various types of non-gaussian noise models.

bats simulation
we reproduce one instantiation of the simulations performed in  <cit> ; specifically, three sets of n =  <dig> profiles, of n =  <dig> timepoints and  replicates, for i = 1; ..., n, j =  <dig>  ..., n except  according to the model defined in . in each of the three sets of profiles,  <dig> out of  <dig> are randomly chosen to be differentially expressed  and simulated as a sum of an orthonormal basis of legendre polynomials with additive i.i.d. noise.

the other  <dig> non-differentially expressed profiles  are essentially zero functions with additive i.i.d. noise. the three simulated datasets are induced with different kinds of i.i.d. noise; respectively, gaussian n, student-t distributed with 5) and  <dig> ) degrees of freedom. figure  <dig> illustrates the comparison on the bats-sampled data with all three kinds of induced noise.

gp simulation
in a similar setup, the second in-silico dataset consists of  <dig> profiles sampled from gaussian processes, with the same number of replicates and time-points, among which  <dig> were setup as differentially expressed. to generate a differentially expressed profile, each of the hyperparameters of the rbf covariance function, namely the characteristic lengthscale, signal variance and noise variance  is sampled from separate gamma distributions. the three gamma distributions are fitted to sets of their corresponding hyperparameters, which are observed for the true positive profiles under a near zero fpr during the first test on bats-generated profiles. in this way, we attempt to resemble the behaviour of the bats-sampled profiles. table  <dig> lists the parameters of the three fitted gamma distributions.

sampled
rbf-
these are the parameters of the gamma distributions from which we sample the rbf- hyperparameters. for example, the characteristic lengthscale is sampled from a gamma with scale  <dig>  and shape  <dig> . the hyperparameters are then used in the rbf covariance function to sample/simulate a profile from the gaussian process.

the other  <dig> non-differentially expressed profiles are simply zero functions with additive white gaussian noise of variance equal to the sum of two samples from the gamma distribution for the signal variance and the noise variance. this addition serves to create a non-differentiated profile of comparative scale to the differentiated ones, but nonetheless of completely random nature. figure  <dig> illustrates the comparison on the gp-sampled data.

experimental data
we apply the standard gp regression framework and bats on an experimental dataset coming from a study on primary mouse keratinocytes with an induced activation of the trp <dig> transcription factor , where a reverse-engineering algorithm was developed  to infer the direct targets of trp <dig>  <cit> . in that study,  <dig> out of  <dig> gene reporters were chosen based on the area under their curves, and ranked by tsni according to the probability of belonging to direct targets of trp <dig>  the ranking list was published in a supplementary file available for download

 and used here as a noisy ground truth. we pre-process the data with the robust multi-array average  expression measure  <cit> , implemented in the "affy" r-package.

we label the top  <dig> position of the tsni ranking as "1" in the ground truth as they are the most likely to be direct targets of the trp <dig> transcription factor and because the binding scores  are most densely distributed amongst the first  <dig> positions, see figure  <dig>  furthermore, in  <cit>  these  <dig> positions were further validated by gene set enrichment analysis   <cit>  to check if their up/down regulation patterns were correlated to genes that respond to trp <dig> knock-downs in general. in summary, "the top  <dig> tsni ranked transcripts are significantly enriched for the strongest binding sites"  <cit> . figure  <dig> illustrates the comparison on the experimental data.

discussion
on bats-sampled data, figure  <dig>  we observe that the change in the induced noise is barely noticeable in regards to the performances of both methods and that bats maintains its stable supremacy over the gp framework. this performance gap is partially due to the lack of a robust noise model for the gp . furthermore, there is a modeling bias in the underlying functions of the simulated profiles, which contain a finite small degree of differentiability . this puts the gp in a disadvantaged position as it models for  infinitely differentiable functions when its covariance function is a squared exponential. consequently, for this simulated dataset the gp is more susceptible to capturing spurious patterns as they are more likely to lie within its modeling range, whereas for bats modeling the polynomials with a limited degree acts as a safeguard against spurious patterns, most of which vary rapidly in time.

on gp-sampled data, figure  <dig>  we observe the reversal of the performance gap in favor of the gp framework while its performance is almost unaffected. the gp is still prone to non-differentially expressed profiles with spurious patterns and differentially expressed profiles with excessive noise. however, the limited polynomial degree of bats proves to be inadequate for many of the gp-sampled functions and the two bats variants with robust noise models  only alleviate the problem slightly. in figure  <dig> we observe the gp outperforming the gaussian noise variant of bats  by a similar degree as in figure  <dig>  the experimental data are much more complex and apparently the robust bats variants now offer no increase in performance. since the ground truth focuses on the  <dig> most differentially expressed genes with respect to the induction of the trp <dig> transcription factor, then these results indicate that the gp method of ranking presented here indeed highlights differentially expressed genes and that it naturally features an attractive degree of robustness against different kinds of noise.

CONCLUSIONS
we presented an approach to estimating the continuous trajectory of gene expression time-series from microarray data through gaussian process  regression and ranking the differential expression of each profile via a log-ratio of marginal likelihoods of two gps, each one representing the hypothesis of differential and non-differential expression respectively. we compared our method to a recent bayesian hierarchical model  via roc curves on data simulated by bats and gps and experimental data. each evaluation was made on the basis of matched percentages to a ground truth - a binary vector which labeled the profiles in a dataset as differentially expressed or not. the experimental data were taken from a previous study on primary mouse keratinocytes and the top  <dig> genes of its ranking were used here as the noisy ground truth for the purposes of assessment. the gp framework significantly outperformed bats on experimental and gp-sampled data and the results showed that standard gp regression can be regarded as a serious competitor in evaluating the continuous trajectories of gene expression and ranking its differential expression.

this ranking scheme presented here is reminiscent of the work in  <cit>  on two-sample data , where the two competing hypotheses are represented in a graphical model of two different generative models connected with a gating scheme; one where the two profiles of the gene reporter are assumed to be generated by two different gps, and thus the gene is differentially expressed across the two treatments, and one where the two profiles are assumed to be generated by the same gp, and thus the gene is non-differentially expressed. the gating network serves to switch between the two generative models, in time, to detect intervals of differential expression and thus allow biologists to draw conclusions about the propagation of a perturbation in a gene regulatory network. instead, the issue presented in this paper is more basic and so is the methodology to deal with it. however, we note that the robust mechanisms against outliers used in  <cit>  are complementary to this work and one should not hesitate to incorporate one into a framework similar to ours. practicalities aside, this paper also introduces additional proof that gaussian processes, naturally and without much engineering, fit to the analysis of gene expression time-series and that simplicity can still be preferred over the ever-increasing -- but sometimes necessary -- complexity of hierarchical bayesian frameworks.

future work
a natural next step would be to add a robust noise mechanism in our framework. in this regard, fine examples can be found in  <cit> . finally, an interesting biological question is about the potential periodicity of the underlying signal in a gene expression profile. in this regard a different of kind stationary covariance function, the periodic covariance function  <cit> , can fit a time-series generated by an periodic process and thus its lengthscale hyperparameter can be interpreted as its cycle.

