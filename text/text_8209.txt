BACKGROUND
the computational recognition of short signal sequences in genomic dna is one of the prevalent tasks in bioinformatics. it includes e.g. the recognition of transcription factor binding sites   <cit> , donor or acceptor splice sites  <cit> , nucleosome binding sites  <cit> , or binding sites of insulators like ctcf  <cit> . many different algorithms have been developed for the recognition of such dna binding sites, with specific strengths and weaknesses, but none of them is perfect. hence, great efforts have been made over the last decade to evaluate and compare the performance of different algorithms  <cit> . the results of such comparative studies are often influential to the direction of future research, because they lead to new and superior approaches by combining the advantages of existing algorithms and because they provide a deeper understanding of the mechanisms of protein-dna interaction. the approaches compared typically differ by  the statistical model employed at the heart of these algorithms,  the learning principle chosen for estimating the model parameters, and  the prior used for the parameters of the model, and it is non-trivial to keep the influences of these different contributions apart. the first two aspects focus on developing improved statistical models or learning principles, while the choice of the prior is often arbitrary or determined by conjugacy. however, the choice of the prior may have a decisive effect on the recognition performance  <cit> . the goal of this paper is to derive a common prior for markov random fields  and mixtures of mrfs, which are at the heart of many existing algorithms for binding site recognition, allowing an unbiased comparison of different learning principles for models from this model family.

many computer algorithms available today use statistical models for representing the distribution of sequences, and many of these statistical models are special cases of mrfs  <cit> . these models range from simple models like the position weight matrix  model  <cit> , the weight array matrix  model  <cit> , or markov models of higher order  <cit>  to more complex models like moral bayesian networks  <cit>  or general mrfs  <cit> . hence, we restrict our attention to statistical models from the family of mrfs in this paper.

one of the first learning principles used in bioinformatics is the maximum likelihood  principle. however, for many applications, the sequence data available for learning statistical models is very limited. this is especially true for the recognition of tfbss, where typical data sets contain sometimes as few as  <dig> and seldom more than  <dig> sequences. for this reason, the ml principle often leads to suboptimal classification performance e.g. due to zero-occurrences of some nucleotides or oligonucleotides in the training data sets. the maximum a-posteriori  principle, which applies a prior to the parameters of the models, establishes a theoretical foundation to alleviate this problem and at the same time allows for the inclusion of prior knowledge aside from the training data.

recently, the application of discriminative principles instead of generative ones has been shown to be promising in the field of bioinformatics  <cit> . generative learning principles aim at an accurate representation of the distribution of the training data, whereas discriminative learning principles aim at an accurate classification of the training data. the discriminative analogue to the ml principle is the maximum conditional likelihood  principle, which has been widely used in the machine learning community  <cit> . however, the effects of limited data may be even more severe when using the mcl principle compared to generative learning principles  <cit> . to overcome this problem, the maximum supervised posterior  principle  <cit>  has been proposed as discriminative analogue to the map principle.

many different priors have been used in the past, and their choice seems arbitrary or motivated by technical aspects. product-gaussian and product-laplace priors are widely used for generatively trained mrfs  <cit>  and discriminatively trained mrfs also called conditional random fields  <cit> . for the generative map learning of markov models and bayesian networks, the most prevalent prior is the product-dirichlet prior, whereas for the discriminative msp learning, either a product-gaussian or product-laplace prior is typically employed  <cit> . hence, when comparing generatively and discriminatively trained markov models, bayesian networks, and mrfs, in many occasions apples are compared to oranges by using different priors.

the comparison of generative and discriminative learning principles is the topic of several recent studies. ng & jordan  <cit>  compare generatively and discriminatively trained pwm models. to be specific, they compare the bayesian map principle with the non-bayesian mcl principle. pernkopf & bilmes  <cit>  compare the ml principle to the mcl principle for estimating the parameters of bayesian networks, while the structures of the networks are estimated by generative as well as discriminative measures. greiner et al.  <cit>  compare the ml principle with a variant of the mcl principle that prevents over-fitting, and they apply these approaches to bayesian networks. grau et al.  <cit>  compare the map principle for markov models using a product-dirichlet prior to the msp principle using product-gaussian and product-laplace priors.

all of these studies use different priors when comparing different learning principles, rendering the conclusions regarding the superiority of one learning principle over the other questionable, because the differing influences of these priors are neglected. in fact, we are not aware of any study that uses the same a-priori information when comparing generative to discriminative learning principles.

motivated by this lack of consistency, we aim at establishing a prior that

i) can be used for the generative  and the discriminative  principles,

ii) is conjugate to the likelihood of mrfs, which include moral bayesian networks,

iii) contains the widely-used product-dirichlet prior as special case when the structure of the mrf is equivalent to that of a moral bayesian network including all of its special cases such as pwm models, wam models, markov models of higher order, or bayesian trees.

in section methods, we present the derivation of such a prior, which is the main result of this paper. with such a prior at hand, it becomes possible to accomplish an unbiased comparison of generative and discriminative learning principles applied to the same model using the same prior. in addition, this prior allows a comparison of different generatively trained models for binding site recognition that are special cases of mrfs including pwm models, wam models, markov models of higher order, bayesian trees, or moral bayesian networks as well as a comparison of different discriminatively trained models that are special cases of mrfs using the bdeu prior  <cit> . in section results and discussion, we illustrate the applicability of the derived prior using two typical data sets of tfbss and donor splice sites.

methods
we denote by x=  a sequence of length l over an alphabet Σ = { <dig>   <dig>  ..., s} with xℓ ∈ Σ, where s =  <dig> in case of dna and rna sequences, and s =  <dig> in case of protein sequences. we denote by c ∈  = { <dig>   <dig>  ..., c} the class of a sequence. in this paper, we consider two-class problems, i.e., c =  <dig>  and we denote the first class containing biological binding sites by foreground, and the second class containing decoy dna sequences by background. for each sequence xn in the training data set, we know its correct class label cn ∈ . we denote the data set of all sequences by  =  and we denote the vector of the corresponding class labels by c= .

in this paper, we consider two bayesian learning principles, namely the generative maximum a-posteriori  principle and the discriminative maximum supervised posterior  principle. the goal of both learning principles is to estimate the optimal parameters of some statistical model with respect to the posterior or supervised posterior, respectively.

using the map principle, the parameters ϑ are optimized with respect to the posterior, which is proportional to the product of a parameter prior h  given hyper-parameters α and the likelihood p of the data set  and the class labels cgiven parameters ϑ:   

under the assumption of independent and identically distributed  data, we obtain   

using the assumption of i.i.d. sequences and the assumption of independence of the parameters of the classes, generative learning principles, as for instance the map principle, can be simplified to class-specific generative learning principles that allow inferring the parameters of the foreground and background class separately. for several simple models like markov models, generative learning principles amount to computing smoothed relative frequencies of nucleotides and oligonucleotides  <cit> .

for the msp principle, the parameters ϑare optimized with respect to the supervised posterior, which is defined as the product of a parameter prior h given hyper-parameters αand the conditional likelihood p  of the class labels cgiven the data set  and parameters ϑ:   

we again assume i.i.d. data and express the class posteriors p  in terms of likelihoods p , yielding   

while the generative ml and map principles often lead to analytic solutions for simple models such as markov models, we must use numerical optimization procedures  <cit>  for the discriminative mcl and msp principles.

in practical applications, the parameterization ϑof the models and the priors h differ between the map and the msp principle, since both learning principles evolved from different theoretical backgrounds. with the goal of resolving these differences, we present a common parameterization for the likelihood of all models from the class of mrfs, which can be used for the map and the msp principle, and we derive a prior for this parameterization that is equivalent to the well-known product-dirichlet prior in the remainder of this section.

foundations of moral bayesian networks
graphical models, which combine probability theory and graph theory, are statistical models in which random variables are represented by nodes of a graph and in which the dependency structure of the joint probability distribution is represented by edges  <cit> . graphical models can be categorized into directed acyclic graphical models called bayesian networks and undirected graphical models called mrfs with a non-empty intersection called moral bayesian networks  <cit> . for deriving the desired prior, we start with moral bayesian networks in this subsection, where we give an introduction to moral bayesian networks, and in the second subsection we present the mrf parameterization for these models. in the third subsection, we present the widely-used product-dirichlet prior for moral bayesian networks, and transform this prior to the mrf parameterization. finally, we extend the resulting prior for moral bayesian networks to the case of general mrfs in the last subsection.

graphical models are represented by graphs consisting of nodes and edges. the nodes in the graph represent random variables xℓ having realizations denoted by xℓ. in case of directed graphical models, the edges are directed from the parent nodes to their children. we denote by pa the vector of parents of node ℓ representing random variable xℓ, and we denote by pa the realizations of the parents pa in sequence x. edges between nodes represent potential statistical dependencies between the random variables, while missing edges between nodes represent conditional independencies of the associated random variables given their parents. specifically, if there is no edge from i to j, then xi and xj are conditionally independent given pa and pa, the parents of node i and j. for bayesian networks the underlying graph structure is a directed acyclic graph . in this paper, we consider models with a given graph structure, such that all parents of each node are pre-determined. to simplify notation in the following derivation, we assume the same graph structure for the models of all classes. the extensions to models with different graph structures and to position-dependent alphabets is straightforward.

a bayesian network is called a moral bayesian network iff its dag is moral. a dag is called moral iff, for each node ℓ, each pair , p <dig> ≠ p <dig>  of its parents is connected by an edge  <cit> . the family of moral bayesian networks contains popular models such as pwm models, wam models, markov models of higher order, and bayesian trees. when considering the parents pa of a node ℓ in a moral bayesian network, we can order the nodes in pa uniquely according to the topological ordering within the set pa.

with these prerequisites, we present the likelihood of a moral bayesian network in a parameterization that is often used for the map principle. in the following, we denote these parameters by θcompared to ϑ in equation . the likelihood pθ of a moral bayesian network with parameters θis defined by   

where θc denotes the probability of class c, and  denotes the probability of observing xℓ at xℓ in class c given the observations pa at the random variables represented by the nodes pa  <cit> . the following constraints together with the non-negativity of the θ-parameters ensure that subsets of the components of θ remain on simplices:  

with c ∈ , ℓ ∈ , and a∈ Σ|pa| being a possible observation at the random variables represented by pa and, hence, corresponding to pa for a specific sequence x.

it follows from these constraints that not all parameters of θ are free: if the values of θ <dig>  θ <dig>  ..., θc- <dig> are given, the value of θc is determined, and if the values of θc, ℓ,  <dig>  a, θc, ℓ,  <dig>  a, ..., θc, ℓ, s- <dig>  a are given, the value of θc, ℓ, s, a is determined.

mrf parametrization of moral bayesian networks
while generative learning of parameters can be performed analytically for many statistical models, no analytical solution is known for most of the popular models in case of the mcl or the msp principle. hence, we must resort to numerical optimization techniques like conjugate gradients or second-order methods  <cit> . unfortunately, the parameterization of directed graphical models in terms of θ causes two problems in case of numerical optimization: first, the limited domain, which is  <cit>  for probabilities, must be assured, e.g., by barrier methods; second, neither the conditional likelihood  nor its logarithm are concave functions of θ, so numerical optimization procedures may get trapped in local maxima or saddle points  <cit> . hence, the likelihood of moral bayesian networks is often defined in an alternative parameterization. we denote these parameters by λwhich replaces ϑ in equation . this parameterization is closely related to the natural parameters of mrfs  <cit>  yielding the likelihood   

where z  denotes a normalization constant defined as the sum over all possible classes c ∈  and all possible sequences x ∈ Σl of the numerator:   

similar to the θ-parameters, there is one parameter λc ∈ ℝ for each class c ∈ , and one parameter  ∈ ℝ for each class c and each symbol b at xℓ given the observation a at random variables represented by the nodes pa. in contrast to θ, however, these parameters cannot be interpreted directly as probabilities.

as for the θ-parameters, not all parameters of λ are free. in case of λ-parameters, we may fix one of the parameters in each subset, i.e., one of the λc and one of the λc, ℓ, b, a for each c ∈ , ℓ ∈ , and a∈ Σ|pa| to a constant value without reducing the codomain of pλ , resulting in the same number of free parameters for θand λ. we choose to fix the last parameter in each subset arbitrarily to  <dig>  i.e.,  

in order to show that equations  and  are equivalent, we need a bijective mapping from θto λ. the mapping from θto λis defined by  <cit>   

with c ∈  and

c ∈ , ℓ ∈ , b ∈ , a∈ Σ|pa|, respectively.  the mapping t from λto θis less trivial. we denote by c := θc the component of tdefining θc, and we denote by c, ℓ, b, a:= θc, ℓ, b, athe component of tdefining θc, ℓ, b, a. then, we obtain tby marginalization of :   

and   

where zc  and zc, ℓ, b, a are two partial normalisation constants defined in appendix a of additional file  <dig> 

prior for moral bayesian networks
for bayesian learning principles  and ), we must to specify a prior on the parameters of the model. one conjugate prior hθ  for the likelihood of directed graphical models and their specializations is the product-dirichlet prior  <cit> . the product-dirichlet prior assumes parameter independence and amounts to a product of independent dirichlet densities:   

where θc := , αc := , θc, ℓ, a:= , αc, ℓ, a:= , and   

where ϕ= , and ϕi stands for θc or θc, ℓ, b, a.

we use hyper-parameters αthat satisfy the consistency condition  <cit> , which introduces the following constraints on the hyper-parameters α. we assume that there are joint hyper-parameters αc, xwith x∈ Σl and c ∈  such that for all ℓ ∈ , for all b ∈ Σ, and for all a∈ Σ|pa|   

and   

where the kronecker symbol δ is  <dig> if both indices are equal and  <dig> otherwise. these constraints ensure that the hyper-parameters αof the product-dirichlet prior can be interpreted as, possibly real-valued, counts stemming from a set of a-priorily observed pseudo-data. the size of the set of pseudo-data is commonly referred to as equivalent sample size  <cit> , and we denote the equivalent sample size of class c by αc. hence, a, product-dirichlet prior allows an intuitive and easily-interpretable choice of hyper-parameters, in contrast to product-gaussian or product-laplace priors.

our first goal is to derive a prior for λwhich is equivalent to the commonly-used product-dirichlet prior for θin equation . to this end, we use the transformation tfrom λto θto transform the product-dirichlet prior hθ  to the desired prior,   

where det ) denotes the jacobian of t. we derive the jacobian in appendix b of additional file  <dig> by exploiting independencies between parameters of the model,   

and obtain a general transformed dirichlet prior .

if all hyper-parameters are chosen to satisfy the consistency condition, many normalization constants cancel, and we obtain a simplified expression of the transformed dirichlet prior,   

where α := Σc αc.

since the commonly-used product-dirichlet prior for θdefined in equation  is conjugate to the likelihood defined in equation , the transformed prior of equation  is also conjugate to the likelihood defined in equation . while in earlier comparisons of different learning principles for the same moral bayesian network, different priors have been employed, we are now capable of using the same prior as defined in equation  for the map and the msp principle. employing this prior, we can compare the classification accuracy of two classifiers based on the same model, but trained either by the map or the msp principle, using the same prior, avoiding a potential bias induced by differing priors.

choice of hyper-parameters
in contrast to the comparison of the map and the msp principle for the same model, the derived prior cannot be used for an unbiased comparison of different models without further premises, since different models typically use different parameters of potentially different dimension, inevitably leading to different priors for these models. one reasonable requirement for the comparison of models with different graph structures is likelihood equivalence  <cit> , stating that models with different graph structures representing the same likelihood, also obtain the same marginal likelihood of the data given graph structure and hyper-parameters or, equivalently, that the values of the prior density on the parameters of such models must be equal for equivalent parameter values. examples for different graph structures representing the same likelihood are left-to-right and right-to-left markov models or differently rooted bayesian trees with the same undirected graph structure.

heckerman et al.  <cit>  show that this property is satisfied only by the bde metric, which corresponds to the consistency condition presented above. this condition also entails that the hyper-parameters used for the priors of these models can be derived from a common set of pseudo-data. however, the consistency criterion does not determine how a specific set of pseudo-data should be chosen in order to minimize the bias imposed on the comparison, and different choices may favor different models in one way or the other. for example, a comparison of different models can be easily biased if the set of pseudo-data contains statistical dependencies that can be exploited by some but not by all models, as for instance dinucleotide dependencies that can be captured by a wam model but not by a pwm model.

the bdeu metric  <cit>  is a special case of the bde metric and a popular choice for structure learning and model selection for bayesian networks  <cit>  or bayesian trees and mixtures thereof  <cit> . it imposes additional constraints on the hyper-parameters, which can be described as follows: building on the consistency condition for the product-dirichlet prior, the specific hyper-parameters for the priors of different models represent identical sets of pseudo-data. the hyper-parameters, which represent the a-priori information, are defined based on a set of pseudo-data in which all possible sequences x∈ Σl occur with equal probability  <cit> . despite the general assumption of uniform pseudo-data, the equivalent sample size may differ between the different classes c ∈ , representing a-priori class-probabilities. using the concept of joint hyper-parameters introduced for the consistency condition in the previous subsection, this a-priori information implies that for each class c the joint hyper-parameters αc, x are identical for each x. for this reason, we derive from equation   

which implies the following values of the hyper-parameters αc,ℓ,b, afor the model parameters λc,ℓ,b, a  

where |pa | is the number of parents pa of node ℓ, c ∈ , ℓ ∈ , b ∈ Σ, and a ∈ Σ|pa|.

consider the example that the equivalent sample size for class c is αc =  <dig> and that the data of each class is modeled either by a pwm or by a wam model. the pwm model has parameters λc, ℓ, b, ℓ ∈ , b ∈ Σ, while the wam model has parameters , b ∈ Σ and , ℓ ∈ , b, a ∈ Σ. in case of the dna alphabet, the bdeu metric determines the hyper-parameters for the pwm model to be αc, ℓ, b =  <dig>  while it determines the hyper-parameters for the wam model to be  =  <dig> and  =  <dig>  with this choice of hyper-parameters, both product-dirichlet priors represent the same set of pseudo-data. the hyper-parameters αc, ℓ, b of the pwm model correspond to pseudo-counts of mono-nucleotides b, while the hyper-parameters  of the wam model correspond to conditional pseudo-counts of nucleotides b given nucleotide a observed at the previous position ℓ -  <dig>  this result does equally hold for all specializations of mrfs considered in this paper, and we choose the hyper-parameters accordingly throughout the case studies.

markov random fields
the prior of equation  allows an unbiased comparison of different learning principles including the generative map principle and the discriminative msp principle for different models from the family of moral bayesian networks including pwm models, wam models, markov models of higher order, or bayesian trees. however, several important models proposed for the recognition of short signal sequences do not belong to this family. hence, we now focus on the main goal of deriving a prior for the family of mrfs, which contains the family of moral bayesian networks as special case.

mrfs are undirected graphical models, i.e., the underlying graph structure is an undirected graph. again, edges between nodes model potential statistical dependencies between the random variables represented by these nodes, while the absence of edges between nodes represents conditional independencies of the associated random variables given their neighboring nodes. the likelihood of an mrf in terms of λ-parameters is given by   

where ic denotes the number of λ-parameters conditional on class c, and fc, i ∈ { <dig>  1} denotes the indicator function of λc, i  <cit> . these indicator functions determine the undirected graph structure.

for illustration purposes, we rewrite the likelihood of a pwm in analogy to the mrf likelihood, for which the set of parents of all nodes are empty. hence, we omit the vector of parents when rewriting the likelihood of equation  in terms of kronecker symbols δ,   

renaming the parameters in terms of λc, i and defining the indicator functions fc, i as corresponding kronecker symbols, we obtain the likelihood in form of equation .

using the conformity of equations  and , we can now suggest a prior for mrfs in analogy to equation ,   

that contains the transformed dirichlet prior of equation  as special case if the mrf of each class belongs to the family of moral bayesian networks. examining the likelihood of equation , we find that the prior of equation  is conjugate to the likelihood of mrfs. additionally, it is equivalent to the conjugate prior of the exponential family  <cit>  for the studied family of models.

we illustrate the prior of equation  for one and two free parameters in figure  <dig> for different values of the hyper-parameters αi. in figure 1a, we compare the derived prior to the gaussian prior and the laplace prior for one free parameter λ <dig>  for illustration purposes, we choose the hyper-parameters of the gaussian and laplace prior such that their maxima are identical to that of the derived prior. we find that the derived prior provides an interesting interpolation between a gaussian prior and a laplace prior. in the vicinity of the maximum, the logarithm of the derived prior shows a quadratic dependence on λ <dig>  whereas it shows a linear dependence on λ <dig> in the far tails. that is, the derived prior is similar to a gaussian prior in the vicinity of the maximum and similar to a laplace prior in the far tails.

in figure 1b, we show the derived prior for two free parameters λ <dig> and λ <dig>  interestingly, the derived prior exhibits a mirror symmetry about the plane λ <dig> = λ <dig>  which can be explained by the choice of equal hyper-parameters α <dig> = α <dig>  in contrast to the product-gaussian and the product-laplace prior, we do not find a radial symmetry, which can be explained by the fixed parameter λ <dig> =  <dig> 

summarizing the main result of this section, we propose a prior for mrfs that

i) can be used for the generative map and the discriminative msp principle,

ii) is conjugate to the likelihood of mrfs and, hence, also to the likelihoods of many popular models used for the recognition of short sequence motifs,

iii) includes the commonly-used product-dirichlet prior of equation  as special case if the mrf belongs to the family of moral bayesian networks including pwm models, wam models, markov models of higher order, or bayesian trees, and

iv) allows to incorporate prior knowledge intuitively by defining a set of a-priorily observed pseudo-data.

hence, it can be employed in comparative studies of generative and discriminative learning principles applied to the same family of models, and of different, generatively or discriminatively trained models. additionally, the derived prior can be readily extended to mixtures of models from the family of mrfs. in the next section, we illustrate the utility of the derived prior.

RESULTS
in this section, we present two case studies that illustrate how the derived prior can be used for an unbiased comparison of different learning principles for different models related to two standard problems in bioinformatics.

in case study  <dig>  we illustrate the comparison of different learning principles for the recognition of tfbss using the same models and the same priors. specifically, we investigate the influence of different sizes of data sets on the performance of generatively and discriminatively trained models in close analogy to the pioneering study of ng & jordan  <cit> . possibly due to the lack of a common prior that could be used for both the generative and the discriminative learning, ng & jordan compare the generative bayesian approach of parameter estimation  to the discriminative non-bayesian approach of parameter estimation . based on the derived prior, it is now possible to compare the two bayesian learning principles directly using exactly the same prior in both cases. in case of tfbss, the number of available training sequences is small, typically ranging from only  <dig> to at most  <dig> sequences. hence, available algorithms for the recognition of tfbss are far from being perfect, and unbiased comparisons of different learning principles for data sets of this size are of fundamental importance for any further advance on this field.

in case study  <dig>  we illustrate the comparison of different learning principles with different models for the recognition of human donor splice sites using the same a-priori information. donor splice sites exhibit non-adjacent dependencies  <cit> . hence, it seems worthwhile to employ mrfs for this task, as they are capable of capturing dependencies between all pairs of positions in a sequence  <cit> . however, different subclasses of donor splice sites exist  <cit> , so the use of mixtures of mrfs may be favourable. donor splice sites are highly conserved so that for some pairs of positions some of the  <dig> possible pairs of nucleotides do not occur. these non-occurrences cause numerical problems when using the ml or mcl principle, but one may adopt a bayesian approach to circumvent these problems. interestingly, mixtures of mrfs have not been employed in the past for the classification of donor splice sites, possibly because of the lack of a suitable prior. the derived prior now provides an opportunity to investigate if mixtures of mrfs might be useful for the recognition of splice sites. we compare mixtures of mrfs to single mrfs, mixtures of markov models, and single markov models using the map and the msp principle, and we investigate which of these two learning principles may be worthwhile for the recognition of splice sites.

the focus of the case studies presented is not on the identification of the most appropriate model class or learning principle for the recognition problem scrutinized, although undoubtedly this is a welcome side-effect, but primarily we aim at illustrating the benefit of the derived prior for unbiased comparative studies in bioinformatics.

case study 1: discriminative vs. generative parameter estimation
in case study  <dig>  we illustrate a comparison of generatively trained and discriminatively trained markov models of different orders using the derived prior. we choose the data set of  <cit>  containing  <dig> aligned binding sites, each of length  <dig> bp, of the mammalian transcription factor sp <dig> as foreground data set and  <dig> second exons of human genes, which have different lengths and are cut into 100-mers for this study, with a total size of approximately  <dig> kb as background data set. we use a pwm model as foreground model and markov models of order  <dig> as background model. results for all other combinations of a markov model of orders  <dig> or  <dig> as foreground model and markov models of orders  <dig> to  <dig> as background model are available in additional file  <dig>  these models are trained by the map principle and by the msp principle using the same priors and the same hyper-parameters for both cases. we choose for both cases and all model combinations an equivalent sample size of  <dig> for the foreground model and an equivalent sample size of  <dig> for the background model.

we use a stratified holdout sampling procedure for the comparison of the classification performance of the resulting classifiers. in each iteration of the stratified holdout sampling procedure, we randomly partition both the foreground data set and the background data set into a preliminary training data set comprising 90% of the sequences and a test data set comprising the remaining 10% of the sequences. in order to vary the size of the training data set, we use an additional sampling step, where we randomly draw a given fraction of the preliminary training data sets ranging from 5% to 100% yielding the final training data sets. we train all classifiers corresponding to different learning principles and different model combinations on the same subsets of the preliminary training data sets, and we use the resulting classifiers to classify the same sequences in the test data sets.

we evaluate the classification performance on the test data sets using as performance measures the false positive rate  for a fixed sensitivity of 95%, the sensitivity  for a fixed specificity of  <dig> %, the positive predictive value  for a fixed sensitivity of 95%, and the area under the precision recall curve   <cit> . we repeat the stratified holdout sampling procedure  <dig>   <dig> times, and report the means and standard errors of the four performance measures fpr, sn, ppv, and auc-pr for each classifier as the final result of the comparison. we present the results of the comparison for the combination of a pwm model in the foreground and a markov model of order  <dig> in the background in figure  <dig>  which shows the four performance measures sn, fpr, ppv, and auc-pr as functions of the relative size of the training data sets. corresponding results for other combinations of models show the same qualitative behaviour and are available in additional file  <dig> 

the classification performance increases rapidly with increasing size of the training data set and achieves its optimal value for the largest training data sets. for the largest training data set, the discriminatively trained classifier yields an fpr of  <dig> %, an sn of  <dig> %, a ppv of  <dig> %, and an auc-pr of  <dig> , whereas the generatively trained classifier yields only an fpr of  <dig> %, an sn of  <dig> %, a ppv of  <dig> %, and an auc-pr of  <dig> .

ng & jordan  <cit>  compare the classification performance of pwms trained by the map principle and the mcl principle on a number of data sets from the uci machine learning repository. they find that for large data sets the discriminative mcl principle has a lower asymptotic error, corresponding to a higher classification performance, but that the generative map principle yields a higher classification performance for small data sets. in contrast to those findings, we find a superior classification performance of the discriminatively compared to the generatively trained models irrespective of the size of the training data set. this result suggests that the choice of the same prior is advisable for an unbiased comparison of generative and discriminative learning principles and, moreover, that it might be worthwhile to re-evaluate the power of the msp principle for other applications in bioinformatics as well.

case study 2: mixtures of markov random fields
in this case study, we demonstrate a comparison of different learning principles using markov models, mixtures of markov models, mrfs, and mixtures of mrfs, and the derived prior. we choose a standard data set of human donor splice sites  and human non-donor splice sites  compiled by yeo & burge  <cit> . this data set is already partitioned into a foreground training data set , a background training data set , a foreground test data set , and a background test data set . we choose an inhomogeneous markov model of order  <dig>  and an mrf which models all pairwise dependencies  <cit>  as basic models. the mrf has  <dig> indicator functions each of the form   

where ℓ <dig>  ℓ <dig> ∈ , ℓ <dig> ≠ ℓ <dig>  and b <dig>  b <dig> ∈ Σ. based on these basic models, we build mixture models with two mms  and two such mrfs , and we compare those four classifiers that are based on a combination of the same kind of model for the foreground and for the background class. for all of these classifiers, we use the derived prior with an equivalent sample size of  <dig> for each of the four foreground models and an equivalent sample size of  <dig> for each of the four background models. we train each of these classifiers on the two training data sets using the map and the msp principle, and we evaluate their classification performance on the two test data sets. we use the same performance measures as in case study  <dig>  except that we replace sn by the the area under the receiver operating characteristic curve   <cit> , because auc-roc is more commonly used than sn for the classification of splice sites  <cit> .

we present the results of this comparison in figure  <dig>  which shows barplots of each of the four performance measures for each of the four classifiers and both learning principles. the results for the map principle are shown in figure  <dig>  we find that the two classifiers based on mixture models outperform the two corresponding classifiers based on single models with respect to all four performance measures. we also find that the two classifiers based on mrfs and mixmrfs yield a higher classification performance than the two corresponding classifier based on mms and mixmms. the classifier based on a mixture of mrfs yields the lowest fpr , the highest auc-roc , the highest ppv , and the highest auc-pr , stating that, among the four models tested, a mixmrf is the most appropriate model for classifying human donor splice sites and non-donor sites using the map principle.

in close analogy to figure  <dig>   shows the results using the msp principle. we find that discriminatively trained mixture models, i.e., mixmm and mixmrf, outperform the two corresponding classifiers based on the single mm and single mrf, and that the mixmm classifier is comparable or even better than the mrf classifier. the mixmrf classifier yields the best results for fpr  and ppv , while the mixmm classifier yields a higher auc-roc  and auc-pr  than the mixmrf classifier.

comparing figures  <dig> and  <dig>  we find that the four msp-trained models outperform the corresponding map-trained models. for instance, the mm classifier yields an ppv of  <dig> % for the msp principle and only  <dig> % for the map principle, and the mixmrf classifier yields a ppv of  <dig> % for the msp principle only  <dig> % for the map principle. interestingly, classifiers based on simple models  show the greatest improvement when replacing the map principle by the msp principle. this observation is in accordance with previous findings that discriminative learning seems to be advantageous over generative learning if the model assumption is wrong  <cit> .

CONCLUSIONS
the systematic comparison of different statistical models and different learning principles has been the focus of several studies of the last decade  <cit> . however, these comparisons lose value if different priors are used for different models or different learning principles, and it is questionable if the obtained results from such comparisons are meaningful at all.

in this paper, we derive a prior that allows an unbiased comparison of generative and discriminative learning principles for models from the family of mrfs including pwm models, wam models, markov models of higher order, bayesian trees, moral bayesian networks, and their mixtures as special cases. the derived prior is conjugate to the likelihood of mrfs and a generalization of the commonly-used product-dirichlet prior for moral bayesian networks. the derived prior provides an interesting interpolation between a product-gaussian prior and a product-laplace prior: it is qualitatively similar to a product-gaussian prior in the vicinity of the maximum and qualitatively similar to a product-laplace prior in the far tails. in contrast to a product-gaussian and a product-laplace prior, the hyper-parameters of the derived prior can be easily interpreted as counts stemming from pseudo-data, allowing an intuitive choice of these hyper-parameters.

we present two case studies using the derived prior for an unbiased comparison, and we find that discriminative parameter learning can be beneficial for sequence classification in the field of bioinformatics. on a set of mammalian tfbss, we find that it is possible to yield an improved classification performance by using the discriminative msp principle instead of the generative map principle even if the amount of available training data is small. by varying the size of the training data set, we find that discriminative parameter learning can improve the recognition of tfbss over generative parameter learning irrespective of the size of the training data set. this result differs from previous findings of ng & jordan  <cit> , who did a similar study comparing the generative bayesian map principle to the discriminative non-bayesian mcl principle. on a data set of donor splice sites  <cit> , we illustrate the utility of the proposed prior for comparing markov models, mixtures of markov models, mrfs, and mixtures of mrfs. for this data set, we find that the best classification performance can be achieved by a discriminatively trained mixture of mrfs.

the derived prior might be useful in future comparative studies as it provides a less-biased guidance to the understanding of molecular mechanisms, and it leads to further improvements of algorithms for the recognition of short signal sequences including splice sites, tfbss, nucleosome binding sites, mirna binding sites, transcription initiation sites, or insulator binding sites. hence, we make an implementation of this prior available to the scientific community as part of the open source java library jstacs http://www.jstacs.de.

list of abbreviations
map: maximum a-posteriori; mcl: maximum conditional likelihood; ml: maximum likelihood; mrf: markov random field; msp: maximum supervised posterior; pwm: position weight matrix; tfbs: transcription factor binding sites; wam: weight array matrix.

authors' contributions
ig and jk developed the basic idea. jk and jg derived the prior, implemented the software, and performed the case studies. all authors contributed to writing and approved the final manuscript.

supplementary material
additional file 1
appendices. this file contains more information about the partial normalization constants, the computation of the jacobian, and a general prior for moral bayesian networks.

click here for file

 additional file 2
results of the sp <dig> case study. this file contains all results of the sp <dig> case study including for all combinations of markov models. for the foreground class we use orders  <dig> or  <dig>  and for the background class we use orders  <dig> to  <dig> 

click here for file

 acknowledgements
we thank andré gohr, michael seifert, and marc strickert for helpful discussions and comments on the manuscript. this work was supported by grant xp3624hp/0606t by the ministry of culture of saxony-anhalt.
