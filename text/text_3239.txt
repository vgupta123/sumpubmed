BACKGROUND
cancer is a severe threat to human health. although there are many established methods for overcoming this disease, the high mortality caused by cancer is still a severe threat to human. meanwhile, the side-effects of many therapeutic methods greatly affect the quality of life of individuals and their families. uncertainty about the mechanisms of tumorigenesis greatly handicaps the creation and application of suitable therapeutic methods. tumorigenesis is a complex process, affected by both genetic factors and environmental conditions. there is evidence to suggest that developmental processes and tumorigenesis share some conserved mechanisms  <cit> . time-course microarray experiments have the advantage of allowing us to study the dynamics of gene regulation. time-course microarrays have recently been used to identify biological markers associated with disease and to examine the expression patterns of genes that are important in tumorigenesis and development  <cit> .

many models have been proposed to explain the process of tumorigenesis and its relationship to development. the "cancer attractor" model was first suggested by kauffman in the  <dig> s  <cit>  and can be used to explain how a gene regulation network  confers a single genome with the capacity to produce a diversity of stable, discretely distinct cell types over the process of development  <cit> . foster introduced a simplified differential equation described by huang  <cit>  into a model containing two genes. five hundred "cells" were stimulated to "differentiate", finally reaching the "stable attractors" position, demonstrating the validity of the "cancer attractor" model. there is a significant amount of evidence based on time-course microarray experiments which supports the attractor theory  <cit> . mar and quackenbush  <cit>  have recently decomposed cell fate transition into two processes: the core process that includes the main differentiation pathway, and a transient process that captures information from the environment and controls the core process.

cell state space is a high-dimensional space in which different cell types correspond to points or distributions  <cit> . in foster's work  <cit>  a system based on two genes generated 3-dimensional coordinates including two gene dimensions and one "quasi potential" dimension, however, that still exists some difficulties to explain the biological meaning of this "quasi potential" dimension.. since time is invariable and irreversible, sequentially ordered developmental progression is a very important innate characteristic of life. if we treat time as a scale for measuring cell state space, it is possible to describe the high-dimensional cell state space by a low-dimensional space.

many approaches, including pca and svd methods  <cit> , the bayesian models  <cit> , hmm  <cit> , and some anova and regression-based model  <cit>  have been applied for the analysis of time-course microarray data from different aspects. most of these methods are designed to detect genes which undergo significant changes and to classify expression patterns in time-course experiments. only few methods emphasize temporal order within experiments and time-course expression profiles.

here, in order to capture the temporal properties and describe the trajectories of development processes, we propose a new linear model, named the "time-ordered linear model", which draws on the idea that a co-bisector can represent the main tendency of a series of vectors. this co-bisector model has two main advantages: first, unlike present methods such as pca, the biological meaning of the co-bisector model is borne in mind in the design of the model. a co-bisector conserves the temporal properties of a series of vectors since they have order-restricted projection locations on the co-bisector. furthermore, our model preserves the spatial distance ratio between neighboring samples which have fixed locations in microarray space. our time-ordered linear model can be used as a measurement scale of gene expression variation in microarray space, thus creating a new application for time-course microarray data; estimating the expression pattern similarities between expression data from more than one source. in the present work, we apply our time-ordered linear model to estimate expression pattern similarities between different tumor tissues and their corresponding normal tissues in both mice and humans. our time-ordered linear model describe the trajectories of development process in a cell state space from the gene expression pattern perspective, thus helping us to improve our understanding of the relationships among different cell types in cell state space.

RESULTS
design the time-ordered linear model in the abstract cell state space
the concept of cell state space was proposed by kauffman <cit> . in high-dimensional cell state space, cell types with similar properties are grouped together. the dimensions of cell state space are measurements of cell properties such as snp, transcriptome, and epigenetic modification. the expression pattern of a cell is simply a reflection of its cell state. recently, the mouse and human genome dna methylation maps have been reported  <cit> . we believe that a fuller and more detailed description of cell state space will emerge as more and more high-throughput data are published. but the work presented here only focus on gene expression patterns, and we simplified the cell state space as a microarray space which dimensions are determined by genes.

since all cell activities are continuous, any cellular process can be represented as a continuous thread in abstract cell state space. in figure  <dig> the process of cell differentiation, from the pluripotent to the differentiated cell state, is described as a continuous track in abstract cell state space. when microarrays are used to describe the transcriptome, the expression pattern is projected from abstract cell state space to microarray space, and the continuum of cellular processes is retained and can be used to map cell differentiation in microarray space.

in cell differentiation microarray experiments, samples representing different cell differentiation stages i.e. different time points, are linked in order by a curve in microarray space. as a powerful approach, the pca method can easily draw the mathematical distribution of principal components of these points to maximize the sum of variance. in order to test the efficiency of description development trajectory by pca methods, we analyzed dataset gse <dig> which represents mouse fetal liver development. although some principal components  may preserve the sampling order , one hand, the biological meaning of these pcs can not be derived directly from the pca methods. some approaches, such as go annotation, were applied to obtain the biological meaning of these pcs from the biological function of significantly changed genes. on the other hand, under the condition that maximizes sum of variance, the projection distance ratio of neighbor points on pcs are different from real distance ratio in microarray space . for these two reasons, it is difficult to use the pca method to describe the trajectories of the development process.

since this curve is difficult to describe in high-dimensional space, we have to develop a time-order linear method to characterize this curve using a simple line, preserving the order of sampling points in the cell differentiation process. different to pca method , our linear model is designed to describe the development trajectory as a line with a distinct direction, which represents the change in genes expression over developmental time. in microarray space, when a series of points  are projected onto a line, the sampling order of the projected points are preserved; meanwhile, if the projection distance ratio of neighbor sample points on the line are equal to the distance ratio of neighbor samples points in the microarray space, we can say this line reflect the change of genes expression over time. naturally, we found that the angle bisector linear model would satisfy these two conditions. since feature reduction involves loss of information, we maximized the distance between points on the bisector in order to preserve as much information as possible. the details of model construction were described in method.

using this time-ordered linear model we can obtain "cell developmental state lines" representing the temporal properties of differentiation trajectories. the main advantages of this time-ordered model are that the sequential order is preserved and that the distance between points is maximized, ensuring that developmental processes are in the right order and that the relationship among neighboring points in microarray space is denoted accurately. here, by analyzing published tissue development and cell differentiation expression profiles obtained using time-course experiments , we obtained cell developmental state lines representing several developmental and differentiation processes, and then compared published tumor expression profiles obtained using the same microarray platform . by calculating the projection positions of expression profiles on the cell developmental state line, and their relationship, we were able to deduce developmental states of these tumors in these processes on a developmental-temporal scale.

similar to pca, time-ordered linear model generate one principal component to represent a mass of sample points. this principal component which we called 'developmental state line', is not only representing one mathematical characteristic of samples, but also reflects temporal property of a development process. in other words, the biological meaning was denoted to a mathematical characteristic, and this clear biological development perspective enable us to accurately estimate different development stage of same tissues samples came from different sources by one line.

in order to verify whether the principal components generated by pca method have the same property, we used pca to analyze dataset gse <dig> which contains mouse ovary development time-course expression profiles, then projected another development time-course data gse <dig> to principal components  of gse <dig>  the result was shown in figure  <dig>  pc <dig> reserved the natural time order of samples in gse <dig>  but can not estimate the right order of samples in gse <dig>  pc <dig> can not keep the right natural time order of  <dig> day and  <dig> day in ovary development expression profiles of gse <dig>  in gse <dig>  pc <dig> mainly kept the right order of development except that sample of  <dig>  day was project between  <dig>  day and  <dig>  day. oppositely, the cell development state line of gse <dig> kept the right natural development order of samples both in gse <dig> and gse <dig> . we also calculated the distance and distance ratio between neighbors points . only cell development state line generated by time-order linear model can keep the right distance ratio information which existed in high dimensional microarray space. we believe the time-ordered linear model is suitable to describe the development trajectory in a microarray space and estimate the developmental stage of samples came from other experiments.

the robustness of this time-ordered linear model was also tested. we generated  <dig> cell developmental state lines by removing  <dig>   <dig> and  <dig> points from dataset gse <dig>  then dataset gse <dig> were projected to these  <dig> cell developmental state lines one by one. the results indicated that the projection locations of the test dataset gse <dig> maintained the order following interval of points of the cell development state lines. meanwhile, the mean values of the projection locations were similar to the control, and the variance constantly increased. especially the first test point  <dig>  d and last test point  <dig>  d, suffered bigger variance than other points . interestingly, lack of the first two or three points influenced the resolution of later development period samples. this result indicated that the model has a high robustness, especially for the lack of medial samples, but lack of samples at either end of the time points would influence the projection result.

mouse liver cell developmental state line demonstrates apparent "similarity to early developmental stage" of liver tumors
the liver development "cell developmental state line" was calculated according to the method described above using dataset gse <dig>  which traces mouse fetal liver development from  <dig>  days to  <dig>  days . dataset gse <dig>  another mouse liver development time-course expression dataset, was used to test the accuracy of this cell developmental state line. as shown in figure 1b, the cell developmental state line could accurately order liver samples according to developmental stage. compared to the cell developmental state line, the projection positions of dataset gse <dig> were earlier. this alteration might be caused by the use of different mouse strains in the datasets analyzed; the cell developmental state lines are based on c57/b <dig> mouse liver development, while the gse <dig> dataset came from experiments with cd- <dig> mice. our results indicated that the cell developmental state line reliably reflects the temporal property of other expression datasets, and can be used to compare data generated from different experiments.

we used the liver cell developmental state line to estimate the similarities of liver tumor samples over time. expression profiles of  <dig> liver tumor samples induced by knockout of trim <dig>  and  <dig> normal samples from the dataset gse <dig> were individually projected onto the cell developmental state line as described above. compared with normal samples, the expression patterns from tumor samples had a clear tendency to project to positions corresponding to earlier development stages . the projection positions of expression patterns of normal liver samples and tumor samples were  <dig>  ±  <dig>  and  <dig>  ±  <dig> , respectively. such results demonstrate that the cell state of liver tumors induced by trim24-ko was more similar to that of earlier stages of development, suggesting that knockout of trim <dig> may block cell development.

we projected the dataset gse  <dig> which contains a series of carcinogen-treated samples onto the liver cell developmental state line. interestingly, a dynamic back-moving tendency appeared . mice treated with the two positive liver carcinogens had the earliest projection positions . projection positions for mice treated with the two negative liver carcinogens located in the middle between control and positive liver carcinogen-treated mice. these results suggest that there is a link between carcinogenicity and the apparent "younger developmental state" of cells observed here; different carcinogens change the cell state to different degrees. our liver cell developmental state line represents the changes in liver cell state associated with development. the analysis of these two datasets suggested a fact that liver tumors have a similar cell state to that of earlier developmental stages of the fetal liver. as is well known, tumor or cancer cells have many of the properties of self-renewing stem cells. it is accepted that once the cell status of cancer cells departs from that of normal cells, they regain the ability to proliferate uncontrollably.

mouse ovary tumor demonstrates apparent "developmentally younger"
we conducted a similar analysis of ovary development time-course experimental data. in dataset gse  <dig>  expression profiles from  <dig> stages  were used to construct the ovary cell developmental state line as described above. dataset gse <dig> was used to test the accuracy of the cell developmental state line. the results indicated that the cell developmental state line ordered each developmental stage accurately . we then used the cell developmental state line to estimate the projection positions of dataset gse <dig>  which contains  <dig> ovarian tumors and  <dig> normal ovary samples. results were also similar to those described above for the liver , once again suggesting that the process of tumorigenesis in ovary make ovary tumor cells have a high "similarity to early developmental stage".

cell state variation caused by carcinogenesis in the lung do no share same direction to mouse lung cell developmental state line
three sets of expression data from different developmental stages were projected onto the lung cell developmental state line  . the projection positions of each of the samples were distributed from early to terminal differentiated stages according to the age of the mice. this result demonstrates that the cell developmental state line can faithfully represent the temporal properties of development. then the cell developmental state line was used to estimate the states of gse <dig> lung carcinogenesis expression dataset, in which different carcinogens were feed to the mouse. the results were different to those for the liver and ovary. the four chemicals hardly changed the "developmental state" of lung cell state . although  <dig> -benzofuran and  <dig> -naphthalenediamine can cause cancer in both liver and lung, our model indicates that, different to in the liver and ovary, the genes belonged to a developmental pathway that may have not been involved in carcinogenesis process in the lung.

generally speaking, the cell developmental state lines generated by our time-ordered linear model using time-course microarray experimental data accurately reflect the gene expression pattern variation over time during development, and their utility for estimating the relationship between tumor cell state and normal cell state could supply clues for further investigations of the tumorigenesis mechanism. if tissue-specific tumors are treated as "attractors", the cell developmental state line describes the relative position of the "attractors" in cell state space. in the liver and the ovary, cancer attractors may be located nearer to earlier developmental stages than is the case for normal tissues. in the lung, cancer attractors may be located in a direction that is vertical to the developmental direction, and the cell developmental state line can not distinguish such cell state changes. projection results for cancer samples give an indication that the mechanisms of tumorigenesis may be not the same in different tissues.

mouse tissues development trajectories have different directions in cell state space
initiating from a fertilized egg, more than  <dig> kinds of cell types are generated follow different differentiation trajectories in both mouse and human. after transforming mouse liver, ovary and lung tissue development trajectories to tissue developmental state lines, we calculated the angles of these three developmental state lines. obviously, smaller angel between developmental state lines suggests higher similarity of gene expression pattern between two tissue development processes. the result shown in figure  <dig> indicated the liver development and lung development shared more commons , and the ovary development had a nearly vertical direction to liver and lung developmental state lines .

as known, the liver and lung both come from the endoderm, and the ovary is developed from mesoderm. we guess that if the origins of tissues in the gastrula are same, their development trajectories may share more commons in the cell state space, and the angle between these tissue developmental state lines would be smaller.

cell differentiation state lines of human es cell distinguished cell states variation of human tumors
since human embryonic stem cells are an important model for studying human development, we transformed expression data from es cell differentiation time-course experiments to a cell developmental state line representing the es cell differentiation process. unlike mouse tissues developments start from different cell states, we calculated two cell developmental state lines for all es cell differentiation processes starting from the same pluripotent cell state. this generated 2-dimensional coordinates, with each cell developmental state line axis representing different developmental processes. we used the gse <dig> dataset of the es cell-derived neural rosette differentiation expression profile to generate a "neuronal" cell developmental state line, and the gse <dig> dataset of the es cell-derived blast cell differentiation expression profile to generate a "blast cell" cell developmental state line. we combined two axes to one "differentiation index coordinate", and used it to estimate projection positions of different cancers and normal tissues.

first we tested the accuracy of the line. the gse  <dig> dataset, which contains expression profiles of normal adult cortex samples, fetal neural stem cells and tumorigenic glioma neural stem cells, was projected onto the "neuronal" cell developmental state line. compared to adult cells, fetal neural stem cells , were as expected, more like embryonic stem cells . surprisingly, tumorigenic glioma neural stem cells  showed the greatest similarity to es cells at the developmental state level. these results suggest that the tumorigenesis process of glioma tumors may share commons to tumorigenesis in liver and ovary.

then the "differentiation-index coordinates" was used to detect cell state of four human tumor expression data  containing normal tissue samples and diseased tissue samples  from the geo . moreover, we selected expression data from gse <dig> ), which contains expression data from more than  <dig> tumor samples derived from more then one hundred tissues. tumor samples originating from the breast, colon, endometrium and ovary were individually estimated by differentiation-index coordinates, and the results were shown according to tissue.

in differentiation-index coordinates, ovary tumors, endometriosis, and colorectal tumors were easily distinguished from their corresponding normal tissues. moreover, ovary tumor samples , tended to resemble es cells , suggesting that ovary cells become "developmental younger" during tumorigenesis. colon tumors and endometriosis  tended to be located at same distance from es cell state in the differentiation-index coordinates . interestingly, the colon cancer seems show a negative correlation between malignance and differentiation: the distribution of projection positions follows the progression from normal tissue to early-onset colon cancer to malignant colon cancer . such negative correlation in the differentiation-index coordinates suggested that, in a cell state space, the real colon cell developmental state lines may have a opposite direction relative to the direction of the two cell developmental state lines we used here, namely cell-derived neural and blast cell differentiation.  these results strengthened solid our assumption that the directions of different tissue development indicate the discrete distributions of attractors in cell state space. like a man walking down from a mountain peak, there are many paths with different directions in cellular development. if we observe development process from an appropriate viewpoint, we may finally understand how many roads must a cell walk down, before we call it a terminal differentiation cell .

in the case of breast cancer, the tumor and normal breast tissue occupied overlapping positions in the differentiation-index coordinates . the fact that it was not possible to distinguish tumor samples from normal samples by differentiation-index coordinate approach may be due to that tumorigenesis in the breast may not be related to the developmental pathway, or the breast developmental state line may be perpendicular to the "neuronal" and "blast" cell differentiation state lines. moreover, a recently published comprehensive genome-level catalogue of breast tumors  <cit>  revealed the complexity of breast tumors. such complexities at genome level may also influence the accuracy of cell developmental state line.

discussion
es cell differentiation is a good model for studying the process of development. however, successful cell differentiation under in vitro conditions is only possible in a limited number of cell types. the two human es cells developmental state lines developed here, based on in vitro datasets, represent only two of the possible es cell differentiation directions, and thus cannot fully represent the complete es cell differentiation process under in vivo conditions. the work presented here provides an approach forwards understanding the relationships among distinct differentiation directions in cell state space, of which microarray space is only one subspace. the increasing availability of high-throughput proteomic and epigenetic data and other measures of cell properties will make it possible to investigate other dimensions.

theoretically, each type of differentiated cell has its unique differentiation direction. even a single cellular activity can be considered to have a unique direction. many different directions exist in the whole process of tissue development and cell differentiation, and these different directions reflect distinct aspects of cell properties. here, we selected the changing tendency of gene expression pattern over time to represent the differentiation trajectory. in the embryonic development process, the diversity of cells increases continuously with cell differentiation. however, it is difficult to describe the relationships among the growing number of cell types, and how the genome facilitates the generation of stable and distinct cell types in the development process is still not clear.

assuming that differentiation processed follow a strict order, using a time scale should be useful for estimating changes in cell state throughout the differentiation process. the cell developmental state lines generated by time-ordered linear model were able to accurately order different developmental stages in different tissue types. interestingly, our results did not only suggest that tumorigenesis can be measured by "developmental state lines", but also suggested the possibility all directions of es cells differentiation can be described. it has been reported that some genes whose expression is significantly altered during tumorigenesis may also play key roles in developmental process  <cit> . our approach may help to understand the relationship between tumorigenesis and cell differentiation in greater detail.

tumorigenesis is a complex process. that tumorigenesis shares many similar characteristics with embryonic cell development implies that they have a close, though poorly understood relationship. the "cancer attractor" model presents a new and integrated perspective for viewing these two processes. constructing cell developmental state lines is an attempt to observe and describe differentiation trajectories in cell state space from another perspective. our result indicated that even in large scale discrimination, some kinds of tumor showed the same moving tendency at timescale. although theoretically there are many "cancer attractors" surrounding normal cell state, in realty the number of these "attractors" may be limited to a very small range.

the time-ordered linear model constructed here is an attempt to use a linear trajectory to describe tissue development and cell differentiation processes. not only it is a novel method to analyze the time-course expression profiles, but by, primarily defining a biological meaning to the mathematical model, the approach also supplies a different viewpoint to traditional methods which mainly emphasize the mathematical characteristics. the time-ordered linear model is a simplified model for calculating lines to represent development trajectories, and some limitations are still need to be addressed. the calculation of this liner model depends on a given order of sample points, and disordered sample points would generate fake cell development state lines. moreover, in this work, we used the average of several repeats at each time points to calculate the cell development state line. such an approach partly limits the robustness and increases the sensitivity to noise. in the future, replacing the averaged points by a may overcome these weaknesses.

however, we cannot expect such a simple model to reflect all the details of development, to fit all expression data, or even to distinguish all types of cancer in cell status space. rather, its function is simply to transform cell differentiation expression profiles to a line in keeping with the natural temporal properties of gene expression during the development processes. the real development trajectories in cell status space are much too complex to be modeled computationally at present. we have therefore started with a simple "line," which captures the basic progression of development from one perspective. if the approach works, it could serve as a basis for further construction of more realistic, comprehensive, and predictive models of cell state space. to draw developmental trajectories in cell state space accurately requires being able to describe cell state from the perspective of all of cell features, including its transcriptome, epigenetic map, and proteome. understanding the trajectories in cell status space will help reveal the mysteries of embryonic development.

CONCLUSIONS
by primarily defining a biological meaning to a mathematical model, we designed the time-ordered linear model which can capture temporal properties of development process, and drew the linearly projected development trajectories in a cell state space. meanwhile, it reflected the change of gene expression from a developmental timescale perspective. by applying this model to measure tumors of different tissues, we found that different developmental states appeared during tumorigenesis.

