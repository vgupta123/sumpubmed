BACKGROUND
pre- <dig>  bluejay
the features of bluejay  prior to the release of version  <dig>  were described in  <cit> . we briefly summarize them as background information, which is necessary to put the new features of bluejay  <dig> , which have not been described elsewhere, into context.

bluejay supports moby  <cit> , a protocol consisting of a common xml object ontology for biological entities and a standardized request/response mechanism for automating web-based analysis. this allows the user to seamlessly link from the visualized data, internally represented as a document object model   <cit> , to moby-compliant web services by embedding the seahawk moby client  <cit> . the tigr multiexperiment viewer   <cit>  is integrated into bluejay such that it functions as a fully embedded module . through this integration, bluejay can show gene expression values in a genomic context, enabling biologists to draw additional inferences from gene expression analyses . bluejay loads url-based data via a proxy web service. if an xml file with a large amount of data is requested, the proxy performs data skeletonization on-the-fly, using an extensible stylesheet language transformation   <cit> , which allows bluejay to run on a memory-limited computing environment .

novel features of bluejay  <dig> 
bluejay is a unique genome browser that offers numerous features not available in other genome browsers. bluejay  <dig>  adds comparative genomics and enriched customization/personalization capabilities in order to provide the biologist with an elegant way to simultaneously view genes in multiple contexts . the new features include:  visual comparison of multiple genomes on a single canvas;  genomic information recommendation reflecting user preference; and  flagging elements of a genome and utilizing the flags for navigation and comparison.

implementation
bluejay is available from the project home page  <cit>  as an applet, java web start, or a standalone application. bluejay is implemented in java  <dig>  and uses a number of open source libraries from the apache foundation  <cit> . the details on how the libraries are integrated into bluejay are described in  <cit> . here we focus on how a biologist can use bluejay's genomic, comparative and expression contexts to enhance their understanding of a gene or set of genes of interest.

• agave: architecture for genomic annotation, visualization and exchange. 

• tigr: the format in which tigr  annotations are distributed. 

• bioseq-set: the output format for xml option in readseq, a popular sequence format conversion program. 

• ncbi_gbseq: ncbi genbank's xml sequence data format. 

the xlink standard  <cit>  is used to hyperlink visual representations of genomic features to external data. for example, magpie gene annotation pages  can be launched by clicking on a gene. custom xml documents created by users can include xlinks to any web page. xlinks are inserted before the annotated sequence is internally represented as a dom tree. the graphics engine uses scalable vector graphics   <cit>  to render the dom tree. this supports almost unlimited semantic zooming and publication-quality image output. through the browser gui, users can customize their viewing preferences, set waypoints for easier navigation, and invoke the search engine for personalized information retrieval. the comparison module is automatically entered and exited depending on the number of genome sequences loaded.

two standalone software applications are currently embedded in bluejay for linking to external resources accessible through the browser gui: seahawk for accessing moby-compliant web services and tigr mev for gene expression analysis. currently, seahawk is incorporated into bluejay as a single java archive  file. no specially designed application programming interface  is required to use the functionality of seahawk from within bluejay  <cit> . this approach also makes it easier to update seahawk when a new release becomes available, avoiding the need to change the bluejay source code. tigr mev has been integrated at the source level, because we needed to extend its functionality to display gene expression values within the context of the corresponding genomes.

RESULTS
whole genome comparison
bluejay is capable of visualizing multiple genomes in a single display for intuitive comparison. the comparison mode is automatically activated if the user loads more than one genome, and exited when only one genome remains loaded. a central feature for genome comparison is the display of lines that link common genes based on their gene classification. this helps the user to instantly estimate how functionally similar the compared genomes are. for example, bluejay comes with a bookmark that lets the user access genome data annotated using the magpie system, which uses gene ontology   <cit>  as the gene classification system. as go allows standardized multi-level hierarchical classification of a gene, each gene is linked only to the physically closest gene in another genome with the same classification at the most detailed go level, if such a gene exists. however, it should be noted that go is not the only gene classification system that can be used in bluejay to compare genes. as the textual gene descriptions are compared to match genes, any kind of gene classification system that the user wants to use can be accommodated in bluejay.

in the comparison mode of bluejay, all genome displays are scaled with respect to the length of the first genome for ease of visual comparison. this means that all circular genomes are displayed as a complete circle and the all linear genome displays are normalized to the length of the first genome. thus, for circular representation, the distance between two genes used for finding the nearest genes is in units of the angle difference between the two gene locations.

an enhanced feature related to gene linking is the automatic gene-level alignment of circular genomes to minimize the sum of the angular distances for all linked pairs of genes. this amounts to minimization of linking distances to find the best global alignment of closely related genes. when this feature is enabled, the outer sequence is automatically rotated to the best-aligned position. the user can then see the functional similarity of the genes in the two sequences, with the effect of base position differences minimized.

another useful feature of bluejay for comparing genomes is the ability to selectively show or hide links between genes. the selection is based on limiting the linking distance as a percentage of the length of the first genome  or a percentage of  <dig> degrees , adjustable by the user. this allows the user to visually perceive the degree of similarity of the compared genomes, based on the positions of similar genes. figure  <dig> shows an example of comparing two chlamydia genus genomes using the aforementioned comparison features  <cit>  .

another example of using the comparative genomics functionality of bluejay is shown in figure  <dig>  where four human chromosomes  are being compared. it has been known that the human chromosomes contain many instances of gene family duplications  <cit> . using bluejay, we can visually confirm that a selected subset of human chromosomes indeed has a number of duplicated genes. the direction of gene linking is by default from the first genome to other genomes , but this direction can be reversed, or even both directional links can be shown .

bluejay supports the manual operation on genomes loaded for comparison, mainly because there may be a need to compare specific genes that are not proximate in the automatic global genome alignment. all loaded circular sequences may be rotated together or individually. the lines linking common genes are dynamically repositioned when the user rotates or unloads a sequence. finding out the correct rotation angle for a sequence to align genes used to be a trial-and-error process. we have now automated the rotation operation to align a set of genes by taking advantage of the waypoints capability .

personalized search via a hybrid recommender system
when viewing a large amount of annotated information at once in a genome browser, the user is easily overwhelmed by the quantity of data. even if the user is familiar with the data itself, thousands of genes, oligonucleotides, gene expression values, and their annotations may be displayed simultaneously, making it difficult to locate the desired information. this problem is compounded when multiple genomes are being viewed simultaneously. even a search engine may not be flexible enough, because a single gene or function may be listed under several synonyms. a recommender system that helps users to locate specific, relevant, personalized information in complex and heterogeneous genomic datasets was therefore implemented.

the bluejay system includes a hybrid recommender system composed of a knowledge-based recommender and a content-based recommender  <cit> , as part of its search engine . the knowledge-based component is implemented using the term frequency-inverse document frequency  text mining algorithm  <cit>  as follows:  matched items, annotated genes and other textual items in bluejay's search results are regarded as "documents"; and  single words found in each document in the search results are taken as "terms". when there is no user profile, the algorithm solely determines the ranking of the search results. since gene annotations vary widely in length, normalization is applied to the rankings to lessen the influence of document sizes.

because of the brevity of genomic annotations in comparison to typical documents in text mining, the tf-idf algorithm alone is not sufficient to determine the ranking of search results. the content-based component uses a previously learned user profile to reflect the user preference of documents. a user creates a personal profile by rating matched items on a 5-point likert scale  <cit> , with  <dig> being "not useful" and  <dig> being "very useful". as an item is rated, the relevance values of all keywords that comprise it  are continuously updated in the user's profile, using rocchio's algorithm  <cit> . the user profile consists of the average vectors of each "usefulness" class, corresponding to the likert scale. once the user profile is created, it can help to classify new matched items. the distances between the learned user preference vectors and the new item are calculated using the cosine similarity measure, which determines the class . the tf-idf score  is added to refine the order of items within a class, resulting in a relevance score represented as a percentage.

the recommender system is invoked via the "search results" window. updated in response to user interactions, the window displays a sorted table of search results that are deemed most relevant to the user's needs. users may change their usefulness rating of any matched item by choosing one of five predefined likert scores from the pull-down menu in the "feature rating" column. figure  <dig> illustrates how the recommendation order based on tf-idf alone is altered after the user rates the items.

waypoints for customized navigation and comparison
biologists are often interested in viewing only a small portion of a genome. navigating within a large genome usually entails scrolling until the desired part is in view or typing in a base number to see the view around it. using these methods, the user has to spend considerable time to focus on the desired part of the genome.

with bluejay, we now offer a significantly more intuitive method for exploring large genomes by using the notion of a waypoint, which is loosely defined as a coordinate that identifies a point in 2d or 3d space. in bluejay, waypoints are represented as a collection of flags with positional and descriptive information to mark points of interest on a genome. the user can set a waypoint within the sequence to highlight a specific gene or sequence feature . figure  <dig> shows a typical use of waypoints to quickly focus on two regions of interest. once a waypoint is set, a number of operations can be performed, including focusing on it or aligning several genomes at a waypoint with the same name within multiple genomes.

viewing a genome at the nucleotide text level is possible in bluejay. in a text mode, a waypoint can be set not only with respect to a whole gene but also at a base position, helping the user to investigate bases as well as whole genes. for example, in the "horizontal sequential" text mode, a genome is displayed as an elongated string of characters .

the usage of waypoints in combination with genome rotation for the comparison of circular genomes adds to the utility of waypoints. there is often the need to align multiple circular genomes at specific genes to investigate how similar they are around those genes. without waypoints, the user would try rotating the genomes by some angles until the genes of interest align more or less. waypoints in bluejay provide the user with the ability to flag multiple genes with the same name and align them at those flags, without estimating how much rotation might be necessary for the exact alignment .

discussion
genome comparison
bluejay offers the ability to display multiple genomes in the same visual display for direct comparison, along with lines linking genes of the same classification, which immediately shows the degree of similarity of the genomes. automatic alignment of genes based on linking distance minimization and user-directed waypoint-based alignments of genes are novel features for genome comparison. for example, the ucsc genome browser  <cit>  can display multiple genomes in different tracks to show base-level alignment and allows the user to sort genes based on several different gene information categories. however, it does not let the user visually align genomes at user-specified genes. however, there is no provision for the user to tag specific genes and use them as anchors for visually aligning genomes. the ensembl genome browser  <cit>  provides a set of comparative genomics tools based on multiple sequence alignment, but visually comparing the sequences at the gene level is not possible.

the gene-level comparison of genomes in bluejay adds to the existing capability of sequence match-based comparison approaches such as the blast programs  <cit> , which are widely used for searching protein and nucleotide databases to identify sequence similarities. mummer  <cit>  is a fast comparison tool to align two large nucleotide sequences. these tools are essentially search or alignment tools that do not provide the user with the information on the similarity of gene functions. a more recent genome comparison tool called m-gcat  <cit>  can generate lines to link maximal unique matches occurring in multiple sequences. this tool displays sequence match results to reveal similarities of genomes at the sequence level, whereas bluejay visualizes annotated functional descriptions of genes which allows users to compare genomes at the gene level.

any gene classification system can be adopted for genome comparison in bluejay. for example, in particular analysis projects, we have successfully replaced go terms with ensembl  <cit>  paralog family labels for classification of genes in the source xml files. as go provides a standardized classification scheme that allows multiple levels of classification for a single gene, adopting go classifications of genes allows users to compare genomes based on gene functions. however, the current approach is clearly limited in detecting genome rearrangements, for which other comparison approaches that depend on sequence search and alignment are better suited. for example, four genomes within the bacteria neisseria genus were compared using blastn  <cit>  which identified four different types of genome polymorphisms including a genome-wide inversion  <cit> . since any object displayed in bluejay, including the genes, act as hyperlinks to additional gene-specific information through the magpie annotation pages  <cit>  or biomoby-compatible web services  <cit> , using these additional sources of data for comparing genomes would be a useful future addition to the current comparison functionality of bluejay.

while bluejay is primarily intended for comparing complete genomes, it is possible to display incomplete genomes or ests, but this requires a reference genome onto which sequence fragments are placed in order to create a pseudogenome. in this mode, the locations of sequence fragments must be verified by performing sequence alignment ahead of time, as otherwise displaying fragments along an imaginary backbone could be misleading.

customization for exploring genomic information
bluejay is the first genome browser we know of with a rich set of waypoint management functions that enables the user to easily navigate within a genome. we have found that in order to visualize the region of interest in a genome, a method of marking positions of a sequence and performing operations on the user-defined markers is far more intuitive than scrolling around or typing in base numbers. an innovative, additional use of waypoints for user-directed gene alignment for comparison adds to the usability of waypoints. to our knowledge this conceptually simple but functionally powerful feature has not been exploited for genome exploration in any other system.

bluejay's recommender system helps bridge the gap between the vastness of genomic data and the specificity of users' needs. especially in genomes with large numbers of annotations, targeting search results using semantic knowledge about the user's preferences can help the user to be productive. to our knowledge, no other genome browser has provided a recommender system yet. gbrowse  <cit>  and the ucsc genome browser  <cit>  have search engines and the capability for user profiles, but neither recommends information based on learned user preferences. the ensembl genome annotation source  <cit>  performs some data mining by searching multiple databases, but it does not record the user's interests.

dynamic resource discovery and linking
bluejay provides interoperability and extensibility by dynamically finding and linking external data and biological web services via standard protocols. most popular genome browsers other than bluejay have limited capabilities of external data and services linking. the ucsc genome browser does not provide the user with the option of directly linking out to external biological resources  <cit> . ensembl can link the distributed annotation system  resource  <cit>  and contains hardcoded hyperlinks that link to external services. the ncbi map viewer  <cit>  provides a "linkout" link to access information about a gene. most of the links in the other browsers are hardcoded, which creates maintenance issues for the tool creators.

the visualization of gene expression levels in the context of a whole genome in bluejay enables biologists to gain valuable insights on gene functions. for smaller genomes, individual genes and their expression values can be investigated without any special visualization methods. however, larger genomes with thousands of genes  require viewing the genome and expression values as a whole. bluejay has been successfully used by biologists for a number of microarray studies  <cit> , which demonstrates its usability. to date, no other genome browser we know of provides this integrative visualization functionality. we expect bluejay to be useful to many researchers who can take advantage of the combined genomic, transcriptional and comparative contexts to more easily answer biological questions.

CONCLUSIONS
bluejay version  <dig>  is one of the more comprehensive visual environments for exploring genomes and related biological data. in addition to visualizing the data for a single genome, bluejay can now visualize multiple whole genomes and provides the user with a set of operations useful for genome comparison. the user can use waypoints for navigating within a genome and for comparing genomes. the hybrid information recommender system coupled with the search engine provides personalized genomic information. dynamic discovery and linking of moby web services from bluejay enables the user to seamlessly connect to diverse biological resources while keeping the application itself relatively lightweight. bluejay also provides access to a comprehensive package  for the analysis of microarray data, with the additional capability of graphical display of gene expression values together with genomic data. we believe that these unique capabilities represent an essential collection of visually oriented tools for bioinformatics analysis in general, and genome/transcriptome analysis in particular.

availability and requirements
project name: bluejay

project home page: 

operating systems: platform independent

programming language: java  <dig>  or higher

license: gnu lesser general public license 

any restrictions to use by non-academics: none

authors' contributions
js improved the waypoint manager, the comparison module, and the text view modes, and integrated them into bluejay  <dig> . pmg designed the software architecture of bluejay and developed most of its core classes. mlt coded earlier versions of the waypoint manager and the text view modes, and also implemented the recommender system. ad coded an earlier version of the genome comparison module. aca integrated tigr mev into bluejay and coded the gene expression visualization module. alt developed most of the svg graphics engine. cws was responsible for scientific guidance on all of the presented aspects of bluejay. js wrote the manuscript with contributions by pmg, and critical review by cws. all authors read and approved the final manuscript.

supplementary material
additional file 1
interaction between bluejay and embedded tigr mev. microarray data parsing and cluster analysis are handled by tigr mev. the expression/cluster data are integrated with the genome data to produce a coherent visual representation. tables of expression values and images of the genome along with visualized expression values can then be exported.

click here for file

 additional file 2
bacterial genome comparison. the comparison of two bacterial genomes shows that they share many genes with the same gene ontology  classification, as indicated by the linking lines:  chlamydia trachomatis and chlamydia muridarum genomes are compared ;  the two genomes are automatically aligned to have the minimum possible total angular linking distance .

click here for file

 additional file 3
using waypoints in a text mode. in the text mode, the genes are shown as coloured rectangles over the bases and waypoints can be set at individual base positions. in this case, the possible location of a frameshift is seen at the nucleotide level, with the annotated orf boundaries as waypoints.

click here for file

 additional file 4
aligning genomes by waypoints. a waypoint named dpoii is set at the appropriate location in each of three sulfolobus spp. genomes, and the "align at waypoint" action is selected to align the genomes at the dpoii gene by appropriately rotating the outer genomes. this makes visual comparison of the gene's structure in all three species easier.

click here for file

 acknowledgements
we thank krzysztof borowski and lin lin for their coding contributions to bluejay. we also thank hong chi tran for his comparative study on popular genome browsers. this work was supported by genome canada/genome alberta through integrated and distributed bioinformatics platform for genome canada, as well as by the alberta science and research authority, western economic diversification, national science and engineering research council, canada foundation for innovation, and the university of calgary. cws is the icore/sun microsystems industrial chair for applied bioinformatics.
