BACKGROUND
cyanobacteria are blue-green algae, prokaryotic organisms capable of both obtaining energy by oxygenic photosynthesis and nitrogen fixation. they play a fundamental role in earth's carbon cycle as primary producers, and in the nitrogen cycle as nitrogen fixers  <cit> . these two processes are somewhat contradictory in nature, since the activity of the nitrogen fixing enzyme, nitrogenase, is dramatically reduced by the presence of oxygen, which is the end product of photosynthesis. cyanobacteria evolved a mechanism for fixing dinitrogen , an oxygen sensitive process, under aerobic conditions. vegetative cells, which are the cells where oxygen is produced from photosynthesis, can differentiate into specialized non-dividing nitrogen-fixing cells called heterocysts. anabaena and other filamentous cyanobacteria in the order of nostocales grow in filamentous structures formed by photosynthetic vegetative cells. for some of these strains, under nitrogen-limiting conditions, vegetative cells differentiate into heterocysts at intervals along the filaments therefore generating a semi-regular spacing pattern  <cit> . this mechanism has made anabaena a model organism for studies involving cellular differentiation and pattern formation in prokaryotes.

the primary known function of heterocysts is the fixation of dinitrogen, for which they require a reductant supplied by the vegetative cells since differentiated cells gain the ability to reduce nitrogen gas but lose the ability to fix carbon dioxide. heterocysts have a deactivated photosystem ii  and higher respiration rates in order to consume the oxygen that was able to enter the cell. all these characteristics generate an anaerobic environment suitable for the operation of the nitrogenase enzyme and therefore, for nitrogen fixation  <cit> . nitrogen fixed in heterocysts is transported along the filament, likely in the form of glutamine, and utilized by the whole population of cells  <cit> . in this scheme, heterocysts share nitrogen with vegetative cells receiving in turn carbon resources establishing a cooperative system  <cit> .

differentiation of vegetative cells into heterocysts is triggered by the absence of a fixed nitrogen source in the growth medium  <cit> . a large number of genes involved in the development and spacing of heterocysts have been identified, however the complete mechanism by which they interact is still unclear  <cit> . interaction mechanisms, based on current knowledge and inferred interactions have been proposed  <cit> .

the reduction in nitrogen levels rapidly enhances the activation of ntca, a dna-binding factor involved in the transcription of genes involved in nitrate and ammonium transport and assimilation, dinitrogen fixation and heterocyst development, including hetr, which is required for heterocyst differentiation  <cit> . nitrogen levels are sensed by the cell's intracellular levels of 2-oxoglutarate. this intermediate from the krebs cycle accumulates in the cytoplasm upon nitrogen starvation, enhancing the dna binding activity of ntca  <cit> . there is evidence that ntca binds to the promoter region of its own gene, suggesting that it regulates its own expression  <cit> .

hetr plays a key role in the regulation of heterocyst differentiation. this gene appears to be indirectly activated by ntca through intermediate signaling molecules, since none of its promoters contain the sequence to which ntca binds  <cit> . the gene product hetr is a dna binding protein that acts as a homodimer  <cit> . in the presence of nitrogen, hetr is transcribed at low levels in all cells. following deprivation, hetr expression is induced in a process that requires ntca expression and the presence of a functional hetr gene, indicating that hetr is also autoregulatory  <cit> .

for the generation of the characteristic pattern observed upon heterocyst differentiation, besides the activation of genes required for heterocyst development, the genes responsible for regulating the position and spacing of heterocysts must be activated. among the genes involved in the control of heterocyst spacing are hetn, pata, pats and a few others. the pata gene is transcribed at low levels in the presence of nitrogen, and transcription increases following nitrogen step-down in a similar pattern of expression to that of hetr. pata is a protein whose structure suggests kinase activity, which is speculated to act indirectly on controlling heterocyst spacing since it does not contain a known dna-binding motif. this protein is required for the enhancement of hetr transcription in developing heterocysts  <cit> . hetn regulates the activity of hetr likely through a secondary metabolite, therefore playing a regulatory role in the control of heterocyst formation  <cit> .

pats acts as a spacing regulator for heterocyst differentiation. this protein has been shown to block heterocyst differentiation when present in multiple copies or when over-expressed. pats is produced early in heterocyst development and is believed to be processed  to release a pentapeptide capable of diffusing through the filament's periplasmic space to form an inhibition gradient around the developing heterocysts. this is supported by the finding that a synthetic peptide corresponding to the last five amino acids of pats inhibits heterocyst development  <cit> . studies have shown the feasibility of diffusion of this pentapeptide through nonspecific intercellular channels from cytoplasm to cytoplasm in anabaena  <cit> . in addition, when pats is knocked-out filaments show an increased frequency of heterocysts and an abnormal spacing pattern  <cit> . it is speculated that pats producing cells must be refractory to the influence of pats, in order not to affect hetr gene expression, since it seems paradoxical how hetr can promote its own synthesis in the presence of the inhibitory pentapeptide derived from pats. in fact it has been proposed that pats is inactive in the cytoplasm of heterocysts and that an active peptide is released into the periplasm and transported to vegetative cells where it would act on hetr, or act on the transcription factors directly involved in the expression of hetr  <cit> .

several mathematical models have been developed in order to systematically explore and understand the system's behavior. baker and herman proposed a mathematical model for differentiation where heterocysts produce a substance that diffuses along the filament and inhibits the differentiation of vegetative cells into heterocysts. when its level in a cell drops below a threshold value, the cell differentiates into a heterocyst. the observed pattern of heterocysts is reproduced but the model shows high sensitivity to the parameters chosen, many of which are vague in terms of association to biological phenomena  <cit> . this model involves the production of an inhibitor by heterocysts and its diffusion along the filament where heterocysts develop if the inhibitors' concentration drops below a certain threshold. a subsequent work explains heterocyst differentiation by means of a competitive mechanism  <cit> . this mechanism involves an autocatalytic activator of differentiation produced by proheterocysts and an inhibitor produced in proportion to their degree of differentiation, which stops and even regresses proheterocyst differentiation and whose effect is reduced by adjacent vegetative cells. with this mechanism an irregular pattern will form on a filament where a maximum and minimum distance between heterocysts is observed  <cit> . some of the elements in this proposed mechanism are in agreement with the underlying gene network currently identified to control differentiation of vegetative cells into heterocysts and addressed in this work. in this network the differentiation activator can be associated with the protein hetr, which enhances its own production, and the inhibitor with pats, which inhibits the production of hetr  <cit> .

turing developed models that showed the possibility of obtaining patterns from an initially homogeneous distribution, from a reaction-diffusion system where two substances with different diffusion rates interact  <cit> . gierer and meinhardt showed that in morphogenesis a spontaneous pattern formation is possible if a locally short-range self-enhancing reaction associated with an activator which promotes its own production, is coupled with an antagonist that acts on a longer range  <cit> . using this hypothesis meinhardt showed that the anabaena system satisfies the prediction of this model, considering a locally restricted activator hetr that self-activates nonlinearly  and a diffusible inhibitor pats  <cit> . the pattern formed by this network has also been modeled and captured using l-system models where the network is described as a growing system with reaction-diffusion equations for antagonic activator and inhibitor molecules  <cit> . a population model was proposed by pinzon and ju to describe the effects of cellular activities and cultivation conditions on heterocyst differentiation at a culture-level  <cit> . more recently, allard et al. proposed a dynamic model that considers random cell growth and division, as well as production, transport, and consumption of fixed nitrogen within the filament. in this model, nitrogen is the main trigger of cell differentiation and cell growth acts as a stochastic factor that can induce cell differentiation. simulation results are in good agreement with experimental pattern distributions  <cit> .

in this paper, a simple evolution mathematical model is presented, to study the pattern formation obtained upon heterocyst differentiation, based on the main regulatory elements and interactions of the gene circuit involved in differentiation: ntca, hetr and pats. in contrast, previous models of the system are based on the protein network involved in heterocyst differentiation. the mathematical model proposed behaves as a discrete one-dimensional activator – inhibitor system, analogous to a continuous autocatalysis-inhibition model  <cit> , but directly derived from the genetic network of the cyanobacteria. this model allows, not only to capture the stable states obtained by the system upon differentiation, but also the response of the system following modifications such as knock-out or over-expression of some of the elements and their effect on the patterns formed as well as the stable states achieved by the system. the underlying idea is the same as in previous models: there is an emerging periodic structure of localized heterocysts in the presence of a local autocatalysis  coupled with and a long-range inhibition . nevertheless, the discrete model presented here has several important advantages when compared with the classical continuous autocatalysis-inhibition models. on one hand, the proposed model naturally arises from the interactions of the gene network involved in differentiation with a set of parameters that have direct biological interpretation. this is a bottom-up construction alternative to the typical top-down methodology of the continuous case where the parameters have to be adapted to each case from general set-up models.

once the discrete model is established, it allows computing the patterns of the system upon differentiation and the frequency of the corresponding attractor basins. these are the equilibrium states of the system reached from a representative sample of random initial conditions. these types of calculations are a difficult task for the system of partial differential equations in continuous models. moreover, since the model parameters have a biological meaning, the effect of modifications on the genetic network, such as knock-out or over-expression on the patterns achieved, can be tested. for this reason, the proposed model is suitable for experimental design and for exploring the pattern formation capabilities of systems that could have these pattern forming mechanisms. finally, some variants of the model that include cell growth and death, or reduced binary on-off activity states can be implemented, but were not considered here for the sake of simplicity.

models and methods
modeling framework
a finite array of n genetically identical cells has been considered. a fixed number of n cells in the array, organized in a cyclical manner where each cell is connected to its right and left neighbors is used.

on each cell, the intracellular interactions are modeled by a gene circuit with three main interacting factors: ntca, hetr and pats. the state of each cell in the array is characterized by the levels of each of these three components. this simple network is schematically represented in figure  <dig>  where each cell is represented by three nodes.

with this, an intracellular interaction matrix is obtained, given by

   

where the values of row i  represent the activation or inhibition strength that the proteins of the intracellular gene circuit exert on i. for instance, no protein acts on ntca intracellularly  and ntca acts on hetr with an activating strength of one. cint summarizes all the network interactions that occur intracellularly for a single cell.

a reduction in nitrogen availability triggers the initiation of heterocyst differentiation mechanisms. initially all cells behave in the same way, and the internal activity of each individual cell causes an inhibitory effect on two elements of the intracellular network of cells in its immediate neighborhood. low external nitrogen levels trigger an increase in ntca expression. ntca leads to the transcription of hetr, which is self-activating. the increase in hetr levels enhances pats transcription to a lower extent than the other activation processes occurring intracellularly , resulting in higher levels of the process pentapeptide pats- <dig> . it has been shown that this pentapeptide has an indirect inhibitory feedback effect on the expression of hetr in adjacent cells, by preventing the dna binding of hetr and subsequent hetr up-regulation, therefore blocking heterocyst formation  <cit> . this is represented by a - <dig> in cint. there is also an indirect long-term effect produced by the increased amount of nitrogen that becomes available once vegetative cells differentiate into heterocysts and start fixing nitrogen. this  effect is induced by hetr and sensed by the cell as low oxoglutarate levels, which in turn decrease the binding activity of ntca  <cit> . both pats and the products of nitrogen fixation are the main signals determining the heterocyst pattern formed  <cit> .

all these external interactions are represented in an extra cellular interaction matrix given by

   

this matrix shows the fact that ntca expression is reduced by the indirect extracellular action of hetr and hetr expression is reduced by the action of extracellular pats. cext summarizes all the interactions that occur in the network for a single cell due to its extracellular environment.

transport of the inhibitory pentapeptide pats- <dig> to adjacent cells through the periplasmic space is controlled by movement across the cell-cell interface and diffusion, and therefore it is dependent on the distance between cells. similarly, the inhibition of ntca by the indirect action of hetr is controlled by nitrogen diffusion. to account for these effects, a transport factor is introduced, d  that affects the extracellular interaction matrix. all these network interactions  define the global interaction network a for the system. for instance, with n = 8

   

the matrix a has the intracellular interaction matrix  on its diagonal and the extracellular interaction matrix  with a transport factor d on the secondary diagonals. the dependence of the effect of the extracellular interaction matrix with transport, represented by this transport factor, is reduced as the distance between cells increases. therefore, its exponent increases in order as the distance from the neighboring cell increases and decreases as the distance  is reduced, as follows:

   

resulting a circulant  type matrix a. the global interaction matrix a summarizes all the interactions that occur both intracellularly and extracellularly for an array of n cells with a gene network as the one shown in figure  <dig> 

the state of the system is associated with the protein levels of each of the elements in the network . these protein levels are normalized and associated to a real number between  <dig> and  <dig>  the state of the system is therefore described by the levels of these factors on each cell of the array, represented by the vector x∈ ℝ3n.

starting from a random initial condition for the state vector that is biologically feasible for the system, that is, a random value between  <dig> and  <dig> for the normalized expression levels of each gene in the network, iteratively the system's equilibrium points were searched for following a perceptron type of rule associated to the nonlinear function f: ℝ →  <cit> , defined as follows:

   

this function is used to determine if the expression of a particular element in the network is enhanced or reduced by the action of the other elements on the network. state transitions are considered to occur asynchronously, with one component of the state vector x being updated at a time in random order for the whole array of cells. this represents the fact that cells that differentiate are selected dynamically in response to nitrogen deprivation  <cit> . more precisely, the state vector x is updated as follows:

   

where ai is the ith row of the global interaction matrix a. in equation  the function f, which is used to determine enhancement or reduction of the activity of a particular element on the network xi in t +  <dig>  is dependent on the internal and external interactions for each cell in the previous state vector ai•xi, the external input associated with nitrogen levels ui , and the activation threshold θ. all cells in the system are considered identical since they all receive the same extracellular inputs and respond to the same thresholds. θ =  <dig>  corresponds to the threshold level defined for the activation of each factor in the network. the vector u∈ ℝ3n represents the effect on the intracellular network of the external input of nitrogen levels sensed by each cell, where

   

with u <dig> =  <dig> in the absence of nitrogen and u <dig> =  <dig> in its presence. each triplet  of the vector uis associated to the effect of an external input on an element of the network  for a cell in the array. a value of  <dig> indicates that nitrogen levels directly affect the first element on the network for each cell, ntca.

the convergence state for heterocyst distribution achieved by the system from a random initial condition for the state vector is illustrated in figure  <dig>  as time  progresses the pattern formed is clearly defined.

RESULTS
effect of the transport of pats
the analysis is started with the relationship between the transport factor and the system's behavior. figure 3-a shows the effect of the transport factor d on the average distance between heterocysts . d was sampled in the interval  <cit>  in steps of  <dig>  units and its effect studied for systems whose size ranges from  <dig> to  <dig> cells.  was calculated as the average distance between heterocysts obtained after the system converged for  <dig> random initial conditions . it was observed that noisier results are generated in the simulation of systems with a cell number lower than  <dig>  due to the small size of the system and border effects. the relative importance of these anomalies decreases as the number of cells in the system increases. based on this observation, the following analysis considers systems with more than  <dig> cells. figure 3-a illustrates that the effect of d on the behavior of systems with different sizes is very similar, i.e., it is independent of the number of cells. this indicates stability and shows good behavior for the model since  is not expected to vary with the number of cells when the transport factor is kept constant. the effect of d on  is very weak and almost linear until d =  <dig> , indicating that low transport coefficient for pats could cause heterocyst proliferation and, consequently, reduce . starting from d =  <dig> , the effect increased dramatically until d =  <dig>  when heterocyst distance reaches a maximum. higher values of d generate a scenario where the transport of pats is greatly facilitated through the system. the saturation of the system with pats inhibits the generation of heterocysts leading to a maximum in . it was found that these curves follow a power law before saturation. the coefficient of determination for lh following a power law with the equation  law, where a, b and c are the adjustable parameters, were of r <dig> >  <dig>  in all cases. according to figure 3-a the behavior of the system, in terms of , could be controlled by means of the modification of d, the transport factor for pats. since the effects of changes in the transport of the pats pentapeptide are difficult to test in an experimental setting, the usefulness of a mathematical model is clear. the transport factor d necessary to reach a specific  is shown in figure 3-a. in particular, an average distance between heterocysts of ten cells  is obtained when d ≈  <dig> – <dig> . more accurate values require a closer examination as shown in figure 3-b.

the absolute value of deviation of  from  <dig>  , for several values of d is shown in figure 3-b. a lower value indicates a  closer to  <dig>  in this case  <dig> biologically feasible random initial conditions were used and d was sampled in the interval  every  <dig>  units. it was found that the transport factor  that minimizes the deviation dev <dig> in figure 3-b is  <dig>  for systems with  <dig> to  <dig> cells. using this d <dig> gives systems with 's only  <dig> % far from  <dig> . the average of those transport factors is  =  <dig>  ±  <dig> . based on this fact,  <dig>  will be used as the transport factor for the following simulations.

average distance between heterocysts for the wild type
histograms of lh for d =  are given in figure 4-a. this figure shows that the distance between heterocysts, lh, for systems with different numbers of cells follows a very similar distribution. in general, the shape of this distribution is narrow, not symmetrical and does not follow a normal distribution . the non-symmetrical shape of the histograms in figure 4-a indicates that the frequency of observing an lh < <dig> is higher than the frequency of lh > <dig>  in fact, for the case of the  <dig> cells system these frequencies are  <dig> % and  <dig> %, respectively. even so, figure 4-a shows that the distribution of lh is highly concentrated in the neighborhood of  <dig>  a fact that has been observed experimentally. our simulated results for the distribution of lh in wild type are consistent with the heterocyst spacing distribution observed experimentally by yoon and golden at  <dig> h with a number of vegetative cells between heterocysts ranging from  <dig> to  <dig> cells, peaking around  <dig> cells  <cit> . the model however does not capture the distribution observed at later culture times, where other factors such as cell death and decay may have an effect in the pattern distribution observed experimentally.

expression profiles between a pair of consecutive heterocysts
ntca expression profiles for cells located between two consecutive heterocysts are shown in figure  <dig>  given lh, ntca expression levels for a cell located at the ith position in the array corresponds to the average expression for all cells located at the ith position between two consecutive heterocysts. calculations were performed considering  <dig> random initial conditions, d = ,  <dig> cells, and lh =  <dig>   <dig> , <dig>  and  <dig>  note that, as shown in figure  <dig>  simulation results indicate that heterocysts are located at both ends of the array and have the highest ntca expression levels. ntca expression profiles in figure  <dig> are bell-shaped curves centered equidistantly from both heterocysts. therefore, maximum ntca expressions are observed for the cell located at position lh/ <dig>  due to the symmetry of inhibitory effects from hetr and pats . an average variability of less than  <dig> % was observed for the expression of ntca at any given position.

the maximum ntca expression levels change with lh and cell array size. in fact, as the distance between heterocysts increases, ntca expression increases, as corroborated by experimental observations. similarly, the inhibitory action of neighboring cells on ntca expression is reduced as the distance between heterocysts increases. if the distance between heterocysts is high enough, oxoglutarate levels will be high to enhance ntca expression on the cell located at position lh / <dig>  eventually, this expression will be high enough to enhance hetr expression and trigger cell differentiation into a heterocyst.

differentiation behavior as a result of external perturbations
the differentiating behavior of vegetative cells into heterocysts is triggered by external disturbances on nitrogen levels, and the cellular response to these disturbances based on its internal characteristics. in the presence of nitrogen, ntca expression is reduced and differentiation does not occur. on the other hand, nitrogen absence will trigger ntca expression and the chain of interactions leading to the differentiation of some cells   <cit> .

the model presented in this paper is able to capture both of these behaviors, as has been shown in the previous sections. as an illustration, a case study is shown.

spacing distribution for the wild type in the presence and absence of nitrogen source
a system of  <dig> cells was simulated, considering a transport factor  =  <dig> , with  <dig> randomly chosen initial conditions. for this scenario, random uniformly distributed binary initial conditions were considered, restricted to biologically feasible scenarios. since cell death is not considered in the model, ntca and hetr must be considered as being turned off initially. else the system would exhibit heterocysts initially and these heterocysts would remain throughout the simulation. figure 6-a and 6b show the convergent state achieved by this system. in the presence of nitrogen , no cellular differentiation into heterocysts is observed. on the other hand, figure 6-b shows that some cells differentiate into heterocysts in the absence of nitrogen, with an average distance of approximately  <dig> cells. in this case no restrictions are considered on initial conditions.

spacing distribution for pats knock-out and over-expression systems
it has been reported that genetic manipulation of the gene network involved in cell differentiation into heterocysts does change the differentiation pattern observed. two extreme examples are the knock-out and over-expression of pats  <cit> . simulation of the differentiation of an array of 100– <dig> cells with d =  with knocked-out expression of pats was performed.  <dig> randomly chosen initial conditions were considered. figure 6-c shows that for pats knock-outs the inhibitory effect of pats is reduced, therefore decreasing the average distance between heterocysts and even allowing the formation of heterocyst clusters in some cases. results in figure 6-c are supported by lh histograms shown in figure 4-b. these results indicate that knocking-out the expression of pats shifts lh distribution, significantly shortening the average distance between heterocysts, , compared to the wild type  , as observed experimentally  <cit> . this is consistent with the results presented in a previous model, where mutation of pats is reported to lead to a larger number of heterocysts  <cit> . table  <dig> shows that  for pats knock-outs in systems with 100– <dig> cells is lower than  <dig> cells, and very similar for all systems. in fact, the frequency of observed  < <dig> is around  <dig> %, almost twice as much as the wild type with normal pats expression. in addition, standard deviations for pats knock-out are higher than those for the wild type, indicating that knocking-out pats produces an increase in the variability of . our simulated results for the distribution of lh in pats knock-outs are consistent with the heterocyst spacing distribution reported for a pats deletion strain  <dig> h after nitrogen step down. in this case the number of vegetative cells between hetercysts ranges from  <dig> to  <dig> cells, peaking around  <dig> cells. heterocysts spacing distribution becomes broader compared to wild type, peaking towards small intervals. the model however, does not match the exact distribution observed experimentally after prolonged culturing, which becomes broader as the culture progresses  <cit>  for the same reasons pointed out in the previous case.

over-expression of pats was also simulated. to our knowledge, this condition has not been explored theoretically with a mathematical model for heterocyst differentiation. in this scenario, simulation results obtained with the present model exhibit a behavior equivalent to that shown in figure 6-a, i.e. higher expression of pats completely inhibits differentiation into heterocysts.

spacing distribution for hetr knock-out and over-expression systems
hetr has been identified as a key factor in heterocyst differentiation. the effect of knocking-out and over-expressing hetr was also simulated, considering an array of 100– <dig> cells with d =  with  <dig> randomly chosen initial conditions.

as expected, if hetr is knocked-out no heterocysts are formed  <cit> . however, hetr over-expression leads to heterocyst differentiation and the formation of heterocyst clusters as shown in figure 6-d. the pattern obtained is similar to the one observed for pats knock-out. figure 6-c and 6d respectively, show that the knock-out of pats has a stronger effect than the over-expression of hetr on differentiation into heterocysts, compared to the wild type in figure 6-b. results in figure 6-d are supported by lh histograms shown in figure 4-c. these results indicate that over-expression of hetr also shifts lh distribution, lowering the average distance between heterocysts , compared to the wild type . this phenomenon has also been observed experimentally  <cit> .

there are no previous reports on the theoretical exploration of the over-expression of hetr using a mathematical model for the gene network involved in heterocyst differentiation. over-expression of hetr may also lead to the formation of heterocysts under normally repressing conditions when the gene is controlled by an external factor. in the present system, this corresponds to an over-expressed hetr scenario where biologically feasible initial conditions are only restricted to ntca being off. simulation results for this case are shown in figure 6-e: heterocyst formation is observed even in the presence of nitrogen , which is consistent with the experimental observations reported  <cit> .

final remarks
additional factors such as cell growth and death were not considered as they do not affect directly the main activator-inhibitor mechanism. three types of parameters are considered in this model; parameters related to transport , dynamics  and a threshold . the system shows to be robust for perturbations in the first two types of parameters, and not surprisingly, very sensitive to changes in θ, which results to be critical as it represents the limit that defines wether a particular element in the network is active or not. it is possible to capture the stable states of the system if the parameters are chosed adequately considering a biological interpretation of the network.  the model allows flexibility in the selection of values for the matrix a.

although the parameters used have not been biologically validated, they retain biological meaning . in addition, given the characteristics of the implementation, the system can be extended to two and three dimensions.

it is important to note that this model, as other activation-inhibition type models, does not consider any assumptions regarding pats. it is often said that it is essential that pats remains inactive until processed in a neighboring vegetative cells for heterocyst-forming cyanobacteria to be able to succesfully activate hetr and therefore achieve their characteristic differentiation pattern. here, no additional assumptions are considered on pats, and in fact pats may act on the cell on which it is produced and still a heterocyst develops, as long as the inhibitory effect is smaller than the counteracting activators effect acting on the same cell.

additionally, no restrictions are imposed on the range of action of the differentiation activator hetr and the inhibitor pats. regardless of these assumptions, the model successfully captures the differentiation pattern observed experimentally for the initial stages of culture. this indicates that it may be possible for the system to achieve the characteristic pattern of heterocyst spacing, without a refractability condition on heterocysts to the action of pats as discussed in most reviews. even if pats inhibited hetr self-activation in the cell where it is produced, pattern formation would be possible if the magnitude of the inhibitory effect on hetr was smaller than hetr self-activation.

one interesting thing is that the pattern formation characteristics naturally emerge from the system without data fitting, since the only parameter that was tuned is the transport factor d. this evolution model was not intended to capture the transient dynamics of the system, but to capture qualitatively the final spacing distribution observed. the simple gene network proposed is able to capture some of the main characteristics of the spacing pattern observed for heterocyst differentiation, with good agreement between simulation and experimental results both for wild type and for perturbations in the gene network.

CONCLUSIONS
in this paper the differentiating behavior of cyanobacteria into heterocysts has been studied by means of a mathematical model. a simple gene network which is capable of capturing the complexity of the differentiation process in this cellular system is proposed.

specific characteristics of the behavior observed experimentally in the presence/absence of nitrogen can be reproduced by the proposed system. the model presented explains how heterocyst-forming cyanobacteria counts to  <dig>  the basic regulatory network elements required and the effect of diffusion on the spacing pattern observed. however, the reason why the system has evolved to this characteristic heterocyst distance remains to be explained. it appears that this has to do with the diffusional characteristics of the inhibitor pats and the trade-off between resource requirements for heterocysts differentiation vs. their nitrogen fixing capabilities.

in particular, the model reports an average distance between two heterocysts equal to  <dig> cells, which is one of the most significant characteristics displayed by these systems. in addition, standard deviations of this magnitude were in accordance with the variability observed experimentally  <cit> .

specific details were also investigated, such as ntca profiles between two consecutive heterocysts. in this case, simulations results also show a good agreement with experimental observations. over-expression and knock-out of pats and hetr were also studied. the model is capable of simulating the qualitative behavior of heterocyst-forming cyanobacteria for these scenarios, capturing their distinctive characteristics, for instance: formation of high density clusters of heterocyst or complete inhibition of differentiation in the case of knocked-out and over-expression of pats, respectively. in the case of hetr the opposite behavior is observed: knocking-out hetr completely prevents the formation of heterocysts. on the other hand, over-expression of hetr leads to the formation of heterocyst clusters, but with a lower density and size than observed for pats knock-out. these results validate the proposed network structure.

list of abbreviations used
genes and gene products: ntca: ntca gene; hetr: hetr gene; pat: pats gene; pat: pata gene; ntca: ntca protein; hetr: hetr protein; pats: pats protein; pata: pata protein. vector, matrices and others: cext: extracellular interaction matrix; cint: intracellular interaction matrix; a: global interaction matrix; f: mapping function; x: cellular state vector; u: external input vector; θ: threshold levels vector; d: normalized transport factor.

competing interests
the authors declare that they have no competing interests.

authors' contributions
zpg proposed the genetic network to be considered as a system, designed in silico experiments, performed biological interpretation of the results, drafted and revised the manuscript. jcs programmed the algorithm, performed results analysis, designed in silico experiments and drafted the manuscript. ao proposed the discrete autocatalysis-inhibition model and programmed the main core of the algorithm used. all authors participated in development of the methods and preparation of the manuscript. all authors read and approved the final manuscript.

