BACKGROUND
high-throughput arrays such as array comparative genomic hybridization  and single nucleotide polymorphism  arrays provide high resolution maps of deletions and duplications. such maps have been used to characterize the extent of cnvs in normal populations such as hapmap
 <cit>  and to study the association of duplications and deletions in case-control study designs
 <cit> . a popular alternative to the case-control is the case-parent trio design, comprised of affected offspring and unaffected parents. de novo cnvs are of particular interest in case-parent trios for their potential to have a functional role in the genesis of the disease phenotype. while numerous methods for detection of cnvs in independent samples are available, there are comparatively few statistical methods for the detection of de novo cnvs in case-parent trios. comparisons of alternative algorithms for de novo cnv detection have been limited and the extent to which technical artifacts such as genomic waves
 <cit>  and batch effects
 <cit>  contribute to false positive identifications has not been well described.

among the predominant algorithms for array-based cnv discovery are segmentation algorithms that segment the genome into regions of constant copy number
 <cit>  and hidden markov models  that simultaneously segment and classify the latent copy number. segmentation algorithms for copy number have been extended to accommodate multi-sample inference, including segmentation of paired tumor-normals
 <cit>  and independent samples
 <cit> . post hoc approaches for classifying the gain or loss of copy number from segmentation methods have been proposed
 <cit> . similarly, hmm algorithms were originally formulated for acgh platforms
 <cit>  and many innovations were subsequently proposed. for example, distance-based transition probabilities
 <cit> , fully bayesian hmms
 <cit> , reversible jump and approximate sampling markov chain monte carlo 
 <cit> , iterative approaches to parameter estimation
 <cit> , alternatives to the viterbi algorithm
 <cit> , and higher order markov chains
 <cit> . as hmms readily accomodate multiple data sequences, the observation that copy number can be estimated from genotyping arrays
 <cit>  led to the development of several hmms that jointly model copy number and genotypes at snps
 <cit> .

statistical methods for the detection of de novo cnvs in case-parent trios have evolved from two-stage models to joint models. for the former, an hmm or segmentation method is fit independently to each sample of a trio and post hoc classification is obtained by identifying non-overlapping cnv in the offspring
 <cit>  or through posterior calling algorithms that incorporate probabilistic models of mendelian cnv transmission
 <cit> . while hmms and segmentation methods for the analysis of multiple samples are available
 <cit> , these approaches target the detection of recurrent cnv in independent samples as opposed to de novo cnv in related samples. ultimately, the two-stage posterior calling algorithm led to a joint hmm implemented in the software penncnv that simultaneously integrates measures of relative copy number and allele frequencies of a parent-offspring trio
 <cit> . throughout this paper, we refer to measures of relative copy number and allele frequencies as log r ratios and b allele frequencies, respectively, as defined previously
 <cit> . the joint hmm outperforms the two-stage predecessor in a comparison of the two approaches
 <cit> .

in this paper, we apply a wave correction procedure
 <cit>  implemented as part of the joint hmm to a case-parent study of oral clefts. our findings motivate an alternative marker-specific measure of relative copy number, the minimum distance, that directly exploits the trio design. we use a standard single-sample segmentation algorithm to segment the univariate minimum distance and maximum a posteriori estimation to infer the de novo status of each segment. we compare the minimumdistance algorithm to the joint hmm on simulated data and the oral cleft study. as the discovery of de novo deletions were identified as a priority by our epidemiologic collaborators for the oral cleft study, we give particular emphasis to findings with respect to de novo deletions. the r package minimumdistance is available from bioconductor
 <cit> .

RESULTS
motivation
the main objective of our research is the delineation of copy number alterations present in the offspring that differ from parental copy numbers , with an emphasis on false positive identifications and computational speed. we evaluate these issues on a case-parent study of  <dig>  oral cleft trios.

we applied the joint hmm implemented in penncnv with wave correction to the oral cleft trios. the analysis required an average of  <dig> minutes for a single trio and approximately  <dig>  weeks for the oral cleft study when computation was distributed across  <dig> high performance nodes. among  <dig>  trios passing quality control , the median number of de novo calls was  <dig> with an interquartile range of  <dig> to  <dig>  to assess batch differences in the de novo call frequencies, we use the chemistry plate on which the samples were processed as a surrogate. we observed statistically significant differences by batch for the median absolute deviation  log r ratio . while quality control removed trios for which the mad and corresponding call frequencies were extreme, the mean mad for each batch was positively correlated with the mean frequency of de novo deletion calls .

to identify data characteristics contributing to unusually high de novo deletion call frequencies, we plotted the log r ratios and b allele frequencies against their genomic physical position. in many trios with high de novo deletion frequencies, we observed smooth genomic waves with inferred breakpoints alternating between diploid and deletion states coinciding with regions of homozygosity. for example, a trough of approximately  <dig> mb on chromosome  <dig> spans a  <dig> kb de novo deletion as well as several transmitted cnv called by penncnv . a very similar trough is evident in the father and to a lesser degree in the mother . while it appears incongruous that the copy number is not the same for the parents and offspring, regions of homozygous genotypes with corresponding b allele frequency emissions near  <dig> and  <dig> in the parents and offspring demarcate the called deletion boundaries . specifically, paternally transmitted deletions are called in regions of the trough in which both the father and offspring are homozygous, maternally transmitted deletions are called in regions of the trough in which the mother and offspring are homozygous, and a de novo deletion is called where only the offspring is homozygous. an alternative explanation for the data is that the trough is promoting a false deletion state. as heterozygous b allele frequency emissions are informative for diploid copy number, the hmm captures regions in which there are no heterozygous genotypes to oppose the deletion state that is favored by the negative log r ratios in the trough. to the extent that regions of homozygosity are common and genomic waves persist following wave correction, the de novo call frequencies may far exceed the true number of de novo cnvs. for example, the trio featured in figure
 <dig> has  <dig> de novo cnvs, or nearly 20-fold the median frequency in the oral cleft study.

algorithm
definition of the minimum distance
consider the difference in log r ratio  between offspring  and father  at a single marker, calculated as ro−rf. we denote the paternal distance by δf. a comparable calculation for offspring and mother provides a measure of the maternal distance, denoted by δm. we define the minimum distance between parents and offspring as 

  d=arg minδ∈{δf,δm}|δ|. 

the calculation is easily vectorized in r and its computation for ≈  <dig>  log r ratios obtained from illumina’s  <dig> quad array for a single trio is nearly instantaneous. denoting the minimum distance vector by d, consecutive negative or positive values in a genomic interval suggest dna copy number loss or gain, respectively, relative to the most similar parental copy number. although its calculation at a given marker is independent of the neighboring markers, the minimum distance can reduce technical variation from correlated probe-effects as well as the peaks and troughs of genomic waves that vary smoothly over large regions of the genome . alternatives to d include the difference of the offspring log r ratios and the cnv-transmitting parent. however, such an alternative requires inference of the cnv-transmitting parent and a trade-off in variance when technical factors such as wave and probe effects in the offspring are more correlated with the non-cnv transmitting parent.

segmentation of the minimum distance
single-sample segmentation algorithms applied to the univariate d can be used to identify breakpoints of potentially de novo cnvs. we currently favor circular binary segmentation 
 <cit>  for its maturity in the bioconductor package dnacopy and its use as a benchmark in comparison papers for cnv detection algorithms
 <cit> . nonstandard options for cbs implemented in minimumdistance include special handling of large gaps in the array’s coverage of the genome  and a pruning step to remove breakpoints that is a function of the number of markers on a segment  and the standardized difference in segment means .

the minimum distance can reduce artifacts that are shared by one or both parents and the offspring. in the motiving example , we argue that genomic waves contribute to false de novo and transmitted deletions when the trough of a genomic wave spans regions lacking heterozygous genotypes. application of cbs to d calculated in the motivating example smooths the trough of the genomic wave , thereby avoiding local maxima in the likelihood identified by the joint hmm. the subsequent classification of the trio copy number  for the minimum distance segment spanning the trough overwhelmingly favors a diploid trio copy number state due to the large number of heterozygous genotypes in the broader region.

as the minimum distance is a relative measure, regions with non-zero minimum distance do not necessarily indicate de novo cnvs. for example, a  <dig> kb region with positive d on chromosome  <dig> suggests a de novo duplication . however, visual inspection of the b allele frequencies and log r ratios reveals deletions in both parents while the offspring is diploid . to avoid false positive de novo cnv calls for regions such as chromosome  <dig>  estimation of the absolute copy numbers is needed. we use maximum a posteriori estimation to infer the absolute copy numbers, as described in the following section.

maximum a posteriori estimation
we classify the copy number states of the minimum distance segments using a fully probabilistic model based in part on the joint hmm. our approach delineates de novo events by finding the mode of the distribution of p over the set of possible trio states. more formally, the maximum a posteriori estimate for the trio copy number for candidate segment l is defined as 

  s^l=arg maxsl∈spifl=1arg maxsl∈spifl> <dig>  

the vector sl contains the copy number state symbols for the trio denoted as xyz, where x is the state symbol for the father, y is the state symbol for the mother, and z is the state symbol for the offspring. the copy number state symbols are  <dig> = homozygous deletion,  <dig> = hemizygous deletion,  <dig> = diploid copy number,  <dig> = single copy gain, and 6=two copy gain. the triplet  <dig>  for example, corresponds to a de novo hemizygous deletion in the offspring. these integer state symbols are used to be consistent with penncnv, and are subject to change in the software implementation of minimumdistance. the set of  <dig> biologically plausible trio copy number states is denoted by s, and excludes  <dig> of the  <dig> possible combinations of trio states in which the parents are both homozygous null and the offspring has one or more copies. the parameter Θ denotes other parameters for our model, including the transition probabilities and initial state probabilities. the matrices of b allele frequencies  and log r ratios  are nl ×  <dig> matrices where nl is the number of markers spanned by the segment l  and columns are individuals in the trio. we remark that the ratio of
p to the probability of a trio of diploid copy numbers can be used to rank de novo cnvs.

the conditional probability of the trio copy number in equation  can be re-expressed using bayes’ rule as a product of the likelihood and the joint probability of the copy number states.  as a posterior probability.) factoring the joint probability of the trio state as in wang et al. <cit> , we write the posterior probability as 

  p∝pp×∏k∈{f,m}p 

for the first segment and 

  p∝p×p×∏k∈{f,m}pp 

for segments l >  <dig>  this is a first order markov model incorporating terms p and p for mendelian transmission of cnvs as implemented in the joint hmm
 <cit> , but assessed on previously determined dna segments . assuming conditional independence of the log r ratios and b allele frequencies given the unobserved copy number states, the likelihood is 

 p=∏k∈{f,m,o}∏i∈lpp. 

 as copy number estimates from hybridization-based arrays are noisy, our goal is to estimate the likelihood robustly.

our approach for robust-to-outlier estimation of a sample’s log r ratio likelihood is predicated on a mixture distribution for the emitted log r ratios. specifically, for individual k of a trio and marker i, we assume a mixture distribution for the log r ratio given by 

  ri,k|s,μr,k,s,σr,k,s,εr,k∼n+εr,ku, 

where the normal component captures within-sample variation for copy number state s and the uniform component captures outliers arising from technical artifacts that we assume to be independent of the latent copy number. the parameter εr,k is the probability of observing an outlier log r ratio in sample k. similar mixture models have been proposed for acgh
 <cit> , and adapted here for genotyping platforms. estimation of the parameters for the means, variances, and outlier mixture probabilities is carried out via the baum-welch algorithm as described in the methods section
 <cit> .

with the exception of the homozygous null state, robust-to-outlier estimation of the b allele frequency likelihood for a sample is also implemented via a mixture model. in particular, for positive copy number states we assume a theoretical mixture distribution given by 

  bi,k|s,s≠ <dig> μb,g,k,σb,g,k∼∑g∈gtspi,gtn+εb,ku, 

where the truncated-normal  mixture captures within-sample heterogeneity of the b allele frequencies over the possible genotypes for state s  and the uniform zero-one density captures technical variation that we assume to be independent of the genotype and copy number state. as b allele frequencies are thresholded to the  <cit>  interval, the proportion of outlier log r ratios, εr,k, does not necessarily correspond to the proportion of outlier b allele frequencies given by εb,k, motivating their separate parameterization. the mixture probability pi,g is estimated from a binomial density parameterized by the frequency of the a allele for genotype g  and the population frequency of the a allele. estimation of the parameters for the means, variances, and outlier mixture probabilities for the b allele frequencies are estimated via the baum-welch algorithm as described in the methods section. for the homozygous null state, we assume the b allele frequencies are emitted from a uniform zero-one distribution.

the likelihood in equations  and  is multiplied by terms involving the conditional probability of the offspring copy number, the initial state probability of the parental copy numbers , and transition probabilities for the parental copy numbers . we calculate the conditional probability for the offspring copy number by integrating out  mendelian and non-mendelian models for cnv transmission. the derivation of the conditional probability is similar to the derivation in the joint hmm, but indexed over segments instead of markers. we leave the mathematical details to additional file
 <dig>  and specification of the initial state and transition probabilities to section methods. multiplication of these terms with the likelihood provides an estimate of the posterior probability. repeating the estimation procedure for each of the  <dig> possible trio states, we obtain a distribution of the posterior probability. the mode of this distribution is the maximum a posteriori estimate. conditional on the maximum a posteriori estimate at segment l, we repeat the procedure for segment l +  <dig> until maximum a posteriori estimates are available for all segments.

segmentation and maximum a posteriori estimation are performed independently for each chromosomal arm and each trio, enabling an embarrassingly parallel implementation. computational speed is derived from the parallel architecture and the implementation of the computationally intensive maximum a posteriori estimation  on a set of segments that is typically several orders of magnitude smaller than the number of markers on the array.

simulation study
to assess the performance of penncnv and minimumdistance when the true cnv are known, we simulated chromosomes containing four de novo and four inherited copy number deletions spanning as few as  <dig> markers and as many as  <dig> markers. we additionally simulated three regions of homozygosity of  <dig>   <dig>  and  <dig> markers in the offspring that were diploid in copy number and spanned by the trough of a simulated wave . log r ratios for a trio were sampled from a 3-dimensional multivariate normal distribution under  <dig> different parameterizations of the covariance for the trio . b allele frequencies for the offspring were simulated to be consistent with mendelian transmission.

we define false positives  as the number of markers in normal regions called de novo and false negatives  as the number of markers in de novo regions called normal. overall, the correlation of fp for minimumdistance and penncnv was low. on average, the fp frequency is higher for the joint hmm than for minimumdistance with several chromosomes having relatively high fp in penncnv and low fp in minimumdistance . for synthetic chromosomes in which both methods have low fp rates, penncnv does slightly better than minimum distance . the low fp rate for at least one method in nearly all of the simulations suggests that de novo cnvs called by both methods on experimental data are more likely to be truly de novo. unlike fp frequencies, fn frequencies for penncnv and minimumdistance are comparable with both methods doing well  or poorly  on the same chromosome .

to assess how incorrect calls were distributed among the different cnvs, we calculated the proportion of the  <dig> chromosomes for which  <dig> percent or more of the markers in the cnv were classified incorrectly. none of the transmitted deletions had more than 50% of the markers called de novo by either method. diploid regions of homozygosity had elevated fp rates in penncnv, although the difference was not statistically significant . for de novo cnv, minimumdistance correctly called a higher percentage of the 10-marker features than penncnv , while penncnv performed well relative to minimumdistance for detecting large de novo features under simulations with high log r ratio variance . approximately  <dig> percent of the oral cleft trios had mads less than  <dig> , a scenario in which minimumdistance fn rate was comparable or better than penncnv .

case study of oral clefts
we assessed the performance of minimumdistance and penncnv on a set of oral cleft trios obtained from the international consortium of oral clefts and genotyped on illumina’s  <dig> quad array as part of the gene, environment, association studies consortium
 <cit> . from a computational vantage point, minimumdistance was clearly preferable. penncnv’s joint hmm required an average of  <dig> minutes for a single trio. without parallel processing, the minimumdistance algorithm required an average of  <dig> minutes to process  <dig> autosomes of a single trio and approximately  <dig> minutes using  <dig> cpus. one trade-off is that minimumdistance uses approximately 17g ram while penncnv requires less than 3g ram. in practice, the increase in computational speed using minimumdistance will depend on i/o, the number of cpus available, and ram constraints.

when assessing the concordance of de novo hemizygous deletions called by minimumdistance and penncnv on  <dig>  oral cleft trios that passed quality control , we found that the 50th and 75th.. the 95th and 99th corresponding to  <dig> and  <dig> de novo alterations, respectively, in penncnv compared to  <dig> and  <dig>  alterations in minimumdistance. minimumdistance called a total of  <dig>  de novo deletions in  <dig> trios versus  <dig>  de novo deletions in  <dig> trios called by penncnv. nearly  <dig> percent of the penncnv de novo deletions  occur in just  <dig> percent  of the trios. the  <dig> trios that harbor  <dig> percent of the de novo deletions were processed on the  <dig> chemistry plates having the highest log r ratio mad . the spearman correlation coefficient of the plate-wise mean mad and the plate-wise mean de novo frequency is  <dig> , suggesting a batch effect induced by differences in noise across plates even after quality control. conversely, minimumdistance calls  <dig> de novo deletions  in the same trios .

to systematically evaluate concordance of penncnv and minimumdistance, we created a list of the de novo deletions for each method ordered by decreasing coverage. we assessed concordance using three complimentary approaches:  the concordance at the top  defined as the proportion of de novo deletions appearing in the top of both lists
 <cit> ,  the proportion of top penncnv de novo deletions appearing anywhere in the minimumdistance list, and  the proportion of top minimumdistance de novo deletions appearing anywhere in the penncnv list. plotting the concordance as a function of list size, the cat decreases from 100% for a size one list to 44% for a size  <dig> list . whereas  <dig> of the top  <dig> minimumdistance hits are corroborated by penncnv , only  <dig> of the top  <dig> penncnv hits are corroborated by minimumdistance . while the proportion of top minimumdistance calls detected by penncnv is  <dig> percent for a list of size  <dig> and trending downward, the concordance stabilizes at  <dig> percent when minimumdistance calls are ranked by the ratio of the maximum a posteriori probability to the posterior probability of diploid copy numbers in the trio .

for de novo deletions with high coverage called by only one method, many appear to be artifacts with the number of apparent false positives in penncnv nearly double that of minimumdistance. as in the motivating example , penncnv-only de novo deletions tend to have troughs that are shared by members in the trio . apparent false positives in the minimumdistance-only calls occur in complex cnv in which the minimum distance breakpoints may span both de novo and transmitted cnv or as a result of genomic waves that are slightly inverted in the offspring compared to the parents . minimumdistance captures at least one region in which the de novo cnv appears to be a false negative in penncnv .

in terms of concordance, de novo cnvs identified by both methods appear to be more amenable to experimental validation. nearly half of the  <dig> concordant de novo calls that rank high by each method in terms of coverage occur on chromosome  <dig> . visual inspection of the log r ratios, b allele frequencies, and minimum distance for these trios is consistent with the de novo inference . using qpcr for experimental validation of the apparent de novo cnvs in four trios, we summarize the inter-platform concordance by the minimum distance of the log r ratio segment means from the illumina platform and the minimum distance of the copycallertm copy number estimates from the qpcr platform
 <cit> . a scatterplot of the minimum distance reveals two clusters separating in both the x- and y-dimensions according to whether the probes on the illumina  and the taqman qpcr probes  are spanned by the de novo cnv  or flank the de novo cnv . this region on chromosome  <dig>  known as the digeorge critical region, has been previously implicated in syndromic forms of cleft palate
 <cit> .

CONCLUSIONS
genomic wave correction in conjunction with the joint hmm for case-parent trios is perhaps the de facto analysis for inferring de novo cnv, yet we find a number of de novo calls that appear to be artifacts of genomic waves and call rates that are correlated with batch . we propose a simple, univariate measure of relative copy number that can reduce local and global sources of heterogeneity such as probe-effects and genomic waves, respectively, and can be segmented by standard, single-sample segmentation algorithms. we use the method of maximum a posteriori estimation for inferring the de novo status of segments. key terms in the posterior probability are the likelihood, which we estimate robustly, and the probability of the offspring copy number conditional on the parental copy numbers. we compute the latter term by integrating over mendelian and non-mendelian models for cnv transmission, using tabled probabilities from the joint hmm directly for the mendelian model. the minimumdistance algorithm is several-fold faster than the joint hmm without any apparent trade-off in sensitivity or specificity as assessed by simulation. unlike penncnv, the frequency of de novo calls by minimumdistance appears robust to differences in noise across batches and robust to genomic waves occurring in trios. de novo calls with high coverage that were concordant between methods include several de novo deletions and amplifications in the digeorge critical region on chromosome  <dig>  four of which were subsequently validated by qpcr. as the digeorge critical region is known to be important for syndromic disorders that include craniofacial abnormalities, the de novo deletions from independent trios with non-syndromic oral cleft may help identify genes responsible for oral clefts. this finding, verifiable by both de novo detection algorithms, was obtained with a nearly 8-fold reduction in computational time using minimumdistance.

our approach for de novo cnv detection can have several limitations. first, the set of candidate breakpoints identified by segmenting the minimum distance are relevant only for identifying genomic regions in which the offspring copy numbers differ from the parental copy numbers. breakpoints for transmitted cnv are only detectable when the copy number estimates within the cnv differ in magnitude between parents and offspring. secondly, while genomic waves are strongly correlated with gc content, differences in direction or magnitude of waves across samples are not uncommon. previous studies suggest that differences in dna quantity contribute to inversions of the genomic waves between samples
 <cit> . while we observed that the waves were often comparable within a trio, this assumption requires verification. to the extent that we can detect inversions, future versions of minimumdistance may provide warnings of such artifacts or apply methods to correct for those artifacts. finally, the minimumdistance algorithm is only defined for autosomal chromosomes.

a potential criticism of the current study is that we have evaluated a novel method on a dataset that has not been well studied for cnvs in the literature. while hapmap has been comprehensively characterized by several platforms and statistical methods, there are limitations. first, the cell lines used in hapmap studies have a signal to noise ratio much higher than the signal to noise ratio observed in dna isolated from experimental studies such as the oral cleft dataset. in fact, our approach was motivated by the technical variation shared among trios in the oral cleft study. secondly, a recent study failed to identify de novo cnvs in hapmap, identifying instead somatic changes or possible problems with the cell lines
 <cit> . finally, while one could conceptually use the available hapmap trios to derive a null distribution for the frequency of recurrent de novo cnv in healthy populations, the practical benefit of such a null would be limited as many of the recurrent de novo regions in the oral cleft study occur in fewer than  <dig> in  <dig> offspring. due to these limitations and the absence of confirmed de novo cnvs in both the oral cleft study and hapmap, we have evaluated the methods by simulation and visual inspection of the low-level summaries. one consequence of the latter is that we avoid low coverage de novo calls as visual inspection of such regions tend to be inconclusive.

