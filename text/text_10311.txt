BACKGROUND
high-throughput technologies, based on microarray and rna-sequencing, are now being used to identify biomarkers or gene signatures that distinguish disease subgroups, predict cell phenotypes or classify responses to therapeutic drugs. however, few of these findings are reproduced when assessed in subsequent studies and even fewer lead to clinical applications  <cit> . the poor reproducibility of identified gene signatures is most likely a consequence of high-dimensional data, in which the number of genes or transcripts being analysed is very high  relative to a comparatively small sample size being used .

one way to increase sample size is to combine raw data from independent experiments in an integrative analysis. this would improve both the statistical power of the analysis and the reproducibility of the gene signatures that are identified  <cit> . however, integrating transcriptomic studies with the aim of classifying biological samples based on an outcome of interest  has a number of challenges. transcriptomic studies often differ from each other in a number of ways, such as in their experimental protocols or in the technological platform used. these differences can lead to so-called ‘batch-effects’, or systematic variation across studies, which is an important source of confounding  <cit> . technological platform, in particular, has been shown to be an important confounder that affects the reproducibility of transcriptomic studies  <cit> . in the microarray quality control  project, poor overlap of differentially expressed genes was observed across different microarray platforms , with low concordance observed between microarray and rna-seq technologies specifically  <cit> . therefore, these confounding factors and sources of systematic variation must be accounted for, when combining independent studies, to enable genuine biological variation to be identified.

the common approach to integrative classification is sequential. a first step consists of removing batch-effect by applying for instance combat  <cit> , fabatch  <cit> , batch mean-centering  <cit> , lmm-eh-ps  <cit> , ruv- <dig>  <cit>  or yugene  <cit> . a second step fits a statistical model to classify biological samples and predict the class membership of new samples. a range of classification methods also exists for these purposes, including machine learning approaches  as well as multivariate linear approaches .

the major pitfall of the sequential approach is a risk of over-optimistic results from overfitting of the training set. this leads to signatures that cannot be reproduced on test sets. moreover, most proposed classification models have not been objectively validated on an external and independent test set. thus, spurious conclusions can be generated when using these methods, leading to limited potential for translating results into reliable clinical tools  <cit> . for instance, most classification methods require the choice of a parameter , which is usually optimised with cross-validation . unless the removal of batch-effects is performed independently on each fold, the folds are not independent and this leads to over-optimistic classification accuracy on the internal test sets. hence, batch removal methods must be used with caution. for instance, combat can not remove unwanted variation in an independent test set alone as it requires the test set to be normalised with the learning set in a transductive rather than inductive approach  <cit> . this is a clear example where over-fitting and over-optimistic results can be an issue, even when a test set is considered.

to address existing limitations of current data integration approaches and the poor reproducibility of results, we propose a novel multivariate integrative method, mint. mint is the first approach of its kind that integrates independent data sets while simultaneously, accounting for unwanted  variation, classifying samples and identifying key discriminant variables. mint predicts the class of new samples from external studies, which enables a direct assessment of its performance. it also provides insightful graphical outputs to improve interpretation and inspect each study during the integration process.

we validated mint in a subset of the maqc project, which was carefully designed to enable assessment of unwanted systematic variation. we then combined microarray and rna-seq experiments to classify samples from three human cell types , human embryonic stem cells  and human induced pluripotent stem cells ) and from four classes of breast cancer . we use these datasets to demonstrate the reproducibility of gene signatures identified by mint.

methods
we use the following notations. let x denote a data matrix of size n observations  ×p variables  and y a dummy matrix indicating each sample class membership of size n observations  ×k categories outcome . we assume that the data are partitioned into m groups corresponding to each independent study m: {,y
),…,,y
)} so that ∑m=1mnm=n, where n
m is the number of samples in group m, see additional file 1: figure s <dig>  each variable from the data set x
 and y
 is centered and has unit variance. we write x and y the concatenation of all x
 and y
, respectively. note that if an internal known batch effect is present in a study, this study should be split according to that batch effect factor into several sub-studies considered as independent. for n∈ℕ, we denote for all a∈ℝn its ℓ
 <dig> norm ||a||1=∑1n|aj| and its ℓ
 <dig> norm ||a||2=∑1naj21/ <dig> and |a|+ the positive part of a. for any matrix we denote by ⊤ its transpose.

pls-based classification methods to combine independent studies
pls approaches have been extended to classify samples y from a data matrix x by maximising a formula based on their covariance. specifically, latent components are built based on the original x variables to summarise the information and reduce the dimension of the data while discriminating the y outcome. samples are then projected into a smaller space spanned by the latent component. we first detail the classical pls-da approach and then describe mgpls, a pls-based model we previously developed to model a group  structure in x.


pls-da partial least squares discriminant analysis  <cit>  is an extension of pls for a classification frameworks where y is a dummy matrix indicating sample class membership. in our study, we applied pls-da as an integrative approach by naively concatenating all studies. briefly, pls-da is an iterative method that constructs h successive artificial  components t
h=x
h
a
h and u
h=y
h
b
h for h= <dig> ..,h, where the h
th component t
h  is a linear combination of the x  variables. h denotes the dimension of the pls-da model. the weight coefficient vector a
h  is the loading vector that indicates the importance of each variable to define the component. for each dimension h= <dig> …,h pls-da seeks to maximize 
  <dig> max||ah||2=||bh||2=1cov, 


where x
h,y
h are residual matrices . the pls-da algorithm is described in additional file 1: supplemental material s <dig>  the pls-da model assigns to each sample i a pair of h scores  which effectively represents the projection of that sample into the x- or y- space spanned by those pls components. as h<<p, the projection space is small, allowing for dimension reduction as well as insightful sample plot representation . while pls-da ignores the data group structure inherent to each independent study, it can give satisfactory results when the between groups variance is smaller than the within group variance or when combined with extensive data subsampling to account for systematic variation across platforms  <cit> .


mgpls multi-group pls is an extension of the pls framework we recently proposed to model grouped data  <cit> , which is relevant for our particular case where the groups represent independent studies. in mgpls, the pls-components of each group are constraint to be built based on the same loading vectors in x and y. these global loading vectors thus allow the samples from each group or study to be projected in the same common space spanned by the pls-components. we extended the original unsupervised approach to a supervised approach by using a dummy matrix y as in pls-da to classify samples while modelling the group structure. for each dimension h= <dig> …,h mgpls-da seeks to maximize 
  <dig> max||ah||2=||bh||2=1∑m=1mnmcovxhah,yhbh, 


where a
h and b
h are the global loadings vectors common to all groups, th=xhah and uh=yhbh are the group-specific  pls-components, and xh and yh are the residual  matrices. the global loadings vectors  and global components  enable to assess overall classification accuracy, while the group-specific loadings and components provide powerful graphical outputs for each study that is integrated in the analysis. global and group-specific components and loadings are represented in additional file 1: figure s <dig>  the next development we describe below is to include internal variable selection in mgpls-da for large dimensional data sets.

mint
our novel multivariate integrative method mint
simultaneously integrates independent studies and selects the most discriminant variables to classify samples and predict the class of new samples. mint seeks for a common projection space for all studies that is defined on a small subset of discriminative variables and that display an analogous discrimination of the samples across studies. the identified variables share common information across all studies and therefore represent a reproducible signature that helps characterising biological systems. mint further extends mgpls-da by including a ℓ
1-penalisation on the global loading vector a
h to perform variable selection. for each dimension h= <dig> …,h the mint algorithm seeks to maximize 
  <dig> max||ah||2=||bs||2=1∑m=1mnmcovah,yhbh)+λh||ah|| <dig>  


where in addition to the notations from eq. , λ
h is a non negative parameter that controls the amount of shrinkage on the global loading vectors a
h and thus the number of non zero weights. similarly to lasso  <cit>  or sparse pls-da  <cit> , the added ℓ
 <dig> penalisation in mint improves interpretability of the pls-components that are now defined only on a set of selected biomarkers from x  that are identified in the linear combination xhah. the ℓ
 <dig> penalisation in effectively solved in the mint algorithm using soft-thresholding .





in addition to the integrative classification framework, mint was extended to an integrative regression framework .

class prediction and parameters tuning with mint
mint centers and scales each study from the training set, so that each variable has mean  <dig> and variance  <dig>  similarly to any pls methods. therefore, a similar pre-processing needs to be applied on test sets. if a test sample belongs to a study that is part of the training set, then we apply the same scaling coefficients as from the training study. this is required so that mint applied on a single study will provide the same results as pls. if the test study is completely independent, then it is centered and scaled separately.

after scaling the test samples, the prediction framework of pls is used to estimate the dummy matrix y
test of an independent test set x
test  <cit> , where each row in y
test sums to  <dig>  and each column represents a class of the outcome. a class membership is assigned  to each test sample by using the maximal distance, as described in  <cit> . it consists in assigning the class with maximal positive value in y
test.

the main parameter to tune in mint is the penalty λ
h for each pls-component h, which is usually performed using cross-validation . in practice, the parameter λ
h can be equally replaced by the number of variables to select on each component, which is our preferred user-friendly option. the assessment criterion in the cv can be based on the proportion of misclassified samples, proportion of false or true positives, or, as in our case, the balanced error rate . ber is calculated as the averaged proportion of wrongly classified samples in each class and weights up small sample size classes. we consider ber to be a more objective performance measure than the overall misclassification error rate when dealing with unbalanced classes. mint tuning is computationally efficient as it takes advantage of the group data structure in the integrative study. we used a “leave-one-group-out cross-validation ”, which consists in performing cv where group or study m is left out only once m= <dig> …,m. logocv realistically reflects the true case scenario where prediction is performed on independent external studies based on a reproducible signature identified on the training set. finally, the total number of components h in mint is set to k− <dig>  k= number of classes, similar to pls-da and ℓ
 <dig> penalised pls-da models  <cit> .

case studies
we demonstrate the ability of mint to identify the true positive genes on the maqc project, then highlight the strong properties of our method to combine independent data sets in order to identify reproducible and predictive gene signatures on two other biological studies.


the microarray quality control  project. the extensive maqc project focused on assessing microarray technologies reproducibility in a controlled environment  <cit> . two reference samples, rna samples universal human reference  and human brain reference  and two mixtures of the original samples were considered. technical replicates were obtained from three different array platforms -illumina, affyhugene and affyprime- for each of the four biological samples a , b , c  and d . data were downloaded from gene expression omnibus  - gse <dig>  in this study, we focused on identifying biomarkers that discriminate a vs. b and c vs. d. the experimental design is referenced in additional file 1: table s <dig> 


stem cells. we integrated  <dig> transcriptomics microarray datasets to classify three types of human cells: human fibroblasts , human embryonic stem cells  and human induced pluripotent stem cells . as there exists a biological hierarchy among these three cell types, two sub-classification problems are of interest in our analysis, which we will address simultaneously with mint. on the one hand, differences between pluripotent  and non-pluripotent cells  are well-characterised and are expected to contribute to the main biological variation. our first level of analysis will therefore benchmark mint against the gold standard in the field. on the other hand, hipsc are genetically reprogrammed to behave like hesc and both cell types are commonly assumed to be alike. however, differences have been reported in the literature , justifying the second and more challenging level of classification analysis between hipsc and hesc. we used the cell type annotations of the  <dig> samples as provided by the authors of the  <dig> studies.

the stem cell dataset provides an excellent showcase study to benchmark mint against existing statistical methods to solve a rather ambitious classification problem.

each of the  <dig> studies was assigned to either a training or test set. platforms uniquely represented were assigned to the training set and studies with only one sample in one class were assigned to the test set. remaining studies were randomly assigned to training or test set. eventually, the training set included eight datasets  derived on five commercial platforms and the independent test set included the remaining seven datasets  derived on three platforms .
a total of  <dig> studies were analysed, including three human cell types, human fibroblasts , human embryonic stem cells  and human induced pluripotent stem cells  across five different types of microarray platforms. eight studies from five microarray platforms were considered as a training set  and seven independent studies from three of the five platforms were considered as a test set 




the pre-processed files were downloaded from the http://www.stemformatics.org collaborative platform  <cit> . each dataset was background corrected, log <dig> transformed, yugene normalized and mapped from probes id to ensembl id as previously described in  <cit> , resulting in  <dig>  <dig> unique ensembl gene identifiers. in the case where datasets contained multiple probes for the same ensembl id gene, the highest expressed probe was chosen as the representative of that gene in that dataset. the choice of yugene normalisation was motivated by the need to normalise each sample independently rather than as a part of a whole study ), to effectively limit over-fitting during the cv evaluation process.


breast cancer. we combined whole-genome gene-expression data from two cohorts from the molecular taxonomy of breast cancer international consortium project  to classify the intrinsic subtypes basal, her <dig>  luminal a and luminal b, as defined by the pam <dig> signature  <cit> . the metabric cohorts data were made available upon request, and were processed by  <cit> . tcga cohorts are gene-expression data from rna-seq and microarray platforms. rna-seq data were normalised using expectation maximisation  and percentile-ranked gene-level transcription estimates. the microarray data were processed as described in  <cit> .

the training set consisted in three cohorts , including the expression levels of  <dig>  <dig> genes on  <dig>  <dig> samples; the test set included the tcga microarray cohort with  <dig> samples . two analyses were conducted, which either included or discarded the pam <dig> genes from the data. the first analysis aimed at recovering the pam <dig> genes used to classify the samples. the second analysis was performed on  <dig>  genes and aimed at identifying an alternative signature to the pam <dig> 



performance comparison with sequential classification approaches
we compared mint with sequential approaches that combine batch-effect removal approaches with classification methods. as a reference, classification methods were also used on their own on a naive concatenation of all studies. batch-effect removal methods included batch mean-centering , combat  <cit> , linear models  or linear mixed models , and classification methods included pls-da, spls-da  <cit> , mgpls  <cit>  and random forests . for lm and lmm, linear models were fitted on each gene and the residuals were extracted as a batch-corrected gene expression  <cit> . the study effect was set as a fixed effect with lm or as a random effect with lmm. no sample outcome  was included.

prediction with combat normalised data were obtained as described in  <cit> . in this study, we did not include methods that require extra information -as control genes with ruv- <dig>  <cit> - and methods that are not widely available to the community as lmm-eh  <cit> . classification methods were chosen so as to simultaneously discriminate all classes. with the exception of spls-da, none of those methods perform internal variable selection. the multivariate methods pls-da, mgpls and spls-da were run on k− <dig> components, spls-da was tuned using 5-fold cv on each component. all classification methods were combined with batch-removal method with the exception of mgpls that already includes a study structure in the model.

mint and pls-da-like approaches use a prediction threshold based on distances  that optimally determines class membership of test samples, and as such do not require receiver operating characteristic  curves and area under the curve  performance measures. in addition, those measures are limited to binary classification which do not apply for our stem cell and breast cancer multi-class studies. instead we use balanced classification error rate to objectively evaluate the classification and prediction performance of the methods for unbalanced sample size classes . classification accuracies for each class were also reported.

RESULTS
validation of the mint approach to identify signatures agnostic to batch effect
the maqc project processed technical replicates of four well-characterised biological samples a, b, c and d across three platforms. thus, we assumed that genes that are differentially expressed  in every single platform are true positive. we primarily focused on identifying biomarkers that discriminate c vs. d, and report the results of a vs. b in the additional file 1: supplemental material s <dig>  figure s <dig>  differential expression analysis of c vs. d was conducted on each of the three microarray platforms using anova, showing an overlap of  <dig> deg , which we considered as true positive. this corresponded to  <dig> % of all deg for illumina,  <dig> % for affyhugene and  <dig> % for affyprime . we observed that conducting a differential analysis on the concatenated data from the three microarray platforms without accommodating for batch effects resulted in  <dig> deg, of which only 56%  were true positive genes. this implies that the remaining 44%  of these genes were false positive, and hence were not de in at least one study. the high percentage of false positive was explained by a principal component analysis  sample plot that showed samples clustering by platforms , which confirmed that the major source of variation in the combined data was attributed to platforms rather than cell types.

mint selected a single gene, bcas <dig>  to discriminate the two biological classes c and d. bcas <dig> was a true positive gene, as part of the common deg, and was ranked  <dig> for illumina,  <dig> for affyprime and  <dig> for affyhugene. since the biological samples c and d are very different, the selection of one single gene by mint was not surprising. to further investigate the performance of mint, we expanded the number of genes selected by mint, by decreasing its sparsity parameter , and compared the overlap between this larger mint signature and the true positive genes. we observed an overlap of 100% for a mint signature of size  <dig>  and an overlap of 89% for a signature of size  <dig>  which is the number of common deg identified previously. the high percentage of true positive selected by mint demonstrates its ability to identify a signature agnostic to batch effect.

limitations of common meta-analysis and integrative approaches
a meta-analysis of eight stem cell studies, each including three cell types , highlighted a small overlap of deg lists obtained from the analysis of each separate study . indeed, the takahashi study with only  <dig> deg limited the overlap between all eight studies to only  <dig> deg. this represents a major limitation of merging pre-analysed gene lists as the concordance between deg lists decreases when the number of studies increases.

one alternative to meta-analysis is to perform an integrative analysis by concatenating all eight studies. similarly to the maqc analysis, we first observed that the major source of variation in the combined data was attributed to study rather than cell type . pls-da was applied to discriminate the samples according to their cell types, and it showed a strong study variation , despite being a supervised analysis. compared to unsupervised pca , the study effect was reduced for the fibroblast cells, but was still present for the similar cell types hesc and hipsc. we reached similar conclusions when analysing the breast cancer data .
fig.  <dig> stem cell study. a pca on the concatenated data: a greater study variation than a cell type variation is observed. b plsda on the concatenated data clustered fibroblasts only. c
mint sample plot shows that each cell type is well clustered, d
mint performance: ber and classification accuracy for each cell type and each study




mint outperforms state-of-the-art methods
we compared the classification accuracy of mint to sequential methods where batch removal methods were applied prior to classification methods. in both stem cell and breast cancer studies, mint led to the best accuracy on the training set and the best reproducibility of the classification model on the test set . in addition, mint consistently ranked first as the best performing method, followed by combat+splsda with an average rank of  <dig>  .
fig.  <dig> classification accuracy for both training and test set for the stem cells and breast cancer studies . the classification balanced error rates  are reported for all sixteen methods compared with mint 




on the stem cell data, we found that fibroblasts were the easiest to classify for all methods, including those that do not accommodate unwanted variation . classifying hipsc vs. hesc proved more challenging for all methods, leading to a substantially lower classification accuracy than fibroblasts.

the analysis of the breast cancer data  showed that methods that do not accommodate unwanted variation were able to rightly classify most of the samples from the training set, but failed at classifying any of the four subtypes on the external test set. as a consequence, all samples were predicted as lumb with pls-da and spls-da, or basal with rf . thus, rf gave a satisfactory performance on the training set , but a poor performance on the test set .

additionally, we observed that the biomarker selection process substantially improved classification accuracy. on the stem cell data, lm+splsda and mint outperformed their non sparse counterparts lm+plsda and mgpls , respectively.

finally, mint was largely superior in terms of computational efficiency. the training step on the stem cell data which includes  <dig> samples and  <dig>  was run in  <dig> s, compared to  <dig> s with the second best performing method combat+spls-da . the popular method combat took  <dig> s to run, and spls-da  <dig> s. the training step on the breast cancer data that includes  <dig> samples and  <dig>  genes was run in 37s for mint and  <dig> s for combat+spls-da.

study-specific outputs with mint
one of the main challenges when combining independent studies is to assess the concordance between studies. during the integration procedure, mint proposes not only individual performance accuracy assessment, but also insightful graphical outputs that are study-specific and can serve as quality control step to detect outlier studies. one particular example is the takahashi study from the stem cell data, whose poor performance  was further confirmed on the study-specific outputs . of note, this study was the only one generated through agilent technology and its sample size only accounted for  <dig> % of the training set.

the sample plots from each individual breast cancer data set showed the strong ability of mint to discriminate the breast cancer subtypes while integrating data sets generated from disparate transcriptomics platforms, microarrays and rna-sequencing . those data sets were all differently pre-processed, and yet mint was able to model an overall agreement between all studies; mint successfully built a space based on a handful of genes in which samples from each study are discriminated in a homogenous manner.
fig.  <dig> 
mint study-specific sample plots showing the projection of samples from a metabric discovery, b metabric validation and c tcga-rna-seq experiments, in the same subspace spanned by the first two mint components. the same subspace is also used to plot the  overall  data. e balanced error rate and classification accuracy for each study and breast cancer subtype from the mint analysis




mint gene signature identified promising biomarkers
mint is a multivariate approach that builds successive components to discriminate all categories  indicated in an outcome variable. on the stem cell data, mint selected  <dig> and  <dig> genes on the first two components respectively . the first component clearly segregated the pluripotent cells  vs. the two non-pluripotent cell types  . those non pluripotent cells were subsequently separated on component two with some expected overlap given the similarities between hipsc and hesc. the two genes selected by mint on component  <dig> were lin28a and car which were both found relevant in the literature. indeed, lin28a was shown to be highly expressed in escs compared to fibroblasts  <cit>  and car has been associated to pluripotency  <cit> . finally, despite the high heterogeneity of hipsc cells included in this study, mint gave a high accuracy for hesc and hipsc on independent test sets , suggesting that the  <dig> genes selected by mint on component  <dig> have a high potential to explain the differences between those cell types .

on the breast cancer study, we performed two analyses which either included or discarded the pam <dig> genes that were used to define the four cancer subtypes basal, her <dig>  luminal a and luminal b  <cit> . in the first analysis, we aimed to assess the ability of mint to specifically identify the pam <dig> key driver genes. mint successfully recovered  <dig> of the  <dig> pam <dig> genes present in the data  on the first three components . the overall signature included  <dig>   <dig> and  <dig> genes on each component , i.e.  <dig> % of the total number of genes in the data. the performance of mint  was superior than when performing a pls-da on the pam <dig> genes only . this result shows that the genes selected by mint offer a complementary characterisation to the pam <dig> genes.

in the second analysis, we aimed to provide an alternative signature to the pam <dig> genes by ommitting them from the analysis. mint identified  <dig>   <dig> and  <dig> genes on the first three components respectively . the genes selected on the first component gradually differentiated basal, her <dig> and luminal a/b, while the second component genes further differentiated luminal a from luminal b . the classification performance was similar in each study , highlighting an excellent reproducibility of the biomarker signature across cohorts and platforms.

among the  <dig> genes selected by mint on the first component, gata <dig> is a transcription factor that regulates luminal epithelial cell differentiation in the mammary glands  <cit> , it was found to be implicated in luminal types of breast cancer  <cit>  and was recently investigated for its prognosis significance  <cit> . the myb-protein plays an essential role in haematopoiesis and has been associated to carcinogenesis  <cit> . other genes present in our mint gene signature include xpb <dig>  <cit> , agr <dig>  <cit> , ccdc <dig>  <cit>  and tff <dig>  <cit>  that were reported as being associated with breast cancer. the remaining genes have not been widely associated with breast cancer. for instance, tbc1d <dig> has been described as over expressed in cancer patients  <cit> . dnali <dig> was first identified for its role in breast cancer in  <cit>  but there was no report of further investigation. although aff <dig> was never associated to breast cancer, it was recently proposed to play a pivotal role in adrenocortical carcinoma  <cit> . it is worth noting that these  <dig> genes were all included in the  <dig> genes previously selected when the pam <dig> genes were included, and are therefore valuable candidates to complement the pam <dig> gene signature as well as to further characterise breast cancer subtypes.

discussion
there is a growing need in the biological and computational community for tools that can integrate data from different microarray platforms with the aim of classifying samples . although several efficient methods have been proposed to address the unwanted systematic variation when integrating data , these are usually applied as a pre-processing step before performing classification. such sequential approach may lead to overfitting and over-optimistic results due to the use of transductive modelling  and the use of a test set that is normalised or pre-processed with the training set. to address this crucial issue, we proposed a new multivariate integrative method, mint, that simultaneously corrects for batch effects, classifies samples and selects the most discriminant biomarkers across studies.

mint seeks to identify a common projection space for all studies that is defined on a small subset of discriminative variables and that display an analogous discrimination of the samples across studies. therefore, mint provides sample plot and classification performance specific to each study . among the compared methods, mint was found to be the fastest and most accurate method to integrate and classify data from different microarray and rna-seq platforms.

integrative approaches such as mint are essential when combining multiple studies of complex data to limit spurious conclusions from any downstream analysis. current methods showed a high proportion of false positives  and exhibited very poor prediction accuracy . for instance, rf was ranked second only to mint on the breast cancer learning set, but it was ranked as the worst method on the test set. this reflects the absence of controlling for batch effects in these methods and supports the argument that assessing the presence of batch effects is a key preliminary step. failure to do so, as shown in our study, can result in poor reproducibility of results in subsequent studies, and this would not be detected without an independent test set.

we assessed the ability of mint to identify relevant gene signatures that are reproducible and platform-agnostic. mint successfully integrated data from the maqc project by selecting true positives genes that were also differentially expressed in each experiment. we also assessed mint’s capabilities analysing stem cells and breast cancer data. in these studies, mint displayed the highest classification accuracy in the training sets and the highest prediction accuracy in the testing sets, when compared to sixteen sequential procedures . these results suggest that, in addition to being highly predictive, the discriminant variables identified by mint are also of strong biological relevance.

in the stem cell data, mint identified  <dig> genes lin28a and car, to discriminate pluripotent cells  against non-pluripotent cells . pluripotency is well-documented in the literature and oct <dig> is currently the main known marker for undifferentiated cells . however, mint did not selected oct <dig> on the first component but instead, identified two markers, lin28a and car, that were ranked higher than oct <dig> in the deg list obtained on the concatenated data . while the results from mint still supported oct <dig> as a marker of pluripotency, our analysis suggests that lin28a and car are stronger reproducible markers of differentiated cells, and could therefore be superior as substitutions or complements to oct <dig>  experimental validation would be required to further assess the potential of lin28a or car as efficient markers.

several important issues require consideration when dealing with the general task of integrating data. first and foremost, sample classification is crucial and needs to be well defined. this required addressing in analyses with the stem cell and breast cancer studies generated from multiple research groups and different microarray and rna-seq platforms. for instance, the breast cancer subtype classification relied on the pam <dig> intrinsic classifier proposed by  <cit> , which we admit is still controversial in the literature  <cit> . similarly, the biological definition of hipsc differs across research groups  <cit> , which results in poor reproducibility among experiments and makes the integration of stem cell studies challenging  <cit> .

the expertise and exhaustive screening required to homogeneously annotate samples hinders data integration, and because it is a process upstream to the statistical analysis, data integration approaches, including mint, can not address it.

a second issue in the general process of integrating datasets from different sources is data access and normalisation. as raw data are often not available, this results in integration of data sets that have each been normalised differently, as was the case with the breast cancer data in our study. despite this limitation, mint produced satisfactory results in that study. we were also able to overcome this issue in the stem cells data by using the stemformatics resource  <cit>  where we had direct access to homogeneously pre-processed data . in general, variation in the normalisation processes of different data sets produces unwanted variation between studies and we recommend this should be avoided if possible.

a final important issue in data integration involves accounting for both between-study differences and platform effects. when samples clustered by study and the studies clustered by platform, then the experimental platform and not the study, is the biggest source of variation . indeed, there are inherent differences between commercial platforms that greatly magnify unwanted variability, as was discussed by  <cit>  on the maqc project. as platform information and study effects are nested, mint and other data integration methods dismiss the platform information and focus on the study effect only. indeed, each study is considered as included in a single platform. mint successfully integrated microarray and rna-seq data, which supports that such an approach will likely be sufficient in most scenarios.

when applying mint, additional considerations need be taken into account. in order to reduce unwanted systematic variation, the method centers and scales each study as an initial step, similarly to bmc  <cit> . therefore, only studies with a sample size > <dig> can be included, either in a training or test set. in addition, all outcome categories need to be represented in each study. indeed, neither mint nor any classification methods can perform satisfactorily in the extreme case where each study only contains a specific outcome category, as the outcome and the study effect can not be distinguished in this specific case.

CONCLUSIONS
we introduced mint, a novel multivariate integrative method, that is the first approach to integrate independent transcriptomics studies from different microarray and rna-seq platforms by simultaneously, correcting for batch effects, classifying samples and identifying key discriminant variables. we first validated the ability of mint to select true positives genes when integrating the maqc data across different platforms. then, mint was compared to sixteen sequential approaches and was shown to be the fastest and most accurate method to discriminate and predict three human cell types  and four subtypes of breast cancer . the gene signatures identified by mint contained existing and novel biomarkers that were strong candidates for improved characterisation the phenotype of interest. in conclusion, mint enables reliable integration and analysis of independent genomic data sets, outperforms existing available sequential methods, and identifies reproducible genetic predictors across data sets. mint is available through the mixmint module in the mixomics r-package.

additional file

additional file  <dig> supplementary material. this pdf document contains supplementary methods and all supplementary figures and tables. specifically, it provides the pls-algorithm, the extension of mint in a regression framework, the application to the maqc data , the meta-analysis of the breast cancer data, the classification accuracy of the tested methods on the stem cells and breast cancer data, and details on the signature genes identified by mint on the stem cells and breast cancer data. 

 


abbreviations
berbalanced error rate

degdifferentially expressed gene

fdrfalse discovery rate

fibfibroblast

heschuman embryonic stem cells

hipschuman induced pluripotent stem cells

lmlinear model

lmmlinear mixed model

maqcmicroarray quality control

mintmultivariate integration method

spls-dasparse partial least square discriminant analysis

rfrandom forest

the authors would like to thank marie-joe brion, university of queensland diamantina institute for her careful proof-reading and suggestions.

funding
this project was partly funded by the arc discovery grant project dp <dig> and the australian cancer research foundation for the diamantina individualised oncology care centre at the university of queensland diamantina institute , and the national health and medical research council  career development fellowship app <dig> .

the funding bodies did not play a role in the design of the study and collection, analysis, and interpretation of data.

availability of data and materials
the microarray quality control  project data are available from the gene expression omnibus  - gse <dig> 

the stem cell raw data are available from geo and the pre-processed data is available from the  platform.

the breast cancer data were obtained from the molecular taxonomy of breast cancer international consortium project  and from the cancer genome atlas . the mint r scripts and functions are publicly available in the mixomics r package , with tutorials on http://www.mixomics.org/mixmint.

authors’ contributions
fr developed and implemented the mint method, analysed the stem cell and breast cancer data, nm analysed the maqc data, kalc supervised all statistical analyses. es and sb contributed to the early stage of the project to set up the analysis plan. the manuscript was primarily written by fr with editorial advice from ae, nm, sb and kalc. all authors read and approved the final manuscript.

competing interests
the authors declare that they have no competing interests.

consent for publication
not applicable.

ethics approval and consent to participate
not applicable.
