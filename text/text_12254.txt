BACKGROUND
discovery of regulatory elements in human gene promoters is one of current bioinformatics challenges. although transcriptional control mechanisms have been investigated in various organisms for at least three decades, it is still almost impossible to predict tissue-specific or developmental-stage-specific expression of a given gene by simply analyzing its promoter sequence  <cit> .

the 5' segment immediately adjacent to the tss includes the core promoter and the proximal promoter, which usually extends about 200â€“ <dig> nucleotides. this region is involved in the modulation of transcription. the distal part of a promoter is variable with respect to composition and length, which may encompass from  <dig> nucleotides to over  <dig> kb. there is no clear-cut defined 5'-boundary for promoters  <cit> .

regulatory elements binding the same transcription factor can be found in different promoters as short dna sequences, differing among them to some extent; they are, in general, from  <dig> to  <dig> nucleotides long  <cit> , often separated by un-conserved sequences. control regions are modular in nature and expression of a given gene depends on specific combination of its regulatory elements and sometimes from their order and orientation  <cit> .

searching by computational methods for promoters and for regulatory elements in dna sequences spanning several kb, produces a large number of false-positive results. a possible solution to this problem is to identify a "sheltered environment" in which specificity of pattern discovery might be enhanced. unknown binding sites for transcription factors might be detected by searching for common elements in upstream regulatory regions of genes with common biological function and/or expression. in fact, genes with similar expression are frequently co-regulated and genes with related function are often similarly expressed  <cit> .

in this study, we attempted to detect putative regulatory elements in promoters of genes expressed in an adult human tissue , by a multi-step approach involving computational analysis of large-scale expression data, selection of a subset of putatively co-expressed genes, retrieval of the upstream portion of their complete genomic sequence and application of pattern discovery on promoter regions.

RESULTS
analysis of known regulatory sequence elements binding transcription factors
before applying coop software on a selected group of promoters, we attempted to exploit information on known regulatory sequences available in transfac  <cit> , to establish some "rules" which could facilitate the discovery of novel regulatory elements. in particular, transfac matrix data were analysed in order to describe number, percent and localization of fixed and variable positions in consensus sequences.

we first considered  <dig> matrices including information on mammalian regulatory elements. average length of consensus sequences was  <dig>  and mode 12; motifs of even length were more represented . less than 5% of the motifs showed only invariant positions . about 33% of motifs showed more than 75% fixed positions , whereas about 73% showed more than 50% fixed positions . in general, the shortest the motif, the less variable appeared its consensus sequence.

by separately considering three regions of consensus sequences , we observed that lateral positions are variable in 37% of sequences, whereas central positions are variable only in 20% of them.

most regulatory elements included in transfac seem to be symmetrical, being equally variable in their left and right sides.

we obtained very similar conclusions from the analysis of the group of  <dig> eukaryotic matrices. results of this analysis suggested that pattern discovery on mammalian promoter sequences might focus on patterns  <dig>   <dig> or  <dig> nucleotides long, showing from 0% to 25% variable positions, and possibly, less variable in the central region.

coop : clustering overlapping occurrences of approximate patterns
since sequence signals with biological significance are frequently subtle, stringency of pattern discovery analyses in biological sequences cannot be set too high. this implies that results are often too numerous. a novel tool for clustering overlapping occurrences of approximate patterns  was implemented in python . this software allows identification of tractable numbers of possibly interesting motifs, starting from large numbers of exact or approximate patterns.

selection of genes and retrieval of putative promoter regions
among  <dig>  genes expressed in retina, statistical analysis of differential expression, by audic and claverie test  <cit> , picked out  <dig> genes significantly more expressed in retina than in all other tissues. we selected as well a group of  <dig> known genes whose mutation is known to cause retinal diseases, recorded in omim and/or in retnet databases, and/or encoding proteins for which a specific function in retina has been described. in total,  <dig> were selected. for each of these genes, the reference sequence or the longest sequence of the mrna with complete cds was compared by blat  <cit>  to human genome sequence, for annotation of the intron/exon structure and for prediction of the most probable tss . we predicted with good confidence tss of  <dig> genes  <cit> . sequences from  <dig> selected genes, each corresponding to  <dig> kb upstream the predicted tss, were retrieved for further analyses. for one gene, ush3a  two alternative promoters  controlling transcription of messenger rna encoding retinal products were found. therefore,  <dig> gene promoters pertaining to  <dig> different retinal genes were considered for the study.

search for approximate patterns
retinal datasets
we considered datasets including sequences corresponding to the  <dig> bp upstream the predicted tss of the selected genes  and the group of  <dig> fully masked sequences corresponding to  <dig> kb upstream the predicted tss . fully masking of sequences in datasets 500m <dig> and 1000m <dig> produced, on average,  <dig> and  <dig> unmasked nucleotides, respectively.

in each group of sequences, approximate patterns of length ranging from  <dig> to  <dig> nucleotides, with at most two variable positions , were searched by spexs . for each dataset, patterns were ranked in different classes, according to the number of sequences in which they were represented .

in the  <dig> bp datasets the number of sequences in which most represented patterns were found as relatively low, reaching a maximum of  <dig>  for 10- <dig> patterns in unmasked sequences  and only  <dig>  for 14- <dig> patterns in masked sequences . when considering sequences of length  <dig> , the number of sequences with occurrences of most represented patterns slightly increased. for instance, most represented 10- <dig> patterns were found in  <dig> sequences in 500m <dig> and in  <dig> sequences in 1000m <dig> 

negative control datasets
random groups of human promoter sequences were established as negative control. one thousand groups of  <dig> promoter sequences randomly selected among  <dig>   human gene promoters were generated . each of these  <dig>  groups included the same number of sequences of the 1000m <dig> set of retinal gene promoters and sequences fully masked and of the same length of retinal gene promoters. moreover, tss predictions were done by promoser  <cit>  according to identical criteria adopted for tss prediction of retina genes.

results of pattern discovery in the  <dig> retina gene promoters group  and in the dataset of  <dig>  groups of  <dig> human gene promoters randomly selected among  <dig>   are shown in tables  <dig> and  <dig> and in figure  <dig>  the number of patterns with different quorum in the retinal datasets and in the negative control groups of promoter sequences are reported. in the last two rows of table  <dig> the comparison of pattern discovery results in the 1000m <dig> retinal gene promoters group and in the dataset of  <dig>  groups of  <dig> sequences  randomly selected among  <dig>  human gene promoters is shown.

the number of patterns found in at least  <dig> and in at least  <dig> out of  <dig> retinal promoter sequences is higher than the average of number of patterns found in at least  <dig> and in at least  <dig> out of  <dig> randomly selected promoter sequences, calculated over  <dig>  different samples. statistical significance  of number of patterns found in each number of sequences of the retina datasets was calculated as the proportion of negative control random datasets in which the number of patterns found was higher or equal to those found in retinal promoters. when this number was below  <dig> , the difference was considered statistically significant. over  <dig>  random samples,  <dig>  10- <dig> patterns were found in average in at least  <dig> promoter sequences, while  <dig> patterns were found in at least  <dig> retinal promoters . similarly,  <dig> 12- <dig> patterns were found in  <dig> or more retinal promoter sequences, whereas  <dig>  were found in average in random samples . statistical significance of this observed difference resulted just above  <dig> . this effect could be due to possible heterogeneity of the class of  <dig> gene promoters. when considering the group of  <dig> promoters corresponding to genes significantly more expressed in retina than in all other considered tissues  and the corresponding negative control dataset , the difference between retinal and random datasets is more evident. for instance,  <dig> 12- <dig> patterns were found in  <dig> or more retinal promoter sequences, whereas  <dig>  in average were found in  <dig>  random samples .

in figure 2a, the cumulative number of patterns is plotted against the number of sequences in which they were found, among sequences of dataset 1000m <dig> and ran1000m52i. in figure 2b the comparison between the 1000m <dig> and the ran1000m91i is shown. for negative control , the average value of  <dig>  sets of sequences is given, with an interval of two standard deviations centred to the mean . it should be noticed that in both comparisons the number of patterns found in the retinal dataset is always considerably higher than average in the negative control dataset.

putative novel regulatory elements in retina gene promoters identified by coop
we considered the group of  <dig>  12- <dig> patterns detected by spexs in at least  <dig> out of  <dig> promoter sequences of genes expressed in human retina . we clustered the  <dig>  occurrences of  <dig> selected patterns by using different sets of parameters, in order to identify combinations maximizing the biological meaning of resulting motifs. distance parameters ranging from  <dig> to  <dig> nucleotides were used, each associated with o values of  <dig>  or  <dig> . the number of clusters decreases when d increases and increases with o. for instance, when o is set to  <dig> , the increase of d from  <dig> to  <dig> changes the total number of clusters from  <dig> to  <dig>  changing the number of clusters containing only the occurrences of one spexs pattern  from  <dig> to  <dig>  with maximum number of patterns per cluster increasing from  <dig> to  <dig>  we kept o high, in order to cluster patterns according to their "very frequent" overlapping occurrences. the change of o from  <dig>  to  <dig>  changes the number of clusters obtained with d =  <dig> from  <dig> to  <dig>  while the number of "single clusters" changes from  <dig> to  <dig>  the number of clusters containing the occurrences of different spexs patterns is quite stable in respect to variation of o , whereas the number of "single clusters" increases considerably with o. in all cases, the number of extracted motifs, ranging in these experiments from  <dig>  to  <dig> , is considerably lower than the number of patterns considered.

starting from  <dig>  occurrences of  <dig> selected patterns found in at least  <dig> sequences with d set to  <dig> and o to  <dig>  coop produced  <dig> clusters with an average number of occurrences per cluster of  <dig>  . clusters are associated to  <dig> sequence alignments,  <dig> of which  are longer than  <dig> nucleotides, and to position-specific scoring matrices. in average,  <dig>  occurrences per motif were observed. these  <dig> motifs occurred in  <dig> sequences out of  <dig>  the mean number of motifs per sequence is  <dig> , whereas the mean number of motif occurrences per sequence is  <dig> . subgroups of these motifs could be similar or overlapping.

motifs occurrences were ranked into four classes according to their position in promoter sequences . the observed distribution significantly deviated from expectation under assumption of randomness . there is a positive correlation between density of motif occurrences and proximity to tss. in fact, over 40% of total motifs occurrences are concentrated in  <dig> nucleotides close to the predicted tss and the two thirds of the total number of occurrences fall within  <dig> nucleotides adjacent to the first exon. regions of promoters sequences corresponding to the  <dig> bp proximal to tss were in average less masked than the upstream regions. when normalizing the number of motifs occurrences to the percentage of unmasked nucleotides in the different regions, a strong difference remains, with significant deviation from a random distribution. p value of chi squared test for the comparison among two groups  is  <dig> *10â€“ <dig> 

from each sequence alignment pertaining to a cluster, a consensus sequence representing the motif was built. different sets of parameters were used to this purpose. the choice of different stringency of parameters for building consensus sequences influences the length of obtained motifs and the fraction of variable positions included in them. threshold i ranged from  <dig>  to  <dig>  and fl and fc ranged from  <dig>  and  <dig>  . if fl and fcare sufficiently stringent, a low value for i could be used, in order to maximize information extracted. when a i =  <dig>  is applied for construction of consensus sequences, the average length of motifs remains almost unchanged , with  <dig> motifs of length over  <dig>  part of the information about each motif is lost when a matrix is built from the alignment of pattern occurrences and when frequency data are converted into a consensus sequence. we used moderately stringent thresholds for the minimum frequency of a single nucleotide determining "fixed" positions. in particular, fl was set to  <dig> , whereas fc, referring to the core regions of consensus sequences, was set to  <dig> . out of  <dig> motifs, only  <dig> "most informative" motifs were selected, which showed a completely conserved consensus or a consensus showing variable positions only in the side regions . the average length of this group of sequence motifs was  <dig> , with about 55% of them longer than  <dig> nucleotides. two pairs of motifs were represented by the same consensus sequence. the resulting group of  <dig> motif consensus sequences, representing putative functional elements in retinal promoters, were compared with transfac data, by tess program  <cit> . in particular, we used the "filtered string-based search query" tool  <cit>  for comparison only with known regulatory sites of mammals, with no mismatches allowed and by using the entire length of known sites instead of their core positions. out of  <dig> motifs,  <dig>  exactly matched at least one sequence known to bind a mammalian transcription factor. sequences corresponding to common or general transcription factors  were matched by  <dig> out of  <dig> consensus sequences ,  <dig> of which matches also additional factors . in total,  <dig> consensus sequences resulted similar to sequences recognized by ap- <dig>  ap- <dig>  wt <dig>  krox- <dig>  gr, ppur or er.

analysis of positive control datasets
to the purpose of both analysing coop efficiency with selected conditions and of indirectly comparing the performances of the method with those of different software, we analysed by coop a group of  <dig> human positive control datasets prepared by tompa and colleagues for the assessment of computational tools for the discovery of transcription factor binding sites  <cit> . this benchmark included  <dig> groups of promoters, for which it is known which regulatory signals should be detected.

the number and the length of promoter sequences and of known signals per dataset are reported in table  <dig>  along with the adopted quorum . the number of signals per group of promoters which are shorter than the length of approximated patterns taken as input by coop  and which were, in principle, very difficult to find by adopted settings, is also reported. for each experiment, among different motifs predicted we selected only the one corresponding to the motif represented in the highest number of sequences. for each dataset the nucleotide-level and site-level  <cit>  overlap between pattern occurrences belonging to the cluster  and known signals, evaluated by different measures , are included in table  <dig> .

moreover, the "combined" statistics summarizing coop performance over the collection of human datasets, was compared with the same statistics calculated for the  <dig> different programs tested by tompa and colleagues on the same datasets  <cit> . results are presented in figure  <dig> and in table  <dig> .

the comparison showed that the performances of coop on the "very difficult" human dataset are in line with those of the top rated tools. in comparison with other software, coop resulted to be in the best 20% of evaluated tools according to four measures  and in the best one third according to six measures .

discussion
pattern discovery in sequences of putative and sometimes incomplete promoters is a considerably complex problem  <cit> . it may be reasonably assumed that some regulatory regions of a group of co-regulated genes share similar sequence elements. in yeast, pairs of genes showing over  <dig>  pearson correlation between their expression profiles, have over 50% probability of sharing at least one common transcription factor binder  <cit> .

since patterns with biological significance could be subtle  <cit> , a main difficulty in pattern discovery approaches is a priori establishing a "quorum" and defining search parameters . by increasing the distance and/or decreasing the quorum, the number of false positives becomes excessively large. a possible solution to the problem of output explosion is to use biological knowledge both before and after application of automated pattern discovery.

we analysed transfac data to obtain information about frequent properties of regulatory elements. it should be noticed that although not all transfac matrices are based on high-quality data and on large samples of sequences, this database represents the largest existing collection of known regulatory elements in different organisms.

in this study we developed a novel tool, called coop, for analysing promoter sequences of putatively co-regulated genes, aiming at extraction of sequence motifs with possible regulatory function. the motif extraction method is based on clustering of overlapping occurrences of approximate patterns, which allows identification of tractable numbers of possibly interesting motifs, starting from large numbers of exact or approximate patterns.

our method is somehow related to two approaches proposed by van helden  <cit>  and by caselle  <cit> , although these studies considered yeast promoter sequences and dealt with exact patterns. the originality of our approach, mainly resides principally in adopting a new similarity measure between patterns, based on the frequency of pattern co-occurrences, and in designing a flexible procedure, with seven parameters which could be varied in order to modulate stringency of different analysis steps.

motifs reconstruction was designed to maximize information included in each extracted sequence motif avoiding generation of spurious elements, given that clustering parameters  are appropriately set. each obtained motif is represented by a consensus sequence, derived from the alignment of strings grouped in a specific cluster by adjustable criteria. in particular, the i threshold affects the length of the consensus sequence, whereas the l, fc and fl determine the number and the distribution of variable positions in the consensus sequence.

in order to evaluate the performance of the method, we analysed positive control datasets, such as all the human benchmark groups of promoter sequences, containing known signals at known positions, proposed by tompa for a systematic assessment of motif discovery tools. coop analyses were carried out with the same settings used for analysing retina gene promoter. the quorum was established by using an unique criterion for different datasets, based on the total number of sequences in the sample. in the first analysis phase, approximated patterns of  <dig> nucleotides, with at most  <dig> variable positions, were searched. benchmark datasets were  <dig> groups of different number of promoters sequences. each set of sequences contained a group of known signals. lengths of signals ranged from  <dig> nucleotides to  <dig> nucleotides. thus, several datasets contained a number of very short signals, which were very hard to find by a motif discovery approach designed to find motifs of length equal or higher than  <dig> nucleotides. we predicted a motif for all but two human datasets, which included only two sequences. coop performed comparably well than the tools which were top rated in the tompa assessment. it should be noticed that some of the other tools gave no predictions for a number of datasets, thus being advantaged from the averaging nppv, sppv and ncc scores when calculating combined statistics over all the human datasets  <cit> .

the method we developed was applied, in a case study, to a collection of human promoter sequences pertaining to a group of  <dig> putatively co-regulated genes expressed in the retina.

one kb long promoter sequences were identified by predicting the most probable tss according to the consensus of information about cdna and ests alignments with the genome sequence. even neglecting the possible presence of alternative promoters, definition of exact tss it is a still open problem, because of low sensitivity of promoter prediction programs and of incomplete cdna coverage of 5' exons. however, cdna coverage of the majority of genes selected for this study is almost complete, since genes considered are well known and/or highly expressed. the adequacy of our method for selecting gene promoter sequences is supported by results obtained by trinklein and colleagues  <cit> : over 90%  <dig> human  <dig> bp promoter sequences, randomly selected among  <dig>  tss predictions  resulted active in at least two cell lines. although the size of  <dig> kb upstream the tss might be insufficient to cover all possible regulatory regions for all genes, it could reasonably include both core and proximal promoters and at least part of the distal promoter.

a very high number of approximate patterns of length from  <dig> to  <dig> with at most 20% variable positions was found in retina promoter sequences. this is partially due to the fact that they include similar sequences or sequences shifted only by few positions. by using coop for clustering approximate patterns, on the basis of their frequent overlapping occurrences, we identified a number of interesting sequence motifs, often longer than the original patterns.

in order to test the significance of the group of sequence patterns frequently found in retinal promoters and used as input for coop, we generated and studied different negative control datasets corresponding to a thousand groups of sequences, randomly selected among a very large group of human promoters. the average pairwise level of pattern sharing in these groups of promoters was expected to reflect the general level of pattern sharing between human gene promoters. we observed that the selected group of retinal promoters  is enriched in common patterns as compared to random groups.

sequence motifs produced by coop resulted more frequently in the regions close to the tss. moreover, the group motifs consensus sequences selected according to very low variability in their central region was compared with sequences which are known to bind mammalian transcription factors under stringent criteria. signals similar to those for general and widespread transcription factors, such as sp <dig> or maz, are the most represented. moreover, a number of selected motifs resulted to be similar to signals recognised by transcription factors expressed in tissues of ectodermal origin and relevant to development and function of retina . for instance, ap- <dig> elements were found in a number of retinal gene promoters including cgmp-phosphodiesterase beta subunit  <cit>  and hydroxyindole-o-methyltransferase  <cit>  whereas the wt <dig> zinc finger factor is essential for normal development of retina and specifically involved in regulation of retinal genes  <cit> .

CONCLUSIONS
we developed a method to detect sequence motifs corresponding to putative regulatory elements in gene promoters, starting from lists of approximate patterns with occurrences in promoter sequences. this method could be profitably applied to different datasets, including promoter sequences of different groups of genes in humans or in other eukaryotes, for which co-regulation could be demonstrated or inferred. the method could be used to investigate on different kinds of regulatory sequences, such as intronic enhancers, or other sequence motifs with non-regulatory function.

availability and requirements
coop can be downloaded free-of-charge from the web page . coop was developed in python. the software works under linux and requires python  <dig>  or higher, biophyton  <dig> b and clustalw. coop is provided 'as is' with no guarantee or warranty of any kind and it is freely available for all.

