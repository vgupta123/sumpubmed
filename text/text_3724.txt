BACKGROUND
microevolution is defined as any evolutionary changes below the species level. it is the study of short-term changes within a population or a species of its alleles  and their effects on the phenotype of organisms that make up that population. the result of the below-species-level evolution is heterogeneity, where populations are made up of subpopulations with a large number of structural variations. heterogeneity analysis is, therefore, essential to our understanding of how the selective and neutral forces shape bacterial populations over a short period of time  <cit> .

in s. aureus, the role of microevolution is especially significant, in which heterogeneity is hypothesized to be the basic molecular mechanism for drug resistance  <cit> . indeed, pre-existing drug-resistant mutants were often detected, from which drug-resistant mutants emerged during drug therapy or on the drug-containing growth medium. s. aureus strain of pc- <dig>  pc- <dig> and pc- <dig> are great examples  <cit> . they were isolated at different stages of vancomycin therapy. the first two were recovered from a patient in the early stages of vancomycin therapy, whereas the third was isolated one day before the patient's death. the minimal inhibitory concentration of vancomycin is  <dig> μg per milliliter for pc- <dig> and pc- <dig>  while pc- <dig> is capable of growing on agar plates containing vancomycin at a concentration of  <dig> μg per milliliter at a frequency of approximately 10- <dig>  pc-3* is a colony picked from pc- <dig> strains capable of growing on agar containing  <dig> μg of vancomycin per milliliter. the new isolate can even grow on  <dig> μg of vancomycin per milliliter at a frequency of approximately 10- <dig>  a strong indicator for the existence of subpopulations. similarly, mutants with higher vancomycin resistance were also picked from mm <dig> plated on vancomycin containing agar with a minimum inhibitory concentration  <cit> .

the heterogeneity is not unique to s. aureus. it is found in the population of mycobacterium tuberculosis and many other bacterial pathogens, where the pathogen can gain drug resistance under the selective pressure of drug therapy. post et al identified drug-resistant subpopulations within tb patients  <cit> , in which four of the  <dig> patients acquired additional drug-resistance mutations during the course of treatment  <cit> . on the other hand, the bacterial pathogen could also lose its pathogenicity when selective pressure is absent, leading to the in vitro accumulation of attenuated mutants. a systematic analysis of individual clones isolated from subcultured m. tuberculosis h37rv and a non-subcultured frozen stock detected a mixed population in h37rv containing wild-type cells as well as neutral red and phthiocerol dimycocerosate  mutants  <cit> . microarray analysis confirmed a significant heterogeneity  <cit> . heterogeneity was also found in natural bacterial populations of escherichia coli  <cit> , salmonella enterica  <cit> , neisseria meningitidis  <cit> , haemophilus influenzae  <cit> , helicobacter pylori  <cit> , streptococcus pneumoniae  <cit>  and pseudomonas aeruginosa  <cit> . from these bacterial pathogens, hypermutation and the pre-existence of drug-resistant subpopulations were detected. it is thus logical to conjecture that the heterogeneity in bacterial populations is fundamental to the development of drug-resistant strains in these and possibly other bacterial species. analysis tools that possess the ability to study heterogeneous bacterial populations and the dynamic of genetic changes in the populations would greatly improve our understanding of the molecular mechanisms of microevolution.

molecular epidemiological analysis tools play critical roles in our current understanding of bacterial microevolution. the tools include is6110-based restriction fragment length polymorphisms ; spoligotyping and the mycobacterial interspersed repetitive-unit-variable-number tandem-repeat  typing in the study of m. tuberculosis populations; multilocus sequence typing ; amplified fragment length polymorphism analysis ; double-locus sequence typing ; and spa typing in the analysis of s. aureus population. all of these techniques, however, have severe limitations. first, these tools focus on small sets of genome components, such as dna sequences of internal fragments of multiple  housekeeping genes in mlst  <cit> , single-strand sequencing of partial repeat sequences of genes clfb and sp in dlst  <cit> , and dna sequence analysis of variable repeat regions of the protein a gene in spa typing  <cit> . consequently, either the genetic heterogeneity could not be detected at all or its frequency is seriously underestimated  <cit> .

the solexa genome analyzer is a sequencing system powered by the next-generation solexa sequencing technology  <cit> . it is based on massively parallel, shotgun, clonal sequencing-by-synthesis and is characterized by high throughput and precision in base calls. with this platform, millions of short reads can be obtained with an accuracy of up to 99%  <cit> , allowing massively parallel picoliter-scale amplification and sequence determination of individual dna molecules  <cit> . for example, a mixture of three hiv- <dig> envelope variants pooled in proportions of 89%, 10%, and 1% can be accurately detected  <cit> . recently, wang et al. detected an average of  <dig> variants per clinical hiv plasma samples using this technology compared to an average of eight variants per sample using conventional direct-pcr dideoxynucleotide sequencing  <cit> . it can be hypothesized that, with these technologies, bacterial genomes in a heterogeneous population can be adequately sequenced so that population dynamics in respect to genetic heterogeneity can be studied at the whole genome level.

heterogeneity analyses are straightforward due to the small size of the viral genome and the rarity of sequence duplications in the genome. however, the heterogeneity analysis is expected to face a significant challenge in bacterial genomes. sequence duplications, insertions and deletions are ubiquitous features of bacterial genomes, which resulted in gene families and super-families with many paralogs  <cit> . the resulting complexity would make it especially difficult to determine whether particular heterogeneity sites are due to mutations that occur between the paralogs or spontaneous mutations that generate heterogeneous bacterial populations.

a few computational tools have been developed for genome-wide variant analysis, including bfast  <cit> , rmap  <cit>  and maq  <cit> . this software facilitates the fast and accurate mapping of short reads to detect sequencing errors, single nucleotide polymorphisms  and indels with well-defined statistics. for example, maq calls the consensus based on a statistical model that maximizes the posterior probability  <cit> . all these tools, however, have limited or no capability for genetic heterogeneity analysis. even though heterozygotes are called in the maq analysis process, all analyses are local in nature, meaning that the process narrows down particular genome positions without considering global genome contexts. as a consequence, it is difficult to determine whether the heterogeneity is due to intra-genome variation or to the heterogeneous population. in addition, like many other tools, maq has limited capability to reveal mutations that occur in repetitive dna. as a matter of fact, snps lying in repetition were intentionally excluded from analysis  <cit> .

here, a new tool referred to as genhtr was established. genhtr is unique in that it could detect variants within the context of whole genomes. specifically, the software first establishes the genotype in genetic heterogeneity at all chromosomal positions for both newly sequenced bacterial strains  and their isogenic reference genomes . comparative genotype analysis allows for the identification of heterogeneity sites where the chromosomal positions are heterogeneous in newly sequenced genomes but homogenous in the isogenic reference genome. together with maq, the software then provides clues to determine whether the multiple variants are due to intra-genome duplications, sequencing artifacts or spontaneous mutations, thus helping to prioritize the variants for experimental validation. in addition, genewise  <cit>  was integrated so that synonymous/non-synonymous mutations can be analyzed as well.

to prove this concept, i applied this approach to srx <dig>  the solexa sequencing data downloaded from ncbi sequence read archive  for a newly sequenced s. aureus subsp. usa <dig> cell line. the data set was chosen as a user model organism for the following reasons: first, completely sequenced genomes of two usa <dig> strains are available in the ncbi ; second, s. aureus is one of the leading causes of infectious disease mortality; and third, heterogeneity has been implicated in the process of drug-resistance development where s. aureus undergoes genetic shifts during treatment, resulting in the acquisition of subtle genetic changes in s. aureus subpopulations  <cit> . it is imperative to find cures effective in treating s. aureus infections since failures can lead to a dire consequence: the selection and spread of multiple drug-resistant strains  <cit> . this paper illustrates the analysis procedure and presents partial results.

methods
genome sequence data
the solexa genome sequences  of s. aureus strain were downloaded from ftp://ftp.ncbi.nlm.nih.gov/sra/static/srx007/srx007710/. the s. aureus is a usa <dig> strain that was sequenced using illumina sequencing technology by the broad institute in the staphylococcus_aureus_assembly_development project. in addition, the completely sequenced s. aureus genome of s. aureus usa <dig> fpr <dig> was downloaded from ncbi ftp://ftp.ncbi.nih.gov/genomes/bacteria/staphylococcus_aureus_usa300_fpr3757/. like the newly sequenced strain, this strain belongs to the aureus usa <dig> subspecies. its genome includes a chromosome of  <dig> base pairs   and three plasmids of  <dig> bps ,  <dig> bps , and  <dig> , respectively. the usa <dig> subspecies is methicillin-resistant, community-acquired  and has been involved in epidemiologically unassociated outbreaks of skin and soft tissue infections in healthy individuals in at least  <dig> u.s. states, as well as in canada and europe  <cit> .

genhtr steps
genhtr is based on a seamless integration of various computational tools such as megablast, blat and genewise as well as some in-house-developed perl modules. megablast uses a greedy algorithm for the nucleotide sequence-alignment search, up to  <dig> times faster than more common sequence-similarity programs  <cit> . blat is a blast-like alignment tool, designed specifically for accurate and faster sequence alignments  <cit> . for the heterogeneity analysis of a particular bacterial strain, a completely sequenced genome of an isogenic strain is selected as a reference genome, named irg for short.

genhtr is partitioned into four conceptual steps . the first step is to create the database reference genome dna fragments , an entire set of non-overlapped dna fragments from the irg . the rgdfs have a pre-defined length, e.g. a default length of  <dig>  base pairs, which was empirically determined. larger rgdfs often present a significant challenge since solexa creates massive sequencing reads in certain genomic areas that often overwhelm megablast, a key tool in this analysis. in such case, no sequence alignments will be displayed.

once established, rgdf is used to search genome-specific databases of solexa short reads via megablast to identify its candidate trace sequences . megablast is run with all default parameters except -v and -b. both are assigned a value of  <dig> , <dig> to allow all possible database sequences to show one-line descriptions  and alignments . the candidate trace sequences were defined as those that display at least 95% sequence identity with a given rgdf. the 95% is used to limit alignments between solexa reads and rgdfs to those of at most two mismatches.

candidate trace sequences are then mapped to the irg based on the alignments from the megablast analysis  to define genetic heterogeneity within a newly sequenced bacterial strain . in the mapping, nucleotide identities  are determine at each chromosomal position, where dij represents the jth alternative nucleotide at chromosomal position i. dij is identical either to those in the reference genome or to those that are substituted, deleted or inserted. furthermore, the numbers of candidate trace sequences  used to derive nucleotide identity j at position i as well as the percentage sequence identities  between the candidate trace sequences and the rgdf are recorded. as a result, the genetic heterogeneity genotype in the format of pi1:di1:mi <dig>  pi2:di2:mi <dig> ... pii:dij:mij ... pin:din:mik will be established for all chromosomal positions. moreover, a 2-2- <dig> rule is designed specifying that any chromosomal position will be defined as candidate genetic heterogeneity sites if the following conditions are satisfied: first, there must exist at least two alternative nucleotides at certain positions; and second, among the alternative nucleotides at these positions, there must be at least five solexa reads per an alternative with an average phred value of  <dig>   <cit> . at least five reads were empirically required for accurate single nucleotide mutation calling  <cit> .

the second step is a simulation procedure to analyze genome complexities of dna mixtures derived from the isogenic reference genome. the procedure first creates an irg-specific dna database, where all possible n-base pair "solexa read-like" dna fragments are generated from the irg . a moving window of n-base pairs is used to scan over the genome to generate dna fragments. the length of solexa reads determines the size of the moving window . then the analysis follows the exact procedures from fig. <dig> i.b and i.c to identify candidate sequences from the irg-specific dna database  and establish genome-wide "heterogeneity" genotypes . for consistency, the term "heterogeneity" is still used in this section, but instead of describing the heterogeneous bacterial population, it is used to portray the genome complexity of the irg. the read depth from simulated data varies from genomic area to genomic area, depending on the complexity of the dna. in the areas of single copy, the read depth is equal to n, the width of the moving window.

the genotypes from this and the previous step are compared  to identify the genetic heterogeneity sites where alternative nucleotides were found from the analysis of solexa sequence data but not from the analysis of the reference genome. once the genetic heterogeneity sites were predicted, synonymous/non-synonymous mutations at the sites were analyzed with genewisedb   <cit>  , where candidate trace sequences with heterogeneity sites were comparatively analyzed with their orthologous proteins from the isogenic reference genome. the genewisedb is run with all default parameters.

genhtr runs are semi-automated. a run of genhtr on the  <dig> m base pairs of s. aureus takes ~  <dig> h on a  <dig> mb ram pentium  <dig> computer running linux. running time increases linearly with the size of the solexa genome sequences and genome length.

RESULTS
characterization of the model genome
in heterogeneity analyses, a key pre-requirement is the existence of completely sequenced, assembled genomes of an isogenic bacterial strain. in ncbi, many completely sequenced s. aureus genomes are available, including those for fpr <dig> and tch <dig>  two strains of s. aureus subspecies usa <dig>  the data set srx <dig>  a usa <dig> strain, was selected as the model organism. the srx <dig> comes from the same subspecies. it was assumed that the newly sequenced genome was highly similar to the two sequenced subspecies. indeed, using s. aureus subspecies usa <dig> fpr <dig> as a template, genhtr can reconstruct the entire genome of srx <dig> with merely five gaps to a total of  <dig> base pairs . moreover, only  <dig> substitutions,  <dig> insertions and  <dig> deletions were revealed, suggesting that srx <dig> is isogenic to fpr <dig>  another critical pre-requirement is the size of the sequencing data. this analysis indicated that srx <dig> has massive coverage of the bacterial genome with an average number of up to  <dig> solexa reads per mapped chromosomal position. among these chromosomal positions, about  <dig> % have greater than  <dig> of solexa reads, with a maximum of  <dig> .

analysis of the isogenic reference genome
the results indicated that the simulation in genhtr could characterize genome complexity of the irg. first, it determined whether chromosomal positions occur in single-copy-dna fragments or in duplicated dna fragments . the analysis also revealed "heterogeneity" within the irg, a mixture of dna fragments derived from recent duplication and subsequent mutations. a total of  <dig> "heterogeneity sites" were detected at genic areas . a majority of the "heterogeneity sites" are present in proteins important to pathogenesis . these include  <dig> sites on the gene for the immunoglobulin g binding protein a precursor,  <dig> sites on the gene for the superantigen-like protein,  <dig> sites on the gene for the cell surface proteins,  <dig> sites on the gene of teichoic acid biosynthesis protein,  <dig> sites on the gene of fibronectin binding protein a/b,  <dig> sites on the genes of clumping factor a/b,  <dig> sites on the genes of sdrc/d/e proteins and  <dig> sites on the genes of staphylococcal tandem lipoprotein. many of those genes encode surface proteins that have a common c-terminal lpxtg/npqtn cell wall attachment motif, a sequence fragment that plays an essential role in host colonization, biofilm formation, and the evasion of host defense  <cit> . for example, wall teichoic acids  have been shown to be essential for the survival of bacillus subtilis  <cit>  and function as virulence factors in s. aureus  <cit> . deficient wta-mutants were impaired in their adherence to nasal cells and were unable to colonize cotton rat nares  <cit> . the superantigen-like protein is a bacterial protein toxin that binds to the major histocompatibility complex class ii and t-cell receptor to stimulate large numbers of t cells, leading to toxic shock syndrome  <cit> .

the detection of extensive "heterogeneity" from the isogenic reference genome, especially on the pathogenesis-related genes, is not surprising. gene duplication has long been recognized as one of the most important mechanisms in the evolution of bacterial genomes, creating multiple homologs within a genome. the paralogous gene groups are further involved in mutations and genome rearrangements that help the bacteria adapt to ever-changing environments  <cit> . by "heterogeneity" analysis, genhtr can characterize the genome dynamics of bacterial pathogens.

heterogeneity analysis of the newly sequenced s. aureus subsp. usa <dig> cell line
the genetic heterogeneity analysis of srx <dig>  the solexa data from the newly sequenced usa <dig> cell line, detected a similar phenomenon. a total of  <dig>  heterogeneity sites were identified through heterogeneity analysis. among them,  <dig> are unique to the new cell line when compared to the "heterogeneity" genotypes of its isogenic reference genome. many of them were also detected by maq as single nucleotide polymorphisms  and passed the "snpfilter" when solexa reads that cover the heterogeneity sites were extracted and used as an alternative maq input . the heterogeneity site that was detected at the gene coding for sensor histidine kinase is a good example. among the  <dig> candidate trace sequences mapped to this site,  <dig> have a nucleotide that is identical to the isogenic reference genome and  <dig> with a g- > c substitution. all seven substitutions have a phred value greater than or equal to  <dig> in the base calling and three of them have a phred value of  <dig>  the highest possible quality value in the data set. a value of  <dig> has a converted probability of  <dig>  incorrect reads. in contrast, the position is homogeneous in the isogenic reference genome. the same phenomenon was observed at other heterogeneity sites, including those at the genes encoding for the sulfatase family protein, the lipoate-protein ligase a family protein, the penicillin-binding protein  <dig>  the lantibiotic epidermin biosynthesis protein epic, the oxacillin resistance-related fmtc protein, and the putative fibronectin/fibrinogen binding protein. furthermore, a majority of the heterogeneity sites are located in the single-copy dna fragment in the isogenic reference genome.

heterogeneity analysis of the genes of single dna copies
further analysis indicated that the genetic heterogeneity has certain unique properties. first, a majority of the genetic heterogeneity sites were detected in unique genomic areas. many of them have non-synonymous mutations, leading to amino acid alterations in target proteins . for example, the genetic heterogeneity leads to a q59- > k <dig> substitution on putative fibronectin/fibrinogen binding protein, a c717- > y <dig> on oxacillin resistance-related fmtc protein at a ratio of  <dig> % , and  <dig> %  out of the detected candidate sequences, respectively. the genetic heterogeneity also leads to truncated proteins, e.g. at genes encoding sensor histidine kinase at a percentage of  <dig> % , and phosphotransferase system, glucose-specific iiabc component at a percentage of  <dig> % .

note. trunc: truncated protein; nonsyn: non-synonymous mutation and syn: synonymous mutation. a: align with genewisedb and b: align with blastx.

the genetic heterogeneity is involved in some pathogenesis-related genes, including penicillin-binding proteins , fibrinogen/fibronectin-binding proteins , and lipoate-protein ligase a family protein. pbp is a key player in the bacterial cell cycle and drug-resistance processes. altered pbps with a reduced affinity to penicillin lead to penicillin resistance in clinical isolates of s. pneumoniae  <cit> . fnbp is a major platelet-activating factor on the surface of s.aureus  <cit> . truncated derivatives of the genes promote platelet activation when expressed on the surface of s.aureus or lactococcus lactis, indicating two distinct mechanisms of activation. fmtc is a gene that affects oxacillin resistance in methicillin-resistant s. aureus. its mutants showed increased susceptibility to beta-lactam antibiotics and bacitracin  <cit> . the gene of lipoate-protein ligase a family protein is upregulated by daptomycin  <cit> . the antibiotic induces the s. aureus cell wall stress stimulon and genes responsive to membrane depolarization.

as indicated above, maq was used as an important tool for validation. however, many genetic heterogeneity sites could not pass the "snpfilter" , but it is worth illustrating them from the functional perspective because of their potential roles in the pathogenicity and microevolution of s. aureus strains. the sites include a lysr family transcriptional regulator gene with a genotype of . a nonsense mutation results in a truncated lysr family transcriptional regulator. this protein is a global transcriptional regulator, acting as either activators or repressors of single or operonic genes. it regulates a diverse set of genes, including those involved in virulence, metabolism, quorum sensing and motility  <cit> . in mycobacteria, the lack of mismatch correction is recognized as a promoter of mycobacterial evolution  <cit> . it is, however, not completely clear how the genetic variation and phenotypic diversity are created in s. aureus. the discovery of the multi-variants in the genes that are known to be associated with hypermutability will shed light on the molecular mechanisms. the first such site is located at the gene encoding dna mismatch repair protein muts. the heterogeneity site has a genotype of . the c- > g substitution at the chromosomal position of  <dig> , <dig> results in a nonsense mutation, leading to a truncated protein with a loss of  <dig> amino acids at the c-terminal of the protein. the finding of truncated dna mismatch repair protein muts in the newly sequenced s. aureus subsp. usa <dig> cell line is new but not a surprise. this gene is part of the bacterial mismatch repair system. it functions to correct point mutations and small insertions/deletions that fail to be proofread by dna polymerase activity. previous experiments indicated that its disruption is related to the high-frequency hypermutability and drug-resistant mutants. in p. aeruginosa, muts mutants displayed an increase in antibiotic-resistance. furthermore, antibiotic-resistant levels of the generated mutants were higher than those measured from spontaneous resistant mutants derived from wild-type cells  <cit> . in s. aureus, the inactivation of muts or mutl was associated with the emergence of a hypermutator phenotype that favors the acquisition of antibiotic resistance and facilitates bacterial adaptation during long-term persistence  <cit> . drug-resistant subpopulations with mutant genes coding for dna repair enzymes, referred to as strong mutators, were found in the laboratory populations of e. coli  <cit> ; s. enterica serovar typhimurium  <cit>  and in natural populations of e. coli  <cit> ; s. enterica  <cit> ; n. meningitidis  <cit> ; and p. aeruginosa  <cit> . all of them have a defective mismatch repair system due to the inactivation of muts or mutl genes.

additional candidates to establishing the genetic diversity necessary for the evolution of drug-resistant strains are the variants found at genes of exonuclease rexb and dna topoisomerase i. the former has a genotype of  at the chromosomal position of  <dig> , and the latter has a genotype of  at the chromosomal position of  <dig> , <dig>  substitutions at both positions lead to non-synonymous mutations, causing amino acid replacements: q620- > k <dig> at exonuclease rexb protein and v65- > f <dig> at topoisomerase i protein. the rexb is part of the cellular system that plays a crucial role in homologous recombination for the repair of a variety of dna damage, involving in the maintenance of chromosome integrity and the generation of genetic variability  <cit> . topoisomerases are essential enzymes that solve topological problems arising from the double-helical structure of dna. it is, then, related to the status of dna supercoiling, a critical factor that modulates the expression of virulence genes in pathogenic bacteria at different phases of the host-pathogen relationship  <cit> . validation of the heterogeneity sites by targeted-sequencing with different technologies would improve our understanding of the molecular mechanisms underlying the evolution and pathogenicity of s. aureus.

detection of mutations in the large gene families
mutations were not only detected in the unique genes but also in large gene families, e.g.  <dig> s rrna and  <dig> s rrna genes . the mutations in these gene families were further validated through maq with high confidence, where individual sequences from the genes were used as references. the results are not surprising. previous experiments established a clear association between mutations in the ribosomal genes and hypermutability. canu et al. detected a variety of ribosomal mutations that conferred resistance to macrolides, clindamycin, streptogramin, and

telithromycin in streptococcus pneumoniae  <cit> . prunier et al. provided additional support for the role of the rrna gene in drug resistance and hypermutability, where six strains of s. aureus were isolated from cystic fibrosis patients after treatment with azithromycin and all carried either a2058g/u or a2059g mutations within the  <dig> s rrna gene and all acquired cross-resistances to azithromycin and erythromycin, the two therapeutic agents  <cit> .

mutations were also detected in the sequences that coded for clumping factor a/b and sdrd proteins. clumping factor a/b and sdrd protein are pathogenic factors from two large gene families in the s. aureus. clumping factor a  is a fibrinogen-binding protein expressed on the s. aureus cell surface and has previously been shown to act as a virulence factor in experimental septic arthritis  <cit> . clumping factor b  is one of the microbial surface components that recognizes adhesive matrix molecules, mediates the adherence of s. aureus to immobilized fibrinogen and promotes bacterial clumping in soluble fibrinogen  <cit> . just like clumping factor b, the serine-aspartic acid repeat protein sdrd can also promote adhesion to squamous cells  <cit> . a mutant strain that lacks sdrd proteins can cause defective in adherence  <cit> .

advancement of the tool
the success of the demonstration indicated that genhtr is an improvement over available tools to calculate genetic heterogeneity. for instance, one of the biggest challenges in the solexa-based heterogeneity analysis, specifically with maq, is the low frequency of mutant subpopulation  <cit> . using the new sequence data of the s. aureus usa <dig> cell line, maq detected about  <dig> single nucleotide polymorphisms  but missed a majority of the heterogeneity sites detected by the genhtr analysis. improvement was made when solexa reads that cover the heterogeneity sites were extracted and used as an alternative maq input. additional heterogeneity sites were indeed rediscovered but not all of them. this is because a greater part of the heterogeneity sites detected have read depths less than  <dig>  a threshold used to identify snp between strains of the highly monomorphic pathogen salmonella paratyphi a  <cit> . furthermore, the analysis with a simulation procedure indicated that the read depth might contribute to the failure in this data set . in the simulation,  <dig>  solexa data sets were created separately for the depth of  <dig>   <dig>   <dig> and  <dig>  each set consists of unique solexa reads that were randomly sampled from the  <dig> solexa reads covering snp identified by maq at the position of  <dig> . all failed to pass the maq filter  except the data sets of the read depth of  <dig>  where snps were detected in  <dig> % of the simulated data. snpfilter is one of the programs in the maq package, which helps to filter snps according to predefined rules of the package.

like many other computational tools, maq analyses are local and all analyses narrow down to particular genome positions without considering global genome contexts. so, it is difficult to determine whether the heterogeneity is due to intra-genome variation or the heterogeneous population. this is exactly the case for five chromosomal positions detected in the gene-encoding putative transposase, where maq identified them as heterozygotes . the genotypic analysis indicated that they are indeed heterogeneous in the newly sequenced genome; however, they are also heterogeneous in the simulated sequence population from the isogenic reference genome, implying intra-genome variation at these sites .

in the snp analysis, maq detects potential snps via comparing the consensus sequence to the reference genomes, which are then filtered by a set of predefined rules  <cit> . the filtering rules out snps if they are, among other constraints, falling in a possible repetitive region. it is understandable to rule out repetitive regions from snp analysis due to possible intra-genome variations. the filtering, however, may have an unexpected consequence. as illustrated above, gene duplication and subsequent mutations are vital in pathogenic bacteria because they help the bacteria adapt to ever-changing environments  <cit> . by establishing and comparatively analyzing the heterogeneity genotypes at the newly sequenced strains as well as their isogenic reference strain, genhtcan identify snps/heterogeneity sites that fall in the highly repetitive regions. this can be demonstrated in the comparative analysis between s. aureus jh <dig> and s. aureus jh <dig>  using the simulation procedure , three differentiating loci were identified within the  <dig> s ribosomal rna genes . among them, two loci are heterogeneous in jh <dig> but homogeneous in jh <dig> 

future improvement
despite the success of the demonstration, there are minor concerns in the development and application of genhtr. first, genhtr utilized megablast for the mapping of the solexa reads and the identification of the genetic heterogeneity sites. the program uses a greedy algorithm for the nucleotide sequence-alignment search, up to  <dig> times faster than more common sequence-similarity programs  <cit> . the alignment tool is able to handle the massive data that solexa generated but would sacrifice certain levels of accuracies. besides its speed, another reason for choosing megablast is its intolerance for mismatches between aligned sequences. for example, runs using megablast with default megablast parameters permit only two mismatches in an alignment of  <dig> base pairs, which allow the identification of solexa reads that are likely to be orthologous to the reference genome. one of the alternative tools for aligning genome sequences with solexa reads is blat. a trial with the alignment tool indicated that it could provide much better alignments; for example, when the dna fragment of the first  <dig>  base pairs of the isogenic reference genome was run against the solexa reads, megablast achieved a full sequence alignment and a 100% sequence identity for  <dig> homologous solexa reads while the number was much larger when blat was applied --  <dig>  in total. as a result, genome coverage was increased. the average solexa reads per position was up  <dig> % from  <dig> to  <dig> when megablast was replaced with blat on the genome analysis of srx <dig>  blat was applied with default parameters, except with the option -out=blast. however, blat took a much longer alignment time than megablast, roughly  <dig> hours to align  <dig>  reference genome dna fragments  against the solexa read data while megablast took approximately  <dig> hours. on the other hand, blat is much faster if solexa reads were used as queries against the isogenic reference genome, taking only a few minutes to finish the analysis of the entire solexa data. the problem is that substitutions could disrupt the alignments when they occur at sub-centric positions . the sub-centric positions mean that the substitutions divide the read into a large dna fragment of about  <dig> to  <dig> base pairs and a small fragment of 5- <dig> base pairs. instead of making the alignment with the mismatches, blat simply aligns the larger one, then searches downstream for the sequence identical to the smaller one and aligns with it. approximately  <dig>  such alignments were found when a solexa data set was mapped to the usa <dig> isogenic reference genome. the result indicated that such analysis could compromise the snp and heterogeneity analysis if not corrected.

second, the sequencing errors are the main concerns. genhtr used the phred value of  <dig>  as a measure to determine whether the base calls from solexa reads are real or are derived from sequencing artifacts. however, a weighted function will be necessary. first, the quality scores are unevenly distributed along the 37-bp solexa reads . overall, base calls at the 5' end of the solexa read have a high-quality score that gradually decreases as sequencing reaches the 3' end  <cit> . for example, a majority of the base calls at the first position of these reads are high quality, where less than 5% of base calls have phred values of less than  <dig>  in the contrast, 10% of the base calls from position  <dig> to  <dig>  25% from  <dig> to  <dig>  50% from position  <dig> to  <dig>  and 75% from position  <dig> to  <dig> are considered to be incorrect base calls based on the threshold. therefore, the geographical location of the bases in the solexa reads is an important factor in evaluating data quality. on the one hand, bases with a low phred score are not necessarily wrong base calling. indeed, previous experiments estimated that the error rate per base read of snps detected by solexa and checked by sanger sequencing for the maq b <dig>  is  <dig>  ×  <dig>  indicating that the majority of the base calling with a low phred score is correct. on the other hand, a higher base quality is not a guarantee of correct base calling. for the maq b <dig> , the error rate is still  <dig>  ×  <dig> although tenfold lower. in addition, genotypes at some heterogeneity sites with a low phred value showed the exact same patterns as those from the isogenic reference genome . this also indicates that a base calling with a low-quality score can still be correct.

another approach to evaluate the quality of the heterogeneity sites is to determine the general tendency of base substitutions. as described above, the progressive deterioration in quality scores as the sequencing proceeds leads to higher noise levels. the consequence is intensity more close to the background, which results in misleading base calling, e.g. it is more likely to be called t than a, or c than g  <cit> . if sequencing errors are the only cause of the heterogeneity, there should be more a- > t and g- > c substitutions than any other types of substitutions at the heterogeneity sites. detailed examination of the heterogeneity genotypes found no such tendency. in section iii of table  <dig>  there are more c- > a  than any other substitutions. this is followed by g- > t  and c- > g . in fact, there are only 7% in both a- > t and g- > c substitutions, indicating that the resulting alternative nucleotides at the heterogeneity sites are not likely entirely from sequencing errors.

third, the frequency of subpopulations in bacterial clone populations represents a great challenge in heterogeneity analysis. rates from 10- <dig> to 10- <dig> of more highly vancomycin-resistant cells in hvisa cultures appear to define hvisa strains at the moment. it is certainly below the proven polymorphism detection limit. evidence also indicated that the frequency, however, varied from strain to strain and condition to condition. generally, strains with a higher level of drug-resistance appear to have higher frequencies of drug-resistant subpopulations when cultured at a medium with a lower drug concentration. for example, nyh-2*, an hvisa strain, has a minimum inhibitory concentration of  <dig> μg/ml. the frequency of drug-resistant subpopulations in nyh-2* is 100% at a vancomycin concentration of  <dig> μg/ml, 10% at  <dig> μg/ml and  <dig> × 10- <dig> % at  <dig> μg/ml  <cit> . pc-3∗ another hvisa strain with a minimum inhibitory concentration of  <dig> μg/ml, has a drug-resistant subpopulation frequency of 100% when cultured at all three vancomycin concentrations:  <dig> μg/ml,  <dig> μg/ml, and  <dig> μg/ml  <cit> . thus, a better experimental design plus greater genome coverage are expected to overcome the low polymorphism detection limit.

finally, the complexity of bacterial genomes will make it difficult to assess the heterogeneity status of particular chromosomal positions if they occur in the dna fragments with multiple copies, e.g. those observed in 5s/ <dig> s ribosomal rna and genes encoding sdre protein and clumping factor a/b . in these cases, the heterogeneity sites can be interpreted to be due either to mutations between paralogs  or to mutation in orthologs . on the other hand, the heterogeneity sites detected in the single-copy dna fragments are less problematic. these sites cover many positions in protein-encoding genes, including those at penicillin-binding protein  <dig>  exonuclease rexb, dna topoisomerase i, and dna mismatch repair protein muts, and involve in  <dig> different functions. it will be a rare event for all these genes to be duplicated in such a short period of time between the isogenic isolates. in addition, no recent duplication events are detected at this or the  <dig> other completely sequenced s. aureus genomes. this allows us to predict that the sites are truly heterogeneous, which likely represent multi-variants in the bacterial populations.

CONCLUSIONS
in summary, genhtr was developed and tested with a newly sequenced s. aureus usa  <dig> cell line. although it is much more time-consuming when compared to maq, a popular tool for snp analysis, genhtr is able to build genome-wide heterogeneity genotypes for both newly sequenced genomes  and their isogenic reference genome . from that, genhtr can predict potential multiple variants that pre-exist in the bacterial population as well as snps that occur in highly duplicated gene families. in addition, the establishment of genome-wide heterogeneity genotypes for newly sequenced genomes and their isogenic reference genomes allows the heterogeneity to be quantified. for example, we plan to use an evolving distance  to quantify how many newly sequenced strains are evolved from the isogenic reference strains and characterize loci that have a greater complexity than those that happened in the  <dig> s rrna genes. the successful implementation and testing of genhtr is expected to have a large impact on the research of bacterial pathogen. rather than identifying sequence variations from strains to strains or isolates to isolates  <cit> , the solexa technology and genhtr will allow bacterial strains/isolates to be studied as heterogeneous populations instead of as monomorphic clones  <cit> . by this approach, the population dynamics of bacterial populations can be carefully characterized and comparatively analyzed with respect to genetic heterogeneity. with the paradigm shift, we expect that the evolutionary forces that shape bacterial populations can be evaluated at the dna sequence level on the whole genome scale.

abbreviations
genhtr: genetic heterogeneity analysis; rgdf: reference genome dna fragment; heterogeneity sites: chromosomal positions with multiple variants of genes in the bacterial population; snp: single-nucleotide polymorphism; irg: isogenic reference genome; rflp: restriction fragment length polymorphisms; miru-vntr: spoligotyping and the mycobacterial interspersed repetitive-unit-variable-number tandem-repeat typing in the study of m. tuberculosis populations; mlst: multilocus sequence typing; dlst: double-locus sequence typing; pdim: phthiocerol dimycocerosate.

competing interests
the author declares that he has no competing interests.

authors' contributions
gx carried out software development, data analysis and manuscript preparation, and approved the final manuscript.

supplementary material
additional file 1
table s1: statistic of the new genome

click here for file

 additional file 2
table s2: copy number and heterogeneity in the simulated data from the referenced genome

click here for file

 additional file 3
table s3: distribution of "heterogeneity" sites at the isogenic reference genome.

click here for file

 additional file 4
table s4: affect of read depth on the performance of maq in discovering snps.

click here for file

 additional file 5
table s5: heterogeneity and snps detected by maq analysis.

click here for file

 additional file 6
table s6: genotype analysis by genhtr

click here for file

 additional file 7
table s7: mutations detected in the s. aureus jh <dig> and jh <dig> by simulation

click here for file

 additional file 8
fig. s1: differences in mutations of  <dig> s ribosomal rna between jh <dig> and jh <dig> 

click here for file

 additional file 9
table s8: blat alignment differences between two different models of analysis

click here for file

 additional file 10
table s9: percentile of phred values on  <dig> positions on  <dig> solexa reads.

click here for file

 additional file 11
table s10: a list of positions that are share same genotypes between the reference genome and those from the newly sequenced s. aureus subsp. usa <dig> cell line.

click here for file

 acknowledgements
this publication was made possible by nih grant #p <dig> rr <dig> from the inbre program of the national center for research resources and by supports from boise state university. i am thankful for the critical reading of the manuscript by my daughter michelle yu and my english tutor ruth paul at boise state university.
