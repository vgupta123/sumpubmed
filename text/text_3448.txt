BACKGROUND
evolutionary distance, the number of substitutions per site separating a pair of homologous sequences since they diverged from their common ancestral sequence, is an extremely important measure in molecular evolution and comparative genomics. it is used for a wide variety of purposes, ranging from phylogenetic analysis  <cit> , to estimating times of divergence  <cit> , the tempo and mode of evolutionary change  <cit> , and functional constraints  <cit> . evolutionary distance estimation is often one of the first steps in high-throughput sequence analysis; errors in these estimates may have wide-ranging consequences on downstream analyses and conclusions.

there are many ways to estimate evolutionary distance; accuracy of various methods tends to be dependent on proper specification of the substitution model and sequence length  <cit> . one factor that has not been well examined with respect to evolutionary distance estimation, however, is alignment . sequence alignment is an extremely common analytical tool used in comparative genomics. the purpose of alignment is to identify positions in homologous sequences that are descended from a common ancestor. because alignment is the first step in many complex, high-throughput studies  <cit> , it is often forgotten that alignment algorithms produce a hypothesis of homology . as with other hypotheses, these alignments may contain more or less error depending on the nature of the data. while it is widely recognized that highly divergent sequences are more difficult to align and will contain more error than less divergent sequences , the nature of this error appears to be underappreciated and is usually ignored.

little attention has been paid to how errors in sequence alignment affect downstream analysis. individual studies have shown that error in alignment can have broad effects on computational approaches to discovering functional elements  <cit>  and phylogenetic analysis ; these studies have been based on specific data sets and generally show that different results are obtained by different alignments, rather than estimating the amount of error generated by incorrect alignment.

i performed a simulation study to examine the relationship between global alignment accuracy and evolutionary distance estimation of noncoding dna sequences. it consists of a profile of the magnitude of error one expects to find in paired sequence alignment under the simulation conditions and the comparison of evolutionary distance estimates from correct and hypothesized alignments as the true divergence increases.

RESULTS
under the baseline simulation conditions, alignment accuracy  is largely dependent on the proportion of homologous sites containing identical nucleotides. when sequence identity exceeded 80%, essentially all aligned sites  were truly homologous . as identity declined, the proportion of correctly aligned sites rapidly decreased. when identity reached 65%, about 90% of the aligned sites were still correct, but when identity reached 50% accuracy dropped to 30–65% . when fewer than 50% of truly homologous sites were identical, alignment accuracy becomes essentially zero.

a distinction needs to be made between the true identity of the sequences  and the aligned identity . the nature of alignment algorithms is to predict homology by inserting gaps so that sites with identical nucleotides align. when true variation among sequences is large, algorithms can be quite efficient at incorrectly inferring identity. the theoretical minimum identity for a pair of sequences under the present simulation conditions is 25–26% , yet clustal yields sequences with a minimum identity of 44% , even for random data . the inflation in observed identity is predominantly found in sequences that truly differ by more than 50% of their sites; sequences with true identity of 50% or more have less than a 1% absolute increase in observed identity after alignment.

the results represented in figure  <dig> describe the accuracy of pair wise alignment by clustal under the specific simulation conditions and alignment parameters. while these exact profiles cannot be taken as representative of alignment accuracy for all sequences and algorithms, the shape of the curve probably does reflect a general pattern. different evolutionary conditions and algorithms may lead to varying inflection points, but the general shape of the curve is likely to be constant .

up to a point, evolution distance estimation is somewhat robust to alignment error . the relative difference between evolutionary distances estimated from the true and hypothesized alignments  is less than 10%, even when up to 50% of the sites are aligned incorrectly . distance estimates from the hypothesized alignments begin to differ to a greater extent from the true alignment only when more than half of the sites are aligned incorrectly. for the jc and hky substitution models, alignment inaccuracy did not have an effect on distance estimation for true distances less than  <dig>  . for hky + Γ, alignment inaccuracy produced little effect on distance estimation even when true distances were as large as  <dig> . when scaled to percent identity , the curves for the different substitution models become congruent . the robustness of these estimates appears to be related to the inflation of sequence identity . as long as the true identity is greater than 50%, there is little inflation in the estimated identity due to alignment . this translates to relatively little error in the estimation of distance, because distance estimates are based solely on the observed proportions of sites that differ among the sequences; jc distance is based on the overall count, tamura-nei distances partition the count into transversions and purine and pyrimidine transitions. since these counts are being estimated reasonably accurately  the distance estimates are also reasonably accurate. the 50% barrier for distance estimate accuracy was also reported by  <cit>  using a least-squares approach to estimating p-distance.

it may be possible to reduce the sequence identity inflation by changing the gap and mismatch penalties ; these changes would also alter the accuracy of the alignment. the purpose of this study was not to test the best possible way to construct alignments, but rather to examine the effects of typical alignment errors on evolutionary distance estimation from dna sequences.

the effects of evolutionary parameters on alignment and distance estimation accuracy varied by parameter, but one general observation is that when the value of a specific parameter has an effect, the effect is amplified when the true distance between the pair of sequences is larger . while sequence length generally affects the accuracy of evolutionary distance estimates  <cit> , there was no interaction between sequence length and the effect of alignment accuracy on evolutionary distance estimation. the mean alignment accuracy was unaffected by sequence length, although standard deviations were much reduced for longer sequences . on the other hand, distance estimates became marginally better with longer sequences . in contrast to sequence length, increasing both indel size and rate had large effects on alignment accuracy . evolutionary distance estimation, however, was unaffected by changes in these parameters , showing a lack of association between alignment accuracy and evolutionary distance estimation .

changing the α parameter of the Γ-distributed rate variation had an easily predictable effect on alignment accuracy given the results in figures  <dig> . decreasing α, increases the magnitude of intersite rate variation ; thus, decreasing α will increase the proportion of identical sites found among the paired sequences since substitutions will occur at a fewer sites. as already shown, increased identity among the sequences leads to increased accuracy of alignment, a result confirmed in figure 4g. accuracy of distance estimates appear driven by the sensitivity of the results to proper specification of the site rate distribution  <cit> , and a relationship with alignment accuracy is uncertain. estimation of evolutionary distance with intersite rate variation substitution models requires user specification of the Γ-distribution shape parameter α. there are no established methods for estimating α from only a pair of sequences . the effect of alignment accuracy on distance estimation is dependent on the accuracy of α . when α is underestimated , evolutionary distance will be underestimated for both the true and hypothesized alignments, but the difference between these estimates is reduced . when α is overestimated , evolutionary distance will be overestimated for both the true and hypothesized alignments and the difference between these estimates is accentuated.

not surprisingly, nucleotide frequency biases have a large effect on the accuracy of both alignment and distance estimation . alignment accuracy decreases with increasing nucleotide frequency bias due to the increased probability of false homology . a corresponding increase in the error of distance estimation is seen , but the lack of alignment accuracy cannot necessarily be considered causal. note the contrast between this result and that for indel rate and size . increased indel rate and size show a similar magnitude of effect on alignment accuracy as nucleotide frequency, but without the corresponding change in distance estimation. this emphasizes the independence of distance estimation to alignment accuracy for moderate evolutionary divergences.

overall, these results are somewhat encouraging, particularly when one considers that the more realistic substitution models  are more robust to alignment error for much longer evolutionary distances. however, the robustness of these distance estimates is extremely context dependent. whether a 10% error in distance estimate is large or small depends on the questions being asked as well as the relative distances of other sequence pairs being analyzed.

some of the general results in this study have been reported previously  <cit> , but the present study differs from these in the inclusion of more complicated substitution models  and distance estimates , as well as a somewhat different approach to sequence alignment. clustal is among the most commonly used alignment programs and implements a variation of the most commonly used pair wise alignment method, the needleman-wunsch algorithm  <cit> . algorithms which make statistical estimates of alignment, either maximum likelihood or bayesian  <cit> , may also incorporate evolutionary distance estimation, sometimes estimating distances over the alignment probability landscape  <cit> . these methods may be more accurate than clustal and thus the relationships between alignment accuracy and distance estimation may be very different for these approaches than those described within this study  <cit> . one goal of this study was to profile alignment and distance estimation errors as commonly used by the bioinformatics and genomics community; the methods i employed in the present work are much more commonly used that are the statistical alignment procedures.

the performed simulations represent a global alignment condition  and thus focused on global alignment. local alignment programs and algorithms, such as blastz  <cit>  or dialign  <cit> , implicitly assume that subsections of the sequences are simply not homologous . by finding only conserved regions, local alignment algorithms essentially decrease the probability of false positives  while increasing the number of false negatives . thus, within the aligned regions, local alignment may be expected to be more accurate than global alignment, but also may lead to underestimates of evolutionary distances since the poorly conserved homologous regions will likely be excluded from the alignment. the tradeoffs between local and global alignment with respect to distance estimation need to be explored in some depth.

because alignment error appears to be somewhat underappreciated by the genomics community, the alignment error profiles are in-and-of themselves interesting. while it is generally known that sequences become difficult to align as they diverge , the precipitous decline in accuracy  has only recently been profiled through simulation  <cit> . not surprisingly, the exact nature of these curves appears to be highly dependent on indel size and rate . to some extent, the alignment accuracy profiled in figure  <dig> can be viewed as a best-case-scenario since the simulation parameters could be considered realistic, but otherwise low, values. as insertion and deletion events increase in size and rate, alignment accuracy, particularly for more divergent sequences will decline precipitously. it is certainly possible that additional accuracy may be recovered by use of different alignment algorithms or better optimization of the alignment parameters.

CONCLUSIONS
in this study, i've shown evolutionary distance estimation to be somewhat robust to errors in alignment for moderate divergences . other uses of aligned data, including for example, identification of conserved sites relative to exploration of genetic disease  <cit> , are likely to be highly dependent on the accuracy of alignment and even a tiny error may have a large effect on the results. different alignments are known to lead to different hypotheses in phylogenetic analysis  <cit> ; how various phylogenetic methods respond to alignment error is an open question in need of future study.

