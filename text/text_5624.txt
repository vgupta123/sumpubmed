BACKGROUND
as the cost of collecting omic data is likely to decrease in the coming years, methods to integrate different types of biological data are likely to become increasingly important. biological data is often expressed as network data. as a result, methods to tackle networks with different layers, each representing a different omic, are likely to play a key role to integrate these data types. a common approach in this case is a layer-wide analysis of each layer separately, finally integrating the separate results into a single aggregate measure.

however, integrating results collected on single layers separately may cause loss of information, especially in cases where the inter-layer interactions are non-negligible. intuitively, by analyzing different types of data in isolation we miss the information that is implicit in the coordinated activity of the different layers. for instance, in an application to networks of patients to investigate cancer, this approach resulted in different clusters of patients depending on which dataset was used, therefore causing incorrect subdivision of patients or samples in different molecular cancer subtypes  <cit> .

genome-scale models of biological organisms are often used to analyze the metabolic potential and to identify the metabolic interventions required to produce metabolites of interest. in this post-genomic era, more than  <dig> genome-scale metabolic reconstructions have been published to date  <cit> , for both prokaryotes and eukaryotes. computational methods on genome-scale models make it possible to explore the reaction network and find solutions that take into account noncomparable objectives, while satisfying all the given constraints.

with the growing availability of multi-omic databases, model-building and data integration techniques, a number of methods for integration of omic data have been proposed recently . the wide variation in response of a single organism across differing conditions is facilitated by complex metabolic networks, which often include multiple levels of redundancy and adaptability. this is evident in the heterogeneity at the transcriptomic, proteomic and fluxomic levels across conditions  <cit> . in this regard, evaluating and aggregating in a single network the response to growth condition on different omic layers, while accounting for the dependence between the metabolic response at different levels , is a highly desired feature, as it increases the reliability of any comparative analysis performed on the conditions, and provides overall topological information.

our idea is to integrate multiple data types, collected from a comprehensive set of environmental conditions in which escherichia coli was grown. these conditions are modeled as a multiplex network. specifically, we focus on the transcriptomic layer  and on the fluxomic layer . the idea is that analyzing growth conditions by focusing only on a single omic level will likely miss complementary information and therefore lead to incorrect evaluations. for instance, considering only gene expression profiles as a response to conditions will miss the actual metabolic response of the bacterium, and will not provide insights into the resulting cellular behavior.

two main methods have been recently proposed to address the task of integrating multiple data types in an aggregate layer of a multiplex network. icluster, developed by shen et al.  <cit> , proposes a joint latent variable model for integrative clustering of multiple genomic datasets. more specifically, tumor subtypes are modeled as unobserved latent variables, which are then estimated from the multiple data types available. since icluster does not scale to the entire set of available measurements and therefore needs gene preselection steps, an alternative approach was developed by wang et al.  <cit> , which is instead based on networks of samples as a starting point for the creation of an aggregate layer. both methods have been only proposed on genes and, since a genotype-phenotype link is missing, they are not able to target and classify growth conditions.

unlike the existing methods for network aggregation, we propose a weighted network fusion that takes into account the importance of each layer. this allows us to apply our method to multi-omic genome-scale models where nodes represent environmental conditions and layers represent transcriptomic and phenotypic information. the weight measures the relative importance of each layer, which is quantified by the reliability of the genome-scale model in predicting correct flux rates starting from gene expression data. as a result, our multiplex network approach is able to integrate and elucidate condition similarity in multi-omic genome-scale models, and to be calibrated to the quality of different data types available for a given organism. to test our method, we build a genome-scale model of escherichia coli, starting from the ijo <dig> reconstruction  <cit>  and including recently discovered gene-protein associations and a comprehensive set of underground metabolic reactions.

the steps of our method are presented in fig.  <dig>  to our knowledge, this is the first attempt of multiplex analysis on a genome-scale metabolic network from a condition-based perspective. we take into account condition-dependent omic data and, for the first time, we propose a method for weighted network fusion of omic layers in a multiplex.
fig.  <dig> the transcriptomic and fluxomic layers of environmental conditions constitute our multiplex  network, where nodes are environmental conditions. the real-valued gene-reaction map φ converts gene set expression values into flux bounds for the trilevel fba model of e. coli . for each condition, the gene expression profile is mapped to the metabolic model, and a trilevel linear program is solved to calculate the condition-specific distribution of flux rates, therefore linking gene expression to phenotype. a network of conditions is then built independently in both layers. the multiplex network is then fused into a single network through our weighted network fusion approach. finally, further learning is performed on the combined network to elucidate relations between conditions



methods
an improved model of escherichia coli with underground metabolism and new gene-protein-reaction associations
to obtain the model used in this study, we started from the ijo <dig> e. coli reconstruction  <cit> . we then added the full set of underground reactions reported by notebaart et al.  <cit> . these underground reactions occur at low rates compared to the rest of the metabolic network, and new metabolites are usually detected with low abundances. interestingly, the effect of the underground reactions is promptly detected in the newly built genome-scale model, since many underground reactions share metabolites with existing reactions or constitute new pathways leading to precursors for biomass production.

finally, we included new gene-protein-reaction  associations uncovered by enzyme promiscuity analyses and failed predictions of gene essentiality  <cit>  . these cases are derived from a workflow applied to aspc, argd and glta, three genes that were incorrectly predicted as essential genes in the previous genome-scale reconstructions, therefore suggesting missing isozymes responsible for the corresponding reactions. potential missing isozymes were identified by running blastp  <cit>  on the protein sequences, and predictions were confirmed by single- and double-knockout analysis.


we remark that adding the underground metabolic reactions and the new gpr associations did not generate detrimental intermediates or reduced flux in those pathways supporting generation of biomass. the inclusion of underground metabolic reactions also increased flexibility and fitness under various growth environments. the resulting model, provided as additional file  <dig>  contains  <dig> genes,  <dig> reactions , and  <dig> metabolites.

steady-state analysis of genome-scale models
various techniques for modelling and simulating metabolic networks have been developed in recent years to better understand bacterial metabolism, as well as to support rational design for reprogramming microorganisms and overproducing biochemical compounds  <cit> . arguably, the most successful technique for predicting flux distributions at steady state is flux-balance analysis   <cit> . fba is based on two main assumptions:  homeostatic assumption, i.e. the organism has reached a steady state where the metabolite concentrations are constant and a set of nutrients are being constantly converted to generate biomass;   optimality, i.e. in each state the organism tends to maximize one or multiple objectives, usually related to growth, excretion of biotechnologically-relevant metabolites and important energy-carrying molecules. fba is suitable for analyzing the flow of metabolites through a metabolic network .

let the metabolic network be composed of m metabolites with concentration xi, i= <dig> …,m and n reactions with flux rates vj, j= <dig> …,n. the derivative of the concentration of each metabolite can be computed through a linear combination of the input and output reaction fluxes, which produce and consume  that metabolite. the balance that metabolite concentrations xi must satisfy is dxidt=∑j=1naijvj,i= <dig> …,m, where aij is the stoichiometric coefficient of the ith metabolite in the jth reaction. under steady state conditions dxidt= <dig> ∀i, the balance for the ith metabolite is ∑j=1naijvj= <dig> . therefore, at steady state, the balance equation is av= <dig>  where a is the stoichiometric matrix , and v is the vector of the flux rates .

quantitative gene expression levels in genome-scale models
recently, fba has been integrated with regulatory constraints taken from gene expression data. for a comprehensive evaluation of these methods, the reader is referred to the paper by machado and herrgård  <cit> . the most widely used approach for linking gene expression level and fba models consists of removing those reactions in the model that are linked to genes whose expression is below a specific threshold. this approach allows a fast implementation of the effect of gene expression variations on the model, but does not provide the necessary level of information needed for a comprehensive and predictive steady-state biological model. furthermore, it forces the gene expression levels to be mapped onto a binary domain { <dig> }, depending on whether the corresponding reaction is active or switched off. finally, the introduction of the on/off threshold restricts the possible optimal configurations to a few points in a discrete variable space  <cit> . a further limitation of these methods is that they consider only one objective, or a linear combination of objectives ; this does not allow one to fully explore the metabolic potential of the organism, where competing goals may lead to a maximized production of a given chemical while simultaneously ensuring high growth rate.

we overcome these limitations by using multi-level linear programming and by modeling the upper and lower bound of each reaction as a continuous logarithmic function of the related transcriptomic data, using metrade  <cit> . in this way, the gene expression values are mapped onto the set of all real numbers, and are scaled to become rna abundances, thus controlling variations of the reaction fluxes. since the expression data is related to genes while the reactions in the fba model depend on gene sets, we also provide a function acting as an interface between the data and the model . each reaction in a fba model depends on a single gene set that controls the reaction through and/or operators between genes. we formalize these relations using the min and max operators, which make it possible to convert the gene expression levels θ into a “gene set expression level”θ  <cit> . specifically, we use the following rules valid for the three basic cases of gene set: 
  Θ=θfor single genes,Θ=min{θ,θ}for enzymatic complexes,Θ=max{θ,θ}for isozymes. 

note that the expression level of nested gene sets is computed by applying these rules recursively.

multi-level condition-specific metabolic networks
in the present study, each condition and the corresponding gene expression profile are used as indicators for the activity of the associated reactions in the model, and are therefore mapped onto the model and finally associated with a point in a multi-dimensional phenotypic space. we assume that the genetic level is slower than the metabolic one; the time that chemical reactions within the cell need in order to reach a steady state is usually less than a minute  <cit> , and therefore the steady state is reached faster than the variation of enzyme concentrations caused by changes in the gene expression profile. furthermore, we account for the fact that the importance of a gene for the metabolism is negatively correlated with the variance of that gene across the experimental conditions  <cit> . essential genes are in fact more tightly regulated and evolve slowly, as a high variance of gene expression level of essential genes would affect all the downstream genes and is more likely to be less tolerated in a large interaction network  <cit> . for instance, essential genes in the metabolic network are those coding for an enzyme controlling a reaction which is upstream of many others . to this end, we take into account the inverse of the variance of a gene across conditions as a multiplicative factor for the lower and upper bound of the flux regulated by the gene.

formally, we define the trilevel linear program 
  maxh⊺vsuch thatmaxg⊺vsuch thatmaxf⊺vav= <dig> viminφ≤vi≤vimaxφ, 

where i ranges over the reactions , while f, g, h are n-dimensional boolean arrays of weights associated with the three flux rates  selected as objectives in the model. vmin and vmax are the arrays of default lower and upper-bounds for the flux rates in the model. if Θi is the gene set expression of the ith gene set , the function 
  φ=1+γσi2logsgn,i= <dig> …,n 

= <dig> if Θi=1) maps the gene set expression value onto the metabolic model. the sign operator is defined as sgn=/|Θi−1|. σi <dig> is the variance of the ith gene set, computed from the variance of the genes involved using the rules  defined to map the gene expressions to the gene set expressions. γ is the weight for the variance, and constitutes the reliability of the variance as an indicator of the importance of the genes in the model.

the reasons for choosing this mathematical structure are as follows. logarithmic and multi-layer processes are not uncommon in biology  <cit> , where many processes display a multiple layer architecture in order to produce amplification in cascades . although the correlation between gene expression and metabolic phenotype is still a matter of debate, our assumption of a logarithmic map φ is supported by recent evidence that, although protein synthesis rate increases with increasing mrna abundance, the rate of increase is lower for high mrna abundance  <cit> . furthermore, φ provides full compatibility with the above-mentioned boolean on/off approaches, as it approaches zero when the expression level approaches zero. being an approximation of a linear function around  <dig> , we also capture the property of roughly linear relation between gene expression and enzyme activity for the wild-type e. coli  <cit> .

the definition of φ is also useful when searching for optimal gene expression values in a given condition  <cit> . such algorithm would not be encouraged to search for unrealistically high values of gene expression levels, since this would not be converted into weak constraints . as introduced above, the parameter γ is quantifying the role attributed to the variance as an indicator of the importance of a gene . by increasing the parameter γ, we increase the ability of the gene expression values to fine tune the final reaction rates. the method is robust with respect to perturbations of γ, while variations of orders of magnitude lead to an increase of the metabolic sensitivity to the different environmental conditions.

here we use the logarithmic map  to set constraints for the metabolic model, then we solve the linear program  to find the flux distribution. while suggesting a logarithmic map, we remark that φ is fully adjustable depending on the type of model and on further data available on protein abundance, which would allow a reaction-specific definition of φ. given existing evidence for a logarithm-like regulation of reaction rates, when incorporating additional experimental data into the model, we suggest keeping the logarithmic map and calibrating the base of the logarithm and γ as adjustable parameters. with good accuracy, our method enables the prediction of the condition-specific growth rate measured experimentally. it also outperforms existing methods based on linear associations between gene expression and reaction flux bounds. overall, it shows high correlation between experimental and predicted rates .

multiplex networks to model omics response to environmental conditions
multilayer networks are particular types of networks used to model interactions between components in a system where different channels of connectivity are explicitly taken into account. a channel is associated with a layer, and each node may have different interactions with the other nodes, depending on the layer where these interactions take place  <cit> . our focus is on investigating similarity between environmental growth conditions by analyzing the e. coli response from a multi-omic perspective. to this end, we link the two layers through a gene-expression driven trilevel linear program. this multi-level structure accounts for the fact that the actual bacterial response to any environmental condition is highly dependent on multiple cellular objectives that the bacterium is required to meet  <cit> .

since we are interested in analyzing conditions and finding condition similarity from the transcriptomic and fluxomic viewpoints, we construct a multiplex with these two layers, where nodes are environmental conditions. the edges between nodes in each layer represent a measure of similarity between conditions in terms of gene expression profile and metabolic flux profile respectively. in order to obtain a global picture of similarity between conditions, we aggregate both layers in a single-layer network through a weighted network fusion approach. after aggregating the system into a single network, we adapt measures on graphs with the aim of identifying clusters of similar conditions, where the similarity takes into account the two omics  and the metabolic network.

similarity network fusion 
motivation
in recent years, complex networks have come to increased prominence as a dataset type. many types of information, particularly in biology, are best represented in terms of pairwise interactions  between entities , which can be a particularly compact form for large systems where only a small proportion of elements have interesting interactions.

as more datasets are gathered and stored as complex networks, it becomes increasingly common to find multiple network datasets  that refer to the same entities . we might suppose that sometimes these network datasets are different reflections of some common underlying network, and we may wish to integrate the known dataset to discover the structure of the underlying, unknown, dataset. this is the purpose of similarity network fusion   <cit> .

definition of w
w are the base similarity networks that need to be integrated. in each layer, if the entries of w  are already representing similarity between nodes of the network, then they only need to be normalized to be positive and in , e.g. by squaring and dividing by the maximum. for instance, social networks are often natively similarity networks, where edge weights are counts of various friendly events between individuals.

however, distance is probably more common than similarity as an edge weight type. when we have distances, we must transform them to similarities, with wang et al.  <cit>  suggesting a scaled exponential similarity kernel: 
  w=exp−ρ2μεi,j. 

definition of p0
p <dig> are the starting state of the networks, which will be modified as the algorithm iterates. as such, they start as normalized versions of w. appropriate normalizations are: 
  p0=d−1w 

where 
  d=∑jw, 

or 
  p0=w2∑k≠iwifj≠i12ifj=i 

which is more robust to numerical instabilities.

definition of s
s are local similarity matrices for the networks. these are modified similarity matrices such that only the k nearest neighbors of a node have nonzero similarity. if ni is the set of neighboring nodes of xi , then we define local similarity by: 
  s=wifj∈ni0otherwise 

core operation
the core network integration procedure consists of iteration of the following update equation: 
  pn+1=sn×∑k≠vpnm−1×snt,v= <dig> …,m, 

where v is the index of each of the m layers, k ranges over all layers except for the one under consideration, n is the iteration number, pn is the similarity matrix, and sn is the local similarity matrix, both referred to the vth layer at the nth iteration.

for a set of networks , this iteration repeatedly makes each network more similar to the others until they converge to a single integrated network.

code listings
for those readers who find source code more illuminating than equations, the file https://github.com/maxconway/snftool/blob/master/r/snf.r is a good place to start.

biased similarity network fusion
to combine the multiple gene expression and phenotype networks together we propose a technique based on snf  <cit> . snf takes a number of networks with the same set of nodes , and iteratively alters each network to resemble the others, until all the networks converge to an aggregate network . the key idea in this study is to aggregate weighted layers of environmental conditions, measured in the transcriptomic and fluxomic levels, each constituting a layer of the multiplex. to this end, we develop a weighted similarity fusion approach that allows us to account for the quality of the metabolic reconstruction when linking gene expression and phenotype. we therefore allow the use of a bias between layers to reflect this. for instance, in the network fusion process, if the predictive capability of the genome-scale model is high, one is able assign more importance to the phenotypic data rather than to the transcriptomic data.
fig.  <dig> visual schema of the multiplex fusion algorithm. the bottom layer in panels  represents the transcriptomic information, while the top layer represent the fluxomic information. each circle represents a feature  of the system, which we consider as an environmental condition. black connectors represent parameter relationships; red links represent the mapping from gene expression to phenotype through the metabolic map φ, and also convey the information related to the message passing method for the snf approach. the four panels represent: a ideal scenario; b more likely real scenario; c fusion proximity; d fusion and reduction of parameter complexity, performed through measures on single-layer networks 



since our multi-omic model and trilevel formulation provide phenotypic flux rates from gene expression profiles associated with growth conditions, one may object that the transcriptomic layer should carry no weight in the fusion process. however, we remark that the fluxomic layer is a result of predictions of the metabolic model, and therefore it should not be considered as the only indicator of the response to a given condition. in fact, in applications to genome-scale models , we suggest setting the weight as the level of confidence in the model itself.

in order to perform network fusion, we create a similarity matrix of environmental conditions in two different layers: transcriptomics and fluxomics. first, we remove gene expressions and fluxes for which less than  <dig> % of values were known and finite. then, we divide each expression and flux into  <dig> quantiles, and replace each value by their quantile number, to deal with the high kurtosis; finally, we calculate the euclidian distances between nodes , and we find similarities pij in each layer v by exponential negative squared euclidean distance 
  pij=e−dij <dig>  

where dij denotes the euclidean distance between the two arrays representing conditions i and j in the vth layer.

let p be the multiplex network of similarity between environmental conditions. p is computed, using  on m= <dig> omic levels, i.e., from the distance between gene expression arrays in the transcriptomic layer, and from the distance between flux rate arrays in the phenotype layer. the central equation of standard snf is eq.  <dig>  which is iterated to actually conduct the fusion process, namely a finite number of message passing steps in which the m layers co-evolve. eq.  <dig> describes the update step for each of the m status matrices p, representing similarities of conditions in each layer. these matrices are initialized as a normalized form of the similarity matrices of the m networks. s are kernel matrices, giving a normalized form of similarity only to the k nearest neighbors.

note that eq.  <dig> computes an unweighted mean over p. to introduce a weighted network fusion, we introduce a vector of biases, b∈rm, which are used to alter the update step and take a larger input from some of the m layers than others. then, we replace eq.  <dig> by performing the following update step for each layer: 
  p=s×∑k≠vp×bk×∑k≠vbk×st,v= <dig> …,m. 

in addition to introducing a layer bias, we added convergence detection based on the first and second discrete derivatives, and parallelized each iteration for an m−fold performance increase when fusing m networks. our weighted network fusion method is freely available at https://github.com/maxconway/snftool.

RESULTS
estimating optimal bacterial response in multidimensional phenotypic spaces
a common assumption in systems biology is that microorganisms tend to shape their metabolic network in order to maximize the growth rate . however, whether the biomass is the right objective for the analysis of the metabolism is still a matter of debate  <cit> . furthermore, there is increasing evidence that bacteria have to cope with multiple, sometimes competing, objectives that must be fulfilled simultaneously  <cit> . it is also likely that evolution has shaped cells in order to reach an optimal trade-off between all their objectives  <cit> . this suggests that a single-objective approach, the maximization of the growth rate, may not be appropriate in many systems biology applications.

to enable a multi-objective view of the metabolism, we base our method on a multi-level linear program aimed towards classifying the bacterial response associated with external or growth media conditions in any multidimensional objective space chosen by the researcher. our pipeline can be used to design environmental conditions that likely lead to a desired phenotype. due to its real-valued kernel, it is well suited for applications involving various perturbations, such as different codon usage bias or continuous genetic manipulations.

we apply our multi-level linear program  by mapping the colombos v <dig>  compendium of expression data  <cit> , which includes e. coli microarray profiles for  <dig> measured conditions, to an e. coli model that includes underground metabolism . the expression profiles have been measured using microarrays  with raw hybridization of intensities, as well as rna-seq  with short read sequences, therefore obtaining homogenized expression profiles. conditions have been fully annotated through manual curation. in fig.  <dig>  we show the  <dig> conditions projected to the three-dimensional spaces biomass-acetate-formate and biomass-succinate-ethanol using eqs.  and choosing the triplet of objectives using f,g,h in eq. . each space is then further projected to the three two-dimensional subspaces. as a result, we map the set of experimental conditions to a set of metabolic networks, each of which yields a specific amount of output metabolites. the red and green lines indicate the trade-off between the two objectives shown, across the sets of aerobic and anaerobic conditions. the full list of colombos conditions and the corresponding flux rates predicted using trilevel linear programming are reported as additional file  <dig> 
fig.  <dig> the  <dig> colombos gene expression microarray profiles mapped to the tridimensional space of objective functions biomass-acetate-formate  and biomass-succinate-ethanol  using trilevel linear programming ). each gene expression profile is translated into flux bounds using ; then, the trilevel problem  is solved with biomass-acetate-formate and biomass-succinate-ethanol as objectives, thus obtaining a point in each of the two objective spaces. in both objective spaces, we show the conditions mapped to the full space , and the projections to the three two-dimensional subspaces: first-second objectives , second-third objectives , first-third objectives . we also find the trade-off between the two objectives shown in each subspace, across the sets of aerobic and anaerobic conditions. the color scale shows the value of the third objective in each point. among the  <dig> conditions ,  <dig> conditions are anaerobic. the plot also shows the subspace where e. coli operates in both the objective spaces selected and allows cross comparing the metabolic flexibility when production of different metabolites is required simultaneously



when maximizing for acetate and formate production, e. coli shows greater variability and different outcomes in different conditions. conversely, when maximizing for succinate and ethanol production, less conditions are able to ensure high succinate or ethanol production. interestingly, many conditions able to ensure high ethanol production are anaerobic. in the acetate-biomass space, the two trade-off curves intersect, due to the fact that in one anaerobic condition e. coli is able to produce  <dig>  mmol h − <dig> gdw − <dig> of acetate while keeping a growth rate of  <dig>  h − <dig>  this configuration is not reached in aerobic conditions. we also note that the presence of oxygen strongly affects the bacterial response in the ethanol-biomass space .

the distinction between aerobic and anaerobic conditions is of great metabolic importance, and it is reliably recorded in the colombos condition database. from fig.  <dig>  we note that under almost all circumstances, the aerobic pareto front covers more “metabolic space”, since adding oxygen allows more possible metabolic configurations. furthermore, a large number of conditions excrete none of each of the byproducts. this is also unsurprising, since excreting these byproducts effectively means excreting energy, which has obviously been selected against. we also note that, in the graphs showing biomass and byproduct excretion, for all byproducts except for succinate, there is a clear scarcity of conditions in the high byproduct, low biomass region . we hypothesize that this is due to the fact that if the overall metabolism of the cell is slow, i.e. low biomass, it will be more difficult for the cell to spare resources to give high byproduct production while still remaining alive.

interestingly, only a few conditions are able to produce simultaneously succinate and ethanol. in fact, the succinate-ethanol and biomass-ethanol subspaces are where the difference between aerobic and anaerobic condition is more evident. this is mainly due to the difficulty in producing ethanol and high amount of biomass in anaerobic condition . indeed, the trade-off in anaerobic condition is far from the trade off in aerobic condition especially in the low-biomass and high-biomass intervals. this is not observed in the succinate-biomass phenotypic space, where the aerobic trade-off is close to the aerobic trade-off even at high biomass production rates.

validation on a phenomics dataset of growth conditions
in order to validate our method for associating a predicted growth rate to each condition, we consider a recent phenomics dataset of  <dig> growth conditions  <cit> . on the new model of e. coli we obtain encouraging results in predicting the growth rate from a set of expression profiles associated with different experimental conditions . specifically, we obtain a strong correlation between predicted and measured growth rates . a comparison between predicted and measured growth rates is reported in fig. 4b. as shown in fig. 4c, the best results are obtained with the subset of conditions representing inhibited protein synthesis by supplying chloramphenicol to the growth medium .
fig.  <dig> validation on the phenomics dataset of growth conditions by hui et al.  <cit> . the dataset includes five c-lim conditions , five a-lim conditions , and four r-lim conditions . a the  <dig> gene expression profiles are mapped to the biomass-acetate space of flux rates. each gene expression profile yields a condition-specific metabolic network, solved as a bilevel linear program with biomass-acetate as objectives, thus obtaining a point in the objective space. the c-lim experimental conditions allow for more acetate production while ensuring higher growth rate and greater variability in different conditions. b measured growth rates are compared with those predicted by our method in the  <dig> growth conditions. c we obtain a good overall correlation between our predicted values and the measured growth rate, with spearman’s ρ= <dig>   and pearson’s r= <dig>  . the diagonal “predicted = experimental”, representing the ideal outcome, is also shown for comparison



we report that our method consistently outperforms the methods for integration of gene expression data in fba that employ a linear map between gene expression values and the multiplicative factors for the flux bounds . for instance, with the dataset used in this study, linearly increasing and decreasing bounds according to gene expression data only leads to a pearson correlation of  <dig>   and, surprisingly, to a negative spearman correlation of − <dig>   between predicted and measured values.

the inclusion of the underground reactions causes a relevant effect in the prediction of growth and production of additional objectives performed through flux-balance analysis. this is due to the fact that underground reactions share several metabolites with the ijo <dig> reactions. some underground reactions also take part in pathways leading to biomass precursors.

multi-omic and multi-condition network fusion
in the transcriptomic layer, a condition is represented by a gene expression array; conversely, in the phenotypic layer, it is represented by a flux rate array. our phenotypic flux data and, to a lesser extent, colombos expression data displayed high kurtosis, indicating that both layers display many outliers. we do not remove outliers for two main reasons: first, in some cases this would remove most of the data; second, this represents a biologically reasonable all-or-nothing regulation, as one would see in a bistable system created by positive feedback in regulation .

after constructing the multi-omic similarity network , we fuse together the phenotype and gene expression layers with a k value of  <dig>  and a phenotype-transcriptome bias of 2: <dig>  we then assess the resulting network by conducting spectral clustering and plotting a heat map. we find that three clusters best represent the data. while moving to larger numbers of clusters could decompose the center cluster slightly, it sacrifices most of the contrast at the cluster boundaries. figure  <dig> shows the heat map resulting from the spectral clustering performed on the fused network, whose outcome is reported in  <cit> .
fig.  <dig> heat map of the similarity matrix of the fused network from our case study, arranged by spectral clustering into three components. the x and y axes represent the  <dig> conditions, while the intensity of the colors in the center represent the similarity between each of the pairs of x and y conditions. the red numbers are cluster labels, from  <dig>  to  <dig> . the intensity of the orange and green bars on the top and side represent 5-deoxyribose exchange rate and biomass production, respectively. the rate of both these fluxes can be partitioned and can be used with high confidence to provide clear distinctions between the clusters of conditions. the partitioning process we used was able to provide a similarly clear distinction in both dimensions using each of the fluxes reported in table 2




to detect those fluxes and expressions that are most indicative of the three configurations, we employed a regression technique based on recursive partitioning  <cit> . this suggested a number of decision trees with only two rules splitting on flux values, each able to assign the correct cluster in  <dig> % of cases. we validated these fluxes as genuinely important via bootstrapping: on repeated samples of  <dig> % of the data, the same fluxes were detected as important. the fluxes we found to be closely associated with clustering are reported in table  <dig>  of these, we can immediately associate biomass generation and 5-deoxyribose production with growth rate. the other exchange reactions may have specific relationships with growth rate configurations, or their detection may be due to a general correlation between rates of bacterial growth and excretion of byproducts. the orange and green bars in fig.  <dig> show how effective these fluxes are in partitioning the data into clusters. interestingly, two out of five predictors are underground reactions.

discussion
multi-layer networks are increasingly being associated with microorganisms, with a rapidly growing number of applications in systems biology  <cit> . bacterial metabolism can itself be thought of as a multi-layer network. this is due to the fact that a microorganism builds complexity in time and space by evolutionary increasing its capability of performing computation through chemical reactions over time, increasing the so called “bacterial computational capability”  <cit> , usually through late transfer of modules that have spread across bacterial species. bacteria have therefore hierarchical regulation machineries for processing gene expression to rna, rna to proteins, proteins to post-translational modified  proteins, and finally complexes of elements to structural organized macrostructures.

while single-layer networks are able to model interactions between components, their strongest assumption, i.e. all the interactions between two nodes can be mapped as a single link, does not always hold in biology. interactions between the same nodes can occur at different levels and in different settings  <cit> . for instance, in case of a compendium of environmental growth conditions for a microorganism, the bacterial response is measured at different omic levels. in this study, we analyzed the transcriptomic and fluxomic levels.

CONCLUSIONS
when we are interested in classifying similarity among growth conditions, and in finding communities structure within their network, we must account for the different omic levels where the response to these growth conditions can be measured.

after building a genome-scale reconstruction of escherichia coli that takes into account underground metabolism, we map a set of growth conditions to the biomass-acetate-formate and biomass-succinate-ethanol spaces of flux rates. this allows us to estimate the metabolic potential of e. coli, and to predict regions of the fluxomic space where the bacterium operates in different conditions. as a result, each condition is represented by a gene expression profile in the transcriptomic layer, and by a flux profile in the fluxomic layer. in both layers, a network of conditions is built taking into account similarity between gene expression profiles and predicted flux rates respectively. we then fuse the resulting multiplex network into a single-layer network, by introducing a bias to represent the weight put on the phenotype layer rather than on the gene expression layer. this weight should be related to the accuracy of the genome-scale metabolic reconstruction. for instance, for large and exhaustive models , the information we gather after taking into account the predicted phenotype is likely to be more detailed than merely considering the gene expression levels.

our multi-omic network fusion method builds on snf to allow us to:  specify a bias between layers;  calculate a similarity matrix in a robust fashion despite extremely high kurtosis distributions; and  attribute the clusters in the fused similarity matrix to a subset of dominant reactions.

integrating multiplex networks of omic levels in combination with metabolic models serves as an indicator of the behavior of the phenotype across the phase-space of all possible gene expression profiles, and their associated metabolic networks. this paves the way for the high-level topological understanding of multi-omic and multi-condition models. assigning a specific metabolic model to each experimental condition proves useful in a number of applications. for instance, using the phase-space of conditions, one can predict and investigate metabolic regions in which the bacterium can work under many experimental settings, as well as unapproachable regimes, or regions in which it can grow only in specific conditions. furthermore, given topological information on the space of experimental conditions, one can infer the position of non-tested or incomplete expression profiles.

multi-omic data modelling will also provide insights into the complexity of regulatory metabolic mechanisms. however, such complexity could be meaningfully analyzed and used in metabolic engineering only through comparative analysis of the organismal response to thousands of environmental conditions. it is noteworthy that this approach resembles the deep phenotyping techniques used in medicine.

availability
the datasets supporting the conclusions of this article are included within the article . our weighted network fusion method for genome-scale models is freely available at https://github.com/maxconway/snftool.

additional files
additional file  <dig> 
the improved model of
escherichia coli
 with underground metabolism. the model is provided as a matlab file compatible with the cobra toolbox. it includes the reactions in the latest ijo <dig> reconstruction, as well as underground metabolism and new gene-protein-reaction associations. the resulting model contains  <dig> genes,  <dig> reactions , and  <dig> metabolites. 



additional file  <dig> 
flux rates of colombos conditions. full list of colombos conditions and the corresponding flux rates predicted using trilevel linear programming. 



abbreviations
snfsimilarity network fusion

fbaflux balance analysis

gprgene-protein-reaction

lblower bound

ubupper bound

competing interests

the authors declare that they have no competing interests.

authors’ contributions

ca mc pl conceived the study and devised the methodology. ca collected the data and built the models. ca mc developed the methodology and wrote the code. ca mc pl wrote the manuscript. all authors read and approved the final manuscript.

declarations

the publication charges of this article were funded by fp7-health-f5- <dig> under grant agreement no.  <dig> . the funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.

this article has been published as part of bmc bioinformatics volume  <dig> supplement  <dig>   <dig>  selected works from the 14th international workshop on network tools and applications in biology . the full contents of the supplement are available online at https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-17-supplement- <dig> 

