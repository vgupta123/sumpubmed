BACKGROUND
when a new protein sequence becomes available the problem of its annotation poses. most of our expertise in trying to endow the new sequence with structural and functional features is based on similarity search  <cit> . methods are mainly based on the knowledge that structure is more conserved than sequence through evolution and that structural alignment is conserved as long as sequence identity  is ≥ 30% over the alignment length. this was observed originally by chothia and lesk  <cit>  and once in a while revisited at increasing number of proteins solved with atomic resolution and deposited in the protein data bank   <cit> . the observation is at the basis of one of the most popular method for computing the three dimensional structure of the target on a template, when found, after a sequence similarity search against the pdb  <cit> . recently maps of the protein structure space have revealed fundamental relationship between protein structure and function  <cit> . when a target sequence well aligns with a template of known structure, its functional properties can be derived on the basis of structural conservation. proteins sharing some 40-60% of sequence identity are likely to share also similar function  <cit> .

however a problem is at hand: how to recognize structural and functional templates when sequence identity is below 30%. in this case proteins are categorized to be distantly related to their homologous counterparts, since they may perform the same function, and possibly be endowed with the same structure although sharing very little sequence homology  <cit> . to this purpose methods have developed trying to grasp local sequence conservation by modeling protein conserved structural and functional domains. the most popular is pfam . in this case function can be inferred when a protein is significantly retained by a specific pfam model that is again based on a local sequence-to-profile alignment and its scoring. superfamily , based on hidden markov models as pfam, has been recently modified to address specifically the problem of function assignment by including a domain-based gene ontology  <cit> .

when function is to be assigned only on the basis of sequence, the problem still remains unsolved, since very little is known on the relationship among sequence similarity and transfer of function  <cit> . functions can be described with specific terms following the gene ontology vocabulary and comprising three main functional branches: molecular function , biological process , and cellular component   <cit> . uniprotkb, the largest resource of protein sequences curates automatically annotated protein records . here annotation integrates previous knowledge on protein structure and function from various sources, when available, again mainly based on sequence similarity search . eventually the records are manually curated . however out of the over  <dig> millions sequence entries presently available , 75% are proteins inferred by homology or predicted whose features in most instances are far from being attributed even with computational methods.

several methods have been developed to predict protein function from structures and sequences trying to infer features from selected and well annotated sets of proteins by mean of different computational approaches, including machine learning, and generally aiming at integrating different source of information .

here we take advantage of the recently released set of proteins selected by cafa  for function prediction in order to discuss how inheritance of annotation can be statistically validated. validation is indeed an added value to the annotation process, when possible. for this we developed bar+  <cit> , a non hierarchical clustering annotation procedure that allows different types of annotation by means of a cluster-mediated transfer of annotation. we also show that our method allows a gain of annotation over a direct pfam prediction and goa electronic annotation .

databases and methods
databases
the test set includes  <dig>  sequences made available during the  <dig> cafa experiment .  <dig>  sequences of this set  could be mapped towards uniprotkb release 2010_ <dig> ; 96% of the cafa/uniprotkb set were manually curated  and  <dig>  proteins have also a pdb structure;  <dig>  of the set are proteins inferred from homology and predicted. we found that  <dig>  sequences of the cafa set  could be mapped into bar+ .

bar+
bar+, the bologna annotation resource, is our annotation system . bar+ allows transfer of validated annotation  <cit> . the method relies on the concept that sequences can inherit the same function/s and structure from their counterparts, provided that they fall into a cluster endowed with validated annotations. bar+ is based on a clustering procedure with the constraint that sequence identity  is ≥ 40% on at least 90% of the pairwise alignment overlapping . clusters in bar+, as previously reported  <cit> , allow three main categories of annotation: pdb  and go and/or pfam; pdb  without go and/or pfam; go and/or pfam without pdb  and no annotation. each category can further comprise clusters where go and pfam functional annotations are or are not statistically significant . depending on the categories of annotation in the cluster and provided that they are statistically validated, all new targets that fall into a cluster can inherit statistically validated annotations by transfer.

for generating bar+ clusters we analyzed a total of over  <dig> million protein sequences from  <dig> genomes and uniprotkb release 2010_ <dig>  the bar+ cluster building pipeline starts with an all-against-all sequence comparison with blast in a grid environment  <cit> . the alignment results are then regarded as an undirected graph where nodes are proteins and links are allowed only among chains that are 40% identical over at least 90% of the alignment length. all the connected nodes fall within the same cluster; when a cluster incorporates a uniprotkb entry, it inherits its annotations . within a cluster go and pfam terms are statistically validated by means of a procedure that includes p-value evaluation with a bonferroni correction and estimate of the significance threshold value after a bootstrapping procedure  <cit> ; validated terms are those endowed with p-values<  <dig>  <cit> . clusters can contain distantly related proteins that therefore can be annotated with high confidence and eventually can also inherit a structural template, if present. in bar+, when pdb templates are present within a cluster profile hmms  are computed on the basis of sequence-to-structure alignment and are cluster associated   <cit> .

RESULTS
bar+ contains clusters with statistically validated annotation
70% of the  <dig> , <dig> sequences of bar+ are collected in  <dig>  clusters . interestingly 87% of the clusters contain sequences whose standard deviation of the protein length is ≤  <dig> residues.  <dig> % of the clusters, containing 23% of the whole set, contains also pdb structures and is endowed with a cluster specific structural hmm  <cit> . 30% of the sequences are singletons that eventually can carry along structural and/or functional information.

a cluster collects specific pfam and go terms directly from the corresponding uniprotkb protein sequence files. validation of the terms within a cluster is based on a bonferroni corrected p-value analysis  <cit> . we performed a statistical evaluation of the p-values by computing the statistical significance of pfam and go terms associated to each cluster and by adopting a bootstrapping procedure. by this procedure we determine the threshold at which significance is different from random and we define a p-value equal to  <dig>  as the discriminative value for a single term to be validated or not . in figure  <dig> the number of clusters is reported as a function of the corresponding bonferroni corrected p-value for pfam and the go terms of the three main roots. the threshold level discriminates among clusters with statistically validated and not validated annotation. 11% of the clusters have one validated go term allowing in the present version of bar+ 45% of the total number of sequences  to be included in clusters endowed with validated terms.

within bar+, inheritance of validated annotation is possible only when a given sequence after alignment towards bar+ finds a counterpart whose sequence identity  is ≥ 40% over at least 90% of the pairwise alignment overlapping .

inheritance of statistically validated annotation
we aligned all the cafa target sequences against bar+clusters. more than 92% of the cafa set was retained by bar+ , including singletons . the statistically validated annotations transferred within bar+ clusters, including pfam terms and pdb templates  of the cafa/bar+ set are detailed in table  <dig>  the set of cafa sequences that received a statistically validated annotation  includes  <dig>  sequences . the list of predicted proteins is grouped by different target sets including sequences from eukaryotes, prokaryotes and "unknown" organisms. in table  <dig> annotations are sorted out by the three different types of go ontologies and pfam terms. values relative to sequences endowed with the union of different ontologies is also shown .

cov: coverage, the ratio of the length of the intersection of the aligned regions on the two sequences and the overall length of the alignment . for both cov values sequence identity  is ≥ 40%. mfo: molecular function ontology; bpo: biological process ontology; cco: cellular component ontology. all-o: number of sequences with predicted mfo or bpo orcco. pfam terms. all-o or pfam: the union of all-o and pfam. °pdb: sequences that inherit a structural template from a cluster hmm within bar+  <cit> . ^ cafa/bar+ set sequences from eukaryotes, prokaryotes, and unknown organisms. *sequences with a corresponding pdb structure.

for sake of exploring the relevance of the alignment length on the annotation system, we decreased the cov value to ≥ 70%) while keeping si≥ 40%. in this case the number of annotated cafa targets increased by only 3% , suggesting that the original 90% cov value together with si≥ 40% ensures that most of the cafa set is already retained within validated clusters.

with our method it is also possible to model distantly related targets that fall into a cluster by aligning them to the template/s in the cluster by means of a cluster hmm, as previously described  <cit> . by this about 25% of the cafa set inherits also a pdb structural template/s  and about 50% of these targets share a sequence identity with the template structure of the cluster lower than 30% . concomitantly the sequence also inherits validated pfam domains and go ontologies and this allows a validation of the functional annotation directly on the protein computed structure.

statistically validated go ontologies of the three main roots  are differently distributed among prokaryotic and eukaryotic sequences of the cafa/bar+ set . here for sake of simplicity we group all the predicted go ontologies under the first branches of each principal root. in "binding" main category "nucleotide binding"  and "protein binding"  are the most represented in prokaryotes and eukaryotes, respectively. in "catalyticactivity", "transferase activity"  and "hydrolase activity"  are the most represented in prokaryotes and eukaryotes, respectively. the most frequently predicted bpo main category is "cellular process", with "cellular biosynthetic process"  for prokaryotes and "cellular macromolecule metabolic process"  for eukaryotes. finally for cco, the most abundant term both in prokaryotes and eukaryotes is "intracellular" . the data confirm the variety of statistically validated functional annotations that can be retrieved by adopting bar+ as an annotation resource and also highlight the main functional features that characterize the proteins of the cafa set sorted out according to prokaryotes and eukaryotes.

in figure  <dig> the different validated and inherited pfam terms are grouped into clans, a collection of pfam similar entries  <cit>  and shown as a function of the number of sequences from eukaryotes and prokaryotes. the most populated clan is "p-loop containing nucleoside triphosphate hydrolase superfamily" . within the clan, the most frequent pfam domains are ras family  and abc transporter  in eukaryotes and prokaryotes, respectively.

comparison with direct uniprotkb annotation
 <dig>  sequences of cafa/uniprotkb set found a match in  <dig>  bar+ clusters where their annotation is validated  and for  <dig>  sequences the number of validated and annotated terms also increases . the remaining cafa/uniprotkb sequences  find a counterpart in bar+ clusters without a statistically validated annotation and are not considered in table  <dig>  furthermore, some 15% of the cafa set  does not have a counterpart in uniprokb and they can be aligned towards bar+ to receive annotation. out of these,  <dig>  sequences receive a statistically validated annotation .

*the cafa/uniprot kb set  comprises  <dig>  sequences,  <dig>  of which do not contain any go ontology and pfam terms. °here the cafa/uniprotkb subset that can be validated in bar+ is considered . the number of sequences and the number of pfam and go terms are listed. sequences that receive new validated terms are also listed according to pfam, mfo, bpo and cco. # sequences of the cafa set, out of a total of  <dig>  that are not present in uniprotkb and are annotated in bar+. +number of sequences that have and also receive in bar+ a pdb template.

 <dig>  clusters are also endowed with a cluster hmm, suitable for sequence alignment of the target with the corresponding template/s of  <dig>  sequences that by this can inherit also a structure . interestingly 50% of these sequences have a sequence identity to the corresponding template lower than 30%.

bar+ web site
for the present analysis, bar+ was updated by distinguishing two sets of clusters: those that are endowed with a statistically validated annotation , and those that are not statistically validated. a sequence can inherit annotation from a cluster in a statistically validated manner when upon alignment it falls into a statistically validated cluster; however at the web site for a sequence falling into bar+ clusters we also provide all the cluster-associated and not validated terms. this is so also when the target aligns towards bar+ singletons. each cluster endowed with pdb templates is also endowed with a cluster hmm based alignment that for each sequence falling in the cluster allows building of the corresponding three dimensional protein structure. bar+ is freely available at http://bar.biocomp.unibo.it/bar <dig> /.

CONCLUSIONS
functional annotation of protein sequences is one of the most important issues in annotation processes. when annotation is done electronically, mainly based on sequence similarity search, a robust validation process can help in the inheritance of pfam and go terms by transfer of annotation. using our cluster-centric bar+ annotation system and adopting as a test case the recently released cafa set of sequences, we can annotate  <dig> % of the cafa set,  <dig> % of which in a validated manner.

as compared with uniprotkb that annotates with go and pfam terms  <dig> % of the cafa set , we validate  <dig>  terms for  <dig> % of the sequences, we increase the annotation for  <dig> % of the set with some additional and validated  <dig>  terms and annotate without validation the remaining  <dig> % of the set.

considering also that  <dig> % of the cafa set is newly annotated with validation, the gain in annotation within bar+ is  <dig> % with respect to uniprotkb, suggesting again that cluster specificity for a sequence is a necessary filter to inherit functional and structural features from well known proteins.

furthermore we can endow with structural models some 25% of the whole cafa set. at least 50% of the proteins that in bar+ inherit a structural model share a sequence similarity with the template/s less than 30%, indicating that with our procedure also distantly related homologs can be safely annotated.

authors' contributions
dp carried out the computational analysis. dp, az and ir developed bar+ under the supervision of pf, pm and rc. gp developed the web site. dp, pf, pm and rc analyzed the data and wrote the manuscript. all the authors have read and approved the final manuscript.

competing interests
the authors declare that they have no competing interests.

