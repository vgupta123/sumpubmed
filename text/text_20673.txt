BACKGROUND
the development of microarray technologies has created unparalleled opportunities to study the mechanism of disease, monitor disease expression and evaluate effective therapies. because tens of thousands of genes are investigated simultaneously with a technology that has not yet been perfected, assessing uncertainty in the decision process relies on statistical modelling and theory. one key function of any statistical procedure is to control the rate of erroneous decisions or, in the microarray case, rate of false discovery of responsible genes.

the above concern can be illustrated as a multiple comparisons problem. suppose we are interested in testing g parameters  = μ. for each individual parameter μj, the null hypothesis is h0j : μj =  <dig> and the alternative hypothesis is h1j : μj ≠  <dig>  this μj can be thought as the difference in mean expressions of the jth gene under two different conditions in a microarray experiment. a conventional method to test each hypothesis is to take a sample and then calculate its p-value from a proper statistical test. if the calculated p-value is less than a threshold determined by a testing significance level, then h0j is rejected. however, when many hypotheses are simultaneously performed, a multiple comparisons procedure  has to be used to control the error rate  <cit> .

the traditional mcp controls the probability of making any error in multiple selections, i.e., controls the familywise error rate . it has been shown, however, that this type of procedure is extremely conservative when the number of hypotheses is large. alternatively, benjamini and hochberg  <cit>  proposed the measure of false discovery rate  for which the expected proportion of false discoveries is controlled. this procedure is based on the idea that one can tolerate more false discoveries if the number of tests is large. for example,  <dig> false discoveries out of  <dig> selections is probably too many while  <dig> false discoveries out of  <dig> selections should be acceptable. this is particularly useful in microarray analysis since a very large number of genes usually show differential expressions. therefore, controlling the fdr can greatly increase the power of discovery.

benjamini and hochberg  <cit>  proved that simes' procedure  <cit>  can be used to control expected fdr at α  when tests of true null hypotheses are either independent or positively dependent. more specifically, let p ≤ p ≤ ..., ≤ p be the ordered p-values and j +  <dig> be the smallest integer satisfying

p>×αg.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbacdawgaawcbagaeiikagiaemosaokaey4kasiaegymaejaeiykakcabeaakiabg6da+iabcicaoiabdqeakjabgucariabigdaxiabcmcapiabgena0oaalaaabaaccigae8xsdegabagaem4zacgaaiabc6cauiaaxmaacawljawaaewaaeaacqaixaqmaiaawicacaglpaaaaaa@425a@

if j ≥  <dig>  then rejecting h, j =  <dig> ..., j ensures the expected fdr at α. we call this method the bh procedure.

suppose the number of true nulls is g <dig>  or the proportion is π <dig> = g0/g. benjamini and hochberg  <cit>  proved that the expected fdr of bh procedure is less than or equal to g0g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabdegannaabaaaleaacqaiwaamaeqaaagcbagaem4zacgaaaaa@308e@α. when g <dig> is small compared to g, using the original α in  loses of power because it can be replaced by the larger value α/π <dig> and still control the fdp at α. here, the power of a selection procedure is defined as the proportion of the alternative hypotheses that are correctly identified. obviously, if we knew π <dig> in advance, we could replace α in  by α/π <dig> to increase power. since π <dig> is unknown, the key question here is how to estimate the number of true null hypotheses g <dig> 

in an earlier published paper, benjamini and hochberg  <cit>  proposed an adaptive procedure  which, by simulation, showed a higher power than bh procedure. the idea of the abh procedure is to estimate g <dig> based on the fact that the p-value under the alternative hypothesis is stochastically smaller than that under the null, which is uniformly distributed on . on a quantile plot of p-values  versus j), the slope passing through ) and  increases just as j increases if the ps are corresponding to the subset of true alternative hypotheses. the first time the slope decreases indicates a change point. using this stopping rule in conjunction with the lowest slope  estimator, )/, benjamini and hochberg proposed their abh method to estimate g <dig> as follows:

alg.  <dig> abh method in g <dig> estimation
 <dig>  if there is no hypothesis rejected by the bh procedure, then stop and declare no discovery.

 <dig>  calculate m = )/, ∀j =  <dig> ..., g.

 <dig>  let j* be the largest value such that m <m. define b as the smallest integer larger than 1/m.

 <dig>  the number of true null hypotheses is estimated as g^0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgnbwzgaqcamaabaaaleaacqaiwaamaeqaaaaa@2f2d@ = min.

recently, storey and tibshirani  <cit>  observed and demonstrated in their figure  <dig> that the density histogram of p-values based on p <dig> ..., pg from a microarray experiment looked flat in the region of . based on the fact that the null p-values of genes are uniformly distributed, most of genes in the region of  should be from the null. therefore, they used a smoothing method to estimate g <dig> based on the flat region of the observed p-values. however, the implicit requirements of their method are: 1) g should be large, and 2) the proportion of true null hypotheses should also be large, such as  <dig> , so that g <dig> can be estimated accurately. the method developed in this paper tries to bypass these two requirements so that a broad range of multiple testing problems can be applied. it is conceivable that when the number of relevant genes are known for certain target disease, a chip with a small number of genes will be widely used for diagnosis. the fdr methods, including both the bh and the abh versions, have now been widely accepted for microarray analyses. they have been implemented in the r program  <cit> , which can be incorporated into the bioconductor package  <cit> . several microarray analysis computer programs, such as sam   <cit>  and genespring  <cit>  also use the fdr criterion to identify differentially expressed genes. yang et al.  <cit>  have used the fdr criterion to determine the sample size in microarray experiments.

methods
without loss of generality, we describe the method in a one-sample testing problem. its extension to commonly used paired-t test, two-sample t test, or nonparametric rank tests in microarray analysis is very straightforward. let yi = ', i =  <dig> ..., n be g-variate vector samples from populations with means μ = '. define y = , ,j =  <dig> ..., g as a row vector for the jth component. the null hypothesis of the jth component is h0j : μj =  <dig> and the alternative hypothesis is h1j : μj ≠  <dig>  let the p-value for rejecting the null h0j be pj derived from a properly chosen test statistic.

once the p-values are derived, we first summarize the information content of p-values using a differentiable real-valued decreasing function h, i.e., h is decreasing to all its arguments. we call h the combining function and its value, η = h, the global statistic. next, define η to be the observed global statistic of η derived directly from the observed data. note that a small value of pj indicates h0j is less likely to be true. since h is a decreasing function of its argument pj, a large value of η indicates a subset of the null hypotheses is likely to be true alternatives. to determine whether η is large enough to make such a claim, we need to know the distribution of η when all the nulls are true. the distribution of η depends on the distribution of its arguments, the correlation between its arguments, and the combining function h. in a microarray experiment, there seems no way to model or estimate so many correlations . hence, a reasonable approach which can tackle the correlation within each experimental unit is to determine the critical value by a permutation test. more specifically, we calculate all b = 2n values of η based on , where ωi = ±  <dig> . hence, we have a set of reference values {η <dig> …,ηb}
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqgg7bweiigacqwf3oaadaqhaawcbagaegymaedabagaeiikagiaegimaajaeiykakcaaogaeiilawiaesojgskaeiilawiae83tdg2aa0baasqaaiabdkeacbqaaiabcicaoiabicdawiabcmcapaaakiabc2ha9baa@3d93@ from the b permutations, and can now define the p-value of the global η-statistic as

p=∑b=1bi≥η)b     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbacdaahaawcbeqaaiabcicaoiabicdawiabcmcapaaakiabg2da9maalaaabawaaabmaeaacqwgjbqsdaqadaqaaggaciab=d7aonaadaaaleaacqwgibgyaeaacqggoaakcqaiwaamcqggpaqkaagccqghljyscqwf3oaadaahaawcbeqaaiabcicaoiabicdawiabcmcapaaaaogaayjkaiaawmcaaawcbagaemoyaimaeyypa0jaegymaedabagaemoqaieaniabgghildaakeaacqwgcbgqaagaaczcaiaaxmaadaqadaqaaiabikdayagaayjkaiaawmcaaaaa@4be9@

where i is the indicator function that takes value  <dig> if the statement x is true and  <dig> if it is not. to determine whether the global null hypothesis of all μ, j =  <dig> ..., g, is zero is to evaluate if the global p-value, p, is less than or equal to a significance level. however, this level is part of the estimation process. it will be determined by the data .

when the global null hypothesis is rejected, it indicates that not all null hypotheses h0js are true. immediate question is, which subset of hypotheses is the true alternative. to determine whether to reject the hypothesis h is a multiple testing problem. we can, however, determine the size of true alternatives using the following iterated process. we regard the gene with the smallest p-value as the major contributor for the rejection and claim that the null hypothesis is not true with this gene. when this gene is removed from the data set, we continue the same process with the rest g -  <dig> genes and the p computed by  is now denoted by p. the whole process is then repeated to produce a sequence of pseudo-global p-values, p, s =  <dig> ..., g -  <dig>  we call the later step global p-value pseudo because it is only based on the subset of the original data. the detail of how to generate pseudo-global p-values is given in the algorithm section. first, we will use these pseudo-global p-values to estimate the number of true null genes g <dig> 

we observe that, intuitively, p ≤ p ≤ ... ≤ p, and this monotone increasing property will be proved in  of the justification section. in addition , we will prove in  of the justification section that if r pseudo-global p-values are less than a given value β, the estimator of the number of null genes is

g^0=g−r+β/2     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgnbwzgaqcamaabaaaleaacqaiwaamaeqaaogaeyypa0jaem4zacmaeyoei0iaemocainaey4kascccigae8nsdimaei4la8iaeiikagiaegymaejaeyoei0iae8nsdimaeiykakyaawbaasqabeaacqaiyagmaagccawljagaaczcamaabmaabagaeg4mamdacagloagaayzkaaaaaa@4173@

and this estimator ensures that e [g^0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgnbwzgaqcamaabaaaleaacqaiwaamaeqaaaaa@2f2d@] ≥ g <dig>   since the inequality e [g^0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgnbwzgaqcamaabaaaleaacqaiwaamaeqaaaaa@2f2d@] ≥ g <dig> holds for any value of β, the best choice of β is the one which makes g^0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgnbwzgaqcamaabaaaleaacqaiwaamaeqaaaaa@2f2d@ closest to g <dig>  by defining Δ = β/ <dig> and ρ = r - Δ, we observe that ρ is an increasing function and then a decreasing function of β for the following reasons. when β is small, Δ increases slowly. however, r is an increasing function in β and r is always greater than  <dig>  therefore, ρ is an increasing function for small value of β. on the other hand, when β →  <dig>  Δ reaches ∞. since r is finite, ρ becomes a decreasing function in this range. since  is equivalent to g^0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgnbwzgaqcamaabaaaleaacqaiwaamaeqaaaaa@2f2d@ = g - ρ, the optimal value of β should be determined as

β^=arg maxβρ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwfyogygaqcaiabg2da9maaxababagaeeyyaemaeeocainaee4zacmaeeiiaaiaeeyba0maeeyyaemaeeieaghaleaacqwfyogyaeqaaogae8xwdinaeiikagiae8nsdigcbagae4xkakcaaa@3f48@

and the method of estimating g <dig> is equivalent to finding the optimal β value.

the estimation of g <dig> can thus be summarized as

alg.  <dig> global-p method in g <dig> estimation
 <dig>  list rβ as the integer such that p ≤ β ∀ s =  <dig> ..., rβ, and p
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbacdaahaawcbeqaaiabcicaoiabdkhaynaabaaameaaiigacqwfyogyaeqaasgaeiykakcaaaaa@3341@ > β for a large number of βs for  <dig> <β <  <dig> 

 <dig>  find β such that ρ = rβ - β/ <dig> is maximized . let this β be β*.

 <dig>  let rβ* be the integer such that p ≤ β* ∀ s =  <dig> ..., rβ*, and p
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbacdaahaawcbeqaaiabcicaoiabdkhaynaabaaameaaiigacqwfyogycqggqagkaeqaasgaeiykakcaaaaa@341d@ > β*

 <dig>  let g^0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgnbwzgaqcamaabaaaleaacqaiwaamaeqaaaaa@2f2d@ = min.

we called this global-p method and denoted it by ℘
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqghyeywaaa@2e34@.

alg.  <dig> differentially expressed gene selection with given fdr
with g <dig> estimated, to control the fdr at α level for identifying differentially expressed genes in microarray data analysis with the conservative estimate g^0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgnbwzgaqcamaabaaaleaacqaiwaamaeqaaaaa@2f2d@, we simply test each sub-hypothesis based on  with the new α ≡ α/g^0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgnbwzgaqcamaabaaaleaacqaiwaamaeqaaaaa@2f2d@, i.e., rejects all h, j =  <dig> ..., j, if p ≤ j × αg^0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaggaciab=f7ahbqaaiqbdeganzaajawaasbaasqaaiabicdawaqabaaaaaaa@30e3@ and p >  × αg^0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaggaciab=f7ahbqaaiqbdeganzaajawaasbaasqaaiabicdawaqabaaaaaaa@30e3@. we also need to address the choices for the combining function h. in this paper, we consider only two commonly used ones. 1) fisher's sum of logarithm

η=h=−2∑j=1glog
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwf3oaacqgh9aqpcqwgobaadaqadaqaaiabdchawnaabaaaleaacqaixaqmaeqaaogaesojgskaeiilawiaemicaa3aasbaasqaaiabdeganbqabaaakiaawicacaglpaaacqgh9aqpcqghsislcqaiyagmdaaewbqaaiabbygasjabb+gavjabbegannaabmaabagaemicaa3aasbaasqaaiabdqgaqbqabaaakiaawicacaglpaaaasqaaiabdqgaqjabg2da9iabigdaxaqaaiabdeganbqdcqghris5aaaa@4c3d@

and 2) liptak's sum of inverse standard gaussian distribution functions

η=h=∑j=1gΦ− <dig> 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwf3oaacqgh9aqpcqwgobaadaqadaqaaiabdchawnaabaaaleaacqaixaqmaeqaaogaeiilawiaesojgskaeiilawiaemicaa3aasbaasqaaiabdeganbqabaaakiaawicacaglpaaacqgh9aqpdaaewbqaaiabfa6agnaacaaaleqabagaeyoei0iaegymaedaaowaaewaaeaacqaixaqmcqghsislcqwgwbacdawgaawcbagaemoaaogabeaaaogaayjkaiaawmcaaawcbagaemoaaomaeyypa0jaegymaedabagaem4zacganiabgghildgccqgguaglaaa@4d7e@

more discussion on the choices of combining functions can be found in birnbaum  <cit>  and folks  <cit> . the computer program for the proposed method, global-p, has been implemented in r script and is publicly available  <cit> .

RESULTS
simulation
two simulation studies were conducted. first, when the number of hypotheses are small and second, when the total number of hypotheses is extremely large. for small number of hypotheses, we used the following configurations: numbers of hypotheses are  <dig>   <dig>   <dig>  and  <dig> with sample size n =  <dig> and the proportions of g0/g being  <dig>   <dig> ,  <dig>  and  <dig> . the true expressions under the alternative hypotheses are assumed to be variance  <dig> gaussian random variables with non-zero mean values μj = dj. in one set of experiments, all djs are set as  <dig>  or  <dig> ; in the other set the djs are divided into  <dig> equal size blocks with values  <dig> ,  <dig> ,  <dig>  or  <dig>  in each block. the number of permutations is b =  <dig>  and the number of simulations is  <dig> . the fdr is set at α =  <dig> . four procedures are used for testing: bh, abh, our global-p test one with fisher's combining function, and one with liptak's combining function. for the purpose of comparison, we also plug in the true value of g <dig> into the abh method. this is the ideal situation to reach the highest power.

based on this simulation results, all the four methods have their expected fdr below the nominal fdr α =  <dig> . both combining functions in our proposed method have a higher power than the abh procedure in most situations, while there is little difference between them. the improvement over the abh methods is substantial when the proportion of the true null hypotheses is small.

since most microarray data consist of tens of thousands of genes simultaneously and many of their expressions are correlated, our second simulation tried to reflect these facts. storey and tibshirani  <cit>  proposed a "clumpy" dependence model in which genes are partitioned into blocks. the gene expressions are assumed independent between blocks but dependent within the same block. following the clumpy model,  <dig> test and  <dig> control samples were generated from normal random variables with mean  <dig> and standard deviation  <dig> where each sample contained  <dig>  genes. for test samples, genes with expression difference were added by  <dig> to represent the expression differences. the number of differentially expressed genes g <dig> were  <dig>   <dig> ,  <dig> ,  <dig>  which corresponded to the proportion of nulls π <dig> at  <dig> ,  <dig> ,  <dig> ,  <dig> . to simulate intra-block dependency, we generated one vector of normal random variables with mean  <dig> and standard deviation  <dig>  in each block of size  <dig> and add it to every gene in that block. this process creates correlations between genes. since the true expression differences for non-null genes are moderate large in this simulation, we expect that any good method should accurately estimate π <dig> 

in a recent article, broberg  <cit>  did a comparative review of various newly developed methods for estimating π <dig>  to make a comparison, we presented the means and standard errors of estimates of π <dig> for all the methods describe in broberg's paper in addition to our proposed method  over  <dig> simulations. the details of π0estimation methods  can be found in broberg's paper and the programs for these methods can be found in the add-on packages of the freely available r software  <cit> . the simulation results are shown in table  <dig> 

as expected, all of them performed very well for large π <dig>  if both the mean  and standard error  over the whole range of π <dig> are considered, lsl and global-p stand out and lsl is better in stability. however, as we will see from the next study, lsl seems to be over-conservative in real data analysis. the means of both combining functions of our proposed method performed well but liptak's function has a higher standard errors. therefore, fisher's function will be used for the real data analysis. during the simulation, we also noticed that current implementation of splosh, sep, mgf, and pre methods in r programs failed to work when the number of hypotheses was small.

real data analysis
we use a publically available experimental data set from the stanford microarray database  <cit>  first to compare the differences between bh, abh and our method with fisher's combining function. the purpose of this experiment was to identify genes that have different expressions between prostate tumor tissue and matched normal tissue. it consists of a total of  <dig> microarrays:  <dig> arrays were from primary prostate tumors and the other half were from matched normal prostate tissues. each array contains  <dig>  different human genes. we chose this data set because of the large number of replicates. with this amount of replicates, we had a better idea of the ground truth.

to compare performances of various methods, we split the whole data set into two groups: a test data set and a confirmation data set. eleven pairs of tumor and normal arrays were chosen for the test data set and the remaining arrays were used for the confirmation. the number of eleven test pairs were taken from a systematic sampling to avoid bias. patients  <dig>   <dig>   <dig> ...,  <dig> in the original order from the database were chosen as the test set. expression information is missing if it is labelled as failed, contaminated, or flagged. genes were removed from our study if more than half of their expressions were missing in the original data set. a total of  <dig>  genes was used to identify differences in expressions using bh, abh and our proposed procedures at  <dig>  expected fdr level. since the experiment was designed with paired tumor-normal arrays, the paired t-test was used to derive the p-value of each gene in the test data set. the bh procedure identified  <dig>  genes, the abh procedure identified  <dig>  genes, and our proposed method identified  <dig>  genes. our test is apparently more powerful if it can maintain the required fdr  <dig> . since we did not have the biological information, another approach was to estimate fdr based on our rejection set. specifically, suppose the rejection set contains the p-values that are less than ξ and the estimated proportion of null hypotheses is π^0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwfapacgaqcamaabaaaleaaiiaacqgfwaamaeqaaaaa@2f9a@. an intuitive estimate for fdr is  <cit> 

fdr^=π^0ξpr^,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqiaaqaaiabbaeagjabbseaejabbkfasbgaaypadagaeiikagcccigae8nvdgnaeiykakiaeyypa0zaasaaaeaacuwfapacgaqcamaabaaaleaacqaiwaamaeqaaogae8nvdghabawaaecaaeaatcvaufebsjuyzl2yd9gzlbvynv2caehbwvmckfmbhbaceigaa4huaiaa+jhaaiaawkwaaiabcufabjabdcfaqjabgsmijkab=57a4jabc2fadbaacqggsaalcawljagaaczcamaabmaabagaeginaqdacagloagaayzkaaaaaa@52c7@

where pr^=∑j=1gi/g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufebsjuyzl2yd9gzlbvynv2caerbwvmckfmbhbqedmvetj2bsbqee0evguee0jxyaibaieydoi=bh8vipeydi8qiw7rqqrffpeea0xe9lq=jc9vqaqpepm0xbbg8faspyrqj0=yi0lxdbba9pge9qqff0dxdhuk9fr=xfr=xfrpiwzqaaeaabigaaiaacaqabeaabeqacmaaaoqaamaahaaabaacbigaa8huaiaa=jhaaiaawkwaaiaacufacawgqbgaeyizimkccigae4nvdgnaaiyxaiabg2da9maaqadabagaamysaiaacicacawgwbwaasbaasqaaiaadmgaaeqaaaqaaiaadqgacqgh9aqpcaaixaaabagaam4zaaqdcqghris5aogaeyizimqae4nvdgnaaiykaiaac+cacawgnbaaaa@4850@. based on the confirm data set, our proposed method reported an estimator of π <dig>  π^0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwfapacgaqcamaabaaaleaaiiaacqgfwaamaeqaaaaa@2f9a@ =  <dig> . using equation , the estimated fdrs for bh, abh and our method were  <dig> ,  <dig> ,  <dig> , respectively.

if we further reject more sub-hypotheses beyond the number provided by our method, the fdr will exceed the assigned level. for example, if we reject the next  <dig> null sub-hypotheses that have the smallest p-values among those not previously rejected, the estimated fdr is  <dig>  which is larger than the pre-assigned  <dig>  level.

moreover, we calculated the standard difference  of expressions using the confirmation data set. the confirmation data set contains  <dig> pairs of arrays so that the statistic is a good estimate for the unknown standard difference. figure  <dig> shows histograms of absolute standard differences based on genes identified by the bh procedure, by the abh procedure, by our method, and the extra  <dig> genes beyond our method. from the histograms, several hundred differentially expressed genes that were not identified by bh or abh in the test arrays were identified by our method and most of them have standard expression differences greater than  <dig>  however, the next group of  <dig> genes beyond our method may contain too many false discoveries to make the fdr acceptable.

next, we use this data set to compare different estimates of proportion of null genes, π <dig>  the whole data set was partitioned into four sub-data sets. we labelled the arrays from  <dig> to  <dig> based on the original order in their database. sub-data set  <dig> contained  <dig> arrays with labels  <dig>   <dig>   <dig> ..., 41; sub-data set  <dig> contains  <dig> arrays with labels  <dig> ,..., 38; sub-data set  <dig> contains  <dig> arrays with labels  <dig> ,..., 39; sub-data set  <dig> contained the remaining arrays. although we did not know the true value of π <dig> in real data analysis, we used the four sub-data sets to compare the variation of different estimation methods. in addition, we used the whole data set to check if the estimates are reliable. for global-p method, we also plot the function of ρ in figure  <dig> using the whole data set. the maximum of ρ occurs at β =  <dig> .

the estimates π^0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwfapacgaqcamaabaaaleaaiiaacqgfwaamaeqaaaaa@2f9a@ were listed in table  <dig>  all π^0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwfapacgaqcamaabaaaleaaiiaacqgfwaamaeqaaaaa@2f9a@ estimates in the subsets were larger than the ones in the whole data set. this is expected because genes with small expressional differences are more likely to be classified as null genes in a small sample. from the π <dig> estimates from the whole data set, we may say the lsl gave a large π <dig> value, pre gave a small value and all the others gave similar estimates. we used lsl, pre and global-p to draw the p-value density histogram using the whole data set in figure  <dig>  the upper panel is the overall view and the lower panel is the closer view. the green dash-dot line is the height using lsl estimate; the red dash line pre estimate; the blue dot line global-p estimate. the lsl method, which is also shown in broberg's study, is too conservative producing the largest value. the pre method underestimated π <dig>  if we used π^0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwfapacgaqcamaabaaaleaaiiaacqgfwaamaeqaaaaa@2f9a@ by pre method to improve fdr procedure, it is likely to have a higher fdr than the nominal level. we think our π <dig> estimate is reliable because it is close but higher than the height of observed p-values in the region of  if we assume genes with expressional differences have rare chance to have large observed p-values.

CONCLUSIONS
benjamini and hochberg's fdr procedure  <cit>  opens an useful approach for multiple comparisons in microarray analysis. due to the complexity in microarray experiments, it seems unlikely that one method can dominate all the other methods in all the cases. in this paper, we have demonstrated a new method that is intuitive appearing because:

 <dig>  it uses permutation test which can take care the complex correlation structures in gene expressions.

 <dig>  its global test based on sequentially eliminated significant genes should provide a good stopping rule because all the remaining genes are always considered together.

with the support of simulation and real data studies, the new method should be a viable alternative to find the differentially expressed genes in microarray experiments.

algorithm
we illustrate the algorithm for calculating pseudo-global p-values based on marginal p-values, p <dig> ..., pg0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbacdawgaawcbagaem4zac2aasbaawqaaiabicdawaqabaaaleqaaaaa@30be@. please note that the procedure described here is the same regardless of g <dig>  we consider h in the summation form:

η=h=∑i=1g0ℏ,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwf3oaacqgh9aqpcqwgobaacqggoaakcqwgwbacdawgaawcbagaegymaedabeaakiabcycasiablaciljabcycasiabdchawnaabaaaleaacqwgnbwzdawgaaadbagaegimaadabeaaasqabagccqggpaqkcqgh9aqpdaaewbqaaiabl+qiobwcbagaemyaakmaeyypa0jaegymaedabagaem4zac2aasbaawqaaiabicdawaqabaaaniabgghildgccqggoaakcqwgwbacdawgaawcbagaemyaakgabeaakiabcmcapiabcycasiaaxmaacawljawaaewaaeaacqai1aqnaiaawicacaglpaaaaaa@4f8c@

where ħ is a differentiable decreasing function in which ℏ'=dℏdt|t=p
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0dxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwipecacqggnawjcqggoaakcqwgwbaccqggpaqkcqgh9aqpdawcaaqaaiabdsgakjabl+qiojabcicaoiabdsha0jabcmcapaqaaiabdsgakjabdsha0baadaabbaqaauaabeqaceaaaeaaaeaacqwg0badcqgh9aqpcqwgwbacaaaacaglhwoaaaa@40b7@ exists and ħ → ∞ as p →  <dig>  note that equation  totally meets the requirement that h should be a differentiable real-valued decreasing function. the realization of ħ can be, for instance, ħ = -2log if we use fisher's sum of logarithm or ħ = Φ- <dig>  if we use liptak's sum of inverse standard gaussian distribution function. recall that pj is the p-value obtained from jth row vector  and the ordered marginal p-values are p ≤ p≤ .... ≤ p
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbacdawgaawcbagaeiikagiaem4zac2aasbaawqaaiabicdawaqabawccqggpaqkaeqaaaaa@3270@. the p-values for individual genes are denoted by subscripts while the pseudo-global p-values in  in are denoted by superscripts. parentheses are used to reveal the order property.

in one-sample testing problem, we permute data b times, where each time we assign wi = ±  <dig> with equal probability to . for each permuted data, we use pb to be the p-value from the bth permuted data for the gene that produced p, j =  <dig> ..., g <dig>  b =  <dig> ..., b.

we summarize p and pb using the following table.

pp1…pb…pbpp1…pb…pb⋮⋮⋮⋮⋮⋮pp1…pb…pb     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqabeabgaaaaaqaaiabdchawnaabaaaleaacqggoaakcqaixaqmcqggpaqkaeqaaagcbagaemicaa3aasbaasqaaiabigdaxiabcicaoiabigdaxiabcmcapaqabaaakeaacqwimaysaeaacqwgwbacdawgaawcbagaemoyaimaeiikagiaegymaejaeiykakcabeaaaoqaaiablacilbqaaiabdchawnaabaaaleaacqwgcbgqcqggoaakcqaixaqmcqggpaqkaeqaaagcbagaemicaa3aasbaasqaaiabcicaoiabikdayiabcmcapaqabaaakeaacqwgwbacdawgaawcbagaegymaejaeiikagiaegomaijaeiykakcabeaaaoqaaiablacilbqaaiabdchawnaabaaaleaacqwgibgycqggoaakcqaiyagmcqggpaqkaeqaaagcbagaesojgseabagaemicaa3aasbaasqaaiabdkeacjabcicaoiabikdayiabcmcapaqabaaakeaacqwiulstaeaacqwiulstaeaacqwiulstaeaacqwiulstaeaacqwiulstaeaacqwiulstaeaacqwgwbacdawgaawcbagaeiikagiaem4zac2aasbaawqaaiabicdawaqabawccqggpaqkaeqaaagcbagaemicaa3aasbaasqaaiabigdaxiabcicaoiabdegannaabaaameaacqaiwaamaeqaasgaeiykakcabeaaaoqaaiablacilbqaaiabdchawnaabaaaleaacqwgibgycqggoaakcqwgnbwzdawgaaadbagaegimaadabeaaliabcmcapaqabaaakeaacqwimaysaeaacqwgwbacdawgaawcbagaemoqaikaeiikagiaem4zac2aasbaawqaaiabicdawaqabawccqggpaqkaeqaaaaakiaaxmaacawljawaaewaaeaacqai2agnaiaawicacaglpaaaaaa@8623@

note that the first column is p-values of genes from the original data while the remaining columns are from the permuted data.

to simplify the notation, let ħ) = ħ, ħ) = ħb and η is just the sum of ħ. therefore, we can transform the table  into the following table with the addition of the last row where its value η is the sum of the ħ in its corresponding column.

ℏℏ1…ℏb…ℏbℏℏ1…ℏb…ℏb⋮⋮⋮⋮⋮⋮ℏℏ1…ℏb…ℏb⇓⇓…⇓…⇓ηη1…ηb…ηb     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqabegbgaaaaaqaaiabl+qionaabaaaleaacqggoaakcqaixaqmcqggpaqkaeqaaagcbagaes4dhg2aasbaasqaaiabigdaxiabcicaoiabigdaxiabcmcapaqabaaakeaacqwimaysaeaacqwipecadawgaawcbagaemoyaimaeiikagiaegymaejaeiykakcabeaaaoqaaiablacilbqaaiabl+qionaabaaaleaacqwgcbgqcqggoaakcqaixaqmcqggpaqkaeqaaagcbagaes4dhg2aasbaasqaaiabcicaoiabikdayiabcmcapaqabaaakeaacqwipecadawgaawcbagaegymaejaeiikagiaegomaijaeiykakcabeaaaoqaaiablacilbqaaiabl+qionaabaaaleaacqwgibgycqggoaakcqaiyagmcqggpaqkaeqaaagcbagaesojgseabagaes4dhg2aasbaasqaaiabdkeacjabcicaoiabikdayiabcmcapaqabaaakeaacqwiulstaeaacqwiulstaeaacqwiulstaeaacqwiulstaeaacqwiulstaeaacqwiulstaeaacqwipecadawgaawcbagaeiikagiaem4zac2aasbaawqaaiabicdawaqabawccqggpaqkaeqaaagcbagaes4dhg2aasbaasqaaiabigdaxiabcicaoiabdegannaabaaameaacqaiwaamaeqaasgaeiykakcabeaaaoqaaiablacilbqaaiabl+qionaabaaaleaacqwgibgycqggoaakcqwgnbwzdawgaaadbagaegimaadabeaaliabcmcapaqabaaakeaacqwimaysaeaacqwipecadawgaawcbagaemoqaikaeiikagiaem4zac2aasbaawqaaiabicdawaqabawccqggpaqkaeqaaagcbagaey40h8nabagaey40h8nabagaesojgseabagaey40h8nabagaesojgseabagaey40h8nabaaccigae83tdg2aawbaasqabeaacqggoaakcqaiwaamcqggpaqkaaaakeaacqwf3oaadaqhaawcbagaegymaedabagaeiikagiaegimaajaeiykakcaaagcbagaesojgseabagae83tdg2aa0baasqaaiabdkgaibqaaiabcicaoiabicdawiabcmcapaaaaoqaaiablacilbqaaiab=d7aonaadaaaleaacqwgcbgqaeaacqggoaakcqaiwaamcqggpaqkaaaaaogaaczcaiaaxmaadaqadaqaaiabieda3agaayjkaiaawmcaaaaa@a685@

once η and η,..., η are available, the global p-value, by definition, is

p=∑b=1bi≥η)b.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbacdaahaawcbeqaaiabcicaoiabicdawiabcmcapaaakiabg2da9maalaaabawaaabmaeaacqwgjbqscqggoaakiigacqwf3oaadaqhaawcbagaemoyaigabagaeiikagiaegimaajaeiykakcaaaqaaiabdkgaijabg2da9iabigdaxaqaaiabdkeacbqdcqghris5aogaeyyzimrae83tdg2aawbaasqabeaacqggoaakcqaiwaamcqggpaqkaagccqggpaqkaeaacqwgcbgqaagaeiola4caaa@4922@

the same process is directly used to calculate the pseudo-global p-values after removing the genes which have the smallest p-values. actually, we can use the available data illustrated in table . by induction, suppose p,..., p have been removed, the ħ values of the raw data and their reference sets are

ℏℏ1…ℏb…ℏbℏℏ1…ℏb…ℏb⋮⋮⋮⋮⋮⋮ℏℏ1…ℏb…ℏb⇓⇓…⇓…⇓ηη1…ηb…ηb     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqabegbgaaaaaqaaiabl+qionaabaaaleaacqggoaakcqwgzbwccqghrawkcqaixaqmcqggpaqkaeqaaagcbagaes4dhg2aasbaasqaaiabigdaxiabcicaoiabdohazjabgucariabigdaxiabcmcapaqabaaakeaacqwimaysaeaacqwipecadawgaawcbagaemoyaimaeiikagiaem4camnaey4kasiaegymaejaeiykakcabeaaaoqaaiablacilbqaaiabl+qionaabaaaleaacqwgcbgqcqggoaakcqwgzbwccqghrawkcqaixaqmcqggpaqkaeqaaagcbagaes4dhg2aasbaasqaaiabcicaoiabdohazjabgucariabikdayiabcmcapaqabaaakeaacqwipecadawgaawcbagaegymaejaeiikagiaem4camnaey4kasiaegomaijaeiykakcabeaaaoqaaiablacilbqaaiabl+qionaabaaaleaacqwgibgycqggoaakcqwgzbwccqghrawkcqaiyagmcqggpaqkaeqaaagcbagaesojgseabagaes4dhg2aasbaasqaaiabdkeacjabcicaoiabdohazjabgucariabikdayiabcmcapaqabaaakeaacqwiulstaeaacqwiulstaeaacqwiulstaeaacqwiulstaeaacqwiulstaeaacqwiulstaeaacqwipecadawgaawcbagaeiikagiaem4zac2aasbaawqaaiabicdawaqabawccqggpaqkaeqaaagcbagaes4dhg2aasbaasqaaiabigdaxiabcicaoiabdegannaabaaameaacqaiwaamaeqaasgaeiykakcabeaaaoqaaiablacilbqaaiabl+qionaabaaaleaacqwgibgycqggoaakcqwgnbwzdawgaaadbagaegimaadabeaaliabcmcapaqabaaakeaacqwimaysaeaacqwipecadawgaawcbagaemoqaikaeiikagiaem4zac2aasbaawqaaiabicdawaqabawccqggpaqkaeqaaagcbagaey40h8nabagaey40h8nabagaesojgseabagaey40h8nabagaesojgseabagaey40h8nabaaccigae83tdg2aawbaasqabeaacqggoaakcqwgzbwccqggpaqkaaaakeaacqwf3oaadaqhaawcbagaegymaedabagaeiikagiaem4camnaeiykakcaaagcbagaesojgseabagae83tdg2aa0baasqaaiabdkgaibqaaiabcicaoiabdohazjabcmcapaaaaoqaaiablacilbqaaiab=d7aonaadaaaleaacqwgcbgqaeaacqggoaakcqwgzbwccqggpaqkaaaaaogaaczcaiaaxmaadaqadaqaaiabiida4agaayjkaiaawmcaaaaa@bb13@

and the pseudo-global p-value after removing the s genes is

p=∑b=1bi≥η)b.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbacdaahaawcbeqaaiabcicaoiabdohazjabcmcapaaakiabg2da9maalaaabawaaabmaeaacqwgjbqscqggoaakiigacqwf3oaadaqhaawcbagaemoyaigabagaeiikagiaem4camnaeiykakcaaaqaaiabdkgaijabg2da9iabigdaxaqaaiabdkeacbqdcqghris5aogaeyyzimrae83tdg2aawbaasqabeaacqggoaakcqwgzbwccqggpaqkaagccqggpaqkaeaacqwgcbgqaagaeiola4caaa@4aa5@

justification
our justification is based on extreme cases to make the proofs tractable. however, this requirement is not very critical. our simulation and real data analysis show that even with moderate g <dig> value, the pseudo-global p-value, p, starts to increase when our procedure has removed most of the significant genes. besides, it jumps up very fast to reach the point that p will be larger than threshold β and stop removing genes. let g be the total number of sub-hypotheses considered. given g, let d =  denote the vector containing the true values of μj, j =  <dig> ..., g for each sub-hypothesis; and r be the number of y removed using procedure ℘
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqghyeywaaa@2e34@. without loss of generality, we assume d ≤ ... ≤ d
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgkbazdawgaawcbagaeiikagiaem4zacmaeyoei0iaem4zac2aasbaawqaaiabicdawaqabawccqggpaqkaeqaaaaa@349c@ <  <dig> and d =  <dig> for j = g - g <dig> +  <dig> ..., g. we have

e℘≤g−g0+e℘,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgfbqrdawgaawcbagaeyighmmabeaakiabcufabjabdkfasjabcicaoiabdeganjabcycasgqadiab=rgakjabcmcapiabc2fadjabgsmijkabdeganjabgkhitiabdegannaabaaaleaacqaiwaamaeqaaogaey4kasiaemyrau0aasbaasqaaiabgiriddqabagccqggbbwwcqwgsbgucqggoaakcqwgnbwzdawgaawcbagaegimaadabeaakiabcycasgqabiab+bdawiabcmcapiabc2fadjabcycasiaaxmaacawljawaaewaaeaacqai5aqoaiaawicacaglpaaaaaa@50e8@

and the equality holds when d→−∞
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgkbazdawgaawcbagaeiikagiaem4zacmaeyoei0iaem4zac2aasbaawqaaiabicdawaqabawccqggpaqkaeqaaogaeyokh4qaeyoei0iaeyohiukaaa@38f1@. the equality affirms that the sub-sample y with extreme small dj <  <dig> is identified and removed from the component of η. actually, when the gene expression difference is far away from zero, it will be identified by any reasonable multiple testing procedure. hence, in this extreme case, we only focus on e℘
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgfbqrdawgaawcbagaeyighmmabeaakiabcufabjabdkfasjabcicaoiabdegannaabaaaleaacqaiwaamaeqaaogaeiilawccbegae8hmaadcbagae4xkakiaeiyxa0faaa@392b@ which is based on the remaining g <dig> samples that have null distributions. our goal is reduced to finding an upper bond of e℘
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgfbqrdawgaawcbagaeyighmmabeaakiabcufabjabdkfasjabcicaoiabdegannaabaaaleaacqaiwaamaeqaaogaeiilawccbegae8hmaadcbagae4xkakiaeiyxa0faaa@392b@, so that the expected value of g^0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgnbwzgaqcamaabaaaleaacqaiwaamaeqaaaaa@2f2d@ can be bounded  by g <dig> 

j. <dig> monotone in pseudo-global p-values
the key feature of our algorithm is that the pseudo-global p-values are monotone increasing. we can be more precise by showing that

pr→1 as sg0→ <dig>      
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaatcvaufebsjuyzl2yd9gzlbvynv2caehbwvmckfmbhbaceigaa8huaiaa=jhadawadaqaaiabdchawnaacaaaleqabagaeiikagiaem4camnaeiykakcaaogaeyizimqaemicaa3aawbaasqabeaacqggoaakcqwgzbwccqghrawkcqaixaqmcqggpaqkaagcdaabbaqaaiabdchawnaadaaaleaaaeaacqggoaakcqwgzbwccqggpaqkaaaakiaawea7aagaay5waiaaw2faaiabgkziukabigdaxiabbccagiabbggahjabbohazjabbccagmaalaaabagaem4camhabagaem4zac2aasbaasqaaiabicdawaqabaaaaogaeyokh4qaegimaajaeiola4iaaczcaiaaxmaadaqadaqaaiabigdaxiabicdawagaayjkaiaawmcaaaaa@61d2@

romano  <cit>  has proved that the distribution of ηb
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwf3oaadaqhaawcbagaemoyaigabagaeiikagiaem4camnaeiykakcaaaaa@32fa@ can be approximated by gaussian distribution using the central limit theorem. therefore, if we let the mean and standard deviation of reference samples ηb
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwf3oaadaqhaawcbagaemoyaigabagaeiikagiaem4camnaeiykakcaaaaa@32fa@  be μ and σ, respectively, and use z to denote the standard gaussian random variable with distribution function Φ, then the pseudo-global p-value p can be expressed as

p=∑b=1bi≥ηb=˙pr=pr,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakqaaeeqaaiabdchawnaacaaaleqabagaeiikagiaem4camnaeiykakcaaogaeyypa0zaasaaaeaadaaewaqaaiabdmeajjabcicaoggaciab=d7aonaadaaaleaacqwgibgyaeaacqggoaakcqwgzbwccqggpaqkaagccqghljyscqwf3oaadaahaawcbeqaaiabcicaoiabdohazjabcmcapaaaaeaacqwgibgycqgh9aqpcqaixaqmaeaacqwgcbgqa0gaeyyeiuoaaoqaaiabdkeacbaaaeaacugh9aqpgagaamxvp5wqsxmqhnxajn0bkvguhdwzzbqegyvzyrwyufgaiqgacagfqbgaa4ncamaadmaabagaa4nwaiaa+5dadawcaaqaaiab=d7aonaacaaaleqabagaeiikagiaem4camnaeiykakcaaogaeyoei0iae8hvd02aawbaasqabeaacqggoaakcqwgzbwccqggpaqkaaaakeaacqwfdpwcdaahaawcbeqaaiabcicaoiabdohazjabcmcapaaaaaaakiaawufacagldbaaaeaacqgh9aqpcagfqbgaa4ncamaadmaabagaa4nwaiaa+5dacagfdbwaawbaasqabeaacqggoaakcqwgzbwccqggpaqkaaaakiaawufacagldbaacqggsaalcawljagaaczcamaabmaabagaegymaejaegymaedacagloagaayzkaaaaaaa@79ef@

where c = Φ-1) is pth upper percentile of the standard gaussian distribution. hence, the relation between η and c is

η = μ + σ c .

similarly, for the μ and σ as the mean and standard deviation of reference samples ηb
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwf3oaadaqhaawcbagaemoyaigabagaeiikagiaem4camnaey4kasiaegymaejaeiykakcaaaaa@34cc@, we repeat the same approximation method to express p as

p     =∑b=1bi≥η)b=˙pr=pr=pr=pr=pr.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqaaeacdaaaaaqaaiabdchawnaacaaaleqabagaeiikagiaem4camnaey4kasiaegymaejaeiykakcaaagcbaaabagaaczcaiaaxmaadaqadaqaaiabigdaxiabikdayagaayjkaiaawmcaaaqaaiabg2da9aqaamaalaaabawaaabmaeaacqwgjbqscqggoaakiigacqwf3oaadaqhaawcbagaemoyaigabagaeiikagiaem4camnaey4kasiaegymaejaeiykakcaaaqaaiabdkgaijabg2da9iabigdaxaqaaiabdkeacbqdcqghris5aogaeyyzimrae83tdg2aawbaasqabeaacqggoaakcqwgzbwccqghrawkcqaixaqmcqggpaqkaagccqggpaqkaeaaiegacqgfcbgqaaaabaaabagafyypa0jbaiaaaeaacqgfqbaucqgfybgcdawadaqaaiab+pfaajab+5da+maalaaabagae83tdg2aawbaasqabeaacqggoaakcqwgzbwccqghrawkcqaixaqmcqggpaqkaagccqghsislcqwf8oqbdaahaawcbeqaaiabcicaoiabdohazjabgucariabigdaxiabcmcapaaaaoqaaiab=n8aznaacaaaleqabagaeiikagiaem4camnaey4kasiaegymaejaeiykakcaaaaaaogaay5waiaaw2faaaqaaaqaaiabg2da9aqaaiab+bfaqjab+jhaynaadmaabagae4nwaolae4npa4zaasaaaeaacqggoaakcqwf3oaadaahaawcbeqaaiabcicaoiabdohazjabgucariabigdaxiabcmcapaaakiabgucariabl+qionaabaaaleaacqggoaakcqwgzbwccqghrawkcqaixaqmcqggpaqkaeqaaogaeiykakiaeyoei0iaeiikagiae8hvd02aawbaasqabeaacqggoaakcqwgzbwccqghrawkcqaixaqmcqggpaqkaagccqghrawkcqwipecadawgaawcbagaeiikagiaem4camnaey4kasiaegymaejaeiykakcabeaakiabcmcapaqaaiab=n8aznaacaaaleqabagaeiikagiaem4camnaey4kasiaegymaejaeiykakcaaaaaaogaay5waiaaw2faaaqaaaqaaiabg2da9aqaaiab+bfaqjab+jhaynaadmaabagae4nwaolae4npa4zaasaaaeaacqwf3oaadaahaawcbeqaaiabcicaoiabdohazjabcmcapaaakiabgkhitiabcicaoiab=x7atnaacaaaleqabagaeiikagiaem4camnaey4kasiaegymaejaeiykakcaaogaey4kasiaes4dhg2aasbaasqaaiabcicaoiabdohazjabgucariabigdaxiabcmcapaqabagccqggpaqkaeaacqwfdpwcdaahaawcbeqaaiabcicaoiabdohazjabgucariabigdaxiabcmcapaaaaaaakiaawufacagldbaaaeaaaeaacqgh9aqpaeaacqgfqbaucqgfybgcdawadaqaaiab+pfaajab+5da+maalaaabagae8hvd02aawbaasqabeaacqggoaakcqwgzbwccqggpaqkaagccqghrawkcqwfdpwcdaahaawcbeqaaiabcicaoiabdohazjabcmcapaaakiabdoeadnaacaaaleqabagaeiikagiaem4camnaeiykakcaaogaeyoei0iaeiikagiae8hvd02aawbaasqabeaacqggoaakcqwgzbwccqghrawkcqaixaqmcqggpaqkaagccqghrawkcqwipecadawgaawcbagaeiikagiaem4camnaey4kasiaegymaejaeiykakcabeaakiabcmcapaqaaiab=n8aznaacaaaleqabagaeiikagiaem4camnaey4kasiaegymaejaeiykakcaaaaaaogaay5waiaaw2faaaqaaaqaaiabg2da9aqaaiab+bfaqjab+jhaynaadeaabagaemowaolaeyopa4zaasaaaeaacqwfdpwcdaahaawcbeqaaiabcicaoiabdohazjabcmcapaaaaoqaaiab=n8aznaacaaaleqabagaeiikagiaem4camnaey4kasiaegymaejaeiykakcaaaaakiabdoeadnaacaaaleqabagaeiikagiaem4camnaeiykakcaaogaey4kascacaglbbaaaeaaaeaaaegabaqeciaaxmaadawacaqaamaalaaabagae8hvd02aawbaasqabeaacqggoaakcqwgzbwccqggpaqkaagccqghsislcqwf8oqbdaahaawcbeqaaiabcicaoiabdohazjabgucariabigdaxiabcmcapaaakiabgkhitiabl+qionaabaaaleaacqggoaakcqwgzbwccqghrawkcqaixaqmcqggpaqkaeqaaagcbagae83wdm3aawbaasqabeaacqggoaakcqwgzbwccqghrawkcqaixaqmcqggpaqkaaaaaagccagldbaacqgguaglaeaacawljagaaczcamaabmaabagaegymaejaeg4mamdacagloagaayzkaaaaaaaa@2e2c@

comparing equations  and , we observe that to prove p ≤ p with probability  <dig> asymptotically when p is given is equivalent to prove that

σσc+μ−μ−ℏσ<c     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaggaciab=n8aznaacaaaleqabagaeiikagiaem4camnaeiykakcaaagcbagae83wdm3aawbaasqabeaacqggoaakcqwgzbwccqghrawkcqaixaqmcqggpaqkaaaaaogaem4qam0aawbaasqabeaacqggoaakcqwgzbwccqggpaqkaagccqghrawkdawcaaqaaiab=x7atnaacaaaleqabagaeiikagiaem4camnaeiykakcaaogaeyoei0iae8hvd02aawbaasqabeaacqggoaakcqwgzbwccqghrawkcqaixaqmcqggpaqkaagccqghsislcqwipecadawgaawcbagaeiikagiaem4camnaey4kasiaegymaejaeiykakcabeaaaoqaaiab=n8aznaacaaaleqabagaeiikagiaem4camnaey4kasiaegymaejaeiykakcaaaaakiabgyda8iabdoeadnaacaaaleqabagaeiikagiaem4camnaeiykakcaaogaaczcaiaaxmaadaqadaqaaiabigdaxiabisda0agaayjkaiaawmcaaaaa@6335@

with probability  <dig> asymptotically when c is given.

as g <dig> → ∞, the sample deviations σ and σ are almost identical so that σσ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaggaciab=n8aznaacaaaleqabagaeiikagiaem4camnaeiykakcaaagcbagae83wdm3aawbaasqabeaacqggoaakcqwgzbwccqghrawkcqaixaqmcqggpaqkaaaaaaaa@38bc@c → c. next, using table  again, we can express μ - μ as

∑b=1bℏ)b.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaamaaqadabagaes4dhgmaeiikagiaemicaa3aasbaasqaaiabdkgaijabcicaoiabdohazjabgucariabigdaxiabcmcapaqabagccqggpaqkasqaaiabdkgaijabg2da9iabigdaxaqaaiabdkeacbqdcqghris5aagcbagaemoqaieaaiabc6cauaaa@3fc3@

the distribution of the reference set p <dig> ..., pb converges to the uniform  distribution since the distribution of the permuted test statistics, which are corresponding to these p-values, converges to a normal distribution using theorem  <dig>  of romano's work. therefore, if we define uniform  random variable as u, ∑b=1bℏ)b
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaamaaqadabagaes4dhgmaeiikagiaemicaa3aasbaasqaaiabdkgaijabcicaoiabdohazjabgucariabigdaxiabcmcapaqabagccqggpaqkasqaaiabdkgaijabg2da9iabigdaxaqaaiabdkeacbqdcqghris5aagcbagaemoqaieaaaaa@3edf@ converges in probability to e by the law of large number. hence, to prove equation  we only need to prove that

pr] →  <dig>      

assume, without loss of generality, that p <dig> ..., pg0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbacdawgaawcbagaem4zac2aasbaawqaaiabicdawaqabaaaleqaaaaa@30be@ correspond to the true null. to prove equation , we first observe that, since p <dig> ... ,pg0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbacdawgaawcbagaem4zac2aasbaawqaaiabicdawaqabaaaleqaaaaa@30be@ are independent uniform random variables, p is the /g0-th quantile of the uniform  distribution. by defining ζs+ <dig> g0=/g0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwf2ogedawgaawcbagaem4camnaey4kasiaegymaejaeiilawiaem4zac2aasbaawqaaiabicdawaqabaaaleqaaogaeyypa0jaeiikagiaem4camnaey4kasiaegymaejaeiykakiaei4la8iaem4zac2aasbaasqaaiabicdawaqabaaaaa@3e94@ and using the distribution of sample quantile  <cit> , we have

g0−ςs+ <dig> g0)→n).
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagcaaqaaiabdegannaabaaaleaacqaiwaamaeqaaaqabagccqggoaakcqwgwbacdawgaawcbagaeiikagiaem4camnaey4kasiaegymaejaeiykakcabeaakiabgkhitggaciab=j8awnaabaaaleaacqwgzbwccqghrawkcqaixaqmcqggsaalcqwgnbwzdawgaaadbagaegimaadabeaaasqabagccqggpaqkcqghsgircqwgobgtcqggoaakcqaiwaamcqggsaalcqwfcpgvdawgaawcbagaem4camnaey4kasiaegymaejaeiilawiaem4zac2aasbaawqaaiabicdawaqabaaaleqaaogaeiikagiaegymaejaeyoei0iae8nwdy1aasbaasqaaiabdohazbqabagccqghrawkcqaixaqmcqggsaalcqwgnbwzdawgaawcbagaegimaadabeaakiabcmcapiabcmcapiabc6cauaaa@5cd3@

since the first derivative of ħ exists, we can use the delta method to have

g0)−ℏ)→n,
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagcaaqaaiabdegannaabaaaleaacqaiwaamaeqaaaqabagccqggoaakcqwipecacqggoaakcqwgwbacdawgaawcbagaeiikagiaem4camnaey4kasiaegymaejaeiykakcabeaakiabcmcapiabgkhitiabl+qiojabcicaoggaciab=j8awnaabaaaleaacqwgzbwccqghrawkcqaixaqmcqggsaalcqwgnbwzdawgaaadbagaegimaadabeaaasqabagccqggpaqkcqggpaqkcqghsgircqwgobgtcqggoaakcqaiwaamcqggsaalcqwfdpwccqggqagkdaahaawcbeqaaiabikdayaaakiabcmcapiabcycasaaa@51d3@

where σ*=ςs+ <dig> g02
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfdpwcdaahaawcbeqaaiabcqcaqaaakiabg2da9maakaaabagae8nwdy1aasbaasqaaiabdohazjabgucariabigdaxiabcycasiabdegannaabaaameaacqaiwaamaeqaaawcbeaakiabcicaoiabigdaxiabgkhitiab=j8awnaabaaaleaacqwgzbwccqghrawkcqaixaqmcqggsaalcqwgnbwzdawgaaadbagaegimaadabeaaasqabagccqggpaqkcqggbbwwcqwipecacqggnawjcqggoaakcqwfcpgvdawgaawcbagaem4camnaey4kasiaegymaejaeiilawiaem4zac2aasbaawqaaiabicdawaqabaaaleqaaogaeiykakiaeiyxa01aawbaasqabeaacqaiyagmaaaabeaaaaa@54da@ represents the asymptotical standard error of ħ).

finally, equation  can be proven as,

pr]=pr−ℏσ∗]=˙Φ]−ℏσ∗)
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakqgabeabawvaagwaaq4aaa5abawexlmbbxgbcf2cpn2qvrwzqf2zlnharygvljhzh5wyagabciaa=bfacawfybgaei4waslaes4dhgmaeiikagiaemicaa3aasbaasqaaiabcicaoiabdohazjabgucariabigdaxiabcmcapaqabagccqggpaqkcqgh8aapcqwgfbqrcqggbbwwcqwipecacqggoaakcqwgvbqvcqggpaqkcqggdbqxcqggdbqxaeaacawljagaeyypa0jaa8huaiaa=jhadawabaqaamaalaaabagaes4dhgmaeiikagiaemicaa3aasbaasqaaiabcicaoiabdohazjabgucariabigdaxiabcmcapaqabagccqggpaqkcqghsislcqwipecacqggoaakiigacqgfcpgvdawgaawcbagaem4camnaey4kasiaegymaejaeiilawiaem4zac2aasbaawqaaiabicdawaqabaaaleqaaogaeiykakcabagae43wdm3aawbaasqabeaaiiaacqqfxiikaaaaaagccaglbbaaaeaacawljagaaczcamaadiaabiqaaqmacawljagaeyipawzaasaaaeaacqwgfbqrcqggbbwwcqwipecacqggoaakcqwgvbqvcqggpaqkcqggdbqxcqghsislcqwipecacqggoaakcqgfcpgvdawgaawcbagaem4camnaey4kasiaegymaejaeiilawiaem4zac2aasbaawqaaiabicdawaqabaaaleqaaogaeiykakcabagae43wdm3aawbaasqabeaacqqfxiikaaaaaagccagldbaaaeaacawljagafyypa0jbaiaacqqhmogrdaqadaqaamaalaaabagaemyraukaei4waslaes4dhgmaeiikagiaemyvaulaeiykakiaeiyxa0laeyoei0iaes4dhgmaeiikagiae4nwdy1aasbaasqaaiabdohazjabgucariabigdaxiabcycasiabdegannaabaaameaacqaiwaamaeqaaawcbeaakiabcmcapaqaaiab+n8aznaacaaaleqabagae03fiocaaaaaaogaayjkaiaawmcaaaaaaa@a31e@

which converges to  <dig> because e is finite and ℏ→∞ as ςs+ <dig> g0=/g0→0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwipecacqggoaakiigacqwfcpgvdawgaawcbagaem4camnaey4kasiaegymaejaeiilawiaem4zac2aasbaawqaaiabicdawaqabaaaleqaaogaeiykakiaeyokh4qaeyohiuqaeeiiaaiaeeyyaemaee4camnaeeiiaaiae8nwdy1aasbaasqaaiabdohazjabgucariabigdaxiabcycasiabdegannaabaaameaacqaiwaamaeqaaawcbeaakiabg2da9iabcicaoiabdohazjabgucariabigdaxiabcmcapiabc+caviabdegannaabaaaleaacqaiwaamaeqaaogaeyokh4qaegimaadaaa@5452@.

j. <dig> determining the threshold β by 
first, we recall that, as p is the global p-value based on all null data, it is uniformly distributed. that is,

pr = β.

we have proved that the pseudo-global p-values, p, are monotone increasing when s/g <dig> →  <dig>  therefore, there exists m such that p ≤ p ≤ ... ≤ p. furthermore, for all s ≤ m,

pr ≤ β.

the purpose here is to derive equation  for any β within  using the above inequality. we start with the number of genes removed by our procedure. observe that

e℘=∑k=0g0−1kpr=∑k=1g0−1kpr.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakqgabeqaaavabagaemyrau0aasbaasqaaiabgiriddqabagccqggbbwwcqwgsbgucqggoaakcqwgnbwzdawgaawcbagaegimaadabeaakiabcycasgqabiab=bdawgqaaiab+lcapiab+1fadbqaaiaaxmaafaqaaewacaaabagaeyypa0dabiqaaazadaaewbqaaiabdugarhqaciab9bfaqjab9jhayjabcufabjabdkfasjabcicaoiabdegannaabaaaleaacqaiwaamaeqaaogaeiilawiae8hmaajaeiykakiaeyypa0jaem4aasmaeiyxa0faleaacqwgrbwacqgh9aqpcqaiwaamaeaacqwgnbwzdawgaaadbagaegimaadabeaaliabgkhitiabigdaxaqdcqghris5aagcbagaeyypa0dabiqaaqyadaaewbqaaiabdugarjab9bfaqjab9jhaybwcbagaem4aasmaeyypa0jaegymaedabagaem4zac2aasbaawqaaiabicdawaqabawccqghsislcqaixaqma0gaeyyeiuoakmaadeaabagaemicaa3aawbaasqabeaacqggoaakcqaiwaamcqggpaqkaagccqghkjyoiigacqafxoqycqggsaalcqwgwbacdaahaawcbeqaaiabcicaoiabigdaxiabcmcapaaakiabgsmijkab8j7aijabcycasiablaciljabcycasiabdchawnaacaaaleqabagaeiikagiaem4aasmaeyoei0iaegymaejaeiykakcaaogaeyizimqaewnsdimaewhlawcacaglbbaaaeaaaeaadawacaqaceaagfgaemicaa3aawbaasqabeaacqggoaakcqwgrbwacqggpaqkaagccqgh+agpcqafyogyaiaaw2faaiabc6cauaaaaaaa@8d66@

in addition,

pr=pr{∏s=1k−1pr}pr≤ββmin1=βkm
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakqgabeqaawvabawexlmbbxgbcf2cpn2qvrwzqf2zlnharygvljhzh5wyagabciaa=bfacawfybgaei4waslaemicaa3aawbaasqabeaacqggoaakcqaiwaamcqggpaqkaagccqghkjyoiigacqgfyogycqggsaalcqwgwbacdaahaawcbeqaaiabcicaoiabigdaxiabcmcapaaakiabgsmijkab+j7aijabcycasiablaciljabcycasiabdchawnaacaaaleqabagaeiikagiaem4aasmaeyoei0iaegymaejaeiykakcaaogaeyizimqae4nsdimaeiilawiaemicaa3aawbaasqabeaacqggoaakcqwgrbwacqggpaqkaagccqgh+agpcqgfyogycqggdbqxaeaacawljaqbaeaabugaaaaabagaeyypa0dabagaa8huaiaa=jhadawadaqaaiabdchawnaacaaaleqabagaeiikagiaegimaajaeiykakcaaogaeyizimqae4nsdigacaglbbgaayzxaaaabaaabawaaiwaaeaadaqewbqaaiaa=bfacawfybwaamwaaeaacawfwbwaawbaasqabeaacqggoaakcqwgzbwccqggpaqkaagccqghkjyocqgfyogydaabbaqaaiabdchawnaacaaaleqabagaeiikagiaemibawmaeiykakcaaogaeyizimqae4nsdimae4hlawiaemibawmaeyypa0jaegimaajaeiilawiaesojgskaeiilawiaem4camnaeyoei0iaegymaedacaglhwoaaiaawufacagldbaaasqaaiabdohazjabg2da9iabigdaxaqaaiabdugarjabgkhitiabigdaxaqdcqghpis1aagccagl7bgaayzfaaaabaaabagaa8huaiaa=jhadawadaqaaiabdchawnaacaaaleqabagaeiikagiaem4aasmaeiykakcaaogaeyopa4jae4nsdi2aaqqaaeaacqwgwbacdaahaawcbeqaaiabcicaoiabdmgapjabcmcapaaaaogaay5bsdgaeyizimqae4nsdimaeiilawiaemyaakmaeyypa0jaegimaajaeiilawiaesojgskaeiilawiaem4aasmaeyoei0iaegymaedacaglbbgaayzxaaaabagaeyizimkabagae4nsdimae4nsdi2aawbaasqabeaacqqgtbqbcqqgpbqacqqgubgbcqqgoaakcqwgrbwacqghsislcqaixaqmcqggsaalcqwgtbqbcqggpaqkaagccqaixaqmaeaacqgh9aqpaeaacqgfyogydaahaawcbeqaaiabdugarnaabaaameaacqwgtbqbaeqaaaaaaaaaaaa@ce42@

where km = min. hence, we can find an upper bound of the expected number of genes removed, e℘
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgfbqrdawgaawcbagaeyighmmabeaakiabcufabjabdkfasjabcicaoiabdegannaabaaaleaacqaiwaamaeqaaogaeiilawccbegae8hmaadcbagae4xkakiaeiyxa0faaa@392b@, which is

e℘≤∑k=1g0−1kβkm=β2−βm+2/+βm+1≈β2 as m is large.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakqgabegaaasaagwabagaemyrau0aasbaasqaaiabgiriddqabagccqggbbwwcqwgsbgucqggoaakcqwgnbwzdawgaawcbagaegimaadabeaakiabcycasgqabiab=bdawgqaaiab+lcapiab+1fadbqaaiaaxmaafaqaaeabdaaaaeaacqghkjyoaeaadaaewbqaaiabdugarhgaciab9j7ainaacaaaleqabagaem4aas2aasbaawqaaiabd2gatbqabaaaaawcbagaem4aasmaeyypa0jaegymaedabagaem4zac2aasbaawqaaiabicdawaqabawccqghsislcqaixaqma0gaeyyeiuoaaoqaaaqaaiabg2da9aqaamaalaaabagae0nsdigabagaeiikagiaegymaejaeyoei0iae0nsdimaeiykakyaawbaasqabeaacqaiyagmaaaaaogaeiikagiaegymaejaeyoei0iae0nsdi2aawbaasqabeaacqwgtbqbcqghrawkcqaixaqmaagccqggpaqkcqghsislcqggoaakcqwgtbqbcqghrawkcqaixaqmcqggpaqkcqqfyogydaahaawcbeqaaiabd2gatjabgucariabikdayaaakiabc+caviabcicaoiabigdaxiabgkhitiab9j7aijabcmcapaqaaaqaaaqaaiabgucariabcicaoiabdegannaabaaaleaacqaiwaamaeqaaogaeyoei0iaemyba0maeyoei0iaegomaijaeiykakiae0nsdi2aawbaasqabeaacqwgtbqbcqghrawkcqaixaqmaaaakeaaaeaacqghijyuaeaadawcaaqaaiab9j7aibqaaiabcicaoiabigdaxiabgkhitiab9j7aijabcmcapmaacaaaleqabagaegomaidaaaaakiabbccagiabbggahjabbohazjabbccagiabd2gatjabbccagiabbmgapjabbohazjabbccagiabbygasjabbggahjabbkhayjabbeganjabbwgaljabb6cauaqaaiaaxmaacawljawaaewaaeaacqqgxaqmcqqg2agnaiaawicacaglpaaaaaaaaaa@9cfc@

let Δ = Δ = β/ <dig>  from equations  and , we have

e℘≤g−g0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgfbqrdawgaawcbagaeyighmmabeaakiabcufabjabdkfasjabcicaoiabdeganjabcycasmxvp5wqsxmqhnxajn0bkvguhdwzzbqegyvzyrwyufgaiqwacawfkbgaeiykakiaeyoei0iaeyildqkaeiyxa0laeyizimqaem4zacmaeyoei0iaem4zac2aasbaasqaaiabicdawaqabaaaaa@4b44@

so that the number of true null estimate is

g^0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgnbwzgaqcamaabaaaleaacqaiwaamaeqaaaaa@2f2d@ = g - r + Δ

and this estimate ensures that

e℘≥g <dig> 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgfbqrdawgaawcbagaeyighmmabeaakiabcufabjqbdeganzaajawaasbaasqaaiabicdawaqabagccqggdbqxcqghljyscqwgnbwzdawgaawcbagaegimaadabeaakiabc6cauaaa@39ad@

figures and tables


