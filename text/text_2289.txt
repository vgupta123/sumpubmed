BACKGROUND
recent developments in high-throughput genomic technologies have revolutionized the approaches aimed at understanding biological systems and emphasized the need for computational and systems biology research. microarray analysis, for instance, can provide massive amounts of information about a biological sample by simultaneously measuring thousands of transcript levels. application of such methodologies has already yielded important molecular insight into cellular phenotypes under various experimental conditions  <cit>  and provided new knowledge about the development and treatment of human diseases, such as cancers  <cit> . during the last several years, microarray technology has undergone continued improvement with better quality control in the overall measurement process, ranging from hybridization conditions to image processing techniques  <cit> . nevertheless, to fully harness the power of the microarray technology to study biological materials such as cancer tissues, one has to deal with a source of measurement variability that comes from the biological materials themselves, which rarely consist of homogeneous cell populations. for example, except for a few types of immune-privileged tissues such as the brain, most solid tumor tissues contain infiltrating lymphocytes as a result of the immune response. most tumor tissues also contain endothelial cells as part of the necessary vasculature systems that provide nutrients for the tumor cells. the complexity of this problem is that different tumor tissues contain different proportions of these non-tumor cells. therefore, if tumor tissues are used without consideration of such a mixing phenomenon, measurement of differential gene expression will certainly be confounded by the heterogeneous cell populations. in some studies  <cit> , pathologists carefully evaluated the tissues and only selected tissues with more than a certain percentage of tumor cells. this prescreening step, however, results in the exclusion of many tumor tissues for the study and contributes to the small sample size problem in some of the studies. alternatively, laser capture microdissection  technology can be used to purify the tumor cells from mixed populations  <cit> . this approach has been very successful in dna-based studies because of the relatively high stability of dna. however, for microarray studies, which require less stable rna, lcm has seen limited success because it is much more challenging to maintain rna stability during the microdissection process. other drawbacks of lcm are that such procedures are time-consuming and yield insufficient quantities of rna, thus requiring multiple amplification steps that may confound quantitative inferences from gene expression data.

a recent paper by ghosh  <cit>  introduced a mixture model based framework for determining differential expression in the presence of mixed cell populations. in this study, we aim at reconstructing the actual expression values of the pure cell types from the heterogeneous mixtures. that is, we develop a computational method for removing the effect of mixing from heterogeneous samples and to microdissect microarray data in silico. similar analytical approaches have been previously proposed by lu et al.  <cit> , stuart et al.  <cit>  and venet et al.  <cit> . lu et al. focused on estimating the fraction of cells in different phases of the cell cycle whereas stuart et al. considered the problem of estimating the cell type specific expression patterns over all samples. here we focus on estimating both the sample and cell type specific expression values using carefully controlled microarray experiments. the inversion of the 'cell mixing effect' can be made appreciably easier by providing estimates of the mixing percentages of different cell types in each measurement, which can be measured by an experienced pathologist. the entire process does not hinge upon such measurements, however, as the mixing percentages can be estimated within the modeling framework. venet et al.  <cit>  introduced some preliminary methods and results for tackling the same problem as we consider here. in particular, they used a similar regression based framework as in  <cit>  and as we do. we also consider the problem of selecting the correct number of cell types using the cross-validation model selection framework.

RESULTS
the microarray data to which we apply our computational methods consists of five different heterogeneous mixtures of lymph node and colon cancer samples which are hereafter abbreviated as normal and rko, respectively. for more details, see materials and methods section. each heterogeneous mixture consists of different fractions of different cell samples, see table  <dig> 

inversion of sample heterogeneity
the first goal is to invert the mixing effect caused by sample heterogeneity. we apply the linear model developed in materials and methods section to the heterogeneous microarray data. the obtained results are presented below.

because of the inherent variability of individual gene expression values, the performance of the inversion method cannot be estimated based on results for individual genes.  thus, we examine the performance of our method globally, by comparing the measured and estimated expression values of all the genes simultaneously. for performance evaluation and visualization purposes, the dimensionality of the 4704-dimensional expression profiles is reduced using the standard principal component analysis . the effect of the sample heterogeneity is the same for all the genes within one array. therefore, for each array, it is useful to combine the results over all the genes. in other words, instead of looking at individual genes, we combine the expression values of all the genes and visualize the results using the most significant principal components. for comparison purposes, we also show the samples used as a reference in the conducted microarray experiments. since the number of measurements is far smaller than the number of genes, we use a standard approach when solving the pca eigenvector-eigenvalue problem. let  and , i =  <dig>  ..., k, denote the measured mixture and reference samples, respectively, and let  and  denote the estimated rko and normal expression profiles. let , where . instead of finding the eigenvalues of the original sample covariance matrix dtd, we compute them for the matrix ddt. the eigenvalues of dtd and ddt are the same and the eigenvectors of dtd can be obtained from the eigenvectors of ddt by multiplying them by dt. results of the inversion of the sample heterogeneity are shown in figures  <dig> and  <dig>  in figure  <dig>  all five heterogeneous samples are used to estimate the expression values of the pure colon cancer and lymphocyte samples. the two most significant pca components of all the heterogeneous samples, reference samples, and the estimated expression profile of the pure colon cancer cells and lymphocytes are shown. figure  <dig> clearly shows that the heterogeneous samples  are located almost on a straight line in the 2-dimensional pca space. furthermore, the line on which the heterogeneous samples are lying is parallel to the first principal component, suggesting that the most significant variation in the data is due to the linear mixing effect. the estimated expression profile of the pure colon cancer cells and lymphocytes are close to samples number # <dig> and # <dig>  respectively, indicating that the inversion of the mixing phenomenon produces reasonable results.

the results are more easily appreciated when only the most significant pca component is shown. as discussed above, the variation in the most significant pca component is due to the mixing effect. the results in figure  <dig>  are as in figure  <dig>  but now shown in 1-dimension in order to facilitate the interpretation. results in figure  <dig> , in turn, are as in figure  <dig>  except that the inversion was done using only the samples # <dig>  # <dig>  and # <dig>  this represents a more difficult and realistic case, since fewer mixtures are available.

when comparing figure  <dig>  with figure  <dig> , one can conclude that the method performs slightly better when more samples are used to estimate the true expression profiles – a result that was expected. overall performance, however, is good in both cases. the estimated expression values for the pure colon cancer  are close to the mixture # <dig>  as it should be since the mixture # <dig> corresponds to a measurement of the pure colon cancer. similarly, the estimated expression values of the pure lymphocytes are close to the mixture # <dig> as well as to all of the reference samples  are the same lymphocytes as the ones used in the mixtures). in figure  <dig> and  <dig> , the most significant pca component and the two most significant pca components explain about  <dig> % and  <dig> % of the total variation in the data, respectively. for the reduced data, for which the results are shown in figure  <dig> , a slightly smaller fraction of the variance is explained, namely about  <dig> % and  <dig> %. the results obviously depend on the optimality criterion for which we used the standard least squares. less outlier sensitive results can be obtained with robust regression methods, such as the huber estimator with the iteratively reweighted least squares implementation  <cit>  or median based regression methods  <cit> . the robust methods provided similar global results, but improved results for some individual genes that contained one or more outliers.

optimization of mixing percentages
in practice, the true mixing percentages are not known but must be measured by some means. therefore, they are also likely to contain some error. so, in addition to inverting the mixing effect, it is also useful to simultaneously estimate the most likely value of the mixing percentages. this problem can be formulated as type of optimization problem, the details of which are shown in the materials and methods section. the proposed optimization scheme was applied to the heterogeneous microarray data. since the heterogeneous samples # <dig> and # <dig> correspond to the cases where only colon cancer cells and lymph node cells are used, respectively, we may assume that α <dig> =  <dig> and α <dig> =  <dig>  thus, we only estimate the value of the three remaining mixing parameters. however, practically the same results are obtained when all the five mixing parameters are estimated. we found that the convergence of the above method is practically independent of the initialization in step  <dig>  the convergence of the optimization method is illustrated in figure  <dig> by showing the evolution of the value of the objective function. parameters in Â are initialized using the measured values shown in table  <dig> 

the found optimal values of the mixing percentages are shown in table  <dig>  the values of the estimated mixing parameters are in a good agreement with the results shown in figure  <dig>  that is, for instance, the heterogeneous sample # <dig> is quite close to the heterogeneous sample # <dig>  and the heterogeneous sample # <dig> is fairly far away from the heterogeneous sample # <dig> . note that estimation of the mixing parameters may also compensate for some other errors/biases in the data than just the mixing percentages.

the obtained expression estimates for the pure colon cancer and lymph node samples, when all five heterogeneous samples are used in estimation, are shown in figure  <dig>  again, the two most significant pca components of all the heterogeneous samples, reference samples, and the estimated expression profiles of the pure colon cancer cells and lymphocytes are shown. it is instructive to compare these results with the ones shown in figure  <dig>  because the heterogeneous samples are again located almost on a straight line, we use 1-dimensional visualization for the results. figure  <dig> shows the obtained expression estimates in 1-dimensional pca space.

again, the estimated expression values for the pure colon cancer cells  are close to those from mixture # <dig>  as it should be, since mixture # <dig> corresponds to a measurement of the pure colon cancer cells. similarly, the estimated values from the lymph node sample are close to those from mixture # <dig> as well as to all of the reference samples. in figures  <dig> and  <dig> , the first pca component and the first two pca components explain about  <dig> % and  <dig> % of the total variation in the data. for the reduced data, for which the results are shown in figure  <dig> , the fractions of variance explained are about  <dig> % and  <dig> %. although the fraction of variance explained is slightly smaller than without the optimization of the mixing parameters, the optimized mixing parameters provide a better fit to the data.

confidence intervals
above we were only interested in estimating the expression values of the pure cell types. often it is also useful to assess the confidence intervals of the obtained expression estimates. for that purpose, we consider two methods: one based on gaussian approximation and the other using bootstrap. 

for illustration purposes, figure  <dig> shows the 90% estimated confidence intervals for a set of genes by pooling each of them with the  <dig> closest genes. the horizontal and vertical axes correspond to the fraction of lymph node cells and the normalized expression value, respectively. in other words, the different heterogeneous mixtures are placed on the x-axis according to the corresponding mixing fractions. the vertical lines at x =  <dig> and x =  <dig> expand over the maximum of the two confidence intervals. in most of the cases the two confidence intervals are in good agreement. the confidence intervals can be tightened by measuring more heterogeneous mixtures.

the proposed inversion methods for the sample heterogeneity were also tested on standard non-replicated microarray data by treating the replicated measurements for each gene as individual "genes." the obtained results were qualitatively similar with the ones shown above and only slightly more variable. in a similar fashion, we examined the effect of low quality replicates on the heterogeneity inversion. slightly less variable results were obtained with a method  <cit>  that detects and removes unreliable replicates prior to the averaging. a drawback of such unreliable spot detection is that, without any missing value estimation method, some of the genes will be excluded from further analysis.

selection of the number of cell types
it is known that the heterogeneous mixtures used in our experiments consist of only two cell types. however, in general case, heterogeneous mixtures may contain an unknown number of cell types. in those cases, it is useful to assess the validity of the model  as well. as introduced in materials and methods section, the linear mixing model can be extended to incorporate more than just two cell types. we use a general purpose cross-validation for model selection. in particular, we apply the so-called leave-one-out cross-validation  and test the one, two, and three cell type models. 

for the three cell type model, the number of samples does not permit us to optimize the mixing percentages for each cross-validation training data set separately. therefore, within the cross-validation loop, we use fixed mixing percentages and only estimate the expression values. for the two and three cell type models we use the estimated mixing percentages shown in tables  <dig> and  <dig>  respectively. the relative loocv errors for the one, two, and three cell type models are  <dig> ,  <dig> , and  <dig> , respectively. the results suggest that the two cell type model is indeed the correct one.

discussion
this paper presents an inversion method for the effects of sample heterogeneity. the proposed method is successfully applied to a carefully controlled microarray data consisting of five different heterogeneous mixtures of lymph node and colon cancer samples. the results demonstrate that both the sample and cell type specific expression values can be reconstructed from heterogeneous mixtures. in some situations, such as cancer metastases in the lymph node, lymphocytes constitute a major cell type beside tumors. hence, with careful sample preparation, the two cell type model can directly be applied to such cases. for unknown heterogeneous mixtures obtained from more complex cancer samples, the analysis may be a bit more difficult. for example, contaminating cells may include several cell types, such as fibroblasts, endothelial cells, macrophages and lymphocytes. as the proposed method can be applied to any cell types and to any number of cell types, the method works in principle in more complex cases as well. requirement for the number of measurements necessary for reliable inversion, however, increases together with the number of cell types present in the sample.

we have emphasized that proper inversion of the mixing effect results in more accurate expression values of the pure cell types. while this is true, it must be noted that clinically relevant information may also be incorporated into other populations than the pure  cells. for example, the degree of lymphocyte infiltration may be clinically important and could be used to complement microarray analysis. however, for comparative microarray analysis, it is important to make comparisons between homogeneous samples so as to minimize the confounding influence of different proportions of contaminating cell types.

application of 'in silico microdissection' to detection of differentially expressed genes
in order to illustrate the above 'in silico microdissection' in practice, consider the following  experimental setting. given the three middle mixture measurements , a goal is to identify a set of genes which are differentially expressed between the colon cancer and the lymph node samples. in a simple approach, often used in practice, the most heterogeneous sample would be discarded since it is measured to contain about 56%  of colon cancer cells , thus giving no direct discriminative information about the underlying two samples. for illustration purposes, let us measure the expression difference of a given gene between these two samples using the fold-change, i.e., the expression value of the ith gene in the colon cancer sample, , is regarded as being differentially over-expressed  if the ratio of  to the expression value of the same gene in the lymph node sample, , is at least  <dig> . of course, in practice, more sophisticated methods for detecting differential expression, including correction for multiple testing, should be used. however, for illustrative purposes, this example will suffice. since only the heterogeneous samples are available, without any inversion of the mixing effect, one must compare the mixture measurement  and . figure  <dig> shows some example genes whose expression difference  between the two heterogeneous samples is within the given threshold , but after the 'in silico microdissection,' the expression difference exceeds even a more stringent criterion . the measured mixing percentages are used in the estimation . it is clear from this example that the proposed method is able to correctly detect differential expression even from heterogeneous samples, especially when the direct use of such samples may fail to find differential expression. indeed, the conclusions we can draw based on the red stars are consistent with those that are based on the true homogeneous samples represented by blue squares in figure  <dig> 

as is evident from the example above, heterogeneity in the biological sample preparation can hinder further statistical analysis steps. not only can the heterogeneity blur the identification of differentially expressed genes, it can also cause contrary effects. presence of a considerable percentage of additional cell types can result in the identification of differentially expressed genes that may be unrelated to the biological question being studied. similarly, irrelevant gene combinations can be discovered in the case of gene expression based classification. for an illustration, see  <cit>  where the authors analyzed a colon cancer data set contaminated with muscle cells.

although the microarray technology has been improved during the recent years, the measurements are still moderately noisy. the easiest and the most widely used approach for improving the measurement quality is to capture replicated measurements. this may become costly because each additional measurement requires an extra spot on the array, or an extra array. an alternative approach based on so-called composite microarrays was introduced in  <cit> , where several different oligos representing different genes are printed on each spot. the multiplexing results in a mixing effect similar to the one introduced in this manuscript, and the phenomenon can be inverted to get the reconstructed expression values for single genes. the benefit is to obtain more replicated measurements without proportionately increasing the number of printed spots. closely related ideas have also been introduced from an error-correcting microarray design point of view in  <cit> . the standard non-repeated microarray method does not tolerate "drop-outs": if a spot is badly corrupted and its intensity cannot be read, the expression value of the corresponding gene will be missed. khan et al. showed that a certain amount of "drop-outs" can be recovered from the multiplexed samples, thus providing more error-resilient measurements. following the methods developed in  <cit> , instead of multiplexing individual genes on spots, one may wish to multiplex different samples on arrays, thus allowing a fault-tolerant recovery of expression values in the case of corrupted array. as a future extension, one can also consider multiplexing both the genes on spots and the samples on arrays. similar methods for inverting the sample heterogeneity have also been studied in the context of time-series gene expression measurements in  <cit> , where the fundamental mixing effect is not due to the different tissue types present in the sample, but due to the loss of synchrony of the cell population. it would be worthwhile to simultaneously study the sample heterogeneity and the loss of synchrony in the future.

CONCLUSIONS
in this paper, we proposed a computational framework for removing the effects of sample heterogeneity. in addition to providing estimates of the expression values of the pure  cell samples, the proposed computational methods can also be used to estimate the mixing percentages of different cell types. furthermore, we also proposed a way of applying general-purpose model selection method for the selection of the correct number of cell types. application of the proposed methods to a carefully controlled cdna microarray data obtained from heterogeneous samples shows that the computational methods can invert the effect of sample heterogeneity and, at the same time, estimate the mixing percentages of the different cell types. furthermore, a general purpose model selection method can be used to select the correct number of cell types.

materials and methods
microarray production
rna isolation, microarray production, and microarray hybridization were carried out as described previously in  <cit> . rna from normal human lymph node was purchased from a commercial source . five μg aliquots of total rna from normal lymph node and rko colon cancer cell line were reverse transcribed using superscript ii rt  in conjunction with oligodt-t <dig> primers according to the manufacturer's suggested protocol. the second strand was synthesized using 10u e. coli dna ligase , 40u e. coli dna polymerase i , and 2u e. coli rnase h . this reaction was stopped with edta and then cleaned with qiagen's pcr purification kit . the double stranded cdna was then amplified by an in vitro transcription reaction  and cleaned with qiagen's rneasy kit . each amplified crna sample was then quantitated using a beckman du <dig> spectrophotometer . five μg amplified crna from stratagene's normal lymph node was labeled with cy <dig> for each microarray hybridization. mixtures of appropriate volumes of crna from normal lymph node and rko were labeled with cy <dig> in a reverse transcription reaction using superscript ii rt . labeled samples were co-hybridized overnight at 60°c in a humidified incubator on a cdna microarray containing  <dig> human genes in duplicate produced in-house. the  <dig> genes represent most of the known genes in the cdna library we used to generate the microarrays. for the purpose of this study, the identity of the genes is not very important since we only study the general effect of sample heterogeneity. as the mixing effect is the same for all the genes, we expect to have similar results when the whole genome arrays are used. slides were scanned with an ls-iv laser scanner . in total, five different heterogeneous mixtures were measured. the measured mixing percentages are shown in table  <dig> 

preprocessing
the microarray data consists of five different heterogeneous mixtures of lymph node and colon cancer samples which are hereafter abbreviated as normal and rko, respectively.  the gene expression data set was preprocessed as follows. the replicated background-subtracted signal intensities were averaged and log2-transformed, and the dye-bias effect was corrected in the log2-domain using the standard lowess smoothing-based normalization  with smoothing parameter f =  <dig> . because the averaging effect  takes place on the molecular level, the phenomenon must be modeled using the absolute expression values. therefore, after the correction of the dye-bias, the data were transformed back to the original domain using the inverse of the log2-transformation. correspondingly, single-channel data were used for further analysis. in order to mitigate the between array variability, the data were further standardized for each array and the two channels separately.

modeling sample heterogeneity
the two samples, rko colon cancer cells and normal lymphocytes, are mixed at the extracted rna level. therefore, without any further verification, the model can be assumed to be linear. lymphocytes were used because tumor tissues often contain infiltrating lymphocytes, especially in tumor metastases in the lymph nodes. let  and  denote the expression level of the ith gene in the colon cancer  and in the lymph node  samples, respectively. assuming only two different cell types are mixed, the sample heterogeneity is modeled by a simple linear model



where  denotes the expression value of the ith gene in the kth heterogeneous sample, and  <dig> ≤ αk ≤  <dig> denotes the fraction of the colon cancer cells in the kth mixture. it is worth noting that we use the same mathematical model for the sample heterogeneity as in  <cit> . also note that in equation  it is assumed that the expression level in rko () and normal () is "fixed" and does not change between heterogeneous measurements. in other words, the measurements  come from the same heterogeneous sample with different mixing fractions. in order to allow variation in the expression values between different samples/treatments/time points, the same model can be applied separately to each set of measurements from the other samples/treatments/time points. the same model can also be extended to more than two cell types .

inversion of sample heterogeneity
the first objective is to invert the mixing effect shown in equation , that is, to obtain estimates for the expression values of the pure colon cancer cells and the pure lymphocytes. in practice, however, the measured expression values, yi, include one or more sources of noise. by making some distributional assumptions, one could use standard model-based estimation methods. however, in order to avoid making additional modeling assumptions, we prefer to use a general purpose least squares method to estimate the gene expression levels corresponding to the pure samples.

let the number of genes be n and assume that one has measured the expression values for k different heterogeneous mixtures. thus, one has measurements ,  <dig> ≤ i ≤ n,  <dig> ≤ k ≤ k. let us also assume for now that the mixing percentages are known or have been measured. for the ith gene the sample heterogeneity can be expressed as 



when including all n genes, the above model can be rewritten as



where  <dig> denotes the k-by- <dig> zero matrix. let the block matrix in equation  above be denoted as Ã assuming the column rank of a is full, the well-known least squares solution is given by



where . due to the structure of the matrix Ã, the least squares solution can be obtained gene-wise as .

the gauss-markov theorem says that the standard least squares solution is indeed the best linear unbiased estimate if the noise in the measurements is additive and i.i.d. with constant variance. however, a common observation is that the homoscedasticity does not always hold for microarray data, but instead, the noise variance depends on the underlying signal intensity  <cit> . such heteroscedasticity may decrease the power of the inversion method shown in equation . fortunately, the structure of the matrix Ã ensures that the inversion can also be performed for each gene separately. consequently, it is not necessary for the homoscedasticity to hold globally. indeed, all we need to assume is that the noise variance is approximately constant for each gene separately.

also note that, in this two cell type model, no prior knowledge about the expression values of either of the two cell types is needed since the method estimates the expression values for both of the two cell types. the same is also true for more general models including more cell types, assuming the model is sufficiently over-determined .

optimization of mixing percentages
in practice, the mixing percentages must be measured by some means. therefore, they are also likely to contain some error. so, overall, one would like to estimate not only the expression values for the pure cell types but also the most likely value of the mixing percentages.

assuming the model in equation  is sufficiently over-determined, the mixing parameters can be adjusted computationally, too. let us again consider the case where only two different cell types are mixed. note that k denotes the number of different heterogeneous mixtures measured. therefore, the regression matrix Ã in equation  has only k free parameters. since the number of expression values to be estimated is 2n, the total number of free parameters in equation  is 2n + k. the number of equations in equation  is kn. hence, the model is over-determined if kn > 2n + k, which, for a fixed n ≥  <dig>  holds if k >  <dig>   as above, no assumptions on the noise distributions are being made and we use the least squares method. this results in the following optimization problem



a similar optimization problem was also introduced in  <cit> .

because the objective function in equation  above is minimized over both Ã and x, the objective function is not linear in the parameters anymore and, therefore, cannot be solved as in equation . in general, any iterative optimization method can be used to get a solution. iterative methods usually become inefficient/unstable as the number of parameters to be optimized increases. in this case, the number of free parameters in Ã and x is 2n + k. therefore, we use a two-step approach in the optimization. in the first step, given proper initial value for Ã, the least squares solution for x is found using equation . in the second step, the mixing percentages are optimized in the least squares sense  using the previously found value for x. these two steps are then repeated, essentially resulting in a type of expectation-maximization  approach. a similar iterative procedure was also proposed in  <cit> , except with different constraints. note that when equation  is minimized over Ã, given the value of x, the optimization problem is again linear in its parameters. assuming the constraints are not violated, the standard equation ) can be applied. if that is not the case, then any general-purpose constrained optimization method may be applied. let  ) denote the value of x  after the jth iteration. details of the algorithm are shown in figure  <dig>  clearly, at each iteration of steps  <dig> and  <dig>  the value of the objective function is decreased. thus, a minimum will be found.

confidence intervals
it is useful to assess the confidence intervals of the obtained expression estimates. as explained above, the gauss-markov theorem is applied gene-wise that greatly alleviates the issue of heteroscedasticity. should the noise variance σ <dig> be constant, then the variance of the estimated expression values would be . due to the special structure of the matrix Ã , the variance of the estimated expression values for the ith gene can be expressed as



where  is the noise variance for the ith gene. a straightforward way of obtaining an estimate of the variance is to compute the sample noise variance  for each gene and then apply equation  to get . that would result in somewhat sensitive variance estimates since there are only k =  <dig> error residuals associated with each gene. a better alternative is to pool genes which have approximately the same average expression value  and then compute the sample noise variance from the error residuals of the pooled genes. although we do not assume gaussian noise distribution, we can resort to the gaussian approximation when computing the confidence intervals. for example, using the gaussian approximation, the  <dig> - 2α confidence interval for estimated expression value of the ith gene in the colon cancer cells is , where Φ- <dig> is the inverse of the standard normal cumulative distribution function and  denotes the  element of the estimated variance matrix  . alternatively, the confidence intervals can be obtained using the non-parametric bootstrap framework  <cit> . here we consider the method in which one re-samples the error residuals with replacement  and computes the confidence intervals directly from the α and  <dig> - α percentiles of the bootstrap distribution of the expression estimates.

selection of the number of cell types
although it is known that only two cell types are mixed in our experiments there may be other experimental settings where the number of cell types may be unknown. then it is useful to assess the validity of the model as well. as was mentioned above, the linear mixing model can be extended to incorporate more than just two cell types using a straightforward extension: , where  denotes the expression value of the ith gene in the jth cell type, and  <dig> ≤  ≤  <dig> denotes the fraction of the jth cell type in the kth mixture. the mixing percentages must also satisfy  for all k. the significance of different 'regression coefficients'  could be tested using standard regression-based statistical tests. since those tests apply only to gaussian noise we recommend using a general purpose cross-validation for model selection . here we consider the leave-one-out cross-validation  and test the one, two, and three cell type models. thus, each heterogeneous sample is left out from the training data at a time, the regression coefficients are estimated based on the remaining four samples, and the model is then tested on the sample which was left out from the training data set.

authors' contributions
vd and wz conducted the experiments and hl, is, oy-h and wz developed the computational methods. hl, is and wz prepared the manuscript.

