BACKGROUND
micrornas  are small  non-coding rnas that have the ability to repress the expression of target genes post-transcriptionally. since the discovery of the first two mirna genes, lin- <dig>  <cit>  and let- <dig>  <cit> , much has been learned about the structure, biogenesis and function of mirnas  <cit> . a growing number of mirnas have been found in animals, plants and viruses  <cit> . the "mirbase" database  <cit>  currently hosts  <dig> mirnas from  <dig> species .

studies in plants  <cit> , animals  <cit> , and viruses  <cit>  have shown that the innovation of mirnas is an ongoing process  <cit> , which indicates that most mirnas are of different evolutionary origins. some mirnas, however, were also populated through local or genome-wide duplications  <cit> , and formed mirna families. as the phylogenetically related mirnas convey important information about the function and evolution of mirnas, a reliable classification of mirna families is indispensable for mirna studies.

some work has been done in classifying mirna families. the nomenclature system for mirnas by "mirbase"  <cit>  can be view as one of the earliest classifications. it classified mirnas with similar mature forms together and assigned them the same id numbers. in recent releases of mirbase, a "mirna family " feature was present, which clustered similar mirna precursors together based on computational analysis and manual inspection. in a recent report by hertel et al  <cit> , the phylogenetic distribution of mirnas in  <dig> species was systematically studied. in that study, potential mirnas in the species were identified with blast  <cit>  and profile based methods  <cit> . the phylogenetic analysis was based on pair-wise sequence identity between precursors, and the significance of the sequence identity cutoff was evaluated with a z-score.

these studies have revealed important phylogenetic information about mirnas. however, there are some underlying problems with the current methods. first, the mature forms of mirnas were often used as the classification criteria in the methods, intentionally or not. this can decrease the sensitivity of finding paralogous mirnas, as the mature part of a duplicated copy of a mirna is not necessarily under strong selective pressure. meanwhile, due to the short length of the mature forms, false classification caused by convergent evolution is very likely to happen. second, since a fixed sequence identity cutoff value alone is inadequate to classify the mirnas , most of the current methods relied on manual inspection in deciding the families. this introduces a heavy human factor in the classification process. third, most of the current methods do not have a measurement of the reliability of the classification results. the z-score used by hertel et al  <cit>  was no exception, because the z-score was actually a measurement of the significance of a fixed sequence identity cutoff value .

in this study, we designed a bootstrap based analysis pipeline  pipeline) to identify phylogenetically related mirnas. in our method, the families are identified based on branch stability in the bootstrap trees derived from overlapping input sets of genome-wide mirna precursor sequences. this approach is similar to the "nodal stability" approach  <cit>  that has been used in phylogenetic tree inference. the difference is that we vary the input data set rather than multiple sequence alignment parameters. a "vote" algorithm was designed to automate the process of identifying and evaluating potential families. the human involvement in the classification process was minimized, and the reliability of each family was evaluated by its supporting levels from the bootstrap trees. we tested the pbc analysis pipeline with the mirnas from the six animal species, h. sapiens, m. musculus, g. gallus, d. rerio, d. melanogaster, and c. elegans. the resulting classification was compared with the mirna families defined by mirbase. while the classifications were largely consistent, our reliability measurement showed that a few new families can be supported and several families in mirbase may not be supported. the pbc analysis pipeline offers an efficient and objective method for classifying large amount of mirnas.

RESULTS
algorithm
the phylogeny-bootstrap-clustering  analysis pipeline
this method is base on the branch stability in the bootstrap trees derived from overlapping input sets of genome-wide mirna precursor sequences. for a set of mirna sequences, we can always perform a multiple sequence alignment  and build a bootstrap tree from the alignment result. due to the imperfection of msa, it is almost certain that some false classifications will happen. however, the true classifications are generally more robust to variations in input sequences or alignment parameters of msa than the false classifications  <cit> . based on this principle, we can add additional sequences to the original input sequence set of the msa, and generate a new bootstrap tree. the true families should be more stable and are more likely to be intact under a branch of high bootstrap value in the new tree, while the falsely classified families are more likely to be broken up in the new tree. if multiple new trees are built with different additional sequences, the likelihood for a falsely classified family to be intact in all the new trees decreases geometrically. in practice, for efficient classification of large amount of mirnas, the original input sequences and the additional input sequences can be genome-wide collections of mirnas.

suppose we have n species whose mirna information is available. let si denote the set of mirna precursor sequences in species i, and let si+sj denote the union of si and sj. in the pbc analysis pipeline, we use the sequence sets  as the input, where s <dig> is the original input sequence set and s <dig>  ..., sn are different additional sequences. msa, neighbor-joining  tree building and bootstrapping are carried out for each input sequence set, and n corresponding bootstrap trees are built  . in these input sets, the s <dig> set of sequences appear in all the input sequence sets. the addition of other sequence sets  to s <dig> introduces variations to the input of msa. from the bootstrap trees , we identify the branches with bootstrap values above the family defining cutoff values and denote such branching nodes as the "family defining nodes." if all the s <dig> leaves under such a branch are also clustered together under a "family defining node" in all the other trees, these leaves form a consensus family. the detailed procedure of this step is capsulated in the "vote" algorithm described in the next section. a consensus family may contain sequences from several species, but only the classification of the s <dig> sequences is confirmed in this step. the reliability of the classification of a group of s <dig> sequences in a family can be measured as the average of the bootstrap values of their best common ancestors in the n input trees.

once the s <dig> sequences are classified, for an individual sequence x from , we can carry out another pbc analysis with the input sequence sets as  to classify x with its phylogenetically related mirnas in s <dig>  however, for genome-wide sets of sequences, this is computationally prohibitive . instead of confirming individual sequence, in practice, we formulate a confirmation set of sequences c which is composed of the sequences from  whose phylogenetic relationship with mirnas in s <dig> is of interest. we also remove the most obviously s1-specific mirnas from s <dig> according to the result of the first round, these include the mirnas in singleton families in the first round and the mirnas in tandem clusters. a new round of pbc analysis is then carried out using the input set of  . those sequences in the confirmation set c whose classifications are confirmed in the new round are patched back to the consensus families . the resulting consensus families form a classification of mirnas that are phylogenetically related to s <dig> mirnas. in other words, s <dig> mirnas are the index for this classification. phylogenetic relations among s <dig>  ..., sn sequences that are not related to any s <dig> sequences are not covered in this classification, but such relations can be examined in the same way by using a different set of sequences as index.

the "vote" algorithm
the "vote" algorithm is the kernel of the pbc analysis pipeline. the input for the "vote" algorithm includes the set of bootstrap trees , the "family defining bootstrap cutoff values" which are derived from well studied known families and are tree specific, and a "evaluation bootstrap cutoff value" which is used to evaluate families defined in other trees. usually, the "family defining cutoff values" are set to be greater than the "evaluation cutoff value".

the "vote" algorithm  is designed to identify families from the bootstrap trees and get measurements of reliability of the identified families. suppose the s <dig> sequences form the index, as is in the case of the first round of pbc. first, for each tree and from root down, the branches with bootstrap value above  the family defining cutoff values are sought. the search will not go inside a branch if the top node of the branch already has a bootstrap value above the cutoff. the top nodes of these branches are the "family defining nodes." for each identified branch, the s <dig> leaves in the branch form a testing set. second, for each testing set, we can obtain the bootstrap values of their best common ancestor  in the input trees. the bca of a set of nodes in a bootstrap tree is defined to be the common ancestor with the highest bootstrap value among all the common ancestors of the set of nodes ). third, the reliability of a testing set is evaluated by its bca bootstrap values in the input trees. if the bca bootstrap value is above the evaluation cutoff value in a tree, the testing set is regarded as supported by that tree. if a testing set is supported by enough input trees, it is deemed as confirmed . in practice, we request a testing set to be supported by n- <dig> trees, allowing one exception. if a testing set is not confirmed, it is progressively broken down until all its subsets are confirmed. finally, all the confirmed sets are clustered into consensus families using a single linkage clustering approach  <cit> .

testing
classification of mirnas from six animal species using the pbc analysis pipeline

the input for the testing case were the mirnas from six animal species, h. sapiens, m. musculus, g. gallus, d. rerio, d. melanogaster, and c. elegans. these mirnas cover most of the experimentally identified mirnas. s <dig> was set to be the human mirnas and s <dig>  ..., s <dig> were the mirnas from the other five species. msa was carried out with clustalw  <dig>   <cit> . neighbor-joining trees building and bootstrapping were carried out with mega  <dig>   <cit>  using  <dig> bootstrap replications and p-distance substitution model. the family defining bootstrap cutoff values are tree-specific, and are set to be the smallest bootstrap value of the reference mirna families  in each input tree. these reference families are well established in the literature. the actual cutoff values were 84% for the "hsa" tree, 90% for the "hsa-mmu" tree, 91% for the "hsa-gga" tree, 78% for the "hsa-dre" tree, 75% for the "hsa-dme" tree and 82% for the "hsa-cel" tree. the evaluation cutoff value is set to be 50%.

after the first round of the pbc analysis, we examined the composition of the consensus families. for human mirnas with same id numbers, only  <dig> are separated in the consensus families, namely mir-92/mir-92b and mir-449/mir-449b, showing that most of the mirna families are robust to the variation in the input of the pbc pipeline. we further examined the alignments for mir-92/92b and mir-449/449b. in both cases, the mature sequences had high sequence identities while the hairpin sequences had low identities outside the mature parts. the mirnas in these cases are separated into different families, as they may be the results of convergent evolution.

the confirmation set of sequences were deduced from the consensus families of the first round of pbc. the confirmation set includes the mirnas from the other species that were not classified with their human counterparts . there were  <dig> from mouse,  <dig> from chicken,  <dig> from fish,  <dig> from fly, and  <dig> from worm . the confirmation set also includes the non-human mirnas that were classified in a family with none of its human counterparts. there were  <dig> from mouse,  <dig> from chicken,  <dig> from fish ,  <dig> from fly, and  <dig> from worm. a second round of pbc analysis was carried out.  <dig> of the mirnas in the confirmation set were confirmed and were patched back to the consensus families and the unconfirmed mirnas were kept out of the families. the resulting consensus families formed the classification of phylogenetically related mirnas with the human mirnas as the index. the full list can be found in additional file 4: full list of the families with human member. the supporting levels of the human mirnas in each family can be found in additional file 5: supporting levels of the families.

the phylogenetic distribution of mirnas
based on the family composition, we categorized the mirna families in the testing case into categories i-iv. category i contains mirna families that have mirnas from both mammals and invertebrates. in addition, we demand that all the category i families should have chicken or fish mirnas. category ii contains mirna families that have mirnas from both mammals and non-mammal vertebrates. category iii contains mirna families that have mirnas from mammals only. category iv contains the mirna families that have no mammal mirnas. the distribution is summarized in table  <dig>  an abbreviated list of the human mirnas of the families is shown in table  <dig>  it should be noted that worm or fly mirnas are present in eight families in category iii. these families were put in category iii because there were no chicken or fish mirnas in these families. these cases are likely to be the result of convergent evolution or incomplete mirna discovery in chicken and fish. most of the human mirnas in these eight families are from a recent publication  <cit> .

although the discovery of mirnas is not comprehensive in species like chicken and fish, the phylogenetic distribution of the mirna families still shows interesting trends. the majority of the human mirnas are conserved only in vertebrates. among the human mirnas,  <dig> are in category i,  <dig> are in category ii, and  <dig> are in category iii. this shows that more than half of the human mirnas are conserved in mammals only, and the majority of the rest are vertebrate only. only a small portion of human mirnas have invertebrate homologues. mouse mirnas display a similar distribution. for the invertebrate mirnas, the portion of mirnas that are conserved in vertebrates is also very small, 22/ <dig> in d. melanogaster and 6/ <dig> in c. elegans. only a small number of mirnas, the  <dig> mirna families in category i, are conserved between invertebrates and mammals. however, more than half of all the mirnas with known function are in these families. this shows a high correlation of sequence conservation and functional importance among the mirnas. the discovery of mirnas is still ongoing, so more data and analysis will be needed to generate a quantitatively more detailed phylogenetic distribution of mirnas.

comparison with the mifam classification
since release  <dig> , a mifam  feature which provides family classification information of mirna hairpin sequences has been available in mirbase. we compared our classification results with the mifam classification in release  <dig> . not considering the families with one or less human mirna or the families without non-human mirnas, our comparison showed that  <dig> out of the  <dig> comparable pbc families are the same in mifam. while most of the mirna families are consistent, we examined the cases where the classification was different . most of these differences involve additional merging or separation of the families between the two classifications. for the families that are merged in the pbc classification, the multiple sequence alignments of the hairpin sequences are generally acceptable, but the alignments of the mature sequence are not necessarily strong. one example is the mir-134/mir- <dig> case , in which the hairpin sequences are similar while the mature sequences differ greatly. the situation is reversed in the families that are merged in the mifam classification. one example is the mir- <dig>  92/mir-92b case, in which the mature sequences are almost identical while the rest of the sequences share little sequence similarity . in only three cases, the families defined by pbc intersect with  the families defined by mifam, but all these mirnas are tandem clustered mirnas which diverge from each other much more than most mirna homologues.

taken together, the comparison between the pbc and the mifam classifications showed that most of the families were consistent. most of the differences stemmed likely from the differences in treating information from the mature sequences. while the pbc analysis pipeline relies totally on the precursor sequences, the mifam classification may have taken certain reference from the similarity between the mature sequences.

classification of new mirnas
while preparing the manuscript, a new release of mirbase sequences  became available. we used our pbc analysis pipeline to classify the  <dig> new human mirnas in this release by treating them as the confirmation set. the results showed that hsa-mir- <dig> can be assigned to the hsa-mir- <dig> ,  <dig> family; hsa-mir- <dig> can be assigned to the hsa-mir- <dig> family; and hsa-mir- <dig> can be assigned to the hsa-mir- <dig> family. the sequence alignments and the support levels among the trees can be found in additional file 7: classification of new human mirnas in release  <dig> . the hsa-mir- <dig> case is present in mifam already, while the other two cases have not been reported.

discussion
from an evolutionary point of view, mirnas are a heterogeneous group of sequences. first, mirnas are of heterogeneous evolutionary origins. most of the mirnas are not related to each other. they are categorized together as mirnas just because they share certain common sequence features and functional mechanisms  <cit> . as is shown in the phylogenetic distribution of mirna families in this study, mirnas also differ greatly as to their levels of conservation across the species. second, mirnas differ in their evolutionary patterns. some, the let- <dig> family for example, maintain almost identical mature forms in evolution. others, the mir- <dig>   <dig>   <dig>   <dig> family for example, diverge in the mature forms .

the evolutionary distance between mirnas is the underlying basis for the classification of mirnas. the heterogeneous nature of mirna sequences has made it impossible to use a single model to summarize the evolutionary distance between mirnas. in context, many current methods actually manually inspect the classification process, which brings in a heavy human factor.

in the pbc analysis pipeline, we used a non-parametric approach. the analysis depended totally on the precursor sequences, and no model of the evolutionary distances between mirnas was assumed a priori. the classification criteria were essentially derived from the data or were based on knowledge from the literature . the human factor was minimized in the classification process. meanwhile, the reliability of the families can be evaluated by their support levels in the bootstrap trees.

CONCLUSIONS
the pbc analysis pipeline is an efficient method for classifying large numbers of heterogeneous mirna sequences. the analysis pipeline assumes no models for the evolutionary distances between mirnas. it requires minimum human involvement and provides a method to evaluate the reliability of the classification results. this analysis pipeline is efficient for classifying genome-wide sets of mirna sequences. it is also an efficient method to classify newly cloned individual mirnas into existing mirna families.

