BACKGROUND
a large problem in mathematical modeling of biochemical signal transduction networks is combinatorial complexity  <cit> . due to the occurrence of receptors and scaffold proteins with high numbers of binding domains and binding partners the number of feasible molecular species is enormous  <cit> . many existing models evade the problem of combinatorial variety by assuming reduced, heuristic network structures that focus on a restricted number of molecular species and reactions  <cit> . faeder et al.  <cit>  showed by simulation studies that in combinatorial reaction networks only a relatively small part of the network might be active which means that the concentration of many species is negligible low. by eliminating these species as well as the associated reactions a fairly reduced model can be obtained. faeder et al.  <cit>  also showed that the predictions of such a reduced model match those of the complete one for the original parameter values quite well, but that the reduced model is not predictive over a larger range of parameter values. even very small perturbations in the parameters may result in large approximation errors. since the real kinetic parameters are usually unknown, these findings of faeder et al.  <cit>  indicate that a heuristically derived model structure will mostly be insufficient to approximate the dynamics of the real signaling network. this result is confirmed by conzelmann et al.  <cit>  who showed, by discussing a scaffold protein with only three binding domains, that reasonable, heuristically derived, model reductions may lead to significant approximation errors even for very small reaction networks.

an alternative approach to tackle combinatorial complexity is stochastic simulation. one possibility is an agent-based approach in which each protein is considered to be an autonomous individual in the reaction network. this approach restricts the number of elements that have to be considered to the total number of protein copies, while the number of feasible multiprotein complexes, which can easily grow to billions  <cit> , often exceeds this number by far. however, the computational cost for that kind of stochastic simulations can also be extremely high. another possibility how stochastic models can help to reduce combinatorial complexity has been presented by lok et al.  <cit> . the enormous complexity of the stochastic model is reduced by a new approach which incorporates complexes and reactions only when they are needed as the simulation proceeds  <cit> . however, it is much harder to analyze the dynamic behavior of stochastic models or to identify the model parameters from measurements  <cit> .

another, ode based, approach has been introduced by blinov et al.  <cit> . the modeling tool bionetgen allows a rule-based model specification, which is automatically expanded to a complete mechanistic ode model. bionetgen has been used to create a number of signaling models including egf receptor signaling and fcϵri signaling  <cit> .

borisov et al.  <cit>  proposed an alternative approach which adopts the point of view that the fundamental elements of signal transduction are domains instead of molecular species  <cit> . borisov et al. suggested to substitute the common mechanistic network description that includes all individual molecular species by a macrodescription. in this context, the term micro-state is used to describe individual multiprotein complexes, whereas the term macro-state refers to large sets of micro-states sharing a certain characteristic like phosphorylation of a defined binding domain. these macro-states correspond to descriptive biological quantities like phosphorylation degrees or levels of occupancy. the goal of this approach is the generation of a dynamic ode model describing the concentrations of these macro-states. borisov et al.  <cit>  show for instance that in the case of independent binding domains a reduced number of odes is sufficient to describe the dynamics of the macro-states accurately. this approach has been extended by conzelmann et al.  <cit>  who introduced a systematic procedural method. the starting point of this method is a complete mechanistic ode model which is subsequently reduced  <cit> . the reduction method bases on a hierarchically structured state space transformation. however, conzelmann et al.  <cit>  only provide a general transformation pattern for scaffold proteins with numerous single protein ligands. if these ligands can recruit further signaling proteins or the considered scaffold forms a dimer, the transformation pattern has to be extended. in this contribution, we present these extensions that enhance the applicability of the method to all kinds of signaling networks. furthermore, we introduce a novel approach to directly generate the reduced equations. this approach circumvents the computationally expensive set-up of a full combinatorial model and its subsequent reduction.

the section mathematical prerequisites will briefly discuss the mathematical concepts that are used. the main results are discussed in three parts: section exact model reduction presents the extension of the transformation pattern introduced by conzelmann et al.  <cit> . section reduced order modeling of combinatorial reaction networks introduces the novel approach for directly generating reduced models. section example: egf and insulin receptor crosstalk discusses the methods practical applicability and its benefits by generating a fairly reduced model of egf and insulin receptor crosstalk.

methods
mathematical prerequisites
in this contribution, exact model reductions will be discussed, but the term exact may be misleading since the elimination of model equations is always linked to loss of information. a reduction can only be exact in terms of the input/output behavior of the system which can be exactly preserved by a reduced model. in this work, we will always consider ode models given in state space representation

  x→˙=f→,u→)x→=x→0y→=h→), 

where x→ denotes the n-dimensional vector of all dynamic states or variables and u→ represents the m-dimensional vector of all external input signals. the vector y→ comprises all q output variables of the system, which either correspond to measured quantities or more general to all quantities of interest. the vector field f→ and the vector valued function h→ do have appropriate dimensions.

since we assume that the output y→ does include all essential quantities, we are solely interested in the systems input/output behavior. it is very essential to stress that exact reducibility is solely determined by the system's structure and the definition of input and output variables. thus, the only way to influence exact reducibility is to modify a system or to change the input and output variables. however, in most cases neither the model structure nor the choice of input and output variables is discretionary. exact reduction methods should not try to influence exact reducibility of a model but provide the information whether a given system is exactly reducible and how it can be reduced. the question of whether a model is exactly reducible is closely related to the control theoretical concepts of observability and controllability which will be introduced below. in control theory models that are not exactly reducible are called minimal realizations  <cit> . if a model is no minimal realization it comprises uncontrollable or unobservable states, which can be eliminated without changing the systems input/output behavior. the elimination of unobservable and uncontrollable states can be achieved by a formal dissection of the model's state space into observable and controllable, observable but not controllable, controllable but not observable as well as neither observable nor controllable subsystems. such a dissection is called kalman decomposition  <cit> .

control theory provides a couple of methods that facilitate the separation of controllable and uncontrollable as well as of observable and unobservable states. however, a deficiency of these methods is that they are either developed for linear systems or they are only designed for small nonlinear models  <cit> , but they are not applicable to very large nonlinear models of biological signaling cascades.

the methods we developed and present facilitate a kalman decomposition of combinatorial reaction networks. interestingly, for the considered type of systems a kalman decomposition can be achieved by a linear state space transformation that is additionally independent of the systems parametrization or the choice of input and output variables. naturally, a change of the parameter values or the input and output variables can affect the number of observable and controllable states but the proposed transformation always provides a kalman decomposition. this statement can be verified using the approach discussed in the section generality of the method.

mathematical characterization of processes and process interactions
a crucial problem in modeling combinatorial reaction networks is the parametrization of the immense number of reactions. considering different signal transduction models  <cit>  and modeling techniques  <cit>  it becomes apparent that mostly a large number of occurring reactions is parametrized by a relatively small number of distinct kinetic parameters. however, the assumptions, which reactions are parametrized by the same, and which by distinct parameter values, differ. from our point of view the most suggestive assumption is to determine parametrization on the basis of process interactions. our focus is on domains of large scaffold or receptor proteins that can be either occupied by other proteins or can undergo post-translational modifications like phosphorylation. we define a binding process as the sum of all reactions that change the level of occupancy of a considered domain. analogously, we define a modification process as the sum of all reactions changing the degree of modification of a domain. two arbitrary processes, no matter if binding or modification processes, may be either completely independent, interact unidirectionally or mutually. koschorreck et al.  <cit>  additionally discuss so-called all-or-none interactions which represent an important border case of mutually interacting processes. these different types of interactions shall be exemplified considering a very simple example which is taken from  <cit> . in this example, a receptor r is considered, which recruits the two ligands l and e. hence, the system comprises two binding processes. in this case, the reaction system consists of four reversible reactions, for which the following reaction rates can be formulated using mass action kinetics

  r1=k1⋅−k−1r2=k2⋅−k−2r3=k3⋅−k−3r4=k4⋅−k− <dig>  

according to conzelmann et al.  <cit>  the following process interaction types can be distinguished

• non-interacting processes

complete independence implies that the kinetic association and dissociation constants of one domain do not change upon ligand binding on the other domain. hence, it follows for the parameters k <dig> = k <dig>  k- <dig> = k- <dig>  k <dig> = k <dig> and k- <dig> = k- <dig> 

• unidirectionally interacting processes

the binding of one ligand, e.g. ligand l, is not influenced by binding of the other one. however, l binding does change the kinetic properties of the other domain. in this case, only the conditions k <dig> = k <dig> and k- <dig> = k- <dig> have to be fulfilled.

• mutually interacting processes

this is the most general case. binding of a ligand has an influence on binding of the other ligand and vice versa. in this case all parameters can have different values.

in addition to these, koschorreck et al.  <cit>  introduce

• all-or-none interactions

all-or-none interactions are a special case of mutual interactions. an mutual interaction between two processes is called all-or-none interaction, if the reaction cycle given by the four reactions of our example degenerates to a reaction chain. in real biochemical networks such interactions usually are given by domain phosphorylation and subsequent ligand binding. mostly phosphorylation can be considered as necessary precondition for ligand binding. on the other side ligand binding prevents dephosphorylation of the domain for steric reasons. to realize an all-or-none interaction in our example, one has to choose k <dig> = k- <dig> = k <dig> = k- <dig> =  <dig>  in this case the species r will not occur and the remaining reactions r <dig> and r <dig> form a reaction chain.

as can be seen from the examples provided below as well as from examples discussed in other publications  <cit> , the absence of interactions or the occurrence of unidirectional and all-or-none interactions facilitate model reduction and modularization.

state space transformations
the model reduction approach presented by conzelmann et al.  <cit>  is based on a linear state space transformation

  z→=tx→. 

in this work, it is assumed that each transformation matrix t is an invertible square matrix with real values  <cit> . the transformed model equations can be deduced from equation  <dig> by differentiation

  z→=tx→|ddt⇒z→˙=tx→˙=tf→. 

finally, the old variables x→ have to be replaced by the new ones using the inverse transformation x→=t−1z→ resulting in

  z→˙=tf→,u→)z→=z→0=tx→0y→=h→). 

in the case of nonlinear transformations, the transformed model equations can be deduced following the same procedure. however, note that the inversion of a nonlinear transformation can be extremely difficult.

observability
let us consider the linear ode system

  =+u→y→=c1x→ <dig>  

in which a, b and c are constant matrices of appropriate dimensions and the initial conditions are given by t=t. obviously, the variables denoted as x→ <dig> do not have any influence on the output variables y→. hence, any initial states whose values for x→ <dig>  coincide result in identical outputs for arbitrary initial conditions x→ <dig> . the differences in the states x→ <dig> cannot be observed considering these outputs.

the number of observable states is determined by the dimension of the so-called observability space. for linear systems it can be calculated as

  d = rank   with   q = t 

the first d linearly independent rows of q build a basis for the observability space o <cit> . for d = n the system is called observable.

these considerations imply that an unobservable system always can be reduced without affecting the dynamics of the output variables. in equation  <dig> a reduced system would exclusively comprise the odes for the state variables x→ <dig>  such reductions are exact with respect to the output.

controllability
now let us consider a differently structured linear system of the form

  =+u→x→=x→0y→=cx→. 

in this case the state variables x→ <dig> cannot be influenced by the inputs. hence, the chosen input does not allow to control the system in any desired way, why the system is said to be uncontrollable  <cit> . in analogy to the considerations about observability, there also exists a controllability space c whose dimension as well as its basis can be deduced from the matrix

  p =  

uncontrollable systems also can be reduced without affecting the dynamics of the output, if an additional assumption is fulfilled. if the dynamics of the uncontrollable subsystem  already decayed, x→ <dig> can be replaced by its steady state value which in the regarded example corresponds to zero.

RESULTS
exact model reduction
short review
conzelmann et al. have introduced linear transformations that realize a kalman decomposition for models of scaffold proteins and receptors with single protein ligands  <cit> . the term single protein ligand indicates that one only considers the multi domain protein and its direct binding partners but no additional binding or modification processes at these ligands.

the model reduction procedure suggested by conzelmann et al.  <cit>  can be divided into three essential steps.

step 1: one generates a complete mechanistic ode model of the considered combinatorial reaction network using e.g. bionetgen or alc  <cit> . furthermore, one has to define input and output variables.

step 2: the ode model is transformed using the proposed linear transformation pattern. if the system contains unobservable state variables the transformed model equations can be written as

  =y→=h→. 

in analogy to equation  <dig> the states z→ <dig> are unobservable. choosing an invertible transformation matrix assures that the system's dynamics are preserved, and the original states can be retrieved from the new ones at any time as long as none of the transformed equations are eliminated.

step 3: the last reduction step is the elimination of the unobservable system states. if the model also comprises uncontrollable states these odes can be replaced by the related steady state equations. a suitable transformation pattern that facilitates a kalman decomposition of models describing scaffolds with multiprotein ligands or scaffold homodimerization is still missing. the term multprotein ligand indicates that the direct binding partners of the considered scaffold can also recruit further proteins or scaffolds . in the following subsections, we will introduce and discuss transformation patterns for these kind of systems.

scaffolds with multiprotein ligands
many scaffold proteins or receptors often recruit other scaffolds which in turn can be phosphorylated and/or bind further ligands. a prominent example is the scaffold irs which binds to insulin receptor and can recruit numerous other ligands like grb <dig> or pi3k  <cit> . we will call scaffolds like irs multiprotein ligands. note that, in general, these multiprotein ligands can either bind single protein ligands or again other multiprotein ligands. heterodimerization, as it occurs in the erbb signaling network  <cit> , also fits into this pattern. homodimerization, on the other hand, will be excluded from the following considerations. due to the symmetry of homodimeric complexes homodimerization has to be handled differently as will be discussed later. scaffolds with single proteins ligands as discussed by conzelmann et al.  <cit>  can be considered as a special case of what we examine here. the main difference between these multiprotein and single protein ligand systems is the formation of long protein chains. for this reason, we will focus on this phenomenon and its mathematical treatment. later we will exemplify how branched multiprotein ligand systems can be handled considering a model of egf and insulin receptor crosstalk.

let us focus on a receptor protein r which provides n binding domains. we take the assumption that each domain i can bind an effector protein e1i which in turn can recruit another effector protein e2i till finally em−1i binds emi. in order to reduce the number of indices we also presume that each chain of effector proteins consists of m proteins. finally, we only regard binding processes and neglect all domain phosphorylations. thus, each receptor domain can be either unoccupied or occupied by a multiprotein ligand consisting of one to m proteins which results in n distinct receptor complexes. furthermore, the m effectors that form the different multiprotein ligands for one single receptor domain can build m <dig> distinct complexes. according to these examinations the total number of feasible multiprotein species is n+m2n.

general transformation pattern
in analogy to the considerations made by conzelmann et al.  <cit>  we require a state space transformation which facilitates a kalman decomposition of the reaction network. the transformation pattern introduced by conzelmann et al.  <cit>  can be divided into tiers that describe levels of occupency of different order. the concept of using levels of occupancy as new variables is problematic for the considered multiprotein ligand systems. the term level of occupancy implies a certain hierarchy among the signaling proteins, which is certainly given in the single protein ligand scenario where one scaffold can bind numerous other effector proteins. it is obvious that in such reaction networks the scaffold takes up a prominent position which suggests the consideration of its occupancy levels. in a system that involves numerous scaffolds a clear hierarchy is missing, and the question arises which occupancy levels should be considered. in most cases, an intuitive hierarchy will be automatically chosen. for example, in the case of insulin signaling, it is quite suggestive to choose the insulin receptor as central protein of the cascade. due to representational reasons we also assume a hierarchy in our examples with r being the central protein. however, if one e.g. considers heterodimerization of two erbb receptors  <cit>  it is not apparent which receptor takes up a more prominent position than the other one. another problem is that the definition of occupancy levels for multiprotein ligand systems is not as unique as for single protein ligand systems. the quantity , which can be interpreted as an occupancy level, describes all receptor species whose first domain is occupied by the single protein e <dig> excluding all species in which e <dig> has bound any further effectors or scaffolds.  on the other site represents an alternative type of occupancy level which does not exclude the previously mentioned multiprotein complexes.

a more general transformation pattern is required that avoids the implication of molecular hierarchy, and is consistent with the transformation pattern introduced by conzelmann et al.  <cit> . these requirements are met by the introduction of so-called occurrence levels. occurrence levels always refer to a certain molecular subcomplex and correspond to the sums of all multiprotein species that comprise this subcomplex. thus, for each individual molecular species one can define a respective occurrence level. if these occurrence levels are used to replace the original model states, this defines a linear and invertible transformation. the proposed transformation pattern also preserves the hierarchical structure of the transformation matrix. the 0th tier of the transformation matrix, as introduced by conzelmann et al.  <cit> , includes the overall concentrations of all involved signaling proteins. it corresponds to the occurrence levels of individual proteins which are a very special type of subcomplex. the 1st tier includes the occurrence levels of all possible two protein subcomplexes. in the case of scaffolds with single protein ligands this directly corresponds to the levels of occupancy. according to this pattern the following tiers of the transformation matrix respectively comprise all subcomplexes consisting of three, four and more proteins. if phosphorylations occur in the considered reaction network the phosphate groups have to be treated as additional molecules. for example a scaffold with one phosphorylated domain is regarded as a two molecule complex.

for the simplified case introduced above the new transformed states can be specified as follows. the 0th tier comprises the states  and , while the first one includes the states  as well as . the occurrence levels that refer to all three molecule complexes are ,  and . the subsequent tiers are defined according to this pattern, and the last tier only comprises the single micro-state . the fact that each individual molecular species can be uniquely linked to an associated occurrence level suggests that the transformation is invertible. this can also be proven by using the mathematical induction as described for single protein ligands in conzelmann et al.  <cit>  .

examples
we will analyze two different systems of receptors with multiprotein ligands . for the sake of simplicity these examples solely consider chains of signaling proteins. a more complex example is given in the section example: egf and insulin receptor crosstalk. the first system consists of six signaling proteins which bind consecutively to each other. in order to provide a simple representation of the occurring complexes and the corresponding occurrence levels the protein r is considered as central receptor which binds the single protein ligand l and a multiprotein ligand consisting of the effectors e <dig> to e <dig>  none of these proteins is assumed to be phosphorylated. the second example only comprises four signaling proteins of which three are phosphorylated.

example 1: six signaling proteins
we assume that e <dig> binding is unidirectionally influenced by the recruitment of l. equivalently, ei binding is unidirectionally influenced by the binding of ei- <dig> to its predecessor. the resulting reaction rules for this system are given in table  <dig>  we take the assumption that  is the input of the system. the choice of output variables is more difficult in this example. for systems with single protein ligands the levels of occupancy are chosen. these correspond to all states included in the 1st transformation tier. in accordance to this choice one could again take all states of the 1st tier as output variables. for multiprotein ligands these states correspond to the occurrence levels of all two protein complexes. however, for many real networks also other states might be of interest. let us consider the insulin receptor which can recruit a multiprotein ligand consisting of shc, grb <dig> and sos  <cit> . in this case, the recruitment of sos to a membrane bound signaling complex initiates the mapk cascade  <cit> . thus, it is important to know how many sos proteins have bound to the receptor complex and not how many grb2-sos complexes occur in the network. hence, we will consider two types of output variables.

the kinetic parameters are specified behind the rules.

the output vector y→ <dig> represents the five occurrence levels of the 1st transformation tier. the output vector y→ <dig> on the other hand includes the variables , , ,  and . in order to show the large influence of process interactions on exact model reduction we additionally consider the case that k <dig> = k <dig> and k- <dig> = k- <dig>  this assumption implies that e <dig> binding is completely independent of all other binding processes. since the transformation pattern is independent of the kinetic system properties and the chosen output variables all mentioned cases can be handled using the same transformation. it consists of six tiers that are shown in table  <dig> 


the new states correspond to the occurrence levels of different subcomplexes. the transformation can be structured in different tiers. the previously discussed case of single protein ligand systems can be considered as border case of the underlying transformation pattern. the transformation is independent of the chosen output variables as well as the kinetic properties of the reaction network. however, another choice of output variables may lead to a higher or lower number of observable states. the same holds true for varying kinetic parameters. for given input and output signals the kinetic properties determine whether states are observable and/or controllable. furthermore, the kinetic parameters also define whether the model equations can be modularized or not. in the considered example the system does not comprise unobservable states and can be divided into five modules if k <dig> ≠ k <dig> and k- <dig> ≠ k- <dig>  if k <dig> = k <dig> and k- <dig> = k- <dig> the system can be reduced to ten odes.

due to the absence of protein production and degradation the six states of the 0th tier remain all constant. thus, these six odes can be eliminated in the considered example. first, we will discuss the case that e <dig> binding is unidirectionally influenced by e <dig> binding. in this case, our transformation does not allow any exact reduction of the model, neither for the output variables y→ <dig> nor for y→ <dig>  interestingly, the transformed model equations can be dissected into five modules, which are all unidirectionally coupled. this model structure directly resembles the interaction pattern between the five considered binding processes. in fact each of the modules describes one of these five processes. however, the modules differ in size and structure.

the first module which describes the recruitment of l to the receptor only consists of one differential equation. the second, third, fourth and fifth module comprises two, three, four and five states, respectively. another nice property of the transformed system is the concurrently achieved modularization of the kinetic parameters. for instance, the l binding module only contains the parameters k <dig> and k- <dig>  in addition to k <dig> and k- <dig>  the second module comprises all parameters that describe binding of e <dig> to r but no others. this special hierarchical structure is very advantageous for parameter estimation.

measurements of the transient behavior either of the states y→ <dig> or y→ <dig> facilitate a stepwise identification of the kinetic model parameters module by module.

taking the assumption that the association of e <dig> and e <dig> is independent of all other occurring binding processes the structure of the fifth module changes. the state e3) is not controllable any more, since the respective binding process can neither be directly nor indirectly influenced by changes in the l concentration. if y→ <dig> is the output vector of the system the output variable e3) is determined by the steady state equation of the respective ode. the remaining four states of the fifth module are not observable and can be simply omitted. thus, the model can be exactly reduced to ten odes. the situation changes if one considers the output vector y→ <dig>  the choice of different output variables does not affect controllability of a system. thus, the state e3) is still uncontrollable and the respective ode can be replaced by its steady state equation. however, all model states are observable in this case, and thus no further equation can be eliminated. an exactly reduced model in this case would comprise fourteen odes.

example 2: domain phosphorylation
as a second example we consider a similar receptor r. in contrast to the previously considered example the receptor's intracellular domain has to be phosphorylated in order to bind the effector protein e <dig>  phosphorylation is considered to be a necessary precondition for e <dig> binding, while bound e <dig> preserves the receptor domain from dephosphorylation due to steric reasons. this corresponds to a so-called all-or-none interaction as it has been introduced by koschorreck et al.  <cit> . e <dig> also has to be phosphorylated in order to recruit e <dig>  which prevents dephosphorylation of e <dig>  we do not consider binding of further effector proteins. the reaction rules for this system are given in table  <dig> 

the kinetic parameters are specified behind the rules.

again the concentration  is considered as the input of the system. the states , , ,  and  are chosen as ouput variables y→. since the system also comprises six different processes the transformation pattern again consists of six different tiers that are depicted in table  <dig>  due to the absence of protein production and degradation the three states of the 0th tier remain all constant. thus, these three odes can be eliminated.

the new states correspond to the occurrence levels of different subcomplexes. the transformation can be structured in different tiers. the previously discussed case of single protein ligand systems can be considered as border case of the unterlying transformation pattern.

in this example, the transformed model equations can be dissected into three unidirectionally coupled modules including all five output variables, and one additional module comprising the two unobservable states  and . all model states are controllable. thus, this example shows that the existence of all-or-none interactions facilitate significant model reductions. although the considered system comprises the same number of molecular processes than the previously regarded one, even the complete mechanistic model already consists of a lower number of odes. additionally, the system comprises two unobservable states, which allows for a further model reduction.

homodimerization of receptors and scaffolds
homodimerization of receptors and scaffold proteins is quite common in signal transduction networks. for instance, homodimers occur in the erbb signaling network as described by citri et al.  <cit> .

homodimerization is additionally characterized by a number of unique features having a strong impact on model reduction which justifies a separate and detailed discussion. due to their symmetric configuration the number of distinguishable homodimers is much lower than of equally large heterodimers. if one considers a receptor monomer which forms n distinct monomeric multiprotein complexes there exist n <dig> feasible homodimers. heterodimerization of two different receptors, which both form n monomeric species, leads to n <dig> feasible heterodimers. however, the indistinguishability of symmetric receptor dimers not only has the positive effect of reducing the number of odes compared to heterodimers. it also leads to non-intuitive kinetic system properties, which will be discussed below.

we will consider a receptor r with n distinct binding domains. furthermore, we presume that r can form homodimers. these homodimers shall be decipted as r.r. due to the symmetry of the dimers one cannot distinguish between r.r and r.r. hence, we reach an agreement that the receptor with more occupied domains will always be noted first.

kinetic properties
dimerization is a molecular process such as ligand binding, and dimerization can influence or can be influenced by all other processes within the considered network. the most simple theoretic case one can analyze is that receptor homodimerization is completely independent of all other processes. in order to achieve this independence one has to parametrize all dimerization reactions adequately. this requires to distinguish between the formation of mirror symmetric dimers and non-mirror symmetric dimers. the reason for this discrimination is that reactions describing the formation of non-mirror symmetric dimers have to be parametrized by a twofold higher kon value than those of mirror symmetric dimers.

  r+r⇋k−1k1r.rr+r⇋k−12k1r.r 

the reason for this duplication of the kon value can be elucidated considering the reaction rates. let us take the assumption that the two concentrations  and  are equal. the rates for the considered two reactions comprise the terms  <dig> and ·, respectively. according to the collision theory for chemical reactions these terms are measures for the likelihood of a collision of two reactants in the system. due to our assumption that the concentrations of both species are equal, the evaluation of both terms leads to exactly the same numerical result. however, the likelihood for the formation of a non-mirror symmetric dimer is twofold higher than that for mirror symmetric ones. this becomes apparent if one considers the collision probability for both cases. in the second case the number of molecules that may collide is twofold higher than in the first one.

not only the dimerization process itself and therefore the dimerization reactions have to be treated differently. due to the symmetry of homodimers one also has to be careful in parametrizing ligand binding and modification reactions. let us again assume that binding of the ligand l is completely independent of all other processes. note, that this is a completely theoretic assumption in order to illustrate the occurring problems regarding the most simple scenario. furthermore, let k <dig> and k- <dig> be the kinetic parameters describing the association and dissociation of l with a receptor monomer

  r+l⇋k−1k1r. 

here, one has again to distinguish two cases, namely binding of l to a completely unliganded dimer and binding to a single liganded one. according to our assumption dimerization shall not have any effect on ligand binding. hence, each receptor molecule of a dimer behaves exactly the same way as a monomeric receptor does, which indicates that an unliganded dimer has a twofold higher kon value than a single liganded or a monomeric one. the same rationale also implies that the koff value for a double liganded dimer is twofold higher than for a single liganded one. thus, the reactions have to be parametrized as follows

  l+r.r⇋k−12k1r.r 

  l+r.r⇋2k−1k1r.r. 

the realization of process interactions either between two binding or modification processes or between dimerization and some other processes is straight forward. if dimerization has an influence on l binding, reaction  <dig> will be parametrized by k <dig> and k- <dig>  while the parameters k <dig> and k- <dig> will be used for the reactions  <dig> and  <dig>  however, one still has to account for the twofold higher association constant of reaction  <dig> and the twofold higher dissociation constant of reaction  <dig>  the neglect of these additional factors corresponds to a mutual interaction between the two ligand binding processes within a dimer.

general transformation pattern
the general transformation for systems that include homodimerization follows exactly the same pattern as introduced for scaffolds with multiprotein ligands. it is hierarchically structured whereas the different tiers of the transformation comprise occurrence levels of one, two, three or higher molecule complexes. however, one has to be careful, since some of the species concentrations have to be counted twice. let us consider the occurrence level of a receptor ligand complex, which we will depict as . this accumulated quantity comprises monomeric as well as dimeric species, namely ,  and . observe, that the species r.r include two receptor ligand complexes and therefore has to be counted twice. consequently, the considered occurrence level is defined as

  =++ <dig>  

the invertibility of the transformation matrix suggested here can again be proved using mathematical induction.

example
as an example we will analyze homodimerization of the egfr receptor which will be called r in the following. in addition to the dimerization process we also consider egf binding and receptor phosphorylation. egf binding and receptor dimerization are assumed to interact mutually. this assumption is in accordance with thermodynamic constraints  <cit> , and also fits to experimental data presented by odaka et al. and lemmon et al.  <cit> . furthermore, we assume that dimerization influences receptor phosphorylation, since the receptors of a dimer phosphorylate each other mutually. in analogy to the experimental results of gherzi et al.  <cit>  for insulin signaling this interaction is expected to be an unidirectional one. the reaction rules which describe this system are given in table  <dig> 

herein the identifiers xn also indicate that the related domains can be in various states as the identifier * does. however, all domains with the identifier xn within one rule have to be in the same state. if two different identifiers xi and xj occur within one rule the respective domains are not allowed to be in the same state.

the reaction system comprises  <dig> receptor species and the ligand egf. the transformation of these states according to the proposed general transformation pattern is shown in table  <dig>  since the concentration of extracellular egf is considered as model input the transformation does not include the overall concentration of egf. the most suggestive choice of output variables in this example are the three occurrence levels of the 1st transformation tier, namely ,  and . these outputs correspond to the total number of liganded egf binding domains, the total number of phosphorylated intracellular receptor domains as well as the number of receptor dimers.

the new states also correspond to the occurrence levels of different subcomplexes. due to the symmetric structure of the recptor dimers some species have to be counted twice. for instance the macroscopic state  is an aggregation of all species that comprise a subcomplex consisting of one receptor and one egf molecule. the two micro-states  and  obviously fit into this pattern. however, the state  has to be counted twice since the regarded subcomplex also occurs twice in this species. furthermore, the transformation can be structured in six different tiers.

due to the absence of production and degradation, the overall concentration of egfr stays constant and the respective ode can be eliminated. the remaining  <dig> transformed model equations can be dissected into three modules. the first module consists of four odes and describes egf binding as well as receptor homodimerization. it comprises the model states , ,  and . the second module describes receptor phosphorylation and contains six odes, while the remaining three odes for ,  and  form the third unobservable module. since all states are controllable the model can be reduced by omitting the three unobservable states. this reduced model then comprises ten odes.

generality of the method
nearly more important than the introduced method and the algorithm to exactly reduce a model is the question about its limitations. in this context, one has to distinguish between the limitations of exact reducibility and of the described reduction method. as we mentioned earlier the model structure as well as its input and output variables are mostly not discretionary. if a considered system is a minimal realization due to these characteristics it is impossible to find or develop any method which allows to exactly reduce this model. from our point of view this is no limitation of the method but of exact reducibility in general. it is difficult to make a descriptive but general statement under which conditions a combinatorial reaction network model is exactly reducible or not. however, one can state that retroactive effects as well as feedbacks can strongly reduce the number of eliminable states. if at least one of the binding or modifications processes that are of interest is directly or indirectly affected by all other considered processes the chances to reduce such a system exactly are very low. from a mathematical point of view one can make much more general statements. control theory provides numerous techniques which allow to check any system for observability or controllability. if all model states are observable and controllable the application of our method is not convenient instead one should alternatively use an approximative reduction technique like proposed by koschorreck et al.  <cit> . one possibility is to check for local observability or controllability of the reduced models by analyzing the linearized model equations

  x→˙=ax→+bu→y→=cx→ 

with a=∂x→)x→o,u→o, b=∂u→)x→o,u→o and x→ ∈ ℝn, u→ ∈ ℝm. if all states of the linearized model are controllable and observable this proves that at least at the considered operating point  all states are required to accurately describe the systems behavior and that the model is not exactly reducible. the system is said to be locally controllable at the operating point if the rank of the matrix p  is n  <cit> . accordingly, the system is said to be locally observable if the rank of the matrix q  is n  <cit> . however, using this analysis method one has to be aware of the fact that controllable and observable nonlinear system states might loose controllability and/or observability at individual operating points  <cit> . a matrix rank of n proves that the considered system cannot be exactly reduced. at least at the chosen operating point all states are controllable and therefore affect the system's input/output behavior. if a model still comprises uncontrollable or unobservable states, the rank of the related matrix will be smaller than n for all considered operating points. however, if the matrix rank is lower than n this is no proof that the system is exactly reducible and still comprises uncontrollable or unobservable states. it is also possible that the system was linearized at an unpropitiously chosen operating point. hence, it might be necessary to repeat the test at several operating points. a matrix rank smaller than n for numerous operating points highly suggests the further existence of uncontrollable or unobservable states in the nonlinear system. however, it is no proof.

after having discussed the limitations of exact reducibility in general, we also want to address the limitations of our method. a limitation of an exact reduction method is it does not facilitate the reduction of an exactly reducible model. unfortunately, it is not possible to generally prove that our method has or has not such limitations. however, each model that has been reduced using our method can be linearized and checked for local observability and controllability. if the rank of the corresponding p and q matrices is n all unobservable and uncontrollable system states have been eliminated.

all examples discussed in conzelmann et al.  <cit>  as well as the examples discussed above have been checked for further uncontrollable or unobservable states using this approach. in all cases, the reduced models proved to be minimal realizations even for varying input and output variables. however, there exists an interesting border case, in which a model can be further reduced without affecting the input/output behavior. this border case shall be discussed below.

we consider a receptor with three binding domains whereas one extracellular domain controls the two intracellular domains in an unidirectional manner. this example is also discussed by conzelmann et al.  <cit> . however, in contrast to the example discussed there, we presume that the two intracellular domains are identical. both recruit the same effector protein e and both have exactly the same kinetic properties. let us further assume that the system output is the total number of e proteins bound to the receptor, which corresponds to the sum of both occupancy levels. the proposed transformation facilitates the elimination of the two unobservable odes  and  . in this case, the remaining odes can only be dissected into two modules. although the two identical domains do not interact with each other their odes are coupled due to the fact that both recruit the same effector. the module that describes the two intracellular domains resembles the symmetry of the considered system. its equations form two identical but coupled submodules

  x→˙1=f→x→1=x→ <dig> ,x→˙2=f→x→2=x→ <dig> ,y=c, 

each describing one of the two identical binding domains. however, note that the initial conditions do not necessarily have to coincide. under these assumptions the system still comprises unobservable states if the vector field f→ fulfills the superposition principle

  f→+f→=f→=g→. 

in this case the system output y and its derivatives only depend on the sum of x→ <dig> and x→2

  y˙=c+f→)=cg→. 

thus, a minimal realization of the system would be

  ξ→˙=g→ξ→=ξ→0=x→10=x→20y=cξ→. 

the superposition principle is fulfilled if the operator f→ is linear in x→. in the more general case if f→ does not fulfill the superposition principle our transformation provides a minimal realization of the system. however, note that even for a general operator f→ the number of equations can be reduced if the initial conditions of both submodules are equivalent . under this condition both submodules are completely identical  and therefore one of them can be eliminated and the reduced module can be written as

  ξ→˙=f→=g→ξ→=ξ→0=x→10=x→20y=2cξ→. 

however, this reduction is not due to the elimination of unobservable states as defined above but results from the restricted choice of initial conditions. from these considerations it can be seen that except for the case of two identical linear subsystems no example has been found for which the proposed transformation does not provide a kalman decomposition.

reduced order modeling of combinatorial reaction networks
in the previous section, we discussed a general and systematic method that allows for significant and exact model reductions of combinatorial reaction networks. now, an alternative approach shall be considered that facilitates the direct generation of the exactly reduced model equations. this reduced order modeling approach is based on the close relations between controllability and observability of a model and the process interactions of the examined system.

controllability, observability and process interactions
from the previously regarded examples it can be seen that the number of observable and controllable states highly depends on the occurring process interactions. the question is whether the qualitative information about process interactions can give clues about the observability and controllability of a reaction network, or maybe even facilitate a direct translation to reduced model equations. controllability and observability as well as process interactions provide information about interactions within the considered system, however, at different levels of abstraction.

controllability and observability are properties of an ode system, and both of them characterize the ode couplings with respect to the system inputs and outputs. all observable states exert a certain influence on at least one of the output variables. on the other hand a state is said to be controllable, if it can be influenced either directly or indirectly by one of the system's input variables.

process interactions describe the regarded system at a different level of abstraction. however, they also provide information about which processes can influence other processes and which can be influenced by other processes. controllability and observability are closely related to the definition of input and output variables, respectively. in accordance to this definition at the ode level, one can also formally define input and output processes at the process level. a connection between the two abstraction levels is given by the occurrence levels we previously introduced as a state space representation for combinatorial reaction networks. these coordinates allow a direct assignment of model states to specific molecular processes.

each occurrence level like e.g.  can be directly assigned to its respective process, namely ei binding to r. analogously, occurrence levels of higher tiers like  can be linked with three different processes. all processes that are related to the chosen output variables are said to be output processes, and all processes that can be directly assigned to the input variables analogously correspond to the input processes. this direct link between model variables and processes facilitates the unique translation of all input and output variables to a set of input and output processes. let us consider an example and presume that the concentration of e <dig> is regarded as input variable while  and  are output variables. in this case e <dig> binding to r is an input process, and e <dig>  e <dig> and e <dig> binding to r are output processes.

furthermore, we can formally introduce process controllability and process observability. a process shall be called process controllable if it is either directly or indirectly influenced by one of the input processes. analogously, a process will be called process observable if it directly or indirectly affects one of the output processes. in contrast to controllability and observability of an ode model, the respective system properties at the process level can be analyzed in a very simple way by considering the process interaction graph. in this graph processes are regarded as nodes, while process interactions are represented as directed edges. this definition of an interaction graph is very similar to that proposed by klamt et al.  <cit> . a process p is process controllable if the interaction graph comprises a directed path from one of the input processes to the process p. the same process is observable if there exists a directed path from p to one of the output processes.

a relation between the controllability and observability concepts at the different abstraction levels can also be approved. process controllability suggests that all states that are assigned to this process are influenced and therefore controllable. process observability on the other hand indicates that the respective occurrence level of the 1st tier is observable. state variables that describe occurrence levels of higher tiers, as , are only observable if the related processes all jointly affect at least one of the output processes. thus, we have found a way to predict whether a certain state might be observable or controllable by considering the process interactions. note, that this technique provides a conservative appraisal which in some cases will classify states as controllable or observable although they are not.

reduced order modeling technique
the enormous complexity of most real signal transduction networks often impedes the application of common model reduction techniques discussed in literature as well as the previously proposed model reduction concept. new alternative techniques are required that allow the direct generation of reduced model equations. the already introduced concepts of process interactions, interaction graphs as well as process controllability and observability serve as a basis for the following considerations. the fundamental idea is that at the macroscopic level a mathematical description of a certain process merely requires the incorporation of those other processes that exert some influence on the considered one. a detailed specification of the method will be given in the following and is structured in nine elementary steps. each step will be illustrated considering the example shown in figure  <dig> 

step 1: definition of all proteins, binding domains as well as binding and modification processes that shall be included to the model.

example: in the considered example the model will comprise the molecules a, b, c and d with their binding domains as depicted in figure 3a. the occurring processes are usually labelled or numbered like indicated in figure 3a. in the example we consider eight different processes, namely binding of a to b , phosphorylation of b at different domains , binding of c to b , phosphorylation of c at two distinct domains  as well as binding of d .

step 2: in a second step one has to define all occurring process interactions and whether these are uni- or bidirectional. these process interactions have to be consistent with both measured kinetic data of the involved proteins and the thermodynamic constraints as discussed in ederer et al. and conzelmann et al.  <cit> . these constraints for instance highly restrict the possible occurrence of unidirectional interactions. nature can only realize unidirectional interactions at the expense of energy  <cit> . since a mathematical model requires a complete definition for all interactions, mostly fragmentary knowledge has to be completed by assumptions.

example: in figure 3a the occurring process interactions of the example are indicated by arrows. the processes , , ,  and  are assumed to interact unidirectionally. this assumption is in accordance with the mentioned thermodynamic constraints since phosphorylation consumes energy rich atp  <cit> . the processes  and  are regarded as all-or-none interactions which by definition are mutual ones. all other processes do not interact directly.

step 3: the interaction pattern of the system has to be translated into an interaction graph. as mentioned before the labelled or numbered processes are nodes and the occurring interactions are represented by directed edges  pointing to the process which is influenced.

example: the interaction graph for the considered example is depicted in figure 3b.

step 4: one defines input and output processes according to the considered system stimulations as well as available measurements or research interests. if for instance the external ligand concentration is considered as input the related input process is ligand binding. if one is interested in receptor phosphorylation all phosphorylation processes at the receptor have to be chosen as output processes. the goal of generating a model that accurately describes the output processes at a macroscopic level necessitates the further inclusion of all other processes that are process observable.

example: in the example we choose process  <dig> an input and the processes  <dig>   <dig>   <dig> and  <dig> as output processes. the output processes are marked by grey circles in figure 3b.

step 5: the interaction graph can be divided into output subgraphs. an output subgraph contains all nodes from which a specific output node can be reached following the directed edges. the most simple way of finding an output subgraph is to invert the directions of all arrows in the interaction graph and to start at one output process. following the arrows one marks all processes that are directly connected with the output process. afterwards one marks all other processes that are directly linked with the previously found processes. this procedure is repeated until one either reaches dead end processes or the number of marked processes does not increase anymore. the so found output subgraph comprises all processes, which are process observable considering the chosen output process. if a node does not occur in any output subgraph the corresponding process cannot influence any of the output processes and can be completely omitted in the following. finally, one has to eliminate redundant information, i.e. subgraphs which are completely comprised in other bigger subgraphs. in principle one also can analogously define input subgraphs and determine which processes are uncontrollable. in this case one does not have to invert the directions of the interaction arrows. one simply uses the original directed graph, starts at an input process and performs exactly the same procedure as described for output processes. however, uncontrollable but observable processes cannot simply be eliminated from further consideration. uncontrollability merely allows for steady state assumptions at the ode level.

example: the graph shown in figure 3b can be divided into four output subgraphs as shown in figure 3c. in this example process six does not influence any of the considered output processes and can be omitted in the following considerations. the subgraph for output process three is completely comprised in two other subgraphs and therefore can be eliminated. in this example there only exists one input subgraph that comprises all processes.

step 6: each of the output subgraphs describes an autonomous signaling path, which can be modeled separately. note, that the first five steps are independent of the used modeling approach. for instance, one can also generate stochastic models on the basis of the derived output subgraphs. however, we will focus on ode models now. hence, the next step is to create complete mechanistic ode models for each subgraph. processes not being part of a subgraph are not included in the respective model.

example: this step shall be exemplified considering the smallest subgraph of the example system that comprises the processes  <dig> and  <dig>  the mathematical model is given by

  r1=k1−k−1r2=k1−k−1r3=k2−k−2r4=k3−k− <dig> 

  ddt])=, 

in which the rates r <dig> and r <dig> describe the binding of a to the scaffold protein b , and the rates r <dig> and r <dig> describe the phosphorylation of b .

step 7: the model equations have to be transformed to new more convenient coordinates, which allow to eliminate redundant information still included in the subgraphs. this redundancy is due to the fact that some processes are comprised in several subgraphs. a suitable choice of new coordinates is given by the previously introduced occurrence levels. note, that we highly recommend to choose always the transformation patterns discussed in the previous sections since these guarantee that the redundant information can be eliminated. however, we also want to state that there exist numerous other transformations that also would allow to eliminate the redundant information.

example: as an example we again consider only the smallest subgraph of the system which comprises the processes  <dig> and  <dig>  the first tier in this example includes the overall concentrations of the molecules a and b

  =++=+++. 

the next tier comprises the first order occurrence levels, which are given by

  =+=+. 

in this example there only occurs one further tier describing the second order occurrence levels, namely

   = . 

processes that are not included in the currently considered subgraph are simply omitted since they are not observable. if the sub-model still contains unobservable states these can also be eliminated at this stage of the procedure.

step 8: the proposed transformation allows to dissect the model equations of each subgraph into modules like shown above. these modules are characterized by unidirectional communication with other modules. processes which directly or indirectly interact mutually form one module. if some processes are included in more than one subgraph, the models of these subgraphs will contain identical modules. multiple copies of modules can be eliminated and the remaining modules can be merged to a complete model.

example: for instance, the transformed odes for the discussed smallest subgraph do have a special structure. the variables  and  are constant and equal their initial concentration. the corresponding odes are not required. additionally, the ode for  does not depend on  and , which is due to the unidirectional process interaction between a binding to b and phosphorylation of b. hence, the remaining three odes can be divided into two modules. one module only comprises the ode for , which describes the dynamics of process  <dig>  the second module comprises the other two odes, which describe the dynamics of process  <dig>  the odes deduced from the two remaining output subgraphs shown in figure 3c, can be divided into six more modules as indicated in figure 3d. each box represents a set of odes. the modules are labelled with the process numbers which are described by the appropriate odes. two copies of module  and one of module  can be eliminated here. the resulting model, which consists of only  <dig> odes, is schematically shown in figure  <dig>  a complete mechanistic model of the exemplified network would comprise  <dig> odes of which three can be eliminated due to mass conservation relations.

step 9: in a last step one can take a steady state assumption for all uncontrollable states that are still part of the reduced model. note that this step is not obligatory and in some cases can be problematic since the steady state equations have to be solved. if it is possible it is advantageous to solve these equations analytically. however, in many cases an analytic solution might be unfeasible and the steady state equations have to be solved numerically in the step of numerical integration which then necessitates a dae  solver.

example: in the regarded example all states are controllable and therefore no steady state assumptions can be made.

the main advantage of the proposed method is the direct generation of a reduced, but exact, system of equations, circumventing a unsuitable large model of full combinatorial complexity. admittedly, the number of equations that has to be set up in step six mostly include redundant information about processes which can be observed at numerous outputs. however, the absolute number of odes that have to be generated is usually much lower than if a complete mechanistic model is created. in the considered example one only has to set up  <dig> odes using the described procedure. a complete combinatorial model would comprise  <dig> states. the method has to be slightly modified if one of the output variables is a higher order occurrence level which is not contained in any of the submodels. let us assume that one of the output variables in the example is  which describes both process  <dig> and process  <dig>  since none of the three subgraphs depicted in figure 4c comprises both processes simultaneously the quantity  will not be a state of the reduced  <dig> ode model. this problem can be overcome by the fusion of two subgraphs. this will necessarily increase the number of odes that has to be generated as well as the final size of the reduced model. however, the number of odes would still be smaller than  <dig>  furthermore, the inclusion of production and degradation into the mathematical model necessitates another extension of this method. the same holds true if the regarded system includes multifunctional protein binding domains, i.e. that certain binding domains are involved in several binding processes. both cases shall be discussed in the following. note, that these problems do not occur if a the method described in section exact model reduction is used.

multifunctional protein binding domains
multifunctional protein binding domains are domains which can recruit more than one binding partner. a typical example is the effector protein grb <dig> that can either bind to several erbb receptors as well as to the adaptor protein shc  <cit> . a constellation like this can lead to problems with the reduced order modeling approach introduced above. the problem occurs if such a multifunctional binding domain is part of two or more output subgraphs as shown in figure 3c.

the probably most simple example to illustrate the occurring problem is a scaffold protein r which provides two binding domains. both of these domains shall recruit the effector protein e which possesses one binding domain. the binding domain of e is a multifunctional one since it can bind to both r domains. if we assume that the two binding processes of the regarded system are completely independent and that both are considered as output processes, the system can be divided into two subgraphs. these subgraphs are somehow degenerated since both only comprise a single node. according to the reduced order modeling approach both binding processes can be modeled separately. however, the problem is that the binding domain of the effector e is involved in both processes. this is a typical crosstalk situation. since the number of effector proteins e and therefore the number of e binding domains is limited, the recruitment of e to one receptor domain reduces the concentration of unbound effector and therefore has an indirect influence on the other binding process.

one possible solution for this problem is to merge all output subgraphs that share such multifunctional binding domains. this approach has the drawback that the number of equations that have to be generated in the sixth step of the modeling procedure can be significantly increased. alternatively, one can formulate the reaction rates for both subgraphs independently. however, all species which are simultaneously involved in both submodels have to be balanced in one joint ode. if the first subgraph of the regarded example is translated into a reaction rate one has to consider only the rate

  r <dig> = k <dig>   - k- <dig> . 

in this representation the identifier # indicates that the real scaffold protein offers further binding domains but that the resulting combinatorial complexity is neglected. the second subgraph can be described by the reaction rate

  r <dig> = k <dig>   - k- <dig> . 

an ode model is obtained by balancing all occurring species. since the species e is involved in both submodels one has to create one joint ode for . note that species like r and r are considered to be completely different molecules. the resulting ode model is given by

  ddt=−r1ddt=r1ddt=−r2ddt=r2ddt=−r1−r <dig>  

following this procedure one does not have to consider the complete combinatorial complexity of the network. one also has to use a joint transformation which in this case is given by

  =+=+=++==. 

this means that occurrence levels can be composed of species from both submodels like  in the regarded example.

this simple modification or extension of the proposed modeling approach facilitates its application to a larger set of reaction systems. it will also be of great importance in modeling the crosstalk between egf and insulin receptor discussed below.

production and degradation
a process that has been completely neglected in the preceding considerations which, however, plays a crucial role in many real signal transduction networks is production and degradation of signaling proteins. this process increases or decreases the number of available proteins. a quite simple way of modeling production and degradation, which we will adopt here, is the assumption of a constant production rate and a degradation rate which is proportional to the concentration of the degraded species. in many cases ubiquitin is used as marker for controlled degradation as for example shown for erbb <dig> receptors  <cit> . a still unanswered question in this context is whether the whole signaling complex is degraded or only the erbb receptor while the associated adaptor proteins are recycled.

for the sake of simplicity we take a number of assumptions. first, the considerations shall be focused on production and degradation of the regarded receptor or scaffold protein and its complexes. the individual receptor protein r shall be produced with a constant rate and all receptor species are presumed to have a natural decay rate. all other adaptor and effector proteins are neither produced nor degraded. if a receptor complex is degraded all bound adaptor proteins shall be recycled to the cytosol. furthermore, we take the assumption that if the receptor is marked by ubiquitination its degradation rate is modulated. this change of the degradation rate from natural decay to ordered degradation can be considered as a process interaction. ubiquitination has a direct influence on degradation. it is quite obvious that all processes that involve one of the r binding domains are affected by the considered production and degradation.

theoretically, degradation can be considered as a process which sets the kon values of all r binding domains to zero and all koff values to infinity. all other effects caused by degradation are indirect effects. note that if one takes the assumption that a complex is degraded with all its bound adaptor proteins all processes that modify or enlarge the r complex are directly influenced. all these interactions are unidirectional ones, which can be simply introduced in the process interaction graph. production and degradation is one additional node in this graph which is influenced by ubiquitination and affects numerous other processes.

example: egf and insulin receptor crosstalk
finally, the discussed methods shall be used to generate a reduced model of egf and insulin receptor crosstalk. we will compare a complete mechanistic description of this crosstalk and an exactly reduced version.

model definition
in a first step it shall be defined which molecules and processes are included to the model and what assumptions are made concerning the process interactions. since a complete mechanistic model that is still manageable shall also be generated the considerations will be limited to a small part of the real signaling network. for instance only the egf receptor  will be taken into account and the other three erbb receptors shall be neglected. similar simplifications were made by many other modelers in the past years  <cit> . in order to avoid an unmanageable combinatorial explosion of feasible egf receptor species only two intracellular domains will be modeled. according to schulze et al. the egf receptor possesses among others six potential residues for grb <dig> and also six residues for shc binding  <cit> . hence, we consider one binding domain for each of these two effector proteins. concerning the insulin receptor family we will focus on the insulin receptor  and exclude potential crosstalk with the insulin-like growth factor receptor  and the insulin related receptor   <cit> . again we restrict the considerations to two intracellular ir domains, namely one for shc and one for irs  <cit> .

egfr provides an extracellular binding domain that recruits egf  <cit> . furthermore, the receptor monomers can form homodimers after being activated by the ligand. this dimerization induces phosphorylation of numerous intracellular domains  <cit> . according to thermodynamic constraints  <cit> , egf binding and receptor dimerization have to interact mutually fulfilling the wegscheider conditions. a mutual interaction is also suggested by experimental data  <cit> .

phosphorylation can be unidirectionally influenced like discussed for the insulin receptor by gherzi et al.  <cit> . analogously, egfr dimerization is assumed to unidirectionally influence egfr autophosphorylation of the regarded intracellular domains. a direct interaction between egf binding and phosphorylation is not presumed to occur. after the two intracellular domains are phosphorylated one of them recruits grb <dig> and the other shc  <cit> . the interaction between receptor phosphorylation and subsequent effector binding shall be an all-or-none interaction. furthermore, it is also known that shc can be phosphorylated after having bound to egfr  <cit> . shc binding is thought to unidirectionally affect shc phosphorylation. the phosphorylated shc protein can also recruit grb <dig>  <cit> . grb <dig> possesses an additional domain which recruits the adaptor protein sos. sos is a guanine exchange factor  which can activate the membrane bound small g-protein ras by effecting the exchange of gdp for gtp  <cit> .

active rasgtp in turn initiates the map kinase cascade. phosphorylated erk which is a component of the map kinase cascade stimulates a serine/threonine phosphorylation of sos resulting in dissociation of the grb2-sos complex  <cit> . thus, we take the assumption that the grb2-sos binding is not influenced by grb <dig> association to phosphorylated egf receptor or phosphorylated shc. however, if sos is phosphorylated by erk, which is considered as additional input signal, the grb2-sos complex dissociates. here we assume a mutual interaction between sos phosphorylation and grb2-sos binding.

the insulin receptor consists of two constitutively dimerized monomers and is activated exclusively by ligand binding without further oligomerization  <cit> . due to the dimeric structure of the insulin receptor two insulin binding domains will be included to the model. according to the thermodynamic constraints and experimental results these two domains have to interact mutually  <cit> . ligand binding is assumed to unidirectionally influence the phosphorylation of the two regarded intracellular domains  <cit> . shc is assumed to bind with other kinetic parameters to ir than to egfr. however, shc phosphorylation, grb <dig> binding to phosphorylated shc etc. is parametrized like in the case of egfr. in order to reduce the complexity of the network numerous binding domains of the scaffold irs are neglected. the model only accounts for irs binding to the phosphorylated insulin receptor, subsequent irs phosphorylation and binding of the grb2-sos complex. in order to reduce the complexity of the model, receptor internalization and degradation is also neglected for both ir and egfr.

all considered molecules, processes and process interactions are also depicted in figure  <dig>  the reaction rules generating this complete mechanistic model are depicted in table  <dig> 

complete mechanistic model vs. exactly reduced model
a complete mechanistic model of the described network of egf and insulin receptor crosstalk comprises  <dig>  reactions and  <dig>  odes. according to the assumed process interactions the complete network can be parametrized by  <dig> kinetic parameters which can be seen in table  <dig>  the exact numerical value of these parameters does not play an important role in this context. the main purpose of this model is to illustrate the possibilities offered by the new reduction methods. hence, the model equations are normalized to relative concentrations. the overall concentration of the considered components egfr, ir, shc, grb <dig>  sos and irs are set to  <dig> percent. the kinetic parameters are chosen such that the model qualitatively shows the expected behavior. we will focus on time plots of the quantities , ,  and .

the complete mechanistic model can be generated by bionetgen or other similar rule-based modeling tools. this example was modeled using the software tool alc  <cit> . alc allows the generation of combinatorial network models and produces output files for both matlab and mathematica. one simulation run with the matlab integrator ode15s took several hours using an intel® xeon™ cpu with  <dig>  ghz and  <dig> gb main memory. the simulation can be sped up by providing an analytically derived jacobian matrix of the ode system. all non-zero elements of the jacobian matrix have been analytically calculated using mathematica and afterwards have been exported to matlab. the resulting simulation files have a size of over  <dig> mb, and a single simulation run still takes about half an hour. all files required to simulate the complete reaction network are provided in a zip-files .

an exactly reduced version of the crosstalk model was generated using the reduced order modeling approach we introduced above. the definition of molecules, processes and process interactions  is already given in the previous model definition section. the process interaction graph corresponds to the arrows drawn in figure  <dig>  in order to get comparable results for all occurring binding and phosphorylation processes each of them was chosen as output process . the process interaction graph of the considered system can be dissected into four subgraphs . until now this step has not been automatized but an automatization would be possible. each subgraph describes one intracellular binding domain either of the egf or the insulin receptor. however, due to the multifunctionality of the grb <dig> binding domain all four subgraphs comprise the grb2-sos binding process as well as the serine/threonine phosphorylation of sos. consequently, the four subgraphs have to be simultaneously modeled and all species have to be simulantiously balanced. we use the modeling tool alc to model the four submodels  <cit> . the input file with which alc generates the odes is provided as additional file . a link to a downloadable version of alc can be found in koschorreck et al.  <cit> . the resulting model comprises  <dig>  reactions and  <dig> odes which already is a significant reduction compared to the complete model. a further reduction can be achieved by transforming the model to the previously introduced occurrence levels and subsequent elimination of redundant, unobservable and uncontrollable system dynamics . these steps have been performed using mathematica. the mathematica code can also be found in the additional files section . the final and exactly reduced model of the network consists of  <dig> odes, which can be divided into six unidirectionally coupled modules. one of these modules, which consists of four odes, describes egf binding and egfr homodimerization. another module specifies insulin binding to the insulin receptor and comprises two odes. six odes are required to model ir phosphorylation at the irs domain and subsequent irs binding. shc binding to egfr as well as ir and the related domain phosphorylations form another module with a total number of  <dig> odes. the largest module consists of  <dig> odes and describes grb <dig> binding to the egf receptor as well as to phosphorylated shc. the last module comprises all variables describing sos binding and sos phosphorylation and consists of  <dig> odes. one simulation run of this exactly reduced model only takes a few seconds. the size of the simulation file is  <dig>  kb . in figure  <dig> it is shown that both models also provide exactly the same results for the considered output variables.

CONCLUSIONS
mathematical models of biochemical reaction networks play an increasing role in cytological research. most of the underlying reaction networks are far too complex to facilitate an intuitive understanding. in this contribution, the focus is on ode based dynamic modeling of receptor mediated signal transduction in mammalian cells like insulin or epidermal growth factor  signaling. these networks share some common features. ligand binding to a receptor triggers conformational changes that facilitate receptor dimerization and/or phosphorylation of numerous residues. the subsequent formation of multiprotein signaling complexes on these receptors and their scaffolding adaptor proteins initiates a variety of signaling pathways. the main problem that occurs in modeling these networks using common modeling strategies is the enormous number of feasible multiprotein species and the high complexity of the related reaction networks. the main contribution of this work for ode based modeling of signal transduction pathways is the extension and further development of an existing model reduction technique and the introduction of a reduced order modeling technique that allows to generate manageable reduced models accounting for the dynamic effects of combinatorial complexity.

for common in- and output signals the number of unobservable and uncontrollable model states depends on the occurring process interactions and is usually fairly high for a complete mechanistic model. the elimination of uncontrollable and unobservable state variables can be achieved by a linear and hierarchically structured state space transformation, which additionally facilitate a modularization of the model equations. due to the enormous size of many real signaling cascades the generation of a complete mechanistic model and its subsequent reduction is not practical. an alternative approach is directly based on the process interaction pattern of the regarded system. all occurring process interactions can be integrated in an interaction graph which is subsequently dissected into independent interaction subgraphs. this exact reduced order modeling technique is used to generate a reduced model of egf and insulin receptor crosstalk. this method allows to fairly reduce the complete mechanistic model with  <dig>  odes to solely  <dig>  simulation studies show that the reduced model has exactly he same input/output behavior than the complete mechanistic model.

thus, the results of this contribution provide new and powerful tools for dynamic modeling of combinatorial reaction networks like they occur in signal transduction. the introduced reduction techniques facilitate the generation of fairly reduced and modularized dynamic models. the modular structure of the resulting models also reduces the complexity of parameter estimation. furthermore, the availability of an alternative reduced order modeling approach also facilitates the handling of very large and complex signaling networks. this property is of immense practical relevance since most real signaling cascades are too complex to be translated into a complete mechanistic model which is subsequently reduced.

authors' contributions
hc and df developed the mathematical methods. hc designed and analyzed the discussed examples. edg initiated, supervised and coordinated the project. all authors wrote the manuscript and approved the final version.

supplementary material
additional file 1
matlab simulation files for the complete  <dig>  ode model of egf and insulin receptor crosstalk.

click here for file

 additional file 2
alc input file to generate an exactly reduced version of the egf and insulin receptor model.

click here for file

 additional file 3
transformation of the alc generated model according to the proposed approach and subsequent elimination of redundant information.

click here for file

 additional file 4
matlab simulation file for the reduced ode model of egf and insulin receptor crosstalk.

click here for file

 acknowledgements
special thanks to michael ederer and markus koschorreck for numerous and fruitful discussions, to rebekka schlatter for carefully reading the manuscript. hc, and edg acknowledge support from the bundesministerium für bildung und forschung  within the framework of the initiatives hepatosys, quantpro and forsys. hc wants to dedicate his part of the work to his brother jochen .
