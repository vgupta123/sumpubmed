BACKGROUND
gene co-expression networks constructed from gene expression microarray data capture the relationships between transcripts  <cit> . from the point of view of individual genes , modules are groups of highly interconnected genes that may form a biological pathway. from the point of view of systems biology , functional modules bridge the gap between individual genes and emergent global properties  <cit> . here we view modules as basic system components  and describe their relationships using network language. we find that co-expression modules may form a biologically meaningful meta-network that reveals a higher-order organization of the transcriptome. we refer to modules in a meta-network of modules as meta-modules.

our analysis can be viewed as a network reduction scheme that reduces a gene co-expression network involving thousands of genes to an orders of magnitude smaller meta-network involving module representatives . we refer to the resulting network as eigengene network. using eigengene neworks, we will show that the information captured by co-expression modules is far richer than a catalogue of module membership.

as a motivating example, consider the comparison between gene co-expression networks in human and chimpanzee brains. using gene expression microarray data corresponding to different brain regions, oldham et al  <cit>  found relatively large modules that are preserved between human and chimpanzee brains. only one human brain module  was not preserved in chimpanzee brains. the original analysis focused on human modules and assessed their preservation in a corresponding chimpanzee co-expression network. we refer to such an analysis as a standard marginal module analysis since it simply determines whether a set of modules can be found in another network. here we pursue a more comprehensive analysis that not only quantifies module preservation but also determines intermodular preservation. we refer to modules that are preserved among data sets as consensus modules. in our applications, we show that two consensus modules may be highly related to each other in one data set but unrelated in another. inter-modular relationships are biologically interesting because changes in pathway dependencies may reflect biological perturbations.

in this work we present methods a) for finding consensus modules across multiple networks, b) for describing the relationship between consensus modules , and c) for assessing whether the relationship between consensus modules is preserved across different networks .

RESULTS
eigengene networks
many module detection methods identify groups of genes whose expression profiles are highly correlated. for such modules, one can summarize the module expression profile by one representative gene: the module eigengene. an intuitive explanation of module eigengenes is provided in figures 1c–e. specifically, we define the module eigengene as the first right-singular vector of the standardized module expression data . eigengenes of different modules often exhibit correlations which we use to define eigengene networks. figure 1a outlines our approach for constructing an eigengene network corresponding to the modules of a single gene co-expression network. we index the eigengenes by capital letters i, j,...; for example, ej denotes the  eigengene of the j-th module. we define the connection strength  between eigengenes i and j as

 aeigen,ij=1+cor <dig>  

thus, the eigengene network aeigen =  is a special case of a signed weighted gene co-expression network . we use a signed co-expression network because the sign of the correlation between eigengenes carries important biological information in our applications. we use a weighted gene co-expression network to describe the relationships between modules since this maintains the continuous nature of the co-expression information. examples of two different visualization methods of eigengene networks are shown in fig. 2c,d and 2e,h.

for the i-th module eigengene, we define the scaled connectivity  ci as mean connection strength with the other eigengenes:

 ci≡12+∑j≠icor <dig>  

where n denotes the number of module eigengenes. note that the scaled connectivity ci is close to  <dig> if the i-th eigengene has a high positive correlation with most other eigengenes.

the density d of the eigengene network is defined as as the average scaled connectivity :

 d≡1n∑ici=12+∑i∑j≠icor2n. 

the density d is close to  <dig> if most eigengenes have high positive correlations with each other.

meta-modules in a single eigengene network
since eigengenes form a network, one can use a module detection procedure to identify modules comprised of eigengenes. we refer to modules in an eigengene network as meta-modules. meta-modules may reveal a higher order organization among gene co-expression modules. we use average linkage hierarchical clustering to define meta-modules as branches of the resulting cluster tree . the resulting meta-modules are sets of positively correlated eigengenes.

differential eigengene network analysis
several recent works have described differential network analysis methods for gene co-expression networks  <cit> . here we propose methods for the differential analysis of eigengene networks. an overview is shown in figure 1b. we start by defining and detecting consensus modules, i.e., modules that are shared by two or more gene co-expression networks. consensus modules may represent biological pathways that are shared among the compared data sets. study of their relationships, represented by consensus eigengene networks, may reveal important differences in pathway regulation under different conditions. detection of consensus modules proceeds by defining a suitable consensus dissimilarity  and using it as input to hierarchical clustering. to compare the consensus eigengene networks  of two data sets whose adjacency matrices are aeigen and aeigen, we make use of the preservation network preserv = preserv, aeigen), in which adjacencies are defined as

 preservij=1−|cor,ej)−cor,ej)| <dig>  

here ei denotes the eigengene of the i-th consensus module in data set s. high values of preservij indicate strong correlation preservation between eigengenes i and j across the two networks. the scaled connectivity ci) is given by

 ci)=1−∑j≠i|cor,ej)−cor,ej)| <dig>  

and is close to  <dig> if the correlations between the i-th eigengene and the other eigengenes are preserved across the two networks. the density d) is given by

 d)=1−∑i∑j≠i|cor,ej)−cor,ej)|2n. 

larger values of d) indicate stronger correlation preservation between all pairs of eigengenes across the two networks. measures  are intuitive, descriptive measures for assessing the extent of preservation between networks. to arrive at a statistical significance level , one can use a permutation test . many statistical tests have been proposed to test for differences between correlations, e.g.,  <cit> .

application 1: differential eigengene network analysis of human and chimpanzee brain expression data
here we report results of our differential eigengene network analysis of human and chimpanzee microarray brain data. the microarray data were originally published in  <cit> . a gene co-expression analysis of these data is reported in  <cit> . to facilitate a comparison with the original marginal module analysis, we used the genes selected by that work. the data, r code, and more details of this analysis can be found in additional file  <dig> and on our webpage.

to find consensus modules, we used the consensus dissimilarity measure  and average linkage hierarchical clustering. genes of a given consensus module were assigned the same color, while unassigned genes were labeled grey. we found  <dig> consensus modules, shown in fig. 2a: black , blue , brown , pink , red , turquoise , and yellow . the functional enrichment analysis of these consensus modules is described below. for each data set, we represented the consensus modules by their corresponding module eigengenes and constructed an eigengene network between them .

the differential eigengene network analysis yields two main novel findings that could not have been obtained using a standard marginal method. first, we find that the relationships between the module eigengenes are highly preserved. figs. 2e and 2h show the eigengene networks aeigen,human and aeigen,chimp, respectively. it is clear that the human and chimp eigengene networks of consensus modules are highly preserved. as described in eq. , we defined a preservation network preservehuman,chimp = preserv between the  <dig> consensus eigengenes.

for each individual eigengene, we find that its relationships with the other eigengenes is highly preserved as reflected by a high connectivity in the preservation network : cred =  <dig> , cblack =  <dig> , cyellow =  <dig> , cturquoise =  <dig> , cpink =  <dig> , cblue =  <dig> , cbrown =  <dig> . we find a high overall preservation  between the two networks as reflected by a high density of the preservation network d =  <dig> . figs. 2f,g summarize our findings about the relationships of the consensus modules.

the second novel finding is that the consensus eigengenes in the human data set fall into three branches , see fig. 2c. the first meta-module consists of the red, black, and yellow eigengenes; the second meta-module contains the turquoise eigengene; and the third meta-module contains the pink, blue and brown eigengenes. remarkably, these  <dig> meta-modules can also be detected in the chimp data, see fig. 2d. while the definition of consensus modules trivially implies that they are preserved between the two data sets, it is a non-trivial result that in this application the meta-modules are preserved as well. 

to understand the biological meaning of the consensus modules, we studied differential expression of the consensus module eigengenes across the brain areas from which the microarray samples were taken. the results are summarized in fig.  <dig> which shows the t-test p-values of differential expression of module eigengenes in the various brain regions from which samples were taken. clearly, eigengenes can be characterized by their differential expression patterns in different brain regions. furthermore, this analysis allows a biologically meaningful characterization of the meta-modules. the first meta-module  represents  <dig> genes that tend to be differentially expressed in the caudate nucleus. the second meta-module  represents  <dig> genes that tend to be differentially expressed in cerebellum. the third meta-module  represents  <dig> genes that are differentially expressed in the cortical samples. thus, the meta-modules of this application correspond to biologically meaningful super-sets of modules and genes.

given the strong relationships between modules in each meta-module, it is natural to ask whether the consensus modules are truly distinct. for example, the black and red modules show very similar levels of differential expression, see fig. 2b. in this case, gene ontology information suggests that the two modules are indeed distinct. the black module is enriched with white matter related genes while no such enrichment can be found for the red module  <cit> . likewise, gene ontology suggests that the yellow and black modules are distinct even though their module eigengenes are correlated.

in summary, the eigengene network analysis reveals a higher order organization of the consensus modules in the transcriptome.

comparing our findings to a standard marginal module analysis
a standard approach for comparing the modules between several network is to identify modules in a 'reference' network and to study the preservation of the module assignment in the other networks  <cit> . in the original analysis, oldham et al chose the human gene co-expression network as reference network since both preservation and non-preservation of human modules was of interest. this marginal module analysis is appropriate when the modules of one data set are the focus of the analysis but it is not designed to identify consensus modules that form the focus of our article. to compare differential eigengene network analysis analysis to the standard marginal module method, we compared our consensus modules to the  <dig> human modules found in  <cit> . we used a pairwise fisher exact test to determine whether there is significant overlap between the consensus and the human modules. the results are summarized in additional file  <dig>  overall, we find good agreement between consensus modules and human specific modules, which reflects the fact that most human modules are preserved in chimpanzees. most of the human modules can be assigned to a consensus module and vice-versa, except for the human blue  and green  modules which mostly disappeared from the consensus. interestingly, small remnants  of the two modules form the majority of the only consensus module  that does not have a clear human counterpart. another small remnant  of the human blue module forms most of the consensus blue module .

the green and blue human modules were found to represent mostly cortical samples  and were the least preserved in chimpanzees  <cit> . this is congruent with our finding of their lack of conservation using the consensus module method. one possible explanation for the absence of these modules in chimpanzees is that they largely reflect gene expression in the cerebral cortex, a brain region that has expanded dramatically in the human lineage. the standard marginal differential network analysis also identified several genes – ldoc <dig>  eya <dig>  lect <dig>  pgam <dig> – whose connectivities  were significantly lower in the chimp network. none of these genes are present in our consensus modules, providing additional evidence of the method's agreement with the results of  <cit> .

by definition, the consensus module detection is designed to find modules that are shared between data sets. obviously, there will be many applications where data set specific modules are of interest. in such applications a standard marginal module detection analysis will be preferable.

application 2: differential eigengene network analysis of four mouse tissues
we analyzed gene expression data obtained from female mice of an f <dig> mouse intercross  <cit> . the microarray data measured gene expression levels in four different mouse tissues: liver, brain, adipose and muscle. more details concerning the data are presented in additional file  <dig> and on our webpage. the consensus dissimilarity ) was used as input to average linkage hierarchical clustering. in the resulting dendrogram, consensus modules were identified by the dynamic tree cut branch cutting method  <cit> . we found  <dig> consensus modules : black , blue , brown , green , green-yellow , magenta , pink , purple , red , turquoise  and yellow . functional enrichment analysis of these modules is presented below.

figures 3f,k,p, and 3u show the eigengene networks aeigen,brain, aeigen,muscle, aeigen,liver, and aeigen, adipose, respectively. to assess the preservation of consensus modules across pairs of tissues, we defined preservation networks , e.g., preservmuscle,adipose = preserv. we find the following overall preservation values between the eigengene networks: d =  <dig> , dbrain,liver =  <dig> , dbrain,adipose =  <dig> , dmuscle,liver =  <dig> , dmuscle,adipose =  <dig> , dliver,adipose =  <dig> . hence, at the level of tissues, we observe good preservation between the consensus eigengene networks with highest preservation between the brain and muscle tissues. interestingly, these two data sets also show the strongest relationships between the eigengenes in each data set . this can be measured by the density of the absolute values of me correlations, dcor ≡ d|). for the muscle and brain network we find dcor,muscle =  <dig>  and dcor,brain =  <dig> . the eigengenes in liver show, as a data set, relationships somewhat similar to those of brain and muscle, though the patterns in the heatmap plot are not as strong, dcor,liver =  <dig> . the adipose tissue shows the weakest relationships between the module eigengenes, dcor,adipose =  <dig> . the eigengene preservations, e.g., cred can be found in fig.  <dig>  in the upper triangle of the matrix of plots f-u.

as an aside, we mention that pairwise network preservation measures are directly comparable only when the compared preservation networks involve the same set of consensus eigengenes, as is the case in this four-tissue application.

we find that the eigengene networks contain meta-modules, i.e., groups of highly correlated eigengenes . as an example, we focus on the meta-modules in the brain eigengene network. as can be seen from fig.  <dig>  the consensus eigengenes in brain tissue form  <dig> meta-modules that are partially preserved in the other tissues. specifically, the first brain meta-module consists of the black, blue, magenta, and red consensus eigengenes. it is highly preserved in muscle and adipose but less so in liver. the second brain meta-module consists of the green-yellow, pink and yellow consensus eigengenes. this meta-module is highly preserved in muscle and liver but less so in adipose. the third brain meta-module consists of the turquoise, green and purple eigengenes. it is highly preserved in liver and adipose but less so in muscle. these results show that meta-modules may or may not be preserved across the different eigengene networks.

to understand the biological meaning of the consensus modules, we used functional enrichment analysis using gene ontology information  <cit> . the detailed results including alternative methods for adjusting for multiple comparisons can be found in the functional enrichment table presented in additional file  <dig>  overall, we find that most modules are significantly enriched with known gene ontologies. specifically, the black module is highly enriched with ribosomal genes ; the blue module with immune/stimulus/defense response ; brown with translation regulator activity  and nucleotide binding ; magenta with stimulus/defense response  and signal pathways ; red with cell cycle  as well as nucleotide/atp binding ; turquoise with protein binding ; yellow with carbohydrate metabolism ; pink and green-yellow with protein localization , and green with alternative splicing/intracellular organelles .

our method detected two protein transport and localization modules  and one may ask whether these modules are truly distinct. the two modules are closely related in  <dig> of the  <dig> data sets, but in the adipose tissue they have a weak  correlation of - <dig> . hence, from the consensus point of view, they are two distinct modules. further, note that the green and black modules are very close on the consensus dendrogram, and their module eigengene  correlation is high in absolute value but negative. the functional enrichment analysis suggests that the modules are different, although some terms are related ; this is an indication that the sign of the correlation of eigengenes is biologically meaningful.

while a standard marginal module analysis would succeed in studying preservation of individual data set modules, the consensus eigengene module analysis allows us to find shared modules and to study higher-order relationships between the consensus modules. meta-modules in the brain tissues indicate the following relationships: the first  suggests a relationship among ribosomal, immune/defense/stimulus response and cell cycle pathways; the second  between protein localization and carbohydrate metabolism; the third  among protein binding and alternative splicing/intracellular organelle pathways.

the data also include clinical trait information on the mice , and one can ask whether some of the consensus modules  relate significantly to any of the traits. we find no significant correlation between consensus module eigengenes and the traits. in application  <dig>  we report significant relationships between consensus modules and clinical traits.

permutation test of consensus module membership
we used the data from the brain and muscle tissues to perform a permutation test  of consensus module detection. we defined the combined number of genes assigned to consensus modules as test statistic. this test statistic was highly significant , which shows that the number of genes in the consensus modules was highly significant. however, this results depends on the level of stringency for defining consensus modules. fig.  <dig> shows that as the height cutoff for the detection of branches in the consensus dendrogram increases, the probability of finding spurious consensus modules  increases; for excessively high branch cutoffs levels, the probability of finding as many genes in permuted data sets as in the unpermuted becomes unacceptably high.

application 3: consensus modules across female and male mouse liver tissues
here we apply the differential eigengene network analysis to liver expression data from female and male mice of the above-mentioned f <dig> mouse intercross. the consensus module detection method identified  <dig> consensus modules, shown fig. 5a: black , blue , brown , green , green-yellow , magenta , pink , purple , red , salmon , tan , turquoise , and yellow . overall, there is excellent preservation between the female and male eigengene networks, d =  <dig>  . the module eigengene dendrograms in figs. 5b,c as well as at the eigengene network heatmaps in figs. 5d,g indicate that the two data sets share three meta-modules. the first one contains the blue and turquoise modules , the second one contains the green, magenta and pink modules , and the third one contains the black, brown, tan, green-yellow and red modules .

the experimental data include clinical traits such as mouse body weight, cholesterol levels, etc. as detailed in additional file  <dig>  we selected  <dig> potentially interesting traits. figs. 5h,i present the correlations and corresponding p-values for relating the clinical traits to the module eigengenes. we find that the turquoise module  is highly significantly correlated with weight in both the female  and male samples . the greenyellow module  relates to weight with comparable correlations, r = - <dig>   and r = - <dig>   in females and males, respectively. the yellow module is significantly related to insulin levels in both the female and male data sets, r =  <dig>   and r =  <dig>  , respectively. the correlation between the eigengenes of the consensus turquoise and greenyellow modules are - <dig>  and - <dig>  in the female and male samples, respectively; the module eigengenes are relatively close by absolute value of the correlation, but the sign difference suggests that they distinct. this result is another motivation to use signed networks  to describe the relationships between eigengenes.

given that the female and male networks appear similar but not the same, one may ask whether the consensus module analysis provides an indication of how they differ. for this purpose we compared the female liver module assignment as reported in  <cit>  to our consensus module assignment, see additional file  <dig>  using the same parameters for the clustering and branch detection, we found that two of the  <dig> modules  in that work are not represented in the consensus modules. investigating the function of these two modules is beyond the scope of this work.

simulation studies of consensus modules
to assess the performance of the consensus module detection method, we performed a simulation study involving two simulated gene expression data sets. the two data sets contained both shared and non-shared modules. the actual simulation procedure is described in more detail in additional file  <dig> and the r code can be found on our webpage.

briefly, each simulated module is built around a chosen seed profile  by adding gene expression profiles with increasing amount of noise. we studied the performance of consensus module detection under varying levels of added noise. the sensitivity and specificity are determined from the numbers of true and false positives  and true and false negatives  as sensitivity = ntp/, specificity = ntn/. to measure the fidelity of the calculated module eigengenes to the true module eigengenes, we report the proportion p <dig>  of the detected modules whose eigengene has a correlation greater than  <dig>  with the true module eigengene, i.e., fidelity = p <dig> . results of the simulation are  summarized in table  <dig>  we found that when noise is low and modules are very clearly defined, the sensitivity, specificity, and fidelity are 100%. it is worth noting that for low and moderate noise levels, the fidelity does not vary substantially with changes in the branch cut height, indicating that module eigengenes are robust to inclusion/exclusion of moderate numbers of genes in the module. as the noise increases, sensitivity, specificity, and fidelity decrease. we note that the specificity and sensitivity depend on the choice of cutting parameters for the cluster trees. we have not performed an exhaustive search to identify parameter values that would give optimal performance. our default settings perform well across a range of different simulation models.

discussion
we propose the use of eigengene networks to study the relationships between co-expression modules. eigengene networks will be useful for any module detection method that leads to modules of highly correlated genes. while eigengene networks can easily be adapted to other co-expression module detection methods, we define them within the framework of weighted gene co-expression network analysis since this framework preserves the continuous nature of the co-expression information and leads to robust results  <cit> . our empirical applications illustrate the kind of novel questions that can be addressed with eigengene networks. we find that modules can be organized into meta-modules that can be biologically meaningful and interesting.

eigengene networks can naturally be integrated with other types of quantitative data. for example a microarray sample trait t  can be included as an additional node of the eigengene network. the adjacency between an eigengene ei and the sample trait t can be defined as aeigen,i,t = )/ <dig>  generalizing eq.  . eigengenes that are adjacent to a clinical trait may correspond to pathways  that are associated with the clinical trait. we illustrate this point in our third application involving female and male mouse liver data, in which we analyze the relationship between consensus modules and clinical traits.

eigengene networks can be used for describing module relationships in a single data set  or they can be used to compare module relationships across different data sets . to facilitate differential eigengene network analysis, we propose methods for finding consensus modules. our approach for detecting consensus modules relies on a consensus dissimilarity measure  that compares topological overlap matrices of different data sets. in our applications, consensus implies that the modules are present in all data sets . in other applications, it may be preferable to relax this stringent requirement and look for 'common' modules instead. for example, if the number of studied data sets is large , the robustness can be increased by replacing the minimum by a suitably chosen quantile . details of such a generalization are presented in methods.

since we define the consensus topological overlap as a minimum , a bias will result if the topological overlap of one network tends to be higher  than that of the other data sets because of non-biologic reasons including different microarray platforms, gene expression normalization methods, or different sample sizes. to address this potential bias, one can scale the individual topological overlap matrices or adjacency matrices. alternatively, we describe a highly robust but less sensitive method for defining consensus modules in the methods . in brief, this robust method defines modules in each of the individual data sets and defines consensus modules by keeping track of shared module membership. module detection depends on several parameters choices, e.g., how to cut off branches of a hierarchical cluster tree. in practice, it is advisable to carry out a robustness analysis with regard to the module definition. for example, the reader can use the r code published on our web page to verify that our findings are relatively robust. since the module eigengene  represents a suitably defined average gene expression profile, it is highly robust with regard to moderate changes in module membership. we find that the consensus eigengene network construction is highly robust and it has high sensitivity and specificity in our simulation studies.

CONCLUSIONS
we find that eigengene network methods lead to mathematically robust and biologically meaningful results. we provide three microarray data applications illustrating that eigengene networks effectively represent module relationships. studies of inter-modular relationships may reveal changes in pathway dependencies due biological perturbations.

