BACKGROUND
high throughput experimentation such as gene expression microarrays, next generation sequencing or proteomics enables the interrogation of many thousands, or even millions, of data points simultaneously. comparison between these experiments  enables identification of gene or protein sets of interest in a hypothesis free manner. to stimulate generation of testable, explanatory hypotheses for experimental validation from these sets of genes, researchers will often apply gene set enrichment analysis   <cit>  or concept enrichment analysis using controlled vocabulary terms. term enrichment analysis, which refers to the search for ontology terms that occur more in a given gene list when compared with a background gene set, can be used to generate new scientific hypotheses. gene ontology   <cit> , arguably the most commonly used ontology in basic research, consists of a collection of three non-overlapping controlled vocabularies that describe molecular functions, biological processes and cellular components. there are now more than  <dig> go-based enrichment analysis tools available. examples of such functional analysis tools are bingo  <cit>  or goeast  <cit>  , which solely utilize gene ontology  for their analyses. other approaches, such as cluego  <cit> , david  <cit>  and geneweaver  <cit> , incorporate larger range of sources, such as disease ontologies, phenotype ontologies or common pathways. however, all of them rely on predefined gene annotations and thus are limited to biomedical domains that have curated annotations. baumgartner, et al. <cit>  presented an analysis that demonstrated how manually curated annotations can never keep pace with novel scientific discoveries, and argued that text-mining based methods need to be adopted to keep pace with the rising volume of literature. for example, an incredible amount of established knowledge about genomes and proteomes is available through ncbi entrez gene  <cit>  and uniprot  <cit> , but the concepts mentioned in the textual descriptions of genes and proteins in these resources are not part of any statistical enrichment analysis. we believe in a hybrid approach of testing manually curated terms along with automatically recognized concepts from curated text will result in more hypotheses and therefore be more useful to the researcher.

large-scale annotation of all the known genes and expressed proteins in an organism’s genome is a complex and arduous task. to this end, biology and medicine have created and manage discipline-specific structured ontologies that are suitable for gene or protein annotation. although these ontologies are publicly available, for instance via the national center for biomedical ontology  <cit>  or the ebi ontology lookup service  <cit>  and provide valuable information about connections between different biological concepts, only a small fraction of these ontologies are used for gene and protein annotation and therefore a relatively small amount of annotations are actually available for use in enrichment analysis methods.

the quality of results from term enrichment analysis is naturally dependent on the quality of the annotations underlying the analysis. therefore term enrichment analysis should only use high quality annotations, such as the human-curated annotations from ingenuity pathway analysis   or from a highly restricted subset of go of experimentally validated and published annotations. however, many genes do not have annotations of this quality, and therefore the results of enrichment analysis can be highly incomplete. on the other end of the spectrum, including automated annotations based on criteria such as computational prediction using sequence similarity would result in a richer but less accurate set of annotations and hence less reliable results from term enrichment analysis. in this paper, we propose a middle ground that combines high quality human-curated gene descriptions with automated assignment of annotation terms based on those descriptions. we use the stanford national center for biomedical ontology  annotator  <cit> , which provides annotations with terms from over  <dig> publicly available biomedical ontologies, to automatically annotate a gene or protein based on the corresponding entrez gene or uniprot textual description. the text description is used as the basis on which the ncbo annotator provides ontological terms that could annotate the gene or protein

we find that automated annotations generated in this manner reliably recover the known annotations already present in the text record , and we find that we are able to annotate with a wide spectrum of concepts not available in any currently used ontology enrichment tools. additionally, we are able to identify go terms that are present in curated text that are not currently formerly annotated to these genes or proteins, and many of these examples are bona fide annotations. overall, our approach is able to annotate proteins with  <dig>  terms from across  <dig> ontologies; and a vast majority of these terms are not part of the go.

in the following, we will demonstrate the advantages of using automatic annotations that are based on manually curated textual descriptions, by extending our previous ransum approach  <cit>  to enable analysis of genes and protein concepts. we will first describe the stop workflow, which allows a researcher fast and easy statistical analyses of gene sets using up-to-date information of genes and proteins from the most widely used model organisms and human. we will further demonstrate how automatically derived annotations contain valuable information that is not currently present in the go, without diminishing the value of manually curated go enrichment analysis. therefore, we compare our annotations against go and highlight examples of gene-to-term annotations that are likely to be correct but not present in official go annotations. finally we describe two use-cases:  proteins that are direct protein interaction partners of the huntingtin protein and  known parkinson’s disease genes. we use these sets of proteins to demonstrate how stop can reveal interesting enriched concepts that improve the understanding of functional traits implied by gene sets.

RESULTS
term enrichment with automatically derived annotations
here, we present stop , a web resource that utilizes automatic annotation and term enrichment analyses to generate novel insights into common traits of sets of genes. in contrast to commonly used tools for the task of gene set enrichment analysis, stop does not limit itself to predefined annotations and a few controlled vocabularies, but uses up-to-date information  about genes to map them to terms from all  <dig> ontologies provided by the national center for biomedical ontology . results from an analysis with stop annotations are presented in a web interface that allows easy navigation and identification of concepts that summarize the input set of genes; thus helping researchers interpret and understand experimental results to create novel hypotheses.

the computational pipeline underlying the stop backend as well as the real time enrichment analysis provided by the stop frontend via a web interface are explained graphically in figure  <dig> 

we implemented a fully automatic import process that can be executed at very frequent intervals  to always provide the latest, state-of–the-art information about genes. this process of populating our local database includes:

 <dig>  collecting all genes and proteins in the genome/proteome of the  <dig> widely used model organisms mus musculus, rattus norvegicus, drosophila melanogaster, caenorhabditis elegans, saccharomyces cerevisiae and escherichia coli and homo sapiens via uniprot and ncbi entrez gene .

 <dig>  search, download and filtering of descriptive text for each gene/protein using ncbi entrez gene and uniprot.

 <dig>  annotation of the genes/proteins to terms from all ontologies currently present in the ncbo bioportal database, using the annotator web service.

stop currently uses over  <dig> , <dig> annotations of  <dig>  genes and  <dig>  proteins from  <dig> organism  that come from  <dig>  terms across  <dig> ontologies. the included ontologies can provide general information as in go and nci thesaurus  <cit> , or can be more specific as, for instance, in the disease ontology  <cit> , pathway ontology  <cit> , or human phenotype ontology  <cit> .

stop has been optimized for fast processing to compute and display enriched terms from  <dig> ontologies in a matter of seconds. the resulting term list can still be overwhelming. therefore, we:  remove redundant information by combining terms with the same name;  implement filtering methods that can display results from selected ontologies, ontology categories, or terms that match user specific key words;  identify a list of  <dig> highly informative ontologies that can be accessed as “preferred” using the ontology category filter;  visualize the enriched terms as a sorted table or term cloud. we further ease usage of our web interface by utilizing all gene identifier mappings for genes and proteins as available from ncbi entrez gene and uniprot respectively. to use stop a researcher simply has to:  copy + paste their list of genes or protein ,  select the species, the background set of genes and the multiple-hypothesis correction method from drop-down menus, and  press the submit button. the stop web interface is available at http://mooneygroup.org/stop.

comparing gene ontology with automatic annotations
as go is still the standard ontology when analyzing gene sets for their functions, we compared the official go annotations to those we automatically derive within stop for this ontology. we obtain the gold standard go annotations for proteins from uniprot and for genes from entrez gene . we further compared gene-based annotations with annotations from the respective species-specific databases: goa  <cit>  , flybase  <cit>  , wormbase  <cit>  , rgd  <cit>  , sgd  <cit>  , ecocyc  <cit>  and mgi  <cit>   obtained via http://www.geneontology.org. the results are slightly lower in recall and precision, probably due to database differences between entrez gene and the species-specific sites. in this analysis we consider each gene in our background that is also found in go, i.e. genes that have at least one go term annotation. for each such gene we calculate precision and recall and determine the average of these values to evaluate the overall equality between these two approaches. the precision for one specific gene is the ratio of go terms that are annotated in both the gold standard and our annotation to that gene  divided by all annotations that we predict for this gene . the average precision for an organism is the average of all precision for all genes in that organism. as expected we achieve high recall values ranging from  <dig>  to  <dig> for the different species except e.coli. when comparing our annotations with e.coli we see big differences, which seem to be rooted in the limited go annotations that are present in entrez gene  for e. coli. the generally high recall values are due to the fact that go terms are part of the text that comprises our input for the annotation process. missing terms are easily explained by different versions and changes in go. the lower precision shows that stop finds several novel annotations that are currently not in go and thus are counted as false positives in this evaluation. we find however, that along actual false positives many of these new annotations make sense and probably should be included in go, see below for some examples. for the annotation process we integrated go annotations from uniprot and entrez gene while the comparison has been performed on the most recent version obtained from uniprot goa, entrez gene and http://www.geneontology.org/.

the results  show that for most genes we identify already known go terms and add several annotations that are not present in the manual annotations. we found several examples where genes or proteins have functions associated with them that are only described in uniprot/entrez gene but are not yet associated with relevant go terms. one example is the human protein liver carboxylesterase  <dig> . stop associates this protein with the go term ‘cocaine metabolic process’ . this association is not listed on the go annotations website. this association was identified from a title for a reference paper for the protein, “structural basis of heroin and cocaine metabolism by a promiscuous human drug-processing enzyme”  <cit> . another example can be found in the c. elegans protein  atp-dependent clp protease proteolytic subunit  <dig>  mitochondrial. stop annotated this protein with the go concept mitochondrial unfolded protein response’ , however this concept was not in the go annotations. the concept was identified from one of the references associated with this protein, “clpp mediates activation of a mitochondrial unfolded protein response in c. elegans”  <cit> .

annotations based on entrez gene descriptions are compared against the gene2go annotations from entrez gene and species-specific databases where the annotations have been downloaded from http://www.geneontology.org, and stop annotations based on uniprot descriptions are compared against goa annotations. recall and precision are calculated for each gene and subsequently averaged. the f-measure is the harmonic mean of these average recall and precision values.

using stop to improve understanding of huntington’s disease
in order to assess the functional utility of stop, we selected a set of proteins from the human protein reference database  that are known to directly interact with the human huntingtin gene   <cit> . htt is of particular interest in neurodegeneration because it is prone to polyglutamine expansion, the degree of which correlates to the severity of the development of huntington’s disease, a devastating neurodegenerative disease. the list of interacting proteins, which is stored on the gene level in hprd, consists of  <dig> genes  serves as a test case for stop here . since the interactions are on the protein level uniprot/swissprot ids were used in the analysis, and the swissprot human database was used as the background for the enrichment analyses. as an additional point of comparison, the same list of proteins was submitted to david and all enriched gene ontology  annotations were retrieved using the “go_all” database. the analysis using david returned a typical list of enriched go categories . among the terms that can be associated directly with what is known about huntington’s disease were for example protein complex assembly, induction of apoptosis and terms associated with cell death. biologically, each of these terms describes at least some part of what little is known about the function of htt. however, these  don’t give much information about the gene set as a whole. if, for instance, one were to submit this gene list not knowing how or if the genes had any shared biological relevance, the results of the go enrichment analysis would be difficult to interpret and would likely not contribute to the understanding of the dataset.

when the htt ppi gene list was analyzed using stop, the results were more diverse. for the purposes of this test case, the results of the stop enrichment analysis were filtered using only terms from the “preferred” ontologies , which helps to refine the output to more biologically useful annotations . in this case, the top  <dig> enriched annotations include terms similar to those in the go analysis such as protein binding or cellular component organization. however, the results also include more descriptive terms such as huntington’s disease, huntingtin, transferases, drug interaction, and solute carrier family  <dig> . thus, the stop analysis correctly identified this gene list as being associated with huntington’s disease, neuron-related processes, and specific disease pathways . it is important to note that the htt gene was not a part of the submitted gene list in either analysis.

application of stop to parkinson’s disease
to further validate the utility of stop, we applied it to genes and proteins associated with parkinson’s disease . all proteins in uniprot that are associated with pd were identified in the phenopred resource  <cit> , resulting in  <dig> human proteins . stop was applied on this list resulting in many enriched terms using benjamini-hochberg for correction of multiple hypotheses and uniprot/swissprot as background . not surprisingly the top term was parkinson’s disease , which was found in  <dig> ontologies . other terms included basal ganglia diseases , tremor , movement disorders , substantia nigra , brain diseases , age , dopamine , neuron , and many others. all terms appear to be relevant, with possible false positives been related largely to other neurodegenerative diseases such as alzheimer disease  or spinocerebellar ataxia  <dig>  n expansion . less significant are terms associated with pathology but are too general to be useful such as lab  or patients .

discussion
some ontological annotations don’t make scientific sense, for example, human genes and proteins that are automatically annotated with terms from the c. elegans phenotype ontology. given that, the philosophy of our approach was to capture the widest possible number of term annotations, in a hypothesis-free manner, regardless of the source. since all examination of these annotations is through statistical enrichment, we believe that falsely discovered annotations will not be statistically enriched after multi hypothesis correction. users, of course, are allowed to select out any term sets in real time on the website, preventing the presence of spurious terms.

using automated annotations derived from text can, however, lead also to false positive annotations. an example we observed, was that results for protein sets that were obtained from interaction data often had the terms, “mint”, “menthol”, and “vascular plant” enriched. we could trace this to the interaction database mint  <cit>  which was part of the descriptive text of all proteins, that had an interaction stored in that database. as a consequence we exclude common database names from the gene descriptions. on the other hand, unrelated terms can have a true meaning that can only be detected with automated text-based methods. in an analysis of a set of genes that are involved in parkinson’s disease, we observed the term “australia” as enriched . originally assuming this to be a false positive we identified the source as a research group in australia that is leading in parkinson’s research due to a highly cited manuscript with australia mentioned in the title. although not biologically relevant, this example shows that automated annotations are capable of detecting relations that would otherwise remain undetected.

due to the import process, the stop application completely depends on the ontologies that are made available through and the annotator web service that is provided by ncbo. however, the ncbo constantly expands their database of available ontologies and adds mapping information between terms of different ontologies. stop takes advantage of this growing resource by regularly re-annotating  the list of genes with up-to-date gene descriptions.

interestingly, we found that in many cases proteins would be annotated with go terms that were not found in the gold standard go annotation database from the go consortium website. we pursued this and found that these annotations were often correct. while this is out of the purview of the stop method, it suggests that curators would do well to identify term text and fold them into their own annotations.

CONCLUSIONS
we have constructed a tool that substantially broadens the hypotheses that can be generated with enrichment analysis using automatically created annotations. we find that these annotations are able to identify existing known concepts in the text. users can download our species specific annotation datasets and perform enrichment analysis on our website with a list of gene and protein ids. enriched and depleted terms can be filtered by ontology or ontology type. furthermore, annotations can be downloaded into a spreadsheet for later use. in the end, stop enables experimental research projects to identify hypotheses for gene and protein sets using a concept space that is far larger than go or omim, thereby improving their ability move high throughput experimentation to validation.

