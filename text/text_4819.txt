BACKGROUND
organisms influence their surroundings by taking up nutrients from the environment and excreting waste products in it. as earth is a closed system with respect to its chemical components, this leads to resource cycles. moreover, in doing so organisms may create a specific local environment for their offspring and competitors. from an ecological point of view these are rather basic observations, yet the overall consequences of such feedback between organisms and their abiotic environment on the evolution of a population, community and ecosystem are not well-studied.

one possible outcome of such organism-environment interaction is metabolic crossfeeding. crossfeeding is an indirect interaction between two or more species, usually microorganisms: it is often observed as the dependence between bacterial strains on each others metabolites. especially determining the ecological preconditions for such cooperative communities has received much attention. both experimentally  <cit>  and theoretically  <cit>  it has been shown that crossfeeding may evolve due to trade-offs in resource uptake and processing, but also simply through the excretion of secondary metabolites.

while crossfeeding and related experimental evolution studies  <cit>  have been done mostly in 'artificial' well-mixed environments, the last few years metagenomics has been shedding light on the interplay between microbial communities and their 'natural' local environment  <cit> . such whole-ecosystem views show various eco-evolutionary solutions on different spatial and temporal scales to nutrient processing  <cit> : shallow phylogenetic divergence, yet large ecological divergence in the human intestine  <cit> , generalist bacterial lineages performing carbon processing  <cit> , but also temporal and spatial specialization through resource partitioning among vibrionaceae strains in coastal waters  <cit> . closely related are analyses in evolutionary functional genomics. a striking example is the finding that many bacterial species contain only parts of the citric acid cycle, suggesting extensive metabolic cooperation among bacterial lineages  <cit> .

in this work we use a computational modeling approach to gain a more general, qualitative insight in the spatial and temporal dynamics and mechanisms of evolving organism-environment interactions. previous studies have shown the importance of an interplay between ecological and evolutionary processes. it plays a crucial role in the generation and turnover of ecological diversity  <cit> . in addition, the spatial locality of ecological and evolutionary processes has been shown to strongly influence the outcome and dynamics of evolutionary processes  <cit> . furthermore, evolving interactions via resources has been shown to facilitate niche creation and selection on an ecosystem level. stable genotypic and phenotypic diversity through resource partitioning was shown by  <cit> , while evolution of ecosystems as an example of multilevel selection was investigated by  <cit> . with respect to evolving interactions among individuals, it has been shown that this may lead to niche creation and ecological diversification  <cit> .

hence we include interlocking ecological and evolutionary processes and a spatial embedding of these processes. as we concentrate on the dual feedback between organisms and their  environment, we restrict interactions between individuals to competition for reproduction via nutrients. furthermore, motivated by metagenomic studies showing the dominant role of microbes in the process of nutrient, or resource, cycling  <cit> , resources can be altered according to a simple artificial chemistry that allows for cycling. schematically speaking, individuals reproduce by taking up a resource, processing it and excreting the resulting resource as waste. an environmental feedback is established, and by eating the environment changes and future feeding opportunities in the neighborhood are affected. importantly, a frustration arises as direct selection for resource processing can be antagonistic to the indirect selection for cycling resources. thus we have a simple evolving ecosystem, with the important feature that individuals determine how much fitness they derive from a resource and which waste product, that is new resource, they produce.

note that in contrast to studies on crossfeeding  <cit> , we abstract from reduction/oxidation and energy constraints in order to focus the analysis on the qualitative effects that organism-environment interactions have on the eco-evolutionary outcome. also, with respect to ecological studies on food webs  <cit> , our model leaves out any predatory or parasitic relationships between individuals.

in this model, we study the effect of indirect selection. we do this by varying two parameters: the spatial setting and the strength of direct selection. firstly, we compare local feedback to a null model that lacks this local feedback due to the mixing of individuals, yet still has cycling on a lattice-wide scale. secondly, we study the relative balance between direct selection for processing resources against indirect selection for cycling. we show that local feedback enhances indirect selection, as it allows individuals to shape their local surroundings. this results in evolutionary stagnation: resource distributions are more in equilibrium and resource cycling is slower than in the null model. furthermore, local feedback shows a long-term trend for independent, 'smart' individuals. individuals are adapted at cycling resources themselves, and do so with shorter cycles than individuals from the null model. as such, especially for relatively high indirect selection  we find single generalists dominating the population eventually. in contrast, the null model – with only a global cycling of resources – displays more turbulent resource dynamics both qualitatively and quantitatively, and a preferred evolution for cooperating, crossfeeding lineages. by shifting the balance of selection pressures by adjusting direct selection, we find similar changes in evolutionary behavior as for the two spatial settings. in both the local feedback and null model, low direct selection results in 'quiet' resource dynamics and an evolutionary trend for self-sufficient individuals. also, if direct selection increases, resource dynamics become more turbulent and crossfeeding lineages become a favored behavior.

thus strong indirect selection for resource cycling, both via local feedback and low direct selection, favors the evolution of self-sufficient individuals, while weak indirect selection, accomplished through only a global feedback and strong direct selection, leads to an ecosystem based resource cycling via crossfeeding lineages.

methods
we describe our model from a high-level perspective first, followed by several sections covering the details. central to the local and null model is the processing of resources: organisms have to evolve their regulatory network such that they gain energy from nutrients in the environment. as depicted in figure 1b, a resource is a bit string, and as an abstraction of metabolic activity an individual has to reproduce the bit string as a temporal output  pattern of its gene regulatory network. we name this a "bite". the example in figure 1b shows a bite of  <dig> bits. next, this bite determines both the fitness of an individual and what waste product is left in the environment: the bite is cut from the left of the resource and re-attached at the right side, effectively rotating the resource bit string.

thus we combine a model of genes and binding sites on a genome, that are translated into a regulatory network, with a very abstract approach to metabolic processing: processing a resource through a gene expression pattern in time. various chains of such resource processing steps reflect different paths of nutrient conversions, such as occurring in the microbial nitrogen cycle. for example nitrogen can be cycled through few, large steps: , or with intermediate metabolites: .

in both the local and null model, the above described interaction between organism and environment is embedded on a two-dimensional grid , where each grid site contains a single resource and at most one individual. given a grid site without an individual, the organisms in the  <dig> neighboring sites compete for the opportunity to reproduce and place a daughter in the empty site. this competition is based on how well each individual can process the resource at the empty site: the longer an individual's bite, the larger is its probability to reproduce. naturally, during reproduction mutations may occur .

as a consequence, in the local model a lineage of fit individuals shapes the resource distribution in its vicinity. this causes an effect over several generations with respect to what resources are available in the local environment and thus impacts the evolution of the local population or community. we compare such local change to the null model in which we remove this opportunity of shaping the local environment. in the null model we randomly relocate all individuals on the grid at the end of each time step. this leaves the process of local competition and reproduction in place, but destroys any phylogenetic relationship between neighboring individuals – in effect individuals are not located close to their parent anymore – and removes the multi-generational effect of a lineage establishing itself in a patch and shaping its local surroundings .

model description
grid
by default the grid is initialized with an identical resource at each site and a homogeneous population of size  <dig> . both the initial resource and individual have been randomly generated in advance and are reused in replicate runs. in addition to the argumentation in the introduction on the use of space, the grid allows for a computationally efficient method of competition among individuals and is biologically sound, as organisms virtually always live in a spatial system with a certain degree of locality.

with a standard grid size of  <dig> ×  <dig> and a fixed death rate per individual of  <dig> , the population size is on average  <dig> and approximately  <dig> new individuals are born each time step. note that in the null model, the individuals are mixed each time step, which means each individual is moved to a random location on the grid.

resources
a resource is a bit string of length n  and can be altered into another resource by rotation from right to left. a minimal rotation of zero bits returns the original bit string, as does the maximal rotation of n bits. thus the 'chemical universe' consists of n different bit strings, each a rotated version of another, with a total of n <dig> =  <dig> transitions or reactions between them. we identify each resource by the number of rotation steps performed on the original bit string. as a reference, the input bit string in figure 1b is the original resource used in the main results. furthermore, resources diffuse by margolus diffusion  <cit> , by default one diffusion step per time step.

genotype and network
the genotype of an individual is a single chromosome, on which genes with their binding sites are placed. from this chromosome a boolean threshold network is computed that can process resources. to this end each gene and binding site have a binding specificity: an integer number. the network is constructed by connecting genes with binding sites if their binding specificity is equal. thus all genes with specificity  <dig> bind to all binding sites with a specificity  <dig>  possibly connecting multiple source genes with various target genes. we allow for self-loops and parallel connections. there are three categories of genes: input genes , processing genes  and output genes . not having any output genes is lethal, the other genes are all optional.

resource processing by the network
resource processing is modeled as gene expression dynamics: genes have to be activated and inhibited to process a resource. first, the first  <dig> bits of the input string are assigned as starting states to the input genes by binding specificity. the rest of the genes are set to zero. as an example: all genes  <dig> are assigned the state of the fourth bit of the bit string. note that input genes may be deleted by mutations and the sensing of bits may thus be impaired. second, after some calculation steps  the task of the network is to reproduce the bit string as a gene expression pattern through time on its output genes. the state of the output gene is read and matched to the bit string. if there are multiple copies of the output gene, the output is considered 'on' if at least one of the output genes is 'on', else it is 'off'. as soon as a mismatch is detected, the network updating is stopped. we refer to the resulting stretch of matching output bits as a "bite". both the calculation steps and the expression output steps are done by updating the boolean network in parallel  <cit> . for a gene this is defined as:

  

with  the expression state of gene i at time t , wij the weight  of binding site j, and θi the threshold of expression of gene i . the network dynamics are performed in one simulation time step and the number of updates may vary from  <dig> to n +  <dig> depending on when a mismatch occurs.

reproduction
if no individual is present at a site, the neighbors compete for the empty site in order to reproduce and place a daughter at the empty site. the neighborhood nbh consists of the  <dig> adjacent sites, also known as a moore neighborhood. the competition consists of each neighbor trial processing the resource of the empty site as described previously. the fitness of an individual, f, is defined as

  

with l the length of bite, g the genome size , pen the genome size penalty coefficient, and σ the selection coefficient. from the fitness we calculate a relative fitness ri of each individual i in the neighborhood: ri = fi/∑j ∈ nbh fj. next, one is selected according to the fitness proportional selection scheme. reproduction consists of duplicating the chromosome, applying mutations and dividing into two daughters. subsequently one of the two daughters replaces the parent, the other is placed in the empty grid cell. and, the rotated resource  of the winner replaces the resource at the empty site.

mutations
on the genes and binding sites mutational events have been defined as follows. genes may  duplicate, which includes the accompanying binding sites,  be deleted, which also includes the binding sites of the gene,  have their expression threshold mutated to a random other threshold value, and  have their binding specificity changed to a random other value. thus the effect of a change of binding specificity may be that a lost gene is rediscovered.

binding sites may  duplicate, where a copy of a binding site is inserted in front of a random gene,  be deleted,  have their weight w changed from activating to inhibiting and vice versa,  have their binding specificity changed to a random other value. default rates of gene and binding site mutations are mentioned in figure  <dig> 

analysis
phenotype
for an individual we can calculate the bites it produces for each resource. this results in  <dig> bites, each in the range [ <dig>  64). next, we store the bite lengths in a vector, and we define this vector as the phenotype of an individual. a vector index corresponds to the number of rotation steps from the original resource. the phenotype is a measure of overall performance, as an individual is evaluated on only few resource in its lifetime.

network dynamics
if networks are allowed to continue generating output bits after the first mismatch with the input resource, repeating patterns of zeros and/or ones are observed. in other words, if we view a network as a dynamical system, it initially moves through a transient and then settles in a fixed point or cyclic attractor. per individual, we calculate the transients and attractors for all resources. next we group individuals by these network dynamics as a measure of diversity in the population. in addition, such dynamics allow us to examine how the different bites are generated. even if the phenotypes of individuals are equal, the network dynamics may be different.

phylogeny tracing
every individual has a unique identification tag and its parents' identification tag. we record these relationships, and in addition, we periodically log a sample of the population  and the entire population . this allows us to compute the 'true' ancestry of individuals in a phylogenetic tree, to correlate branching depth to phenotypes, and to display the evolution of various properties.

ecosystem
in order to visualize the ecosystem at a specific time point, we depict it as a network with resources as nodes and bites that transform one resource in another as edges. in the resulting figures the following ecological concepts are easily observed.

shortest cycle
the rotations of bit string resources leads to cycles. as we have n =  <dig> resources, a cycle of bites has a maximum length of  <dig> . it follows that shorter cycles have longer bites, which means higher fitness for the individuals involved. this brings us to the shortest cycle: the cycle that contains the smallest set of bites that cycles a set of resources, where each bite can be performed by at least  <dig> individuals at a time step.

crossfeeding
a special case of division of labor is crossfeeding: the shortest cycle is formed by the cooperation of multiple lineages. to be more precise: we compute the shortest cycle and take a 10% sample from the population . crossfeeding is present if the shortest cycle cannot be performed by a single group of phenotypically identical individuals, with the group having at least  <dig> individuals.

ecological simulations
the stability of crossfeeding is studied with so-called ecological runs. such runs are initialized with a population and accompanying environment – that is the resources on the grid – from a specific time point of an evolutionary run. in these runs we omit the mutational process and therefore eliminate much of the 'noise' generated by mutants and their aberrant bites.

RESULTS
due to the nature of resource processing  the ecosystem evolved to contain one or more, overlapping, cycles in which the bites neatly map onto each other. this optimization of resource cycling was selected for indirectly, and importantly, implied a frustration in the evolutionary process. this frustration is a crucial feature of the dynamics of our model: in the long run it can pay off to not increase the direct fitness, but to produce resources which the offspring or local community can process well. we refer to this secondary level of selection for a cycle of bites as indirect selection.

therefore in this study we do not focus on evolution as an optimization process of resource processing . instead, the emphasis of our studies is on long-term indirect selection, its effect on resource dynamics, and how evolution structures the ecosystem with respect to the population and the individual. we investigate this by varying two parameters: the spatial setting and direct selection. we compare the outcome of the local and null model, and we take  <dig> levels of direct selection . for each level we have performed  <dig> runs of both models . note that when direct selection is weaker, indirect selection can play a more important role. also, drift plays a larger role in this case, but for the values of σ used  the drift does not prevent adaptation. thus, we will refer to more direct and less indirect selection  when we simply change the level of direct selection.

the results are organized as follows. we shortly introduce both models, followed by a detailed view of what kind of individuals initially evolve and what the initial ecosystem looks like. next, we study population diversity and how it evolves over time: how does the ecosystem "solve the problem" of cycling resources? we focus on questions such as: do local interactions among individuals promote or inhibit cooperativity, such as crossfeeding? do individuals evolve to cycle resources 'all by themselves'? how do individuals and their community structure change if we vary direct selection?

additional simulations have been run to test for the robustness of our main body of results against various parameter changes, such as mutation rates, starting networks, different resources and resource size .

overview of the local and null model
in figure  <dig> we show for both models and each selection regime a representative run. clearly, both models show that from low to high selection  the resource dynamics in the environment become more turbulent. importantly, there is also a clear difference between the models as the local model is more 'quiet', or stable in its resource dynamics. with respect to fitness , we find that in both models the difference between maximum bite and median bite is large, and median bite length increases hardly. the most striking property of the diversity  is that the sudden burst of diversity corresponds with the end of the so-called initial phase. it is also interesting to note that a diversity of ~ <dig>  given a sample size of  <dig> individuals, implies that there is a lot of diversity in the populations at σ =  <dig>  and  <dig> , and in the null model at σ =  <dig> . finally, we highlight the dynamic nature of the system on the level of an individual's phenotype : turbulent resource dynamics and the gain and loss of maximum bite lengths indicate the many invasions of new lineages and the extinction of old ones.

from the runs in figure 2a, c, j and 2l we have taken a single time point and visualized the ecological interactions between individuals and resources . again we observe two 'gradients' from rather simple dynamics to complex interwoven cycles of resource modifications: both from local to null model, and from low to high direct selection. moreover, under low direct selection, we find a single lineage performing the resource cycling, while for high selection multiple cooperating lineages are shown.

the first resource cycles
we consider the example run with local feedback shown in figure 2a. it can be divided into two periods: an initial phase characterized by an equal abundance of a subset of resources, and the long term evolution of the run in which resource numbers varied from equilibrium dynamics to turbulent patterns in time. the initial phase as we observed it in the example run was found across all runs, though its duration varied and was shortened with higher values of σ . we now present this period in terms of the sequences of zeros and ones that individuals output, allowing us to show the mechanics of our model. this nicely complements the higher-level ecosystem view we take in the subsequent study of long-term evolution.

in the initial phase the population was characterized by individuals that produced simple output bit strings in response to resources. we found that in the example run the networks generated first a transient of zeros, followed by the point attractor of value one. in table  <dig> all bites are enumerated that lead to reproduction at time step 5· <dig>  many bites were still small  and thus of low fitness. all bites were of low complexity: for instance, both the most abundant  and most fit  would be generated by the same transient and attractor. only the most abundant output would have a mismatch much earlier. also, a single output 'strategy' was often applied to multiple resources . to study which bit strings individuals could produce, we analyzed the underlying network dynamics. we found that the strings were generated by a single lineage with the following  <dig> typical outputs: 00001*, 0001*, 001*, 01* and 1*, where the star signals the continued emission of the last bit. thus the individuals were capable of modulating the transient length depending on the input before ending in a point attractor. this behavior was typical for the initial phase of the runs.

in the first column output bit strings are shown, with mismatched bits as dots . as the length of a correct output is the main determinant of an individual's fitness, one can easily differentiate between high and low fitness bites. the second column contains the number of individuals which generated the output. matching resource rotations  are given in the third column, corresponding to the ecological snapshot in figure 3a. the upper half of the table contains all bites from the shortest cycle, the lower half contains 'mutant' bites.

in the ecosystem snapshot of time step 5· <dig>  we observed a dominant cycle that was composed of popular bites and abundant resources. as expected, this was in concordance with table 1: row  <dig> to  <dig> contain all bites from this shortest cycle. the positive correlation between shortest cycle and resource abundance was a general property that held in all runs. the resources on the shortest cycle occupied over half of the grid, while a randomized ensemble of resources covered  <dig> to  <dig> times less space . we can understand this as an equilibrium between the dominant lineage and the mutants that were present. the dominant lineage maintained resources on the shortest cycle, and possibly channeled other resources onto the shortest cycle. on the other hand the various mutants took bites such that the resulting resources were likely not on the shortest cycle anymore. this explained the equilibrium we observed in figure 2a.

furthermore, as the shortest cycle was a concatenation of relatively large bites , the dominant lineage would often win the competition for reproduction. thus while this lineage established itself in the population, it out competed the other individuals and there would be an increase in shortest-cycle resources, until an equilibrium was reached. the result was a shortest cycle that was composed of abundant resources and the bites were performed by the dominant lineage.

summarizing, our ecosystem was initially composed of a population of simple individuals that shaped their environment with a low variety of processing steps. resource cycles quickly emerged, of which the shortest cycle of bites is an important property of the system. in all runs, this first phase of evolution abruptly ended with the innovation of oscillatory output patterns . it was accompanied by a sudden dramatic increase in phenotypic diversity . and while the initial phase had been rather similar for all runs, the long term outcomes were different, as we show next.

evolutionary stagnation
from a detailed account on the initial phase, we now move to an ecosystem point of view. as mentioned previously, we focus on the effect of indirect selection. we do this by studying the differences in behavior of the local – and null model, and by examining the effect of different levels of direct selection. we show that relatively high indirect selection, especially by local feedback between individual and its environment, leads to evolutionary stagnation in three different ways.

resource dynamics
in the comparison between the local and null model, resource dynamics in runs with local feedback were less turbulent and more often in equilibrium . in addition, the local model showed only a minor increase in turbulence from low to high σ, while for the null model this increase was much larger . thus local feedback enhanced a stable cycling of the same resources , which implies fewer mutants established in the populations and therefore a slow down of the evolutionary process.

bites
next, we considered the bites that occurred in the population over time. as argued previously, in case an individual influences its local environment, there is an incentive to have resource modifications that nicely follow up on each other: if an organism can increase the probability of its descendants having an "easy bite", this will lead to more successful offspring in the long run. on the other hand, in the null model this process is not present as local kin relationship is destroyed by the mixing of individuals. how does this difference reflect in the distributions of bite lengths over time?

the average bite that lead to reproduction in all selection regimes was around 4– <dig>  for both the local and null model. however, as we observed clearly for low direct selection , the local feedback resulted in less long bites . there were no bite lengths >  <dig>  while the null model showed bite lengths up to  <dig>  also, for σ =  <dig>  and  <dig>  bite lengths in the interval  <cit>  were less present in case of local feedback .

considering that mutation rates were equal and genome lengths comparable, mutants arose at a similar rate in both models. yet in case of local feedback mutants with larger bites failed to establish. the only difference between the two models was that in a spatial setting mutants were polluting their local surroundings and they were 'confronted' with this. that is to say, while the residing individuals were well-adapted to local resources and due to indirect selection also to the resources at the next time step, mutants found themselves among resources they could not process well. thus most mutants could not establish a lineage locally and were out competed by the expanding lineages that cycled resources more efficiently. in the null model, however, by mixing the connection between individual and resource composition was much weaker. mutants were not 'forced' to process their locally produced resources, hence it was easier for them to establish in the population. thus, in the long run, mutants were subjected to stronger competition in the local model. and the higher indirect selection, the stronger this competition was.

from this also follows that for higher values of σ direct selection overruled indirect selection and mutants were able to invade. in concordance with this argumentation is the coverage of the grid by the resources of the shortest cycle. in figure  <dig> we observed that while low selection had a high coverage , thus indicating few established mutants, σ =  <dig>  and  <dig>  showed a distinctly lower coverage. this points at alternative resource modifications taking place.

shortest cycle
as we have shown the core of the ecosystem dynamics was formed by the shortest cycle, we compared these cycles in the different settings. for σ =  <dig>  not only bite length, but also cycle length had clearly stagnated . translated into bite lengths, a local feedback cycle of length  <dig> resulted in an average bite of length  <dig> , while in the null model average bites were 64/ <dig> =  <dig>  bits long. thus on average approximately three bits were processed less if local feedback was present.

moreover, these differences in cycle length extended to σ =  <dig>  and  <dig> . at first sight a difference of one step may not seem significant, but as cycles become shorter the bites become progressively larger. for instance, for σ =  <dig> , if local feedback was present cycle length was  <dig>  which equaled a bite length of  <dig> , while the null model had an average bite of 64/ <dig> =  <dig> . thus there was a difference of more than  <dig> bits, which indicates quite some change in the network dynamics of the individuals.

concluding, locality of the feedback between individual and environment enhanced the effect of indirect selection for cycling resources. naturally, this was most obvious for low direct selection . however in comparison to the null model for all selection regimes we observed less change in the resource dynamics, a stagnated evolution towards long bites and a stagnated evolution of short cycles.

population structure
given the evolutionary stagnation, we turn to the underlying population and community structure. we focus on long-term dynamics of the community for the different selection regimes in both the local and null model.

crossfeeding
as described before, the innovation of oscillatory outputs marked a sudden increase in phenotypic diversity. from this large variety of different individuals cooperative cycling of resources emerged. subsequently the lineages participating in shorter cycles, thus performing larger bites, took over and this was mirrored in a rapidly decreasing length of the shortest cycle . eventually a few groups of individuals became dependent on each other for resources on the shortest cycle. we labeled such structuring of the population as crossfeeding, and examined it in detail.

first of all, we looked at the evolutionary dynamics of crossfeeding. it is clear that for all three selection regimes the local model resulted in less crossfeeding than the null model. however, there was a stronger dependence on selection. as shown in figure 7b, for low selection crossfeeding was a transient phenomenon. in both the local and null model, there was a peak before  <dig> · <dig> and in ~55% of the runs a single lineage eventually took over, performing the shortest cycle by itself. such was also the case in the example run we discussed previously, and its null model counterpart at σ =  <dig>  . the ecological network of the null model run is shown in figure 3b. a single lineage performed the shortest cycle of length  <dig>  while its close mutants created detours such as  <dig> →  <dig> →  <dig> →  <dig> and  <dig> →  <dig> →  <dig> →  <dig> →  <dig> 

contrastingly, runs with average and strong selection showed prolonged periods of crossfeeding : it was the main long term evolutionary outcome. this impacted the length of the shortest cycle. even though there was a 5-fold difference in σ between average and high selection, the lengths are comparable and substantially lower than for σ =  <dig>  . in figure 3c and 3d snapshots show the partitioning of the resources among different phenotypes. large bites were performed by specific phenotypes, while shorter ones were more prone to be shared .

ecological stability
next, we studied the population dynamics of these crossfeeding runs. a population structuring while mutations occur does not imply ecological stability  <cit> . we performed ecological runs and tested if crossfeeding was maintained. the results stressed that for low selection the structuring is not stable: only few runs preserved crossfeeding . however, for average and high selection all runs showed maintenance of crossfeeding. thus in these cases we have a stable phenotypic partitioning of the population.

for each of the selection regimes, we have tested the ecological stability of crossfeeding in a random set of  <dig> runs, for populations taken from  <dig> time points. the total number of runs, including the ones that lack crossfeeding, is shown in the second column. the first time point is chosen early in the simulations, after the innovation event. the other two time points are indicative of the long term evolutionary dynamics. each entry gives the fraction of runs with crossfeeding that show ecologically stability. a run is labeled as ecologically stable if crossfeeding is maintained in short ecological simulations .

phylogenetic basis
still the question remained if multiple lineages were present if there was crossfeeding? we verified that the phenotypic structure of the population had indeed a phylogenetic basis, that is to say there was a genotypic grouping as well. in figure  <dig> we show for the local model the phylogenetic distance between pairs of individuals against their phenotypic distance . it is important to realize that for short phylogenetic distances we observed mostly quasispecies variation among the phenotypes, while for large phylogenetic distances we have the actual population or community structuring.

one of the first observations was that all  <dig> figures have a red-colored peak close to the origin , which implied that a large fraction of the pairs was both phenotypically and phylogenetically closely related. second, low selection showed only limited phylogenetic diversity, which nicely corresponded to the evolutionary solution of a single dominant lineage. third, there was an obvious difference between low selection and the other two regimes. while for σ =  <dig>  the population remained similar as branch depth increases, for the other two average phenotypic distance increased. furthermore, the latter two showed deep branches of dissimilar pairs of individuals. in fact, considering some pairs of individuals had a last common ancestor almost 25· <dig> time steps ago, in a few runs the population must have split into separate lineages only a relatively small period after the start.

overall, the null model agreed well with the observations above. there was, however, one clear difference. we found that the last common ancestor was quickly different , contrasting the rather long stretch of similar ancestors found in the local model. this indicates that lineages diverged, and thus specialized, quickly. such faster divergence of the population is facilitated by mixing: the spread of a new adaptation is not limited by space, hence a mutant may establish faster.

in summary, both the local and null model show a clear dependency of crossfeeding on the strength of indirect selection, and this is most obvious along the different degrees of direct selection. high indirect selection – that is low direct selection or local feedback – often resulted in a single lineage performing a relatively long shortest cycle. with decreased indirect selection, via average and high direct selection or mixing of the population, prolonged periods of crossfeeding were observed. this crossfeeding was based on a phenotypic and phylogenetic differentiation in the population, and was ecologically stable.

for high direct selection , indirect selection was relatively low. most of the decline in crossfeeding was not caused by indirect selection, but by an impressive result of the evolutionary process. in  <dig> out of  <dig> runs with local feedback and  <dig> null model run a lineage evolved that was capable of outputting a correct sequence of  <dig> bits for a specific resource, as one can also observe in figure  <dig>  this specialist lineage out competed everyone and thus dominated the population. though impressive, we regard this result as an artifact at the boundary of interesting behavior in our model.

individuals
from the population and community structure we concluded that strong indirect selection favored the evolution of generalist lineages. if we look at the individuals of the runs, an interesting question is to assess their 'smartness'. how well would they process all the resources by themselves? a straightforward definition of smartness is the sum of an individual's phenotype. thus per individual we established for  <dig> resources its corresponding bite length and summed these lengths.

for each setting  we sampled  <dig> · <dig> individuals in the second half of the runs, from  <dig> · <dig> to 25· <dig>  in figure 9a the resulting distributions of smartness are shown. in all cases there was a peak of 'stupid' individuals close to zero. these were simply mutants that had an extremely deleterious mutation. secondly, all showed another peak around  <dig>  thus independent of the selection pressure or spatial setting most individuals were equally smart. thirdly, it was in the right tail of the distributions that we found distinct behavior for each σ . with increasing σ, individuals became smarter in both models, and even more so in the local model.

however, the following alternative definition of smartness resulted  in the opposite observation. previously we argued that the evolutionary stagnation of resources and their shortest cycles was caused by the indirect selection for cycling resources. to study how this affected individuals we wondered what shortest cycles would be generated by the individuals themselves . thus we introduced a second definition of smartness: to have a short cycle of resources. we allowed the individuals to use only resources that were abundant during their lifetime, and we found a clear difference between individuals along the two 'gradients' of indirect selection. more individuals from the local model were capable of performing a cycle, and they also had a shorter cycle than individuals from the null model , see also figure 9b and additional file 4: figure s <dig>  also, an obvious decline in the number of individuals that can perform a full cycle, was observed from low to high direct selection. note that in the latter case the individuals that are capable of performing a cycle, actually do this in fewer steps for higher σ .

at first sight it was perhaps paradoxical that different definitions of smartness lead to contrasting results. considering the first definition – the sum of bite lengths – the explanation is that under strong direct selection, individuals with large bites are strongly selected for and reproduce. we examined runs with local feedback by hand and in a subset of them  we found that the evolution for large bites for many resources had been very successful. local feedback enhanced the capability to integrate information and as a result phenotypic smartness ensued  <cit> . hence the tail of smartness in figure 9a. with respect to the second definition, this smartness is simply a consequence of indirect selection: in both the local and null model resources had to be cycled. thus strong indirect selection, either via locality or low direct selection, enabled the evolution of individuals that cycle resources.

in addition the following argumentation highlights the role of local interactions, as compared to the mixed case. we established that indirect selection for resource cycling via a local feedback resulted in a trend for single lineages performing the cycling across all three selection regimes . due to the locality of the interactions, crossfeeding was slightly obstructed, and individuals would  rely on their own lineage . contrastingly, the mixing of individuals in the null model facilitated crossfeeding and due to the higher long-term evolutionary stability of crossfeeding  individuals may have specialized.

discussion
in this study we examine the influence of an individual on its environment in an evolutionary setting. we let individuals evolve an abstract metabolic process of consuming resources and excreting waste products in a closed ecosystem. this introduced a new, indirect, selection for resource cycling. as a result a short cycle of resource modifications dominated the ecological dynamics, and depending on the strength of indirect selection eco-evolutionary phenomena such as stagnation, crossfeeding, generalists and specialists were observed.

evolutionary stagnation
in case of local feedback a lineage "co-evolves" with its surroundings, while mixing of the population  removes the relation between individuals and their local environment. we observe that local resource cycling results in stagnated evolution. especially for low direct selection  evolution slows down drastically by the interaction between organism and environment. looking at all selection regimes, we observe a lower throughput in the resource cycling  compared to the well-mixed null model.

previously, evolutionary stagnation has been observed in the context of predator-prey co-evolution on a lattice  <cit> . it was found that spatial patterns in the form of patches hindered the invasion of mutants. recently, in a model on marine microplankton a different mechanism with similar outcome was found: an increasing number of sibling species competing for resources slowed down the evolution of the entire ensemble  <cit> . it is tantalizing to associate such evolutionary slowdowns with the well-known observation of morphological stability in many fossil species  <cit> . could it be that interactions with the environment increase robustness of species on an ecosystem level? however, at the moment indirect, resource mediated ecological interactions among individuals have hardly been acknowledged as a potential mechanism that is contributing to the observed evolutionary stasis in the fossil record  <cit> .

crossfeeding and self-sufficiency
in case of strong direct selection , crossfeeding lineages evolve and maintain with ease in both models. two, occasionally three, genotypically and phenotypically distinct lineages form a cooperative community that is ecologically stable. the specialization on specific resources by different lineages could also be interpreted as a partitioning of the resources. still, as the different lineages clearly depend on each others 'waste', crossfeeding is a more appropriate term for the ecological dynamics.

the common hypothesis is that crossfeeding in  populations originates from rate-yield trade-offs  <cit> . as we omit such thermodynamic constraints, an energy related trade-off is not present. however, due to the fact that a network has a maximum of  <dig> different genes, there is an 'information storage' trade-off. nonetheless, we consider it unlikely that the maximum network capacity is reached, given the distribution tails in figure 9a. instead a more likely cause of generalization and specialization is the difficulty of evolving yet another recognition of a resource bit pattern or another long bite. in other words, the metabolism is practically not constrained as is the case for the rate-yield trade-off, but simply difficult  <cit> .

if we look at the evolutionary trajectories of the various runs, an interesting succession of phases is found. in the initial phase there is a single lineage that performs the cycling: an individual-based ecosystem. the era of this lineage ends when oscillatory outputs are discovered. this innovation leads to a phase of cooperating lineages: a community-based ecosystem. the long-term behavior that follows depends strongly on the indirect selection for bites that neatly map onto each other. local feedback and low direct selection both favor an individual-based ecosystem. in the long run the crossfeeding lineages tend to be replaced by a 'smart' generalist lineage that performs the cycling of resources by itself. on the other hand, both mixing the population and a high direct selection override the selection for resource cycling and foster a community-based solution of cooperating lineages. thus the evolution of our models appears to show a gradient from smart populations with 'stupid', cooperating individuals to 'smart', self-sufficient individuals. both the distribution of environmental knowledge over different lineages that compose a population, and the embedding of this knowledge in single individuals has been named "information integration"  <cit> .

such different modes of evolution have been reported previously in an evolutionary model on bacterial restriction-modification  systems under pressure by a continuous stream of phages  <cit> . either individuals were 'smart' in the sense that they contained many rm systems to guard against many phages, or the population was composed of mutually uninfectable bacteria with few rm systems. similar results have been found in a study on individual-based versus ecosystem-based function approximation  <cit> , where predators and scavengers subdivide a mathematical function in order to approximate it.

evolutionary innovation
we reported the innovation of oscillatory output patterns for both the local and null model, followed by the rapid takeover of the population by the lineage that 'discovered' the oscillations . though it is tied to the modeling approach we apply, we find it extremely intriguing that a fitness gain may not be reducible to a single gene, but is found on a higher level, namely that of the network discovering a novel behavior. from a classical point of view one expects that as a mutant takes over the population, the phenotypic diversity decreases. in our model this is not the case, even if we decrease the mutation rate by two orders of magnitude. instead, as the oscillatory behavior establishes in the population, there is a striking increase in phenotypic diversity, genome length and fitness . our conjecture is that the innovation of a new mode of generating output makes a large variety of phenotypes accessible, and this is subsequently exploited by the evolutionary process. in other words, innovation leads to species radiation. further research is necessary to establish the generality of this phenomenon.

modeling choice
from an ecosystem modeling perspective, we made choices that deserve some attention. first of all, we wondered if the fact that our ecosystem is closed with respect to the resources affects our results.

therefore we performed various runs with a slightly modified system. instead of rotating the resources, we let the individuals bite chunks from one side of the bit strings. thus the bit strings become smaller and at some point are finished. a finished resource is then replenished with a new resource, identical to the original. as a result we now have an open ecosystem with an influx of nutrients. in this model we observed both stagnation and crossfeeding. also the abundance of the different resources  changed over time in a qualitatively equal manner as in our default model. thus our results are not directly dependent on the precise topology of the 'chemical universe'.

second, questions regarding ecosystem evolution are often approached from an energy point of view, yet we have omitted any explicit constraints on the anabolic and catabolic activities of micro-organisms. this has allowed us to replace the thermodynamic constraints and complex nutrient pathways between bacteria, archaea and other micro-organisms with a much simpler chemical universe, and focus on the concept of having a feedback mechanism. as such our approach is a baseline study for the evolution of ecosystems.

third, the local and null model differ on two features: the presence and absence of kin-relationships between neighbors, and the ability  to create a specific local resource composition. strictly speaking we cannot distinguish between these two in our current results. an alternative null model could be the mixing of the resources instead of individuals. like in the current null model, the ability to create a specific resource composition for offspring would be eliminated, but neighbor relations would be preserved. we expect that whether or not individuals compete with their kin, also in this case indirect selection would be severely reduced.

finally, ecosystems usually consist of  food webs in which resources not only exist as 'edible' items in the environment, but also are immobilized in individuals and made available via predation and parasitism. in this study we have focused solely on individuals and their abiotic environment, and explicitly left out any direct interactions between individuals, except for competition. thus in order to study the evolution of more complete ecosystems, we could in future work extend our model with the ability of individuals to evolve interactions among each other.

CONCLUSIONS
the dynamics of our model amounts to how information on the environment is stored in the population and in single individuals. we used selection and the spatial setting to vary environmental structuring, population structuring and individual ecological roles. most importantly we show the effect of different degrees of indirect selection on the eco-evolutionary solution via the contrast of local against global feedback and the different levels of direct selection.

in short, locality enhances the integration of information from the environment into single individuals. however, as a consequence resources are cycled more slowly and in that sense the ecosystem is less efficient. though locality also plays a role in the evolution of crossfeeding, the latter is more dependent on the strength of direct selection. crossfeeding is always observed after the initial phase of evolution, yet it is likely to be only a transient phenomenon if there is  weak direct selection. in contrast, strong direct selection leads to sustained crossfeeding, and therewith more efficient resource cycling and faster environmental change.

despite our simplified in silico approach, it is suggestive to associate our results with the diverse range of ecosystems formed by microbial communities: from the individual-based, single-species ecosystem in a south african mine  <cit> , simple endolithic ones  <cit>  to complex soil communities  <cit> .

authors' contributions
ac conceived of the study, analyzed the data and drafted the manuscript. ph participated in the design of the study, analyzed the data and helped to draft the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
oscillatory output and parameter dependencies. we provide extra information on the nature of the oscillatory outputs generated by individuals. in addition, to assess the dependencies of our results on the model parameters, we varied several key parameters such as the mutation rates, starting networks and bit string length.

click here for file

 additional file 2
phylogenetic tree with leafs colored by genome size. we plot the phylogenetic tree of a run with local feedback and σ =  <dig> . each  <dig> · <dig> time steps a population is logged to disk and used in combination with ancestor tracing  to build the tree. nodes are individuals from the logged populations and ancestors at lineage-splitting events. in other words, we prune the tree for intermediate ancestors. the edges thus represent branches from last common ancestors, and are scaled and colored by time interval. for the coloring of the leaves the genome length, genes plus binding sites, is mapped to a color from yellow to red. the arrow in the top-left corner points to the ancestor in the initial population . we observe an overall modest genome size, with occasional branches evolving toward long genomes. see also additional file 6: figure s <dig> 

click here for file

 additional file 3
phylogenetic distance  against phenotypic distance  in the null model. we computed phylogenetic trees of all null model runs with σ =  <dig>  and  <dig>  . for each run we sampled a  <dig> random pairs of individuals with a time of birth difference <  <dig> time steps and traced their last common ancestor. the phylogenetic distance is the difference in time of birth between the pair and their ancestor. phenotypic distance is expressed as the manhattan distance between two phenotypes. the colors, as given in the legend, give the number of pairs averaged over  <dig> runs. note that the regular spacing in the data is an artifact of the periodicity of logging populations. average and high selection are shown in a, b respectively .

click here for file

 additional file 4
fraction of individuals incapable of cycling resources by themselves. we have taken per  <dig> time steps a sample of  <dig> individuals, over the interval . with  <dig> ×  <dig> runs this results in  <dig> data sets of  <dig> individuals. for each selection coefficient we find that local feedback  results in a smaller fraction of individuals that cannot cycle resources on their own, compared to global feedback . this plot complements figure 9b.

click here for file

 additional file 5
sudden increase in diversity. the number of unique bites is shown for the first 10· <dig> time steps. the number of unique bites in an ecosystem is calculated by counting the number of different bites that occur each time step. this measure is directly related to the phenotypic diversity. if there is more variety in the ways individuals process resources, the number of unique bites increases. in the same manner a phenotypically uniform population will have a low number of unique bites, as one can observe in the initial phase of evolution . furthermore, though we plot only the runs of the local model, the null model simulations result in qualitatively equivalent plots.

click here for file

 additional file 6
genome length through time. genome length through time for a run with local feedback and σ =  <dig> . genome length is defined as the sum of genes and binding sites. the total spread of different genome lengths at each time step is given by the gray dots, with the median and the 1st and 3rd quartile given by the solid and dashed black lines. we observe that the genome length penalty pen does not inhibit the evolution of large genomes. see also additional file 2: figure s <dig> for the phylogenetic tree of this run.

click here for file

 acknowledgements
this research is funded by the computational life science program of the netherlands science organization  under grant number 653-100- <dig> 
