BACKGROUND
marine fish often show weak genetic divergence over large geographical areas 
 <cit> . this may be due to high larval dispersal and adult migration in marine systems , and/or because of low genetic drift due to the large effective population sizes of many marine fish 
 <cit> . the predominant tools used for population genetic studies on marine species have been a small number of microsatellite markers . however, microsatellites derived from genomic libraries are unlikely to be indicative of adaptive differentiation unless they are in linkage with functional genes or located within their coding regions 
 <cit> . thus, in the context of fisheries management, the general lack of focus on molecular markers that are associated with genomic regions under selection suggests that marine populations may be incorrectly managed as panmictic. this is especially true for marine species inhabiting regions where local adaptation to steep environmental gradients is likely to exist 
 <cit> .

mitochondrial dna  is a potentially useful source of informative markers for investigating population structuring and adaptation in marine species due to its low effective population size  and documented functional roles in thermal adaptation and aerobic capacity 
 <cit> . mitochondria produce up to 95% of eukaryotic cell energy through oxidative phosphorylation, thereby having an important role in metabolic performance. despite the fact that there is very strong linkage between mitochondrial genes due to which they can not be considered as evolutionarily independent, the genes do differ in their mutation rates 
 <cit>  and functions. however, selective forces acting on one site will affect the whole mitochondrial genome, such that variation even in non-coding regions will deviate from neutral expectations. as well as selection acting directly on the mitochondrial genome, selection on the nuclear genome may also indirectly influence the mitochondrial genome, as mitochondria-encoded subunits of the respiratory chain are embedded within nuclear-encoded subunits 
 <cit> . furthermore, any maternally inherited factor could in theory influence mitochondrial haplotype diversity 
 <cit> . recombination is thought to be rare , thus increasing the potential for selective sweeps 
 <cit> .

several studies have detected specific mutations and regions of the mitochondrial genome that appear to be under positive selection. mutations in mitochondrial genes have been linked to a large number of human diseases , to thermal adaptation 
 <cit>  and to aerobic capacity 
 <cit> . furthermore, a study of  <dig> protein-coding mitochondrial genes in  <dig> placental mammals found evidence for adaptive evolution of the mitochondrial genome in species with specialised metabolic requirements  and high oxygen requirements ; particularly strong positive selection was detected in nd <dig>  nd <dig>  nd <dig>  and atp <dig>  at the population level, there is some evidence for mtdna selection in birds , based on the fact that certain populations consistently had a single non-synonymous substitution in the nd <dig> gene 
 <cit> . in addition, walleye pollock  have been shown to have more mitochondrial diversity than expected under a model of mutation and genetic drift, indicating that selection is occurring along a north–south gradient in two separate sampling regimes on either side of the north pacific 
 <cit> .

mitochondrial dna may be a particularly useful marker for marine species, as they are likely to experience strong selective pressures towards high aerobic capacity, and those with wide distribution ranges may also need to adapt to environmental clines 
 <cit> . broader sampling of the mtdna genome holds the possibility of greater resolution of both the population structure and intraspecific selection dynamics of marine fish. a very small number of studies have directly examined mtdna selection in marine species. cytochrome c oxidase  has been shown to be under selection in fish with high aerobic requirements . in addition, garvin et al.  <cit>  found evidence for codons under positive selection in the nd <dig> and nd <dig> genes in pacific salmon species, indicating that complex i  has been particularly important in the evolution of these species. in contrast, a global study of killer whale mitochondrial genomes found very high levels of conservation, with only two positively selected codons, both in the cytochrome b gene, and both in antarctic pack-ice individuals, which may actually represent distinct subspecies 
 <cit> . although there are very few studies of mtdna selection in marine species, it has been more common to use mtdna as a marker for population and phylogeographic studies for marine fish. however, the majority of such studies have almost exclusively used only one or two mitochondrial genes or gene fragments from across a very broad geographical scale 
 <cit> .

the atlantic herring  in the baltic sea provide an ideal case study to investigate mitochondrial genome variation and the possibility of selection, as this geographical region is characterised by strong environmental gradients and local adaptation to this variation may be expected. the baltic sea region, including the skagerrak and kattegat seas that connect the baltic sea to the north sea, is a post-glacial environment, which has existed only for approximately the past  <dig>  years 
 <cit> . a salinity gradient occurs from north to south, and east to west, ranging from  <dig> to  <dig> psu  within the baltic sea, and up to  <dig> psu at the mouth of the baltic sea. within the baltic sea, a temperature gradient also runs from the north to the south . the skagerrak and kattegat seas mark the region where the environment changes from being strictly marine  to brackish .

herring in the baltic region appear to be weakly differentiated, most likely due to high gene flow caused by larval drift and migrating adults, large population sizes, and perhaps also due to young age of the baltic sea meaning that there may have been insufficient time for population differentiation to occur. there is support for the baltic representing a distinct population, with a boundary to gene flow occurring around the skagerrak/kattegat sea region 
 <cit> . there is also some evidence for weak population structuring within the baltic sea, with possible barriers to gene flow separating rügen  herring from all other studied baltic sea samples, and separating populations in the southern baltic sea from those in the north 
 <cit> . snp data shows evidence for introgression of north sea alleles to the southern baltic sea 
 <cit> . microsatellite and snp allelic frequencies have been shown to correlate with variation in sea surface temperature and salinity within the baltic sea, providing preliminary evidence that environmentally-induced selection may be occurring at this geographical scale 
 <cit> . indeed, there is evidence from tagging experiments on atlantic herring in the baltic for a high degree of homing to spawning sites, and very low levels of migration between sites at spawning time 
 <cit> , enhancing the potential for local adaptation. furthermore, exome sequencing has demonstrated 
 <cit>  that many loci identified as likely to be under positive selection are clustered within particular chromosomal regions, and can be assigned to specific candidate genes that are thought to be under salinity-induced selection , providing evidence for adaptation in this system.

here, we used the whole mitochondrial genome to investigate population differentiation, selection and molecular evolution in the atlantic herring in the baltic sea. we addressed three main questions by analysing a large number  of whole mitochondrial genome sequences of herring from  <dig> localities covering the entire baltic sea, and an additional sample from the barents sea. first, is there any evidence for geographical structuring of genomic variation? second, is there any evidence for positive selection acting on the mitochondrial genome? third, is there any evidence that the genomic variation is associated with local variation in sea temperatures and salinity? we conclude by discussing the implications of our findings for the management of herring fisheries in the baltic sea.

methods
sampling
sampling was designed to cover the whole baltic sea, with an additional sample from the barents sea . herring were fished during the spring spawning seasons of  <dig> and  <dig>  with the exception of the barents sea site which were collected in february  <dig>  in total, we used  <dig> individuals from  <dig> sites . the samples used in this study were collected in accordance with the national legislation of the countries concerned.

sequencing
the mitochondrial genome was amplified in  <dig> overlapping segments, using  <dig> novel primer pairs  which were designed with primer <dig> 
 <cit>  using published clupea harengus sequences as a template . pcr mixes for all primer pairs consisted of 5μl qiagen taq pcr master mix , 3μl h2o,  <dig> μl of each primer at 10pmol, and 1μl dna. the pcr program used for all primer pairs was: denaturation at 95°c for  <dig> min, followed by  <dig> cycles of 95°c for 30s, 60°c for  <dig> min 30s, 72°c for  <dig> min, followed by a final elongation step at 60°c for  <dig> min. the resulting products were run on 1% agarose gels to check for amplification, cleaned using exonuclease i and fastap , and sanger sequencing was outsourced to beckman coulter genomics  and the institute for molecular medicine . sequences were checked manually, assembled, aligned, and annotated in geneious pro  <dig>  
 <cit> . annotations were performed using those from a published c. harengus mitochondrial genome . note that the mtdna genome has several overlapping genes , and one gene  is encoded on the complementary strand. overlapping nucleotide sections were duplicated so that each gene sequence was fully represented in the individual gene and concatenated gene datasets, and the reverse complement of the nd <dig> nucleotide sequence was used in order to infer the correct amino acid sequence.

three dataset types were created  whole genome ,  each of the  <dig> individual genes and the control region as separate datasets,  all genes concatenated .

phylogenetic trees
 whole genome - the most suitable model of nucleotide evolution for the whole genome sequences was chosen using jmodeltest  <dig> . <dig> 
 <cit>  this model was coded in to mrbayes 
 <cit>  to create a bayesian tree, which was run with two chains for  <dig>  million generations, sampling every  <dig> generations, and discarding 25% of the samples as burnin. the run was stopped once the standard deviation of split frequencies was < <dig> , and convergence was checked using tracer v <dig>  
 <cit> . a maximum likelihood consensus tree was calculated for the same dataset using mega v. <dig>  
 <cit> , with  <dig> bootstraps and using the gtr substitution model. clupea pallasii  was used as an outgroup to root both types of tree. a neighbour-joining tree was produced from the same dataset using between sampling site mean nucleotide distances  in mega v. <dig>  
 <cit> . in order to better visualise the whole genome nucleotide distances, a multidimensional scaling  plot was generated using the cmdscale function in r 
 <cit> .

 individual genes and control region – datasets for each of the  <dig> individual coding genes, and for the control region, were run through jmodeltest  <dig> . <dig> 
 <cit> . these models were used as priors in mrbayes 
 <cit>  to create a bayesian tree for each gene. mrbayes was run with two chains for two million generations, sampling every  <dig> generations, and discarding 25% of the samples as burnin. for each gene the standard deviation of split frequencies was < <dig>  when the analysis was terminated. clupea pallasii  was used as an outgroup to root all trees.

 all genes concatenated - trees were also created using the dataset of all coding genes combined. a bayesian tree was created in mrbayes 
 <cit>  partitioning the dataset into each of the  <dig> separate genes, and using individual models for each gene as chosen by jmodeltest. mrbayes was run for six million generations, sampling every  <dig> generations, and discarding 25% of the samples as burnin. clupea pallasii  was used as an outgroup to root the tree. an additional maximum likelihood tree was produced using amino-acid data for all genes concatenated with  <dig> bootstrap replicates. a neighbour-joining tree was produced with the same dataset, using between sampling site mean amino acid distances  in mega v. <dig>  
 <cit> . also, a multidimensional scaling  plot was generated using the cmdscale function in r 
 <cit>  for the all genes concatenated amino acid data.

clade dating
estimating the time to most recent common ancestry  of c. harengus, and its intraspecific subclades was performed using a bayesian relaxed clock method implemented in beast v. <dig>  
 <cit> . the all genes concatenated dataset was used, with two additional aligned sequences from each of the two nearest species having whole mtdna genome sequence available . two nodes were used for temporal calibration based upon the phylogenetic relationships among  <dig> clupeiforme mtdna genomes 
 <cit> . nothing is known about the tmrca between sprattus and clupea, thus a uniform prior between  <dig> and  <dig> millions of years ago  was chosen, with an initial value of  <dig> mya. the tmrca between c. harengus and c. pallasii was defined as a truncated normal distribution having a mean of  <dig> mya, a standard deviation of  <dig> my, and an upper and lower limit of  <dig> and  <dig> mya, respectively, based on previous estimates for the age of this node 
 <cit> . the analysis used the srd <dig> model of codon evolution , and an uncorrelated log normal  relaxed clock model of evolutionary change. the ucln mean rate prior was modelled as a uniform distribution from  <dig> to  <dig>  with an initial value of  <dig>  e –  <dig>  the tree prior was set to a yule speciation process, starting with a randomly generated tree. multiple analyses were conducted for at least 50 ×  <dig> iterations each, with a burn-in of  <dig>  samples were taken every  <dig> iterations and operators were optimized automatically. results of replicate runs, convergence, asympotic performance and effective sample size  of posterior parameters  were assessed using tracer v <dig>  
 <cit> .

population structure
analysis of molecular variance  was performed for the whole genome nucleotide dataset, for each individual coding gene, and for the control region, using arlequin version  <dig>  
 <cit>  with  <dig>  permutations, in order to test the null hypothesis of no population structure. the fst estimator used was Φst, a direct analogue of wright's fst for nucleotide sequence divergence. again, we applied the sequential bonferroni correction, and a false discovery rate of  <dig> . arlequin was also used to calculate pairwise Φst for the whole genome and any genes that indicated significant population structure.

isolation by distance tests to compare genetic and geographic distances were performed using mantel’s tests  in r 
 <cit> , using  <dig>  permutations. the following datasets were used: whole genome nucleotides, all coding genes concatenated nucleotide and amino acid data, each individual gene nucleotide and amino acid data, and the control region nucleotide data. the genetic distances were calculated as the number of substitutions per site averaging over all sequence pairs between populations, and calculated using mega v. <dig>  
 <cit> . estimates for the geographic distance between each pair of sites using the most direct marine route were calculated using google earth 
 <cit> . this analysis was performed excluding the barents sea reference population . we applied two different corrections for multiple testing: the sequential bonferroni correction 
 <cit> , and a false discovery rate of  <dig>  
 <cit>  using the p.adjust function in r 
 <cit> .

selection
selection is often assessed by looking at the ratio of nonsynonymous  to synonymous mutations , where a ratio of dn:ds >  <dig> is taken to indicate positive selection 
 <cit> . however, this approach is not appropriate for conserved genes in which most mutations are synonymous and a very small number of changes can still be adaptive 
 <cit> . this approach is also sensitive to sampling strategy as shared ancestry can generate spurious results. because of these issues, we used treesaap 
 <cit>  which compares the observed physiochemical amino acid changes inferred from a phylogenetic tree with the expected random distribution of amino acid changes selective neutrality. treesaap compares amino acid sequences in the context of the given tree to infer amino acid replacements, which are then analysed using models that estimate the distributions of  <dig> physiochemical amino acid properties, under the assumption that under neutrality, every feasible amino acid replacement is equally likely. although within-site sample sizes are low, it is worth noting that the treesaap analysis is not based on mutation frequencies within populations, but upon the sequences themselves, and so is less affected by sampling strategy than approaches such as dn:ds ratios 
 <cit> . we used the dataset for all genes concatenated with the corresponding bayesian tree, and a sliding window of  <dig>  in order to detect strong positive selection, we only considered most radical amino acid property changes  at p ≤  <dig> . the z scores for the physiochemical properties with significant changes in these categories were plotted. positive z scores indicate positive selection, while negative z scores indicate negative selection. the total number of codons inferred to be under significant positive selection were counted within each gene and each sampling location. the most significant amino acid changes detected were mapped onto the bayesian tree.

environmental correlates of genetic diversity and genetic distance
mean sea temperature and mean salinity were calculated for 5– <dig> m of depth from helcom data  for locations closest to the sample sites. two averages were calculated: mean april values, and mean spawning time values. mean temperatures and salinities for the month of april were used in order to give an estimate of how temperatures varied between sites at a fixed time-point. april was chosen as the representative month as spawning took place from february through to july. in addition, mean temperature and salinity values were obtained for a two-week period spanning the spawning date, with the sampling date taken as the midpoint and one week either side to allow for some degree of error.

latitude and the distance from the entrance to the baltic sea were used as explanatory variables for genetic diversity. the distance from the entrance to the baltic sea was calculated as the shortest marine route from each site to a point at the region where the baltic sea meets the north sea .

 amino acid and nucleotide diversity

in order to search for correlations between population amino acid or nucleotide diversity  and environmental variables, general linear models were implemented in r 
 <cit> , with the expectation that genetic diversity may be lower in more extreme environments. nucleotide diversity and amino acid diversity for all genes concatenated and for each individual coding gene, and nucleotide diversity for the whole genome and the control region, were fitted as response variables in separate models. in each case, the explanatory variables were: distance from the entrance to the baltic sea, latitude, mean april temperature, mean april salinity, spawning time temperature, and spawning time salinity. in addition, we included the biologically relevant interaction terms mean april temperature × mean april salinity, and spawning time temperature × spawning time salinity. residuals were tested for normality, and each term was dropped individually using the ‘drop1’ function to remove the effect of the order in which the terms were entered in the model. we applied a sequential bonferroni correction and a false discovery rate of  <dig> , and these corrections were applied within each environmental variable, and separately for nucleotides and amino acids.

 amino acid and nucleotide distance

in order to search for correlations between genetic distance and environmental distance, mantel’s and partial mantel’s tests were implemented in r 
 <cit> . genetic distance matrices were calculated for nucleotide and amino acid sequence data for all genes concatenated and for each individual coding gene, and for nucleotide sequences for the whole genome and the control region . the genetic distances were calculated as the number of substitutions per site averaged over all sequence pairs between populations, using mega v. <dig>  
 <cit> . distance matrices were generated using r  for the following variables: mean april temperature, mean april salinity, spawning time temperature, spawning time salinity, and latitude. mantel’s tests were performed in r  between each of the  <dig> genetic distance matrices and each of the five environmental distance matrices . in addition, these  <dig> tests were repeated as partial mantel’s tests  controlling for geographical distance by sea, in order to remove the effect of isolation by distance from the correlation tests. in all cases, the pearson correlation coefficients were used, with  <dig>  permutations. we applied a sequential bonferroni correction and a false discovery rate of  <dig> ; the corrections were applied within each environmental variable, separately for nucleotides and amino acids, and separately for mantel and partial mantel tests.

RESULTS
in total,  <dig> mtdna genomes were fully sequenced, each comprised  <dig>  base pairs, which corresponded to  <dig>  amino acids when all  <dig> transcribed genes were concatenated. no identical sequences were encountered. annotated genomes were submitted to genbank . basic information for each coding gene is included in additional file 
 <dig> 

phylogenetic trees
 whole genome - the jmodeltest results for all analyses can be found in additional file 
 <dig>  the bayesian tree revealed three well-supported main clades, with one outlier . the maximum likelihood tree showed the same main three clades as the bayesian tree, with high bootstrap support . the three main clades  did not cluster geographically . the neighbour-joining tree using between site nucleotide distances did not show any obvious clades or geographic structuring . likewise, the multidimensional scaling plot revealed no population structuring .

 each gene individually and control region – some bayesian trees for individual coding genes  showed no resolution. however all other genes and the control region showed clustering that was consistent with the three main clades identified in the whole genome tree .

 all genes concatenated - the partitioned bayesian nucleotide tree showed identical major clades to the whole genome bayesian tree. the maximum likelihood tree based on amino acids for all coding genes showed no well supported clades , though the samples tended to cluster similarly as in the nucleotide-based trees. the neighbour-joining tree using between site amino acid distances showed no obvious clades, and no clear geographic structuring. however, de-rugen appears to stand out at the root of the tree . the multidimensional scaling plot based on the all genes concatenated amino acid data shows that de-rugen, no-berlevag, and ee-muuga are quite different from all the other sites, and also from each other .

clade dating
the mean tmrca for the c. harengus sequences was  <dig>  mya :  <dig>  -  <dig> ), and between subclades  <dig> and  <dig> the mean tmrca was  <dig>  mya . the posterior estimate of the mean rate of evolutionary change, for the concatenated gene set over the whole tree, was  <dig>  substitutions/site/myr , with little rate variation across temporal scales within the clupea species lineages . given the large uncertainty in the realized rate variation across temporal scales, which a growing body of studies suggests increases from  <dig> to  <dig> x in comparisons between within population and interspecific levels 
 <cit> , we also assessed our results assuming a 10x higher rate of evolutionary change. using a 10x higher rate provides a robust lower limit on the tmrca and decreases the aforementioned tmrca estimates and their 95% hpds by a factor of  <dig> . analysis of the posterior distributions for the constrained nodes indicates that the tmrca age estimates are highly influenced by the prior constraints, indicating the need for more detailed study of age estimates for these clades and the clupeiformes as a whole before robust temporal insights can be obtained.

population structure
the amova using the whole genome dataset gave an overall Φst =  <dig>  . looking at individual coding genes and the control region, overall Φst across populations ranged from  <dig> to  <dig> , with atp <dig> showing the lowest and cox <dig> the highest value . on application of sequential bonferroni correction, or a false discovery rate of  <dig> , only cox <dig> was significant.

pairwise Φst estimates indicated significant population structuring between many population pairs in the whole genome nucleotide analysis , with population se-blekinge being the most distinct in this dataset . in addition, the cox <dig> pairwise Φst analysis also indicated se-blekinge to be the most differentiated population, but showed fewer other significant pairwise results than the whole genome nucleotide analysis.

isolation by distance tests showed a significant correlation between atp <dig> nucleotide distances and distance by sea , and borderline significant correlations between atp <dig> amino acid distances  and atp <dig> nucleotide distances  with distance by sea. no further statistically significant isolation by distance results were detected . all tests were non-significant after correcting for multiple tests.

selection tests
treesaap detected significant  changes in amino acid physiochemical properties in many parts of the herring mitochondrial genome . the highest proportions of codons under selection were found in the nd <dig>  nd <dig>  nd <dig> and atp <dig> genes respectively , and in the sampling sites de-rugen, ee-muuga, and no-berlevag . two codons showed particularly significant results , however when these amino acid changes were mapped to the bayesian tree, they were found to occur only on terminal branches and did not cluster together. the cox <dig> change only occurred in a single individual, and the nd <dig> change only occurred in four individuals . due to the small within-site sample sizes and associated sampling variance, the importance of these terminal mutations can not be verified. of the significant amino acid changes that occurred in internal branches, two were found in all but one sample in clade  <dig> , and another was found in all samples in clades  <dig> and  <dig> . unlike the amino acid changes occurring in the terminal branches, amino acid changes in the basal areas of the tree will not be influenced by sampling variance.

environmental correlates of genetic diversity and distance
as our pairwise Φst estimates indicated significant population structuring between many population pairs, we proceeded with correlation tests between genetic and environmental diversity.

 amino acid and nucleotide diversity

the general linear models indicated little or no correlation between genetic diversity and any of the environmental variables used . four significant results were obtained; atp <dig> amino acid diversity with latitude , atp <dig> nucleotide diversity with spawning temperature  and with the interaction term spawning temperature x salinity , and cox <dig> amino acid diversity with spawning temperature . however, on inspection of the data, the atp <dig> and cox <dig> amino acid diversity for the majority of the sites  is zero. no correlations were significant after the application of sequential bonferroni correction or at a false discovery rate of  <dig> .

 amino acid and nucleotide distance

the mantel tests correlating genetic distance with environmental distance showed significant associations between the following: atp <dig> nucleotide distance and spawning salinity , atp <dig> nucleotide distance and spawning salinity , atp <dig> amino acid distance and april salinity , cox <dig> amino acid distance and spawning salinity , cox <dig> amino acid distance and april salinity , nd <dig> nucleotide distance and spawning temperature  as well as latitude , and nd4l nucleotide distance and spawning temperature . when these tests were repeated as partial mantel tests, controlling for geographical distance, the following remained significant: cox <dig> amino acid distance and spawning salinity , cox <dig> amino acid distance and april salinity , nd <dig> nucleotide distance and spawning temperature  as well as latitude , and nd4l nucleotide distance and spawning temperature . the correlations between atp <dig> and atp <dig> with salinity were simply due to isolation by distance. no correlations were significant after the application of sequential bonferroni correction or at a false discovery rate of  <dig> .

discussion
our results show that there are three well-supported clades of atlantic herring in the baltic sea region, dating to a time long before the formation of the baltic sea. the three clades are all found throughout the baltic sea, and also at a site in the barents sea, with no obvious geographical clustering. isolation by distance tests uncovered only borderline significant results for the atp <dig> and atp <dig> genes, before correcting for multiple testing. despite this lack of geographical clustering, there was evidence for significant population structuring , and when considering amino acids, three sampling sites were divergent . significant evidence for positive selection was found, particularly in the nd <dig>  nd <dig>  nd <dig> and atp <dig> genes. amino acid changes associated with selection were found at the base of the major clades clades, and occur more often in the three divergent sampling sites. despite the evidence for selection, there was little evidence for correlations between genetic diversity or differentiation with environmental factors.

phylogeography and clade dating
the three main clades were well supported, and a similar pattern of clustering was found within all genes with adequate resolution. using interspecific calibrations, the last divergence among these clades  occurred around  <dig>  mya. in order to provide a robust lower limit to this last divergence event, we also used a 10x faster rate of molecular evolution, which puts the lower limit to  <dig> kya years ago. while there is a large degree of uncertainty regarding our temporal estimations of these clades, given that the baltic sea is a post-glacial environment that is roughly  <dig>  years old 
 <cit> , the three main c. harengus clades certainly represent divergence events that occurred long before the formation of the baltic sea. these three diverse clades may have colonized the baltic sea at around the same time, or they may have colonised in different waves and subsequently mixed. liu et al.  <cit>  estimated that there have been  <dig> million years of separation between three pacific herring  lineages around the north american and asian pacific coastlines, which is of a similar order of magnitude to the dates in our study.

multiple genetic lineages seem to be common in the baltic region in a number of species. for example, the ninespine stickleback  apparently has only two lineages in this region, one within the baltic and one in the north sea. a study on the baltic clam  revealed three major lineages within the baltic sea and north sea, with one clade occurring only within the baltic sea and alaska, a second clade occurring predominantly outside the baltic sea, and a third clade found in both the baltic and north seas; these lineages also diverged long before the formation of the baltic sea, at around  <dig> - <dig> mya 
 <cit> . it is clear that the majority of baltic species, including herring, show a distinct barrier to gene flow between the atlantic and the baltic sea 
 <cit> . this pattern indicates that baltic sea populations are evolutionarily divergent from the atlantic populations, either due to isolation, bottlenecks, and/or selection for life in a brackish water environment. perhaps surprisingly, this pattern is not evident from the distribution of mtdna clades in our study, as the three robustly identified old lineages are found both within the baltic and at the reference site in the barents sea . in addition, we found no evidence for a reduction in mtdna diversity from the entrance to the more peripheral regions within the baltic sea. it is clear that these lineages are now very well mixed geographically, and this may have reduced any signal of a reduction in diversity towards the innermost geographical regions, however it should be noted that out within-site sample sizes are small  and so diversity and differentiation measures should be considered with caution.

similarly to our study, a whole mitochondrial genome study of the cod  found multiple clades but with little clear geographical patterning, despite their four sampling locations spanning the north atlantic 
 <cit> . although this lack of geographical structure might be expected for a wide-ranging marine species such as the cod, a recent study on pacific herring  did manage to detect population structure around the north american and asian pacific coastlines 
 <cit> . it is possible that looking at a wider geographical scale in the atlantic herring could reveal a geographical basis for the lineages that we found, or reveal additional lineages that did not colonise the baltic sea.

isolation by distance and population structure
we did not uncover any strong patterns of isolation by distance using the whole genome, concatenated genes, or most individual genes. our amova results indicated low yet statistically significant population structuring, with an overall Φst of  <dig>  for the whole genome. although small sample sizes within-sites mean that the value of Φst may be imprecise, three sampling sites stood out as particularly distinct when looking at the amino acid data . these results strongly support findings from transcriptome-derived microsatellites in a recent study of baltic herring 
 <cit> . microsatellites revealed a distinct genetic unit linking de-rugen, se-stromstad, dk-fredrikshavn and lv-liepaja, and a separate genetic unit linking a nearby estonian site  with fi-vaasa 
 <cit> . genetic variation and differentiation in microsatellites were shown to correlate with temperature and salinity, and genetic differentiation was also found to be related to oceanographic connectivity 
 <cit> . snp variation 
 <cit>  provides additional evidence for rügen being distinct from other baltic populations, demonstrating introgression of north sea herring alleles along the southern side of the baltic, and also providing further evidence that this structure relates to adaptation to environmental heterogeneity. from our data it appears that the rügen population  has the lowest degree of divergence from a common ancestral population , and this population is located at the root of the amino acid distance tree , perhaps due to introgression of north sea haplotypes. given the consistency of the results between the studies, it seems likely that there is some population structuring in herring within the baltic sea, which may have an adaptive basis.

evidence for selection
although the mitochondrial genome is very conserved 
 <cit> , previous studies have uncovered positive selection, particularly in the cox <dig> gene in high aerobic requirement fish 
 <cit> , the nd <dig>  nd <dig> and nd <dig> genes in pacific salmon 
 <cit> , and the nd <dig>  nd <dig>  nd <dig>  and atp <dig> genes high metabolic requirement mammals 
 <cit> . likewise in our study, the nd <dig>  nd <dig>  nd <dig>  and atp <dig> genes showed the highest proportions of codons under significant positive selection. while cox <dig> showed one very highly significant codon, this mutation was only found in a single individual, and hence its importance can not be verified. focussed cox <dig> sequencing with larger within-site sample sizes would reduce sampling variance and could provide further insight into the importance of this mutation. in contrast, a significant mutation in the nd <dig> gene was found at the base of clades  <dig> and  <dig>  and mutations in the nd <dig>  and nd <dig> genes were found at the base of clade  <dig>  as these sites detected as likely to be under positive selection are found in the basal regions of the tree, they are likely to be important in the evolution and adaptation of atlantic herring. the nd <dig>  nd <dig> and nd <dig> genes together make up the transmembrane section of nadh dehydrogenase, and have been suggested to be the proton pumping device as they are homologous to a class of na+/h+ antiporters 
 <cit> . mutations in these three genes underlie clade  <dig> and clades 2/ <dig>  indicating that the clades may have some adaptive differences. in addition, the three sampling sites with the highest numbers of significant amino acid changes were the same three sites that appeared as very distinct on the amino acid multidimensional scaling plot , providing preliminary evidence that there may be local adaptation occurring at these locations. it is also worth noting that the atp <dig> gene was the only gene to show significant isolation by distance before correction for multiple testing.

the occurrence of multiple clades, and potential adaptive mutations at the base of the clades indicates that variation in the mitochondrial genome may be useful for exploring population structuring and selection at a wider global scale, in particular by providing context for the three clades found in this study. the mitochondrial genome may also be useful for detecting selection in other marine fish; according to the theory of genetic draft , larger populations are expected  to have experienced more recent selective sweeps, resulting in reduced genetic variation relative to neutral expectations 
 <cit> .

environmental correlates
correlations between genetic diversity, differentiation and environmental factors were also of interest due to the strong environmental gradients in the baltic sea, as well as the potential adaptive value of mitochondrial variability. there was no evidence that genetic diversity  was correlated with distance from the entrance to the baltic sea, latitude, salinity, or temperature. however, there was some evidence that genetic distances at the cox <dig> gene are associated with salinity, and genetic distances at the nd <dig> and nd4l genes  are associated with temperature at spawning time, after correcting for the effects of geographical distance. nd <dig> genetic distance was also associated with latitude, which is likely to be due to the variation in temperature at different latitudes rather than a spatial effect, as there was no indication of isolation by distance in this gene. none of these correlations remained significant after the application of corrections for multiple testing, however, these corrections are very conservative particularly as the α values become very low given the number of tests that we have performed, and there is much debate regarding the application of such tests . the tight linkage between the mitochondrial genes means that the tests are not truly independent, meaning that correlations of individual genes with environmental factors must be interpreted with caution.

there is very little published material on the adaptive roles of individual mitochondrial genes. however, there are indications that cytochrome oxidase enzyme activity increases in high salinity environments in the cyanobacterium anacystis nidulans <cit> , and in the cyanobacterium synechococcus  <dig> cells grown in a saline environment show a tenfold increase in cytochrome oxidase activity 
 <cit> . in addition, cold stress has been shown to reduce the capacity for respiratory nadh oxidation in plants 
 <cit> . although our results hint that the nadh complex may be important for thermal adaptation, and the cytochrome oxidase complex may be important for salinity adaptation, none of the genes identified as under particularly strong positive selection showed any indication of correlation with the environmental variables that we examined.

CONCLUSIONS
from the perspective of fisheries management, this work shows that although there are distinct mitochondrial lineages of herring in the baltic sea, the atlantic herring management units in the baltic region cannot be defined on the basis of these lineages due to a lack of clear geographical structuring. however, our data does indicate higher levels of population differentiation than expected at random, with some populations appearing particularly divergent when looking at amino acid data. this divergence aligns with the within-baltic genetic structure described using transcriptome-derived microsatellite markers 
 <cit> .

there is also some indication that positive selection has occurred on the amino acids in the divergent populations. furthermore, transcriptome-derived microsatellites showed evidence for local adaptation to temperature and selection 
 <cit> , and a recent exome sequencing study 
 <cit>  has provided strong evidence for positive selection in regions of the nuclear genome that are associated with adaptation to environmental heterogeneity. together these results imply that local selection and adaptation is acting in this system. selection on the mitochondrial genome was detected at the base of the three major lineages, and global studies covering more of the herring distribution may be able to reveal a phylogenetic pattern to these mutations.

the development of molecular markers located in selected regions of genomes has gained attention in the conservation genomics literature, the argument being that such markers may be able to play a large role in management by helping to identify management or conservation units 
 <cit> . the mitochondrial data support the units found using microsatellite markers, indicating that distinct genetic management units could be implemented. nevertheless, filling sampling gaps on the northern coast of poland and the gulf of riga , and investigation into autumn spawning herring will be critical for developing sensible management units. as for now, evidence for selection on the mitochondrial genome, and evidence for local adaptation from microsatellite markers 
 <cit>  and exome sequencing 
 <cit>  imply that local management of herring fisheries may be an appropriate strategy in order to maintain locally adapted populations.

competing interests
all authors declare that they have no competing interest.

authors’ contributions
agft carried out the molecular genetics lab work, performed all analyses except for clade dating, and wrote the paper. cww performed the dating analysis. all authors contributed to the conception and design of the study, and contributed to drafting the final manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
information on samples. sd= fisheries subdivision, n = number of individuals. the latitude and longitude for each site are given to the accuracy provided by the collectors.

click here for file

 additional file 2
primer details. primer details including name, sequence, annealing temperature , gc content, and the length of the amplified product .

click here for file

 additional file 3
basic information and jmodeltest results for whole genome and each gene. this table shows the complex, length , number of segregating sites , model chosen by the bayesian information criterion , nucleotide frequencies, substitution frequencies , proportion of invariable sites , gamma shape, and transition/transversion ratio  for the whole genome and each gene individually.

click here for file

 additional file 4
amova results for whole genome, individual coding genes, and the control region . presented are the Φst , the probability that the observed data is within the range of the random data ), the probability of randomly getting an fst that is higher than the observed data ), and the overall probability . on application of sequential bonferroni correction, or a false discovery rate of  <dig> , only the amova for cox <dig> remains significant.

click here for file

 additional file 5
population-specific Φst indices from the amova analyses. population-specific Φst indices from the amova analyses, representing the degree of evolution of a particular population from a common ancestral population. these indicate whether certain populations contribute differently to others to the average Φst.

click here for file

 additional file 6
pairwise Φst for  the whole genome and  the cox <dig> gene. pairwise Φst for  the whole genome and  the cox <dig> gene. the cox <dig> gene showed significant population structure in the amova analysis. the numbers below the diagonals are Φst and the numbers above the diagonals are the probability values. the probability values shown in bold are < <dig> .

click here for file

 additional file 7
isolation by distance results. the pearson product–moment correlation coefficient statistic  and the probability values  are shown for whole genome , all genes concatenated , each individual coding gene, and the control region . separate results are shown for nucleotide and amino acid data. there is no amino acid data shown for the whole genome as large parts of the genome are non-coding, nor for the control region. in addition, amino acid results are not shown for the nd <dig> gene as there was no variation. significant results are shown in bold . all tests were non-significant after the application of sequential bonferroni correction or at a false discovery rate of  <dig> ; the corrections were applied separately for nucleotides and amino acids.

click here for file

 additional file 8
treesaap results summary. showing the total number of codons for each coding gene and complex, the number of these codons that were detected as being under significant positive disruptive selection , and the proportion of codons under selection. for each sampling site we show the number of individuals sampled, the number of codons under significant positive disruptive selection , and the number of codons corrected for number of individuals.

click here for file

 additional file 9
results of general linear models. the response variables were the genetic diversity measures, either nucleotide diversity  or amino acid diversity , while the explanatory variables were distance from the entrance to the baltic , latitude, temperature and salinity at spawning time, temperature and salinity for april, and the interactions between temperature and salinity at spawning time and for april. f statistics ) and probability values  are given. p values < <dig>  are shown in bold. no correlations were significant after the application of sequential bonferroni correction or at a false discovery rate of  <dig> ; the corrections were applied within each environmental variable, and separately for nucleotides and amino acids.

click here for file

 additional file 10
results of mantel and partial mantel tests correlating genetic distance with environmental distance. the pearson product–moment correlation coefficient statistic  and the probability values  are shown for whole genome , all genes concatenated , each individual coding gene, and the control region . separate results are shown for nucleotide and amino acid data. there is no amino acid data shown for the whole genome as large parts of the genome are non-coding, nor for the control region. in addition, amino acid results are not shown for the nd <dig> gene as there was no variation. partial mantel tests were all performed using shortest geographical distance by sea as the conditioning variable. significant  results are shown in bold. no correlations were significant after the application of sequential bonferroni correction or at a false discovery rate of  <dig> ; the corrections were applied within each environmental variable, separately for nucleotides and amino acids, and separately for mantel and partial mantel tests.

click here for file

 acknowledgements
thank you to those who kindly collected or provided samples that contributed to this work: teija aho, janis birzaks, martina blass, michele casini, hannu harjunpää, eric hoffmann, alpo huhmarniemi, timo jääskeläinen, mike luner, jukka pönni, anna-karin ring, lennart sundström and anti vasemägi. this research was funded by the academy of finland , formas , and the european community’s seventh framework programme  under grant agreement no.  <dig> made with the joint baltic sea research and development programme bonus .
