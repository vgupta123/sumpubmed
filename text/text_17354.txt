BACKGROUND
the construction of a quantitative genotype-phenotype map is one of the most challenging problems in current biology. mathematical models of gene regulatory networks explicitly connecting the dna sequence level with that of gene expression or other molecular phenotypic traits represent a flexible framework for studying various aspects of genotype-phenotype mapping  <cit> . by using this approach, it is possible to assess the importance of various mechanisms involved in translation of genetic information into phenotype and their interplays in different contexts  <cit> . a promising approach for this type of modeling combines methods of the statistical thermodynamics and dynamical systems for model formulation and incorporates the latest experimental results on the sequence and gene expression analysis for its verification  <cit> .

along this research direction, we previously applied the thermodynamics based model to the drosophila gap gene network, which is a sub-network of the segmentation gene network. the segmentation genes are expressed in early drosophila embryo and determine positions of the body segments  <cit> . the gap gene sub-network consists of the following genes: bicoid  and caudal  are maternal coordinate genes, tailless  and huckebein  are terminal gap genes, and hunchback , kruppel , giant , and knirps  are trunk gap genes. all these genes encode transcription factors. the model takes as input the potential regulatory regions of trunk gap genes, predicts transcription factor binding sites  and estimates their binding affinities for all transcription factors  regulating these genes by using positional weight matrices , and then calculates as output the dynamics of gene products  in the embryo nuclei at the blastoderm stage. the values of free parameters in the model were estimated by fitting the model solution to the in situ data on gap gene expression , and the quality of fit was quantitatively satisfactory. we aim to use this model in this study to analyze how functional important tfbss are distributed in the regulatory regions and how their impacts on gene expression patterns correlate with each other.

a special question of interest is how this analysis depends on specific assumptions about the regulatory interactions between genes. in order to do that, we extend our model in several ways. the first extension concerns new binding sites added to the model. in the first variant of the model, we implemented only those high-affinity tfbss that fall into the dnase i accessibility regions in the regulatory sequence, as these regions presumably correspond to the open chromatin domains. however, filtering by dnase accessibility might discard some of functional tfbss, so we added to our model binding sites previously reported as functional  but whose coordinates do not intersect with the dnase i accessibility regions.

another extension concerns new regulatory interactions between hb and kr genes. based on the analysis of fixed mutant expression patterns and in vitro data, it has been suggested that hunchback  protein acts as a dual regulator of kr : it activates kr at low hb concentrations and inhibits at high concentrations  <cit> . based on the previous findings that kr monomer can act as activator, while the homodimer can act as inhibitor  <cit> , a recent study has suggested that a similar dual role  can be played by kruppel  in its regulatory action on hb, and a model of this regulatory action is elaborated in that study  <cit> .

the main purpose of this study is to understand the functional organization of the gap gene regulatory regions by developing and applying an advanced model that takes into account the above extensions of our previous model for the gap gene network. we implement both the extended set of tfbss and the dual regulatory interactions between hb and kr in a series of the model variants with increasing complexity. the new variants of the model correctly describe wild-type expression of the four gap genes in the mid-embryo. they also correctly predict gene expression for a larger number of experimentally characterized cis-regulatory modules  in comparison to the previous model  <cit> . in the framework of the new model variants, we show that the tfbss with the strongest impact on gene expressions appear in all domains of the regulatory regions considered in the model. the analysis demonstrates how tfbss group into clusters of functionally important modules responsible for different spatial parts of the expression patterns, thus forming the in silico images of crms. we show how tfbss work in concert by elucidating the correlation between impacts on gene expression from tfbss of different tfs and from different regulatory regions. taking all together, the study sheds more light on the binding site organizational level of the gap gene regulatory network.

RESULTS
selection of binding sites
we predict binding sites using positional weight matrices  in the region spanning  <dig> kbp upstream and 6kbp downstream of the transcription start site of each of four gap genes hb, kr, kni, and gt and for eight transcription factors bcd, cad, hb, gt, kr, kni, tll, and hkb  <cit> . we apply two constraining factors for binding site selection in order to reduce false-positive predictions. according to the first constraint introduced in the previous work  <cit> , we use only sites belonging to dnase i accessibility regions and not overlapping with the coding sequence. however, this set of sites has only partial overlap with the experimentally verified cis-regulatory modules   <cit> , which drive expression in the trunk region of the embryo at the blastoderm stage, and thus misses a notable fraction of binding sites predictions. in this study, we additionally considered footprint sites and crms from redfly database  <cit> , which is a curated collection of known drosophila crms and tfbss. the full list of crms considered is given in table  <dig> and the number of sites for each target gene is shown in table  <dig>  this new list also includes predicted binding sites which overlap with the tfbss earlier verified by dnase i footprinting, thus allowing to assess their contribution to the model. the number of sites under consideration is  <dig> which is  <dig>  times more than  <dig> sites in the previous work.


hb
kr
gt
kni
hb
kr
gt
kni
columns correspond to target genes, rows to tfs.

combined model of gap gene network
in order to explore the functional importance of the selected binding sites in different contexts, we elaborate our previous model of gap gene expression hereinafter referred to as model  <dig>  <cit> . it describes the expression of four gap genes in a one-dimensional region on the central midline of the embryo , and the time period covering cleavage cycles  <dig> and 14a that are about  <dig> min and  <dig> min long respectively. cleavage cycle 14a is divided into  <dig> temporal classes  of  <dig>  minutes each. here, we briefly describe our approach and new incorporated enhancements.

the model derives the gap gene mrna and protein concentrations from the regulatory sequence. at the first step, we calculate the gene activation probability based on the statistical thermodynamics approach  <cit> . this approach links the gene activation probability to all possible molecular configurations of the regulatory sequence, representing different combinations of free and bound binding sites. the model incorporates homotypic cooperativity of binding proteins  <cit>  and short range repression  <cit> . at the second step, we use reaction-diffusion equations for the spatio-temporal dynamics of mrna and protein concentrations of the gap genes hb, kr, gt, and kni, with the time-delay parameter accounting for the temporal separation of transcription and translation processes.

we enhanced the model in three steps with increasing complexity. first, we added the synergy to the model by allowing several dna bound activators to interact with the basal transcription machinery  simultaneously . the synergistic effects of activators are represented in the previous variant of the model only via the homotypic cooperativity mechanism, while only one bound activator is allowed to directly interact with the btm in that model . it can be shown that the total synergistic effect from all activators will disappear at high activator concentrations under the cooperative binding model , but not under the multiplicative model. the maximal number of activators interacting with the btm is defined as a parameter nmax.

another improvement in the new variant of the model concerns the way how the solution is calculated. the gene activation probability in model  <dig> was calculated using the experimental data on protein concentration for tfs bcd, cad, tll, hkb and also hb, kr, gt, kni that are included in the model as target genes. the numerical solution of model equations for proteins is used in the new variant of the model as concentration profiles for tfs hb, kr, gt, kni, as generally expected when simulating differential equations. we use model  <dig> as the name for the model variant incorporating the synergy and the new simulation method.

secondly, we added to model  <dig> the dual action of tf hb on gene kr by replacing the single parameter for the strength of hb's action on kr by three parameters: a threshold concentration, an activation strength when hb concentration is smaller than the threshold concentration, and a repression strength when hb concentration is larger than this threshold. this variant of the model is called model  <dig>  finally, we modified model  <dig> by introducing a similar dual action of kr on hb and call this variant of the model model  <dig> 

another novelty for models 2- <dig> in comparison with model  <dig> concerns the data used for model fitting. the output of model  <dig> has previously been fitted to the data on gap protein concentrations from the flyex database  <cit> , while for the new models 2- <dig> we fit the output both to the protein data and to the rna data from the superfly database  <cit> . the optimization of parameter values is carried out by the differential evolution  method  <cit>  to minimize a combined objective function. this function is a sum of the residual sum of squared differences between the model output and the data, the 'weighted pattern generating potential'  <cit> , and a penalty term, which limits a growth of regulatory weights .

we performed about a hundred optimization runs in total for three model variants. it should be noted that several runs are needed due to the stochastic nature of the optimization method in order to find the parameters that provide the minimum value for the combined objective function. we obtained about ten solutions for each model variant with the objective function for proteins close to the value  <dig> reported for model  <dig>  the values of combined objective function for these solutions were  ×  <dig>   ×  <dig> and  ×  <dig> for model  <dig>  model  <dig> and model  <dig> respectively. we select the best model output from optimization runs which both has a small value of the objective function and contains a minimal number of visual defects in the expression patterns. the optimization results for models 2- <dig> yield solutions of comparable quality as for model  <dig> , and the corresponding gap gene expression patterns qualitatively match the data profiles in the wild type embryo . model  <dig> provides the best fit among the three new variants of the model. despite the overall satisfactory correspondence between the solutions and the data, all model variants bear some common inconsistencies in positioning of some domain borders and an expanded kni domain. on the other hand, the new solutions demonstrate a good balance between the fit qualities for mrnas and proteins, in contrast to model  <dig> whose fit quality has only been controlled for proteins. the typical defects in model solution are illustrated in figure s <dig> 

the regulatory parameters are presented in tables  <dig>   <dig>   <dig>  most features of the gap gene network topology are in agreement with previous modeling results and data from the literature  <cit> . bcd and cad activate zygotic gap gene expression in a majority of circuits. the only exception is the repression of gt by bcd in model  <dig>  the reciprocal interactions between the trunk gap genes kr, hb, kni, and gt are repressive. tll represses kr, gt, and kni and acts as activator of hb. hkb represses hb, kr, gt, and kni. gt autoactivates itself in all models. kr and hb autoactivate themselves in model  <dig>  but repress themselves in models  <dig> and  <dig>  kni autoactivates itself in models  <dig> and  <dig> and represses itself in model  <dig> 

rows 2- <dig> present regulatory parameters tab or target genes, while columns correspond to tfs. k, ω and τ are affinity, cooperativity and delay constants respectively. nmax  and qbtm  are the number of activators interacting with the btm and the btm affinity constant respectively. range is the range for repressor action in bps.

rows 2- <dig> present regulatory parameters tab  for target genes while columns correspond to tfs. the action of hb on kr is characterized by two coefficients for intensities less and greater than the threshold value . k, ω and τ are affinity, cooperativity and delay constants respectively. nmax  and qbtm  are the number of activators interacting with the btm and the btm affinity constant respectively. range is the range for repressor action in bps.

rows 2- <dig> present regulatory parameters tab  for target genes while columns correspond to tfs. the action of hb on kr is characterized by two coefficients for intensities less and greater than the threshold value . k, ω and τ are affinity, cooperativity and delay constants respectively. nmax  and qbtm  are the number of activators interacting with the btm and the btm affinity constant respectively. the range for the repression is shown in the same row. range is the range for repressor action in bps.

prediction of gap expression in reporter constructs
as the regulatory sequence adopted in the model contains both tfbss from known crms and other potentially strong tfbss from the accessible chromatin, it is an important test to verify how the crm's binding sites operate in the background of the rest of the tfbss. we do it by in silico predicting the crm driven expression in the model and comparing it to the experimental data. we model gap gene expression in reporter constructs by taking as input only those tfbs that overlap with a crm contained in a reporter  <cit> . tables  <dig>   <dig>   <dig> summarize results of sumulations.


hb
kr

gt
kni
hb
kr
gt
kni
columns correspond to target genes, rows to models.

the images of patterns of expression driven by crms cloned in reporter constructs and obtained by rna in situ hybridization with lacz probes are available for the majority of constructs under consideration  <cit> . from these data we determine what pattern elements of the endogenous gene are driven by the crm and compare the corresponding parts of data profiles with simulations. we report that prediction is correct if domains of the simulated pattern overlap with those observed experimentally .

model  <dig> has the best prediction power as it successfully predicts gap gene expression patterns in  <dig> constructs out of  <dig> in comparison to  <dig> and  <dig> correctly predicted by model  <dig> and model  <dig>  respectively.

given the fact that the models correctly predict the basic features of gap gene expression in the majority of the constructs we conclude that all the model correctly account for the functional role of most of the included crm's binding sites. these results also demonstrate the predictive power of the models.

interestingly, expression patterns driven by some crms  are not predicted by any model. a possible reason may be that some regulatory mechanisms are still missing in our model, or it is the tfbs prediction quality that limits the model power.

if the expression of the construct is predicted by a model, it is also predicted by subsequent models  with  <dig> exceptions: kni_+ <dig>  kni_223+ <dig>  kr_bdelnc <dig> . the most deviations in the predictions are for crms from the gt and kni regulatory regions : models  <dig> and  <dig> are essentially less accurate than model  <dig> in gt 's crm simulation, and models  <dig> and  <dig> are more accurate than model  <dig> in kni 's crm simulation.

impact of individual tfbs on model solution
we study the functional importance of tfbss under different modeling assumptions by calculating the regulatory weight  wrf of a tfbs:

 wrf=/fref, 

where f ∈ {rss,wpgp} is one of the two measures for the proximity of the solution to the data , fref is the value of f for the model solution for the full set of annotated sites, and fmut is the same value calculated with the site of interest excluded. therefore, wrf quantifies the input of the tfbs in the solution. to explore how the regulatory weight depends on the context , we analyze its values for all model variants, f measures and annotated sites.

we find that the rws estimated with rss and wpgp strongly correlate in the case of models  <dig> and  <dig> with pearson correlation coefficients r =  <dig>   and r =  <dig>  , respectively . the rw does not correlate with the pwm score, a measure of the binding affinity of the site . the absence of correlation between the rw measures and pwm scores is not surprising. the later reflects the strength of tf binding per se to dna and proceeds from the premise that neighboring positions in dna are independent, while the former measure considers the impact of tf removal on phenotype that is mediated by gene interactions in the network. it is worthy of note, that recently the comparative analysis of  <dig> drosophila genomes in a phylogenetic framework failed to find evidence that selective constraint across cis-regulatory sequences is correlated with predicted tf binding affinity  <cit> .

wrss
wwpgp
for model  <dig>  the rws estimated with rss and wpgp have a weaker correlation, r =  <dig>  , but also a bit more essentially correlate with the pwm score, r =  <dig>   and r =  <dig>  , respectively . the loss of correlation between the rws for the wpgp and rss measures indicates that the tfbss in model  <dig> encode for those properties of the expression domains which cannot be captured by the standard rss measure. as the wpgp measure is shown to be more than the rss one oriented on quantifying the constitutive spatial characteristics of the expression patterns, this result suggests that this variant of the model represents the functional role of tfbss more accurately. this also appears to be accompanied with the stronger connection between the site impact on expression and its binding affinity, although this connection remains generally weak, in accordance with our previous findings  <cit> .

interestingly, most of the inter-model correlations are weak or negligible except the one between wrss for models  <dig> and  <dig>  r =  <dig>   . the correlation between wwpgp for those models is almost twice lower, r =  <dig>  . these results demonstrate that models  <dig> and  <dig> with dual regulatory actions are closer to each other than to model  <dig> 

in figure  <dig>  we plot the rws of tfbss estimated with the rss measure in model  <dig> relative to their positions in a regulatory region. only a small number of sites demonstrate a high impact on the model solution, with the majority of sites having a relatively low individual influence. this finding supports our previous results  <cit> .

using the histograms of the tfbs rws , we select the threshold value for wrss equal to  <dig>  and for wwpgp equal to  <dig>  and further analyze the sites with wr exceeding these thresholds. the complete site lists are presented in tables s9-s <dig> in additional file  <dig>  there is a difference between the model variants in the way the strongest sites are distributed between distinct groups of tfbss, namely belonging to crms, dnase i accessibility region, or both . in model  <dig>  tfbss from crms play the most important role. all regions contribute approximately similar in model  <dig>  in case of model  <dig>  the majority of important sites belong to both crms and the dnase i accessibility region.

columns correspond to regions, rows to models.

figures  <dig> and  <dig> demonstrate that most of the tfbss are relatively weak and only a few sites are strong in the model with respect to their influence on gene expression. on the other hand, it is not possible to neglect even a small portion of the weak sites without visible reduction in the model output quality . these facts together define the concept of many weak binding sites working in concert, as opposed to the concept of a small number of strong sites controlling everything. it has been shown previously with the help of evolutionary simulations in a similar modeling framework how such enhancer organization may eventually appear during the evolution  <cit> .

differential expression of individual tfbs
we further study how the impact of each tfbs on gene expression is distributed in space and time and how these spatio-temporal impact distributions correlate for distinct binding sites. we calculate the impact distribution for a given tfbs by setting the diffusion rate parameter to zero in the model equations and computing the difference in all nuclei and at all times between the solution for the case with all sites included and the solution for the case with the binding site of interest excluded. we do it for all sites and for all new model variants. setting the diffusion rate equal to zero does not lead to significant perturbations of the expression patterns in the model  and, hence, can be used for the analysis.

figures  <dig>  s <dig>  and s <dig> show the correlation matrices for the tfbs impact distributions calculated for models  <dig>   <dig>  and  <dig>  respectively. the color in the figure represents the level of correlation between the impact distributions for each pair of tfbss. if the correlation is positive, the affects of these two tfbss on gene expression are similar in different nuclei and at different times , i. e. these affects have the same sign. if the correlation is negative, the impacts from the two sites are of different signs across time and space . the absence of correlation means that for some nuclei and time points the impact from the two sites can be of the same sign, while for others of the opposite signs. the sites are ordered in alphabetical order by target gene  and, secondly, by tf  in each group.

the clusters of highly correlated sites appear in the figure as big square islands of yellow or red color. for model  <dig>  the majority of these clusters are located on the main diagonal and for the regulatory regions of hb, kni, and kr . this is quite expected result as these tfbs belong to one regulatory region and have either the same or opposite impact on gene expression. in contrast, the bcd sites in the gt regulatory region have high positive correlation with the hb sites in the hb regulatory region . this correlation demonstrates an indirect interaction between the bcd and hb binding sites: bcd activates gt, and gt represses hb, so the net effect of the bcd sites on hb is repression, and the same effect is true for the hb sites on hb in model  <dig>  as the clusters of highly correlated sites are mainly located on main diagonal, we conclude that this model variant has low amount of indirect tfbs interactions.

the correlation matrix for model  <dig> leads to many yellow squares outside of the diagonal, corresponding to highly correlating sites in the regulatory regions of different genes due to indirect interactions . the case of model  <dig> is somewhere in between with respect to the number of the off-diagonal yellow and red islands . the color intensity of those islands  is also lower than for model  <dig>  the moderate impact of indirect interactions is intuitive as they are known to be present but are side-effects of the primary regulatory mechanisms. as the number of sites with strong impact is less than  <dig> for each model, the clusters of sites with high positive or negative correlation can be seen as the illustration of relatively weak impact sites playing in concert. it should also be noted that these indirect effects cannot be captured with model  <dig> from  <cit> . this is because, by definition, the indirect connection between a tfbs for a tf va with a tfbs for a tf vb takes place only via the influence on another solution component vc. as mentioned above, the solution in model  <dig> is calculated by solving equations with the synthesis term that depends only on the data tf profiles at any time, not on the solution, and the data profiles evidently are not influenced by the tfbss.

as opposed to figure  <dig>  figure  <dig> shows the spatial distribution of impacts of different tfs on hb expression. despite the zero diffusion coefficient that prevents the direct transfer of the gene products between the nuclei, the impact of a site may cover several adjacent nuclei with variable magnitude due to regulatory interactions as shown in the inset of figure  <dig> by different color intensities for individual nuclei represented by small rectangles.

it can be seen from figures  <dig> and  <dig> that a single tfbs can act both as an activator and a repressor of hb depending on the spatial position. for example, some bcd sites activate hb in the posterior domain and repress in the anterior one . this change of the regulation sign may happen only due to interaction with an intermediate tf. as bcd activates hb, the direct impact of its binding sites on hb expression can be only activating. however, bcd also activates all other inhibitors of hb , so that its binding sites can indirectly repress hb expression in specific positions.

CONCLUSIONS
we presented new modeling results in the framework of the two-layer model for gap gene expression. the previously formulated model  <cit>  had serious drawback, namely the gene activation probability was calculated using the experimental data on tf protein concentration for target genes hb, kr, gt and kni. here, we introduced several new model variants in which the numerical solution of model equations for proteins is used as concentration profiles for these tfs, as generally expected when simulating differential equations.

other improvements include the addition of synergy by allowing several dna bound activators to interact with the btm simultaneously, dual action of tf hb on gene kr or dual regulatory interactions between hb and kr. all the model variants consider the information about all experimentally characterized crms for this developmental system. for all assumptions, the model qualitatively describes the characteristic features of gene expression patterns. however, from the obtained regulatory parameters we may conclude that the assumption about the dual interaction between hb and kr leads to the most consistent results.

the defects present in the expression patterns predicted in all variants of the model can have multiple reasons. the thermodynamic modeling approach has its own limitation. for example, it does not take into account the dynamical effects of the enhanceosome assembly  <cit> , which might influence the relative probabilities of different molecular configurations of the regulatory regions. the implemented methods for tfbs search may also contain errors, leading to possible mispredictions for binding sites. the imperfect expression pattern for hb can be explained by the complex two-promoter structure of this gene, with different enhancers influencing different promoters  <cit> , which currently is not taken into account in our model.

the difference in parameter values between the model variants represents the influence of different modeling assumptions in these variants and cannot be explained by the overfitting or parameter nonidentifiability issues, as we have shown previously that the model is relatively stable in this respect  <cit> . this difference underlines the disagreement between the models in the predicted correlation patterns for the impacts of tfbss on gene expression and the functional organization of the regulatory regions. as the model variant with the dual interactions between hb and kr  is more consistent in terms of the topology of the regulatory network and in terms of the predicted crm's expression, we believe the results obtained for this model variant deserves more attention. however, additional experimental validation is necessary to make a definite decision.

our results are in agreement with the previously formulated regulation concept of many weak binding sites working in concert  <cit> , following the idea of homotypic binding sites clusters  <cit> . it is hard to define a threshold for the functional importance of binding sites under this concept, and it makes the problem of selecting the complete set of important binding sites more vague. we applied a combined approach for this selection by joining two sets of potential binding sites, high-affinity tfbss from the open chromatin domain and experimentally characterized tfbss irrespective of their position in the sequence. some tfbss with high functional impact from the hb, kr, and kni regulatory regions coincide with the strong sites annotated and verified in the dnase i footprint assays. as the majority of functionally important sites in the best model variant belongs to the intersection between the dnase i accessibility region and experimentally characterized crms, we conclude that there should be a balance in binding site selection for modeling gene regulation. the existing information about crms is essential, but is not enough to fully determine the expression patterns. on the other hand, our results support previous findings about importance of the dnase i accessibility regions usage for modeling  <cit> .

our model allows to estimate the effect of individual tfbs on molecular phenotype, gap gene expression patterns. this effect is mediated by interactions between different bound tfs. an important advantage of new model variants is their ability to account for indirect interactions between individual binding sites. the analysis reveals specific examples of such binding sites in the regulatory regions of the gap genes and elucidates the regulatory mechanism for their interplay. this mechanism provides a potential basis for the evolutionary compensatory effects such as the binding site turnover  <cit> . however, not all variants of the model demonstrate the indirect interactions between the sites. comparing different modeling assumptions in this context, we conclude that the presence of the dual regulatory action probably obscures existence of such regulatory compensations.

the presented two-layer modeling framework might be applicable to other gene regulatory networks previously described by odes alone ,  <cit>  ) given the data on tfbss, pwms and expression patterns are available.

