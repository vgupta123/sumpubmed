BACKGROUND
as our ability to investigate molecular mechanisms in biology at finer resolutions improves, there is increasing interest in generating reliable gene expression profiles for smaller biological samples, down to the level of the single cell and potentially subcellular compartments. single-cell gene expression profiling provides a powerful tool to analyze the composition of complex cell populations  <cit> . there are many contexts in which the focus is shifting towards understanding the cellular networks of individual cells  <cit>  and the similarities and differences between individual cells at the transcriptional and translational level  <cit> .

limitations to the sensitivity and resolution of current technologies for studying gene expression mean that when using samples as small as those generated from single cells we are inevitably faced with amplifying cellular mrna. although the most common method for evaluating large-scale gene expression is through microarray technology  <cit> , the problem will be the same for any experimental method that requires transcript amplification to produce useful quantities of material to be analyzed, including real-time pcr and serial analysis of gene expression   <cit> . the amplification stage may, however, introduce significant distortions in the measured gene expression levels, especially for genes with small numbers of transcripts in the material under study. this distortion is introduced by sampling effects that arise from inefficiencies in the processes of copying and amplifying the original mrna pool.

in a complex mrna population with small absolute numbers of individual transcripts, such as that from a single eukaryotic cell, sampling effects can result in only a subset of the population of starting rna molecules being represented in the final amplified population. this is particularly problematic for low copy number transcripts in single cell samples: in the first step of the process, reverse transcription may fail for a small proportion of the original mrna molecules, which would therefore be eliminated from subsequent amplification and detection. for genes with only a small number of transcripts in the starting material, this will create a variable  distortion in the relative representation of transcript abundances in the final experimental sample, potentially leading to the absence of such low abundance transcripts in the final amplified population. the first round of pcr amplification will have a similar effect, and subsequent rounds will have effects of diminishing importance, in terms of complete dropout of low-abundance transcripts.

the overall effect of random dropouts of low abundance transcripts from amplified single cell cdna populations would be that random sets of transcripts would be called as absent in different cells. observations consistent with such sampling effects in single cell expression analysis have been reported previously, leading to the proposal that there are limits to the reliable detection of gene expression from small samples <cit> . for example, one estimate is that there is a lower limit of  <dig> copies of a single mrna per cell for detection of two-fold differences between samples <cit> . despite these empirical predictions, the nature and significance of sampling effects for single cell expression profiling have not been systematically studied to date.

the magnitude of the overall sampling effect will, in theory, depend on two factors: the transcript abundance distribution, which is the variation of transcript number among genes being expressed in a cell ; and the copying and amplification efficiencies for conversion of the original population of mrna molecules into dna or rna detectable by the expression profiling platform in use. we have previously demonstrated that a global polyadenylation and pcr-based amplification technique generates reliable data from picogram amounts of rna  <cit> , although that study did not measure the efficiency of conversion of original mrna transcripts into cdna copies. the copying and amplification efficiencies can be estimated from experimental data. however, the estimation of the transcript abundance distribution poses two distinct problems: knowing the form of the distribution; and evaluating the shape and scale parameters for the distribution.

there are conflicting reports of the transcript abundance distribution in a typical eukaryotic cell, ranging from a distribution with a median value for mrna transcript copies per gene of less then one  <cit> , to a distribution with a median of approximately  <dig> copies  <cit> . the difficulty is that, in general, the transcript abundance distributions of real single cells are not known but are inferred from population measurements . based on published data  <cit> , a simple approximation is that the transcript abundance distribution is log-log-normal, as this distribution captures certain key features of our current understanding of the single cell transcript abundance distribution: there is a high number of genes with transcript abundances lower then 10– <dig> and relatively few genes with high transcript abundances . for the purposes of modeling single cell expression data we use that distribution for this work, with the additional assumption that such a population-based distribution is reflected in the underlying single cell transcript abundance distributions.

the purpose of this work was to systematically evaluate the presence and significance of sampling effects in pcr-based global amplification-based single cell expression profiling. we investigated whether observed variations in gene expression levels in single cell samples could be artifacts of the experimental method, how much sampling effects contribute to variability in single cell expression measurements, and, finally, if global amplification techniques can be reliably used for the detection of differences in gene expression among single cells. we conclude that significant differences in gene expression levels exist between phenotypically identical cells in vivo, and that these differences exceed any noise contribution from global mrna amplification.

RESULTS
conceptual approach
variation in microarray-based, single cell expression measurement is contributed to by  technical noise intrinsic to the microarray platform;  sampling effects caused by non-representative amplification of low abundance mrna transcripts; and  real differences in gene expression levels between two samples. it was not possible to measure directly sampling effects in pairwise hybridizations comparing gene expression between individual cells , because at the outset of this research we did not know if two phenotypically identical cells were identical at the transcriptional level. however, it is possible to estimate and model sampling effects using computational methods.

to do so, we performed the following steps to identify the sources of variation and noise in single cell microarray-based expression profiling :

 <dig>  estimation of technical noise;

 <dig>  measurement of the efficiency of the amplification technique;

 <dig>  generation of experimental microarray data comparing gene expression between two half-samples from the same cell ;

 <dig>  estimation of the single cell transcript abundance distribution from monte carlo simulations, by finding the distribution with the best fit to experimental half-vs-half data ;

 <dig>  simulation of gene expression data including observed sampling effects for pair-wise cell-vs-cell hybridizations using findings from 1–4;

 <dig>  generation of actual microarray data for cell-vs-cell hybridizations and comparison with simulated cell-vs-cell data.

estimation of technical noise
to calculate technical noise we conducted replicate hybridizations of mrna isolated from the developing mouse dorsal forebrain . as our purpose was to calculate technical noise, we wished to avoid sampling effects in the initial reverse transcription and pcr steps. therefore, we used a sufficiently high amount  of total rna in the initial reverse transcription and first  <dig> cycles of pcr. reverse-transcribed cdna was then used for an initial  <dig> cycles of pcr amplification, following which 1/200th of that pcr product was used for a further  <dig> cycles of pcr amplification. two replicates were then labeled and co-hybridized on expression arrays. the data shown represent the average data from two dye-swap hybridizations plotted as a frequency histogram of log expression ratios and a typical microarray plot where log expression ratios are plotted against average log signal intensities . the distribution of expression ratios demonstrated very low variability between two independently amplified replicates, with standard deviation  values varying from  <dig>  to  <dig>  . the measured expression ratio distribution for technical noise  was used in subsequent model computations. for comparison, a typical frequency histogram and microarray plot for a comparison of gene expression between two halves of the same cell  are also shown .

estimation of global amplification efficiency
to estimate the overall efficiency of transformation of the original mrna sample into detectable pcr product, it is crucial to know both the efficiency of reverse transcription of mrna into single-stranded cdna and the efficiency per round of the subsequent pcr amplification process. distortion of the original mrna profile is most severe for losses during the early stages of this process, and we estimate that after seven cycles of pcr amplification that the further impact on the expression profile is negligible. from measurements of cdna mass during the process ; we estimated that the initial copy step  was 94–96% efficient, and that each subsequent pcr cycle was >99% efficient. combining these values, and imposing a seven cycle limit on the effect on overall efficiency, gives us a value of 90% for the overall efficiency of transformation of the original mrna sample into detectable pcr product.

generation of data comparing gene expression between two halves of the same cell: 'half-vs-half' comparisons
the first step in the process to estimate the typical single cell transcript abundance distribution was the generation of expression data comparing two halves of a single cell. the key to this approach was that by comparing data from two halves of the same cell we guarantee that the two samples were drawn from the same transcript abundance distribution , and that this is true for both the experimental and the simulated data . thus, the model abundance distribution should then apply when the same cell types are used in a straightforward two-cell comparison.

to generate these data, total rna from four individual neocortical progenitor cells was split into two halves and each half independently amplified. each set of two paired half-cell cdnas was compared to one another in two dye-swapped replicate comparisons in a series of eight microarray hybridizations. these data were then used to calculate the average gene expression ratio distribution when comparing two halves of the same cell .

modelling transcript abundance distribution
in this study, we assume that the general form of the transcript abundance distribution for single cells is log-log-normal described by the equation:

 g=1xσ2π×exp⁡2/2), 

where g is the number of genes with t transcripts, t is the transcript number and x = ln. the scale parameter μ determines the most common transcript number, and the shape parameter σ determines the width of the peak about the most common transcript number.

in order to estimate the most likely transcript abundance distribution for the single cells analysed here, we varied the scale and shape parameters of the distribution to better fit the experimental distribution observed in the 'half-vs-half' microarray data. there are some additional constraints: the number of active genes in the cell  and the total number of transcripts in the cell. clearly these must lie within biologically meaningful limits. the consequence of this was that we could define a model cell as having g active genes and t total transcripts, and then for a given value of the scale parameter μ there was only one value of the shape parameter σ that would populate the model cell with the correct numbers of genes and transcripts, giving a specific transcript distribution. this simplifies matters somewhat as we now do not have to search all possible values of μ and σ in order to cover the feasible range of realistic model cells. for each model cell we used values of μ such that the most common transcript number varied over a range from ~2– <dig> to ~ <dig>  values outside this range are likely to represent unfeasible distributions.

preliminary analysis of the experimental data from our pairs of real single cells showed an average of ~ <dig>  genes per experiment with a measurable gene intensity ratio, with ~ <dig>  probes on the microarray. we created a range of  <dig> model cells using gene numbers between  <dig>  and  <dig>  and total transcripts between  <dig>  and  <dig> million . in the event, this empirically chosen range was sufficient. for each model cell we created ~10– <dig> specific distributions for values of μ in the range  <dig>  – ~ <dig>  , giving us a set of  <dig> specific distributions. each specific distribution consisted of a vector of pairs of values: a gene transcript number and the number of genes with that number of transcripts .

estimation of parameters of transcript abundance distribution fitted to half-vs-half microarray expression data
we ran a simulation for each model transcript distribution to create simulated half-cell log intensity ratio distributions. the simulated half-cell log intensity ratio distributions for each transcript distribution for the various model cells were then compared with the real log intensity ratio distribution from the experimental comparison of two half samples of mrna from the same cell. to measure the fit between the real and simulated data we used the root mean square  difference on the vertical axis of the intensity distribution over the log ratio range - <dig>  to + <dig>  averaged over the runs for each distribution.

the closer the fit between the real and simulated microarray data, the closer the model distribution will be to the transcript distribution in the real cell . the basic cell model  varied quite widely over the best fit distributions but the best fit distributions themselves showed considerable consistency, with μ values around  <dig> . plotting the peaks of all these distributions shows even more clearly the strong correspondence between the distributions and fit with the two half-cell real data . from this we conclude that although we cannot determine the basic cell model with any accuracy, we can estimate the probable transcript distribution for cells of the type in this study as being that for which the most common transcript number ~ <dig> and the number of genes with that transcript number ~ <dig> 

single neural stem cells demonstrate considerably greater differences in gene expression than predicted by a sampling model
if single phenotypically identical cells are very similar at the transcriptional level, we would expect that the simulated microarray data would approximate results produced from real expression data. to test this, we generated data comparing expression between twelve single, murine embryonic neural stem cells in a series of pairwise hybridizations that were repeated as dye-swapped replicates. these cells were chosen because they are phenotypically identical, neurogenic neural stem cells isolated from the same region of the mouse neocortex at a single developmental timepoint at which they have a cell cycle length of approximately  <dig> hours.

analysis of the gene expression data from those cells identified significant transcriptional differences among these cells . comparing these data from real cells with our simulated microarray data found that the datasets were notably different in the spread of expression ratios . this can only reasonably be explained on the basis that there are widespread and significant variations in individual gene expression levels amongst real cells of this type even though they are phenotypically identical.

discussion
the main findings of this study are that the contribution of sampling effects to observed single cell expression data is likely to be minor and that substantial transcriptional differences exist between phenotypically identical cells. this indicates that one can generate reliable gene expression profiles from single cells using microarrays to interrogate globally amplified rna populations. however, the considerable variation in gene expression levels between similar cells is likely to dictate that relatively high numbers of cells would need to be analysed to robustly identify significant and consistent differences in gene expression between cell populations. alternatively, these findings argue that single cell expression profiling will be particularly useful for identifying absolute differences in gene expression between cell types.

a second implication of this study is that one important limit on the use of amplification techniques for single cell expression profiling is that if amplification efficiency drops significantly below 90% then the sampling effect may considerably distort the measured expression profile. if the goal of a given investigation is to use sub-picogram samples of rna or to measure very rare transcripts, than the efficiency of amplification becomes even more important. there are several amplification techniques that have been used for single cell expression profiling  <cit> . one promising technique for mrna amplification from individual cells, which combines global exponential and linear amplification, has been shown to produce very low levels of noise and highly reproducible data and may limit the significance of sampling effects when profiling rare transcripts  <cit> .

the majority of transcripts are present at relatively low abundance
our results demonstrate that the actual transcript abundance distribution for the tested cell type has a peak at approximately 5– <dig> copies per gene. we recognize that our experiments are based on a particular type of mouse neural stem cell, but in the absence of any reason to suppose that the transcript distributions of most other cell types are radically different from this, we believe the result should generally apply to expression experiments performed on a wide range of cell types.

previous work has demonstrated that the distribution of mouse transcript abundances in e <dig>  embryonic, placental, and cultured embryonic and trophoblast stem cells are highly similar, suggesting that such distributions are not heavily skewed according to tissue structure or function  <cit> . that study estimated that the percentage of transcripts present at less than an average of one copy per cell ranged from  <dig>  to  <dig> % in the four tissues  <cit> . we propose that the typical transcript abundance distribution in eukaryotic cells is log-log-normal, consistent with previously published results in which the shape of transcript abundance distribution appears to be log-log-normal  <cit> . although our method did not allow us to discriminate between different models of overall gene and transcript numbers in the cell, we believe it strongly suggests that more then 85% of transcripts are present in relatively low copy numbers .

phenotypically similar cells demonstrate variability within population
we compared gene expression among twelve phenotypically identical neural stem cells randomly taken from the developing mouse neocortex. at this stage of development the population of stem progenitor cells is expected to be homogeneous  <cit> , although these cells are not synchronized with respect to their position in the cell cycle. therefore, we are confident that the observed diversity of gene expression does not reflect cellular heterogeneity. similar and even higher diversity has been found for other cell types, including neurons , and again this seems to reflect real differences in gene expression levels of individual cells.

one possibility is that the difference in cell expression levels profiles we discovered could be a result of stochastic fluctuations of mrna levels and to be an intrinsic characteristic of the cell's behaviour. the variation in the transcript levels between homogeneous, phenotypically identical cells remains undefined, but growing evidence indicates that phenotypically similar cells are not identical at the transcriptional level. insight into the variability of the gene expression profiles of single cells has been obtained using a number of technical approaches, incuding microarray analysis following linear t7-based amplification  <cit> , multiplexed fish   <cit>  and quantitative pcr  <cit> . transcriptional bursting has been observed in escherichia coli, in which protein levels have very little correlation with mrna levels, particularly for younger cells  <cit> , as well as dictyostelium  <cit>  and mammalian cells  <cit> . in mammals, the study of expression levels of several genes in individual mouse pancreatic islet cells by real-time pcr revealed high heterogeneity within the population of tested cells  <cit> . overall, those findings are consistent with a model for cellular phenotypes that are underwritten by transcriptional programs that appear inherently noisy when total cellular transcript levels are measured at the single cell level.

it has been suggested that because in the individual cell the transcriptional machinery is controlled by a relatively small number of transcription factors, it may result in stochastic behavior in gene activity. our current results revealed that the majority  of genes are represented by limited number of mrna copies , and this may account for the large cell-to-cell variations in mrna copy number that we have observed.

CONCLUSIONS
we have addressed the degree of transcriptional variation between phenotypically identical cells by using a simple and informative approach to estimate the sampling effect introduced by single cell cdna amplification and expression profiling. comparing those simulated data with data generated from single neural stem cells confirmed that sampling effects do not impede our ability to extract reliable gene expression profiles from single cells and that significant differences in gene expression levels exist between phenotypically identical cells.

