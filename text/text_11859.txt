BACKGROUND
bacteria, long thought having a solitary existence, were found to communicate with one another by sending and receiving chemical messages  <cit> . their communication mechanism results in the ability to synchronize the activity of the colony as a whole. the latter leads to a coordinated behaviour that in some cases resembles that of multicellular organisms, e.g. the so-called community effect during development  <cit> . thus, by means of the quorum sensing  mechanism, cells produce, export, and import signalling molecules . as the colony grows, more cells produce and export autoinducer, leading to an increasing concentration of the signalling molecule in the environment and in the cells. upon reaching a concentration threshold, the autoinducer activates the expression of qs-controlled genes therefore coordinating the cells in a density-dependent manner. importantly, qs controls a number of relevant phenotypic changes in bacteria as for example the virulence in s. aureus <cit> . in addition, it has become a model system for studying the emergence of coordinated behaviour in communicating cells. all in all, qs has opened a research field with promising technological applications  <cit> , as for example, the environmentally controlled invasion of cancer cells  <cit> .

the qs systems in gram-negative bacteria share a core network architecture. in this regard, a characteristic model system is the luxr/luxi regulatory network in vibrio fischeri <cit> . luxr protein is an autoinducer-dependent activator of the lux operon that drives the autocatalytic expression of luxr and of the autoinducer synthase, luxi, together with that of the genes responsible for the production of bioluminescence. the up-regulation of luxi increases the production of autoinducer molecules that in turn activates further gene expression. the resulting positive feedback loop leads to a bistable switch-like behaviour depending on the concentration of the autoinducer as shown by in silico <cit>  and in vivo experiments  <cit> . such switch-like behaviour has been observed at the population level by measuring the average gene expression level. however, how individual cells behave remains puzzling. in fact, as observed in vibrio harveyi <cit> , vibrio fischeri <cit> , pseudomonas aeruginosa <cit> , and luxi/luxr-gfp strains of e. coli <cit> , the cellular response to qs signals seems to be highly heterogeneous at the level of the distribution of both the population phenotype and the response times of individual cells.

a number of studies have shown that noise plays an important role in bistable systems  <cit> . therefore, the aforementioned heterogeneity may be caused by the random fluctuations that unavoidably affect cell regulation and signalling. this poses the intriguing question of how cells achieve a coordinated response in the presence of noise. indeed, the qs mechanism may produce a robust and synchronized behaviour at the level of the population both experimentally  <cit>  and theoretically  <cit> . however, how this behaviour at the collective level arises from the stochastic dynamics of individual cells is still an open question. at the end, in the framework of qs, a collective response means a precise information exchange in the colony. consequently, how can a bacterial population estimate its number of constituents precisely if such information is fuzzy at the single cell level? herein, we shed light on this problem and investigate how noise affects the qs transition both at the level of individual cells and at the level of the cell population.

in the context of qs modelling, most research has focused on the understanding of the intracellular circuit  <cit> , i.e. single cell studies, while few of them have considered an ensemble of communicating cells  <cit> . yet, so far no study has taken into account the coupling of the signalling mechanism at the single cell and collective levels by stochastic means together with realistic dynamics of the proliferation process. in this work, we model the qs mechanism by using both deterministic and stochastic approaches and taking into account the key regulatory interactions between luxr and luxi, the autoinducer transport, the cellular growth and the division dynamics. our results indicate that the cell response is highly heterogeneous and that noise in the gene expression of luxr is the main factor that determines this variability. moreover, we show that the transition of the qs switch near the critical concentration of autoinducer is very slow compared to other characteristic temporal scales of the process and that, as a consequence, the non-stationary effects are crucial for setting a precise switch. as we show further below, the dilution due to cell growth and division is a key element required for an in-depth understanding of the qs response dynamics. in addition, we demonstrate that noise, depending on the cell density, can either prevent or promote phenotypic changes indicating a beneficial role played by stochasticity. altogether, we find that the precision of the qs switch for determining the number of cells in the colony is highly dynamic and context dependent, which in turn favors adaptability.

methods
modelling of the luxi/luxr gene regulatory network
the regulatory interactions that control the wild-type lux operon are more complex than first thought  <cit> . those include both positive and negative regulation of the luxr gene depending on the concentration of the autoinducer  <cit> . simplified synthetic constructs, such as lux <dig> and lux <dig> <cit> , retain the minimal luxi/luxr regulatory motif and lack the structural genes responsible for light emission that may also play a regulatory role, e.g. luxd <cit> . still, these constructs reproduce the main features of the wild-type operon as revealed by gfp tags reporting the promoter activity  <cit> . in addition, lux <dig> and lux <dig> constructs allow to perform controlled experiments that have shed light on the wild-type dynamics and its regulatory interactions. herein, we follow this approach and focus on the lux <dig> and lux <dig> constructs as well characterized examples of the behaviour of the wild-type operon. the lux <dig> operon lacks the luxi gene and only gfp is transcribed in that direction. on the other hand, the lux <dig> operon carries a luxi::gfp fusion. accordingly, lux <dig> cells cannot produce their own autoinducer and the induction in that case is driven by adding exogenous autoinducer to the medium. figure  <dig> shows schematically the regulatory interactions we consider in our model. the autoinducer molecules  are produced due to the action of their synthetase, luxi, and bind to the cytoplasmic protein luxr  creating a complex . the latter binds to the promoter region activating both the transcription of luxi::gfp  and luxr. signalling molecules can diffuse passively in and out the cell and contribute to increase the external concentration of the autoinducer  that can be eventually modified by an external influx of molecules  and a dilution protocol . in our model we consider that signalling molecules degrade at the same rate whether they are cytoplasmic or not. finally, we consider a dna duplication process. such modelling scheme can be formally written as a set of chemical reactions:

 dna→αrkrdna+mrnaluxrdna→αikidna+mrnaluxi::gfpdna·luxr·a2→krdna·luxr·a2+mrnaluxrdna·luxr·a2→kidna·luxr·a2+mrnaluxi::gfpmrnaluxr→prmrnaluxr+luxrmrnaluxi::gfp→pimrnaluxi::gfp+luxi::gfpluxi::gfp→kaa+luxi::gfpluxr+a↔k1−k1−/kd1luxr·a2luxr·a↔k2−k2−/kd2luxr·a2luxr·a2+dna↔klux−klux−/kdluxdna·luxr·a2a↔rddaexta→da∅aext→da∅mrnaluxr→dmr∅ 

  mrnaluxi::gfp→dmi∅luxr→dr∅luxi::gfp→di∅luxr·a2→dc2∅luxr·a→dc∅dna→ln/τdna+dnadna·luxr·a2→ln/τdna·luxr·a2+dna. 

as revealed by the set of reactions , we assume that the regulatory complex  <dig> activates the transcription of luxi and luxr in opposite directions upon binding to the dna. these reactions account for the main regulatory interactions of both lux <dig> and lux <dig> constructs. since lux <dig> lacks the luxi gene the autoinducer, a, cannot be synthesized, i.e. ka= <dig>  and an exogenous supply of the signalling molecule is required to induce the system. the expression rates of luxi and luxr depend on the initiation rate of transcription, the speed of elongation, the length of the transcript, and the rate of translation and postmodification into functional proteins. we take into account the differences due to these intermediate processes in an effective manner by using different transcription/translation rates for the luxr and luxi::gfp genes. note that we assume that there are basal transcriptional rates, αrkr and αiki, even though the regulatory complex  <dig> is not bound to the promoter region of the dna. still, since αr,αi≪ <dig> , the maximum transcriptional rates take place when the activator complex is bound.

deterministic and stochastic approaches: cell growth and division
the equations  lead to a master equation description that can be sampled exactly by means of the gillespie algorithm  <cit> . this approach is suitable for the characterization of the system at the single cell level. complementary to this, if the number of molecules of the species is large enough such that the fluctuations can be neglected, a set of ordinary differential equations  can be derived from eqs.  . the odes formalism is then appropriate to account for the behaviour at the colony level since noise averages out in that case. herein we make use of both stochastic and deterministic descriptions as follows. as for the deterministic model, we consider that all cells share their cytoplasm in a single volume vc,tot. chemical species x inside the cell are described by their concentration, cx, in vc,tot. therefore, this model can only be used to study the dynamics of species averaged over all the cells in the population. from an experimental point of view, the population average can be measured determining the average bulk fluorescence of the gfp reporter of the cell culture by means of a fluorometer or by averaging the fluorescence data obtained with a flow cytometer.

we notice that our in silico experiments span up to  <dig> hours of cell culture growth in some cases . thus, regardless of the description, and in addition to the dynamics of the regulatory network, we also need to take into account the effects of cell growth. if cells are maintained in the exponential phase with doubling time τ then the dynamics of the volume of the cell is vc,tot=v <dig> tot2t/τ. where v <dig> tot=nv <dig>  n being the number of cells in the colony and v0the volume of a single cell at the beginning of the cell cycle. as a consequence, the cellular growth introduces dilution terms, −cxlnτ, in the r.h.s. of the odes of all species, with the exception of the autoinducer in the medium aext. on the other hand, cell division events lead to the duplication of the genetic material. the latter is taken into account by adding the term +lnτcdna+cdna·luxr·a <dig> to the ode that describes the concentration of dna. this term compensates exactly for the cell growth dilution such that cdna,tot=cdna+cdna·luxr·a <dig>  i.e. the total concentration of dna, is kept constant.

in our simulations, as in the experiments we aim to reproduce, the cell density is kept constant. this can be achieved by means of an external dilution protocol  that compensates for cell proliferation. we then keep the volume vc,tot constant and define the external volume, vext, such that the total volume of the cell culture reads vtot=vext + vc,tot. accordingly, the parameter r, see equations , reads r=vc,tot/vext. we assume that molecules are homogeneously distributed inside both the cytoplasm and the external volume . finally, the resulting odes are numerically integrated.

in order to study the role of noise in a population of cells communicating by qs, we build also a stochastic model of a population of bacteria. in this case, each bacterium is described as a single cell carrying a copy of the regulatory network. the ensemble of all the chemical reactions in all cells, including the diffusion reaction, are treated as one global system. we apply the gillespie algorithm  <cit>  to compute the time of the next reaction, choose the reaction channel from the list of all possible reactions and update the number of molecules according to the reaction stoichiometry. we model the system of cells as a global stochastic system in order to simulate as exactly as possible the stochastic dynamics of all chemical species, in particular that of autoinducer molecules. the noise in the signalling molecule originates from different sources: randomness in its synthesis by luxi, fluctuations at the level of the number of molecules of luxi, and randomness in the diffusion reaction of the autoinducer. the latter is particularly important since it leads to correlations between cells as follows. an autoinducer molecule can diffuse out of the cytoplasm of one cell into the medium, thereby increasing the number of molecules in the external volume by one; this increase in the level of aextchanges the probabilities of an autoinducer molecule to diffuse into any other cell. thus, all the cells are coupled through the diffusion reaction. we note that while a possible optimization of the algorithm relies on parallelizing the code such that each cell evolves independently  <cit> , this approximation is prone to introduce errors in the dynamics of the signalling molecule because the aforementioned correlations are neglected.

as mentioned above, cell growth introduces a dilution of the molecules in a cell. we implement cell growth in our stochastic model by allowing the volume of cell i to change in time as, 

 vc,i=v02t/τi, 

 where v0is the volume of a cell at the beginning of the cell cycle , τiis the duration of the cell cycle of cell i, and t is referred to the precedent division event. when t=τi the cell i has doubled its volume and a new division takes place. at this time the internal clocks and volumes of daughter cells are reset to zero and v0respectively. moreover, when a cell divides, proteins, mrnas and signalling molecules are binomially distributed  <cit>  between daughter cells and one copy of the dna is given to each cell. we note that regulatory complexes bound to the dna are detached prior to the distribution between daughter cells. as in the case of the deterministic model, we assume that the cell density is maintained constant during experiments due to a compensational external efflux that wash away cells in the culture . in relation to the effect of the cell volume of individual cells on the diffusion rate of the autoinducer, we note that in this case, 

 rit=vc,ivtot−∑j=1nvc,j. 

the duration of the cell cycle, τiis different for each cell and is set independently after a division according to the following stochastic rule  <cit> , 

 τi=λτ+1−λτ~, 

 where τ and τ~ denote, respectively, the deterministic and stochastic components of the cell cycle duration, and λ∈ <cit>  is a parameter that weights their relative importance. the stochastic component accounts for the period of time between events driven by a poissonian process and satisfies an exponential distribution, 

 ρτ~=e−τ~ττ. 

in this way, we allow variability from cell to cell in regards of the duration of the cell cycle, yet setting a minimum cell cycle duration, λτ. according to these definitions, the average duration and standard deviation of the cell cycle are τ and τrespectively.

finally, we notice that in principle the gillespie algorithm needs to be adapted in order to take into account the time-dependent cell volume. the propensity of a second-order reaction at cell i at time t scales as pi=p0v0/vc,i, where p <dig> stands for propensity of the reaction at division time when vc,i=v <dig>  the propensity p0are derived from the corresponding reaction rate, k, by dividing the latter by the initial cell volume, p0=k/v <dig>  in addition to the change in the propensities of the reaction channels, the algorithm would also need to be adapted to compute the time till next reaction  <cit> . however, in our case, since all reactions rates are faster than the rate of variation of the cell volume, ∼1/τ,  then the volume increase is negligible during the time interval until the next reaction takes place. consequently, we can adiabatically eliminate the volume growth dynamics and safely assume that the volume-dependent propensities remain constant until the next reaction occurs. summarizing, at a given time t we compute, as described above, the time-dependent propensities based on the volume of the cell at that time and, according to those, we determine the time at which the next reaction takes place, t + △t, following the standard gillespie algorithm.

gene expression noise: burst size
during translation mrna molecules are translated into proteins following a bursting dynamics  <cit> . the so-called burst size, bx, is defined as the ratio between the protein x production rate and the mrna x degradation rate. it has been shown that bx is directly related to the intensity of gene expression noise  <cit> . thus, for the same average protein concentration, the larger bx is, the more fluctuating expression dynamics is displayed by protein x. in our stochastic simulations we use the burst size bxas a parameter to tune the noise intensity at the level of luxi and luxr and study its effects. unless explicitly indicated otherwise, the bursting size in the stochastic simulations is br=bi= <dig> 

external dilution protocol
in controlled experimental setups it is advantageous to keep the cell density constant. this is carried out by means of an external dilution protocol that compensates for cell growth. experimentally, this is usually achieved by periodic dilutions of the cell culture  <cit>  or by a continuous flow of liquid medium in a chemostat or in a microfluidic device  <cit> . this procedure allows to measure the stationary concentration of the signalling molecule at a given cell density and/or to estimate the threshold of the qs collective response of a cell culture. moreover, the external dilution is also important in order to maintain cells in the exponential growth phase and prevent depletion of nutrients in the medium. additionally, the levels of the autoinducer can be controlled by adding/removing exogenous signalling molecules in/from the culture buffer. we implement those in our simulations as follows.

in the deterministic model, as shown in figure  <dig>  we assume a unique cell with volume vc,tot. cell density is controlled by a continuous efflux that removes cytoplasm and culture medium at a rate that compensates exactly for the cell growth, such that the volume vc,totremains constant. concurrently, a continuous influx of equal and opposite rate brings fresh medium to the cell culture. in our in silico stochastic experiments, the efflux is reproduced by removing molecules, aext, from the medium and washing away cells by “deleting” a cell picked at random in the population each time a new cell is born.

in our simulations, as in the experiments we aim to reproduce, the exogenous autoinducer concentration ca∗ is the control parameter  <cit> . this means that the levels of autoinducer are controlled by varying the concentration of exogenous autoinducer in the dilution buffer . the influx of exogenous autoinducer molecules, together with the efflux of culture medium, can be represented by the following reaction, 

 aext↔γca∗vtotγ∅. 

 where γ=ln/τ. that is, an efflux removes autoinducer molecules from the external volume at a rate γand an influx introduces signalling molecules in the external volume at a rate γca∗vtot. in the deterministic description, the last equation leads to an additional term at the r.h.s. of the ode for the concentration of aext:+γca∗vtotvext−caext. we notice that in our simulations, as in experiments, vtot/vext≃ <dig>  in the absence of synthesis  and taking into account that the degradation is slower than the diffusion and the influx rate, it is easy to see that the concentration of autoinducer, both inside and outside the cell, tends to ca∗: the desired control value of the autoinducer concentration .

parameters
the parameters used in our model are listed in table  <dig>  when possible, parameter values are fixed or estimated by using experimental measurements found in the literature. the rest of the parameters are fitted to the experimental data of  <cit>  using the deterministic model to reproduce the main characteristics of the response curves of the lux <dig> operon: a difference of two orders of magnitude in the level of expression of gfp between the low and the high states, a hysteresis effect in the range of autoinducer concentrations 0<ca∗<15nm, and a time to reach steady-state at full induction  shorter than  <dig> hours. in regards of the cell density, based on an estimate of the cfu/ml for an average od of  <dig>  for e. coli cells, we take a typical value of cn=5·108cells/ml. moreover, in order to keep the computational time within reasonable limits, we choose a system size of n= <dig> cells. after fixing the number of cells and the cell density, the total and external volumes are then respectively derived from the relations cn=n/vtot and vext=vtot−nv <dig>  where vtot=2·10−4μl. finally, for the case of the lux <dig> operon there is one additional parameter that needs to be calibrated: the synthesis rate of the autoinducer, ka. the latter is adjusted such that the lower bound of the hysteresis region extends up to ca∗= <dig> as experimentally reported.

first passage time analysis
the mean first passage time at a given autoinducer concentration quantifies the average time that a cell takes to get activated or deactivated. for computing the first passage time in transitions, from low  to high  state, we take a single cell at the low  state and follow its dynamics until the gfp expression level reaches the high  state. we point out that the maximum gfp concentration refers to that of the deterministic simulations. in order to get enough statistics, we repeat this procedure, departing from the same initial condition,  <dig> times for each concentration of autoinducer.

RESULTS
the deterministic model reproduces the experimental observations at the population level
the chemical kinetics formalism leads to a set of odes that describes the population average dynamics in terms of the concentration of the different species considered in our model . as in some experiments  <cit> , we assume that the cell culture grows in an environment where the concentration of the external autoinducer in the medium, caext, is kept fixed and under well-stirred conditions. in addition, we implement a dilution protocol that compensates for cell growth and maintains the cell density constant . we notice that in some experimental setups, e.g.  <cit> , a periodic dilution protocol is applied for keeping the cell density constant; in our model, we keep the cell density constant by means of a continuous influx and efflux of culture medium, as in a chemostat or microfluidic device.

we use the deterministic simulations as a benchmark of the regulatory interactions included in our model and also to fit/estimate some parameters such that the experimental data are reproduced . thus, by integrating numerically the rate equations derived from the population-averaged model, we compute the steady state concentration  of gfp  and luxi::gfp  as a function of ca∗. the steady-state induction curves for increasing and decreasing autoinducer concentration of the lux <dig> and lux <dig> constructs are shown in figure  <dig>  we are able to reproduce the behaviour of the network at the steady-state, in particular a region of bistability in the range of autoinducer concentration 2nm<ca∗< <dig> nm  and 0nm<ca∗< <dig> nm . as shown by williams et al., the luxr regulation of the lux <dig> operon alone  is enough to yield a bistable response. moreover, expression of luxi in the lux <dig> operon restores the autoinduction loop and extends the lower bound of the hysteresis range to zero concentration of exogenous autoinducer as seen experimentally, indicating that once the operon is fully activated and cells produce their own autoinducer that increases the stability of the high state.

further simulations to check if the dynamics of our model is compatible with the experimental data refer to the behaviour of the system under non-stationary induction conditions and to the serial dilution protocol of the external medium  <cit> . as for the first, when cells are induced for  <dig> h, we observe that the bistability region increases . as for the second, cells are partially induced at a fixed autoinducer concentration for  <dig> hours and afterwards the external medium is changed hourly to decrease the concentration of the autoinducer. in this case, the transient response of the cells  also reproduces the experimental observations. that is, from the point of view of the population average, the deterministic model is not only capable of reproducing the steady-state of the network but also its dynamics. moreover, in agreement with experiments  our simulations reveal that the temporal scale for reaching a steady-state is much larger than the cell cycle duration. in order to clarify how noise and the induction time modifies the timing for the transition at the single cell level we then perform stochastic simulations.

the stochastic simulations reveal the interplay between non-stationary effects and noise
cells are subjected to intrinsic noise at the level of the mrnas, regulatory proteins, i.e. luxr and luxi, and at the level of signalling molecules. in order to analyze the behaviour of individual cells and reveal how noise affects the qs switch, we perform stochastic simulations of a population of growing and dividing cells as described in the methods section . the transition of an individual cell from the low to the high state, and the other way around, is intrinsically random and depends, among others, on the levels of autoinducer. thus, inside a population some cells will jump while others remain in their current state leading to a bimodal phenotypic distribution. we compute the proportion of cells that are below and above a threshold of gfp equal to half-maximum gfp concentration. we consider the distribution of cells to be bimodal when the proportion of cells in either the low or the high state is below 90% and according to this we define the range of autoinducer concentration  for which there is bimodality. for low concentrations of autoinducer, ca∗<cab1∗, the collective response of the cell population is unactivated, and for high concentrations, ca∗>cab2∗, such response activates most of the cells leading to a global response of the colony. on the other hand, within the bimodality range, the response is distributed between two subpopulations, thus failing to achieve a global coordination in the colony. in order to characterize this behaviour, we introduce the concept of precision in the qs switch as the inverse of the ca∗ concentration range for which the cells response distribution , during an induction experiment, is bimodal. that is, the larger the bimodal range, the less precise the switch is in order to generate a global response in the colony. in this regard, we point out that the precision of the switch in a noise-free situation is infinite since all cells achieve global coordination simultaneously.

the heterogeneity in terms of the jumping statistics is revealed in figure  <dig> where we plot individual trajectories for the lux <dig> operon as a function of time at ca∗=25nm over a period of  <dig> hours. some cells become induced after  <dig> hours, while others need ∼ <dig> times more induction time to reach the high state. at this concentration of autoinducer all cells have eventually reached the high state after ∼ <dig> hours of induction. importantly, we do not observe that cells jump back . that is, while there is variability over the colony in regards of the switching time, once the transition occurs the cell remains in the new state that is sustained over generations as seen in figure  <dig>  therefore, over the typical timescale of an experiment , the behaviour of the qs switch is highly dynamic and the precision of the switch is a transient quantity that crucially depends on the duration of induction.

as expected the intrinsic noise decreases the precision of the qs switch with respect to the deterministic case. still, noise helps cells to become activated before the critical concentration of a fluctuations-free system under all induction conditions. moreover, in steady-state conditions the high state is globally achieved before the critical deterministic concentration. this phenomenon is recapitulated in figure  <dig>  where we plot the population average response for the induction and dilution experiments at steady-state  for both the deterministic and stochastic models. notice that the dilution curves of the stochastic model are similar to that of the deterministic model; however, the average transition to the high state occurs at a lower autoinducer concentration due to intrinsic fluctuations.

the features of the qs switch depends on the transcriptional noise of luxr
for the same concentration of the external autoinducer, the stochastic dynamics of the regulatory network arises from the noise at the level of luxi and luxr. we now analyze the individual contribution of those by modulating the burst size of luxr and luxi, brand birespectively. we notice that the burst size modulates the stochasticity levels while maintaining the average protein copy numbers. additional file 5: figure s <dig> illustrates the effect of changing the burst size by showing individual trajectories of the chemical species obtained for large and small values of this quantity at low and high concentrations of the external autoinducer. in this regard, insight about the activation process can be obtained by computing the mean first passage time  for transitions between the low and the high state. figure  <dig> shows this quantity as a function of ca∗ and for different values of the burst size of luxr and luxi. for the sake of comparison, we also compute the mfpt for the deterministic solution. we note that in that case, the mfpt inside the bistable region is infinite, since the deterministic system cannot spontaneously jump from one stable state to the other. our results indicate that changing the burst size of luxi does not modify the mean first passage time whereas changing the transcriptional noise at the level of luxr modifies the jumping statistics. moreover, our results reveal a non-trivial behaviour of the mfpt as a function of the concentration of the autoinducer. on one hand, with respect to the activation dynamics, when ca∗ is below ∼ <dig> nm, an increase in luxr noise decreases the mean time of the activation. that is, luxr noise helps cells to get the initial activation quicker. on the other hand, above ∼ <dig> nm of autoinducer concentration, the effect is the opposite: an increase in luxr noise increases the mean jumping time thus slowing down the full cell activation.

we observe these effects both for the lux <dig> and lux <dig> operons. surprisingly, when the autoinducer concentration is above the critical concentration of the deterministic system, ca∗≈ <dig> nm, the stochastic system always takes more time to get activated than the deterministic case. by computing additional properties of the first passage time probability density we also clarify the behaviour of the precision depending on the induction time. in particular, we compute the times tlow and thigh for which, at a given ca∗ concentration, the probabilities of finding a fpt<tlowand a fpt>thighare 10%, i.e. the 10% and 90% quantiles respectively. the shadings in figure  <dig> delimit these regions for the cases br=bi= <dig> and br=bi= <dig> . the precision of the switch after n hours of induction, is directly related to the width of the shaded region at 〈fpt〉=n h: at any given time, this width indicates which is the minimal concentration of autoinducer for getting 10% of cells already activated and also the concentration beyond which more than 90% of cells have been activated. thus, in agreement with figure  <dig>  the induction time clearly modifies the precision: it increases  as the induction time becomes larger. moreover, note that as the luxr noise weakens the precision increases. figure  <dig> recapitulates some of these results. there we show the gfp expression probability for the lux <dig> operon after  <dig> hours of induction for different values of the burst size br and bi. notice that the region of bimodality does not vary when changing the burst size for luxi. however, decreasing the burst size in luxr reduces the region of bimodality thus increasing the precision of the switch. furthermore, the noise at the level of luxr helps some cells to become activated at lower concentration levels of the autoinducer. once more, this phenomenon does not depend on the levels of transcriptional noise of luxi. that is, while the global coordination increases as the transcriptional noise of luxr decreases, more concentration of the autoinducer is required to start activating cells. figure  <dig> also suggests that the sensitivity of the precision as a function of the induction time and/or as a function of the stochasticity levels get diminished after ∼ <dig> hours since the width of the shaded region barely varies. figure  <dig> points towards that direction: under long induction time conditions  the precision of the switch remains constant regardless the value of the burst size. all together, these results indicate an interesting and counterintuitive role of the transcriptional noise of luxr in terms of the biological function of the qs switch.

discussion
the response of bacterial colonies driven by the qs signalling mechanism under noisy conditions has been addressed, in a broad sense, by different authors. in particular, the characterization of the collective response as a synchronization phenomenon where the phenotypic variations can be generically predicted has been proposed  <cit> . however, this approach requires gene regulatory interactions controlling the qs switch that do not induce bistability and lead to a monostable behaviour, e.g. negative feedback loops  <cit> . our study focus on strains that display, as the wild-type luxi/luxr system do, bistability and, consequently, an alternative method to quantify the phenotypic variability induced by noise was needed, i.e. the precision concept. moreover, previous works assume stationary conditions and disregard the role of the cell cycle duration. herein, in agreement with experimental results, we have shown that the time for reaching a steady expression rate is much larger than the cell cycle duration . as a result, we have revealed that the interplay between non-stationary and stochastic effects is key for understanding the global response of the colony and the phenotypic variability. finally, we have shown that the intrinsic noise is able to stabilize a particular phenotypic state. this effect, namely the fluctuations inducing a slowing down in the activation of the cells, emerges because noise extends the bistable region compared to the deterministic system. while such a noise-induced phenomenon has been characterized in population models  <cit>  and, more recently, in theoretical studies on bistable switches  <cit> , to the best of our knowledge, this is the first time that is reported in the context of qs systems. all in all, from the viewpoint of the comprehension of how noisy inputs may condition phenotypic variability in bacterial colonies, our study introduces a number of advances.

herein, we have characterized how the precision of the qs switch depends on the stochasticity levels and, importantly, elucidated which noisy component of the luxi/luxr regulatory network drives the observed phenomenology. thus, we have found that under non-stationary conditions, luxr controls the phenotypic variability and that changing the noise intensity at the level of luxi has no effect on the precision of the switch. a plausible explanation for this reads as follows. the fluctuations at the level of luxi are transmitted to the autoinducer. however, the diffusion mechanism rapidly averages out the stochasticity levels of the latter. this is not possible for luxr which is kept within the cell. as a consequence the amount of activation complex, that is ultimately the responsible for the activation, is driven by the fluctuations of luxr but not by those of luxi.

recent experimental work has measured the bioluminescence levels of individual v. fischeri cells at fixed autoinducer concentration  <cit> . in agreement with our results, the authors observed that cells differed widely in terms of their activation time and luminescence distribution. interestingly, other experiments have revealed the presence of additional regulatory interactions for controlling the luxr noise levels. for example, c8hsl molecules, a second qs signal in v. fischeri, has been suggested to reduce the noise in bioluminescence output of the cells at low autoinducer concentrations  <cit> . in the same direction, in v. harveyi, the number of luxr dimers is tightly regulated indicating a control over luxr intrinsic noise  <cit> . in fact, wild-type v. harveyi strains have two negative feedback loops that repress the production of luxr  <cit>  and this kind of regulatory circuit is known to reduce noise levels  <cit> . in this context, our results provide a feasible explanation for the network structure in wild-type strains: since noise in luxr controls the phenotypic variability of the luxr/luxi qs systems, bacteria have evolved mechanisms to control its noise levels. an additional argument in this regard arises from our results about the deactivation of cells: once they are fully induced we do not observe reversibility of the phenotype . first, these results are in agreement with other switching systems as the gallactose signalling network in yeast  <cit>  and with theoretical results that explain the asymmetric switching dynamics due to stochastic effects  <cit> . second, they reveal the importance of additional interactions that regulate negatively luxr in wild-type strains and indicates that synthetic strains as lux <dig> and lux <dig> summarize many features of the wild-type operon during the activation process but fail to capture some of dynamical aspects of the deactivation phenomenon.

finally, our simulations indicate that non-stationary effects are essential during the activation of the qs response. while speculative, these results can be extrapolated to growing colonies where the cell density is not kept constant. a good supply of nutrients implies short induction times since the concentration of autoinducer will quickly grow  as the population size does. according to our results, this fast growing condition decreases the precision of the switch and, consequently, promotes variability at the population level . in addition, the full collective activation of the system would require a large population size. on the other hand, if the colony grows in a poor nutrient environment, the system will have time to reach a steady-state more easily and the precision would increase. hence, the variability would be diminished, and full activation would require smaller colony sizes. most phenotypic changes induced by the qs mechanism refer to bacterial strategies for survival and/or colonization. in this context, our results suggest that both the qs activation threshold and the phenotypic variability might depend on the growth rate of the colony and, as a consequence, on the environmental conditions. this is in agreement with recent studies that show that the collective response of a population of cells depends not only on the underlying genetic circuit and the environmental signals, but also on the speed of variation of these signals  <cit> .

CONCLUSIONS
herein we have introduced deterministic and stochastic modelling approaches for describing the core functionality of the luxi/luxr regulatory network in quorum sensing systems. we have focused on synthetic constructs, lux <dig> and lux <dig>  that reproduce the behaviour of the wild-type system and allow for controlled experiments that have provided quantification of the activation process  <cit> . the deterministic approach has allowed us to estimate different parameters of the model and reproduce the switch-like behaviour of the qs network. thus, our simulations reveal that the interplay between non-stationary and stochastic effects are key and that, for an extended range of autoinducer concentrations, a bimodal phenotypic variability develops such that cells fail to produce a global response. in this context we have introduced the concept of precision of the qs switch, as the inverse of the width of the bimodal phenotypic region.

by computing the statistics of the activation dynamics of cells, we have shown that the qs precision depends on the gene expression noise at the level of luxr and is independent from that of luxi. our results, together with the experimental evidences on luxr regulation in wild-type species, suggest that the noise at the level of luxr controls the phenotypic variability of the luxr/luxi qs systems and that bacteria have evolved to control its intensity. in addition, the robust stabilization of the phenotype once is fully induced indicates that, albeit synthetic strains as lux <dig> and lux <dig> summarize many features of the wild-type operon during the activation process, they fail to capture crucial aspects of the deactivation phenomenon.

most insight in regards of the effect of luxr noise on the dynamics of cell activation is given by the study of the mean first passage time . in terms of the timing of activation, we have observed two opposite effects depending on the control parameter ca∗: for ca∗≾ <dig> nm, the larger the noise in luxr, the quicker the cells become activated, while for ca∗≿ <dig> nm, we observe the opposite effect and noise slows down cell activation. we suggest that this effect can be explained by the stochastic stabilization of the low state. moreover, the calculation of additional properties of the statistics of the first passage time have allowed us to relate the concept of precision of the switch with the variability of the fpt by estimating the 10% and 90% quantiles.

in summary, our results indicate that in bacterial colonies driven by the qs mechanism there is a trade-off between the activation onset and a global response due to non-stationary and stochastic effects. on one hand, large levels of noise at the level of luxr imply that cells require smaller autoinducer levels for achieving an activation onset but, at the same time, a global response requires a substantial autoinducer concentration. on the other hand, if the luxr noise levels are small, the activation onset is shifted toward larger values of the autoinducer concentration but the global response is achieved for smaller concentration values. our study could be useful for synthetic biology approaches that exploit the qs mechanism. the fact that some important features of the qs mechanism, e.g. precision, rely on the burst size of one component, opens the door to modifications of the luxi/luxr operon for regulating the response depending on the problem under consideration. finally, further research is needed about the general validity and applicability on the noise-induced stabilization phenomenon of particular phenotypic states in other gene regulatory systems beyond the qs mechanism. work in that direction is in progress.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
mw and jb designed the experiments. mw carried out the simulations. mw and jb analyzed the data. all authors read and approved the final manuscript.

supplementary material
additional file 1
text s <dig>  chemical equations for the deterministic model.

click here for file

 additional file 2
video s <dig>  movie of the stochastic simulation. movie of the stochastic simulation for the lux <dig> operon,  <dig> h of induction at ca∗=50nm, burst size br=bi= <dig>  cells are modelled as individual compartments containing a copy of the luxr/luxi regulatory network. the gillespie algorithm  is used to integrate the stochastic dynamics of the whole system of cells. cell growth and division is explicitly taken into account as well as a certain degree of stochasticity in the cell cycle duration. cells movement is purely aesthetic since we do not include any spatial effects in our model and consider a well-mixed environment. the number of cells  is maintained constant by removing one cell at random each time a cell divides.

click here for file

 additional file 3
figure s <dig>  intra and extracellular autoinducer as a function of exogeneous autoinducer concentration. response curves to autoinducer induction for lux <dig>  and lux <dig>  operons. total autoinducer concentration catot in the external volume and in the cells , intracellular concentration ca, and extracellular concentration caext , as a function of the exogenous autoinducer concentration, ca∗, in the deterministic model. all graphs represent the steady-state response for increasing  and decreasing  autoinducer concentrations. the exogeneous autoinducer concentration ca∗ controls the autoinducer concentration in the medium by means of an influx and an efflux . upon activation of the operon, luxr is produced at high levels, thus sequestering autoinducer molecules inside the cells. the bound form of autoinducer cannot diffuse out of the cell and is therefore not subjected to the influx and efflux. this explains why the total concentration of autoinducer in the system, catot=1vtotvcellca+cluxr·a+cluxr·a2+cdna·luxr·a2+vextcaext is slightly larger than ca∗, when the operon is activated. for the same reason, the free form of autoinducer, both in the cell and in the medium, is slightly smaller.

click here for file

 additional file 4
figure s <dig>  cell response distribution during decreasing-concentration trajectories. cell response distribution for decreasing-concentration trajectories for lux <dig>  and lux <dig>  strains in the stochastic model. cells are initially induced at ca∗=100nm for  <dig> hours. the concentration of exogenous autoinducer ca∗ is then hourly decreased in order to simulate the experiments . the cell distribution reveals the variety of cell trajectories in comparison to the deterministic population average solution . the cells jump to the high state for a wide range of times and autoinducer concentrations. note also that fluctuations leads to a stabilization of the low state with respect to the deterministic solution.

click here for file

 additional file 5
figure s <dig>  trajectory of chemical species in individual cells. trajectory of chemical species luxr mrna , luxr, luxi, intracellular autoinducer , regulatory complex  <dig> and promoter bound to complex , in an individual cell for the following control parameter and burst size values:  ca∗=15nm,br=bi= <dig>   ca∗=50nm,br=bi= <dig>   ca∗=15nm,br=bi= <dig> ,  ca∗=50nm,br=bi= <dig> .

click here for file

 acknowledgements
we thank oriol canela xandri and nico geisel for fruitful comments. financial support was provided by micinn under grant bfu2010-21847-c02-01/bmc, and by dursi through project 2009-sgr/ <dig>  we also acknowledge support from the european science foundation through the funcdyn programme. m.w. acknowledges the support of the spanish micinn through a doctoral fellowship .
