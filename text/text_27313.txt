BACKGROUND
the improvement of agricultural crops with regard to yield, resistance and environmental adaptation is a perpetual challenge for both breeding and research. with regard to prospected climate changes, improved tolerance against abiotic stresses like drought, low soil fertility, and extreme temperatures is required in crop improvement. the outcrossing species rye shows the highest freezing tolerance among small grain cereals  <cit>  and exhibits excellent tolerance against many biotic and abiotic stresses. understanding the functional genetic basis of stress tolerance in rye will facilitate the improvement of stress tolerance in wheat  and barley . as a genetic research system, rye is intriguing due to its high genetic variability. in addition to being an economically important crop for middle and eastern europe, rye provides valuable traits for other crops, as a parent of the amphiploid triticale, and as a donor of translocated chromosome segments in wheat  <cit> . rye benefits from being diploid and closely related to the more extensively characterized species wheat and barley. while reference sequences of grass genomes have become available for rice  <cit> , sorghum  <cit> , brachypodium  <cit>  and maize  <cit> , sequence information for rye is sparse which hampers the exploitation of its genetic potential.

the haploid genome size of rye is more than  <dig> gbp  <cit>  which is one of the largest among cereal crops. in addition, 92% of the genome is composed of repetitive sequences  <cit> . genetic and genomic resources are limited compared to other triticeae. currently,  <dig> , <dig> wheat and  <dig>  barley ests are publicly available whereas only  <dig>  rye ests are deposited in public databases http://www.ncbi.nlm.nih.gov/dbest/dbest_summary.html . publicly available genomic resources for rye are restricted to one bac library  <cit> , a limited number of genetic markers http://wheat.pw.usda.gov/gg2/index.shtml, and genetic maps with low marker density  <cit> .

next-generation sequencing  technologies such as illumina's genome analyzer and roche's  <dig> sequencing platforms have opened the way to tackle sequencing of large genomes like those of barley and wheat which would be impossible to address by sanger sequencing  <cit> . ngs platforms produce hundreds of thousands of sequences in a massively parallel manner, are cost and labour effective and were proven to be reliable and accurate. several studies have highlighted the success and usefulness of ngs for extending available genomics resources by transcriptome  and whole-genome  <cit>  sequencing. furthermore, ngs has been used for gene expression profiling  <cit> , analysis of genome organisation  <cit> , dna methylation studies  <cit> , and molecular marker development  <cit> , to name few.

given the large genome size and the lack of sequence information and genomic resources in rye, identification and targeted isolation of genes underlying agronomic traits and understanding of gene function and trait variation is greatly hampered. the aim of the present study was to promote rye genome analysis through massive improvement of the public rye est resource and development of the first high-throughput snp genotyping array.

methods
plant material, rna and sequencing
five winter rye inbred lines lo <dig>  lo <dig>  lo <dig>  p <dig>  and p <dig> were used for cdna sequencing. lo <dig>  lo <dig>  and lo <dig> were provided by kws lochow gmbh  and represent lines from the seed parent and the pollen parent pool of the company's hybrid rye breeding program. p <dig> and p <dig> were developed at the institute of genetics and cytology, minsk, belarus, and are parents of the mapping population p <dig> × p <dig>  <cit> . inbred lines lo <dig>  lo <dig>  and lo <dig> were generated by six selfing generations, whereas p <dig> and p <dig> were selfed seven and eight times, respectively. in addition,  <dig> proprietary inbred lines from the breeding material of kws lochow gmbh, representing the two breeding pools were investigated. lines from the pollen parent pool were generated by two to three selfing generations, whereas lines from the seed parent pool have undergone five selfing steps.

to capture a comprehensive part of the rye transcriptome  <dig> samples of total rna per inbred line were obtained from a set of plant tissues harvested at five developmental stages and after three stress treatments, respectively . three plants per inbred line were pooled to obtain each of the  <dig> rna samples. for all non-stress treatments tissue samples from leaves, stems and/or roots were harvested at three- to four-leaf stage, tillering, stem extension, heading and harvest ripe stage. coleoptiles, florets, early and mature spikes were harvested. to enrich stress induced genes in the cdna sample, cold stress, dehydration shock, and nutrient-starvation stress treatments were applied in the three- to four-leaf stage. cold stress was induced by placing plants in a freezer at -15°c. root, stem and leaf tissues were harvested after  <dig>   <dig>  and  <dig> hours of stress treatment and pooled. dehydration shock experiments were conducted by removing well-watered plants from soil and leaving them on whatman®  <dig> mm paper  at room temperature  <cit> . root, stem, and leaf tissues were harvested after  <dig>   <dig>  and  <dig> hours of stress and pooled. three plants per inbred line were densely planted leading to nutrient-starvation stress. root and leaf tissues were harvested and pooled. all tissue samples were frozen in liquid nitrogen and stored at -80°c until use. total rna was isolated according to manufacturer's instructions using the nucleospin rna plant kit  and quantified with the spectronic genesys™  <dig> bio spectrometer .

five micrograms of the  <dig> rna samples of each inbred line were pooled and  <dig> μg total rna per inbred line was sent for cdna synthesis to vertis biotechnology ag . poly+ rna was prepared from total rna. first-strand cdna synthesis was primed with random hexanucleotide primers. then  <dig> sequencing adapters a  and b  were ligated to the 5' and 3' cdna ends. finally, cdnas were amplified in  <dig>  and  <dig>  pcr cycles using a proof reading enzyme. normalization was carried out by one cycle of denaturation and reassociation of the cdna. reassociated ds-cdna was separated from the ss-cdna on hydroxylapatite columns to obtain the normalized cdna samples. after hydroxylapatite chromatography, the ss-cdna samples were amplified in  <dig> pcr cycles. the cdna fraction in the size range of  <dig> to  <dig> bp was eluted from preparative agarose gels. as a control, aliquots of the fractionated cdnas were analyzed on  <dig> % agarose gels. approximately  <dig> to  <dig> μg of the normalized, adapter-ligated, and size selected cdna samples were used for gs flx  <dig> sequencing. all  <dig> sequence raw data were submitted to the ebi sequence read archive  and are available under the study accession number erp <dig> 

est resource
de novo sequence assembly
after  <dig> sequencing, raw sequence reads were passed through quality filtering where cdna synthesis primer and sequencing adapter sequences were removed. after pre-processing, cleaned and trimmed reads were subjected to inbred line-specific assemblies. therefore, we adapted the strategy of kumar and blaxter  <cit>  for assembling transcriptome data using multiple assembly programs and combining the outcomes to create longer contigs that are less likely to be in-silico artefacts brought forth by a single algorithm. the strategy has been modified to be applicable for various lines . we used three independent assemblers to achieve most credible consensus contig sequences. initially, all reads from each of the five lines were assembled separately into first-order contigs with the programs clc assembly cell v <dig>  http://www.clcbio.com, mira v <dig>   <cit>  and newbler v <dig>   <cit> . while mira and newbler follow the overlap-consensus-layout paradigm , clc attempts to find paths in de bruijn graphs. to obtain line-specific assemblies, all first-order contigs constructed by the three assemblers were merged using the olc assembler cap <dig>  <cit> . we considered only line-specific contigs whose constituents included first-order contigs from all three assemblers. for est resource generation , we employed cap <dig> a second time to co-assemble the high confidence line-specific contigs and denoted those supported by constituents from more than one line as multi-line contigs, while contigs with evidence from only one line were deemed single-line contigs. the assembly process of sce_assembly <dig> has been accomplished with a screening for potential dna and foreign rna contamination. we applied a blastn against chloroplast genome sequences of barley  and wheat , mitochondrial genome sequences of rice , sorghum , and wheat , and plastids genome sequences of brachypodium , rice , sorghum , and wheat . further purity was gained by excluding hits against cds sequences of acyrthosiphon pisum , buchnera aphidicola , fusarium graminearum , and the draft sequence of puccinia triticina available at the broad institute. we discarded contigs from the sce_assembly <dig> sequence set that showed e-values larger than e- <dig> and the proposed best hits representing at least 10% of the full contig size. the established est resource sce_assembly <dig> is available from the gabi primary database  <cit> , http://www.gabipd.org.

sequence comparisons
sequences between the five rye inbred lines potentially differ to a degree that prevents the de novo assembly of two lines. blast  <cit>  comparisons which do not require strict sequence identity were carried out to analyze for overlaps between the different assemblies. line-specific assemblies generated by cap <dig> were used together with the sce_assembly <dig> in an "all versus all" blastn analysis. each line-specific assembly as well as the multi-line and single-line contigs of the sce_assembly <dig> were used as both, subject and query sequences. the best query hit to a subject sequence was counted to identify homologs in the respective assemblies. hits were considered significant when they exceeded a conservative cut-off value of > = 70% identity and  <dig> bp coverage.

comparisons of the sce_assembly <dig> against the four currently available protein databases of maize , rice , sorghum  <cit> , and brachypodium  <cit> , two est databases of barley and wheat , and two full length cdna  library databases of barley  <cit>  and wheat  <cit>  were performed using blastx and tblastx, respectively. hits were only considered significant when they exceeded a conservative cut-off value of > 70% identity and  <dig> bp coverage. to prevent hits found based on low-complexity sequences or repeats the sce_assembly <dig> was masked using repeatmasker  <cit>  and the internal mips repeat database  <cit> .

genome-wide distribution of the sce_assembly <dig> contig sequences was investigated by chromosome-wise blastx analysis comparing multi-line and single-line contigs with brachypodium protein sequences. sce_assembly <dig> sequences were mapped onto the brachypodium genome by using a sliding window approach with a window size of  <dig>  mb and a shift of  <dig>  mb along the brachypodium chromosomes. the number of blastx hits and the percent bp coverage of the respective brachypodium genes were determined. these density values were corrected for the number of ns per window, if the n content exceeded 60% the value was set to zero. density values were extrapolated to genes  <cit>  or hits  per mb to facilitate comparisons. to visualize the mapping results heatmaps were created from the density values using the python matplotlib module in combination with the jet colormap  <cit> .

functional gene annotation
the  <dig>  sequences of the sce_assembly <dig> were functionally annotated performing a blast search with blast2go default parameters against the non-redundant  protein sequence database  <cit>  after masking repetitive sequences and excluding the singletons. gene ontology  terms were assigned using b2g4pipe http://www.blast2go.org and a locally installed blast2go database. the annotation file was extended by its respective go category - biological process, cellular component, and molecular function - using a custom built python script that is available upon request.

ssr mining and snp discovery
simple sequence repeat  motifs within  <dig>  contigs of the line-specific assemblies were identified by misa  <cit>  under standard settings. out of the five inbred lines, lo <dig> was selected as reference dataset as it provided the highest number of ssr containing contigs. the misa output of the four remaining lines was cross-matched with the lo <dig> dataset to detect redundant ssrs. a non-redundant ssr dataset was generated by combining "unique" ssr motifs detected in lo <dig>  lo <dig>  lo <dig>  p <dig>  and p <dig>  mononucleotide repeat motifs were discarded since monomer runs are known to be the most frequent sequencing errors in roche/ <dig> data. for experimental validation of in silico detected ssrs, primers flanking the ssr motifs were designed using primer <dig>  <cit> . amplification of the fragments was performed in lo <dig>  lo <dig>  p <dig>  and p <dig> as they are the parents of two mapping populations. thus, polymorphisms detected between lo <dig> and lo <dig> and/or p <dig> and p <dig> enable the genetic mapping of discovered ssrs. pcr was conducted in a total volume of  <dig> μl, including  <dig> ng of genomic dna, 1× hotstar taq pcr buffer ,  <dig> nm of each primer,  <dig> μm dntps, and  <dig>  u hotstar taq dna polymerase . using a touch-down pcr profile, an initial denaturation step of  <dig> min at 95°c was followed by  <dig> cycles of denaturation at 94°c for  <dig> min, annealing for  <dig> min, and extension at 72°c for  <dig> min. annealing temperature was decreased by 1°c per cycle from 65°c to 55°c and was kept constant for  <dig> subsequent cycles. a final extension step was performed at 72°c for  <dig> min. successful amplification was checked on  <dig> % agarose gels.

for the discovery of snps in assembled sequences, a second assembly strategy was pursued. reads assembled in line-specific contigs were selected from all reads and subjected to an overall assembly, merging the extracted reads of all five genotypes . with this strategy information about nucleotide coverage is maintained which is important for reliable snp discovery. the sce_assembly <dig> is described in additional file  <dig> and is available from the gabi primary database http://www.gabipd.org. the workflow from in silico snp discovery in the sce_assembly <dig> to selection of high confidence snp candidates was a three-step procedure: first, the tool gigabayes v <dig> . <dig>  <cit>  was applied with parameter settings given in additional file  <dig>  second, characteristics for discovered snps were extracted by in-house implementations to compute defined selection criteria for candidate snps. candidate snps were filtered by these selection criteria to meet the following requirements: snps should be bi-allelic and polymorphic between parents of the two mapping populations lo <dig> × lo <dig> and/or p <dig> × p <dig>  for successful probe design they should have a distance to homopolymeres >  <dig> bp, to the next indel >  <dig> bp, and to the contig end >  <dig> bp. third, filtered snps were manually inspected in the assembled sequences using eagleview  <cit>  to ensure high quality of the snp genotyping array. we considered putative sequencing errors, snp position in individual reads, and haplotype information. oligo-probes for  <dig>  snp were designed and the rye5k array was produced by illumina inc.  as infinium iselect hd custom beadchip. to demonstrate genome-wide coverage of the snps represented on the genotyping array snp containing contig sequences were in silico mapped against the brachypodium genome by blastn analysis.

snp array performance was assessed by analyzing  <dig> rye inbred lines including the five inbred lines used for sequencing as well as accessions from barley , wheat , and triticale . a total of  <dig> ng genomic dna per plant was used for genotyping on the illumina iscan platform and the infinium hd assay following manufacturer's protocol. the fluorescence images of an array matrix carrying cy3- and cy5-labeled beads were generated with the two-channel scanner. raw hybridization intensity data processing, clustering and genotype calling  were performed using the genotyping module in the genomestudio software v <dig>  . genotype data were cleaned through exclusion of all snp assays with more than 5% missing data. frequencies of the a and b allele for a given snp were calculated directly by dividing the number of occurrences of one allele  by twice the number of assayed lines per snp. residual heterozygosity of  <dig> inbred lines was calculated by the relation of heterozygous snps  to the number of assayed snps per inbred line. significant deviation of the observed value from the expected value was tested with an exact binomial test using r  <cit> . genotyping data of the  <dig> non-rye accessions were analyzed to investigate the applicability of the rye5k snp array to other small grain cereals.

RESULTS
establishment and description of the rye est resource
assembly
the five independent sequencing runs produced between  <dig>  and  <dig>  reads corresponding to ~ <dig> and ~ <dig> mb of raw data per inbred line . subsequent quality filtering and removal of sequencing adapters and cdna synthesis primers resulted in ~ <dig> to ~ <dig> mb of high quality sequences per inbred line with median read lengths between  <dig> and  <dig> bp. overall,  <dig> , <dig> high quality reads with a median length of  <dig> nucleotides were obtained, totalling  <dig> mb. the quality filtered reads of the five line-specific cdna libraries were assembled separately generating between  <dig>  and  <dig>  contig sequences per line-specific assembly, summing up to  <dig>  contigs . on average each nucleotide in the five line-specific assemblies was covered by  <dig>  to  <dig>  reads.

consensus sequences created by multiple assembly programs and merged by cap <dig> were used to generate the sce_assembly <dig> .  <dig> % of the reads were assembled into contigs originating from two, three, four, or five inbred lines  or from one single inbred line , respectively. the sce_assembly <dig> resulted in  <dig>  sequences including  <dig>  multi-line contigs  and  <dig>  single-line contigs .  <dig> % of all reads failed the quality criteria and were removed from the assembly. the multi-line contig sequence length ranged from  <dig> bp to  <dig>  bp with a l <dig> length of  <dig>  bp. on average, each contig was built from sixty reads in the multi-line contigs and three reads in the single-line contigs.

sequence comparisons
we compared the five line-specific assemblies generated by cap <dig> against each other and against the multi-line and single-line consensus sequences of the sce_assembly <dig> . this revealed  <dig> % to  <dig> % hits between the line-specific assemblies. blastn analysis of the line-specific assemblies against the multi-line contigs reached up to  <dig> % hits. thus, as expected, a large overlap of represented genes between single-line assemblies can be concluded. however, the remaining  <dig> % revealed either pronounced sequence differences  or genes that are represented  in only one of the five rye inbred line samples.

values show percent hits of query sequences counting the first best hit in each comparison.

the sequence homology between the line-specific assemblies and the sce_assembly <dig> with the reference genomes of brachypodium, maize, rice, and sorghum, and available flcdna and est collections from wheat and barley, respectively, was investigated by blastx comparisons . most homologs were identified in comparison to barley sequences, followed by brachypodium, wheat, sorghum, maize and rice. contig sequences of the line-specific assemblies and multi-line contigs of the sce_assembly <dig> showed a high homology to the public sequence databases. low homology was detected for the single-line contigs of the sce_assembly <dig>  this finding can be attributed to the sequence length which is about two thirds shorter than that of multi-line contigs . multi-line contigs of the sce_assembly <dig> yielded more than 65% hits with either barley or wheat flcdna and harvest assemblies . through tblastx comparisons of the sce_assembly <dig> against the genome sequences of brachypodium, maize, sorghum, and rice we were able to tag fragments from about  <dig> %,  <dig> %,  <dig> % and  <dig> % of the reference gene repertoires. from  <dig>  multi-line and  <dig>  single-line contigs  <dig>   and  <dig>   revealed a hit to at least one of the public grass sequence resources. the genes comprised in the rye cdna libraries indicated no bias for or against a certain region of the rye genome when comparing the sce_assembly <dig> contig sequences to the brachypodium genome . the dense gene content in the distal regions of the brachypodium chromosomes as well as the gene poor regions around the centromeres were well covered by sce_assembly <dig> contig sequences.

functional gene annotation
after masking repetitive sequences of the sce_assembly <dig>  <dig>  sequences  remained for blast2go analysis. out of these sequences  <dig>  revealed a hit against the nr database and subsequently  <dig>   unique rye contig sequences  were assigned to one or more go annotations. in total  <dig> ,  <dig>  and  <dig>  go terms were obtained for biological processes, cellular components and molecular functions, respectively . across the three go categories,  <dig>  unique go terms were identified. more than  <dig> sequences in the sce_assembly <dig> were related to biotic and abiotic stress response .

marker discovery, snp array design and high-throughput genotyping
ssr marker development
within the  <dig>  contigs of the line-specific assemblies a fraction of  <dig>   contigs contained ssr motifs. primer sequences could be designed for  <dig>  of these contigs. restriction to di-, tri-, tetra-, penta- or hexa-nucleotide motifs reduced the number of ssr candidates to  <dig> . cross-match analysis filtered a final ssr dataset comprising  <dig>  unique, non-redundant ssrs . a random subset of  <dig> ssrs was chosen for experimental validation by pcr amplification of the four parental genotypes lo <dig>  lo <dig>  p <dig>  and p <dig>   <dig> primer pairs  immediately amplified fragments of expected size without further optimization of pcr conditions. twelve primer combinations produced fragments larger than expected indicating the presence of introns. these were excluded from further analyses. finally,  <dig>  out of  <dig> pcr products with expected fragment size revealed naked-eye polymorphisms on agarose gels between either p <dig> and p <dig>  or lo <dig> and lo <dig> .

snp discovery
snp discovery requires sufficient coverage with high quality sequence reads in order to allow for distinguishing true snps from sequencing errors. therefore, the assembly sce_assembly <dig> was performed that excluded singletons from the line-specific assemblies when merging sequences of the five inbred lines. overall  <dig>  putative polymorphisms in  <dig>  contigs cumulating  <dig> mb consensus sequences were identified in a first data mining step using gigabayes. the number of snp candidates was reduced to  <dig>  by filtering those snps that fulfilled the selection criteria and quality requirements such as bi-allelic and polymorphic between parents of the two mapping populations lo <dig> × lo <dig> and/or p <dig> × p <dig>  distance to homopolymeres >  <dig> bp, distance to the next indel >  <dig> bp, and distance to the contig end >  <dig> bp. subsequent manual inspection in the sce_assembly <dig> reduced the dataset to  <dig>  snp candidates from  <dig>  contigs. this dataset together with additional  <dig> snps discovered in non-public rye sequences was used for the design and production of the rye5k snp genotyping array. out of the  <dig>  unique contigs,  <dig>  contigs  were in silico mapped to the brachypodium genome. the contigs were evenly distributed with  <dig>   <dig>   <dig>   <dig>  and  <dig> hits on chromosomes bd <dig> to  <dig>  respectively . blast2go analysis of  <dig>  contig sequences represented on the rye5k array assigned  <dig>  sequences with associated go identifiers .

application of the rye5k snp array
the performance of the rye5k snp array was tested on the five inbred lines selected for rna-seq,  <dig> additional rye inbred lines, and  <dig> non-rye accessions. out of the  <dig>  snps,  <dig>   generated signals and between  <dig>   and  <dig>   were successfully called for the  <dig> rye inbred lines representing the hybrid rye seed parent and pollen parent pools . based on genotyping results for the five inbred lines used for snp discovery, 3% of the in silico detected snps turned out to be false positives. allele frequencies in rye were evenly distributed from  <dig>  to  <dig>  . a small proportion of  <dig> % called snps turned out to be monomorphic in the independent set of  <dig> inbred lines not used for snp discovery with slightly increasing values when looking separately at the pollen parent  and the seed parent  pools.

significant  deviation from the expected level of heterozygosity is indicated.

genotyping data were used to calculate the observed residual heterozygosity of the rye inbred lines. the observed percentage of heterozygous loci for each line varied between  <dig>  and  <dig> % in the five rye inbred lines used for  <dig> sequencing and between  <dig>  to  <dig> % in the  <dig> inbred lines from the two heterotic breeding pools. on average, a higher level of residual heterozygosity was observed for the pollen parent pool  than for the seed parent pool .

applicability of the rye5k snp array to other small grain cereals was investigated. out of the  <dig>  snp assays that generated a signal in rye,  <dig> % ,  <dig> % , and  <dig> %  could be scored in barley, wheat, and triticale, respectively. however,  <dig> ,  <dig> , and  <dig> % of the scored snps did not show a polymorphism between the investigated barley, wheat, and triticale accessions.

discussion
dual-purpose transcriptome sequencing
in this study we report the establishment of rye genomic resources comprising  <dig>  est sequences,  <dig>  ssrs, more than  <dig>  snps, and the rye5k snp array for large-scale genotyping. ngs was used to generate transcriptome sequences of the five rye inbred lines lo <dig>  lo <dig>  lo <dig>  p <dig>  and p <dig>  the number of reads per sequencing run of the present study was in line or even surpassed results obtained in other studies  <cit> . due to the massive number of  <dig>  mio read sequences obtained by  <dig> sequencing the de novo assembly of such datasets remains a computational and bioinformatic challenge. two purpose-oriented assembly strategies were followed in order to first provide a comprehensive est resource and second enable discovery of polymorphisms between inbred lines. a second assembly on top of the five line-specific assemblies reduced the possibility of creating chimeric artefacts in the sce_assembly <dig>  in addition, sequence redundancy introduced by variations between lines is removed. this was achieved by bringing together related sequences while accepting line specific nucleotide differences. in contrast this fact was essential for snp detection, where only reads that were pre-assembled in line-specific contigs were subjected to the sce_assembly <dig>  thus, information about allele coverage at the snp position was retained which increased the reliability of snp candidates. a challenge in our study was the detection of snps without a reference sequence. many snp detection tools such as gmap  <cit>  or maq  <cit>  are only applicable to de novo assemblies that are aligned to a reference sequence. this was a strong challenge in our approach and much effort was invested in the detection of high confidence snps. manual inspection of snp candidates in more than  <dig>  contigs indicated that many sequencing errors occurred in the beginning of read sequences which, as a consequence, lead to false positives. exclusion of snp candidates detected in such regions of read sequences might reduce the false positive rate and improve automated tools that detect polymorphisms in de novo assembled sequence data without a reference sequence.

genome sequencing has progressed rapidly in model plants. given the increased sequencing throughput and the decreasing costs, ngs technologies pave the way for sequencing even large genomes  <cit> . although of major importance for research and breeding, sequence resources for rye were sparse imposing serious limitations for trait mapping, association studies, and functional genomics in rye. rye is of interest especially for middle and eastern european economic markets due to its high tolerance to abiotic stresses. as a first step towards deciphering the rye genome we aimed to sequence a large portion of the rye transcriptome. to achieve this we first sampled rna from plants under various stress conditions, different plant tissues and developmental stages. rye-specific sequences e.g. related to stress tolerance were generated in the present study which are indispensable for functional genomic studies in rye. second, we reduced the complexity of the transcriptome by cdna normalization prior to sequencing. cdna normalization lead to a significant increase in transcriptome sequencing efficiency by equalizing the representation of high, medium and rarely expressed transcripts in the cdna population  <cit> . since many transcripts are temporally and/or spatially expressed during plant development, rna pooled from different tissues at different developmental stages ensured the coverage of temporal- and spatial-specific transcripts.

linking rye to grass genome sequence resources
to assess, how much of the rye transcriptome is represented by the established est resource, we compared the sce_assembly <dig> sequences to currently available grass genome, flcdna, and est sequences. generally, the number of sequences with significant blastx hit in public databases was higher for multi-line contigs than for single-line contigs. this finding is in line with results of schafleitner et al.  <cit>  who compared est sequences of sweet potato  with sequences contained in the uniref <dig> protein database.

the overall gene content across the grass subfamilies ehrhartoideae , panicoideae , and pooideae  <cit>  is in a similar range. a total of  <dig>  protein coding gene loci were found for brachypodium  <cit>  which is in line with rice , maize , and sorghum . due to a close evolutionary relationship with these model genomes a pronounced overlap with rye transcripts was expected. the comparison of the sce_assembly <dig> against flcdna, est, and genomic sequences revealed a higher homology to barley, brachypodium, and wheat than to maize, rice, and sorghum which was expected, as rye is phylogenetically more closely related to other members of the pooideae than to maize, rice, and sorghum  <cit> . the go annotation analysis reveals that a broad spectrum of genes was sampled in our normalized cdna pool from multiple tissues and developmental stages. the large number of reads generated by  <dig> sequencing entails a substantial gain at the level of gene discovery which provides a valuable resource for forward and reverse genetics approaches in rye as well as for comparative gene analyses. a significant fraction of multi-line contigs  gave no hits with the public grass sequence resources. in part this finding can be attributed to species specific and tribe specific genes and gene families. the pooideae contain  <dig> subfamily-specific gene families leading to subfamily-specific blast hits  <cit> . given our stringent blastx/tblastx cut-off value of > 70% sequence identity, non-conserved and non-coding sequences such as 3'- or 5'- untranslated regions and non-coding rnas are assumed to contribute to the fraction that lacks homology with other grass species. around 2% of all rye  <dig> reads revealed hits to the mips repeat element database  <cit> , suggesting that transcriptional activity of retrotransposons contributed to the sampled rna pool. transcriptome sequencing in two rice subspecies detected alternative splicing patterns in about half of the rice genes and more than  <dig>  novel transcriptional active regions of which more than half had no homolog in public protein data  <cit> . this might suggest that the rye est resource contains rare, tissue-specific and/or stress-related transcripts that are not represented in sequence resources of the closely related species wheat and barley despite their extensive est resources. it is anticipated that rye transcriptome sequence analysis will greatly benefit from a reference genome sequence for a member of the triticeae family. whole genome sequencing is in progress for barley  <cit>  and wheat  <cit>  and exploratory bac end sequencing of rye 1rs-specific bac libraries  <cit>  has been reported. in silico mapping of rye ests to the model genome of brachypodium revealed an even distribution of rye transcripts when anchored to their brachypodium homologs. the large extent of synteny between grass genomes will facilitate the construction of a virtual gene map of rye representing the ancestral gene scaffold. genetic mapping of the snps represented on the rye5k array and of ssrs developed from our rye ests is underway and will lead to fine-scale comparative maps between rye and other grasses. a fully annotated genome sequence for rye is still out of reach due to the complexity and highly repetitive nature of the rye genome. however, with the tools established in our study, rye catches up with other grass genome resources and a far more detailed glimpse into the rye genome and its evolution will be possible.

molecular toolbox for rye
sequence information of the five rye inbred lines was used to detect sequence variation that was transferred into more than  <dig>  ssrs and about  <dig>  snps. molecular markers have been developed for a range of crop species and play an essential role in modern plant breeding. they have been used to monitor dna sequence diversity within and among species, to identify genes responsible for desired traits, to disclose sources of genetic variation that allow for the production of new varieties by introducing favorable traits from landraces and related grass species, and to manage backcrossing programs  <cit> . together with amplified fragment length polymorphisms , ssrs are currently the most popular marker system in cereals. they have been developed for major crop plants including cereals and when applied in breeding programs this marker system is predicted to lead to accelerated progress  <cit> . currently, the availability of public rye ssrs is very limited. our resource significantly increases this marker resource that might facilitate the assessment of genetic variability and the estimation of genetic distances between populations. besides ssrs the marker system receiving the greatest attention nowadays are snps  <cit> . snps have shown huge potential in highly efficient fingerprinting, genetic map construction, marker assisted selection as well as population and evolutionary genetics. the rye5k snp array provides a powerful new resource for large-scale genotyping in molecular and genome-centric research in rye. recently whole-genome genotyping arrays became available for crops and livestock and are used for genome-wide association studies and to investigate genetic variation . in a pilot experiment, we analyzed  <dig> rye inbred lines including the five lines used for sequencing with the rye5k snp array to estimate the degree of residual heterozygosity. theoretical expectation after two, three or six cycles of selfing is about  <dig> %,  <dig> %, and  <dig> %, respectively. genotyping of these  <dig> lines using the rye5k array showed that the degree of heterozygosity significantly  exceeds this theoretical expectation. this might be in part explained by the allogamous behaviour of rye resulting in remaining heterozygosity  <cit> . despite forced selfing during inbred line production some degree of cross-pollination cannot be excluded as the seed was produced as single-ear progenies in a commercial breeding program. the lower levels of residual heterozygosity observed for the seed parent pool is in agreement with the higher advanced selfing generations in rye seed parent lines . a detailed analysis of sequences that remained heterozygous indicated sequences belonging to large gene families, such as transferases and hydroxylases. detection of snps in paralogs or members of gene families may mimic a substantial part of the detected heterozygosity, thus leading to an overestimation of the true remaining heterozygosity in the rye inbred lines.

CONCLUSIONS
in conclusion, the sce_assembly <dig> provides a new and comprehensive est resource that integrates rye in the comparative analysis between small grain cereals. the rye5k snp array allows the analysis of large sets of individuals to obtain genotyping data for association studies, estimating linkage disequilibrium, and population genetic approaches. our genomic resources comprise  <dig>  est sequences,  <dig>  ssrs, more than  <dig>  snps, and the rye5k snp array for large-scale genotyping that will improve and promote genetic and genomic research as well as genome-based breeding in rye.

authors' contributions
gh prepared the sequencing samples, participated in the bioinformatic analyses, conducted the genotyping, and evaluated the genotyping data. ts, mm, and us carried out the processing and assembly of  <dig> reads and gave the descriptive statistics for them. kfxm and ms performed the blast analyses, functional annotations, and sequence comparisons along the brachypodium chromosomes. ns and rz developed and examined the ssr markers. eb, gh, and ts developed the rye5k snp array. ccs, eb, kfxm, ns, and us designed the study. eb, gh, ms, rz, and ts drafted the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
set of plant tissues for rna extraction. rna of each rye inbred line was extracted from plant tissues exposed to various stress treatments and harvested at different developmental stages.

click here for file

 additional file 2
establishment and description of the sce_assembly <dig> generated for in silico snp mining. the sce_assembly <dig> was performed in three steps using the mira assembler v <dig>  on integrated standard settings: firstly, raw sequence reads surpassed a quality filtering process where  <dig> sequencing adapter and cdna synthesis primer sequences as well as low quality reads were removed. secondly, the cleaned and trimmed sequence reads were subjected to a line-specific assembly where reads of each inbred line were aligned in a separate assembly run. non-aligned reads in the line-specific assemblies, i.e. singletons, were rejected. thirdly, those reads that merged into contigs in the line-specific assemblies were moved further to the sce_assembly <dig> starting again with the cleaned and trimmed reads, but now from all five inbred lines. this strategy resulted in contig sequences that were used for snp detection and subsequently for the design of the high-throughput genotyping snp array. with regard to snp discovery this assembly allowed the deduction of critical information about the snp position like allele coverage.

click here for file

 additional file 3
gigabayes parameters. only parameters different from gigabayes program default settings are listed.

click here for file

 additional file 4
association of multi-line and single-line contigs of the sce_assembly <dig> to the brachypodium chromosomes bd <dig> to bd <dig>  the four heatmaps per chromosome are depicting the density of brachypodium genes, homologous rye sequences, contigs represented on the rye5k snp array, and snps that were heterozygous among  <dig> rye inbred lines  by going along the brachypodium chromosomes in a sliding window with  <dig>  mb window size and a  <dig>  mb shift and determining for each window the number and percent bp coverage of the respective tagged genes. the density values were corrected for the number of ns per window, if the n content exceeded 60% the value was set to zero and drawn in white color. the number was extrapolated to number per mb to facilitate comparisons. the heatmaps were created from density values using the python pylab module in combination with the jet colormap . minimum, maximum, and mean number of genes/mb in brachypodium and hits/mb in rye, respectively, were given on the left of each map. the ruler on top gives the chromosome length in mb.

click here for file

 additional file 5
go categories found in the sce_assembly <dig> multi-line and single-line contig sequences on blast2go level  <dig>  categories with an occurrence less than  <dig> % were summarized in "others".

click here for file

 additional file 6
ssr motifs detected in  <dig>  contigs of the five line-specific assemblies. mononucleotide repeat motifs were discarded. mixed motifs describe two close ssr motifs which are separated by less than  <dig> bp.

click here for file

 additional file 7
description of the rye5k snp array. snp containing contigs represented on the rye5k snp array were listed including candidate snp position, probe design sequences provided to illumina inc. , and go annotations.

click here for file

 additional file 8
observed residual heterozygosity of  <dig> rye inbred lines representing the two heterotic pools. heterozygosity was calculated based on genotyping data obtained with the rye5k snp array. lines from the pollen parent pool were in generations f <dig> to f <dig>  lines from the seed parent pool were in generation f <dig> 

click here for file

 acknowledgement
we thank fritz thümmler  for synthesizing and normalizing the cdna samples, kws lochow gmbh for providing seed and dna samples, and christof pietsch for his initial work on the snp discovery pipeline. this work was supported by a grant  in the framework of the initiative 'gabi-future' of the german ministry of education and research .
