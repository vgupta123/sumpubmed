BACKGROUND
with more and more genomes being sequenced and the resulting problem of poor annotations becoming more critical it is important to turn attention to improving sequence matching to enable better identification of function. the most common way to annotate genes and identify the function of a new gene is based on identifying a similar sequence by sequence matching against proteins of known function. however, this remains a challenge , and it is generally thought that ~40 % of genes do not have a known function. also for protein structure prediction, sequence matching of protein sequences is the standard way to identify protein homologs - the first step in protein homology model building. the huge numbers of protein sequences with unknown structures and unknown functions cannot be identified by the present sequence matching with the present sets of annotated sequences and structures. thus, improving protein sequence matching should enable improving both the identification of remote homologs, for the predictions of the structures and function of large numbers of protein sequences.

the quality of sequence alignments and the similarity scores used for sequence matching depend critically on the amino acid substitution matrices that are used. substitution matrices are developed by alignment of protein sequences. alignment is important in biology and can reveal crucial information about evolution. these alignments can identify patterns of sequence conservation of proteins that belong to fold families. although sequence alignments are popular and far more frequently performed they are not very reliable whenever sequences are too different showing little sequence similarity. these are cases sometimes called the twilight and midnight zones. there are cases where similar structures have extremely little or no sequence similarity. moreover, there are also structures that have sequences that are very similar but have completely different folds  <cit> . when the sequence identity between two related proteins falls below 30 %, sequence-based search methods do not perform well  <cit> .

however, when protein structures are more conserved than their sequences  <cit>  it will be more reliable to align structures instead of sequences. improved substitution matrices can be built from structure alignments, based on the amino acid identities of proximate pairs in the aligned structure pair. better substitution matrices can capture distant evolutionary relationships and can more reliably detect distant evolutionary relationships. success will depend on how well these newly developed matrices can detect the sequence similarities among distantly related sequences.

amino acid substitutions do not obey universal rules. there are some amino acid substitutions that more commonly occur in related proteins. it is important for the substituted amino acids to be compatible with the protein structure and function. some have postulated that a specific amino acid in one position is conserved for different reasons than at other positions . if a substitution is not compatible, then a single mutation can modify the protein structure and sometimes, though rarely, even disrupt the whole protein function or denature the protein. often, these substitutions are preferential for chemically similar or size similar amino acids or similar in charge. however, other changes may also occur to compensate for neighboring changes –so-called compensatory mutations. residues on the surface can often be substituted with nearly any type of amino acid, unless it is a critical functional residue. if we know the specific types of changes that are most and least common within a large number of proteins, this information can assist with sequence matching. but combining information from many different types of structures means that the substitution metric loses much of its specificity. the availability of a large body of sequence and structure information can aid in expanding these types of statistical computational methods.

sequence-based similarity matrices
the earliest similarity matrices were the pam matrices from from margaret dayhoff’s group  <cit> , which were based upon extremely small numbers of manually aligned sequences and then the blosum matrices  <cit> , which were developed later using much more. these matrices are statistical matrices where the frequency of occurrence of mutations is used for their derivation. another type of substitution matrix that is based on amino acid contact frequencies in proteins was reported by miyazawa and jernigan  <cit> . statistical amino acid contact potential based similarity matrices have also been developed  <cit> . contact propensity of amino acids is a strongly conserved feature of each position of a protein, and amino acid matrices can be obtained from the correlations within the pairwise amino acid contact potentials. vilim et al. developed substitution matrices employing a method similar to blosum. however, instead of focusing on positions that are strongly conserved they considered particularly positions that are different within a family of proteins  <cit> .

there are also studies where multiple sequence information was used to develop hidden markov models for families of proteins  <cit> . in another study, kuznetsov et al. compared general purpose matrices and found that the maximum likelihood method  <cit>  is the best performing standard matrix  <cit> . however, they also stated that no generic matrix can outperform all other matrices for all protein structural folds. some of the other similarity matrices developed in the past include those of luthy et al., niefind et al., overington et al., koshi et al., and russell et al. . tomii et al.  <cit>  obtained mutation matrices using amino acid indices which are a set of numerical values representing any of the different physicochemical and biochemical properties of amino acids. they used  <dig> published matrices and performed cluster analysis to construct a substitution matrix. they also tried to reproduce these starting substitution matrices by combining amino acid indices and found that matrices like pam and volume and hydrophobicity of amino acids are correlated. in a recent study done by yamada and tomii  <cit> , they developed a principal component analysis based matrix using existing substitution matrices, blosum, vtml  <cit>  and bcg  <cit> . their results proved were improved compared to generic purpose substitution matrices.

structure information in similarity matrices
since structure is more conserved than sequence  <cit> , a more appropriate way to approach this issue is by using structure alignments. prlic et al. used structure alignments to derive similarity matrices   <cit> . they used a data set of superimposed protein pairs to derive evolutionary information. these pairs have high structural similarity but low sequence similarity. structural information has also been used to enrich substitution matrices  <cit> . they used a linear combination of the sequence substitution matrix blosum <dig> and a threading energy table thom <dig>  the resulting matrix was shown to improve the prediction accuracy for homology modeling in the twilight zone. it was suggested that by further incorporating protein structural descriptors such as secondary structure and exposed surface area in a linear fashion better performance could be obtained. the johnson and overington matrix  takes into account not only the substitutions that occur in similar parts of protein structures but also the variable regions where gaps occur  <cit> . blake and cohen built similarity matrices  where structural superposition of protein structures was performed by using structures obtained from cath database  <cit> . the structures were selected based on the sequence identities and the alignments were performed for ranges of different sequence identities. these series of matrices were used in structure-function prediction. some studies have shown that the use of protein family specific substitution matrices is helpful to identify orthologs that are not identified with the standard blosum matrices  <cit> . in that study the authors developed parasite specific similarity matrices and were thereby able to annotate apicomplexan proteins which have unknown functions.

it is clear that structure based matrices are key for improvements in sequence matching. although there are some methods that use structure information they fail to capture the unique information for each topology. it is important that the substituted amino acids are compatible with the protein structure and function. for most protein sequence comparisons only a single amino acid matrix is used. the overall goal in this study is to develop different amino acid substitution matrices for different topologies of proteins. the novelty in our work resides in several of its aspects. we employ a novel multi-structure alignment at each homology level  of the cath structures in order to extract topological information. in addition to using structure information we also use a sequence information component to find the unique evolutionary conserved residues in each cath topology. a weighting system between these two components is used to determine the optimal portion of sequence and structure information that gives the best fit for sequence matching.

methods
the cath database of the hierarchical domain classification of protein structures was utilized to obtain the structures to develop our topology-based similarity matrices. the s <dig> family  <cit>  of cath data was used where structures are clustered at the 35 % level of sequence identity. we are interested in distinctions at the topology or fold level of structures. in the fold level, structures are grouped together by the overall shape of structures and the connectivity of the secondary structure elements. one hundred ninety eight all helical topologies,  <dig> all beta sheet topologies and  <dig> alpha/beta mixed topologies were chosen . we have not included topologies having little secondary structure. the amino acid compositions along with other properties of these three structural classes differ  <cit>  and therefore we wanted to treat these three classes separately.

structures were categorized according to their cath topology . each set of sequences that belong to the same cath topology was further categorized into its homology level . these homology level structures are categorized as sharing a common ancestor in cath. proteins that share the same h level are said to be evolutionarily related or homologous. proteins belonging to different h levels are called analogous and they have no evolutionary relationships. for sequences belonging to each homology level multiple structure alignments were performed using the mustang  alignment program  <cit> , which uses a progressive pairwise framework to build and report the multiple structure alignments and superposition of structures. at least two structures need to be available for each topology in order to perform a structure alignment. a further breakdown of topology levels into the homology level is required because the homology level structural similarity is necessary to obtain reasonably good structure alignments. doing structure alignments at the topology level is ill-posed and not very sensible.

mustang yields a sequence alignment based on the multiple structure alignment of each homology level structure set. a cα cutoff distance was used to find the residues in each pair of structures lying close together within the alignment. if a pair of residues belonging to two different protein structures in the structure alignment were found within the cutoff distance, they were then considered to be substitutions between the two structures. this is the physical basis for our substitution matrix. if there were no amino acid pairs between a pair of structures within the cutoff distance, then this was counted as a gap in the corresponding multiple sequence alignment that is developed.

eight distance cutoffs between  <dig> Å and 8 Å were first used for our preliminary test set. all pairwise sequence comparisons were carried out on these multiple sequence alignments and the number of times one amino acid was substituted by another was counted at each homology level. a 21× <dig> matrix  was obtained containing the total number of counted substitutions. normalization was performed by dividing the count for each type of substitution by the number of amino acids involved in that particular substitution. for example, if amino acid c was replaced with amino acid r x number of times, that count was then divided by the number of times c was replaced with any other amino acid that was not r . all the homology level similarity matrices belonging to the same topology were added together in order to obtain the topology level substitution matrices. the normalized matrices were obtained by normalizing the maximum value of the 20× <dig> matrix to  <dig>  a schematic diagram of how homology level matrices are added together in order to get the corresponding topology level matrix  is shown in fig.  <dig> fig.  <dig> example of how the amino acid similarity matrices are developed for one topology t-level . the available homology level  structure alignments are first used to obtain homology level similarity matrices. then these homology level matrices  are added together to yield the corresponding topology level matrix . further decomposition of topology levels into homology level is required because homology level structural similarity is necessary to obtain reasonable structure alignments.



the topology matrices were further modified by adding in a standard similarity matrix . the vt160_ra matrix is based on a mathematical formalism which is referred to as the resolvent approach and protein evolution is modeled as a markov process. this method takes into account various degrees of evolutionary divergence and iteratively cycles between estimating the evolutionary distance between an alignment and updating the estimator for the matrix.

the generic matrices were added to topology based matrices with different weight coefficients  varying from  <dig> to  <dig> for the topology-based matrices, to obtain the final similarity matrices that incorporate the new topology information: combinedmatrix=standardmatrix+x. 

in our preliminary calculation using  <dig> topologies with weights from  <dig> to  <dig>  we observed that the best weights always lie between  <dig> and  <dig>  therefore the weight range was selected to be from  <dig> to  <dig> in the subsequent studies. these combined matrices were multiplied by  <dig> and round to the nearest integer in order to capture all the minor variations as well. the maximum value of the matrix was set to  <dig> 

test dataset
we wanted to test our topology based matrices against a distant homologs protein set. sets of structurally similar but sequence dissimilar pairs  of proteins are used as the test dataset. these selected pairs have unique cath topologies .

the preliminary study was performed on a dataset consisting of  <dig> cath topologies which were obtained by friedberg et al.  <cit>  and prlic et al.  <dig>  <cit> . the list of the test topologies and the sequences can be found on our website. these sequence pairs have less than 30 % sequence identity. there are eight all helical sequence pairs, nine all beta sheet sequence pairs and ten alpha/beta sequence pairs in our selected set of sequence pairs. the preliminary dataset was used to obtain the best cutoff distances for structure alignment and it also gave an indication of the relative performance from using the different standard matrices used to obtain the combined matrices. the preliminary dataset has also been used to find the appropriate range of weights to investigate.

after doing the first calculations using the above mentioned preliminary dataset, a second dataset which was larger and more complete was obtained from the gg benchmark dataset  <cit>  for the subsequent studies. two hundred seventy six sequences belonging to  <dig> unique cath topology were extracted so that each cath topology has three sequences. all these sequences show less than 30 % sequence identity. there are  <dig> all helical topologies,  <dig> all beta sheet and  <dig> alpha/beta topologies . these sequences can also be downloaded from our website. since there are three sequences for each unique topology, three sets of pairs are included for each topology. this gives three independent subsets for the second dataset. these three subsets will be referred to as test set a, test set b and test set c below. all calculations have been performed on each of these subsets, and the results are seen to agree well with each other. results were obtained separately for each of the three classes. for each topology in each class, alignment scores were calculated for all sequence combinations using the needleman-wunsch algorithm from the bioshell package  <cit>  with default gap penalties. here the goal was to learn whether the structure-based matrices are capable of distinguishing the structurally similar pairs of sequences from the other pairs better than can be done using standard generic matrices alone.

suppose there are n number of topologies in the test set for one class and the sequences for the first topology is s <dig> and s1’, and that for the nth topology are sn and sn’. then the scores are calculated for the structurally similar sequence pairs  and for each cross-pair that does not belong to the same topology . for topology number  <dig>  the s1:s1’ score  is expected to be distinguishable from all the cross-pairs for that topology .

for each topology, the scores were obtained for four matrices: the corresponding new combined topology-based matrix, the blosum <dig> matrix, the vt160_ra matrix and the vtml <dig> matrix. vtml <dig> is another generic matrix that uses a maximum likelihood estimator  <cit> . the blosum <dig> matrix does not take into account evolutionary distances; however, vt160_ra and vtml <dig> matrices do.

in order to compare the results obtained for different matrices, z-scores were calculated using the mean and standard deviation  of data with the following equation: z−score=/sd. 

for the given example, z−score=−meanscore)/sd. 

scores were obtained for all the cross set sequence pairs and structurally similar sequence pairs for all topologies of the three classes. these scores correspond to different weight coefficients. weight  <dig> corresponds to the standard matrix alone . the mean and the standard deviation for each matrix were calculated and the z-scores are obtained. after the z-scores were obtained for each weight of the corresponding combined matrix for the topology and that for blosum <dig>  vt160_ra and vtml <dig>  comparisons were carried out. then we find the similarity matrix that gave the best z-scores, that is, which matrix was able to best distinguish the structurally similar pairs from all of the other structurally dissimilar pairs. in this way we can learn which matrices are best for identifying distant homologs.

the newly developed structure based matrices were also compared with other structure based matrices in literature. as previously described z-scores were calculated for topology based matrices and other structure based matrices such as bc <dig>  <cit> , johm  <cit> , and prla <dig>  <cit> . the performance of topology based matrices was also compared with two well established methods, psi-blast and hidden markov model  methods.

psi-blast
psi-blast is a frequently used search algorithm to detect homologous sequences  <cit> . for each class, the 2nd sequence of the sequence matching pair for each topology  was used to obtain the psi-blast database for each class and was formatted for psi-blast search. the test query sequences were s <dig>  s <dig>  s <dig>  …, sn. the sequences used in obtaining the topology based matrices for each topology were used as input for each topology. the multiple sequence alignments for these sequences were obtained from clustalw. two rounds of interactions were used. for each topology, the hits for each query sequence  were obtained using the database that contain s1’, s2’, s3’.., sn’. for each test query sequence, it was tested to see if the correct structure matching hit was identified from the database. psi-blast was also run by replacing the default blosum <dig> matrix with the corresponding topology based matrix for each case. a matrix corresponding to weight  <dig> was used for each case of the topology based matrix and the values in the matrix were divided by  <dig> and converted to the nearest integer before being used as input into psi-blast algorithm.

profile hmm
hidden markov models  for sequence matching are probabilistic models that are found to be efficient for homology detection . the sequences that were used to create each topology based matrix were used to obtain multiple sequence alignments and to generate hmm profiles for each topology. hmmer software was used for the generation of hmm profiles  <cit> . as in psi-blast, the 2nd sequence of the sequence matching pair for each topology  was used to obtain the psi-blast database for each class. the database was searched using hmmer hmmsearch for each query sequence s <dig>  s <dig>  s <dig>  …, sn using the corresponding hmm profile built for each topology. each test query sequence was tested to see if the correct structure match pair can be identified from the database.

RESULTS
figures  <dig>   <dig>  and  <dig> show the maximum  average z-score obtained by topology matrices relative to blosum <dig> matrix z-score for a range of structure alignment cutoff distances ; fig.  <dig> is for all helical, fig.  <dig> is for all beta sheet and fig.  <dig> is for alpha/beta. all three figures show a peak near 3 Å, indicating this to be an optimal distance cutoff. this peak is sharpest for the all beta sheet case although the variation is small. for alpha/beta case the decrease in the z-scores is small and remains nearly constant. from the figures the best distances are chosen to be three,  <dig> and 4 Å for all helical, all beta sheet and alpha/beta respectively. although for alpha/beta, the choice between  <dig> and 4 Å cutoff distances do not make a significant difference, we have used 4 Å. for the calculations hereafter these structure alignment cutoff distances are used. within this cutoff distance the residue pairs are aligned from the sequence match and are considered to be substitutions.fig.  <dig> the ratio of the best average z-scores obtained with the blosum <dig> combined with topology-based matrices to the blosum <dig> z-score for the all helical protein set, for varying cutoff distances in the structure alignment. the z-scores are obtained for blosum <dig> combined with topology-based matrices for a range of weight coefficients. the maximum  z-score for each topology is averaged over all helical topologies to obtain the best new z-score for the all helical class

fig.  <dig> the ratio of the best average z-scores obtained for the blosum <dig> combined with topology-based matrices to the blosum <dig> z-score for all beta sheet protein set, for varying cutoff distances for defining the sequence match from the structure alignment. the z-scores are obtained for the blosum <dig> combined topology-based matrices for a range of weight coefficients. the maximum  z-score for each topology is averaged over all beta sheet topologies to obtain the best new z-score for the all beta sheet class

fig.  <dig> the ratio of the best average z-scores obtained with the blosum <dig> combined with topology-based matrices to the blosum <dig> z-score for mixed alpha and beta protein set, for varying cutoff distances for defining sequence matches. the z-scores are obtained for the blosum <dig> combined with topology-based matrices for a range of weight coefficients. the maximum  z-score for each topology is averaged over the mixed alpha and beta topologies to obtain the best new z-score for the alpha/beta class



for the selected cutoff distances, the average z-scores obtained for each class with different weight coefficients are shown in fig.  <dig>  the z-scores are averages over all the topologies belonging to each class. the z-scores obtained using the generic matrices are also shown on the left sides for comparison. figure  <dig> shows the average z-scores when topology-based matrices are obtained with blosum <dig> as the basis matrix and fig.  <dig> shows the z-scores when the topology matrices are based on the vt160_ra matrix. there is no significant difference in z-scores when the weights are changed. it can be seen that z-scores level off with increasing weight but when the weights are greater than ~  <dig> the z-scores rapidly decrease . all results shown are for test set a. similar results are obtained for the other two test sets . the improvement using the topology-based matrices is significant and can be seen in comparison to the generic matrices on the left side. z-scores obtained for helical matrices are higher with respect to beta sheet and alpha/beta classes. beta sheet shows the lowest z-score values for all matrices.fig.  <dig> 
a the average z-scores obtained for blosum <dig>  vt160_ra, and vtml <dig> matrices, and for different weights of combined topology-based matrices obtained using blosum <dig> as the basis matrix. the results are shown for helical, beta sheet, and mixed alpha and beta classes. b the average z-scores obtained for blosum <dig>  vt160_ra, and vtml <dig> matrices, and different weights of combined topology-based matrices obtained using vt160_ra as the basis matrix. results are shown for helical, beta sheet, and alpha/beta classes. z-scores are averaged over all the topologies for each weight for each class. only improved cases are used to obtain averages. all the z-scores obtained for both improved and other cases are shown in additional file 1: tables s <dig> ,  and . the average z-scores for all topologies and the improved topologies are compared in additional file 1: table s <dig>  there is no significant difference in z-scores when the weights are changed. it can be seen that the z-scores level off with weight but when the weights are more than ~  <dig>  z-scores rapidly decrease 



tables  <dig>   <dig>  and  <dig> show the average z-scores obtained for the three classes when the three generic matrices  and the topology-based matrices are used. the maximum improvement obtained for each topology when the corresponding topology matrix is used is also shown for topology matrices obtained by using blosum <dig> as the basis matrix and vt160_ra as the basis matrix. here only the topologies that show improvement in z-score for both blosum <dig> combined and vt160_ra combined topology-based matrices are shown. the z-scores obtained for all the topologies for the three datasets are given in additional file 1: tables s <dig>   and . the average values of z-scores of all the topologies are compared to the averages obtained only using the topologies where z-score improvements were shown in additional file 1: table s <dig> table  <dig> z-scores for all helical class topologies in test set a: scores obtained for each topology for blosum <dig>  vt160_ra, and vtml <dig> matrices are shown in columns  <dig>   <dig>  and 4

columns  <dig> and  <dig> show the maximum z-score obtained and the maximum percent improvement obtained when using blosum <dig> combined with topology-based matrices. columns  <dig> and  <dig> show the show the maximum z-scores obtained and the maximum percentage improvements obtained when using vt160_ra combined with topology-based matrices. maximum percent improvement is the improvement of combined topology-based matrices over the maximum z-score giving generic matrix for each topology. only the topologies where z-score improvements were observed for both blosum <dig> combined and vt160_ra combined matrices over all three of the generic matrices are shown

columns  <dig> and  <dig> show the maximum z-scores obtained and the maximum percentage improvements obtained when using blosum <dig> combined with topology-based matrices. columns  <dig> and  <dig> show the show the maximum z-scores obtained and the maximum percentage improvements obtained when using vt160_ra combined with topology-based matrices. maximum percent improvement is the improvement of combined topology-based matrices over the maximum z-score giving generic matrix for each topology. only the topologies where z-score improvements were observed for both blosum <dig> combined and vt160_ra combined matrices over all three of the generic matrices are shown.

columns  <dig> and  <dig> show the maximum z-scores obtained and the maximum percentage improvements obtained when using blosum <dig> combined with topology-based matrices. columns  <dig> and  <dig> show the maximum z-scores obtained and the maximum percentage improvements obtained when using vt160_ra combined with topology-based matrices. maximum percentage improvements are the improvements of combined topology-based matrices over the maximum z-score giving generic matrix for each topology. only the topologies where z-score improvements were observed for both blosum <dig> combined and vt160_ra combined matrices over all three of the generic matrices are shown.



the percent number of improvements obtained for the three classes are shown in table  <dig>  the average percentage of improvement obtained is 61 %. for the blosum <dig> combined topology-based matrices, all helical class improvements are observed for 73 % of the cases, all beta sheet class 53 % and for alpha/beta 56 %. for vt160_ra combined topology-based matrices, all helical class show improvements again for 73 % of cases and for beta sheet class 49 % and for alpha/beta 56 %. overall the number of improvements is slightly higher for the topology-based matrices obtained using blosum <dig> as the basis matrix. and the best results are obtained for all helical topologies.table  <dig> average percentage of the number of topologies showing improvements for the combined topology-based matrices compared with the three generic matrices 

mixed alpha and betaa
the percentage improvements are shown for the blosum <dig> combined topology-based matrices and the vt160_ra combined topology-based matrices. the results are shown for all helical, all beta sheet and mixed alpha and beta classes. both types of combined topology-based matrices perform nearly equally well. the topology-based combined matrices show their best performances for all helical class


amixed alpha and beta corresponds to the combined group of alpha + beta structures and alpha/beta structures 



figure  <dig> compares the average z-scores obtained for the all helical, the all beta sheet and the alpha/beta classes for different generic matrices and topology-based matrices. the average z-scores obtained for topology-based matrices are always higher than for the standard matrices . the best weight for each class is taken and is used to obtain the optimized z-score for each topology in that class. this weight is found by averaging all the z-scores obtained for each weight of each topology in the class and taking the maximum average z-score given weight for that class. the maximum z-scores are the best z-scores for each individual topology. figure  <dig> shows that the maximum average z-score obtained for each class is higher than the average z-scores for the optimized weight for each class . the z-score corresponding to this weight is used for all the topologies in each structural class and is termed the optimized z-score for each topology. the average z-scores for matrices obtained on the blosum <dig> combined topology-based matrices and the vt160_ra combined topology-based matrices are approximately the same. this is true for both the optimized z-score and the maximum average z-score. maximum average z-scores obtained for the topology-based matrices show a significant improvement in comparison with the standard matrices.fig.  <dig> the average z-scores over all topologies in all helical, all beta sheet, and mixed alpha and beta test cases.  optimized z-scores are the z-scores corresponding to the weight that gives the best average z-score for each class. maximum z-score is the best  z-score obtained for each topology. in other words, optimized average z-scores have used a single weight for the whole class but the maximum average z-scores allow different weights for each topology. the z-score for the remote homology detection when using generic matrices such as blosum <dig>  vtml <dig>  and vt160_ra can be further improved when structure information is incorporated into substitution matrices



the newly developed structure based matrices were also compared with other structure based matrices in literature. as previously described z-scores were calculated for topology based matrices and other structure based matrices bc <dig>  johm, and prla <dig>  for some cases the performance of topology based matrices clearly outperformed all three of these single matrix based matrices. for example, for all beta topologies  <dig> . <dig> and  <dig> . <dig> the improvements were over 20 % and for topology  <dig> . <dig> topology the improvement was almost 50 %. traditional psi-blast program picks the structurally similar pairs for 23/ <dig> of the all alpha test cases, 16/ <dig> of the all beta test cases and 42/ <dig> of alpha beta test cases . matching pairs were not found for topologies  <dig> . <dig>   <dig> . <dig>   <dig> . <dig>   <dig> . <dig>   <dig> . <dig>   <dig> . <dig>   <dig> . <dig>   <dig> . <dig>   <dig> . <dig>   <dig> . <dig> and  <dig> . <dig>  for corresponding hmm profiles generated for topologies, matching pairs were found for 23/ <dig> all alpha test cases, 15/ <dig> all beta test cases, and 41/ <dig> alpha beta test cases. matching pairs were not identified for topologies  <dig> . <dig>   <dig> . <dig>   <dig> . <dig>   <dig> . <dig>   <dig> . <dig>   <dig> . <dig>   <dig> . <dig>   <dig> . <dig>   <dig> . <dig>   <dig> . <dig>   <dig> . <dig>   <dig> . <dig>  and  <dig> . <dig>  there were  <dig> all beta topologies  and  <dig> alpha beta topologies  for which matching pairs were not identified by either of the two conventional methods psi-blast search and hmm profile search . table  <dig> shows the e-values of hits for psi-blast search, profile hmm search and topology based psi-blast search for topologies that didn’t give hits for psi-blast or profile hmms. the topology based psi-blast clearly outperforms these popular conventional methods for not only these cases where hits were not obtained by conventional methods but also picks the right match for all the cases we tested. all results are included in additional file  <dig> table  <dig> the e-values of hits for psi-blast search, profile hmm search and topology based psi-blast search for topologies not yielding hits for psi-blast, profile hmms or both

the topology based psi-blast clearly outperforms these popular conventional methods for not only cases where hits were not obtained by conventional methods but for all the cases tested 



CONCLUSIONS
similarity matrices are used extensively in many different applications in computational biology. standard matrices like blosum <dig> have been generated without taking into account any topological information, although the statistics of amino acid substitutions vary with protein topology. there are some amino acid substitutions that occur more frequently in some topologies than in others and these are usually substitutions do not affect the function of these proteins. the hypothesis for this study has been that different protein topologies exhibit different amino acid substitution statistics. here we have used structural alignment of protein structures belonging to each cath topology and used these alignments to develop similarity matrices for each cath topology by making amino acid substitution assignments directly from the structure alignments. we combine this structural information with general purpose matrices so that both sequence and structure components are incorporated into the newly generated topology specific matrices. we have tested our matrices using a dataset of distant homologous proteins that belong to unique cath topologies. our results show improved performances in sequence matching when we use our new combined topology-based matrices compared to using generic standard matrices such as blosum <dig>  our combined topology-based matrices were able to distinguish structurally similar protein pairs with a better fidelity than the generic standard matrices such as blosum <dig>  vt160_ra and vtml <dig> 

we have used generic matrices as anchor matrices for our topology-based matrices by adding these as perturbations to the standard matrices. this is specifically important for cases where there are too few structures in a protein family. it is evident from the scores obtained using vtml <dig> as the basis for generating combined topology-based matrices in the preliminary dataset that the improvements observed are approximately similar to those using vt160_ra. therefore, only the blosum <dig> and vt160_ra generic matrices were used for generating the combined topology-based matrices. we have used the same gap penalties . however, gap penalties might possibly be optimized to improve alignments to obtain further improvements. z-scores are best when the blosum <dig> matrix is used as the basis for the combined topology-based matrices compared to the scores obtained by the combined topology matrices generated using vtml160_ra as the basis.

the best weight for each class is taken and is used to obtain the optimized z-score for each topology for that class. maximum z-scores are obtained for the corresponding weight that gives the best z-scores for each individual topology. maximum z-scores that were obtained are always higher than the z-scores obtained with the optimized weights. this shows that there may still be room for improvement to sequence alignment. although there is not a significant difference between the two types of topology-based matrices, slightly better results are seen for topology-based matrices built upon blosum <dig> as the basis matrix. improvements of z-scores obtained using topology-based matrices are significant compared to the scores obtained using any of the generic standard matrices. this demonstrates the importance of using topology-based similarity matrices when performing sequence matching. sequence matching can be improved significantly by using the fold-specific similarity matrices, and this will aid in improving many aspects of homology modeling of proteins and gene annotation.

for the all helical cases the number of improvements observed is 73 % for both types of combined topology-based matrices. the number of improved cases for the beta sheet class is lower than for the helical class or the alpha/beta class. in almost any protein structure prediction the accuracy for alpha helical structures is nearly always higher than for beta sheet structures. this could be due to the fact that there are more long range interactions in beta sheet structures relative to short range interactions than in alpha helices. on average for the three classes, the original z-scores obtained for the generic matrices are doubled when topology-based matrices are used.

we have also repeated our calculations taking into account less detail than at the topology level. that is the second level of cath . however, we found that the discrimination power of the matrices decreases substantially. hence, the best sequence matching scores are obtained when topology level matrices are used.

results for sequence matching for psi-blast search and topology based psi-blast search, clearly show that replacing standard blosum <dig> in psi-blast search results in improvements in sequence matching. topology based psi-blast search also outperform profile based hmm for the cases tested. these results clearly show the importance of using topology specific similarity matrices instead of using standard matrices that are used in common practice today. a server for sequence matching using fold specific matrices is developed and will be made available in a subsequent publication.

additional file
additional file 1: supplementary materials. 

 abbreviations
cathclassification of protein structures downloaded from the protein data bank

hmmhidden markov models

pdbrcsn protein data bank

