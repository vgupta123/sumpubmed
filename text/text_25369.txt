BACKGROUND
mass spectrometry is being used to generate protein profiles from human serum, and proteomic data obtained from mass spectrometry have attracted great interest for the detection of early-stage cancer . recent advancements in proteomics come from the development of protein mass spectrometry. matrix-assisted laser desorption and ionization  and surface enhanced laser desorption/ionization  mass spectrometry provide high-resolution measurements. mass spectrometry data are ideally continuous data. some method is required to deal with high-dimensional but small sample-size data, similar to microarray data. an effective methodology for identifying biomarkers in high-dimensional data is thus an important problem.

ovarian dataset 8-7- <dig>  available from the national cancer institute, was analyzed in this paper. this dataset is raw data and consists of  <dig> controls and  <dig> ovarian cancer patients. the mass spectrometry data for an individual is illustrated in fig.  <dig>  the horizontal axis indicates the m/z-value and the vertical axis the intensity of ion. a characteristic of the data is that a number of peaks can be observed. each peak represents a singly charged positive ion originating from a protein in the sample. peaks present in the mass spectrometry data may be usable as biomarkers to judge whether an individual is affected or not.

some methodologies have been proposed for the identification of biomarkers from ideally continuous mass spectrometry data. one approach is to use peaks in the data to identify biomarkers. yasui et al. <cit>  and tibshirani et al. <cit>  adopted this approach. another approach is based on binning of data. yu et al. <cit>  and geurts et al. <cit>  analyzed mass spectrometry data after binning the data. the methodology presented in this paper adopts the former approach, since peaks in mass spectrometry data are considered to represent biological information. our idea is that "common" peaks within the sample might contain useful information. this means that a peak seen for only one subject may be noise, whereas a peak exhibited by many subjects might be useful. in this study, an ovarian cancer dataset was analyzed as follows:  preprocessing,  peak detection,  identification of biomarkers,  classification. adaboost was used to construct a classification function. asymboost was also examined for balancing the false negatives and the false positives. the effectiveness of the approach is evaluated using validation data.

the proposed approach is closely related to that of yasui et al. <cit> . in  <cit> , biomarkers were specified through classification by adaboost. the present approach differs in that "common" peaks are extracted before classification to specify biomarkers. by specifying biomarkers before classification, the dimension of covariates becomes smaller in classification. we think that it is better if the number of covariates is small in classification. whereas yasui et al. <cit>  used discrete covariates, both continuous covariates and discrete covariates can be used in the present approach, according to the situations. furthermore, we recommend that the results obtained using discrete covariates should be compared with those obtained using continuous covariates. in the example considered here, more information on the structure of the data can be obtained through the use of both covariates, i.e., different kinds of informative features can be obtained by the use of both covariates.

RESULTS
dataset
the range of m/z-value in the dataset is approximately  <cit> . however, the frequency of the peaks is too high in the interval  <cit>  and in some cases it is difficult to derive information from peaks in the interval  <cit> . therefore, the dataset is analyzed only in the interval  <cit> , as in  <cit> .

as is often the case in statistical learning  <cit> , the dataset is divided into two sets; a training dataset that consists of  <dig> controls and  <dig> ovarian cancer patients and a test dataset that consists of  <dig> controls and  <dig> ovarian cancer patients. the number of the training and test datasets are denoted by n and n, respectively . the method proposed in this paper is trained using the training dataset, and the performance of the trained scheme is checked using the test dataset.

preprocessing
proteomic data obtained from mass spectrometry are often inaccurate in some senses. for example, the mass/charge axis shift is a big problem in many cases  <cit> . therefore preprocessing of the data is very important. preprocessing methods have recently been proposed by wong et al. <cit>  and jeffries  <cit> .

in this paper, preprocessing of the dataset is performed using specalign  <cit>  as follows:  subtract baseline,  generate spectrum average,  spectra alignment . it should be noted that it is difficult to align spectra perfectly even if some alignment algorithm is used. in the section of identification of biomarkers, this problem is reconsidered.

peak detection
the peak detection rule of yasui et al. <cit>  is adopted here. an m/z point is regarded as a peak if it takes the maximum value in the k-nearest neighborhood. if k is small, a point is easily recognized as a peak. an appropriate k can be selected by examining some ks as done in yasui et al. <cit> . we empirically set k =  <dig>  in this study, a slightly small k is used, since only the "common" peak is considered as a biomarker.

identification of biomarkers
suppose that some individuals have a peak at a certain m/z-value, m*. it is then expected that there exists a protein related with the ion corresponding to m*. therefore, m* may be a biomarker that can be used to judge whether an individual is affected or not. but a peak exhibited by only one subject may just be noise. the peaks "commonly" exhibited by many subjects are thus candidates of biomarkers. however, there remains the problem that the m/z-values are not perfectly aligned in general, so that the above idea cannot be applied directly. by overcoming this problem of imperfect alignment, the method for identifying such "common peaks" is derived in the following.

first, an "average of peaks" is constructed by averaging gaussian kernels with centers at peaks, as illustrated in fig.  <dig>  the "average of peaks" is then expressed as

a=1n∑i=1n∑jexp⁡,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgbbqqcqggoaakcqwg4baecqggpaqkcqgh9aqpdawcaaqaaiabigdaxaqaaiabd6eaobaadaaewbqaamaaqafabagagiyzaumaeiieagnaeiicaahaleaacqwgqbgaaeqaniabgghildaaleaacqwgpbqacqgh9aqpcqaixaqmaeaacqwgobgta0gaeyyeiuoakmaadmgabagaeyoei0yaasaaaeaacqggoaakcqwg4baecqghsislcqwgwbacdawgaawcbagaemyaakmaeiilawiaemoaaogabeaakiabcmcapmaacaaaleqabagaegomaidaaagcbagaei4eashccigae83wdmnaeiikagiaemicaa3aasbaasqaaiabdmgapjabcycasiabdqgaqbqabagccqggpaqkcqgg9bqfdaahaawcbeqaaiabikdayaaaaaaakiaawufacagldbaacqggsaalcawljagaaczcamaabmgabagaegymaedacagloagaayzkaaaaaa@6167@

where pi,j is the m/z-value of the i-th observation and the j-th peak and σ  shows the "width" of the peak. in this study, σ  =  <dig>  × pi,j. in general, a very small σ is not desirable because the same peaks could not be "added" properly, but a very large σ is not also desirable because a peak affects other peaks. the value of σ could be decided based on the accuracy of the mass/charge axis. in this study, 2σ /pi,j =  <dig> . this corresponds to about ±  <dig> % error of the mass/charge value of each peak point. in this dataset, a small change of σ did not affect the result. secondly, a biomarker is identified by finding the peak greater than hth in the "average of peaks," where hth is a parameter controlling how "common" peaks can be regarded as biomarkers ). with hth =  <dig> ,  <dig> biomarkers were obtained by the procedure described in the previous section ). the features of the approach are as follows:

• in general, peaks cannot be aligned perfectly even if some alignment algorithm is applied, as stated in the section of preprocessing. in the "average of peaks," even if peaks are not aligned perfectly, they can be added because they have "width" σ   and  <dig> ).

• another possible approach is to use the average of intensities ). however, we think that the "average of peaks" is more effective in mass spectrometry data ). "common" peaks with small intensities can be found easily in fig.  <dig> , whereas it is difficult to find such "small common" peaks in fig.  <dig> . furthermore, the difference between controls and ovarian cancer patients can be seen more clearly in the "average of peaks" than in the average of intensities .

there are many ways to reduce the number of biomarkers determined by the above procedure. one way is to select biomarkers that are effective in classification. in this study, however, we simply used the biomarkers obtained by the above procedure.

the covariates are extracted from the data as discrete variables and/or continuous variables. let m <dig>  m <dig>  ⋯ be the m/z-values of the biomarkers. the discrete covariate is obtained by searching for a peak within a window of the biomarker, i.e.,

xj={ <dig> there exists a peak within a window , <dig> otherwise.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg4baedawgaawcbagaemoaaogabeaakiabg2da9maaceqabaqbaeaabigaaaqaaiabigdaxiabcycasaqaaiabbsha0jabbigaojabbwgaljabbkhayjabbwgaljabbccagiabbwgaljabbiha4jabbmgapjabbohazjabbsha0jabbohazjabbccagiabbggahjabbccagiabbchawjabbwgaljabbggahjabbugarjabbccagiabbeha3jabbmgapjabbsha0jabbigaojabbmgapjabb6gaujabbccagiabbggahjabbccagiabbeha3jabbmgapjabb6gaujabbsgakjabb+gavjabbeha3jabbccagiabcufabjabcicaoiabigdaxiabgkhitggaciab=f8ayjabcmcapiabd2gatnaabaaaleaacqwgqbgaaeqaaogaeiilawiaeiikagiaegymaejaey4kasiae8xwdinaeiykakiaemyba02aasbaasqaaiabdqgaqbqabagccqggdbqxcqggsaalaeaacqaiwaamcqggsaalaeaacqqgvbwbcqqg0badcqqgobaacqqglbqzcqqgybgccqqg3bwdcqqgpbqacqqgzbwccqqglbqzcqgguaglaaaacagl7baaaaa@84e6@

the continuous covariate is the maximum value of the intensity within the window.

xj = the maximum value of the intensity within .

in this study, ρ =  <dig> .

adaboost
the present objective is to find the important features of a peak pattern associated with a disease on the basis of peak identification on proteomic data. we introduce adaboost for the extraction of informative patterns in the feature space based on examples consisting of n pairs of the feature vector and the label. in this context, the feature vector is obtained from peak intensities over the detected m/z-values for a subject, and the label expresses the disease status of the subject. for pattern classification, one of two cases are employed, that is, in which the feature vector is composed of discrete or continuous values, as discussed in the preceding section.

ensemble learning has been studied in machine learning. adaboost  <cit>  is one of the most efficient learning methods in ensemble learning. as explained below, adaboost provides a classification function by a linear combination of weak learners. the adaboost algorithm can be regarded as a sequential minimization algorithm for the exponential loss function.

let x be a feature vector and y a binary label with values + <dig> and - <dig>  a classification function f is then used to predict the label y. if f is positive , then the label is predicted as + <dig> . suppose that a class of classification functions ℱ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfxeiraaa@3787@ = {f} is provided. in adaboost, a classification function f in ℱ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfxeiraaa@3787@ is called a weak learner. a new classification function f is constructed by taking a linear combination of classification functions in ℱ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfxeiraaa@3787@, i.e.,

f=∑t=1tβtft,
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwggbgrcqggoaakcqwg4baecqgg7awoiigacqwfyogycqggpaqkcqgh9aqpdaaewbqaaiab=j7ainaabaaaleaacqwg0badaeqaaogaemozay2aasbaasqaaiabdsha0bqabagccqggoaakcqwg4baecqggpaqkasqaaiabdsha0jabg2da9iabigdaxaqaaiabdsfaubqdcqghris5aogaeiilawcaaa@45c6@

where β =  is a weight vector and ft ∈ ℱ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfxeiraaa@3787@ for t =  <dig>  ⋯, t. the sign of f provides a label prediction of y. this is a rule of majority vote by t classification functions f <dig>  ⋯, ft with weights β <dig>  ⋯, βt. consider a problem in which weights β <dig>  ⋯, βt and classification functions f <dig>  ⋯,ft are optimally combined based on n given examples of , ⋯, . adaboost aims to solve the problem by minimizing the exponential loss defined by

∑i=1nexp⁡.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaaewbqaaigbcwgaljabciha4jabcchawjabcufabjabgkhitiabdmha5naabaaaleaacqwgpbqaaeqaaogaei4eashccigae8nsdi2aasbaasqaaiabigdaxaqabagccqwgmbgzdawgaawcbagaegymaedabeaakiabcicaoiabdiha4naabaaaleaacqwgpbqaaeqaaogaeiykakiaey4kasiaes47iwkaey4kasiae8nsdi2aasbaasqaaiabdsfaubqabaaabagaemyaakmaeyypa0jaegymaedabagaemota4eaniabgghildgccqwgmbgzdawgaawcbagaemivaqfabeaakiabcicaoiabdiha4naabaaaleaacqwgpbqaaeqaaogaeiykakiaeiyfa0naeiyxa0laeiola4iaaczcaiaaxmaadaqadiqaaiabikdayagaayjkaiaawmcaaaaa@5ddd@

adaboost does not jointly provide the optimal solution, but offers a sophisticated learning algorithm with sequential structure involving two stages of optimization in which the best weak learner ft is selected in the first stage and the best scalar weight βt is determined in the second stage at the t-step.

in this study, decision stumps were used as weak learners. a decision stump is a naive classification function in which, for a subject with a feature vector x of peak intensities, the label is predicted by observing whether a certain peak intensity is larger than a predetermined value or not. accordingly, the set of weak learners is relatively large, but all of the weak learners are literally weak, since they respond only to a peak pattern. the set of the decision stumps is denoted by

{dj = sign | j =  <dig>  ⋯ , j, -∞ <b < ∞ }.

adaboost efficiently integrates the set of weak learners by sequential minimization of the exponential loss. as a result, the learning process of adaboost can be traced, and the final classification function can be reexpressed as the sum of the peak pattern functions fj's, where

fj=∑{t|ft=dj}βt sign ,
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwggbgrdawgaawcbagaemoaaogabeaakiabcicaoiabdiha4jabcmcapiabg2da9maaqafabaaccigae8nsdi2aasbaasqaaiabdsha0bqabaaabagaei4easnaemidaqnaeiifawnaemozay2aasbaawqaaiabdsha0bqabawccqgh9aqpcqwgkbazdawgaaadbagaemoaaogabeaaliabc2ha9bqab0gaeyyeiuoakiabbccagiabbohazjabbmgapjabbeganjabb6gaujabbccagiabcicaoiabdiha4naabaaaleaacqwgqbgaaeqaaogaeyoei0iaemoyai2aasbaasqaaiabdsha0bqabagccqggpaqkcqggsaalaaa@5652@

in which the sum of coefficients βt is referred to as the score sj <cit> . in this way, the score sj expresses the degree of importance for the j-th peak in terms of contribution to integrating a final classification function in the process of learning algorithm.

in table  <dig>  the test error with discrete covariates and that with continuous covariates are the same.

the score sj is calculated to consider the difference between the obtained prediction functions. each sj gives the influence of the j-th covariate for the obtained classification function. tables  <dig> and  <dig> show the ten highest values among sj's in the discrete and continuous cases, respectively. from tables  <dig> and  <dig>  the prediction functions obtained using the discrete and continuous variables are different. the result obtained using continuous covariates appears to be based on a difference in the intensity under the condition that the peak exists, but the result obtained using discrete covariates is likely to be based on a rougher difference whether the peak exists at the m/z-value. in this dataset, there may be many peaks that affect classification, but each individual peak will not have sufficient information to perfectly distinguish cancer patients from controls. in such a situation, the continuous covariates with high score and the discrete covariates with high score are different, but a classification function with high predictive performance will be obtained by combining information from many peaks by either continuous covariates or discrete covariates.

the above results were obtained with hth =  <dig> . we can use more  covariates by setting a smaller  hth. tables  <dig> and  <dig> show the results for various values of hth in the discrete and continuous cases, respectively. when hth is large, the test error becomes larger in the discrete case, whereas in the continuous case, the test error does not vary as much.

in figs.  <dig> and  <dig>  the false negatives are much larger than the false positives, but this is not a desirable result. in order to suppress false negatives, asymboost  <cit>  may be useful. in adaboost, the loss function is given by , but in asymboost, the loss function is given by

∑i=1nwiexp⁡,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaaewbqaaiabdeha3naabaaaleaacqwgpbqaaeqaaaqaaiabdmgapjabg2da9iabigdaxaqaaiabd6eaobqdcqghris5aogagiyzaumaeiieagnaeiicaanaei4waslaeyoei0iaemyeak3aasbaasqaaiabdmgapbqabagccqgg7bweiigacqwfyogydawgaawcbagaegymaedabeaakiabdagamnaabaaaleaacqaixaqmaeqaaogaeiikagiaemieag3aasbaasqaaiabdmgapbqabagccqggpaqkcqghrawkcqwivlctcqghrawkcqwfyogydawgaawcbagaemivaqfabeaakiabdagamnaabaaaleaacqwgubavaeqaaogaeiikagiaemieag3aasbaasqaaiabdmgapbqabagccqggpaqkcqgg9bqfcqggdbqxcqggsaalcawljagaaczcamaabmgabagaeg4mamdacagloagaayzkaaaaaa@60e3@

where each initial weight wi is set as follows:

wi={α,if the i-th patient is cancer, <dig> otherwise.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg3bwddawgaawcbagaemyaakgabeaakiabg2da9maaceqabaqbaeaabigaaaqaaggaciab=f7ahjabcycasaqaaiabbmgapjabbagamjabbccagiabbsha0jabbigaojabbwgaljabbccagiabdmgapjabb2catiabbsha0jabbigaojabbccagiabbchawjabbggahjabbsha0jabbmgapjabbwgaljabb6gaujabbsha0jabbccagiabbmgapjabbohazjabbccagiabbogajjabbggahjabb6gaujabbogajjabbwgaljabbkhayjabcycasaqaaiabigdaxiabcycasaqaaiabb+gavjabbsha0jabbigaojabbwgaljabbkhayjabbeha3jabbmgapjabbohazjabbwgaljabb6cauaaaaiaawuhaaaaa@687b@

it is expected that the false negatives will be suppressed by using a large α. in figs.  <dig> and  <dig>  the false negatives might be suppressed by using a large α at the expense of the larger false positives, in particular when the number of iterations is small.

CONCLUSIONS
we proposed a methodology for identifying biomarkers from high-dimensional mass spectrometry data. "common" peaks in the data are regarded as biomarkers. the number of biomarkers can be changed by varying the value of hth, which is a threshold value that controls how "common" peaks can be regarded as biomarkers. by identifying biomarkers, the number of covariates is reduced, so that classification is facilitated. we can select discrete or continuous covariates depending on the situation.

the effectiveness of our approach was demonstrated through application to an ovarian cancer dataset. it was shown that a prediction function with high performance can be obtained by a simple application of adaboost.

a simple method was used to analyze data in this study. in general, however, a more sophisticated method may be required to extract a covariate at a biomarker. for example, when discrete covariates are extracted, we can use peaks obtained by a stricter rule or we can extract variables effective for classification  <cit> . when continuous variables are extracted, we can use the intensity at the m/z-value nearest to a biomarker, or the average of intensities within a window including a biomarker.

in this paper, the difference between the result for the continuous covariates and that for the discrete covariates was investigated in detail. in the example, the result obtained using continuous covariates appeared to be based on a difference in the intensity under the condition that the peak exists, but the result obtained using discrete covariates was likely to be based on a rougher difference whether the peak exists at the m/z-value. in general, whether discrete covariates are better or continuous covariates are better depends on data. if the value of the intensity in the data is reliable, it may be better to use continuous covariates. if not, it may be better to use discrete covariates. we consider that both cases of covariates should be examined and the results compared and inspected in detail for practical almost studies. we conclude that we can obtain more information on the structure of the data by integrating both results.

authors' contributions
tf wrote programs for this study and main parts of the manuscript. hf wrote a half of the section of background. se proposed the use of asymboost when the false negative is small, and wrote the explanation on adaboost algorithm. all authors read and approved the final manuscript.

