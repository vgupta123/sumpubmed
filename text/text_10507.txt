BACKGROUND
it is commonly believed that sequence determines structure, which in turn determines function. this paradigm forms the basis of functional annotation methods using sequence or structure similarity. however, since the structure space is much smaller than either the sequence space or the function space, there will be exceptions to this paradigm: similar functions may be exerted by distinct sequences and structures, as in the kinase family  <cit> . alternately, similar structures may exert very different functions, as in the tim barrel fold family  <cit> . the presence of multi-functional fold families suggests that structure and function do not always correlate.  however, the presumption among biologists is that the function of protein can be easily inferred whenever its structure is obtained either by experimental means or by computer simulation. this forms part of the rationale for structural genomics projects where the goal is to obtain structures for representative members of a fold family in the hope that the structure and function of the other members of the family will be apparent. while this is true in the majority of the cases, a significant minority  of structures from structural genomics projects represent proteins of unknown function, annotated merely as "hypothetical proteins"  <cit> . classification and identification of the exact function for protein targets given an experimentally determined structure still remains an open challenge  <cit> .

for many proteins without experimental structures and easily identifiable sequence homologues, structural models can be generated by fold recognition algorithms and used for functional inference. the fold recognition algorithms typically align a query sequence to proteins whose structures have been experimentally determined, and are extremely effective at determining the correct fold, even when the sequence similarity between the query and its homologue is very low  <cit> . studies have been conducted to evaluate the possibility of using predicted structures to infer protein function: for example, predicted structures were used to identify possible functional sites through database matching  <cit> . in addition, structure predictions were used to infer function in a genomic scale for proteins without obvious sequence homologues  <cit> . despite all these studies, the correlation between successful fold recognition and correct functional annotation has not been thoroughly studied and quantitated.

our first goal was to determine the accuracy of functional inference when the correct structural fold for a given target protein sequence was predicted using fold recognition algorithms. to accomplish this, we evaluated a set of fold predictions made in the livebench  <cit>  and pdb-cafasp  <cit>  experiments. we found that similarity in structural folds derived from fold recognition algorithms does not lead to correct functional assignments approximately one third of the time when the protein is a member of a multi-functional fold family. considering that the structures of most proteins will never be solved experimentally, methods that perform accurate functional annotation based on predicted structure even for this minority of proteins will significantly enhance our ability to utilize the vast amount of available sequence data. therefore, novel methods to predict function that go beyond sequence and structure comparisons are necessary to reduce the gap between structural genomics and functional genomics.

we previously developed a computational method called functional signatures from structural alignments   <cit>  to address this problem. in brief, given an ensemble of proteins sharing the same structural fold, we first perform all-against-all structure alignments. we use the alignments to separate the contribution to structure and function for each amino acid residue in each structure using log odds scores. for a given protein, the collection of these log odds scores for all residues comprises its functional signature, which can be used to classify query protein structures into functional categories. our method shows comparable or better results than other sequence or structure comparison based methods, especially when the sequence identity between a target protein and others belonging to the same fold family is relatively low.

here, we extend our previous work as follows: we evaluated our algorithm for  <dig> multi-functional fold families using experimental structures collected from the latest release of the scop database . we then evaluated the performance of our algorithm using predicted structures generated by the livebench and the pdb-cafasp experiments. in both cases, we showed that our algorithm performs better than sequence and structure comparison approaches for functional annotation. we further investigated the reason for the fssa algorithm having good performance even on predicted structures that are generated with biases towards the incorrect functional categories . finally, we implemented the fssa algorithm as a webserver  <cit> . the webserver takes a pdb file and a scop fold as input, and outputs predicted scop superfamilies and corresponding confidence scores, as well as the functional signature, which indicates the contribution of each position and residue type to the function of the protein.

RESULTS
accuracy of functional assignment based on experimental structure similarity
the structural classification of proteins  database curators classify protein domains whose structures or functional features suggest a common evolutionary relationship into the same superfamily  <cit> . we use the scop superfamily as a proxy for functional category, since it is generally regarded as a gold standard for defining remote homology and widely used in the literature  <cit> . even though the correlation between scop superfamilies and function is not absolute, and that proteins within the same superfamily may have different biochemical activities, this may be used as a reasonable approximation for evaluating functional assignment of classification methods.

we first analyzed the fraction of structural domains that belong to multi-functional fold families, which gives an estimate of how frequently we will encounter the problem of ambiguous functional assignment for a newly solved structure. in the scop release version  <dig> , 11% of all scop folds contain multiple superfamilies, while 46% of all domains belong to one of these multi-functional fold families . therefore, although multi-functional fold families account for a small fraction of the fold space, these folds are usually more abundant than other folds. our analysis suggests that the problem of ambiguous functional assignment may be encountered for about half of the structures solved experimentally.

accuracy of functional assignment based on predicted structure similarity
we next investigated whether functional assignment for a given protein can be inherited from its closest structural homologues predicted by state-of-the-art fold recognition techniques. we collected a set of fold predictions made in the livebench  <cit>  and the pdb-cafasp  <cit>  experiments. these experiments evaluate how well structure prediction servers perform on blind prediction targets. one of the best performing fold recognition methods in these experiments is 3d-jury  <cit> , which collects output from various individual structure prediction servers and generates a consensus prediction. we obtained  <dig> proteins from the livebench  <dig>  livebench  <dig>  livebench  <dig> and pdb-cafasp  <dig> experiments, representing "hard" prediction targets correctly assigned to a multi-functional fold family.

we then evaluated the correctness of functional assignment for these  <dig> proteins using their closest structures as determined by 3d-jury using the scop nomenclature . the fraction of correct assignments is similar for all four experiments, indicating that our estimates have low variance and high confidence. there is no obvious increase in the fractions of correct assignments for the three consecutive livebench experiments, indicating that increasing quality in structure prediction may not necessarily lead to improvements in structure-based annotation transfer. overall, we found that approximately one-third  of the proteins in the multi-functional fold families are not assigned to the correct superfamilies, even when the correct structural folds are identified .

performance of fssa on experimental structures
our published study on fssa  <cit>  was carried out on a fraction of fold families in the scop database . here we extended our previous performance evaluation to all the  <dig> scop fold families for which sufficient training data are available, and compared the performance of the fssa algorithm with several other sequence and structure homology based function classification methods . the comparison is not totally equitable since these other methods were not particularly developed or parameterized for functional classification; however, they are widely used by biologists to infer function based on similarity.

to investigate the correlation between performance and similarity among testing and training sequences, we used four different data sets retrieved from the astral compendium, representing proteins whose pairwise sequence identities are less than 10%, 20%, 30% and 95% to each other. for all sequence identity levels, these structural folds in our data sets contain all-α, all-β, α/β, α+β as well as small proteins, and provide a good representation of the protein fold space. we performed cross-validation experiments to examine the functional classification performance for different methods. overall, the fssa algorithm has the best performance when pairwise sequence identity in the data sets is less than 30%, though the differences are subtle between all methods utilizing structural information . sequence homology based function classification methods perform relatively poorly at low sequence identity levels. our evaluation demonstrates that the fssa algorithm would be useful for automated function annotation applications for structural genomics projects, when used in conjunction with other sequence and structure comparison methods.

performance of fssa on predicted structures
we next investigated whether the fssa algorithm can be applied to structures that are predicted by homology modeling techniques. we selected  <dig> hard prediction targets from the livebench and pdb-cafasp experiments for our analysis. these targets are those that have been assigned to the correct multi-functional fold families by the 3d-jury system and belong to the  <dig> fold families for which sufficient training data are available. we used our own homology modeling and optimization algorithms on these prediction targets and generated all-atom structural models . we then applied the fssa algorithm on predicted structures to test whether they can be assigned to the correct functional categories. for comparison, we also tested the experimental structures corresponding to these prediction targets by the fssa algorithm. we found that both fssa and structure comparison method perform well, though function predictions on the modeled structures are generally slightly worse than those obtained using the experimental structures .

performance of fssa on predicted structures using templates from incorrect scop superfamilies
we then focused on  <dig> structures whose templates  belong to a different superfamily than the query, since these structures are potentially biased towards the incorrect superfamily and pose a challenge for function prediction methods. structure superposition confirmed that the predicted structures tend to be similar to the templates used to construct the models, with an average cα rsmd of  <dig> Å. for 16/ <dig> predicted structures, the fssa algorithm correctly identifies their functional categories, even though the structures were modeled in a manner that biased them towards folds in different function categories. in comparison, the structure comparison method only identifies the correct functional categories for 7/ <dig> predicted structures. this suggests that the fssa algorithm is less sensitive to biases in predicted structures caused by using templates from different superfamilies.

to further investigate the mechanism that enables fssa to accurately classify modeled structures even when the templates are derived from incorrect scop superfamilies, we visually examined two prediction targets: an aldolase from pseudomonas  and a phosphosulfolactate synthase from methanococcus  . both targets have 3d-jury scores higher than  <dig>  indicating high confidence in the accuracy of fold recognition and the alignments generated by the 3d-jury system. however, the predicted structures for both targets are correctly classified by the fssa algorithm but not by structure or sequence comparison methods. both prediction targets belong to the tim barrel fold, and the predicted structures correctly reproduce the global barrel shape. we found that both predicted structures are generally biased toward the conformation of the template structures, especially in the c-terminal region . however, some local structural features in experimental structures are correctly captured by our structure prediction algorithm: for example, the second helix in the predicted structure for the pseudomonas aldolase resembles that of the experimental structure, rather than the template structure. similarly, for the methanococcus phosphosulfolactate synthase, a small extra helix-like region is correctly generated after the second helix in the barrel, similar to that in the experimental structure. since the fssa algorithm uses both local sequence and structure to determine function, it is less susceptible to biases in global structure when classifying protein function.

the good performance of the fssa algorithm here is mainly due to its immunity to global structural bias, rather than its ability to match functional signatures to the correct superfamily. our analysis nevertheless suggests that the combination of local structure and local sequence information, rather than global structural fold, is important in assigning function to predicted structures.

the fssa algorithm as a webserver
using data sets from the astral compendium  <cit>  for the scop database, we implemented the fssa algorithm as a webserver for automated function prediction  <cit> . because the fssa algorithm needs sufficient data for training, currently our server only contains  <dig> of the  <dig> multi-functional fold families. domains in these  <dig> folds account for 69% of all domains within multi-functional fold families in the scop database.

the webserver takes a pdb file and a scop fold as input, and outputs predicted scop superfamilies and corresponding confidence scores, using the fssa algorithm as well as sequence and structure comparison methods. it also outputs predicted functional signatures, which indicates the contribution of each position and residue type to the function of the protein.

discussion
we have demonstrated and quantitated the degree to which proteins belonging to multi-functional fold families hinder the accurate functional annotation of experimentally derived structures as well as structures modeled by fold recognition methods. although this situation is relatively well known for structures that have been experimentally solved , it has not been quantitatively measured for structures modeled by fold recognition methods. in addition, we have also performed extended performance analysis of the fssa algorithm on both experimental and predicted structures. our algorithm performs better than structure comparison methods for functional annotation, especially when using modeled structures that are biased towards templates from different functional categories. we further implemented the fssa algorithm as a webserver so that it is more publicly accessible.

the current implementation of the fssa algorithm has issues that need to be resolved. the first issue concerns the suitability of using scop superfamily to define functional category. although this manually curated scheme is widely accepted as a proxy for evolutionary relationship, there are many exceptions where proteins with the same superfamily have different functions. hegyi et al has shown that the exact protein function is conserved for 67% of pairs of single domain proteins within the same scop superfamily, and for 80% of pairs of multi-domain proteins with the same combination of scop superfamilies  <cit> . therefore, the scop superfamily can be only used to classify broad functional categories or evolutionary relationships, rather than the exact biochemical functions for proteins. the enzyme commission   <cit>  or gene ontology   <cit>  annotations are alternative classification schemes for training our methods. the ec classification can be only applied to enzymes, and for selected structural fold families that contain large numbers of enzymes, such as the tim barrel fold family, the performance of the fssa algorithm is similar to what is observed when the scop classification scheme is used. even though some of the structures in the pdb have been assigned computationally identified go terms through the use of sequence or structural homology  <cit> , we cannot use these annotations to train and test our algorithm until a large portion of the pdb contains experimentally verified go functional assignments. in principle, we could also extend the fssa algorithm to classify proteins at the family level, rather than superfamily level, allowing for greater specificity in functional annotation. however, since the current scop database classifies family level relationships by sequence comparison, it may not be a good reference dataset for training our models. the use of meta-functional signatures from different sources for more detailed and accurate functional classification is being actively explored.

another issue with the fssa algorithm concerns our combining multiple small categories into a single "other" category to train our models in a more realistic manner . an annotation of "other" however does not shed light on the actual function . in addition, we have noticed that in many cases proteins in the "other" category can be assigned to the correct functional category by the fssa algorithm, but not by structure comparison methods. in such cases, the good performance of the fssa algorithm is actually due to its ability to indicate that a given query does not belong to one of the incorrect categories. the problem caused by the "other" category will reduce in severity as the sizes of structural databases increase.

several structure-based functional annotation systems similar to ours have been developed in recent years  <cit> . for example, protein function can be inferred by scanning a database of 3d templates   <cit> . the phunctioner method  <cit>  extracts functional sites from multiple structural alignments, and then generates 3d profiles for sets of residues that determine functional specificity. the proknow method  <cit>  extracts various sequence, structure and interaction features from structural databases, and relates them to function by annotation profiles. the thematics method  <cit>  identifies enzyme function by computing the theoretical microscopic titration curve for each residue in a protein structure. our approach markedly differs from these others:  the contribution of each amino acid residue to structure and to function is explicitly separated through the analysis of local structure and local sequence.  the functional importance of each residue is assigned a quantitative value, rather than a uniform value for selected functionally important residues.

overall, we envision fssa as a complementary method to other sequence and structure-based approaches for the annotation of protein function. we believe that the combination and integration of all these methods is necessary to achieve broad annotation of organismal genomes and proteomes.

CONCLUSIONS
our results indicate that the fssa algorithm has better accuracy when compared to homology-based approaches for functional classification of both experimental and predicted protein structures, in part due to its use of local, as opposed to global, information for classifying function. our method can be used in combination with other methods to achieve broad annotation of organismal genomes and proteomes.

