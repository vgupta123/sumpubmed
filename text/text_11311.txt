BACKGROUND
protein-dna interactions play crucial roles in many biological processes, including regulation of gene expression, dna modification, and dna duplication  <cit> . knowledge of the 3-dimensional  structures of protein-dna complexes can help us better understand the mechanism of protein-dna recognition, shed light on the evolution of gene regulatory networks, and guide the rational design of therapeutic drugs. with the advancement of structure determination techniques and molecular expression systems, the number of protein-dna complex structures deposited in protein data bank   <cit>  is increasing at a higher rate. as of august,  <dig>  there are over  <dig> solved protein-dna complex structures in pdb . the current state of research in protein-dna interactions with the number of known protein-dna complex structures is reminiscent of the situation of protein structure modeling in the early 1990s which started a new wave of development of protein structure prediction methods. the number of available high-resolution structures of protein-dna complexes makes it possible to develop more accurate knowledge-based potentials and protein-dna docking methods  <cit> .

one of the crucial steps in investigating the mechanism of protein-dna interactions is the construction of datasets as well as classification of protein-dna complex structures. previously, non-redundant datasets have been generated through comparison of protein sequences  <cit> . this "protein-centric" view has also been the traditional method in classification of protein-dna complexes  <cit> . however, the same protein may interact with two very different dna molecules. for example, 1bgb and 2b0d contain the same protein but the corresponding dna sequences  are very different . in addition, one protein may interact with two dna sequences through different binding sites. the protein-dna complex structure 1zx <dig> is such an example, in which the protein has two different dna binding domains . one of the reasons that the dna molecules were not taken into account in dataset construction is probably the lack of double-stranded dna sequence information and complete protein-dna binding models in pdb files. for example, some double-stranded dna molecules are fragmented into several shorter dna chains for biological or non-biological reasons, and there is no annotation about whether a dna chain is a single stranded dna, one full-length chain of a double-stranded dna, or only a fragment of one strand of a double helix. moreover, dna bases that interact with protein residues are usually more conserved than other bases. therefore, how the dna sequences in the complexes are used for comparison is not a trivial issue. the lack of such detailed information has compromised the classification of protein-dna complexes and dataset construction.

due to the unique structural features of dna, protein residues may interact with dna bases in major or minor grooves, and the protein-dna interactions can be specific or non-specific. although these features are important in characterizing the nature of the interactions in a protein-dna complex, they are not available in pdb files. currently, there are several programs and databases, such as 3dna  <cit> , nucleic acid database   <cit> , amino acid-nucleotide interaction database   <cit> , and protein-nucleic acid complex database   <cit> , which represent previous efforts in providing some structural details of dna or protein-dna complex structures. however, these programs/databases only provide information on some aspects of the protein-dna complex structures. for example, ndb and 3dna are nucleic acid specific. aant only has statistical information on amino acid-nucleotide interaction. while pronuc provides a list of atom-atom contact pairs between protein and dna, it lacks other information such as the nature of protein-dna interactions.

sarai and colleagues recently developed a new scheme for classification of protein-dna complexes using a "dna-centric" approach  <cit> . the new viewpoint highlights the need for a comprehensive annotation of the solved protein-dna complex structures and an automatic program for generating such information. here we present the development of such a program, pda , which can help us better understand the mechanism of protein-dna interactions and should be useful in statistical potential development, protein-dna docking, and structure-based regulatory network studies. in addition, the protein-dna complex structures can be classified from a more holistic view by combining the "protein-centric" and "dna-centric" approaches.

methods
pda is implemented using python  <cit> , a platform-independent programming language. the flowchart of pda is shown in figure  <dig>  which includes four major steps: 1) restoration of full protein-dna complex structures ; 2) dna structure analysis including identification of base pairs and double-stranded dna ; 3) analysis of protein-dna interactions; 4) identification of protein-dna binding units . below we provide detailed description for each step.

restoration of full protein-dna complex structures
some pdb entries provide only partial coordinates of the whole protein-dna complex structures. we observed that there were two kinds of incompleteness of the protein-dna complex structures in pdb files. the first is that parts of the complex structures, such as one chain of a double-stranded dna or one chain of a protein dimer is missing in the original pdb file . pdb files with this type of incomplete structure usually have codes, e.g. "biological molecules", embedded in the structure file, which pda uses for generating the full structure model if missing component is identified. the second type of incomplete complex structures is that the coordinates of one or more full double-stranded dnas are missing . pda searches for such missing double-stranded dnas by first reconstructing  <dig> ×  <dig> crystal cells with the crystal symmetry information of the structure in pdb and examining if there is any double-stranded dna in the crystal whose bases are in contact with the protein.

dna structure analysis
base-pair and double-stranded dna detection
many algorithms have been developed for defining base-pairs in a dna structure  <cit> . however these programs employ complicated procedures for base-pair recognition. since the goal of this step is to identify double-stranded dnas for dna sequence comparison, we developed a simple approach for detecting base pairs by using two distance measures: "h-distance" and "stagger distance". h-distance is the distance between a hydrogen bond donor of one base and its hydrogen bond acceptor of the other base  while stagger distance represents the distance between the plane of one base and the tip heavy atom of the other base . therefore, one base-pair has three  or two  h-distances and two stagger distances. a base-pair is defined between two bases when both the maximum h-distance and the maximum stagger distance are less than their respective cutoff values. if a base has more than one potential pairing partner, the one with the smallest stagger distance will be chosen. using a heuristic approach, we found that a combination of an h-distance cutoff of  <dig>  Å and a stagger distance cutoff of  <dig>  Å can accurately identify structural base pairs. a double-stranded dna is then defined as a group of polynucleotide chains that are canonically joined by base-pairing . dna chains without any base pairing partners are classified as single-stranded dnas. as an optional feature of pda, the users can also use 3dna instead of the default functional module in pda for base pair detection.

recognition of dna bending with a backbone break
binding to proteins can cause dna deformation and introduce bends in dna molecules. severe deformation with broken dna backbones has been observed in protein-dna complex structures that are not related to gene regulation . we developed an empirical method to detect such a "crack" in a dna backbone: when one or more sequential nucleotides are missing in one strand of a double-stranded dna, the distance between the c1' atoms of the nucleotides flanking the break or missing region is calculated. if the distance is more than  Å, where d is the sequence distance between the flanking nucleotides, a crack is recorded. most of the cracks detected by this criterion were related to dna modification and replication .

protein-dna interaction analysis
a dna base is considered to be in contact with a protein if the distance between any heavy atom of the base and any heavy atom of the protein is less than a cutoff value . if the contact involves a base in the major/minor groove, it is annotated as a major/minor groove contact. when the distances between both the major and minor groove atoms of a base and a protein atom are within the cutoff value, the type of the base-protein contact is determined by comparing the contact distances and the angle formed by the "major groove atom"-"protein atom"-"minor groove atom". if the angle is less than  <dig> degrees, the contact with the longer distance is considered to be shielded by the shorter contact and is thus discarded. in case that the angle is more than  <dig> degrees, both the major and minor groove atoms of the base are considered to be in contact with the protein atom, which was usually observed in terminal bases and the bases that do not have base-pairing partners . we use several measures to describe the nature of protein-dna interactions: 1) major  groove contact number refers to the number of major  groove dna bases that are in contact with protein; 2) major groove contact ratio is calculated as the ratio between the number of major groove contacts and the sum of major and minor groove contacts; 3) base  contact number refers to the number of nucleotides whose base  is in contact with protein; 4) base contact ratio is calculated as the ratio between the number of base contacts and the sum of base and backbone contacts. additional aspects of protein-dna interaction that are analyzed by pda include "running-into-protein" dna   and "flipped base"  .

protein-dna binding unit
a pdb entry can have more than one protein-dna binding sites; for example, 1a <dig> has two distinct protein-dna binding entities on one double-stranded dna  . comparison of such complexes can be problematic as these complexes have different protein-dna binding entities. to resolve such a problem, we use a new term "protein-dna binding unit" to describe the distinct interaction unit: a double-stranded dna and a functional protein entity  bound to the dna. as in the case of 1a <dig>  it has two dna-binding protein components that do not interact with each other, therefore it is considered to have two protein-dna binding units .

functional classes of protein-dna complexes
each protein-dna complex structure is assigned with one of four functional classes  based on the keywords in the pdb file of a protein-dna complex structure. entries with "transcription" or "gene regulation" as keywords belong to the gene regulation class. the transferase class contains structures with keywords "transferase" or "polymerase" while the hydrolase class consists of pdb entries with annotated function of "hydrolase" or "nuclease". the protein-dna complex structures that cannot be assigned with any of these three classes are grouped into the "others" category. in case of conflicts, the function of the complex structure is further examined by manual inspection. for example, a few pdb entries have keywords for both the transferase class and the gene regulation class. all of them were classified as transferase after manual inspection.

sequence comparison of protein-dna complex structures
sequence comparison is a convenient way for determining the similarity of two macromolecules such as two protein or two dna sequences. it would be useful if such sequence comparison could also be done for protein-dna complexes. previous studies only compare protein sequences for dataset construction. since a protein-dna complex can have multiple protein chains as well as multiple double-stranded dnas, we take an approach of all-against-all comparison  of two complexes and report the lower and upper bounds of the sequence identities for protein and dna separately. while the sequences of the entire protein chains are used for protein comparison, the dna sequences used for comparison are not straightforward. some protein complexes have long dna sequences but only a small portion of the sequences are involved in protein-dna interaction. on the other hand, in some protein-dna complexes, a large percentage of dna participates in the binding and interaction with proteins even though the dna sequences are short. to address this issue, we first extract the dna subsequences that interact with proteins since in general the dna binding motifs are better conserved while the flanking sequences showed less conservation. the protein-binding dna fragment is defined as the longest dna subsequence bounded by two bases that are in contact with the protein plus one flanking base on each side . within the subsequence, at most three consecutive bases are allowed to be not in contact with the protein. if there is no base-protein contact in a double-stranded dna, the double-stranded dna is excluded from sequence comparison. likewise, protein chains that are not in contact with any bases of dnas are also excluded from sequence comparison. align  <cit>  is used for protein sequence comparison, with gap opening and extension penalty of - <dig> and - <dig>  respectively. as for the dna sequence comparison, we used an in-house program to perform gapless alignments since the binding motifs are generally short. sequence identity is defined as the number of identical residues or bases in the alignment divided by the length of the shorter sequence.

RESULTS
performance of base-pairing detection by pda
to test the efficiency of pda that uses only two distances  for base-pair detection, we compared the performance of pda with 3dna  <cit> , a program widely-used for dna structure analysis, on a dataset of  <dig> protein-dna complex structures that are solved by x-ray crystallography with high resolution  and have at least one base-pair determined by 3dna. two base-pairing matrices were generated for each dna by pda and 3dna respectively. each cell has a value of  <dig> if two bases form a pair and  <dig> otherwise. the correlation of base-pair assignments between pda and 3dna was calculated using matthews correlation coefficient   <cit> . the histogram of the mcc for the  <dig> protein-dna complex structures is shown in figure  <dig>  the mcc of more than 99% of the complexes is more than  <dig>  and 73% of the complexes show a perfect correlation between 3dna and pda. compared with the 3dna assignment, most of the missed base-pairs by pda were located at the termini of dna or in the middle of very long and wound dna. there are some base-pairs detected only by pda but not 3dna. through manual inspection, we found that many of these "false positive" base-pairs are possibly true base-pairs. based on above analysis, the performance of pda in base-pair detection is comparable to that of 3dna. our simple but effective approach uses less than five distance calculations per base-pair while 3dna employs a least square fitting procedure to obtain a reference frame for each base followed by comparing six geometrical parameters from two reference frames for a pair of bases.

pda analysis of protein-dna complex structures
pda takes a pdb file as input and outputs the detailed analysis result to the standard output as well as files for protein-dna binding units. most of the pda output is self-explanatory. several notable features of pda are as follows. one is the pdagram, a text-based diagram from pda analysis showing the organization and structure of double-stranded dnas and the interaction patterns between protein and double-stranded dna . the advantage of pdagram over 3d visualization of protein-dna complexes is that it provides an easy way to display the interaction pattern of a protein-dna complex. for 3d visualization of pda analysis data, a rasmol/jmol  <cit>  visualization script is automatically created for each pda analysis report, in which the protein and dna are rendered in cartoon and space-fill formats, respectively, with a default color scheme as shown in figure 5d.

structural features of protein-dna complex structures by pda analysis
pda has the capability to restore full protein-dna complex structures , recognize double-stranded dna structure, reconstruct the full-length double-stranded dna , and identify protein-dna binding units . figure 3c shows the utility of pda's complex structure restoration capability. the pdb file of 1zx <dig> has the coordinates for one protein dimer and one double-stranded dna. however, in the original literature for 1zx <dig> <cit> , three copies of the double-stranded dna were shown to bind to the same protein dimer . using the crystal symmetry information, pda reconstructed the coordinates of the whole protein-dna complex structure of 1zx <dig> as reported  <cit> . the pda program is also capable of detecting protein-dna complexes that have running-into-protein dna , cracks in a double-stranded dna , and flipped-out bases as described in methods . running-into-protein dnas and flipped-out bases are often observed in reverse transcriptase-dna complexes and dna modifying enzyme-dna complexes, respectively.

major/minor groove-protein contacts are important in studying protein-dna recognitions. figure  <dig> shows the distribution of major groove contact ratios by pda analysis of  <dig> non-redundant protein-dna complex structures chosen from pdb with the following criteria: 1) solved by x-ray crystallography with a resolution of at least  <dig>  Å; 2) at least one base-protein contact; and 3) each pair in the dataset has less than 30% protein sequence identity. we found that about  <dig>  percent  of the complexes have more minor groove-protein contacts than major groove-protein contacts suggesting that minor groove-protein contacts may play important roles in protein-dna binding specificity in a number of protein-dna complexes  <cit> .

clustering of protein-dna complex structures involved in gene regulation
to further demonstrate pda's utility in studying systems biology and structure-based transcription factor binding site prediction, we generated a non-redundant dataset with protein-dna complex structures that are involved in gene regulation. first, a total of  <dig> protein-dna complex structures that were solved using x-ray crystallography with resolutions less than  <dig>  Å were selected. we then selected the protein-complex structures that are in the "gene regulation" category and applied the following criteria: 1) the number of protein-dna binding units ≥ 1; 2) base contact ratio ≥  <dig>  to ensure specific interactions; 3) base contact number ≥ 2; 4) no running-into-protein double-stranded dna; 5) no "crack" in double-stranded dna structures. application of the above procedure resulted in  <dig> complex structures. the length distribution of the protein-contacting dna sequences as described in methods and implementation is shown in figure 9a. the length of most of the dna sequences ranges from  <dig> to  <dig> base pairs. the complex structures with dna shorter than  <dig> bps and longer than  <dig> bps were removed and a set of  <dig>  complex structures were generated for further studies.

since the dna sequences involved in protein-dna interaction are generally short , two unrelated dna sequences may have high sequence similarity. in set <dig>  there are  <dig> complex pairs in which the proteins have less than 30% sequence identity. when the corresponding dna sequences were compared, we found that about 93% of the dna sequences have up to 65% sequence identity even though the protein sequences are not similar . it is not surprising that all the dna sequence pairs showed at least 25% sequence identity using gapless sequence alignment approach as the dna sequences are short. on the other hand, there are  <dig> pairs of protein-dna complexes that have less than 65% dna sequence identity while the proteins have more than 50% sequence identity .

in general there is a trade-off between "redundancy" and "dataset size" for statistical analysis when constructing a dataset especially if the data available is not large enough as in the case of protein-dna complex structures. for example, when only protein sequences are used for protein-dna complex comparison, a low sequence identity cutoff  will generate a relatively small dataset. this dataset offers low-redundancy but lacks power in statistical analysis  <cit> . while a higher protein sequence identity cutoff increases the dataset size, the "non-redundancy" is compromised. note that protein-dna complexes may have dissimilar dna sequences and interaction patterns even though the protein sequence identity is over 50%   <cit> . therefore, it is possible to produce a dataset that is bigger while keeping a low data redundancy in terms of the nature of protein-dna interactions by increasing the cutoff of protein sequence similarity and applying dna sequence similarity at the same time. as an application example, we clustered complex structures in set <dig> into  <dig> groups using a sequence identity cutoff of 50% for both the protein and double-stranded dna. non-redundant datasets can be selected from the  <dig> distinct clusters and used for studying transcription factor-dna interactions. to our knowledge, this is the first attempt that not only considers the number of base-protein contacts, ratio of specific contacts between protein and dna but also take the double-stranded dna sequence identity into account. these datasets are available at .

CONCLUSIONS
we developed an automatic and comprehensive analyzer for protein-dna complex structures and implemented it as a computer program pda. pda can restore the full atomic coordinates of protein-dna complex structures from partial coordinates, accurately detect dna base-pairs with a new and simple algorithm, recognize double-stranded dna structures, analyze protein-dna contacts and define protein-dna binding sites. these restorations and annotations are necessary for constructing datasets that takes the dna into consideration, making them real non-redundant "complex structures", not just non-redundant in terms of proteins. pda's analysis on protein-dna binding modes, including major/minor groove interactions and base/backbone-protein contacts, will also help classification of protein-dna complex structures and construction of contact specific datasets for protein-dna interaction studies.

availability and requirements
pda and pre-compiled pda analysis results for protein-dna complex structures in pdb are freely available for non-commercial use at . the only requirement for running pda is a python interpreter . java virtual machine, which is available free at , is required for using the precompiled analysis data at . the webserver was successfully tested with firefox  <dig>  safari  <dig> and internet explorer  <dig>  the pda program and web server will be updated regularly.

competing interests
the authors declare that they have no competing interests.

authors' contributions
jg designed and supervised the study and revised the manuscript. rgk participated in the design of the study, implemented the computer program and the web server, and prepared the manuscript. all authors read and approved the final manuscript.

