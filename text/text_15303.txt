BACKGROUND
while annotation efforts and gene prediction methods have begun the process of identifying protein-coding genes, robust high-throughput methods for detecting functional non-protein coding elements remain elusive  <cit> . only about  <dig> percent of the human or mouse genomes consist of dna sequences that are protein-coding regions  <cit> . the remaining vast majority of the genome consists of non-coding sequences . it has been shown that gene regulatory elements  reside in the ncs  <cit> . gres have been broadly placed into two major functional groups: promoters and enhancers. promoters are sequences that direct the precise locations of transcription start sites. enhancers, repressor, and silencers, etc. are sequences that bind gene regulatory proteins and influence the transcription activity of a gene. gres can be located upstream, downstream, or even internal to the target gene. gres, therefore, act as switches to turn gene expression on or off and as modulators to increase or decrease expression. traditionally, ncs have not received as much attention from investigators as protein coding sequences and gres are generally poorly defined, mostly as only sequence motifs. research is now focusing increasingly on non-coding sequences and specifically the search for ncs with regulatory functions. identifying functional ncs and understanding their mechanism of operation will shed new insights into the understanding of the regulatory functions of transcription, dna replication, chromosome pairing, and chromosome condensation  <cit> . in order for the full understanding and eventual control of biological function, not only must the genes involved in a particular function be identified but the regulatory elements that trigger and control the biochemical pathways that determine each gene's expression must also be well understood. however, searching for functional gres within the ncs that comprise roughly 98% of the genome is not a simple task. the size and scope of this search brings with it many intellectual and experimental challenges that span computational biology and comparative functional genomics  <cit> .

there are two commonly used methods for identification of functional gres. the first uses gene expression analysis and the second uses comparative genomics. dna microarray gene expression profiling is capable of evaluating thousands of genes across various experimental conditions. bioinformatics approaches are used to cluster genes that show similar patterns of expression. once genes with similar patterns of expression are identified, they are searched within their upstream sequences to identify over-represented or conserved sequence motifs  <cit> . sequence alignment algorithms employed by the comparative genomic methods are powerful in identifying conserved sequences in non-coding regions located in and around genes with the same function, known as homologous genes, from diverse species. homologous genes usually have the same function and may also have similar regulatory elements that control this function. functional regions  experience selective pressure against change and therefore have a higher level of sequence conservation across a wide range of species than non-functional regions. ideally, selective pressures would allow for non-functional sequences to diverge due to evolutionary drift while leaving functional regions with high similarity  <cit> . dna sequence comparison of the human and mouse orthologous genes have indicated that conserved ncs are enriched significantly in regulatory sequence regions  <cit> . subsequent to the identification of putative regulatory elements by sequence comparison, the confirmation of biological function will depend upon experimental assays. transcriptional regulatory regions in genes from humans, mouse, fugu fish, caenorhabditis elegans, drosophila, and yeast  <cit>  have been identified. the power of comparative genomics analysis is enhanced significantly when genomic sequences are available from a number of related species that have diverged sufficiently. this reduces the chances of conservation among non-functional elements. by comparing multiple genomes, it can help to determine which conserved elements are more likely to be functional  <cit> .

whether the focus is on genes with similar expression patterns or those expected to have the same function, both analysis methods require the retrieval of ncs for the identification of functional sequence elements. currently, the process of retrieving these sequences is performed manually from a wide range of sources. no efficient method is available for retrieving ncs quickly and systematically at a single source. to facilitate the analysis of ncs for functional regulatory elements, we present here a web-based non-coding sequences retrieval system  that performs the automated retrieval of non-coding sequences among genomes of different species. a previously developed application for retrieving ncs, called retrieval of regulative regions   <cit>  parses annotation and homology data from ncbi to identify ncs. this parser requires local installation but also requires a local copy of desired genomes and annotation files. a web based application is also available but only a few genomes are currently available and rre utilizes annotation data from only ncbi. the ncsrs requires no installation or local management of genome sequence databases and utilizes annotation information from both ncbi and ensembl. currently, ncsrs has  <dig> genomes  with sufficient annotations available for ncs retrieval.

implementation
annotation and sequence information
there are two major groups currently working on genome annotation. data from these two sources serve as the source of the annotation information that comprises the core for this tool. these include ncbi refseq  <cit>  and ensembl  <cit> . refseq is a partially manually curated annotation database which includes information based on predicted mrnas and proteins. the genes with manually curated mrna information are labelled with the "nm" prefix while the genes based on predicted mrna information are labelled with an "xm" prefix. ensembl's gene predictions are automated but all predictions are based on experimental mrna evidence. the ensembl annotation system marks predicted genes as either known or novel based on the level of experimental support and information from other annotation sources. the number of genes annotated by ensembl and refseq are listed in table  <dig> and  <dig>  table  <dig> shows the number of genes annotated in refseq are also included in the ensembl system along with the percentage of overlap between the two with respect to the total number of annotated genes in the ensembl system. the pros and cons of each will not be discussed here but rather it is emphasized that this tool offers users the freedom to choose.

known – genes that have species-specific protein sequences already available in the public sequence databases. novel – genes that could not be mapped with confidence to existing entries. total predictions – the number of 'known', 'novel' and 'pseudogenes' predicted by the ensembl analysis and annotation pipeline.

entrez genes – number of genes defined by sequence and/or located in the ncbi map viewer. total unigene clusters – the number of non-redundant sets of gene-oriented clusters automatically partitioned by unigene.

the homolog data table files for each of the baseline species were queried to find the total number of genes along with the number of homologous genes that are present in another given species' genome. similarly the homologene.data file was used to generate the homologene statistics. shown are the number of homologs and the percentage of coverage 

the refseq annotation data  is obtained for each genome from the human genome browser at ucsc  <cit>  ftp site <cit>  as are some of the genome sequences. the remaining genome sequences along with the ensembl data  are obtained from ensembl's ftp site <cit> . both sets of gene annotations are downloaded and then processed to serve as the basis for building a genome map that contains the location of each gene and all its exons. ensembl includes 5' and 3' utr's along with coding exons when counting the total number of exons. 5' and 3' utr's are also listed on their website as exons and are included in the downloadable annotation files as exons. therefore, following this convention, 5' and 3' utr's have also been included in the list of exons by ncsrs. in those cases where multiple transcripts are available, the transcript with the greatest number of exons is used. because not all the transcript information is used to define sequences in the intron region there is the potential that an exon from an unused transcript variant may not be shared with the utilized transcript. in this case, the unshared exon would be "hidden" from the annotation and returned as part of the non-coding sequence. however this is not relevant in the majority of cases as "hidden" exons are not the norm. furthermore, this is limited to only the intragenic region and would not affect the up and down stream sequences.

in this paper non-coding regions refer to all sequences that are not exons. the definition of exons will follow the convention used by ensembl of defining exons as the set of 5' utrs, coding exons, and 3' utrs. ensembl includes 5' and 3' utrs in their total exon counts both on their website and in the downloadable annotation files  <cit> . while it is arguable that utr's can be considered non-coding regions, for the sake of consistency and clarity, the convention followed by ensembl is maintained.

homology prediction
the refseq annotation information, called homologene  <cit> , is the basis for the homologous gene prediction system. this system is implemented in the ncsrs by using the single "homologene.data" file  <cit>  for gene annotation information from refseq. this file is a list of the sets of homologous genes for all genes annotated by refseq. ensembl has its own homology prediction method and its output is organized in a set of multiple files. the ensembl annotation information is the basis for its homologous gene prediction and therefore when using ensembl's annotation information, ensembl's homology prediction results are used. simple analysis of the data generated by the two homology prediction methods shows that both systems have good coverage for those genomes most commonly used for research . as the annotations improve, the results of the predictions will also improve in accuracy and percent coverage.

input
the user's input of the desired search options on the user interface  determines the work-flow path . the search options include the input type, genome or genomes from which sequences will be extracted, range of sequence extension, exon masking, and output format. the user inputs the individual gene or set of genes of interest. the input can be either the entrez gene id or hugo gene symbol  but must be the same for all the genes of a given search. the non-coding sequences from a specific species can be returned by selecting the desired species from a pull down menu or from all species with a known orthologous gene, by activating the "pull all ortholog sequences" option according to the homologene database.

mapping
using the annotation information all annotated genes are sorted based on chromosomal position. then the start and stop locations for all coding regions are identified. by identifying the coding regions we can also determine the locations of the non-coding regions using genomic position information, or mapping, of a specified gene and its flanking genes. the non-coding sequences are identified simply as those located between the adjacent identified exons. the information for each gene's non-coding region is then written to a new set of files that are used by the ncsrs. this non-coding region annotation serves as the basis for the locations of the end points for each intergenic and intragenic region.

retrieval of non-coding sequences
using the locations of non-coding regions the appropriate genomic sequence is identified. the genome sequence file is read and the specified sequences are extracted and copied to a new file according to the appropriate position information. the ncsrs by default outputs the non-coding sequence of the specified gene starting from the end of its adjacent gene and ending with the start of the other adjacent gene . unless specified otherwise the ncsrs also outputs the intergenic sequences, exons and introns. the boundaries for the flanking regions can be arbitrarily set by specifying the extension length in the options, e.g., with a specified extension length of  <dig> bp. then,  <dig> bp up- and down-stream of the queried gene will be included in the extraction irrespective of the location of neighbouring genes. each sequence has a pair of associated files: fasta format sequence file with file extension ".fa" and exon definition file with file extension ".exon", both with file names generated using the ucsc annotation format. the ".fa" file contains the sequence in fasta format. the first line of the ".exon" file defines the span of the coding region. the first line also contains other information such as the name of the gene the chromosome the gene is located and the chromosomal position of the extracted ncs. the following lines list pairs of locations which represent the start and end of all the exons. these locations are relative to the start of the sequence in the ".fa" file. the set of sequences and exon annotation files are packaged as a compressed file that is available for download through a link on the results webpage . the result webpage also has a table of the gene or genes returned, for each genome that is currently available, along with a link to the results for each genes query of ncbi's entrez gene site  <cit> , a gene map view from ucsc's genome bioinformatics website  <cit> , and further gene information at ensembl's website  <cit> .

updating
both annotation systems, refseq and ensembl, are works in progress and   with subsequent releases, the annotations will improve in scope and accuracy. new genome assemblies will also continue to be released for new and existing genomes. as the sequence and annotation information which serve as the basis for this system are refined, the sequences generated by this system will improve. therefore, it is critical that the genomes and annotation information are kept up to date. the ncsrs will be updated automatically on a weekly basis to ensure that the most recent information is always available.

hardware and software
the ncsrs uses a single computer that acts as both the server and database. there is also a developmental computer which is used for updating, designing new applications, and troubleshooting. the main server uses dual intel® xeon® processors at  <dig>  ghz, with  <dig> gb ram and  <dig> gb hard disk space and runs apache  <dig>  as its web server. the scripts and programs used by ncsrs for building and accessing the databases are written predominantly in php and perl.

RESULTS
we have developed a web-based sequence retrieval system that quickly and easily extracts non-coding sequences associated with a specific user defined gene set from a single and/or multiple genomes. the ncsrs efficiently delivers non-coding sequences for specified genes or gene sets using a user-friendly interface from a single site. this system eliminates the need to manually sift though genome sequences and look for annotation information from multiple sources. this will help eliminate human errors as well as increase throughput for those investigating gene regulatory elements. the system also allows the user to specify the gene or set of genes for retrieval while maintaining a simple user interface, enabling the user to apply their expert knowledge without having to spend a lot of time learning how to use the system. another option that is important for those seeking to elucidate functional ncs is masking. repetitive sequence elements found in the genome can cause sequence alignment algorithms to predict conserved elements that do not have gene regulatory function. for this reason, there is an available option to mask sequences as repeated sequences to allow for alignment algorithms to ignore repeated sequences  <cit> .

this system has great flexibility in its potential applications. an important and unique feature is that if the user intends to apply this tool to a comparative genomics approach, the user can obtain the sequences for multiple species by simply selecting the "pull all orthologs" option. once the sequences are returned, a multiple sequence analysis can be performed for each set of homologous gene sequences. the system's ability to return sequences from multiple genomes in one run greatly increases the efficiency and speed of the system. furthermore, it has been shown that increasing the number of genomes used in alignment analysis increases the   signal-to-noise ratio and, if specific genomes are selected carefully,   increases the likelihood of correctly predicting functionality  <cit> . if microarray data is the basis for analysis, the system's ability to handle multiple genes in a single query allows for the user to input multiple genes with similar expression patterns at one time to return the desired sequences. it is even possible to combine the two approaches and obtain sequences for all homologous genes of a set of genes with similar expression profiles. this allows for the system to be utilized by those who seek to learn more about genome-wide networks through their analysis  <cit> .

CONCLUSIONS
ncsrs combines a number of available genomic resources  and applies them to the specific task of identifying and retrieving non-coding sequences in an up to date web based application that is easy to use and requires no maintenance by the user. the unique features of this tool will be very helpful for those studying gene regulatory elements that exist in non-coding regions. future work will include incorporating ncsrs with a program that analyzes non-coding sequences using a multi-sequence alignment algorithm and identifies highly conserved regions  <cit> . this pipeline will be designed to be able to rank potential gene regulatory elements according to the likelihood of functionality using sequence motif information of known transcription binding factors  <cit> . ultimately the seamless integration of these two tools with the ncsrs will be implemented into a gene regulatory element finder pipeline. this will allow future experimental work and resources to focus on the verification of potential regulatory elements to those conserved elements that have a theoretically basis for regulatory function and therefore increase overall efficiency. the proposed pipeline will serve as the initial selection process for targeting experimental verification.

availability and requirements
project name: ncsrs

project home page: 

operating system: platform independent

programming language: perl, php

licence: gpl

any restrictions to use by non-academics: none

authors' contributions
lc identified the need to develop such a system, initiated the project, and designed the basic functions. sd and yz wrote the source code for the software and web interface and contributed with ideas on overall design, feature requirements, and implementation. all authors participated in the drafting of the manuscript and approved the final version.

