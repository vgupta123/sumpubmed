BACKGROUND
predicting the phenotype from the genotype of complex organisms is one of the most important and challenging questions we face in modern biology and medicine  <cit> . genetic mapping, dissecting a phenotypic trait to its underlying quantitative trait loci  through the use of molecular markers, has proven powerful for establishing genotype-phenotype relationships and predicting phenotypes of individual organisms based on their qtl genotypes responsible for the trait  <cit> . the success of this prediction depends on how well we can map the underlying qtls and characterize complex interactions of these qtls with each other and with environmental factors. powerful statistical models have been developed in the past two decades to detect qtls and study their biological function in a diverse array of phenotypic traits  <cit> . worldwide, a substantial effort has been made resulting in the collection of a large amount of data aimed at the identification of qtls  <cit> . unfortunately, despite hundreds of thousands of qtls detected in a diversity of organisms, only a few of them have been isolated by positional cloning , leaving it unsolved how to construct a genotype-phenotype relationship map using genetic mapping.

the most likely reason for this result may arise from a possibility that the qtls detected by stringent statistical tests are not biologically relevant. existing strategies for qtl mapping were built on testing for a direct association between genotype and end-point phenotype. although such strategies are simple and have been widely accepted, they neglect the biological processes involved in trait development  <cit> . to attempt to fill this gap, a statistical model, called functional mapping  <cit> , has been developed to study the interplay between genetics and the developmental process of a phenotypic trait by integrating mathematical models and computational algorithms. if a trait is understood as a "system" that is composed of many underlying biological components  <cit> , we should be in a better position to comprehend the process and behavior of trait formation based on interactive relationships among different components. through mapping and using those qtls that govern design principles of a biological system, a new trait that is able to maximize resource-use efficiency can be generated and engineered.

as one important strategy for plants to respond to variation in the availability of resources in their environment, biomass allocation has been extensively used to study the relationship between structure and function in modern ecology  <cit> . the concept of biomass allocation has now been increasingly integrated with plant management and breeding, aimed to direct a maximum amount of biomass to the target of harvest   <cit> . if the whole-plant biomass is considered as a target trait, we need to understand how different organs of a plant coordinate and interact to optimize the capture of nutrients, light, water, and carbon dioxide in a manner that maximizes plant growth rate through a specific developmental program because plant biomass growth is not simply the addition of biomass to various organs. many theories and models have been proposed to predict the pattern of biomass partitioning in a response to changing environment. chen and reynolds  <cit>  used coordination theory to model the dynamic allocation of carbon to different organs during growth in relation to carbon and water/nitrogen supply by a group of differential equations. compared to the conventional optimization model in the context of maximizing the relative growth rate of a plant, the coordination model does not require an unrealistic capacity the plant possesses for knowing beforehand the environmental conditions it will experience during the growth period. here, we integrate the coordination and optimization model to study the pattern of biomass partitioning by incorporating the allometric scaling theory into a system of differential equations.

in a series of allometric studies by west et al.  <cit> , a power relationship that universally exists between parts and the whole can be explained by two fundamental design principles in biophysics and biochemistry; i.e., all organisms tend to maximize their metabolic capacity by increasing surface areas for energy and material production as well as internal efficiency through reducing distances and the time to transport water, nutrients, and carbon. the integration of this optimization theory expressed in terms of allometric scaling with the coordination theory leads to a tripled group of ordinary differential equations  to specify the coordination of the leaf, stem, and root biomass for a plant:   

where ml, ms, and mrare the biomasses of the leaves , the stem , and the roots , respectively, with whole-plant biomass w = ml+ ms+ mr; α and β are the constant and exponent power of an organ biomass scaling as whole-plant biomass  <cit> ; and γ is the rate of eliminating ageing leaves and roots. the complex interactions between different parts of a plant that underlie design principles of plant biomass growth can be modeled and studied by estimating and testing the ode parameters . for example, plants are equipped with a capacity to optimize their fitness under low nutrient availability by shifting the partitioning of carbohydrates to processes associated with nutrient uptake at a cost of carbon acquisition  <cit> . these parameters can be used to quantify and predict such regulation between different plant parts in response to environmental and developmental changes.

in this article, we put forward a conceptual framework to incorporate the design principles of trait formation and development into a statistical framework for qtl mapping. complementary to our previous functional mapping  <cit> , we name this new mapping framework "systems mapping" in light of its systems dissection and modeling of phenotypic formation. a group of odes like  or other types of differential equations is used to quantify the phenotypic system. much work in solving odes has focused on the simulation and analysis of the behavior of state variables for a dynamic system, but the estimation of ode parameters that define the system based on the measurement of state variables at multiple time points is relatively a new area. yet, in the recent years, many statisticians have made great attempts to develop statistical approaches for estimating ode parameters by modeling the structure of measurement errors  <cit> . we implemented ramsay et al.'s  <cit>  penalized spline method for estimating constant dynamic parameters in our genetic mapping. the problem for systems mapping with ode models is different from those considered in current literature. first, systems mapping is constructed within a mixture-based framework because qtl genotypes that define the de models are missing. second, systems mapping incorporates genotypic data which are categorical or binary. these two characteristics determine the high complexity of our statistical model and computational algorithm used for systems mapping.

RESULTS
qtl detection
we develop a new model for qtl mapping by treating trait formation as a dynamic system and further incorporating the design principles of the biological system into a statistical mapping framework . the new model, named systems mapping in light of its systems feature of phenotypic description, was used to map qtls for biomass partitioning in a mapping population of soybeans composed of  <dig> recombinant inbred lines  derived from two cultivars, kefeng no.  <dig> and nannong 1138- <dig>  for an ril population, there are two homozygous genotypes, one composed of the kefeng no.  <dig> alleles and the other composed of the nannong 1138- <dig> alleles. figure  <dig> illustrates the growth trajectories of leaf, stem and root biomass for individual rils. by using the system of odes  to fit growth trajectories of leaf, stem and root biomass over time, we obtained a mean curve for each trait. it can be seen that growth trajectories can be well modeled by three interconnecting odes  derived from coordination theory  <cit>  and allometric scaling  <cit> . the model-fitted curves of leaf  and root biomass trajectories  delineate reasonably the decay of leaf and root biomass at a late stage of development due to senescence. as expected, stem biomass growth does not experience such a decay  although growth at the late stage tends to be stationary.

by scanning the genetic linkage map composed of  <dig> molecular markers located in  <dig> linkage groups, we detected two significant qtls, one named as biomass <dig> that resides between markers gmkf167a and gmkf167b and the second as biomass <dig> that resides between markers sat- <dig> and be <dig> . using the maximum likelihood estimates of the curve parameters in ode  whose standard errors were obtained by the parameter bootstrap  <cit>  , we drew the growth trajectories of leaf, stem and root biomass for two different genotypes at each qtl . the genetic effects of the qtls displayed different temporal patterns for three organs. the qtls were expressed more rapidly with time for the stem than for the leaves and roots. at biomass <dig>  the alleles from parent nannong 1138- <dig> increase leaf and stem biomass growth , whereas the alleles from parent kefeng no.  <dig> increase root biomass growth . this could be interpreted as the nannong 1138- <dig> allele favoring carbon allocation to the shoots at the expense of the roots but the kefeng no <dig> allele favoring carbon allocation to the roots at the expense of the shoots. likewise, the biomass <dig> alleles from nannong 1138- <dig> favor carbon allocation to the leaves  and those from kefeng no.  <dig> favor carbon allocation to the roots, but the alleles at this qtl inherited from parent kefeng no.  <dig> favor carbon allocation to the stem, which is different from the behavior of qtl biomass <dig>  note that leaf and root biomass growth tend to decay at the late stage for almost all rils. but the genotypes at the qtls detected do not reflect this trend , although they display much reduced rates of growth at the late stage. we explained this to be due to some other qtls that have not been detected with the current linkage map.

model m <dig> assumes two different genotypes at a qtl , whereas model m <dig> assumes a single genotype .

note: qtl  <dig> is one between markers gmkf167a and gmkf167b on linkage group  <dig>  qtl  <dig> is one between markers sat- <dig> and be <dig> on linkage group  <dig>  the alleles of genotype qq are derived from kefeng no.  <dig> and those of genotype qq derived from nannong 1138- <dig> 

the functional relationships among leaf, stem and root biomass were determined by the qtls detected . for biomass <dig>  two genotypes are not only different in whole-plant biomass trajectory, but also display pronounced discrepancies in biomass growth trajectories of individual organs . this means that this qtl affects the dynamics of both plant size and biomass partitioning. the genotype composed of the kefeng no.  <dig> alleles has a smaller slope of biomass growth, leading to smaller whole-plant biomass at late stages of development, than that composed of the nannong 1138- <dig> alleles, but the former has larger root biomass over the entire period of growth at the expense of the shoots than the latter. for biomass <dig>  two genotypes are similar in total plant size during growth, but they have a marked distinction in biomass partitioning . it appears that this qtl affects plant growth trajectories through altering biomass partitioning rather than total amount of biomass. at this qtl, the genotype with the kefeng no.  <dig> alleles has a dominant main stem and heavy roots, whereas the genotype with the nannong 1138- <dig> alleles carries dense leaves.

simulation
by analyzing a real data set for soybean mapping, systems mapping produces the identification of two significant qtls that control the dynamic formation of whole-plant biomass through developmental regulation of different organs, stem, leaves, and roots. to validate the new model, we performed simulation studies by mimicking the effects of qtl biomass <dig> detected from the example of qtl mapping in soybeans. the simulated mapping population contains the same genotype data for  <dig> rils. the phenotypic values of three traits, the stem, leaf and root biomass, assumed to obey the system of ode , were simulated at six different time points by summing time-dependent genotypic values at biomass <dig> calculated with curve parameters in table  <dig> and residual errors. specifically, the phenotypic values of the kth trait were simulated by adding white noise with variances  to the ode curves for the jth qtl genotype with the probability wj|i, i.e., the conditional probability of the ith ril that carries the jth qtl genotype, given the two markers genotypes of this ril. the values of noise variance  were set as the estimates from the real data, which are ,  and  for the leaf, stem, and root biomass, respectively. meanwhile, by assuming a modest heritability  for each trait at a middle stage of growth, we re-scaled  values which were used to simulate a new data set.

systems mapping, implemented with the parameter cascading method, estimates qtl genotype-specific curve parameters in the ode  from the simulated data. the simulation was repeated  <dig> times to calculate the means, biases, standard deviations, and root mean square errors, with results tabulated in table  <dig>  it was found that the model can provide reasonably accurate and precise estimates of qtl genotype-specific ode parameters with a modest sample size . the biases of the estimates are negligible, compared with the scale of the standard deviations. given that this simulated data is a mimicry of the real soybean data, the results suggest that the experimental design used for soybean mapping is scientifically sound and can provide convincing qtl detection. this actually is not surprising because phenotyping has low measurement errors.

in analyzing a simulated data set for the traits assumed to have a modest heritability , the estimates of the ode parameters are reasonably accurate and precise, indicating the power of systems mapping to detect small qtls involved in trait formation. we performed an additional simulation to investigate the power and false positive rates of the model by changing levels of noises. in general, the power of the model is high, reaching  <dig>  even when the heritability of growth curves is low . basically, a qtl can be fully detected when the heritability is  <dig>  or larger. in any case, the false positive rates are not beyond  <dig> , mostly being less than  <dig> .

discussion
mapping the genetic architecture of complex traits has been a subject of interest in both theoretical and empirical aspects of modern biology  <cit> . original approaches for genetic mapping are based on single-point variation in a phenotypic trait, neglecting the dynamic change of the trait during development. to capture the dynamic pattern of genetic control, a new statistical model called functional mapping has been developed by incorporating the mathematical aspects of trait development  <cit> . despite significant improvement over conventional static mapping, functional mapping has still a major limitation in characterizing developmental pathways that cause a final phenotype and unraveling the underlying genetic mechanisms for trait formation and progression.

in this article, we have for the first time put forward a new approach-systems mapping by treating a phenotypic trait as a dynamic system and incorporating the design principles of a biological system into a statistical framework for genetic mapping. various components that constitute the system through developmental regulation are studied and connected by a system of biologically meaningful differential equations . thus, the genetic mapping of a complex phenotype become an issue of testing and estimating genotype-specific curve parameters at specific qtls that define the emerging properties and dynamic behavior of the de system. systems mapping identifies qtls that control developmental interactions of traits, the temporal pattern of qtls expression during development, as well as the genetic determinants that control developmental switches .

systems mapping was applied to map qtls for dynamic trajectories of biomass from different organs, the stem, leaves, and roots, that interact and coordinate to determine whole-plant biomass growth, in an experimental cross of soybeans between kefeng no.  <dig> and nannong 1138- <dig>  in general, the stem receives a proportionally larger amount of biomass with development, accompanying a proportional decrease of biomass to the leaves and roots. specific qtls, biomass <dig> and biomass <dig>  that control this allometric change with development have been detected from systems mapping. the alleles at the two qtls inherited from kefeng no.  <dig> tend to amplify this contrast in development-dependent biomass partitioning, as compared to those from nannong 1138- <dig>  one of the two qtls, biomass <dig>  was found in a similar genomic region identified by traditional functional mapping  <cit> . this consistency does not only simply verify our systems mapping, but also gains new insight into biological functions of the detected qtls. for example, the two qtls detected, biomass <dig> and biomass <dig>  trigger genetic effects on the interactions and coordination of different organs which cause the dynamic variation of biomass growth.

through various tests for ode parameters individually or in a combination, our systems mapping can reveal the genetic control mechanisms for several mechanistically meaningful relationships. they are  size-shape relationship - is a big plant due to a big stem with sparse leaves or a small stem with dense leaves?  structural-functional relationship - in a specific environment does a plant tend to allocate more carbon to its leaves for co <dig> uptake or roots for water and nutrient uptake?  cause-effect relationship - are more roots due to more leaves or do more leaves produce more roots? and  pleiotropic relationship - different traits with a similar function tend to integrate into modularity  <cit> . how do the same qtls pleiotropically control this modularity? a better understanding of these relationships helps to gain more insights into the mechanistic response of plant size and shape to developmental and environmental signals and, also, provide guidance to select an ideotype of crop cultivars with optimal shape and structure suited to a particular environment  <cit> .

the model described in this article is a simple framework for systems mapping. it can be used as a start point to expand the concept of systems mapping to tackle more complicated biological problems. a phenotype can be dissected to any number of components at any level of organization, molecule, cell, tissue, or whole organism, depending on the interest of researchers and data availability. with more knowledge about phenotype formation and development, more components can be involved in a system that is specified by high-dimension differential equations. sophisticated mathematical techniques are needed to obtain stable solutions of these equations. in addition, by integrating it with genome-wide association studies, systems mapping will not only provide a clear view of how different components interact and coordinate to form a phenotype, but also will be capable of illustrating a comprehensive picture of the genetic architecture of complex phenotypes. there is also a good reason to integrate systems mapping with network biology to explore how "omics" information contribute to the regulatory mechanisms of phenotype formation  <cit> . in any case, systems mapping will open a new avenue for understanding the genetic architecture of complex phenotypes from a perspective of mechanistic pathways inside their formation.

CONCLUSIONS
the past two decades have seen a phenomenal increase in the number of tools for the genetic mapping of complex traits. although genetic mapping continues to be an interesting area in genetic research owing to the success of molecular and sequencing technologies in generating a flood of data, a conceptual breakthrough in this area remains elusive. in this article, we present a bottom-top model for mapping and studying the genetic architecture of complex traits. different from existing mapping models, we use a systems approach to identify specific genes or quantitative trait loci that govern the developmental interactions of various components comprising the phenotype. the map of developmental interactions among different components is constructed by a system of differential equations. thus, by estimating and testing mathematical parameters that specify the system, we are able to predict or alter the physiological status of a phenotype based on the underlying genetic control mechanisms. we have tested and validated our model by analyzing a real data set for genetic mapping of biomass growth in soybeans. the detection of qtls by the new model provides biologically meaningful interpretations of qtl effects on trait formation and dynamics. the new model can be readily used to study the genetic basis of phenotypes in any other organism.

