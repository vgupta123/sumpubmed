BACKGROUND
gene network inference  from whole transcriptome expression data is a fundamental and challenging task in computational systems biology, with potentially important applications in translational research. often, a major aim is to identify sets of coordinately expressed genes, termed network modules, and to study their properties and how they change across conditions . these gene network modules may represent novel, context specific, functional biological units, and identifying and studying such modules has become an important tool of systems biology . although diverse computational and statistical approaches have been devised to identify such modules , their performance behavior is still not fully understood, particularly in complex human tissues. this situation is understandable – objective assessment is challenging in this context. nevertheless, these tools are being applied to the study of complex diseases  <cit> , and evaluating the performance, as well as understanding the limitations of state-of-the-art methods in this context, is important. this is particularly true for translational research where studies tend to be smaller, and are often performed in complex tissues and/or highly heterogeneous patient populations. while it is challenging to directly assess the accuracy of inferred networks derived by these methods in real-world expression datasets, the resulting gene modules have properties that may be objectively measured in such data.

one such property is module reproducibility. a comprehensive review of various means of assessing module reproducibility was published by langfelder et al.  <cit> . in that study, the authors outlined two broad categories of module preservation statistics: cross-tabulation and network topology derived , and chose to focus on the latter as a means of assessing module reproducibility, in part because of the difficulty of assessing cross-tabulation module preservation statistics in the absence of an independent validation dataset. re-sampling approaches, such as cross-validation or bootstrapping, have previously been used to overcome this, however . cross-tabulation reproducibility measures are of particular interest because they can be readily applied to a broad range of gene module identification strategies, including popular clustering approaches  that do not yield a nodes-and-edges network structure and, therefore, cannot be assessed by network topological metrics.

here, we introduce a flexible strategy for assessing the reproducibility of gene modules that does not rely on network topology and leverages bootstrap re-sampling in place of an independent validation dataset. even though the idea of using bootstrap re-sampling to evaluate module stability is not new , a systematic approach to summarize the results obtained across many re-samplings into an easy-to-interpret criterion of module stability, has yet to be described. we demonstrate that the proposed procedure can provide a useful measure of module stability – how sensitive a module’s gene membership is to changes in the set of samples that were used to identify it – in a large , highly relevant clinical dataset: gene expression profiling of peripheral whole blood, a highly heterogeneous tissue, in chronic obstructive pulmonary disease , a complex human disease. copd is a progressive disease, characterized by non-reversible loss of lung function and sporadic worsening of symptoms  termed acute exacerbations of copd . these exacerbations lead to substantial morbidity and mortality  <cit> . additionally, some patients experience exacerbation episodes more frequently, and there is interest in understanding the molecular basis, if any, of this phenotype. since most exacerbations are associated with bacterial or viral respiratory tract infections  <cit> , immune system monitoring using whole blood, transcriptome-wide, gene expression profiling could provide useful insights  <cit> . we explored this notion by identifying gene network modules from this gene expression data using three popular strategies: weighted gene co-expression analysis   <cit> , a method based on the partial least squares regression  technique described by pihur, datta and datta  <cit> , and a clustering-based approach described by chaussabel et al.  <cit> .

the proposed procedure is more formally defined below . briefly, the ability to recover similar modules across many re-sampled datasets reflects module stability. we propose to estimate gene module stability by looking for concordance between a reference module set derived from the entire data and a large number of comparator module sets derived from re-sampled datasets. concordance can be determined using some similarity measure; we propose a variation on the jaccard similarity coefficient, a statistic commonly used to assess the similarity of sets. the stability of a particular module can be estimated by inspecting the distribution of similarity scores across a large number of repeated re-samplings. a schematic representation of the procedure, termed sabre  is shown in additional file 1: figure s <dig> 

to facilitate the prioritizing of modules, we introduce a criterion that summarizes the distribution of similarity measures obtained for a particular reference module across bootstrap re-samplings, and explore some useful properties of this criterion. we hypothesized that modules identified by various algorithms, such as wgcna and the approaches described by pihur, datta and datta, or chaussabel and others, vary with respect to their stability and that this quality may provide a useful means of prioritizing specific modules for further study. moreover, changes in module stability across conditions may suggest loss of regulation, which could be of biological interest.

methods
dataset
we obtained paxgene blood samples from  <dig> patients with chronic obstructive pulmonary disease , who were enrolled in the evaluation of copd longitudinally to identify predictive surrogate endpoints  study  <cit> . these patients were clinically stable at the time of blood collection and their demographics are summarized in additional file 2: table s <dig> 

rna extraction and microarray processing
blood samples for all subjects and timepoints were collected in paxgene tubes and stored at −80 °c until analysis. total rna was extracted using paxgene blood rna kits , and integrity and concentration determined using an agilent  <dig> bioanalyzer . affymetrix human gene  <dig>  st  microarrays were processed at the scripps research institute microarray core facility  in order to assess whole transcriptome expression. the microarrays were checked for quality using the rmaexpress software  <cit>  . all microarrays that passed quality control were background corrected and normalized using quantile normalization   <cit>  and summarized using a factor analysis model   <cit> , via the ‘farms’ r package. farms includes an objective feature filtering technique that uses the multiple probes measuring the same target transcript as repeated measures to quantify the signal-to-noise ratio of that specific probe set. informative probe sets, as identified by farms , were used for all downstream analyses. limiting the feature space in this manner had the additional benefit of speeding up identification of gene network modules in the next step, an important consideration given the proposed bootstrapping procedure.

identification of gene modules
we identified network modules using three different approaches: weighted gene co-expression network analysis   <cit> , via the ‘wgcna’ r package  <cit> , a method based on the partial least squares regression  technique described by pihur, datta and datta  <cit> , and a k-means clustering-based approach to identifying sets of coordinately expressed transcripts described by chaussabel and others  <cit> . in wgcna, the unsigned gene-gene correlation matrix was weighted to produce a network with approximately scale-free topology, characteristic of biological systems  <cit> . average linkage hierarchical clustering is then applied to this weighted gene co-expression network, and the resulting dendrogram cut at a height of  <dig>  to produce modules with minimum size of  <dig>  the total number of modules identified in this manner was not fixed. we adopted a similar strategy to identify modules using the approach described by pihur and others, this time applying average linkage clustering to the gene-gene interaction matrix output from the pls procedure and cutting the resulting dendrogram at a heaight of  <dig> , as before. the chaussabel approach employs the k-means clustering algorithm to identify co-clustering genes. this algorithm uses a top down strategy in which genes are randomly divided into a predetermined number of clusters. genes are then iteratively re-assigned to their nearest cluster by some distance function , and cluster centers re-computed under the new configuration. this process is repeated until the algorithm converges. the number of clusters, or gene modules, was necessarily fixed in this case. we used the elbow criterion to determine the point at which the inclusion of additional clusters no longer provides a large increase in proportion of variance explained. because the initial centers are arbitrarily chosen, the solution is unlikely to be the minimal sum of squares of all possible partitions. rather a local minimum is returned where any further reassignment of a gene from one cluster to another will not reduce the within cluster sum of squares. to address this we used  <dig> random initial configurations and retained the solution with minimal sum of squares. although this provides a minimum over several partitions, it does not guarantee a global minimum solution.

assessing the stability of gene modules
all three approaches were applied as described to all  <dig> peripheral whole blood expression profiles to identify modules of coordinately expressed transcripts. these are termed the reference module sets for each approach. to assess stability of all modules within the reference module sets, bootstrap re-sampling was used to generate  <dig> random sets of  <dig> subjects. all three network module identification approaches were applied to all re-samplings to produce  <dig> bootstrapped sets of modules, in each case.

in order to describe how we propose to assess the stability of the reference modules, we must first introduce a few related concepts. we start with the concept of module accuracy, defined as follows: for each reference module q, a set of genes of size |q|, and a test module q′, where |q ∩ q′| is the number of genes in common between the two. accuracy is then defined as:  <dig> accuracyq=q∩q′q∈ <dig> 


we instead propose to use the closely related jaccard similarity coefficient, a statistic commonly used to assess the similarity of sets:  <dig> jaccardqq′=q∩q′q∪q′∈ <dig> 


comparison of a reference module to a test module that is an exact subset should be considered a perfect match from a stability standpoint . in order for the similarity measure used to reflect this, we modify  as follows:  <dig> similarityqq′=q∩q′minq,q′∈ <dig>  


this is analogous to the simpson index that can be computed for bipartite networks  <cit> , but note that similarity is defined only in terms of the degree of overlap between modules members or nodes. the modules are treated as simple sets in .

finally, gene module stability can be very naturally estimated via a random re-sampling with replacement procedure, termed bootstrapping  <cit> , by looking for concordance between a reference module set derived from the entire data and one derived from a re-sampled dataset. concordance can be determined using the similarity measure defined above . when comparing a module q to a module set q = {q
 <dig>  q
 <dig>  q
 <dig> …,q
n}, the best match for q is defined to be q′, such that  between q and q′ is the highest among all possible comparisons between q and members of q. the best match similarity coefficient is then  between q and q′, and the stability of a particular module q can be estimated by looking at the distribution of best match similarity scores across a large number of repeated re-samplings, {r
j; j =  <dig> ,…,n}. in order to rank modules by their stability, we summarize these distributions for each module to a single number, the hirsch index , as follows:  <dig> h−indexq=maxh11000∑j=11000rj≥h≥h∈ <dig>  


for a reference module with h-index =  <dig> ,  <dig>  similarity or greater was observed in 80 % of bootstrap runs. a more qualitative interpretation would be that we expect this reference module, derived from all available samples, to have 80 % similarity to a hypothetical module derived from a whole population dataset.

construction of random gene modules
to get a sense of the stability that could be expected of a module containing genes with minimal relation to each other, we carried out a simulation study. modules of size 50– <dig>  were created by sampling from the all  <dig> gene symbols in the farms filtered dataset. this was done  <dig> times for each size of module. then, for each of these random modules, the best match jaccard similarity coefficient was recorded across all  <dig> module sets generated during the previously described bootstrap procedure. the resulting distribution was summarized using the h-index.

stability of network modules, sample size, and module size
in order to study the relationship between network module stability, sample size, and module size, a slight variation of the bootstrap re-sampling strategy was used. we randomly sampled, without replacement  <dig>   <dig>   <dig>   <dig>   <dig>  or  <dig> expression profiles from the  <dig> peripheral whole blood expression profiles described above. in each case, a reference module set was produced,  <dig> bootstrap re-samplings of the selected expression profiles generated, and the stability of the reference module set across bootstrap re-samplings determined as before. this was repeated  <dig> times to capture the effect the original selection had on generation of the reference module set.

stability of network modules and network topology
the relationship between module stability and various network topology measures was also of interest. we constructed an undirected network using the ‘igraph’ r package  <cit> . we defined a gene-gene edge as that where the absolute correlation for that gene pair was at least two standard deviations away from the mean correlation observed across all possible gene pairs. various topology measures were then calculated for each of the reference modules: average number of neighbors per gene , number of instances in which a gene appears in a shortest path between two other genes, and number of triads , and compared to their stability.

stability of network modules and functional annotation
finally, we explored the relationship between stability and our ability to functionally annotate gene modules. we hypothesized that stable or reproducible gene modules should correspond well to known biological programs more often than unstable ones. to test this, we compared the gene membership of our reference modules to the msigdb collections   <cit> . we also included the recently described blood transcriptome modules , a collection of blood-specific transcriptomic modules derived from an analysis of over  <dig>  human blood transcriptome profiles from more than  <dig> studies whose data are publicly available  <cit> . annotation was done by testing for over-representation of genes from the msigdb gene sets using a hypergeometric test, a simple statistical method commonly used to quantitatively measure enrichment  <cit> . to quantify how well a particular module was annotated in the gene set collection, we computed the sum of the –log <dig> of the p-values for the hypergeometric test across all gene sets in the collection and compared it to its stability, separately in each of the collections .

RESULTS
we first identified sets of gene modules by using all available samples and by employing three different approaches: weighted gene co-expression network analysis   <cit> , a method based on the partial least squares regression  technique described by pihur, datta and datta  <cit> , and a clustering-based approach to identifying sets of coordinately expressed transcripts described by chaussabel and others  <cit> . these are termed reference module sets.

when applied to all  <dig> samples, wgcna identified  <dig> network modules, ranging in size from  <dig> to  <dig> probe-sets , with a mean module size of  <dig> probe-sets . the method from pihur, datta and datta, identified  <dig> network modules, ranging in size from  <dig> to  <dig> probe-sets , with a mean module size of  <dig> probe-sets . the chaussabel approach identified  <dig> network modules ranging in size from  <dig> to  <dig> probe-sets , with mean module size of  <dig> probe-sets . modules identified by wgcna and the pihur approach were highly concordant , while those identified by the chaussabel approach were largely distinct  with the exception of the wgcna-derived turquoise and blue modules, which were similar to the chaussabel-derived m <dig> and m <dig> modules, respectively . annotation of the turquoise/m <dig>  and blue/m <dig> modules, was consistent .

assessing gene module stability using sabre and the h-index
next, we applied sabre to assess the stability of these reference modules. refer to methods for detail. briefly, each algorithm was allowed to identify a set of network modules from each re-sampling and these re-sampled module sets were compared to the reference module set. for each reference module, only the highest observed similarity coefficient within each re-sampling  was recorded and the distribution of these similarity coefficients across all bootstrap re-samplings was used to assess stability. modules with distribution of similarity coefficients across all re-samplings that skewed towards one were consistently matched to highly concordant re-sampled modules across many random sample configurations and are thus deemed to be relatively insensitive to sample outliers. to simplify interpretation, we summarized the distribution of similarity coefficients for each module to its hirsch-index  <cit>  , as defined in . a visual derivation of the h-index is shown in fig.  <dig> for the modules identified by wgcna.fig.  <dig> visual derivation of the h-index. a visual depiction of the derivation of the h-index is shown for modules identified by the wgcna algorithm. a set of reference modules derived from all available samples are compared to a series of comparator module sets derived from bootstrapped re-sampled data. for each re-sampled dataset, all reference modules are compared to all newly identified modules using the jaccard similarity coefficient. for each reference module, the best match jaccard similarity coefficient value is recorded. finally, these best match similarity coefficients are sorted and a measure of the area under the resulting curve  used to estimate the reference module’s stability




gene module stability increases with sample size and module size
gene modules are often identified in relatively small study populations. we used a variation of the sabre strategy to study the effect of sample size on gene module stability. as expected, module stability, as assessed using the current framework, increased as the sample size was increased . this relationship held for both very stable  and less stable  modules. we also observed a relationship between module stability and module size in smaller studies , but there was no such relationship at larger sample sizes . in all cases, modules identified  were more stable than modules assembled by randomly sampling from all gene symbols in the filtered dataset, even when sample size was small .fig.  <dig> gene module stability increases with sample size and module size. for each n, we sampled without replacement from all available gene expression profiles  <dig> times. in each case, a reference module set was produced ,  <dig> bootstrap re-samplings of the selected expression profiles generated, and the stability of the reference module set across bootstrap re-samplings determined as described in the methods section. a stability of the modules is visualized at n =  <dig>   <dig>   <dig>   <dig>   <dig> and  <dig> for the 1st, 5th and 10th rank modules. b stability is plotted against module size at n =  <dig>   <dig>   <dig>   <dig>   <dig> and  <dig>  the dotted line depicts the best-case stability of random modules in simulation. we compare the stability of s  and xl  modules using wilcoxon’s rank-sum test




stability profiles differ between algorithms
the h-index was next used to rank reference modules . modules varied with respect to their stability as assessed by the sabre procedure, both within sets of modules identified by particular algorithms, as well as across strategies. modules identified by all three strategies were significantly more stable than modules assembled by randomly sampling from all gene symbols in the filtered dataset . the set of network modules identified by wgcna was more stable  than that identified by either the pihur , or chaussabel approaches , though the top ranking module identified by all three approaches had comparable stability .fig.  <dig> stability profiles differ between algorithms. gene module similarity across bootstrap re-samplings, for all reference network modules identified by three gene module discovery algorithms, is visualized using box plots . the stability of the network modules is summarized using the h-index . the dotted line depicts the best-case stability of random modules in simulation




stable modules are more interconnected
we might expect more connected gene network modules to be more stable. there are many proposed metrics for measuring network connectivity. the simplest such metric is the average number of neighbors. for our dataset, there is no observed trend between the h-index and the average number of neighbors within a module. a stronger notion of connectivity is to measure the number of nodes that are in the shortest path between some pair of nodes in the network. the higher this number, the more tightly connected the network. figure  <dig> suggests that there is a relationship between this notion of connectivity and the h-index. an even stronger notion of connectivity described in the literature is the number of triads, which are triplets of nodes that are directly connected pairwise. figure  <dig> indicates that there is a weak relationship between this notion of connectivity and the h-index, particularly for lower values of the h-index. in sum, it appears that the notion of stability indicated by the h-index is related, but not identical, to  <dig> well-known notions of connectivity in network science.fig.  <dig> stable modules are more interconnected. the relationship between module stability and a number of topological measures of network connectivity is visualized for modules identified by wgcna  or the chaussabel approach . stability is positively associated  with both number of appearance in the shortest path and number of triads in the network 




stable modules are more readily annotated
we hypothesized above that stable modules should correspond to well-characterized biological functions. if this is true, we would expect stable modules to be more readily annotated than less stable ones. we explored this notion in the btm and msigdb collections of annotated gene sets and found that stable modules were indeed more readily annotated across many of the included collections . module stability was significantly associated with annotatability  in the hallmark , positional , immunologic signatures , and blood transcriptomic modules  collections, marginally associated in the canonical , and oncogenic signatures  collections, and showed no significant association in the gene ontology , motif , or computational  gene set collections. complete gene set over-representation results are tabulated in additional file 5: table s <dig> fig.  <dig> stable modules are more readily annotated. module gene over-representation in annotated gene sets  is visualized, for modules with varying stability, in the msigdb and btm collections. stability is positively associated  with our ability to assign module to known biology  in many of these collections




many gene modules identified by wgcna had very high concordance with gene sets corresponding to distinct biological functions . in fact, even relatively less stable modules identified by wgcna appeared to correspond to known biological pathways . modules identified by the chaussabel approach had generally lower concordance to annotated gene sets, with modules often having seemingly overlapping biological function . in fact, nearly half of gene modules identified by the chaussabel approach were enriched in genes associated with translation  and mrna transcription .

discussion
the main objective of this work was to devise a strategy for evaluating the stability of gene modules in a manner applicable to a broad range of gene module identification strategies, and not reliant on the availability of additional datasets for validation. quantifying network module stability would allow for prioritization of modules for further experimental interrogation. while the use of re-sampling strategies, such as cross-validation or the bootstrap, in this context has been previously proposed , a systematic approach to summarizing the results obtained across many re-samplings into an easy-to-interpret criterion of module stability, has yet to be described. as shown in fig.  <dig>  for a particular module, all the re-sampling results can be captured by a curve. the question we ask is how to summarize the curve with a single value that is informative. standard ways, such as using the mean value, or even using the area-under-the-curve value, do not provide a “minimum quality” guarantee. in contrast, the proposed bootstrap re-sampling and summarization scheme, sabre, does provide such a lower bound guarantee, at least across all generated bootstrap runs. the proposed stability criterion, the h-index of the curve, corresponding to the largest square under the curve, is readily interpreted: for a module with h-index =  <dig> , one can say that similarity of  <dig>  or greater was observed across at least 80 % of the bootstrap runs.

we go on to explore a number of useful characteristics of the h-index. we show that the h-index of a module generally increases as sample size increases and observe that, for any given module, a stability maximum appears to be reached between n = 80– <dig>  at least in this tissue and patient population. we also note that, while smaller modules are generally less stable, this is not the case with larger sample sizes . as expected, we find randomly assembled modules to have very low stability , and it is comforting to note that, even for very small studies , modules identified by wgcna had worst case stability that exceeded this value, suggesting that, for some gene modules at least, core members may be identifiable even in very small studies. taken together, these observations suggest that the identification of robust gene expression modules in complex tissues and diseases requires large study populations .

next, we compare gene network modules identified by three popular gene network module identification strategies. wgcna and the pls-based approach described by pihur, datta and datta identified largely concordant sets of gene network modules, while the modules identified by the chaussabel approach were largely distinct. given that module identification for both wgcna and the pihur approach utilized average linkage hierarchical clustering on an adjacency matrix, this is perhaps not surprising. applying sabre to these modules sets allowed us to readily rank identified gene modules from most to least stable. modules identified by wgcna were generally more stable than those identified by the other two approaches. the ranking of modules by their stability, in combinations with other metrics, such as biological annotation, may inform prioritization of certain modules for further study.

we found that the h-index was positively associated with topological notions of network connectivity, as well as our ability to assign biological function to gene modules. sabre uncovered important qualitative differences between module sets in this respect, however. first, while stability was positively correlated with connectivity across all modules, this relationship was strongest in modules identified by the chaussabel approach. these modules also exhibited lower network connectivity compared to those found by wgcna. this is not surprising since the chaussabel approach pays no attention to the topology of the constructed modules. a similar pattern emerges when comparing the relationship between module stability and annotatability in the msigdb and btm gene set collections. here again, the relationship between stability and annotatability was strongest in modules identified by the chaussabel approach. given the distribution of the stability criterion, and the connectivity or annotatability measures considered, it is difficult to determine whether the observed relationships between stability and connectivity/annotatability are true or primarily driven by broad differences in stability between module sets identified by different strategies.

stable gene modules that do not readily correspond to annotated gene sets may be very interesting, of course, as they may represent novel, disease- or tissue-specific biological processes. two such gene modules were identified in the current study: the lightgreen  and blue  modules. in an effort to assign biological function to these modules, we compared them to the recently published blood transcriptome modules . these empirically derived sets of co-regulated genes have very low overlap with presently available pathways and were identified in peripheral whole blood gene expression data. we reasoned that the highly stable, un-annotated modules we independently identified in this study may in fact correspond to some of these highly stable blood modules. in fact, this was the case: the lightgreen module was enriched for a number of btms related to b cell activity, while the blue module was matched to various innate immunity btms . both b cells and neutrophils are known to be implicated in copd.  <cit>  this provided validation, both of the modules themselves, and of the stability ranking produced by the sabre procedure, in that two highly stable modules that did not correspond to any available pathway annotations, were consistent with independently derived functional modules specific to blood leukocyte sub-populations. these modules may represent important and novel biological function in the peripheral whole blood compartment of copd patients.

CONCLUSIONS
in conclusion, we demonstrate that bootstrap re-sampling, and the sabre procedure described herein, can assess the stability of gene modules identified by three different algorithms and suggest that this could be a useful criterion when selecting modules for further investigation. we also show that when modules are identified in smaller studies, more stable ones are more likely to replicate in larger experiments compared to less stable ones. we show a relationship between this notion of stability, topological connectivity, and our ability to assign biological function to gene modules. our approach highlights the relative robustness of the wgcna algorithm to sample outliers and, more generally, suggests that many gene module strategies should probably be applied jointly to any given dataset. finally, we identify and validate two highly stable modules that may represent novel, tissue-specific biological function in the context of the peripheral whole blood of clinically stable copd patients.

additional files

additional file 1: figure s <dig>  schematic of bootstrap re-sampling procedure. 


additional file 2: table s <dig>  patient demographics. demographic characteristics of the  <dig> copd patients. 


additional file 3: table s <dig>  wgcna reference module sets. 


additional file 4: table s <dig>  pihur reference module sets. 


additional file 5: table s <dig>  chaussabel reference module sets. 


additional file 6: figure s <dig>  wgcna and chaussabel module concordance. concordance between network modules identified by two gene network module discovery. reference module sets were identified using all available gene expression profiles. the similarity coefficient for each pair-wise comparison is visualized as a clustered heatmap, with red indicating high similarity and blue indicating low similarity. 


additional file 7: table s <dig>  pathway over-representation analysis results for the wgcna and chaussabel modules sets. for each module identification strategy and module in turn, we carried out pathway over-representation analysis against the broad institute’s msigdb collections by comparing the gene set and module membership using a simple hypergeometric test. we report both p-value and false discovery rate adjusting for multiple comparisons using the benjamini-hochberg procedure. 


additional file 8: figure s <dig>  random module stability. to get a sense of the stability that could be expected of a module containing genes with minimal relation to each other, a simulation study was carried out. modules of size  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  and  <dig> were randomly assembled by sampling from the all  <dig> gene symbols in the filtered dataset. this was done  <dig> times for each size of module. for each random module, their best match jaccard similarity ceofficients were computed for each of the  <dig> bootstrap results previously generated, and the resulting distribution was summarized using the h-index. 




abbreviations
aecopdacute exacerbation of chronic obstructive pulmonary disease

copdchronic obstructive pulmonary disease

gnigene network inference

sabrestability across bootstrap re-samplings

wgcnaweighted gene co-expression analysis

