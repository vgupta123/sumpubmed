BACKGROUND
the humoral immune response is based on the ability of antibodies to recognize and bind to epitopes on the surface of antigens with high specificity. it is believed that most protein epitopes are composed of different parts of the polypeptide chain that are brought into spatial proximity by the folding of the protein or discontinuous. however, for approximately 10% of the epitopes, the corresponding antibodies are cross-reactive with a linear peptide fragment of the epitope  <cit> . these epitopes are termed linear or continuous and are composed of a single stretch of the polypeptide chain.

in many cases it is difficult to obtain a pure preparation of the protein of interest for immunization purposes. the traditional cloning of the proteins or experimental peptide scanning approach is clearly not feasible on a genomic scale. however, to raise antibodies it is not necessary to present the complete protein but only the immunogenic fractions. specific antibodies can be generated by immunization of animals with a peptide if the peptide is well chosen and presents an effective continuous epitope of the protein. the continuous b-cell epitopes play a vital role in the development of peptide vaccines, in diagnosis of diseases, and for allergy research. the specific interactions between antibodies generated against the continuous epitopes are also exploited extensively in biochemical and high-throughput assays. the encode  <cit>  and the modencode  <cit>  projects aim to profile protein-dna interactions for all transcription factors and dna associated proteins for human and for model organisms like drosophila melanogaster and caenorhabditis elegans using the factor specific antibodies. this has increased the demand for good antibodies at the whole genome level.

the computational methods can be cost effective and reliable for predicting linear b-cell epitopes and can guide a genome wide search for antigenic b-cell epitopes. therefore, a lot of research has been devoted in the past for identifying continuous b-cell epitopes from the protein sequences. the classical approach of epitope prediction is to utilize the amino acid propensity scales describing properties like hydrophobicity  <cit> , hydrophilicity  <cit> , flexibility/mobility  <cit> , surface accessibility  <cit> , polarity  <cit> , turns  <cit> , and antigenicity  <cit> . the first propensity scale method for predicting linear b-cell epitopes was introduced by hopp and woods  <cit>  and utilized the levitt hydorophilicity scale  <cit>  to assign a propensity value to each amino acid. preditop  <cit> , people  <cit> , bepitope  <cit> , and bcepred  <cit>  predicted linear b-cell epitopes based on combinations of physico-chemical properties as opposed to the propensity measures that rely on individual properties. the bcepred method obtained the best specificity of 56% and sensitivity of 61%  <cit> . blythe and flower assessed  <dig> amino acid propensity scales in combination with ranges of plotting parameters and found that even the best set of scales and parameters perform only marginally better than random  <cit> . this led researchers to combine propensity scales with machine learning methods to improve the performance. the bepipred  <cit>  method combined the parker hydorophilicity scale  <cit>  with a hidden markov model  and demonstrated a slight but statistically significant improvement in the classification performance compared to the performance of the propensity scale based methods. chen et al.  <cit>  developed an amino acid pair  antigenicity scale that assigns to each possible pair of amino acids, a propensity value. their support vector machine  classifiers trained using amino acid pair  propensity derived features outperformed svm classifiers trained using amino acid propensity derived features  <cit> .

recently, several researchers have explored various machine learning methods with learning examples for predicting linear b-cell epitopes using amino acid sequence information. the abcpred  <cit>  method use recurrent artificial neural networks for predicting linear b-cell epitopes. s√∂llner and mayer  <cit>  represent each peptide features derived from a variety of propensity scales, neighborhood matrices, and respective probability and likelihood values and attained an accuracy of 72%. the bcpred and fbcpred  <cit>  methods predict linear b-cell epitopes and flexible length linear b-cell epitopes  using svm classifiers that use string kernels. the cobepro  <cit>  method use a two-step procedure for predicting linear b-cell epitopes. in the first step, an svm classifier is used to assign scores to fragments of the query antigen. in the second step, a prediction score is associated with each residue in the query antigen based on the svm scores for the peptide fragments. many methods utilizing three-dimensional  structure to predict discontinuous epitopes are also available  <cit> . we refer readers to a recent review by el-manzalawy and honavar  <cit>  for a more detailed discussion.

there are several problems common to recently developed machine-learning methods. these methods have utilized only a limited amount of positive learning examples. some of these methods have utilized negative learning examples derived from random protein fragments. these negative training examples may harbor genuine b-cell epitopes and affect the training procedure and result in poor classification performance. moreover, none of the published work has systematically combined and compared the performance of various structural properties and evolutionary information in bringing about good classification performance. finally, most methods have utilized large peptide lengths  in their benchmarking experiments. predicting protein epitopes within the length range of 7- <dig> is important as peptide in this length range are easy to synthesize experimentally and well-chosen peptides could generate specific antibodies. the effect of peptide length on the classification performance has not been checked systematically. it is worth noting that these methods have failed to achieve accuracy > 75% and auc >  <dig> .

to overcome these limitations, we have generated a large non-redundant training set of b-cell epitopes with both the positive and the negative learning examples. this dataset was prepared by combining data from the immune epitope database  <cit> , the bcipep database  <cit>  and the antijen database  <cit>  that has information on small peptide epitope antigenicity and specificity in immune response. we have created and leveraged the computational capabilities of open life science gateway  to exhaustively predict structural properties for sequences containing epitopes. we have checked contributions of different protein structural properties including first and higher order composition, evolutionary conservation information, compositional and per residues probabilities for secondary structure, solvent accessibility, disorder, and low-complexity. we show that the utilization of negative examples and increasing the training set size contribute to the improved classification performance. however, the set of learning features have a definite impact on the learning process. we have also checked the effect of epitope length on the classification performance.

we introduce the b-cell epitope oracle , a svm classifier that integrates different types of information that was provided as learning features to the classifier and validate the classifier on multiple validation sets. a large test set, a list of  <dig> chromatin immunoprecipitation  grade antibodies and  <dig> hdac antibodies with known epitope sequences were utilized as validation sets. moreover, we checked whether beoracle scores for hdac peptides antibodies correlated with the intensity of fluorescence in immunofluorescence experiments on the drosophila melanogaster embryos. finally, a second svm classifier, b-cell region oracle  that utilizes the beoracle scores as learning features, was trained to predict specificity of antibodies produced after immunization with large protein domains. this is first such attempt in our knowledge. validation information for immunofluorescence , western blot , immunohistochemistry  and protein array  data from protein atlas database was used to assess performance of broracle.

RESULTS
we have carried out more than  <dig> svm classification experiments with a large learning set that provides both positive and negative learning examples for the training of the beoracle and the broracle classifiers . each classification experiment includes a 5-fold cross validation on the training set while varying the featuresets, the svm kernels and the peptide lengths. the learning features extracted from training examples provided to the classifier protein composition information in terms of the n-grams, evolutionary information encoded in the position specific scoring matrix , and the structural information like secondary structure, solvent accessibility, disorder, and low-complexity assignments predicted using the state-of-the-art bioinformatics algorithms. the beoracle and the broracle classification performances were validated on multiple validation sets. see methods for details on learning sets and feature extraction procedure.

combining sequence features improve classification performance
our experiments suggest that the n-gram features providing information on the protein composition with length  <dig> provides good classification performance and generalizes well . the classification performance calculated as the f1-measure decreases from  <dig> % to  <dig> % as n-gram number decreases from  <dig> to  <dig> . using position based encoding, normalizing the n-grams with background frequency of amino acids in uniprot database or using physico-chemical scales for svm learning did not provide good classification performance .

our results indicate that no structural feature alone provides satisfactory classification performance. on the other hand, combining appropriate features substantively improves the classification accuracy and the f1-measure . the combination of n-gram features, evolutionary information, secondary structure and solvent accessibility information resulted in the best classification performance . the best  <dig> classifiers in the 5-fold cross validation studies utilized the best feature set with polynomial kernels of degrees  <dig> and  <dig>  and the radial basis function kernel , respectively. adding other structural features such as disorder and low complexity information did not improve classification performance .

the best classifier achieved an accuracy of  <dig> % and the f1-measure of  <dig> % to the average accuracy of  <dig> % and the average f1-measure of  <dig> % when using only one type of features. the polynomial kernel of degree  <dig> has the highest area under the curve  of  <dig>  followed by the polynomial kernel of degree  <dig> with the auc of  <dig>  and the rbf kernel with the auc of  <dig>  . the bcpred  <cit>  and bepipred  <cit>  methods follow with auc =  <dig>  and auc =  <dig> , respectively. the identification of epitopes using various amino acid propensity scales is only marginally better than the random model as mentioned above. the classification performance of our svm classifier is a marked improvement on these and other published methods.

utilization of negative training examples improve the classification performance
to assess the contribution of negative learning examples on the svm classification performance; we trained our best svm classifier with a dataset prepared by el-manzalawy et al  <cit>  and the best feature set. the el-manzalawy dataset contains  <dig> non-redundant positive training examples from bcipep database  <cit>  and an equal number of negative learning examples randomly extracted from the sequences in the swissprot database. the svm classifier trained on the random negative examples achieved the auc of  <dig>   at the epitope length of  <dig> and the auc of  <dig>   at the epitope length of  <dig> . this is a small yet significant decrease in classification performance compared to the auc of  <dig>   and  <dig>   obtained when the classifier was trained with actual negative examples at these lengths .

the training of our svm classifier on this dataset has also allowed for a more direct comparison of the prediction performance of our classifier with the bcpred method . the bcpred classifier achieved the auc of  <dig>  and  <dig>  at lengths of  <dig> and  <dig> on the test set prepared by us, which is significantly less than the auc achieved by our classifier mentioned in the previous paragraph. thus, our classifier even when trained on el-manzalawy dataset clearly outperforms bcpred . this result also supports the conclusion that utilization of the best feature set improves the classification performance .

improvement in the classification performance is not solely dependent on the size of the training set
compared to other published methods we have created a large learning set that provides the svm classifier with both the positive and the negative learning examples. it is possible that this large learning set size is solely responsible for the improved classification performance. therefore, we utilized 10%  increments of our training set with epitope length  <dig> and the best feature set to study the performance improvement with increase in the learning set . the f1-measure decreases from  <dig> % to  <dig> % with the decrease in learning examples and the auc decreases from  <dig> % to  <dig> %. however, even when utilizing just 10% of learning examples, which is less than the training set size of bcpred or bepipred, the svm classifier trained on the best feature set outperforms these methods.

classification performance is dependent on the epitope length
the epitope length of  <dig> utilized in the classification experiments above is less than those utilized by other methods. moreover, epitope length could affect the epitope specificity and therefore the classification performance. surprisingly, effect of epitope length on the classification performance has not been studied systematically in previous works. therefore we checked the classification performance from length  <dig> to  <dig>  the range in which peptides can be synthesized relatively easily . we found that the f1-measure decreased from  <dig> % to  <dig> % and the auc decreased from  <dig>  to  <dig>  with the decrease in the epitope length. however, even when training with the epitope length of  <dig>  which is less than the epitope length utilized by bcpred and bepipred during the training, our svm classifier outperformed those methods. therefore, we believe that the learning features in the best set indeed play a big role in the improved classification performance.

identification of the b-cell epitopes from large protein sequences
we developed a scanning procedure to identify the b-cell epitopes from large protein sequences with high confidence. the scanning procedure that we developed takes a desired peptide length, a step length and utilizes features extracted for this peptide to give it a svm score. the scanning procedure obtained the f1-measure of  <dig> % and the auc of  <dig>  with the peptide length  <dig>  the step length of  <dig> and the best feature set. we term this predictor b-cell epitope oracle .

validation of the beoracle classification performance
for validating the beoracle performance in identifying epitopes that could result in chip-grade antibodies, a list of  <dig> antibodies with known peptide epitopes was compiled from the encode  <cit>  and the modencode  <cit>  project wiki pages. these antibodies have been used for identifying genome-wide binding profiles of transcription factors and dna associated proteins by microarrays or next generation sequencing. we compared the beoracle performance with the bcpred and the bepipred methods at specificity of 80%. the scanning procedure provided positive scores indicating good epitopes for  <dig> out of the  <dig> peptides and achieved an accuracy of  <dig> %. the remaining  <dig> got the score of zero and none got the negative score that indicated poor epitopes. the bcpred algorithm provides positive scores for  <dig> out of  <dig>  while the bepipred model provides positive scores for  <dig> out of  <dig> epitopes .

another validation set of  <dig> hdac antibodies with known epitope sequences was also used to validate beoracle performance. the peptides for all hdac antibodies obtained positive beoracle scores during the scanning procedure, thus resulting in 100% accuracy. we carried out immunofluorescence experiments for these antibodies on the drosophila melanogaster embryos and annotated fluorescence intensity into four groups very good, good, low intensity and not good if . we sorted beoracle scores from high to low and compared the correlation between the beoracle score and the fluorescence intensity in a blind testing set up. there are three antibodies with "very good" fluorescence in the top  <dig> versus only one in the bottom  <dig>  moreover, only  <dig> antibody in the top  <dig> has "low intensity" and no antibody has "not good intensity". therefore, there is some evidence of correlation of fluorescence intensity with the beoracle score. although, a larger testing set is required to substantiate this claim . based on the beoracle performance on these two independent validation sets, we can conclude that the classifier identifies b-cell epitopes from the linear protein sequences that can create antibodies with high specificity.

local information allows for the prediction of specificity in immune response for large protein regions
distributional analysis of scan scores for  <dig> positive and  <dig> negative training examples extended to the length  <dig> showed that the positive learning examples have higher frequency of positive beoracle scores than the negative learning examples . therefore, these extended regions containing positive and negative b-cell epitopes could be utilized to train a classifier for predicting the specificity in immune response for large protein regions or domains. however, it should be noted that the negative learning set here might contain some genuine b-cell epitopes. a second set of classifiers with different svm kernels were trained using the beoracle svm scanning scores as learning features. the svm classifier with the radial basis function kernel achieved an f1-measure of  <dig> % in 5-fold cross-validation. we term this classifier the b-cell region oracle . the broracle classifier achieved an f1-measure of  <dig> % and the roc area of  <dig>  on the validation set . the broracle classifier has been trained such that it can handle protein regions of any length. please see additional file  <dig> for the description of the training algorithm.

validation of the broracle classification performance
the classification performance of the broracle was further validated on  <dig> human protein regions of varying lengths extracted from the human protein atlas database  <cit> . immune response specificity information in terms of if, wb, ihc and pa experiment results is available for these regions. the broracle classifier achieved the highest accuracy of  <dig> % for the if and the lowest accuracy of  <dig> % for the wb experiments . therefore we can conclude that local information on antigenicity and specificity, available as beoracle scores, can predict specificity in immune response for large protein regions. we can also conclude that specificity in immune response on large regions can be predicted without identifying discontinuous/conformational epitopes that may be present in these regions.

discussion
svms are widely used classifiers while performing machine learning in settings with high-dimensional feature space. they have been shown to outperform other classification methods in different learning tasks. svms have been used in many published studies for the b-cell epitope identification  <cit> . the beoracle classifier described in this work is also an svm classifier and provides significant improvement in the b-cell epitope prediction task, as attested on a large test set and multiple biological validation sets.

it is possible that other classification algorithms trained on the feature sets described in this work may outperform the beoracle classifier. instead of looking for the best classification algorithm, we have exhaustively surveyed the structural properties of proteins at the global and the residual level and identified the best sets of properties that provide improved classification performance. the novelty of this work lies in the systematic feature extraction and integration that provides information on determinants of antigenicity in protein sequences that could result on highly specific antibodies. we will compare the classification performance of different classification methods with feature sets described here in future. the beoracle classifier requires the structural and evolutionary information from other software like blastp, psipred, and accpro <dig> as input. these steps are computationally intensive when performed on large data sets or on a whole proteome scale. the olsgw scientific gateway on the teragrid provided the required computing power for this analysis.

our experiments suggested that the determinants of antigenicity are largely compositional rather than positional as n-grams, secondary structure, solvent accessibility and evolutionary information were presented to the classifier largely as compositional features extracted from positive and negative learning examples. other encodings and feature sets do not work as well. the beoracle classifier utilizing features from only these properties provided an impressive f1-measure of  <dig> % on a large test set. the classification performance improves with the increase in the peptide length as it provides more accurate estimation of epitope composition and its neighborhood. the amino acid neighborhood and evolutionary information is routinely utilized for accurate prediction of secondary structure, solvent accessibility and other structural properties. the psipred method utilizes the pssm matrices generated by the psi-blast and the accpro utilizes both the secondary structure predicted by the psipred and the pssm matrices generated by the psi-blast. even then features derived from these three contributed distinctly in improving the prediction performance. we saw a marked increase in the classification performance when 20-state solvent accessibility was used in the training instead of the 2-state solvent accessibility. therefore, more granular secondary structural information may also improve the classification performance.

for any classifier, it is understandable to have some loss of prediction power due to composition of learning sets and a theoretical limit in prediction performance. for example it is estimated that secondary structure prediction possibly has an upper limit of 90%  <cit> . during the training of the beoracle classifier the best set of learning features are selected from an exhaustive list of possible features that can be predicted. however, the learning examples were compiled from different databases with entries varying in quality and epitopes identified using different experimental methods. moreover, the various bioinformatics methods used to predict features have their own error rates. therefore, f1-measure of  <dig> % and the auc of  <dig>  of the beoracle classifier are indeed impressive and perhaps suggestive of the fact that our work has identified determinants of antigenicity and specificity in immune response.

this assertion is further corroborated by the identification of peptides epitopes for  <dig> chip-grade antibodies, and  <dig> hdac antibodies with > 96% accuracy by the beoracle classifier and by the performance of the broracle classifier that successfully predict highly antigenic regions from protein sequences. the broracle classifier only utilizes only beoracle scores as features. it doesn't utilize any three-dimensional structure information and is unaware of any conformational epitopes that may be present in those large regions. yet, the broracle classifier can successfully identify those regions on a validation set with four different assay types for human proteins extracted from the protein atlas database. therefore, we believe that composition, secondary structure, solvent accessibility and evolutionary information are indeed the determinants of antigenicity and specificity in immune response as they can be used to predict antigenicity and specificity in immune response for small epitopes and for large regions.

further improvements in the b-cell epitope prediction task can be achieved by utilizing other features. for example, knowledge of the 3-dimensional structures  of proteins will provide accurate information on secondary structure and solvent accessibilities. additional structural features like h-bonding and residue packing can be derived only from the 3d structures. functional information like post-translational modification , protein-protein and peptide-protein interaction interfaces and gene ontology categories can be utilized as features. other information on reactivity, presence of homologous sequences in the genome of antibody source/host species can also be utilized as features. utilizing these features for predicting specificity in immune response could lead to improved performance for both continuous and perhaps discontinuous b-cell epitopes.

CONCLUSIONS
our results indicate that the features derived from epitope composition, secondary structure, solvent accessibility and evolutionary conservation can be used to identify linear b-cell epitopes with a very high accuracy. they also indicate that the determinants of antigenicity and specificity in immune response are largely compositional rather than positional since the learning examples for the best classifier were encoded as compositional features. the beoracle classifier achieved an f1-measure of  <dig> % and > 96% accuracy in identifying peptides for chip-grade antibodies for encode and modencode projects.

the broracle classifier predicts specificity in immune response for large protein regions. this task has not been addressed before. the broracle classifier utilizes beoracle scores as features and therefore predicts using the information from local features only. the broracle classifier achieved accuracies of  <dig> - <dig> % on a validation set with immunofluorescence, immunohistochemistry, protein arrays and western blot results obtained from the protein atlas database.

together these results suggest that immunogenicity is a local property of the protein sequences and immune response obtained from the large protein regions could be accurately predicted using local information. the knowledge about protein tertiary structure or presence of discontinuous epitopes is not required for predicting immune response obtained from large protein regions. the dataset prepared in this work and the classifier models are available for download at https://sites.google.com/site/oracleclassifiers/.

