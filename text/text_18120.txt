BACKGROUND
a common method for annotating a protein is homology-based transfer of function by means of sequence comparison. possible matches are organized in databases like interpro  <cit>  or pfam  <cit>  and the usage of such databases simplifies the assignment of protein function due to the comprehensive characterization of their entries. interpro comprises signatures from more than ten repositories. pfam entries subsume sequences and functions of individual protein domains which are accessed by their pfam-id.

however, the level of misannotation in some databases can exceed 80%, if sequence similarity is the only measure to assign function  <cit> . reliability increases with the integration of orthogonal methods like genome neighborhoods . in prokaryotic genomes, genes are organized in operons and commonly, the corresponding gene-products have related functions like the enzymes that catalyze subsequent steps of a metabolic pathway. thus, gn algorithms utilize the fact that short distances between genes allow for the prediction of a functional coupling of their products, if the gn is conserved across many phylogenetically diverse species  <cit> . such gns are particularly useful to characterize elements of large enzyme superfamilies. more than a third of them are functionally diverse, i. e., homologous members catalyze reactions with different ec numbers  <cit> . if these homologs are part of different operons, the gns of isofunctional enzymes must be similar and a gn comparison must discriminate functionally different enzymes.

to identify putatively isofunctional enzymes, one can compare their sequences pairwise and cluster them, if sequence similarity exceeds a superfamily-specific threshold th. however, depending on the th value, clusters may break or regroup. thus, sequence similarity networks  that represent sequences as nodes and their pairwise similarity as weighted edges are a more flexible concept to model subtle sequence relationships that may interlink sequence clusters  <cit> . it follows that the set of gns deduced for all nodes of an ssn also form networks, commonly named genome neighborhood networks .

in order to facilitate the prediction of specific enzyme functions, the enzyme function initiative  is developing and disseminating high throughput in silico methods and offers services that compute for a given set of protein sequences ssns and gnns. in this context, the gn of a given gene product is represented by a set of pfam-ids, listing all protein domains found in the adjacent ±nb neighbors, where nb is chosen by the user. to date, these are the only gnns deduced from a large number of genomes. we have implemented agennt that automatically generates refined neighborhood networks. agennt utilizes the efi services but processes in- and output in order to create function-oriented, intuitive and easy to interpret gnns.

methods
computing the thresholds a-th and s-th
the two alternative thresholds a-th and s-th computed by agennt are based on the analysis of two values that result if a chosen threshold  is used to eliminate edges of an ssn: according to terminology introduced earlier  <cit> , nn is the resulting number of nodes interconnected by edges and se is the resulting number of edges. both network parameters can be combined to a ratio value nsv:  <dig> nsvth=sethnnth 


applying a low th-value induces the predominant elimination of edges that connect nodes belonging to different protein families, because their pairwise sequence similarity is low. consequently, the increase of th decreases se but not nn, as these nodes are still connected to other members of the same family. thus, the ratio nsv becomes smaller until the specific th value is reached that also induces the elimination of edges within sequence clusters. for this th value and larger ones, isolated nodes will arise that increase nsv. by step-wise incrementing th
t to th
t+ <dig>  agennt determines the lowest threshold inducing the raise of nsv; this is the a-th value computed according to  <cit> .

we suggest an alternative, smoothed threshold named s-th that is based on the relative changes relnn and relse:  <dig> relnnth=nnthnnthmin,relseth=sethsethmin 


here, th
min is the smallest pairwise similarity score occurring within the considered ssn. we define s-th as the lowest value th
t for which the gain of isolated nodes is higher than the loss of eliminated edges:  <dig> s‐th=argminthtrelnntht−relnntht+1>relsetht−relsetht+ <dig> 


computing a measure for the uniqueness of pfam-nodes and cluster-nodes
inspired by the work of a. kalinka  <cit> , we utilized the hypergeometric distribution in order to assess the uniqueness of network elements. a gnn is a graph consisting of cluster-node c
j , pfam-nodes p
l, and edges e
il =  interconnecting a sequence-node and a pfam-node.

for a given gnn, let n = |{s
i}| be the total number of sequence-nodes. let m
l = |{e
il}| be the number of sequence-nodes interconnected to a specific p
l and let k
lj = |{s
i ∈ c
j| ∃ e
il}| be the number of sequence-nodes s
i belonging to c
j and connected to a certain p
l. using the hypergeometric distribution, one can compute the probability that k
lj out of the n sequence-nodes have p
l in their gn:  <dig> pplcjx=klj=mlkljn−mln−kljnn 


as a measure of the “uniqueness” of an edge , agennt lists the following value:  <dig> uniqueplcj=−log10pplcjklj 


as an approximation, we assume independence of the occurrence of the different pfam-nodes p
l that belong to the gn of cluster-node c
j. thus, we determine the uniqueness of a gn for a certain cluster c
j according to:  <dig> uniquecj=∑pl∈pfamcj−log10pplcjklj 


here, pfam is the set of pfam-nodes interconnected to sequence-nodes belonging to c
j. a high uniqueness value of a cluster-node arises, if its gn consists of many, exclusively linked pfam-nodes. analogously, agennt computes the uniqueness of pfam-nodes:  <dig> uniquepl=∑cj∈clusterpl−log10pplcjklj 


here, cluster is the set of cluster-nodes interconnected to the pfam-node p
l.

eliminating subspecies
in ssns deduced from interpro families, sequences are annotated with a unique number  indicating their phylogenetic origin. thus, for these well characterized datasets, agennt can correct for strongly overrepresented species. to do so, agennt utilizes a list  generated by the ncbi that indicates for each taxid whether it belongs to a species or a subspecies. at wish, agennt eliminates all sequences originating from the genomes of subspecies prior to the computation and analysis of an rgnn.

user-defined whitelist
the user can specify a whitelist consisting of a text file containing one pfam-id per line. pfams that are not part of this whitelist will be skipped during the process of generating a filtered gnn. the built-in whitelist consists of  <dig> pfams-ids whose description contains a reference to an enzymatic function like an ec number or the terms “enzyme” or “catalytic”.

listing the phylogenetic origin of sequences
based on taxids, agennt determines for each cluster-node the normalized frequencies with which the different phyla contribute sequences. these numbers are listed as phylumstat values.

download and installation of agennt
agennt is a standalone java application that can be used on many computer platforms. however, for the analysis of large networks , we recommend a powerful cpu and at least 32 gb main memory. after download, agennt can be started without any additional configuration by executing a command script. see the readme file to be found after installation in the ..\agennt directory. for the generation of neighborhood networks and their visualization, the program cytoscape is needed. it can be downloaded from http://www.cytoscape.org/. during the first call of cytoscape within agennt, the user has to specify the location of the cytoscape executable. afterwards, agennt starts cytoscape without further assistance.

RESULTS
function of agennt
agennt requires an ssn computed by the efi-est service  as input. the computation of an ssn is detailed in  <cit>  and demonstrated in additional file  <dig>  efi-est provides a set of output files containing networks of different granularity. if the network has less than 10 m edges, a full network is provided. additionally, representative node  networks are offered. in a rep-node k network, sequences that share at least k% identical resides are collected in the same sequence node. thus, the number of nodes and edges as well as phylogenetic bias can be reduced by analyzing a rep-node  <dig> or a rep-node  <dig> network.

due to their comprehensive annotation, we recommend the usage of ssns deduced from interpro families and the blast e-value cut-off 1e- <dig> in order to create most comprehensive networks. the results shown below are based on interpro version  <dig> or  <dig>  the outcome of the subsequently applied network clustering algorithm depends on the threshold th applied to the edge weight distribution of the ssn. agennt utilizes a previously proposed heuristic  <cit>  and an in-house method to compute two alternatives, named a-th and s-th. after the user has selected a threshold, agennt eliminates from the initial ssn all edges not reaching th and initiates the computation of a gnn. to start this efi service, the user has to specify the size of the genome neighborhood , the co-occurrence lower limit  and an email address. the co-occurrence lower limit is the fraction of sequences from the given sequence cluster that possess a gene-product encoding the functionality of a pfam-node p
l within their nb neighborhood.

after the completion of the efi service, agennt downloads the gnn to the user’s computer and offers the visualization of the efi gnn, a colored ssn, and the refined gnn  by means of cytoscape  <cit> . a gnn interlinks cluster-nodes  and pfam-nodes . each gn consists of those pfam-nodes p
l that reach the specified co-occurrence lower limit. similar to the sequence-centered version of the efi gnns, the “hubs” of the network are the cluster-nodes that are linked to “spokes” that are the pfam-nodes. due to this representation, it is easy to determine and to compare the gns of different sequence clusters; compare fig. 1a. in comparison with efi-gnns, rgnns benefit from the following features that decisively support the annotation of enzymes:agennt assists the user in specifying the threshold th required to filter the initial ssn prior to gnn generation; see formula .

to reduce graph complexity, agennt optionally eliminates gene neighbors without enzymatic function based on an editable “whitelist” containing pfam-ids, which represent enzymatic functions.

each pfam-node is additionally annotated with go terms that specify the molecular function and the metabolic process in which the enzyme is involved.

on demand, agennt reduces phylogenetic bias. then, each species can only contribute one sequence to each cluster node and the sequences from related subspecies are eliminated. to further characterize the phylogenetic distribution of the enzymes, agennt determines the normalized frequencies of all phyla contributing to each cluster-node.

the size of the nodes corresponds to the number of clustered sequences . thus, dominant as well as more special gns can be discriminated easily.

for each edge, interconnecting a cluster node and a pfam node, the coverage is given, which is the relative number of genomes supporting this link of a cluster-node and an enzyme function  encoded in the considered neighborhood.

in order to assist the user in comparing gns, agennt computes statistics to assess the “uniqueness” of edges, pfams, and gns; see formulae  to .


fig.  <dig> excerpts of two rgnns of ipr <dig> . a using cytoscape, all nodes with less than  <dig> sequences were deleted from the rgnn and the position of nodes was interactively altered for ease of interpretation. “hubs”  represent sequence clusters from the corresponding ssn and “spokes”  protein functions found within the respective gn. the diameter of the elements corresponds to the number of sequences. clusters  <dig> and  <dig> possess distinct gns that differ from the gn of clusters  <dig> and  <dig>  due to the parameters selected for ssn generation, these isofunctional sequences constitute two sequence clusters. cluster  <dig> comprises sequences from different bacterial phyla; sequences of cluster  <dig> are mainly from bacteroidetes. b this rgnn was created in the same manner as the one shown in . however, subspecies filtering was not applied. this is why this rgnn contains cluster  <dig>  which is a highly specific gn of few proteobacterial species. cluster  <dig> corresponds to cluster  <dig> shown in 




the usage of agennt is detailed in additional file  <dig>  in the following, we motivate the computation of a novel threshold, show typical results and a novel application of rgnns, and illustrate the predictive power of rgnns by analyzing some retrospective test cases. the processed rgnns of all test cases can be downloaded from our github repository; see release tab.

s-th, a more adequate threshold for the analysis of dense ssns
the aim of ssn generation is to distribute sequence-nodes among cluster-nodes that represent each a certain protein function, i. e. an isofunctional protein family. in order to make possible the clustering by means of graph analysis techniques, the edges interconnecting the sequence-nodes of an efi ssn are labeled with scores indicating the pairwise similarity determined by blast  <cit> . it turned out that the performance of network clustering algorithms depends on thresholding the edges prior to clustering  <cit>  and for each network a proper threshold th has to be found. if chosen correctly, th separates inter-family edges from intra-family edges  <cit> . for the assessment of their threshold , the authors had analyzed four sequence sets consisting at most of  <dig> sequences, each representing the full diversity of a protein family  <cit> . due to the low pairwise similarity of many sequences, the corresponding ssns were sparse networks, which is no longer the case for current datasets. nowadays, most datasets representing protein families contain large numbers of sequences, which are often highly similar to each other. thus, the resulting ssns are dense networks, as the number of edges is usually at least ten fold higher than the number of nodes. to illustrate this circumstance, table  <dig> lists characteristic values of the five interpro families analyzed below. as a consequence, the a-th value is often chosen too high for a representative analysis. therefore, we suggest an alternative, smoothed threshold named s-th ), which eliminates more edges; see table  <dig> table  <dig> characteristics of interpro families and resulting ssns

a-th
s-th
a-th
s-th
the first column gives the name of the interpro family and the second one the number of sequences belonging to this dataset. the four columns entitled rep-node  <dig> and rep-node  <dig>  respectively, list the number of nodes and edges of the corresponding ssn and the thresholds a-th and s-th. for the generation of the dataset, the blast e-value cut-off 1e- <dig> was used




an rgnn of the glycosyl transferase family
ipr <dig> is named glycosyl transferase family  <dig> and subsumes all enzymes that transfer a phosphorylated ribose substrate. the family includes anthranilate phosphoribosyltransferases  and thymidine phosphorylases . to create fig. 1a, we chose the proposed s-th value of  <dig>  eliminated subspecies and created an rgnn by collecting ± <dig> neighbors at a co-occurrence value of 20%. for visualization, we used cytoscape and eliminated all nodes representing <  <dig> sequences. for all representations of rgnns shown below, cytoscape’s organic layout was applied initially and the position of nodes was rearranged interactively for ease of interpretation.

the comparison of the neighborhoods makes clear that the homologs constituting ipr <dig> possess at least three different enzymatic functions: the gn of clusters  <dig>  and  <dig>  comprises pf <dig>  pf <dig>  pf <dig>  pf <dig>  pf <dig>  pf <dig>  and pf <dig>  which represent gene products of the canonical tryptophan operon surrounding trpd. for the edges interconnecting cluster-node  <dig> and pfam-nodes, all coverage values are >  <dig> , for cluster  <dig> the values are in the range between  <dig>  and  <dig> . these numbers indicate a lower gn conservation for the physiologically diverse trpd sequences which are mainly from proteobacteria and firmicutes clustered in node  <dig>  in contrast to the gns of the physiologically more related trpd sequences of cluster  <dig>  which are mainly from bacteroidetes. the gn of cluster  <dig>  represents a typical gn of nucleoside phosphorylases . the  <dig> sequences of cluster  <dig> are annotated as glycosyl transferases. however, the gn contains two domains of a dna unwinding helicase  suggesting dna interaction for these  <dig> sequences. indeed, one representative, ybib, has recently been characterized as a dna-binding protein  <cit> . altogether, this retrospective test case demonstrates the predictive power of gnns, because the gns are indicative of putative functions for all three clusters of homologs.

the number of pfam-nodes belonging to these gns is relatively small, because the elimination of sequences from subspecies removed any species-specific conservation of gene arrangements. figure 1b is part of an rgnn created with the same parameters albeit lacking subspecies elimination. this rgnn contains the cluster-node  <dig> representing  <dig> sequences mostly from proteobacteria. the corresponding ssn makes clear that these sequences are combined in not more than  <dig> sequence nodes and the three most populated ones represent  <dig>   <dig>  and  <dig> sequences originating predominantly from subspecies. due to their close phylogenetic relationship, their genome neighborhood is highly conserved. this is why the gn of cluster  <dig> contains  <dig> additional pfam nodes that occur as neighbors in the genomes of few proteobacteria. the uniqueness value of cluster-node  <dig> is  <dig>  which also indicates a highly specific combination of enzyme functions.

this example illustrates that the elimination of phylogenetic bias helps to avoid gns whose content is overly specific due to a close phylogenetic relationship. such gns can be misleading, if the ± <dig> neighborhoods contain enzymes from different operons which commonly show no strong functional coupling. on the other hand, the gn of cluster  <dig> indicates the robustness of rgnn topology: as expected, this dominating gn represents the tryptophan operon. it consists of pf <dig> , pf <dig> , pf <dig> , pf <dig> , pf <dig> , pf <dig> , and pf <dig> . this set is identical to the gns of clusters  <dig> and  <dig> of fig. 1a. the numbering of the clusters is different, because the subspecies filter alters the composition of the sequence sets. figure 1a is lacking a gn corresponding to cluster  <dig> of fig. 1b, because after subspecies elimination, the respective sequence nodes contained less than  <dig> sequences each and were eliminated.

in order to further demonstrate the robustness of rgnns, especially with respect to the parameters chosen for their generation, we created  <dig> rgnns based on the rep-node  <dig>  rep-node  <dig>  and rep-node  <dig> files of ipr <dig> and varied in a systematic manner the neighborhood  and the co-occurrence  values. the corresponding figures s1–s <dig> can be found in additional file  <dig>  to allow for a straightforward comparison of the networks, the same color code was used for all plots and all graphs were oriented the same way. a comparison of the networks makes clear that – as expected – the complexity is highest for the rep-node  <dig> network analyzed with a ± <dig> neighborhood and a 10% co-occurrence. for each rep-node k dataset, the complexity of gns decreases for a smaller neighborhood and a higher co-occurrence value. moreover, complexity goes down with the decrease of the k value. however, as can be seen, characteristic pfam-nodes like , , and , which are important for functional assignment of cluster-nodes representing trpd, deoa, or ybib–like enzymes are present in all networks.

in summary, this systematic analysis of one interpro family testifies to the robustness of the ssn/rgnn approach, because the assignment of three specific enzyme functions is possible for a broad range of parameter combinations.

the gnn of a monofunctional enzyme has a simple topology

hisf is encoded in the histidine operon of bacteria and its gene product catalyzes a cyclization reaction during the sixth step of histidine biosynthesis. for bacterial hisf, no further function has been described. in order to illustrate how adjacent operons affect the composition of gns, we computed an ssn for the interpro family ipr <dig> with a blast e-value of 1e- <dig> by means of the efi-est service. we applied the threshold s-th, which was  <dig>  and eliminated subspecies. an rgnn was created by collecting ± <dig> neighbors at a co-occurrence value of 20%. the number of sequences belonging to different nodes varied from  <dig> to  <dig>  to eliminate low populated nodes, all nodes with a seqcount value ≤  <dig> were eliminated. figure  <dig> shows the resulting rgnn; interestingly, it contains not more than six cluster-nodes.fig.  <dig> rgnn of ipr <dig> . the biosynthesis of histidine requires reactions catalyzed by eight enzymes. hisf catalyzes the cyclization reaction needed for the sixth step. this rgnn was created by applying the s-th threshold of  <dig>  subspecies were eliminated, and ± <dig> neighbors at a co-occurrence value of 20% were collected. all nodes with a seqcount value ≤  <dig> were deleted




cluster node  <dig>  represents  <dig> sequences from different phyla. the corresponding gn consists of pf <dig> , pf <dig> , pf <dig> , pf <dig>  and pf <dig> . these enzymes constitute the core of the canonical histidine operon and the two smaller clusters  <dig>  and  <dig>  possess in their specific gns these pfam-nodes as well. clusters  <dig> and  <dig> share in their gns pf <dig>  and pf <dig> , which are also involved in histidine biosynthesis, but are seemingly less conserved in bacterial operons. two pfam-nodes specific for cluster  <dig>  namely pf <dig> and pf <dig>  are domains of the atp phosphoribosyltransferase, which is also related to histidine biosynthesis. most likely, the remaining two enzymes pf <dig>  and pf <dig>  are not involved in histidine biosynthesis but are co-located.

interestingly, five of the seven enzyme functions specific for cluster  <dig> are related to tryptophan biosynthesis. these are pf <dig> , pf <dig> , pf <dig> , pf <dig> , and pf <dig> . inspecting the hisf neighborhood by using the genome browser of the biocyc server  <cit>  shows that the histidine and tryptophan operons of mycobacteria and other actinobacteria are directly adjacent in their genomes. this is why the gn of cluster  <dig> contains functions from two operons. cluster  <dig>  represents  <dig> sequences dominantly from euryarchaeota, cluster  <dig>  contains  <dig> sequences from spirochaetes, and cluster  <dig>   <dig> sequences mainly from proteobacteria. without deeper analysis, these marginally populated gns are difficult to interpret. in contrast, the composition of the three dominating gns shows that the rgnn of a mono-functional enzyme has a relatively simple topology.

correlating enzymatic function of hisa and pria and the localization of their genes
for two actinobacterial species, namely streptomyces coelicolor and mycobacterium tuberculosis, the existence of an enzyme named pria has been reported  <cit> . with respect to sequence and structure, pria is highly similar to hisa, which catalyzes the isomerization of an aminoaldose in histidine biosynthesis. interestingly, actinobacteria lack a trpf gene and it turned out that pria is a bi-functional homolog of hisa, which adopts the roles of hisa in histidine and of trpf in tryptophan biosynthesis. the evolution of pria is unclear; it has been suggested that its bi-functionality is an evolutionary response to the loss of the trpf gene and that a narrowing down of the pria specificity in certain actinobacteria occurred after the horizontal gene transfer of a whole trp operon  <cit> . an ssn of the hisa/pria superfamily  made clear that hisa genes are present in all major phylogenetic groups and that the occurrence of annotated pria genes is indeed restricted to the actinobacteria. moreover, by characterizing ancestral hisa enzymes, it was made plausible that hisa has been a bi-functional enzyme for at least  <dig> billion years, most likely without any evolutionary pressure  <cit> . the latter results are strong evidence for the assumption that pria is a typical hisa successor due to the bi-functionality of the ancestral hisa enzymes.

if one can show that the gn of bi-functional pria enzymes is highly similar to the gn of typical hisa enzymes, one can further confirm that pria is more a typical than an exceptional hisa homolog. figure  <dig> shows the rgnn determined for ipr <dig>  using the efi-ssn service and an e-value of 1e- <dig> as blast cut-off, an ssn was created. the s-th value of  <dig> and elimination of subspecies was chosen prior to the generation of the rgnn. for highest sensitivity, a ± <dig> neighborhood was analyzed; however, in order to eliminate enzymes belonging to the adjacent tryptophan operon , a co-occurrence of 25% was used to compute the rgnn. using cytoscape, all cluster-nodes representing ≤  <dig> sequences were deleted. besides few outliers, all hisa homologs from actinobacteria belong to sequence-cluster  <dig> that represents  <dig> sequences. cluster-nodes  <dig>  and  <dig>  comprise sequences from different bacterial phyla. the gns of these three clusters overlap to a great extent and consist of enzymes involved in histidine biosynthesis. most importantly, the gn of the actinobacterial hisa homologs does not contain enzyme functions not found in the other gns of bacterial hisa enzymes. this finding makes clear that with respect to functional coupling, the actinobacterial pria enzymes do not differ from other hisa homologs.fig.  <dig> rgnn of ipr <dig> . pria is a bifunctional enzyme that adopts the roles of both hisa in histidine and of trpf in tryptophan biosynthesis. cluster-node  <dig> contains the actinobacterial hisa homologs  and cluster-nodes  <dig> and  <dig> homologs from different bacteria. the gns of all three cluster-nodes overlap to a great extent and consist of enzymes involved in histidine biosynthesis. the pfams belonging to the overlap of gns are arranged in a line




the function of chorismate-utilizing enzymes can be deduced from their specific gns
the sequences of the c-terminal domain of chorismate-utilizing enzymes constitute ipr <dig>  among these enzymes are anthranilate synthases , aminodeoxychorismate synthases , isochorismate synthases , and salicylate synthases . as and adcs catalyze mechanistically related reactions using ammonia as a nucleophile in tryptophan and folate biosynthesis, respectively. although ics and ss are highly similar to as and adcs with respect to sequence and structure, they utilize water instead of ammonia as a nucleophile and are part of secondary metabolic biosynthetic pathways leading to iron-chelating siderophores  and electron-transport compounds .

it has recently been shown that only two amino acid substitutions in as are sufficient to generate a bi-functional enzyme that forms isochorismate as efficiently as does a native ics while retaining as activity  <cit> . thus, the comparison of sequences in this enzyme family may be misleading and the determination of function from sequence homology may be erroneous. however, as these enzymes are part of different metabolic pathways, their gns should be indicative of their predominant function.

the rgnn of this enzyme family  was computed using the efi-ssn service and an e-value of 1e- <dig> as blast cut-off. the s-th value of  <dig> and elimination of subspecies was selected prior to the generation of the rgnn with a ± <dig> neighborhood and a co-occurrence of 20%. using cytoscape, all cluster-nodes representing ≤  <dig> sequences were eliminated and the organic layout was utilized for visualization.fig.  <dig> rgnn of ipr <dig> . the family of chorismate-utilizing enzymes comprises several homologous but functionally diverse enzymes from different primary and secondary metabolic pathways. the enzyme as from tryptophan biosynthesis is represented by cluster-nodes  <dig> and  <dig>  whose gn represents the typical tryptophan operon. the gn of adcs from folate biosynthesis  is less conserved and consists of one pfam-node, representing the enzyme catalyzing the subsequent step of folate biosynthesis. the homologous ics and ss enzymes are part of different biosynthesis pathways that lead to iron-chelating siderophores as well as electron transport compounds. the rgnn greatly assists in separating these enzymes into different isofunctional groups: the gns make clear that cluster-nodes  <dig>   <dig>  and  <dig> represent menf-type ics, cluster-node  <dig> represents entc-type ics, and cluster-node  <dig> represents ss enzymes




dominating is cluster-node  <dig>  which represents  <dig> as and adcs sequences from several major bacterial and archaeal phyla. its gn consists of only one pfam-node, pf <dig>  that subsumes the glutaminases trpg and paba, which are part of the heterodimeric as and adcs complexes and deliver the ammonia required for the as and adcs reactions. most likely, the occurrence of as and adcs enzymes in many, phylogenetically less related species and the variability of the genome neighborhood is the reason that this gn consists of not more than the glutaminase subunits. pf <dig> also belongs to the gn of cluster-node  <dig> which additionally contains  <dig> other pfam-nodes. the respective sequences are almost exclusively of proteobacterial origin and this close relationship is the reason that this gn contains other enzymes of the trp operon, namely pf <dig> , pf <dig> , and pf <dig> . the gns of other adcs also seems to be highly diverse, the main adcs cluster, cluster-node  <dig>  only contains pf <dig>  which represents pabc, the enzyme that catalyzes the subsequent step in folate biosynthesis.

cluster-node  <dig> is special due to a unique gn consisting of  <dig> pfams. the sequences comprising this cluster are almost exclusively from acinetobacter and psychrobacter species and are annotated as either as or adcs. however, the gn does not contain a single enzyme typical for tryptophan or folate operons but instead contains several dna- or atp-binding proteins, hydrolases, and a histidinol dehydrogenase. presumably, the sequences of cluster-node  <dig> represent homologous copies of as or adcs that are part of a different functional context in acinetobacter and psychrobacter and they may be interesting candidates for elucidating enzymatic function.

as mentioned above, ipr <dig> also contains ics and ss. these two enzymes are highly similar in sequence and structure and their respective reactions differ only in the different processing of their common product. thus, false annotations are very common for ics and ss. moreover, several isozymes of ics are known that catalyze the same reaction in different metabolic contexts. for example, the ics entc is part of the biosynthesis of the siderophore enterobactin, whereas the ics menf is part of the biosynthesis of menaquinone. the rgnn can help to reliably assign the ics sequence of this enzyme family to the different isotypes. for example, the cluster-nodes  <dig>   <dig>  and  <dig> represent ics sequences from proteobacteria, firmicutes, and bacteroidetes, respectively, and share five pfams in their gns . however, the gn of cluster-node  <dig> exclusively contains pf <dig>  which represents the ubia prenyltransferase family. one homolog of this family, mena, is part of the biosynthesis of menaquinone  <cit> . along the same lines, the gn of cluster-node  <dig> exclusively contains pf <dig>  which represents a family of nadh-ubiquinone oxidoreductases, some of which also accept menaquinone as an electron acceptor  <cit> .

cluster-node  <dig> represents the other isotype of ics, entc. its gn contains pf <dig>  and pf <dig> , which are part of the non-ribosomal peptide-synthetases that catalyze the formation of enterobactin-type siderophores  <cit> . moreover, this gn contains pf <dig> , the enzyme that catalyzes the step following the entc reaction in the biosynthesis of enterobactin. cluster-nodes  <dig> and  <dig> have in common four pfams in their respective gns . however, the gn of cluster-node  <dig> does not contain pf <dig> , which supports the annotation of these sequences as ss. in contrast to ics, these enzymes directly convert chorismate to salicylate and not via an additional step  to  <dig> -dihydro- <dig> -dihydroxybenzoate.

in summary, the analysis of the interpro family of chorismate-utilizing enzymes illustrates how gns in combination with the functionality of agennt can help to reliably dissect large families of homologous enzymes with diverse functions and different metabolic contexts.

rgnn analysis immediately reveals at least three different functions of ptps enzymes
the interpro entry ipr <dig> is named “6-pyruvoyl tetrahydropterin synthase/qued family protein” and contains  <dig>  sequences that possess  <dig> different domain architectures  <cit> . 6-pyruvoyl tetrahydropterin synthase  catalyzes the conversion of dihydroneopterin triphosphate to 6-pyruvoyl tetrahydropterin, which is the second of three enzymatic steps in the synthesis of tetrahydrobiopterin from gtp  <cit> . the enzyme qued, which contributes to the biosynthesis of queuosine, a hypermodified base in the wobble position of some trnas in bacteria and eukaryotes  <cit> , is also part of this functionally diverse superfamily  <cit> . in total, at least six ptps homologs with different enzymatic functions named ptps-i – ptps-vi have been described to date, which are also often misannotated and hard to discern via sequence similarity alone  <cit> . moreover, several bacterial species possess more than one ptps homolog and a standard gnn approach did not allow the accurate and precise identification of the different enzymatic functions  <cit> . we expected a better performance of an rgnn analysis due to the following reasons:agennt’s built-in filters reduce noise and eliminate pfam-nodes less relevant for a functional assignment.

agennt’s representation of gns allows the detection of clearly distinct gns but also function-related overlaps between clade-specific gns.




to begin with, we computed an rgnn for ipr <dig> based on the rep-node  <dig> file and used our standard parameters, i. e., the blast e-value cut-off 1e- <dig>  a ± <dig> neighborhood, and a co-occurrence of 20%. additionally, we applied the s-th value of  <dig> and eliminated subspecies. by utilizing cytoscape’s select command, we generated the network named rgnn_7115_ <dig> that contains all cluster- and pfam-nodes representing at least  <dig> sequences; see fig.  <dig> fig.  <dig> rgnn of ipr <dig> . this rgnn  contains all nodes that represent more than  <dig> sequences. dominating are cluster-nodes  <dig> ,  <dig> , and  <dig> . dominating pfam-nodes are related to queosine biosynthesis . the gns of ptps-ii enzymes  and of ptps-iii enzymes consist of not more than two pfam-nodes. the gns of ptps-iv enzymes contain fole2; fole belongs to the gn of cluster-nodes  <dig>   <dig>  and 71




dominant elements of rgnn_7115_ <dig> are three cluster-nodes  that possess distinct gns. the gn of cluster  <dig>  contains not more than two pfam-nodes, namely pf <dig>  and pf <dig> . interestingly, cluster-node  <dig>  also contains a gtp cyclohydrolase i, namely pf <dig> , but also pf <dig>  which is involved in riboflavin biosynthesis  <cit> . cluster  <dig>  represents  <dig> sequences mainly from proteobacteria. the most prominent pfam-node of the corresponding gn is pf04055-pf <dig> .

this pfam-node occurs in nine gns and the corresponding cluster-nodes  represent a total of  <dig> sequences. the gns of these clusters also contain pf <dig> , pf <dig>  and pf4055-pf <dig> , all of which contribute to queosine biosynthesis. thus, the abundance of sequences and the density of the network make clear that qued  functionality is most prevalent in this interpro family. as a first result, we postulate at least three different enzyme functions for ptps homologs; the analysis of a conventional gnn did not allow such a classification  <cit> .

in order to illustrate a more profound analysis of a complex case, we generated a second, more detailed network named rgnn_7115_ <dig> that contains all cluster- and pfam-nodes representing at least  <dig> sequences; see additional file 2: figure s <dig>  additionally, we analyzed sequence motifs, which are indicative of the functionality of ptps homologs  <cit>  and can easily be deduced for cluster-nodes; see the protocol given in the legend of additional file 2: figure s <dig>  as expected, the concerted analysis of known motifs and gns allows a more precise specification of ptps functions: for example, the clusters predicted as being involved in queosine biosynthesis showed the motif cxxxhgh that is typical for ptps-i functionality  <cit> . all sequences of cluster-node  <dig> contain the ptps-ii typical sequence motif cxxxxxhgh  <cit> . in contrast, the sequences of cluster-nodes  <dig> and  <dig> contain the motifs cxxxxhgh and cxxxhgy, thus we termed them ptps-ii-like. the sequences of cluster-node  <dig> share the motif exxhgh indicative of ptps-iii functionality and those of cluster-node  <dig> preferentially contain the ptps-iv-typical sequence signature fgpaq  <cit> .

importantly, our rgnn approach identifies fole <dig> as element of the ptps-iv neighborhood, which has not been recognized previously, possibly due to the low number of analyzed sequences. moreover, our analysis of more than  <dig>  sequences suggests a highly variable gn of ptps-ii sequences ; the coverage of the edge interconnecting cluster-node  <dig> and pf <dig> is not higher than  <dig> . a more detailed analysis of rgnn_7115_ <dig> can be found in the legend of additional file 2: figure s <dig> 

taken together, by analyzing this interpro family of ptps homologs, we have demonstrated that the visualization of gns as interwoven networks helps to corroborate similarities and differences of gns. by eliminating smaller gns, the user can create a “bird eye’s view” on enzyme interactions and identify those ones that are conserved in many, phylogenetically distinct genomes. these results nicely supplement findings deduced from the specific analysis of individual genomes and are additionally robust against the effect of “genomic hitchhiking”. most likely, some microbial neighborhoods are merely due to the expression level and not to the functional theme of a given neighbourhood  <cit> , which makes some individual cases enigmatic.

discussion
potentials and limitations of ssns, gnns, and rgnns
the exponential growth of sequence data demands the development of robust and simple to use techniques to support the experimental biologist in analyzing and restructuring functionally diverse enzyme superfamilies. ssns are an easy to use alternative to multiple sequence alignments  and phylogenetic trees. for large and diverse sequence sets, it is difficult to construct a reliable msa. this in turn impedes the identification of sequence motifs that are specific for the different functions of homologs and also the computation of a phylogenetic tree. on the other hand, the two-dimensional distances used in ssns represent much of the information underlying phylogenetic trees  <cit> . moreover, when analyzing and annotating large superfamilies, the main goal is not to create the optimal representation of sequence similarity, but to allow the user the visualization of many protein attributes that are orthogonal to sequence similarity and represent derived information. as has been demonstrated, by mapping these features onto ssns by means of interactive software like cytoscape, the informed user can rapidly develop hypotheses about the function of family members .

the synergistic use of ssns and gnns further assists the user in assigning enzyme function, because the genome neighbors are expected to be functionally related to the enzymes under study. along this line, experiments confirmed that the majority of the  <dig> enzymes of the proline racemase superfamily catalyze only three known reactions. thus, by using gnns without additional information, the function of > 85% of the family members could be predicted  <cit> .

we made plausible that the simultaneous analysis of many phylogenetically unrelated genomes reduces the risk of creating overly specific gns containing functionally unrelated enzymes. to the best of our knowledge, the efi services are the only algorithms that deduce and combine gns for a large number of homologous protein sequences. in contrast, alternatives like the multi-genome browser of biocyc  <cit>  or psat  <cit>  are focusing on the analysis of few genes or are restricted to co-expressed genes  <cit>  or mammalian genomes, like g-nest  <cit> . thus, the strength of efi gnns is the possibility to deduce gns from many genomes and to combine them. moreover, these gnns are an ideal representation of the commonalities and differences of gns found for homologous proteins.

agennt provides additional guidance in functional annotation. however, the user has to anticipate several kinds of bias that may affect the composition of the resulting rgnns:in contrast to initial implementations of gns  <cit> , the efi gnns comprise all protein functions encoded by neighboring genes irrespective of their orientation and their regulation. thus, a gn may contain functionally unrelated gene-products belonging to different operons. this risk is higher, if a large neighborhood value was chosen for gnn compilation and if the operon under study consists of only few genes.

if some species  are overrepresented in a cluster-node, their species-specific gn can dominate the gn determined for the whole cluster-node.

the composition of the individual gns depends on the clusters constituting the ssn.




a combination of enzyme functions from several operons to the same gn  is more likely for cluster-nodes representing closely related species but unlikely for less related ones, because the genome location of operons is not conserved on the grand scale. by inspecting the phylumstat value computed by agennt for each cluster-node, the user can deduce the phylogenetic relationship of the corresponding species.

eliminating phylogenetic bias  is difficult; however, the subspecies filter offered by agennt and the usage of rep-node networks enables the user to purge a fair amount of this bias. additionally, high uniqueness values are indicative of highly specific gns related to a certain evolutionary environment or taxon. if accompanied by a broad phylogenetic spread shown by phylumstat, small uniqueness values signal gns that are found in many, less related taxa.

in order to assess the robustness of the findings deduced by means of rgnns , we recommend to utilize several parameter combinations and to compare the outcome. for example, if the parameters chosen for ssn generation give rise to a large “super cluster” consisting of several clusters c
 <dig> .. c
n, the gn deduced from the corresponding rgnn might be indicative of only one cluster c
j but not for all of them. moreover, if a genome contains two copies of a gene, the gnn is a composite of two genome neighborhoods. to identify such cases, the user can control the seqcount and coverage values to be found in the edge table of cytoscape’s table panel. these values give for all edges that interconnect a cluster-node and a pfam-node the absolute and relative number of genomes supporting this link. if these values are relatively small, the corresponding enzyme function occurs only in a fraction of clustered gns.

CONCLUSIONS
for monofunctional enzymes found in many phyla, the gn is conserved to a great extent and after filtering, the rgnn is of low complexity because adjacent operons vary in their composition. rgnns of high complexity are indicative of homologous enzymes possessing different functions. the representation of these gns generated by agennt assists the user in discriminating highly specific genome content and a more common functional coupling of enzymes deduced from a large number of phylogenetically less related species. the rich annotation of cluster-nodes supports the user in structuring large protein families and in deducing putative functions based on the differing metabolic contexts.

additional files

additional file 1: usage of agennt. a tutorial guiding through the process of generating ssns, rgnns by means of agennt and their visualisation by means of cytoscape. 

 
additional file 2: figures s1–s <dig>   representations of  <dig> rgnns resulting from a systematic variation of parameters used to generate them and of rgnn_7115_ <dig>  

 


abbreviations
efienzyme function initiative

gngenome neighborhood

gnngenome neighborhood network

ncbinational center for biotechnology information

pfamprotein family

rgnnrefined genome neighborhood network

ssnsequence similarity network

ththreshold

electronic supplementary material

the online version of this article  contains supplementary material, which is available to authorized users.

