BACKGROUND
living snakes  comprise more than  <dig>  species. they are virtually cosmopolitan in distribution, occupying fossorial, arboreal, terrestrial, and aquatic environs, and living in climates ranging from arid deserts to the open ocean. crown snakes are split into two major clades: scolecophidia, which includes blind snakes and thread snakes, and alethinophidia, which comprises all other snakes  <cit> . within alethinophidia, the most diverse and disparate clade is henophidia, which includes booids  and caenophidians .

the ecological and evolutionary origins of snakes have long been debated in light of the clade’s incredible extant diversity, and the distinctive snake body plan. among the major questions surrounding snake origins are whether snakes first arose on the mesozoic supercontinent of gondwana or laurasia, whether snakes originated on land or in the sea, and whether the earliest snakes were fossorial, terrestrial, or arboreal in their habits. inferring the phenotype, ecology, and biogeography of the ancestral snake has heretofore been hindered by the relative lack of informative fossils of early stem snakes. furthermore, deciphering the evolutionary origins of snakes is complicated by the fact that scolecophidian snakes, which are sister to all other crown snakes, are highly modified and overprinted with unique morphological and behavioral apomorphies  <cit> . these include ecological and behavioral features such as exclusively fossorial habits, specialized feeding on social insects and their larvae, as well as derived phenotypic characteristics such as highly reduced eyes, uniquely modified jaws, and smooth, deeply imbricate, cycloid body scales.

however, recent discoveries of more complete, better-preserved specimens of fossil stem snakes such as dinilysia patagonica   <cit> , najash rionegrina   <cit> , and coniophis precedens   <cit>  suggest that the unique characteristics of scolecophidians likely do not represent the ancestral condition for snakes. phylogenetic analyses indicate that dinilysia, najash, and coniophis represent successively more remote hierarchical sisters to crown snakes, with dinilysia representing the immediate sister to the crown  <cit> . these specimens thus provide abundant new data on the origin of early snakes. importantly, these fossil species are also unambiguously terrestrial  <cit> : this, in combination with the recently revised phylogenetic position of the limbed tethyan marine snakes  as nested within alethinophidia   <cit> , offers compelling evidence against the marine origin hypothesis for snakes.

these recent fossil findings, in conjunction with fossils of previously unknown, extinct members of crown serpentes such as sanajeh indicus  <cit>  and kataria anisodonta  <cit> , provide abundant new data on the morphology and evolution of the earliest known snakes, and emphasize the crucial role fossils play in accurately inferring evolutionary history  <cit> . in light of this newfound wealth of fossil data, we infer the ecology, behavior, and biogeography of early snakes by synthesizing information from the fossil record with phenotypic and genetic data for recent species. specifically, we reconstruct the ancestor of the snake total-group and of crown snakes, using both established and recently developed analytical methodologies. additionally, we infer divergence time trees using a combination of traditional node-based dating and novel fossil tip-dating methods  <cit>  to explore the pattern and timing of major events in early snake evolution.

RESULTS
phylogenetic analyses
the complete dataset comprises  <dig> phenotypic characters,  <dig>  base pairs  from  <dig> nuclear loci and one mitochondrial locus, and  <dig> novel characters for ancestral state reconstruction . bayesian phylogenetic trees were inferred using the following four datasets: 1) phenotypic data alone ; 2) genetic data alone ; 3) the combined phenotypic and genetic dataset, without any topological constraints ; and 4) the combined phenotypic and genetic dataset, with topological constraints enforced such that the relationships of the major clades correspond to those inferred using the morphological data . the constrained analysis was implemented in order to test hypotheses of character evolution on the phenotypic tree topology with branch lengths inferred using the complete dataset. in addition, maximum parsimony trees were inferred using the phenotype-only dataset  and the combined dataset .figure  <dig> bayesian phylogenetic tree inferred from phenotypic dataset. fifty-percent majority rule consensus tree from bayesian analysis of the state-partitioned phenotypic dataset  under the mkv model  <cit>  in mrbayes. node values are bayesian posterior probability support values; only values above 90% are shown. scale bar represents substitutions/site. colored boxes indicate major clades. fossil taxa are marked with a dagger .



in general, most nodes are consistent across all trees with high support. clades that appear in both the tree inferred from the phenotypic dataset using parsimony and the tree inferred using bayesian methods are always well supported under both optimality criteria. in the few instances where parsimony and bayesian topologies for the phenotypic dataset differ, support for an alternative topology is invariably poor . the parsimony and bayesian analyses of the  combined dataset also match in general, with the one notable exception of parsimony inferring a large polytomy at the base of alethinophidia, comprised of anilius, kataria, tropidophiidae, the clade of cylindrophis + anomochilus + uropeltis, the simoliophiidae, the clade of xenopeltis + loxocemus + pythonidae, and a polyphyletic ‘booidea’ .

the most striking differences are between trees inferred from the phenotype vs. the genotype. scolecophidia, for example, is inferred to be paraphyletic  in the genetic tree . this result concurs with other recent phylogenetic analyses using genetic data to target snake interrelationships  <cit> . however, in the phenotypic tree , as well as in the combined trees , scolecophidia is inferred to be the monophyletic sister to alethinophidia . it is particularly notable that the unconstrained tree in our study recovers a monophyletic scolecophidia, as it suggests that the addition of phenotypic data to a dataset dominated by genetic data  can have significant effects on tree topology – in this case, resulting in the more traditional inference of scolecophidian monophyly.

several other major differences exist between the phenotypic/constrained trees and the genetic/unconstrained trees. the viperid snake daboia russelii is inferred to be sister to crotalinae  in the phenotypic , unconstrained , and constrained trees , whereas it is sister to causus rhombeatus in the genetic tree , making it part of a clade that is sister to all other viperidae. in addition, the phenotypic and constrained trees strongly support a monophyletic xenopeltidae  as sister to all other members of macrostomata, whereas the genetic and unconstrained trees firmly place them as successive sisters to pythonidae . this result concurs with other recent studies of snake phylogeny based on concatenated gene sequences  <cit> .

the position of tropidophiidae within alethinophidia is radically different among trees derived from these datasets. in the genetic and unconstrained trees, anilioidea is polyphyletic : cylindrophis, uropeltis, and anomochilus form a clade sister to macrostomata, with anilius + tropidophiidae  as the next successive sister group. the anilius + tropidophiidae clade, also termed amerophidia  <cit>  after their exclusive extant presence in the new world , is strongly supported by molecular data in this study, in agreement with previous phylogenomic analyses of snake phylogeny  <cit> . in contrast, the phenotypic and constrained trees recover tropidophiidae in its traditional position nested within henophidian macrostomatans, as sister to caenophidia . notably, in the unconstrained tree, the support values for the anilius + tropidophiidae clade, and for the sister relationship between the clade of cylindrophis + uropeltis + anomochilus and macrostomata, are not significant. this collapse in support values relative to the genetic tree  is likely due to the inclusion of strongly discordant phenotypic data in the unconstrained analysis. indeed, to date only a single morphological apomorphy – specifically, an oviduct connecting with diverticuli of the cloaca, instead of directly with the cloaca as in all other squamates – has been found to be shared by anilius and tropidophiidae  <cit> . in addition, the splitting of cylindrophis, uropeltis, and anomochilus from anilius in the genetic tree, and the placement of the former three taxa within basal macrostomatans, would require the “redevelopment of a complex multipinnate jaw adductor musculature comparable to that of lizards”  <cit> . furthermore, although it can be argued that anilius and uropeltines may be artificially drawn together due to convergence in their skulls related to shared fossorial habits, such an argument does not account for the fact that other fossorial snakes, such as loxocemus, are never recovered as being closely allied to anilius or uropeltis. the question of whether amerophidia  represents a true clade clearly requires further study; regardless, including phenotypic characters in our combined dataset collapses strong support for amerophidia, again demonstrating the potential influence of including phenotypic data even in large-scale phylogenomic studies, despite marked discrepancies in the number of characters from each source . we emphasize here that we do not mean to suggest that the morphological signal is necessarily the ‘correct’ one, but rather that including morphological data can be beneficial and effective at identifying portions of phylogenetic trees that may not be as uncontroversial as genomic data alone may suggest – whether by directly affecting the topology itself  or by collapsing the support values of controversial groups . our study presents empirical evidence against the commonly held view that genomic data, by virtue of their abundance, will inevitably ‘swamp out’ conflicting signals from morphological data, rendering their contribution negligible and thus ignorable .

the placement of several fossil taxa differs between the unconstrained tree and the phenotypic and constrained trees. for instance, marine simoliophiids are inferred to form a clade that is sister to alethinophidia in the unconstrained tree , in contrast to the phenotypic  and constrained trees , where they are nested within alethinophidia as sister to crown macrostomata. the simoliophiidae + alethinophidia sister relationship in the unconstrained tree is, however, poorly supported. in all cases, simoliophiids are inferred to be nested within crown snakes with high support, and do not represent stem snakes , despite retaining tiny hindlimbs.

the unconstrained, constrained, and phenotypic trees all strongly support madtsoiidae  as stem alethinophidians , and thus as belonging to the snake crown-group . this suggests that madtsoiids, and by extension the ancestor of crown snakes, likely also retained tiny hindlimbs with ankles and toes, as in stem snakes and simoliophiids – unlike any extant snakes. at this point, however, we can only be sure that madtsoiids retained at least part of the hindlimb, as wonambi naracoortensis has a scolecophidian-like triradiate pelvis with a well-developed acetabulum for reception of the femoral head  <cit> .

the unconstrained tree and constrained/phenotypic trees further differ in the placement of the paleocene fossil snake kataria anisodonta, from south america  <cit> . in the unconstrained topology, kataria is reconstructed as sister to tropidophiidae, with anilius scytale as sister to both of these taxa . in contrast, the phenotypic and constrained analyses  infer that kataria is nested within macrostomata and henophidia as sister to tropidophiidae + caenophidia, in agreement with scanferla et al.  <cit> . the placement of kataria exhibited in the unconstrained tree is not strongly supported, and likely reflects a passive consequence of its allegiance with tropidophiidae and caenophidia, clades that are strongly supported in all analyses of all datasets.

both the genetic and unconstrained trees resolve xenodermus javanicus as the immediate sister taxon of colubroidea, followed by acrochordus granulatus as sister to the xenodermus + colubroidea clade . this is contrary to the strongly supported phenotypic/constrained topology, in which the positions of xenodermus and acrochordus are reversed . although other studies of concatenated gene sequences have inferred the same topology as our genetic tree with equally high support  <cit> , the recent pyron et al.  <cit>  supertree recovered an alternate, highly supported topology in which xenodermatidae and acrochordus form a clade that is sister to colubroidea. the disagreement between genetic tree topologies for these taxa illustrates the existence of extensive homoplasy in multi-gene, phylogenomic datasets  <cit>  . definitively unraveling the relationships among xenodermatidae, acrochordus, and colubroidea will require further study.

in all analyses, dinilysia patagonica, najash rionegrina, and coniophis precedens form successive sisters to crown serpentes, supporting their status as early members of pan-serpentes, with coniophis as the earliest-diverging stem snake currently known. although najash and coniophis are clearly stem snakes more distantly related to the crown than is dinilysia, the inference that coniophis, rather than najash, is sister to all other known snakes depends on the correct attribution to that species of isolated, tooth-bearing bones with numerous disarticulated vertebrae, all from the maastrichtian of the american interior west  <cit> . the validity of this standpoint remains controversial, and its resolution will require additional discoveries of associated/articulated coniophis specimens  <cit>  and more complete knowledge of najash.

ancestral state reconstruction
ancestral state reconstructions  were conducted for  <dig> characters  for the genetic , unconstrained , and constrained  topologies, using three methods: parsimony, yang et al.’s maximum likelihood  re-rooting method  <cit> , and bayesian stochastic character mapping  <cit> , representing a total of  <dig> individual asr analyses. we chose to implement all three methods in order to compare their results and establish robustness  of our results. in particular, we were concerned with how variable reconstructions were across methods, and how different ways of defining a character – i.e., the binary ‘plate i’ character vs. the much more highly atomized ‘plate ii’ character – might affect our results. the bayesian stochastic character mapping method was chosen in particular for its ability to include polymorphic and missing characters – which are extensive in our dataset – during the inference process. asr results are reported for the ‘serpentes’  node and the ‘total-group’ node, with bayesian results reported as posterior probabilities , ml results reported as proportions of total likelihood , and the most parsimonious state reported for parsimony.

asr results are largely invariant across different reconstruction methods and tree topologies. however, several reconstructions fail  for the genetic topology. specifically, this occurs for the ‘diel’, ‘plate ii’, ‘biome’, ‘habitat stratum’, and ‘aquatic habits’ characters. in contrast, for the constrained and unconstrained tree topologies, asr fails only for the ‘biome’ character using the ml method. this suggests that this genetic topology is particularly poorly suited to ancestral state analyses, perhaps because, due to its lack of intermediate, branch-shortening fossils, it fails to approximate the full distribution of character states that existed across the evolutionary history of snakes. this underscores the importance of including fossils as terminal taxa in ancestral state reconstruction analyses; for scenarios in which the genetic-only dataset fails in its ancestral state reconstruction, analyses of the combined datasets fail in only one of these . previous studies, both theoretical  <cit>  and empirical  <cit> , have demonstrated that the inclusion of fossil data in ancestral state reconstructions improves the precision, accuracy, and overall performance of these analyses. our results corroborate these ideas, further demonstrating that in certain cases, the lack of fossil taxa in these analyses may actually render the reconstruction of ancestral states impossible. fossil data are indispensable for reliably interpreting evolutionary history, as they serve to constrain possible hypotheses of character evolution and capture a more complete picture of character state distributions across evolutionary time and phylogenetic diversity.

both the ancestor of crown snakes and the earliest known ancestor of the snake total-group are reconstructed unambiguously by all methods and on all topologies to have been land-dwelling, supporting the hypothesis that snakes originated in a terrestrial, rather than a marine, setting  <cit> . this is consistent with independent inferences of terrestrial habits for the oldest member of pan-serpentes   <cit> , najash rionegrina, dinilysia patagonica  <cit> , and lapparentophis defrennei  <cit> . these results further corroborate the suggestion that the limbed tethyan simoliophiidae represent an independent invasion of the marine realm. although a terrestrial origin of snakes might imply that the snake body plan  is an adaptation for a burrowing lifestyle   <cit> , our inference for the primary habitat stratum for both the ‘serpentes’ and the ‘total-group’ node is somewhat ambiguous: although the bayesian and ml methods reconstruct the most likely stratum for both ancestors as surface-dwelling, the pp and ptl values are relatively low in the constrained topology . furthermore, reconstructions of terrestrial habits and fossoriality are equally parsimonious for both ancestors and topologies. such ambiguity is not entirely unexpected, as many extant snakes exhibit a combination of habits, and some species may even vary in stratum preference based on age and size  <cit> . regardless, our results suggest that the conclusion that the snake body plan evolved as an adaptation for a fossorial lifestyle is by no means foregone, and that burrowing taxa such as scolecophidians, and perhaps even anilioids, may have evolved from ancestors less committed to life underground  <cit> .

several additional conclusions can be drawn regarding the ecology and behavior of both the ancestor of crown snakes, and the ancestor of total-group snakes based on our analyses. both ancestors likely inhabited well-vegetated environs in warm, moist, and equable climates . this ecological preference spans much of the early history of snakes, from the branch stretching from serpentes to caenophidia. this may explain why, despite an extraordinary diversity of squamate fossils from these sediments, snakes have never been recovered from the more arid environs of the upper cretaceous of mongolia  <cit> .

ancestral snakes are strongly inferred to have been nocturnal, with the acquisition of diurnal habits apparently occurring inside colubroidea, specifically in the clade stemming from the last common ancestor of elapidae and colubridae . this return to diurnal habits – which are likely ancestral for reptiles  <cit>  – may explain certain aspects of the evolutionary history of colubroidea. specifically, although colubroids experienced extensive diversification during late oligocene climatic warming, this wide taxonomic breadth was not matched with high relative abundance  until the latter half of the miocene, when colubroids became dominant in the cooler and drier habitats that emerged at higher latitudes  <cit> . the success of the colubroidea in these higher-latitude environments may have been facilitated by the reemergence of diurnality within that lineage, as colder nighttime temperatures may have limited nocturnal activity for ectothermic snakes.figure  <dig> ancestral state reconstruction of diel activity pattern. bayesian simmap ancestral state reconstruction using the constrained tree for the history of the ‘diel activity pattern’ character. nocturnality is inferred to be ancestral for snakes. the grey box marks the clade colubroidea, within which diurnal habits re-evolved. note that simmap estimates the most likely states for tip taxa that are coded as missing or polymorphic – as such, some of the tip states exhibited in this figure are inferred tip states, not coded tip states . fossil taxa are marked with a dagger .



the feeding behavior of the earliest snakes was inferred to have been similar to that of most extant snakes: they were likely widely foraging stealth predators, hunting soft-bodied prey subequal to head size . constriction is relatively restricted in its phylogenetic distribution, and likely did not arise outside of crown alethinophidia.

the bayesian and likelihood reconstructions reported above are all supported by parsimony asr for all three topologies of interest, with the exception of prey preference, where parsimony reconstructs both soft-bodied prey and termites/ants  as being equally parsimonious on the genetic topology. this is likely due to a combination of the lack of fossil taxa in the genetic topology and the position of the termite-/ant-eating scolecophidians as sister to all other extant snakes. virtually all reconstructions are highly supported  by bayesian and ml methods across the combined tree topologies, with the exception of the ‘biome’ character for both topologies , the ‘constriction’ character for both topologies , and the ‘habitat stratum’ character for the constrained topology . all successful asr analyses for the genetic topology exhibit pp and ptl values greater than  <dig> , with the exception of the ‘diel’ character, for which the pp value of nocturnal habits, the most highly supported reconstruction, is  <dig>  .

lagrange  <cit>  biogeographic analysis of the ‘plate ii’ tectonic plate character yielded ambiguous results  for all tree topologies when the complete dataset  was used. when the taxa in the analysis were instead coded to reflect only the biogeographic ranges of individual species , lagrange infers that both the ancestor of crown snakes and the ancestor of the snake total-group likely originated on laurasia for the constrained tree . for the unconstrained tree, the results are equivocally split between laurasian and gondwanan origins . in contrast, the ancestor of crown snakes is unequivocally reconstructed as having originated on laurasia for the genetic tree using the no-genus distribution . however, the laurasian reconstruction for the ancestor of crown snakes using the no-genus distribution is potentially influenced by sampling bias, as our dataset contains mostly representatives of scolecophidia from north america and the caribbean, despite the worldwide distribution of scolecophidians. this phenomenon, resulting in more complete genetic data for nearctic scolecophidians than for other biogeographic zones, is likely due to the relative ease of access to these sampling localities for researchers hailing from the northern hemisphere.

the inability of the lagrange method to produce an unambiguous result suggests that such biogeographic methods, which require introducing sources of uncertainty , may not be ideal for reconstructing dispersal history across long stretches of geological time. this is likely due in no small part to the breakdown of the conceptual foundations of these methods when geographical areas – which must necessarily be predefined to create dispersal probability matrices – change significantly through time . this issue is likely aggravated when the organisms under consideration are highly dispersive, and thus likely to make biogeographic leaps that might seem extremely unlikely a priori.

several lines of evidence suggest that snakes, particularly relative to other squamate reptiles, are particularly adept dispersers: 1) snakes have been empirically demonstrated to exhibit larger ranges than non-snake lizards  <cit>  – when only terrestrial species are taken into consideration, snakes exhibit median range sizes that are ~ <dig>  times larger than that of non-snake lizards  <cit> ; 2) hydrophiine snakes are unique among extant squamates in being adapted exclusively for marine lifestyles , demonstrating the remarkable capacity of serpentes to adapt to and inhabit environments that traditionally hinder the dispersal of terrestrial organisms. this idea is corroborated by snakes having invaded aquatic  and marine habitats  multiple times in their evolutionary history, perhaps facilitated by natural floatation conferred by enlarged right lungs that extend down the body, as well as a style of terrestrial locomotion that approximates anguilliform-style swimming; and 3) the biogeographic ranges of certain snake clades suggest dispersal capabilities across large stretches of water. for instance, candoia is broadly distributed across the indo-pacific islands, but is sister to new world boas  <cit> ; such a biogeographic distribution is difficult to explain without considering the likelihood of oceanic dispersal. another example is the presence of bolyeria and casarea on round island, mauritius, while their sister xenophidion is found in southeast asia  <cit> . these issues in tandem – the breakdown of the conceptual underpinnings of biogeographic methods and the high dispersal capabilities of snakes – suggest that the failure of lagrange to reconstruct the snake biogeographic history indicates the fundamental inability of such methods to effectively broach the deep evolutionary histories of dispersive organisms.

in contrast to the lagrange results, ‘naïve’ asr methods  reconstruct the ‘serpentes’ ancestor as most likely originating on the gondwanan supercontinent . this conclusion agrees with previous work suggesting a gondwanan history for crown snakes, and in particular scolecophidia  <cit> , which is sister to all other crown snakes. reconstructions for the ‘total-group’ node are more equivocal: the most parsimonious state for both the constrained and unconstrained topologies is a laurasian origin, while ml and bayesian methods reconstruct a gondwanan origin as being only slightly more likely. although the unambiguously laurasian geographic distribution of a succession of anguimorphan outgroups supports a laurasian origin for stem snakes  <cit> , the ambiguity surrounding the ‘total-group’ node is likely also due to the laurasian occurrence  of the problematic early snake coniophis precedens, which has been argued to represent the sister group to all other snakes  <cit> . although this topological hypothesis is corroborated by our phylogenetic analyses, the validity of this argument hinges largely on whether all of the disarticulated elements referred to coniophis are truly associated with a single species, a claim that requires further investigation. future fossil discoveries and analyses may also potentially change our understanding of coniophis and the deepest portions of the snake stem .

these results thus support a gondwanan provenance for crown snakes, while also suggesting the possibility of a laurasian origin for the snake total-group. acceptance or rejection of this hypothesis necessarily relies on the future reevaluation of specimens referred to c. precedens and the discovery of additional early representatives of pan-serpentes.

divergence time estimation
divergence time trees were estimated for the genetic , unconstrained , and constrained trees . the constrained topology is presented because, unlike the other topologies, it preserves scolecophidian, anilioid, xenopeltid, booid, and tropidophiid + caenophidian monophyly. the following discussion, however, applies equally to all of the time-calibrated trees, with the exception of specific numbers regarding dates and their 95% highest posterior density intervals , and when otherwise noted.figure  <dig> divergence time tree inferred using the constrained topology. divergence times inferred using the constrained tree in beast. major crown clades are named, along with two extinct clades . the red line separating the mesozoic and cenozoic eras marks the cretaceous-paleogene  boundary at 66 ma. timescale is in millions of years. circled numbers and green stars correspond to calibration dates outlined in additional file  <dig>  colored boxes indicate major clades. fossil taxa are marked with a dagger . grayed taxa names indicate extant species that are included on the basis of phenotypic data only.



pan-serpentes is inferred to have originated ~ <dig>  ma , while crown snakes are inferred to have diverged ~ <dig>  ma . given the error margins in this analysis, these events appear to have occurred in relatively quick succession during the late early cretaceous . the successive divergences of madtsoiids, pan-anilioids, simoliophiids, and pan-macrostomatans occurred in a remarkably rapid series of events between 105–95 ma, with basal splits in crown macrostomatans following shortly thereafter . the timing of these rapid basal divergences falls within the range of dates associated with the cretaceous terrestrial revolution   <cit> , an interval when many familiar floral and faunal groups – such as mammals  <cit> , birds  <cit> , and angiosperms  <cit>  – appear to have experienced accelerated and widespread diversification in terrestrial ecosystems. our analyses suggest that snakes also experienced a burst of radiation in the mid-cretaceous, and may have been participants in this significant macroevolutionary event.

the initial splits within macrostomata appear to have occurred in the early late cretaceous, with the crown divergence between pan-booidea and the tropidophiid + caenophidian total-group following later . the modern radiation of crown caenophidian snakes, however, seems to spring forth later in the cenozoic, starting around 65–50 ma, soon after the k-pg mass extinction. although it should be noted that the hpdi of the deepest divergence in booidea crosses the k-pg boundary, the widespread distribution and astonishing diversification of henophidian snakes – which was driven primarily by the radiation of the colubroidea  <cit>  – clearly occurred after the end-cretaceous mass extinction in the combined divergence time trees. this result is in contrast to previous studies , which inferred a paleogene origin for colubroidea, but with confidence intervals crossing the k-pg boundary. however, it should be noted that the clade definitions of burbink and pyron  <cit>  differ slightly from ours; their crown ‘colubroidea’ is equivalent to our crown ‘caenophidia’. the age of our crown ‘colubroidea’  appears approximately as old as the corresponding clade in burbrink and pyron  <cit> . our genetic divergence time tree infers a similar result to previous studies using only genomic data, with a post k-pg origination date for colubroidea, but with error margins crossing the boundary . the inclusion of fossils as tip taxa thus clearly affects inferred divergence dates, and suggests that the early divergence dates for the most species-rich modern clade of snakes are younger than previously assumed. this radiation was likely driven by the sudden availability of niches left vacant by the catastrophic k-pg extinction, mirroring the astounding radiation of placental mammals  <cit> , crown birds  <cit> , and several other surviving groups of squamates  <cit>  in the early cenozoic.

CONCLUSIONS
based on our analyses, the ancestors of crown and total-group snakes were nocturnal stealth hunters that foraged widely for soft-bodied prey in warm, mild, well-watered, and well-vegetated ecosystems . prey size was relatively small compared to prey regularly consumed by snakes exhibiting the macrostomatan condition, but large relative to the size of prey targeted ancestrally by non-snake lizards. it was unlikely that they employed constriction to subdue prey. the earliest snakes were likely active primarily on the ground surface , although they may have also exhibited semi-fossorial habits. ancestral snakes are unequivocally inferred to have originated on land, rather than in aquatic settings. the biogeographic origin of snakes is less clear than their early ecology and behavior; however, our results suggest that the ancestor of crown snakes most likely originated on the mesozoic supercontinent of gondwana, and indicate the possibility that the ancestor of total-group snakes arose instead on laurasia. a conclusive resolution of the biogeographic origin of total-group snakes will require both reevaluation of the controversial fossil snake coniophis precedens, and the discovery of new fossils of stem-group snakes.figure  <dig> reconstruction of the ancestral crown-group snake, based on this study. artwork by julius csotonyi.



the snake total-group, or at least the coniophis-node, is inferred to have arisen in the middle early cretaceous, with the crown originating about  <dig> million years later, during the albian stage. a series of rapid divergences in their early evolutionary history suggests that snakes may have been participants in the hypothesized early cretaceous terrestrial revolution. our results further suggest that henophidian diversity, which includes the bulk of extant snake species, radiated entirely after the k-pg mass extinction.

these results paint the clearest picture yet of the early evolution of snakes, shedding light on their ecological, behavioral, biogeographic, and macroevolutionary origins. both the ancestors of total-group and crown-group snakes were apparently similar in ecology and behavior to many basal macrostomatans surviving today. this conclusion, dependent on the inclusion of fossil stem snakes in our analysis, would be unexpected if only extant snakes were considered, given the sister-position of highly derived scolecophidians to all other extant crown snakes. thus, the importance of fossil intermediates for illuminating macroevolutionary processes cannot be understated. furthermore, our results demonstrate that the inclusion of phenotypic and fossil data can affect the inference of phylogenetic topologies, even when such data are vastly outnumbered by genetic sequence data. fossils afford unprecedented glimpses into the grand tapestry of evolutionary history, and can inform inferences well beyond those that can be drawn from the fortuitous survivors comprising earth’s modern biota. transitional fossils are therefore invaluable for both phylogenetic analyses and for the accurate reconstruction of ancestral states.

