BACKGROUND
understanding the link between protein structure and protein function is a fundamental problem that underlies diverse application areas including drug target identification, protein function prediction, and structure-based evolutionary analysis. the specific few amino acids that mediate the drug-binding affinity of targeted binding sites are an example of a substructure within a protein. the catalytic substructures of enzymatic proteins are intrinsically linked to enzyme function  <cit> , and establishing a mechanistic understanding of how specific structural features affect protein function is a central problem in structural genomics  <cit> . the analysis of the physico-chemical properties of the few amino acids constituting these substructures, common to families of functionally related proteins, can provide direct insight to the structural features that dictate a particular enzymatic function  <cit> . for example, the family of serine proteases is a well-established case of a common functional substructure, the his-asp-ser catalytic triad, dictating a common function in the absence of sequence or fold similarity between chymotrypsins, subtilisins, and lipases  <cit> . conversely, in the case of tim barrel proteins which share fold similarity, differing functional substructures within the catalytic site confer differing functions  <cit> . therefore, because these functional substructures are essential determinants of protein function, computational approaches to analyze and compare substructures among proteins can provide fundamental insight to the molecular mechanisms that mediate protein function  <cit> .

protein substructures can be represented as motifs  that abstract the functionally import residues of binding sites. comparing conserved binding site substructures among all proteins within an enzymatic family can reveal high-level structural trends that may not be apparent if only considering pairs of proteins. the family-wise analysis of substructural templates  method introduced in this work identifies substructural clusters  by comparing the binding site substructures among all proteins within a family. the scs identified by fasst are demonstrated to reveal substructural patterns that can be associated with phylogeny, conformation change, and homology. motif ensemble statistical hypothesis testing , the second method introduced here, exploits the scs output by fasst to construct multi-structure ensembles of motifs that are shown to have increased function prediction power compared to single-structure motifs. together, fasst-mesh provides an automated approach for identifying patterns of substructure variation among large numbers of proteins and a method for enriching existing substructure motifs.

substructure analysis is of practical importance for identifying proteomic drug targets, finding potential drug side-effects, predicting protein function, and evolutionary analysis. binding site substructures have been considered "receptor-based pharmacophores"  <cit> , allowing a specific few amino acids to indicate likely interaction with a specific ligand-based pharmacophore. substructural similarity at ligand-binding sites among proteins is indicative of similarity in ligand- and drug-binding properties  <cit> . exploitation of this property has been applied recently to identify new targets for existing drugs  <cit>  and to computationally analyze potential drug side-effects  <cit> . specifically, cross-species substructure analysis of binding sites among families of functionally homologous proteins can play an important role in lead evaluation  <cit> , and therefore computational approaches to analyze family-wise substructural variation are particularly relevant for modern drug development.

furthermore, substructure comparison of catalytic sites among proteins has been shown to be a powerful technique for predicting the function of protein structures  <cit>  and is an important component of structural genomics initiatives that seek to map and functionally annotate the space of protein structures  <cit> . finally, enzymes evolve under selective pressure to maintain biologically necessary functions  <cit> , and functional substructure conservation in the absence of sequence of fold conservation has been established  <cit> ; substructure comparison may be the only way to establish homology between proteins that have significantly diverged in both sequence and fold  <cit> . this work contributes two new computational methods for family-wise substructure analysis that contribute novel approaches to examining protein substructures. given the biological relevance of substructure analysis and the proliferation of available structures in the protein data bank   <cit> , computational approaches to substructure analysis can make meaningful contributions to our understanding of proteomics.

computational methods for finding functionally significant substructures and methods for comparing substructures to identify biologically relevant proteins with matching substructures are two complementary components of substructure analysis. as far as approaches capable of finding substructures are concerned, earlier work includes ligand-binding cavity identification , structural pattern recognition , computational scanning mutagenesis , evolutionary analysis , expert knowledge , and automatically curated databases . substructures identified by these methods can be computationally represented, either in full or in part, by motifs that model both the geometric and physico-chemical properties of a given substructure. computationally identifying substructure matches in other proteins with statistically significant similarity to a motif can indicate that a matched protein may share functional characteristics with the motif  <cit> . diverse approaches to motif search and/or comparison have been developed and include: spasm  <cit> , assam  <cit> , pints  <cit> , jess  <cit> , siteengine  <cit> , query3d  <cit> , profunc  <cit> , proknow  <cit> , sitesbase  <cit> , giraf  <cit> , mash  <cit> , labelhash  <cit> , soippa  <cit> , feature  <cit> , and pevosoar  <cit>  to name a few. in general, designing high-quality motifs that accurately capture the functional essence of a substructure is critical and the  performance of motif-driven substructure comparison methods depends directly on the biological relevance of input motifs. the described work complements both the identification and comparison of motifs in novel ways. this paper departs both from finding functionally significant substructures and from comparing substructures to identify biologically relevant matching proteins. the approach presented here combines substructure comparison, unsupervised learning, dimensionality reduction and non-parametric statistical analysis to partition functionally homologous protein families into scs based upon substructural similarity. this work demonstrates an automated approach that could be used to augment existing substructure motifs already available in repositories such as the catalytic site atlas  <cit>  by geometrically enriching motifs for families that exhibit high structural variability. as both the number and diversity of available structures for a given protein family continue to increase, the enhancement of substructure-based functional annotation methods to accommodate large families is necessary. the automated enrichment of available motifs strengthens the function prediction power of these motifs and facilitates the use of substructure-based analysis methods for large-scale, automated annotation of novel structures.

the biological relevance of the functional substructures modeled by motifs can be exploited for exploratory investigations of the role and structural conservation/variation of a substructure within a large protein family; we demonstrate the utility of this approach using fasst by comparing the scs output by fasst to biological ontologies such as phylogeny. furthermore, selecting a single-structure motif as a consensus model of a family-wide functional substructure can prove difficult  <cit>  when functionally conserved protein families become large and species-diverse. the mesh framework transforms single-structure motifs into motif ensembles to account for increasing family-wide substructural diversity and provides a robust procedure for identifying statistically significant matches to the motif ensemble as a whole. fasst and mesh directly contribute to substructure-based analysis by providing a motif assessment and refinement procedure. fasst provides an additional avenue of exploratory investigation for selected substructures within a family of interest.

fasst proceeds as follows. for a given enzyme family, a substructure motif of the catalytic site is first defined from a literature reference or other source of substructure motifs  <cit> . instances of the motif are then identified in each family member structure by a substructure search algorithm--labelhash in this paper  <cit> . next, all-against-all pairwise least root mean square deviation  distance comparisons are computed between family members. the lrmsd of the catalytic site substructure from a given protein to the remainder of the family then encodes the family-wise relationship of the family members to one another as vectors of geometric features. each geometric feature vector can then be interpreted as a point in a high-dimensional geometric feature space, where nearby points in this space indicate similar family-wise relationships for the corresponding substructures. fasst then uses a gaussian mixture model  clustering approach for unsupervised learning of the scs. the scs can then be compared to a biological ontology by mapping meta-data to each substructure for exploratory data analysis.

we demonstrate with fasst that scs can suggest biological sources of structural variation within a protein family. for the heme-dependent peroxidase family  and the xylose isomerases , we show that the observed scs can be explained by the phylogenetic distance between members of the family. structures of the thermolysin family of bacterial proteases are observed to have catalytic sites with both discrete and continuous modes of flexibility, and structures are known to transition between discrete structural conformation states upon ligation. analysis of the family-wise structural variety of the serine protease catalytic triad, incorporating over  <dig> structures from  <dig> different species and  <dig> ec classes, demonstrates the ability of fasst to detect substructure variation among convergently related families where the motif substructure resides in many configurations, including some spanning peptide chains. the substructural variation present within each family is automatically identified from the scs output by fasst.

the fasst method presented here directly complements the k-partite  <cit> , bipartite  <cit>  and product-graph-max-clique  <cit>  approaches to all-against-all common substructure identification, because these methods can successfully identify common substructures between two  <cit>  or more  <cit>  binding sites. the common substructural elements identified by these approaches can serve as a source of new motifs for further substructure analysis. several of these all-against-all methods have been used to construct "similarity networks" of known ligand binding sites by using pairwise similarity between binding sites in combination with linkage-based  <cit>  clustering to build graphs of related sites. however, edges in these "similarity networks" correspond to maximal matches between any given pair of binding sites, causing both the specific subset and number of amino acids compared between a given site and all other sites to vary due to differing levels of maximal matches between each binding site pair. our approach uses a single substructure as a consistent point of comparison in every pairwise comparison made within a protein family; hence, the resulting scs output by fasst can be further utilized, by mesh, to construct a per-cluster representative consensus motif that is guaranteed to be found in every cluster member. the substructure-based all-against-all comparison implemented by fasst is most analogous to the seminal work of holm and sander  <cit>  on mapping protein fold space via all-against-all dali comparisons  <cit> . mesh utilizes the scs identified by fasst to construct refined substructure motifs that have improved sensitivity, and we demonstrate this procedure in a series of protein function prediction experiments. mesh constructs a representative motif for each identified cluster. the collection of representative motifs, for the family, constitutes a single motif ensemble. to provide a statistically rigorous framework for calculating the statistical significance of substructure matches identified by motif ensembles, we introduce a non-parametric model of substructural similarity for multi-structure motifs. when compared to single structure motifs, we demonstrate that the fasst-mesh framework can significantly improve functional annotation sensitivity for structurally diverse families of proteins, while maintaining annotation specificity, for the  <dig> protein families included in the study.

RESULTS
the families of proteins included in our study were analyzed with fasst to construct scs that model the substructural diversity of each family. the underlying source of substructural variation could be clearly attributed to phylogenetic distance, conformation, or protein homology in many cases. the families of proteins we highlight here have a source of substructural variation that can be concretely linked to a single biological factor, in order to better demonstrate the role of each variation source independently. each structure family was defined by enzyme commission  numbers and preference for inclusion into the data set was given to families with a large number of structures. a catalytic site motif was defined for each family from a literature reference  using cα positions. fasst then takes as input the family and motif and outputs scs for the family in order to identify the substructural variation within a family. we analyze the scs of highlighted families in detail below.

for each ec class family, a single pdb structure was used to define an input motif. the list of amino acid numbers are documented functional residues found within the primary pdb http://www.pdb.org reference corresponding to each pdb structure. the superscript labels above each amino acid number are the possible amino acid types that can match at each motif point; further details of alternate amino acid label use can be found here  <cit> . where multiple amino acid labels per motif point appear, they were determined using consurf  <cit> .

phylogenetic-based clusters 
heme-dependent peroxidases
heme-dependent peroxidases  are ubiquitous enzymes responsible for moderating reactions with reactive oxygen species. the lactoperoxidases and myeloperoxidases found in animal leukocytes produce potent antibacterial agents and have been shown to play a role in inflammatory responses  <cit> . the non-animal class ii peroxidases, found in fungi, and class iii peroxidases, found in plants, are both secreted enzymes that are thought to play multiple roles including organism development and pathogen defense  <cit> . the catalytic site region of the arthromyces ramosus class ii peroxidase enzyme  includes the proximal  and distal  histidines coordinated to the heme group as well as the distal catalytic residues  and the hydrogen-bonded asp- <dig>  <cit> . superposition of all of the heme-dependent peroxidase catalytic site structures, identified through motif propagation as outlined in methods, is shown in figure  <dig>  although the catalytic site motif can be identified within both animal and non-animal peroxidases, geometric variability of the catalytic residues is evident from the alignment. the peroxidase scs constructed by fasst ) reveal that the peroxidase structures segregate into four main clusters that can be explained well by the phylogenetic ontology of the structures as shown in the corresponding figure  <dig> plot. the lactoperoxidase structures from capra hircus , bos taurus , ovis aries , and bubalus bubalis  form a single cluster in the scs nearby the distinct myeloperoxidase cluster from homo sapiens. the class iii plant peroxidases from the brassicaceaa family form a tight cluster along with the class iii plant peroxidases of the fabaceae family which are near the perimeter, but outside the main cluster. finally, the class ii fungal peroxidases form a fourth distinct cluster most distant from the other three clusters.

the locations of the peroxidase catalytic site substructures in the scs appear to be highly correlated with the evolutionary history of the enzyme. the animal and non-animal peroxidases are theorized to have originated from two separate endosymbiotic events predating modern plant and animal cells  <cit> . the sequence identity between the human  and fungal  versions of the enzyme is 9% making a sequence-based approach to analyzing this family as a whole impossible. pairwise sequence identity between the labeled positions in figure  <dig> is consistently very low as seen in table  <dig>  as shown in figure  <dig>  the overall fold topology of the animal and non-animal peroxidases differ greatly and belong to separate fold classes within the cath structural ontology  <cit> . however, the catalytic substructure represented by the motif provides a common point of comparison between these peroxidases and allows fasst to identify the significant family-wise catalytic site variation and underlying clusters within the larger protein family. by mapping the scs to the family-level phylogenetic ontology, fasst is able to propose a hypothetical explanation for the pattern of substructural conservation and variation within the family of peroxidases.

xylose isomerases
metabolic engineering approaches to creating organisms capable of producing biofuels, such as ethanol, from previously unrecoverable plant biomass are being actively studied in the search for renewable energy sources  <cit> . xylose isomerase is a key enzyme in many engineered biosynthetic pathways because of its ability to interconvert sugar isomers, allowing novel carbohydrate sources, such as plant biomass, to be utilized over more traditional sugar substrates such as glucose  <cit> . while members of the peroxidase family demonstrate topological diversity, the family of xylose isomerases  are more topologically homogenous, and provide another clear example of scs that can be linked to the corresponding phylogenetic ontology of the structures.

applying fasst to the catalytic sites of  <dig> structures of xylose isomerase from  <dig> different species, including thermophilic archaea and several species of mesophilic bacteria, reveals that variation in catalytic site geometry within the family can be well-explained by the family-level phylogenetic ontology of the family. as shown in figure  <dig>  the closely-packed, but well-defined clusters of structures clearly map to the phylogenetic labeling at the family-level of taxonomic classification. while the xylose isomerase family exhibits high structural conservation, understanding the substructural relationship between related members of enzymatic families, capable of catalyzing the same reaction under different environmental conditions, is an important step towards rational design of biosynthetic pathways.

conformation-based clusters 
many proteins are known to undergo structural rearrangements and hinge-bending motions upon binding ligands or other proteins. induced fit via amino acid rearrangements are a common feature of many catalytic sites, and the state of the catalytic site at a given time can often be partitioned into two states: apo, an open confirmation with no ligand, and holo, a closed confirmation with bound ligand. the thermolysins  are a family of bacterial heat-stable metalloproteases that cleave peptide bonds at hydrophobic residue positions and have been shown to change confirmations upon ligand-binding  <cit> . the family of available thermolysins contains  <dig> structures of the protein from bacillus thermoproteolyticus and a single structure from both staphylococcus aureus and bacillus cereus, all of which are gram-positive bacteria species . because there are roughly equal numbers of apo  and holo  structures within the family, and all but two of the structures are repetitions of the same protein from the same species, the effect of ligation state on the substructural variation of the catalytic site can be analyzed in isolation from other possible contributing factors such as phylogenetic distance. applying fasst to the thermolysins results in the scs shown in figure  <dig> 

mapping ligation-state data to the scs reveals that the clusters determined can largely be explained by the presence/absence of a bound ligand. outliers revealed by fasst were further investigated to understand why they deviate from the remainder of structures sharing a ligation state. a closer examination of the seemingly misclassified structures reveals that not all ligands binding thermolysin induce conformational change in the binding site substructure ).

closer examination of the five holo outlier structures residing within the apo region reveals that either lysine or phenol is bound to the structurally rigid side-chain recognition pocket of these structures in all five cases. in figure  <dig>  the catalytic site of one of the five holo outliers , where a valine-lysine dipeptide is bound near, but not within the catalytic site, is compared to a holo structure with a ligand bound for catalysis in figure  <dig>  the ligand in figure  <dig> can be clearly seen to interact with the catalytic residues as well as the coordinated catalytic metal  but the ligand of  is bound just outside of the catalytic site. binding of the valine-lysine/phenol ligands to the side-chain recognition pocket of thermolysin in the five holo outliers does not induce the catalytic site to alter its geometry, explaining the presence of these holo outliers in the apo region of the plot in figure  <dig> 

further investigation into the two apo outlier structures, shown to reside in the holo region of figure  <dig>  reveals that these two proteins were artificially modified to coordinate co2+ and fe3+metals within their catalytic sites, instead of the normal zn2+ metal found in nature. the substitution of co2+ and fe3+ for zn2+alters the geometry of the catalytic site, effectively converting thermolysin into the "closed," ligand-bound holo state  <cit> . this fact explains why these two artificially substituted apo outliers have higher substructural similarity to the holo structures and are co-located with the holo structures in the scs shown in figure  <dig>  therefore, the conformational state of the binding site is a more complete explanation for the scs determined by fasst, which is highly correlated with, but not completely determined by, the presence/absence of a ligand.

while the presence/absence of a bound ligand is easily determined by examining a protein structure, fasst incorporates only knowledge of the binding site geometry in order to automatically identify each conformation state. as demonstrated by examination of the holo outliers, not all ligands were capable of inducing conformational change in the binding site of thermolysin. the effect of ligation-state within phylogenetic-based clusters was also analyzed for the heme-dependent peroxidases and xylose isomerases to ensure that ligation-state was not influencing the result; open/closed plot characters are used to denote apo/holo structures, respectively, in figures  <dig>   <dig>   <dig> and  <dig>  when multiple conformations exist within a family of structures, fasst is able to automatically identify the separate conformations as scs. the conformation-based scs can then be used as input to mesh to construct a multi-conformation motif ensemble for comparison to non-family structures.

homology-based clusters 
some protein substructures have proven themselves, throughout the course of evolution, to be so well-suited at catalyzing particular reactions, that they have arisen independently in different kingdoms of life. one such example of convergent evolution in protein substructures is the his-asp-ser catalytic triad which catalyzes the hydrolysis of peptide bonds in many serine proteases  <cit> . the his-asp-ser catalytic triad is a common substructure among many families of proteases and the geometry of the triad residues across protease families has been shown to be highly conserved  <cit> . to demonstrate the ability of fasst to detect substructure variation among non-divergently related families where the triad substructure resides in many configurations, including spanning peptide chains, we have considered all of the non-mutant protein structures from the families listed in table  <dig> in an analysis of the serine protease catalytic triad. the mutant-filtered family of serine protease structures included  <dig> protein structures spanning  <dig> ec classifications and  <dig> species; the total number of structures in the table is  <dig> of which  <dig> are mutant structures. the input motif consisted of the cα coordinates of the triad residues and was geometrically based upon the  chymotrypsin structure; this motif was able to accurately identify triad residues in all serine protease families, including cases where the triad residues span peptide chains. correct identification of triad residues for all propagated motifs was subsequently confirmed prior to applying fasst.

the chymotrypsin, trypsin, elastase, thrombin, and α-lytic protease families are all divergently evolved proteases of the "chymotrypsin clan"   <cit>  and share a common fold that differs from the convergently evolved subtilisin family of proteases. the triacylglycerol lipases have also convergently evolved the serine-based triad and form a third distinct evolutionary group  <cit> . application of fasst to the families of serine proteases, as shown in figure  <dig>  reveals that proteins of the chymotrypsin clan overwhelmingly cluster together with high degrees of overlap in the scs; the subtilisin structures form a distinct cluster outside of the chymotrypsin clan cluster. within the chymotrypsin clan, the different families of serine proteases show only subtle variations in triad geometry and are nearly inseparable from one another. it is evident from analysis of the scs shown in figure  <dig> that the lipases exhibit much more catalytic triad geometric variability, overall, than either the subtilisins or chymotrypsins, as they can be seen in many different regions of the space.

outlier structures within the scs output by fasst, labeled in figure  <dig>  were further investigated. one of the most extreme outliers in figure  <dig> corresponds to a pancreatic elastase structure  complexed with α- <dig> antitrypsin, and this complex was documented to introduce extensive distortion to the catalytic site  <cit> , well-explaining the distant position of this structure from other proteins in the scs. similarly, two trypsin outlier structures  denoted in figure  <dig> are complexed with a protein inhibitor that was documented to cause distortion of the catalytic site. two trypsin structures , crystallized with sub-atomic resolution, are also distant from the main chymotrypsin cluster in the scs  <cit> . apo and holo structures are denoted in figure  <dig> using open and closed plot characters, respectively, and both apo and holo structures can be found in each cluster identified. the single non-mutant tk-subtilisin structure, from the archaeon pyrococcus kodakaraensis, is found to be distant from both the chymotrypsin clan cluster and main subtilisin cluster, which suggests a mode of geometric variation different from that of prokaryotic subtilisins and chymotrypsin-like triads. application of fasst to the serine proteases clearly demonstrates the extremely high degree of both chemical and structural conservation of the catalytic triad across very diverse species and proteins with diverse ligand specificities. surprisingly, modeling only the triad cα positions, as was done here, is sufficient to recover the super-family organization of the serine proteases.

protein function prediction 
fasst provides a method to expose the underlying scs of a protein family and the mesh framework utilizes the scs to enhance the function prediction power of substructure motifs. instead of representing an entire protein family with a single motif, fasst-mesh uses an ensemble of motifs, where each motif within the ensemble is used to represent a cluster within the scs. mesh automatically constructs a representative consensus motif for each cluster of geometrically related family members output by fasst . collectively, the set of consensus motifs for all clusters composes a motif ensemble. earlier work investigated the performance of averaging all substructures within a family to identify a single family consensus motif  <cit> . however, it was found that for large geometrically diverse families, a single representative motif, based on any family member substructure or a substructure average of all members, could not sufficiently represent the entire family, just as building a single profile hmm for a large number of distantly related sequences can be difficult. transitioning to the multiple-model motif ensemble, however, requires that the statistics employed by mesh to distinguish statistically significant matches take into account the presence of multiple tests for significance, one test for each consensus motif in the ensemble .

fasst-mesh was used to construct motif ensembles for  <dig> families of enzymes , as defined by enzyme commission  number, and the performance of these motif ensembles was compared to single-structure motifs in a set of function prediction experiments . function prediction performance can be quantified by sensitivity, the percent of true positives  correctly identified ), and specificity, the percent of true negatives  correctly identified ). because the process of constructing a motif ensemble can be considered unsupervised learning of the family substructure space, 5-fold cross-validation was implemented, where the motif ensemble was built from 4/ <dig> of the data and then the last 1/ <dig> was used for performance assessment. the robustness of the scs identified during cross-fold validation  can be seen by the stability of the clusters during each of the  <dig> cross-fold validation steps. two ec families included in the function prediction experiments are discussed below, and each demonstrates a different extreme of sensitivity/specificity improvement after applying fasst-mesh.

for each single-structure motif, a motif ensemble was constructed using fasst-mesh. next to each % sensitivity value is the total number of true positive  matches; next to each % specificity value is the total number of false positive  matches. the performance of motif ensembles was assessed using 5-fold cross-validation and the sensitivity/specificity values correspond to mean ± standard deviation across the  <dig> folds. the x-fold improvement is calculated as: mean motif ensemble performance divided by single-structure performance.

the diverse family of β-lactamases  includes structures from  <dig> different bacterial species. using the  <dig> clusters identified from the scs output by fasst as shown in figure  <dig>  mesh constructs a consensus motif for each cluster, resulting in an ensemble of  <dig> consensus motifs. the β-lactamase motif ensemble, constructed by fasst-mesh, identified  <dig> % of functionally homologous proteins  with statistically significant substructure matches. the corresponding single-structure β-lactamase motif only identified  <dig> % of functional homologs, and therefore fasst-mesh improved the functional annotation sensitivity of the single-structure motif by  <dig> -fold while maintaining the high specificity of the single-structure motif.

in the family of peroxidases  analyzed in figure  <dig>  a single-structure motif was capable of identifying a statistically significant match for  <dig> % of the ec family, and therefore already showed high sensitivity. after applying fasst-mesh to the single-structure peroxidase motif, annotation sensitivity improved only slightly  but the absolute number of false positive matches identified decreased from  <dig> to  <dig> ±  <dig>  the decrease in false positive matches, resulting from use of a motif ensemble, occurred because true positive matches tended to match multiple consensus motifs within the ensemble with low lrmsd, while many false positive matches have only marginally significant lrmsd to a single consensus motif, and applying multiple testing correction to the final set of matches for a given false positive often caused a single marginally significant match to move outside of the significance threshold.

as both the number and diversity of available structures for a given protein family continue to increase, the enhancement of substructure-based function prediction methods to accommodate large families is necessary. this work demonstrates an automated approach  that could be used to augment existing substructure motifs already available in repositories such as the catalytic site atlas   <cit>  by geometrically enriching motifs for families that exhibit high structural variability. the automated enrichment of available motifs by fasst-mesh strengthens the function prediction power of these motifs and facilitates the use of substructure-based analysis methods for large-scale, automated annotation of novel structures.

comparison with sequence and whole structure approaches
similarity among proteins belonging to an enzymatic family can be difficult to detect using sequence and whole structure approaches when such families are sequentially and topologically diverse. the heme-dependent peroxidase and xylose isomerase families differ greatly in the amount of family-wide fold and sequence similarity. to assess the ability of sequence and whole structure  analysis to identify the structures in each family as interrelated, each family was combined with a set of  <dig> functionally unrelated structures randomly selected from the nrpdb <dig>  additionally, each family was combined with all structures sharing the same scop  <cit>  superfamily classification in a separate experiment from the random nrpdb <dig> structures. the heme-dependent peroxidases were combined with all structures within the heme-dependent peroxidase superfamily  which includes structures from ec: <dig> . <dig>  , ec: <dig> . <dig>  , ec: <dig> . <dig>  , and ec: <dig> . <dig>  . the xylose isomerases were combined with all structures from the xylose isomerase-like superfamily  which includes structures from ec: <dig> . <dig>   and ec: <dig> . <dig>  . comparing the inter-cluster distance of clusters belonging to a family relative to the distances to functionally unrelated structures illustrates the amount of intra-family similarity that is evident when using each approach.

the sequence and structure comparisons were implemented by using clustalw  <cit>  and combinatorial extension   <cit> , respectively, to compute the pairwise distances between proteins instead of labelhash ); all remaining steps of fasst were carried out identically for each approach ). the non-substructure methods will be referred to as fasstclustalw and fasstce hereafter, while fasst will refer only to the substructure-based approach.

the results of fasst applied to the heme-dependent peroxidase and xylose isomerase families, each in combination with the functionally unrelated structures, are shown in additional files  <dig> and  <dig>  respectively. in both cases, the substructure-level analysis implemented by fasst identifies the within-family structures to be highly similar to one another  relative to the functionally unrelated structures. these results demonstrate that functionally unrelated structures can be clearly identified as outliers from the remainder of structures in a family analyzed by fasst.

applying fasstclustalw and fasstce to the heme-dependent peroxidases  results in multiple clusters of peroxidases and a single, more scattered cluster consisting of unrelated structures. in contrast to the fasst result , the individual peroxidase clusters identified by fasstclustalw and fasstce are as distant from one another as to the functionally unrelated cluster. using fasstclustalw and fasstce to analyze the xylose isomerases  results in the within-family structures grouping into multiple clusters well-separated from the functionally unrelated structures; the thermophile xylose isomerase structures are roughly equidistant to the functionally unrelated structures and the remainder of the family.

the average running times of fasst were  <dig>  min ,  <dig>  min , and  <dig>  min ; times reported are the wall-clock times for running with a single core on the following system:  <dig>  ghz intel core  <dig> duo, 4gb ddr <dig> memory, macbook pro.

the comparison of fasst with fasstclustalw and fasstce demonstrates that intra-family similarity may be more difficult to detect by sequence and fold comparison in some cases. the substructure-level analysis used by fasst can further distinguish functionally related and unrelated structures when conserved substructures can be identified. therefore, fasst provides a complementary approach that can be used in combination with sequence and fold analysis for analyzing the diversity of functionally related enzymes.

discussion
understanding the significant geometric variability among enzyme catalytic sites is an important component of structural analysis. as the number of solved protein structures grows, methods capable of summarizing and analyzing large amounts of structural data will become increasingly necessary. while whole structure alignment and protein fold analysis can be a valuable tool for assessing protein homology, in the absence of sequence similarity, extremely distantly related enzymes or enzymes which are examples of convergent evolution may be ill-suited to whole structure comparison techniques. however, when no detectable domain or fold homology exists, enzymes are still capable of exhibiting functional equivalence through chemically and geometrically synonymous functional substructures. techniques capable of assessing the family-wise similarity of these conserved substructures can reveal new insights into the relationships among families of structures. fasst has the ability to recognize modes of family-wise geometric variation among substructures and knowledge of the substructural diversity of a family can guide hypotheses about the role of the substructure in different proteins.

biological significance of scs
in several families of proteins, we have identified possible sources of geometric variation and linked these sources of variation to the substructural clusters automatically identified by fasst. in the peroxidase family, the geometric distance between catalytic sites appears to be correlated with phylogenetic distance. organisms that are more closely related, such as the plant and fungal species, were shown to have more geometrically similar catalytic sites to one another than to more distantly related phyla, such as vertebrates. with the family of thermolysin structures, we demonstrated how fasst automatically captures modes of catalytic site flexibility, correctly segregating structures into clusters based upon ligation state. using the families of serine proteases, we demonstrated how fasst extends naturally to very large numbers of structures and is still capable of identifying the major modes of geometric variation across vast numbers of species and triad configurations that include chain spanning and non-spanning instances. finally, fasst is able to identify structural outliers within families, and these outliers were shown to have biochemical causes for substructural deviation from the remainder of the family, thereby guiding further inquiry to these anomalous structures.

fasst partitions a protein family into self-similar clusters of structures and in doing so, constructs scs that can then be linked with biological metadata to possibly explain the family-wise diversity. here we have highlighted particular protein families whose substructural diversity can be clearly linked to a single biological ontology, such as phylogeny, conformation, or homology. in several families included in the function prediction experiments, the sub-groups identified by fasst cannot be clearly attributed to a single biological factor. the β-lactamases are an example where some clusters clearly correspond to a single phylogenetic branch of bacteria, but other species of bacteria form multiple, distinct clusters as shown in figure  <dig>  in the typical case, there are likely multiple biological factors working in concert to produce substructural variability. it is intriguing to combine large-scale metadata analysis with fasst to automatically correlate likely biological factors, such as phylogeny, ligation state, and crystallization conditions, with fasst-identified clusters to unravel more complex relationships among functional substructures.

diffierentiating sequential and structural redundancy
using fasst to analyze a catalytic site substructure of thermolysin among  <dig> sequence-similar proteins demonstrates how latent biological trends can be identified even within a sequentially-homogenous collection of structures. the thermolysin family examined here contained  <dig> different structures of the exact same enzyme from b. thermoproteolyticus and yet fasst was able to automatically uncover a structural trend where the catalytic substructure modified its position only upon binding ligands that interact directly with the coordinated zinc ion. if only sequentially non-redundant structures were used by fasst, this trend could not have been identified because of the miniscule number of sequentially-distinct crystallographic structures for thermolysin. this result demonstrates the additional information that can be garnered by researchers when all available structures are incorporated into a structural analysis. similarly, the multiple solvent crystal structures  technique utilizes repeated crystallizations of the same enzyme under different solvent conditions in order to probe for functional sites  <cit> . several of the available thermolysin structures incorporated in our study were produced as part of mscs experiments  <cit> . our work demonstrates that fasst can detect subtle trends among sequentially-similar structure collections and is an important tool for analyzing and understanding structure-function relationships across large numbers of protein structures.

fasst-mesh improves single-structure motifs
after identifying both the existence and membership of structurally defined clusters within a protein family via the automated fasst-mesh framework, this substructural information can be used to enhance existing substructural motifs in order to more accurately represent large families with diverse catalytic site geometry. our function prediction experiments show that by representing a structurally diverse family with a motif ensemble, we can better capture the variety of substructures present within a given family and increase function prediction sensitivity while maintaining specificity. in cases where family-wide geometric diversity was found to be low, single structure motifs alone can have high sensitivity. however, even when geometric variability is low, motif ensembles created by fasst-mesh always maintain the function prediction performance of single structure motifs and demonstrate vast improvement in several cases among the families included in our study . while labelhash was used here as the underlying substructure comparison tool, we are not attempting to compare the performance of labelhash to other comparison tools. rather, the purpose of the function prediction experiments presented here is to illustrate cases where a single-structure motif insufficiently models a large class of functionally homologous, but structurally diverse proteins, and to demonstrate a method to improve the function prediction sensitivity of motifs in general by using motif ensembles.

automated motif definition
in this paper, the substructure motifs given as input to fasst  were constructed only from residues that have been experimentally confirmed to play a role in enzyme function in order to separate the subproblem of motif definition from motif analysis. while the input single-structure motifs used here were manually defined, a multitude of automated approaches to motif definition are possible. our previous work successfully used evolutionarily conserved residues, as determined by evolutionary trace  <cit> , for automated motif definition  <cit> .

because motifs are an input parameter to fasst, different methods of identifying the residues constituting functional substructures can be used in conjunction with fasst, and by doing so, fasst provides an automated approach to further analyze and understand the role of these substructures. in future work, several substructure selection methods and databases, such as castp, et  <cit> , consurf  <cit> , csa  <cit> , snap  <cit> , and ligbase  <cit> , will be used as sources for large numbers of motifs. this work used only residues deemed to be functionally important by experimentalists, as defined by literature references, in order to isolate the performance of fasst-mesh from methods that automate substructure selection.

CONCLUSIONS
fasst has been shown to be a powerful technique for assessing family-wise structural variability among analogous protein substructures. we have demonstrated examples of substructural clusters that can be linked to phylogenetic distance, ligation state, and protein homology. the complementary mesh framework provides a systematic approach to create concise motif ensembles that represent the structural variability within a protein family. such ensembles can be used to improve function prediction for families with significant structural variability.

many proteins are known to have structurally conserved, but non-catalytic substructures, such as steric recognition sites, metal/ligand sequestering sites, phosphorylation sites, cofactor binding sites, or immunologically important substructural epitopes. using the fasst-mesh approach for these non-catalytic substructures can be done without modification to the method because fasst-mesh makes no assumptions about the types of substructures modeled by motifs nor underlying sources of structural variation. our future, application-specific work will focus on understanding particular structure-function relationships among both catalytic and non-catalytic substructures. as the available number of protein structures continues to rapidly grow, methods for automated, large-scale analysis of structures such as fasst-mesh will be critical for identifying high-level structural trends among proteins and placing newly solved structures in the larger context of existing structural data.

