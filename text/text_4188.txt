BACKGROUND
the research in protein biomarkers discovery is one of the fundamental topics in clinical proteomics in order to possibly improve both diagnosis and prognosis of a wide variety of disease states  <cit> . mass spectrometry has proved to be the most promising tool in the perspective of biomarker identification  <cit> : it allows measuring the mass of ionized molecules, hence making it possible to analyze proteins in small concentrations and in a short time. in particular, excellent resolution and good mass accuracy combined with high sample throughput can be achieved with matrix-assisted laser desorption/ionization time-of-flight  mass spectrometry  <cit> . the maldi-tof device produces signals that correspond to the different flight times of the analyzed proteins, which are ionized by means of a high energy laser beam and accelerated with an electric field: the ions, detected at the end of the tube, can be separated on the basis of their mass/charge ratio . the acquired spectra always present complex features, because the protein signals, characterized by "true" peaks in the mass spectrum, can be contaminated by several chemical and/or physical processes of the measurement procedure  <cit> . two different kinds of disturbance can be revealed in the spectra: baseline drift and background noise. the baseline is the trend of the signal that would be generated by the mass spectrometer if no material was introduced into it. the background noise is a signal produced by electronic disturbances and fragments of material, with rapid fluctuations randomly varying over small mass ranges. as a consequence, a very sensitive and accurate peak-detection method, able to correctly separate "true" protein peaks from noise, is required  <cit> . several methods using analytical rules, template matching and wavelet techniques have been proposed in the literature  <cit> . however, the problem of the detection of noise peaks as signals still remains a critical issue  <cit> .

in this work, we propose a computational method for the detection of protein peaks from multiple maldi-tof-ms data, named limpic . its major improvement is a new procedure for decomposing a maldi-tof mass spectrum into signal, baseline and noise. subsequently, limpic estimates an non-uniform residual noise level from processed spectra, and it detects protein signals by finding peaks that have significantly high signal-to-noise ratio. the peak lists generated from the single spectra are then compared, and a classification between molecular signal peaks and noise is performed on the basis of a detection rate parameter. in-vitro purified protein samples and human plasma samples were used for the validation of limpic: in both conditions, the proposed method showed a significant accuracy in the detection of the protein signals, and it was able to provide a superior sensitivity and specificity than two well-established commercial algorithms, apex and centroid, and a freely available algorithm, cromwell.

RESULTS
the limpic method was developed for the detection of consistent protein peaks, starting from a set of calibrated mass spectra. it was implemented in matlab, and is provided as additional file  <dig>  a schematic overview of its processing and analysis steps is given in figure  <dig>  each mass spectrum is preprocessed with smoothing and baseline removal. the smoothing is performed by means of a kaiser digital filter working with a moving window  <cit> ; the baseline removal is accomplished with the subtraction of a signal trend, estimated after the elimination of the most significant peaks in the mass spectrum. the detection of protein peaks in the single spectra is performed by finding all the local maxima, and eliminating those with intensity lower than a non-uniform threshold, proportional to the noise level  <cit> . the peaks detected for the single spectra are clustered on the basis of their m/z position, and then classified as protein or noise peaks on the basis of their consistency across the spectra  <cit> .

the validation of the proposed method for the separation of maldi-tof-ms signals from noise regarded two aspects: the effectiveness of signal processing and the detection of reliable protein peaks. for this purpose, we used mass spectra from in-vitro purified protein mixtures for testing limpic under controlled conditions, and human plasma samples for validating it in the perspective of clinical applications. the two sets of maldi-tof mass spectra are respectively provided as additional files  <dig> and  <dig>  in this study, we also compared the outcomes of limpic with those of two commercial algorithms, apex and centroid   <cit> , and of a recently released freeware algorithm, cromwell, created by the texas university bioinformatics group  <cit> .

an example of maldi-tof data from plasma samples, noticeably contaminated by baseline drift and background noise, is illustrated in figure  <dig>  with regard to spectrum denoising, we analyzed the performances of kaiser filter with different window lengths, in order to find the general criteria for setting this parameter. in fact, small window lengths might result in an insufficient denoising, whereas large ones might distort the "true" signal. as shown in figure  <dig>  we explored  <dig> different parameter settings, with window length ranging between  <dig> and  <dig> data points. analyzing the subtracted noise, we found that its amplitude increased with the window length; however, we observed that the smoothing using the two larger window lengths produced signal distortions, evidenced by a peaked signal distribution exactly where peaks occurred in the mass spectrum. consequently, we decided to set this parameter equal to  <dig>  thus covering a range of  <dig> da in the mass spectrum. the performances of kaiser filter in terms of data smoothing were compared with those of savitzky-golay filter  <cit> , the solution generally adopted in flexanalysis with apex and centroid, and wavelet filter  <cit> , the smoothing technique used in cromwell. for savitzky-golay filter, that is also based on a moving window, we used the same window length as for kaiser filter, whereas for wavelet filter we adopted the parameters suggested by the cromwell research group. as illustrated in figure  <dig>  wavelet filter provides very different outcomes with respect to the two moving-window filters: it was minimally influenced by the presence of peaks in the mass spectrum, but it did not seem to properly reconstruct noise structure at the high end of the studied mass range. we measured the similarity of the noise structures with respect to gaussian noise by means of two statistical parameters: skewness and kurtosis. surprisingly, wavelet filters presented a significant value of skewness, that is related to the presence of an asymmetrical noise distribution. conversely, savitzky-golay and kaiser filters showed noise structures consistent with respect to the mass spectrum, and more similar to gaussian noise, with relatively low values of skewness and kurtosis.

with regard to baseline removal, we compared the peak-elimination method used in limpic with the classical method based on minimum value interpolation  <cit> , used by apex, centroid and cromwell. the two estimates of the baseline drift are superimposed in figure  <dig>  the most evident difference is that the limpic baseline can locally increase, for example when large and overlapping peaks are present in the spectrum.

a qualitative comparison referring to the mass spectrum shown in figure  <dig>  before and after smoothing and baseline subtraction, is provided in figure  <dig> for limpic, apex, centroid and cromwell processing. furthermore, the reliability of intensity reconstruction was assessed using mass spectra acquired from in-vitro purified protein mixtures of equine myoglobin and cytochrome c. this analysis was carried out at  <dig> different concentrations of cytochrome c, ranging between  <dig>  and  <dig> fmol. for each concentration, the coefficient of variation was calculated on  <dig> replicate spectra for the peak corresponding to the single-protonated molecular ion of cytochrome c . limpic processing provided results that were comparable to apex, centroid and cromwell above  <dig> fmol, whereas it allowed a more reliable estimate of signal intensity at lower protein concentrations.

limpic, apex, centroid and cromwell preprocessing methods were evaluated from in-vitro protein spectra at different dilutions of cytochrome c. for each method, the average peak intensity, the standard deviation and the coefficient of variation are provided. the underlined values were manually obtained from the mass spectra, because the peak-picking algorithms did not allow to detect the peak.

in particular, cromwell produced null intensity for the cytochrome c peak at  <dig>  fmol, including it in the subtracted noise, and apex and centroid showed a coefficient of variation equal to 24%, which might be ascribed to a residual noise level comparable to the peak intensity. in this case, the coefficient of variation after limpic processing was equal to 8%.

using the same in-vitro protein mass spectra, the peak detection sensitivity of limpic was compared with that of apex, centroid and cromwell. the latter does not need parameter tuning; conversely, a number of input parameters are required by the two commercial algorithms. therefore, we adopted the typical parameters used in our lab: snr =  <dig> and peak width  <dig>  da for apex; snr =  <dig>  peak width  <dig>  da and percent height 80% for centroid. in order to have comparable results, the peaks detected with the commercial algorithms and with cromwell from the replicate spectra were clustered as for limpic. we also classified the peaks on the basis of a parameter named peak detection rate , expressed by the ratio between the number of spectra containing the considered peak and the total number of analyzed spectra. as shown in detail in table  <dig>  only limpic was capable to reveal the cytochrome c peak in case of low protein concentration regimes , when ionic competition processes in the mass spectra produced a loss of linearity between the protein abundance and the related peak intensity. the comparative results of the peak-picking algorithms for all peaks are summarized in table  <dig>  the correct identification of the protein peaks was generally accomplished with limpic for all the acquired signals, with no false negatives and only one false positive among the  <dig> detected peaks. on the other hand, a large number of incorrect peaks was produced by apex, centroid and cromwell. these results were confirmed by those obtained with plasma spectra, for which an example of the peaks detected by the four methods from a single spectrum is provided in figure  <dig>  when comparing the peaks from the single spectrum with those obtained from the other plasma spectra, we found that only a part of them is consistent. in figure  <dig> we provide an example of the limpic classification, performed for the same peaks shown in figure  <dig>  using a minimum pdr equal to  <dig> .

limpic, apex, centroid and cromwell methods were assessed from in-vitro protein spectra at different cytochrome c dilutions, with respect to the number of detected peak classes, false negatives and false positives. only the peak classes that could be found across replicate spectra with a peak detection rate  larger than  <dig>  were considered for the analysis.

analytical results about peak masses and peak intensities for the group of plasma samples are summarized in a spreadsheet, which has been provided as additional file  <dig>  we grouped the  <dig> peaks detected among all the maldi-tof-ms signals into  <dig> peak classes. this allowed selecting the most reliable peaks, because only the ones that are robustly found across spectra were retained. using a minimum pdr equal to  <dig> ,  <dig> out of the  <dig> peak classes were selected . in order to determine whether the selected peaks could be used for quantitative studies, the snr values were analyzed. in particular, the condition snr >  <dig> was fulfilled for all the  <dig> peaks, as illustrated in figure  <dig> 

using the selection criterion based on the pdr value, it was also possible to measure the hit-rate, defined as the ratio between the number of "true" peak classes and the average number of the peaks revealed in the single spectra: the larger this ratio the better the performances of the peak-picking method. according to this parameter, a larger number of consistent peaks were generally detected with limpic, confirming the superior reliability of this method for mass spectra from both protein mixtures and plasma samples .

limpic, apex, centroid and cromwell methods were assessed with respect to the groups of mass spectra obtained from the in-vitro purified protein samples and human plasma samples, respectively. the performances were measured on the basis of a hit-rate parameter; the latter was obtained as a ratio between the number of peak classes, selected on the basis of a pdr larger than  <dig> , and the average number of detected peaks.

moreover, with regard to the classification of peaks from plasma mass spectra, we analyzed the pdr distribution, in order to obtain valuable information regarding the method sensitivity in the separation of protein and noise peaks. as it was impossible to accurately define the presence of a defined set of protein peaks, the detected peaks were compared with a given list of  <dig> peaks that correspond to proteins classified in the human plasma proteome project  database  <cit>  which can be revealed by maldi-tof mass spectrometry in the m/z range 5– <dig> kda  <cit> . the complete list of the proteins considered for this analysis can be found in additional file  <dig>  a roc curve was calculated for limpic, apex, centroid and cromwell, varying the minimum pdr used for the peak classification . the results demonstrated that a larger accuracy can be achieved with limpic; in particular, no false positives were obtained by setting minimum pdr to  <dig> , whereas the best performances in terms of sensitivity and specificity were attained by setting minimum pdr to  <dig> .

discussion
we presented a reliable automated tool for signal denoising and peak detection in maldi-tof-ms data. in contrast to many established approaches to this problem  <cit> , the proposed method was particularly designed to work properly even on very low intensity peaks. limpic processing reduced the disturbances that partially hid the true signal in the mass spectrum. in particular, the smoothing algorithm permitted the reduction of the background noise without any noticeable distortion of the true signal, and it seemed to be more effective than savitzky-golay and wavelet filters with maldi-tof-ms data. moreover, the limpic baseline correction was able to work with all kinds of spectra, even with those characterized by a non-increasing baseline drift, for which the standard method based on fitting a monotone minimum curve might be unsuccessful  <cit> . in addition, the coefficient of variation obtained with limpic with in-vitro protein mixtures at low concentrations proved the efficacy of the preprocessing steps, and also the reliability of the quantitative information that could be extracted from single peaks. according to the method proposed by yasui  <cit> , the positions of the peaks in the mass spectrum were determined on the basis of the first derivative of the signal, whereas other techniques based on template matching were considered unreliable, because the presence of residual noise could corrupt the ideal peak shape and could determine incorrect outcomes  <cit> .

given the significant consistency of noise level across spectra, also after preprocessing, an alternative technique for the reduction of false peak discovery was proposed in the literature  <cit> . it is not based on data smoothing, but on the determination of a proper non-uniform threshold, in order to exclude intensities associated with the noise. the noise level is calculated by means of the local standard deviation, considering data points with intensity below the 90th percentile. as a result, this approach might be inappropriate in case of spectra with a high number of large-intensity peaks. also our method takes into account the presence of an uneven noise level, but in our opinion it is suitable for a broader variety of mass spectra: it estimates a non-uniform noise threshold on the basis of the waveform properties, without making any assumptions on the signal intensities.

although the iupac guidelines suggest the use of the condition s > 10σ to extract quantitative information on signal intensity  <cit> , we found that the limpic configuration with s > 3σ still yields good performances, allowing an accurate identification of weak peaks. however, in light of the findings of other research groups using different methods, it is clear that the number of peaks detected in the single spectrum is not, by itself, a sufficient measure of the peak-picking effectiveness  <cit> . since we matched the results obtained from replicate spectra, we could also appraise the amount of peaks that, after the comparison, were likely to be classified as noise peaks  <cit> . the pdr analysis was aimed at obtaining an optimal separation between protein signals from noise. in particular, the optimal cut-off value had to be properly chosen, depending on the specific application: the selection of a large value  increased the reliability of the selected peaks, but simultaneously reduced the amount of information that can be used for subsequent analyses. when a relatively small value is chosen , the probability of selecting "noise" peaks can be reduced by also setting a threshold for the minimum acceptable snr. nonetheless, the selection of peaks with snr >  <dig> allows, in the perspective of biomarker discovery, to categorize the ones for which the associated intensity values can be used for statistical tests.

although the number of the detected peaks was generally smaller for limpic than for the commercial algorithms apex and centroid, and for the freeware algorithm cromwell, the larger hit-rates of the proposed method demonstrated that a more reliable selection of real protein signals can be accomplished. therefore, the roc curves calculated for the four methods reveal that a superior sensitivity and specificity can be obtained with limpic, particularly when a low cut-off value was used for the pdr.

CONCLUSIONS
the discovery of protein profiles that can be ascribed to each pathologic state and the classification of individual proteins that compose them are key steps in the direction of an early disease detection. the proposed method was intended for the reliable detection of protein peaks using average mass signals such as the one collected from linear maldi-tof-ms instruments. in this case, data processing is particularly difficult, because weak protein signals, represented by the "true" peaks in the acquired spectra, are generally hidden by two disturbances: baseline drift and background noise. we developed a novel technique for mass spectrometric data denoising, and we showed that the processed spectra can be jointly used for peak detection with high reliability and accuracy. the limpic method was properly designed in order to work correctly also in case of very weak peaks. moreover, the entire processing procedures and algorithms can be modified and tailored to the data produced by different acquisition systems, allowing for a complete control, which is rarely possible in commercial software solutions. with the recent improvements in the maldi-tof technology, the detection of protein peaks with a low coefficient of variation across measurements is becoming feasible; as a consequence, the quantitative information on the peak intensity extracted with our method could be used for the recognition of significant protein profiles by means of advanced statistic tools. we hope that the analytic strategy presented here using mass spectrometric data will support further advances for the discovery of novel disease-state biomarkers.

