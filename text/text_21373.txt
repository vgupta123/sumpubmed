BACKGROUND
asian cultivated rice  has phenotypically divergent ecotypes  <cit> . irrigated and upland rice, respectively adapted to growing in paddy fields and rain-fed dry lands, are two main ecotypes that are generally considered to show apparent phenotypic differentiation. the upland type is more drought tolerant, taller, of lower tillering potential, more resistant to blast, and tends to have longer and thicker roots than its irrigated counterpart  <cit> . accordingly, upland varieties are widely adopted in upland areas to optimize crop yields because of their more efficient water usage and adaptation to dry land. though the yield of upland rice is comparatively lower than the irrigated rice, it provides the daily staple food on which nearly one hundred million people depends  <cit> . because we are now facing global population expansion and a growing shortage of water resources, upland rice and especially knowledge about its genetic mechanisms for dry land adaptation become more important as they allow the possibility of transforming or modifying high-yield irrigated varieties of rice to upland ones.

drought resistance is an important component of rice adaption to most rainfed upland areas because in this ecosystem water could not be well preserved and frequent or sporadic drought events could occur each year  <cit> . previous research proposed three different mechanisms for plant drought resistance: drought escape, dehydration avoidance, and dehydration tolerance  <cit> . through drought escape, timing of plant lifecycle is modulated to escape the time of drought when drought time is predictable in each year. dehydration avoidance refers to the case that plants constitutively avoid excess loss of water through more developed root systems or a thick layer of cutin  <cit> . dehydration tolerance refers to the inducible mechanisms, like osmotic adjustment, which help plants to prevent damage and survive when excess loss of water does happen  <cit> . for the frequent and unpredictable drought stress in upland areas, the dehydration avoidance and dehydration tolerance should be the appropriate options for upland crops. in fact, upland rice seems to depend more on the constitutive dehydration avoidance than the inducible dehydration tolerance in its adaptation  <cit> . by far, some genes have been reported to be related with drought resistance <cit> , such as genes in abscisic acid  synthetic pathway   <cit> , transcription factors interacting with the cis-acting dehydration response element   <cit> , genes synthesizing osmoprotectants  <cit> , and mitogen-activated protein kinase  genes  <cit> . however, these studies focused on single gene’s effect, while adaptation to dry land may involve many genes in the genome. furthermore, the valuable genetic resources within upland rice, which were ignored by most previous studies, are also worthy of enhanced utilization.

upland and irrigated rice evolve their respective characteristic traits under both natural and artificial selections, which lead to phenotypic adaptation to respective environment and simultaneously genetic differentiation between ecotypes. some statistical tools for identifying selected regions during population differentiation have been well established. fixation index  is a commonly used statistics that measure population differentiation based on genetic polymorphism data. fst is positively associated with allele frequency difference. cross-population composite likelihood ratio test , a newly invented approach, incorporates not only genetic differentiation but also allele frequency spectrum information  <cit> . by jointly modeling multilocus allele frequency differentiation and frequency spectrum under neutrality and selection, xp-clr was demonstrated to have high power in detecting selective sweeps during population differentiation. besides, nielsen’s clr, a parametric test also based on composite likelihood ratio, detects selective sweeps using the spatial distribution of site frequency spectrum  <cit> . this approach only uses snp data of one population and thus detects selective sweeps in single population without consideration of population differentiation.

to investigate the genetic mechanisms for upland adaptation and identify genes for its important component, ‘drought resistance’, we use our whole-genome re-sequencing data for a large panel of accessions, including  <dig> upland accessions and  <dig> irrigated accessions reported by our previous work  <cit>  , where these data were used to test that a low-diversity region containing a key enzyme gene of abscisic acid synthesis was due to human selection. considering the wide distribution of upland rice in the world, we obtained our samples from asia, africa and south america, covering most major distribution areas of upland rice. we explored phylogenetic relationship between upland and irrigated ecotypes and population structure of current upland rice population. more importantly, by detecting selective sweep regions using fst and xp-clr, we compiled a list of candidate genes that are likely responsible for upland adaptation or that are related to phenotypic differentiation between the upland and irrigated ecotypes, providing valuable insights about crop breeding for dry land.

RESULTS
phenotypes of the upland accessions differ from those of the irrigated ones
for the  <dig> globally sampled and representative upland rice accessions , we want to confirm whether they possess the reported phenotypes that distinguish them from irrigated rice  <cit> . therefore we grew the varieties to do phenotyping . our examination focused on four non-yield phenotypes that are reported to be differentiated between upland and irrigated rice: root weight, maximal main root length, tiller number, and plant height. moreover, we also examined four yield traits, including thousand grain  weight, number of productive panicles, number of filled grain per panicle and number of empty grain per panicle. under both well-watering and dry land  environments, the upland accessions consistently showed significantly taller plant architecture, fewer tillers, longer main roots and heavier root weights, which supports the previously reported phenotypic differences . regarding the yield traits, under both environments upland accessions show larger 1000-grain weight and less productive panicles as compared to irrigated accessions . the numbers of filled and empty grain per panicle show no significant differences between the two ecotypes under the irrigated condition. however, under the rainfed upland condition, the upland accessions perform much better, i.e. have significantly more filled grain  and less empty grain  per panicle than the irrigated accessions.

*phenotypic value is indicated by mean value ± standard deviation.

#the difference is positive when the phenotypic value in the upland environment is larger than in the irrigated environment, otherwise the difference is negative.

@the number of productive panicles were measured at the stage of maturity, while tiller number was assessed before the earing period. since different accessions have different heading dates, some accessions produce more tillers after we measured the tiller numbers. so the final mean numbers of productive panicles were larger than the mean tiller numbers in the irrigated condition.

∆ in the upland environment, most of the accessions have less than two tillers. when we phenotyped the number of productive panicles, we found almost all the tillers develop productive panicles, i.e. the percentage of earbearing tiller is close to 100% in the rainfed upland condition. so here in the upland environment, tiller numbers and productive panicle numbers share the same values. the tillering ability is weak in our upland condition, and no more tillers were produced at the stage of maturity.

we focus on four non-yield phenotypes in this study, including plant height, tillering number, root weight and maximal main root length, and four yield phenotypes, including thousand grain weight, number of productive panicles, number of filled grain per panicle and number of empty grain per panicle. these phenotypic data were collected under both irrigated and upland environments.

using software spss statistics  <dig> , we calculated the pearson correlation coefficients  between each of the four non-yield traits and each of the yield traits under upland condition . the plant height is significantly associated with the 1000-grain weight , the number of empty grain per panicle  and the number of productive panicles . the tiller number is significantly associated with the number of productive panicles  and the 1000-grain weight . the root weight is significantly associated with the number of filled grain per panicle . the maximal root length is significantly associated with the thousand grain weight  and the number of empty grain per panicle . therefore all of the four non-yield traits are significantly associated with yield traits under rainfed upland condition. from the ρ values it could be speculated that larger root weight and greater root length of upland rice would contribute to net yield increase under upland condition probably because better developed root systems could contribute to better dehydration avoidance. however, the effects of plant height and tiller number on yield are complex. the larger plant height of upland accessions would possibly cause the reduction of productive panicles, but can increase 1000-grain weight and reduce the number of empty grain. the less tiller numbers of upland accessions can cause reduction of productive panicles, but would increase 1000-grain weight.

when comparing these phenotypes between the two culture conditions, we found that dry land environment can slightly reduce plant height and 1000-grain weight, but will dramatically decrease the tiller number, root weight, number of productive panicles and number of filled grain per panicle of both the upland and the irrigated ecotypes. however, the main root length and the number of empty grain per panicle responded differently to the different environments between the two ecotypes. we observed a minor decrease  of main root length of irrigated rice but a significant increase  of upland rice root length in dry land as compared with that in the irrigated condition , indicating an adaptive feature of upland rice. specifically,  <dig> percent of the upland accessions showed increase of root length in the upland condition, while only about  <dig> percent of the irrigated accessions showed root length increase in the upland condition. moreover, for the number of empty grain per panicle, we observed a slight and nonsignificant reduction of it for the irrigated accessions in the upland condition  but a dramatic decrease of it for the upland accessions , suggesting another adaptive trait of upland rice. based on the phenotypic differentiation between the upland and irrigated accessions and the correlations between the non-yield phenotypes and yield phenotypes in the upland condition, we define ‘upland adaptation’ in this study as the characteristic non-yield phenotypes of upland rice that are associated with the yield performance in upland conditions, such as plant height, tiller number, root weight and maximal root length which are directly associated with drought resistance.

snps calling and annotation for the  <dig> accessions
for the  <dig> irrigated and  <dig> upland accessions, we obtained  <dig> , <dig> pair-end reads that passed the reads pass filter, amounting to around 8 g base pairs . the re-sequencing data for  <dig> upland and  <dig> irrigated accessions was reported in our previous work  <cit> . here we comprehensively analyze these re-sequencing data to determine the genetic components that might have caused the upland adaptation and phenotypic differentiation between the two ecotypes, which has been a long-term open question in rice study.

about  <dig> percent of these reads could be aligned to the reference genome  using soap- <dig>  software  <cit> . the average mapping ratios of reads for the type indica and type japonica are 81% and 92%, respectively. on average,  <dig> % of the reference genome was covered for each accession . the mean depth for each accession was about  <dig>  × on average  . in total, the genome coverage of the upland and irrigated population reached 41 × and  <dig> ×, respectively. after snp calling and a series of filtering for quality control ,  <dig> , <dig> high-quality snps were identified , of which  <dig> , <dig> are non-singleton snps. by randomly choosing  <dig> snps and genotyping them via sanger sequencing, we were able to validate our snp calling accuracy at  <dig> %. the sequencing data, though relatively low in depth, are enough to well satisfy our analyses, as we shall discuss below.

in the following analyses, only  <dig> , <dig> snps with genotype data covering more than  <dig> individuals in both populations were used. we annotated these snps by classifying them into different categories according to the genomic context . the non-synonymous-to-synonymous ratio of snps is  <dig> , consistent with the previously reported ratio of  <dig>  in rice  <cit> . snps causing radical mutations, such as premature stop codons or frame disruptions, were also identified .

phylogenetics and population genetics analysis for upland rice
snp genotypes were used in phylogenetic analysis for the  <dig> accessions. additionally,  <dig> wild accessions from our previous data  were added to help address the phylogenetics of upland accessions  <cit> . we constructed the accessions’ phylogenetic tree using a neighbor-joining approach with  <dig> bootstraps . consistent with some of the previous reports  <cit> , our results support that indica and japonica usually considered as two subspecies are very different groups, as they largely clustered in respective group and both have closely related wild accessions . the results also show that probably the majority of current upland accessions belong to the type japonica  , consistent with the classification of the collection center based on traditional phenotypic characteristics and previous reports that upland rice mainly pertains to japonica  <cit> . the phylogenetic tree showed that all the upland japonica accessions cluster together, suggesting that upland japonica likely have a single origin. however, for the type indica, the scattering pattern of upland indica indicates that upland indica accessions may have been separately bred multiple times using different irrigated rice as the basic genetic materials.

population structure in upland rice and admixture in upland indica
we use  <dig>  snps with genotype data covering more than  <dig> accessions to analyze the population structure within our samples . principle component analysis  summarizes the population structure for the entire population . the top four principle components explain about 65% of the genetic variation. the huge differentiation on principle component  <dig> distinguishes indica from japonica. by contrast, genetic differentiations between upland and irrigated ecotypes seem to be much lower. the fst value for the two ecotypes calculated based on genome-wide snps is only  <dig> . even in the type japonica, where the upland accessions approximate monophyly and the ecotype differentiation is clear-cut , the upland and irrigated ecotypes still have a limited genetic differentiation , much lower than the reported differentiation between type indica and type japonica   <cit> .

we also investigated the population structure using frappe to estimate the ancestry and population admixture of each accessions  <cit> . by increasing k  from  <dig> to  <dig>  the population structure of upland and irrigated accessions are shown . for k =  <dig>  we see a differentiation between type indica and type japonica, and this differentiation also exists for oryza rufipogon and oryza nivara in the wild population. when k =  <dig>  the wild rice and the cultivars become separated. when k =  <dig>  the division between irrigated japonica and upland japonica emerge, while the irrigated indica and upland indica still share the same structure, indicating the ecotype differentiation is higher within the type japonica than in the type indica. when k =  <dig>  a new subgroup in upland japonica appears, suggesting some accessions in upland japonica forms a unique subgroup which is differentiated from the others in it.

from the structure analysis, we found that some upland indica accessions, though primarily classified as type indica according to their phenotypes, turn out to be quite complicated in terms of their genomic composition. for example, six accessions  , previously classified as upland indica according to their phenotypes , turn out to be more close to upland japonica , indicating that for the upland ecotype, seed shape phenotype could be misleading in distinguishing type indica from type japonica. besides the six accessions, gs <dig> and gs <dig> also have a large genomic proportion close to upland japonica, which makes them cluster with japonica in the phylogenetic tree . and upland indica gs <dig> , indicated with a red arrow, has a large proportion of wild rice ancestry, and correspondingly it clusters with the wild rice in the phylogenetic tree . these results suggest that current upland indica group is a admixture, containing accessions of different origins. they are classified as belong to indica probably because some of their traits are more close to type indica than type japonica. besides, the  <dig> upland indica accessions which remain in the indica group in the tree also seem to be polyphyletic, indicating they might originate multiple times and their genetic mechanisms for upland adaptation might be heterogenous. on the contrary, upland japonica accessions that form a monophyletic group are more likely to have similar mechanisms for upland adaption. considering the well-known hybridization between indica and japonica, it’s probable that upland japonica and some upland indica share similar adaptation genes, while the rest upland indica might be different. therefore, in the following study on the ecotype differentiated genes, we first use a large sample size by comparing the merged upland and irrigated population to identify genes that show strongest signals and might be shared between upland japonica and some upland indica accessions. then we mainly focus on the type japonica to find the japonica-specific upland adaptation genes. more data and other experiments would be needed to comprehensively address the adaptation mechanism in the complicated indica group.

ecotype differentiated genomic regions  in genomes
edrs probably contain genes that account for the adaptive differentiation. using a sliding window approach to screen regions with both the top 5‰ fst and cross-population composite likelihood ratio test  scores , edrs were identified with selective signals to narrow down the genes underlying the phenotypic differentiation between upland and irrigated rice . after merging the neighboring edrs, we eventually identified  <dig> edrs in the genome with a median length of  <dig>  kb that were differentiated between the upland and irrigated rice . within these edr regions, there are a total of  <dig> snps . compared with the whole genome snps used in our analysis, the snps in edrs are significantly enriched in genic regions  . among the edr snps,  <dig> have allele frequency differences larger than 60% between ecotypes, which we subsequently labeled “ecotype differentiated snps”  .

ecotype differentiated genes  in edrs
there are  <dig> genes in the edrs, which we called edgs . for these edgs,  <dig> genes have edss in the gene regions and the other  <dig> genes have edss located within 1 kb upstream or downstream regions. by gene enrichment analysis, we found that the edgs are enriched in several classes , such as lipase containing gdsl domain class , peroxidases , glutathione-related classes , and auxin signaling pathway .

p 
for the edgs of the whole population and japonica specific edgs, the enriched gene families and interesting genes in them are shown. and their potentially functional effects are indicated.

the gdsl domain-containing lipase has been reported to be involved in response to abiotic stress, such as drought  <cit> , indicating that the genetic differentiation of these genes in upland rice may be relevant to their adaption to dry land. peroxidases and glutathione-related proteins bear antioxidant activity, another crucial factor in plant adaptation to a drought-like environment  <cit> . furthermore, auxin, the famous growth-promoting hormone, plays an important role in determining plant architecture, and has been proved to control the formation of adventitious roots  <cit> . accordingly, differences in auxin signaling between upland and irrigated rice could potentially contribute to their different architectures and root systems. additionally, we also found several individual edgs of interest that might also be critical in upland adaptation or the phenotypic differentiation between the two ecotypes. os07g <dig>  a type-a response regulator, is of special interest . type-a response regulators belong to arr gene family induced by cytokinin and play important roles in cytokinin signaling  <cit> . quite a few pieces of evidence have shown that arr genes impact root and shoot development and apparent functional overlap exists among type-a arrs  <cit> . moreover, the relevance of type-a arr gene to the root and shoot phenotypes that are differentiated between upland and irrigated rice has also received experimental support; over-expression of a type-a response regulator in transgenic rice has been shown to cause dwarfness and poorly developed root systems  <cit> . hence the ecotype differentiation on this type-a arr gene, os07g <dig>  may be able to explain certain differences of root and plant height phenotypes between upland and irrigated rice. further reciprocal transgenic experiments between upland and irrigated rice will eventually address the contribution of os07g <dig> in the adaptation of upland rice.

other edgs were also implied by direct or indirect evidence to be relevant to upland adaptation. os12g <dig>  has a wrky dna-binding domain and wrky genes have been well established to be important elements in drought tolerance  <cit> . os12g <dig> encodes a sos3-like calcium-binding protein  <dig> and its homologs in arabidopsis are related to responses to water deprivation  <cit> . os11g <dig> encodes a terpenoid synthase, and terpenoid plant hormones have been shown to inhibit rice tillering  <cit> . this gene may, therefore, explain the difference in tiller numbers between upland and irrigated rice. besides, several pentatricopeptide repeat protein-coding genes  and two serine/threonine protein kinase genes  may also be related to drought response as these classes of genes have been reported to be involved in responses to drought/osmotic stress and root development  <cit> . these results illustrate how these  <dig> edgs may represent a valuable candidate gene list for investigating the phenotypic differentiation of the two ecotypes and upland rice adaptation.

edgs selected in individual populations
the investigated edgs indicate selection during the differentiation of the two ecotypes. to further pinpoint in which population the selection occurred, we used nielsen’s clr test to identify possible selective sweeps in a single population . we identified  <dig> selective sweep regions in the upland population with a median length of 27 kb, and  <dig> selective sweep regions in the irrigated population with a median length of 41 kb . in the selected regions of these upland and irrigated populations, there are  <dig> and  <dig> genes, respectively. upland rice then has twice as many genomic regions/genes selected as irrigated rice, indicating that upland rice varieties probably suffered more selection pressure imposed by adaptation or breeding. by overlapping the  <dig> edgs with these potentially selected genes, we found that almost all of these selected edgs  could be reconfirmed as selected genes using nielsen’s clr approach. among these,  <dig> were potentially specifically selected in upland rice,  <dig> were potentially specifically selected in the irrigated population, while  <dig> were likely selected in both populations .

japonica-specific and indica-specific edgs
genetic architectures of complex traits in rice are often both rich and complicated since they are usually heterogeneous across the subspecies  <cit> . in light of this, we were also interested in the ecotype-differentiated genes within the type indica or type japonica. as figure  <dig> depicts, upland indica have multiple origins, and thus may be genetically heterogeneous in terms of upland adaptation. when investigating the type-specific edrs, we accordingly mainly focused on the type japonica.

we carried out a similar pipeline to screen the edrs in type japonica  and found  <dig> edrs with a median length of 24 kb . in these edrs,  <dig> edgs were identified , among which  <dig> edgs are overlapped with the previous edg list from the total population while the remaining  <dig> are japonica-specific. for these japonica-specific edgs, the significantly enriched gene families include mitogen-activated protein kinase , wrky genes  and thioredoxin coding genes  . previous studies showed that mitogen-activated protein kinase plays an important role in response to biotic stress and root development  <cit> ; one japonica-specific edg of this class is very similar to blast induced kinase, which may then explain why upland rice are generally more blast tolerant than irrigated rice. moreover, as mentioned previously, wrky genes and thioredoxin may be critical for drought response. intriguingly, among our list we found os09g <dig>  a homolog to the famous maize-domestication gene, teosinte-branched  <dig>  indicating this gene may also be related to the different tillering abilities displayed by the upland and irrigated types.

for the type indica, because of the admixture of upland indica only  <dig> upland indica accessions that remain to cluster in the indica group could be used for analysis. but the fst between upland and irrigated accessions in indica is quite lower  than that in japonica , which means that a much larger sample would be needed to detect the ecotype differentiation in indica. however, because of the small population size of upland indica accessions in the world it is difficult to collect enough samples so far. analysis using only the  <dig> upland indica accessions yield a list of  <dig> genes identified by intersecting fst and xp-clr top signals . hence, it is not surprising that none of the  <dig> genes were overlapped with the previous edg list from the total population, considering the small sample size and possibly heterogeneous adaptation mechanisms in indica. however, we noticed that nine and four of the genes from the indica xp-clr top signals overlap with the previous edgs of the merged populations and edgs of the japonica population, respectively , indicating that some genes related to upland ecotype might be shared among some indica accessions and japonica but are more difficult to detect because of the limited and probable heterogenous samples. more experiments and data are needed to comprehensively address the indica-specific upland adaptation genes.

discussion
largely due to the popularity and fecundity of irrigated rice, there has been limited inquiry about the phenotypes that distinguish upland rice. some work in this area has been done by chang et al., who investigated the rate of leaf production, tillering production, plant height, root system and resistance to drought for  <dig> upland varieties as explanatory factors in the different phenotypes  <cit> . likewise, ono pointed out that japanese upland varieties are tall and low tillering with broad leaves, long panicles, drought and blast resistant, and have a less efficient utilization of fertilizer  <cit> . despite interesting findings, these studies were based on only a few varieties of upland rice. to our knowledge, the sample size of the phenotypic comparisons between upland and irrigated rice in this study represents a very large sample of upland varieties to date and the sample covers most distribution regions of upland rice over the world, providing solid evidence supporting chang et. al’s observations  <cit> . our phenotyping also observed some new features, e.g., the phenomenon that dry land culture increases main root length of upland rice but decreases that of irrigated rice indicates a remarkable superiority of upland rice to adapt to an upland environment.

beyond our thorough phenotypic analysis, this study, to our knowledge, also provides the first genomic perspective as to the phylogenetics and population structure of current upland rice. consistent with our classification based on phenotypic characteristics and glaszmann’s report which indicated most upland cultivars belong to the type japonica  <cit> , phylogenetic analysis revealed that a large proportion of upland accessions belong to the type japonica, which form a monophyly. the population structure inference reveals much less genetic differentiation between the two ecotypes than exists between the type indica-japonica, which could be due to either much more frequent gene flow between ecotypes than that between indica and japonica, or recent origin of upland rice.

though the sequencing depth for each accession used in our study is relatively low, the data set itself is informative enough to address the questions we wanted to address about upland rice adaptation. firstly, the snps identified have a high accuracy , even taking into account the low coverage. secondly, the average sequencing depth for each site in the upland or irrigated population is more than 40×, providing a sufficient sample size for allele frequency estimation. likewise, only snp sites with the genotype determined in more than  <dig> individuals within each population were used for analysis such as calculating allele frequencies, and only snp sites with no less than  <dig> individuals’ genotypes were used for estimating population structure. thirdly, though the genome coverage rate for each accession is not high, for each pair-wise comparison there are enough informative sites for the distance between any two accessions to be precisely computed . thus, as some previous studies have shown, we presented an interesting example substantiating the feasibility of genetic analysis with low coverage population genomic data  <cit> .

except for some qtl mapping efforts, very few reports have touched upon the genetic mechanisms that underlie the adaptive phenotypes of upland rice  <cit> . in this study, we identified some interesting candidate genes or gene families that likely contribute to the upland adaptive traits or phenotypic differentiation between the upland and irrigated ecotypes, not only providing exciting new evidence useful in harnessing the genetic adaptations of upland rice but also demonstrating the efficiency of our methodology. though pending more experimental evidence to validate the precise phenotypic effects of all the identified alleles, a limited number of genes  provided a highly feasible list for functional investigation as well as for the upland breeding. crucially, we would like to stress that our approach most likely caught most of the major genomic regions that account for ecotype differentiation and upland rice adaptation including those specific regions in type japonica, but identifying some indica accession specific adaptation genes still need further work and additional data.

CONCLUSIONS
in summary, we surveyed the phenotypes across a large sample of upland rice in both dry land and irrigated conditions, and by comparing them to irrigated rice in similar conditions we were able to demonstrate some significant phenotypic differentiations between the two ecotypes. using high-throughput re-sequencing of a large batch of rice accessions, for the first time, to our knowledge, we clarified a single-origin pattern of upland japonica rice but a novel multiple origin pattern in upland indica accessions. with comprehensive population genetic analysis, we identified the ecotype differentiated regions and important selection genes during the differentiation between the upland and irrigated ecotypes, and more poignantly, provided great insights into upland rice adaption and the phenotypic differentiation between the two ecotypes. these findings have important implications in the spread of upland rice varieties in breeding. for example, the genes that likely account for drought resistance can be used to breed highly drought resistant varieties from the existing high-yield irrigated varieties, and concurrently, the genes likely related to tillering ability can be used to enhance the tillering ability of upland rice, a major factor limiting its yield and subsequently its widespread usage.

