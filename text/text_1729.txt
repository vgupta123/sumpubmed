BACKGROUND
when a patient is diagnosed with cancer, various clinical parameters are used to assess the patient's risk profile. however, the patients with a similar prognosis frequently respond very differently to the same treatment. this may occur because two apparently similar tumours are actually completely different diseases at the molecular level, often called genetic heterogeneity. it describes the biological complexity whereby apparently similar inheritable characters result from different genes or different genetic mechanisms. the presence of such heterogeneity has a significant impact on both the efficiency of modern clinical practice and biomedical research of common human diseases. gene chip technology measuring the transcriptional omics holds a promise in tackling the heterogeneity issues for complex human diseases, i.e., the subtypes of a disease can be discovered accurately at a molecular level by analysis of the gene expression profiles. recent examples can be witnessed in the studies of leukaemia  <cit> , breast cancer  <cit> , renal allograft  <cit> , lung cancer  <cit>  and prostate cancer  <cit> , based on unsupervised hierarchical clustering. diffuse large b-cell lymphoma  analyzed in this study is the most common type of lymphoma in adults and demonstrates very apparently clinical heterogeneity. it can be treated by chemotherapy in only approximately 40% of patients. several recent studies used dna microarrays to study dlbcl, suggesting that it is possible to identify subgroups of patients in terms of different survival courses via gene expression data  <cit> , which are unlikely to be discovered by traditional clinical approaches.

however, most of the methods for peeling off heterogeneities resort to the unsupervised learning techniques, such as hierarchical clustering, to identify clinically relevant subtypes based on all genes or a large number of genes on microarrays. their utility is limited when the disease heterogeneity is resulted from only a small subset of the genes that participate in a particular cellular process, leading to different clinical outcomes. when the full dataset is analyzed, the "signal" of this process may be completely overwhelmed by the "noise" generated by the vast majority of unrelated data. in this study, we thus proposed an improved heterogeneity analysis strategy over the coupled two-way clustering algorithms  <cit> . in the proposed two-way clustering algorithm, super-paramagnetic clustering  algorithm  <cit>  was used to take its advantages as an efficient partitioner: the number of clusters was achieved by the algorithm internally, without a need to be externally prescribed; and its stability against noise, thus providing a mechanism to identify robust stable phenotypic clusters using the most compacted subset of gene signatures that leads to the best fits of the sample partitions. the rapidly accumulated multiple lines of evidence from, among others, gene expression and protein-protein interaction studies, support that genes express and perform their highly integrated cellular functions in modular fashions in cells  <cit> . also inspired by our recent success in peeling off the hidden genetic heterogeneities of cancers based on disease relevant functional modules  <cit> , we further defined a geneontology -based  <cit>  conceptual functional similarity measure in order to establish a functional validation for the identified gene subsets. finally we proved the differential survival outcomes of new subtypes using kaplan-meier survival analysis and multivariate cox proportional-hazards prediction modelling according to their clinical data. we demonstrated the behaviours and properties of the proposed method by applying it to two publicly available microarray datasets of diffuse large b-cell lymphoma , a notoriously heterogeneous phenotype.

RESULTS
description of dlbcl datasets
in this study, we used two published gene expression data for dlbcl. the first dataset, analyzed initially by alizadeh et al.  <cit> , consists of  <dig> samples, and  <dig> of them have survival data as well. the microarray data, available at lymphoma/leukemia molecular profiling project  <cit> , the website companion to  <cit> , have expression profiles for  <dig> genes, and among the  <dig> genes,  <dig> genes have missing values. we imputed missing values by the k-nearest neighbours method   <cit> . the second dataset, analyzed initially by shipp et al  <cit>  and available at the website for the broad institute's cancer program data sets  <cit> , consists of  <dig> samples and  <dig> genes.

coupled two-way clustering
we searched significant gene subsets using the well established coupled two-way clustering  algorithm as implemented in a public sever  <cit> , which used spc as the underlying clustering tool to break down the total dataset into subsets of genes and samples iteratively until significant partitions  were revealed. first, we clustered all samples using all genes to identify stable sample partitions and clustered all genes using all samples to identify stable gene subsets. then, we clustered the genes gained in the previous step using the newly defined sample partitions  to find the responsible gene subsets of high discriminating power. finally, we clustered each sample partition again using each gene subset with high discriminating power. in the searching process, we explored the cluster depth for both dimensions of samples and genes. the cluster depth selected was based on the empirical judgement whether the clinical samples could be well separated using the candidate gene subset. for the dataset of alizadeh et al  <cit> , we stopped the sample clustering at the cluster depth of one, with eight stable and significant gene subsets  identified. for the dataset of shipp et al  <cit> , we also stopped the sample clustering at the cluster depth of one, with  <dig> stable and significant gene subsets  identified.

computing the functional concept consistency scores for the identified gene subsets
co-expression genes often share some functional relevance. because we clustered the samples based on expression similarity  among the putative feature genes, the samples within a cluster were expected to be more similar in transcriptional activities than those in different clusters. hence, the sample partitions might reflect their differences in response to the underlying biology pathway leading to the phenotypic differentiation. in order to establish the functional validation for the identified gene subsets, we defined a geneontology -based  <cit>  conceptual functional similarity measure, called concept consistency score .

the ctwc algorithm was able to identify numerous highly correlated gene subsets during the recursive partitioning of samples and genes. in this study, our goal was to find some partition of dlbcl with high medical implications. the consistency scores for eight stable gene subsets  identified in the dataset of alizadeh et al  <cit>  were  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> , ∅ and  <dig> , respectively. an empty value ∅ occurred because some genes had neither functional annotation nor a common parent node in go. subset g <dig> had the highest consensus score, and was thus selected as a modular signature for subtyping the disease samples. the consistency score of g <dig> was the highest  among  <dig> stable gene subsets  identified in the dataset of shipp et al  <cit> . their scores were  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> , ∅,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> , respectively.

clustering samples by spc, using the gene subsets with highest score as the modular features
when clustering a dataset using a subset of genes, it is important to know if the samples can be well characterized using such a subset. for the dataset of alizadeh et al, forty-two dlbcl samples were clustered using the genes included in g <dig> using spc, with the euclidean distance and pearson's correlation coefficient as the sample and the gene expression similarity measures, respectively. figure  <dig>  plotted by treeview  <cit> , shows clearly a partition of three subtypes of diffuse large-b-cell lymphomas for  <dig> patients per the expression patterns of  <dig> probes . among  <dig> probes,  <dig> were annotated in go:  <dig> were for the major lymphoid-restricted membrane protein ,  <dig> for the b-cell cll/lymphoma 7a ,  <dig> for phosphoinositide-3-kinase, catalytic, gamma polypeptide  and  <dig> for cancer susceptibility candidate  <dig> . in addition, bcl7a and tnfa were previously reported as the prognostic factors for lymphoma. five of the remaining  <dig> probes were known transcribed loci. a careful scrutiny of g <dig> revealed that it largely captured complex modular activities that regulate cell cycling, dna synthesis and repair, leukocyte adhesion, cell-cell signalling etc. and that mainly take place in nucleus and intracellularly. it is also interesting to note that g <dig> contained an "integral to plasma membrane" component consisting of the well known dlbcl relevant pathway – g-protein coupled receptor protein signalling pathway   <cit>  and jaw <dig> for vesicle targeting and homocyte development. for the functional annotations for the known genes included in g <dig>  see additional file  <dig> 

for the second dlbcl dataset,  <dig> dlbcl samples were clustered using the genes included in g <dig> using spc. we again identified a partition of three subtypes of dlbcl among  <dig> patients per the expression patterns of  <dig> probes, as shown in figure  <dig>  among those,  <dig> probes were annotated in go:  <dig> were for the major lymphoid-restricted membrane protein ,  <dig> for the b-cell cll/lymphoma  <dig> ,  <dig> for the b-cell cll/lymphoma 7a ,  <dig> for the cylin d <dig>  most of the  <dig> genes were found to be germinal centre b cell signatures  <cit> , suggesting that g <dig> described a complex process leading to a favourable survival outcome for dlbcl patients. however, we recognized that compared with g <dig> some new genes  were identified in g <dig>  which may define some new pathways or expand our knowledge on the functional topology for dlbcl, or may be simply due to the differences between the two datasets. for the functional annotations for the known genes included in g <dig>  see additional file  <dig> 

it is interesting to note that several genes were repeatedly identified as important molecular signatures for dlbcl. for example, multiple probes for jaw <dig> were repeatedly identified in both datasets. in addition, many previous experiments also detected the overexpression of this gene in normal  <cit>  or impaired germinal centre  b-cells  <cit>  and jaw <dig> had thus been established to be one of the most important molecular signatures for the gcb subtype of dlbcl  <cit> . the jaw <dig> gene, encoding a lymphoid-restricted membrane protein , was first identified by screening for genes expressed preferentially in b-cell lines  <cit>  and later found in lymphoid tissues and in the pancreas and colon  <cit> . a recent immunohistological study of b-cell lymphomas  <cit>  documented jaw <dig> expression at the protein level in human tissues by using immunohistochemical and western blotting. and the investigators found that jaw1-encoded protein was also highly expressed in germinal centre b-cells. overall, multiple lines of evidence at different molecular levels support that jaw <dig> is the most important prognostic marker for lymphoma. interestingly, the jaw <dig> gene has been reported to be fused to the blc <dig> gene in a case of transformed follicle centre lymphoma  <cit> . in this study, both genes were included in g <dig> for the second dataset.

bcl <dig>  bcl7a, kiaa <dig>  cyclin g <dig>  pik3cg and jaw <dig> included in the subsets of g <dig> and/or g <dig> for the two datasets are previously reported germinal centre-associated signatures  <cit> . bcl <dig> was the prognostic marker for gcb-like dlbcl and non- gcb-like dlbcl groups and jaw <dig> has different expressions among the three subtypes identified by wright et al.  <cit> . consequently, it is not surprising that both subsets of genes had high discriminating power in recognizing gcb subtype of dlbcl. based on the definitions of dlbcl subtypes proposed by alizadeh et al.  <cit> , most of subtype  <dig> partitioned by g <dig> were of germinal centre b-cell-like  dlbcl  dlbcl cases), and all of subtype  <dig> were of ab-like dlbcl. however, the clinicopathological characteristics of subtype  <dig>  consisting of  <dig> ab-like dlbcl cases and  <dig> gcb-like cases were less clear. as shown in figure  <dig>  the subtype  <dig> defined by g <dig>  which may correspond to rosenwald et al's type  <dig> dlbcl  <cit> , did not express the set of genes of g <dig> at a high level.

survival analysis
to verify the clinical significance of the identified hidden dlbcl subtypes, we estimated survival curves by using kaplan-meier product-limit method and assessed the differences between the survival curves of the subtypes of dlbcl patients by a log-rank test  <cit> . for the first dataset, the survival curves associated with the three subtypes revealed by g <dig> are shown in figure  <dig>  the log-rank statistic comparing the survival times of the first subtype and the third subtype  shows highly significant differences . the  <dig> year survival rates for three subtypes were  <dig> %,  <dig> % and  <dig> %, respectively. the survival curves associated with the three subtypes identified by g <dig> in the second dataset are similar to the plots for the first dataset except for subtype  <dig> that has a steeper survival curve . the log-rank statistic comparing the survival times of the first subtype and the third subtype shows highly significant differences . the  <dig> year survival rates for three subtypes were  <dig> %,  <dig> % and  <dig> %, respectively.

in order to explore a compact model for clinical use, we further identified the most contributed genes of high prediction power. multivariate cox proportional-hazards model was used to analyze the genes in g <dig> and g <dig>  respectively. to reduce the number of variables to be modelled, we applied the stepwise variable selection option  for the multivariate cox proportional-hazards regression model  <cit> . we ended up with four predictors  for g <dig> and two predictors for g <dig>  respectively . not surprisingly, both bcl <dig> and jaw <dig> were selected to be the significant prognostic predictors because of their importance involved in the underlying pathogenic mechanisms for lymphoma. hans et al  <cit>  estimated that it was feasible to assign patients to gcb-like and non-gcb-like groups based on only three markers . however, the finding of jaw <dig> being repeatedly selected for both datasets may implicates its discriminating role in lymphoma patients at large. in both datasets, the jaw <dig> gene was defined as an important 'favourable' prognosis predictor . based on the go function data, all other three genes  in g <dig> are associated with the functions of 'regulation of transcription', implying their putative roles in cell development and cycling .

discussion and 
CONCLUSIONS
an initial gene expression profiling study of dlbcl led to the discovery that this single diagnostic category consists of at least two molecularly distinct diseases  <cit> . one dlbcl subtype, termed gcb-like dlbcl, expressed genes characteristic of normal germinal centre b cells whereas the other subtype, termed ab-like dlbcl, instead expressed genes characteristic of mitogenically activated blood b cells. patients with gcb-like dlbcl were more often cured by chemotherapy than patients with ab-like dlbcl were. recently, in an expanded gene expression profiling study of  <dig> dlbcl patients, the two gene expression subtypes were again identified together with a new subtype, termed type  <dig>  which did not express the genes characteristic of either gcb- or ab-like dlbcl  <cit> . as before, patients with gcb-like dlbcl had a more favourable clinical course, with a 5-yr survival rate of 60% compared with 5-yr survival rates of 35% and 38% for patients with ab-like and type  <dig> dlbcl, respectively. another study used oligonucleotide microarrays to profile gene expression in  <dig> dlbcl biopsies  <cit>  and attempted to identify the gcb- and ab-like dlbcl subtypes using the genes that were identified in the original profiling study for distinguishing these subtypes  <cit> . hierarchical clustering of the dlbcl cases based on expressions of these genes resulted in two groups of patients that did not differ in clinical outcome  <cit> , in apparent contrast with the two other studies  <cit> . compared with the previous studies, the two-way clustering algorithm applied in this study appears more efficient in finding the most compact gene subsets that have achieved an improved prognostic accuracy over the dlbcl patients' survival profiles. however, it should be cautioned that more detailed clinicopathologic characteristics for subtype  <dig> dlbcl patients as defined by either gene subset g <dig> or g <dig> have to be fully characterized before use although the survival profiles for the subtype can be clearly separated from other two subtypes. based on the gene expression patterns of g <dig> , it appears that many genes in subtype  <dig> patients were inactivated and hence the g2's ability in differentiating these samples was significantly lowered.

computational discoveries of the hidden subtypes for a complex disease have to be verified by some means, e.g., a functional assay using bioinformatics approaches or a clinical validation using epidemiological approaches such as survival analysis. in supervised classification, the choice of the best subset of genes for disease prediction should be relatively easy because the sample labels in training set are given, the high accuracy rate of the classifiers trained on the candidate subsets might be used to filter more specific and critical subsets highly relevant to a disease pathogenesis. in unsupervised clustering analysis, however, identifying the best subset for peeling clinically heterogeneous disease can be a very challenging task as no cross-validation can be done internally. the underlying assumption for a clustering algorithm is that genes with similar expression patterns are more likely to have a similar biological function, but a clustering algorithm itself does not provide proof of the best grouping of genes in terms of biological functions  <cit> . thus, the biological interpretation of the disease clustering results relies heavily on the expert knowledge which often is somewhat subjective  <cit> . therefore, in this study, we designed a functional consensus score for evaluating a candidate gene subset in terms of functional concept consistency, which is similar to the biological homogeneity index  proposed recently  <cit> . based on evaluating the performance of ten well-known clustering algorithms on two gene expression datasets, the authors in  <cit>  found that a good clustering algorithm should have a high bhi. alternatively, one can use the external annotation database such as gene ontology to directly guide the selection of multiple functionally compact and coherent gene subsets  as we did in a recent study  <cit> . in terms of the better-characterized functionality of subsets g <dig> and g <dig> and based on the significantly different survival results for the patients defined by the newly defined subtypes, the applied two-way clustering algorithm has been demonstrated to be a feasible and promising toolbox for peeling off molecular heterogeneities of complex human diseases.

in this study, we took the known subtypes suggested by previous studies as the basis to assess the validity of the proposed approach. although the clustering results provided good fits to these known phenotypic partitions, the implied assumption of the lack of other subtypes or subtle dlbcl groups might not be true. also, the problem to estimate the correct number of subtypes for peeling off complex diseases is not investigated in this study. some investigators  <cit>  have proposed several methods to obtain the best number of sample partitions by optimizing some validity indices such as the adjusted rand index   <cit> , which would provide additional insights onto improving the two-way clustering algorithm applied in this study.

there is a growing interest in biomedical domains for developing robust predictive model for the survival of cancer patients using gene expression data. however, many methods use all the genes on chips or a large number of genes  to predict a survival. since the vast majority of the genes in a given dataset are irrelevant to the survivals of the studied patients, the result is that many of the inputs to the predictive model are superfluous and thus reduce the accuracy of the model for prediction. hence, mclachlan et al.  <cit>  proposed a mixture model-based approach to the clustering of microarray expression data. in this approach, a subset of the genes relevant for the clustering of the tissue samples was first selected by fitting mixtures of t distributions to rank the genes in order of increasing size of the likelihood ratio statistic for the test of one versus two components in the mixture model. then, if this reduced set of genes is still too large for a normal mixture model to be fitted directly to the tissues, the investigators suggested the use of mixtures of factor analyzers to reduce the dimension of the feature space of genes further. in this study, we applied an integrative approach that combines a spc-based two-way clustering with a functional consensus metric to identify functionally sounding and the most compact subset of genes underlying the phenotypic partitions of patients. application of the proposed approach to two dlbcl datasets led to identification of two gene subsets with several features overlapped, and further multivariate cox proportional-hazards modelling defined jaw <dig> as one of the most significant predictors for the survival of the dlbcl patients in both cohorts. overall, our results demonstrated that the proposed approach is promising for peeling off the hidden genetic heterogeneity based on modern omics data, and may lead to an improved diagnosis and treatment of cancers.

