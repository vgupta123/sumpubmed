BACKGROUND
microarray gene expression experiments produce high dimensional expression measurements in genomic scale, typically expression levels of more than ten thousand genes. while the high dimensionality offers an opportunity for a comprehensive interrogation of transcriptome, it also poses a challenge to researchers seeking to extract functional understanding and interpretation of the data, which go beyond a mere identification of differentially expressed genes . a way to derive such a functional interpretation is to focus on functional sets of genes, such as biological pathways, instead of individual genes. a common practice for the pathway-level analysis has been the functional enrichment analysis, for which two types of methods are widely used. one is called over-representation analysis in which degs are first identified from the data and their prevalent pathway annotations are then identified, whose best known example is david  <cit> . the other is called gene set analysis in which differential expression statistics of all genes are first computed and each pathway is then examined to see whether its member genes collectively show significant differential expression, whose best known example is gene set enrichment analysis   <cit> . a common theme underlying the two types of functional enrichment analysis is that individual genes are first tested for differential expression and the resultant gene-level results are then combined at the pathway level for an identification of differentially regulated pathways.

an alternative approach is also possible, where gene expression data are first aggregated at pathway level to yield a compact representation of the original data, in which each row in the data matrix now corresponds to a pathway instead of a gene. thereafter the pathway-level aggregated expression data, or simply, pathway expression data, are directly analyzed to identify differentially expressed pathways. a notable advantage of the aggregation-based approach is that it can be applied to a wider range of analysis tasks than the conventional functional enrichment analysis. this is because, once gene expression data are aggregated at pathway level, the pathway expression data can not only be used for identifying differentially expressed pathways, but also for classification or clustering of samples in the space of pathways  <cit> , leveraging existing algorithms usually applied to gene expression data. transforming the expression data from gene space to pathway space is also expected to yield a more robust representation of the data in which intrinsic technological and biological variances across samples are reduced  <cit> . in other words, while expression of individual genes in a pathway may vary considerably across samples with similar phenotypic characteristics, expression of the pathway as a whole may become consistent across the samples. noting the advantages in interpretability, compactness, utility, and anticipated robustness, several studies have proposed pathway-level aggregation methods of gene expression data  <cit> .

with the availability of all these pathway-level aggregation methods, it becomes important to comprehensively evaluate how these methods compare with one another. although each of the original reports has presented an evaluation of its performance for a demonstration of its improvements over existing methods, the evaluations were done only to a limited extent and thus inadequate to make general recommendations. most notably, there were the following two major limitations.

the first limitation is that, in the studies in which classification accuracy was assessed in the pathway space  <cit> , external validation of accuracy on related but independent test datasets was either skipped   <cit> , or insufficiently done on a limited number of datasets   <cit> . although internal cross-validation is a convenient solution to assess a classifier's performance within a single dataset, it leads to optimistically higher estimates of performance than what would really be expected in a new dataset with identical phenotypic classes  <cit> . thus, in any classification studies, it is increasingly being recognized that it is crucial to externally validate the performance of a classifier constructed from a dataset on an independent test dataset for a realistic estimation of classification performance and generalizability  <cit> . in addition, to ensure a comprehensive evaluation, the training and the external validation need to be performed on multiple pairs of training and test datasets that encompass a wide range of phenotypes with varying extent of relative subtlety in the biological differences between phenotypic classes.

the second limitation is that all the original reports did not evaluate the extent to which the differential expression signature of pathways is correlated between datasets with identical phenotypic classes. as described earlier, an expectation with the pathway-level aggregation has been that, although differential expression signature of genes may show some discrepancy between related datasets, differential expression signature of pathways may become more congruent with each other. despite the importance as an evaluation metric, the correlative extent of pathway signature has not been evaluated in the original reports.

to address the aforementioned limitations towards a reliable assessment, this study presents a comprehensive evaluation of six most prominent pathway-level aggregation methods of gene expression data--five existing methods and a simple variant of an existing method. datasets collected for benchmarking consist of seven pairs of two-class gene expression datasets  of various phenotypes. the gene expression datasets were aggregated in the space of kegg pathways. the performance of the pathway-level aggregation methods was assessed by classification accuracy validated both internally and externally, and by correlation of pathway signatures.

RESULTS
description of six compared methods of pathway-level aggregation
this study compared six of the most prominent methods for pathway-level aggregation of gene expression data. for an illustrative purpose, an example of a gene expression profile and corresponding pathway expression profiles aggregated by the six methods is provided as heatmaps in figure  <dig>  the six methods can be grouped into three general categories: mean-based , projection-based , and others . description of each of the methods is given below. mathematical description of the methods is provided in additional file  <dig> 

mean of all genes 
in this most straightforward method, which has appeared in the literature many times in one form or the other  <cit> , the gene expression data are first z-scaled for each gene across the samples into zero mean and unit variance. then the expression profiles of all member genes in a pathway are combined by taking their mean.

mean of condition-responsive genes 
in this method  <cit> , expression profile of a pathway is represented by the mean expression of key member genes, called corgs , instead of all the member genes. the corgs are defined as the genes that, upon aggregating their expression profiles by averaging, yield a pathway expression profile that is the most discriminative between the two classes in the data. identifying the corgs of a pathway in a given two-class dataset begins with t-test on z-scaled expression data of genes belonging to the given pathway. then, overall direction of expression change  in the pathway is determined as the sign of the mean t-statistic values of all its member genes. next, all the member genes are sorted by their t-statistic values in accordance with the overall regulatory direction of the pathway; the most strongly up-regulated genes are arranged to the top for an overall up-regulated pathway, whereas the most strongly down-regulated genes are arranged to the top for an overall down-regulated pathway. then, the corg set is initially set to contain only the top ranked gene, and iteratively expanded. at each iteration, the gene of the next rank is added to the candidate corg set, pathway expression profile is obtained next by taking the mean of expression profiles of the candidate corgs, and t-test is then performed to give the pathway's t-statistic. the iteration stops when the pathway's t-statistic no longer improves, at which point the final corg set is obtained. although this method has been called as pac  in the original article, it will be referred to as mean corgs in this report in order to emphasize the mean-based nature of the method as well as to avoid confusion with pca  which is one of the methods evaluated in this article.

analysis of sample set enrichment cores 
the assess method  <cit>  can be considered as a sample-level extension of gene set enrichment analysis   <cit> . as in the gsea method, assess calculates enrichment score of each pathway. the difference is that, while gsea gives only an overall enrichment score of a pathway between two classes of samples, assess provides an enrichment score of the pathway for each sample. to this end, assess employs random walk computations twice. the first use of random walk is applied at the level of individual genes. given an expression level of a gene in a sample, the sample's log likelihood ratio of belonging to one class instead of the other is calculated. to calculate the log likelihood ratio, it is needed to first calculate two probabilities that the expression level of a gene in a sample is representative of class  <dig> or class  <dig>  random walk is used for this probability calculation. more detailed description of the first use of random walk can be found in the original publication  <cit> . then the second use of random walk is done at the level of each pathway. using the log likelihood ratio values obtained for its member genes, it computes enrichment score of a pathway in a sample by the maximum deviation of the random walk from zero, as in gsea.

principal component analysis 
pca has long been applied to the analysis of gene expression data, especially for an exploratory data visualization to discriminate between sample groups. in this usage of pca, correlation matrix is first computed from z-scaled gene expression data. each element in the correlation matrix represents a measure of dependencies between corresponding gene pairs, with zero indicates independence. then, through eigen-decomposition of the correlation matrix, major directions in the data with the largest variability are identified as eigenvectors corresponding to the largest eigenvalues of the correlation matrix. or, equivalently, the eigenvectors and eigenvalues of the correlation matrix can also be found by singular value decomposition  of the gene expression matrix itself. the eigenvectors are called the principal components , or metagenes in gene expression studies. finally, the gene expression data are projected onto a small number of pcs, usually two or three, and the projections are used for an exploratory visualization of the data. the matrix of pcs is commonly referred to as loadings, in which each column gives the location of each pc axis relative to the original system of axes. the matrix of projections is also commonly referred to as scores, in which each column gives the location of samples with respect to each pc axis.

in addition to its use in the exploratory data visualization, pca has also been used as a pathway-level aggregation method in several studies  <cit> . in this usage, pcs are found by applying pca to the matrix of z-scaled expression levels of member genes in a given pathway, instead of all genes represented in the microarray. projection of the gene expression data of the pathway onto the first pc is taken as the expression profile of that pathway. in this application of pca as a pathway-level aggregation method, it is worth mentioning that there exists an issue called sign ambiguity  <cit> , which is an inherent but often overlooked aspect of pca despite its wide usage in bioinformatics. the sign ambiguity refers to an intrinsic property of pca and svd in which the orientations of pcs, or equivalently, those of singular vectors, cannot be mathematically determined. to see why, consider the decomposition of a data matrix x, x = uΣvt, in which Σ is a diagonal matrix and the columns of u and v are the left and right singular vectors, respectively. in this decomposition, the orientation of any right singular vector can be flipped as long as the orientation of the corresponding left singular vector is flipped as well. in other words, the following equality holds for any column index k; σkukvkt=σk-uk-vkt. although any implementation of pca and svd assigns singular vectors with specific signs, the assignment of sign is essentially random  <cit> . what this entails in the context of pathway-level aggregation is that, for a pathway expression profile obtained from pca, positive and negative expression values may not necessarily mean an up-regulation and a down-regulation of the pathway, respectively. thus, the sign of pc scores lacks meaningful biological interpretation. while the sign ambiguity problem has not been recognized in some studies that used pca as a pathway-level aggregation method  <cit> , it was considered in other related studies  <cit>  by correcting the signs of pc scores so that the pc scores are positively correlated with the average gene expression profile of the given module. this simple approach for sign correction was adopted for the analysis shown in this report.

partial least squares 
pls is a regression method that combines properties of multiple regression and pca. data for pls analysis consist of a data matrix x and a response matrix y, which contain values of the independent and the dependent variables, respectively. in brief, pls seeks to find latent variables  that best summarize the variance in the original data x and are the most relevant for the response y as well. unlike the standard multiple regression which builds a regression model between the original data x and y, pls seeks to build a regression model between the latent component scores of x and those of y. unlike pca which chooses the pcs so that only the variability within x is best described, pls chooses the latent components so that covariance between x and the response y is best described. a previous study  <cit>  has used pls as a pathway-level aggregation method. in this approach, data consist of a matrix x of z-scaled expression levels of a given pathway's member genes and a class vector y. each element in the class vector simply indicates class membership of the corresponding sample. score vector of the first latent component is taken as the expression profile of that pathway. as in the case of pca, the sign of the latent components needs to receive further consideration. in the previous study  <cit> , a dummy coding scheme was used to represent the class vector,  <dig> for a control sample and  <dig> for a case sample. however, the sign of the latent components obtained under this coding scheme lacks meaningful biological interpretation. since  <dig> is a larger numeric value than  <dig>  regression on these two dummy numeric values makes the resultant pathway expression levels larger in case samples and smaller in control samples. thus subsequent differential expression analysis at pathway level would falsely identify all pathways as being up-regulated. thus, for the analysis shown in this report, the sign of the latent component scores was corrected so that the scores are positively correlated with average gene expression profile of the given pathway--the same correction scheme used for pca. this correction scheme is also equivalent to the use of 0/ <dig> coding for an overall up-regulated pathway and 1/ <dig> coding for an overall down-regulated pathway.

mean of top 50% of genes 
in addition to the five existing methods described above, a simple variant of the first method  was proposed in this report. in this modification, pathway expression profile is calculated by averaging only the top half of the member genes with larger t-statistics, instead of all member genes.

collection of benchmarking datasets
for a comprehensive evaluation, a total of seven pairs of independent datasets of various phenotypes was collected, fourteen in total . each dataset will be referred to by the name of the first author in the corresponding article, or by the name of cohort. in all the datasets, class  <dig> represents a more malignant sample group than class  <dig>  thus class  <dig> was designated as the case group and class  <dig> as the control group.

each of the datasets was referred to in the main text by the dataset name, which is the first author's name or cohort name. numbers in the table indicate the number of samples.

internal cross-validation accuracies in each dataset
the ability of pathway expression profile for discriminating two sample groups was first assessed by 5-fold cross-validation within each dataset . balanced accuracy was examined as a function of feature set size , instead of at a fixed arbitrary number of features, or an optimized number of features that results in the best performance in the validation dataset  <cit> . the adopted examination scheme allows a transparent benchmarking of the compared methods over an unbiased operative range, and is an often adopted scheme in similar benchmarking analyses  <cit> .

several observations can be made from figure  <dig>  first, the classification accuracy varied across datasets, which reflects the relative subtlety in the biological differences between two classes in each dataset. the highest  accuracies were obtained in the comparison of tumorous kidney and normal kidney , which are markedly distinctive disease states. somewhat lower accuracies were obtained in the remaining datasets. the lowest accuracies  were obtained in the sun dataset  which compared glioblastoma multiforme  and anaplastic astrocytoma --the two subtypes of high grade gliomas and also known as grade iv and iii astrocytoma, respectively. second, there were noticeable fluctuations in accuracies along the feature set sizes, and their extent appeared to vary across datasets. for example, the smoking dataset of vanni showed the largest fluctuations  whereas the kidney dataset showed the smallest fluctuations . with respect to aggregation methods, it appears that there are more pronounced fluctuations in some of the methods  than in the rest . third, some of the methods can be recognized to yield lower accuracies than the others. for example, pca never achieved the highest accuracies across all datasets and feature set sizes.

external validation accuracies in each pair of datasets
having examined the classification accuracies by cross-validation on the same datasets from which the classifiers were derived, the accuracies were then re-assessed by externally validating on independent datasets with identical phenotypic class labels. as in the internal validation, there were noticeable fluctuations in accuracies along the feature set sizes, and their extent appeared to vary across datasets. for example, the smoking datasets showed the largest fluctuations , the kidney datasets showed the smallest fluctuations , and the lung cancer subtype datasets showed medium fluctuations . as in the internal validation, it appears that there are more pronounced fluctuations in some of the methods  than in the rest . apart from the aforementioned qualitative observations, the presence of the dataset-dependent and feature set size-dependent fluctuations in accuracies makes it difficult to further compare quantitatively the relative performance of the six methods. for example, while it should be relatively straightforward to compare the methods in the breast cancer er subtype dataset which showed relatively small fluctuations , it would be difficult to do so in the smoking dataset which showed a high extent of fluctuation . to facilitate further comparison, a summarized view of accuracies across all the datasets was thus obtained using a rank-based method, as described in the next section.

overall accuracy ranking combined across the datasets
to simplify the comparison of the methods, it would be helpful to summarize the accuracy results by converting them into a ranking of the six methods in each dataset and combining the rankings from all the fourteen datasets. to this end, we used rankaggreg package  <cit>  which produces a combined ranked list when given with several ranked lists. the rank combination was done for the external validation results as well as for the internal validation results. the combined ranking of the six methods at each feature set size is shown in figure  <dig> 

with such ranking-based summarized representation, relative performance of the six methods becomes more evident. in the internal validation , mean top 50% achieved the highest accuracy ranks across all feature set sizes, whereas pca achieved the lowest accuracy ranks. overall, the combined accuracy ranking showed only a small extent of fluctuation in the internal validation, despite the fluctuations in accuracy values within individual datasets. in the external validation , there were considerable fluctuations in the combined accuracy ranking. nevertheless, relative performance of the six methods was distinguishable despite the fluctuations. by comparing figure 4b with figure 4a, it can be observed that the external and the internal validation results are generally similar. first, on average, mean top 50% achieved the highest accuracy rank in both the external validation  and the internal validation . second, pca ranked the second lowest in the external validation  and the lowest in the internal validation . third, mean corgs achieved a medium accuracy rank in both validations. fourth, assess achieved the second highest accuracy rank in both validations. on the other hands, disparate observations can also be made between the external and the internal validation results. for example, although pls ranked consistently near the bottom in the internal validation, it showed a steady decrease in accuracy rank in the external validation as more pathways are added to the classifiers, yielding a medium average rank of  <dig> . while the results from the internal and external validation showed both similarities as well as discrepancies, the results from the external validation should receive more weight since the external validation is a more realistic way to estimate the true performance and generalizability of a classifier, as argued in the introduction section. therefore, in subsequent sections, further examinations of the classification performance were made to the externally validated results only.

overall distribution of accuracies pooled across the datasets and feature set sizes
to further summarize the external validation results shown in figure  <dig>  overall distribution of accuracies was obtained for each of the six methods by pooling their accuracies obtained under all the fourteen datasets and ten feature set sizes, and represented as boxplots . with respect to median accuracy, three methods  similarly showed a higher accuracy , whereas mean all and pca showed a lower accuracy . with respect to dispersion, four methods  showed a similar extent of dispersion, whereas mean corgs and pls showed a high extent of dispersion, with a small lower quartile value . considering both the median accuracy and the dispersion, mean top 50% and assess thus showed a similarly good performance across all the datasets and feature set sizes. although pls showed a good median accuracy, its accuracies varied the most across the datasets and feature set sizes.

overall distribution of accuracies in each phenotype
the external validation results shown in figure  <dig> were also summarized for each of the six methods by pooling their accuracies at all feature sizes and two independent datasets in each phenotype . a main observation is that the relative performance of the methods varies across phenotypes. while the median accuracies of all the methods are relatively similar in some phenotypes , there are large differences in other phenotypes . what this observation entails is that the performance evaluation should be performed in as many phenotypes as possible, as done in this study.

between-dataset correlation of differential expression statistics of pathways
comparison of the methods can also be performed by evaluating the extent to which the differential expression statistics of pathways are correlated between independent datasets. to this end, student's t-test was performed on pathway expression profiles to obtain t-statistics of each pathway in each of the datasets. in total, seven pairs of pathway signatures were obtained per method. thus, for a given phenotype, one can correlate a pathway's t-statistic in one dataset with its t-statistic in the other dataset. to obtain a summarized view, a scatterplot of t-statistics was prepared for each method by correlating t-statistic values of all the pathways between seven pairs of datasets . thus each plot contains  <dig>  data points . two main observations can be made from the scatterplots. first, lower correlations were observed under three methods  than the rest . second, the three methods with lower correlations have many discordant pathways whose t-statistics are large in magnitude and in the opposite sign between the two independent datasets . it is these discordant pathways that, when used as a feature, dropped the external validation accuracy and caused the observed fluctuation of accuracies shown in figure  <dig> 

to further examine the discordant pathways, an exemplar pathway was selected among the top  <dig> feature pathways used in the classification analysis. since the lung cancer grade datasets showed lower accuracies  under the three methods  than the rest, an exemplar pathway was selected from the feature pathways in the lung cancer grade datasets. one of the most discordant pathways with the largest magnitude of t-statistic values was mapk signalling pathway, whose  <dig> member genes are represented in the microarray data. in mean corgs, it was the most up-regulated pathway in one dataset  but fifth most down-regulated pathway in the other  . in pls, it was also the most up-regulated pathway in the dana-farber dataset but ranked the twenty-first as a down-regulated pathway in the michigan dataset . its t-statistics in the lung cancer grade datasets are indicated as large red circles in figure  <dig>  and its member genes' expression profile along with its pathway expression profiles aggregated by the six methods are shown in figure  <dig>  three observations can be made from figure  <dig>  first, differential expression between the grade groups becomes more evident with pathway expression profiles  than gene expression profile . second, the direction of pathway-level expression change is discordant between the two cohort datasets. in the grade  <dig> samples, the mapk signalling pathway is up-regulated in the dana-farber cohort  but down-regulated in the michigan cohort . third, the extent of differential expression of the pathway is more pronounced under mean corgs and pls, as all the samples within each grade group show relatively homogeneous expression levels.

discussion
this study evaluated and compared the six methods of pathway-level aggregation of gene expression data--five existing methods  and a simple variant of an existing method . four of the compared methods are either conventional dimensionality reduction methods  or simple heuristics . these four methods were not specifically developed to address the pathway-level aggregation problem itself. it may be argued that the former lacks a solid biological basis and the latter a formal basis. the other two methods  were specific to the pathway-level aggregation problem. the evaluation was performed with respect to classification accuracy, validated both internally and externally, and by examining the correlative extent of pathway signatures between seven pairs of related but independent datasets. the results show that there are considerable differences in performance between the methods. three main findings from this study are described below. first, with respect to the external validation accuracy, the six methods can be ranked from the best to the worst as mean top 50%, assess, pls, mean corgs, pca, and mean all . the dimensionality reduction methods were overall inferior to others. second, the overall distribution of accuracies is skewed down in mean corgs and pls , indicating that there are many instances in which these two methods did not perform well. third, the reason why these two methods perform poorly in such instances is that they tend to produce pathway expression signatures that are discordant between related but independent datasets, as shown in the pathway t-statistic correlation . the between-dataset discordance arises due to the algorithmic characteristics of the two methods. in mean corgs, the pathway's overall direction of expression change is first determined as the sign of mean t-statistic values of all its member genes. then, only the key member genes that contribute the most to the pathway-level t-statistic are selected. thus, if the pathway's overall expression change is in different directions between datasets even by a small magnitude, the discordance in the resultant pathway expression profiles becomes inflated. similarly, in pls, the sign of the latent components was corrected so that the component scores are positively correlated with the average gene expression profile of the given pathway. thus, the pathway expression profile aggregated by pls becomes discordant in the opposite direction as well.

the third observation described above suggests that, in order to yield a pathway expression profile that is concordant between independent datasets and predictive of a phenotype as well, a successful pathway-level aggregation method should not strictly depend on the overall direction of expression change of a pathway, as measured by the mean of z-scaled expression levels of its member genes. although it is the simplest and the most widely used practice that regards a pathway being up-regulated if the mean expression is positive and down-regulated if negative, such a rationale lacks solid biological support. it has been argued that, in physiological processes such as biological pathways, homeostatic transcriptional responses may occur so that an up-regulation of one component in a pathway leads to a down-regulation of another component in that pathway in an attempt to compensate  <cit> . if so, overall direction of a pathway's expression change is determined by the relative magnitudes of the two opposing components. if, for some reason, the relative magnitudes of the two components are reversed between independent datasets, the overall direction of a pathway's expression change would become discordant in the opposite direction. furthermore, simply averaging the expression changes of all the member genes as if they were independent and uniform objects may not lead to an adequate measure for representing a pathway's expression behavior in a biological context, considering that differential expression of downstream genes in a pathway may not influence the pathway's overall activity as much as that of its upstream genes  <cit> . thus, i speculate that a successful pathway-level aggregation method needs to consider the issues such as the homeostatic response of a pathway, the positions of genes in the pathway topology, as well as the types of interaction linking the member genes. the last two issues have also been mentioned in a review paper describing topology-based pathway enrichment analysis methods  <cit> .

the pathway-level aggregation approach is advantageous in that it can be used not only for identifying differentially expressed pathways, but also for classification or clustering samples in the space of pathways, for deriving a compact representation and visualization of the original gene expression data, as well as for facilitating systems-level interpretation. nevertheless, an inherent problem of the pathway-level aggregation approach is a possible loss or even deformation of information present in the original gene expression data. this problem arises since the expression levels of pathway member genes are reduced into a single numerical value. in this regard, a relationship may exist between the discriminative ability of a pathway expression profile and the size of the pathway, since the size of a pathway may indicate either complexity or extent of characterization of the pathway. to examine whether such a relationship exists, for each of the fourteen datasets, the  <dig> pathways were ranked by student's t-test p-value. at each rank, a box plot was prepared to summarize the sizes of the pathways occupying that rank in the fourteen datasets. then the median pathway sizes are joined to show the overall trend between size and rank . overall, there were no strongly discernible trends that are suggestive of the size-rank relationship of pathways. another potential problem of the pathway-level aggregation approach is a possible correlation between pathways whose member genes partially overlap. for such pathway pairs, a pathway that is actually irrelevant to the given phenotype may assume a discriminative expression profile merely because it shares many member genes with the other relevant and genuinely discriminative pathway. it is desirable to avoid identifying such an irrelevant pathway as discriminative since it would otherwise confound the interpretation of the results. in the domain of functional enrichment analysis, this problem has been addressed by approaches such as performing separate analyses on the shared and unique member subsets in the pathways  <cit> , and giving smaller weights to the genes that assume intermediate positions in the pathway network topology, which are likely to be shared among pathways  <cit> . similar lines of approach may be possible in the domain of pathway-level aggregation.

there are four major strengths in the evaluation scheme adopted in this study, which raise validity of the reported results. first, the evaluation is comprehensive due to the use of seven pairs of related but independent datasets. evaluating the performance under a multitude of datasets encompassing various phenotypes helps to draw a generalized conclusion. as shown in figure  <dig>  both the median and the distribution of accuracies varied across the seven phenotypes. if only the datasets from a couple of phenotypes had been used for benchmarking , it would have been incorrectly concluded that the six compared methods did not differ in their median accuracy. second, the evaluation is stringent by externally validating classification accuracy on independent datasets. third, the evaluation is transparent since the classification accuracy was examined as a function of feature set size , instead of at a fixed arbitrary number of features, or an optimized number of features that results in the best performance in the validation dataset  <cit> . while the resultant fluctuations in accuracy across the feature set sizes  may make the performance comparison less evident, they transparently show that the expression profile of top-ranked differentially regulated pathways might be discordant between datasets. fourth, the evaluation was also done with respect to the reproducibility of pathway signatures by examining correlation of pathway t-statistics between datasets. its results further substantiate the discordance of pathway signatures between datasets, especially under mean corgs and pls-based aggregation.

there are also three minor contributions in this study. first, the collection of seven pairs of related but independent gene expression datasets can be used for benchmarking analysis of any methods based on gene expression data. second, the sign ambiguity of pcs in pca has been explicitly stated and resolved. some of the previous studies that used pca as an aggregation method either overlooked the sign ambiguity issue  <cit> , or simply pointed out that the pca-aggregated expression profile is not readily interpretable since it does not capture the direction of expression changes of pathways  <cit> . the present study explicitly stated the issue and followed a simple available approach that corrects the signs of pc scores so that the pc scores are positively correlated with the pathway's average gene expression profile  <cit> . an alternative solution  <cit>  has also been proposed in the field of chemometrics, in which the sign of pcs are determined by computing the sign of the sum of inner products between pc and all data points in the dataset. a preliminary analysis employing this approach did not result in better classification accuracy , thus it was not considered further in the analysis. third, the present study also explicitly stated and resolved the sign correction issue of latent components in pls, which has been neither stated nor resolved in a previous study that used pls as a pathway-level aggregation method  <cit> .

in light of the findings obtained from this study, it appears that there is both room and necessity for developing a novel method for pathway-level aggregation. on one hand, considering that averaging the expression profiles of all pathway member genes  results in the lowest accuracy, it is remarkable that simply removing half of the genes with lower t-statistics  leads to the highest accuracy . on the other hand, any method that is dependent on the pathway's overall change direction, as in mean corgs and pls, is likely to manifest the discordance between independent datasets. this issue needs to be considered and resolved in developing a novel method, since one of the expectations in pathway-level aggregation has been that the expression of the pathway as a whole may become more consistent, predictive, and reproducible across independent datasets despite gene-level inconsistencies  <cit> .

CONCLUSIONS
in conclusion, this study evaluated and compared the six methods for pathway-level aggregation of gene expression data. comprehensive and stringent evaluation was made possible by collecting seven pairs of related but independent datasets encompassing various phenotypes. the evaluation was performed with respect to classification accuracy, validated both internally and externally, and by examining the correlative extent of pathway signatures between the dataset pairs. the best accuracy and correlation were obtained when pathway-level expression profiles were derived by assess and mean top 50%. thus these two methods are suggested to be the preferable solutions. the lowest accuracy was obtained from mean all. pls and mean corgs gave rise to the largest extent of discordance in the pathway signature correlation. the analysis shown in this report also implies that there is both room and necessity for developing a novel method for pathway-level aggregation.

