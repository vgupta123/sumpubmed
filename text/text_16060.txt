BACKGROUND
mass spectrometry  has been one of the most used tools to analyze large biological molecules since the introduction of the soft ionization methods, such as electrospray ionization  and matrix-assisted laser desorption/ionization . for this reason ms is increasingly being used in proteomics. in particular, ms is exploited in proteomics to cope with two main tasks: determination of proteomic profiles of several samples for differential studies  and the identification of proteins or characterization of post-translational modifications  in a biological sample   <cit> .

the widely used protocols for protein identification or characterization of ptms are pmf  and pff   <cit> . maldi-tof is the platform generally exploited for pmf, whereas different platforms are used for pff   <cit> . electron capture dissociation  combined with esi-fticr is the most powerful technique for characterization of intact proteins  <cit> . for all these platforms the determination of the monoisotopic masses of the detected ions  is one of the main steps of the data analysis and interpretation; in fact, every meaningful conclusion of the proteomic studies depends on the extracted peak list.

on the other hand ms has been used also for protein profiling. the aim of these studies is to discover the differences between the proteomic profiling of samples representing different conditions . in this field, apart from the new approaches of quantitative proteomics , an important ms platform is seldi-tof that differs from maldi-tof for the presence in the sample preparation of one or more protein chips , expressly developed to selectively capture proteins  <cit> . spectra obtained from different subjects are generally considered in these studies. it is well recognized that the main problem in differential analysis is the high number of features  in each spectrum, known as high-dimensionality-small-sample problem  <cit> . several approaches have been proposed to extract a reasonable number of significant features from the whole spectrum, on which, subsequently, different classification methods can be successfully applied. peak list extraction is one of these approaches.

all the types of spectra described above, although quite different, require a similar analysis pipeline starting from the raw spectrum to the peak list. this procedure for peak list extraction is usually composed by the following steps: preprocessing, peak detection, peak selection, monoisotoping and charge state determination . the last operation of monoisotoping and charge state determination is the crucial phase of the procedure. during this step the monoisotopic masses of the detected biomolecules are determined by the analysis of the isotopic distributions  present in the mass spectrum. in addition to the procedures embedded in the software distributed with the instruments , several algorithms have been developed for peak list extraction. they are generally based on the comparison between each real id  in the spectrum and the corresponding theoretical id . apart from few approaches which try to find a global optimal solution   <cit> , the major part of the algorithms for feature extraction are iterative subtractive fitting methods  <cit> . then, the tid at certain mass is built generally considering an artificial sequence with the same mass of the unknown sequence but composed by only an "average" amino acid, called averagine proposed for the first time by  <cit> . such tid can be computed by one of the algorithms proposed in the literature  <cit> .

in the case of the seldi-tof spectra, both the low resolution power  of the spectrometer and the high values of the analyzed masses can determine an overlapping between the isotopic peaks of an id. unfortunately, it can happen in these conditions that the only detectable isotopic peak is the most likely one ; so it is necessary to use suitable models to determine the monoisotopic mass of the molecules. the major part of features reduction/identification procedures applied on such seldi-tof spectra do not exploit some chemical model, but they are based on algorithms like local maxima finding or wavelet transform  <cit> .

in this paper, a novel algorithm for peak list extraction from both low and high resolution mass spectra is presented. it includes and integrates in the same algorithm several ideas already reported in the literature by different authors and never used together. the most interesting innovative features adopted in the proposed procedure can be summarized in the following three points. first, it is suitable to analyze with good performance several kinds of mass spectra from both identification and profiling studies. in fact, the double model, on which the peak extraction algorithm is based, permits to analyze spectra characterized by a wide range of rp. rp of a mass spectrometer typically ranges from  <dig> for the low resolution maldi/seldi-tof instruments to  <dig>  for tof analyzers, but can reach even  <dig>  for ft-icr and  <dig>  for orbitrap  <cit> . note that, nowadays the only model-based approach applicable to both low and high resolution spectra is that proposed in  <cit> . other original features of the presented approach concern the strategy for building the tids. the procedure includes a tid prediction model more accurate than those used in the previous published algorithms  <cit> , exploiting the factional averagine approach proposed in  <cit> . at the same time, it permits the use of reference amino acids on which to build the tid alternative to classical averagine  <cit> , including an updated version of the averagine itself designed within this project on a recent release of the swissprot database. this helps to handle the wide variability of the amino-acid sequences of the detected proteins/peptides. this feature is particularly useful to manage ids with shape significantly different from the classical averagine-based one. no previous work raised the problem of updating the senko's averagine with the new available proteomic information. finally, an important original contribute of this paper is the successful attempt to manage the overlapping between ids and, at the same time, to correct the misalignment among scans/replicates. the management of the overlapping ids is the most difficult and frequent problem that the peak list extraction algorithms have to cope with. the proposed approach exploits the coefficient of correlation through the so-called subspectra  as suggested by  <cit> . in addition, the algorithm proposes, for the first time, to exploit in the peak detection the coefficient of correlation among peaks calculated on the subspectra. subspectra/replicates are a great available source of information often unused by the most widely used tools. for example, in order to produce a single seldi/maldi-tof spectrum, many scans  are performed in different positions of the sample spot, everyone generating a scan spectrum which can be considered as a replicate. all these scan spectra are usually simply summarized by the vendors' tools to obtain the representative mass spectrum.

the performances of the different versions of the algorithm were tested on a reference low resolution seldi-tof dataset , on a high resolution seldi-tof dataset from nci , on some maldi-tof mass spectra of the aurum database and on a reference esi-fticr ecd spectrum. finally, because the optional functionalities of the here proposed algorithm are fully effective only when many replicates/subspectra are available, an additional original maldi-tof spectrum with many stored scans was considered.

methods
in this section the model-based procedure for peak list extraction from different kinds of mass spectra is presented.

the input data of the algorithm can be a single proteomic mass spectrum . for a successful application of the procedure the input signal must be acquired in "profile mode" . moreover, the algorithm can analyze also a set of subspectra composed by different scans of the same sample or by correlated spectra of different samples . these multiple spectra will be indicated as replicates. when m replicates are available, first a vector of the n m/z values common to all the spectra is derived and then an nxm matrix, which contains the intensities for all the spectra, is computed. the sum of the intensities on the same row of this matrix is considered as the representative spectrum of the experiment. obviously, when only a single spectrum is available, the representative spectrum coincides with the acquired one.

the procedure presented in this paper requires a preliminary elaboration  <cit> , described in the first subsection, consisting in: i) the definition of the three reference amino acids  to exploit for tid calculation, i.e. the averagine proposed in  <cit> , the leucine, and an updated version of the averagine based on the release  <dig>   of the swissprot database; ii) the computation and storage of the ids for a series of artificial sequences composed by such reference amino acids in order to speed up the computation of the tids. these two operations do not belong to the analysis of mass spectrum, but the produced output will be necessary for each analysis.

in addition to the choice of which reference amino acid to use for the analysis, the algorithm requires to set the following two parameters which depend on the input data:  an initial guess of the rp  of the instrument around which the effective rp  will be estimated by the algorithm itself; the maximum number of charges  which reasonably can ionize every molecule according to the used platform.

typically zmax should be set to  <dig> for maldi spectra,  <dig> or  <dig> for seldi spectra , whereas for an esi-fticr ecd spectrum  an higher value is suitable .

the procedure for peak list extraction, discussed in the remaining part of this section, includes the following steps: i) preprocessing; ii) computation of all the possible tids for each m/z in the representative spectrum exploiting the results of the preliminary elaboration; iii) estimation of the effective rp of the instrument; iv) peak detection on the representative spectrum; v) calculation of an intensity threshold which is dependent on the signal and is used to remove noise peaks; vi) monoisotoping and charge state determination during which, for each id recognized in the spectrum, its monoisotopic mass, its intensities and its ionizing charge are extracted and reported.

moreover, two further functionalities to manage the overlapping among ids and to correct the misalignment of the replicates were developed and will be presented.

preliminary elaboration: creation of the reference isotopic distributions
the procedures for peak list extraction are usually based on the comparison between the real spectrum and tids. the method for tids calculation is based on the table of the isotopic abundances and on reference amino acids.

calculation of an isotopic distribution
the first problem is the definition of a method able to compute the id of a given complex molecule. recently, a method for a fast computation of ids has been developed  <cit> , improving the reference algorithm presented in  <cit> . however, because the calculation of the ids is performed once during the preliminary elaboration, speed is not one of the crucial requirements; so, a simple iterative algorithm, based on a matrix approach introduced in  <cit> , was adopted and implemented.

to better understand how the algorithm works, let us consider the molecule xmyn, whose elements x and y have a known isotope abundance distribution in nature . the basic idea is to compute the distribution of interest through an iterative procedure that builds the molecule of interest atom by atom. so, the id of the molecule xmyn is obtained after m+n- <dig> iteration steps. in each step, the vector a, representing the id of the "current" molecule, is updated by considering the vector b, representing the id of the next atom, in the following two substeps: i) the matrix c of the joint distribution of a and b is computed simply by multiplying the two distribution vectors; ii) the probability of the isotopic configurations with the same mass weights are summarized and the id of the "new" extended molecule is stored again in a. for example,

 ==→a b=c→a 

computation and storage of reference ids
the simple procedure just described cannot be straightforwardly applied because the atomic composition of each charged biomolecule detected by the mass spectrometer is not known and only the monoisotopic mass is available. the id can be approximated by the id of a virtual sequence having the same monoisotopic mass but composed by a suitable number of residues identical to the reference amino acid. this id, called tid, can be computed by the matrix approach described above. in this work, the following three reference amino acids are alternatively considered.

 <dig>  the averagine proposed in  <cit>  by senko et al.:

 ave=c <dig> h <dig> o <dig> n <dig> s <dig> = <dig> da 

 <dig>  the leucine, a real amino acid, which has the most representative atomic composition among all the other residues, because it is the most frequent amino acid in nature  <cit>  and it shares its formula with isoleucine:

 leu=c6h11o1n1s0= <dig> da 

 <dig>  an update version of averagine, that we have built on the release  <dig>  of swissprot:

 avu=c <dig> h <dig> o <dig> n <dig> s <dig> = <dig> da 

the calculation of a tid, give a monoisotopic mass, is computationally very expensive, so it cannot be performed for every id detected in a spectrum. moreover, it could be necessary to apply the reference amino acid procedure on monoisotopic masses which are not an exact multiple of the weight of the reference amino acid. for these reasons a preliminary elaboration is performed and a great number of tids are stored. for every reference amino acid, all the artificial sequences of n residues, with n between  <dig> and a number such as the mass of the sequence is about  <dig> da , are generated and their ids calculated. for computational reasons, only the first  <dig> isotopic peaks starting from the monoisotopic one are stored. the same operation is performed also keeping  <dig> da as limit . subsequently, when spectra are analyzed, the stored ids lower than  <dig> kda are considered by default by the peak list extraction procedure. however, if the range of the input mass spectrum overcomes  <dig> kda then the stored ids lower than  <dig> kda are automatically exploited.

preprocessing of the spectra
a baseline correction algorithm is applied twice on all the input spectra to remove the systematic components of the noise  <cit> . other popular preprocessing algorithms, such as smoothing, normalization or alignment, are not used in this paper in order to preserve as much as possible the information contained in the acquired spectra, even if a sort of smoothing is indirectly performed as result of the summarization of the replicates. however, additional smoothing algorithms, like lowess or savitzky-golay, were implemented and could be applied too  <cit> . conversely, normalization must not be applied, so that the contribution of each subspectrum  in the representative spectrum is proportional to its total ion current. a procedure for spectra alignment will be discussed as an optional functionality. when replicates are available, a quality control is applied by removing the spectra with a coefficient of correlation against the representative spectrum lower than  <dig> .

computation of all the possible tids
for each of the m/z values in the representative spectrum a vector of predicted intensities of the first  <dig> isotopic peaks are computed by interpolating the results of the preliminary elaboration. this operation is repeated for each of the considered reference amino acids.

resolution power estimation
given the spectrum to analyze, it is necessary to know the rp of the instrument which generated the data. the user usually knows the nominal rp of the instrument, but often it does not exactly correspond to the rp observed in the data. it happens because the rp of the instrument gets worse over time; moreover the misalignment error among the subspectra, which are summed to build the representative spectrum, contributes to the worsening of the final rp. for this reason, a procedure able to estimate the really observed rp has been designed.

the representative spectrum is divided into a predefined number of intervals , everyone containing the same amount of points , and for every interval the m/z with maximum intensity is considered. this maximum is considered as the most likely peak of an id and the procedure for monoisotoping and charge state determination  is applied by varying the rp around the rpin parameter. a series of different rps are tested on the maximum of each interval, obtaining the corresponding fitting scores. so, the mean among the fitting scores obtained for every rp is calculated and the rp to which corresponds the minimum of such means is finally selected as estimated rp .

peak detection
the proposed methodology calculates the positions of all the local maxima in the representative spectrum, considering them as possible isotopic peaks. in particular, the maximum value is calculated within a moving window of width /rpest for each m/z values of the representative spectrum; the set of these maxima forms a "maximal curve". a local maximum of the maximal curve is detected as central point of a region starting where the derivative passes from a positive value to a not positive and ending where the derivative passes from not negative to a negative value. an example of peak detection is shown in figure  <dig>  for simplicity, the error is calculated assuming that all the ions are mono-charged.

building of the intensity threshold
a signal-dependent intensity threshold to filter out noise peaks is derived in the following way. the distribution of the intensities of the local maxima calculated in the previous step is considered and the noise peaks are assumed to be spread in gaussian way . the spectrum is analyzed by a moving window: the window width depends on the mass of the central m/z value, and it is inversely proportional to the density distribution of the peptide/protein masses of a reference database . a gaussian curve  is estimated for each window, and the value of the intensity threshold referred to the m/z at the center of such window is set to μ+2σ. this limit is chosen to minimize as much as possible the false positives . finally, the full intensity threshold curve is obtained by linear interpolation of the threshold values computed for all the windows. all the peaks whose intensity is lower than the threshold curve are discarded, while the remaining peaks are included in the vector peaks.

monoisotoping and charge state determination
starting from the vector peaks, the list of the detected ids is generated applying the following steps .

 <dig>  the peak peaksi with the lowest m/z among all those in the vector peaks is considered as reference peak.

 <dig>  if peaksi is over the intensity threshold , the algorithm proceeds with the next step, otherwise it is removed from the vector peaks and the algorithm restarts from the step  <dig> 

 <dig>  the charge zj of the selected molecule is set to  <dig> and further incremented until zmax.

 <dig>  given rpest, zj and peaksi, if mzi/rpest <1/zj, i.e. isotopic peaks are well-separated, the reference peak is the monoisotopic one, otherwise the most likely peak is taken as reference and the monoisotopic one is defined by a suitable regression model.

 <dig>  the first reference amino acid  is selected among those considered.

 <dig>  given zj, ammsk and the monoisotopic mass associated to peaksi, the related tid, computed as already described, is retrieved. the smallest peaks of tid are removed, keeping only those peaks whose intensity is over one thousandth of the maximum of the tid. a region of the representative spectrum around the considered peaksi is selected by setting its two boundaries before the first isotopic peak and after the last considered one .

 <dig>  tid is refined adding a gaussian bell with mean in correspondence of every isotopic peak and standard deviation σ = peaksi/. this formula was derived by considering that the rp is defined as m/Δm, where Δm is the minimum distance between the apexes of separable peaks  and that the standard deviation σ is correlated to fwhm as follows: fwhm = 22ln2σ ≈  <dig>  σ. the absolute intensity of each peak is calculated by setting the reference peak of the tid equal to the intensity of the peaksi in the representative spectrum and consequently scaling the whole tid, considering also as local residual baseline the lowest intensity of the region.

 <dig>  tid is shifted within the region by following two types of movements, maximizing the goodness of fitting of tid against the real spectrum. the first movement has step-width equal to 1/zj and then, for each of the tried steps, tid is further slightly shifted for every m/z values within an interval whose range dependent on rpest. note that, when the reference peak is considered by the algorithm as the monoisotopic one following the rule of the step  <dig>  it could occur that the real monoisotopic peak is under the intensity threshold previously defined and then such a peak has been wrongly removed from the vector peaks. in this case, the considered peak could be really the most likely one, so, the tid, as first movement, has to be shifted to the left for how many are the isotopic positions between the monoisotopic and the most likely peak at the mass under investigation. on the other hand, when the most likely peak is chosen as reference in step  <dig>  the first movement of tid is performed by a shift of one isotopic peak position on the left and one position on the right. this is done because of the error which could be made by the regression model in predicting the position of the most likely peak.

 <dig>  to evaluate the goodness of fitting of the tid against real data, a score is computed as the sum of absolute differences evaluated in correspondence of some points appropriately chosen as follows. if zmax =  <dig> only the position of the reference peak and some points at the left of the estimated monoisotopic peak are taken into account to avoid errors due to id overlapping. conversely, when zmax > <dig>  it is necessary to evaluate the fitting of the whole tid  in order to correctly estimate the effective charge state of the ion. in the case of esi, because low ionizing charges are less probable, the fitting score is increased when the number of the charges decreases.

 <dig>  if no more reference amino acid has to be considered, the algorithm proceeds with the next step, otherwise the next reference amino acid is selected and the algorithm restarts from the step  <dig> 

 <dig>  if the tested charge zj value is already equal to zmax, the algorithm proceeds with the next step, otherwise zj is increased of one unit and the algorithm restarts from the step  <dig> 

 <dig>  the tid obtaining the best score  is selected. if this best score is over a predetermined score threshold , peaksi is removed from peaks vector. if such score is under such a threshold, the tid is stored in the peak list and subtracted from the real spectrum. in particular for each tid the corresponding monoisotopic mass, charge and intensity are considered. the sum of the intensities of all the peaks of tid is taken as intensity, instead of only the intensity of the most likely peak. the reason is that it is considered a more accurate measure of the real quantity of molecules reaching the detector .

at last, all the peaks involved in the computation of the score and in correspondence of which the tid fits well with the real spectrum  are removed from the peaks vector.

 <dig>  if there are still some remaining peaks in peaks, the algorithm restarts from the step  <dig>  otherwise the peak list is fully generated.

optional functionalities
when replicates are available, the procedure has two further functionalities that exploit the correlation among subspectra. these two functionalities are useful both during rp estimation and the final step of monoisotoping and charge state determination.

management of overlapping ids
as previously described, the fitting between a tid and the real spectrum is evaluated by the sum of the absolute differences in correspondence of the isotopic peaks, but in case of overlapping between ids some troubles have to face . in order to successfully manage also the ids overlapping, the score is computed by weighting the differences on the basis of the coefficient of correlation between the reference peak and each peak of the tid, calculated through the replicates . in this way, an overlapping peak has a low weight because it has a low correlation with the reference peak. moreover, during the step  <dig> of the algorithm described above, not only the peaks well-fitted by the tid will be removed from the initial vector peaks, but also all the peaks characterized by an high coefficient of correlation with the reference peak.

correction of replicates misalignment
given the region identified in the step  <dig> of the procedure for monoisotoping and charge state determination, every replicate is appropriately shifted within this region in order to be well-aligned to the representative spectrum. the shift is performed in order to maximize the correlation between every replicate and the representative spectrum; in particular the correlation is calculated only in correspondence of the most correlated points. then, the representative spectrum is recalculated in the region under investigation, considering the best alignment of replicates. the further operations will be performed on the new representative spectrum. this operation is applied on every analyzed rid. an example of misalignment correction is presented in figure  <dig> 

RESULTS
the performance of the overall procedure was tested on spectra characterized by different values of rp from both profiling and identification studies. before reporting and commenting results, the main comparison strategy usually adopted in the literature in the different contexts will be discussed.

data from identification studies
in this context all the procedures for peak list extraction are usually evaluated on spectra obtained from sample of known proteins or peptides, but so far no standard protocol has been established. the measure more commonly used is the precision  or more frequently the number of peaks correctly extracted  <cit> . some of these algorithms are further evaluated considering the impact on the protein/peptide identification; this can be estimated by analyzing the improvement of the score used to rank the candidate peptides/proteins  <cit> . finally, some works analyze the performance of the different methods pointing out the attention in a specific region of the spectrum particularly interesting or also evaluating the running time  <cit> .

therefore, the procedure here proposed was tested also on high resolution data from identification studies following these guidelines. some maldi-tof spectra of the aurum database, an esi-fticr ecd spectrum and an additional maldi-tof spectrum for which many replicates were stored were considered. performances were measured in term of peak retrieval precision and, in the case of pmf studies, considering also the improvement in term of the mascot protein identification score. the esi-fticr ecd spectrum was evaluated also showing the results in a particularly complex region of the spectrum. some evaluation in term of running time will be reported in the conclusions.

maldi-tof spectra
the method proposed was tested on some maldi-tof spectra of aurum database obtained from the analysis of  <dig> well-known proteins  <cit> . the aurum database is a collection of both pmf and pff mass spectra of well-known proteins  acquired by maldi-tof and maldi-tof/tof platforms. it is intended to be a reference set of spectra available to train and test algorithms  <cit> .

the proteins having at least four replicate spectra were selected to test our procedure also with optional functionalities. then, a further selection criterion was adopted in order to consider only spectra which permitted a good protein identification in order to be able to distinguish between true positive  and false positive  peaks and calculate the precision. the spectra satisfying these criteria where related to  <dig> different proteins.

the theoretical masses of all the possible peptides generated from the digestion of each protein were derived in silico, being the identity of the  <dig> proteins known, as well as the enzyme used for digestion and all the possible ptms produced by the experiment  <cit> .

thanks this information, the algorithm was evaluated following two different perspective.

• first, the algorithm was evaluated in terms of precision . in fact, peak list extraction can be considered as a classification problem, characterized by some positive classifications , among which the tps are all the extracted peaks whose monoisotopic masses match with those of the theoretical peptides. so, the overall precision is calculated as #tp/. to make comparable the performance of different algorithms, we considered the same number of extracted peaks. in particular, because the two manufacturer-provided software  does not automatically put a significance cutoff in the ranked peak list extracted from the spectra, we consider for all the software the a number of peak equal to that provided by massspec algorithm .

• then, for data coming from pmf experiment, the accuracy of the peak list extraction procedure was evaluated in terms of improvement of the reliability of the protein identification. mascot tool was exploited for the protein identification starting from the peak list extracted from a spectrum  <cit> . the protein with highest score is usually considered as the unknown protein in the sample. the absolute value of the score can be a good measure of the reliability of this identification, but a better measure is represented by the distance  between the first and the second protein in the mascot ranking. the bigger this difference the greater is the reliability of the identification, i.e. the probability that the first protein is really the unknown protein of the sample.

as reported in table  <dig>  the basic version of massspec algorithm shows a better performance than the two reference software tools  in terms of both precision and Δsc, while the optional functionalities do not improve significantly the results because of the low number of available replicates.

default parameters: a advanced baseline correction, peak detection and peak monoisotoping; b mass measure and tof transform.

mean values are reported for  <dig> proteins of the aurum dataset

a maldi-tof spectrum with many scans
to fully test the real benefits of the optional functionalities on real data, a maldi-tof mass spectrum with  <dig> available scans  was analyzed. this spectrum was obtained from a spot containing trypsin-digested pdia1_mouse protein. after the quality control check,  <dig> scans were remained, allowing an excellent working of the optional functionalities.

results, reported in table  <dig>  still show better performance of massspec algorithm compared to the two reference tools. moreover, there is a good improvement of the performance in terms of both precision and Δsc using the optional functionalities compared to the basic version of the algorithm.

an esi-fticr ecd spectrum
our algorithm was tested also on a complex high resolution esi-fticr spectrum previously published  <cit> . it is a plasma ecd spectrum of carbonic anhydrase  recorded by cornell 6t ftms. the results were compared to the ones obtained by two reference algorithms for ftms analysis: aid-ms and hardklor  <cit> . the assignment of the fragments to the peak list was done by ms-product  <cit> . the  <dig> ids, extracted by aid-ms and presented in  <cit> , were taken as reference. therefore, the comparison of these results was performed by considering the  <dig> peaks with highest intensities extracted by both massspec algorithm and hardklor.

precision and absolute number of assigned ids for different algorithms on a plasma ecd spectrum of carbonic anhydrase, by considering only theoretical fragments a, b, c, y, z and including water and ammonia losses

a published results. b default parameters.

monoisotopic mass and charges for the extracted ids shown in figure 5

data from profiling studies
in this context methods for peak identification  are usually applied on datasets of seldi-tof spectra coming from subjects in different conditions  and evaluated indirectly on the basis of the accuracy reached by different classifiers that exploit the extracted features  <cit> . moreover, in the majority of the works the algorithms are tested more directly on spectra obtained from mixture of known polypeptides  <cit> ; in this way some metrics typically adopted to compare predictive tools like sensitivity and fdr can be calculated. the relationship between sensitivity and fdr is often used to assess the performance of a peak list extraction algorithm. then, the approach proposed in this paper was tested on the camda  <dig> dataset  <cit>  which permits to calculate sensitivity and fdr, being composed of spectra coming from a known peptide mixture. unfortunately, this dataset is composed only by low resolution spectra and no high resolution profiling data obtained from known mixture of protein are available in literature. for these reasons the "ovarian cancer" dataset provided by nci  <cit>  was considered to test the procedure also on high resolution spectra and, in this case, the algorithm was evaluated by the classification accuracy.

low resolution seldi-tof spectra
the camda  <dig> dataset  <cit>  is composed by low resolution seldi-tof mass spectra. data are from the all-in-one protein standard sample  acquired using a ciphergen np <dig> chip. seven polypeptides are present in the sample and correspond to the following mass values:  <dig>   <dig>   <dig>   <dig>   <dig>   <dig> and  <dig>  the optional functionalities of the proposed algorithm can be used and tested because  <dig> replicates were stored and are available.

in order to assess the performance of the algorithm, the sensitivity and the fdr were calculated  by varying some parameters of the algorithm, mainly regarding the intensity threshold. the sensitivity was defined as the number of identified true positive peaks divided by the total number of real peaks. since the mixture contained  <dig> polypeptides, assuming a maximum of  <dig> charges for polypeptides the true peaks result to be   <dig>  it is important to note that the sensitivity so calculated can be underestimated because some peaks  could be not really present in the acquired spectrum.

the fdr was defined as the number of wrongly identified peaks divided by the total number of identified peaks. an extracted peak was considered as wrong if it is not within a tolerance window of ±1% around the m/z of one of the polypeptides in the mixture.

results were summarized by plotting the fdr-sensitivity curve. in particular, two curves were computed: one obtained considering independently every spectrum of the dataset , another one obtained considering all the  <dig> spectra in the dataset as replicates and building the reference spectrum . previous works demonstrated that the use of a reference spectrum  improves the performance of peak detection methods  <cit> . moreover, in this case, it is possible to exploit also the optional functionalities of the here proposed procedure.

fdr-sensitivity curves were computed also by using chiphergen proteinchip software  <cit> , that extracts the peak list following a two-step procedure: first a peak detection algorithm was applied on each spectrum, then the most frequent detected peaks are grouped by a clustering procedure. sensitivity and fdr values were obtained by varying some parameters of the peak detection algorithm and the clustering step.

in figure  <dig> these curves were compared with those computed in  <cit>  by using three others reference algorithms: the one implemented in the bioconductor process package, the wavelet denoising method proposed by  <cit>  and the approach based on the continuous wavelet transform  presented just in  <cit> .

high resolution seldi-tof spectra
this dataset of high resolution mass spectra is made publicly available by the center for cancer research of nci   <cit> . it consists of  <dig> mass spectra  obtained from serum samples. the goal of the study was to discover biomarkers for ovarian cancer in the low molecular weight serum proteome, amplified by binding to circulating carrier proteins such as albumin  <cit> .

every spectrum is composed by  <dig> different m/z values which are the candidate biomarkers . the procedure proposed in this paper considered the different spectra in each group of subjects as replicated and it was applied on the sum spectrum by setting the maximum number of charges equals to  <dig> and rpin equals to  <dig>  by using only the basic version  good results in term of feature reduction were reached:  <dig> different ids were extracted both singly and doubly charged. whereas by applying the full procedure  <dig> ids  were extracted. the application of the optional functionalities, especially that for the management of the id overlapping, is very useful, given the great complexity of the high resolution ms profile of the entire low molecular weight human serum . it was feasible thanks the great number of spectra  composing the dataset.

the intensity of the most likely peak of every id was stored for every spectrum in order to use this data for the subsequent differential analysis by classification algorithms finalized to discover a single or a pattern of biomarking biomolecules for ovarian cancer. two different machine learning approaches , implemented in the software weka  <cit> , were chosen and applied to  <dig> peaks further selected by a feature reduction procedure present in weka . performances were evaluated within a leave-one-out cross-validation framework. the choice of the classifiers was based on their capability to build a simple diagnostic model easily to understand and interpret.

the simple oner algorithm selects the minimum-error attribute to predict the class , discretizing continuous attributes  <cit> . the selected feature is the  <dig>  peak and the accuracy achieved is quite good, i.e.  <dig> % .

part is a method for generating "partial" decisional trees. in particular, it builds a partial c <dig>  decision tree in each iteration and makes the "best" leaf into a rule  <cit> . the accuracy obtained by leave-one-out cross-validation is  <dig> %. the list of rules built by the complete training set contains the  <dig> rules shows in table  <dig> and uses only  <dig> different features.

for example, the rule "if.  <dig>  ≤  <dig>  then no cancer" means that if the intensity at m/z  <dig>  is less or equals to  <dig> , then the patient to which the spectrum is related can be classified as healthy

better classification accuracy values were reached by other classifiers , but results of these methods are more difficult to interpret and to use as meaningful diagnostic models. all these results obtained starting from the peak list generated by massspec are not worse than those obtained in the literature applying other feature extraction algorithms on the same dataset  <cit> . the main advantage of using the peak list instead of other data mining techniques to extract relevant features is that peaks can be associated to ids and with further efforts possible to a list of peptides/proteins. this step from a clinical point of view is not irrelevant.

CONCLUSIONS
the best way to extract useful information from proteomic mass spectra is to generate the peak list composed by the monoisotopic mass, the charge and the intensity of each detected biomolecule. this is not a trivial task and its precision can be crucial to reach useful results both in identification and in profiling studies. notwithstanding, peak list extraction is widely applied to identification spectra, whereas in profiling studies the step of feature extraction is often performed by other data mining procedures like wavelet transform or simple local maxima finding, by ignoring the biochemical background.

in the procedure proposed in this paper a mass spectrum is modeled as a sum of the ids generated by the detected ions and determined by the rp of the instrument, the mass of the molecule and the acquired charge. because the algorithm for feature extraction is based on a double model, considering as reference both the monoisotopic and the most likely peak, it has been possible to extend the peak list extraction to the analysis of profiling spectra, making the procedure independent of ms platform in terms of resolution power.

the main goal of the proposed procedure is to improve the peak list extraction operation in terms of precision rather than reducing the computational time. due to the complexity of the mass spectrum of a biological sample, the algorithm for peak list extraction had to cope with many problems.  the high level of noise is faced by a sophisticated method to calculate a signal-dependent intensity threshold.  the wide variability of the amino-acid sequences of the proteins/peptides detected is handled by an improved prediction model for tids and by the possibility to use more than only one reference amino acid to build the tids.  moreover an update version of classical averagine has been designed; the obtained results demonstrates a good impact in using this residue because, among the three reference amino acids, it was often the best choice .  the problem of the ids overlapping, which more than the others affects the performance of peak list extraction, is solved by exploiting the correlation among replicates .  this correlation is used also to correct the misalignment among replicates.

the algorithm was tested on data from both identification and profiling studies. the peak lists extracted from spectra obtained from  <dig> proteins of aurum database prove that the algorithm often produce better results than two popular software  both in term of precision of ids extracted and in term of ability to improve the quality of the protein identification performed with mascot. the application of the proposed procedure on a maldi-tof spectrum of which many scans  were available demonstrates that the optional functionalities, when applicable, can significantly improve the performances. the algorithm was applied also on a complex esi-fticr ecd spectrum to test the performances for both esi data  and very high rp . the precision of massspec algorithm is comparable and, in some cases, better than some sophisticated algorithms previously published. if scans had been stored and made available, such good results could be certainly improved by using the optional functionalities, which could be very useful mainly to manage overlapping ids, that are very frequent in so complex spectra.

the results obtained on a low resolution seldi-tof dataset  are better than the results reached by some reference algorithms specifically designed for low resolution spectra, showing the best comparative performance at the lowest fdr values. the high values of accuracy reached on the "ovarian cancer" dataset using the attributes extracted by the proposed procedure demonstrate that it helps to extract suitable information also from high resolution profiling data.

the algorithm was evaluated also on simulated mass spectra to test its performance in terms of sensitivity, as well as precision. the obtained results were promising but are not included in this paper for the clearness of the presentation.

although the final goal was to achieve an high accurate peak list, the running time of the basic version of massspec algorithm is comparable with other similar software: e.g. the mean time spent for peak list extraction on aurum spectra was  <dig>  seconds using a quite standard sun workstation . obviously run time deeply dependent on the use of optional functionalities and on the value of parameter zmax. then it decreases using only one reference amino acid .

future developments of the procedure will concern its application on lc-ms data. so far, the method for peak list extraction was successfully applied on both ltq and orbitrap proteomic mass spectra  to improve precursor mass determination in pff experiments. furthermore, in this kind of experiments, we planned to implement an iterative procedure to select groups of subspectra neighboring in the chromatogram as replicates, for applying optional functionalities.

availability
the proposed procedure was implemented in matlab  and compiled with matlab compiler toolbox . the graphical user interface was developed using the matlab guide tool. the software tool, called massspec, exploits some functions included in the bioinformatics  and curve fitting  toolboxes. it is distributed with the runtime matlab libraries and does not requires any matlab license. a beta-version of the tool is available for windows and linux systems together with the installation instruction at the web site http://aimed <dig> unipv.it/massspec. the tool reads two kinds of input: a single mass spectrum, acquired in profile mode, both in ascii data file format  and in mzxml format, or a whole dataset of replicates as a folder containing a file for every spectrum. some test data  are available with the software tool to evaluate the proposed procedure. the implemented algorithm could be used to analyze mass spectra obtained by one of the considered ms-platforms  regardless manufacturers.

authors' contributions
nb led the design and the implementation of the overall procedure, its evaluation and drafted the manuscript. pm supervised the design of the procedure, its evaluation and finalized the manuscript. all authors read and approved the final version of the manuscript.

