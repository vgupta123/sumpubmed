BACKGROUND
profile-based methods of sequence analysis use multiple sequence alignments  to extract information about conserved features of a protein family, which are impossible to decipher from a single sequence. such methods increase both the sensitivity of homology detection and the quality of produced alignments  <cit> , mainly due to more accurate scoring of similarity between sequence positions. here, we address the problem connected to but different from the problem of scoring positional matches. we focus on detecting confident dissimilarities between profile positions that are suggested to be equivalent. in particular, we sought conservative p-value estimates for the comparison of individual columns in msa. such estimates have at least three practical applications:  evaluation and optimization of methods predicting propensities for residue occurrence at protein positions;  detection of potentially misaligned regions in automatically produced alignments and their further refinement; and  detection of sites of functional or structural specificity in two related families.

statistical analysis at the level of individual msa positions may be used to compare residue frequencies predicted from some model to the actually observed residue usage at the given position in sequence homologs. the model may represent, for example, a method for in silico sequence design that generates native-like sequences from a structural template. detection of discrepancies between the model and the real data would assist the analysis of the model's performance and its further improvement. to our knowledge, such statistical assessment has not been proposed up to date.

several approaches have been proposed to detect potential regions of low alignment quality in sequence-sequence and sequence-profile alignments. these approaches range from identifying low-scoring regions in pairwise alignment  <cit>  to more complicated schemes: comparing scores of the given alignment and the optimal alignment where this position is omitted  <cit> , or analyzing the consistency of a given position among different alignments produced with various parameters of alignment construction  <cit> . for multiple sequence alignments, positional residue conservation was proposed as a measure to detect potentially misaligned regions of high variability  <cit> . cline and co-authors  <cit>  compared several methods for positional evaluation of sequence-profile alignments and recommended the approach based on the analysis of near-optimal alignments  <cit> . however, detection of potentially misaligned regions in profile-profile alignments has not been addressed before.

when the analyzed alignment is highly reliable, detecting positions of significant dissimilarity may reveal sites that determine functional or structural specificity of otherwise similar proteins. several approaches have been proposed that use comparison of multiple sequence alignments in order to predict such sites  <cit> . however, these methods do not involve explicit estimation of statistical significance. bejerano  <cit>  has recently proposed a promising algorithmic approach to the exact p-value computation, which allows for a faster enumeration of possible outcomes. despite a significant improvement in the computational efficiency, the algorithm still requires a considerable time to process realistic data in 20-dimensional space of residue frequencies.

in this work, we consider approximate analytical estimates of p-value in two settings:  comparison of an alignment column to an emission vector of residue probabilities, and  comparison of two alignment columns. these estimates allow detecting cases where the null hypothesis  can be confidently rejected. we performed simulation experiments that show consistency of the estimates with the statistical model, and applied our method, peac , to the analysis of real msa.

RESULTS
theory
as the statistical null model of a multiple alignment column, we assumed independent random draw of residues according to a vector of emission probabilities. we represented randomly generated columns by vectors of residue counts n, with total count n equal to that of the real alignment column under evaluation.

statistical significance of similarity between a multiple alignment column and a vector of emission frequencies
null hypothesis h0
given alignment column  is generated by given vector of emission probabilities f. if this hypothesis is rejected, then the set of emission probabilities is inadequate for the description of the residue content in this alignment column.

the assumed null model of random columns corresponds to a multinomial form of ρ, which is difficult for analytical consideration. to calculate the p-value, we use the multivariate gaussian approximation of the multinomial distribution, based on the assumption of large statistical samples :



where x = {xi} is a random d-dimensional vector of residue counts of size , f is emission vector of residue frequencies,  is the mean vector of residue counts, Σ = ||cov|| is the covariance matrix. this approximation of p.d.f. allows for the analytical expression for the p-value :



where  is a regularized gamma-function, d is dimensionality of vector f. thus, p-value is described by a χ <dig> distribution with  degrees of freedom.

random simulation shows consistency of p-value estimates with null model
in order to analyze whether the gaussian approximation allows reasonable p-value estimates, we performed extensive random simulations and tested consistency of p-values based on this approximation ) with p-values based on the multinomial model. in particular, we used a set of residue frequencies f = {fi} <dig> to generate a large number Ω =  <dig> of random columns of a fixed size n, i.e. Ω sets of n residues drawn randomly according to probabilities fi. for each random column, residue counts n = {ni} <dig> were derived and the multinomial probability of its generation was calculated as , where  is the multinomial coefficient. all Ω generated columns were sorted by ρmult in the ascending order. for a given p-value p*, the column number Ωp <dig> was chosen from this sorted list. this column corresponded approximately to the multinomial p-value p*. this p-value was compared to our estimate pestim ) calculated for the chosen column in the gaussian approximation of multinomial distribution. for each value p* we performed  <dig> independent simulations and plotted average values of pestim against p*, which showed their general consistency. figure  <dig> illustrates the results for three typical sets of emission frequencies f derived from real alignment columns, and for three typical column sizes n. the accuracy of estimates becomes poorer for lower column sizes and more skewed frequency sets . however, even in such cases the accuracy of pgauss within orders of magnitude is sufficient for the purpose of detecting the pronounced dissimilarities with p <<  <dig> . thus, the error introduced by gaussian approximation still allows the use of p-value estimates under the initially assumed null model of random columns.

statistical significance of similarity between two columns of multiple alignments
null hypothesis h0
two observed columns m* and n* are generated by a single vector of emission probabilities. as the prior distribution of emission vectors, we use the maximum likelihood  estimate based on m* and n*. such prior should produce the conservative upper estimate of the p-value. rejection of hypothesis h <dig> would mean that the two alignment columns are highly dissimilar.

the p-value for this hypothesis is calculated in three steps:

a). given the two vectors of residue counts {n, m}, we produce the ml estimate of the p.d.f. for emission vectors f that can generate both columns simultaneously. we assumed a simple form of multivariate gaussian distribution and calculated ml estimates of its mean  and variance values  .

b). we use this p.d.f. θ as the prior to calculate the posterior probability ρ) that a pair of random columns {n, m} is produced by any single emission vector f. similarly to problem  <dig>  we use multivariate gaussian approximation of the multinomial distribution that assumes large total residue counts in the generated columns. the posterior probability density can be calculated as

ρ) = ∫ρ  θ  df     

c). using , we calculate p-value as the integral :



this value can serve as the upper estimate of the p-value, since the prior distribution θ is a ml estimate based on the observed alignment columns. the partial integral ∫ρ  dm dn can be calculated analytically for any emission vector f, but analytical calculation of full integral  is problematic. however, an approximate estimate of this value would suffice, since  expression  already contains approximations introduced by estimates of θ, ρ) and ρ); and  we are interested in a conservative estimate of the upper p-value limit. hence, we calculate an approximate upper estimate of p-value :



where erf is error function, and



random simulation shows consistency of upper p-value estimates with null model
to assess the consistency of our estimates with the null model, we performed the following simulation experiments. a random emission vector of residue frequencies f was used to produce a column of size n by random draw according to these frequencies. having the vector residue counts n in this column, we produced another vector of counts m that made our estimated p-value pestim equal to the specified value p <dig>  to produce this vector, we considered sets of residue counts as points in multidimensional and randomly chose a straight line passing through the point n. on this randomly directed line, we found the point m as the solution of equation pestim = p <dig>  where pestim is defined by formula . thus, we generated a pair of columns that corresponded to the specified p-value according to the peac estimate. we compared this estimate to the actual p-value p* calculated for the generation of m and n by the original vector f. as shown by the plot of p* against pestim , a particular estimate of p-value may correspond to various actual values p*. however, for low p-values, i.e. for the range of our interest, peac systematically produces pestim higher than actual values p*, as expected from the upper p-value estimates. these conservative estimates ensure the absence of false positive results among detected cases of significant dissimilarity.

we developed p-value estimates for the following null hypotheses :  a given alignment column is generated by a given set of emission residue frequencies; and  two given alignment columns are generated by a single set of residue frequencies. we applied both types of estimates to the analysis of real multiple alignments, detecting cases of significant dissimilarity where the null hypotheses were confidently rejected.

application
comparison of an alignment column to a frequency vector
using our method, we assessed the consistency between predictions of residue frequencies based on structural considerations, and the frequencies in multiple alignments of sequence homologs. specifically, we prepared a dataset of  <dig> pdb structures and made predictions of residue propensities at each position, based on local structural environment. in parallel, the sequences corresponding to these structures were used as queries for psi-blast searches, and profiles of detected confident sequence homologs were constructed . the effective residue frequencies at profile positions were compared to the structure-based predictions, and p-values for each position were estimated using peac. the histogram of produced p-values for all positions is shown in fig. 3a. these p-values ranged widely between 10- <dig> and  <dig> , with the median being approximately  <dig> .

to analyze the cases of most pronounced discrepancy between our structure-based predictions and residue frequencies observed among sequence homologs, we chose ~ <dig> protein positions  that had lowest p-values . these sites were located mainly in the secondary structure elements, most frequently at their ends, and corresponded to unusual local distortions of 3d conformations. we compared residue content in the corresponding subset of alignment columns to the whole dataset. as shown in fig. 3b, alignment positions with low p-values demonstrated unusually high average frequencies of negatively charged residues, glutamate and aspartate.

for a more detailed analysis, we considered the subset of  <dig> alignment positions with p < 10- <dig> that contained highly conserved d or e, and inspected corresponding d or e residues in tertiary structures. the vast majority of these residues were buried, as was indicated by the accessible surface area  of their carboxyl caps . when we excluded glutamates and aspartates whose charge could be neutralized by contacts with positively charged arginine, lysine or histidine, the remainig portion of the set was still comprised of mostly buried residues . these buried residues with acidic side chains did not form salt bridges with basic side chains, which is the most typical way of neutralizing a charge in hydrophobic environment. inspecting these positions manually, we found a less usual mode of charge neutralization, which involves contacts with other polar residues. a typical example of such conformation is a motif classified in the i-site database  <cit>  as aspartate beta bulge, located in the middle of a beta strand in bovine rhodanese . the contact between side chain oxygen of d <dig> and s <dig> distorts the regular beta-strand conformation. our scheme of structure-based frequency prediction considered only most common classes of local conformations that involve nearest neighbor residues. this scheme could not account for less usual residue contacts and therefore failed to predict a high conservation of buried acidic residues at this position, which may have functional or structural importance  <cit>  in summary, this application of our method assists detecting positions with discrepancies between the predicted and naturally occurring residue frequencies. a detailed analysis of these positions may highlight shortcomings of a predicting scheme and suggest possible directions for improvement.

comparison of two alignment columns
statistical comparison of two msa positions may be used in two applications.  in automatically produced alignments of sequences or structures, consideration of profiles of confident homologs helps to detect inconsistencies. according to our observations, these inconsistencies are caused mainly by alignment errors.  in the high-quality structure based alignments, where structural equivalence of residues is confident, the low p-values may indicate functional specificity of spatially aligned residues.

detection of errors in sequence alignments
as an example of application , we evaluated our method by ability to predict erroneous residue matches produced by an automatic sequence aligner , as compared to the high-quality reference alignments in a manually curated database, balibase  <cit> . for each balibase alignment, we  extracted individual sequences and generated their clustalw alignment;  for the top and the bottom sequences of balibase alignment, produced msas of their homologs detected by psi-blast; and  used the resulting alignment pair to estimate p-values for the sequence positions matched by clustalw.

we then sorted all clustalw positional matches by ascending p-values and classified them as true or false predictions of clustalw errors. for our purpose, the clustalw matches different from those in balibase were considered true positive predictions; whereas correct matches were considered false positives. having the ranked list of true and false positive predictions, we generated sensitivity curve . the curve shows the degree of discrimination between erroneous and correct positional matches. among the top  <dig> predictions, the method generated  <dig> false positives. up to ~ <dig>  true positives, the rate of false positive predictions is slowly growing, then this rate considerably increases. this point approximately corresponds to the p-values of ~10- <dig> 

detection of evolutionarily unrelated positions in structure-based alignments
we applied our method to detect profile dissimilarity between protein positions that are aligned by an automatic structure based method. specifically, we  collected pairs of protein domains that are structurally similar according to the dali alignments  <cit>  in the fssp database  <cit> ,  for each of these proteins, produced msa of homologs detected by psi-blast, and  used the resulting pairs of alignments to estimate p-values for the positions matched in fssp. we used two sets of the fssp domain pairs, with different sequence identities between the domains:  <dig> ± 1% ., and  <dig> ± 1% .

figures 5a,5b show the histograms of p-values produced for pairs of profile positions that correspond to structurally aligned residues. the distributions of p-values were different for the two ranges of sequence identities. for identities around 15% , the histogram had maximum at approximately  <dig>  10- <dig> and the median was approximately  <dig>  10- <dig>  for identities around 25% , the maximum was above  <dig>  and the median was approximately  <dig>  10- <dig>  which shows much better consistency between structure-based and profile-based alignments.

to analyze the most dissimilar profile positions, in each dataset we chose  <dig> % of position pairs that had lowest p-values . using insight ii suit for molecular modeling and simulation , we performed a detailed manual analysis of structural superposition for a portion of the corresponding structural alignments. we found that the majority of inspected positions were apparently misaligned. approximately 80% of these residues were located within  <dig> positions from a gap introduced in the structural alignment. vicinities of gaps generally correspond to less similar fragments of aligned structures, which are more difficult to superimpose and where alignment errors can occur more frequently.

we considered residue contents of the msa columns corresponding to these low-p-value position pairs, and compared these contents to the average residue frequencies in the whole msa datasets. in the set corresponding to  <dig> ± 1% sequence identity, the most pronounced difference was a higher frequency of aspartate at the position pairs with low p-values . in the set for  <dig> ± 1% identity, the low-p-value positions had higher frequencies of methionine, leucine and isoleucine .

we further concentrated on the aligned structural positions that showed unusual residue frequencies in the corresponding msa columns. in the set corresponding to  <dig> ± 1% sequence identity, we considered positions with highly conserved aspartate, whereas in the set corresponding to  <dig> ± 1% sequence identity, we considered positions with high combined frequency of methionine, leucine and isoleucine. in an attempt to exclude apparently misaligned positions, we considered only those positions that were distanced more than  <dig> residues from gaps in the fssp structural alignment. we selected and manually analyzed  <dig> of such positional matches. however, even among these selected matches most of the discrepancies were still caused by apparent alignment errors:  <dig> cases corresponded to structural misalignments , and  <dig> cases were caused by biased residue frequencies at profile positions, due to errors in psi-blast alignments of sequence homologs. the remaining  <dig> position pairs did not involve apparent errors of either dali or psi-blast. these pairs might represent real differences in residue preferences at structurally equivalent positions.

alignments of strands a illustrate superposition errors as the typical source of low p-values for automatic structural alignments. dali  constructed the correct alignment, which was the same as the manual structure alignment  and profile-based alignment . this alignment corresponded to high positional p-values. mammoth  apparently misaligned strands a by introducing a one-position register shift, which resulted in the low p-values for this region .

structural alignments of strands b represent a rare example of an automatic alignment that corresponds to low positional p-values and yet is correct from the structural viewpoint. both dali and mammoth produced the alignment consistent with the confident manual superposition. this structural superposition correctly aligns zinc-binding residues . however, such alignment corresponds to low positional p-values, indicating a significant difference between structure-based and sequence-based position similarity. the optimal profile-based alignment  has a one-residue shift that dramatically increases positional p-values in this region, but is inconsistent with the topology of the beta strands and zinc-binding sites. such a shift might represent a change in the structural roles of related protein positions in remote homologs. indeed, zinc binding role in penicillinase 1smla is transferred from residue d <dig>  which is related to the zinc binding d <dig> of glyoxalase ii , to the neighboring s <dig>  <cit> . thus, in the case of a high-quality structural alignment, low positional p-values may indicate evolutionary dissimilarity of spatially superimposed residues. such cases, however, comprised a minor portion among automatic structure-based alignments and were overwhelmed by the cases of misalignment.

prediction of structurally and functionally specific protein positions
as an example of possible predictions of functionally specific regions, we considered positions in multiple alignments of sequence homologs for two structurally similar but evolutionary divergent proteins: rna 2'-o ribose methyltransferase from t. thermophilus  <cit>   and hypothetical e. coli protein ybea . these proteins possess the same α/β knot fold but belong to different scop families, spou-like rna 2'-o ribose methyltransferase and ybea-like, respectively. using manually curated structure-based alignment of the two proteins and msas of their homologs detected by psi-blast, we considered structurally equivalent positions that were well aligned in space  but showed significantly different residue contents in the msas . we found  <dig> such positions, the majority being concentrated in the region of dimer interface, which includes the 'knotted' c-terminal helix d . in rna 2'-o ribose methyltransferase, this region is suggested to be crucial for the molecular dimerization  <cit> . positions detected in other regions mostly correspond to buried residues of hydrophobic core. the discrepancies in residue content at these positions may reflect different structural solutions for the sidechain packing within the core, as in the case of buried residues in helix c . thus, the detected positional differences between spou-like and ybea-like families highlight the functional importance of the 'knotted' c-terminal helix and may suggest a family-specific mode of dimerization and dimer activity for the hypothetical protein ybea.

discussion
here, we applied the concept of statistical significance to comparison of single positions of multiple sequence alignments. we proposed rigorous problems of the p-value estimation for the comparison of an alignment column to an emission frequency vector; and for the comparison of two alignment columns. we suggested approximate analytical solutions to these problems and applied the resulting p-value estimates to the analysis of protein families.

comparison of an alignment column to an emission frequency vector
using our method, we compared residue conservation among sequence homologs and residue propensities predicted from local structural environment. the cases of the highest discrepancy between observed and predicted residue frequencies were enriched with positions containing conserved buried residues d/e. many of these acidic residues do not form a salt bridge with basic side chains, but use contacts with polar residues to neutralize the negative charge in hydrophobic environment. surveys of such contacts formed by aspartate residues were previously performed by singh and thornton  <cit>  and by fiser et al.  <cit> . the observed residue conservation may indicate the importance of such motifs for protein structure or function. the structure-based statistic for the prediction of residue propensities used only common classes of structural environments and considered closest neighboring residues in polypeptide chain. hence this statistic was unable to predict the found conservation of buried glutamate and aspartate. detection of such contradictions between predicted residue propensities and actual residue frequencies in msa has three main implications. first, analysis of these contradictions can assist evaluation and further optimization of the predicting schemes, including knowledge-based potentials  <cit>  or environment-specific substitution tables  <cit> . second, the patterns of atypical relations between residue conservation and structural conformation may point to local motifs of potential structural or functional significance. third, such atypical patterns, which are unlikely to coincide in two proteins by chance, may serve as signatures for homology detection.

comparison of two alignment columns
we used our estimates to assess similarity between msa positions. first, we evaluated our method by detection of erroneous residue matches produced by an automatic sequence aligner, clustalw  <cit> . the evaluated automatic alignments were compared to the high-quality reference alignments in a manually curated database, balibase  <cit> . second, we estimated p-values for msa positions corresponding to structurally aligned residues in the fssp database of automatic structure based alignments  <cit> . we found that among detected cases of highest dissimilarity, the vast majority was caused by local structural misalignment. correction of such alignment errors typically produced an increase of p-values . these results suggest a potential value of the method for the detection of misaligned regions in automatic alignments.

in our set of fssp structural alignments, correctly aligned sites of low p-value were very rare. such sites correspond to structurally equivalent positions that have different residue content in two related families. to illustrate the detection of such family-specific protein positions, we used a high-quality manually curated structural alignment of distantly related spou-like and ybea-like families of the same α/β knot fold . in addition to specific preferences for sidechain packing in the hydrophobic core, the statistically significant positional differences emphasized the importance of the 'knotted' helix , which is essential for dimer formation  <cit> . these differences may suggest a family-specific mode of dimerization and dimer activity for the hypothetical protein ybea.

CONCLUSIONS
we proposed p-value estimates to assess statistical significance for  comparison of a single position in a multiple alignment to a set of emission residue frequencies; and  comparison of two alignment positions. computational implementation of these estimates showed its potential value for several important tasks in sequence analysis:  evaluation and optimization of methods predicting propensities for residue occurrence at protein positions, such as protocols for in silico sequence design;  detection of potentially misaligned regions in automatically produced alignments and their further refinement; and  detection of sites that determine functional or structural specificity in two related families.

