BACKGROUND
structural biology relies heavily on structure comparison methods. these methods are routinely applied in order to establish structural, evolutionary and functional relationships between proteins  <cit> . in general these methods provide a measure of structural similarity between proteins, which is used to identify similar folds and evolutionary related proteins. most of the methods also generate an alignment that defines the residues that have a structurally equivalent role in the proteins compared. when the aligned proteins are assumed to share a common ancestor, a structure alignment supports the identification of evolutionary equivalent residues. since protein structure is more conserved in evolution than sequence, structure alignments of remote homologous proteins are considered more reliable than sequence based alignments to identify the equivalent residues. the structure alignment of functionally related proteins provides insights into the functional mechanisms, and has been successfully applied in the functional annotation of proteins whose structures have been determined  <cit> .

when aligning structures the nature of the structural models should also be taken into account. experimental structural models are usually determined by x-ray crystallography or by nuclear magnetic resonance spectroscopy. the atomic coordinates obtained from these experiments are always associated with some degree of uncertainty resulting from experimental errors and from the intrinsic flexibility of the proteins or from atom vibrations. these uncertainties become problematic especially for some comparison methods that assume that the protein backbone is formed by regular secondary structure elements, and correct assignment of these elements might not be possible for models with poor resolution. additional difficulties originate from the nature of the protein structural relationships. similar structures might display considerable structural variability and are often related by several insertions and deletions  of considerable size. structural variation is noticeable in the comparison of alternative conformations of a single protein, and reflects the intrinsic protein flexibility  <cit> .

structural similarity between different proteins is the result of evolution from a common ancestor if the proteins to be compared are homologous, or they are the result of convergent or parallel evolution  <cit> . the evolution of proteins involves mutations of single residues, insertions and deletions  <cit> , gene duplication or fusion and exon duplication, deletion or shuffling  <cit> . such changes accumulate over time and result in structural differences between the two proteins. these changes preferably affect the surface regions of the proteins, except for the functional sites which tend to be conserved if the protein retains the same molecular function. the hydrophobic core, essential to maintain structural integrity, in general remains relatively conserved  <cit> . homologous proteins might also be related by circular permutation or shuffling of the protein sequence, which results in a non-sequential sequence or structure alignment between the two structures. circular permutations are the result of gene duplication, exon shuffling or post-translation modifications  <cit> .

repetition is a common feature of protein structures, and is observed at different structural levels. these repetitions occur at the level of the secondary structure elements, at the level of supersecondary elements, at the subdomain level or at the domain level. recurring substructures imply that protein structures can be aligned in alternative ways with comparable structural similarity scores. the existence of alternative alignments has been investigated before  <cit> .

currently there are a considerable number of structural comparison tools available to the structural biologist  <cit> ). in general, these methods compare the geometry of the cα backbone atoms, but they are based on different algorithms and have been designed for various applications. ce  <cit>  and dali  <cit>  are two popular methods for searching similarities in a structural database and for pairwise comparison of two structures. both methods search for compatible pairs of fragments with similar intramolecular cα distances. then they use different strategies to combine these fragments into a final alignment. methods like fatcat  <cit>  are able to align subdomains in different relative orientations, resulting from protein flexibility or from evolutionary divergence  <cit> . another strategy is to consider not only the backbone geometry but also the physicochemical environment of each residue in order to align the two structures  <cit> . this strategy is followed in the sheba implementation  <cit> . some tools match secondary structure elements to obtain in an efficient way a first alignment that is later refined. matras  <cit>  in particular matches secondary structure elements in the first stage of alignment. environmental properties and cα distances are then applied to obtain the final solution. matras applies a markov transition model of evolution to derive different types of scoring functions. some methods, like cα-match, do not take the protein sequence order into account and allow for non-sequential alignments  <cit> . cα-match in particular is based on geometric hashing and ignores connectivity between aligned residues, which is desirable for the comparison of folds and architectures and for the comparison of proteins related by circular permutation. other methods are able to align multiple structures  <cit> . finally, some tools perform very fast comparisons between a given query protein and a structural database, and provide structural similarity scores for each comparison but no alignment  <cit> .

so far structure comparison methods have been primarily evaluated in terms of their ability to identify proteins with similar folds or to identify homologous proteins  <cit> . they have also been assessed relative to the extent of structural similarity that is identified, where better performance corresponds to longer alignments and to better rigid body superpositions, or to a better score according to other geometric measures  <cit> . several methods have been the focus of these analyses, in particular ssap  <cit> , structal  <cit> , dali  <cit> , lsqman  <cit> , ce  <cit> , ssm  <cit> , ash  <cit>  and tm-align  <cit> . less attention, however, has been given to the objective analysis of the extent of agreement between alignments produced by different pairwise structure comparison methods. there is also a need to assess the accuracy of these structure based alignments regarding the correct identification of equivalent residues in terms of structure, evolution or function.

we analysed and compared pairwise structure alignments produced by six methods based on different algorithms: ce, dali, fatcat, matras, sheba and cα-match. first, ce and dali were applied to a representative set of remote homologous proteins comprising  <dig> structure pairs derived from the astral database  <cit>  . then we applied ce, dali, fatcat, matras, sheba and cα-match to  <dig> related protein pairs obtained from the sisyphus database  <cit>  . finally, these six methods were applied to a third set comprising  <dig> pairs that are challenging to align. these pairs include repetitions, indels, permutation and conformational variability . the methods were compared in terms of the extent of structural similarity detected according to the resulting alignments and in terms of alignment consistency. the methods were also compared relative to the extent of agreement to reference alignments. finally, to illustrate the different types of structure comparison challenges, the results of selected pairs were analysed in more detail.

RESULTS
in this section we present the results for the comparison of ce and dali structural alignments using the astral <dig> set. then we provide the alignment comparison results obtained for the sisy and ripc sets using six different methods. the alignments from different methods were compared regarding identification of structure similarity and alignment consistency  and agreement with reference alignments . finally we describe in more detail the different alignments obtained for seven pairs of proteins from the ripc set which illustrate the different types of challenges currently faced by structure alignment methods.

astral <dig> structural alignments
the standard structure comparison methods ce and dali were applied to each pair of structures in the astral <dig> set. proteins of the astral <dig> collection are remote homologous in the sense that they have less than 40% sequence identity and belong to the same scop  <cit>  superfamily but different families . the structure based alignments obtained by ce and dali were compared with regard to the identification of structural similarity and the consistency or agreement of the residues aligned.

identification of structural similarity
two standard measures of protein structure similarity can be derived from structure-based alignments: the alignment length expressed with the number of equivalent residues  and the root-mean-square distance  of the superimposed structures. the number of equivalent residues provides a measure of how large is the region of structural similarity, and the rmsd provides a measure of the degree of structure similarity in the aligned region. the rmsd depends on the number of equivalent residues, therefore the rmsd values associated with alignments of different lengths can not be compared. different normalised measures have been proposed  <cit> . in particular the rmsd <dig> corresponds to the rmsd value expected if the two protein structures were  <dig> residues length  <cit> . a simpler alternative is to divide the rmsd by eqr: rmsdn = rmsd/eqr.

first we investigated the extent of the correlation between the alignments obtained with ce and with dali relative to eqr and to rmsd <dig>  figure  <dig> shows the results for each pair of proteins in the astral <dig> set. the eqr are highly correlated, with a pearson correlation coefficients of  <dig> , and a spearman correlation coefficient of  <dig> . the rmsd <dig> values are less correlated, with  <dig>   and  <dig>  .

in the astral <dig> set, rmsd <dig> values are highly correlated to the rmsdn . rmsd <dig> was selected for the analysis of the results. the differences in lengths and rmsd <dig> values for the alignments produced by ce and dali for each pair are small in general. the ce alignments tend to be longer , while dali alignments tend to have better rmsd <dig> values . although the differences are small, the distributions of eqr and rmsd <dig> of the alignments obtained with ce and dali are significantly different in the astral <dig> set according to the wilcoxon signed-rank test with paired observations  <cit> . the p-values are  <dig> ·10- <dig> for eqr and  <dig> ·10-5for rmsd <dig> 

to summarise, the lengths of alignments produced by ce and dali are highly correlated, but the rmsd <dig> values are less correlated. the differences between alignment lengths and the rmsd <dig> are small but significant, where dali tends to generate shorter alignments but with better rmsd <dig> than ce.

alignment consistency
the extent of agreement between the residues aligned by ce and dali was measured with a <dig> and a <dig>  as described in the methods section. the first measure is more strict as it only considers the matching aligned residues, while a <dig> tolerates shifts of up to four residues. figure  <dig> provides the histograms for distributions of a <dig> and a <dig> values for the astral <dig> set.

the a <dig> distribution has mean of  <dig>  and median  <dig> . the more tolerant measure a <dig> has higher mean  <dig>  and median  <dig> , indicating that ce and dali tend to align proteins in the same region. the spread is much larger for the a <dig> distribution. there is a maximum at , with 14% of alignments having an a <dig> ≤  <dig> , and there is a another peak around  <dig> . the a <dig> shows a pronounced bimodal distribution with a peak at , and a smaller peak at . for 8% of proteins ce and dali alignments are completely different, with a <dig> ≤  <dig> .

structural alignments from the sisy set
the sisy set is based on the sisyphus database, which contains structural alignments for proteins with non-trivial relationships  <cit> . most pairs of the sisy set are categorised in sisyphus as homologous  while the remaining are structurally related through a common fold or a fragment definition . alignments were calculated by ce, dali, fatcat, matras, cα-match and sheba for each pair in the sisy set. these alignments were compared with regard to the extent of structural similarity detected and the consistency between alignments. the alignments obtained by the six different methods were also compared to reference alignments obtained from the sisyphus database.

identification of structural similarity
we compared eqr of the alignments obtained with the six methods. there is a considerable correlation between all methods regarding the eqr . in particular the correlation is high between ce and dali, as observed previously with the astral <dig> set. matras tends to show lower correlation with fatcat and sheba. the correlation regarding rmsd <dig> is much lower. for example, between ce and dali the correlation is  <dig>   and  <dig>  .

the distribution of the differences of the length of the alignments generated by two methods for each pair of structures are given in figure s <dig> in additional file  <dig>  in general sheba and fatcat generate longer alignments than the other methods, while cα-match generates the shortest alignments. similar analysis of rmsd <dig> differences indicates that cα-match has the smallest rmsd <dig>  while sheba and to a less extent matras alignments tend to have larger rmsd <dig> 

alignment consistency
the consistency between alignments from different methods was measured according to a <dig> and a <dig> over the sisy set. the distributions of the a <dig> and a <dig> values for each pair of methods are shown in figure  <dig> as box-and-whisker plots, the corresponding histograms are available in figure s <dig> and figure s <dig> in the additional file  <dig>  the spread of the a <dig> values is rather large. fatcat and cα-match have the lowest alignment consistency according to a <dig>  the best consistency according to a <dig> is observed between dali and matras, between ce and dali, and between ce and matras. the a <dig> distributions have considerably higher median values, but otherwise the trends are similar to the a <dig> results.

in order to group the methods according to the alignment consistency we used the mean values of a <dig> and a <dig> as well as the median values to compute several dissimilarity measures. two dissimilarity measures were computed of the type d =  <dig> - m, where m is the mean of a <dig> or a <dig>  hierarchical clustering  <cit>  was applied using the four alternative dissimilarity measures. the silhouette width value is a measure of cluster quality  <cit>  and was applied to select the best number of clusters. the best average silhouette width values were obtained with two clusters using any of the two dissimilarity measures. one of the clusters included only the cα-match method and the remaining cluster included the other five methods. the silhouette width values were usually below  <dig> . this indicates that the cluster quality is low, and that the methods are uniformly distinct regarding alignment consistency.

the alignment agreement between all six methods is in general much lower than between any pair of methods. when a <dig> is computed based on the number of aligned residues in common by all six methods, then the alignment consistency is  <dig>  for 42%, and 64% have a <dig> ≤  <dig> .

to summarise, the alignment agreement between two methods shows a large spread, and the observed range of medians is  <dig>  -  <dig> . if alignment shifts of up to four residues are tolerated, then the range of medians increases to  <dig>  -  <dig> . cα-match alignments tend to be less consistent with the alignments from other methods. the alignment agreement over all six methods is much lower, with 42% of the pairs sharing no aligned residues over all methods.

comparison to reference alignments
the sisyphus database contains manually curated multiple structure alignments  <cit> . for each pair in the sisy set we extracted these reference alignments from the sisyphus database. to assess alignment accuracy, the alignments generated by the six methods were compared to these reference alignments, and the percentage of agreement was computed . the corresponding box-and-wisker plots are available in figure  <dig>  the corresponding histograms are shown in figure s <dig> in additional file  <dig>  the spread of accuracy values as measured by the agreement to sisyphus alignments is large for all methods except dali. the lowest median accuracy value is 60% for cα-match , the largest median is obtained by dali with 91% . most methods have a peak of accuracy above 80% as shown in the histograms in figures s <dig>  the cα-match and sheba histograms show peaks at low accuracy values . in four cases no method is able to align any residue correctly. for the pairs 1cr5c-1eu1a and 1okga-1h9ca sisyphus defines short reference alignments . the methods however generate larger global alignments which do not match these fragments aligned in sisyphus. in case of 1v7oa-1hr6b we observe circular permutations, and additionally the sisyphus target alignment does not superimpose very well. finally, the structure 1gzda contains two repeats of 1m3sa with several extensive indels.

the distribution of the accuracy values from the six methods were compared using a two-sided wilcoxon signed-rank test with paired observations  <cit> . the corresponding p-values are given in table  <dig>  dali and ce alignment accuracy distributions are significantly different , with dali accuracies having higher median and mean values. the results therefore indicate that dali alignments agree better with sisyphus alignments than ce. in addition, the results in table  <dig> show a significantly better agreement with sisyphus alignments for both dali and matras in comparison to sheba. the p-values in table  <dig> also indicate that the agreement between cα-match alignments and sisyphus is significantly worse in comparison to dali and matras. other differences are noticeable but they are not as significant . the correlation between accuracy values was also investigated, and is in general very low .

structural alignments from the ripc set
in order to improve current methods, a better understanding of their limitations is required. this can be provided by the analysis of structurally related proteins that are problematic to align, which are available in the ripc set. the ripc set comprises  <dig> structure pairs . the pairs in this set are difficult to align as they include repetitions, extensive indels, circular permutations and/or considerable conformational variability. we compared the alignments calculated by ce, dali, fatcat, matras, cα-match and sheba. reference alignments were derived for a subset of the ripc set based on sequence and function conservation. these reference alignments were used to investigate the ability of methods to correctly align functional residues and alternative conformers of flexible proteins.

type: type of difficulty for alignment algorithms. r: repetitions, i: insertions, p: permutation, c: conformational changes. seqid: sequence identity in percent. ref: a reference alignment is available to evaluate alignment accuracy.

structural similarity and alignment consistency
the results for the comparison of the alignment eqr and rmsd <dig> obtained in the ripc set are similar to the results obtained in the sisy set. in particular there is considerable correlation of eqr values between alignments from different methods. the correlation for rmsd <dig> is also much lower.

the consistency between alignments from different methods was measured according to a <dig> and a <dig> over the ripc set. the distributions of the a <dig> and a <dig> values for each pair of methods are shown in figure  <dig> as box-and-whisker plots. the alignment consistency tends to be lower than the one observed in the sisy set, but otherwise the trends are similar. cα-match and sheba have the lowest alignment consistency according to a <dig>  the best consistency according to a <dig> is observed between ce and dali, and between dali and matras. in general cα-match alignments tend to have low a <dig> values when compared to alignments from other methods.

comparison to reference alignments
we derived reference alignments for  <dig> pairs of the ripc set that correspond to pairs of residues that are expected to be equivalent as described in the methods section. as with the sisy set, the alignment accuracy was measured by comparison of the reference alignments to the alignments obtained with the six methods . the results obtained for each method are compared in figure  <dig>  the spread of accuracy values is large for all methods. the mean and median accuracy values are around 50% for most methods and lower than observed in the sisy set. the distribution of the accuracy values from the six methods were compared using a wilcoxon paired test. in general, no significant difference between the distributions according is observed . the only two exceptions, although the statistical significance is still low , are the comparison between fatcat and sheba and between dali and sheba.

alternative alignments
so far we have investigated the consistency between alignments from different methods. there are two possible reasons for the differences between alignments. first, only one of the two alignments is optimal in the sense that it identifies the regions with most extensive structural similarity, or it identifies the evolutionary equivalent residues. second, different alignments are equally optimal which is possible if there is not one but several alternative solutions for aligning two proteins. such different alignments result usually from the existence of repetitions in the structures compared. they correspond to the same degree of structural similarity or to alternative ways to define evolutionary equivalent residues.

some of the structure comparison methods produce alternative solutions, but in the previous analysis we only considered one single alignment from each method . this might result in low consistency between alignments for pairs of structures that have alternative alignments. to investigate the role of alternative optimal alignments, one can consider all the alternative alignments from the different methods. another simpler approach is to remove from the sets the pairs for which a method gives alternative alignments, and then investigate whether the consistency improves for the remaining pairs with unique alignments. we decided for the second approach, and removed from the astral <dig>  sisy and ripc sets all pairs with alternative solutions according to dali. in total  <dig> pairs were excluded from the astral <dig> set ,  <dig> pairs were excluded from the sisy set , and  <dig> pairs were removed from the ripc set . the consistency scores a <dig> and a <dig> were recomputed for these subsets. the new results show an improvement  in some cases, but in general they are still similar to the ones obtained with the original sets. this indicates that the methods actually produce different solutions for some pairs, independent of the existence of alternative alignments.

analysis of selected challenging examples
in this section we investigate seven pairs of scop domains selected from the ripc set. these examples illustrate how repetitions, indels, circular permutations and local conformational changes affect structural alignment results. for each example alignment path plots are provided for the visualisation of the alignments from the different methods.

repetitions
indels
the umud protein is activated to umud' by a reca activated self-cleavage process that removes the n-terminal fragment with  <dig> residues. umud' is involved in the sos dna-repair response in e. coli. the resemblance to a domain of spase, a type i signal peptidase, has been observed  <cit> . this shared domain includes the catalytic residues essential for protease function that are conserved in both proteins. the spase contains an additional all-β subdomain inserted in the conserved domain  <cit> . the structures are visualised in figure  <dig>  figure 8b shows the corresponding alignment paths. the ten reference alignment residues are clustered in three different regions along the backbone, and include two catalytic site residues. most of umud' can be aligned, but a large gap is required to accommodate the subdomain inserted in the spase and correctly align the c-terminal region. this correct alignment is achieved by most methods, which also succeed in matching the reference alignment. some methods failed to place the required large gap and therefore incorrectly aligned the c-terminal region. in particular fatcat introduces two twists and incorrectly aligns parts of the inserted subdomain.

p-loop containing ntp hydrolases are difficult cases for alignment because they may vary in the number of β-strands in the central sheet. aligning these proteins therefore requires several indels  <cit> . figure 8c shows extensive differences in the alignments by the different methods of the two ntp hydrolases. the n-terminal p-loop, the region associated with adp binding, is in general correctly aligned by the different methods.

circular permutations
a prominent example for circular permutation is concanavalin a. this protein has a β-sandwich structure , and is posttranslationally cleaved resulting in new n- and c-termini. pea lectin  resembles d1nls__ but is not processed in the same way, therefore the n-terminal region in one protein matches the c-terminal region in the other and vice versa. figure 10a shows two aligned fragments, corresponding to the alignment of the two n to c-terminal regions that is characteristic of circular permuted proteins. most methods align only the n-terminus half of concanavalin a to the c-terminus of pea lectin . matras matches the other region, aligning the c-terminal of concanavalin a to n-terminal of pea lectin . only cα-match correctly aligns the complete structures. all methods  share  <dig> aligned residues. the reference alignment includes six residues involved in ca2+ and mn2+ binding. most methods correctly align five of these binding residues, and sheba succeeds in aligning all of them.

the homology between nk-lysin and swaposin with a circular permutation was revealed by sequence prior to knowledge of the crystal structures. the common fold consists of five helices forming a folded leaf. a previous curated alignment of the two proteins  <cit>  was employed as reference alignment. figure 10b shows that the methods align the helices in sequence order, which is incorrect regarding the evolutionary equivalent residues, and results in poor rmsd <dig> values . the exception is the alignment from cα-match, which aligns some residues in the permutated regions correctly, although most of the equivalences are sequentially unconnected. no aligned residues are shared by all six methods.

conformational variability
the udp-glucose-6-dehydrogenase middle domain d1dlia <dig>  <cit>  and the gdp-mannose-6-dehydrogenase middle domain d1mv8a <dig>  <cit>  are structurally related and of similar size. the catalytic site atlas identifies four equivalent catalytic residues that are used to define the reference alignment. the two proteins consist of two common substructures that are conserved but in considerably different relative orientations. most methods align only the n-terminal region, but ce matches only the c-terminal fragment. we observe a high alignment consistency in the first substructure located in the n-terminal region . fatcat and sheba succeed in aligning the two substructures and the catalytic amino acids correctly.

the hect e <dig> ligase catalytic domain consists of two α+β subdomains. this domain is present in the ubiquitin-protein ligase e3a   <cit>  and in the ww domain-containing protein  <dig>   <cit> . the domains in the two proteins share 35% sequence identity. the subdomains are conserved in the two proteins but in different relative orientations . we defined a reference alignment based on six catalytic site residues. the alignment consistency between the different methods is shown in figure 10d. the overlapping alignment paths indicate a high consistency between the alignments from different methods in the n-terminal region corresponding to the first subdomain. in total  <dig> positions are equally matched by all methods. fatcat, matras and dali also correctly align the second subdomain that corresponds to  <dig> residues in the c-terminal region. all methods correctly align some of the functional residues, but only fatcat succeeds in all six residues.

CONCLUSIONS
we have presented a comparative analysis of pairwise structural alignments using three different datasets. the aim of this work is not to rank or benchmark the different methods, but instead to reveal the differences in the results and the challenges these methods face. the results indicate that the alignments of homologous proteins generated by two standard methods  tend to be similar. nevertheless for some of these homologous pairs the alignments are still completely different. the alignment agreement is lower in the more challenging datasets , in particular if alignments from other methods  are also compared. for these two datasets, reference alignments were compiled based on curated alignments and on the identification of equivalent functional residues. we find that the different methods tend to match the reference alignments to some extent, but there is still large room for improvement, specially for the more challenging protein pairs.

the analysis of the results obtained for seven protein pairs that are challenging to align illustrated the strengths and limitations of the different methods. these examples revealed how repetition and extensive indels results in low alignment consistency. they also revealed how proteins related by circular permutations are still difficult to align correctly by most methods, and that some methods can successfully align proteins with considerable conformational variability.

these results raise several issues of relevance for the users of structure alignment methods. in particular the results indicate that different alignments can be obtained when comparing the structures of remote homologous proteins with different methods. in addition, the resulting alignments not always match equivalent functional residues or curated alignments. these findings should also encourage developers to further improve their methods. in particular they should focus on testing and improving the results for challenging cases, as provided in the ripc set.

the current study focused on the analysis of pairwise structure alignments. it would be of interest to perform in the future a similar comparative analysis of multiple structure alignments. in this respect one should take into account the procedures that have been successfully established to test multiple sequence alignment tools  <cit> .

