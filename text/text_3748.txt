BACKGROUND
mitochip is an array-based platform that was first developed by maitra et al , in collaboration with affymetrix, to sequence the entire human mitochondrial dna  coding region )  <cit> . oligonucleotide probes were synthesized in situ and tiled over each coding position of both strands to interrogate its base composition. the subsequent version, mitochip v. <dig> , has expanded coverage across the entire human mitochondrial genome by adding redundant probes that target the most common haplotypes in the highly variable control region  <cit> . in their original paper, zhou et al  showed a very high reproducibility  of base calls for mitochip v. <dig> , with an average call rate of  <dig> % . while the reproducibility and accuracy were impressive, the call rate they achieved was suboptimal for clinical diagnostic purposes. this finding alone has limited the wide adoption of mitochip v. <dig> , such that traditional sanger sequencing and emerging next generation sequencing technologies are typically preferred in a clinical diagnostic setting, despite their inherently higher cost and slower turn-around time.

affymetrix gseq  <dig> , which uses the zhou et al.  algorithm that was first implemented in ra tools  <cit> , is the most commonly used software tool for analyzing mitochip v <dig>  data. base calling with default settings in gseq  <dig>  can achieve a call rate and accuracy in excess of 90% and  <dig> %, respectively http://www.affymetrix.com. several studies have shown that both metrics can be improved by varying several parameters, and that additional information can be obtained from redundant probes on the array. most notably, an average call rate of  <dig> % and accuracy of  <dig> % were achieved in a comparative study  <cit>  that used a set of bioinformatics filters developed by pandya et al.  <cit> .

other efforts to develop an improved bioinformatics analysis pipeline for mitochip v <dig>  have met with only limited success. for example, in the method developed by hartmann et al.  <cit> , the call rate was improved by using the probe intensity values of redundant probes. a base call was determined when the ratio of the highest probe set signal intensity to background noise exceeded an empirically determined cutoff value. unfortunately, this approach may improve the call rate without necessarily improving accuracy, and is more subject to batch effect when the background noise levels differ between sample sets.

several additional challenges have limited the clinical utility of mtdna sequence analysis using the mitochip v <dig>  platform. the first challenge is the detection of insertions or deletions , particularly in regions known to have such variants. at present, the gseq  <dig>  algorithm provides no explicit way to detect indels. a second challenge is an apparent lack of sensitivity and specificity to detect and report heteroplasmy. since pathogenic mtdna mutations may only be present in certain tissues and/or at certain percentage loads  <cit> , the accurate detection and assessment of heteroplasmy levels are imperative to understand disease diagnosis and prognosis  <cit> . while the affymetrix mitochip v <dig>  platform has the potential to detect heteroplasmy with great sensitivity  <cit> , gseq  <dig>  does not provide an efficient method for making accurate heteroplasmy calls  <cit> . a third challenge is the lack of a robust quality metric, as no measurement accurately captures the overall quality of each mitochip data set. call rate offers one reflection of robustness but can be misleading if used as the sole parameter of sample quality, since it is subject to influence not only by technical factors but also by biological factors such as the presence of indels. a final challenge is the absence of a base call summary method at regions of common variation that are captured by multiple probes placed on mitochip v <dig> .

here, we describe the development and implementation of a custom bioinformatics pipeline that addresses these challenges. we assessed and validated the effectiveness of this pipeline using a carefully selected set of mtdna samples. our pipeline improves mitochip v <dig>  call rate without sacrificing accuracy and, at the same time, provides an effective means for assessing data quality, detecting large indels, and systematically identifying heteroplasmic mtdna variants.

implementation
we designed and developed a customized bioinformatics pipeline, mitochip filtering protocol , to analyze mtdna sequence data generated by affymetrix mitochip v <dig>  . the methods and algorithms used in the study were implemented as matlab code that is publicly available at matlab central file exchange using the keyword "mfp" http://www.mathworks.com/matlabcentral/fileexchange/ .

dna sample description
a total of  <dig> human mtdna samples were studied . these dna samples were extracted by standard techniques from whole blood , skeletal muscle , or cell lines . two of the dna samples were extracted from different tissues of the same individual that had variable heteroplasmy loads . eighteen of the samples were previously sequenced using conventional sanger sequencing on a clinical basis at either the baylor mitochondrial laboratory  or on a research basis by the authors , following the methods of palanichamy et al.  <cit> . two other samples had previously been studied only with a common mtdna point mutation panel at baylor mitochondrial laboratory . three additional samples were previously analyzed by denaturing hplc-based heteroduplex analysis on a clinical basis at transgenomics laboratory . the last sample  was previously processed using illumina genome analyzer ii at the university of pennsylvania. known pathogenic mutations in this data set included a five kilobase  pair deletion , and six known heteroplasmic mutations . samples # <dig> through # <dig> were selected to represent a wide range of common and rare mtdna haplogroups . a total of  <dig> muscle dna samples previously analyzed by sanger sequencing were used as an independent, validation data set.

 <dig> clinical samples and  <dig> research samples were analyzed by mitochip v <dig> . tissue origin, comparative mtdna genome sequencing methodologies, unique or pathogenic features that characterize particular samples based on a priori sequencing knowledge, variant heteroplasmy levels, as well as mitochip performance in terms of ability to detect known variants and the call rate achieved using mitochip filtering protocol  are detailed. the 'mtdna haplogroup' column details the manually curated haplogroup based on full sequence analysis for each sample. 'mitosnp predicted haplogroup' was based on a subset of  <dig> mtdna positions and generally agreed with manual curation, with the exception of haplogroups b, k, and d that were not properly identified by mitosnp prediction. &, muscle and blood samples originated from the same subject.

mitochip v <dig>  sequencing
all  <dig> dna samples detailed in table  <dig> were processed in the center for applied genomics at the children's hospital of philadelphia using the affymetrix genechip human mitochondrial resequencing array version  <dig>   per standard affymetrix protocol  <cit> .

illumina genome analyzer ii sequencing
the mtdna library for sample # <dig> was sequenced to  <dig> bp  using an illumina genome analyzer ii. the resulting  <dig> , <dig> reads were aligned using eland  to the human genome reference sequence  including the mitochondrial genome allowing up to  <dig> mismatches. all reads that did not align or aligned to mtdna  and had fewer than  <dig> alignments at  <dig>   <dig>  and  <dig> mismatches were selected. this step yielded  <dig> , <dig> mtdna candidate reads. these reads were assembled using velvet  with an overlap setting of  <dig>  velvet produced  <dig> contigs, which were aligned to the hg <dig> 'chrm' using fasta <dig> to assess coverage. a consensus sequence was also generated with maq  using the same set of input sequences and the hg <dig> chrm sequence as a reference.

gseq  <dig>  analysis
raw data  of the  <dig> mitochip v <dig>  data sets were initially processed with gseq  <dig>  software using both diploid and haploid models. all default parameters were used with the exception of the quality score threshold, which was set at  <dig> rather than the default setting of  <dig> to optimize sensitivity and specificity  <cit> . base calls were made for each sample and position, which included "a", "c", "g", and "t". "n" was used to indicate when no base call could be confidently made because the quality score was below  <dig>  aside from base calls, the sequences and intensities of each probe were exported and analyzed for additional base and heteroplasmy calls.

RESULTS
quality control  analyses
the call rate of a genotyping array is generally considered to be a good indicator of data quality but can potentially be misleading when influenced by technical factors or biological contributions such as pathogenic indels. in addition, using a threshold by which to identify poor quality samples can be subjective. therefore, we devised a procedure that used call rate and base call quality correlation coefficient to identify potentially problematic samples. the generalized extreme studentized deviate  many-outlier method was then applied in the following manner to eliminate any outliers that had poor data quality  <cit> . first, we plotted the quality score distribution of all bases for each of the  <dig> dna samples . as expected, quality scores were normally distributed for all samples except for the one that had a known 5-kb deletion . while a large number of bases in this sample had the lowest quality score, the remaining bases in this sample appeared to have normally distributed quality scores. this observation correlated with the large mtdna deletion known to be present in the sample.

next, correlation coefficients of quality scores between different samples were analyzed . while it was expected that sample # <dig> would correlate poorly with other samples due to its large deletion, three additional samples  showed similar evidence of poor correlation. thus, correlation coefficient analysis was strongly indicative of the overall poor quality of these four samples. additionally, while their overall quality score distributions were similar to that of other samples, peaks at low-quality ends could clearly be seen for these samples, albeit to a much lesser degree compared to sample # <dig> 

finally, the mean quality score across all samples for each probe was used as the baseline for purposes of computing the sum of square of the difference between each sample and the baseline . as before, samples # <dig>  # <dig>  # <dig>  and # <dig> were found to be outliers from the remaining twenty samples. call rates for those samples originally made using a quality score cutoff of  <dig> in gseq were all below 97% and represented a clear departure from the remaining samples that had call rates of approximately 99%. this observation supported the interpretation that these samples were problematic and should not be included in downstream analyses.

the atypical nature of sample # <dig> became more evident when the average quality score was plotted across its mtdna genome using a  <dig> bp moving window for all samples. in this analysis, samples with a deletion or insertion were expected to show a significant dip in the plot at the corresponding genomic region. indeed, this is exactly what was seen for sample # <dig> . while the rest of that sample's mitochondrial genome behaved similarly to the other study samples in terms of the distribution of mean quality scores, consecutive stretches ranging from nucleotide positions   <dig> to  <dig> had extremely low quality scores . a continuous and significant drop of the highest probe intensity was also seen across the same region using a  <dig> bp moving window . the pattern became more obvious when the quality score plot for this sample was individually studied . outside of the deleted region, however, base calls were 100% concordant between mitochip v <dig>  and sanger sequencing.

structural variant detection
the large  <dig> bp deletion in sample # <dig> located between np  <dig> and  <dig> had previously been identified by sanger sequencing. this result indicated that precise structural variants can be reliably detected and defined from mitochip data simply by plotting either the average probe quality scores or the highest probe intensity values. break-point determination with this approach was also highly accurate, as coordinates of the predicted deletion only differed by  <dig> bp on one side. this result supported the feasibility of detecting at least large size deletions using a moving window approach. at the same time, our failure to detect a  <dig> bp ac deletion in the control region of sample # <dig> demonstrated the limitation of this method for identifying structural variants at finer resolution. unfortunately, a series of samples with indels of different sizes were not included in the study samples to permit experimental determination of this method's sensitivity.

however, we did explore a computational approach to predict the estimated size of structural variation that could potentially be detected by our moving window approach, . we started by developing a statistically rigorous measure of a deletion, rather than using visual inspection alone , that involved grouping and collectively assessing the quality scores from all samples having no known deletions. a quality score that was  <dig> standard deviations below the mean was chosen as the cutoff. if the average quality score of a stretch of consecutive bases fell below this cutoff, this segment was deemed to be deleted. in our set of samples, the cutoff value was determined to be  <dig> , which allowed us to determine that the deletion in sample # <dig> was located from np  <dig> to  <dig> 

because of the lack of samples with various sizes of deletions, we estimated the sensitivity of our method using simulation tests. briefly, we first randomly chose a segment of a given size from the known deletion of sample # <dig> and used its data to replace those of a segment of the same size randomly chosen from another sample. we then applied our method to assess whether or not this segment was detected as a deletion. as seen in additional file 2a, deletions that were  <dig> bp or longer could be clearly detected. deletions that were smaller than  <dig> bp in length could still be detected but with increasing difficulty as their size decreased . to quantify the sensitivity of our method for deletions 2- <dig> bp in length, we repeated  <dig> simulations for each given size using the global cutoff value of  <dig>  as described before. the fraction of times that we could detect the deletion was estimated as the sensitivity of our method. as shown in additional file 2c, the sensitivity was as high as 90% for deletions of  <dig> bp or larger, but as low as 20% for deletions of  <dig> bp or shorter.

limitations to base call rate in gseq  <dig> 
gseq  <dig>  sets the default quality score cutoff at  <dig>  when keeping all other parameters at default values but lowering the quality score cutoff to  <dig>  an average call rate of  <dig> % was achieved for the  <dig> samples having consistently high quality scores. the call rate for those  <dig> samples ranged from  <dig> % to  <dig> % with a standard deviation of  <dig> %, which is still not high enough to consistently satisfy the rigorous requirements of clinical diagnostic applications. while the call rate could be improved by further lowering the quality score setting, this would also increase erroneous base calls. thus, it was evident that a method was needed to improve the call rate without sacrificing accuracy.

incorporating intensity values to improve call rate
gseq  <dig>  software uses the quality score as the sole threshold by which to determine base calls. this standard leads to greater confidence being placed on base calls with higher quality scores. however, we found that quality score was highly correlated between samples, where certain loci had proportionally lower quality scores than did others. therefore, relying solely on quality scores to determine base calls may diminish call rates for certain regions of the mitochondrial genome.

to further improve call rate, we incorporated into our pipeline an advanced analysis of intensity values that were determined in gseq  <dig>  software. rather than simply taking the probe with the highest intensity value at a given position, a call was made if the probe that had the highest intensity of all probes significantly exceeded background noise. while many approaches can estimate background noise, the second highest intensity value from both strands was used to provide conservative noise estimations. the ratio between the highest and second highest intensity values from both strands was used to measure confidence in generating additional base calls. a threshold was selected based on our statistical analysis of the ratio distribution.

sample # <dig>  which contained the large  <dig>  kb deletion, provided a good measure of signal to noise ratio reliability based on thousands of data points, since the signals from deleted loci could all be considered as noise. the ratios of the deleted bases in this sample were closely analyzed . the median plus four times the standard deviation of the inter-quartile value  was chosen as the threshold to differentiate outliers or true signals from pure noise. for all other samples, bases with non-calls  were reexamined. if the signal-to-noise ratio exceeded  <dig> , then a call was made according to the probe with the highest signal. otherwise, the non-calls remained as they had initially been defined. in addition, any single nucleotide variant  calls having a quality score below  <dig> were converted to "n". our revised analytical method was then applied to snv calls across the entire mitochondrial sequence of each sample, where any probe having the highest to second highest signal intensity ratio less than  <dig>  were converted into non-calls.

analysis of base calls in common variable regions
affymetrix mitochip is a sequencing-by-genotyping technology. it relies upon the signal intensities of a set of 25-mer probes that hybridize to the dna sample and specifically interrogate the base composition at the position corresponding to the 13th position of these probes. its performance is complicated by the existence of many common mtdna sequence variants, especially in the control region. probes that do not match perfectly with the dna sample at the bases beside the 13th position could therefore potentially lead to ambiguous calls or non-calls. to address this problem, redundant probes were tiled over the common variable regions on the affymetrix mitochip v <dig> . details of the design can be obtained from the affymetrix website http://www.affymetrix.com. unfortunately, gseq  <dig>  does not provide an effective and integrated way to use these data.

an algorithm called reseqchip was recently developed to improve the call rate in these regions  <cit> , but uses very complex methodologies to do so. we employed a similar but much simpler scheme. for a given position in a polymorphic region, all base calls for all probes having a quality score above  <dig> were collected and a majority vote was used as the final base call. in cases when two different base calls had an equal number of votes, a rank sum test of their quality score was examined. if the resulting p-value was less than  <dig> , then the base call with the higher average quality score was chosen as the final base call. bases with a p-value higher than  <dig>  were further examined for potential heteroplasmy.

combined improvement in call rate achieved using mfp
all of the above-mentioned methods were integrated into a single mitochip data analysis pipeline, which we called the mitochip filtering protocol . significant improvement in the call rate was obtained in mfp relative to that generated in gseq  <dig>  . for the  <dig> samples that passed our qc filtering and did not have a large deletion, the average call rate achieved was  <dig> % . by contrast, the average call rate for the same data sets using gseq  <dig>  by itself was 99% . interestingly, different magnitudes of improvement in call rate were seen in different gene regions for different samples . as expected, significant improvement was seen in all samples in the control region attributable to the improved use in mfp of redundant control region probes.

accuracy of base calls generated using mfp
to assess the accuracy of base calls generated in mfp, we compared calls for  <dig> samples that had previously been analyzed by either sanger or illumina gaii next generation sequencing. a summary of the variant results by sample is provided in table  <dig>  on average, we observed two discordant base calls per sample, which translates to approximately  <dig> % concordance rate between mfp-analyzed mitochip v <dig>  data and traditional sanger  whole mtdna genome sequencing methods. this calculation was based on the ability of mitochip v <dig>  to interrogate only  <dig>  of  <dig>  bp of the mtdna genome.

discrepant calls between mitochip v <dig>  using our custom mfp bioinformatics algorithm are summarized for each of the  <dig> study samples for which full mtdna genome sequencing had been previously performed . total number of discrepant calls is detailed, with numbers in parentheses specifying calls missed by mfp-based mitochip analysis that had been made by standard sequencing, as well as the extra calls made by mfp-based mitochip analysis that had not been detected by standard sequencing. the specific discordant variants from each sample are catalogued in additional file  <dig> 

the discordant base calls were closely examined . mitochip v <dig>  data had high quality scores  using gseq  <dig>  analysis for eight of the discordant bases that occurred at one of three nucleotide positions in the hvs1:  <dig> ,  <dig> , and  <dig> . we are confident that the  <dig> and  <dig> polymorphisms are present  because they are phylogenetically diagnostic mutations for the samples' respective haplogroups. thus, these polymorphisms were clearly missed by mitochip. extra calls by mitochip that were not seen in sanger sequences or the ngs sequence were also noted. six of the  <dig> mutations occur near known polymorphisms. most of these mutations also involved unusual transversions. one of these transversions was found in two samples that belonged to two different mtdna haplogroups , further suggesting that an error occurred in the mitochip read.

the percentage of no-calls at cytosine  positions was consistently high across all samples , as was similarly reported in prior studies  <cit> . rates of "no-calls" were not linked to the mutational aspect of any specific haplogroup. in other words, there was no bias in mutation ascertainment towards phylogenetically older or younger haplogroups relative to one another. in addition, the majority of the extra calls appeared as atypical transversions, with many being adjacent to or near real polymorphisms.

we noted a high percentage of discordant calls for two samples  relative to other mtdnas in the sample set . this difference may reflect the fact that they were the first samples that were processed and analyzed using mitochip  <dig>  in our data set. in spite of this problem, nearly all of the polymorphisms identified in the samples through sanger sequencing were also detected by mitochip  <dig> , with most of the observed discrepancies being extra calls made by mitochip  <dig> . these results indicate that dna samples collected 1- <dig> decades ago, such as # <dig> and # <dig>  are amenable to sequence analysis with the mitochip  <dig>  and can produce very high call rates, despite their being of possibly slightly lower quality than recently collected samples.

improved sensitivity for heteroplasmy detection using mfp
a potential advantage of affymetrix mitochip array technology over sanger sequencing technology is its higher sensitivity for heteroplasmy detection  <cit> . since the heteroplasmy calls in gseq  <dig>  often appeared to be questionable, as suggested by other studies  <cit> , we developed our own statistical method for heteroplasmy detection. intensity patterns of typical heteroplasmic sites are illustrated in figure  <dig>  the highest and second highest intensity values are close to each other but significantly differ from the other potential base calls. importantly, we observed a high degree of correlation among probe intensities across different samples at the same position.

therefore, we devised a mathematical approach to utilize the intensity values of multiple samples for purposes of detecting heteroplasmic sites. a ratio of intensity values at each position of a given sample was calculated as detailed in equation 1:

  intensitynew,i= logintensityhighest,iintensitysecondhighest,i∕intensitysecondhighest,iintensitylowest 

where i is the base position of interrogation. this equation measures the relative difference between the highest and second highest intensity value as compared to the second highest and lowest intensity value. at a heteroplasmic position, the second highest intensity would be much closer to the highest intensity but much more distant from the lowest intensity. such ratios follow a bell-shaped distribution pattern, where extreme values to the left side of the distribution are suggestive of heteroplasmic loci.

to further eliminate false positive heteroplasmy detection, a four-step method was applied. first, since a true heteroplasmic site was assumed to have an extreme value both within a sample and across all samples, three standard deviations was used as a cutoff threshold. second, any positions for which two different bases had the highest intensities on forward and reverse strands were filtered out. third, potential false positives were filtered out using the base calls from gseq  <dig>  that were made with either a diploid or haploid model. calls were considered to be "real" only if the base calls were different using different models at a given base, which was another indication of a potential heteroplasmic site. finally, we eliminated any heteroplasmic calls detected immediately adjacent to another detected snp, since those heteroplasmic bases appeared to be false positives caused by neighboring positions to an imperfect match.

we applied this method to the  <dig> samples that passed quality control parameters to detect a total of  <dig> heteroplasmic sites in these samples, including four that had been previously identified by sanger sequencing. we also assessed heteroplasmy calls with default gseq  <dig>  settings for the same  <dig> samples. of these variants, two of the six heteroplasmic loci identified by sanger sequencing were missed by gseq  <dig> . sample # <dig> was sequenced using gaii with single-end  <dig> bp reads to provide an average 375x depth of coverage, which allowed for validation of some additional heteroplasmy calls that we had made in mfp. for this sample, gseq  <dig>  detected one heteroplasmic mutation at np  <dig>  examining the gaii sequence alignment using tablet  <cit> , we did not find any supporting evidence for this site being heteroplasmic, as it appeared to be entirely homozygous for thymine  . by contrast, our pipeline identified two potentially heteroplasmic loci from the same sample at np  <dig> and  <dig>  which were supported by the gaii data . collectively, these results suggest that our mfp method for detecting heteroplasmy has a higher sensitivity and specificity than does gseq  <dig>  alone . however, more extensive validation of the capability of mfp to detect heteroplasmy needs to be conducted, ideally using a next-generation sequencing technology for comparison.

heteroplasmy load quantitation using mfp
the heteroplasmy level at a given locus can be estimated using relative intensity ratios. for a detected heteroplasmic position, we first determined the relative ratio of two alleles and then calculated a product average of the two ratios, as per equation 2:

  r¯i=intensityallele <dig> i,senseintensityallele <dig> i,sense×intensityallele <dig> i,antisenseintensityallele <dig> i,antisense 

where i is heteroplasmy loci, and intensityallele k, i, sense/antisenserepresents the intensity value of allele k at the sense or antisense strand. the ratio was then converted to the percentage of each allele type's abundance. using this method, we estimated that the heteroplasmy levels for the a3243g mutation in sample # <dig> and for the c5049t mutation in sample # <dig> were 63% and 40%, respectively. sanger sequencing followed by allele refractory mutation system  based quantitative pcr  <cit>  estimated the heteroplasmy mutation load for a3243g at 84% in sample # <dig>  heteroplasmy at the c5049t position was identified by sanger sequencing but not further quantified in sample # <dig>  interestingly, mfp analysis identified heteroplasmy at np  <dig> and  <dig> for sample # <dig>  which was reported to have an inserted thymine  between these exact positions through sanger sequencing. mfp-based mitochip v <dig>  analysis also detected similar heteroplasmy levels as estimated by sanger sequencing alone or with arms qpcr, with these heteroplasmy loads being between 30% and 84%, respectively . however, a heteroplasmic variant identified by sanger sequencing in sample # <dig> at an estimated 25% heteroplasmy level was not identified by mfp analysis.

sample # <dig>  # <dig>  # <dig>  and # <dig> had heteroplasmic variants detected both by sanger sequencing and mfp analysis of mitochip v <dig>  data. of interest, the 5537_5538inst in trna-trp identified by sanger sequencing in sample # <dig> was interpreted in mfp as a heteroplasmic mutation at both positions  <dig> and  <dig>  although a heteroplasmic a1709g site was detected by sanger sequencing in sample # <dig>  this sample was excluded from mfp analysis due to poor sample quality. "n.d." = not determined.

validation data set analysis
we applied our custom mfp pipeline to an independent data set from five muscle dna samples whose mtdna genomes had been sequenced using both sanger sequencing and mitochip v <dig> . comparative results of mfp pipeline analysis and gseq  <dig>  analysis results of mitochip v <dig>  data are detailed in additional file  <dig>  overall, the mfp-based analysis of mitochip v <dig>  results closely matched those generated by sanger sequencing, with an average of  <dig> base call error per sample being observed. it was noteworthy that the same base call discrepancy  accounted for  <dig> of the  <dig> total snp discrepancies identified across all five samples . the three samples affected all belong to mitochondrial haplogroup u, which has an a12308g change compared to the revised cambridge reference sequence . these results highlight the limitations with mitochip v <dig>  design at a few individual loci, but further support the utility of the mfp pipeline to provide superior overall accuracy and call rate.

discussion
the affymetrix mitochip v <dig>  resequencing array provides a relatively fast, high-throughput, cost-effective, and sensitive method for detecting both homoplasmic and heteroplasmic mutations across the entire human mitochondrial dna genome. the costs for each mitochip v <dig>  array and reagents  are lower than any other commercially available mitochondrial dna sequencing methodology. furthermore, under a week is needed to sequence and analyze mitochip v <dig>  data using the mfp pipeline. by contrast, the current cost of sequencing the whole mitochondrial genome using sanger sequencing or more recently available ngs platforms typically exceeds $ <dig>  per sample at a clinical diagnostic laboratory, and can take up to two months to obtain analyzed results. furthermore, while gseq  <dig>  is a standard software package designed to analyze mitochip v <dig>  data, it provides less than the desirable call rates necessary for clinical diagnostic applications in suspected mitochondrial disease.

in this study, we systematically analyzed the mitochip v <dig>  data from  <dig> carefully selected samples with a number of statistical methods. the outcome was the development of a custom pipeline, mfp, that significant improved the call rate and accuracy relative to gseq  <dig> . with an average call rate of  <dig> % across the entire genome and an estimated accuracy of  <dig> %, mitochip v <dig>  analysis with the mfp bioinformatics pipeline can now be viewed as a viable and highly attractive alternative to sanger sequencing.

a distinct advantage of sanger sequencing over mitochip v <dig>  has been its ability to detect and precisely determine the breakpoints of indels of any size. in this study, we showed that, while indels of a few base pairs in size are still difficult to detect with mitochip v <dig> , deletions larger than  <dig> bp should be fairly straightforward to detect and precisely define. it is not clear whether the oligos in the mitochip v <dig>  can be further modified to detect smaller indels in mtdna samples.

since the mitochip v <dig>  platform was designed based on the revised cambridge reference sequence that belong to mitochondrial haplogroup h  <cit> , it has been suggested that mitochip analysis would not reliably detect sequence variants from more divergent haplogroups, such as l <dig>  <cit> . as shown in table  <dig>  the  <dig> study samples analyzed here originate from a number of diverse haplogroups. if the data set passed qc control parameters, then a desirable call rate could be readily achieved in all cases. these data satisfactorily address concerns about the potential lack of sequence identification of the probes for divergent or rare mitochondrial dna lineages.

while haplogroup origins could be precisely determined based on our manual curation of the mfp-determined mtdna genome sequence, we note that implementation in mfp of an automated algorithm that relies solely upon a panel of  <dig> snps to assign haplogroup  <cit>  failed to permit the accurate assignment of b  or d <dig> haplogroups . the haplogroup for sample # <dig> that had a  <dig>  kb deletion was also understandably misassigned, as several of the haplogroup-defining variants for this sample  fell in the deleted region of this sample. thus, haplogroup assignment can be readily made with mfp but must be viewed with caution if based on the  <dig> common snp panel used here or if the sample harbors a large deletion. however, the use of an expanded set of snps representing a wide range of phylogenetically important markers from a global set of haplogroups will likely rectify these kinds of misassignments.

another potential advantage of mitochip v <dig>  analysis over sanger sequencing is its potential to more sensitively detect heteroplasmy. however, failure to exploit the data captured on mitochip v <dig>  relative to heteroplasmy detection and quantitation appears to be attributable to a limitation of the current gseq  <dig>  and other software. this same problem has been noted in previous studies employing the mitochip v <dig>   <cit> . while we were able to use mfp to detect  <dig> confirmed heteroplasmic bases , more extensive validation results are needed to determine the conditions that must be met to consistently achieve those calls across the mtdna genome. mfp analysis did detect two potentially low-level heteroplasmic mutations in sample # <dig> at np  <dig> and  <dig>  which were supported by deep sequencing data . this result suggests that mfp can potentially make robust and accurate heteroplasmy calls.

any array-based sequencing technology has inherent limitations that cannot be fully addressed by statistical or informatic means. aside from the difficulty of detecting small indels, as mentioned above, another important issue is the reliable and consistent detection of very low levels of heteroplasmy. as newer technologies emerge, superior heteroplasmy detection will be achieved. in this regard, next-generation sequencing technologies offer enormous depth of coverage for the mitochondrial genome such that point mutations, small indels and low levels of heteroplasmy  can be reliably and quantitatively detected  <cit> .

yet, current next-generation sequencing technologies are not without their own limitations. for example, such technologies are still relatively expensive in terms of equipment, reagents, and labor costs. furthermore, they are high-throughput technologies only in terms of the amount of sequence data that they generate per run, but not in terms of the number of samples that can be individually processed at the same time. in contrast to ngs methods, mitochip v <dig>  analysis can be run on individual samples without having to accumulate a sufficient number of samples to batch analyze them.

CONCLUSIONS
in summary, we conclude that mfp-based analysis of mitochip v <dig>  data provides a highly attractive option for both clinical diagnostic applications as well as research-based evaluation of the human mitochondrial dna genome. the custom mfp bioinformatics pipeline reported here performs with consistently high call rate and accuracy, provides improved metrics to assess sample quality control, permits improved detection of the occurrence of both large deletions and heteroplasmic variants, and performs consistently well in samples of diverse haplogroup origins. with the bioinformatics algorithm improvements described here that we incorporated into a single mfp pipeline, mitochip v <dig>  analysis can now provide a fast, cost-effective, flexible, and truly high-throughput way of achieving comparable or higher accuracy relative to sanger sequencing in the evaluation of a large number of individuals for potential pathogenic mutations throughout the mitochondrial genome.

availability and requirements
project name: mitochip filtering protocol ; project home page: http://www.mathworks.com/matlabcentral/fileexchange/ using keyword "mfp"; operating system: platform independent; programming language: matlab; other requirements: matlab statistics toolbox; license: gnu gpl; any restrictions to use by non-academics: none.

abbreviations
mtdna: mitochondrial dna; bp: base pair; kb: kilobase; snv: single nucleotide variant; mfp: mitochip filtering protocol; np: nucleotide position.

authors' contributions
mjf, xg, and tgs conceived of the project idea. mjf, ep, cc, and as obtained clinical samples for analysis. jab and js provided the hela cell line sample and illumina gaii sequence data from this line for comparison. mpk provided the  <dig>  kb deleted cell line sample and comparative sequence file. tgs, mcd, mg, and siz selected and provided nine haplogroup samples for analysis, completed the sanger sequencing of these samples for comparison, and made manual haplogroup calls for all samples. aa, ck, and hh performed all affymetrix mitochip v <dig>  pcr and hybridization protocols of the original data set. vp provided the validation set sample data as analyzed by both sanger sequencing and affymetrix mitochip v <dig> . jcp and hmx established the custom bioinformatic pipeline and processed all mitochip sample data. hmx, xg, tgs, mcd, and mjf wrote the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
source code.

click here for file

 additional file 2
structural variant detection capacity analysis in mfp.  quality score plots with  <dig> bp moving window for simulated data sets with deletion segments of different sizes . the deleted segment is highlighted in red in each plot.  sensitivity plot for deletions of various sizes based on simulation tests.

click here for file

 additional file 3
box plot of ratios between the highest and second highest signal intensities of all bases located in the large deleted region of sample # <dig>   <dig> % of bases in the  <dig> bp deleted region would fall above this cutoff.

click here for file

 additional file 4
single nucleotide variant discrepancies within  <dig> dna samples analyzed both by affymetrix mitochip v <dig>  with the mfp analysis algorithm and by either sanger or illumina genome analyzer ii sequencing methods. whole mtdna genome sequence data was compared for all  <dig> high quality samples detailed in table  <dig>  as well as for  <dig> samples found to have poor quality . no sequence discrepancies were noted between mitochip v <dig>  and  <dig> of the high quality samples , nor in sample # <dig> at any base positions outside of its large deleted region.

click here for file

 additional file 5
alignment of illumina ga next generation sequencing reads from position  <dig> in sample # <dig>  mitochondrial genome position  <dig>  visualized in tablet, shows no indication of heteroplasmy by next generation sequencing.

click here for file

 additional file 6
alignment of illumina ga next generation sequencing reads from position  <dig> to  <dig> in sample # <dig>  the  <dig> base pair deletion located between np  <dig> and  <dig> in the mitochondrial genome, visualized in tablet, clearly indicates these are potential heteroplasmic sites.

click here for file

 additional file 7
validation data set results comparison between mfp and sanger sequencing.  call rate improvement when comparing mfp analysis to gseq  <dig>  for each of  <dig> validation samples.  accuracy between total calls made by mfp analysis and sanger sequencing for each of  <dig> validation samples.  call type details for a total of  <dig> discrepant calls between mfp analysis and sanger sequencing seen in  <dig> of the validation samples. interestingly,  <dig> of the  <dig> discrepant calls involved the same snp  in three distinct samples  that was detected by mfp.  sanger-based electropherogram clearly shows the presence of the a > g variation, not at  <dig>  but at its neighboring position  <dig>  as shown here for validation sample c <dig> 

click here for file

 acknowledgements
we are grateful to pr. paquis-flucklinger, dr. valerie desquiret-dumas, and investigators of the mitochondrial french consortium for contributing the sample data for the validation data set. this work was funded in part through a children's hospital of philadelphia research institute mitochondria research affinity group pilot and feasibility award , a grant from the national institutes of health , and through support from the university of pennsylvania , and the social sciences and the humanities research council of canada . the content is solely the responsibility of the authors and does not necessarily represent the official views of the national institutes of health. the funding agencies had no role in study design, data analysis or interpretation, or manuscript preparation.
