BACKGROUND
viruses interact extensively with the host cells they infect, and thus are believed to play a major role in the evolution of life  <cit> . in the process of virus-host interaction, viral genes might be left behind and incorporated into the host genome, or host genes might be taken up by viruses and become integrated into the viral genome. in this work, we devise a model to systematically predict which viral genes do not originate from the species in which they were observed. the method is targeted to the identification of genes that presumably have been integrated into virus genomes only recently.

horizontal gene transfer  amounts to the exchange of genetic material between organisms other than by reproduction and typically across species boundaries. instances of hgt have been observed in all three domains of life  <cit>  as well as in viruses. for the identification of horizontally transferred genetic material, various methods have been proposed . in general, the methods are based on either phylogenetic analysis or interpretation of compositional features.

phylogenetic analysis requires assumptions about a comprehensive phylogenetic tree. while cellular organisms have a common ancestor, viruses likely do not originate from a common progenitor  <cit> . moreover, viral genomes evolve more quickly than cellular genomes, which very quickly causes genes to diverge beyond any recognizable similarity. hence, phylogenetic trees can be constructed only for a limited set of closely related viruses; and methods based on phylogeny are applicable to the study of hgt in viruses only to a limited extend. in contrast, methods based on compositional features are applicable. these methods involve the analysis of statistical features and specific genomic signatures, and are more powerful in detection of gene insertion, as opposed to phylogeny-based techniques that can detect gene displacement as well  <cit> .

a genomic signature is a vector of numbers constructed from a dna or protein sequence. these vectors are similar for all sequences from the same genome  and distinct from vectors corresponding to sequences of other genomes. species evolve specific signatures in the characteristic evolutionary processes each of them is subjected to in time. comparison of these patterns enables the identification of horizontally transferred genes as those whose features are atypical for a particular genome. however, only recently acquired genes can be detected because sequences quickly adjust to their new genome environment, a process known as gene amelioration  <cit> .

the statistical analysis of viral genetic data is challenging. these data exhibit high biases due to comparably short genomes and the tendency of certain viruses to display high mutation rates. yet, there is a number of studies focusing on hgt in viruses.

for cyanobacterial phages and their hosts, it has been shown that whole genes of the photosystem reaction center have been transferred from host to phage  <cit> . the host-like photosynthesis genes of the cyanophages presumably augment the host photosynthetic machinery during infection and thereby provide a fitness advantage. there is also evidence for the transfer of multiple genes involved in the sphingolipid biosynthesis pathway between the eukaryotic microalga emiliania huxleyi and its large double stranded dna virus emiliania huxleyi virus although the direction of the hgt was not identified  <cit> . the similarity of pola genes in both thermophilic viruses and the bacterial phlyla of aquificae and apicomplexa could be attributed to not only one event of gene transfer but to a whole network of transfers of genetic material that occurred during evolution  <cit> . a study of hgt in the family of poxviridae has revealed that proteins encoded by members of the subfamily chordopoxvirinae exhibit greater similarity to eukaryotic proteins than to proteins of other virus families illustrating the important role of gene capture from the host for virus evolution  <cit> .

a special case is sputnik virus. this virus infects acanthamoeba polyphaga mimivirus, one of the largest known viruses. some of the genes of sputnik virus apparently originate from mimivirus
 <cit> . sputnik virus is the first virus discovered to infect another virus  <cit> .

all these studies focus on individual viral species or at most one family and reveal interesting details for them. a number of methods employ machine learning techniques to discover hgt events on a large scale . none of these methods, however, analyzed viruses specifically as a subject for hgt. although for wn-svm  <cit>  predictions in  <dig> virus species are reported, the authors concerntrate exclusively on dsdna viruses with relatively large genomes. in contrast, we aim to provide a method equally applicable for detection of hgt in all known viruses. the method relies on detection of genes whose statistical properties are for the virus it resides in, and thus does not reveal the source of the gene transfer. recent metagenomic studies indicate a large and partly underappreciated diversity of viral species , so we speculate that in many cases the source organism may still be undiscovered. the mentioned anecdotal cases are not sufficient to form a gold standard data set of viral genes acquired via hgt. so the validation of the model is particularly demanding. we evaluate the algorithm on simulated data sets as well as on real data sets, and we relate selected findings to available literature.

the identification of potentially horizontally transferred genes resembles an outlier detection problem. we hypothesize that most genes of a virus family are inherent and only few entered the family by means of horizontal transfer. furthermore, the family-inherent genes share characteristics which the foreign genes do not have. genetic sequences inherent to a genome exhibit specific common statistical features, whereas genes recently horizontally transferred into the genome show the specific statistical features of their original genome. thus, representations of genes in the form of signatures allow for distinction of within-family and out-of-family genes.

however, reliable statistics of viruses are hard to obtain due to fast evolutionary rates and short genomes. representations might be affected by high fluctuations and potentially exhibit large statistical errors. in particular for high-dimensional representations, biases can be extremely high. options to overcome this are either to work with simple representations or to reduce biases. representations obtained from either option are evaluated as inputs for the devised algorithm.

the central element of the algorithm is a one-class support vector machine . in contrast to a regular svm, a one-class svm does not require labeled data and hence is particularly suited for the task of outlier detection in virus families where labels are unavailable. it learns a decision function for outlier detection. new data provided to the algorithm are classified as similar or different to the data before seen  <cit> .

methods
one-class svm
given all genes of a virus family, a one-class svm is employed to obtain a ranking of genes from most atypical to most typical. it predicts whether new data is like the data on which it has been trained. similarly to a regular svm, the one-class svm maps data into a feature space by means of a kernel function. in this space, a maximal separating hyperplane is set up such that it separates the data from the origin – manifesting a decision boundary – and maximizes the margin. for a new point, the class membership is determined by evaluating on which side of the hyperplane it falls.

the solution heavily depends on the parameter ν that corresponds to the fraction of data points expected to be on the other side of the decision boundary with respect to the origin. therefore, the one-class svm is also referred to as ν-svm. the position of the decision boundary is influenced by the choice this parameter. for the prediction of atypical genes, we employ a one-class svm with a gaussian kernel. this kernel, particularly suited for real-valued feature sets, requires the proper choice of a second parameter γ controlling the variance of the radial basis function. the selection of values for the parameters ν and γ is demanding as no information on the expected number of outliers is available beforehand. because of the unsupervised nature of the problem, typical parameter selection procedures, such as cross validation, are infeasible.

we note that although in its original formulation, the one-class svm is an approach to binary classification, i.e. differentiation between in-class and out-of-class data, it can well be used to rank the data. to obtain a ranking, the signed distances of each data point from the decision boundary are evaluated. points outside the boundary have distances with a negative sign. for points within the boundary, the distance to the boundary is positive. hence a ranking from most atypical to most typical is obtained by enumerating the genes with respect to their distance to the decision boundary in ascending order. because the exact location of the decision boundary is of minor importance for this task and there is no notion of the expected number of outliers, we select parameters such that a ranking is robustly determined. as discussed in detail in this section, the ranking is considered robust if it remains stable under slight variations of the parameters.

input features
from the genetic sequences of each virus family, various input features are derived to serve as a input to the one-class svm. virus family refers to the taxonomic rank as assigned by the international committee on taxonomy of viruses   <cit> . these features include

oligonucleotide frequencies: the alphabet Σ={a,c,g,t} has |Σ|k words of length k. the oligonucleotide signature is a |Σ|k-dimensional vector of word frequencies. we employ values of  <dig>   <dig>   <dig>  and  <dig> for k to derive feature sets. we do not use oligonucleotide frequencies with k> <dig>  because for some families, there is not enough statistics for such high-dimensional feature spaces.

codon usage: as features, we use a vector of the frequencies of each codon within a genetic sequence. relative codon usage is a vector of codon frequencies relative to the occurrence of synonymous codons.

amino acid frequencies: the 20-dimensional vector of amino acid frequencies is obtained from a protein sequence from the alphabet Σ′={a,r,n,d,c,e,q,g,h,i,l,k,m,f,p,s,t,w,y,v}. this vector can equally be derived from the respective genetic sequence by translation of the codons into amino acids.

position-based nucleotide frequencies: given a genetic sequence, the frequencies of nucleotides in the three codon positions yield a 12-dimensional feature vector.

gc content: the gc content is the proportion of c and g in a sequence from the alphabet Σ.



we compare the performance of the algorithm with these nine different input feature sets. with respect to the amount of information, the gc content is the most primitive feature set. this one-dimensional signature is frequently used for the detection of hgt  <cit>  and hence we use it as a base line to assess performance. it is not provided as input to the one-class svm. instead, the genes of a virus family are ranked by their gc content and then a ranking is induced by their deviation from the median gc content of the virus family.

in addition to the exploration of different input features, we examined the use of linear regression on the gc content with each of these feature sets in advance of providing them to the one-class svm. as viruses typically have short genomes and exhibit high mutation rates, this regression step, successfully applied in metagenomics  <cit> , was thought to reduce bias in the data. however, because the data is standardized to zero mean and unit variance before supplied to the svm, linear regression of any feature set yields the same solution.

parameter selection
to choose values for the parameters ν and γ, we explore a wide range of them. the aim is to achieve stability of the ranking of the data points induced by the signed distances from the decision boundary. a stable result is not necessarily correct but more trustworthy than a result that sensitively varies under small disturbances. the parameter ν takes  <dig>   <dig> equidistant values in the interval − <dig>  where d is the dimensionality of the respective feature space. the latter value for γ is frequently used as a rule-of-thumb value for svms with gaussian kernel. the similarity of the ranked lists, obtained for successive values of ν, is measured by spearman’s rank correlation ρ
 <cit> .

data sets
we consider all viral genes from ena, the european nucleotide archive  <cit> , downloaded in july  <dig>  these data are clustered using cd-hit  <cit>  with a sequence identity level of 95%. representatives of each cluster, grouped by their virus family, yield the data sets. the data sets form the basis to derive feature sets presented as input to the prediction algorithm.

from the initial data sets, simulated data sets for each virus family are created using all genes of that family and adding portion of artificial outliers chosen uniformly at random from all viral genes not from this family such that 5% of the genes in the artificially amended family are outliers. these data with simulated outliers allows for the use of measures of binary classification performance during the evaluation. however it should be pointed out that the actual outliers remain unrecognized in the data and compete with the artificially added outliers. we did not perform any comparison with proven events of hgt, since no collection of such events exists for viruses.

measure of performance
area under curve  scores are used to evaluate the performance in the simulated setting. auc is defined as the area under a receiver operator characteristics  curve. the roc curve for binary classification is a plot of the true positive rate as a function of the false positive rate when different cutoffs for the number of predicted atypical genes are considered. for the simulated data sets, the upper 5% of the list are considered as predicted atypical genes.

the performance of the prediction method was also assessed by measuring the auc scores when the labels are inferred from blast searches  <cit>  for each gene in the result. genes are considered atypical if they have at least one bi-directional blast hit outside the viral family , and the sequences of the two genes are similar over 80% of the length of the family gene. as this labeling can at most reveal a trend, additional literature search is conducted for a number of genes to strengthen the analysis. the blast search is executed on protein level using blast version  <dig> . <dig> with default parameters querying the uniprot database  <cit> .

RESULTS
the expected result of the one-class svm, given a feature set and parameters ν and γ, is a ranked list, sorted from the most atypical gene to the most typical gene in the respective virus family. before analyzing the performance, initial focus is on the selection of appropriate parameters ν and γ.

robustness of the prediction
the assessment of ranking stability is illustrated for partitiviridae and a feature set based on codon usage estimates . each point depicts the average spearman’s rank correlation coefficient over the prediction result with the neighboring values of ν. a value of  <dig> indicates that the ranking obtained with the current value of ν is identical to the ranking resulting from the preceding value of ν and the subsequent value of ν.figure  <dig> 
ranking stability under varying
ν
for different values of
γ
. correlation between prediction results under varying ν for different values of γ . the prediction results originate from partitiviridae using codon usage estimates as feature set. every point corresponds to the correlation between the prediction result for one value of ν and the prediction result for the next value of ν, averaged with the correlation between the result for current value of ν and the previous. the step size between subsequent values of ν is  <dig> .



for ν> <dig> , the ranking remains invariant under changes of ν irrespective of the choice of γ. the smaller ν is, the smaller the observed correlation between neighboring parameter sets. additionally, the stability depends on γ. for small values of γ, the stability is generally better than for large values of γ. the prediction result obtained with large values of γ can be very sensitive to small deviations in ν. for some feature sets , if the value of γ is large, there is not even a trend towards increasing stability when ν is large.

for all parameter sets and for all virus families, we observe that γ=− <dig> yields a high stability over a large range of ν. this finding confirms that this rule of thumb for the selection of γ is a reasonable choice. thus, we refrain from conducting the subsequent evaluation for multiple values of γ and fix it to γ=− <dig> 

the parameter ν impacts the proportion of outliers we expect to observe in the data. this proportion however is unknown. the ranking stability analysis indicates that assuming the proportion of outliers to be very low might yield an unstable prediction result. because we do not rely on the binary labels from the one-class svm result but rather on the signed distances to the decision boundary, we can fix ν such that the ranking is stable irrespective of assumptions on the actual number of alien genes.

to evaluate the prediction algorithm for the different sets of input features and different svm parameters we establish a measure of success. the prediction of atypical genes in a viral family is considered successful if the auc score exceeds  <dig>  and semi-successful if it only exceeds  <dig>  in the simulated data setting. the prediction for a family is considered successful if success is reported for at least one combination of feature set and parameters.

values of ν smaller than  <dig>  yield less successes than larger ν . the semi-success rates are constantly around 80%. among the larger νs, there is no preference for a specific value. we fix ν= <dig>  for the subsequent analysis.figure  <dig> 
success rates of the one-class svm for different values of
ν
. the proportion of successfully predicted families is depicted in darkgray, the proportion of semi-successes in lightgray.



prediction quality on simulated data
the assessment of performance on simulated data shows the quality of the established model.

from the ena database  <cit>  we obtain  <dig> virus families with more than three genes recorded. for  <dig> of them, our method is capable of identifying the alien genes with auc score larger than  <dig>  in at least one set of features . for  <dig> of the families the auc scores are larger than  <dig> . the number of genes in the families ranges from less than  <dig> to more than  <dig>   <dig> for phycodnaviridae and flaviviridae. the family of retroviridae is too large to be processed as a whole and is split up taking a lower level of taxonomy, the level of genus. on this level, the genus lentivirus still comprises more than  <dig>   <dig> genes from which we sample only  <dig>   <dig> uniformly at random.

the large deviations in the number of genes per family are the result of a bias in research intensity. the family of flaviviridae for example comprises viruses such as dengue virus, yellow fever virus, hepatitis c virus, and swine fever virus. these viruses are infectious to humans or domestic animals and are therefore of particular interest. the genus lentivirus includes hiv which is subject of intensive research as it causes the acquired immunodeficiency syndrome . phycodnaviridae infect algae and are probably so numerous in the database because of metagenomic studies of water samples.

comparing auc scores obtained in all families for different feature sets we find indications of very good performance. in particular in comparison with the primitive prediction method based on gc content, the quality of the approach becomes evident: the median auc scores are  <dig>  for that method and between  <dig>  and  <dig>  for the more sophisticated feature sets. median scores above  <dig>  are observed only for oligonucleotide frequencies . generally, the oligonucleotide frequencies of length k≥ <dig> appear to be the most preferable feature sets, tetranucleotide frequencies being the best performing.figure  <dig> 
boxplot of auc scores on simulated data for different feature sets. gray bars indicate the median score observed in all families and 50% of all scores fall within the range indicated by the black boxes. the horizontal line at  <dig>  highlights the score expected for a random result.



for completeness, we display also sample results obtained using linear regression for the derivation of the feature sets . the median score with these feature sets is  <dig> , which is inferior to the performance of feature sets without regression. the difference in performance explains by the fact that there are de facto only two distinct dimensions as explained in the previous section.

comparison of the prediction results with the naïve labeling using blast
we have compared out prediction results with potential hgt genes identified by blast  <cit> . the assumption behind this is that if a hgt event is predicted correctly, we may find a related gene in an organism outside the immediate viral family. thus, we label a gene as atypical according to blast if there is at least one bi-directional blast hit outside the virus family under consideration with the similarity observed over at least 80% of the query gene length. this labeling implies many shortcomings. besides biases from the fact that different organisms are studied with different intensity, it does not differentiate between hits that can occur due to gene transfer from the particular family to another and those that occur due to gene transfer into the family or that may be a signature of a common ancestry. while with this naïve labeling, all three cases are classified atypical, the prediction algorithm is supposed to identify only the second case. the observation of concordance between the prediction result and the labeling derived from the blast searches, despite these shortcomings, provides support, yet no proof, for the established methodology. on the contrary, inconsistency between the labeling and the prediction result does not imply failure of the prediction algorithm. in any case, the most valuable support, if at all, has to be provided by extensive literature search.

despite their effectiveness, blast searches become infeasible for large virus families. therefore, we restrict this analysis to  <dig> families. considering the distributions of scores from all these families together yields no indication of success for any of the feature sets. all median scores are close to  <dig> , the highest being  <dig>  for the tetranucleotide frequency feature set . codon usage-based feature sets produce second-largest auc scores of  <dig> . considering this together with the performance results for the simulated data, we conclude that codon usage-based tetranucleotide frequency feature sets produce most reliable results. overall, we do not observe any significant correlation between the predictions of our algorithm and the labeling inferred from blast. however, for some families, we observe the prediction result and the labeling inferred from blast searches to be partially in conjunction with each other, as manifested by auc scores much higher than  <dig> . a few such examples are discussed below.figure  <dig> 
boxplot of auc scores between the one-class svm prediction results and the blast search results on different feature sets. only  <dig> families are taken into account. the horizontal line at  <dig>  highlights the score expected in case of a random result.



orthomyxoviridae
many feature sets perform well for this family, as demonstrated by the average auc score of  <dig> . interestingly, the gc content privedes very good agreement with blast-based annotation, rendering an auc score of  <dig> .

the most prominent members of orthomyxoviridae are influenza viruses. they cause infectious diseases in mammals and birds spreading in seasonal epidemics. orthomyxoviridae are viruses with single stranded anti-sense rna which implies that the nucleotide frequencies might deviate from chargaff’s rule  <cit> . the atypical genes identified by both the labeling inferred from blast searches and the one-class svm exhibit nucleotide frequencies in accordance with chargaff’s rules while a large proportion of genes, mostly from influenzavirus a, show opposing behavior in the frequencies of adenine and thymine.

influenzavirus a is the subject of intensive study, and its genes constitute 95% of the genes of the orthomyxoviridae family in our data. for the one-class svm approach, it is possible that this imbalance influences the identification of atypical genes. the blast algorithm however is independent of statistical signatures of viral families and yields a similar result: atypical genes are found among genes not from influenzavirus a and typically have high gc content. of a total of  <dig> atypical genes identified by the blast search, none are from influenzavirus a. the high evolutionary rate in the influenza a virus attributed to positive selection through the human immune system  <cit>  and a very narrow specialized set of its proteins can be the reason why the horizontally transferred genes are not accommodated by this virus.

support for our method is provided by the identification of the araguari virus partial glycoprotein , dhori virus partial glycoprotein , batken virus partial glycoprotein , and several partial glycoproteins from thogoto virus strains  as atypical genes. these genes occur within the top  <dig> of  <dig> in the ranked list result when using the tetranucleotide frequencies feature set. all these viruses belong to the thogotovirus genus. the thogoto virus glycoprotein has been found to have resemblances to the baculoviral glycoprotein gp <dig> indicating a possibility of gene transfer  <cit> .

circoviridae
in circoviridae we observe the auc score to reach  <dig>  for the tetranucleotide frequency feature set. circoviridae have a circular single-stranded dna genome. they are broadly distributed among vertebrates without causing illnesses for most organisms. the blast hits of the top ranked genes refer to a variety of species: chicken anemia virus partial protein vp <dig>  is found to exhibit similarity to the rmuc-domain protein  from odoribacter splanchnicus; and a protein of unknown function from duck circovirus  is similar to serine/threonine protein kinase related protein  from spirochaeta sp. furthermore, a number of replication-associated proteins, including rep  from bat circovirus zs/yunnan-china/ <dig>  the putative rep  from circoviridae batcv-sc <dig> are similar to a rep-like protein  of canarypox virus, a dsdna virus. the multiple cases of similarity between the rep protein to proteins from unrelated viruses hint to a complex history of this protein, which has been corroborated by previous research: meehan et al. hypothesize that rep has originated through recombination, combining gene segments from unrelated viruses  <cit> ; and gibbs et al. identified rep-like genes by means of a database search and speculate that these genes originated by multiple interspecies recombinations as they are represented in viral, plasmid, bacterial, and parasitic protozoan genomes  <cit> .

flaviviridae
for flaviviridae, we observe an auc score of  <dig>  for the position-based nucleotide frequencies feature set. flaviviridae have a single-stranded sense rna genome and are often spread through ticks and mosquitoes. they are subject of intense studies as they are infectious to humans and domestic animals. the majority of flaviviridae genes in ena stems from hepatitis c virus. a sub-population of these genes, like influenzavirus a genes in orthomyxoviridae, exhibits strong deviations from chargaff’s rule in their nucleotide composition. the prediction algorithm as well as the labeling based on the blast search identify atypical genes from wang thong virus  and culex flavivirus . the corresponding non-viral genes are found in asian tiger mosquito and yellowfever mosquito, likely hosts of these viruses. thus this represents most probably the inverse event of horizontal gene transfer from virus into its host.

hepadnaviridae
for hepadnaviridae, the auc scores reach  <dig>  for relative codon usage and tetranucleotide frequencies feature sets, indicating good correlation between the labels inferred from blast searches and the prediction result. hepadnaviridae have a reversely transcribed double-stranded dna genome that get integrated into the host genome for transcription during their replication process. hepadnaviridae infect mammals and birds. all the blast hits outside hepadnaviridae can be explained by the integration of the virus genome into the host. they stem from a sequence analysis of hepatocellular carcinoma in hepatitis b infected woodchuck  <cit>  and from a study on budgerigar genomes being infiltrated by hepadnaviruses millions of years ago  <cit> . the blast search in this case provides no information on the validity of the svm based prediction.

given the average auc scores around  <dig>  for all examined families , the question rises whether the svm prediction and the blast search actually have a reasonable overlap that allows for conclusions. at least for hepadnaviridae, and potentially also for other retro-transcribing viruses, the labeling inferred from blast is not informative and hence allows for no statement about the prediction performance of the svm.

siphoviridae
for some virus families, auc scores of at most  <dig>  indicate poor prediction results. siphoviridae is one example where scores below the performance of a random classification are observed. the reason for these scores is that almost every gene from siphoviridae yields blast hits outside the family and thus, to attain a good score, the few genes with no hits outside would need to be at the very end of the ranked result and not somewhere in the middle. our method however is tuned for the identification of a minority of atypical genes and not a minority of typical genes. the test with the blast search appears to be not applicable in this case.

siphoviridae are bacteriophages and can shuttle genes between bacterial species. this mechanism, known as transduction, is a common mechanism of horizontal gene transfer among bacteria. therefore, it is not surprising that many genes from siphoviridae have bacterial counterparts which are detected by the blast search.

this example shows that the prediction quality on real data is hard to assess. good or bad auc scores in comparison with blast labeling are a sign neither of failure nor of success of the prediction algorithm. they only associate two labeling procedures and neither can be validated. however, if there were a perfect validation strategy, it would already solve the problem.

comparison to other available methods
machine learning techniques have been employed for the identification of horizontal gene transfer events before: specifically, composition-based statistics have been used by tsirigos and rigoutsos  <cit>  and dufraigne et al.
 <cit> . in both studies, statistics were collected from segments identified by a sliding window over a genome of a single species. either tetramers in conjunction with distance-based prediction  <cit> , or complex compositional feature vectors and one-class svms  <cit>  can be used. our approach bears similarity to both of these methods, but works on the level of complete genes and viral families. the details of the implementation of the svm also differ: while we fix parameters beforehand and report the ranking induced by the distances of each gene to the decision hyperplane, tsirigos and rigoutsos estimate the parameter ν such that, in an artificial setting, the ratio of recovered artificially inserted genes is maximized. as this kind of selection is infeasible in a real setting, regions are reported as a candidate for gene transfer only if they were marked as atypical at a number of tested values of ν. for the sake of comparison, we have modified the algorithm to use single species genomes and a sliding window of the size coinciding with the respective study.

tsirigos and rigoutsos  <cit>  report the prediction of regions of atypical composition ranked from most to least atypical in  <dig> viruses from the families of asfaviridae, baculoviridae, herpesviridae, iridovoridae, nimaviridae, nudiviridae, phycodnaviridae, and poxviridae, and unclassified dsdna viruses. we selected a representative set of  <dig> viral strains, created a set of segments using the sliding window approach, and ranked them using  the compositional statistics calculated for the same set of segments, and  using statistics for the whole family this virus belongs to . the comparison with the ranking from  <cit>  shows overall good agreement of the results, although it varies largely among the strains . the curves represent the fraction of the shared segments in a top fraction of the two lists: one from  <cit> , and the other calculated with our method. interestingly, the usage of family-based statistics appears to compensate for a more simplistic sequence representation , as reflected by aucs that are significantly higher in this case . this can make our method potentially better suited for species with small genome size and skewed nucleotide composition, e.g. rna viruses or retroviruses.figure  <dig> 
comparison with  <cit> . each curve on the plot represents the fraction of the shared segments in a top fraction of the lists generated by our algorithm and reported in  <cit> . the tetranucleotide statistics in our method were calculated using a single species sequence  and all genes from the corresponding family .
distribution of auc scores in comparison with  <cit> . boxplot of auc scores corresponding to the comparison of the results of our method and that of  <cit> . the tetranucleotide statistics in our method were calculated using a single species sequence  and all genes from the corresponding family .



of the  <dig> representative viruses, the best agreement with the results of  <cit>  is observed for bovine papular stomatitis virus , chimpanzee cytomegalovirus, and invertebrate iridescent virus  <dig> . it is plausible that bovine papular stomatitis virus harbors genes that were horizontally transferred to it from its host  <cit> . the possibility of gene transfer from the host into iridoviridae  has also been discussed in the literature  <cit> . we do not have specific information for chimpanzee cytomegalovirus, but for human cytomegalovirus, four genes are pointed out as gpcr homologs and thus having potentially eukaryotic origin: ul <dig>  ul <dig>  us <dig> and us <dig>  <cit> . in all of them except us <dig>  we also identify atypical segments with a rank within top 20% using family-based statistics.

in another study,  <dig> bacterial genomes were analyzed to predict the events of hgt using tetranucleotide statistics  <cit> , which makes it also similar to our method. again, we mimicked this approaches by considering segments of genomic sequence of the corresponding species, and using all genome assemblies from ncbi for each species  as the source for the tetranucleotide frequency statistics. for  <dig> of the  <dig> species we were able to obtain results within reasonable time, and calculated the rank of the first segment ovelapping with a hgt segment reported by  <cit>  . in all cases except a. pernix the median of these ranks lies within top 10%, which indicates a very good agreement of our methods with that of  <cit> , although our method was not specifically trained to make predictions in bacteria.figure  <dig> 
distribution of hgt segment ranks in comparison with  <cit> . boxplot of ranks of the first overlapping segment with those identified as horizontally transferred by  <cit> . red lines indicate the total number of the considered segments.



CONCLUSIONS
the presented one-class svm model convincingly identifies potential examples of hgt in cases when they were artificially added to a family but in many cases does not agree well with labels derived by blast. given statistics about the composition of a viral family, the method robustly identifies the genes that are most atypical for the family. the model can provide no guarantee for the identified genes to be horizontally transferred. its prediction is based solely on statistics using no external information to attain additional evidence for or against the result. the interpretation of the result remains to be derived manually. compared to phylogenetic analysis for hgt indetification, out method presents the following advantages:  it can identify hgt events without any assumptions about the source species ; and  it can operate with much larger sets of genes than even the simplest sequence comparison.

we have specifically tested our algorithm only on real virus sequence data. unlike artificial data, these data have shortcomings. aside from issues of correctness and completeness of the gene records, statistical biases are what makes prediction very difficult. while for some viruses there are very few genes in the database, others are the subject of intensive study and thousands of gene records exist. for a virus family of which one member is highly over-represented, the prediction algorithm will regard the genes of this member as typical for the whole family. this bias could be eliminated by sampling down the number of genes per species to that of the species with least genes in the family. the downside of this procedure is a possible loss of information if the that number is very low.

due to the use of real data, not only the assessment of performance in the real setting is difficult but also the simulated data sets are affected by shortcomings in the data as they are constructed from these data. the simulated atypical genes added to each family are taken from the set of all other viral genes. they are distributed uniformly with respect to the total number of genes other than from the family of interest. hence, it is biased towards well studied families with many gene records in the database. for this reason, it is possible that the observed performance for families with properties similar to large families is underestimated while the performance established for families with properties very different from the characteristics of large families is overly optimistic. it is also evident that we cannot expect to observe perfect prediction performance on the simulated data as the true unlabeled outliers remain in the data sets and should be identified by the prediction algorithm just like the artificial atypical genes.

for the evaluation of performance on the real data sets, the comparison to the result of blast searches is not a perfect strategy. as the one-class svm approach, the blast result is affected by the presence or absence of information as well, yet with different consequences: blast does not construct a statistical model for viral families but summarizes which other genes similar to the one queried exist in the uniprot database. if the gene of interest is from a well studied group of related families, very good matches will be found among the genes of common ancestry, occluding matches from other families as we only consider the first  <dig> hits. in case of gene transfer of a viral gene not into but out of the considered family, this gene is labeled atypical irrespective of its statistical features.

despite these difficulties, we observe overall reasonable recovery of simulated atypical genes in the data sets and were able to identify genes proposed to be horizontally transferred in the literature. we also note that the presented methodology can be directly applied for the identification of hgt in cellular organisms as well.

competing interests

the authors declare that they have no competing interests.

authors’ contributions

sm formulated and implemented the algorithm, produced the predictions and carried out the evaluation for the individual viral families. ovk conceived the study, formulated the algorithm, analyzed the results and carried out the benchmark against other available methods. both authors wrote, read and approved the final manuscript.

