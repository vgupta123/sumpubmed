BACKGROUND
a significant portion of genomic data that is currently being generated extends beyond traditional primary sequence information. genome-wide epigenetic characteristics such as dna and histone modifications, nucleosome distributions, along with transcriptional and replication center structural insights are rapidly changing the way the genome is understood. indeed, these new data from high-throughput sources are often demonstrating that much of the genome's functional landscape resides in extra-sequential properties.

with this influx of new detail about the higher-level structure and dynamics of the genome, new techniques will be required to visualize and model the full extent of genomic interactions and function. genome browsers, such as the uscs genome database browser  <cit> , are specifically aimed at viewing primary sequence information. although supplemental information can easily be annotated via new tracks, representing structural hierarchies and interactions is quite difficult, particularly across non-contiguous genomic segments  <cit> . in addition, in spite of the many recent efforts to measure and model the genome structure at various resolutions and detail  <cit> , little work has focused on combining these models into a plausible aggregate, or has taken advantage of the large amount of genomic and epigenomic data available from new high-throughput approaches.

to address these issues, we have created an interactive 3d viewer, genome3d, to enable integration and visualization of genomic and epigenomic data. the viewer is designed to display data from multiple scales and uses a hierarchical model of the relative positions of all nucleotide atoms in the cell nucleus, i.e., the complete physical genome. our model framework is flexible and adaptable to handle new more precise structural information as details emerge about the genome's physical arrangement. the large amounts of data generated by high-throughput or whole-genome experiments raise issues of scale, storage, interactivity and abstraction. novel methods will be required to extract useful knowledge. genome3d is an early step toward such new approaches.

implementation
genome3d is a gui-based c++ program which runs on windows  platforms. its software architecture is based on the model-viewer-controller pattern  <cit> . genome3d is a viewer application to explore an underlying physical model displaying selections and annotations based on its current user settings. to support multiple resolutions and maintain a high level of interactivity, the model is designed using an object-oriented, hierarchical data architecture  <cit> . genome3d loads the model incrementally as needed to support user requests. once a model is loaded, genome3d supports ucsc genome browser track annotations of the bed and wig formats  <cit> .

at highest detail, a model of the physical genome requires a 3d position  for each bp atom of the genome. the large amount of such data  is reduced by exploiting the data's hierarchical organization. we store three scales of data for each chromosome in compressed xml format. atomic positions are computed on demand and not saved. this technique reduces the storage size for a human genome to ~ <dig>  gigabytes, resulting in more than 400× savings. there are several sample models available for download from the genome3d project homepage. more information of our representative model and its data format can be found in additional file  <dig> 

RESULTS
genome3d program features
the range of scales and spatial organizations of dna within the human cell presents many visualization challenges. to meet these challenges, genome3d manipulates and displays genomic data at multiple resolutions. figure  <dig> shows several screen captures of the genome3d application at various levels of detail. genome3d allows the user to specify the degree of detail to view, and the corresponding data is loaded dynamically. because of the large amount of data and the limited memory that is available, only portions of the data can typically be viewed at high resolution. the interactivity of genome3d facilitates exploring the model to find areas of interest. additionally, the user can configure various display parameters  to highlight significant structural relationships.

genome3d features include:

• display of genomic data from nuclear to atomic scale.

genome3d has multiple windows to visualize the physical genome model from simultaneous different viewpoints and scales. the model resolution of the current viewing window is set by the user, and its viewing camera is controlled by the mouse. resolutions and viewpoints depend of the type of data that is being visualized.

• a fully interactive point-and-select 3d environment

the user can navigate to an arbitrary region of interest by selecting a low resolution region and then loading corresponding higher resolution data which appears in another viewing window.

• loading of multiple resolution user-created models with an open xml format

the genome3d application adheres to the model-view-controller software design pattern  <cit> . the viewing software is completely separated from the multi-scale model that is being viewed. we have chosen a simple open format for each resolution of the model, and users can easily add their own models.

• image capture and povray/pdb model export support

genome3d supports screen capture of the current display image to a jpg format. for highly quality renders, it can export the current model and view as a povray model  <cit>  format for off-line print quality rendering. in addition, atomic positions of selected dna can be saved to a pdb format file for downstream analysis.

• incorporation and user-defined visualization of ucsc annotation tracks onto the physical model

the ucsc genome database browser has a variety of epigenetic information that can be exported directly from its web-site  <cit> . this data can be loaded into genome3d and displayed on the currently loaded genome model.

visualizing integrated epigenetic and genomic data
we now give a few examples of applying biological information to a model and suggest possible methods of inferring unique structural relationships at various resolutions. one of the advantages of a multi-scale model is the ability to integrate data from various sources, and perhaps gain insight in higher level relationships or organizations. we choose to concentrate on high-throughput data sets that are becoming commonplace in current research: genome wide nucleosome positions, snps, histone methylations and gene expression profiles. the sample images, which can be visualized in genome3d, were export and rendered in povray  <cit> .

the impact of nucleosome position on gene regulation is well-known  <cit> . in addition to nucleosome restructuring/modification  <cit> , the rotation and phasing information of dna sequence may also play a significant role in gene regulation  <cit> , particularly within non-coding regions. figures 2a, b show a non-coding nucleosome with multiple snps using genome-wide histone positioning data  <cit>  combined with a snp dataset  <cit> . it highlights one of the advantages of three dimensional genomic data by clearly showing the phasing of the snps relative to the histone. observations of this type and of more complicated structural relationships may provide insights for further analysis, and such hidden three-dimensional structure is perhaps best explored with the human eye using a physical model.

another important source of epigenomic information is histone modification. genome-wide histone modifications are being studied through a combination of dna microarray and chromatin immunoprecipitation   <cit> . histone methylations have important gene regulation implications, and methylations have been shown to serve as binding platforms for transcription machinery. the encode initiative  <cit>  is creating high-resolution epigenetic information for ~1% of the human genome. despite the fact that such modification occurs in histone proteins, current approaches to map and visualize such information are limited to sequence coordinates in the genome. our physical genome model visualizes methylation of histone proteins at atomic detail as determined by crystal structure. figure 2c shows histone methylations for several histones within an encode region. an integrated physical genome model can show the interplay between histone modifications and other genomic data, such as snps, dna methylation, the structure of gene, promoter and transcription machinery, etc.

in addition to epigenomic data, the physical genome model also provides a platform to visualize high-throughput gene expression data and its interplay with global binding information of transcription factors. we consider a sample analysis of transcription factor p <dig>  genome-wide binding sites of p <dig> proteins  <cit>  can be combined with the gene expression results from a study investigating the dosing effect of p <dig>  <cit> . this may identify genes that have p <dig> binding sites in their promoter regions and are responsive to the dosing effect of p <dig> protein. such large-scale microarray expression data is often displayed with a two-dimensional array format, emphasizing shared expression between genes, while p <dig> binding data are stored in tabular form. with a physical model, expression levels of genes in response to p <dig> level can be mapped to genome positions together with global p <dig> binding information, revealing any structural bias of the expression. figure  <dig> shows this type of physical genome annotation. drawing inferences from coupling averaged or "snap-shot" expression data with the dynamic architecture of the genome may be helpful in determining structural dependences in expression patterns.

discussion
to illustrate the capability of genome3d to integrate and examine data of appropriate scales, we constructed an elementary model of the physical genome . this basic model is approximate since precise knowledge of the physical genome is largely unknown at present. however, the model's inaccuracies are secondary to its multi-scale approach that provides a framework to improve and refine the model. current technologies are making significant progress toward capturing chromosome conformation within the nucleus at various scales  <cit> . because our multi-scale model is purely descriptive beyond the ncp scale, it can easily incorporate more accurate structural folding information, such as the 'fractal globule' behaviour  <cit> . the genome3d viewer, decoupled from the genome model, can be used to view any model that uses our model framework.

building a 3d model of a complete physical genome is a non-trivial task. the structure and organization at a physical level is dynamic and heavily influenced by local and global constraints. a typical experiment may provide new data at a specific resolution or portion of the genome, and the integration of these data with other information to flesh out a multi-resolution model is challenging. for example, an experiment may measure local chromatin structure around a transcription site. this structure can be expressed as a collection of dna strands, ncps, and perhaps lower resolution  <dig> nm chromatin fibers. our data formats are flexible enough to allow partial integration of this information, when the larger global structure is undetermined, or inferred by more global stochastic measurements from other experiments. combining such data across resolutions is often difficult, but establishing data formats and visualization tools provide a framework that may simplify the integration process.

CONCLUSIONS
recent advances in determining chromosome folding principles  <cit>  highlight the need for new visualization methods. more detailed three-dimensional genomic models will help in discovering and characterizing epigenetic processes. we have created a multi-scale genomic viewer, genome3d, to display and investigate genomic and epigenomic information in a three-dimensional representation of the physical genome. the viewer software and its underlying data architecture are designed to handle the visualization and integration issues that are present when dealing with large amount of data at multiple resolutions. our data structures can easily accommodate new advances in chromosome folding and organization.

a common framework of established scales and formats could vastly improve multi-scale data integration and the ability to infer previously unknown relationships within the composite data. our model architecture defines clear demarcations between four scales , which facilitates data integration in a consistent and well-behaved manner. as more data become available, the ability to model, characterize, visualize, and perhaps most crucially, integrate information at many scales is necessary to achieve fuller understanding of the human genome.

availability and requirements
project name: genome3d

project homepage: http://genomebioinfo.musc.edu/genome3d/index.html

operating system: windows-based operation systems 

programming language: c++ and python

other requirements: openglv <dig>  and glsl v <dig>  

any restrictions to use by non-academics: none

authors' contributions
wjz conceived the initial concept of the project and developed the project with tma. tma developed the 3d genomic model and worked with mm to develop the genome3d software. jt and wjz advised tma and mm on the software development, and wjz oversaw the whole project. all authors read and approved the final manuscript.

supplementary material
additional file 1
supplemental information. additional details about human physical genome model construction and the genome3d software.

click here for file

 additional file 2
genome3d v <dig>  readme. the readme file for genome3d software.

click here for file

 acknowledgements
this work is partly supported by grants irg 97-219- <dig> from the american cancer society, computational biology core of  <dig> ul <dig> rr029882- <dig>   <dig> r <dig> gm063265-09s <dig>  a pilot project and statistical core of grant  <dig> p <dig> rr017696- <dig>  phrma foundation research starter grant, a pilot project from 5p20rr <dig> to w.j.z, and nsf  <dig> and  <dig> r <dig> gm078991-03s <dig> to jt. t.m.a. is supported by nlm training grant 5-t15-lm007438- <dig>  the authors thank y.ruan for valuable discussion about the project, k.zhao and d.e.schones for providing nucleosome positioning data, m.boehnke for critical reading of the manuscript, and t qin, lc tsoi, and k. sims for software testing. the high performance computing facility utilized in this project is supported by nih grants: 1r01lm <dig>  p20rr <dig>  1t32gm <dig> and 1t <dig> lm <dig> 
