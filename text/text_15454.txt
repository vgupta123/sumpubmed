BACKGROUND
electron cryomicroscopy  is a fast developing experimental technique aiming at the determination of the 3-dimensional structure of large protein complexes  <cit> . although not yet at the atomic resolution, this technique can be used to generate protein density maps at  <dig> to  <dig> Å resolution  <cit> . computational methods have been developed to detect the secondary structures such as helices and β-strands from the density map at this resolution  <cit> . since the secondary structures are often the major building blocks of a structure, the detected secondary structures appear as the skeletons  of the density map. in the density map of 6– <dig> Å resolution, alpha helices look like sausages with 5– <dig> Å in diameter, and beta-sheets appear as extended volumes with varying sizes. the connection relationship between the skeletons is often unavailable in the density maps.

given a protein sequence, the location of secondary structures on the sequence can be roughly predicted using existing secondary structure prediction methods. such methods can generally predict the secondary structures to about 70–80% accuracy  <cit> . although not completely correct, the predicted secondary structure segments of the sequence provide a rough location of the secondary structures. wu et al has used the secondary structure geometrical relationships existing in the pdb to reduce the topological space. the reduced possible topologies were then used to add the loops and a simulation of the entire chain was used to identify the true topology  <cit> . we have also shown previously that the decoys generated by rosetta ab initio structure prediction software can be used to reduce the topological space  <cit> . in this paper, we will introduce a method that directly measures the contact energy of the secondary structures to reduce the topological space of the skeletons. this is the first such demonstration. the secondary structure topology problem of the cryoem density map is to find the true mapping between the predicted secondary structure segments on the sequence and the skeletons of the density map. secondary structure topology in this paper refers to the order and the direction of the secondary structures such as helices and strands with respect to the protein sequence. for a protein with n helices and m strands, there are  different topologies. for example, there are n! different permutations for assigning n helix segments to n helix skeletons and two directions to assign a sequence segment to each skeleton.

this paper investigates the following question. given the skeletons detected in the protein density map, is it possible to derive a small subset of the topological space that contains the native topology of the secondary structures using a direct measurement of the energy formed by the secondary structures? the determination of favourable secondary structure topologies has always been one of the most essential problems in tertiary structure prediction. although predicting the topology, in general, is as hard as predicting the tertiary structure, it is not clear if it is true when the rough location of the secondary structures is known.

systematic mutation analysis has shown recently that the native protein sequence for a specific 3-dimensional structure is close to optimal  <cit> . this is intuitively not surprising since nature might have derived a near optimal sequence to achieve the function through evolution. the research in this paper is guided by the intuition that when the relative geometry of the secondary structures is fixed in the 3-dimensional space, there might only be a small number of topologies that can provide energetically favorable structures. in this paper, we describe a method to perform mutation analysis for the secondary structures. it generates possible atomic structures for the skeletons through the exhaustive search in the topology space of the secondary structures.

methods
the overall framework to generate the possible secondary structure topologies contains two stages. the first stage is part of the second stage, but it demonstrates the potential of the overall approach. the question for the first stage is how to generate all the topologies if the positions of the cα atoms in the secondary structures are given. note that the cα atoms are not resolved in the low resolution density map, although the location of the secondary structures can be computationally detected  <cit> . the second stage starts with the axial location of the skeletons, rather than the backbone atom locations. it generates the coordinates of the cα atoms through translation and rotation around the axis. the second stage in this paper only implemented the helices, although the first stage implemented both the helices and β-strands. figure  <dig> shows a flowchart of the topology generation. we have done a test of stage  <dig> using  <dig> proteins. our preliminary result of stage  <dig> involves  <dig> proteins.

stage  <dig> – secondary structure mutation and side chain optimization
for each of the tested proteins, a total of 2n2mof all the possible topologies were generated, where n is the number of helices and m is the number of beta strands. a mutated topology of the secondary structures was generated using the coordinate of the backbone atoms of the secondary structures and the sequence segments that form the secondary structures. two major steps were involved:  mapping sequence segments to the skeletons and  construction of the side chain atoms. figure  <dig> shows an example of a native topology  and a mutated topology  of the secondary structures.

in the native topology, r <dig>  r <dig> and r <dig> skeletons were assigned to the sequence segments h <dig>  h <dig>  and h <dig> respectively. in the mutated topology, r <dig>  r <dig> and r <dig> were assigned to h <dig>  h <dig>  and h <dig> respectively. when the length of the sequence segment  does not match that of the skeleton , we used the length of the skeleton as the reference. the sequence segment was either truncated  or padded  based on the distance from the center amino acid of the segment. for example, when r <dig> is mutated from h <dig> to h <dig>  three amino acids were deleted from each end of h <dig> . when r <dig> is mutated from h <dig> to h <dig>  h <dig> is padded with six amino acids to match the length of r <dig>  in this case, since h <dig> is only two amino acids away from the end of the sequence, it is padded more at the other end.

after the sequence segments were assigned to the skeletons, the side chains were constructed. the rotamer library was used and the side chains were relaxed using the simulated annealing  <cit> .

multi-well energy function
we have developed a multi-well energy function by incorporating the statistical data to a lennard jones shaped function  <cit> . the multi-well function is composed of the original lennard jones shaped function )  <cit>  and the statistically derived function )using two window functions f <dig> and f <dig> 

  u=f0u0+f1u1 =f0⋅eij⋅+f1⋅eij⋅ 

the eij is the contact energy between two amino acids  <cit> . the p, q and r <dig> are adjustable parameters. rmn is the distance between the side-chain centers of residue m and n. the signs are chosen to be positive if eij >  <dig>  or negative if eij <  <dig>  there is a potential well near the favorable side-chain distance r <dig> in u <dig>  λrmn, npeak and c are statistically derived parameters based on an analysis of  <dig> selected proteins from the pdb. here λrmn is a non-dimensional coefficient varying with distance rmn and represents the depth of the potential well. rk is the position of the k-th residue distance peak in the distribution curve of the residue pair distance. here the window functions f <dig>  f <dig> satisfy:

  u={u <dig> r1−δ≤rmn≤rnpeak+δu <dig> rmn<r1−δorrmn>rnpeak+δ 

r <dig>  rnpeak are the first and the last peak positions respectively in the distance distribution. δ is a small constant to allow the smooth connection between u <dig> and u <dig> that are combined using a set of window functions f <dig> and f <dig>  by statistical analysis of  <dig> proteins in pdb, a new multi-well contact energy function was developed for each of the  <dig> residue pair interaction. the contact energy measured is the mean of the energy from all the contact pairs in the secondary structures. both the intra and inter secondary structure energy were considered. the contact energy from a pair of residues within a helix or a strand is the intra energy, and the contact energy from a pair of residues in different helices or stands is the inter energy. the average of inter and intra energy, named as effective contact energy ueff, was used as a measurement of the stability of the secondary structures. we are preparing another paper to with more details about the construction of the energy function.

stage  <dig> – sequence assignment to the skeletons
in stage  <dig>  we assumed that the number of detected skeletons and the number of the sequence segments of the secondary structures are the same. in a general case, suppose that there are kα sequence segments forming helices and kβ sequence segments forming β-strands in a native protein structure. let's also suppose that there are n helix skeletons and m strand skeletons detected from the protein density map. based on our experience, kα and kβ are usually larger numbers than n and m respectively. the total number of different sequence combination is:

  ncomb=ckαnckβm= 

for each set of the sequence segments picked from kα and kβ, the total number of possible sequence assignment is , as was dealt with in the first stage. when not all the secondary structures are detected in the density map, the total number of topologies is:

  nperm=ckαnckβm×n!×2n×m!×2m 

when the sequence segments are predicted using a secondary structure prediction tool, such as psipred  <cit> , the predicted segments are often shifted from their corresponding true locations. in order to estimate the magnitude of the computation, let's suppose that each sequence segment can have a shift in both directions with a maximal number of p amino acids. then there are 2p+ <dig> possible sequence segments for each true segment. the total number of assignments for the skeletons is

  ntotal=ckαnckβm×n!×2n×n×m!×2m×m 

note that the above estimation of the total assignments assumes each segment having the same maximum number of shifts. in reality, different segments might have different maximum number of shifts depending on the nature of the particular sequence. in the current implementation of stage  <dig>  we allowed the maximum shift to be  <dig>  and all the tested proteins are α-helical proteins. the total possible assignment number ntotal is still a huge number, even when m, n, p are relatively small.

in order to ignore the obvious wrong assignment between a sequence segment and the skeleton where their lengths differ significantly, we used a threshold d =  <dig> to require them to have similar lengths.

  |lskl - lseq| ≤ d 

here lskl, lseq is the length of skeleton and sequence segment.

stage  <dig> – construction of the atomic structures for the skeletons
once a set of sequence segments are assigned to a set of helix skeletons, the possible atomic structures can be constructed for the skeletons using the information of the segments and the spatial position of the skeletons. however, since the skeleton does not provide the exact location of the backbone atoms at low resolution, this step generates the possible atomic coordinates of the atoms. by csaw method  <cit> , the protein structure backbone and the side chains were created and moved to the corresponding spatial positions of the helix skeletons. each constructed helix structure was then rotated around the central axis of the skeleton as part of the structure adjustment. a rigid shift along the axis was also built in the method, although we did not use it in this paper due to the large solution space. the rotation step size was 30° in this paper. for each candidate structure, side chain rotamer library was used to relax the side chain overlap and simulated annealing method was used to minimize contact energy. protein structures passed the overlap screening were ranked according to their contact energy formed by the helices.

RESULTS
the dataset used to test the first stage involves  <dig> proteins from the protein data bank . some of the proteins are listed in the paper of nanias et. al  <cit> . others were randomly selected from the proteins that satisfy the following criteria:  has single domain  has  <dig>  Å or better resolution  share less than 30% sequence similarity  has less than  <dig> secondary structures, due to the amount of computation. the key question in the first stage was to see if the protein is comfortable when the segments of the sequence are assigned to the skeleton in all possible topologies. intuitively, when the positions of the backbone atoms are fixed, only a small number of the all possible sequence assignments to the skeletons will be energetically favorable. however, there has not been any data to support this hypothesis and as to how much of the population in the mutated topologies is energetically acceptable. our program was used to construct the all-atom structure for each topology in the total topological space of . the topologies with collision of atoms after side chain relaxation and those with large variation in the per-pair contact energy were eliminated. the rest of the topologies were ranked based on the contact energy. the numbers of topologies with lower contact energy than that of the native topology is shown in column  <dig> . for example, in the case of protein 1hdj , there is only  <dig> topology  that has the contact energy lower than that of the native topology, out of total  <dig>  topologies . it appears that the native topology is ranked within the top 30% among all the topologies. for most of the proteins, there is only less than 5% of the total population with lower energy than that of the native. this finding suggests that if the locations of the backbone atoms of the secondary structures are fixed, only a small portion of the huge topological space will result in energetically stable topologies for the secondary structures.

naa: number of amino acids

pctn: the percentage of amino acids in the secondary structures ;

nα: the number of alpha helix; nb: gthe number of beta strands;

nm: the gnumber of secondary structure mutations, the cross mutation between a helix and a strand is ignored;

neff: the gnumber of the mutated topologies with lower effective contact energy than that of the native;

pcteff: the percentage of the mutated topologies with lower effective contact energy than that of the native by multi-well function;

we tested the approach in stage  <dig> with four small α-proteins. the helix skeletons were first detected using helix tracer  <cit> . our program was then used to construct the possible all-atom structures exhaustively. it uses the axis location of the helix skeleton and performs rotational sampling of the cα coordinates every 30°. it also allows the inexact positioning of a sequence segment for a maximum of  <dig> amino acid shift. all the constructed structures of the secondary structures were sorted based on their contact energy. table  <dig> shows an example  of the ranked structures for the skeletons. since the total number of the possible structures is too large, only those with negative contact energy were stored and analyzed. one of the key questions in stage  <dig> is to see if the native assignment of the sequence segments is still included in the top percentage of the list when only the axes of the skeletons are known. unlike in stage  <dig> where the true backbone location was used for the skeleton, stage  <dig> samples the backbone locations through rotation around the skeleton axis. therefore, our rotation sampling may not hit the true structure exactly, although a structure close to the native can be reached. in fact, if one applies our approach for a protein with unknown structure, this is the situation encountered. therefore, it is interesting to see even with 30° of sampling step size, how accurate the resulting structure is. table  <dig> illustrates the trend of the constructed structures after they were ranked by the contact energy . the one with the smallest rmsd to native  was identified from the entire list. it appears that the structure with the smallest rmsd to native , the one most similar to the true structure, was ranked the 17th among all the possible constructed structures for the skeletons. this constructed structure indeed has the true topology with the topology id =  <dig>   <dig>  means that there are three helices in the skeleton and they were assigned to the correct helix sequence segments with the correct direction. we used the first three digits of the topology label to indicate the permutation of the assignment and the last three digits to indicate the assignment direction for each of skeletons. as an example, a topology label of  <dig> means the sequence assignment for the first and the second helix segments is swapped, and the third segment is assigned to the correct skeleton but with an opposite direction from the true direction. the structure that is the most similar to the true structure has a shift of  <dig> amino acid in the 1st and the 3rd segment respectively .

rank: the rank of the structure by the contact energy 

topology: the topology id, the 1st half of the digits: permutation of the assignment, the last half of the digits: directions  of the assignment for each helix;

shift: the amino acid position shift from the true helix segment for each assignment, "-" left, "+" right;

rot: rotation angle around the skeleton axis for each helix, in radian;

ce: effective contact energy of the constructed helices;

rmsd: the root mean square deviation of the cα atoms between the constructed candidate structure and the native structure, in Å.

the results of the four tested proteins are summarized in table  <dig>  for each of the proteins, a table similar to table  <dig> was constructed . then the structure with the smallest rmsd to native from each of the four tables is included as a row in table  <dig>  for all the four proteins, the structure most similar to the native was ranked in the top portion of the huge list. for example, in the case of 1gxga, such a structure was ranked the 5th based on its contact energy comparing to other assignments. in this case, helix tracer only detected three of the four helices in the true structure. therefore, only three helices  were used in the calculation. our direct estimation of the contact energy formed by the secondary structures appears to be quite effective for the four proteins. the structure that is the most similar to the native structure was ranked at the 17th, 31st, 16th, and 5th out of  <dig>   <dig>   <dig> and  <dig> constructed structures for the four tested proteins respectively . the rmsd to native of the best constructed structure is between  <dig> Å and  <dig> Å for all the four proteins. the small rmsd to native value suggests that the best constructed structure is close to the native structure for all the four proteins.

protein: the pdb id;

assignments: the total number of assignments with the negative contact energy

rank: the rank of the structure with the smallest rmsd to native;

topology: the topology id, the 1st half of the digits: permutation of the assignment, the last half of the digits: directions  of the assignment for each helix;

shift: the amino acid position shift from the true helix segment for each assignment, "-" left, "+" right;

rot: rotation angle around the skeleton axis for each helix, in radian;

ce: effective contact energy of the constructed helices;

rmsd: the root mean square deviation of the cα atoms between the constructed candidate structure and the native structure, in Å.

to illustrate the nature of the top ranked structures, we show a distribution of the topologies, the contact energy, and the rmsd to native for the top  <dig> constructed structures in figure  <dig>  the structures of the skeleton of 1lre were ranked by the contact energy of the secondary structures . the two most popular topologies in the top  <dig> structures are  <dig> and  <dig>  although a few  <dig>  and  <dig>  exist . here, the topology id of  <dig> means the three helix segments of sequence were correctly assigned to the corresponding skeletons with the correct directions. a topology id of  <dig> means the three helix segments of the sequence were correctly assigned to the skeletons. however, the direction of h <dig> sequence segment was assigned to the opposite direction from the true direction. note that a wrong topology  can be energetically favourable, since we observed that the structure with the lowest contact energy has a wrong topology. however, our result shows that the great majority of the wrong topologies correspond to energetically non-favorable structures. the near native structure of the skeletons can be found near the top of the list, the 17th that are marked in red .

discussion
we introduced a method to construct the possible atomic structures for skeletons of the density map. the method is built on the direct estimation of the contact energy formed by the skeletons. the evaluation of the constructed structures is independent from the knowledge of the conformation of the entire protein chain. this approach can be potentially useful when the size of the protein is large where the ab initio prediction of the entire chain is often hard. our approach suggests that it is possible to derive a set of possible topologies of the secondary structures without constructing the conformation of the entire chain. although our approach is expected to encounter the huge computation expenses when large proteins are the targets, it is interesting to see if the approach can be optimized to tackle the computation problem.

we performed a small test in stage  <dig> using four α-proteins. our current method samples the possible structures for the skeletons using a fixed step size. the advantage of this sampling method is that it provides details about the solution space. the disadvantage obviously is its computational expense. this approach was able to rank the most near native structure at the 17th of  <dig>  the 16th of  <dig>  the 5th of  <dig> and the 31st of  <dig> structures for 1lre, 1dp3a, 1gxga, and 1jw2a respectively . note that the base number here only includes the structures with negative contact energy, and not the entire topological space. a test including more proteins, particularly the non-alpha proteins, will provide more concrete results. it is also possible to use simulated annealing in stead of the exhaustive sampling of the topological space.

we have developed a method to eliminate the secondary structure topologies through an direct estimation of the contact energy of the secondary structures. it will be interesting to see how stable this screen method is compared to a geometrical screening method introduced by wu et. al  <cit> . it is possible that the combination of the two approaches can be more effective in reducing the topological space for the skeletons.

CONCLUSIONS
this paper explores the question if it is possible to derive a small set of atomic structures for the skeletons through the sampling of the entire topological space of the secondary structures. we have developed an approach to enumerate the possible atomic structures for the skeletons and to rank the structures using a direct estimation of the contact energy formed by the secondary structures. we demonstrate for the first time that it is possible to use the secondary structure contact energy to eliminate the great majority of the wrong structures for the skeletons. a test of  <dig> proteins suggests that when the backbone atoms are given for the skeletons, there are only a small number of topologies with more comfortable structures than that of the native. even when the backbone atoms are not known for the skeletons, it is still possible to construct a small set of structures that contains a near native structure for the skeletons. our results suggest that without constructing the structure of the entire chain, it is still possible to derive a small set of the atomic structures for the skeletons, out of the huge solution space, using our recent development of the multi-well energy function.

competing interests
the authors declare that they have no competing interests.

authors' contributions
ws and jh developed the methodology. ws developed the code and performed the tests. jh provided overall guidance. both are involved in developing the manuscript.

