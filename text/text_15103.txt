BACKGROUND
whole genome duplication  associated with autopolyploidy and allopolyploidy has been a recurrent and prevalent phenomenon in plant evolution, linked to species diversification and species radiation  <cit> . difficulty in studying the genomic complexity that wgd entails has slowed progress in understanding the genetic basis of adaptation and speciation in non-model systems  <cit> . recently, with the advent of high throughput sequencing, many researchers have turned to analyses of transcriptomes to advance knowledge of evolutionary relationships, and to identify traits and candidate genes potentially important in adaptive diversification. one current international initiative seeks to assemble the transcriptomes of  <dig> plant species .

transcriptome assembly has "many informatics challenges"  <cit>  including markedly different expression levels of genes and homeologues, as well as potentially high levels of sequence similarity between duplicated gene copies . use of a reference transcriptome can facilitate the assembly  <cit> . however, where gene duplication has generated novel sequences compared to the reference transcriptome, these sequences can remain undiscovered or even be assembled as a chimeric sequence with their paralogues. for many plant species a close reference does not exist at all, which makes the assembly even more challenging. in these cases, an assessment of optimal assembly parameters is needed to generate full length ests and avoid the production of chimeric sequences formed between homeologous copies, recently duplicated, and very similar genes.

several pipelines for the assembly of transcriptomes have been suggested in a number of studies. these studies have identified k-mer size as an important parameter. during contig assembly assemblers such as abyss, trans-abyss and trinity, k-mer size specifies the length of an oligonucleotide sequence used for building the de bruijn graph . one k-mer represents a node in the graph while overlaps between k-mers of length k- <dig> represent the edges that connect the nodes. a contig is assembled by following the connected nodes and edges through the graph. thus, the length of the chosen k-mer influences the connectivity between the nodes and can affect the result of the assembly considerably. in the case of a transcriptome assembly genes with a low expression level are represented by very few reads with small overlaps in the dataset and therefore can only be assembled with small k-mer sizes. the choice of the k-mer size can either lead to fully assembled or heavily fragmented transcripts, changing the quality of an assembly dramatically. the latter is typically evaluated using metrics such as the length of the longest contig or the n <dig> length . k-mer sizes between  <dig> and  <dig> have been reported as optimal in a number of studies on transcriptome assembly. in some studies only one k-mer size has been used to obtain a 'best' assembly, as assessed by various parameters describing the amount and length of the assembled contigs  <cit> . in other studies, the contigs obtained from assemblies made with a range of k-mer sizes have been reported, since it has been observed that different genes sometimes require different k-mer sizes for optimal assembly  <cit> . very few studies have at this point reported optimal values or the significance of k-mer coverage  <cit> .

here we report a successful strategy for the assembly of two reference transcriptomes in pachycladon  - an allopolyploid plant genus which has diversified into ten species in the new zealand alps within the last  <dig>  million years and originated from a hybridization event  <cit> . the two ancestral lineages represented in each of the extant allopolyploid species are estimated as having diverged from each other within the arabidopsis clade approximately eight million years ago  <cit> . this evolutionary scenario has led to a situation where in pachycladon  ortholgues are highly similar between species  and  the homeologous genes within each species show less, but still very high, sequence identity . thus, the assembly of their transcriptomes is not only complicated by their size  but also by the high sequence identity between homeologous copies. this similarity complicates the de bruijn graph considerably. for example, if there are two highly similar homeologues in the transcriptome they will share nodes  in the graph while nodes belonging to either sequence will still be connected to the nodes of the respective other sequence. when encountering structures like this in the graph, assembly algorithms tend to terminate the assembly in order to not generate hybrid sequences. this results in rather fragmented assemblies. using longer k-mer sizes helps to avoid this problem by minimizing the number of connected nodes in the de bruijn graph. however, long k-mer sizes cannot be used to assemble genes with a low expression level as there can be too few overlapping k-mers. obtaining full length transcripts requires consideration for both k-mer size and k-mer coverage. in the present study we simultaneously evaluate k-mer size and coverage cutoff in generating optimal assemblies for two pachycladon transcriptomes using abyss  <cit> . we discuss criteria for evaluating our assemblies and also discuss the effectiveness of two currently used transcriptome assemblers trinity  <cit>  and trans-abyss  <cit> .

RESULTS
quality assessment of the reads and de novo assembly
two lanes of paired-end and one lane of single-end illumina  <dig> base pair sequences were generated for p. fastigiatum and one lane of single-end  <dig> base pair sequences for p. cheesemanii. before the  <dig> nucleotide reads were assembled they were quality checked and trimmed. each lane was analyzed separately. for both lanes of the paired-end data, there was a significant decrease in quality  after approximately  <dig> nucleotides. in both lanes of single-end reads the same quality decrease was reached after approximately  <dig> nucleotides. all  <dig> , <dig> reads of p. fastigiatum and  <dig> , <dig> reads of p. cheesemanii were trimmed to retain the longest contiguous read segment where all nucleotides had a phred quality score above the cutoff of  <dig>  which is equivalent to one base call error every  <dig> nucleotides. after this step, only reads longer than  <dig> nucleotides were used for the assembly. due to the relatively low quality of the p. fastigiatum paired-end data only  <dig> of the  <dig>  megabases could be assembled as paired-end data because reads were only considered as being paired if the length of both reads exceeded  <dig> nucleotides. if only one of the reads exceeded the length cutoff  it was added to the set of the single-end reads . after this filtering step  <dig> mbp paired-end and  <dig> mbp single-end reads were used to assemble contigs for p. fastigiatum as well as  <dig>  mbp single-end reads for p. cheesemanii. the reads for both species were assembled separately using  <dig> different coverage cutoffs between two and  <dig> with abyss v.  <dig> . <dig>  <cit> .  <dig> different k-mer sizes between  <dig> and  <dig> were also considered, resulting in  <dig> assemblies per species.

assessing the assemblies
for each of the  <dig> assemblies the number and length of the contigs was assessed. in total  <dig> , <dig> contigs were assembled for p. fastigiatum and  <dig> , <dig> for p. cheesemanii . the lowest number of contigs was obtained using a k-mer size of  <dig> and a coverage cutoff of  <dig>  and  <dig>  ) while the highest number of contigs was obtained using k-mer size  <dig> and coverage cutoff  <dig> . the percentage of contigs per assembly that were longer than  <dig> bp varied according to the parameters used. overall the percentage was higher when large k-mer sizes were used. while the percentage of longer contigs for assemblies made with the same coverage cutoff did not differ significantly when using small cutoffs , it did vary considerably between different k-mer sizes using higher cutoffs .

we also compared the total number of assembled bases for each assembly. the highest number of assembled bases for p. fastigiatum was  <dig> mbp  while the lowest number was  <dig>  mbp . when only contigs longer than  <dig> bp were considered those numbers dropped to  <dig>   and  <dig>  mbp . for p. cheesemanii a maximum of  <dig> mbp were assembled using parameters  <dig> and  <dig> when all sequences were considered and  <dig>  mbp  using sequences longer than  <dig> bp. the minimal values  <dig>  and  <dig>  mbp were found with parameters  <dig> and  <dig> for all sequences and sequences longer than  <dig> bp, respectively.

in order to determine the percentage of reads included in each assembly we mapped the reads of each species against the respective contigs of each assembly. in p. fastigiatum the maximum percentage of reads mapping to the contigs was  <dig> % with parameters  <dig> and  <dig>  while only  <dig> % of the reads mapped with parameters  <dig> and  <dig>  in p. cheesemanii the maximum percentage of reads mapping was  <dig> % with parameters  <dig> and  <dig>  the pearson correlation coefficients between the coverage cutoff or the k-mer size and the percentages of reads mapping were too small to infer a linear correlation . however, in both species the highest percentages were associated with low coverage cutoffs  and large k-mer sizes  while the lowest were computed with small k-mer sizes .

for each combination of assembly parameter values the length of the longest sequence was determined and annotated against homologues in a. thaliana. for example, the longest sequences in the p. fastigiatum libraries  were assembled using coverage cutoffs three to five and k-mer sizes  <dig> to  <dig> while the shortest sequences  were assembled using coverage cutoffs two to seven and k-mer sizes  <dig> and  <dig> . the longest sequences generated in different assemblies were homologues to different genes. in  <dig> assemblies the longest sequence generated was homologous to a. thaliana at5g <dig>  an uncharacterized gene whose length is  <dig>  bp. in  <dig> other assemblies, the longest sequence was homologous to glu <dig> . in total,  <dig> different genes were found in the set of the longest sequences, six of which occurred only once. for only ten of those genes the complete coding sequence was assembled.

additionally, the n <dig> and n <dig> lengths were computed for each assembly of p. fastigiatum reads. the highest n <dig> length was  <dig> for the assembly made with cutoff  <dig> and k-mer  <dig>  while the smallest n <dig> length  was computed for the assembly with cutoff  <dig> and k-mer size  <dig>  overall the n <dig> length was higher when higher coverage cutoffs and k-mer sizes were used . the largest n <dig> length was  <dig>  while the smallest was  <dig> . the n <dig> length again was longer when higher coverage cutoffs and k-mer sizes were used. these n <dig> and n <dig> values are significantly smaller than the n <dig> and n <dig> values for the reference libraries of a. thaliana  and a. lyrata .

the importance of the k-mer size and the coverage cutoff for transcript assembly
with p. fastigiatum none of the genes could be assembled completely with all  <dig> combinations of the assembly parameters. while there were  <dig> sequences that were assembled with all  <dig> different coverage cutoffs, there were only eight sequences that were assembled with all  <dig> different k-mer sizes .  <dig> sequences were complete only in assemblies that used one coverage cutoff.  <dig> sequences were complete only in assemblies that used one k-mer size.  <dig> of these sequences were assembled using exactly one parameter combination. similarly, for p. cheesemanii the success of gene assembly varied greatly with chosen parameter values.  <dig> genes were assembled with all  <dig> coverage cutoffs but only  <dig> with all  <dig> k-mer sizes.  <dig> genes were only completely assembled with one coverage cutoff and  <dig> genes were only completely assembled with one k-mer.  <dig> of these genes were assembled with exactly one parameter combination.

comparing assemblies in terms of the number of complete transcripts
to quantify the similarity of assemblies made using different parameter values we counted the number of complete transcripts in each assembly and made pair wise comparisons of assemblies. for each comparison we divided the number of complete transcripts common to both assemblies by the total number of complete transcripts summed across both assemblies. the highest value therefore was  <dig>  for perfect overlap and the lowest value was  <dig> if no sequence was identical between the complete sequences of the two assemblies. these values were then divided by  <dig>  to regain easily comparable percentages . no perfect overlap could be detected between any two assemblies. the highest values were computed for assemblies conducted with near identical k-mer sizes. for example, of the  <dig> complete sequences found with coverage cutoff  <dig> and k-mer sizes  <dig> and  <dig>  respectively,  <dig> were found in both datasets, which corresponds to an overlap of 67%. values for the overlap between assemblies conducted with adjacent parameters varied between  <dig> and 80%. the more difference there was between the assembly parameters the less overlap was detected between the completely assembled sequences. while there was still about 60% overlap if the k-mer sizes differed by four, this decreased to  <dig> to 50% when k-mer sizes differed by six and to  <dig> to 40% when they differed by eight. there was no overlap between the  <dig> and  <dig> sequences found with parameters  <dig>   <dig> and  <dig>   <dig>  assemblies conducted with the same k-mer size but different coverage cutoffs showed even less overlap. between the assemblies made with parameters  <dig>   <dig> and  <dig>   <dig> only 50% of the sequences were identical. this decreased to 32% with coverage cutoff  <dig> and further to  <dig> % with coverage cutoff  <dig> .

comparison to trinity assembly
the p. cheesemanii reads were also assembled using trinity  resulting in  <dig>  contigs of which  <dig>  were longer than  <dig>  bp while most of the contigs  were between  <dig> and  <dig> bp long. the n <dig> and n <dig> values of this assembly were  <dig> bp and  <dig> bp, respectively. the total number of assembled bases of  <dig> mbp was a bit smaller than the maximum value obtained with any abyss assembly. when only sequences longer than  <dig> bp were considered the trinity assembly contained considerably more nucleotides . the percentage of reads included in the assembly was  <dig> %, which is slightly smaller than the highest value of the abyss assemblies . the longest sequence was  <dig>  bp and identified as the homologue to at1g <dig> while the longest sequence in the abyss assemblies was  <dig>  bp. at1g <dig> was also identified to be the longest sequence in  <dig> abyss assemblies.  <dig> contigs in the trinity assembly represented complete coding sequences while the maximum number of complete sequences identified in any abyss assembly was  <dig>  after combining the abyss assemblies  <dig>  complete transcripts were obtained.  <dig>  sequences in the trinity assembly spanned more than 55% of an arabidopsis reference gene, which was again less than the  <dig>  sequences obtained with all abyss assemblies.

most similar homologues
all abyss contigs of p. fastigiatum longer than  <dig> bp were searched against all plant protein sequences in the nr database using blastx  <cit> . applying an identity cutoff of 70% the highest percentage of contigs per assembly that had a significant match to the database was 89% with coverage cutoff  <dig> and k-mer size  <dig>  this percentage was again highly variable between the assemblies. the minimum value was  <dig> % for the assembly made with coverage cutoff  <dig> and k-mer size  <dig> leaving  <dig>  contigs without a hit in the plant nr database. no correlation  was detected between the k-mer size or the coverage cutoff and the percentage of contigs with hits in the plant database. a homologous sequence was found in the nr database for  <dig> , <dig>  of the  <dig> , <dig> contigs.

sequences of a. thaliana  and a. lyrata  were found most often as best hits to the pachycladon contigs. sequences of other species in the brassicaceae lineage were also found as best blast hits: for  <dig>  sequences the best hit was found with boechera divaricarpa, for  <dig>  sequences it was found to be with different species of brassica, and for  <dig>  sequences with thelungiella halophila. a small proportion of the sequences had best hits outside of the brassicaceae lineage, e.g. for  <dig>  contigs the best hit was found with vitis vinifera, for  <dig>  with ricinus communis, and for  <dig>  with populus trichocarpa. a small number of the contigs had best hits to algae:  <dig>  contigs to volvox carteri and  <dig>  to micromonas pusilla ccmp <dig>  for most of these contigs, homologues in the arabidopsis lineage did exist but were less similar to the pachycladon contigs than the algal sequences.

the lengths of the contigs with hits in the plant database were determined as well as the lengths of the contigs without those hits. both length distributions were then compared using a wilcoxon rank sum test. the length of the contigs with hits was significantly longer than the ones for the other sequence set . the mean length of the contigs with hits was  <dig> while it was  <dig> for the other sequence set. the longest sequence in the first set is  <dig>  bp while the longest sequence in the other set was  <dig> . for both datasets most sequences were between  <dig> and  <dig> bp long  but the percentage of sequences longer than  <dig> bp was slightly higher in the dataset with hits in the plant database . the  <dig> sequences longer than  <dig> bp without hits in the plant database were analyzed further as it is highly unlikely that sequences of this length are comprised of 'nonsense' assemblies. these sequences were found in all assemblies with a k-mer size smaller that  <dig>  when compared against the nucleotide database at ncbi they either hit hypothetical or uncharacterized proteins and genomic sequences. the sequence identity of these hits was mostly below 70%. the longest sequence  did have a hit in the plant database  but a large number of indels in the alignment reduced the identity to 53%. interestingly, this sequence passed the filters when searched against the coding sequences of a. thaliana using blastn.

a comparison of orthologues, paralogues and homeologues
we used two reference transcriptomes for the identification and annotation of homologous transcripts within and between our p. fastigiatum and p. cheesemanii libraries. while the a. thaliana transcriptome is the best annotated reference available, the pachycladon contigs showed the highest identity to the a. lyrata transcripts. thus, using only one of the databases as a reference could result in sequences not being annotated either because they were too different to the a. thaliana sequences or because the a. lyrata sequences were not annotated. hence, our contigs were searched against a combined library. sequences either had a hit in both arabidopsis species or a hit in only one species. all sequences, that covered a minimum length of at least 55% of any arabidopsis reference sequence, were added to the est libraries. this minimum length ensured that there was at least 5% overlap between orthologues and homeologues in the two libraries. if there were two different overlapping contigs that were homologous to the same arabidopsis gene, these were annotated as possible homeologues. contigs that were assigned to a specific gene and copy were assembled further using the overlap assembler cap <dig>  <cit> . using these criteria, we assembled ests for  <dig>  and  <dig>  unique genes for p. fastigiatum and p. cheesemanii, respectively. of these,  <dig>  genes were common to both species. all sequences were annotated using blastn and the combined database of a. thaliana and a. lyrata coding sequences .

we counted the number of homeologous pairs present in both species.  <dig> homeologous pairs were identified as common to both. the mean sequence identity of these homeologous copies was  <dig> %, while the minimum was  <dig> %. we used this observed distribution of identities to determine the relationship among other homologues occurring in the two libraries. we inferred sequences to be putative orthologues  if they had greater than 95% sequence identity, and inferred sequences to be likely paralogues  if they had less than 95% identity . the number of genes common to both libraries inferred to have an orthologous relationship was  <dig> . this contrasted with  <dig>  genes that were only found in the library of p. fastigiatum and  <dig>  genes that were only found in the library of p. cheesemanii. these genes were either not expressed in the other species or present in contigs that covered less than 55% of the reference gene.  <dig> gene pairs of the  <dig>  genes only found in the p. fastigiatum library were inferred to be homeologues, while  <dig> homeologous pairs were identified among the  <dig>  genes exclusive in the p. cheesemanii. in total  <dig>   homeologous pairs were assembled for p. fastigiatum and  <dig> for p. cheesemanii . the total number of pachycladon genes represented by these sequences was  <dig> .

in order to determine if the  <dig>  genes only found in the library of p. cheesemanii were a result of differential expression between the species we mapped the reads of p. fastigiatum and p. cheesemanii against these genes using bowtie v.  <dig> . <dig>   <cit>  and allowing for up to three mismatches. we then compared the number of reads mapping to each of the genes in both species. this was done after normalizing for the total number of reads mapping in each species. for nine of the sequences no expression was determined in p. fastigiatum.  <dig>  genes had a higher rpkm value in p. fastigiatum than in p. cheesemanii while  <dig>  had a higher expression level in p. cheesemanii. a paired wilcoxon rank sum test was conducted to determine if the expression levels were significantly higher. in both cases the difference in expression level was highly significant  indicating that the coverage of those genes was too low for an assembly of at least 55% in one species. a comparison of the genes present only in either one of the libraries showed that for  <dig>  of these genes the respective other copy was assembled in the other library. this illustrates a relatively high degree of differential expression between the two homeologous copies.

the sequences present in both libraries  were compared to homologues from a. lyrata and a. thaliana. the mean identity of sequences from both pachycladon species with respect to sequences of a. thaliana was found to be approximately 92%, while the identity to the a. lyrata sequences was slightly higher. the minimal identity of the blast alignments between the homologues was 62% and the maximum 100%. to determine if it was possible to assign gene copies in the pachycladon species to maternal and paternal ancestral lineages, a similarity comparison was made between sequences for the  <dig> homeologous gene pairs with a. lyrata and a. thaliana. however, no set of genes was identified that showed a significantly higher identity to the reference genes consistent with the suggestion that the homeologous genes both stem from the maternal ancestral lineage. thus, we were unable to unambiguously map gene copies to distinct evolutionary lineages.

observations on specific genes that highlight issues for assembly
we investigated the number of reads mapping to seven genes that were expressed at different levels and exhibited different degrees of sequence similarity. this was done allowing for no mismatches and also up to  <dig> mismatches per read. the motivation for allowing mismatches was to accommodate potential sequencing errors that might occur with high density of reads and also to demonstrate the assembly problem caused by having very similar homeologous sequences in the dataset.

two genes studied  had a very high expression level. for these a complete transcript was assembled under very few k-mer size and coverage cutoff combinations. homeologous copies were not assembled for either gene. in the a. thaliana genome, four genes encode the small subunit of rubisco  <cit> . of these four genes only one  was assembled completely in five different assemblies using coverage cutoffs  <dig> to  <dig> and k-mer  <dig>  for the other three genes, only contigs that spanned less than 55% of the reference sequences were found. another interesting case concerned the contigs for the homologues to mvp <dig> , a myrosinase-associated protein  <cit> . one mvp <dig> gene copy was assembled using  <dig> different parameter combinations with coverage cutoffs seven to twelve,  <dig> to  <dig>  and  <dig> and k-mer sizes between  <dig> and  <dig> while a second mvp <dig> gene copy was assembled using nine different combinations using cutoffs two and three and  <dig> to  <dig> but only using k-mer sizes  <dig> and  <dig>  a third mvp <dig> gene copy could also be assembled by combining smaller contigs using cap <dig>  comparison to the transcriptome of a. lyrata revealed a duplication of mvp <dig> on chromosome  <dig> explaining the occurrence of the third copy in p. fastigiatum. sequence comparison and similarity between a. lyrata and pachycladon homologues was used to annotate the homeologous gene copies . the three copies of mvp <dig> were all highly similar and had a low to medium expression level. two other genes investigated  had a low expression level and were found to be robust to choice of parameter values in most assemblies. in p. fastigiatum the homologue to at1g <dig>  was the gene found in most assemblies . although at1g <dig> is nuclear encoded, only one gene copy was found under different assembly conditions. not all parameter combinations led to a completely assembled sequence for this gene, but there was at least one partial sequence from each of the  <dig> coverage cutoffs and  <dig> k-mer sizes. the gene found with the second highest number of assemblies was the chloroplast located large subunit of rubisco  for which only one copy was present in the transcriptome. again there was at least one complete sequence for each of the coverage cutoffs but only k-mer sizes between  <dig> and  <dig> led to a completely assembled sequence.

the number of reads mapping to each of these sequences established different expression levels of the corresponding genes.  <dig>  reads mapped to the sequence of rbcs and  <dig>  to esm <dig>  only  <dig>  reads mapped to one homeologous copy of mvp <dig>  while  <dig>  reads mapped to the other homeologous copy.  <dig>  reads mapped to the paralogue of mvp <dig>   <dig>  reads mapped to rbcl and  <dig>  to the homologue of at1g <dig>  when allowing for up to three mismatches, the number of additional reads mapping to the sequences did not scale proportionally. while the number of reads mapping to esm <dig>  rbcl and the homologue to at1g <dig> increased by about 9%, it increased by 28% for rbcs and 229% for one copy of mvp <dig>  the number of reads mapping to the other two sequences of mvp <dig> increased by 10% and 14% . in total  <dig>  reads mapped to the sequences of the two copies of mvp <dig> when allowing for up to three mismatches. this number is more than twice the number of reads mapping without mismatches to one of the sequences. even when no mismatches were allowed  <dig>  reads mapped to both sequences. while no read was identical between the two copies and the duplicated third sequence when allowing for no mismatches, there were  <dig> and  <dig> identical reads when allowing for up to three mismatches, respectively.

the number of reads from the p. fastigiatum dataset mapping to the transcripts of at1g <dig>  at3g <dig>  three sequences of at1g <dig> , atcg <dig>  and at1g <dig> were determined as well as the number of assemblies the complete transcripts of these genes were identified in.

a comparison of assembled mvpi homeologues in the p. fastigiatum library identified eight different regions of length  <dig> to  <dig> bp that were identical between the sequences. the first identical region between the copies is located between nucleotide  <dig> and  <dig> of the mvp <dig> coding region. all contigs that span this region were assembled with k-mer sizes greater than  <dig> regardless of the coverage cutoff. in assemblies made with smaller k-mer sizes two overlapping contigs were produced for this region, however they were not joined .

separate and joint assembly of reads for specific genes
reads mapping to assembled ests for the seven mentioned genes were removed from the pool of reads. reads mapping to each of these genes were then assembled separately with k-mer lengths  <dig> to  <dig>  and without specifying a coverage cutoff. when no coverage cutoff is specified, abyss determines the coverage cutoff automatically according to the actual k-mer coverage of each respective sequence. the automatically determined coverage cutoffs for individual genes varied greatly. for example, while the determined coverage cutoff for rbcs was between  <dig>  for k-mer size  <dig> and  <dig>  for k-mer size  <dig>  it was between  <dig> and  <dig>  for rbcl . we observed that if reads for different genes were jointly analysed, the automatically determined coverage cutoff always dropped to two. this occurred irrespective of how many and what reads from different genes were assembled.

to determine the effect of including reads in an assembly where there are mismatches to the contig sequence, the reads mapping to each sequence were assembled with k-mer sizes  <dig> to  <dig>  four different read datasets were used for each gene sequence: no mismatch, up to one mismatch, up to two mismatches, and up to three mismatches. if one contig were assembled with each k-mer value  and for 0- <dig> mismatches, then 20x <dig>  full length identical transcripts are expected for each gene. however, the resulting contigs not only varied in length and number but also in their coverage. after the separate assembly of the seven example genes, we combined the datasets of all seven genes to simulate a small transcriptome assembly.

in the separate assemblies, the genes with high expression levels  were assembled to a full length transcript in most assemblies. the assembly of esm <dig> was the least sensitive to changes in parameter values. with this gene, there was no fragmentation as all  <dig> assemblies each produced exactly one contig. this was also true for the assemblies of rbcs when the read dataset without mismatches was used. as soon as reads with one to three mismatches were included, some assemblies were fragmented. full length transcripts were only found with k-mer sizes  <dig> and  <dig>  the highest fragmentation  was found with k-mer size  <dig> 

in the joint assemblies the results differed dramatically from the separate assemblies. while for esm <dig> there was a full length contig for each k-mer when the reads mapping without mismatches were used,  <dig>  contigs were assembled when one mismatch was allowed,  <dig>  with two mismatches and  <dig>  with three mismatches. most of these sequences were smaller than  <dig> bp. some longer contigs  were obtained in the dataset with one mismatch, though none of those were full length transcripts. the same observation was made for rbcs. while there were  <dig> contigs for the dataset without mismatches, there were  <dig> ,  <dig> , and  <dig>  for the other datasets. no full length transcripts were found for these, with the maximum length transcript being  <dig> 

with the three mvp <dig> homologues  and the separate assemblies highest fragmentation occurred with small and large k-mer sizes. k-mer sizes between  <dig> and  <dig> produced full length contigs for one homeologous copy . increasing the number of mismatches increased the amount of fragmentation and decreased the number of full transcripts obtained. the assembly of the duplicated mvp <dig> gene sequence showed the least fragmentation of mvp <dig> homologues.

the results for the joint assemblies were similar. for the first homeologous copy of mvp <dig> no full length transcript was found. full length transcripts were found for the second homeologous copy with k-mer sizes  <dig> to  <dig> in the dataset without mismatches and  <dig> to  <dig> in the others. the lowest degree of fragmentation again was found for the third sequence of mvp <dig>  full length transcripts were assembled with k-mer sizes  <dig> to  <dig>  in the other assemblies, the sequence was fragmented into three contigs.

the lowest degree of fragmentation in the separate as well as the joint assemblies was found for the two sequences with a low expression level. only assemblies with large k-mer sizes, regardless of separate or joint analyses, failed to produce fully assembled sequences. allowing for mismatches where genes had low expression levels resulted in a decrease of fragmentation in assemblies with high k-mer sizes indicating that the additional reads were crucial for the assembly of regions with low coverage.

gene expression levels and assembly parameters
in order to determine whether or not a relationship existed between the expression level of a gene and assembly parameters as previously suggested  <cit> , the trimmed reads were mapped against the sequences of each of the full length transcripts using bowtie v.  <dig> . <dig> and an expression level ) was derived.

in p. fastigiatum, rbcs  had the highest expression level  followed by esm <dig> , ltp <dig> , the homologue to at1g <dig> , and vsp <dig> . for each gene the number of coverage cutoffs and k-mer sizes used for assemblies, in which a full transcript was obtained, was determined . esm <dig>  for instance, was assembled in  <dig> of the  <dig> assemblies. no complete transcript was found in assemblies conducted with coverage cutoffs between two and ten. for each assembly made using cutoffs  <dig> to  <dig> one transcript was obtained using k-mer size  <dig>  a complete transcript for esm <dig> was also obtained using cutoffs  <dig> to  <dig> and k-mer size  <dig>  with cutoff  <dig> full length transcripts were obtained using k-mer sizes  <dig> and  <dig>  in addition there were fully assembled transcripts found using cutoff  <dig> and k-mer sizes  <dig>   <dig>   <dig>   <dig>   <dig>  and  <dig>  in summary, esm <dig> could be assembled using ten different coverage cutoffs and six different k-mer sizes. in contrast,  <dig> genes were assembled with exactly one k-mer size but with possibly varying coverage cutoffs, while  <dig> genes were assembled with exactly one coverage cutoff and varying k-mer sizes. only eight genes were assembled with all  <dig> k-mer sizes, while  <dig> genes were assembled with  <dig> coverage cutoffs, respectively.  <dig> genes were fully assembled using exactly one combination of these two parameters. next, the relationship between gene expression level, k-mer size, and coverage cutoff was investigated to determine whether the expression level of a gene affected its assembly over a wide range of assembly parameters. first, the genes were binned into different categories according to the number of k-mer sizes for which a complete transcript was assembled. for example, as mentioned above, the sequence of esm <dig> was fully assembled using six different k-mer sizes and was therefore binned in category  <dig>  the number of genes falling in each of the categories is shown in figure 2a . the mean expression level of all genes in each category was determined . this was also done for the coverage cutoffs, where  <dig> different categories were possible . finally, a correlation coefficient was computed between the mean expression level of genes in each category and the number of coverage cutoffs or k-mer sizes per category. when the expression levels of all genes were used, no correlation was observed. this situation changed if genes with an extremely high level of expression were excluded from the analysis, a result that might be explained by the observation that a very high expression level can lead to highly fragmented assembly patterns similar to a very low expression level. when  <dig> genes with an rpkm value greater than  <dig> were excluded from the correlation analysis we observed a positive correlation. the pearson correlation coefficient for the coverage cutoffs  was higher than the correlation coefficient for the k-mer sizes . this means the higher the mean expression level of the genes in a category was, the more different k-mer sizes and coverage cutoffs lead to a full transcript in the assembly.

in p. cheesemanii the genes with the highest expression levels were ltp <dig> , a plant defensin gene  and photosystem i light harvesting complex gene  <dig> . the rbcs and the ltp <dig> gene were only assembled to 68% and 80% of their respective arabidopsis orthologues, while esm <dig> and vsp <dig> had an rpkm of  <dig>  and  <dig> .  <dig> genes had an rpkm value greater than  <dig> and these genes were excluded from the correlation analysis. calculating the pearson correlation coefficients for this reduced set gave coefficient values of r =  <dig>  and r =  <dig>  between rpkm values and coverage cutoffs and k-mer sizes, respectively.

discussion
in this study we investigated the difficulty of transcriptome assembly in the case of an allopolyploid transcriptome in which there were high levels of similarity between homeologues. our findings supported earlier studies which have identified the importance of k-mer size for optimal assembly  <cit> . that is, while genes with low expression levels are more easily assembled  with small k-mer sizes, assembly of genes with higher expression require large k-mer sizes. this is particularly true when there is a high degree of similarity between homeologues. additionally we showed that simultaneously varying k-mer size with the coverage cutoff had a significant impact on the success of gene assemblies. most importantly we showed that both parameters  need to be optimized for each gene or set of genes in the transcriptome depending on their properties. currently, such extensive evaluation of parameter space is not conducted by transcriptome assemblers such as trans-abyss and trinity, and thus will likely produce suboptimal assemblies with some datasets.

comparison of homologues
the parental species of the genus pachycladon diverged about  <dig> million years ago while the different pachycladon species diverged only  <dig> - <dig>  million years ago  <cit> . therefore we expected greater similarity between orthologues than between the homeologues within each species. the analysis of  <dig> homeologous genes whose duplicated copies were present in both species confirmed this expectation. while the identity between homeologous genes had a range of 70% to 90%, orthologues were at least 95% identical.

this high degree of similarity between homeologues created a high risk of assembling chimeric sequences, where one part of the sequence derives from one copy while another part derives from the other copy. furthermore we wished to avoid assigning contigs for different homeologous copies to the wrong copy. for this reason we only evaluated contigs that were assembled to be longer than 55% of the reference gene to which they were annotated. this minimal length ensured a minimum of 5% overlap between pachycladon homeologues. if this overlap was at least  <dig> bps it could reliably be used to distinguish copies.

interestingly, only 35%  of the genes that were unambiguously identified were present in both libraries. among these, both copies were present for  <dig> genes, while for  <dig>  genes only one copy was identified in both species. for 65%  of the assembled sequences no counterpart was found in the respective other library although for a surprisingly high number of genes  the respective second copy was found in either one of the two libraries. this relatively small percentage of overlap between the assembled libraries and greater number of sequences in the p. fastigiatum transcriptome might have resulted for different reasons. first the number of reads obtained from the p. fastigiatum transcriptome was almost three times as high as the number of reads from the p. cheesemanii transcriptome, making it more likely that more genes with a very low expression level would be assembled for p. fastigiatum. the availability of the paired-end data for p. fastigiatum also helped to assemble genes where the length of an identical region exceeded  <dig> bp. this was the case even though these data had low quality than the single-end data and therefore were significantly shortened during the trimming process. sequences only found in the p. cheesemanii dataset  on the other hand has different reasons. lower expression levels or the lack of expression in p. fastigiatum lead to several small contigs as the coverage in some regions is not high enough to combine them. the use of the respective other homeologous copy in the other species is another reason, while for some genes higher expression levels in p. fastigiatum result in fragmented assemblies because of the introduction of sequencing errors. mappings of the p. cheesemanii reads against the p. cheesemanii contigs did not reveal any substantial snps that might stem from the three different biological replicates used. nonetheless it is still possible that for some genes in p. cheesemanii and p. fastigiatum alike the assembly would also be complicated because of snps between the different accessions.

the comparison of homeologous pairs found in both species with their homologues in a. lyrata and a. thaliana confirms the recent finding that both parental species have arisen from the arabidopsis lineage  <cit> . since both parental genomes have similar divergence estimates from both arabidopsis species, the presence for example of the duplicated gene of the mvp <dig> in the a. lyrata and pachycladon genomes does nevertheless hint at a higher similarity in gene content to a. lyrata. this suggestion was also supported in evaluations of the best blast hit for each contig. almost twice as many contigs had a gene from a. lyrata as a best blast hit compared to the number of best blast hits to a. thaliana. the recent finding that the parental species of the genus pachycladon both stem from the arabidopsis lineage  <cit>  instead of one parent stemming from the arabidopsis and one from the brassica lineage  <cit>  also received support from the observation of a relatively low number of contigs having best hits to brassica species. the number of contigs found with a best blast hit outside of the brassicaceae lineage strengthen the argument that one reference transcriptome might not be sufficient to fully annotate a newly assembled transcriptome where there might occur genes that are no longer present in the reference species.

the mean length of the sequences without a hit in the nr plant database is slightly smaller than the length of sequences with a hit, confirming the observation that the annotation rate for sequences shorter than  <dig> bp is not as reliable as for longer sequences  <cit> . considering the surprisingly high number of longer sequences  without a hit in the database, an annotation pipeline containing both a protein and a nucleotide dataset might lead to a higher annotation rate.

k-mer size and assembly
comparison of assemblies made with different parameter combinations showed that the k-mer size had a significant impact on the length of contigs as previously observed  <cit> . while contigs assembled with low k-mer sizes tend to be smaller than contigs assembled with higher k-mer sizes, there are also many more contigs assembled with low k-mer sizes. this is largely explained by identical regions in different genes. as soon as the length of an identical region exceeds the length of the chosen k-mer size, the different genes cannot be assembled without risking the formation of chimeric sequences. in this situation, abyss generates contigs that overlap but it does not combine them without further information. this produces a highly fragmented assembly. to reduce fragmentation, longer reads and higher k-mer sizes can be used. however, genes will not be assembled where there is insufficient overlap between longer k-mers. genes expressed at low levels can only be assembled using small k-mer sizes. to assemble the largest possible number of contigs with the longest length, a range of k-mer sizes is required. in most studies of est libraries reported to date the goal is to assemble as many genes as possible, which might explain why low k-mer sizes , have been used in previous studies  <cit> .

coverage cutoff and assembly
although it appears not to have been used to advantage in reported transcriptome studies, the coverage cutoff can also help to avoid assembly problems when there are identical regions between homeologues or paralogues. if one of two highly similar homeologues has a high expression level while the other homeologue has a low expression level, the highly expressed homeologue can be assembled using high coverage cutoffs. doing this will exclude from assembly the low coverage reads that belong to the second homeologue. once the highly expressed reads have been assembled  then the assembly of reads from the lowly expressed homeologue can be made using a low coverage cutoff and a small k-mer size. indeed it may make little sense to search for a single set of 'best' assembly parameters for a transcriptome. such an approach is likely to limit the number of genes that can be assembled in the est library.

trans-abyss and trinity
the trans-abyss  <cit>  assembler was tested on our datasets because earlier benchmarking analyses showed an improvement in the quality of trans-abyss assemblies over abyss assemblies. trans-abyss takes contigs assembled using abyss with different k-mers as input and then conducts a blat  <cit>  search to find nearly identical contigs obtained in these assemblies. overlapping contigs with identical sequences are then assembled further using cap <dig>  <cit> . this step reduces the number of contigs considerably. for our dataset this method resulted in a high number of hybrid sequences for the homeologous copies. the reason for this is that if the distance between two snps between the homeologous copies is greater than the k-mer used, abyss produces contigs that overlap by exactly the sequence between the two snps. cap <dig> is an overlap assembler that combines sequences by a majority rule, meaning that contigs stemming from different homeologous copies will be combined randomly if an overlap of identical sequences is present. as no parameter setting of percent identity and length of overlap were available with trans-abyss to prevent the assembly of hybrid sequences a more conservative approach to transcriptome assembly was investigated in the present study .

trinity  <cit>  is a transcriptome assembler that does not generate one large de bruijn graph for the whole dataset but first generates linear contigs from seeds  in the inchworm step first. these linear contigs are then converted into de bruijn graphs in the chrysalis step. this method was tested on the p. cheesemanii dataset and indeed was able to reduce the effect of different expression levels of the genes. genes that were known to have a low expression level were assembled with the same parameter as genes with a very high expression level. nonetheless the n <dig> and n <dig> value as well as most other assessment parameters used do not show any significant improvement to the single assemblies conducted with abyss. only the amount of bases assembled in the sequences longer than  <dig> bp indicate that sequences assembled with trinity are longer than with abyss. trinity assembles  <dig> complete transcripts more than any single abyss assembly but  <dig>  complete transcripts less than were obtained with all abyss assemblies. although trinity is able to accommodate for differences in the expression level, the default k-mer size specified is  <dig>  in our case this means that homeologous that have identical regions of more than  <dig> nucleotides cannot be assembled anymore. restricting the k-mer parameter space results in a fragmented assembly. with trinity, the k-mer can only be increased to a maximum of  <dig> making this assembler, while promising for diploid organisms, does not significantly improve the transcriptome assembly of allopolyploidy species similar to pachycladon. further, in the situation where a homeologous gene copy has a very low expression level relative to the other copy, this sequence is filtered out in the butterfly step as it is assumed to be the result of sequencing errors.

assessment of assemblies
parameter estimates used to assess de novo assemblies have previously included the number of the assembled contigs, the length of the longest sequence, and the n <dig> length. our study of pachycladon assemblies and also previous studies suggest that all three are related, and the first two parameters can be predicted just from the k-mer size used. assemblies conducted with small k-mer sizes have more contigs because of the higher fragmentation of the sequences. this fragmentation also leads to a higher number of smaller contigs and therefore to a smaller n <dig> length. assemblies conducted with high k-mer sizes produce fewer contigs , a higher percentage of longer contigs and a higher n <dig> length. the use of the n <dig> length is most appropriate when assembling whole genomes but when evaluating the assembly of a transcriptome, in which the lengths of the genes are highly variable by default, a high n <dig> length does not necessarily indicate a higher quality transcriptome assembly. rather, assemblies that have a high n <dig> length select against the assembly of shorter genes. this suggests that less significance should be placed on n <dig> length and more emphasis should be placed on how many and what sequences are assembled. this suggestion is supported by the observation that the longest sequence in each pachycladon assembly was not the same gene. in our  <dig> assemblies  <dig> different genes were identified as being the longest transcript. other parameters like the percentage of reads included in the assembly or the amount of sequences assembled indicate how much of the actual transcriptome is captured in the assembly. optimal k-mer size and coverage values derived from these parameters favour the use of small coverage cutoffs and larger k-mer sizes. nonetheless, one of the most important uses of an assembled transcriptome is for differential expression analysis. particularly when dealing with polyploidy species it is crucial to be able to distinguish the two homeologous copies of one gene in order to distinguish expression levels of both copies. the more fragmented an assembly is, the harder it is to reliably distinguish contigs belonging to either of the two copies. while the amount of data generated and included in the assembly are important parameters, they do not give an indication of how fragmented are the assemblies.

assessment should be based on the total number of full length transcripts
while it is obvious that there must be one best assembly with regard to whole genomes  <cit> , with transcriptomes assembly must be optimized for each of the transcripts separately, making that task much more challenging. instead of assembling only one genome the assembly of a transcriptome is analogous to the simultaneous assembly of several thousand small genomes wherein optimal parameters need to be found for each genome.

in our study, the highest number of full length transcripts was found with k-mer size  <dig> and coverage cutoff seven for p. fastigiatum and coverage cutoff five for p. cheesemanii. the lowest number of full length transcripts was found using k-mer size  <dig> and high coverage cutoffs. this suggests that many genes shared an optimal or near optimal parameter combination at the mid range of our parameter values. while k-mer size  <dig> was high enough to distinguish between the homeologous copies it was also small enough to assemble genes with a medium expression level. coverage cutoffs seven and five were also effective in assembly when genes in our dataset exhibited a medium level of expression. reducing the coverage cutoff increased the amount of noise and the complexity of the assembly problem, thereby reducing the total number of full length assembled transcripts. similarly, increasing the coverage cutoff above  <dig> also significantly reduced the total number of such transcripts, because relatively fewer genes had sufficiently high expression levels. high k-mer sizes also led to suboptimal assemblies. k-mer sizes higher than  <dig> produced a reduced number of full length assembled transcripts irrespective of coverage cutoffs, a result consistent with most transcriptome assemblies reported to date which typically report optimal k-mer sizes smaller than  <dig>  an important point of note is that the optimal k-mer size and coverage cutoff is expected to vary between organisms and also between different read datasets for the same organism. in respect of the later, our results suggest that the absolute number of reads will influence the optimal k-mer size and coverage cutoff values for each gene in the transcriptome.

comparison of assemblies revealed a surprising lack of overlap with respect to the full length transcripts. the maximum number of full length transcripts found in one assembly was  <dig>  if only this assembly had been conducted,  <dig>  sequences would not have been assembled to full length transcripts. for many genes near identical parameter values gave similar assembly results , while more distinct parameter combinations produced assemblies with little overlap. transcripts found to be full length under one set of assembly conditions often occurred in other assemblies in a more or less fragmented state. such fragmented sequences are less useful for differential expression analyses as the statistical power is less for smaller sequences  <cit> . furthermore in allopolyploid plants it might be difficult to assign reads to the appropriate homeologue under such conditions. these considerations provide further justification for the idea that the best measure of a transcriptome assembly should be the length of the transcripts.

the realization that an optimal assembly requires optimization for each gene becomes even clearer when the parameter combinations for which full transcripts were assembled are considered. there was no gene in our dataset whose assembly was not influenced by either the coverage cutoff or the k-mer size. for example, although there were some genes in p. fastigiatum, that could be assembled with a wide range of parameter combinations such as glycosyl hydrolase 9b <dig>  many genes did not assemble completely with only one specific coverage cutoff and/or one specific k-mer size . the analysis of the expression level and similarity between the genes suggests that there are mainly two reasons for this: one important attribute is the expression level of each gene, another attribute is the extent of similarity to other sequences in the dataset.

a higher expression level typically is associated with a wider range of optimal assembly parameters . not only does the expression level affect the range of coverage cutoffs but also the range of k-mer sizes. however, if a gene has a very high expression level, as with esm <dig> and rbcs in p. fastigiatum, this effect seems to be reversed. the reads for these two transcripts can be assembled fairly well when separated from the rest of the dataset, especially in the case of esm <dig>  however, even the addition of only the reads with up to three mismatches does cause a fragmented assembly. this is surprising because our experience is that allowing for mismatches with less highly expressed genes tends to reduce fragmentation. combining the reads of the seven example sequences generated an extremely fragmented assembly for these two transcripts resulting in very short sequences . since contigs smaller than  <dig> or  <dig> bp are normally excluded from further analyses as they are too short to be accurately annotated, contigs of very highly expressed genes will be absent from assemblies made with low coverage cutoffs . both esm <dig> and rbcs belong to gene families with highly similar paralogous sequences  <cit> . the presence of these might provide an explanation for the fragmented assemblies obtained with these genes.

the three gene copies for mvp <dig> are highly similar and thus require assembly using higher k-mer values. however the transcripts for these copies have a low to medium expression level, which means that high k-mer values are not appropriate. a tradeoff seems to be k-mer sizes  <dig> and  <dig> with which all sequences can be assembled to nearly full length transcripts.

assembly of the transcripts for rbcl and at1g <dig> required accommodating low levels of gene expression. in this situation contigs might not be joined because there are too few reads connecting them. including reads with mismatches in this instance is expected to help the assembly as the presence of these can increase read coverage. this was found to be the case in the assembly of rbcl. this gene is chloroplast encoded, and therefore only one copy of this gene exists, thus there were no reads stemming from a similar homeologous or paralogous copy to interfere with the assembly. this also seems to have been the case with at1g <dig>  that is, while it is nuclear located, the inclusion of mismatched reads improved the assembly regardless of the k-mer size and cutoff values. this hints either towards the presence of only a very dissimilar homeologous copy in the transcriptome or towards a lack of expression of a homeologous copy.

in summary, our observations suggest that common causes of fragmented assemblies with allopolyploid libraries are either too low or too high expression levels and a high degree of similarity between homeologous or paralogous sequences. all of these issues can be addressed using different strategies, however the success of these strategies depends on multiple features of the genes. for example, the inclusion of mismatched reads can assist in the assembly of transcripts with a low expression level. however, the addition of mismatched reads can introduce significant noise into a dataset of reads when transcripts are highly expressed. in this instance their inclusion will be unhelpful.

CONCLUSIONS
as many gene families have arisen through gene duplication during evolution the similarity between different gene copies can pose a problem of significance in the assembly of transcriptomes. this is especially the case for organisms of polyploidy origin. the problem for assembly that highly similar gene copies cause can to some degree be overcome by altering the k-mer size and the coverage cutoff as shown here. while the addition of longer reads into the assemblies can also be expected to provide a solution for these cases, our findings highlight the potential of using even very short reads for the assembly of allopolyploid plant transcriptomes.

