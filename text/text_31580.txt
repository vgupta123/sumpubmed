BACKGROUND
the immune adaptive system defends multicellular organisms from pathogens  and tumor cells which are specifically recognized by antigen receptors. these antigen receptors, immunoglobulins  or antibodies  <cit>  and t cell receptors   <cit> , present a huge diversity  that is crucial for specific antigen recognition. these huge numbers of different proteins are encoded by a relatively limited number of genes organized in the genome in different loci  that comprise different types of gene: variable , diversity , joining  and constant  genes. synthesis of the ig and tr proteins requires complex mechanisms that include, at the dna level, rearrangements of v and j, or of v, d and j genes  <cit> , n-diversity at the resulting v-j and v-d-j junctions  <cit>  and, for the ig, somatic hypermutations  <cit> . these rearrangements are followed, at the rna level, by the splicing of rearranged v-j and v-d-j genes to a c gene. in order to manage ig and tr data, imgt®, the international immunogenetics information system®, http://www.imgt.org/ <cit>  was created in  <dig>  by the laboratoire d'immunogénétique moléculaire ligm . one of the first goals of imgt® was to identify and to describe all the human ig and tr genes present in the human genome, an indispensable requisite before analysing the immune repertoire. owing to the particularities of the ig and tr gene structures, imgt-ontology  <cit> , the first ontology for immunogenetics and immunoinformatics, has been built to ensure the accuracy and the consistency of the imgt® data, as well as the coherence between the imgt® databases, tools and web resources  <cit> . several years of expert and time consuming manual curation led to the imgt® gene nomenclature for ig and tr genes  <cit>  which was approved by the human genome organisation  nomenclature committee  in  <dig>  <cit>  and by the world health organization-international union of immunological societies   <cit> . imgt® ig and tr genes have been entered in imgt/gene-db  <cit> , the imgt® gene database, in the human genome database   <cit> , in locuslink  <cit>  at the national center for biotechnology information , in entrez gene  <cit>  when this database superseded locuslink, in ensembl  <cit>  at the european bioinformatics institute , and in the vega genome browser  <cit>  at the wellcome trust sanger institute.

interestingly, the human ig and tr genes data were annotated in imgt®  <cit>  before the release of the human genome sequence  <cit> , however most of the corresponding genomic sequences were short  and large contigs still remain to be precisely annotated. conventional software and tools such as genemark  <cit> , genescan  <cit>  and n-scan  <cit> , are not adapted to the annotation of ig and tr genes owing to the particularities of their structure. prediction of immunoglobulin superfamily protein genes with exegesis  <cit> , a procedure which uses genewise  <cit>  and experimental maps, showed improvement by comparison with the ensembl method. however, this procedure has not been developed for detailed and standardized annotation. to answer the need of a tool for an automated annotation of antigen receptors in genomic dna and, thus, to avoid several manual and time consuming steps, imgt/ligmotif, a java on-line software has been developed, that allows the identification, standardized description and functionality assignment of ig and tr v, d and j genes in large genomic sequences.

methods
ig and tr gene characteristics to consider for gene identification
ig and tr v, d and j genes belong to multigene subgroups and, therefore, share a high percentage of sequence identity  as a result of gene duplications inside a given subgroup  <cit> . as a consequence it is often difficult to assign nearly identical sequences either to different genes or to different alleles of a same gene. this can lead to possible errors in the genome assembly that need to be detected.

ig and tr loci contain several hundreds of genes, 608- <dig> ig and tr genes per haploid genome in human, depending on the haplotypes, and more than  <dig> ig and tr genes in mouse  <cit> , these numbers including many pseudogenes . many of these pseudogenes are degenerated and/or partial genes and, therefore difficult to annotate. another level of complexity results from gene insertion and/or deletion polymorphisms that are frequent in multigene families. as the genome assembly results from joined dna fragments from different haplotypes, and from one or the other chromosome, it does not reflect a 'true' haplotype and a careful analysis is required for the gene and allele assignment. it should also be noted that some ig and tr genes, designated as orphons are localized outside the main loci  <cit> . although these orphons are not functional, they have a high percentage of identity with genes of the major loci and represent another source of possible confusion and errors in gene and allele identification. at last, d and j genes have very small coding regions  and 37- <dig> bp, respectively) making their identification difficult.

interestingly, and despite the difficulties mentioned above, functional ig and tr genes have characteristics that, if present, allow their unambiguous identification. thus, for example, ig and tr v genes comprise two exons, a l-part <dig>  exon and a v-exon with a splicing frame of type  <dig>  . the ig and tr v, d and j genes have recombination signals  which allow them to rearrange at the dna level in b cells  and t cells   <cit>  and that constitute one of the major differences with conventional genes. rs are localized in 3' of the v genes , in 5' of the j genes  and on both sides of the d genes   <cit> . they consist of conserved heptamers and nonamers separated by less conserved spacers of  <dig> ±  <dig> or  <dig> ±  <dig> bp which vary between loci and species . an efficient recombination only occurs between a rs with a  <dig> bp spacer and a rs with a  <dig> bp spacer   <cit> .

in imgt®, the ig and tr gene characteristics used for gene identification are defined by concepts generated from the imgt-ontology 'identification' axiom  <cit> . three concept instances of the 'molecule_entitytype' concept of identification are used in the imgt/ligmotif model: v-gene, d-gene and j-gene. these concept instances are defined by the gene type , diversity , joining ), the molecule type  and the configuration type   <cit> .

ig and tr gene characteristics for standardized gene description
prototypes and labels
the ig and tr gene features are described, in imgt®, according to the standardized concepts of description generated from the imgt-ontology 'description' axiom  <cit> . thus, the v-gene, d-gene and j-gene are described by three concept instances of the 'molecule_entityprototype' concept of description: v-gene, d-gene and j-gene  <cit> , respectively. their graphical representation, or prototype, and the labels that describe them are shown in figure  <dig> . among the  <dig> imgt® labels defined for the nucleotide sequences,  <dig> are used in the imgt/ligmotif model  of which  <dig> are specific of one prototype . two labels  are common to all prototypes, whereas  <dig> labels  are shared by several imgt-ontology prototypes .

the organization of a prototype is based on the relations that order two labels  <cit> . interestingly, a set of twelve relations is necessary and sufficient to describe the relations between labels in a prototype . ten of these relations were defined previously  <cit> . two reciprocal relations, 'is_in_5_prime_of' and 'is_in_3_prime_of' have been added in the imgt/ligmotif model to indicate the relative position of labels on a 5'-3' dna strand when there is no intersection between labels .

relations between labels are those used for the description of prototypes  in imgt-ontology  <cit> .

patterns
for the purpose of gene description, imgt/ligmotif uses the 'gene unit' labels l-v-gene-unit, d-gene-unit and j-gene-unit . indeed, these labels, in contrast to the 'gene' labels  have the advantage to be precisely delimitated in 5' and 3', respectively, by the 5' end and 3' end of constitutive labels . moreover, the part of the prototype they encompass can be defined by conserved motifs that constitute a pattern . in a pattern, the conserved motifs are separated from each other by a distance in base pairs  comprised between a minimal and a maximal length . motifs are ordered from 5' to 3' with a rank  that corresponds to their relative localization in the pattern, the motif the most in 3' having a rank that corresponds to the number of motifs in the pattern . in the j pattern, the motifs j-trp and j-phe are shown between brackets and separated with a coma to indicate that the two motifs are possible for the same rank.

these conserved amino acids j-trp and j-phe are part of a conserved motif '--x-g' where w = tryptophan , f = phenylalanine , g = glycine, a = alanine and x = any amino acid except proline.

ig and tr gene characteristics for functionality identification
the gene functionality identification can only be assigned to precisely described ig and tr genes. in imgt-ontology, an unrearranged genomic v, d or j gene can be functional , open reading frame  or pseudogene   <cit> . a gene is qualified as 'functional' if the coding region has an open reading frame without stop codon, and if there is no described defect in the splicing sites, recombination signals and/or regulatory elements. a gene is qualified as 'orf' if the coding region has an open reading frame, but alterations have been described in the splicing sites, recombination signals and/or regulatory elements and/or changes of conserved amino acids have been suggested by the authors to lead to uncorrect folding, and/or the entity is an orphon. a gene is qualified as 'pseudogene' if the coding region has stop codon and/or frameshift mutation. in particular, a v-gene  is considered as 'pseudogene' if these defects occur in the l-part <dig> and/or v-exon, or if there is a mutation in the l-part <dig> init-codon atg. a j-gene  is considered as 'pseudogene' if it has been identified by the presence of a rs upstream of an open reading frame, but it has no donor splice site in 5' or the donor splice is not in the expected splicing frame sf <dig> or if it has no conserved '--x-g' motif.

characteristics for gene delimitation and cluster assembly
the imgt® rule to delimit v-gene, d-gene and j-gene instances is to equally distribute the distance between the two genes. the imgt-ontology 'genecluster' concept allows describing genomic sequences that contain several genes. the gene instances in a cluster can be of the same prototype , or of different prototypes . seven instances of the 'genecluster' concept are used in the imgt/ligmotif model . the imgt-ontology 'genecluster' instances are particularly useful for the annotation of the large scale genomic ig and tr loci and are also used by the sequence ontology   <cit>  .

 seven 'genecluster' concept instances of imgt-ontology are used in imgt/ligmotif. six of them are also used by sequence ontology   <cit> .

 relations with the 'molecule_entityprototype' concept instances comprise the minimal number of different instances for each 'genecluster' concept instance and the name of the different instances, as defined in the imgt/ligm-db list of labels  <cit> .

imgt/ligmotif model
the imgt/ligmotif model comprises  <dig> modules ,  <dig> of them  take into account the ig and tr gene characteristics as defined above and deal with individual gene units, whereas the fourth module  deals with gene delimitation and assembly of genes in a cluster, and provides an annotated genomic sequence.

gene identification
the 'gene identification' module identifies potential v, d and j genes along the genomic sequence to analyse. first, a heuristic search for local alignments is performed against imgt/ligmotif reference motif databases . these databases comprise nucleotide sequences that correspond to ig and tr gene unit labels  and to motifs that compose them. these databases are created dynamically from imgt/ligm-db  <cit>  sequences, using the imgt/gene-db  <cit>  interface that allows queries on labels. thirty-four labels were queried corresponding to ig and tr sequences from human  and mouse . pseudogene genes too poorly conserved to be assigned to subgroups were excluded. the alignments obtained in this first step provide labelled high-scoring segment pairs  on both dna strands of the sequence to analyse. then, there is a selection of the labelled hsps and a grouping of these selected hsps given their topology and their gene type . thus, the 'gene identification' module provides the potential v genes, d genes and j genes identified as grouped and labelled hsps along the sequence to analyse.

gene description
the 'gene description' module provides the description of each potential gene identified in the first module. it comprises a search of conserved motifs based on prototypes and patterns. codons of conserved amino acids in the patterns  are difficult to identify by conventional algorithms as the motifs  are very frequent in sequences. for that reason, the codons of conserved amino acids of the v-region and v-exon  are identified by the software imgt/v-quest  <cit> . the expected outputs of the 'gene description' module are described as gene units , although, as discussed in the algorithm section, partially described and undescribed outputs can also be obtained.

functionality identification
the 'functionality identification' module includes the control of features needed for the functionality assignment and allows to obtain annotated gene units.

gene delimitation and cluster assembly
in this final module, genes  are delimited and assembled in a cluster if the analysed genomic sequence contains several genes. the final outcome of imgt/ligmotif is the annotated genomic sequence.

algorithm
gene identification of v, d and j genes
search of labelled alignments
the algorithm starts by aligning the genomic sequence using blastn  <cit>  against imgt/ligmotif reference motif databases . the possibility is given to the biocurator to select databases on species , locus , gene type , functionality , and to choose any combination in this selection. imgt/blast provides hsps that inform on the similarity of the analysed sequence  with labelled motifs from the reference database . these labelled hsps are obtained on both dna strands of the sequence to analyse. practically, ncbi-blastn  is used with the minimum hit word size possible , an e-value threshold of  <dig>  . the blast was preferred to hidden markov model  methods and software such as hmmer  <cit>  for practical uses.

selection of labelled hsps
imgt/blast produces a huge quantity of hsps but these hsps do not have the same importance. hsps obtained with different reference motif databases may overlap at a same location as they are expected components of a same prototype . these overlapping hsps do not need to be filtered as they delimit different and expected labels. in contrast, and owing to gene duplications in ig and tr loci, different hsps obtained with a same reference motif database may overlap at a same location although they might belong to different genes. in consequence, the best hsps are selected at a given location  on score, e-value, length and identity blast parameters. the method to filter overlapping hsps obtained with the same motif database is described as follows: score(), length(), identity(), evalue() are the functions that return  <dig> if a given hsp  performs better than the other  for the tested parameter ,  <dig> if the two hsps are equal and - <dig> if hsp <dig> performs less well than hsp <dig>  parameter g <dig>  and evalue(), with - <dig> ≤ g <dig> ≤ 2) and parameter g <dig>  and identity(), with - <dig> ≤ g <dig> ≤ 2) are calculated between each two overlapping hsps obtained from the same motif database. if g <dig> >  <dig>  or if g <dig> =  <dig> and g <dig> >  <dig>  hsp <dig> is removed. in other cases , hsp <dig> is removed.

grouping of selected hsps in v, d or j gene
the objective of this step is to group selected hsps that may belong to a same gene . for that purpose, the positions of selected hsps from the same dna strand and with labels of the same gene type  are, in this step, compared to each other . if the topological relation of two compared hsps is not coherent they are considered as belonging to distinct genes. if the topological relation is coherent, a length specific for each label , is added to 5' and/or 3' extremities of each compared hsps  and these new regions are looked for a potential position overlap. if a position overlap is found, the two hsps are considered as belonging to the same gene. if not, the two hsps are considered as belonging to different genes. for a given hsp group, the position most in 5' and the position most in 3' define the area that contains a potential gene . the labelled hsps that constitute that group provide the gene type  and, using their respective localization on the dna strands, the gene orientation. each group of hsps corresponds to a potential gene identified along the sequence .

gene description of l-v-gene-unit, d-gene-unit and j-gene-unit
the second module of imgt/ligmotif, 'gene description', describes in detail each identified gene, individually . this analysis is performed from 5' to 3', exploring both strands. imgt/ligmotif starts by searching conserved motifs of the patterns described in figure 1a. the gene description is performed by searching and delimiting conserved motifs that are characteristic of each gene type .

delimitation of conserved motif searching areas 
in order to reduce the algorithm execution time the search of conserved motifs is limited to conserved motif searching areas  which are delimited by the positions of the most informative combination in each grouped hsp. the best combination of hsps depends on the gene type : for instance, for a v gene the best combination is l-part1+v-exon+v-rs, for a d gene, it is 5'd-rs + 3'd-rs, whereas for a j gene, it is j-rs + j-region. if the best combination is not present, other combinations are explored in the order shown in table  <dig>  a length is added to extremities  of the labels belonging to an hsp combination to delimit the cmsa . for example, a length of  <dig> nt  is added to the 5' and 3' position ends of a rs hsp.

l-part <dig> + v-exon
v-exon + v-rs
v-exon
5'd-rs + d-region
d-region + 3'd-rs
5'd-rs
3'd-rs
d-region
j-region
j-rs
the underlined combinations are those used in priority. if not present, the combinations below in the columns are chosen in the order from top to bottom.

 d-region is not used even if it is identified because 5'd-rs and 3'd-rs are sufficient for its precise delimitation, as well as those of the heptamers and nonamers.

 as l-part <dig> is missing, its motifs  are not delimited.

search of conserved motifs in cmsa
conserved motifs that include conserved amino acids , splicing sites , heptamers and nonamers are searched in the cmsa which are known to include them. heptamers and nonamers are searched by alignment with the reference motif databases. if no exact match is found, an approximate form of the motifs is searched using non gapped position-specific scoring matrices   <cit> . following the search of conserved motifs in cmsa, matches are grouped and retained as a set named 'solution' if the distances between the motifs are in the intervals defined for the pattern. a minimum of two conserved motifs is required to retain the solution. if this condition is not fulfilled, genes cannot be described using imgt/ligmotif and, thus, are defined as 'v undescribed', 'd undescribed' and 'j undescribed' .

delimitation of motifs using conserved motifs as anchors
in the next step, other motifs of the patterns are then delimited precisely using conserved motifs as anchors  . arrows taking root from anchors delimit precisely new labelled motifs. for instance, acceptor-splice and v-heptamer  allow delimiting v-exon. an arrow arriving from the left delimits the 5' end of a motif whereas an arrow arriving from the right delimits the 3' end. the number associated to an arrow indicates the number of nucleotides which must be added  or subtracted  to a conserved motif position to delimit precisely the new labelled motif. the j-phe and j-trp are the only conserved motifs that do not delimit labelled motifs, and consequently, no arrow takes root from them.

additional steps for the description of a l-v-gene-unit
the description of a l-v-gene-unit requires two additional steps. the first one is the delimitation of the v-region with its constitutive regions  and conserved motifs  using imgt/v-quest  <cit> . this step is only be performed if a v-exon has been identified. if v-exon is missing the gene is defined as 'v partially described'. the final step for the description of a l-v-gene-unit is the delimitation of l-part <dig>  a region delimited by the v-exon acceptor splice and the 5' end of the v-region determined by imgt/v-quest.

functionality identification
the third module of imgt/ligmotif 'functionality identification' identifies the functionality of each described gene unit . a l-v-gene-unit is identified as functional if it has all the  <dig> specific labels and expected splicing sites , no stop codons in l-part <dig> and v-exon, a splicing frame sf <dig> between l-part <dig> and v-exon, no frameshift , an expected v-spacer length, and v-heptamer and v-nonamer identical to ones found in functional genes . a j-gene-unit is identified as functional if it has all the  <dig> specific labels and expected splicing site , no stop codons in j-region, a sf <dig> donor splice, the conserved '--x-g' motif as one indicator of the absence of frameshift, an expected j-spacer length, and j-nonamer and j-heptamer identical to ones found in functional genes . a d-gene-unit is identified as functional if it has all the  <dig> specific labels, at least one open reading frame without stop codon, expected 5'd-spacer and 3'd-spacer lengths, and the heptamers and nonamers are identical to ones found in functional genes . a gene unit is identified as an open reading frame  if the last  <dig> criteria for v and j and the last  <dig> for d are not fulfilled. in other cases the gene unit is identified as a pseudogene . note that if the first criterion  is not fulfilled, the functionality is 'unknown' as it cannot be determined automatically and its identification therefore requires a manual expertise.

gene delimitation and cluster assembly
for each gene unit, and whatever its description status , partially described  or undescribed ), the 5'utr and 3'utr delimitations of the corresponding v-gene, d-gene or j-gene are determined by equally distributing the distance between two neighbouring gene units. thus, the sequence can be considered as a succession of genes that constitute a cluster. the cluster is defined based on the 'molecule_entityprototype' instances found in the sequence and an imgt® cluster label is assigned , for instance v-d-j-cluster, if the sequence contains at least one v-gene, one d-gene and one j-gene. finally, the number of genes in the analysed sequence is computed per dna strand, per gene type and per functionality.

RESULTS
imgt/ligmotif algorithm is implemented in java http://www.java.com/fr/. a web application of imgt/ligmotif is running on a tomcat server http://tomcat.apache.org/ and is available at http://www.imgt.org/ligmotif/. the genomic sequence to analyse can be copied/pasted by the biocurators, or uploaded in fasta or embl format. query parameters can be modified to optimise the analysis efficiency. for instance, reference motif databases can be selected on their gene type, locus, functionality and organism. the execution time depends on the gene types and the number of genes existing in the sequence. the analysis of a single gene takes a few seconds whereas a complete locus containing more than  <dig> genes takes between  <dig> minutes to  <dig> hour, using standard parameters. the imgt/ligmotif results page  displays, at the top of the page, statistics that include the execution time, the length of the analysed sequence, the total number of genes per dna strand , and two tables: the first one indicates the number of genes per description status  and per gene type, the second table indicates the number of annotated gene unit per functionality status . below the statistics, the main table displays the content of the analysed sequence, starting from n°  <dig>  for the gene the most in 5'. this table provides, for each identified gene: description , positions , dna strand, functionality and number of labels. selecting gene units in the main table  allows displaying their labels with positions, nucleotide sequences and, for coding regions, amino acid sequences . in the detailed display, labels of each gene unit are ordered from 5' to 3'. if two labels start at the same 5' position, the label with the longest nucleotide length is displayed first. the imgt/ligmotif results can be exported to a spreadsheet file that can be modified at will. imgt/ligmotif results for the  <dig>  bp sequence of the human trb locus  identified  <dig> gene units  . compared with manual expert annotation, these results show that all gene units were correctly identified. no gene was missing and there was no false positive. the functionality is more difficult to assign, which is reflected in the imgt/ligmotif results. functionality could be assigned to  <dig> gene units:  <dig> genes  were determined as functional,  <dig> as orf and  <dig> as pseudogenes. indeed, the functionality identification by imgt/ligmotif requires that a gene unit be fully described with all its labels. most mutated pseudogenes have missing labels therefore preventing the functionality assignment. another limitation is the lack of recognition of unconventional splicing sites found in orf . although manual expertise is still required for a definitive functionality assignment, imgt/ligmotif represents a major step forward in the automatic assignment of the functionality. in its present status, imgt/ligmotif considerably accelerates the process of identification and description of antigen receptor genes in large genomic sequences.

CONCLUSIONS
imgt/ligmotif http://www.imgt.org/ligmotif/ is a user friendly tool that provides the annotation of large genomic sequences containing ig and tr genes. the web user interface provides a simple way to query, visualize and download results. the execution time is suitable for the analysis of an entire locus. the annotation includes the gene identification and orientation in the sequence, the gene delimitation , the detailed description of gene units  with the imgt® labels and functionality identification, and finally the cluster assembly. annotation of c-gene has not been included in this first version of imgt/ligmotif as the gene identification and annotation is performed easily with conventional tools by the biocurators. imgt/ligmotif is particularly useful for the annotation of ig and tr loci from species that are phylogenetically close to human and mouse such as nonhuman primate species, chimpanzee and rat, respectively. more distant species will still require manual expertise in the control of the annotations. however, it is expected that the progressive enrichment of the imgt/ligmotif reference motif databases with data ig and tr annotated by imgt® will save a considerable amount of time in the process of the genomic annotation of vertebrate antigen receptor loci.

competing interests
the authors declare that they have no competing interests.

authors' contributions
jl conceived the algorithm and its implementation. pd and mpl coordinated the project. all authors read and agree to publish the manuscript.

