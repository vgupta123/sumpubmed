BACKGROUND
the most commonly used way of comparing two biological structures is by calculating their root mean square deviation . the rmsd measures the average distance between the atoms in the two structures after optimal rigid body superimposition, yielding a handy single value in distance units. two identical structures will display a zero rmsd, whereas two distinct ones will display values proportional to their dissimilarity.

despite its wide use, rmsd calculation still represents a challenge at many levels. for instance, a key step is to establish atomic equivalence in both structures. if the two proteins have identical topology, that is, the atom indexes and names are identical in both coordinate files, then assigning equivalence is trivial. unfortunately, this is rarely the case  and thus some kind of atom mapping is required to establish atom equivalence. in the same context, frequently forgotten issues are resolving positional equivalence of atoms in side chains allowing symmetry ambiguity  <cit>  or accounting for internal symmetry  <cit> . another key issue is the comparison of proteins with flexible regions or partial overlap, where a direct rmsd calculation provides an unrealistic measure of the similarity. in this regard, several concurrent strategies have been developed under the assumption of assigning greater weight to “rigid” parts of the protein. their common foundation is to use an iterative search to optimize the superimposition, assigning lower weights to most deviating fragments and thus finding the largest superimposable core  <cit> . more important problems arise in the structural comparison of proteins with different sequences. in these cases, a sequence alignment  <cit>  is mandatory before establishing the positional equivalence. in cases where the two proteins have completely different sequences, one must resort to structure-based superimposition methods  <cit> .

in macromolecular assemblies, symmetry issues also appear at the protomer level. most of the proteins in the protein data bank  are oligomeric complexes consisting of two or more subunits that associate forming rotational or helical symmetries  <cit> . for instance, according to a survey of all e. coli proteins , dimers represented ~ 40% of the species, followed by tetramers , and only ~ 19% were monomers  <cit> . among oligomers , homo-oligomers predominate , whereas only 21% form hetero-oligomeric complexes  <cit> . protein assemblies having rotational symmetry are classified according to crystallographic point group operations, forming cyclic groups , dihedral groups  and icosahedral groups . cyclic groups are the simplest yet most abundant cases among the three in pdb, consisting of a single axis of rotation forming a ring of arranged subunits.

the superimposition of complexes with perfect rotational symmetry is not an issue because rmsd becomes invariant to rotations. however, symmetry in biomolecules is rarely perfect and often is broken in functionally-relevant conformational changes. for instance, assemblies can adopt quasi-symmetry, in which subunits with identical sequence adopt distinct conformations   <cit> ), or pseudo-symmetry, in which different chains form almost symmetrical complexes   <cit> . the presence of “imperfect” symmetry  generates a hurdle in the superimposition of structures  by currently available software  <cit> .

despite the abundance of oligomeric complexes and superimposition tools, after an exhaustive search we could only find one that dealt with the issue of symmetry. the tool is called multimeric-align , comes from zhang’s lab  <cit>  and is an extension of the monomeric alignment program tm-align  <cit> . mm-align joins individual chains in each complex in every possible order and then finds the optimum structural alignment between them. mm-align is available via source code and web server, and provides basic text information about the final rmsd between complexes, the transformation matrix, as well as a rasmol script for local visualization of structures. mm-align, although extremely robust, is slow with large proteins and is not very versatile in terms of input and graphical output. for this reason, we decided to extend some of its attributes and develop a new web tool ourselves, taking advantage of all the atom mapping and superimposition features implemented in the icm modeling platform  <cit> .

here we present biosuper, a free web server that allows for fast quaternary structure comparison of homo-oligomeric and hetero-oligomeric proteins displaying n-fold rotational symmetry about one axis. biosuper has built-in sequence-dependent and structure-based methods for comparison of rigid and flexible proteins, which can be launched simultaneously. the superimposed 3d structures can be interactively manipulated side-by-side in a web browser with the help of a free plugin , or downloaded, together with the details describing atomic mappings. this paper describes the implementation of the tool, compares its results with mm-align, and shows a few examples chosen to highlight characteristics that can be of interest for structural and computational biologists.

implementation
we created biosuper as a fast, simple-to-use and platform-independent superimposition tool for structural and computational biologists  in need of comparing oligomeric proteins, in particular those forming ring structures. for the client-side operations, we used a responsive design web interface with html <dig> and the jquery javascript library, whereas the server-side was implemented using the perl cgi module. all the core calculations, including sequence alignments  <cit> , atom mapping, superimposition and rmsd calculations are carried out with icm  <dig>  software as described elsewhere  <cit> .

biosuper allows for three distinct types of superimpositions, two based on a sequence alignment and one based on a structural alignment. the three superimposition types are part of the icm distribution and have been exhaustively tested as published elsewhere . the simplest, yet the most widely used of the sequence-dependent methods, follows a mclachlan fitting algorithm  <cit>  and is labeled as standard. a standard superimposition  works well when the sequences of the proteins to be compared are similar and they do not display flexible domains or regions . using this type of superimposition, equivalence of symmetric side chain atoms in phe, arg, asp, glu, leu, phe, tyr, and val residues is taken into account when the user selects the mode heavy-atoms. for proteins having similar sequences but displaying flexible regions or partial overlap, a gaussian-weighted iterative approach   <cit>  can be used to find the best superimposable core in both structures. the idea is that non-flexible atoms will have a greater weighting than those that move . in cases where the sequences of both proteins differ, a structure-based method  is the most convenient . this approach finds the residue-to-residue correspondence based on the cα coordinates. the structural alignment algorithm is based on the zega  dynamic programming procedure  <cit> .

prior to any of the three mentioned superimposition types, if the target consists of multiple chains, the server performs the following operations:

 <dig>  the server performs n x n  sequence alignments to look for chain replicas. in the event that a given chain from the target displays a sequence identity ≥ 95%  with any other chain from the same structure, the server assumes that rotational symmetry exists . note that the user can modify this threshold. by default, the server reorders the chains in the pdb files so that adjacent ones become consecutive . the idea is to consider as adjacent the chain that is closer in space. for instance, taking the first chain  as a reference, the server computes the distances between its center of mass and the center of mass of the remaining chains, and adds as a consecutive  the chain having the minimum distance. the procedure is continued after all chains have been processed without allowing repetitions. this fast operation is able to correctly reorder the vast majority of assemblies checked, however, it can fail with hetero-oligomers  or with complex dihedral symmetries. for this reason, it can be turned on or off by the user. as a rule of thumb, we always recommend to manually verify chain position in the structures when working with biological units.

 <dig>  a search is performed to establish the chain mapping that minimizes the standard cα rmsd between the reference and the target. the chains of the target are mapped to those in the reference by performing a clockwise shifting, as follows : if we assume that the reference has  <dig> chains labeled as: “che-mis-try”  and the target has  <dig> chains labeled as “cal-che-mi”, two clockwise permutations of the target chains lead to “mi-cal-che” and “che-mi-cal”. in this case, “che-mi-cal” permutation will lead to the optimum chain mapping.

 <dig>  the 3d coordinates of the optimal permutation will be used for any of the  <dig> superimposition types available.

it is worth noting that we do not perform any rotation about an angle during the search, but an optimal circular permutation. in contrast to mm-align, biosuper does not find the best mapping of each individual chain from the target on the reference. this decision was deliberate to avoid the steric clashes that appear in the interfaces after individual superimposition of chains. the method was originally intended for assemblies displaying cyclic groups but it also works with many oligomers displaying dihedral groups . the server was not built to superimpose complexes displaying helical symmetry and thus it is not suitable for viral capsids, etc.

RESULTS
input and graphic visualization
the structures can be retrieved by their pdb code  or uploaded as pdb files. the user has the option of selecting individual protein chains and the level of atom selection . as an added feature, biosuper has the option of constructing the biological units  from the asymmetric ones. this operation can be performed only if the pdb contains appropriated information in the remark  <dig> tag . the user also can activate or deactivate the chain reordering feature, and can change the sequence identity threshold for considering two chains as equal.

the results are presented immediately after hitting the submit button, with an average execution time of ~  <dig> second  for average-sized proteins, and of 2– <dig> seconds for large biological units . the results are primarily web-based, consisting of html tables containing all numeric results and atom mapping, plus embedded 3d interactive molecular objects . to visualize the 3d objects inside the browser the user needs to install the free activeicm/active x plugin . alternatively, the 3d objects can be downloaded to be manipulated with the free icm browser  or with the free imolview lite . the server also provides the option of downloading superimposed pdb structures, as well as all possible chain mappings as text files  for further manipulation or analysis. all the information contained in the html tables can also be downloaded as a comma separated value  text file. the server includes a simple mechanism to try out sample data, a help page with extended documentation on the technical details, and several pre-computed examples showing scenarios where it can be applied .

benchmark
we conducted a benchmark to compare the performance of biosuper and mm-align. prior to the comparison, we want to emphasize that our goal with biosuper was not to create “another” structural superimposition tool, or to compete with any existing one, but rather to fill a gap existing for comparison of quaternary structures of symmetric assemblies.

we performed a search in the pdb and downloaded all the pdb ids having global c <dig> symmetry  to be later be used in pairwise superimpositions. we selected c <dig> complexes due to the relative low number of structures available, yet we think the conclusions can be extrapolated to any other symmetry type. from these  <dig> structures, we narrowed the selection to those assemblies that yielded  <dig> chains in the biological unit . our objective was to classify pairs by sequence similarity, so, for each protein we joined the  <dig> chains into a single one and performed  <dig> possible pairwise sequence alignments.  <dig>  had a sequence identity < 30%,  <dig>  had 30% ≤ sequence id. <  <dig>  and  <dig>  had a sequence identity ≥ 80%. from each of these  <dig> subsets we selected  <dig> random pairs and performed calculations with a standalone version of mm-align and biosuper web server . every subset had diverse representation of protein sizes, ranging from  <dig> to  <dig> residues. in figure  <dig>  we compare rmsd values obtained from biosuper with respect to rmsd values from mm-align, together with the number of residues aligned. ideally, we would like an approach that aligns the maximum number of residues while keeping the rmsd distances to minimum values. for biosuper we reported the weighted rmsd  and the structure-based rmsd.

as expected, for protein pairs having a sequence identity < 30%, a superimposition based on sequence alignments did not provide optimum results, and thus the weighted rmsd values were higher that those coming from the structural alignment of mm-align . interestingly, the number of aligned residues when using a sequence-based superimposition was consistently higher than that based on structure from mm-align. part of this effect is due to the superior accuracy of the “chain-to-chain” alignments in biosuper, with respect to the “joined-chains” ones in mm-align. biosuper’s structural superimposition provided lower rmsd values than mm-align, but only because icm aligned fewer residues than mm-align. complexes having sequence identity between 30% and 80% provided overall better rmsds values in both programs. this time biosuper’s weighted superimposition performed remarkably well in many cases, yet still aligning more residues than mm-align. as before, the biosuper structural rmsd values were lower that those from mm-align, due to the lower number of aligned residues. biosuper provided the best results in terms of aligned residues when the sequence of both complexes was ≥ 80%. the weighted superimposition was able to align the same or more residues than mm-align, thus providing more realistic rmsd values than purely structural ones. the fact that structure is more conserved than sequence became apparent, and weighted rmsd values were still higher than the structural alignment from mm-align. in case of structure-based superimpositions, mm-align provided larger alignments yet its rmsd values were comparable to those from biosuper.

in summary, we can conclude that biosuper is able to correctly map the chain correspondence between two protein assemblies displaying rotational symmetry, and its “chain-to-chain” sequence alignment has greater accuracy than the “joined-chains” one. this is particularly important when comparing assemblies with similar sequences that are fluctuating between conformational states. biosuper calculation times were on average 5×-10× faster than those from mm-align. on the other hand, in cases where the sequence of both complexes differs, the structural alignment from mm-align is able to align more residues  yet keeping decent rmsd values.

examples with proteins displaying rotational symmetry
c-reactive protein
the c-reactive protein  is a protein found in the blood that is involved in the activation complement system via the c1q complex. the quaternary structure consists of five identical chains  and is classified as a cyclic group c <dig>  for such a protein, we chose pdb ids that had identical sequence but displayed a conformational change  . in this case, the optimal permutation of chains was: r: a,b,c,d,e; t: d,e,a,b,c that led to an standard rmsd of  <dig>  Å . the original chain mapping led to a cα rmsd value of  <dig>  Å. for this protein, a standard superimposition yielded optimum results.

repb
repb is the initiator of dna replication of streptococcal rcr plasmid pmv <dig>  the structure of native full-length repb reveals a hexameric ring molecule, where each protomer has two domains organized as a toroid  <cit> . the catalytic domains appear to be highly mobile and repb hexamer  has been crystallized as trigonal and tetragonal forms , displaying c <dig> and c <dig> cyclic groups respectively . in this case, after creation of the biological units, the optimal permutation of chains was that present in the original x-ray structures. such chain mapping led to a standard rmsd value of  <dig>  Å . because of the high flexibility of the loop portion, the weighted rmsd led to a cα rmsd value of  <dig>  Å  and provided a better overall superimposition .

glutamine synthetase class i
glutamine synthethase class i  from salmonella typhymurium is an enzyme that plays an essential role in the metabolism of nitrogen by catalyzing the condensation of glutamate and ammonia to form glutamine. the quaternary structure consists of  <dig> identical subunits  arranged as a ring classified as dihedral group d <dig>  for this example, we chose two pdb ids that displayed quasi-symmetry . in this case, the optimal permutation of chains was that present in the original pdb files, that led to a standard rmsd value of  <dig>  Å . for this protein, a standard superimposition type yielded optimum values.

hemoglobin
adult human hemoglobin is a α2β <dig> tetrameric  hemeprotein present in erythrocytes, responsible for binding oxygen in the lung and transporting the bound oxygen throughout the body. the quaternary structure of the protein displays rotational symmetry and is classified as a cyclic group c <dig>  for this application, we chose two pdb ids that displayed pseudo-symmetry, the human deoxyhemoglobin . the results revealed that the optimal permutation of chains was again that present in the original x-ray files that led to a standard rmsd value of  <dig>  Å . for this protein a standard superimposition led to optimum results.

CONCLUSIONS
we have developed a web tool named biosuper that allows for fast and easy superimposition of proteins and assemblies displaying rotational symmetry about one axis. to the best of our knowledge, biosuper is the first web tool of its kind that provides instantaneous visualization of the 3d graphical results in the browser, biomolecule generator capabilities, as well as sequence-dependent and structure-based superimpositions, and the only web tool that takes into account atomic equivalence of atoms in side chains displaying symmetry ambiguity. the web server was created after our own frustration when attempting to superimpose snapshots coming from molecular dynamics simulations of flexible oligomers, and we believe that it can also be extremely useful to crystallographers and computational biologists.

availability and requirements
● project name: biosuper

● project home page: e.g. http://ablab.ucsd.edu/biosuper

● operating system: platform independent

● programming languages: perl, html <dig>  javascript.

● other requirements : activeicm  or imolview lite 

● license: gnu gpl 

● any restrictions to use by non-academics: none.

competing interests
the authors declare that they have no competing interest.

authors’ contributions
mr contributed to the design, implementation and testing of the web server, and wrote the manuscript. mo was involved in revising the manuscript. mt and ra wrote the icm program subroutines that are used by the web server, plus ra revised the manuscript. all authors read and approved the final manuscript.

