BACKGROUND
alternative splicing is widespread in higher eukaryotes as a way to increase cellular and functional complexity . most human genes are alternatively spliced , and most human alternative spicing is tissue-specific  <cit> . recently, the encyclopedia of dna elements  project catalogued human transcripts genome-wide in two major cellular sub-compartments  for  <dig> cell lines  <cit> , thus providing the most in-depth picture to date of the human transcriptome. one finding from that study is that about 10– <dig> isoforms are expressed per gene per cell line  <cit> .

growing evidence suggests that alternative splicing is important in cell functions. for example, it plays an important role in cell development . recently, merkin et al.  <cit>  studied tissue-specific splicing patterns in four mammals and one bird and identified many exons exhibiting highly conserved tissue-specific splicing patterns. differential alternative splicing may be associated with diseases  <cit> ; for example, overexpression of four-repeat tau mrna isoforms has been reported in progressive supranuclear palsy  <cit> . abnormally spliced mrnas are also found in a high proportion of cancerous cells  <cit> .

traditionally, the expression level of individual isoforms is quantified one isoform at a time using a specific primer. recent advances in next-generation sequencing technology  <cit>  allow genome-wide profiling of isoforms . although rna-seq conveniently provides a global view of the transcriptome at the gene level, deconvolution of the overall expression of a gene into the expression of its individual isoforms from sequence reads is not trivial because similar isoforms can generate identical sequence reads. many of the tools that have recently been developed for this purpose detect differences in expression between two groups of samples for each individual isoform of a gene , rather than for all its isoforms simultaneously.

in this paper, we focus on detecting differential isoform usage: “differential” meaning differences between two groups of samples and “isoform usage” denoting the set of relative abundances  of all isoforms of a gene. isoform usage so defined is assessed by a vector of fractions summing to one. consequently, detecting differential isoform usage for a given gene between two groups of samples is a different problem from that mentioned earlier of detecting differential expression for any particular individual isoform. the former problem, by focusing on the entire compositional vector, implicitly incorporates the constraint that the fractional contributions of the component isoforms sum to one.

existing methods for detecting differential isoform usage can be categorized into two types depending on whether or not they use information on isoform structure, e.g., gene annotation. methods that require isoform structures, either known a priori or inferred from rna-seq data, include cuffdiff <dig>  <cit> , the chi-square test in  <cit> , rdiff.parametric in  <cit>  and the probability splice graph  model in  <cit> . methods that do not depend on isoform-structure information include the flow difference metric  model in  <cit> , diffsplice in  <cit>  and the rdiff.nonparametric in  <cit> . all of these methods essentially test for a difference between two groups in their underlying distributions of isoform usage; and they all make use of alignment data obtained from the rna-seq sequence reads .

among methods that utilize prior information on isoform structure, cuffdiff <dig>  <cit>  either uses the known isoform-structure information or uses information on isoform structure inferred from the rna-seq alignment data by cufflinks  <cit> . the alignment data are also used to estimate the abundance of isoforms of genes. these estimates are then used to test for differential isoform usage between the two groups for those genes with all isoforms sharing the same start site. another method in this category, the chi-square test in  <cit> , first utilizes the known isoform-structure information to identify regions that are unique to particular isoforms and uses the counts of the alignments in those unique regions to test for differential isoform usage. similarly, for each gene, rdiff.parametric  <cit>  first identifies genomic regions that are not common to all isoforms in the gene and uses the counts of the alignments in those regions to test for differential isoform usage by a negative-binomial model. finally, psg  <cit> , uses known isoform structure information to construct a splice graph, aligns the rna-seq reads to the splice graph, estimates the weights of the edges in each sample from the aligned reads, then uses those estimated weights to test for differential isoform usage with a likelihood ratio test.

each of these procedures has limitations, however. cuffdiff <dig> cannot test for differential isoform usage directly when the isoforms of a gene do not share the same transcription start site , as it is designed to detect differential alternative splicing events for isoforms originating from the same pre-mrna. the chi-square test in  <cit>  can only be applied to genes that contain unique regions among the isoforms; so its power is expected to be limited when the unique regions are small. similarly, rdiff.parametric  <cit>  is expected to have limited power when regions that are not common to all isoforms are small. finally, psg  <cit>  does not accommodate biological replicates and requires exactly one biological sample per group.

tools that do not require isoform structures to test for differential isoform usage employ permutation tests to compare the alignments of sequence reads over the gene region in the two groups and provide an overall test for each gene. fdm  <cit>  constructs a splice graph for each gene in each sample using the rna-seq alignment data, calculates the flow difference metric  for every pair of the constructed splice graphs , and tests for differential isoform usage using those fdms. diffsplice  <cit>  also constructs a splice graph from the rna-seq alignment data for each sample, and indirectly tests for differential isoform usage by testing for the differential distribution of the alignments over the genomic locations where “alternative splicing occurs” in the gene, i.e., the alternative splicing modules  in  <cit> . rdiff.nonparametric represents each alignment in a gene as a binary vector whose length is the number of base pairs in the gene, calculates the average of these binary vectors from all samples in each group, and then tests for differential isoform usage using the euclidean distance between the two averages as the test statistic. one advantage of these three procedures is that they do not require the isoform structure information and so can be applied to genomes with incomplete or unknown annotations. however, there are disadvantages too. for example, fdm and diffsplice do not use the available data efficiently because, when applied to paired-end reads, they do not directly incorporate the uncertainty of the unsequenced portion of the underlying mrna fragments into their models. such uncertainty is only partially handled by alignment tools such as mapsplice  and mapper  before the data analysis. also, none of these methods can pinpoint which isoforms are involved in differential isoform usage, as individual isoforms are never identified in these methods.

in this paper, we present isoform usage two-step analysis , a novel approach for detecting genes with differential isoform usage between two groups of samples. iuta requires knowledge of the gene’s isoform structure and availability of multiple samples . for a given gene, iuta first estimates isoform usage in each sample based on paired-end rna-seq alignment data using a statistical model similar to one used by miso  <cit> . iuta then tests for differential isoform usage between the two groups using those estimates. because isoform usage is a type of compositional data, i.e., vectors that contain the proportions of each component comprising the whole unit  <cit> , iuta defines the statistical testing problem as a test of equal means for two multivariate distributions under the aitchison geometry  <cit>  instead of under the usual euclidean geometry. the aitchison geometry is widely regarded more suitable for compositional data analysis than euclidean geometry  <cit> . fully elucidating the reasons this preference is beyond our scope here, but the following example will illustrate the issue. consider two three-isoform genes in two conditions. for gene a, isoform usage is  in condition  <dig> and  in condition  <dig>  for gene b, the corresponding isoform usage vectors are  and . most biologists, regarding fold-change as the way to assess differential expression, intuitively regard gene a has having a greater disparity in isoform usage between the conditions than gene b because the proportion of the first isoform doubles for gene a but only increases about 14% for gene b and the changes in the second components are more comparable between the genes. the euclidean distance between conditions is the same for both genes ; whereas the aitchison distance between conditions is based on log-ratios  and is larger for gene a compared to gene b , in accord with intuition. iuta is the first approach that tests for differential isoform usage under aitchison geometry. iuta is implemented as a r package and is available at http://www.niehs.nih.gov/research/resources/software/biostatistics/iuta/index.cfm.

we performed several simulation studies to show the performance of iuta and to compare it with the cuffdiff <dig> , in which the developers improved the related testing procedures substantially from their old published procedures  <cit> . we restricted our comparison to cuffdiff <dig>  rather than including other methods that detect differential isoform usage, because cuffdiff <dig> is perhaps the most commonly used tool that both tests for differential isoform usage and estimates isoform usage vectors. the results showed that iuta is robust and has advantages over cuffdiff <dig>  we also applied iuta to six tissue-specific rna-seq datasets from the mouse genomes project at the wellcome trust sanger institute. we carried out  <dig> pair-wise comparisons among the six tissues to identify both genes with differential isoform usage between any two given tissues and genes with unique isoform usage in a given tissue compared to all others. this analysis represents the first genome-wide analysis of isoform usage in those tissues. our results on those data are consistent with other biological literature and will be valuable to those who study tissue-specific isoform usage.

methods
overview of iuta
suppose we have paired-end rna-seq alignment data for multiple samples from each of two groups . as a first step, for each gene in each sample, iuta uses alignment data  to estimate the isoform usage according to the isoform structure from an annotation file. iuta employs a statistical framework that is similar to, but different in some aspects from miso’s  <cit> . in a second step, iuta uses the estimates from the first step to test for differential isoform usage in each gene between the two groups.

estimating isoform usage
suppose a gene has k isoforms. let θij =  be the isoform usage of the gene for sample j in group i where i =  <dig>   <dig> and 1 ≤ j ≤ ji . each θijk represents the relative abundance of isoform k, that is, the proportion of the total number of transcripts for that gene with isoform k. to define a likelihood function for θij, we let lk be the length of isoform k , and introduce the following notation, in which the group and sample indices i and j are ignored for the sake of brevity. let r =  be the observed alignment data over the gene region, where n is the number of aligned paired-end sequence reads and rn  is the alignment, i.e., the genomic location information for the pair n. let r =  be the random vector for which r is a realization. for n =  <dig>  ⋯, n, let in be the random variable indicating the isoform from which read rn is sequenced; let fn be the random variable representing the fragment from which read rn is sequenced; and let ln be the random variable representing the length of fn. also let lkn be the length of the fragment of isoform k  that matches rn , i.e., the two ends of the fragment are identical with read pair n, and define lkn as  <dig> if there is no fragment of isoform k that matches rn. let fbe the fragment length distribution .

the likelihood function for a single gene  is then defined as:
  

because p = p, we can write
  

expressing the joint probability as a product of conditional probabilities, we have
  

where k =  <dig>  ⋯, k. the unknown fragment length distribution f can be estimated from r . note that the sample index  of pk  is also ignored in the above discussion.

iuta’s likelihood function is similar to the likelihood function in miso  <cit> , with three main differences. first, miso defines pk differently than iuta does, using  where μ is the mean of the empirical fragment length distribution f’ that is obtained by mapping all paired-end reads to long constitutive 3′ utrs . second, miso uses a discrete normal distribution  in the place of f while we estimate f from the analyzed rna-seq sample in a completely different way . finally, iuta and miso calculate p differently: iuta uses  while miso uses , where m is the number of “mappable positions” defined to reflect an overhang restriction when a read straddles a splice junction.

to find the maximum likelihood estimates  of θ, we first use an expectation-maximization  algorithm to find the mle of p, denoted , based on the likelihood function l . we then calculate the mles of θ, denoted , from  where  . the details of the em algorithm, including the choice of the starting point of the algorithm, are provided in additional file  <dig> 

testing for differential isoform usage
let θi be the mean isoform usage  of the gene of interest in group i, where i =  <dig>   <dig>  we want to test:
  

using an isometric log-ratio  transformation  <cit> , a distance-preserving one-to-one mapping from the open simplex  with aitchison geometry to the real space ℝk −  <dig> with euclidean geometry, we can test the equivalent hypotheses:
  

the ilr transformation allows us to honor the aitchison geometry on the simplex when carrying out statistical calculations in familiar euclidean space. details of the aitchison geometry and the ilr transformation are provided in additional file  <dig> 

we take a hierarchical approach to deriving a probability model for a sample-specific isoform usage estimate , the mle of the sample-specific mean isoform usage  in sample j of condition i . let  denote the random variable for sample-specific estimated isoform usage, whose observed value is . our hierarchical model specifies a first-stage distribution for  conditional on the sample-specific mean θij and a second-stage distribution for ilr conditional on the group-specific mean θi. this second stage of the hierarchy implicitly views the θij as random quantities that vary around a fixed group-specific mean θi.

more specifically, we assumed in the first stage of the hierarchy that the distribution of , after ilr- transformation, has a normal distribution on ℝk − 1
 <cit>  centered at ilr with variance-covariance matrix Υij, that is,
  <dig>  

where  denotes the multivariate normal distribution in ℝk −  <dig>  we require that  lie in the open simplex, i.e., that all relative abundances are positive so that the ilr transformation is applicable. to satisfy the requirement, if an isoform’s relative abundance is estimated as zero in some, but not all, samples, iuta replaces values estimated as zero with a small positive value . if an isoform’s relative abundance values are estimated as zero in all samples of both groups, then that isoform is excluded from consideration in the testing stage. the variance-covariance matrix Υij can vary across samples in the same group because read coverage may differ among samples. for the second stage of the hierarchy, we assumed that each sample-specific mean θij for 1 ≤ j ≤ ji, after ilr- transformation, arises independently from a normal distribution on ℝk −  <dig> centered at ilr with variance-covariance matrix Σi, that is,
  <dig>  

similar to the first stage, we require that θij lie in the open simplex. also note that the model allows each condition to have a distinct variance-covariance matrix Σi. combining equations  and , gives the marginal probability model for sample-specific estimated isoform usage :
  

we simplified this model somewhat in our testing procedures by proceeding as though Υij = Υi for 1 ≤ j ≤ ji. although this simplifying assumption is arbitrary, a simulation study showed that iuta is robust to moderate departures from it . consequently, the statistical tests implemented in iuta assume that all samples within group i have a common marginal variance-covariance matrix, Σi + Υi, that differs between groups.

thus, under our assumptions, testing h0’ versus h1’ is a test of whether two multivariate normal distributions have equal mean vectors when they have different variance-covariance matrices. in the statistical literature, this problem is called the multivariate behrens-fisher problem. we employed the skk  <cit> , cq  <cit>  and ky test  <cit>  to test for h0’ versus h1’. details are provided in additional file  <dig>  notice that when k =  <dig>  the ky test becomes the welch’s t-test  <cit> . in implementing these tests, iuta employs the observed values of  from each group to empirically estimate the group-specific variance-covariance matrix Σi + Υi for each group i. the ky test requires that the estimate of Σi + Υi be positive definite for each group; but the skk and cq tests do not, though their critical values are justified using large-sample theory. these latter two tests are appropriate for situations where the number of isoforms in a group is greater than the number of samples in the group. consequently, iuta can in principle accommodate genes with any number of isoforms provided there are at least two samples per group .

simulations
we performed three simulation studies. the first one aimed at two goals: 1) to compare the three tests  implemented in iuta, and 2) to compare iuta  with cuffdiff <dig> . the second simulation studied the robustness of iuta to the violation of the constant variance-covariance assumption that Υij = Υi for 1 ≤ j ≤ ji. we induced differences in Υij among samples by simulating differences in read coverage among samples. the third aimed to assess further the robustness of iuta to differences of read coverage among samples.

in the first two simulation studies, we selected  <dig>  mouse genes with number of isoforms between two and ten from the ucsc known mouse genes  annotation  <cit> . in the last simulation study, we randomly selected five genes  with  <dig>   <dig>   <dig>   <dig> and  <dig> isoforms, respectively, and then two additional genes , both with  <dig> isoforms. details of gene selection are provided in additional file  <dig> 

in the first two simulation studies, we divided the  <dig>  genes into two sets . using each set of genes, we simulated  <dig> rna-seq alignment datasets  in bam format . the average read coverage for each gene in the first simulation study was  <dig>  and the average read coverage for each gene in the second simulation study varied among the samples  in each group. in the last simulation study, we chose six different levels of read coverage . at each read-coverage level, we carried out  <dig>  in silico experiments for each gene. in each of the  <dig> experiments, we also simulated  <dig> rna-seq alignment datasets .

the parameters Σ <dig> and Σ <dig> used in the simulation studies for the  <dig>  genes were obtained from cufflinks analysis of  <dig> mouse placenta rna-seq data sets   provided by perry blackshear . the details of all simulations are provided in additional file  <dig> 

RESULTS
comparison among three different tests in iuta
our simulation study demonstrated that the skk test and cq test performed comparably and both outperformed the ky test . as the ky test is only applicable when the dimension of the data is less than the sample sizes, we used the skk test for all subsequent analyses.

performance comparison between iuta and cuffdiff2
we also used the above simulated datasets to compare the performance between iuta and cuffdiff <dig>  out of the  <dig>   mouse mm <dig> ucsc known genes  <cit> , iuta was able to analyze all of them for differential isoform usage. in comparison, cuffdiff <dig> could only analyze  <dig> . cuffdiff <dig> was unable to analyze the other  <dig>  genes for two reasons. first and foremost, cuffdiff <dig> is designed specifically to test differential isoform usage for a given transcription start site . nearly half of the genes  contained isoforms with different tsss, thus, cuffdiff <dig> eliminated those genes from testing. second, cuffdiff <dig> is not well suited for testing genes whose isoform structures are similar. even with the average reads coverage of  <dig> used in our simulation, cuffdiff <dig> declared that  <dig> of the  <dig>  did not have enough alignments for testing. for the  <dig>  genes that both iuta and cuffdiff <dig> analyzed, iuta outperformed cuffdiff <dig> .figure  <dig> 
performance comparison between iuta and cuffdiff <dig> using simulated data. receiver operating characteristic  curves based on the  <dig> mouse genes that can be tested by both cuffdiff <dig> and iuta. false positive rate  and true positive rates  were computed by varying the p-value cutoffs.



robustness of iuta to a constant variance-covariance assumption
to see how iuta performed when the constant variance-covariance assumption that Υij = Υi for 1 ≤ j ≤ ji  is violated, we repeated the same simulations as above but varied the read coverage among the five samples of each group for each gene , as this variation in coverage would induce variation in the precision with which isoform usage was estimated in each sample. the roc curves for iuta  were nearly identical to those in figure  <dig>  again, the skk and cq tests performed comparably and both outperformed the ky test. with smaller coverage per sample than in the previous simulation, cuffdiff <dig> could analyze only  <dig>  of the  <dig>  genes that iuta analyzed. as before, for the genes both tools could analyze, iuta performed slightly better than cuffdiff <dig>  those results demonstrated that iuta is robust to the violation of the constant variance-covariance assumption.

robustness of iuta to the depth of read coverage
for seven genes , we chose six different levels of average read coverage, namely,  <dig>   <dig>   <dig>   <dig>   <dig>  and  <dig>  and carried out  <dig>  simulations at each read-coverage level. we ran iuta on the  <dig>  datasets . type-i error rate and power were computed based on the nominal α level  <dig> . as shown in table  <dig>  the type-i error rate and power were consistent across the different levels of read coverage for each gene, except for bptf, a gene with five isoforms, two of which  contain  <dig> long exons and are highly similar. among the three genes  with eight isoforms, iuta had the smallest power for stab <dig>  a long gene  with  <dig> exons for which the eight isoforms have many exons in common. for the other two genes  with eight isoforms but with fewer exons in common, iuta showed higher power. therefore, we concluded that the read coverage had little effect the performance, but the isoform structure mattered.table  <dig> 
empirical type i error rate  of iuta_skk at nominal type i error rate  <dig>  for various levels of read coverage for a selection of genes



zfp407

loxl2

bptf

pde4dip

dido1

ifi203

stab2


inspection of table  <dig> revealed a troubling feature of iuta_skk: although the tests were performed at nominal α level  <dig> , the empirical type i error rate  was larger than  <dig>  for almost every simulated data set. iuta_cq, but not iuta_ky, showed the same failure to maintain the correct type i error rate . although we had not included cuffdiff <dig> in this simulation originally, we now undertook a similar simulation study to compare iuta and cuffdiff <dig> with respect to type i error rates. we selected three genes , each had  <dig> isoforms sharing the same transcript start site. we considered two different levels of read coverage . for each gene at each read-coverage, we simulated  <dig> data sets with  <dig> replicates in each of the two groups under the null hypothesis that both groups had the same isoform usage. the empirical type i error rates for all three tests  were larger than nominal  <dig>  . we conclude that both cuffdiff <dig> and iuta fail to control the type i error rate at the nominal level.table  <dig> 
empirical type i error rates at nominal type i error rate  <dig>  for three tests at two levels of read-coverage for three genes



dhx9

mr1

trim11


taken together, our simulation studies demonstrated that iuta performed better than cuffdiff <dig> for genes that both could analyze and was able to analyze more genes than cuffdiff <dig>  iuta was robust to the read coverage, but both iuta and cuffdiff <dig> failed to maintain the nominal type i error rate. iuta was more powerful for genes whose isoforms have fewer exons in common than for genes with many exons in common.

applications of both iuta and cuffdiff <dig> to real rna-seq datasets from mouse tissues
we applied iuta to  <dig> rna-seq datasets from the mouse genomes project at the wellcome trust sanger institute . these datasets consist of six biological replicates from each of six mouse tissues .

we first aligned the sequence reads to the mouse  refgene gene models using tophat   <cit> . next, we carried out all  <dig> pair-wise comparisons between any two tissues using iuta. in each comparison, we estimated the isoform usage in each sample, gene by gene, and then tested for differential isoform usage while controlling the family-wise error rate  at  <dig>  with the bonferroni correction. the numbers of genes with statistically significant differential isoform usage are listed in table  <dig> with their official gene symbols provided in additional file  <dig>  the smallest number of genes with differential isoform usage was from the comparison between spleen and heart whereas the highest number was from the comparison between thymus and hippocampus. in total, iuta identified  <dig>  genes with differential isoform usage in at least one comparison. estimated isoform usage in all six tissues and the pair-wise comparison results  for all genes tested are provided in additional file  <dig> table  <dig> 
the number of genes with statistically significant differential isoform usage between pairs of mouse tissues




next, we searched for genes with tissue specific isoform usage. specifically, we searched for genes whose isoform usage was significantly different in all comparisons between a given tissue and remaining five tissues but non-significant in every comparison that did not involve the given tissue. forty-six such genes were identified .table  <dig> 
genes with significant tissue-specific isoform usages from  <dig> pair-wise comparisons among six tissues


abi <dig>  arfgap <dig>  camta <dig>  dctn <dig>  dctn <dig>  eef1d, eif4g <dig>  ltbp <dig>  nelf, nqo <dig>  pxk, tecr, mon <dig>  traf <dig>  faim, parp <dig>  gopc, eya <dig>  1110021j02rik, nt5c <dig>  cadm <dig>  camkk <dig>  fchsd <dig>  gnal, ptprs, wdr <dig>  morf4l2
naca
mxi <dig>  psen <dig>  ptpn <dig>  bdh <dig>  nmi, tomm <dig>  efemp <dig>  ythdf <dig>  slc6a <dig>  masp <dig>  il <dig>  stat5b, timm <dig>  alkbh7
cttnbp2nl, c1qtnf5
fam149b


one such gene is pxk, which has two isoforms  . pxk, also known as monaka, encodes for the px domain containing serine/threonine kinase. monaka has been suggested to modulate brain nak-atpase and may thereby participate in the regulation of electrical excitability and synaptic transmission  <cit> . iuta estimated that nm_ <dig> was predominantly expressed in hippocampus whereas nm_ <dig> was predominantly expressed in the other five tissues. isoform nm_ <dig> has a unique exon . another example is eef1d , iuta estimated that nm_ <dig> has a large relative abundance in hippocampus and has a relative abundance almost  <dig> in each of the other  <dig> tissues.figure  <dig> 
visualization of differential isoform usage for
pxk
across the six mouse tissues.  pie plot representations of tissue-specific isoform usage;  observed rna-seq read coverage .
visualization of differential isoform usage for
eef1d
across the six mouse tissues.  pie plot representations of tissue-specific isoform usage;  observed rna-seq read coverage .



finally, we applied cuffdiff <dig> on the liver and spleen data and compared its performance to that of iuta. the cuffdiff <dig> was also run using the mouse refseq gene models. for this data , both tools run fast, though cuffdiff <dig> was faster .

among the  <dig> mouse genes with more than one isoform and the same transcription start site  for all isoforms, iuta was able to assess statistical significance of isoform usage difference for  <dig> genes whereas cuffdiff <dig> was able to do  <dig> genes given the rna-seq data, of which  <dig> genes were common between the two tools. iuta detected more significant genes than cuffdiff <dig> did under the same nominal false discovery rate : specifically, cuffdiff <dig> reported  <dig> significant genes whereas iuta identified  <dig> significant genes, among which  <dig> were in common. visual examination of the isoform usage plots of the genes declared significant by iuta but not by cuffdiff <dig> suggests that the iuta significant genes are credible. a good example is the cd <dig> gene . mouse cd <dig> gene has two isoforms. the relative proportion of isoform nm_ <dig> is higher in liver than in spleen, as supported by the read coverage plot . the unique  exon in nm_ <dig> has higher relative read coverage in liver than in spleen, whereas the read coverage on the common exons appears to be similar among the samples. although cuffdiff <dig> also gave a small p-value , it failed to reach significance after adjusting for false discovery rate . it is worth pointing out that both iuta and cuffdiff <dig> gave similar isoform usage estimates for this gene. the estimates from iuta are  in liver and  in spleen, whereas those from cuffdiff <dig> are  in liver and  in spleen, respectively. estimates of isoform usage were often similar between iuta and cuffdiff <dig> even when they differed in declaring a gene to have differential isoform usage between tissues.figure  <dig> 
visualization of differential isoform usage for
cd74
in the mouse liver and spleen tissues.  pie plot representations of tissue-specific isoform usage;  observed rna-seq reads coverage .



discussion
recent advances in next-generation sequencing technologies enable rapid profiling of the entire transcriptome. methods for identifying differentially expressed genes from rna-seq data have been developed, either at the gene level or transcript level. less attention has been paid, however, to the development of robust and general methods for identifying differential isoform usage . detecting differential isoform usage is different from detecting differential isoform expression, which aims to detect the difference of expression level between two conditions for each individual isoform of each gene. for the latter problem, many excellent tools have been proposed such as miso  <cit> , bitseq  <cit> , and ebseq  <cit> . among methods for the former problem, cuffdiff <dig> has gained recognition as the best available tool. our proposed method, iuta, which explicitly makes use of the compositional nature of isoform-usage estimates, offers some advantages compared to the recent completely overhauled version of cuffdiff <dig> . because miso, bitseq, and ebseq are designed for testing a statistically different hypothesis than cuffdiff <dig> and iuta, we did not include the former methods in our simulations.

using alignments from paired-end reads and a known isoform structure, iuta first estimates the isoform usage for each gene in each sample from each group and then uses those estimates to test for differential isoform usage between two groups. because isoform usage is a type of compositional data, i.e., vector of all relative proportions of the whole, aitchison geometry is more suitable than euclidean geometry. aitchison geometry implicitly respects the bounded sample space induced by the isoform usage vector’s summing to one, and its distance metric is fundamentally related to fold-change. thus, iuta formulates the problem of testing for differential isoform usage under aitchison geometry and is, to our knowledge, the first approach to do so.

one aspect of the aitchison geometry can be problematic, however. two proportions for the same isoform in different conditions that are both quite small but differ by orders of magnitude  sometimes have a strong influence on conclusions. even though distinguishing such small values is beyond the ability current technology, estimates of isoform usage occasionally contain them. through the simulation and real data studies, we found that genes with one or more isoforms having near-zero usage in both conditions were often declared to have statistically significant differential usage even when the other entries of the isoform-usage vector were quite similar. to deal with this issue of near-zero estimated usage for some isoforms, iuta replaces those values, together with sporadic estimated zeros, by a user-specified small positive value  to facilitate the testing procedure. setting an even larger value such as  <dig>  would ensure that the top-ranked significant genes are those with a large change in their isoform usages. the user can investigate whether near-zero values are influencing conclusions by seeing whether changes in this tuning parameter impact which genes iuta declares as having differential isoform usage. this ability represents a practical approach to a knotty problem in compositional data analysis.

a distressing feature of both iuta and cuffdiff <dig> was their failure to maintain the nominal type i error rate – both rejected the null hypothesis too often when it was true. because procedures for controlling false discovery rate rely on p values from individual tests, a set of genes declared to have differential isoform usage at a false discovery rate of, say,  <dig>  will actually represent a larger, perhaps much larger, false discovery rate when using these two procedures. the most likely reason for the failure of iuta to control the type i error rate is that the validity of its tests’ p values is justified theoretically for large numbers of replicate samples but not for the few replicate samples used in studies of isoform usage. we believe that this issue is likely widespread among genome-wide tests that based on only a few replicate samples. we found it true of cuffdiff <dig> also. because many comparisons among competing procedures are based on roc curves, the failure to properly control type i error rate or false discovery rate may not be noticed by those developing methods -- as almost happened to us.

an ideal solution to the failure to control type i error rates in isoform usage testing is elusive. though much larger numbers of samples in each group would ameliorate the problem, the cost of experiments would be prohibitive. permutation testing is another option. although we found that a permutation approach for the tests iuta_skk and iuta_cq helped to maintain the nominal type i error rate , the minimum possible p values for permutation tests with few samples can be too large to reach statistical significance after fdr or other genome-wide multiple-comparison adjustment. maintaining the correct type i error rates will remain a challenge whenever inferences must be based on a relatively small number of replicate samples.

iuta has several advantages over existing tools: first, iuta directly incorporates the uncertainty of the underlying dna fragments corresponding to the paired-end reads into the rna-seq data model when estimating the isoform usage. second, iuta utilizes all paired-end reads that are mapped to a gene, not only those that are mapped to the unique regions of a gene, to test for significance. third, iuta takes into consideration biological variation between by requiring biological replicates and accommodates technical replicates by combining all technical replicates for a given biological replicate into a single data set. lastly, for each gene, iuta provides not only the p-value for differential isoform usage for each gene but also the estimate of isoform usage for each gene in each sample.

we evaluated iuta’s performance through simulation studies in comparison to cuffdiff <dig>  cuffdiff <dig> was designed to test either if alternative tsss are differentially used  between groups of samples or if, for genes with a unique tss, alternative splicing events occur between two groups of samples. thus, for testing differential isoform usage, cuffdiff <dig> is limited to genes with all isoforms resulting from the same pre-mrna, i.e., sharing the same tss. in contrast, iuta is applicable to all genes with at least two isoforms regardless of their tss. consequently, iuta can test many more genes differential isoform usage than can cuffdiff <dig> for the same data. moreover, we showed that iuta performed better than cuffdiff <dig> for the subset of genes cuffdiff <dig> could analyze. iuta is programmed in r which has the advantage of code that is easily modified and integrated with other tools, such as those available through bioconductor but has disadvantages in processing speed compared to other languages.

when applied to the tissue transcriptome data from the mouse genomes project from the wellcome trust sanger institute, iuta identified  <dig>  genes with differential isoform usage between any two given tissues and  <dig> genes with tissue-specific isoform usage. we believe that our analysis results are the first systematic catalogue of differential isoform usage between the six mouse tissues. we examined a few of those genes and found literature support. although the functional relevance for many of those genes remains unknown, we believe that the analysis results that we provide in additional files  <dig> and  <dig> for those tissues/cell lines will be useful to those interested in alternative splicing. of course, all results based on computational tools like iuta and cuffdiff <dig> should be confirmed in the laboratory.

CONCLUSIONS
iuta, conveniently implemented in an r package, is unique among tools for genome-wide estimation and testing of isoform usage in that it utilizes contemporary statistical techniques for compositional data.

though the development of computational/statistical methods for genome-wide analysis of alternative splicing is in its early stages, consortiums like tcga are generating large numbers of rna-seq datasets that could be used to probe isoform usage. we expect that new computational methods like ours will catalyse routine genome-wide analysis of alternative splicing, making it as commonplace as genome-wide analysis of gene expression.

electronic supplementary material
additional file 1:
iuta_supplementary_material. this pdf file contains all supplementary notes and supplementary figures. 

 additional file 2:
differential_iu_genes. this excel file lists all genes identified by iuta as exhibiting differential isoform usage between any two of the six mouse tissues. the rna-seq data sets were from the mouse genomes project at the wellcome trust sanger institute . the file contains  <dig> columns , the genes identified as having differential isoform usage between two tissues are listed under the column corresponding to those two tissues. the fwer is controlled at  <dig>  by bonferroni correction for each comparison. 

 additional file 3:
iu_all_mouse_genes. this excel file lists the p-values for all the genes that were analyzed by iuta during the  <dig> pair-wise comparisons between any two of the six mouse tissues. the rna-seq data sets were from the mouse genomes project at the wellcome trust sanger institute . the file contains  <dig> columns . 

 competing interests

the authors declare that they have no competing interests.

authors’ contributions

ln, wh and dmu developed the method. ln made the initial draft and implemented the software. ln, wh, dmu and ll were all involved in study design, planning, analyses, and the interpretation of results. ln, wh, dmu and ll all contributed to writing and revising the manuscript. all authors read and approved the final manuscript.

