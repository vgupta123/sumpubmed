BACKGROUND
since the pioneering work of arnheim et al. in  <dig>  <cit> , the analysis of pooled dna samples has undergone extensive development over the past two decades  <cit> . the main applications of pooled dna techniques in genomic/genetic studies include association mapping  <cit> , polymorphism identification/validation  <cit> , genetic diversity  <cit>  and mutation detection  <cit> . the millennium revolution of the pooled dna technique was its integration with microarrays  <cit> , and the performance of which has been examined broadly  <cit> . this new-generation biotechnique significantly decreases the cost of large-scale genomic/genetic studies; for example, costs due to typing numerous dna samples are reduced by pooling genomic dna, and expenses related to primers and assay kits are reduced by using microarray genotyping. therefore, microarray-based pooled dna provides a cost-saving and valuable avenue for deciphering the mysteries of the human genome.

analysis of high-density genome-wide pooled dna data involves a series of sophisticated procedures that require simultaneous and extensive data processing, statistical estimation and hypothesis testing. the data attributes/structures become more complicated and the computational complexity increases significantly when compared to a candidate-region or low-resolution genetic analysis. the urgent demand for efficient, publicly available software has motivated us to develop the shared software, microarray pooled dna analyzer , which enables elaborate genome-wide pooled dna analysis. the major functions of mpda include data processing , statistical estimation , and gene mapping . graphical and numerical outputs provide for global and detailed inspection of the human genome. figure  <dig> presents the analysis framework of mpda.

mpda implements association analysis  <cit>  and allelic imbalance analysis  <cit>  based on a generalized concept of pooled dna, of which there are two types in this study. the first is a "population-level " dna pool, which is constructed by mixing genomic dna from different subjects. this pool is formed by laboratory work and reflects interindividual variations in dna. the second type, an "individual-level " dna pool, is contributed by a single subject. this dna pool is formed naturally and reflects intercell variations in dna. the artificial dna pool concept is used to construct association analyses, whereas the natural dna pool concept is used to develop allelic imbalance analyses.

implementation
software and interface
mpda was developed based on matlab® software and adapted to ms windows® 98/me/nt/2000/xp/ <dig>  mpda provides a user-friendly interface created using the matlab® graphic user interface . users can easily analyze their data by merely checking the option boxes in the mpda interface. for users working on machines without installing matlab® software, we also developed stand-alone executables generated via the matlab® compiler. moreover, two data examples reported in this paper are included in the mpda software to demonstrate its functionalities and data input formats. the details on statistical methods and operation procedures can be found in the mpda user manual. the software, user manual and additional data examples are available online at the mpda website.

genetic typing experiments and data format
all the genotyping experiments were performed with leukocyte dna using the affymetrix genechip human mapping  <dig> k set  that contains  <dig>  single nucleotide polymorphisms  with a median intermarker distance of  <dig>  kb and 92% genome coverage within  <dig> kb of a snp  <cit> . oligonucleotide probes for the snps were tiled on two arrays, xba and hind chips. leukocyte genomic dna was isolated using the puregene genomic dna purification kit . the dna concentration was quantified using a nanodrop nd- <dig> spectrophotometer . for individual genotyping experiments, a total of  <dig> ng of genomic dna with concentration at  <dig> ng/μl was used. for allelotyping of dna pools, a total of  <dig> ng of mixed genomic dna with an equal amount of dna from each selected individual was used. genotyping of each individual  or allelotyping each experimental dna pool  was performed according to the genechip mapping assay protocol. the assay details can be obtained from the affymetrix genechip mapping  <dig> k assay manual  <cit> . for each snp, the implanted genotyping analysis tool, genechip® dna analysis software version  <dig> , provided intensity data for the five best quartet pairs. each quartet pair contained sense-strand and antisense-strand probe quartets, and each probe quartet consisted of perfect-match and mismatch probe cells for two different alleles.

feature extraction
for feature extraction from intensity data, mpda calculated the relative allele signal  of each snp for each subject. the average of the mismatch intensities of a pair of alleles were subtracted from the perfect match intensities to adjust background noise and yield an adjusted intensity. the adjusted intensity of an allele was divided by the sum of adjusted intensities from an allele pair to calculate a relative proportion for a strand under each quartet. medians of the relative proportions over five quartets were calculated for sense and antisense strands respectively, and the two medians were averaged to yield the composite ras . the cras measure was a basic element of subsequent analyses.

to evaluate the quality of snp data, mpda calculated a discrimination signal  for each snp for each subject. for each probe pair, the sum of perfect match and mismatch intensities was divided by the difference between perfect match and mismatch intensities to yield a ds value. for each allele and probe cell, the median of ds values over five probe quartets was taken as the median ds value . a min-max criterion, which picked the minimum mds over two probe cells for each allele and then took the maximum from the two minimums, was used to calculate the final ds  value for each snp for each subject. the fds can serve as an index of genotyping quality–the higher the index fds, the better the genotyping quality of the snp. for a good-quality snp, an fds of >  <dig> % was suggested by the modified partitioning around medoids  mapping algorithm in the affymetrix genechip dna analysis software user's guide.

whole-genome cpa analysis
mpda estimates the whole-genome cpa and the corresponding standard error. for any given snp, subjects who were genotyped individually and were heterozygous with respect to the snp were selected. their hybridization intensities were transformed into cras as described in feature extraction. the cras pairs were collected and used to estimate cpa according to the arithmetic mean  <cit> , geometric mean, and bias-correction cpa  <cit> . the corresponding standard error was calculated via a resampling procedure with an underlying model that the cras followed a beta distribution  <cit> . the detailed statistical formulae can also be found in appendix a in the mpda user manual.

mpda provides several options of data types for the calculation of cpa. firstly, affymetrix users can select chromosomes of interest and provide hybridization intensity data of  <dig> k or  <dig> k to calculate cpa. secondly, users who apply an existing cpa database can provide their own cpas or use two cpa reference datasets provided by mpda. thirdly, non-affymetrix users can input pairs of peak intensities from different platforms, such as the matrix-assisted laser desorption/ionization time-of-flight  and the illumina humanhap <dig> genotyping beadchip. if users want to calculate standard error of the cpa estimate, they should enter the number of bootstrap replications into mpda.

whole-genome af estimation
mpda estimates afs in regards to a population-level dna pool  or an individual-level dna pool . hybridization intensity data of dna pools were transformed into cras as described in feature extraction. given a snp, cras were unadjusted estimates of afs in dna pools. to adjust preferential amplification/hybridization of alleles, the estimated cpa was multiplied by the cras of the second allele to amplify  the suppressed  cras. the new cras of the second allele replaced the original cras used in calculating the unadjusted af to estimate the adjusted af. the variance of the unadjusted af estimate was calculated based on binomial sampling variation; the variance of the estimated adjusted af included extra variation due to cpa calibration  <cit>  and experimental error  <cit> . mpda allows users to input affymetrix-format hybridization intensity data or non-affymetrix-format intensity pair data to estimate afs. the detailed statistical formulae for af estimates and their standard errors can be found in appendix b in the mpda user manual.

whole-genome association analysis
mpda provides whole-genome single- and multi-locus association tests to screen loci susceptible to traits of interest based on population-level dna pools , where cpa calibration is properly incorporated into the af estimates and association tests . for single-locus association tests, differences of adjusted af estimates of two groups are calculated, and the af differences are divided by the corresponding standard error of the af difference to construct the test statistics. mpda provides two test statistics: one assumes a common cpa between two groups whereas the other does not. mpda requires users to input the experimental error while performing the test. for multilocus association tests, the sliding-window empirical p-value test  statistics are used, which are composite scores of a series of p-values from single-locus association tests  <cit> . the single-locus p-value can come from either the mpda single-locus association test or user-specified p-value data. users also must select weight functions, truncation thresholds, window sizes, and three swept statistics, i.e., the multiplicative-effect swept, additive-effect swept and minimum swept. mpda calculates an empirical p-value of the swept statistic based on a monte carlo procedure. the number of monte carlo replications should be provided while conducting the test. the detailed statistical formulae for single-point and multipoint association tests can be found in appendix c in the mpda user manual.

whole-genome allelic imbalance analysis
mpda provides an innovative whole-genome allelic imbalance analysis to identify regions of chromosomal aberration based on individual-level dna pools , where cpa calibration is incorporated into the af estimates and allelic imbalance analysis . a snp has alternate alleles m and n. theoretically, for each natural dna pool that is diploid, the af of allele m should be  <dig>   <dig>  or  <dig> with respect to  <dig>   <dig>  or  <dig> copies of allele m. deviations from the standards are called allelic imbalance and suggest chromosomal aberration.

we first introduce the single-locus allelic imbalance analysis. we estimated afs for each of the healthy controls following a similar procedure for af estimation as described in whole-genome af estimation, where the role of an artificial dna pool was replaced by a natural dna pool. we used the estimated afs to establish standards representing a control population free from chromosomal aberrations, described as follows. for each snp, we calculated the mean and prediction error of af estimates, , under each of three genotypes {uv, uv ∈ } and then constructed the corresponding prediction bands by μ^uv±η⋅σ^uv, where η is a critical level for determining statistical significance. next, we estimated afs for each patient sample following the same procedure for unaffected samples. we checked whether the estimated af of the patient was located within one of the three prediction bands constructed from an unaffected population. if the estimated af of a snp was outside of the three prediction bands, then the snp was identified as an allelic imbalance point.

next, we introduce the multilocus allelic imbalance analysis. there are two statistics for this purpose. the first statistic is called score <dig>  which is used to detect allelic imbalance regions based on the results of the single-locus allelic imbalance analysis. positive scores are assigned to significant snps  and negative scores are assigned to non-significant snps . scores for snp loci are accumulated from the starting snp on each chromosome. the cumulative sum score is called score <dig>  a significantly increasing trend in score <dig> implies that the region contains many snps with abnormal afs and is a potential chromosomal aberration region. the second statistic is called score <dig>  which focuses on detecting regions that contain a chromosomal segment with a low proportion of heterozygous snps. all snps are divided into heterozygous and non-heterozygous snps for each patient. if the estimated af of a snp is located within the prediction band μ^mn±η⋅σ^mn, then the snp is classified as a heterozygous snp; otherwise, it is classified as a non-heterozygous snp. negative scores are assigned to heterozygous snps and positive scores are assigned to non-heterozygous snps. scores for snp loci are accumulated from the starting snp on each chromosome. this cumulative sum score is called score <dig>  the detailed statistical formulae for single-point and multipoint allelic imbalance analyses can be found in appendix d in the mpda user manual.

RESULTS
whole-genome cpa analysis
preferential amplification/hybridization, which is quantified by cpa, is a major factor interfering with the estimation of af in pooled dna studies. cpa has been defined as a ratio of a pair of peak intensities  <cit>  and is related to the polymorphic nucleotide type and gc content of probes  <cit> . failure to adjust preferential amplification/hybridization may result in serious bias in af estimates thus leading to false conclusions in association mapping and allelic imbalance detection. therefore, investigation of the pattern of whole-genome preferential amplification/hybridization and provision of cost-free cpa databases for future calibration of af estimates in pooled dna studies are critical  <cit> . we used mpda to establish and update our cpa databases. in a new analysis, we individually genotyped  <dig> independent subjects recruited in our previous project "the taiwan han chinese cell and gene bank"  <cit>  using the affymetrix genechip human mapping  <dig> k set. subjects who were heterozygous with respect to snps from the  <dig> subjects were selected, and the hybridization peak intensities for both alleles from these individuals were extracted to estimate the pairs of cras and then estimate three cpas of snps across the human genome. the corresponding standard errors for the cpa estimates were calculated based on a beta-distributed bootstrapping procedure with  <dig>  replications .

mpda provides both graphic and numerical outputs of cpa estimates. figure  <dig> shows whole-genome scatter plots of the bias-corrected cpa estimates in log <dig> scale versus physical positions by chromosome. the gap on each chromosome represents the centromeric region; log <dig> >  <dig> indicates preferential amplification/hybridization of allele  <dig> over allele  <dig>  and vice versa for log <dig> <  <dig>  whereas log <dig> =  <dig> indicates no preference in this regard. numerical outputs showed that whole-genome mean, median, standard deviation, minimum and maximum of the estimated log <dig> were  <dig> ,  <dig> ,  <dig> , - <dig>  and  <dig>  respectively. the estimated cpas play important roles in subsequent analyses, including af estimation, association analysis and allelic imbalance analysis . calculations of genome-wide cpas for the constructed taiwanese-specific cpa database were finished within  <dig> hours using a pc with an intel pentium iv  <dig>  ghz processor and  <dig> gb ram. calculations of standard error for genome-wide cpas with  <dig>  bootstrap replications were finished within  <dig> hours.

in addition to the taiwanese-specific cpa database based on  <dig> taiwanese samples, we also constructed another cpa database that includes the  <dig> taiwanese samples as well as  <dig> african-americans,  <dig> caucasians, and  <dig> east asians from the human variation panel . the two cpa databases were then interfaced and included with the mpda software. as the aim of mpda is to provide a convenient tool for genome-wide genetic analysis, mpda not only has user-friendly interfaces but also provides several options for gathering cpa information. in addition to directly using one of the two mpda-provided databases, users can also input user-specified cpas or carry out cpa estimation based on the supplied intensity pair data. the cpa database is applicable to different studies because of high stability across laboratories and time . however, if users would like to construct their own database, parallel computations organized by chromosomes, carried out on multiple pc's, are recommended when the sample size is large.

whole-genome af estimation
to illustrate whole-genome af estimation of population-level pooled dna data using mpda, we carried out an allelotyping experiment based on the affymetrix genechip human mapping  <dig> k set. equal amounts of dna from  <dig> taiwanese samples were mixed to construct an artificial dna pool that was subjected to allelotyping using dna chips . a set of two arrays  was used to assay the dna pool. snps that had a call rate of < 90% in the individual genotyping data were excluded. the pairs of cras in the dna pool were calculated based on the original hybridization intensity data . following feature extraction, the cras pairs were used to calculate the unadjusted and adjusted af estimates by incorporating the taiwanese-specific cpa database provided in mpda. standard errors of the af estimates were also calculated. the analysis was executed under component  <dig> of mpda. to examine the accuracy of the af estimates from mpda, the true af was calculated by an allele counting approach using the individual genotyping data for all of the  <dig> study subjects involved in the artificial dna pool . we then compared the true af from the individual genotyping data with the unadjusted and adjusted af estimates from the pooled dna allelotyping data. the numerical results of the three types of afs are presented graphically in figure  <dig> 

the adjusted af estimates clearly outperformed the unadjusted estimates, verifying the importance of cpa calibration in af estimation. moreover, the adjusted af highly correlated with the true af , demonstrating that mpda can accurately estimate afs in pooled dna studies. the improvement of af estimation was observed on every chromosome. in this example, all calculations were finished within one minute. importantly, mpda provides two cpa reference datasets, so users can perform preferential amplification/hybridization for af estimation without collecting any individual genotyping data for cpa calculation, which greatly reduces the study cost and computational time for a pooled dna study. we also performed af estimation for individual-level pooled dna data, and examples are presented below .

whole-genome association mapping
to evaluate the performance of mpda with regard to whole-genome association mapping based on population-level hybridization intensity data using mpda, we performed allelotyping experiments with pool sizes of  <dig> and  <dig> individuals, respectively, using the affymetrix genechip human mapping  <dig> k set. samples in the two artificial dna pools were randomly drawn from the same taiwanese population. all samples were also genotyped individually. the true afs in the two dna pools were calculated . snps that had a call rate of < 90% or were non-polymorphic in the individual genotyping data were excluded. a set of two arrays  was used to assay the two dna pools, respectively. in each dna pool, mpda used the original hybridization intensity data  to calculate the adjusted af estimate of each snp locus by incorporating the taiwanese-specific cpa database provided in mpda. pooled dna single- and multi-locus association scans were then carried out to examine the difference in af distribution between the two dna pools . note that, cpa calibration should be applied to adjust for preferential amplification/hybridization, otherwise the true association may not be detected  <cit> .

genome-wide single-locus association tests were carried out based on modified chi-square statistics of common cpas, where binomial sampling error and cpa calibration error were calculated by mpda. an experimental standard error of  <dig>  was assigned; the standard error was derived from our previous experiments in which different pool sizes, multiple dna formation, and chip replications were taken into consideration  <cit> . the pooled dna single-locus p-values for snp markers were then calculated to provide a marginal effect of a single locus. we also conducted single-locus allele-based association tests based on individual genotyping data to evaluate the performance of the population-level pooled-dna association tests. figure  <dig> presents the bonferroni-type adjusted p-values in a -log <dig> scale across the human genome versus physical position by chromosome, where the raw  p-values were multiplied by the number of snps and then transformed to a -log <dig> scale. because the adjusted p-values may be greater than  <dig>  it was possible to get negative values after taking a -log <dig> transformation. under a test size of  <dig>  , results of whole-genome association mapping based on the data from pooled allelotyping and individual genotyping experiments were highly consistent except for a few loci. note that, it is always necessary to carefully examine genotyping quality and attributes of the identified snps in order to reduce the possibility of false positives. in this example, the significant snps on chromosomes  <dig>   <dig>   <dig> and  <dig>  which were identified by pooled allelotyping but not validated by individual genotyping, have either very low fds or minor af. this suggests that the statistical significance may be induced by measurement error. in this example, all calculations of single-locus association tests were finished within seven minutes.

we further carried out multilocus association tests. based on the series of single-locus p-values in the order of the snp physical positions provided by the annotation file of the affymetrix genechip human mapping  <dig> k set, we applied a multiplicative swept statistic with equal weight, a p-value truncation threshold of  <dig>  and a window size of  <dig>  the final empirical p-values versus ordered windows across the human genome were calculated by chromosome, based on  <dig>  monte carlo replications. none of the snps had significant af differences . because the two sample pools were from the same taiwanese population, it is not surprising that no significant snp loci should be identified by both association tests. the running time of mpda for multilocus association analysis depends on the number of monte carlo replications. in this example, all calculations of multilocus association analysis were finished within  <dig>  hours.

whole-genome allelic imbalance analysis
identification of chromosomal aberrations and allelic alterations, such as aneuploidy, gene amplification/duplication, gene deletion, and loss of heterozygosity , is an important way to identify genes involved in cancer and other diseases. for this purpose, mpda provides an efficient allelic imbalance analysis based on individual-level hybridization intensity data. the function is illustrated by an example aiming to identify aberrant chromosomal regions associated with acute lymphoblastic leukaemia . this example involves  <dig> all patients from our previous study  <cit>  and the  <dig> healthy controls used for cpa calculation. all samples were individually genotyped using the affymetrix genechip human mapping  <dig> k set. we carried out single- and multi-locus allelic imbalance analyses of the  <dig> patients . whole-genome afs for each healthy control were estimated with mpda, and the estimated afs were used to construct prediction bands for the genotypes nn, mn and mm. the whole-genome pattern of the estimated afs for a healthy control is shown in figure  <dig>  almost all af points are located within each of the three banded regions indicating allele m frequencies of  <dig>   <dig>  and  <dig>  which correspond to the genotypes nn, mn and mm, respectively.

the whole-genome afs of the  <dig> all cases were also estimated individually using mpda. moreover, for each patient, mpda carried out single-locus allelic imbalance analysis to detect snps with signals of allelic imbalance. for multilocus allelic imbalance analysis, we calculated the cumulative sum statistic score <dig> by assigning a value of + <dig> to each ai snp and a value of - <dig> to each nai snp, and we calculated score <dig> by assigning a value of - <dig> to each snp having an af corresponding to a heterozygous snp and a value of + <dig> to each snp having an af corresponding to a non-heterozygous snp. in this example, all calculations of whole-genome single-locus and multilocus allelic imbalance analyses for one patient were finished within  <dig>  minutes.

the relationship between allelic imbalance and dna copy number change was validated by real-time pcr . importantly, allelic imbalance analysis is able to reveal biological features associated with chromosomal aberration. for example, the tcrα/δ locus on 14q <dig> identified by mpda has been reported to be a frequently deleted region in all, partly due to somatic dna rearrangement during t-cell differentiation. interestingly, few snps on the allelic imbalance region in the three all patients showed normal afs corresponding to heterozygous genotype , suggesting existence of two copies of the corresponding dna segment. this implicates that dna rearrangement of vdj gene segments of the tcrα/δ locus rather than simple deletion, occurred in these all samples. two reference databases of af means and prediction errors derived from healthy controls are included in mpda, thus providing a free and time-saving resource for the detection of chromosomal/allelic aberrations in a target dna sample.

discussion
compared to individual genotyping data analysis, there is very limited access to free public software for population-based pooled dna analysis, and most of these focus on frequency estimation. for pooled dna single-locus analysis, poolfilter  <cit>  estimates af for microsatellite markers. for pooled dna multilocus analysis, the packages ldpooled  <cit> , ehp.r  <cit>  and pools <dig>  <cit>  use expectation-maximization algorithms to estimate haplotype frequency. however, the complicated computations lead to the restriction of small pool size and/or small number of markers in the analysis. none of these three packages allows automatic selection of snps involved in the haplotype analysis or contains a multilocus association test. although these methods have pioneered pooled dna multilocus analysis, these limitations restrict their application to practical whole-genome pooled dna analysis. for genome-wide microarray pooled dna data, emmuras.r  <cit>  is a collection of r-language functions that provides data pre-processing, including the calculations of discrimination score and ras. ppc  <cit>  is an algorithm that estimates af for the affymetrix genechip human mapping  <dig> k array. genepool is a recently published package  <cit>  that provides af estimation and association tests for microarray data. the major difference between genepool and mpda is that mpda provides both data analysis for natural dna pools as well as artificial dna pools, but genepool provides data analysis only for artificial dna pools. there are other programs that provide partial analysis for pooled dna data , but these have not been released for free public access. our previously developed pda  <cit>  provides single- and multi-locus association tests by analyzing peak intensity data from matrix-assisted laser desorption/ionization time-of-flight mass spectrometry  <cit> . pda also handles data from different genotyping platforms; however, it is not straightforward to use for whole-genome microarray pooled dna data analysis even though supplementary sophisticated data processing can be handled by users themselves.

in this paper we introduce mpda, which has a user-friendly interface and applications for studying two different types of pooled dna. the mpda extends the advantages and capabilities of existing software to provide an integrated analysis system for whole-genome microarray pooled dna studies. importantly, in addition to its functions of feature extraction, cpa estimation and af estimation, mpda is applicable to both population-level and individual-level dna pools and thus is a useful approach to systematically identify disease susceptible genes by detecting marker-trait association and aberrant chromosomal regions inferred from allelic imbalance. the proposed association analysis provides a reliable whole-genome screening method. the results help to dramatically reduce the number of study snps involved in the follow-up confirmation study and thereby reduce costs. the proposed analysis of allelic imbalance provides complementary and auxiliary information on chromosomal abnormalities for other detection approaches, such as copy number estimation  <cit> . for example, as illustrated in figure  <dig>  allelic imbalance analysis can detect a genomic aberrant region with copy-neutral loh, which can not be detected using copy number analysis. compared to the other software for pooled dna analysis, to our knowledge, mpda is the first software that integrates whole-genome pooled dna analysis and chromosomal aberration detection.

moreover, the allelic imbalance method can also be applied to monitor genotyping quality and identify copy number polymorphisms. we have applied this method to healthy controls who had been genotyped individually to check the patterns of the estimated afs. for example, as shown in figure  <dig>  the whole-genome afs of a healthy control showed an obviously abnormal pattern where a significant proportion of snps were located outside the three prediction bands  on most chromosomes. because no identifiable disease was reported for this individual during sample collection and due to the dispersed distribution of the snps with abnormal afs across the whole genome, this result strongly suggests that contamination with another genome occurred during dna preparation or genotyping procedures. in addition, our proposed allelic imbalance analysis is potentially useful to identify copy number polymorphisms, which are useful genetic markers for gene mapping and gene testing of microdeletion or microduplication disorders  <cit> . in addition to analyzing copy number polymorphisms using individual-level hybridization intensity data, we are also developing methods to validate/identify copy number polymorphisms based on population-level pooled dna data. polymorphism validation/identification using population-level pooled dna data is cost-saving and efficient for snps  <cit>  and other genetic polymorphisms  <cit> .

analyses in mpda rely on the provided reference databases of cpa and prediction bands from individual genotyping data. the methods are feasible only if the reference databases are stable and applicable to analyses performed in different laboratories and conditions. therefore, we evaluated the stability of cpa and af based on individual genotyping data from different laboratories and time as follows.  stability of cpa and af across laboratories: we calculated cpa based on individual genotyping data of our  <dig> taiwanese samples and  <dig> asian samples in the hapmap project, respectively. the pearson correlation coefficient between the two sets of cpas was  <dig> . in addition, the two sets of cpa were applied to adjust af in the example discussed in section whole-genome af estimation. the correlation coefficient between the two sets of af estimates was  <dig> . the high correlation coefficients demonstrate the stability of cpa and af estimation based on different reference data from different laboratories.  stabilities of cpa and af across genotyping time: we partitioned our  <dig> taiwanese samples into five subsets according to their genotyping time. the five subsets contained  <dig>   <dig>   <dig>   <dig> and  <dig> samples, respectively; the second subset was excluded from the analysis because of the small sample size. then we calculated cpas of the four subsets  in order. correlation coefficients of cpas from each pair of subsets were calculated. they were corr =  <dig> , corr =  <dig> , corr =  <dig> , corr =  <dig> , corr =  <dig> , and corr =  <dig> . in addition, the cpas from different subsets were applied to adjust the unadjusted afs in the example discussed in section whole-genome af estimation. the correlation coefficients between any pair of afs were  <dig> . the high correlation coefficients demonstrate the stability of cpa correction across genotyping time. we followed similar methods to investigate the stability of prediction bands, and high correlations of prediction bands across laboratories and time were observed. the results verified the stability of the mpda-provided databases.

we also evaluated the robustness of our allelic imbalance method. firstly, the assumption that a genome is diploid is inherent in most genotype calling algorithms  <cit> . deviation from diploidy causes genotype calling errors, thereby resulting in misleading conclusions in subsequent analysis  <cit> . this assumption is particularly impractical for genotyping dna from cancer cells, which usually have abnormal copy number for chromosomal segments. our approach avoids this problem by estimating afs for each snp of patients without requiring genotype information. secondly, all genotyping experiments fail to completely preclude biological noise and technical noise that are inherent in microarray data. for example, in figure  <dig>  the noise might have caused afs of a few snps from a healthy control sample to deviate from the expected value for a normal reference population. our method adjusts background noise during feature extraction and alleviates abnormal interference by incorporating multiple loci. even though noise is not completely eliminated, the results from real examples show high sensitivity and specificity in our association and allelic imbalance analyses. thirdly, although all the examples illustrated in this paper were based on the affymetrix genechip human mapping  <dig> k set, the methodology in mpda is general and also applied to genotyping arrays with higher marker density, such as the affymetrix genechip human mapping  <dig> k set. moreover, mpda not only accommodates the affymetrix gene chips but also the illumina bead chip genotyping platform by inputting pairs of normalized image intensities. users can follow the instruction in section  <dig> of the mpda user manual to prepare the input data.

CONCLUSIONS
in summary, we have developed a convenient tool, mpda, for whole-genome microarray-based pooled dna analysis. the four authentic data examples presented in this paper demonstrate the feasibility and important applications of mpda. the first analysis–based on genotyping data of  <dig> subjects–shows that mpda can be used to identify genomic patterns of preferential amplification/hybridization and provide important calibration information for pooled dna data analysis. the second analysis yielded a correlation coefficient of >  <dig>  between adjusted af estimates based on allelotyping data from a dna pool and true afs based on individual genotyping data of the samples, demonstrating that mpda can accurately estimate afs based on pooled dna data. the third analysis compares the results of two types of association mapping based on pooled allelotyping as well as individual genotyping data, and the results indicate that mpda is cost-effective and reliable for association mapping. the final analysis–based on genotyping data of  <dig> all patients–detected allelic imbalance in cancer genomes, indicating that mpda can identify regions of chromosomal aberration in cancer and other diseases. graphic and numerical outputs are simultaneously generated by mpda to support global and detailed inspection of large quantities of genomic data. all these features make mpda a useful tool for analyzing allelotyping/genotyping hybridization intensity data for various research interests.

availability and requirements
the mpda software, user manual and illustrated examples can be downloaded from the mpda website: .

project name: microarray pooled dna analysis project

project home page: 

operating system: ms windows®

programming language: matlab®

other requirements: no

license: mpda license

any restrictions to use by non-academics: on request and citation

list of abbreviations used
mpda: microarray pooled dna analyzer; dna: deoxyribonucleic acid; cpa: coefficient of preferential amplification; af: allele frequency; snp: single nucleotide polymorphism; ras: relative allele signal; cras: composite relative allele signal; ds: discrimination signal; mds: median discrimination signal; fds: final discrimination signal; swept: sliding-window empirical p-value test; loh: loss of heterozygosity; all: acute lymphoblastic leukaemia; ai: allelic imbalance; nai: non-allelic imbalance.

authors' contributions
hcy conceived the experimental designs, statistical methods, performed data analyses and prepared the manuscript. mch programmed the software. lhl contributed to the discussion and prepared the manuscript with hcy. chl constructed dna pools in the allelotyping experiments. alty and mbd provided dna samples for the all patients. lhl, jyw, ytc and csjf provided support for the genotyping and allelotyping experiments.

supplementary material
additional file 1
interface  <dig> of mpda. the welcome interface of mpda.

click here for file

 additional file 2
interface  <dig> of mpda. the interface to mpda association analysis.

click here for file

 additional file 3
interface  <dig> of mpda. the interface to mpda allelic imbalance analysis.

click here for file

 additional file 4
true afs in one group. results of the true afs from individual genotyping data for the  <dig> study subjects involved in the artificial dna pool.

click here for file

 additional file 5
true afs in two groups. results of the true afs from individual genotyping data for the  <dig> and  <dig> study subjects involved in the two artificial dna pools.

click here for file

 acknowledgements
we gratefully acknowledge the national clinical core and national genotyping center at academia sinica for providing dna samples and genotyping support. we also thank three anonymous reviewers for providing very insightful suggestions. this work was supported by a national science council grant of taiwan .
