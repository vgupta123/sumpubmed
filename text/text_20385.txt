BACKGROUND
advances in dna sequencing technology have expedited the rate at which new genomes are being sequenced. while this is a tremendous benefit for biology, this deluge of genome sequences presents new challenges for the management, distribution and analysis of data. new computational approaches are required to efficiently analyze biological data in a timely fashion.

genome sequences form the basis for our significantly improved understanding of the diversity of proteins. as genomes are sequenced, they reveal both new versions of known proteins, helping us to construct “families” of related but distinct proteins, as well as representatives of previously unknown protein families  <cit> . this is especially the case for microorganisms, as even very closely related taxa can have significant differences in protein families  <cit> . recent genomic  <cit>  and metagenomic  <cit>  analyses suggest that we have yet to discover a tremendous amount of the protein diversity that exists in nature.

protein family databases serve to define our knowledge of protein diversity. many protein family databases have been developed, including cogs  <cit> , uniprotkb/swiss-prot  <cit> , the kegg  <cit> , hamap  <cit> , figfams  <cit> , pfam  <cit> , tigrfam  <cit> , panther  <cit> , phylofacts  <cit> , protclustdb  <cit>  and eggnog  <cit> . protein databases differ in a variety of ways, including how protein families are defined, the phylogenetic diversity represented in the database, the method by which protein families are identified, and the format in which family data is encoded. these resources have proven to be critical components of genome and metagenome annotation  <cit> , evolutionary analysis , and community ecology . maintaining an up-to-date catalog of protein family diversity is important to the development of these research fields.

while these databases have been and remain useful resources for biological sequence analysis, they are generally not designed to be able to rapidly discover and accommodate new protein families that may be revealed through the sequencing of new genomes. for example, most databases invoke some amount of curation in the process of identifying families. curation improves the precision of data, but results in a bottleneck when processing new sequences. in addition, when updating their catalog of protein family diversity, many databases de novo cluster all sequences, including those that were previously identified as being members of a family. while this helps ensure optimal clustering of sequences into families, it can present substantial computational challenges in the face of ever-increasing amounts of data.

given the infrastructural challenges that result from increased rates of sequencing, we reasoned that an alternative protein family identification strategy might be warranted. with the goal of maximizing the coverage of protein family diversity, we developed a high-throughput procedure for identifying protein families that focuses on efficiency, automation, and updatability. specifically, we employ a fully automated method to cluster sequences into families using as much starting data as possible. this has the benefits of minimizing the curation bottleneck and producing families that are not biased towards historical artifacts, such as human-created labels that interfere with what the data supports. in-depth curation is left to researchers if a particular family is deemed relevant in a scientific analysis. additionally, we increase the ease of updating the database by decreasing the computational complexity associated with processing new data. this is accomplished by an iterative clustering procedure that uses previously identified families to sift out homologs of known families in new data. only the remaining sequences are then subject to de novo clustering to identify new families. this process gives rise to what we call “sifting families”, or sfams for short.

here, we outline our strategy for creating sfams in an automated manner given any set of protein sequences. we also describe a computational pipeline that executes this strategy and produces a database of  <dig>  sfams based upon sequences from  <dig>  genome sequences from all three domains of life . we demonstrate how sfams can be rapidly updated given new genomic data. we use sfams to annotate genomes and metagenomes by classifying sequences into sfams. we find that sfams cover most of the diversity in new genomes and recover a greater number of metagenomic homologs than alternative hmm-based protein family databases. our sfam identification software and database is publically available for download .

RESULTS
an iterative approach to defining protein families
we developed an easily implemented solution that generates families from protein sequences that exhibit global homology and allows for relatively rapid and regular updates as new genomes are sequenced . our procedure uses the markov clustering algorithm  with pairwise blastp percent sequence identity as a distance measure to group protein sequences into families. mcl is a fast and scalable unsupervised de novo clustering algorithm  <cit> . we build a mysql database that includes an alignment, a profile-hidden markov model , and a phylogenetic tree to describe the diversity of each family. these resources can be used for a variety of research problems, including annotating protein sequences according to similarity to the hmms and studying the relationships between protein families.

to update the families with new sequence data , we assign each new protein sequence to an existing family if it has high enough similarity to the family hmm . all sequences with no significant match in the current database are clustered with mcl to identify novel families, which we call sifting families . this process can be periodically repeated. our iterative strategy limits the number of sequences that need to be clustered at each update, enabling the de novo identification of large numbers of diverse protein families in a computationally feasible manner.

generating the sfam database
we applied our approach to a large collection of proteins from sequenced genomes. first, we initialized our database by downloading the december  <dig> snapshot of annotated genomes available in the jgi img database. this data set includes  <dig>  bacterial genomes,  <dig> archaeal genomes and  <dig> eukaryotic genomes. of the  <dig>  genomes in the first iteration of the database,  <dig> are finished genomes,  <dig> are draft assemblies and  <dig> are permanent drafts. there are  <dig> , <dig> annotated protein sequences associated with these genomes, which served as the input to our clustering workflow.

generating de novo protein families requires calculation of the similarity of each pair of proteins, a procedure that grows as a function of the square of the sequence database size. performing this calculation on over  <dig> million proteins requires significant time and memory. to reduce the computational complexity of this pairwise sequence-similarity search, we applied our iterative approach to sift through genomes and define protein families. we start with large, well-defined families and sequentially add in the remaining proteins. because the vast majority of the available sequence data is from bacteria and archaea  and because genomes from these groups have been selected for sequencing in a phylogenetically informative manner  <cit> , we limited our initial cluster analysis to  <dig>  proteins from  <dig> phylogenetically diverse representative bacterial and archaeal genomes . we clustered these proteins using mcl and identified  <dig>  protein families,  <dig> of which were present in at least 50% of the  <dig> representative genomes. these widely distributed families tend to be large, well studied, phylogenetically diverse, and well conserved across the bacteria and archaea . we built profile hmms of these families and used them with the hmmsearch algorithm to identify additional family members in the full set of ~ <dig> million proteins. we found that the  <dig> widely distributed families recruited  <dig> , <dig> sequences.

next, we subjected the remaining  <dig> , <dig> proteins to a pairwise similarity search, which took approximately  <dig>  cpu hours. we found that  <dig> , <dig> sequences exhibit significant similarity to at least one other sequence in the database. this similarity data was used as input into mcl to cluster sequences into sfams. prior to running mcl, we filtered this pairwise similarity data using alignment coverage to mitigate sequence length-dependent clustering biases and to ensure that all members of an sfam are global homologs. specifically, the pairwise alignment had to include at least 80% of both sequences or their similarity was set to  <dig>  applying mcl to this coverage-filtered data grouped the sequences into  <dig>  sfams. sfams ranged in size from  <dig> to  <dig>  members and are composed of global homologs. most sfams were small, suggesting that they are phylogenetically restricted or not well represented by the current sampling of genomes . the biological annotations that are enriched among the largest families reinforce the hypothesis of phylogenetic restriction; most appear to be relatively well-studied and involved in general cellular maintenance , dna polymerase iii , etc.) and are thus likely common to most genomes . however, some of the annotations that are enriched among large families appear to be more specific in their activity and are thus less likely to be found in most genomes , disease resistance protein , etc.). sfams with such annotations may have been subject to relatively large copy number expansions. future work will thoroughly explore the evolution of sfam size across the tree of life.

we then generated multiple sequence alignments, phylogenetic trees and hmms for each sfam. because large multiple sequence alignments can be prone to error  <cit> , we developed a method that selects diverse representative sequences from a family . representatives were used to generate a training alignment for those sfams with more than  <dig> members . all other family sequences were aligned to this training alignment before building hmms and phylogenies for these large families.

our iterative mcl clustering approach assigned  <dig> % of the proteins subject to clustering to an sfam. the remaining  <dig> , <dig> sequences are either orfans, misannotated sequences , or too diverged from the other family members for homology to be inferred via sequence comparison. notably, many of these sequences have significant local alignments to other sequences, suggesting that they may share common and promiscuous protein domains.

requiring high coverage identifies truncated and novel sequences
because we designed sfams to represent globally homologous proteins, the step in our workflow that calculates the similarity between every pair of sequences only does so if their alignment covers at least 80% of both sequences. as a result of this threshold,  <dig>  sequences were removed from the clustering analysis, many of which exhibited significant local pairwise alignments with other sequences. we characterized these filtered sequences by comparing them to each family’s hmm and analyzing the alignments.

we found that  <dig> % of the filtered sequences  display evidence of being relatively truncated  members of at least one family. specifically, these sequences have significant alignments with a relatively long hmm  and the alignment includes at least 80% of the filtered sequence. conversely,  <dig> %  of the sequences are longer than any of the hmms they significantly align with, suggesting that these sequences may have been subject to an evolutionary event  or annotation error that increased the sequence’s length. the remaining  <dig> % of the filtered sequences may represent novel protein families for which only a single member has been identified, or highly diverged members of other protein families.

sfam hmms can be used to accurately identify new family members
we evaluated the ability of each family’s hmm to recruit new family members by comparing the initial  <dig> , <dig> input protein sequences to each of the  <dig>  hmms. sequences were recruited into families if they could be globally aligned to a sfam’s hmm. we then used recall and precision metrics to estimate how well an hmm exclusively detects all members of the family it represents . for example, a recall equal to  <dig>  indicates that the hmm detected all of its family members, suggesting that the hmm accurately recruited members of the family and that the family members are generally global homologs of one another. a precision equal to  <dig>  indicates that the hmm only recovered its own family sequences, suggesting that the hmm differentiated family members from non-family members and that the family members are generally not homologs of members of other families.

the distribution of sfam precision values has a larger spread, indicating that a subset of sfams are derived from sequences that are not highly differentiated from each other. while approximately 58% of the families have a precision of  <dig>  , there is a long tail of lower-precision families. indeed, roughly 35% of the families  have a precision less than  <dig> . these families are enriched for several biological functions that are well distributed across the tree of life, frequently found in high copy number per genome, and often curated into superfamilies  in various protein family databases . these include various transport proteins , permease , secretin/tonb , etc.) and proteins involved in cytochrome assembly , cytochrome b/b <dig> , cytochrome p <dig> , etc.). these results suggest that a subset of sfams share similarity with other sfams and that they may be over partitioned. as evidenced by the functional enrichment data, many of the low-precision sfams may actually represent subfamilies  within a superfamily. over 54% of the families have a precision and recall of  <dig> , suggesting that, in general, sfams are well partitioned and can be used to accurately identify their members. we include the results of this precision and recall analysis for each family as a qualifier in our database.

sfams are related through a sparse network
the precision results indicate that some sfams recruit non-member sequences. this may result from an over-partitioning of the data, wherein some sfams share an evolutionary history with other families. for example, two sfams may be distinct sub-clusters  within a larger family . we emitted an hmm consensus sequence for each sfam and aligned all pairs of consensus sequences to evaluate the relationship between sfams. we found that 33% of our sfams do not exhibit significant sequence similarity with any other family, suggesting that they are well partitioned and distinct. the remaining 67% of sfams have similarity to at least one other family, indicating that some of the sfams are either over-partitioned  or not phylogenetically distinct .

we evaluated the structure of these relationships through network analysis. we represented families as nodes  and relationships of significant similarity between families as unweighted and undirected edges . we evaluated the network topology by calculating various network summary statistics, including the median node  degree , betweenness , transitivity , and closeness . the distributions of the degree and betweenness summary statistics are characterized by a long tail, which indicates that most sfams share similarity with a small number of families. we also found that the network contains  <dig>  distinct components , many of which may represent superfamilies. most are composed of two sfams , though one component is especially large, containing 54% of the nodes. the network summary statistic distributions for this large component are similar to those of the entire network, though the median node is slightly more connected  and the average node is skewed towards a higher connectivity . this suggests that while the topology of this large component is analogous to the entire network, it contains an enrichment of highly connected nodes compared to the other components.

this analysis reveals that most sfams have few direct relationships to other sfams and represent peripheral nodes within the network. a relatively small number of sfams represent network hubs. high-degree sfams are enriched for several functions , including signal transduction , membrane transport , and sugar metabolism . some functions that are enriched among high-degree sfams are also enriched among low-precision sfams, especially those functions associated with ribosome biogenesis . in total, these network results indicate that while the majority of our sfams share sequence similarity with at least one other sfam, most are not similar to more than two other sfams. hence, a user wanting to annotate a novel sequence via comparison to our sfam hmms may want to evaluate two or three of the top hits, but generally does not need to consider a large number of hits.

we use the results of this consensus-sequence network analysis to partition sfams into sets of families that are related through sequence similarity . clans can be used to improve the interpretation of sfam search results. for example, when using sfams to functionally annotate a new sequence, one might place greater weight on the putative annotation for a sequence that is recruited into multiple sfams within the same clan relative to a sequence that is recruited into multiple sfams that are distributed across multiple clans. to provide flexibility to users of our database, we also provide a listing of sfam clans that is based on hmm recruitment of member sequences. specifically, if two families reciprocally recruit 80% of one another’s member sequences, then we merge these families into a clan using single-linkage clustering. this procedure finds that  <dig>  families are recruited into one of the  <dig>  clans that this analysis identifies. both sets of clans are made available to users of our database.

the majority of sfams are associated with interpro annotations
we functionally annotated each sfam by assigning interpro  <cit>  annotations to the families on a majority-rules basis. we find that 52% of the families  have at least one interpro annotation . an additional  <dig>  sfams  contain at least one interpro-annotated sequence, but not enough to meet the majority-rules threshold. the remaining families have no described functional annotation, suggesting that their function is unknown. we also evaluated the functional consistency of each network component by calculating the fraction of annotated component sfams that share an interpro annotation. we found that the majority of components have at least one interpro annotation identifier that is common to all annotated sfams within the component .

these functional annotations can be used to rapidly annotate new genomes with fairly high confidence by classifying the protein sequences into sfams and transferring the annotation. however, similarity-based annotation can yield erroneous inferences of function when similarity and function are not tightly linked  <cit> . thus, we recommend using only the 39% of the sfams  that contain sequences which all share the same functional interpro identifier when inferring the function of a new sequence.

sfams cover most diversity in new genomes and can be automatically extended to incorporate new families
to illustrate how our sfam database can be used to annotate new protein sequences, we executed a second iteration of our workflow to classify protein sequences obtained from recently released microbial genomes into sfams. specifically, we evaluated  <dig> , <dig> predicted proteins obtained from  <dig>  genomes that were submitted to the jgi img database between december  <dig> and august  <dig>  each protein was compared to each of the  <dig>  sfam hmms identified in the first iteration of our workflow. roughly 84% of the sequences  were assigned to an sfam currently defined in our database, and 73%  were recruited into a functionally annotated family. this high rate of annotation demonstrates the utility of our sfam identification procedure and suggests that our sfams cover a large percentage of protein diversity in recently sequenced genomes.

nonetheless, a substantial number of protein families remain to be identified. our automated, iterative mcl procedure provides a means for defining new sfams from the unannotated sequences. after sifting out all sequences that show homology to one of the existing sfams, we subjected the remaining  <dig>  proteins from recently sequenced genomes plus the  <dig>  proteins that were not clustered into an sfam in our initial analysis to an independent round of pairwise blastp and mcl, as described above. this de novo clustering identified an additional  <dig>  sfams. these sfams and their member sequences were added to our database and can be differentiated from the previously identified sfams through a unique identifier . as additional genomes are sequenced, this procedure will be repeated to expand the diversity of sfams encoded in our database. this analysis demonstrates how our sfam database can be rapidly and automatically updated.

sfams can be used to rapidly and thoroughly annotate metagenomic sequences
our database of sfams can also be used to annotate metagenomes. for example, metagenomic sequences can be compared the database of hmms to identify homologs of sfams. in their study of the sorcerer ii global ocean sampling  metagenome, yoosef et al.  <cit>  predicted proteins from assembled metagenomic reads using two methods:  de novo clustering of translated open reading frames predicted from metagenomic sequences, along with full-length reference proteins and  annotation of translated metagenomic orfs using hmms from pfam  <cit>  and tigrfam  <cit> . the authors discovered that while de novo clustering was computationally expensive , it resulted in substantially more predicted proteins than did the hmm based strategy.

we evaluated the performance of sfams on the annotation of metagenomic data by classifying predicted gos metagenomic peptides into sfams. specifically, we downloaded from camera  <cit>   <dig> , <dig> peptides that were predicted in the gos study  <cit>  and compared each peptide to each of the  <dig>  first-iteration sfam hmms in our database using hmmscan. we classified  <dig> % of the sequences  into one of our sfams. of these sequences,  <dig> %  were classified into a functionally annotated sfam. these percentages exceed the 63% of proteins that we were able to annotate when using pfam  and tigrfam  hmms, indicating that our sfams cover a greater diversity of marine metagenome proteins than other protein family databases. importantly, we can fairly thoroughly annotate a metagenome with substantially fewer computational requirements than de novo clustering. as metagenomic studies grow in size due to advances in technology and dropping sequencing costs, the classification of metagenomic sequences into reference sfams will be more tractable than performing de novo protein family clustering for every study.

resources and availability
our sfam database and software workflow is publicly available for download . this database includes the ~ <dig>  million protein sequences obtained from the  <dig>  genomes that we analyzed across the two iterations of our workflow. it also includes multiple sequence alignments, hmms and phylogenetic trees describing each of the  <dig>  sfams that we characterized. we also make available various details on the sfams, including precision, recall, clan listings and functional annotation. as additional genome sequences become available, we will expand the diversity of the sfams described in our database through iteration of the workflow. our procedure ensures that our knowledge of known protein family diversity will grow at a rate consistent with the rate at which new genomes are discovered.

we recognize that some of the large-scale computational analyses that we conducted produced data that may be useful for other researchers. thus, in addition to the sfam database, we provide access to several large datasets, including the results of the initial pairwise sequence–similarity search , the pairwise similarity matrix used as input into mcl, the mcl result files , and the sfam similarity network. researchers can use these data sets to explore the relationship between proteins or sfams or build their own families using mcl with alternative inflation values or different de novo clustering algorithms.

CONCLUSIONS
we developed an automated, high-throughput procedure that iteratively identifies sfams from whole genome sequences. we used this procedure to populate a database of sfams that provides a basis for describing the diversity of protein families and functions. our approach streamlines the identification of novel protein families, ensuring that the diversity described in our database of sfams will keep pace with the diversity discovered through additional genome sequencing. the approximately 30% of sfams that do not have an interpro identifier suggests that our database contains novel diversity relative to other commonly used hmm-based protein family databases. sfams should thus prove to be a useful supplemental resource for analyses that rely on classifying sequences into families. indeed, we found that our procedure facilitates rapid and thorough annotation of genome and metagenome sequences.

although this approach provides an updateable and comprehensive dataset of families, our sequence similarity–based sfams are limited because they are not built based on functional relatedness. additionally, sfams are identified using high-throughput procedures, which may trade sensitivity for accuracy. for example, many sfams, especially those with low precision or a large number of degrees, may represent subfamilies within a superfamily. given that we apply a single mcl inflation value to all sfams that we identify, some over-partitioning of the data during de novo clustering is expected. in addition, our selection of various thresholds that are used to infer homology between a pair of sequences or a sequence and a family may produce family-composition errors. fortunately, our statistical assessments indicate that most sfams are well partitioned and only exhibit similarity with no more than one other sfam. furthermore, we use previously identified families to reduce the computational complexity of identifying novel sfams. this could introduce errors, such as in the case where two proteins from the same family are recruited into two separate previously identified families. our decision to maximize the phylogenetic diversity of the set of genomes that we used to initialize our database of families should mitigate – though it cannot eliminate – this potential problem. regardless, as a result of these aforementioned properties of our sfam database, downstream curation is required for sfams of interest. we provide access to our pairwise similarity matrix as well as our sfam statistics and network relationships to aid users of our database in the curation of specific sfams.

we plan to provide regular updates to the sfam database as new genome sequences become available. in addition, as the phylogenetic representation of eukaryotic genome sequences improves, we will identify those sfams that are widely distributed across eukarya. future work will also include automatically detecting superfamily and subfamily sfams. additionally, we plan to characterize the phylogenetic and ecological distributions of sfams. our ultimate hope is that through adoption of high-throughput and computationally efficient procedures such as the identification of sfams, researchers can leverage the inundation of biological sequence data to thoroughly and rapidly characterize the diversity of proteins in nature.

