BACKGROUND
chipx, including chip-seq  <cit>  and chip-chip  <cit> , is a powerful technology for mapping transcription factor binding sites . biologists often use it as a genome-wide screen to identify promising tf target genes to design follow-up studies or develop mechanistic hypotheses. a typical chipx experiment can identify thousands of tf bound genes. however, a large fraction of the bound genes are usually non-functional, in the sense that they do not respond transcriptionally to tf binding  <cit> . to help with identifying promising targets for functional studies, many researchers combine chipx data with gene expression data from tf perturbation experiments  to search for genes that are both bound by the tf and differentially expressed in the tf perturbation experiments. in this article, genes bound by the tf of interest are called tf “binding” targets, whereas genes that are both bound by the tf and transcriptionally respond to tf perturbation are defined as “functional” tf target genes. since changes in tf binding at the functional targets are associated with changes in transcription, it is very likely that the binding changes at these genes will result in observable phenotype changes. for this reason, biologists often want to identify the functional targets among the binding targets to design follow-up studies because studying the functional genes is more likely to produce clearly interpretable results and may increase the success rate of the follow-up studies. unfortunately, a large fraction of chipx studies do not have corresponding tf perturbation gene expression data. for instance, a survey of  <dig> published chipx studies randomly chosen from the gene expression omnibus   <cit>  shows that around 40%  of the existing chipx studies do not have accompanying gene expression data. in these cases, investigators usually prioritize tf bound genes according to the strength of the chipx binding signals and then choose follow-up candidates from the top ranked genes, based on the assumption that the top ranked binding targets are more likely to be functional target genes than the lower ranked binding targets  <cit> . in order to improve upon this chipx-only based approach, we developed chipxpress to better identify functional tf target genes among tf binding targets when corresponding tf perturbation data is unavailable.

chipxpress is a novel method that relies on integrating large amounts of publicly available gene expression data  with chipx data to better identify functional tf target genes. it is motivated by the observation that over  <dig>  gene expression samples containing valuable biological information are currently deposited in the geo, but remain relatively underutilized. the value of ped has been demonstrated by several groups for data mining in various applications such as tissue origin prediction and microarray sample phenotype identification  <cit> . however, using ped to improve other genomic analyses, such as chipx data analyses, particularly in complex genomes like human and mouse represents a novel research area that has yet to be extensively explored. two complications that may arise when dealing with ped are its large heterogeneity, which may give rise to substantial lab and batch effects  <cit> , and the overwhelming amount of data. given its heterogeneity and size, much remains to be learned as to whether and how the wealth of information in ped can be effectively used to boost the analysis of other high-throughput genomic data. moreover, the lack of tools to conveniently handle ped has also prevented many researchers from benefiting from these data in their daily research. therefore, there is a need for easy-to-use but effective tools that can extract meaningful information from ped to enhance common genomic analyses. chipxpress helps to fill this role by providing a simple, fast and scalable algorithm that uses regulatory information from the diverse cell types, tissues, and diseases in ped to enhance functional tf target gene prediction from chipx data. by doing so, chipxpress also helps to increase the overall value of ped by providing a beneficial tool for researchers to more fully utilize the publicly available and useful gene expression data.

ideally, researchers interested in using ped to improve functional target gene identification would extract only the relevant gene expression data in ped that applies to their chipx experiment. however, this approach has a number of limitations. first, it requires non-trivial and tedious manual work, which currently is a major barrier that discourages many researchers from using ped. for instance, researchers will need to collect data that matches the cell types and conditions of interest in their chipx experiment and then correctly analyze the data to identify differentially expressed genes. this requires careful reading of the database annotations to understand the sample origins and associated experimental design, as well as the biological and technical expertise to choose the most relevant samples and the most appropriate data analysis methods. if multiple tfs need to be analyzed and each tf has many matching gene expression datasets in ped, this process would need to be repeated multiple times, which may take a significant amount of effort and time. an alternative solution would be to automate the manual approach, but currently this is also very difficult and is not amenable to scale-up. the main issue with automation is it depends on the availability of high-quality and computer-friendly sample and experiment annotations, and requires effective tools for automatically extracting, accurately interpreting and analyzing the annotations. maintaining high-quality annotations is non-trivial, as a lot of manual work needs to be invested during data storage, especially for a database that is currently growing at an exponential rate. on the other hand, tools for automatically parsing the annotations to accurately identify the samples, experiment design information, and the analysis methods are still far from mature. thus, it remains difficult to automate this manual approach. finally, this approach requires the availability of matching gene expression samples in ped. in many cases, especially if the investigator is the first to study the regulation of a set of tfs in a cell type of interest, corresponding gene expression data is simply unavailable since no one has yet to perform the relevant experiments.

based on the reasons above, the goal of this article is to develop a method that can be easily used by researchers to explore the large and highly heterogeneous data in ped to extract useful biological information for identifying functional tf targets among the binding target genes detected in chipx experiments. we wish to develop an automated method that does not depend on sample and experiment annotations, so that it can be easily scaled up to accommodate the rapidly growing data in ped. our solution, chipxpress, is constructed based on observing that the global correlation between a tf and its target genes across a large number of properly normalized ped samples from diverse cell types and biological conditions contains valuable information for identifying functional targets, in spite of the inherent heterogeneity of ped. we develop a simple ranking algorithm, based on a novel truncated absolute correlation measure, to combine chipx data and ped to more accurately predict functional tf target genes. the algorithm ranks genes predicted to be bound by the tf in chipx data by incorporating the tf binding information from chipx data and correlation in expression between tf and binding target genes from ped. the main purpose of chipxpress is to improve upon the tf-bound gene rankings generated from existing chipx peak calling tools to help identify the most promising functional target genes for follow-up studies. to evaluate this method, we applied it to  <dig> different mouse and human chipx data sets and found that chipxpress rankings consistently performed better than chipx-only rankings and may substantially increase the probability of finding functional tf targets in the top ranked genes, when researchers do not have their own tf perturbation gene expression data to accompany their chipx data. we also show that by using ped in its entirety, chipxpress makes it possible to improve functional target gene identification even when the gene expression data from the matching cell types and biological conditions are unavailable in public gene expression databases. chipxpress is implemented as an r/bioconductor package which is freely available at the chipxpress website  <cit> .

methods
data collection
we developed chipxpress using two large compendiums of human and mouse gene expression profiles collected from geo. the human compendium consists of  <dig>  gene expression samples from the affymetrix human u <dig> plus  <dig>   array, and the mouse compendium contains  <dig>  samples from the mouse  <dig>  <dig>   array. both these compendiums were compiled by mccall et al.  <cit> . within each compendium, samples were consistently normalized using frozen rma   <cit> , and the normalized expression values of each gene across all samples were then standardized to have zero mean and unit standard deviation. for each gene with multiple probesets, only the probeset with the highest variance prior to standardization was retained.

frma is a new algorithm that can normalize tens of thousands of microarray samples collected by different labs from the same affymetrix microarray platform. the algorithm normalizes all samples to a fixed  reference distribution. since the reference distribution is frozen, one can process new array samples one-by-one without renormalizing the old samples. the normalized values from the new and old samples are directly comparable. in this way, one can easily expand the microarray compendium without incurring significant computational burden. frma can also more effectively reduce probe-related batch effects  <cit> . using the frma normalized expression values, mccall et al.  <cit>  have shown that within each microarray platform, the biological variation across the compendium samples from different cell types is larger than the lab or batch effects. as a result, the normalized expression values of the same gene can be meaningfully compared across samples in spite of their heterogeneous origins  <cit> . this is consistent with similar observations made by others  <cit> .

our exploration of these two ped compendiums further confirmed these observations, as we found that tfs and their known functional target genes  are often highly correlated across compendium samples despite their diverse lab and cell type origins. for instance, the scatter plot in figure 1a shows the frma normalized gene expression values for the tf oct <dig> and its known target dppa5a across  <dig>  mouse expression samples. the pearson correlation coefficient between these two genes is strong, r =  <dig> , especially given the heterogeneous lab and cell type origins of the compendium samples. in comparison, the correlation between oct <dig> and a randomly chosen gene is much weaker  as shown in the bottom-right corner of the same plot. using the pearson correlation coefficients between oct <dig> and all genes as an empirical null distribution, the one-sided p-value for the observed oct4-dppa5a correlation  is less than  <dig> . figure 1b provides another example where the expression of jarid <dig>  a known transcriptional repressor, and its repressed target gene slc48a <dig>  is shown across the same  <dig>  mouse expression samples. again, the pearson correlation between these two genes is strong despite the heterogeneous lab and cell type origins of the compendium samples . in comparison, the correlation between jarid <dig> and a random gene is much weaker  as shown in the bottom-right corner of the same plot. these examples suggest that the global correlation between a tf and a gene across the frma normalized ped samples from a diverse collection of cell types and conditions may correlate with the potential of a tf bound gene to become a functional target. this observation motivated the development of chipxpress which attempts to use the global tf-tg correlation across diverse ped samples to improve functional target gene prediction.

while the current implementation of chipxpress is based on the two pre-built ped compendiums described above, the chipxpress package also provides the users with tools to construct their own compendium of expression profiles from other affymetrix platforms and species. the same processing procedure will be used to compile the new compendium; the gene expression data will be first consistently normalized and processed with frma and then standardized to have zero mean and unit standard deviation. usage of these tools is described in full detail in the vignette manual of the r/bioconductor package chipxpress.

truncated absolute correlation
one simple way to measure the global tf-tg correlation is the pearson correlation coefficient, r. one may compute r between the tf-of-interest and each gene in the compendium to measure the regulatory potential. genes with larger absolute values of r may have higher probability to be true functional targets. however, this simple correlation measure has a limitation; namely, it ignores the context-dependency of gene regulation. for example, we often observed that when the tf-of-interest is not expressed, its target genes could still be activated or repressed by other transcriptional regulators. figure 2a shows the expression of oct <dig> and its known target rrn <dig> across all  <dig>  mouse samples in the mccall compendium, where oct <dig> and rrn <dig> are positively correlated among samples with medium to high level of oct <dig> expression, but this correlation decreases substantially when oct <dig> expression is low. among samples with low oct <dig> expression, many still have high rrn <dig> expression, possibly due to existence of other transcriptional regulators that can activate rrn <dig>  thus, context-dependency of gene regulation may decrease the global correlation between tf and tg. when one uses all compendium samples to compute the pearson correlation between oct <dig> and rrn <dig>  the correlation is r =  <dig> . using the pearson correlation coefficients between oct <dig> and all genes to construct a null distribution, one can compute a standardized z-score for the observed oct4-rrn <dig> correlation by subtracting the mean and dividing by the standard deviation of the null distribution. the resulting z-score is  <dig> , which measures the separation between the observed correlation and the null. in contrast, when one excludes samples with low oct <dig> expression and only uses samples in which oct <dig> is above the average oct <dig> expression in the compendium to compute the pearson correlation, the oct4-rrn <dig> correlation increases to r =  <dig> . one can use the same truncation approach to compute the correlation between oct <dig> and all other genes to obtain a null distribution and calculate a z-score. the z-score increases to  <dig> , representing a better separation between the observed correlation and the null. figure 2b-d shows a few additional examples for gli <dig> in mouse and esr <dig> and tfap2c in human, where the correlation between tf and tg increases from  <dig>  to  <dig> ,  <dig>  to  <dig> , and  <dig>  to  <dig> , respectively, when excluding samples in which the expression of the tf is below the average expression. figure 2e-f shows an additional two examples for jarid <dig> and nanog in mouse, in which the target gene expression is repressed by the tfs. in both cases, the negative correlation between the tf and tg became more negative when excluding the samples with below average tf expression. in all of these examples, the absolute value of the z-score increases irrespective of whether the tfs activate or repress their target gene. since similar phenomenon was observed for many known tf-target gene pairs, we decided to use a new statistic, truncated absolute correlation, in chipxpress to more effectively measure the potential of a gene to be a functional tf target by taking into account the aforementioned context-dependency.

assume there are i samples in the gene expression compendium. let xti be the expression value of the tf-of-interest t in sample i, and ygi be the expression of gene g in sample i. given a cutoff value, c, let c = {i: xti ≥ c} denote the collection of samples in which the tf expression is bigger than or equal to c. the truncated pearson correlation between the tf t and gene g is defined to be equal to the pearson correlation coefficient calculated only using the samples in c:

 rt,g=∑i∈cxti−x¯tygi−y¯g∑i∈cxti−x¯t2∑i∈cygi−y¯g <dig> 

here, x¯ and y¯ are averages taken across samples in c, and truncation refers to the exclusion of samples with low levels of tf expression . this truncation can help with excluding samples in which a target gene is activated or repressed by other transcriptional regulators instead of the tf-of-interest, thus reducing the amount of noise by removing samples which are not likely to be informative for inferring the relationship between the tf-of-interest and its target genes. the truncated absolute correlation, at,g = | rt,g | , can then be used to measure the regulatory strength between the tf-of-interest and each gene in the compendium. based on this definition, it is easy to see that the absolute value of the pearson correlation coefficient is equivalent to a non-truncated absolute correlation, i.e. at,g where c = −∞. we will show later that the truncated absolute correlation performs better than the non-truncated absolute correlation.

chipxpress ranking algorithm
without gene expression data, one can prioritize tf bound genes based on the chipx signal alone. using the ped compendiums, one can also rank the genes based on the truncated absolute correlation alone. chipxpress generalizes these two methods by combining chipx and ped information together in order to improve upon the ranking of tf bound genes identified from chipx experiments.

suppose users have a list of tf bound genes ranked based on chipx data alone. the genes are ranked from the most to least likely to be regulated by a tf as determined by the chipx signal strength. since most chipx peak calling algorithms rank their reported peaks, one can easily generate this list by ranking tf bound genes according to the highest-ranking peak associated with each gene. let pg  denote the chipx-only rank of gene g. for the tf-of-interest t and each tf bound gene g, one can also calculate the truncated absolute correlation at,g between t and g in the gene expression compendium using a set cutoff c. tf bound genes can then be ranked based on at,g. let ag  be the rank of the tf bound gene g based on the truncated absolute correlation calculated from the gene expression compendium.

chipxpress combines the chipx-based rank pg and the ped-based rank ag through a linear combination rg = w*pg + *ag to produce a new ranking. if a tf bound gene does not have a corresponding expression measurement in the gene expression compendium, then the gene is not ranked by chipxpress. we note that, since the final chipxpress score rg is a linear combination of ranks, a smaller rg score will correspond to a higher ranked gene.

chipxpress has two parameters: the truncation cutoff c for computing the absolute correlation and the weight w for combining chipx and ped information. by default, chipxpress uses c =  <dig> and w =  <dig> . this is based on our systematic tests below which show that irrespective of the  values, the rankings based on rg are able to provide better or comparable overall performance compared to rankings based on chipx or ped data alone, and the optimal performance was achieved when c =  <dig> and w =  <dig> . note that since expression values of each gene are standardized to have zero mean, c =  <dig> amounts to using the samples in which the tf expression is above the average tf expression to compute the correlation.

chipxpress implementation
chipxpress is currently offered as an r/bioconductor package that can be used by any operating system that supports r. it can be downloaded and installed following the instructions at the chipxpress website  <cit> . users will also need to download the accompanying chipxpressdata package, which contains the pre-built mouse and human gene expression compendiums. if users would like to build their own gene expression compendium for a different platform or for a different species, the chipxpress package also provides the necessary functions to do so as explained in the software manual. to lower the loading time of the large amount of gene expression data, both compendiums are stored in big.matrix format using the bigmemory r package, which requires at least 64-bit of ram for large databases . thus, users will be required to install the 64-bit version of r in order to have enough memory to load the compendiums.

RESULTS
chipxpress is able to improve upon the chipx-only rankings
in order to evaluate chipxpress, we analyzed  <dig> chip-seq, chip-chip promoter array, and chip-chip whole-genome tiling array datasets for  <dig> different tfs – oct <dig>  jarid <dig>  gli <dig>  esrrb, and nanog in mice and myc, tfap2c, hif1a, and esr <dig> in human . we paired each dataset with a corresponding tf perturbation microarray or exon array dataset  . for each pair of chipx and tf perturbation data, we constructed gold standard functional tf target genes by intersecting the genes that were predicted to be bound by the tf in chipx data and differentially expressed in corresponding tf perturbation data. to determine tf bound genes, we processed chip-chip data using tileprobe  <cit>  and the chip-seq data using cisgenome  <cit> , and detected chipx peaks at the 10% false discovery rate  level. a gene is defined to be bound if there was at least one peak within 10 kb upstream and 5 kb downstream of the gene’s transcription start site. to determine the differentially expressed genes, we processed the tf perturbation data with rma  <cit>  for gene expression microarrays or genebase implemented in jetta  <cit>  for exon microarrays to obtain normalized expression values. we then analyzed them with limma  <cit>  to detect differentially expressed genes at a 10% fdr cutoff. genes that are both bound in the chipx data and differentially expressed in the tf perturbation data are then labeled as gold standard functional targets. the gold standard target genes are listed in additional file  <dig> and the number of gold standard target genes for each tf is listed in table  <dig> 

tfp tf perturbation gene expression data, p affymetrix promoter array, t affymetrix tiling array, gs gold standard constructed by intersecting tf bound genes in chipx data with differentially expressed genes in tf perturbation experiments. for each tf, three sets of gs were constructed using three different peak callers. the table shows the number of gs target genes corresponding to tileprobe, mat, tilemap for chip-chip data  and cisgenome, macs, and original for chip-seq data .

for each chipx dataset, we then pretended that the gene expression data from the tf perturbation experiments were not available, and used different methods to rank genes. the methods we tested include:

 chipxpress ranking, which ranks tf bound genes using the default parameter values c =  <dig> and w =  <dig> .

 chipx-only ranking, which ranks tf bound genes by peak strength only using chipx data .

 geo-only ranking, which ranks genes by their truncated absolute correlation, obtained only using the ped from geo.

if the tf perturbation experiments used to construct the gold standard genes were also contained in the ped compendium, the corresponding samples were removed from our ped compendium prior to the chipxpress analysis.

for each test dataset, we compared different ranking methods based on their ability to identify gold standard functional tf target genes among the top ranked genes. in this regard, we computed the percentage of top ranked targets that were true functional targets, or the positive predictive value , for each method. the ppvs of different methods were then compared. the results from the ten test datasets were largely consistent, and figure 3a shows four representative examples. for each dataset, the figure shows three curves, corresponding to the ppvs for chipxpress, chipx-only and geo-only rankings, respectively, versus increasing predicted target gene list size. chipxpress outperformed both the chipx-only ranking and the geo-only ranking, and provided the highest percentage of true functional target genes among the top ranked genes. the level of improvement varied across datasets and was substantial in some cases . these analyses show that incorporating ped can improve upon the chipx-only ranking when an investigator does not have his/her own tf perturbation gene expression data.

prediction improvement is not tied to a specific chipx platform or peak calling algorithm
next, we asked whether the observed improvement brought by chipxpress was tied to a specific chipx peak calling algorithm. to answer this question, we re-defined tf bound genes with several other peak calling algorithms by detecting chipx peaks using their default parameter settings, and reevaluated chipxpress prediction performance. these additional algorithms include mat  <cit>  and tilemap  <cit>  for chip-chip data, and macs  <cit>  and original  for chip-seq data. for each test dataset and peak calling algorithm, we evaluated the chipxpress, chipx-only and geo-only rankings. in each evaluation, the same peak calling algorithm and parameters were used to obtain the chipxpress rankings, the chipx-only rankings, and the tf bound genes used to construct the gold standard. we found that chipxpress was able to improve upon the chipx-only ranking irrespective of which chipx peak caller was used. for instance, figure 3b,c shows the results for the same four datasets in figure 3a. in all cases, chipxpress provided the best ranking performance. the four datasets in figure  <dig> represented three different platforms for chipx experiments . altogether, our results suggest that chipxpress is able to improve functional target gene identification irrespective of the chipx platform and peak caller.

chipxpress robustly improves ranking for a wide range of parameter values
the comparisons so far were based on the default parameters of chipxpress. we also studied the performance of chipxpress using a wide range of other parameter values. to facilitate the comparison, we summarized the ranking performance of each method in each dataset into a normalized auc score, calculated using the area under the ppv curve divided by the total plot area for the top n  predictions. for instance, for each curve in figure  <dig> and each n in { <dig>   <dig>  1000}, this amounts to computing the average of the positive prediction values across the top n predictions . since  <dig> datasets were analyzed,  <dig> normalized auc  scores were obtained for each n and each ranking method .

we first fixed the weight parameter w to its default value  <dig>  and asked how changing the truncation cutoff c may change the nauc scores. six different cutoff values were tested: c = −∞, - <dig>  - <dig>   <dig>   <dig> and  <dig>  figure  <dig> shows the results when the chip-seq and chip-chip peaks were called using cisgenome and tileprobe respectively. for each ranking method, including chipx-only, geo-only, and chipxpress using different values of c, the distribution of the  <dig> nauc scores is shown as a box plot. in the figure, “all” corresponds to chipxpress with c = −∞, which is equivalent to computing the traditional pearson correlation coefficients using all the samples in the compendium and then using their absolute values to rank genes. comparing the nauc scores of different ranking methods, one can see that regardless of which parameter values were used for the truncation cutoff c, chipxpress robustly performed better than or comparable to the chipx-only and geo-only rankings. the figure also shows that c =  <dig> produced the best overall performance among all the tested methods. this can be seen by tracking the average nauc score across different values of c. comparing the results for c = −∞ and the results for c =  <dig>  one can also see that using the truncated absolute correlation can improve ranking compared to using the non-truncated absolute correlation .

next, we fixed the truncation cutoff c to its default value  <dig> and asked how changing the weight parameter w may change the nauc scores. eleven different w values were tested: w =  <dig>   <dig> ,  <dig> , …,  <dig>  figure  <dig> shows the nauc scores of chipxpress obtained using different w values. here, peaks were also called using cisgenome and tileprobe. based on the figure, w =  <dig>  produced the best overall performance among all the tested methods. w =  <dig>  had the highest mean and median nauc for n =  <dig>   <dig>  and w =  <dig> had the highest mean and median nauc for n =  <dig>  similar to before, we found that chipxpress rankings were better  than both the geo-only rankings and the chipx-only rankings irrespective of which weight w was used to combine the chipx and ped information. it is important to note that when w =  <dig>  the chipxpress ranking is the same as the chipx-only ranking. however, when w =  <dig>  the chipxpress ranking is not the same as the geo-only ranking . this is because in the geo-only ranking, no information from chipx data, namely whether a gene is tf bound or not, is incorporated, thus all genes in the compendium are ranked by the absolute correlation at,g. in contrast, the chipxpress ranking with w =  <dig> first extracts the subset of genes that are tf bound, and then ranks the tf bound genes by at,g. therefore, chipx information is still used for determining which genes are tf bound. this means that even though the default weight w =  <dig>  for the chipx data seems to be small, the actual contribution of the chipx data to the final gene ranking is more than the 10% represented by the weight parameter w.

figures  <dig> and  <dig> only show the prediction performance across the  <dig> test chipx datasets marginally . to visualize the prediction performance when both w and c are jointly allowed to vary, we constructed heat maps showing the average nauc score of the  <dig> tested datasets for each w and c pair . figure  <dig> also shows the results obtained using other peak calling algorithms to determine tf bound genes. since the  <dig> test datasets contained both chip-chip and chip-seq data, we paired the possible peak callers into  <dig> different chipx analysis methods: cisgenome  with tileprobe , macs  with mat , and original  with tilemap . figure  <dig> shows that overall, chipxpress performed better than both the geo-only ranking and the chipx-only ranking irrespective of which chipx analysis method and parameter values  were used. when w =  <dig>  and c =  <dig>  chipxpress achieved its best overall prediction performance. specifically, out of the  <dig> possible combinations between n =  <dig>   <dig>   <dig> and the  <dig> chipx analysis methods, w =  <dig>  and c =  <dig> offered the highest  mean nauc among the tested  parameter values for  <dig> out of the  <dig> combinations. based on these results, we set the chipxpress default procedure to first rank the predicted tf-bound genes by calculating at,g by using only the samples in which the tf expression is above the average tf expression  and then calculate a final chipxpress ranking by combining the chipx ranking and at,g ranking with weights  <dig>  and  <dig> , respectively .

chipxpress is scalable, efficient, and fast
since chipxpress does not depend on sample annotations and is automated, it can be easily applied in a high-throughput fashion. for instance, chipxpress was recently adopted by hmchip  <cit> , a database for publicly available chip-seq and chip-chip data in human and mouse, to provide improved target gene rankings for 400+ tf chipx datasets. these data can be downloaded from the hmchip website  <cit> . processing these 400+ datasets using chipxpress only took 1 hour on an 800 mhz quad-core amd opteron™ processor  <dig> computer with 4gb of memory. a similar manual analysis of the 400+ tf chipx datasets would be more difficult and much more time consuming. thus, chipxpress can dramatically increase efficiency, which is essential for scale-up.

chipxpress may be applied when no matching expression data are available in ped
our analyses above show that the global tf-tg correlation, at,g, which reflects the potential of a gene to co-express  with the tf, provides useful information to help identify a truly functional tf target gene. this global correlation is supported by large amount of data from a diverse collection of cell types and biological conditions. therefore, removing one or two cell types from the ped compendium usually has little effect on at,g. in this sense, the global tf-tg correlation is a general characteristic of a gene that is not contingent on the availability of one specific cell type in ped. in chipxpress, this global expression correlation is combined with the cell type and condition dependent binding information in the chipx data to improve target gene prediction. genes with large expression correlation but no binding in the experimental condition of interest or genes with strong binding but weak expression correlation will not be picked up by chipxpress.

since adding or removing a cell type or condition from the ped compendium usually has little effect on the global tf-tg correlation, we speculate that it might be possible to apply chipxpress even when no gene expression data matching the cell type and condition used for the chipx experiment are available in ped. to test whether this is the case, we analyzed two chipx datasets in table  <dig> – human myc in mcf <dig> cells and mouse gli <dig> in limb bud – but only after removing all related samples to the experimental cell type or tissue  in the gene expression compendium. removing these samples was done by manually examining cell type annotations of all samples in the compendium. since this is a time-consuming process, we only analyzed the two chipx datasets above. figure 7a-b shows the ped samples removed  and retained  for the chipxpress analysis in two examples. this figure shows that the removed samples are only a small fraction of all samples, and the global tf-tg correlation pattern remains clear even when the red dots are not considered. in figure 7c-d, we performed analyses similar to figure  <dig> after removing the mcf <dig> and limb bud samples. comparing figure 7c-d and figure  <dig>  one can see that removing the samples with matching cell types from ped had little to no effect on chipxpress prediction performance. most importantly, chipxpress rankings still performed better than both the chipx-only and the geo-only rankings. these examples demonstrate that even when no gene expression experiments have been performed in the cell type or condition corresponding to the chipx experiment, it is still possible to use chipxpress to improve functional target gene ranking compared to using only the chipx data.

we also note that while the global tf-tg correlation computed using ped does not depend on a specific cell type or condition, it is combined with cell type and condition dependent binding information to produce the final ranking, and therefore the chipxpress ranking is still cell type and condition dependent . to demonstrate, the top  <dig>   <dig>  and  <dig> genes identified by chipxpress using cisgenome from the two myc datasets in table  <dig> – one from mcf <dig> and one from helas <dig> cells - had  <dig> %,  <dig> %, and  <dig> % overlap, respectively. thus, the large majority of highly ranked myc target genes in helas <dig> and mcf <dig> cells are still cell-type specific, even though the rankings utilize a common measure of tf-tg correlation in ped.

chipxpress sample commands
chipxpress is implemented as an r/bioconductor package which can be easily used by researchers. as an example, below we provide the commands to reproduce the oct <dig> chipxpress analyses described in the paper. users will first need to download and install the chipxpress and chipxpress data packages. the chipxpress package contains the necessary ranking functions and the chipxpress data package contains the pre-built mouse gene expression compendium  used in the paper.

next, users will need to load the packages and the mouse gene expression compendium.

library

library

library

path < − system.file

db < − attach.big.matrix

then they will need to specify the entrez gene id for the tf-of-interest, oct <dig>  and a ranked list of predicted tf bound genes from chipx data.

tfid < − “18999”

data

finally, users will input the above information into the chipxpress ranking function:

chipxpress

the function will output two results. the first is a ranked vector of oct <dig> bound genes sorted from the smallest to largest rg. the second contains the remaining oct <dig> bound genes that were not found in the compendium. full details and more examples, including how users can build their own compendium for different platform or species, can be found in the accompanying vignette and help files in the r/bioconductor package chipxpress.

discussion
we have demonstrated that by using a simple algorithm, chipxpress is able to produce more accurate functional tf target gene rankings than chipx-only and geo-only rankings. the method is amenable to scale-up as it does not require sample annotations. the r/bioconductor package makes chipxpress easy-to-use for individual investigators. in addition, our analyses show that it is possible to use chipxpress to improve target gene ranking even when no related gene expression data is available in ped. chipxpress can help to alleviate many drawbacks that affect manual approaches to identify functional target genes from chipx data. therefore it provides a valuable tool for tf target gene prioritization when users want to analyze their own chipx data but do not have accompanying gene expression data from tf perturbation experiments. since most chipx studies and peak detection algorithms provide a list of tf-bound genes ranked by binding strength, investigators can also easily use chipxpress to quickly survey other chipx experiments relevant to the tf and cell type of their interest.

although our results show that chipxpress is able to improve functional target gene identification by combining publicly available gene expression data and chipx data, it is important to mention a few caveats.

first, our truncated absolute correlation measure will not be able to properly rank genes and transcription factors that are not measured reliably by microarrays. this will be the case especially for lowly expressed genes or transcription factors that are regulated primarily through post-translational modifications. fortunately, based on our experience this does not affect the large majority of genes and transcription factors, but users will still need to be aware of this issue when analyzing their own chipx data in case this issue affects their tf-of-interest. in cases when the tf-of-interest is consistently expressed at very low levels or shows little variation in expression across all samples in the ped compendium, the tf-tg expression correlation may not provide as much useful information. to alert users of this possibility, chipxpress reports the mean, variance, and coefficient of variation for the queried tf computed using expression values before standardization. then users will be warned if any of the three statistics fall below the 5th or 25th quantile of the distribution of the mean, variance, and coefficient of variation for all genes in the compendium.

second, our target gene rankings assume that functional tf binding will induce significant changes in the expression of its target genes. this is not always true. for example, housekeeping genes can be expressed at a stable level across a variety of cell types and conditions. this may be because many housekeeping genes are activated by multiple tfs in different cell types to ensure consistent expression of the genes. as a result, binding changes in one tf in a specific cell type may not induce changes in the expression of these genes. if users are more interested in all tf target genes irrelevant of whether or not the target gene is transcriptionally affected by tf binding, then chipxpress will not be useful. however, since a large number of investigators – especially, in initial functional studies to determine which target genes of a tf should be selected for follow-up - are interested in target genes that exhibit substantial transcriptional response to tf binding, chipxpress is still broadly applicable.

third, our modified pearson correlation coefficient is not necessarily the best and only way to capture the tf-tg regulatory information contained in ped. although we have shown that it does improve upon the naive pearson correlation coefficient by focusing on the samples in which the tf is likely to be expressed, other measures that are more robust or accurate may exist and are worthwhile to explore in the future. for instance, the global tf-tg correlation used to characterize the possibility of a gene to become a functional target is based on large amounts of data, and a strong correlation is often supported by multiple cell types and conditions. if a tf target gene is functional in only one cell type or condition and the gene does not respond to the tf binding in all other cell types or conditions, then it is possible that the global correlation between the tf and tg across all ped samples is very weak. in such a scenario, when chipx data is collected from the cell type/condition in which the target gene is functional, chipxpress may not rank that gene among the top due to its weak global correlation with the tf. how to better identify these types of genes is still under investigation.

despite these limitations, it is important to remember that only after having established the feasibility and concept that the huge and heterogeneous ped can be used to improve chipx data analysis, are we then able to pursue the other avenues of improvement through more sophisticated models and measures. one major contribution of the current work is establishing the feasibility of our approach in complex vertebrate genomes.

in this article, the gold standard target genes used to evaluate chipxpress were obtained by combining experimental chipx data with tf perturbation gene expression data. a method frequently used to assess chipx peak callers  <cit>  is to measure the motif occurrence rate among the top ranked peaks. this method was not used here for evaluation because our goal is to improve the prediction of functional target genes among the tf-bound genes rather than detecting the tf binding targets per se. previous studies have shown that a significant fraction of tf binding targets with motifs and reliable chip-seq signals are not functional  <cit> . thus, while the motif occurrence rate is a natural measure to evaluate quality of the binding peak calls, i.e. whether a genomic locus is bound or not by the tf, it does not directly provide information needed for evaluating the functionality of the target genes, i.e., whether the tf binding at a gene will result in transcriptional response. functional evidence would require a change in the expression of the gene in response to binding, which can only be determined from additional tf perturbation gene expression data rather than the presence or absence of tf motifs. this is the reason why tf perturbation experiments are often performed in addition to chipx experiments. it also explains why we relied on tf perturbation gene expression data rather than motif occurrence rate to evaluate the effectiveness of the chipxpress algorithm. despite this potential limitation of motif-based evaluation, we did perform a comparison between chipxpress, chipx-only and geo-only rankings based on motif occurrence rates. this comparison is presented in additional file  <dig> for the reader’s reference. the analysis shows that for the majority of the data analyzed here, chipxpress rankings are associated with comparable or better motif occurrence rates compared to the other ranking methods.

currently, chipxpress is designed to use large compendiums of gene expression microarray data, but the same approach in principle can also be used with rna-seq data  <cit> . this might improve the performance of chipxpress since rna-seq is known to be able to provide more accurate gene expression estimates than gene expression microarrays. although this is true, we first focused on gene expression microarray data because there are over  <dig> + gene expression microarray samples compared to  <dig> + rna-seq samples currently deposited in geo. the significantly larger number of microarray samples provide a much wider variety of cell types, tissues, and diseases that allows the truncated absolute correlation measure to more accurately capture the regulatory potential between each gene and tf. moreover, building a large compendium of rna-seq samples is not an easy or straightforward task. publicly available rna-seq data is generated from many different platforms and processed using a variety of algorithms. current understanding of how to properly normalize the data to combine them together and analyze them jointly is very limited. consistent methods to handle large rna-seq datasets still need to be developed and explored to even begin utilizing the data to improve chipx analyses or other functional analyses. rather than waiting for rna-seq methodology to mature and more rna-seq data to be deposited in ped, chipxpress can be used immediately to improve chipx analyses by taking advantage of the large amounts of gene expression microarray data in ped currently available. this explains why the current implementation of chipxpress is based on gene expression microarray data. in the future, as the rna-seq data continue to grow and the methods for analyzing those data become mature, it should be more straight-forward to extend chipxpress to also accommodate rna-seq data.

CONCLUSIONS
in summary, chipxpress improves functional target gene identification from chipx data using publicly available gene expression data in a simple and straightforward manner. our results show that when an investigator does not have his/her own tf perturbation data, chipxpress is able to more accurately rank functional tf target genes compared to rankings obtained using only chipx data, which may significantly increase the chances of finding real functional tf targets among the top ranked genes. chipxpress demonstrates the value of ped and hopefully encourages more research focused on improving chipx data analysis by incorporating ped.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
gw designed and implemented the chipxpress method and performed the analyses. hj designed and supervised the development of chipxpress. both authors wrote and drafted the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
gold standard target genes as listed in table  <dig> 

click here for file

 additional file 2
evaluation of motif occurrence rate comparing chipxpress rankings to chipx-only and geo-only rankings.

click here for file

 acknowledgements
funding

the national institute of health grant r01hg <dig> 

the authors would like to thank drs. matthew n. mccall and rafael a. irizarry for providing assistance on using the frma normalized gene expression compendiums.
