BACKGROUND
alternative splicing is one of the most important rna modifications, leading to protein diversification and contributing to the complexity of higher organisms
 <cit> . recent advances in rna sequencing , combined with modern rna-seq assembly software such as cufflinks
 <cit> , allows for high-resolution profiling of the rna landscape. the technological and computational advances enables identification of a catalog of distinctly spliced transcripts originating from the same transcription unit/gene. these full-length transcripts are however underutilized, in part because it is difficult to predict the functional impact of alternate transcription events leading to the different transcripts. in addition to the potential for impact on protein domains, alternate splicing may also alter rna processing, stability and localization. nonsense mediated decay  is tightly linked to alternate splicing, and the mechanism by which even small changes in alternative splicing can result in degradation via nmd is well described
 <cit> . to predict splicing events that may lead to these functional changes, it is necessary to classify the type of event as well as annotate the genomic position of the regions that are differentially spliced. such classifications also enable systematic follow-up analyses, such as sequence analysis of the differentially spliced regions to infer the underlying mechanisms. however, at present there are no available tools that adequately perform these analyses. existing methods, including miso
 <cit> , astalavista
 <cit>  and diffsplice
 <cit> , do not output the genomic coordinates of differentially spliced regions
 <cit> , have insufficient classification of alternative splicing 
 <cit> , or cannot assess novel features
 <cit> . furthermore, none of the existing tools for analyzing alternative splicing support nmd predictions
 <cit> .

this prompted us to develop the r package splicer. splicer uses the full-length transcripts created by rna-seq assemblers to detect single- and multiple exon skipping/inclusion , alternative donor and acceptor sites , intron retention , alternative first or last exon usage , and mutually exclusive exon events . splicer annotates the genomic coordinates of the differentially spliced elements, facilitating downstream sequence analysis. finally, splicer predicts the coding potential of transcripts, calculates untranslated region  and open reading frame  lengths and predicts whether transcripts are nmd-sensitive based on compatible annotated start codon positions and their downstream orf.

implementation
retrieval of data
splicer is implemented as an r package and is freely available from the bioconductor repository . it is based on standard bioconductor
 <cit>  classes such as granges, allowing for full flexibility and modularity, and support for all species and versions supported in the bioconductor annotation packages. an example dataset is included to allow easy exploration of the package.

splicer is compatible with the output from any full-length rna-seq assembler, but was designed to integrate with cufflinks and includes a dedicated function that retrieves all relevant information from the sql database generated by cufflinks axillary r package cummerbund. in future versions new functions dedicated to import data from other rna-seq assemblers will be introduced. the r code for a standard workflow based on cufflinks data is illustrated in figure 
 <dig>  a workflow using output from other full-length rna-seq assemblers is provided in the splicer bioconductor documentation.

classification of alternative splicing
for each gene, splicer constructs the hypothetical pre-rna based on the exon information from all transcripts originating from that gene. subsequently, all transcripts are compared to this hypothetical pre-rna in a pairwise manner, and alternative splicing events are classified and annotated . alternatively, splicer can be configured to use the most expressed transcript as the reference transcript instead of the theoretical pre-rna. this may be useful in perturbation scenarios where investigators are interested in deviation from normal conditions. for statistical assessment of differential splicing, users can access the transcript fidelity status and p-values of cufflinks, or can easily apply other r-packages that are tailored for this purpose, including edger
 <cit> , deseq
 <cit> , and bayseq
 <cit> .

isoform fraction values
for each transcript and condition, splicer calculates an isoform fraction  value, which is calculated as  /  * <dig> to represent the contribution of a transcript to the expression of the parent gene. furthermore delta-if  values, which measure the absolute change in if values between conditions, are also calculated. since these dif values measure changes in relative abundance of isoforms within a gene, they are well suited for identifying and analyzing changes in the isoform usage. such analysis does however require that the expression values of transcripts and genes have been normalized to length, sequencing depths, and possibly other biases, a standard feature of the cufflinks fpkm  metric. for data from other assemblers, the user may need to accommodate this requirement manually. these if values are highly dependent on the underlying data quality and relative expression strengths, and should be viewed as a helpful ranking statistic for identifying changes in alternative splicing between conditions.

analysis of coding potential
splicer retrieves the genomic exon sequences of each transcript from one of the bioconductor annotation files. orf annotation is then retrieved from the ucsc genome browser repository either from refseq, ucsc or ensembl, as specified by the user. alternatively, a custom orf-table can be supplied. for each transcript, the most upstream compatible start codon is identified, the downstream sequence is translated, and the relative position of the first in-frame stop codon and the distance to the final exon-exon junction is recorded and returned to the user. transcripts are marked nmd-sensitive if the stop codon falls more than 50 nt upstream of the final exon-exon junction, indicating a pre-mature stop codon . this is based on the literature consensus
 <cit> , however this setting is user-configurable. the position of the start codon is also annotated, which, in combination with the found stop codon and the annotated transcript lengths, enables users to calculate 5′utr lengths, orf lengths and 3′utr lengths. in future versions, we plan to include alternative methods of coding region prediction, such as the logistic regression model implemented in the program cpat
 <cit> .

visualization and data integration tools
the splicer package generates a gtf file that can be uploaded to the ucsc genome browser, to help users visualize transcripts and to allow for integration of the rna-seq analysis with external annotation sources. this splicer gtf file has two main advantages over the corresponding gtf file generated by cufflinks’ cuffmerge tool: firstly, splicer’s optional filters uses stringent criteria, e.g. requiring that the transcript should be expressed, or that cufflinks marks the transcript deconvolution as successful. in our experience, this removes up to 80% of transcripts originally predicted to belong to the same gene in the cufflinks gtf file , making the gtf file generated by splicer more suitable for visual analysis.

secondly, splicer can color-code transcripts according to their expression level within the parent gene. this feature facilitates easy visualization of changes in gene and transcript expression both within and between conditions.

the tabulated output of splicer facilitates a number of downstream analyses, including identification of transcripts that exhibit major changes between samples, the ability to filter the output for specific splicing classes, as well as sequence analysis in or around regions that are spliced in or out between samples. examples include detection of enriched motifs, or identification of protein domains, mirna response elements or localization signals that are spliced in or out. splicer facilitates these types of analyses by outputting the genomic coordinates of each alternatively spliced element.

RESULTS
to show the power and versatility of splicer we reanalyzed the publically available rna-seq dataset from zhang et al. <cit> , which compared two experimental conditions: the human colorectal cell line ht <dig> with and without a sirna directed towards usp <dig>  a histone h2b deubiquitinase. to compare our approach with the original analysis, we used the original cufflinks data . transcripts successfully deconvoluted by cufflinks were used as the input into splicer. the resulting dataset contained  <dig>  single-transcript genes, and  <dig>  multi-transcript genes. combined, the multi-transcripts genes were predicted to express  <dig>  unique transcripts  <dig>  transcripts per gene). the analysis and results presented here are based on only five lines of r code, , shown in figure 
1b-d, which illustrates the power and ease-of-use of splicer. for reference, the splicer analysis took ~30 minutes on a typical laptop .

splicing pattern and transcript structure
to validate the transcripts generated by cufflinks, the two first and two last nucleotides of all introns, corresponding to the locations of splice site consensus sequences, were extracted from both the transcripts generated by cufflinks as well as reference transcripts from refseq and gencode. the extracted dinucleotides were then compared to the canonical splicing motifs and the percentage of dinucleotides agreeing with the classical splice site motif was analyzed . the transcripts predicted by cufflinks were spliced in accordance with the hyper-conserved splicing motifs as frequently as transcripts originating from refseq or gencode. to further validate the transcripts obtained though cufflinks we used cufflinks’ cuffcompare tool  against all refseq transcripts. this showed that the sensitivity and specificity for both introns and exons detection are high  . these two analyses indicate that that the splicing pattern and transcript structure observed in the cufflinks derived transcripts are of high quality and suitable for further analyses.

the two first and last nucleotides, corresponding to the splice site consensus sequences, were extracted from all exons originating from the rna-seq data, gencode, and refseq. the percentage of dinucleotides identical to the canonical motif was calculated.

cufflinks’ cuffcompare tool  was used to compare refseq to the obtained transcripts and the sensitivity and specificity  for exons, introns, and intron chains are shown.

alternative splicing and nmd
from the usp <dig> kd dataset splicer identified a total of  <dig>  alternative splicing events , distributed across the different splicing classes shown in figure 
 <dig>  splicer found  <dig>   transcripts without a ptc ,  <dig>  transcripts with a ptc  while  <dig>   transcripts did not have any annotated compatible start codons. similar fractions of transcripts were predicted to be nmd sensitive when all transcripts from refseq  and gencode  were analyzed with splicer, indicating that a non-neglectable fraction of transcripts could be nmd sensitive. by using splicer’s annotation of start and stop codons, the length of both 5′utrs, 3′utrs and orfs were analyzed, but no changes between conditions were found .

splicing efficiency
zhang and colleagues reported that a subset of transcripts were enriched for intron retention following usp <dig> depletion
 <cit> , leading to the hypothesis that usp <dig> kd reduced the splicing efficiency of pre-rna molecules. if usp <dig> kd impaired splicing efficiency, an increase in the relative abundance of transcripts with ir when comparing wt and kd would be expected. since the relative abundance of transcripts is measured by if values, we tested this hypothesis by comparing the distributions of if values from the subset of transcripts with ir . this analysis shows that transcripts with ir had no global changes in their relative abundance  indicating that the global splicing efficiency was unchanged. this type of analysis could however be used to analyze changes in isoform usage in any subset of transcripts that the user could find interesting, for example all nmd sensitive transcripts .

transcript switching
we next assessed transcripts whose relative abundance was altered by the usp49kd, by filtering for genes that had both a large positive and large negative dif value .  <dig> high confidence transcript switches were found: in  <dig> instances , an nmd-negative transcript was down-regulated while a nmd-sensitive transcript was up-regulated. this illustrates that failing to assess the nmd sensitivity can lead to overestimation of the number of functionally relevant transcript switches.

the transcript switch in the sqstm <dig> gene  illustrates the utility of integrating the splicer data with information in the ucsc genome browser to identify functional changes conferred by alternate splicing. visual inspection of the isoform switch was possible by uploading the gtf file generated by splicer. as seen in figure 
 <dig>  kd of usp <dig> caused a switch from the long transcript predicted to contain a truncated pb <dig> domain, to the short transcript predicted to encode an intact pb <dig> domain.
 <cit>  respectively .

CONCLUSIONS
here, we have introduced the r package splicer, which increases the usability and power of rna-seq and assembly technologies by providing a full overview of alternative splicing events and protein coding potential of transcripts. splicer is flexible and easily integrated in existing workflows, supports input and output of standard bioconductor data types, and enables investigators to perform many different downstream analyses of both transcript abundance and differentially spliced elements. we demonstrate the power and versatility of splicer by showing how new conclusions can be made from existing rna-seq data.

availability and requirements
splicer is implemented as an r package, is freely available from the bioconductor repository and can be installed simply by copy/pasting two lines into an r console.

•project name: splicer

•project home page:http://www.bioconductor.org/packages/ <dig> /bioc/html/splicer.html

•operating system: platform independent

•programming language: r and c

•other requirements: r v  <dig> . <dig> or higher

•license: gpl

•any restrictions to use by non-academics: no limitations

competing interests
the authors declare that they have no competing interests.

authors’ contributions
kvs and jw developed the r package. bp, as, kvs and jw planned the development and wrote the article. all authors read and approved the final manuscript.

supplementary material
additional file 1: table s1
tabulated output of the splicer analysis.

click here for file

 acknowledgements
kvs, jw and as were supported by grants from the lundbeck foundation, the novo nordisk foundation, and the rimod-ftd joint eu program for neurodegenerative research to as. work in the btp lab was supported through a center grant from the novo nordisk foundation . we thank dr christine wells, glasgow university, for comments on the manuscript.
