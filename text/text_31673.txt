BACKGROUND
the genetic component of complex disorders such as hypertension, parkinson's disease, cancer, and diabetes is believed to result from the compound effect of multiple dna variations in different chromosomal regions. in this context, the paradigm of searching across the genome for univariate single nucleotide polymorphism  associations may not be the most appropriate or realistic strategy. a preferred approach would consider the effects of multiple snps jointly. unstructured enumeration of all possible combinations of snps for association is computationally demanding, if not infeasible. variable selection needs to be performed before testing such multi-locus effects due to the discrepancy between numbers of snps and sample size in a typical genome-wide association study. in the current work, we focused the proposed association analyses of snps belonging to genes that are biologically related. the criteria for grouping snps can be based on biological theory, expert opinion, or localization in genes that control the same functional process or are co-regulated. such groups of snps will be referred to as loci-sets. we have developed a method called glossi  to score loci-sets as a function of the significance level of the individual snps comprising each loci-set. in what follows, we will use the terms locus and snp interchangeably.

the idea of directly scoring a predefined set of genetic features is not new. it has sparked considerable interest in the context of gene expression data analysis since the publication of the pioneering paper by mootha et al.  <cit> . these authors designated and implemented the gene set enrichment analysis  approach to identify functionally related genes that display overall coordinated expression changes with respect to biological states or disease phenotypes. the annotated biological function is expected to be more relevant if the set is 'enriched' with genes showing good-to-moderate association signals as compared to the remaining genes.

recently, wang et al.  <cit>  built on work of subramanian et al.  <cit>  and extended it to genotyping data. since many snps can be assigned to the same gene, the authors used the best signal  from each gene in their calculation. similar to gsea, enrichment of association signals was measured by using a modified kolmogorov-smirnov  statistic and statistical significance determined through permutation testing. one drawback of the ks statistic is that it depends, in part, on the signals outside of the tested loci-set. put another way, it assumes the 'real' causal snps are fully contained in a single relevant loci-set, if such a set exists. in practice, causal snps can probably span across multiple loci-sets, without accounting for the imperfect snp classification that might arise, for instance, from the empirical definition of the boundary of a loci-set. under these conditions, application of the ks statistic will result in the attenuation of the overall significance of the relevant loci-set. another limitation pointed out by the authors is the need to carry out the computationally demanding permutation of sample labels, instead of the faster gene label permutation to properly assess the statistical significance of the ks statistic. when many loci-sets have to be tested, the computational challenge is increased since a larger number of permutations have to be performed so as to detect significant association with correction for multiple hypothesis testing.

the method we describe below addresses these two issues. glossi scores loci-sets by an alternative strategy that only focuses on information from within a loci-set and allows the determination of significance level with relative computational ease.

RESULTS
fisher's combined probability test
suppose that the data collected are from i independent subjects on j loci, where the number of loci genotyped is typically much larger than the sample size, i.e. j >> i. let yi represents the phenotypic measurement for the i-th subject, i =  <dig> ..., i, with the phenotype being understood in a broad sense as for instance a binary or multiclass label, a continuous quantity, a censored variable, or even count data. for illustration purposes, we assume here that the phenotype is binary . using a standard encoding of the genotype as a count of the major allele, we denote the genotyping data as:

  

with i =  <dig> ..., i and j =  <dig> ..., j. also, let gjk be an indicator variable indexing the k-th loci-set, i.e. for j =  <dig> ..., j and k =  <dig> ..., k 

  

a measure of statistical significance is first calculated between each of the j loci with a chosen binary phenotype . either allele or genotype frequencies can be used as the basis for testing a locus in terms of its ability to distinguish the two phenotypic classes under study. various statistical approaches are appropriate for deriving the p-value, from contingency-table-based methods: fisher's exact test, pearson's χ <dig> test, or cochran-armitage trend test; to regression-based techniques: logistic analysis, probit analysis, or complementary-log-log analysis. these approaches could have widely different methodological assumptions, specifically on the way in which the phenotype depends on the loci . because it is a common belief that the additive assumption is generally adequate for complex disorders, we opt for the cochran-armitage trend test in view of its statistical power. the trend test statistic is formulated in the method section. henceforth, we denote p-value for the j-th locus by pj.

the null hypothesis of no association between yi and sij implies that pj is distributed as a standard uniform random variable, taking values in the interval  bahadur optimal. however, the assumption of independence is not tenable in a high-throughput gwas even if only tag snps are used in the study. basing inference on the independence assumption could therefore greatly inflate the apparent statistical significance of a loci-set, leading to more false positive findings. for this reason, we suggest correcting for correlation using brown's approximation  <cit> :

  

with  in which Ω is the covariance matrix of t. brown showed in his paper that the approximation works well in general except when tj's are highly negatively correlated. since correlations between tjs from two-sided tests can only be positive, the approximation should be adequate for most genetic association studies. note that Ω is unknown and needs to be estimated. we chose to perform the estimation through shuffling the phenotype labels  <dig> times, though smaller number of permutations are often sufficient to attain a stable estimate for Ω. details of the permutation scheme are deferred to the method section.

simulation study
in order to objectively assess the potential of the proposed methodology, we conducted a simulation study. a web-based tool, namely hapsample  <cit> , was used to generate case-control samples with genetically realistic genotypes. we restricted the simulation to a subset of snps interrogated by the sentrix® humanhap <dig> beadchip  <cit> , which consists mostly of tag snps. more explicitly, a total of  <dig>  snps no more than  <dig> millions bases away from the end of each autosome were retained in the study. of these, we filtered out  <dig> loci based on the following criteria:  <dig> are not in the hapmap phase i/ii data  <cit> ;  <dig> have a minor allele frequency  of zero according to the hapmap project ; and  <dig> lie near the edge of some chromosomes which possess linkage patterns  that are not compatible with the simulator recombination algorithm.

the genotypes of the remaining  <dig>  loci were simulated with  <dig> settings, i.e. the null hypothesis  and  <dig> distinct alternative hypotheses, reflecting varying numbers of snps associated with the case-control status and different effect sizes . an artificial loci-set was affixed to each scenario, but only two distinct sets were introduced to enhance comparability. we created the loci-sets and fixed causal snps as follows. given a certain maf value , two snps at least  <dig> million bases apart were randomly picked from the chromosomes. we assigned a fraction of them, or one of their 'untyped' linkage disequilibrium  counterparts  in scenarios 19– <dig>  as containing a high risk allele. note that either none or only one snp per autosome was assumed causative in compliance with the constraint of hapsample. moreover, we assumed additivity on the phenotype-genotype relationships and considered the causal snps as independent from each other. all snps located within  <dig> kilobases upstream or downstream  of the  <dig> selected loci constitute a loci-set. this resulted in  <dig> members in the maf =  <dig>  loci-set while the size of the other set was  <dig> 

*rr  = relative risks  when a loci carries two disease alleles, assuming an additive model; †maf = minor allele frequency of the utah samples in the hapmap project. ‡three out of the  <dig> original causal snps, generated under the case where maf equals  <dig> , are not in high ld with any snp genotyped in the hapmap phase i/ii project. disease prevalence and crossover rate are fixed at 25% and  <dig>  centimorgan, respectively, in all simulations.

every single simulation setup was replicated a thousand times for each of these case-control sizes: 200– <dig>  400– <dig> and 1000– <dig>  in other words, a total of  <dig> thousand independent data sets were generated. glossi was run on the simulated data sets one-at-a-time and the resulting significance levels of the hypothetical loci-sets were stored so as to evaluate statistical power and type i error rate. these were derived as the proportion of loci-set p-values achieving a smaller numerical value than  <dig> . as would be anticipated, the distribution of p-values under the null hypothesis closely resembles the standard uniform distribution . the empirical type i error rates, calculated under  <dig>  as well as two other popular nominal levels, are presented in table  <dig>  all type i error rates are within the 95% confidence intervals of the specified levels . this leads us to conclude that glossi offer adequate results in the true null scenario.

the results for  <dig> affected and  <dig> unaffected samples under the varying alternative hypotheses are graphically documented in figure  <dig>  despite having a smaller fraction of causal snps than the corresponding maf =  <dig>  set, the enriched maf =  <dig>  loci-set is more readily identified by glossi as significant. it is surprising to see that relatively higher power is obtained in cases where causal snps are not 'genotyped'. this is counterintuitive and likely to occur by chance, but it requires further investigation. it should also be noted that the method displays very low statistical power when only  <dig> causal snp was included in the loci-set. the capability of detecting one-snp enrichment stays below the standard 80% cut-off level for the other sample sizes considered in this study . figure  <dig> shows the relationship between sample size and power for some representative scenarios in which sufficient power was attained at the total sample size of  <dig>  given that we fixed less than 10% of the snps in the maf =  <dig>  loci-set as causative, glossi exceeds 80% power when i.) relative risk  is  <dig> and sample size is  <dig>  ii.) rr =  <dig>  with  <dig> samples, or iii.) rr =  <dig>  with  <dig> cases and  <dig> controls. in summary, higher rr, larger maf, increased number of causal loci and bigger sample size all have a positive impact on the power.

it is of interest to compare the performance of glossi against the modified ks approach proposed by wang et al.  <cit> . to this end, eight additional non-overlapping regions  were randomly picked from each chromosome. we altered the extension of the newly selected regions to either double, equal or halve the size of the hypothetical genes in the loci-set. these were used to create a reference distribution in the modified ks test. without loss of generality, we focused the comparison on the null and two alternative hypotheses with the use of our data set of  <dig> cases and  <dig> controls. scenarios  <dig> and  <dig> were chosen here because their powers were near 80% in the case of glossi.

outputs from the modified ks test on the basis of both phenotype and gene label permutations under the null hypothesis are summarized in table  <dig>  when there is inequality in the gene sizes in and out of the loci-set, gene label shuffling, though less computationally burdensome, can lead to substantial deviation from the nominal type i error rate of 5%. it offered satisfactory result when the size of all the hypothetical genes was set to be the same. in contrast, resampling case-control status appears adequate for the null distribution regardless of the relative size of genes. however, size of genes did have an influence on the power of the modified ks statistic in the two tested non-null hypotheses even when sample label permutation was applied. proportion of significant p-values  was calculated to be  <dig> % ,  <dig> %  and  <dig> %  for scenario  <dig> and  <dig> % ,  <dig> %  and  <dig> %  for scenario  <dig>  the ks statistic seemed to parallel glossi  in power when larger genes were used as reference.

we speculated in the background section that causal loci in genes not belonging to the query loci-set can dilute the degree of significance and, therefore, statistical power of the ks statistic. moreover, the power should drop as the fraction of genes with causal snps outside of the loci-set increases. to test these, we reassigned two snps  in different genes of the reference set as causative. since hapsample can only handle  <dig> causal locus per chromosome, we study the change in the proportion of loci being causative by decreasing the number of hypothetical genes not in the loci-set from  <dig> to  <dig> and then to  <dig>  results from case-control label shuffling are presented in table  <dig>  as expected, scenario  <dig> with more snps having high risk alleles is less susceptible to the 'contaminants'. although the simulation setup is somewhat artificial, it supports our claims in general.

antihypertensive response example
glossi was used in this example to identify potentially instructive loci-sets for their influences on diastolic blood pressure  response to hydrochlorothiazide in the genetic epidemiology of responses to antihypertensives study   <cit> . on the basis of the age and baseline dbp-adjusted distribution of dbp response, the study group was partitioned into race-and-gender specific "good", "intermediate" and "poor" responders. raw intensity data obtained via the affymetrix genechip® human mapping  <dig> k set  <cit>  were available for  <dig> african americans  and  <dig> non-hispanic caucasians . genotype calls were made through the use of dynamic modeling algorithm  <cit> . the following snps were excluded from the analysis: on the x-chromosome, monomorphic, maf < 2%, "call"-rate < 80% or deviated from hardy-weinberg equilibrium at p < . <dig>  thus our illustration is based on  <dig>  and  <dig>  post-filtering snps in the black and white samples, respectively. see turner et al.  <cit>  for a detailed description of the study design and procedures taken to preprocess the affymetrix data. we derived loci-sets from  <dig> generic and human-specific functional sets of the publicly accessible molecular signature database . only snps located within  <dig> base pairs upstream or downstream of a gene  were considered relevant to that gene. table  <dig> reports the most significant loci-sets from applying glossi on all non-empty loci-sets . q-values  <cit>  were calculated to guard against the cost of multiple hypothesis testing. this provides an expected proportion of false positives among loci-sets with unadjusted p-values at least as extreme as the current set of interest.

glossi reported  <dig> loci-set with a q-value lower than 5% in whites but no loci-set passed this cutoff in blacks . the size of the  <dig> loci-sets ranges from  <dig> to  <dig> snps. this result is quite encouraging since single snp methods previously applied to the same datasets could not detect any snp that was statistically significantly associated with dbp response to hydrochlorothiazide . among the top ranking loci-sets of the populations, two were derived from the same gene expression experiment of kidney transplant biopsies  <cit> . these loci-sets are 'upregulated in acute rejection transplanted kidney biopsies'  for non-hispanic caucasians and 'upregulated in well functioning transplanted kidney biopsies'  for african americans. although biological interpretation of the results is not straightforward, one can hypothesize that genes in those two loci-sets are related to kidney pathophysiology or normal physiology and, therefore, may be relevant to sodium excretion, blood pressure regulation, and dbp response to diuretic therapy. one could also speculate that the different physiological mechanisms indexed by these two loci-sets are consistent with known differences in diuretic response between black and white individuals with hypertension.

other loci-sets are less informative and harder to interpret. inspection of their names suggests that several of the significant loci-sets in whites could conceivably be involved in regulation of antihypertensive drug response. these include 'growth hormone signaling pathway' , 'calcium signaling by hbx of hepatitis b virus' , and 'insulin signaling pathway' . the relationship of some other loci-sets with dbp response to hydrochlorothiazide requires a more speculative interpretation. for example, a few of them appear to be related to cell growth regulation but with no obvious relationship to blood pressure. however, a possible connection could exist through mitogenic hormones that are often vasoconstrictive and antinatriuretic and, therefore, would elevate blood pressure . conversely, vasodilating and natriuretic hormones that lower blood pressure are often anti-mitogenic .

CONCLUSIONS
the glossi methodology for scoring loci-sets  overcomes limitations of commonly-used single snp approaches. the origin of a loci-set facilitates the interpretation of statistical outputs, providing a biological understanding of the mechanisms that underlie diseases or other phenotypes of interest. in contrast to the approach of wang et al.  <cit> , the proposed procedure is parametric: it assumes that p-values from individual snps follow a standard uniform distribution under the null hypothesis of no association and infers statistical relevance of each loci-set against a χ <dig> distribution. consequently it has the advantage of computational speed, demands measurements only of snps within the query loci-set, and imposes no constraint on the size of the set. although we only focus on binary phenotypes in this communication, the technique is general and equally applicable to other kinds of outcomes or any types of genome-scale data. in particular, the locus-specific p-values could be generated by statistical methods equipped with the ability to control for the presence of covariates . appropriate adjustment for additional covariates would allow more accurate estimation of the true genotype-phenotype effect. the performance of the proposed method was evaluated by using computer simulated data as well as data from an antihypertensive pharmacogenomic study. in the simulation study, glossi yielded the anticipated type-i error rate when no snp in the loci-set was related to the binary outcome. also, it demonstrated sufficiently high power for detecting loci-sets in which a fair number of snps  had moderate to large effect sizes and intermediate maf values. in the real data example, the proposed method appears to have been able to identify novel loci-sets not previously known or suspected to be involved in blood pressure regulation or antihypertensive drug response.

the lack of firm biological interpretation in the antihypertensive response example underlines one of the limitations of our method. although glossi is capable of detecting relevant loci-sets as demonstrated in the simulation experiment, its usefulness depends directly on the definition and availability of loci-sets when applying it to biological data. the currently available functionally annotated loci-sets are biased toward groups of genes involved in cancers since most of them were derived from such disease studies but very few of them focus on blood pressure or kidney-related investigations. undoubtedly, more annotated and curated loci-sets will be available over time, which in turn will increase the applicability of glossi for a given disease phenotype. the definition of a loci-set itself can also be challenged. the current assignment of snps to a gene, according to fixed physical distance boundaries from that gene, might not be optimal, not even in principle, let alone given the uncertainty in determining the appropriate fixed distance.

it must be stressed that glossi only accounts for the additive, independent effect of individual snps and, therefore, ignores possible biological interactions that might exist. the joint effect of snps within a loci-set can be captured using multivariate methods  <cit> . however, a fair comparison of multivariate models derived from various loci-sets is hard to achieve since it demands sample label permutation testing. more specifically, the statistical model needs to be rebuilt for every loci-set in each permutation, which quickly becomes impractical as the numbers of loci-sets and permutations increase. other complications that might arise during the application of multivariate analysis include overfitting and model instability. to balance the need for joint effects modeling with computational time effectiveness, one can envision developing a hierarchical approach that first uses glossi for rapid identification of significant loci-sets followed by more extensive multivariate modeling. this approach is currently being investigated in our group.

