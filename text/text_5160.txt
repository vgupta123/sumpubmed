BACKGROUND
introduction
the major issue when studying datasets with many tests and few replicates in general and microarray datasets in particular is the decreased power of the analysis. indeed, to reduce the risk of detecting false positives due to the lack of a sufficient number of replicates, statistical tests allow for higher threshold levels as the number of replicates decreases. this implies an unavoidable increase of the number of false negatives and, thereby, a decrease in power.

to compensate for this lack of information about expression data generated by microarrays, some authors have tried to work at the probe level, breaking down probesets into smaller components. nonetheless, most researchers prefer to work at the probeset level where data can be analyzed in different layers   <cit> .

among these methods, the analysis of genesets with regard to known or observed biological criteria holds high potential for fundamental as well as clinical research. for example, members of the same metabolic pathway can be studied simultaneously to assess modifications of the pathway under certain conditions, such as the action of a drug, or to diagnose a pathology, etc.  <cit> . this last application is common with genesets called "signatures", devised for certain pathologies based on coexpression  <cit>  or clustering studies  <cit> . the study of genesets involves two complementary tasks:

- group discovery: empirical data is used to identify new criteria to discover new genesets. this task uses several different approaches such as data clustering  <cit>  and the study of regulatory sequences  <cit> ,

- geneset analysis: previously defined genesets are used to guide empirical data analysis, to determine whether the expression values of known genesets are correlated with the conditions compared in the experiments  <cit> .

the research presented here focuses on statistical geneset analyses. our initial motivation was to answer the seemingly trivial question : "which known genesets are associated with different expression profiles under the two conditions compared?". we discuss here the ability of current methods to provide an answer to this question.

this main question q <dig> implies several hypotheses related to the nature/composition of genesets tested: the individual members  may be expressed at various levels, over- or under-expressed or correlated .

to provide an answer to question q <dig>  we present the faeri methodology , an anova-2-like procedure tailored to detect genesets with differing expression profiles, regardless of the nature of the individual responses.

state of the art
several geneset analysis methods have been published recently. each available method provides an answer to question q <dig>  the methods discussed below were selected to provide an overview of the main strategies followed by the authors, or due to their pioneering approach.

over-representation analysis methods are not considered in this paper, as they focus on the top list obtained by individual analysis and aim to identify only those groups of genes that are represented by the most differentially expressed probesets. this approach thus facilitates the interpretation of individual analyses, by giving annotation clues about biological meaning. however, such methods require the ad hoc selection of an individual statistic, and the definition of an arbitrary threshold for the detection of individual genes, whatever the individual statistic used. thus, over-representation analysis does not allow for the detection of genesets associated with subtle individual changes according to the individual statistic chosen  <cit> . for this reason, other authors describe improved ora strategies. as an example, yi and stephens, in slepr, first select sample-level differentiated genes from each individual sample, before computing an enrichment score characterizing the geneset  <cit> .

question q <dig> covers all the others; therefore, a method answering this question answers all the others.

more recent functional class scoring  methods can be classified based on their competitive or self-contained null hypothesis. competitive methods sort the groups focusing on question qcomp   <cit> . such methods provide a list of genesets that are the most significantly associated with the phenotype compared with other geneset definitions. the definition of the null hypothesis of the competitive methods is theoretically associated with the gene-sampling strategy for significance evaluation   <cit> . this statement, however, as shown by effron and tibshirani, does not take into account the pattern of correlations between genes, which is destroyed by gene-sampling  <cit> . conversely, self-contained methods study question qself . the significance of the results, for those methods, is evaluated by label sampling . each geneset score is thus evaluated against its putative range of geneset score values, maintaining the geneset definition  <cit> .

the gsea methodology and its derivatives make use of a hybrid strategy providing results that are harder to interpret. the null model used to develop the methods relies on the competitive approach, but is later evaluated by label sampling, thus mixing both strategies  <cit> .

the second methodological difference between the methods concerns definition of the geneset score evaluated. methods using two steps first compute an individual statistic that is then used in a second step to compute a geneset statistic  <cit> . conversely, global methods perform the analysis in a single step, evaluating geneset statistics from raw expression values associated with the group members   <cit> . samgs is a particular case of a global method where the final formulation of the statistic is similar to a two-step strategy using the sam t-like individual statistic  <cit> .

questions studied by the methods
current methods do not provide equivalent answers to question q <dig>  therefore, we propose to reformulate the hypothesis used with the available methods with respect to the biological properties of the sets .

the methods are grouped into categories. the upper and lower parts of the table list respectively the competitive and self-contained methods. the methods highlighted in bold rely on a two-step procedure. the methods in plain writing rely on a global analysis, which uses the expression data to compute the geneset statistic in one single step, based on multivariate models. finally, anova- <dig> and faeri are shown in italics.

question q <dig> includes all of the other questions  related to the nature of the groups tested. three criteria must be taken into account to describe the groups: expression levels , the direction of the expression change  and correlations between the group members .

 it is important to study expression levels as highly expressed probesets may mask differences observed for probesets with lower expression levels. two-step methods such as the samgs are not influenced by this criterion. for example, the student t or samgs d statistics characterize expression differences, regardless of the individual expression levels  <cit> . moreover, global methods that rely on the i.i.d. condition may be affected as expression levels vary between probesets, meaning that the probesets are not identically distributed.

 individual expression values may reveal up or down regulation of the genes depending on the conditions tested. one way to take the direction of expression changes into account and deliver results with no dependence on this criterion is to avoid studying mixed groups with a global null effect . two-step methods may be adapted to use the absolute value of a unidirectional individual statistic , or its squared value . alternatively, the geneset statistic may be defined to be representative of the directional subgroup associated with the biggest expression change , optionally with regard to the size of the directional subgroup   <cit> . among global methods, the samgs and globaltest are independent of the direction as the null hypothesis is tested respectively on squared statistic  and expression change variability   <cit> .

 genes may be associated with correlated or variable expression changes. question q <dig> takes both possibilities into account. two-step methods based on a sum or a mean, like the samgs, do not need further adaptation since they explicitly rely on the sum of individual pieces of information  <cit> . the total difference is then evaluated independently of the variability of the individual differences. among global methods, the globaltest is suited for the study of uncorrelated genesets as it assesses the variability of the individual answers. on the contrary, the globaltest is not intended to detect correlated groups since the variability of the individual answers in such sets is null   <cit> .

it appears that only two-step methods, as well as the samgs, may simultaneously provide an answer to the three criteria considered and thus evaluate more completely question q <dig> 

software packages developed thus far are not always able to fine-tune the appropriate combination of steps with regards to the criteria. moreover, it is not systematic to take the direction of the answer into account or to rely on partial genesets   <cit> .

global methods, on the other hand, ignore the possible bias associated with expression level. the samgs procedure involves a preliminary step of variance stabilization based on the sam individual analysis method, which requires that the expression values of all probesets be estimated  <cit> .

competitive procedures aim to identify groups with bigger differences and ignore groups associated with the phenotype but with a moderate answer compared to the others. the self-contained null hypothesis thus provides a more appropriate answer, where each set is evaluated according to its possible distribution range  <cit> .

objectives
there are several possible strategies to evaluate question q <dig> as completely as possible. several methodologies may be selected to answer complementary questions. gentleman et al. previously suggested to separately study sub-groups defined by the direction of expression changes and to define core sets of genes common to several genesets . as a perspective of the globalancova methodology, mansmann and meister proposed to study the interaction between the effect of the condition and group composition, to take the variability of the individual responses into account. the hypothesis associated with this test complements the unidirectional null hypothesis, but also provides a partial answer to question q <dig> since it ignores unidirectional correlated groups .

the work reported below proposes an alternative strategy to answer question q <dig> based on a single self-contained test. to optimally analyze expression data, our model relies on a global strategy because two-step methods suffer from a loss of information  caused by the substitution of data with individual statistics. we introduce the faeri method that was tailored from the 2-factor anova procedure. our aim was to group the information associated with individual differences into one single statistic taking direction, correlation and expression level into account and to combine the advantages of the globaltest , globalancova  and samgs  models whilst avoiding their respective limitations.

methods
datasets
hypoxia datasets
bosco et al.  described the e-mexp- <dig> dataset, available in the arrayexpress repository. the experiment compares samples extracted from human monocytes. rna was hybridized on  <dig> affymetrix hgu-133a microchips, among which  <dig> normoxia samples and  <dig> samples from cultures grown under hypoxic conditions  <cit> .

vengellur et al.  studied cellular response to hypoxia on human hep3b hepatocytes cell lines, considering  <dig> additional treatments known to mimic hypoxic conditions: cobalt chloride , nickel chloride , and dfo . mrna was extracted separately from two biological replicates, and crna was hybridized on affymetrix genechip hg-u95av <dig> microchips. we used part of this dataset to compare samples grown under normoxic and hypoxic conditions, and did not use the other samples . this dataset is available on geo   <cit> .

kim et al.  described the gse- <dig> dataset, available on geo. the authors studied cellular response to hypoxia on human b lymphocytes . two biological replicates were used to extract mrna from separate cultures. crna was hybridized on affymetrix genechip hg-u133a microchips  <cit> .

in the work reported here, the three hypoxia datasets were preprocessed using gcrma to study the effect of hypoxia and compare the ability of each geneset analysis method to detect common pathways from several datasets featuring a limited number of replicates.

xiao et al.  report a study of osteoporosis using microarrays hybridized with  <dig> low and  <dig> high bmd samples . b-lymphocyte mrnas were isolated from  <dig> ml of blood, and crna was hybridized on affymetrix genechip hg-u133a microchips. this dataset is available both on geo  and arrayexpress   <cit> . we used this dataset, preprocessed with gcrma, to illustrate the development of the faeri methodology.

introduction to faeri
as several genes are associated with multiple probesets, a bias could be introduced during the analysis at the geneset-level. in the work reported below, we used only one probeset for each gene studied on the microchip, by selecting the probeset associated with the largest variability, to avoid giving too much weight to a gene due to the number of associated probesets. as a result of this selection, the words "probesets" and "genes" are synonyms in this text. the multiplicity of the probesets is not considered in this publication.

the analysis of variance or anova relies on the study of the variability of the data with respect to one or more criteria to determine if that criterion is responsible for the values observed. the simplest model, relying on a single criterion is equivalent to the student t test  <cit> . when analyzing differential expression, a one-way anova can evaluate the involvement of probesets under two or more conditions. the anova with two classification criteria allows for study of the differential expression of a set of probesets .

the model that we chose to test the validity of this approach states that the expression data observed can be explained by dependence of the intensities measured on the probesets, the condition and the interdependence between those two parameters, since each probeset can potentially be associated with a different response under each of the tested conditions.

the mathematical representation of this model is given by equation  <dig> 

  xk=μ+ai+bj+abij+ek 

where μ is the general mean, ai is the contribution of factor a, bj is the contribution of factor b, abij is the contribution of the interaction of factors a and b and ek is the residual contribution.

the comparison between the different criteria relies on the ratio of the mean squares associated with each criterion. the statistic computed for each criterion is evaluated by fisher's f distribution using the appropriate number of degrees of freedom .

  fa=msamse~f) 

  fb=msbmse~f) 

  fab=msabmse~f;nanb) 

where fx is the f score associated with factor x, msx is the mean square value associated with factor x, nx is the number of levels for factor x.

it is important to note that when the effect of the interaction is significant, no decisions can be made for the other criteria. the study of the effect associated with the condition is close to the globalancova method  <cit> . the study of the interaction is similar to the globaltest methodology and to the perspectives formulated by mansmann and meister , since the genesets within which probesets present a different answer are biologically interesting  <cit> . we state that this test must be complemented with a test on the condition because it is impossible to detect unidirectional and correlated changes by studying the interaction alone. to circumvent this limitation, we present a strategy in the next section for analysis of the faeri methodology designed to simultaneously answer all possible configurations in a single test. for more details on the procedures of the faeri methodology, see the additional file  <dig> .

faeri
geneset analysis of differential expression is influenced by the direction of the expression changes of the members and by possible interactions between the probesets and the conditions  <cit> .

expression level
probesets belonging to the same geneset can be expressed at various levels. from a biological point of view, a weakly expressed geneset might have a bigger impact on physiology than a strongly expressed one. we propose to standardize the data so that, in principle, all the probesets have the same potential for response under two conditions compared, based on a classical reduction of data producing z values. the standardization is computed for each probeset using equation  <dig> by pooling the data associated with both conditions and computing the observed mean and variance. the resulting reduced data is distributed around a mean value of  <dig> with a variance of  <dig>  the information about the difference between the conditions is retained. at the end of this operation, the result of an individual analysis based on the student t is unchanged. note that this procedure renders data closer to the conditions of application of the anova  <dig> .

  zij=spool,i 

where xij is the expression value associated with the ith probeset in the jth microchip, mpool, i and spool, i are the means and standard deviations computed for probeset i from all experiments . this procedure is repeated for each probeset in the dataset.

direction of differential expression
several probesets may be activated or repressed at the same time, but may also be associated with a variable expression change, depending on the biological context studied and the definition of the genesets. to provide a full answer to question q <dig>  with no dependence on the direction of differential expression, two approaches can be proposed: up- and down-regulated probesets may be studied separately or simultaneously by computing a cumulative value for the absolute difference. the first solution consists of defining "activated" or "repressed" genesets to conduct a proper analysis. this approach relies on current knowledge that is incomplete, but is useful for diagnosis purposes to determine whether a patient has a pathology by analyzing signature genesets. the second solution is addressed by several methods by defining an individual statistic independent of the direction   <cit> .

using a multivariate procedure, we propose to study the absolute response of the genes by directional reduction of the data. this operation involves multiplying the expression values related to down-regulated genes by - <dig> . the down-regulated genes are identified empirically from the expression data studied.

  zijd=sign×zij 

where di = mib - mia, the difference in means between conditions a and b for the ith probeset, zij = z-score associated with the ith probeset in the jth microchip, and zdij the directionally reduced z-score associated with the ith probeset in the jth microchip.

it may be interesting to consider the median instead of the mean to evaluate the direction of differential expression. however, the performances tests we conducted previously in individual expression analyses show a reduction in the performance of the student t test when using the median as the estimator  <cit>  on biological data .

after this 2-step reduction of the data, faeri evaluates an f statistic as is done in the anova- <dig> procedure . the faeri f* statistic associated with the condition effect is representative of the differences found based on biological reasoning. each gene provides information on its differential expression, independently of the direction of that difference, and the absolute value of the individual t statistic remains unchanged.

null distribution
due to the dependence on geneset size introduced by directional reduction, the significance of the results cannot be evaluated using fisher's theoretical distribution, which is used by the anova procedure. we will refer to the statistic computed using the faeri methodology as f*. we tested two solutions to determine the null distribution of the faeri f* statistic, relying either on permutations or the use of random data.

the permutation strategy associated with a self-contained null hypothesis relies on label sampling  <cit> . given the null hypothesis that no probeset is involved under the conditions compared, the permutations of the labels are performed independently for each probeset, independently of the correlation between the members of the geneset.

due to the z value reduction step, a second strategy may be used to evaluate the null distribution of the faeri f* statistic. indeed, as the null hypothesis states that there are no differences between the two conditions compared and as we postulate that individual expression values follow a normal distribution, z standardization provides the possibility to establish the null distribution using random data from a normal distribution, and then apply the same 2-step reduction to compute the reference f* <dig> values. under the null hypothesis, the f* statistic computed on reduced test data should follow the same distribution as the f* <dig> statistic computed from reduced random data. conversely, if the expression values of the geneset differ between two conditions, the f* statistic distribution leads to higher values than the f* <dig> values computed from random data.

this possibility to compute a reference distribution based on random data frees the faeri method from the limited number of available permutations. moreover, for each experimental strategy  and each geneset size, the null distribution can be computed once and stored for future analysis.

RESULTS
the effects of two-step reduction
as presented in the introduction, we propose to take the level of individual expression into account, using a first-step reduction of the data. figure  <dig> illustrates the results obtained when applying anova- <dig> to the raw data and to the reduced data. in both cases, the effect of the condition factor was compared to the interaction between the condition and the probeset. comparison of the p-values associated with the two effects, before and after standardization, shows that expression levels are an important criterion: a very large number of groups are significant for one of the two effects or for both when each probeset is considered on even ground. this suggests that a very large number of genesets are made up of members distributed at various expression levels and that the expression change of several weakly expressed probesets is masked by strongly expressed probesets when raw data is used.

in the second step of faeri, we used a directional reduction to obtain a cumulated value of absolute expression changes in the genesets. we chose to use an empirical determination of the direction, easier to assess from the data than from prior incomplete knowledge. as the sign of the reduced values is not a feature of the biological mechanisms involved within genesets, the description of the mechanisms involved should be associated with individual analysis of the member genes based on raw data.

we tested two procedures to assess the significance of the f* statistic. figure  <dig> shows that the computed p-value is independent of the number of members in the set, regardless of the procedure used. figure  <dig> shows that the p-values evaluated using permutations or random data are perfectly correlated when simulated data is analyzed, but that a great number of genesets display different behavior when biological data is analyzed. this observation illustrates that the variability of biological data cannot be modeled by generating a null distribution from iid random data, as both procedures do not provide similar p-values when real-world data is analyzed. in biological samples, each gene may be expressed at a variable level of expression, with gene-specific variability. furthermore, a correlation exists between genes, so that their distribution is not independent. the evaluation of permutations leads to a higher number of extreme values, as co-occurring expression changes are more likely to be observed using biological data.

mansmann and meister recommend assessing the significance from permutations instead of the fisher distribution when analyzing microarray data with a multivariate procedure. their globalancova procedure evaluates the significance of the test using the label-sampling strategy instead of the classic fisher distribution  <cit> . the globalancova procedure does not include a z-reduction step, and the iid requirement is not met due to gene-specific expression levels, gene-specific variability, and gene correlation patterns.

performance evaluation
performance evaluation on simulated data
several authors have stressed the need to compare the performances of geneset analysis methods with regard to the correlation between geneset members  <cit> . to this end, marit ackermann et al. developed a simulation scenario focusing on  <dig> geneset definitions  <cit> . each set is generated randomly by a multivariate normal distribution using the definition of a correlation/covariance matrix. table  <dig> summarizes the parameters used to fine-tune the simulation of the sets, focusing on the correlation structure, direction of simulated differences, and proportion of members differentially simulated. each set was simulated with  <dig> replicates for each condition and included  <dig> members.

we reproduced the simulation proposed by ackerman et al. to assess the performances of anova- <dig>  faeri and several geneset analysis methods currently available, to obtain a comprehensive understanding of the performances with regards to the mathematical structure of the data. each set was simulated  <dig> times and table  <dig> summarizes the detection rate associated with each set, when the selection threshold was set to  <dig> ,  <dig>  and  <dig>  for the p-values. histograms of the p-values resulting from the analysis of set no.  <dig> with each method are also provided in the additional file  <dig> 

each set of measurements presented was generated  <dig> times. the measurements in the table show, for each method, the number of detections of the different sets of measurements defined. the upper part of the table presents the results for unidirectional genesets only  and the lower part concerns groups with a simulated mixed answer . the data related to h <dig> shows the number of genesets detected by chance .

comparison of the results illustrates the effect of correlations between members of the sets. for each method tested, the presence of intra-set correlations reduces the performance of the analysis. for the simplest simulated sets , anova- <dig> provides the best results, followed by faeri  and globaltest, as evaluated using a gamma distribution or permutations .

moreover, the anova- <dig> and faeri procedures are both associated with higher performance compared to all other methods based on the simplest simulation scenario . indeed, faeri detects set  <dig> in 62% of the cases, with a threshold of  <dig>  and no false positives . at this threshold, faeri is able to detect roughly  <dig> times more genesets than the best performing method currently available . as a comparison, samgs and globaltest require a threshold that is  <dig> times higher to detect only 60% of set  <dig>  comparison of sets  <dig> and  <dig> highlights the method's abilities to detect genesets where half of the members are not differentially expressed. in this case, faeri detects 43% of the genesets, compared to 15% when applying globaltest with a gamma distribution. the anova- <dig> and faeri procedures thus appear to be the most appropriate to analyze unidirectional genesets.

the lower part of table  <dig> concerns sets simulated with mixed differences in two directions . the behavior of the methods differs: the anova- <dig> and gsa methodologies , as well as gsea, are not appropriate to analyze such sets. for each bidirectional set tested, the faeri methodology performs best, with the exception of set  <dig> where samgs provides better results for a threshold below  <dig>  . the presence of a correlation between the members reduces the performance, as shown for the unidirectional scenarios.

to ease interpretation of method's performances with regard to the mathematical structure of the genesets analyzed, table  <dig> presents the ranking of the methods for each type of set simulated, using a threshold of  <dig>  for the p-values. the statistic used was accuracy . the scores above 75% are shown in bold.

comparison of the number of true positives and true negatives to the total number of tests /. for information, we also computed the mean value for the  <dig> types of groups studied. the significance threshold to select groups was set at  <dig> . the highlighted  values are relative to methods obtaining a score of more than 75%. the four global methods are more appropriate for geneset analysis and the two-step methods show poor performance. among the global methods, only anova- <dig> and faeri happen to be suited for unidirectional correlated genesets. faeri and samgs are the only methods adapted for the study of bidirectional correlated genesets. across all genesets tested, the methods giving the best results were: faeri , faeri , samgs , globatest , globatest , samgs , globaltest . faeri is the only method suited for the study of all types of genesets tested.

• anova- <dig> is the most appropriate method for unidirectional groups;

• globaltest, which uses a statistic representative of response variability, is suited for the study of both uni- and bidirectional non correlated genesets;

• samgs, using an individual statistic, appears to be less appropriate for the analysis of correlated genesets, since this information is lost during the procedure;

• faeri, developed to detect sets independently of their mathematical structure, is appropriate for each type of set tested;

• anova- <dig> and faeri provide an appropriate analysis of sets with correlated members, respectively using unidirectional and bidirectional definition of sets;

• methods making use of a two-step strategy provide lower performance levels .

real data: study of hypoxia
analysis of a genuine biological dataset offers the opportunity to qualitatively evaluate the results and provide a biological validation of geneset analysis methods through comparison of the results with current biological knowledge. we chose to use three datasets related to response under hypoxic conditions. the definition of the genesets relies on the msigdb databank , published by the authors of the gsea methodology  <cit> . msigdb consists of several libraries of genesets . the analysis reported below focuses on the c <dig> kegg category.

for each geneset, the p-values obtained by each method are listed. the values in plain text are not significant. the p-values of the significant  and highly significant  genesets are shown in bold. the two last columns give the p-values obtained for datasets gse- <dig> and gse- <dig> by faeri.perms, to illustrate the coherence of the results presented.

this list can be split into  <dig> categories. first, genesets concerning several metabolic pathways suggest metabolic adaptations occur as a cellular response to oxygen deprivation. second, several genesets address signaling pathways and are known to be involved in the hypoxic stress response. genesets of the third category are related to pathologies, mostly involving cancers, for which a hypoxic environment has been observed  <cit> . these results illustrate the ability of faeri to detect groups known to be involved in hypoxic responses or hypoxia-related pathologies, and to detect those groups independently in  <dig> datasets related to hypoxia. in particular, we should point out the strong coherence between genesets detected by faeri on a small number of replicates , either within the top list or between top lists associated with the three datasets.

these observations should be followed-up by a characterization of the genesets detected by the other methods. table  <dig> lists the genesets detected with high significance  by at least one geneset analysis method , and compares the p-values assigned to these genesets by each of the methods tested . we observe that gsa.mean, globaltest , gsea and samgs do not find any geneset to be highly significant. the sets detected by globaltest.gamma are also detected as significant by its equivalent based on an asymptotic distribution. several genesets detected and considered to be significant by faeri are related to hypoxia . overall, the p-values attributed by faeri to all the genesets detected by other methods are small, which confirms the ability of the method to assign lower scores to genesets related to hypoxia and detected by the other methods. other genesets can be considered to be related to hypoxia, even indirectly . the nature of these genesets suggests however that their relationship with hypoxia is of lesser importance than genesets known to be involved in the hypoxic response . faeri assign a higher p-value to such sets . when the significance threshold is set to  <dig> , the same conclusions can be made: gsea and samgs fail to detect any significant geneset. on the contrary, globaltest gives a much higher number of genesets, and this list is coherent with faeri  .

for each geneset, the p-values are given for each method we used.

as table  <dig> illustrated a correlation between the results provided by faeri on  <dig> related datasets, we compared each method's ability to discover common genesets from several related datasets. table  <dig> lists the number of genesets detected by each method for each of the three datasets, as well as the number of common genesets between the datasets. the analysis was performed using the c <dig> kegg category, on the e-mexp- <dig>  gse- <dig> and gse- <dig> datasets. the thresholds were set to  <dig>  and  <dig>  for the p-values. the anova- <dig> procedure, faeri  and globaltest detected several genesets with a higher level of significance , while gsea and samgs failed to detect any set, as mentioned previously. the gse- <dig> dataset contains only  <dig>  replicates, and thus the analysis revealed a large rate of false positives. therefore, we concentrated the analysis in table  <dig> on datasets gse- <dig> and e-mexp- <dig> 

the results are shown for each method, for significance thresholds of  <dig>  and  <dig> . the three datasets analyzed are e-mexp- <dig>  gse- <dig> and gse- <dig>  and concern the same condition . the first column contains the datasets analyzed. the first  <dig> rows of each table contain the top list obtained by each geneset analysis method. when several datasets are mentioned at the beginning of the row, the number of genesets in the other columns is the intersection of the results from different datasets

setting a significance threshold of 1% for the p-values, the ranking of the methods detecting more genesets common to the two experiments is the following: faeri.permutations , anova- <dig> , globaltest.gamma  and gsa.mean . the other methods do not intersect. when the significance threshold is set to 5%, the ranking of the methods is the following: faeri.permutations , globaltest.gamma , faeri.null , anova- <dig> , globaltest.asymptotic  and gsa.mean . the other methods do not intersect. these results suggest that the bidirectional genesets, detected by faeri and globaltest, are an important part of the genesets simultaneously involved in both datasets, compared with the anova- <dig> and gsa.mean procedures.

to quantify the abilities of the methods to provide the same result from different datasets, we propose to compute pearson's coefficients of correlation on the ranks associated with the genesets analyzed, by pairwise comparison of the three datasets, for each method and each category of genesets defined .

for all the categories tested, the faeri.permutations methodology is associated with a higher coefficient of correlation. conversely, the anova- <dig>  gsea and gsa.mean provide poorly correlated results. the coefficients of correlation obtained for the other methods are intermediary between these two extremes and depend on the geneset category.

CONCLUSIONS

