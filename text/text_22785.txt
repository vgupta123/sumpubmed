BACKGROUND
the most important epigenetic modification of vertebrate dna involves the addition of a methyl group to the carbon- <dig> of the pyrimidine ring of the cytosine in cpg dinucleotides   <cit> . the methylation of dna provokes a localized restriction of transcription that can be used for the selective silencing of genes. this form of transcriptional control is mediated by regulatory regions termed cpg islands  which overlap the promoter of all human housekeeping genes and over half of all tissue-specific genes  <cit> . cgis are the only regions in the human genome that are rich in unmethylated cpgs  <cit>  and therefore represent a notable exception to the almost "global" methylation that affects the bulk of the genome and has, over the time, resulted in the depletion of cpg dinucleotides from it.

the methylation of cgis is associated with a host of normal and cancer-related processes  <cit> , making them an important target for large-scale studies of dna methylation that aim to shed light on their role in the epigenetic control of gene expression  <cit> . nevertheless, measuring dna methylation experimentally involves procedures that are time-consuming, expensive and have only recently been scaled to genome-wide approaches that maintain a high degree of resolution  <cit> . computational solutions to the genome-wide prediction of cgi methylation would therefore be a great aid  <cit> . however, the characteristics that make a sequence susceptible or resistant to methylation are not completely understood.

recent studies employing supervised machine learning methods account for differences between methylated and unmethylated dna sequences  <cit> . however, recent experimental results have shown the presence of much more complex patterns of methylation in the human genome  <cit> . since these patterns may vary across tissues and developmental stages, they are partially described by a binary methylation model  <cit> . current computational methods therefore distinguish well between constitutively methylated and unmethylated cgis, but do not take tissue-specific cgi methylation into account. this is a significant source of uncertainty, since their prediction models were trained on a heterogeneous mixture of constitutive and tissue-specific methylation. this could mask the characteristics that truly discriminate between cgis that are methylated or unmethylated in all tissues. one of the primary causes for this situation was the lack of high-resolution methylation data from multiple healthy human tissues  <cit> . this impeded the discovery of tissue-specific cgi methylation classes and the key characteristics that predispose certain cgi sequences to either constitutive or tissue-specific methylation.

the data of human epigenome project   <cit>  gives us the opportunity to try and resolve this issue. they specify the methylation status of more than  <dig> individual cpgs from the human chromosomes  <dig>   <dig> and  <dig> in twelve healthy tissues and cell types, therefore representing the highest-quality source of experimental methylation data currently available  <cit>  and have been used before to gain insights into the epigenetic variability of the human genome  <cit> . in this paper we use this information to identify novel profiles that map dna sequence, structural, physicochemical and evolutionary attributes of cgis into methylation profiles. they clearly distinguish cgis that are constitutively methylated or unmethylated from cgis that show a tissue-specific degree of methylation. at the same time, these profiles provide important insights into the key attributes that determine if a cgi has a functional role in the epigenetic control of gene expression and is predisposed to become methylated during normal cellular differentiation.

RESULTS
in recent years, there have been several successful efforts at predicting the methylation status of cgis. these methods use different combinations of dna patterns and attributes to classify them as methylated or unmethylated  <cit> , but do not take tissue-specific cgi methylation into account. in this work we elucidate intermediate subclasses of cgis with a differential degree of methylation that better reflect the complex methylation patterns of the human genome.

our approach is primarily a mining process carried out in the absence of supervised data  <cit>   that identifies associations among two different data domains and uses these associations to label the database. first, we independently clusterer two different data-domains: cgi methylation and sequence-related attributes. then, both domain-clusters are related and evaluated based on the probability of intersection using the hypergeometric measurement. this measure helps to uncover cohesive relational clusters while avoiding conditional decisions -often derived from the use of conditional probabilitiesâ€“of clustering first one domain and then the other or viceversa  <cit> .

once the database is labeled, after a summarization process, we proceed with the corresponding feature selection of the new methylation classes and inference steps with the creation of a classifier with the newfound knowledge.

 <dig>  profile identification
we selected cgis that were covered to over 70% by the cpgs in the hep dataset, requiring their methylation status to be defined in at least  <dig> tissues. this measure ensured a balanced dataset, where more than two-thirds of the cgis were defined in all tissues and  <dig>  were defined in at least  <dig> tissues .

* number and percentage of cpgs measured in at least one of the twelve tissues.

** number and percentage of cgis where at least 70% of the cpgs were covered by the hep data, in at least two tissues.

the cgis were identified by the cpgcluster algorithm  <cit> , which does not rely on the traditional three parameters of length, gc-content and o/e-ratio  <cit> . instead, it searches for closely spaced cpgs and computes the probability of finding a cluster with the same length and number of cpgs in the genome . cpgcluster has a high degree of sensitivity for detecting known, functional cgis, while at the same time, excludes spurious repetitive elements  <cit> . over 97% of the cgis in our dataset were covered by a cgi predicted using the traditional parameters  <cit> , while the inverse ratio is 71%. this lower degree of coverage is due the high specificity of cpgcluster that excludes more false-positives, such as alu-repeats, than methods based on the traditional thresholds.

we then characterized each of the cgis in our dataset using  <dig> attributes belonging to four distinct categories:  cgi-specific attributes ,  repetitive sequences ;  evolutionary conservation , as well as  structural and physicochemical properties of the dna itself   <cit> . the attribute global linear analysis   showed that all of them contributed significantly to the overall variability of the dataset. therefore, all raw data were used in further steps because they provide a more interpretable characterization.

then attribute and methylation data were independently clustered by both hierarchical and k-means clustering methods. the validity indices that define the appropriate number of clusters were not conclusive, as shown in table  <dig>  thus we selected cluster partitions yielding more than two clusters using the best two partition scores .

in order to determine a combination of biological cgi attributes that naturally intersected with a specific pattern of methylation, we linked the two pairs of clusters by calculating the probability of intersection  and employing a significance p-value <  <dig> . this approach optimizes the cluster partitions based on the coincidence between independent clusters  <cit>  instead of intrinsic intra/inter clustering measurements  <cit> . the application of this unsupervised process to our dataset identified  <dig> significant intersections  where two independent clusters had more cgis in common than would be expected by chance . these  <dig> profiles are redundant due to the fact that partitions from distinct numbers of clusters were allowed in the former step. therefore, a cluster from one domain might be related to more than one cluster from the other domain and vice versa. we removed this redundancy  by grouping the  <dig> profiles and selecting a representative prototype from those that recognize similar observations. the process resulted in  <dig> non-redundant profiles  , which demonstrate clear patterns of tissue-specific methylation  associated with distinct biological characteristics . the attribute values in table  <dig> were normalized between  <dig> and  <dig>  this normalization is performed before the clustering process in order to prevent bias clusters caused by attributes with high absolute values. the significance at a p-value <  <dig>  is relative to these normalized values. the non-normalized values are available in the supplementary information. the number of cgis recovered with each profile is registered in table  <dig> 

average and tissue-specific methylation values of the nine non-redundant cgi profiles. the methylation values mentioned during the comparison of the profiles are marked in bold and all differences between profiles are supported by a mww p-value lower than  <dig> .

the attribute values in table  <dig> are normalized between  <dig> and  <dig>  this normalization is performed before the clustering process in order to prevent biased clusters caused by attributes with high absolute values. the significance at a p <  <dig>  is relative to these normalized values. the non-normalized values are available in the supplementary information. the attribute values mentioned during the comparison of the profiles are marked in bold and all differences between profiles are supported by a mww p-value lower than  <dig> .

1cgi-specific attributes; 2repetitive sequences; 3evolutionary conservation; 4dinucleotide content; 5structural and physicochemical properties;

a cgi was defined as being misclassified if it lacked an experimental methylation value in sperm but was classified nonetheless as constitutively methylated or unmethylated solely in sperm. cgis that were missing methylation data in more than half of tissues and cell types under analysis were also defined as misclassified and removed.

finally, we labeled the observations using the corresponding methylation patterns  into four methylation classes: constitutively methylated, containing cgis that are highly methylated in all tissues ; unmethylated in sperm contained cgis that only lacked methylation in sperm ; differentially methylated contained cgis that showed a distinct degree of methylation for each tissue ; and constitutively unmethylated, comprising cgis that are uniformly unmethylated across all tissues and cell types .

the initial pca analysis suggested that all attributes were informative. however, we considered the data labeled in the previous step and applied a local feature selection analysis based on the entropy of the attributes  for dissecting each new methylation class. the most relevant attributes were the novel ones included in this study: phastcon content, the p-value computed by the cpgcluster algorithm, and structural characteristics of the cgis describing their three-dimensional flexibility such as: twist, tilt, roll, shift, slide and rise of a dna sequence from a novel model of dinucleotide stiffness. moreover, a correlation analysis of all attributes shows that each relevant attribute was not replaceable by any other . here we describe the most relevant attributes for each class.

constitutively methylated class
cgis in this class had a high average degree of methylation in all tissues , and reflect pbc <dig>  this class is described by a higher average content of ca and tg dinucleotides, which can be seen as the "footprint" of methylation, since they are often the result of the deamination of methylated cytosine. the most notable difference between the constitutively methylated class and the other classes, specially the constitutively unmethylated, is its higher overlap with phastcon elements. this attribute never reaches values greater than  <dig>  in the former class, while it never falls below  <dig>  in the differentially methylated classes. a high phastcon overlap was originally seen as a sign of a potential conserved functional regulatory element  <cit>  however their high degree of methylation poses limits on their functionality by restricting access to the dna.

constitutively unmethylated class
the cgis in this class have a low avg_meth  in all tissues; it summarizes pbcs from  <dig> through  <dig>  previous results have shown a negative correlation between the concentration of cpgs and a high degree of methylation, and this idea has been used as the starting point for methylation prediction. however, our findings agree with the new experimental work of raykan et al.  <cit> . the authors find that dna methylation can occur at high-, medium- and, contrary to previous notions, at even some low-cpg density promoters. it has been also found that certain promoters with few cpgs were active and methylated, whereas other promoters of that group can be unmethylated when active  <cit> . these data suggest that dna methylation is involved in regulating activity over a broad range of cpg o/e-ratios, including cpg-poor promoters, located in tissue-specific differentially methylated regions .

all constitutively unmethylated pbcs are very similar, with exception of the unexpectedly high content in gc-rich repetitive elements of pbc  <dig>  only 6% of the cgis supported this pbc indicating that the combination of attributes learned from the few remaining repetitive elements is not representative of a large subset of cgis. this is a consequence of the hep selection process, which excluded most of these repeats  <cit> . however, in our results,  <dig> out of the  <dig> cpg islands overlapping with a repetitive element, overlap either with the extended promoter region  or with the tss of a gene . of these cgis,  <dig>  are unmethylated despite the presence of a repeat. in fact, all tss-overlapping cgis are unmethylated regardless of the repeat in their vicinity. the presence of a promoter seems to be incompatible with the methylation of these repeats. this small set agrees with the recent experimental findings of meissner et al.  <cit> , where it was proven that not all transposable elements are equally affected concerning methylation. long interspersed nuclear elements  and long terminal repeats  are generally methylated independently of cpg density. however, cpg density influences whether non-autonomous short interspersed nuclear elements  and low complexity regions remain unmethylated, which may be a reason for the low degree of methylation of the repetitive elements of profile  <dig>  these results show that cgis with distinct biological characteristics can share the same methylation status  and that the degree of cpg enrichment or the presence of a repetitive element alone does not determine if a sequence is protected against methylation.

these results show that cgis with distinct biological characteristics can share the same methylation status  and that the degree of cpg enrichment or the presence of a repetitive element alone does not determine if a sequence is protected against methylation.

the cpgcluster p-value is a key attribute for distinguishing between constitutively methylated and unmethylated cgis. this measure distinguishes true cgis from repetitive alu-elements, which are the main source of false-positive cgi predictions, and is not linked to either g+c content or the o/e ratio. this is important because it can determine the significance of a cgi independently of changes in the g+c content of the genomic sequence and is therefore not affected by fluctuations in the sequence composition. g and c-containing dinucleotides  in conjunction with a reduction in a and t-containing dinucleotides  and the curvature are also important attributes for this class. the high contents of g and c dinucleotides leads to an increasing degree of sequence bending and reduces both the macroscopic curvature of the dna as well as the amount of energy needed to separate the strands . despite the increasing g+c content, the o/e ratio decreases continuously , indicates that there is a balance between cpg enrichment on one hand and the overall g+c content on the other.

in addition to the previously known classes we found two tissue-specific methylation classes:

unmethylated in sperm class
these cgis lack methylation in sperm, and have a slightly lower degree of methylation in cd <dig> t lymphocytes, dermal fibroblasts, dermal keratinocytes and the muscle tissue of the heart. nevertheless, sperm is the only tissue that shows a level of methylation below  <dig>  making it the defining characteristic of this class. this agrees with the known normal development and control of sperm-specific gene expression of germ cells  <cit> , as well as with their epigenetic reprogramming during gametogenesis.

differentially methylated class
in contrast to the classes constitutively methylated and unmethylated in sperm, this class showed a heterogeneous degree of methylation ranging across all tissues. it presented both highly methylated and unmethylated cgis in the same tissue yielding an intermediate degree of methylation after averaging. this average was significantly lower than that of the cgis unmethylated in sperm. this class also presented the lowest average distance between cpgs, the highest cpg o/e value, g+c content, and cpg and gpc dinucleotide content than the constitutively methylated and unmethylated in sperm classes. this class presented unique structural characteristics, such as low degrees of bending and curvature, as well as a high degree of solvent-accessibility of the dna backbone , which may indicate a higher degree of permissiveness for dna binding. dna sequence bending is generally higher if the sequence contains phased gggccc sequences, and therefore the bending should be higher for sequences rich in g+c. this does not apply to this class where alternating cpgs and gpcs limit bending, curvature, twist and the number of helix turns, but tends to increase the flexibility of the sequence.

 <dig>  functional cgi categorization by gene association
in order to assess the functionality of the four newly defined methylation classes, we measured the coincidence between them and defined gene association classes  using probability of intersection  . the pi is usually employed to perform coincidence analysis because it is a context-sensitive metric that takes into account the domain where the intersection is calculated. it measures the degree of inclusion of one set into another, considering both the number of instances intersected between two sets as well as those instances not belonging to the intersection. formally, the pi determinates the p-value, which is the statistical significance of observing over represented intersected instances . the results obtained show that the new classes represent unique, functional cgi profiles associated with distinct cgi methylation patterns and gene compartments .

only the p-value  is shown and marked in bold.

                              pi
the cgis in our dataset were associated with  <dig> protein-coding gene loci . while the vast majority of the cgis  were located in the vicinity of a promoter, less than 4% of the cgis were outside the genic environment, indicating that the dataset is skewed towards genic regions. this is a consequence of a bias in the hep data, which includes few intergenic regions  <cit> . normally a higher percentage of cgis would be found outside of the genic region in an unbiased dataset  <cit> . approximately 20% of the cgis are located in the gene-body and we found that these cgis were unequally distributed, since there were approximately 30% more cds-overlapping cgis than those located in introns.

moreover, it is known that cgis associated with the gene-body are susceptible to both constitutive as well as tissue-specific methylation  <cit> . however, by separating between coding and non-coding regions, we were able to distinguish between highly methylated and differentially methylated cgis.

constitutively methylated class
it coincided significantly with the cds of the genes in our dataset. they are highly conserved and may be the result of gc-rich codons simulating the presence of a cgi. the methylation of a cds region itself, in contrast to a tss region, does not impede the progression of transcription, making this region permissive for both methylation and compact chromatin conformation.

differentially methylated class
this class coincided significantly with cgis located in introns, indicating the presence of functional methylation-dependent sequence elements. though the majority of the differentially methylated cgis that were conserved overlapped with the cds , we found that they were the only class of cgi that was significantly enriched in highly conserved non-coding elements   <cit>  . since the differential methylation of hcnes has recently been shown in a comparison of embryonic stem cells  and es-derived differentiated cells in mouse  <cit>  these differentially methylated cgis may represent examples of enhancers that are controlled by methylation  <cit> .

*absolute number and percentage of conserved and not conserved cgis of each pbc in the gene-association classes.

unmethylated in sperm class
over 40% of the cgis belonging to this class coincided with promoter-overlapping cgis, including genes known to be testis-specific, such as ddx <dig>  <cit> , hist1h2ba  <cit> , piwil <dig>  <cit>  and ecat <dig>  <cit> . although this supports the view that germline-specific genes are preferentially methylated in somatic tissues  <cit> , the only significant intersection with a gene-class was with the pseudogene-proximal cgis, 22% of which were unmethylated in sperm. only 12% of all cgis were associated with pseudogenes and the majority of them represent "processed" pseudogenes . this may still include parts of the core promoter region, including the promoter-overlapping cgi  <cit> . their lack of methylation in sperm was thought to be a by-product of the global changes in methylation that occur during spermatogenesis  <cit> . although it may also permit them to be transcriptionally active in sperm  <cit>  they are normally targeted for silencing through methylation during differentiation and therefore show a high degree of methylation in somatic tissues  <cit> . this complicates the identification of cgis that are involved in controlling the sperm-specific expression of protein-coding genes via promoter-cgi methylation such as the mage and hage-genes  <cit>  because it may lead to false positives in genome-wide studies of promoter methylation. for example, dppa <dig> a functional testis-specific gene  <cit> , is active in pluripotent cells and down-regulated during the differentiation process  <cit> , but we found that it contains a cgi and a pseudogene within its 5'utr. therefore it is not clear if the lack of methylation of this cgi is necessary to maintain tissue-specific activity or simply a by-product of the pseudogene in its vicinity.

constitutively unmethylated class
this class showed significant coincidence with the cgis overlapping the tss. however, they showed neither the highest g+c-content nor the highest o/e ratio of the whole unmethylated group. instead, they showed the lowest average cpgcluster p-value, further supporting the use of this attribute as a better measure of functionality than the cpg enrichment or g+c content alone  <cit> .

this categorization of the methylation classes was used to re-classify the dataset into the four functional methylation classes shown in table  <dig>  the promoter/tss proximal cgis represent the vast majority of all cgis and they are predominantly unmethylated. it has been estimated that about 18% of the cgis in the human genome are subject to tissue-specific methylation  <cit>  and we found our data to support this estimate since just over 17% of the cgis were either unmethylated in sperm or differentially methylated. it is noteworthy to mention that neither of these two classes overlapped significantly with the promoter-proximal cgis.

 <dig>  prediction of cgi methylation
our four functional cgi methylation classes were then employed in the development of a supervised classifier. our hypothesis was that if these classes were biologically and computationally significant, they would be useful in predicting new observations. to do so we first labeled each observation using the classes assigned by the profiles. we then used a simple classifier  that employs  <dig> of the  <dig> attributes to predict the four classes of methylation. the methods were tested via 10-fold cross-validation where imbalanced classes were compensated  <cit>  .

these results show that the decision tree can encode rules that predict cgis with distinct methylation patterns at a high level of accuracy . it is difficult to asses the performance of our method compared to previous computational approaches due to the fact that all constrain the prediction to only two methylation classes, where a sequence is either "methylated" or "unmethylated" across all possible tissues or cell types  <cit>  and they do not take into account tissue-specific methylation.

the ability of our approach to predict methylated and unmethylated cgis, was then directly compared to the results obtained from epigraph  <cit> , which were tested on our hep-based cgi methylation data and the methylation data used by the epigraph system . in order to compare the methods we used a binary methylation classification system as described in the materials and methods section.

                              cc
*validation was performed using  <dig> repetitions of  <dig> fold cross-validation

** validation was performed using  <dig> fold cross-validation

1hep cgi data 

2epigraph methylation data 

3hep cgi data 

the average accuracy  and correlation coefficient  were used to measure fitness.

both datasets were classified using two methods, svm and decision tree, the former one with two different implementations, epigraph c <dig>  and the matlab decision tree . in all cases we used default parameters.

the results obtained using both datasets are very similar, independently of the classifier used. thus, we suggest that our attribute set is capable of predicting methylated and nonmethylated cgis with a high degree of accuracy even without sampling and method specific parameter optimization .

unexpectedly, a different implementation of a simpler method such as a decision tree, obtained a better accuracy and cc than the more complex svm with the default setting parameters. in addition, this method produces interpretable rules that can be used for a better understanding of the data and easily extended to the use of multiple classes.

as shown in table  <dig> we are able to predict four different classes with accuracy close to that of the binary methylation prediction. the comparison with a more sophisticated classifier, suggests that the new information in terms of cgis attributes and tissue-specific methylation classes are the key factors that improve the cgi classification instead of the classifier themselves   <cit> .

CONCLUSIONS
the analysis of dna methylation has been based primarily on the use of binary models which predict dna sequences to be methylated or unmethylated. we have presented a profile-based approach that is able to define novel cgi methylation data relationships which not only separated between constitutively methylated and unmethylated cgis but also identified cgis showing a differential degree of methylation across tissues and cell-types or a lack of methylation exclusively in sperm. our approach differs fundamentally from previous studies since it does not specify cgi classes a priori. instead, it employs unsupervised data clustering methods for the detection of groups of cgis sharing a common tissue-specific degree of methylation as well as similar attributes. these types of clustering methods avoid the potential biases of the limited cgi dataset available here since they do not require pre-determined classes in order to detect homogeneous groups within the data.

the functional cgi profiles discovered in this work bring new insights into the features associated with cgi methylation susceptibility, which included their evolutionary conservation, their significance, as well as the evolutionary evidence of prior methylation. moreover, the usefulness of this information in building a simple classifier demonstrated that the ability to predict cgi methylation is mostly based on the biological information and the relationships uncovered between different sources of knowledge. this information can be exploited for the improvement and development of new tools able to detect not only constitutive or tissue-specific cgi methylation with equally high degrees of accuracy, but cgi functionality across the genome as well.

contrary to previous studies, our method does not rely on ad hoc thresholds in order to determine if a cgi is constitutively methylated, unmethylated or shows a tissue-specific degree of methylation  <cit> .

this yielded a series of novel, functional cgi profiles that allowed us to measure the extent of tissue-specific cgi methylation within the genic environment. we found that the different functional regions of genes were not equally affected by methylation. furthermore, we were able to determine biological attributes that influence both the functionality and the methylation status of the cgis, allowing us to use this knowledge for the computational prediction of their methylation.

in addition to the insights provided by our approach we demonstrate that the attribute set used is able to predict four methylation classes conserving the accuracy provided by leading binary methylation classification methods.

