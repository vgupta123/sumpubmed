BACKGROUND
network or graph theory is of increasing importance for the analysis of biological systems. this may comprise protein interaction networks  <cit> , metabolic networks  <cit>  or neuronal networks in the human brain. task-induced and resting state functional magnetic resonance imaging  and diffusion tensor imaging  established the analysis of functional and structural connectivity networks in the human brain  <cit> . for quantitative analyses, local and global topological measures are employed; see  <cit>  for a description and a critical discussion. we introduce in this paper a new concept, which may be called a “regional quantity” and which measures the complexity of networks. the problem how to measure complexity of a graph has been approached in different ways. for example, complexity of a graph has been defined by the number of its spanning trees  <cit> . it has been defined as the number of boolean operations to construct the graph from generating graphs  <cit> ; this type of complexity is frequently called computational complexity. or, it has been defined by a combination of the number of vertices, edges and proper paths  <cit> . our concept of complexity is based on the connectivity of a graph. simple examples of this type of complexity are the cost or the efficiency, more involved examples are the box-counting dimensions  <cit>  introduced recently. cost and efficiency are easily calculated, however both concepts fail to discriminate regular grids with different dimensions, see ndim and manifolds. box counting-dimensions can detect a novel type of graphs, the fractal graph; however, these dimensions need np-complete algorithms and become unstable if fractality is distorted  <cit> . in our approach we try to overcome these shortcomings by a new concept, which is applicable to any undirected graph. we achieve with our concept more flexibility and enhanced informative power, the price however is again a np-complete algorithm with high cpu times for some large sized networks. practical applicability of ndim to such cases will be demonstrated by the introduction of convenient lower bounds.

our concept is based on a definition of a fractal dimension introduced for sets in ℝn by sandau  <cit>  and sandau & kurz  <cit> . fractal analysis in ℝn allows the quantification of irregularity or complexity of point sets where the concepts of traditional geometry usually fail. fractals possess a fine structure that exhibits details at different scales of resolution. fractals appear in numerous disciplines, e.g., plasma physics, biological systems, or neuroscience .

the degree of complexity is measured by a fractal dimension fd although many non-equivalent definitions of fds exist. however, all such concepts of fd satisfy  the following unifying conditions, see  <cit> . 
invariance under euclidean motions;

invariance under affine transformations;

monotonicity for set inclusion;

maximum property for set union;

fds are extensions of the topological dimension for smooth manifolds, and

all fds are equivalent for self-similar fractals.



a picturesque definition of self-similarity is due to mandelbrot  <cit> : a fractal is called self-similar if a subset, magnified to the size of the whole set, is congruent to the whole.  the numerical calculation of fds for real data with scale of resolution > <dig> is, in general, nontrivial as the details of scales tending to zero are important for the characterization of a fractal  <cit> . in  <cit>  an fd definition, called x-dim, was proposed that is both applicable to self-similar and more general fractals. this definition appears to be numerically more robust than the frequently used box-counting dimension for self-similar fractals.

using a procedure similar to the calculation of a box-counting dimension in ℝn, a novel fd for networks or graphs was introduced by song et al.  <cit> . for this purpose, a covering of the graph by subgraph  systems differing in their linear size is proposed. the fd is finally determined by the slope of a linear log− log plot, where the minimal number of covering subgraphs is plotted versus their linear size.

networks have in general no well defined geometric patterns that allow the definition of self-similarity. but self-similarity can be defined by internal properties of the graph, e.g., by the invariance of the degree distribution under scale transformations. to obtain graphs on different length scales, a subgraph covering with fixed linear size is iterated, blurring the initial graph more and more, thus increasing the scale; see song et al.  <cit> . if the degree distribution is invariant under the different steps of this renormalization procedure, the graph is called self-similar  <cit> . a similar scaling invariance for edge densities was discussed by blagues et al.  <cit> . note the following difference to fractals in ℝn: there exist self-similar graphs which are not fractals, i.e., graphs for which the log− log plot is nonlinear  <cit> .

inverting this iterated renormalization procedure allows the design of models for fractal and non-fractal scale free graphs  <cit> . transitions between both classes depend on the strength of the module or hub repulsion which is controlled by the model parameters; minimal hub repulsion  produces a model with small world properties, maximal hub repulsion a fractal graph  <cit> . it is shown in  <cit> , that the addition of noise by adding random edges can also initiate the transition from a fractal to a small world graph. many real data networks are fractal graphs; examples are the world-wide-web , social networks, protein-protein interaction graphs , and cellular networks  <cit> . more recently, gallos et al.  <cit>  detected fractal fmri networks in the human brain for high percolation thresholds. an alternative to the box-covering methods is discussed in  <cit> ; they use a random walker through the network, to derive a correlation dimension using a convenient log− log plot.

in this paper, we propose an extension of sandau‘s fractal dimension x-dim in ℝn to networks or graphs, which we call ndim. this new concept is based essentially on the maximum k-clique cardinality and does not only allow the quantification of complexity for fractal graphs, but also for graphs with non-linear log− log plots. we prove that this concept satisfies the graph-specific modifications of the conditions c <dig>  c <dig>  and c4; condition c <dig> is irrelevant for graphs. the validity of conditions c <dig> and c <dig> is demonstrated numerically by applications of ndim to regular lattice or grid graphs and to binary fractal models. as weighted graphs are frequently used to quantify functional or structural connectivity, we present three procedures to apply ndim to weighted graphs. to evaluate the complexity ndim, we compare it with the connectivity measures cost, efficiency, and box-counting dimensions by applications to resting state and task-induced fmri data. we find several advantages of our new measure: compared to cost and efficiency ndim has stronger informative power, as complexity differences in fmri correlation networks between healthy and depressed subjects are increased for ndim. in contrast to cost and efficiency is ndim a non-global regional metrics. we show that this feature enables the localization of special hub nodes in the networks which are characteristic for depressed subjects. comparing ndim and some box-counting metrics, we find a strong similarity as long as the networks are fractals; applying these concepts to experimental dual task fmri networks, which lose fractality by lowering a correlation threshold, we find that ndim has an essentially enhanced scope of application compared to box-counting dimensions. though the algorithm to calculate ndim is np-complete, we find that cpu time is quite low for moderate network sizes, for large sized networks we discuss the introduction of lower bound constraints.

methods
extended counting method in euclidean space
for a point set in ℝn, the fractal dimension x-dim is numerically calculated using the extended counting method  <cit> ; see fig. 1a, b for an illustration.
fig.  <dig> panel a sierpiński triangle f in the plane. panel b extended counting method for f. the scales e
 <dig> and e
w for the fine grid and the sliding window  are indicated. the window with the maximum number of fine grid boxes intersecting f determines the complexity of the fractal . panels c and d show a fractal graph g with a submaximum  and a maximum  highlighted k-clique . the cardinality of a maximum k-clique determines the complexity of g )



in fig. 1a, b, the point set f  is covered by a fine uniform grid with grid scale e <dig> satisfying e1≥ the resolution of the data points given in fig. 1a. an additional large window with size ew= / <dig> is slid along the corner points of the fine grid to find the maximum intersection between f and the fine grid within the window; see fig. 1b. denoting the maximum number of intersecting fine boxes by n, x-dim is then estimated by 
 x-dim=lognlog. 

. for x-dim estimates of mri cortex surfaces, fmri time series in the human brain, and fractional brownian motion, we refer to .

extended counting method for networks
for a connected binary network or graph g, we define an extended counting method similar to that for a point set in ℝn. the fractal dimension ndim of g is computed in several steps: 
compute the average distance μ of g. the average  distance, characteristic path length, or normalized wiener index is a natural measure for the compactness of a graph  <cit> . it is defined by 
 μ:=∑1≤i<j≤ndn <dig>   where n denotes the number of vertices and d the chemical distance or shortest path between vertices i and j.

reduce μ to an integer k:=⌊μ⌋. here ⌊·⌋ denotes the floor function.

compute a vertex set that is defined by a maximum k-clique of g. a maximum k-clique is a largest set of vertices with distance ≤k in g to each other. such a clique can be interpreted as a cluster, module, or cohesive subgroup of vertices  <cit> .

we define ndim for a finite graph g by 
 ndim=log|maxk-clique|log,  where | maxk-clique| denotes the cardinality of a maximum k-clique. following the convention of song et al.  <cit> , we added a + <dig> to the chemical distance in the denominator.

for infinite graphs g with arbitrary large k, a fractal dimension ndim can be defined by 
  ndim=limk→∞log|maxk−clique|log,provided this limit exists. 

the above definition is similar to the definition of fractal dimensions for sets in ℝn where an infinitesimal process is applied  <cit> ; see ndim and manifolds and applications of ndim to fractal and non-fractal models for examples of graphs where the number of vertices and k go to ∞.

see fig. 1c, d for an illustration of a sub-maximum and a maximum k-clique in a fractal graph. as will be shown in later sections, ndim is a fractal dimension fd in the sense that it satisfies the conditions c <dig> – c <dig> for graphs given in. for simplicity, the notion of fractal dimension is also used for ndim when applied to finite graphs.



the numerically most difficult part in the computation of ndim is the calculation of the maximum k-clique where a scan through g is necessary. this is a np-complete problem  <cit>  just as the computation of box-coverings for the fd of  <cit> . for the clique computations, an algorithm by carraghan & pardalos  <cit>  and an algorithm by tomita et al.  <cit>  applied in the commercial software package mathematica are used. for a comparison, the box-covering dimensions defined via log− log plots are also computed. we employ the maximum-excluded-mass-burning  algorithm and a compact-box-burning  algorithm as described in  <cit> . the memb algorithm is published online and can be found at http://www-levich.engr.ccny.cuny.edu/webpage/hmakse/brain/.

application of ndim to weighted graphs
the fd ndim was introduced for a binary graph. however, numerous problems in biology or brain research deal with weighted graphs  <cit> . .

in the following, we describe three procedures of how to apply ndim to weighted graphs with nonnegative weights. elaborate examples for human brain data and the conditions for applicability are discussed in results. to obtain a reasonable distance measure d for weighted graphs, the interpretation of the weights w in the weighted adjacency matrix must be considered. for better readability, we do not delineate in the following between a graph and its adjacency matrix.

for “transportation networks,” distances increase with the weights; for “communication networks,” distances decrease with increasing weights  <cit> . for brain mapping, “communication networks” are frequently used. here the weights may be given by w=|correlation| for fmri time series in two different rois i and j  <cit> , or by w=connectivity-strength for dti fiber connection between functional rois i and j  <cit> . in these cases ndim can be computed as follows. 
transition to a binary adjacency matrix using a cut-off: a mapping from the weighted adjacency matrix wn×n of a graph with n vertices to a binary adjacency matrix an×n with components a is defined by thresholding of some quantity τ> <dig>  as follows. if for an edge w>τ, then w is replaced by a=1; otherwise w is replaced by a= <dig>  this implies that for, e.g., |correlation|>τ, d= <dig>  and for |correlations|<τ, d> <dig>  as the connecting paths are no longer direct links.

if the binary graph a is disconnected then ndim is computed for every connected binary component akl, where kl is the average distance in component al. the list of fds  is combined into a weighted average 
 ndim=∑lweight·ndim,  describing the complexity of the disconnected graph. as weights, we choose weight =/n, where n denotes the size of the entire graph, which reduces the weight for smaller components as they carry less information. components with only a few nodes should be excluded from the averaging process but the normalization ∑lweight= <dig> should be maintained.

a monte carlo ensemble method: the weighted adjacency matrix wn×n is normalized by setting w~:=w/max{w:i,j= <dig> …,n} and these weights are interpreted as probabilities. a uniform random number generator assigns to each edge a random number p∈ then a=1; else a= <dig>  by this procedure, an ensemble of binary random graphs is produced, where for large w~ short distances are frequently randomly generated and for small w~ mainly large distances  <cit> .

for every such binary random graph the fd ndim can be computed. in case a random graph is disconnected, a weighted averaging as in  can be applied.

calculation of ndim via functional distances: to calculate statistical measures of weighted connected communication networks wn×n, a functional  distance network w~n×n is often introduced in order to avoid long pathways for strong connections  <cit> . in the following we adapt this approach for the computation of the complexity ndim. 
the w coefficients  are mapped to functional distance coefficients via, e.g., w~=1/w.

the graph w~n×n is mapped to an approximating multigraph mn×n with integer weights by scaling by a large factor c and rounding  <cit> : mn×n=⌊cw~n×n⌋. finally, the coefficients m=∞ are mapped to m=0; see results for a numerical example of scaling. then compute, for instance by the dijkstra algorithm  <cit> , the distance matrix dn×n with coefficients d for mn×n, the average distance μ, and the minimum positive distance m.

transform the multigraph mn×n to a binary distance graph gn×n  <cit>  using the following condition: if d≤⌊μ⌋ set g=1; otherwise set g= <dig> =0). for this binary graph calculate a maximum clique if gn×n is connected; otherwise compute a maximum clique in each connected component and use from these maximum cliques the one with maximal vertex cardinality; see an example in the comment for fig.  <dig> 


the complexity ndim for wn×n is finally estimated by 
 ndim=log|maximum clique|log.  in case mn×n is a binary graph, ndim agrees with the definition given in extended counting method for networks.





data
an application of thresholding and of the monte carlo ensemble method to compare the complexity of weighted networks relies on data from  <cit> : for patients with recurrent depression and for healthy controls, a whole brain functional connectivity network was derived from preprocessed resting-state functional mri data. by anatomical parcellation of the whole brain using the harvard-oxford atlas   <dig> regions of interest  or network nodes were defined. time series of functional mri signals were extracted from each voxel and subsequently averaged within each of the  <dig> rois. a maximal overlap discrete wavelet transform was applied to decompose the regional time series into different frequency scales  <cit> . absolute wavelet correlation coefficients at the low-frequency scale  were used to obtain a 112× <dig> weighted connectivity matrix representing an individual whole-brain functional correlation network for each subject; a similar procedure is used in  <cit> .

a second data set from  <cit>  uses visual and auditory stimuli with four different onset delays to achieve whole-brain dual-task fmri time series. the phase of the bold signal was computed for each voxel i and for  <dig> trials  <cit> . the phase-based correlations between different voxels i and j were averaged over the trials. this resulted in a whole-brain correlation matrix representing a weighted subject-specific functional network. this whole-brain network was reduced by a mask of ∼  <dig>  voxels, where only voxels with high activation probability were kept. the data are published online at http://www-levich.engr.ccny.cuny.edu/webpage/hmakse/brain/. the variation of a correlation threshold produces a percolation process: highly correlated voxels indicate separated modules with strong functional internal links, for lower thresholds the modules are merged and the network approaches a small-world topology.

seven binary connectivity networks, taken from http://www.brain-connectivity-toolbox.net/, are tested for computational cost. autobahn has a connection  <dig>  if two locations are directly connected by the highway  <cit> . air <dig> summarizes the flight connections between  <dig> air ports  <cit> . three biological networks are: celegans describing neuronal connections  <cit> , mac <dig> and macaque summarizing corticocortical connections  <cit> .

RESULTS
in the next section, we numerically explore how well ndim and a box-covering dimension approximate the dimensions of grid graphs . then, the equivalence between ndim and several box-covering dimensions is explored for models of self-similar fractal graphs . an examination of non-fractal graphs demonstrates that ndim is applicable beyond fractality, i.e., to graphs with non-linear log− log plots for minimum numbers of covering boxes versus box size. three methods of how to apply ndim to weighted graphs on the basis of analyses of functional connectivity in the human brain are explained. resting state fmri data of healthy and depressed subjects and dual-task fmri data are involved to evaluate ndim.

ndim and manifolds
to demonstrate, that the proposed fd ndim is an extension of the topological dimension for smooth manifolds , we applied ndim to regular one- and two-dimensional finite lattice graphs of size  <dig>   <dig>  30× <dig>  40× <dig>  80× <dig>  and 100× <dig>  for comparison, a box-covering dimension was calculated applying the method memb  <cit>  and the measures cost  and global efficiency, which are in use as simple measures of complexity. we refer to table  <dig> for the results, which show a convergence of the fds to the topological dimensions as size increases. for cost and efficency we find that they tend to zero for both grids as their sizes increase.


the log− log plots for memb showed a high linearity in all cases. the coefficient of determination r <dig> was found to satisfy r2> <dig> . the box sizes for the log− log plots were averaged, as proposed by song et al.  <cit> , thus increasing the r <dig> values. to keep computation time within limits, we did not use adjacency matrices with more than  <dig>  nodes. these results show the enhanced informative power of the fractal dimensions as compared to the topological measures.

application of ndim to fractal and non-fractal models
a model for scale-free fractal networks was introduced by  <cit> ; it is shown in the supplement of this paper that this model is in addition self-similar. an explicit algorithm, calculating the model by inversion of a renormalization process, can be found in  <cit> . in this algorithm, the network grows iteratively in size  whereby the diameter and the degree per node approach the full model. to explore if ndim satisfies condition c <dig> for binary graphs, the network dimensions ndim, memb, and bcm are compared at different stages of a growing network. starting the network construction with a single node, these dimensions are plotted against the size of the model f for g= <dig> , <dig>  and  <dig> iterations; see fig.  <dig>  the growth factor of the network size is n= <dig> per iteration, the growth factor of the degree is m= <dig>  the probability for hub attraction is e=0; see  <cit>  and  <cit>  for a detailed discussion of the parameters. the fd of a full model  can be calculated by fd= ln/ ln.
fig.  <dig> the fractal dimensions ndim , memb , and bcm  are plotted against the size of the network for stages g= <dig> , <dig>  . the applied model is f. with increasing g, all fractal dimensions approach fd = 2



applying the hub attraction parameter 0<e≤ <dig>  we can construct non-fractal models with nonlinear log− log plots for box-covering dimensions; increasing e converts the network more and more to a small world network  <cit> . although box-covering dimensions are not well defined for the entire range of log− log plots, ndim can still be applied in these cases to quantify the complexity of such graphs. the notion of complexity is introduced as an extension of the notion of fractality; see discussion for an in-depth explanation. depending on the size, the complexity of a binary network is limited by the complexity of the corresponding complete graph, where ndim= log/ log <dig>  see fig. 3a, b for the models f and f.
fig.  <dig> in panel a, a fractal and in panel b a non-fractal network are presented. panel c shows the number n of covering boxes versus their mean linear size l
b for the models f. linear regression for e= <dig> is indicated by a straight line. panel d shows the complexities ndim for f with g= <dig> , <dig>  , and the indicated values of e




in fig. 3c, we show log− log plots for the minimum number of covering boxes n against the averaged box sizes lb, calculated by the memb algorithm for models with e= <dig> . <dig> . <dig> . <dig>  and  <dig>  for e> <dig>  deviations from linearity are clearly visible. the computed complexities ndim of these models are presented in fig. 3d for the iterations g= <dig> , <dig> . it is shown in  <cit> , that the addition of small fractions of random edges to the fractal models  produces similar deviations from linearity in the log− log plots.

application of ndim to weighted graphs by thresholding
abnormal functional brain connectivity is reported for recurrent depression patients compared to the connectivity of healthy subjects  <cit> . we use such connectivity data to exemplify the informative power of ndim and to demonstrate how to apply this measure for weighted networks; a detailed clinical study is beyond the scope of this paper. in this section, for a healthy and a strongly affected recurrent depression subject after  <dig> episodes of depression and a high clinical hamilton rating scale ham-d= <dig>  <cit> , resting-state fmri correlation networks of size =  <dig> as described in data, are compared. to calculate ndim and the frequently used topological complexity measures cost  and normalized global efficiency, the two weighted absolute correlation networks are transformed to binary graphs by thresholding the correlations w, following the procedure outlined in methods. this procedure is applied for τ= <dig> , <dig> , and  <dig> . for τ= <dig> , the low correlation edges are also filtered out using the following inverse condition: if w<τ, then w is replaced by a=1; otherwise by a= <dig> =0). the results are shown in fig.  <dig>  broken lines belong to the healthy subject, solid lines to the subject with depression. cost, efficiency and ndim increase for w>τ, with decreasing tau; all measures ndim are increased for the depressed subject as compared to the healthy subject. vice versa, for the low correlation graphs w< <dig> , the network of the healthy subject is more complex. in general, we find for ndim, that the differences are more pronounced than for the two global measures, indicating larger informative power of ndim. for the depressed subject, ndim decreases from the case w> <dig>  to the case w< <dig> , whereas cost and efficiency are increasing. this dependency excludes a simple correlation or redundancy between ndim and the topological measures. see fig. 5a for binary networks derived by the condition : w> <dig> . the left-hand side shows the graph of the healthy subject, the right-hand side the graph of the subject with depression, maximum k-cliques are indicated in red.
fig.  <dig> cost , efficiency  and ndim  for a healthy  and a depressed  subject are presented for different cut offs indicated. for ndim, in brackets  are given

fig.  <dig> panel a depicts the binary graphs for a healthy and a depression subject computed by the thresholding method. panel b shows binary samples of the monte carlo method. the k-cliques are indicated in red. panels c, d, e, h represent paired monte carlo distributions of complexity ndim for a healthy  and a depression subject . panel f represents the distributions for a healthy group  and the depression subject , panel g for two groups. the thresholding for the weighted networks is indicated



monte carlo ensemble method
the same two data sets used in the last section and extensions to groups of  <dig> healthy controls and  <dig> depressed subjects  are now analyzed for ndim by the monte carlo ensemble method. to provide a closer comparison with the results of the thresholding method, the weighted networks are also thresholded for a given τ before transforming them to the binary random graphs, as is described in methods. thresholding is performed like follows, in case w>τ, w remains unchanged, otherwise w=0; or, for the low correlation case, if w<τ, w remains unchanged, and set otherwise w= <dig>  for a quantitative comparison between the binary ensembles the weighted networks are normalized to probabilities by the total maximum weight collected over all networks involved in the comparison. in fig. 5b, samples of the binary monte carlo ensembles after identical thresholding are presented. the graphs in panel b increase in complexity from healthy to disease as in the cases shown in fig. 5a. a reduction of connectivity in the monte carlo samples compared to panel a, is due to the fact that this method transforms lower w less frequently into the edges of the binary networks. for every weighted network an ensemble of  <dig>  binary random networks is calculated and ndim of a weighted graph is thus quantified by a distribution of complexities; see fig. 5c–h for examples. the blue distributions belong to the healthy subject, the red ones to the subject with depression. the afore-mentioned thresholding of the weighted graph is indicated in the figure. panels c), d), e), h) present comparisons of the two subjects, panel f) a comparison between the control group and the depressed subject, and panel g) the group-group comparison. statistical subject-subject comparisons may be helpful in personalized medical analysis. the group distributions are involved to reduce subjective random variability, their distributions are computed pooling all samples of the group members. the one-sided significance of the pairwise distribution shifts  can be quantified using a nonparametric statistics of brunner and munzel  <cit> . this method is free of any assumption regarding the shape of the distributions. for the case with w< <dig>  the ndim distribution of the healthy subject is significantly shifted to higher complexities compared to the distribution of the depressed subject. for the other cases > <dig> , <dig> , <dig> ) the upwards shift is reversed ending at higher ndim values for the depressed subject. for the subject-group and group-group comparisons, panels f),g), this upwards shift is weakened, we find for the p-values psubject-subject<psubject-group<pgroup-group<10− <dig>  the subject-subject comparisons are in line with that of the thresholding method, but more instructive, as their statistical significance can be quantified; see  <cit>  for applications of this statistical technique to edge distributions of weighted networks.

the calculation of ndim is based on the maximum k-cliques or on the largest sets of nodes with distances ≤k. maximum k-cliques include nodes with high functional connectivity w or with similar resting state fmri signals in the corresponding grey matter rois. figuring out the spatial locations of maximum k-clique rois in the brain, we can deduce localized neural information. this point is complicated by the fact that several maximum k-cliques may exist in any binary random realization of the weighted network. for the cases with w> <dig> , we find that for depressed subjects this multiplicity  increases compared to the multiplicity of healthy subjects , the characteristic path length k  is on the contrary rather stable. this indicates, as ndim increases, an increasing connectivity for depression in some regions of the brain. for further analysis we focus on nodes which are contained in the intersection of all maximum k-cliques of a binary random realization and call these nodes core nodes. a core node is a hub node with distances ≤k to all maximum k-clique nodes of a binary network. for an ensemble of binary realizations we can quantify the probability of any node to be a core node. in fig. 6a, b this probability is plotted for the healthy  and the depressed  subject of fig. 5e versus the node labels  <dig> to  <dig>  a complete mapping of these labels to grey matter rois can be found in the supplement of  <cit> , the rois are derived from harvard-oxford brain atlas. this labeling is symmetric for the left and the right hemisphere of the brain. in fig. 6c, d core node probabilities are given for the healthy group and for the group of depressed subjects of fig. 5g. for nodes with higher probabilities, the grey matter rois for depressed patients are given in table  <dig>  compared to the healthy subject, the probability of these nodes is strongly increased for the subject with depression , some of these nodes have probabilities ∼1; such nodes play in nearly all binary realizations the role of a core node or, the corresponding weighted network favors these core nodes. the clusters of core nodes with enhanced probabilities are nearly symmetric in both hemispheres indicating non-random  modifications of connectivity under depression . for the group-group comparison, the patterns of the node probabilities  are similar to the subject-subject case, but the probabilities for the depressed case are weakened. the situation for the group-subject, see fig. 5f, core nodes is not shown, but is quite similar to the subject-subject case, as can be easily inferred. summarizing, we find that depression enhances the number of core nodes and consequently the functional connectivity between the maximum k-cliques. the grey matter core rois under depression which are active for all comparisons are : frontal pole , insular cortex , superior frontal gyrus , middle frontal gyrus , cingulate gyrus, anterior division , see table  <dig> and fig.  <dig> 
fig.  <dig> probabilities of core nodes versus node labels. red points are core nodes of depressed patients, blue points of healthy probands. the horizontal lines indicate probability =  <dig> . panels a, b are based on the brain hemispheres of single subjects, panels c, d are derived from groups



applications of functional distances
an application of functional distances is performed on correlation networks based on dual-task fmri measurements; see data. to keep the cpu time within limits, we reduced the number of voxels in the data mask of a subject from  <dig>  to  <dig>  thus eliminating coefficients in the correlation matrix. this lowers the percolation thresholds p and the complexity but an essential result in the work by gallos et al.  <cit> , where separated fractal brain modules collapse for lower p into weakly connected non-fractal components, is still approximately valid. to compare the complexity ndim with box-counting dimensions in such a situation, we extended the box counting algorithm for bcm to be directly applicable to the weighted network w~n×n . following the procedure of gallos et al., the correlation network wn×n of a subject is thresholded by p in the following way: if w<p then w:= <dig>  then we apply the chain of transformations as described in ‘methods’. the scaling factor c is calculated by 
  c=kmax{w~<∞:i,j= <dig> …n}−min{w~>0:i,j= <dig> …n} 

for k= <dig>  in order to guarantee that c·min{w~>0:i,j= <dig> …n}≥ <dig> and to obtain an approximating multigraph mn×n of cw~n×n, k must satisfy the inequality 
 k≫max{w~<∞:i,j= <dig> …n}min{w~>0:i,j= <dig> …n}− <dig>  

for the threshold p= <dig> , we find two large connected components of w~n×n of nearly equal size ; see fig. 7a, b. for p= <dig> , we find a collapsed large component in w~n×n of size = 1147; see fig. 7c. the corresponding binary distance graphs gn×n including maximum cliques are shown in fig. 7d-f. the complexities of wn×n are ndim1= <dig>  and ndim2= <dig> , respectively. for the large component we find ndim= <dig> . the corresponding mean topological distances of w~n×n are μ1= <dig>  μ2= <dig>  and μ= <dig>  the log− log plots for bcm  are shown in fig. 7g-i. their r2-values are r2= <dig> , respectively, r2= <dig> , for bcm 1= <dig> , respectively, bcm 2≈ <dig> . for the collapsed component we obtain r2= <dig> ; the corresponding log− log plot is too non-linear to estimate a unique fd. these results indicate that the component of size  <dig> is a fractal, the component of size  <dig> may be close to a fractal, and the collapsed component is a non-fractal graph. please note that in contrast to  <cit> , bcm is calculated by box-covering on the weighted graph w~n×n.
fig.  <dig> panels a-c show the largest connected components of the w~n×n graph  of different size according to the thresholds p= <dig>  and p= <dig> . panels d-f depict the corresponding binary distance graphs g
n×n and maximum cliques. panels g-i present the log− log plots of minimum numbers of boxes n
b versus averaged weighted box sizes l
w. the r
 <dig> coefficients are also indicated. for the purposes of comparison, some estimates of the linear regressions are included

fig.  <dig> panel a represents a binary graph overlaid with the maximum 2-clique . panel b represents its binary distance graph for distances ≤ <dig> and the maximum clique . separating edge cuts are indicated by the green and blue lines



monotonicity and the maximum property
monotonicity and the maximum property  are essential properties of topological or fractal dimensions  <cit> . we show that ndim satisfies both criteria for fractal and non-fractal graphs in an appropriate way just as x-dim does for sets in ℝn  <cit> . the detailed proofs of both theorems are given in the next section. we refer to  <cit>  for graph-theoretic definitions and notation, and to  <cit>  for details about weighted graphs. in the following we add parameters to ndim in oder to clarify the interpretation.

monotonicity: for induced connected subgraphs g <dig> and g <dig> of a binary or weighted connected finite graph g, we have the following implication. 
 g1⊆g2⇒ndim≤ndim,  where μ is the average and m is the minimum positive distance. the parameters μ and m may be derived from g or from gi. . this relation is an approximate version of condition c <dig> 

for infinite graphs g <dig> and g <dig> with μ1<μ <dig> and μ <dig> μ2→∞, the exact version of condition  <dig> reads as follows: 
  g1⊆g2⇒limμ1→∞ndim≤limμ2→∞ndim 

as 
 limμ→∞ndim=limμi→∞ndim,i= <dig> . 

here it was assumed that all limits exist.

maximum property: for induced connected subgraphs g <dig> and g <dig> of a binary or weighted finite connected graph g and for 
  g1⊎g2:=v∪v,e∪e∪e, 

where e denotes the set of all edges of g directly connecting vertices v of g <dig> and g <dig>  we obtain the following estimates: 
 ndim−1lb/m)≤max{ndim,ndim}≤ndim,  for fixed μ and m. here we set lb:= log <dig> 

the above relation for ndim is also called the quasi maximum property in  <cit> , implying that the complexity ndim of a finite graph is determined approximately by a subgraph with maximum clique cardinality. the error of this approximation reduces as the average distance μ increases, thus approaching the exact maximum property  for infinite graphs g <dig>  g <dig>  g1⊎g <dig> when μ <dig> μ2→∞: 
 limμ12→∞ndim=maxlimμ1→∞ndim,limμ2→∞ndim.  the existence of all limits was assumed.

proofs
in this section, we proof the monotonicity and maximum properties of ndim for binary and weighted connected finite graphs w. we use the transformation w→ multigraph m→ distance graphd→ binary distance graph g, as described in application of ndim to weighted graphs / <dig>  and present the proofs for the maximum cliques clmax. the complexity ndim for w is finally estimated by 
 ndim=log|clmax|log/m,  where μ denotes the average distance and m the minimum positive distance derived from d. for graph theoretic definitions and notation, see  <cit> .

monotonicity: for induced subgraphs g <dig> and g <dig> of g, we have the implication: 
  g1⊆g2⇒|clmax|≤|clmax|, 

for connected as well as disconnected subgraphs g <dig> and g <dig> 

proof.
if g1=g <dig>  the identity is true. if, w.l.o.g., g1⊂g <dig>  then the vertex cardinality |clmax| is a lower bound for |clmax| implying the right-hand side of .

assume now that the induced connected subgraphs wi⊆w have the property that w1⊆w <dig>  they are transformed to induced subgraphs gi in the distance graph g with g1⊆g <dig>  by , we have ndim≤ndim, for fixed μ and m based on w.

to clarify the understanding of the proof of the maximum property, a binary graph  with k=⌊μ⌋= <dig> and its binary distance graph  are shown in fig.  <dig>  the maximum 2-clique in  and the corresponding maximum clique in  have identical vertex cardinality and are indicated in red. if the weight m= <dig> in  is modified to m= <dig>  we still have k= <dig> and the binary distance graph  becomes disconnected. edge eliminating cuts  are indicated in  and . any cut separates a graph g into a pair of disjoined induced subgraphs g <dig> and g <dig> with g=g1⊎g <dig>  note that in a graph g several maximum cliques with identical vertex cardinalities |clmax| may exist. due to their distance dependence, k-cliques of subgraphs gi may involve paths outside of gi, as see by the green cut in . if the distances in  are artificially restricted to gi, statement b) in the following lemma may not be fulfilled: apply, e.g., the modification m= <dig> and the green cut. then |=10)>|clmax|=2+|clmax|=7) in , where clmax={ <dig> , <dig> , <dig> ,13}.

maximum property: for induced connected subgraphs w <dig> and w <dig> of a binary or weighted finite connected graph w and for 
 w1⊎w2:=v∪v,e∪e∪e,  where e denotes the set of all edges of w directly connecting vertices v of w <dig> and w <dig>  we obtain the following estimates: 
 ndimw1⊎w2−1lb/m)≤maxndim,ndim≤ndim, 

for fixed μ and m. here we set lb:= log <dig> 

we prove the maximum property in several steps.

lemma.
assume that g <dig> and g <dig> are induced connected subgraphs of a finite binary distance graph g. if g1∩g2=∅ and g1⊎g <dig> is connected, then we have for the vertex-cardinalities |·| the following estimates: 
max|clmax|,|clmax|≤|clmax|;

|clmax|≤|clmax|+|clmax|.



proof of : applying the operation ⊎ to g <dig> and g <dig> implies that gi⊆g1⊎g <dig>  for i= <dig> ; see fig.  <dig> for an illustration. by monotonicity, this set containment yields that |clmax|≤|clmax|, which gives statement .

proof of : 
assume that no eliminated edge connecting g <dig> and g <dig> is contained in any of the n≥ <dig> maximum cliques of g1⊎g <dig>  then,  holds as an inequality; see the green cut in fig.  <dig> 

assume that only one maximum clique clmax exists and that eliminated edges connecting g <dig> and g <dig> are contained in this maximum clique clmax; see blue cut in fig.  <dig>  using the notation clmax,i:=clmax restricted to gi, we have |clmax|=|clmax,1|+|clmax,2| and  holds as an identity in case |clmax,i|=|clmax|, for i= <dig> . on the other hand,  is satisfied as an inequality if |clmax,i|<|clmax|, for i= <dig> or i= <dig>  if |clmax,i| contains only a single vertex then |clmax,i|= <dig> 

first assume that we have n> <dig> maximum cliques clmax. for a cut that eliminates edges of m  maximum cliques clmax, the inequality is true, as there exists at least one maximum clique clmax⊆gi for i= <dig> or i= <dig>  if the edges of all n maximum cliques clmax are removed, then we have for every maximum clique clmax the identity |clmax|=|clmax,1|+|clmax,2|. suppose now that there exists a maximum clique clmax with |clmax,1|=|clmax|. then, |clmax|≥|clmax,2| which yields . on the contrary, if we assume that for all n maximum cliques |clmax,1|<|clmax|, then inequality holds in . □



now overlapping subgraphs are analyzed. two cuts are involved to separate g <dig> and g <dig> 

remark <dig> 
statements  and  in the lemma also hold when g1∩g2≠∅ for connected subgraphs g <dig> and g <dig> 

proof of : follows the same arguments as those given in the proof of the lemma.

proof of : assume w. l. o. g. that g~1:=−g <dig> is connected, where g~1⊂g <dig>  g~1∩g2=∅, and g~1⊎g2=g1⊎g <dig>  then statement  in the lemma holds. by monotonicity,  is then also true for the subgraphs g <dig> and g <dig>  if g~ <dig> is not connected, we follow the same argumentation applying the definition of a maximum clique for disconnected binary graphs as given in application of ndim to weighted graphs /3c. □

remark <dig> 
both statements in the lemma are also valid if g <dig> and g <dig> are connected, g1∩g2=∅, and g1⊎g <dig> is disconnected.

proof.
statements  and  hold trivially as an equality, respectively, an inequality.

remark <dig> 
if the induced subgraphs g <dig> and g <dig> are disconnected, then statements  and  in the lemma are valid.

proof.
apply the argumentation given in the above proofs with trivial modifications.

remark <dig> 
statement  in the lemma and remarks  <dig>   <dig>  or  <dig> imply that 
 |clmax|≤2max{|clmax|,|clmax|}.  combining  and  and taking the logarithm to base  <dig> yields the maximum property.

discussion
we introduced in this paper a new measure of complexity, ndim, for binary and weighted graphs. numerical applications to grids, fractal and non-fractal models, and to human brain data are complemented by the proofs of some general mathematical properties of ndim. the term complexity can be understood in a picturesque manner if we regard complete graphs with finite size and constant weights w=c> <dig>  in this case, ndim= log/ log <dig>  such graphs combine maximum complexity with maximum cost thus indicating that for a fixed size increasing complexity may be due to a proliferation of increasing network connectivity. the concept ndim is closely related to box-covering dimensions for fractal graphs derived from log− log plots  <cit> . although ndim, if applied to fractal graphs, can be interpreted as a fractal dimension, ndim does not rely on log− log plots, which quickly become uninformative losing linearity by hub attraction or noise.

the construction of ndim is motivated by the extended counting method, proposed by sandau and kurz, see  <cit> , to calculate a fractal dimension for point sets in ℝn, and relies for graphs essentially on the computation of maximum k-cliques in binary or multi-graphs. the use of distance-based k-cliques to count the maximum vertex cardinality of “tightly knit vertex groups” is somewhat arbitrary; diameter-based k-clubs  <cit>  might also be reasonable candidates but would require substantially longer cpu times for some of our applications. for the measure of cohesion we used k=⌊average distance⌋, where the average distance of a graph is a measure for its compactness. the alternative k=⌊diameter/2⌋, which is closer to sandau’s original proposal was also numerically tested. we found that for graphs with small distances, ndim computed by using k=⌊diameter/2⌋ lost robustness when short path graphs were added randomly.

fractal dimensions fd should satisfy  a list of conditions given in background. for graphs, the following conditions are relevant: fds are invariant to multiplicative factors, fds are extensions of topological dimensions, different fds for self-similar fractal graphs are equivalent, and the monotonicity and maximum properties are satisfied . according to the definitions of ndim for binary and weighted graphs, ndim satisfies factor invariance . in ndim and manifolds, we showed that ndim approaches the topological dimensions of grid graphs  as their size increases. in addition, we quantified that ndim converges faster than the box-covering dimension memb to the topological dimension of a grid. applying cost and global efficiency to the regular latices, we find that both topological measures of complexity tend to zero as the size increases losing complexity information; see table  <dig>  models of self-similar fractal binary graphs are explored with ndim and the box-covering dimensions memb and bcm, in order to study the agreement between fds for self-similar fractal graphs . these models are iteratively generated and increase in size, diameter, and node degree, for an increasing generation parameter g. in the limit g→∞, a box-covering dimension of the model can be calculated analytically. we found that with increasing parameter g the quantities ndim, memb, and bcm approach the model dimension . cpu-time limitations prevented the investigation for graphs of size > <dig>  different degrees of hub attraction or noise destroy the fractality of a graph. the box-covering dimensions are no longer well defined in such cases in contrast to ndim which is applicable beyond fractality. .

the iteration of the graph models applies an inverted renormalization process; the growth of the parameter g reduces the length scale and increases the resolution of a graph. accordingly, the iteration process can be interpreted as an increased network parcellation. we see in fig.  <dig> that ndim is for e> <dig>  not scale invariant, especially for small-world graphs ; however, for fractal graphs or for graphs close to fractality  ndim is quite stable for g> <dig>  see also fig.  <dig>  studying the effect of different spatial parcellations of the human brain on graph metrics is an important clinical issue  <cit> , it relates to the problem of comparability of studies with different brain parcellations. it is shown in  <cit>  that topological metrics of resting state fmri networks vary with the spatial parcellation scales; however, some qualitative properties, like small-worldness or scale-freeness are stable. this differs from our results, where the metric ndim is increasingly stable for fractal graphs. fractal graphs were detected in the human brain by gallos et al.  <cit>  for dual task fmri data and convenient thresholding ; see also fig.  <dig>  for two different spatial brain parcellations the results were similar, see supplement of  <cit> . a systematic investigation of the dependence of their findings on spatial brain parcellations was to our knowledge however not performed. studying the dependence of complexity ndim for real data on different brain parcellations is beyond the scope of the present paper and may be a topic of future research. at present we can only say that scale invariance of ndim can be achieved if the spatial brain parcellation induces a network parcellation of a fractal network.

the conditions monotonicity and maximum property  are outlined and proven in proofs. monotonicity asserts that the complexity ndim cannot decrease for graphs g <dig>  g <dig> with g1⊆g <dig>  the maximum property claims that the complexity ndim of a graph g can be estimated by the complexity of a subgraph of g. we showed that for binary and weighted, fractal and non-fractal graphs monotonicity is approximately satisfied for finite graphs. the same conclusion holds for the maximum property. these approximations improve as the average distance increases. in the limit, as the average distance approaches infinity, conditions c <dig> and c <dig> hold exactly. conditions c <dig>  c <dig> are essential properties of any concept of dimension  <cit> , may it be topological or fractal. as ndim satisfies conditions c2-c <dig> at least approximately, we may interpret ndim when applied to fractal graphs as a fd, similar to memb or bcm. more generally, without restricting to fractal graphs, we may interpret ndim as a dimension measuring complexity.

bio-medical networks are frequently modeled by weighted graphs. methods to apply ndim to weighted graphs were presented in application of ndim to weighted graphs. all three methods mapped the weighted graph to convenient binary graphs, where a maximum k-clique was computed. thresholding proved to be the fastest method, but simplifies any weight w> <dig> to a yes-no edge a= <dig> or  <dig>  comparing with cost and efficiency, we find that ndim has enhanced power to differentiate connectivity in a healthy and a depressed subject; see fig.  <dig>  more information about the weights is maintained in the monte carlo method, where w is mapped to an ensemble of binary edges; the higher w the more frequently a= <dig> is sampled. mapping a weighted graph to an ensemble of binary random graphs implies that the complexity of the weighted graph is described by a distribution of complexities ndim of the corresponding binary graphs; see fig.  <dig>  therefore, the difference of the complexity between two weighted graphs can be made statistically relevant by significance testing, analyzing the shift in the two ndim distributions  <cit> . this may be of importance for a personalized clinical analysis of the abnormal functional connectivity under depression. as ndim is a regional measure, core nodes within the maximum k-cliques can be detected to localize rois which act as communication centers or hubs. our analysis shows that the probability for such hubs is increased for subjects under depression; see fig.  <dig> 

in a third approach, using functional distances, the weighted graph was transformed to a binary k-distance graph and ndim was calculated via the cardinality of its maximum 1-clique. we applied this method to a dual-task fmri data set  <cit>  and compared ndim with the box-covering dimension bcm that was modified for a direct application to weighted graphs. for a high percolation threshold  we found, similar to gallos et al.  <cit> , large connected components which are at least close to a fractal with rather low complexities ndim and bcm. for a lower threshold , the components collapse into a non-fractal network with lower average distance and higher complexity ndim. due to the non-linear log− log plot for p= <dig> , bcm can no longer be calculated reliably over the entire range of box sizes. this demonstrates the advantage of ndim, which can quantify complexity beyond fractality. the limited applicability of the box-covering dimension bcm is apparent already for r <dig> coefficients with r2< <dig> ; see fig.  <dig> 

the weights of a network can be altered by the application of thresholding techniques or by noise. direct thresholding is applied in figs.  <dig>   <dig> and  <dig>  in all cases correlation thresholding modifies the network complexity, in fig.  <dig> even the type – it separates strongly connected fractal subgraphs from a mixed compound. this influence of the threshold on complexity is intuitively clear: different correlation thresholds in, e.g., fmri data, focus on signals with a different degree of similarity; the lower the threshold, the higher the complexity due to monotonicity . in some studies correlation thresholding is additionally constrained by the condition of identical cost for the pair to be compared. we reparametrized the results of fig.  <dig> and achieved for cost = <dig> , <dig> , <dig> , <dig>  for efficiency and ndim smaller differences between healthy and depressed patients compared to direct correlation thresholding; all differences of efficiency were < <dig> , the differences of ndim were  <dig> , <dig> , <dig> ,  <dig> , respectively. we still find that ndim has more informative power than efficiency. next we look at robustness or noise sensitivity of ndim. to test this, the weights of the correlation graph for fig.  <dig>  were modified by adding uniformly distributed noise. for w→w+ε, ε∈, where α∈{ <dig> , <dig> , <dig> , <dig> }, we obtained ndim= <dig> →ndim=  <dig> ,  <dig> ,  <dig> , and  <dig> , respectively. under the influence of such noise, ndim is quite robust. different is the effect of noise on binary graphs by adding randomly connections =1; e.g. complexity ndim of the fractal model e= <dig>  g= <dig> of fig.  <dig> increases by  <dig> , <dig> % if only  <dig> , <dig> % random connections are added, see also  <cit> .

computational cost  for large networks is a problem for any np complete algorithm  <cit> . in our calculations of ndim for the synthetic networks of fig.  <dig> cpu times depend on the type characterized by parameter e and on the generation parameter g or size. we find for any type monotonicity of ndim with size. this agrees with intuitive expectation, as renormalization  induces blurring reducing vertices and low distance connectivities; if renormalization produces a subgraph  of the graph  monotonicity of ndim could be proven formally. the worst case  cpu times for the graphs with e= <dig> . <dig> . <dig> are cpu =  <dig>   <dig>   <dig> sec, for g= <dig>  cpu ∼ <dig> sec in all cases. critical are the cases e= <dig>  and  <dig>  we find, e.g., for the case e= <dig>  and g= <dig> a cpu time of more than  <dig> hours, for g= <dig> , <dig>  a cpu time of only  <dig> , <dig> sec. the mentioned cpu times are calculated without any constraints on the clique cardinalities; especially constraining the lower bound can improve speed  <cit> . monotonicity enables a simple rule to estimate this lower bound exp· log+1))=lower bound of| maxk-clique|. if we incorporate this information as a constraint in our calculations we find the following cpu times: for e= <dig>  and g= <dig> cpu = <dig> sec, for e= <dig>  and g= <dig> , <dig> cpu = <dig> , <dig> sec. for fractal networks based on real data, as used in fig. 7a,b, we needed only cpu ∼ <dig> sec without constraint. this may be due to inherent type mixing or noise in real data networks. we tested computational cost for seven additional connectivity networks taken from the brain-connectivity-toolbox, see data. we had to symmetrize some of the adjacency matrices, as ndim is defined for undirected networks only, using the triangle above the diagonal of the matrix. in some cases the graphs were disconnected, in such cases the largest connected component was used. for these  <dig> networks complexity was calculated without constraints, cpu time was in all cases moderate, see table  <dig>  all cpu times were produced by a single processor  applied to the commercial software mathematica  <dig>  and should be regarded only as rough estimate which may be improved by faster hard ware equipment or software. a more basic improvement is possible by application of parallel computing as was demonstrated in  <cit> , where fast algorithms for the calculation of the maximum clique were developed and tested; we showed in application of ndim to weighted graphs that ndim can always be calculated by a maximum clique . applying  <dig> processors to the maximum clique calculation for a network a speeding up factor of ∼ <dig> could be achieved. implementation of this involved method was beyond our scope.


CONCLUSIONS
we presented a new measure, ndim, to quantify complexity originating by the proliferation of edge-connectivity in binary or weighted networks. ndim is essentially determined by the cardinality of a maximum k-clique of the graph and fulfills the conditions of a dimension. these dimensional properties guarantee a large informative power of ndim, compared to cost and efficiency. in addition, for a fractal graph ndim estimates its fractal dimension, like the recently proposed box-covering dimensions. but, box-covering dimensions cannot be calculated uniquely for fractals perturbed by noise caused by the addition of random edges or for graphs with hub attraction like small world graphs. for ndim however, there is no such limitation; comparisons of complexity between all types of finite graphs can be performed. these features were demonstrated for model calculations and by comparisons of functional brain connectivity for healthy and depressed subjects. due to this informative power and flexibility, ndim may become a useful tool in biomedical studies performing comparisons of complexity of finite networks.

competing interests

the authors declare that they have no competing interests.

authors’ contributions

kh proposed the new concept of complexity measure, performed several of the numerical tests, contributed to the proofs, the interpretations of the results, and helped to draft the manuscript. pm contributed to the proofs and to the analyses of new advanced mathematical methods involved in this study. he contributed to draft the manuscript and was responsible for its latex formulation. sp designed and implemented numerical algorithms for the calculation of box-covering dimensions. in addition he performed with these algorithms model and real data analyses. all authors read, discussed, and finally approved the manuscript. every author contributed substantially to the presented work; it is the result of a cooperation.

