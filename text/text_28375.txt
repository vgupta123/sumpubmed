BACKGROUND
dna methylation has a role in the development of eukaryotic organisms  <cit>  and may represent the interface between genome and environment  <cit> . currently, the most widely used method for detecting 5-methylcytosine is the treatment of dna with sodium bisulfite  <cit> , which results in the deamination of all non-methylated cytosine to uracil. since sodium bisulfite does not convert 5-methylcytosine bases to uracil, this approach allows for the direct interpretation of where methylation has or has not occurred in the genome. this interpretation is complicated by the need to generate percentage methylation statistics per cytosine residue because the same locus can have different methylation levels across cells. this complication underscores the need to have careful metrics to assess experimental procedures.

bisulfite treatment combined with next-generation sequencing  is the method of choice for the nih epigenomics roadmap  <cit> , a project with a stated goal to map methylation patterns in multiple tissue types. this experimental design underlies the expectation that there are different methylation patterns in different tissues, and there is a high likelihood that cells that make up these tissues themselves have different methylation patterns, even at the same genomic loci. this variation complicates analysis and can lead to high levels of noise, making data interpretation challenging. one major issue for all bis-dna next generation sequencing  experiments is read alignment to a reference genome. this is due to the loss of unmethylated c residues  leading to decreased complexity. specifically, the longer and more diverse a sequenced read, the more likely it is to align to the genome. loss of base diversity from the decrease in c bases means that individual reads may appear to align to multiple regions of the genome. a second major reason for alignment difficulties is the diversity of methylation patterns at cytosine loci. in a read containing many c residues, methylation patterns at the same base could be different between reads. this means that reads from the same genomic locus could align to different genomic regions.

bisulfite conversion of dna followed by massively parallel sequencing is likely to be the most practical approach to map methylation in the coming years, whether in reduced or complete genomic space  <cit> . reduced-representation bisulfite sequencing  uses an mspi digestion  prior to bisulfite conversion and library preparation to reduce genomic space, resulting in the sequencing of ~ <dig> % of the genome; however, a thorough analysis of its limitations, and methods to cope with these inadequacies, has not been fully addressed. early protocols for bisulfite sequencing  <cit>  were described for the illumina genome analyzer iix sequencer, where library preparation was singleplexed. later protocols  <cit>  switched to multiplexed indexing approaches using illumina trueseq dna sample preparation. notably, early protocols focused on library construction, while recent protocols have explored strategies for successful sequencing and analysis  <cit> ; however, there currently lacks a simple, detailed description of multiplex sequencing using conventional tools; complex, hard-to access strategies are exemplified by the proposal to use ‘dark’ sequencing  <cit>  in bisulfite sequencing experiments.

the purpose of the current work is to provide a simple bisseq protocol, with several qc checks throughout that can be used in standard laboratories and to test two main questions: 1) what is the function of pooling non-bisulfite dna with bisulfite converted dna in a single lane, and 2) what is the validity of using duplicate reads to calculate coverage statistics? in this work we carefully and completely lay out experimental procedures and qc parameters to assess bisseq experiments and we suggest that pooling 30% non-bisulfite converted dna with bisulfite converted dna has a minimal effect on bisulfite read output, meaning that sequencing non-bisulfite dna samples from unrelated experiments is practical. we find also that using duplicate reads to calculate coverage is legitimate, but that a simple test to assess whether the total read pool is representative of a read pool with no duplicates should be applied first.

methods
library preparation
all tissue samples used in this study were provided by the brain endowment bank™ following protocols approved by the research ethics board of the university of miami miller school of medicine. brain samples  were obtained at autopsy following the principles of the helsinki declaration and next-of-kin gave written informed consent. we used nebnext illumina library prep master mix kit for the library construction work. all experiments herein use reduced representation bisulfite sequencing; however, most optimizations can be applied to standard bisulfite sequencing. figure  <dig> shows a flow chart of library preparation procedures for multiplexed reduced-representation bisulfite sequencing , which takes on average 7– <dig> days. figure  <dig> shows a molecular level illustration of library preparation after the adaptor ligation stage.

enzyme digestion
after dna purification using the qiaamp genomic dna micro isolation kit from human brain, 2- <dig> μg of genomic dna was used to carry out the mspi  digestion at 37°c for  <dig> hours using  <dig> units of enzyme per μg of dna. digested dna was purified by phenol/chloroform  extraction . the aqueous top layer containing genomic dna was precipitated in the presence of nacl  and glycogen . the precipitated dna was pelleted via centrifugation and washed with  <dig> μl 80% ethanol  and then centrifuged again at  <dig> rpm for  <dig> minutes to solidify the pellet. the pellet containing mspi fragmented dna was resuspended in  <dig> μl dh <dig> for the end-repair reaction. five-ten percent of the purified mspi fragmented dna was then run on a precast 4-20% gradient polyacrylamide tbex <dig> gel and stained with ethidium bromide . this is an important step to verify the enzymatic digestion of dna; a complete mspi digestion will produce visible satellite bands in a smearing background . a high sensitivity dna chip to check the completion of mspi digestion can also be used .

end repair 
mspi recognizes double stranded dna at 5′-c^cgg-3′ and cleaves the phosphodiester bonds upstream of cpg dinucleotide. this reaction results in dna fragments with 5′ overhangs, so end repair is necessary to fill-in the 3′ termini of each fragment. this way, all mspi digested library fragments should contain a cpg dinucleotide on both ends of the fragment. the nebnext dna library prep master mix set for illumina separates the filling-in step from da-tailing reaction.

filling- in of mspi rragmented dna
using the mspi fragmented dna  described above, the nebnext end repair reaction buffer , and the nebnext end repair enzyme mix , we incubated the solution  at 20°c for  <dig> minutes. after incubation, the reaction mixture was diluted to  <dig> μl with dh2o. next, we added  <dig> μl of p/c at room temperature. after ethanol precipitation, dna was resuspended in  <dig> μl dh2o in preparation for the da-tailing reaction.

da-tailing of blunt end mspi fragment
the enzymatic process that adds an extra adenosine  to both the plus and minus strand 3′ termini is referred to as da-tailing and is necessary for ligation of the adaptors . following the nebnext dna library prep master mix set for illumina kit manual, we carried out the da-tailing reaction. we used  <dig> μl blunt-end dna,  <dig> μl of nebnext da-tailing reaction buffer , and  <dig> μl klenow fragment , for a total volume of  <dig> μl and incubated at 37°c for  <dig> minutes. next, p/c extraction and ethanol precipitation were performed following the same steps as outlined above, without the inclusion of glycogen . the final volume of da-tailed mspi fragment is  <dig> μl in dh2o.

methylated adaptor design
we used the two-step illumina adaptor design for the adapters and the pcr indexing primers because it decouples the indexing reaction from library amplification , and allows for more efficient bisulfite treated dna library amplification and size selection. we synthesized published illumina paired-end adaptor oligonucleotides, and had all cytosines replaced with 5′methyl-cytosines in order to prevent the deamination of the adaptor cytosines in the bisulfite conversion reaction. all adaptors and indexing primers are listed in table  <dig> 

abbreviations: c  methylated c, p phosphate, s phosphorothioate bond.

illumina methylated y-adaptor annealing
prior to adaptor ligation, we carried out an adaptor y fork annealing reaction by combining equal molar ratios of methylated pe <dig> and methylated pe <dig> adaptors. with this, annealed adaptor oligonucleotides can be kept at -20°c for many months before use, provided high temperature and other denaturing conditions are avoided. to perform this reaction, we mixed  <dig> μl each of mc-pe <dig>  and mc-pe <dig>  in pcr well-plates and carried out the following denaturing and annealing reaction on the thermal cycler: 95°c,  <dig> s; 80°c,  <dig> s; 70°c,  <dig> s; 60°c,  <dig> s; 50°c,  <dig> s; 40°c,  <dig> s; 30°c,  <dig> s; 4°c indefinitely.

ligation of methylated y-adaptor to da-tailed dna fragments
for the ligation reaction, we used  <dig> μl da-tailed dna,  <dig> μl neb quick ligation reaction buffer ,  <dig> μl pre-annealed illumina methylated y-adaptors, and  <dig> μl neb quick t <dig> ligase for a total volume of  <dig> μl. this was then incubated for  <dig> hour at 16°c, followed by a second incubation for  <dig> minutes at 20°c.

purification of adaptor- ligated library
we used the qiaquick pcr purification kit for the purification of the adaptor-ligated libraries. we used  <dig> μl of qia buffer pe to carry out the purification process for  <dig> μl of the ligation mixture. the purified libraries were then eluted in  <dig> μl of dh2o.

bisulfite conversion
we used the qiagen epitect fast  <dig> bisulfite kit to carry out the bisulfite conversion of adaptor-ligated library. this single conversion step is reported to be sufficient to achieve a ≥99% conversion rate . we used 50% of the purified adaptor ligated library for bisulfite conversion. to purify dna, the reaction mixture was transferred into a 96-well plate, with a high affinity membrane on the bottom of each well . buffer bl, bisulfite conversion mixture and ethanol  were added sequentially, mixed, then left to stand for  <dig> minutes. after spinning, single stranded, bis-converted dna was bound to the membrane. we then washed twice with buffer bw, than twice with buffer bd to achieve a complete on-membrane desulfonation. this was followed by two more washes with bw then a final elution with buffer eb.

pcr amplification of bisulfite converted libraries
agilent pfu turbo cx hotstart dna polymerase has the property of uracil-tolerance and high fidelity dna polymerization. amplification of bisulfite-converted libraries was carried out simultaneously with the library size selection process by using the progressive pcr method. indpepcr_f  and _r   were used as pcr primers.

the detailed pcr reaction mixture  is as follows:

10x pfu turbo cx rxn buffer - <dig> μl

dntp - <dig> μl

indpepcr_f - <dig> μl

indpepcr_r - <dig> μl

pfu turbo cx hot start dna polymerase- <dig> μl

bisulfite converted rrbs library- <dig> μl

dh2o - <dig> μl

the pfu turbo cx hot start dna polymerase should be added last. the detailed amplification cycle is as following:

 <dig>  95°c- <dig> s

 <dig>  95°c- <dig> s

 <dig>  60°c- <dig> s

 <dig>  72°c- <dig> s

 <dig>  4°c indefinitely 

repeat steps 2– <dig> for  <dig> cycles

the final pcr products represent the minimally-amplified and size-selected non-indexed rrbs libraries. we confirmed the correct size amplification by running a  <dig>  % hr agarose gel  or an invitrogen 4-20% gradient polyacrylamide gel , or invitrogen e-gel 2% with sybr safe, all after  <dig> cycles of pcr. samples showing faint but visible 150– <dig> base pair  smearing on the gel have the optimal amplification pcr cycles. satellite dna bands should also be visible in the smearing background for a well-constructed and optimally amplified rrbs library . samples that give very faint smearing require additional pcr amplification cycles. samples requiring extra pcr cycles  can be returned to the thermal cycler for 2– <dig> more cycles of amplification following the above progressive pcr protocol. ten μl of these ‘additional cycle’ amplified pcr reaction mixtures can be run on a gel and checked for smearing. thus, final library selection is determined by visual inspection of gel images for appropriate smearing and satellite band patterns . this is required because of the large variation observed across libraries, even with identical starting dna concentrations and enzyme digestion times. finally, we perform a cleanup step with the remaining pcr products from all libraries using ampure xp spri beads  using  <dig> μl/ <dig> μl  ratio. after purification,  <dig> μl of the purified library was used for quality control using an agilent bioanalyzer  <dig> high sensitivity dna chips. a good amplified size-selected and purified library produces a smear covering 150– <dig> bp with visible satellite bands, similar to that seen in figure  <dig>  with very little primer-dimers.

indexing
using  <dig> μl of purified, non-indexed library, we performed the following pcr indexing reaction for each library. the pcr primers used for indexing reaction are indpepcr_f  and index_#r primer 

10x pfu turbo cx rxn buffer - <dig> μl

dntp - <dig> μl

indpepcr_f - <dig> μl

indpepcr_#r - <dig> μl

pfu turbo cx hot start dna polymerase- <dig> μl

non-indexed rrbs library- <dig> μl

dh2o- <dig> μl

the pfu turbo cx hot start dna polymerase should be added last.

using the following pcr steps:

 <dig>  95°c- <dig> s

 <dig>  95°c- <dig> s

 <dig>  65°c- <dig> s

 <dig>  72°c- <dig> s

repeat 2– <dig> times

 <dig>  4°c indefinitely

we used 60μl/55μl  ratio. ampure spri bead-purified library was eluted in  <dig> μl of dh2o. purified libraries can be screened on an agilent  <dig> bioanalyzer .

molecular cloning and sanger sequencing
 <dig> μl of ampure bead-purified library  was used for cloning experiments. the single band product was cloned using chemically competent e.coli cells and the pcr™4-topo® ta vector  using  <dig> μl of fresh pcr product,  <dig> μl of vector,  <dig> μl of salt solution, and ligated for  <dig> minutes at room temperature. four μl of ligated product was added to  <dig> μl of competent cells and incubated on ice for  <dig> minutes,  <dig> μl of s.o.c. medium  was added to the cells incubated in a 37°c shaker for  <dig> hour.  <dig> μl of transformed cells was plated on ampicillin agar plates and incubated for  <dig> hours at 37°c. prior to sequencing, we assessed some band sizes by an ecori digestion of plasmids . sequencing was done using rolling circular amplification, a service provided by genewiz, inc . m13f  sequenced colonies were aligned using lasergene® seqman pro .

for methylation assessment of a single, targeted locus, a  <dig> bp amplicon was isolated from the original rrbs library preparation for sample g <dig>  two μl of template was amplified using high fidelity platinum taq  and the pcrx enhancer system to facilitate amplification of cg rich template , with the following thermocycling conditons: 95° for  <dig> minutes,  x  <dig> cycles, 72° for  <dig> minutes, 4° indefinitely. bisulfite primers were designed using methyl primer express® , forward 5′- ggg aag agt tgg tta gag aga -3′ and reverse 5′-aaa acc ccc tat aaa aaa acc c- <dig>  corresponding to  chromosome 3:  <dig>   <dig>  452– <dig>   <dig>   <dig> 

massively parallel  sequencing
we used the illumina hiseq <dig> platform, with single-end  <dig> cycle sequencing. sequencing was performed by the mcgill university and génome québec innovation centre in montreal, quebec. data was downloaded onto our servers in fastq format. illumina de-indexed data was first processed using fastqc tool v <dig> . <dig> , which provides a user-friendly overview of raw sequencing data. the programs fastx_clipper, fastx_trimmer and fastx_collapser  were used to remove adaptors, filter low quality reads, and remove reads <  <dig> bp in length.

alignment
there are many excellent aligners for bisulfite sequencing data including bismark  <cit> , bsmap  <cit> , and rmap  <cit> , bs-seekeer <dig>  <cit>  and some of these have been recently assessed  <cit> . we opted to use bismark  <cit>  for its flexibility and compatibility with downstream processing tools such as methylkit  <cit> , which we use routinely for post-alignment processing. all user-set features were set to default, except for: --best, --n  <dig>  and –directional. for data visualization, we wrote a custom perl script to convert bismark output alignment files into the sam  format for the visualization of the alignment reads into the integrated genomic viewer  <cit> . this script is available for download at: http://www.mcgill.ca/psychiatricgenetics/tools- <dig>  further description of bioinformatic details can be found in the results section.

RESULTS
post-bisulfite indexing for increased flexibility and improved library purification
currently, most ngs bisulfite dna protocols take advantage of the ‘one-step’ design, where indexing and adaptor ligation occur in one step, but this creates longer products  which influences clean-up procedures and allows less flexibility in library amplification – an important factor in bisulfite dna projects because of the variability in dna concentration after bisulfite treatment. pre-indexing also requires decisions to be made about what samples to pool together prior to knowing the quality of each library. to devise a post-library indexing strategy, we used the illumina two-step paired end design  which uses a third indexing primer .

a major benefit to using the two-step illumina adaptor/indexing technology beyond the increased flexibility, is that they form dimers less than  <dig> bp, allowing for the use of spin columns rather than ampure beads; adaptor dimers using this strategy are  <dig> bp in contrast to the  <dig> bp dimers generated by the truseq protocol. spin columns recover all fragments > <dig> bps, whereas ampure bead purification functions best at high dna concentrations or with small volume operations. this means that a greater proportion of the library is retained after purification. a disadvantage of using the two-step approach is that fusion products between the adaptor and indexing primer form, and this product needs to be removed .

simultaneous amplification and size selection of bisulfite libraries by progressive pcr
progressive pcr amplification combined with limited pcr extension time achieves library amplification and size selection at the same time . size selection is achieved because standard taq dna polymerase extension speed is on the order of 700– <dig> nucleotides per minute at 72°c. instead of time-consuming gel-cutting for size selection, optimized progressive pcr can be performed to amplify and size-select libraries. we set the 72°c extension time to  <dig> seconds for 150– <dig> bp libraries. we used  <dig> cycles of pcr amplification cycles, then transferred plates immediately to 4°c . next, we ran a small aliquot of the pcr product  and verified the products on an agarose gel with etbr. when a smearing range from 200– <dig> bp is nearly visible a minimal amplification condition has been achieved . if there is no smear visible at all, the complete pcr reaction is returned to the thermal cycler and amplified for an additional 2– <dig> cycles, hence progressive pcr.

quality control check of final rrbs libraries
we used cloning and sanger sequencing to verify the quality of bisulfite conversion as well as library quality . qpcr is used for absolute quantification of the final library and also serves as a check-point for the incomplete bisulfite conversion. as illustrated in figure 5b, the dissociation curve from a bisulfite-converted rrbs libraries demonstrates a much lower melting temperature  as compared to a non-rrbs library . this drop in the template melting temperature is caused by the excessive presence of t and a bases in the rrbs libraries. this is not meant as a quantification of conversion rate, but rather as a ‘sanity’ check - a large shift should be observed in the melting temperature at this step when bis-dna versus non-bis libraries are compared. we performed real-time pcr using an abi <dig> sds system  with sybr green master mix according to the manufacturer’s instructions. primers used were pe-qpcr_f and r . figure  <dig> demonstrates a raw illumina qc output from one representative sample. note the general quality of the library , and the low cytosine content and approximately equal cytosines at positions 40– <dig> as compared to positions 1– <dig> . note also that >95% of reads have a large spike at base position  <dig> and  <dig> of a guanidine dinucleotide. this is caused by the mspi digestion which is expected in any mspi rrbs library.

descriptive characteristics of methylation patterns across samples post-sequencing but pre- alignment
prior to beginning any experiment, a visual inspection of cpg distribution can be done. even if an explicit hypothesis is being tested, the distribution of methylated to unmethylated cpgs is expected to be similar, and major deviations from this can be flagged in bisseq experiments. for example, figure 7a, c, e, g suggest that 55-65% of all cpgs have <5% methylation while 25-30% are methylated >95%, at least in dna derived from human brain tissue. there is also a relatively consistent but low frequency of methylation between cpg residues methylated at 10%- <dig> %, with a small but consistent increase when methylation data is binned in 5% blocks in the  <dig> - <dig> % methylated range. methylation in this bin is usually 2- to 3-fold higher than neighboring bins . finally, coverage per cpg should be uniform across independent samples; compare figure 7b, d, f, h .

calculation of c-t conversion rate
the calculation of c-t conversion rate is a contentious issue in any bisulfite experiment, but is fundamental to accurate calling of methylation. previous ngs studies using bisulfite converted dna have reported conversion rates from 97-99%  <cit> . c-t conversion rates in the current study are  <dig> - <dig> % ±  <dig> % across all  <dig> independent libraries. we calculate this conversion rate by adding the chh and chg variables from bismark, where ‘h’ refers to any non-g base in the genome. it may be that methylation occurs at non-cpg sites in the human genome; convincing reports of this have begun to emerge  <cit>  from mammalian genome studies. normally an all ‘c’ dna fragment could be included as a control in bisulfite sequencing studies, but this downplays the importance of the diversity of fragments in the genome which may effect conversion rates and has its own potential for errors being a homo-polymer. there are several checks that can be performed to assess c-t conversion: 1) an initial cloning experiment should be performed prior to ngs  to determine how well c-t conversion has functioned, 2) an assessment of the c ratio in bases 1– <dig> and 40– <dig> in sequenced reads , and finally 3) an internal negative control can be used to assess c-t conversion  genome to assess c-t conversion).

visualizing data in igv and using the mitochondrial  genome to assess c-t conversion
visualization of aligned reads in the integrated genome viewer  is a simple method to assess initial accuracy of alignment. reads should begin at cgg or tgg , there should be equal balance between forward and reverse reads, and the number of non-methylated related errors should be what was set in the alignment program . figure  <dig> shows an example of what this may look like for one region, but simply looking at different regions is inefficient, so we propose that the mitochondrial genome be used for initial visualization. mammalian mt genomes are not methylated  <cit>  and have extremely low cpg content  <cit> , thereby providing an internal negative control for dna methylation experiments. methylation in the mt genome has also been recently confirmed to be absent from brain tissue  <cit>  which is the tissue source used here. specifically, alignment to the  <dig>  kb human mt genome allows for an assessment of c-t conversion rate . analyzing reads that align to the mt genome provides an isolated genomic locus with which to assess how well the alignment procedure has worked.

using imprinted regions and cloning to finalize alignment and library quality assessment
there are many known imprinting clusters in the human genome, though the tissue specificity and extent of methylation at each site are not precisely known  <cit> . to provide reference maps for expected methylation levels in human brain tissue and to demonstrate how these regions can be used as positive controls for a bisseq experiment, we began by selecting known imprinted cpg islands previously documented in sperm  <cit> . next, we assessed the same cpg islands in our sample using reads across all lanes and combining the data for each subject, though we included two cpg islands from genes that should not be imprinted, in other words, two regions where we did not expect to observe any methylation. table  <dig> shows the results from this experiment and we note the relatively narrow ranges across subjects for each locus. to demonstrate this narrow range across subjects we show the mean and standard deviation for each locus . table  <dig> shows the number of cpgs in the cpg island that were covered ≥ 1x and the mean coverage per cpg.

igf2r
grb10
peg3
mest
rb1
kcnq1
gapdh
actb
igf2r
grb10
peg3
mest
rb1
kcnq1
gapdh
actb
assessing imprinted regions for methylation status is an important check to ensure appropriate mapping , but a gold standard experiment to determine if methylation mapping and percentages are consistent with informatics analysis can also be done. to perform this experiment, we searched for high coverage regions with a mid level of methylation. we avoided regions with either 100% or 0% methylation because these likely would not show the variation across cell dna that would be needed to test if the computational algorithm was able to accurately detect methylation patterns. to validate the accuracy of our rrbs results we cloned a  <dig> bp amplicon from the original library preparation of sample g <dig>  which was the only subject sequenced across all lanes. we sequenced  <dig> individual clones, of those  <dig> were high quality and aligned to the reference sequence. this region gave us information for  <dig> individual cpg pairs. the average methylation level across all cpgs was not different between any of the  <dig> independent lanes of illumina sequencing, or the cloning and sanger sequencing  p =  <dig> ; figure 9).

significantly increasing the proportion of non-bisulfite converted dna has a minimal impact on read count from bisulfite-converted libraries
spike-in of non-bisulfite converted libraries might improve the quality of sequencing reads of bisulfite treated libraries. the reason for adding non-bisulfite converted dna is that it can increase the performance of an mspi-based rrbs library by increasing the diversity of the first three bases. in theory, all mspi based rrbs library reads start with cgg or tgg  and this can cause a diversity issue on the illumina hiseq platform and result in incorrect base calls and lower qc scores. one way to address this issue is to diversify the first  <dig> bases in dna fragments by the addition of non-bisulfite converted libraries which have a balanced a, c, g, t ratio.

to determine a reasonable concentration of non-bis dna to incorporate we used identical libraries across  <dig> lanes with varying levels of non-bisulfite-converted phix library in 1%, 10%, 20%, 30%, or 50% increments. table  <dig> shows the experimental design and tables  <dig> and  <dig> show the output data from this experiment for all samples across all lanes. additional file 1: table s <dig> shows clustering information. we first asked if the quality call per base was different when different amounts of phix spike-in were used. the mean quality score for all bases from bisulfite converted libraries  across each of the  <dig> lanes was , which corresponds to a linear, highly significant  decrease in quality as phix spike-in concentration increased; importantly, all of these quality scores are excellent .

*the same  <dig> libraries were used in lanes 1– <dig>   <dig> and  <dig> 

we next determined what the total number of achievable reads was for an experiment; here we used one full lane to sequence one bisulfite-converted library . we found  <dig>  m unique alignable reads in this analysis, with a mean coverage of  <dig> x per cpg , using only non-duplicate reads. given that there was ~  <dig> m reads per lane, sequencing one subject per lane is very inefficient; however, there is a logarithmic relationship between number of reads and number of unique alignable reads in an rrbs experiment. that is, there are diminishing returns as one continues to sequence the same sample – largely due to the high number of duplicates in each library.

we estimate that approximately > <dig> m unique reads is the range where ‘returns’  significantly diminishes. this is best demonstrated by the samples that were fixed across multiple lanes, but with decreasing concentration as the proportion of non-bis dna increased. we take one sample from table  <dig> to demonstrate this: sample g <dig> yielded  <dig>  m,  <dig>  m,  <dig>  m,  <dig>  m, and  <dig>  m reads in lanes  <dig> to  <dig>  respectively, despite the fact that the proportion of this library represented just  <dig> %,  <dig> %, 20%,  <dig> %, and  <dig> % of each lane, respectively. one would normally expect a decrease in unique, alignable reads between the first and last points to be 50%, yet in fact the decrease is just  <dig> %. this relationship was confirmed in three other independent libraries , suggesting that this is not an artifact of a single library or of liquid handling. our data further suggest that one major reason for this is the increase in cluster density as non-bis increases . cluster density is directly proportional to the total number reads, meaning that the more clusters there are the more reads there will be.

given that the total number of usable reads does not change substantially  with increasing proportion of non-bisulfite converted dna, we would suggest that bisulfite converted libraries can be run with non-bisulfite converted libraries at minimal cost to sequencing output. this has significant implications for cost savings and strongly encourages genome centers or individual labs to save sequencing costs by pooling bis dna and standard dna libraries in the same lane. we currently use this approach  for on-going projects.

calculation of coverage and use of duplicates in coverage statistics
a genomic library with reduced representation from the genome  and reduced read complexity  leads to a situation where many identical reads may be observed but which come from independent dna sources . to highlight this, we demonstrate coverage over one locus in figure  <dig>  first, note that unique read coverage comes from  <dig> of  <dig> possibilities; 1) from read ‘pile-up’ over a given region where mspi digestion sites are close, so that the same cpg is covered by different fragments, 2) by reads with identical mspi digestion sites but which have acquired errors, so map to the locus but are derived from a different read cluster, 3) by reads with identical mspi digestion sites, but with different methylation patterns, so map to the same locus, and 4) sequencing reads from the reverse strand. reads with a small number of errors  are highly useful in this context. in standard sequencing libraries, coverage is determined by pile-up, where reads have different start and end regions. here, reads at a given locus mostly have identical start and end points, due to targeted enzymatic digestion and illumina-determined read size . this suggests that regions of very high or low methylation will have lower coverage in these libraries .

how should coverage of a bisulfite-converted library be determined, given that enzymatic digestion gives identical fragment sizes when representation of the genome is reduced? a conservative approach is to use unique reads only and to calculate coverage over cpg sites only. in our data this approach gives a mean coverage of approximately 2-4x . because this is largely seen as inadequate to call methylation differences, different groups have included duplicates in their coverage calls, but duplicates are not normally used in coverage statistics from massively parallel sequencing experiments. the importance of utilizing duplicates is that they function as proxies to the true number of fragment reads, implying that simply filtering out duplicates removes valid data; however, as of yet there is no metric to determine when or how duplicates should be used. table  <dig> shows how output data from the experiment shown in table  <dig> changes when duplicates are included - coverage increases by ~10-fold . the relationship between methylation frequency calls and coverage may also be a limitation of rrbs more generally; that is, that low sampling of unique reads is inevitable.

we reasoned that if duplicates are valid to use they should be representative of the pool of unique reads. to determine if duplicate reads are representative of the unique aligned reads, we wanted to assess a sample of genomic loci where there are many unique reads  and where a given read has a high number of cpgs. ‘representativeness’ can be assessed in different ways, but the issue we most wanted to test was whether pcr bias  led to poor representation. pcr bias  occurs for two independent reasons in bisseq libraries: 1) fragments derived from the same locus can have different methylation patterns; increased methylation leads to the preservation of cytosine residues which have different melting temperatures, different interactions with polymerase, and different annealing times than fragments with ‘t’ residues; 2)  <dig> bp se sequencing does not alter the fact that libraries were selected at 150– <dig> bp in the progressive pcr step. shorter fragments may be amplified preferentially than longer ones because annealing and extension times are shorter. because the polymerase extension time is fixed in the library amplification step, longer fragments may not amplify in the initial pcr stages, but all short fragments will. pcr amplification can lead to a bisseq library that includes duplicates in the mapping statistics being unrepresentative of the initial bisseq library.

to assess this idea, we calculated a pearson correlation between methylation sites in all unique aligned reads compared to all reads at the same genomic locus. figure  <dig> shows an example region to demonstrate this concept. figure  <dig> and table  <dig> show four sites with differential methylation at one locus, . using just four cpg sites at this region selected for high cpg coverage in uniquely aligned reads, we found an r <dig> value of  <dig>  between reads from the uniquely aligned reads and all reads, which has a p-value of  <dig>  with a cpg n of four. while all the reads present in the uniquely aligned group are present in the all read group, this pearson calculation helps to guard against potential pcr bias . if one dna fragment happens to amplify at a significantly higher rate than any other, the pearson correlation coefficient would drop and duplicates would then be less representative of non-duplicate, uniquely aligned reads.

since pile-up of non-duplicate reads is low at any given locus and this qc metric requires differential methylation at cpg sites in the same read, we recommend assessing all loci with several unique reads  and differential methylation . significant r <dig> values at these regions would suggest that the library constructed is of good quality, and that duplicates can be used for assessing coverage statistics for the library.

these data sets correspond to the graphic in figure  <dig>  this table shows the frequency of methylation at each cpg in the read grouping where duplicates are removed and where duplicates remain. the r <dig> value associated with these data is  <dig>  .

discussion
we have proposed a set of improvements, from library construction to bioinformatic analysis, for any experiment using bisulfite converted dna for the purpose of methylation mapping, and addressed two issues in bisulfite sequencing experiments, namely the effect of including non-bis dna in bisseq experiments, and the extent to which duplicate reads can be used to calculate coverage statistics. our detailed approach and suggestions for sample pooling and coverage calculations should be useful in any experiment that uses massively parallel sequencing to understand dna methylation states.

we have several quality control checkpoints at each stage of the process, including library construction, pre-sequencing, post-sequencing, and post-alignment. at the library construction stage, we propose a multiplexing approach that uses a post-library indexing step, which allows the user to select an indexing strategy after library synthesis. because this technique also involves smaller adaptors, it allows for simple sample clean-up using inexpensive, efficient spin-columns. the progressive pcr step for library amplification allows fragment size selection by altering pcr extension time while allowing the user to achieve the lowest possible cycle number per library. together, these improvements simplify and speed-up the library synthesis process. at the pre-sequencing stage, we recommend cloning a small number of fragments to ensure fragment diversity  and to assess c-t conversion. a qpcr experiment can also be done using primers directed at adaptor ends and compared to melting curves for standard libraries. while this is a gross measure – 5% differences bisulfite conversion are unlikely to be detected for example, it is a simple check to reassure, particularly since qpcr experiments are often required for accurate quantification of library concentration prior to sample pooling .

there are several assessments that can be done immediately after massively parallel sequencing but before alignment. assessing base composition in sequenced reads will give a further reassurance about bisulfite conversion, for example. if there is a higher proportion of cytosine bases at position 40– <dig> in sequenced read compared to bases 1– <dig>  this may be evidence of incomplete conversion or sequencing error; one expects equal representation of all bases across all positions, with significantly lower cytosine residues compared to the other bases. in an rrbs experiment, the strong majority of reads should have cgg or tgg at base position  <dig>   <dig>  and  <dig>  if this is not observed, it suggests a problem with the enzymatic digestion. post-alignment, we generated a novel computational tool to make the bismark output readable in the igv. we suggest assessing all reads in the <17kb mt genome to determine library quality: are reads the size that is expected? is there equal representation from forward and reverse reads? are all c residues converted to t? beyond visual assessments, we also generated data at several imprinted regions that can be used by any other group using brain dna to determine library quality. imprinted regions are expected to have a specific level of methylation and if these regions show a large deviation from what is expected, it may suggest alignment or other problems. we also used molecular cloning to determine if our methylation calling parameters were accurate. having two different technologies  show strongly similar methylation patterns in a given region suggests that computational calling parameters are accurate.

a further goal of this project was to understand the role of pooling non-bis dna with bis-dna. we found that increasing the proportion of non-bis dna libraries with bis-dna libraries led to a minimal decrease in uniquely aligned reads and significantly increased cluster density, suggesting that pooling unrelated samples that have not undergone bisulfite conversion is not only viable but recommended to decrease sequencing costs. the increased proportion of reads that were sequenced when bis dna was decreased in a lane was due both to sequencing less duplicates from a library and to increasing clustering density presumably created by the addition of more diverse dna fragments. because duplicates are desirable in a well-performed bisseq experiment, we recommend a 30% spike-in of non-bis dna. a 30% spike-in will give almost identical cpg coverage as at 1% spike-in, and allow for the sequencing of unrelated non-bis dna samples.

we also addressed the validity of using duplicates in calculating coverage for bisseq experiments because duplicate reads are traditionally discarded in massively parallel sequencing experiments. we suggested that pcr bias can be assessed by using a correlation assessment where a single locus has many cpgs and many unique reads. by comparing cpg methylation frequency in the non-duplicate read pool to the all-read pool, one expects to observe a strong correlation between pools. a low correlation might be evidence of over-amplification in the library preparation stage which will be biased towards shorter dna fragments and fragments with less cytosine residues.

where does the future lie for methylation mapping? a move from rrbs to whole genome bisulfite sequencing  has already begun, though these whole genome experiments are much more expensive and still have significant alignment issues. the fractionation of dna instead of the enzymatic digestion improves things considerably because most fragments will be generated from different genomic locations instead of from ccgg locations. still, it is not clear that wgbs is worth the cost given that sites rich in cpgs continue to be assessed, and these are covered to a wide extent in rrbs, though recent evidence from mouse suggests that the most functionally relevant dna methylation sites might be located in cpg poor distal regulatory regions with low methylation levels. in this case, wgbs will be preferable because rrbs will miss many of these sites because of the absence of ccgg at the cpg poor distal regulatory regions  <cit> . it is clear that bisulfite sequencing is not an ideal methodology but it is currently the best available option to give reproducible data. bisulfite treatment of dna causes dna damage and recent reports suggest that hydroxymethylation may also be an important epigenetic mark  <cit>  and this may confound bisseq experiments because hydroxymethylation and methylation are indistinguishable after bisulfite treatment and pcr. single molecule sequencers  <cit> , whereby unamplified and untreated ‘native’ dna is sequenced are not yet ready for prime-time; however, it is foreseeable that all methylation  is done on single molecule sequencers in the not-to-distant future  <cit> .

CONCLUSIONS
these data suggest improved ways to process and analyze bisulfite sequencing data. we provide new methods for library construction and indexing, as well as several new options for qc assessment as well as recommendations for generating high quality data.

availability of supporting data
all supporting data is available within this manuscript and at the ernst lab website at:http://www.mcgill.ca/psychiatricgenetics.

abbreviations
bp: base pair; etbr: ethidium bromide; mt: mitochondrial; ngs: next generation sequencing; rrbs: reduced representative bisulfite sequencing; wgbs: whole genome bisulfite sequencing.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
ce designed experiments and conceived of the study. gc carried out experiments. ce and gc wrote the manuscript. ad, rj and ce performed bioinformatic analyses. as, cn, kv, pel, and vo assisted with experiments. dm and gt supplied reagents. all authors read and approved the final manuscript.

supplementary material
additional file 1
clustering informations, as well as adaptor and indexing primers fusion products, of bisseq libraries

click here for file

 ackowledgements
this work was funded by a research grant rgpin 435512– <dig> from the natural science and engineering research council of canada  and phs nida grant da <dig> . ce is supported by the canada research chairs program.
