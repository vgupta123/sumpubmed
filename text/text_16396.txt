BACKGROUND
hla class ii molecules are expressed by human professional antigen presenting cells  and can display peptides derived from exogenous antigens to cd4+ t cells  <cit> . the molecules are heterodimers consisting of an alpha chain and a beta chain encoded in one of three loci: hla dr, dp and dq  <cit> . the dr locus can encode two beta chains drb <dig> and drb3- <dig> which are in linkage disequilibrium  <cit> . the genes encoding class ii molecules are highly polymorphic, as evidenced by the imgt/hla database  <cit>  which lists  <dig>  known sequences of hla class ii alleles for hla-dr, hla-dp and hla-dq molecules . both alpha and beta chains can impact the distinct peptide binding specificity of an hla class ii molecule  <cit> . hla class ii peptide ligands that are recognized by t cells and trigger an immune response are referred to as immune epitopes  <cit> . identifying such epitopes can help detect and modulate immune responses in infectious diseases, allergy, autoimmune diseases and cancer.

information was extracted from imgt database. hla-dm and hla-do molecules are not included as they are not expressed on cell surface.

computational predictions of peptide binding to hla molecules are a powerful tool to identify epitope candidates. these predictions can generalize experimental findings from peptide binding assays, sequencing of naturally presented hla ligands, and three dimensional structures of hla peptide complexes solved by x-ray crystallography . several databases have been established to document the results of such experiments including antijen  <cit> , mhcbn  <cit> , mhcpep  <cit> , fimm  <cit> , syfpeithi  <cit>  and the immune epitope database   <cit> . iedb currently documents  <dig>  peptides tested for binding to one of more of  <dig> mhc class ii allelic variants of which  <dig> are human . it is possible to develop binding prediction methods for hla molecules for which no experimental data are available by extrapolating what is known for related molecules  <cit> . however, the quality of these extrapolations decreases for molecules that are very different from the experimentally characterized ones, and completely ab initio predictions have not been successful  <cit> . it is therefore a major gap in knowledge that little binding data are available for hla dp and dq molecules, which are more difficult to work with experimentally, but are equally relevant as hla dr molecules. resulting from this lack of data, the vast majority of hla class ii binding predictions to date are only available for dr molecules. we here address this gap by providing a consistent, large scale dataset of binding affinities for hla dr, dp and dq molecules which we use to establish and evaluate peptide binding prediction tools.

it is our goal to include a variety of binding prediction algorithms in the iedb analysis resource   <cit> , identify the best performing ones, and ideally combine multiple algorithms into a superior consensus prediction. in this study, we implemented two methods in addition to the previously incorporated ones. the first method is based on the use of combinatorial peptide libraries to characterize hla class ii molecules. such libraries consist of mixtures of peptides of the same length, all sharing one residue at one position. determining the affinity of a panel of such peptide libraries to an hla molecule provides an unbiased and comprehensive assessment of its binding specificity. this approach is also time and cost effective, as the same panel of peptide libraries can be scanned for all hla molecules of interest, and has been applied successfully for multiple applications  <cit> , the second method we newly implemented was nn-align  <cit> . this neural network based approach combines the peptide sequence representation used in the netmhc algorithm  <cit>  that was highly successful in predicting the binding specificity of hla class i molecules  <cit>  with the representation of peptide flanking residues and peptide length used in netmhciipan method  <cit> . both the nn-align and the combinatorial peptide library method were evaluated in terms of their prediction performance and ability to improve a consensus prediction approach.

finally, we wanted to address the impact of homologous peptides in our datasets on evaluating prediction results. the presence of homologous peptides in our dataset is primarily due to the strategies that were utilized in the peptide selection process. for comprehensive epitope mapping studies in individual antigens, we typically utilize 15-mer peptides overlapping by  <dig> residues that span entire protein sequences. another strategy utilized to define classical binding motifs is to systematically introduce point mutations in a reference ligand to map essential residues for peptide:mhc interaction. finally, for identified epitopes, additional variants from homologous proteins are often tested to predict potential cross-reactivity. all of these strategies introduce multiple peptides with significant sequence similarity into the dataset. this could affect the assessment of binding prediction in two distinct manners: 1) peptides in the testing set for which a homolog is present in the training may be easier to predict and thereby lead to overestimates of performance compared to real life applications; 2) the presence of multiple homologous peptides during training may bias prediction methods leading to reduced prediction performance when testing. to examine these issues, we compared evaluations with different approaches to removing similar peptides.

RESULTS
derivation and assembly of a novel mhc class ii binding affinity dataset
in a previous report, we described the release of  <dig>  mhc class ii binding affinities experimentally measured by our group  <cit> . the data included measured binding affinities for a total of  <dig> different mouse and human allelic variants. this dataset was at the time the largest collection of homogenous mhc class ii binding affinities available to the public and remains a valuable asset for the immunology research community. however, it was apparent that this dataset could be expanded and its utility improved in several regards. first, coverage of human hla dp and dq molecules was limited or non-existing. secondly, for several molecules, relatively few data points existed, in spite of the fact that we and others  <cit>  have shown that several hundred data points are desirable to derive accurate predictive algorithms. we have now compiled a new set of  <dig>  experimentally measured, mhc class ii peptide binding affinities covering  <dig> allelic variants . this set includes and expands the previous set, and is the result of our general ongoing efforts to map epitopes in infectious agents and allergens. these data represent an over four fold increase in binding affinity measurements and a ~ 60% increase in allelic variant coverage. importantly, the alleles included were selected for their high frequency in the human population . as a result, the combined allele frequency of this set of  <dig> mhc class ii molecules results in >99% population coverage . overall, an average of  <dig>  data points and  <dig> binders  are included for each molecule, ranging from a minimum of  <dig> data points for hla drb1* <dig> and  <dig> binders for h-2-iab, to the highest values of  <dig>  data points and  <dig>  binders for the hla-drb1* <dig> molecule. this uniformly large number of more than  <dig> affinity measurements for each included allelic variant was previously found to be required to consistently generate reliable predictions  <cit> . to the best of our knowledge, this is the first publicly available dataset of hla-dp and hla-dq binding affinities of significant size.

 <dig>  binder defined as ic <dig> < <dig> nm.

 <dig>  average haplotype and phenotype frequencies for individual alleles are based on data available at dbmhc. dbmhc data considers prevalence in europe, north africa, north-east asia, the south pacific , hispanic north and south america, american indian, south-east asia, south-west asia, and sub-saharan africa populations. dp, drb <dig> and drb3/4/ <dig> frequencies consider only the beta chain frequency, given that the dra chain is largely monomorphic, and that differences in dpa are not hypothesized to significantly influence binding. frequency data are not available for drb3/4/ <dig> alleles. however, because of linkage with drb <dig> alleles, coverage for these specificities may be assumed as follows: drb <dig> with dr <dig>  dr <dig>  dr <dig>  dr <dig> and dr14; drb <dig> with dr <dig>  dr <dig> and dr9; drb <dig> with dr <dig> and dr <dig>  specific allele frequencies at each b3/b4/b <dig> locus is based on published associations with various drb <dig> alleles, and assumes only limited variation at the indicated locus.

evaluation of previously reported methods with the new dataset
in our previous evaluation of mhc class ii binding prediction algorithms, we tested the performance of a large number of publicly available methods. among those methods, arb, smm-align and propred  were the top performing ones and were incorporated into the mhc class ii binding prediction component of the iedb analysis resource  <cit> . here, we re-evaluated their performance on the new dataset. as in the previous evaluation, we performed 5-fold cross validation for arb and smm-align and direct prediction for propred over the entire data set, and quantified the performance of the various methods by calculating the auc values using an ic <dig> cutoff of  <dig> nm, as shown in table  <dig> under the "current" columns. on average, the performance of the various methods was  <dig>  for arb ,  <dig>  for smm-align , and  <dig>  for propred . importantly, the cross-validated prediction performance for the newly included allelic variants was comparable to that of the previously included ones. thus, the arb and smm-align machine learning approaches can be successfully applied to hla dp and dq allelic variants.

best prediction performance for each allelic variant was highlighted in bold.

 <dig>  the current auc values for arb and smm-align were derived by cross-validation. the current auc values for propred were derived by predicting affinities for the new dataset.

 <dig>  the old auc values were taken from previous evaluation  <cit> .

the previously reported prediction performance data taken from  <cit>  is also shown in table  <dig> under the "old" columns. compared to the average evaluation results reported previously, arb  and smm-align  showed markedly improved performance. as the training algorithms were unchanged, this most likely can be attributed to the increase in dataset sizes. in contrast, propred achieved virtually the same auc value . as the propred approach is fixed and not retrained based on additional data, it is not surprising that the predictive performance on the new dataset did not differ substantially from the previously reported performance. also, as the new data set cannot be utilized to train new propred predictions, its predictions can now be generated for only a minority of the molecules considered.

incorporating novel prediction algorithms into the mhc class ii binding prediction arsenal
in addition to the previously implemented prediction methods, we integrated two new approaches into the iedb analysis resource. we used combinatorial peptide libraries to experimentally characterize the binding specificity of each hla molecule for which new assays were established, including all hla-dp and hla-dq allelic variants. the affinity of  <dig> libraries of 13-mer peptides, each sharing one amino acid residue in one of the positions from 3- <dig> was determined. the ability of these matrices to predict binding of individual peptides was evaluated with the entire new dataset, and the resulting auc values are shown in table  <dig> in the "all" column. it was found that the combinatorial library performed with auc similar or better than the propred method, which is similarly constructed based on affinity measurements for a library of single residue substitution peptides. similar results were obtained when performance was measured with spearman's rank correlation coefficient . this confirms that combinatorial peptide libraries are an efficient experimental approach to derive mhc class ii binding profiles. also, these predictions provide an alternative for those molecules for which the propred method is not available.

 <dig>  sr1stands for similarity reduced.

 <dig>  the consensus-best <dig> method is based on nn-align, smm-align and combinatorial peptide library. propred was used for allelic variants when combinatorial peptide library was not available

best prediction performance for each allelic variant was highlighted. the best performing method for "all" dataset was highlighted with underline while the best performing method for "sr" dataset was highlighted in bold.

the second new method we added to the iedb analysis resource was nn-align  <cit> . this method differs from previous approaches in that nn-align is neural network based and can hence take into account higher order sequence correlations. furthermore, nn-align incorporates peptide flanking residues and peptide length directly into the training of the method. this is in contrast to the smm-align method, where the peptide flanking residues and peptide length are dealt with in an ad-hoc manner. we evaluated the performance of nn-align using the same 5-fold data separations used for the arb and smm-align methods. the auc values derived from this cross validation are shown in table  <dig> under the "all" columns and the spearman's rank correlation coefficients were shown in additional file  <dig>  table s <dig>  the nn-align method stands out as having by far the best performance, with an average auc value of  <dig>  and average spearman's rank correlation coefficient of  <dig> .

a novel homology reduction approach for unbiased cross validation
some peptides in our dataset have significant homology to each other which could bias the cross-validation results if similar peptides are present in both the training and the testing sets. previous studies have attempted to address this issue and several strategies have been proposed to generate sequence similarity reduced datasets for cross-validation purpose. one such approach is to remove similar peptides from the entire dataset  <cit> . we call this a 'random selection' strategy as the order in which peptides are removed is not defined. we applied the algorithm to our dataset and for any two peptides that shared an identical 9-mer core region, or that had more than 80% overall sequence identity, one peptide was removed. the results are shown in additional file  <dig>  table s <dig> and highlight that this strategy selected a different number of peptides in repeated runs. to avoid this, we applied a hobohm  <dig> like selection strategy that deterministically selects a set of peptides, and also maximizes the number of peptides included in the data. this was done by a forward selection procedure described in the methods section. briefly, for each peptide the number of similar peptides was recorded and peptides were sorted according to this number. peptides were selected from this ordered list starting with those with the smallest number of similar peptides. if a peptide was encountered for which a similar matching one was already selected, it was discarded. as shown in additional file  <dig>  table s <dig>  this strategy indeed resulted in a stable selection of peptides and always selected a higher number of peptides than the random selection algorithm.

using the forward selection algorithm, we derived sequence similarity reduced  datasets and used them in five-fold cross validation to evaluate the performance of our panel of mhc class ii binding prediction tools. the results are shown in table  <dig> under columns titled sr. clearly, reducing sequence similarity had a significant impact on the observed classifier performance, which is consistent with previous findings  <cit> . at the same time, the order of performance of the different prediction methods was unchanged when using the reduced dataset, with nn-align performing the best, smm-align second, arb third, and propred and the combinatorial libraries last. the order of performance determined by spearman's rank correlation coefficient analysis  was largely identical except that arb and propred switched position. the largest drop in performance was observed for nn-align and smm-align, where the average auc value was reduced by  <dig>  and  <dig>   when tested with similarity reduced datasets, respectively. the smallest reduction was observed for propred with an average auc reduction of  <dig>   followed by the combinatorial peptide library with a reduction in auc of  <dig>  . as the latter two methods do not utilize the training dataset to make their prediction, it is expected that they show less of a drop in performance than the others. the fact that a reduction in performance was observed at all indicates that removing similar peptides from the testing set alone makes the prediction benchmark harder. this can be explained by the fact that homologous peptides removed because they are single residue substitutions of known epitopes or reference ligands are often 'easy' to predict, as they carry strong and straightforward signals to discover binding motifs.

training with peptides of significant sequence similarity doesn't negatively influence the prediction of unrelated sequences
an important question arising from the sequence similarity reduction and cross validation evaluation is whether inclusion of similar sequences will have a negative impact on the prediction of unrelated sequences. an excessive amount of peptides with similar sequences may bias a classifier such that the performances on sequences without significant similarity to the training data are negatively influenced. this was demonstrated in  <cit>  in which a classifier displayed better performance than others when evaluated on a dataset that contained similar sequences, but which completely failed when evaluated on a dataset with no homology between peptides. it is unclear though how relevant this finding is in practice, specifically as the inclusion of single residue substitutions can contain particularly useful information demonstrated by the fact that this is how the mhc binding motifs were originally defined  <cit> .

we developed a simple strategy to test if the inclusion of homologous peptides in the training data can affect the prediction of unrelated peptides. for each allelic variant, we selected a subset of singular peptides  set, which share no sequence similarity with any other peptides in the set . the similarity reduced  set is a superset of the sp set, which in addition to the sp peptides also contains one peptide from each cluster of similar peptides. for each peptide in the sp set, there exist two blinded binding predictions obtained in the previous cross validations: one where the training set included all peptides including homologs , the other where only non-homologous peptides were included in the training . by comparing the performance of the two predictions, we evaluated if inclusion of homologous peptides in the training negatively impacts the prediction of non-homologous peptides. we performed this test on all implemented machine learning methods with similar results, and are showing the resulting aucs for the top performing method nn-align in table  <dig>  on average, the performance of methods trained including homologues was higher than methods trained leaving out those peptides. while the difference is not significant , this alleviates concerns for the tested methods that predictions will actually get worse when including homologous peptides in the training. thus, it is advisable that the ultimate classifiers for public use should be trained using all available binding data.

the "all" column indicates 5-fold cross validation performance of this subset trained with entire dataset. the "sr" indicates 5-fold cross validation performance of this subset trained with sequence similarity reduced dataset.

 <dig>  auc reduction = auc all - auc sr

 <dig>  # peptide reduction = # peptide all - # peptide sr

 <dig>  % peptide reduction = /# peptide all

a consensus approach of selected methods outperforms a generalized consensus approach and individual methods
in our previous study, a median rank based consensus approach gave the best prediction performance. in this study, we updated the consensus approach with the new methods  and evaluated its performance on the similarity reduced as well as entire dataset . the result showed that while the consensus method remains a competitive approach, it does not outperform the best available individual approach nn-align  on the similarity reduced dataset.

we next investigated optimized approaches for deriving consensus predictions. we reasoned that simply increasing the number of methods included in a consensus prediction might not be optimal, especially if certain methods are underperforming, or simply if multiple methods are conceptually redundant . to determine the benefit of including individual methods in the consensus, we tested the performance of the consensus approach while removing each of the five methods  using the similarity-reduced dataset. the results indicated that removing nn-align, smm-align, the combinatorial peptide library and propred reduced prediction performance. in contrast, removing arb actually had a positive impact on consensus performance. based on this, we tested the performance of a consensus approach on the sr dataset utilizing nn-align, smm-align and the combinatorial library, or substituted propred for the combinatorial library for those alleles for which it is not available . the resulting average auc on the sr set  is significantly improved over consensus using all methods . also, the prediction performance of consensus-best <dig> in comparison to nn-align is significantly better in the sr set . when performance was measured with spearman's rank correlation coefficient, very similar results were obtained though the performance of nn-align and consensus-best <dig> were virtually identical on the sr set. thus, a combination of selected subsets of methods for a consensus could achieve better performance than the naïve consensus approach in which all methods were utilized.

inclusion of the novel dataset into the iedb and integration of the algorithms in the iedb analysis resource
we have updated the mhc class ii portion of the iedb analysis resource http://tools.immuneepitope.org/analyze/html/mhc_ii_binding.html to reflect the progress in data accumulation and algorithm development. there are now six algorithms available to predict mhc class ii epitope: the previously established arb, smm-align and propred methods, the newly established combinatorial library and nn-align predictions, and the combined consensus approach. the arb algorithm has been re-implemented in python to allow better integration with the website and future development. the machine learning based approaches  have been retrained with the complete dataset described in this article to provide improved performance. the collection of algorithms has also been implemented as a standalone command line application that provides identical functionality as the website. this package can be downloaded from the iedb analysis resource along with the mhc class ii binding affinity datasets, the prediction scores, and the combinatorial peptide library matrices.

discussion and 
CONCLUSIONS
computational algorithms to predict epitope candidates have become an essential tool for genomic screens of pathogens for t cell response targets  <cit> . the majority of these algorithms rely on experimental binding affinities to generate predictive models. the data presented in this study provides a large scale and homogenous dataset of experimental binding affinities for hla class ii molecules, along with a comprehensive evaluation of prediction performances for a number of algorithms. the binding dataset made available here is about four-fold larger than the one in our previous report  <cit> . the increased number of peptides per allele resulted in a significantly improved performance of machine learning methods, arb and smm-align. this reinforces the idea that the prediction performance of a machine learning method is greatly dependent on the amount of learning data available.

this present dataset is not only significantly larger than what was previously available, but also for the first time covers hla-dp and hla-dq molecules in depth. lack of data for these alleles was identified in previous studies as one of the challenges facing hla class ii binding predictions  <cit> . the significant increase  in the number of allelic variants results in a > 99% population coverage which could be very valuable for the development of t-cell epitope based vaccine. this dataset will also be useful in improving pan-like approaches that take advantage of binding pocket similarities among different mhc molecules to generate binding predictors for allelic variants without binding data  <cit> .

we added two new methods to our panel of prediction algorithms. combinatorial peptide libraries were used to experimentally characterize hla class ii alleles for which no propred predictions were available. data from such libraries have successfully been used to predict proteasomal cleavage  <cit> , tap transport  <cit>  and mhc class i binding  <cit> . the performance of the libraries for class ii predictions was comparable to that of propred, and in general inferior to the machine learning approaches. the main value of the combinatorial library approach lies in its experimental efficiency, and in that its predictions can be considered completely independent of those from machine learning algorithms. the combinatorial library approach increases its value when combined with machine learning methods for consensus prediction approaches.

the second method added was nn-align, which showed a remarkably high prediction performance in the benchmark. this repeats the dominating performance of the related netmhc prediction methods in a number of recent mhc class i prediction benchmarks  <cit> .

one of the challenges for evaluating the mhc class ii binding prediction performances is how to deal with the presence of homologous peptides in the available data  <cit> . one concern is that peptides in the testing set for which a homolog is present in the training data may lead to artificially high prediction performances. to address this, we generated sequence similarity reduced dataset from the entire available data using a forward selection approach such that no homologous peptides are present in the subset. the prediction performance on this similarity reduced dataset shows that the absolute auc values of the compared methods is indeed significantly lower than that of the entire dataset. however, the rank-order of the different prediction methods was largely unchanged between datasets. this leads us to conclude that 1) the impact of homologous peptides shared between training and testing datasets has a minor impact on rankings of prediction methods at least for large scale datasets, but should nevertheless be corrected for. 2) prediction performance comparisons between different methods cannot be made based on absolute auc values unless both training and testing datasets are identical.

a second concern when dealing with homologous peptides in the training dataset is that the presence of a large number of similar peptides may bias the classifier such that the prediction performance of unrelated peptides is negatively affected. we performed a direct comparison of the predictive performance on novel peptides based on classifiers trained in the presence and absence of similar peptides. the comparison showed that there is a performance gain for classifiers trained with the larger dataset including similar peptides. thus we recommend that classifiers created for end user applications should be trained with all available data to gain maximum predictive power for epitope identification.

constructing meta-classifiers is a popular approach to improve predictive performance. we previously reported a median rank based consensus approach that outperforms individual mhc class ii binding prediction methods. with the addition of new methods, we found that consensus methods including all available methods failed to outperform the best available individual method. on the other hand, when only methods that contributed positively to the consensus approach were included, the consensus approach outperformed the best individual method  on the "sr" dataset. the absolute values of improved average auc is much smaller than that was reported in our previous study . this suggested that simple median rank based approach is less effective as individual method's performance improves and more sophisticated consensus approaches are needed to capitalize on a large array of mhc class ii binding prediction methods. also, the best individual method  still outperformed the consensus with selected methods when they were tested with the "all" dataset. since there are significant peptide similarities in the "all" dataset, this could be due to overfitting. we plan to systematically examine how to best construct consensus predictions for mhc binding in the future, building on work done by us and others in the past  <cit> .

