BACKGROUND
a decade has passed since the introduction of phylogenetic profiles to elucidate functional relationships between gene products. the basic assumption in the phylogenetic profiling approach is that convergent evolution of traits, e.g. gene co-presence and co-absence patterns across genomes are due to inter-dependence between those traits  <cit> . for example, if the activity of a gene a is dependent on the existence of another gene b, a fixed deletion of b renders a redundant and consequently a will be eventually lost due to genetic drift as it is no longer subject to selective constraints. phylogenetic profiles of gene presence-absence are typically encoded as a binary sequence of 1's  and 0's  where each position in the profile corresponds to a particular species under study . functional dependencies between genes should then result in a smaller number of differences in the corresponding profiles than expected by chance.

since their introduction, phylogenetic profiling approaches have evolved and a number of novel methods have been developed to quantify the similarity between two profiles or to statistically evaluate the reliability of the predicted functional relationships. these methods can be coarsely divided into two categories depending on whether they take into account the underlying species phylogeny: non-phylogenetic approaches that include pairwise distance comparisons  <cit> , mutual information  <cit>  or pearson correlation  <cit>  and phylogeny-aware approaches that rely on parsimony  <cit> , maximum-likelihood  <cit>  or kernel-methods  <cit>  based scoring. in theory, phylogeny-aware approaches are preferable due to the statistical bias introduced by gene content inter-dependence between closely related species, and it has been shown that such methods can improve the prediction of functional links in eukaryotic genomes  <cit> . nevertheless, these methods remain computationally complex. as a consequence, some groups have proposed phylogeny-based heuristic corrections with the goal of reducing the inherent biases in a computationally efficient manner .

despite the successful application of phylogenetic profiles in a number of studies involving prokaryotic genomes , profiling in eukaryotes has received little attention. moreover, based on combined prokaryotic and eukaryotic studies, some groups have concluded that the statistical signal is severely disrupted by inclusion of eukaryotic genomes  <cit> . to measure the extent to which these methods can be applied in studies of eukaryotes, singh and wall  <cit>  constructed phylogenetic profiles consisting exclusively of eukaryotic genomes and detected some correlation for proteins within the same functional module determined using the gene ontology  <cit> . this finding indicates the presence of at least some statistical signal in eukaryotes.

as an alternative to these co-evolution studies based on individual genes, a number of recent studies have independently proposed a different approach based on the correlation of homologous gene group sizes across genomes. ranea and colleagues  <cit>  grouped protein encoding genes hierarchically in families based on their 3d structure  and sequence similarities. they then measured the evolutionary convergence between them through copy number, referred to here as group size, correlation analyses based on a euclidean distance statistic to quantify profile pair relatedness. cordero and coworkers  <cit>  studied the co-evolution between pathway co-occurring gene families from the cog database  <cit> . they introduced a more sophisticated phylogeny-aware approach based on the reconstruction of the histories of gene content across phylogenetic lineages. thus, gene families  that showed concerted changes in size at the same branches along the species tree are predicted to have co-evolved. despite their methodological differences, both studies reached the conclusion that considering gene group size instead of total presence or absence of a particular gene can lead to a considerable improvement in predictive performance, at least in their respective datasets. in addition, very recently tuller and colleagues  <cit>  applied non-parametric correlation analysis of gene group size changes along branches of the species tree to elucidate functional relationships between go terms. they used this approach in conjunction with correlation of evolutionary rates to reconstruct a global gene co-evolution network in yeast species.

although all these approaches have been used successfully in a certain number of studies, no objective comparison has been performed to evaluate their relative performance, particularly in the more complex situation of eukaryotic genome studies. here, we have constructed a benchmark containing both positive examples of functionally related gene pairs and negative examples of unrelated pairs, based on the functional relationships defined in the string database  <cit> . the benchmark contains examples of two different types of relationships: physical protein-protein interactions  and co-occurrence in the same cellular pathway . we have used this benchmark to perform a comprehensive study of "classical" gene presence-absence phylogenetic profiles, as well as gene group size based analyses taking into account the species phylogeny, in order to measure the ability of each technique to predict these functional relationships in the eukaryotic life domain.

methods
gene group test sets in eukaryotes based on orthology and shared domains
the first step in any phylogenetic profiling analysis is the definition of homologous gene groups in the set of species under study. here, we have used a large test set of eukaryotic orthologous gene groups extracted from the orthomcl database version  <dig>  <cit> . this orthology prediction database offers a broad eukaryote species sampling and has performed well in gene function based benchmarks  <cit> . each orthologous group may contain an arbitrary number of paralogs within each species as determined by the orthomcl multi-species algorithm  <cit> , typically resulting from post-speciation gene duplications. therefore orthomcl groups are appropriate for the evaluation of both presence-absence and gene group size based approaches as functional link predictors in eukaryotes at the domain level. the resulting test set includes a total of  <dig> eukaryotic species  and  <dig> orthologous gene groups present in at least two of these species.

cells show mean and standard deviation.

calculated on the functional link network between groups present in string database.

fn = false negative, tn = true negative

eukaryotic phylogeny and selection of conserved gene groups
in order to apply more accurate genome phylogeny based profiling methods, we needed to specify a fully resolved species phylogeny for the  <dig> species under analysis. we used a curated phylogeny  taking into account the current understanding of deep evolutionary relationships between eukaryotic taxon groups  <cit> . the root of the tree was placed at a plausible location corresponding to the last common ancestor of all eukaryotes: the split between unikonts  and bikonts   <cit> . in order to focus on functional relationships that may be relevant to most of the eukaryotic species examined, we considered only those gene groups that expand across these two major taxon groups. the final dataset consisted of  <dig> orthomcl and  <dig> interpro groups.

gene presence-absence profiling
for each of the groups in the  <dig> datasets described above, a presence-absence profile was constructed, with each position corresponding to the  <dig> species under study. the position in the profile was set to  <dig> if the species was present in the orthologous group, regardless of the number of genes, and was set to  <dig> if the species was absent. the similarity of each pair of profiles was then measured using two different approaches:  co-occurrence of group loss as inferred using dollo parsimony and  weighted-hypergeometric and runs-corrected scores. these two approaches are described in more detail below and in figure  <dig> 

presence-absence profiling based on dollo parsimony inferred gene losses
dollo parsimony was initially conceived as a tool to infer phylogenies  <cit> , but recently some studies have applied this approach to the analysis of the evolution of gene content in genomes and functional linkage between proteins in eukaryotes  <cit> . dollo-parsimony assumes that of two possible state transitions, in our case, presence to absence and vice versa, one is more probable than the other. in the current context, we assume that gene gains can only occur once, but that genes can be lost independently in many lineages. thus we assumed that recurrent gain of the genes in different eukaryotic lineages via lateral gene transfer  is relatively small in comparison to the number of genes inherited vertically.

in order to measure the statistical significance of the similarities observed between two profiles, we applied the hypergeometric test based on the four possible result classes  at each position on the profile. we also implemented the phylogenetic correction used in the string database by compressing subtrees with all extant taxa in the same result class into a single observation . additionally we bound trees at branches where a gene group loss occurs in either of the two orthologous groups. we considered that two gene groups cannot influence each other's evolution long after one of them has been lost . in the rest of the article we refer to this method as dpcp .

presence-absence profiling using ordered profiles and runs-based scoring
this is the approach proposed by cokus and coworkers  <cit> . in summary, their approach scores the number of coincidental co-presences  in a pair of group profiles, taking into account the proportion of gene groups present in each genome  and the species phylogeny. the scoring procedure does not consider the tree topology per se, but it does so indirectly by ordering the species in the profiles according to their evolutionary relationships and then counting the number of runs  between two profiles . although not equivalent, the number of runs is positively correlated with the combined number of gene group gains and losses in both profiles and thus the information content present in the profile pair. for example, multiple co-presences found within a small number of runs may indicate gene conservation in lineages rather than co-evolution, whereas the same number of co-occurrences in a larger number of runs is a more convincing indicator of true co-evolution.

the number of observed runs and the resulting score depends on how we graphically sort descendant subtrees at each ancestral node in the species tree. we chose a single order for all comparisons following the approach indicated in the original paper  <cit> , which involves minimizing the genome content dissimilarities between adjacent genomes in the profile. from this point on we refer to this method as wruns.

gene group size profiling
in gene group size based profile approaches, instead of coding gene groups according to presence and absence, the exact number of gene group members at each genome is preserved at each position. therefore there is no loss of information at this point. methods that do not take into account the phylogeny  could compare the profiles with no further changes. however, phylogeny aware methods include an additional step where profiles "unfold", by incorporating an additional position for each ancestral taxon or internal node in the species tree that contains an estimated ancestral group size. then, the group sizes in the profile are transformed into the final signed size change along the branch that lead to them . this is calculated as the group size at that node minus the group size at the direct ancestor on the tree. as a result, each position in the final profile, representing a branch in the species phylogeny rather than an extant species, includes a neutral sign or  <dig> if there was no size change, a negative number if the gene group decreased in size, contraction, or a positive number if its size increased, expansion.

reconstruction of ancestral gene group sizes
a key element in these approaches is to infer ancestral gene group sizes. here we used two different approaches: a parsimony based reconstruction method and a new approach based on gene trees.

for the parsimony based reconstruction, we implemented the algorithm described in cordero et al  <dig>  who minimized a cost function on the minimum number of genetic events  necessary to explain the observed pattern of group sizes in extant species. here, we used the cost function f ; in this function we do not consider de novo gene gains, that would result from lgt, thus increases in gene group size can only be due to existing gene duplications. we adjusted the gene duplication, d, to loss, l, cost ratio parameter, μ, using observed relative frequencies using the gene tree based reconstruction approach .   

the novel gene tree based approach involves the reconstruction of the genealogy for each gene group and the mapping of gene gains and losses onto the species tree. to do this, we used the mafft software  <cit>  to construct multiple sequence alignments for each gene group. then we used the treebest package  <cit> , first to build the corresponding trees using the neighbour joining  algorithm on multiple substitution corrected amino acid distances, and second to map genetic events onto branches on the species tree.

often protein domain rearrangements and fast sequence evolution hampers sequence alignment and in turn gene tree reconstruction. consequently, we needed to split each gene group into subgroups more amenable to alignment and tree inference. in order to do this, we performed a greedy decomposition in maximum cliques using cliquer  <cit> . here we define a clique as a subset of genes whose sequences are aligned with any other member of the clique over at least 50% of the length of the shortest sequence in the pair. this threshold was determined in tests on a subset of groups and permits reconstruction of subgenealogies without over-fragmentation of the subfamilies. at each decomposition step, the maximum clique is subtracted from the remaining set of genes until only one or zero remains. since calculating maximum cliques is a computationally demanding problem , we used nmclique  <cit> , an approximate heuristic solver, as long as the remaining group size was greater than  <dig> genes. finally, once a gene group was fully decomposed, treebest was run on each subgroup and inferred genetic events were merged by adding them up on the corresponding branches of the species tree.

group size based profiling significance testing
we applied two methods to identify gene group size change profile pairs that show a significant level of coevolution: first using a correlation test on unmodified size change values and second using a hypergeometric test on the distribution of the sign of the change  across branches. we refer to these as gscor  and gshgt  in the text from now on. subscripts  and  indicate that ancestral group size were reconstructed using parsimony or gene trees respectively .

for gscor we implemented an approach similar to the one proposed by cordero and colleagues  <cit>  but opted for a non-parametric method, kendall-t ranks correlation coefficient and p-values as changes are not necessarily normally distributed. we also tested a partial correlation correction to take into account the bias effects of heterogenous genome sizes. however this did not result in an improvement in predictive performance  thus we opted for the uncorrected version, relying on empirical thresholds and the p-value fitted distribution to eliminate this and other biases as described in results and discussion.

in both approaches we did not take into consideration ambiguous branches that exhibit no group size change. this allows a binary encoding of expansions and contractions in gshgt and avoids numerous ties of  <dig> in gscor.

measure of profile pair information content
for the gscor method, we used the number of branches considered in the test, i.e. those with expansions and contractions in both profiles, to quantify information content. in contrast, for dpcp, wruns and gshgt, we used the geometric average of the profile entropies multiplied by the length, lij, of the profile pair under consideration:   

the individual profile entropy h is calculated using the fraction of positions for each possible symbol :   

calculation of information content adjusted profile pair scores
we used two approaches that take into account ic, in order to classify profile pairs as putatively co-evolving or not. first, we used a single cut-off threshold based on a negative control set built as described below. second, we fitted a bivariate distribution of scores versus information content for each method using the kernel approach implemented in the mass r package .

positive and negative test sets
we used the string database version  <dig>  <cit>  as a unified source of both experimentally verified and computationally inferred protein-protein functional relationships. we built two different categories of true positive  datasets. the first set, tpcopw, contained gene pairs that participated in the same kegg cellular pathway  <cit>  as stored in string. the second set, tpppi, included interacting protein pairs from interactome databases present in string . we propagated the relationships defined for individual genes to gene groups, if there were at least two disjoint pairs of genes in each group that were functionally related to each other. in the case of tpcopw, at least one pair must belong to a unikont species and the other to a bikont. this way we intrinsically give more weight to functional links that are more likely to exist in most eukaryotes. due to limited species sampling of protein-protein interactions, in the tpppi we included all group relationships that had evidence in both vertebrates and non-vertebrates.

in order to construct the negative control dataset, we wanted to explicitly exclude potential functionally linked gene pairs and their corresponding gene groups. we therefore built a "false negative"  set of related gene pairs based on the absence of any kind of evidence in string, except functional links only supported by the phylogenetic profiling method implemented therein; if included, these would result in an overestimation of the performance of the phylogenetic profiling methods under evaluation, due to similarities between the criteria used to build the negative control set and to compare their profiles later. finally, we propagated all gene level relationships to their respective orthomcl and interpro groups with no additional restrictions.

in each analysis we generated a putative true negative set tn . to do so, we constructed random gene group pairs and discarded those present in the fn set until we reached the targeted size. note that all tp pairs are included in the fn set, therefore tp pairs are also automatically excluded from the negative control.

we used two approaches for generating random pair samples: based on a weighted and unweighted group random pair generator. in the unweighted approach, resulting in the pair set tnuw, each group has the same probability of being picked, whereas the weighted approach gives a weight to each group proportional to the number of gene members, resulting in the pair set tnw. the motivation behind using a parallel weighted approach is the noticeable bias in the orthologous and domain level group sizes found in the tp sets in comparison with unweighted tnuw sets. in order to generate positive predictive value  plots, we estimated the real proportion of tp group pairs using the number of unweighted random pairs rejected because they were found in the fn set.

RESULTS
a total of six phylogenetic profiling approaches described in methods were tested based on the positive and negative datasets of functionally linked genes or gene groups. these included two methods based on the traditional presence-absence profiles of individual genes: a full species phylogeny based method  and a computationally efficient heuristic method . in addition, four different gene group size approaches were tested resulting from the combination of two methods to infer ancestral gene group sizes  and two methods to evaluate the significance of the co-evolutionary signal . a summary of the methods and abbreviations used is shown in table  <dig> 

sensitivity of presence-absence profiling at the orthologous group level
we first applied the traditional presence-absence profiling methods, here represented by dpcp and wruns, to the test set of orthomcl orthologous groups. the goal was then to correctly predict known relationships extracted from the string database, namely co-presence in pathways  or protein-protein interactions . to measure the overall sensitivity of the methods, we initially defined a single global p-value or score threshold for each method using the distribution of values observed in the negative control sets at the typical standard type-i error level of 5% .

the first two columns in table  <dig> show the resulting sensitivities. dpcp is more sensitive with a maximum of  <dig> % true positives versus  <dig> % for wruns on the tpcopw test set, using tnuw as a negative control. similar results are obtained for tpppi with sensitivities of  <dig> % and  <dig> % respectively. using the weighted negative control, tnw, the two approaches achieve more similar but slightly lower sensitivities . thus, in this case, we conclude that the negative test set sampling approach has little effect on the sensitivity estimates.

the corresponding roc curves , which plot sensitivity versus specificity, show that these methods are better than random classifiers especially in the region of high scoring cases . nevertheless, both presence-absence profiling approaches sometimes fall just above or below the diagonal, generally showing a poorer performance on the ppi positive set compared to the copw set. this is due to a considerable percentage of profile pairs that do not exhibit enough variability or number of genetic events , resulting in an elevated number of degenerated maximum and non-significant p-values  that affect copw and ppi .

sensitivity of group size based profiling approaches at the orthologous group level
since the orthomcl orthologous groups may contain a variable number of paralogs for each species, group size based approaches are also applicable in this scenario. accordingly, we also evaluated their sensitivity using the same procedure as for the presence-absence profiling methods . in order to calculate empirical thresholds, we only considered group pairs with a minimum number of  <dig> common branches that have undergone a group size expansion or contraction, since lack of either group size variability across species or phylogenetic spread renders a considerable number of profile pairs unsuitable for this purpose.

the ancestral gene group size reconstruction using parsimony also yielded results better than a random classifier based on the roc curves . they were roughly equal to or inferior to presence-absence methods in the high selectivity region close to the origin of the axes with the exception of the tpppi using unweighted negative test set sampling . using gscorpars, the observed sensitivities are higher than with gshgtpars .

in contrast, the gene tree based reconstructions achieved in general a better sensitivity, closer to that achieved by dpcp on the tpcopw test set and with a noticeable improvement on the tpppi set using both gshgt and gscor. gscorgenet achieves an more than  <dig> fold increase using the unweighted negative set sampling . also the corresponding roc curves  are the ones closest to the ideal classifier, indicating that these methods seem to perform better overall .

sensitivity at the domain sharing and gene family level
in a second experiment, we applied the same analyses to coarser groups of genes from the interpro dataset . these groups are clearly more extensive in comparison with orthomcl groups, with a  <dig> fold larger mean group size . a larger number of members allows a greater group size variability across extant and ancestral gene groups, and thus a larger number of informative tree branches that have undergone group size expansions or contractions.

it is worth noting that the weighted negative pair sampling generates a staggering 49% pairs present in the fn profile pair set . in other words, if two genes are chosen at random, there is nearly a 50% chance that they contain some functionally related protein domains . this is not surprising if one considers that even assuming an unrealistic random intergenic functional network, larger gene groups would have an increasing chance to exhibit some direct or indirect functional link through some of its members.

although presence-absence profiling is not appropriate for coarse gene clusters , we applied dpcp and wruns to these two datasets in order to compare their performance with gene group size based approaches. presence-absence profiling clearly loses overall sensitivity when applied to coarse gene groups . moreover, their sensitivity does not even reach the designed type-i error for the prediction of ppi relationships using the interpro groups. this confirms that presence-absence profiling is less useful at this group granularity level, although it still does better than a random classifier on the copw positive profile pair set.

in contrast, using the group size based approaches, the sensitivity remains equal or increased with coarser clusters of genes. the only exception is the gene tree reconstruction with the hypergeometric test  for the prediction of copw relationships, where sensitivity slightly decreased . the maximum sensitivity achieved is as high as  <dig> % for the prediction of ppi using the interpro groups and the unweighted negative control sampling to calculate thresholds.

the corresponding roc curves are consistent with these results . these show an appreciable decrease in performance of the presence-absence profiling methods compared to the results obtained with the orthomcl groups , especially for the prediction of ppi positive pairs. the group size based approaches using parsimony reconstruction  improve considerably in most cases , in contrast to the gene tree based reconstruction  that only results in a noticeable improvement for the ppi predictions.

effect of information content on sensitivity and false positive rates
to evaluate to what extent information content may have an impact on the performance of the different methods, we plotted sensitivity, or true positive rate , and false positive rates  at a standard type-i error level of 5% against a measure of profile pair ic  . all approaches show better performance for the prediction of ppi compared to copw relationships. moreover, the sensitivity is in most cases higher than the fpr, although the ratio between the two quantities is lower using the group size methods.

for the gene presence-absence methods applied to orthomcl groups , the sensitivity increases steadily with increasing ic clearly above the fpr. both dpcp and wruns achieved similar performances at the same ic levels. the sensitivity is clearly higher for the prediction of ppi compared to the copw dataset. at the 5% type i error level, sensitivity exceeds 50% in the highest informativeness regions. in contrast, the fpr barely reaches 10% under the same conditions, thus resulting in an approximate  <dig> fold ratio between sensitivity and fpr.

for the group size based approaches , the parsimony ancestral size reconstruction apparently results in lower ic . nevertheless this observation is not by itself a clear indicator of the overall performance superiority of the gene tree based reconstruction. at best, for the parsimony reconstruction with the hypergeometric test , fpr reaches values as high as 30% with a contrasting sensitivity that only occasionally surpassed the 40% mark . using gene tree based reconstruction, these figures reached 35-40% and 65-70% respectively. in general, sensitivity vs fpr in group size based approaches does not go far beyond the  <dig> fold mark. in contrast, the correlation based approach  using either parsimony or gene tree based ancestral group size reconstruction does not show such a clear distinction graphically between copw positive and negative control sets specially using gene tree reconstruction . the performance is slightly better for ppi positives.

the sensitivity and fpr of the methods applied to interpro groups  are very similar to the plots obtained using orthomcl groups from a qualitative point of view. nevertheless there is a clear loss of sensitivity in presence-absence methods at this group level . the differences between the group size based approach curves  are mainly due to differences in the ic ranges and thresholds used.

effect of information content heterogeneity
in order to investigate the ic ranges for the profile pairs in each of the test sets, we plotted the relative profile pair ic frequency distribution along the x-axis . in all approaches and gene group granularities, the regions with high frequency in the positive profile pair test set do not match the maximum sensitivity . this seems to be the main factor that limits profiling performance. additionally, the profile pair distribution across ic levels is clearly different between the positive and negative datasets in each possible combination of profiling methodology and gene group granularity. using presence-absence profiling, the positive set frequencies are shifted towards low ic in contrast to the negative control set frequencies, whereas this trend is reversed using group size approaches. this may explain the contrasting performance of presence-absence profiling and group size based profiling within and across different gene group clustering granularities.

in the case of presence-absence profiling, most ppi links are found in the region with less informative profile pairs especially in the interpro gene group positive test set . thus, despite the fact that sensitivity is generally higher when compared to copw positive pairs and that ppi functional links should exhibit a stronger interdependence, this type of profiling performs worse in practice .

these results suggest that we could aim to improve functional link prediction accuracy by using alternative grouping criteria that maximize ic. for example, previous studies in prokaryotes and eukaryotes indicate a gain in performance when considering several similarity thresholds  <cit>  as opposed to a single gene clustering criterion. however altering granularity in order to increase the chance of detection by optimising ic may render the results less amenable to interpretation, as cluster boundaries may not correlate with clear biologically interpretable gene groups .

alternatively, profile pairs could be sorted based on ic for further investigation using potentially more accurate but computationally demanding approaches, such as maximum-likelihood based methods  <cit> . this would avoid running computationally demanding analyses on profile pairs with low ic that a priori are much less likely to show any evidence of coevolution.

score adjustment based on information content
in view of the differences in information content  distributions for the positive and negative test sets, even when using weighted negative sampling, we reassessed the performance of the different approaches after correcting for ic heterogeneity on a case by case basis. taking tnw as a control and using a kernel fit, we estimated the conditional probability distribution of the scores given the ic under the null hypothesis that gene groups are not functionally related: pr. then, the scores were converted to adjusted p-values equal to the probability of obtaining a score equal to or greater than the observed score given the ic found in the pair. the resulting profile pair p-values should more accurately reflect our confidence in the prediction of co-evolution of the corresponding gene groups. the plots on the right-hand size in figures  <dig> and  <dig> show the adjusted roc curves next to their non-adjusted counterparts using unweighed and weighted negative sampling  and table  <dig> shows the sensitivity estimates at the type-i error level of 5%  for the ic-adjusted p-values.

note: cases with information content equal to zero are always treated as insignificant. thus sensitivity can be much lower than type i error .

our results indicate a decrease in the performance of the gene group size based approaches using ic corrected p-values, while the performance estimate of the presence-absence approaches remains relatively unchanged compared to the single empirical threshold approach. the parsimony reconstruction based analyses are the most affected by the adjustment, particularly when applied to the interpro datasets, where sensitivities that were previously estimated to be as high as 34% percent  decrease to around 10% or lower . all in all, the group size based approaches seem to lose most of the advantage they had with respect to presence-absence profiling when the co-evolutionary signal is measured objectively based on the ic of the profile pair. in other words, we overestimate the performance of gene group based approaches unless, either the profile pair scores are adjusted for ic, or the statistical differences between the positive and the negative control test sets accurately reflect the properties of the real world data.

thus, the typical approach of generating unweighted random pairs to build a negative dataset and a single cut-off value results in a very clear overestimation of the accuracy of gene group size approaches. performance improvement using this strategy does not seem to be founded on a real gain of co-evolutionary signal as much as statistical biases due to heterogeneous distribution of informativeness between positive and negative control groups. jothi and colleagues  <cit>  made an important remark on the importance of a careful selection of the null hypothesis in order to avoid spurious results due to profile heterogeneity. they focused their discussion on the effect introduced by combined analyses of profiles with different phylogenetic spread. the adoption of species tree aware approaches, such as the ones used in this study, together with the restriction of considering only groups that are present on both sides of the root of the tree, should reduce these biases. nevertheless, differences may still remain and can result in artefactual detection of functional relationships between gene groups.

it should be noted however that the inability to distinguish between putative functionally linked and unrelated pairs may result in part from the difficulties in obtaining a pure negative control dataset totally devoid of functionally linked groups. for instance, weighted negative sampling generates a high proportion of false negatives: 49%. moreover, the functional network resulting from the clustering of genes into coarse groups is inevitably very condensed, with most genes connected by one or only a few direct functional links . arguably, we should expect to see at least some weak co-evolution between groups that are found close together in the network .

other sources of bias in phylogenetic profiling analyses
for all the methods tested here, the fpr increases for high information content levels. this trend is more pronounced in the group size based approaches and especially when using non-partial correlation corrected coefficients . previous studies using permutation and simulations have already shown that heterogeneous genome size can affect the outcome of co-evolution tests  <cit> . for example, lineages leading to larger genomes should have a natural tendency to expansions and vice versa. moreover, genomic scale events, such as whole genome duplications and major genome rearrangements, may introduce additional background co-evolution-like patterns for the affected gene groups that are not a consequence of true functional relationships.

in addition to genome size effects, we also found evidence for local correlation of group size evolution mostly between neighbouring branches of the species tree . either positive or negative correlation of group size change between phylogenetic tree branches should result in a number of coincidental expansions and contractions greater than that expected under the null hypothesis, due to the fact that we conveniently  consider observations at different branches or profile positions as independent data points. an evolutionary explanation for this phenomenon might be that closely related phylogenetic lineages tend to follow a similar evolutionary pattern, resulting in positive correlation, and that gene losses are typically preceded by gene gains, resulting in negative correlation between ancestral and successor branches on the tree. branch evolutionary correlation heatmaps such as the one shown in figure  <dig> could be used to attain an optimal choice of species for phylogenetic profiling by selecting lineages resulting in a minimization of autocorrelation effects.

phylogenetic profiling as a functional link predictor in large-scale analyses
the positive predictive value  is a statistic of special interest for high-throughput functional studies as it quantifies the probability that a positive test outcome is in fact a true prediction. figure  <dig> shows ppv plots against sensitivity for analyses using the orthomcl and interpro groups based on ic corrected p-values. reasonable ppv values  are only obtained at very low sensitivity, especially for the orthomcl gene groups . this is for the most part due to the low estimated proportion of tp pairs amongst all possible pairs  and the fact that only a fraction of these have a high enough ic to be tested.

consequently, although phylogenetic profiling may be used to unveil some functional relationships with a strong co-evolutionary signal, it is on its own not suitable for large-scale screening of these relationships in eukaryotes. the ppv improves when considering coarser gene clusters , but this will lead to subsequent problems in distinguishing true functionally related gene pairs, since the number of possible pairings grows quadratically with the number of members of each group.

reassessing the contribution of gene group size based approaches
gene group size based approaches offer an opportunity to overcome some of the limitations of presence-absence based methods  <cit> , for example the analysis of essential gene group profiles . nevertheless, even though these methods take in consideration a greater number of genetic events, thus increasing information content, they are still outperformed by presence-absence in certain cases, particularly when applied to the fine-grained orthomcl groups . the most plausible explanation for this is that a total loss of a gene group, without any homologous genes left to perform at least part of its biological role, has a much greater impact than losing or gaining some gene "copies". thus, common gene group pair co-expansions or co-contractions that do not result in a total gain or loss of the homologous groups under consideration provide less compelling evidence of co-evolution and may introduce noise.

despite this lack of resolution, the fact that the sensitivity values are typically above the fpr curves  is a clear indicator that these scores are positively correlated with true functional relatedness. consequently, although group size based approaches may not perform that well in classifying pairs as related or unrelated, they may still be appropriate for defining functional distances between groups and also perhaps for clustering them in functional modules. in any case, high scoring pairs are likely to be true functionally linked groups  <cit> . however, it is preferable to use adjusted scores determined, for example, by the kernel approach described in methods in order to avoid an over-representation of cases with high ic due to their inherently higher non-adjusted scores.

gene trees improve the performance of gene group size change approaches
in an attempt to improve the performance of gene group size based methods, we used gene trees to reconstruct ancestral gene group sizes. this resulted in a clear improvement compared to parsimony reconstruction. gene trees can map more precisely gene duplications and losses to branches of the species tree using the evolutionary information present in the gene sequences. the total number of genetic events inferred is approximately  <dig> fold the number recovered using parsimony. moreover, multiple losses and gains can be simultaneously detected on the same branch, whereas parsimony can only infer an optimal number of gene losses or duplications depending on the sign of the size change on that branch. consequently, the number of branches with expansions and contractions in the average profile pair is much greater using the gene tree based reconstruction . moreover, after correcting for heterogeneous ic content, the sensitivity of gene tree based approaches is clearly greater than those using parsimony .

CONCLUSIONS
to summarize, our results confirm that the performance of phylogenetic profiling methods is limited in eukaryotic studies, an observation already made in previous studies of presence-absence profiling  <cit> . however, several methodological aspects beyond the scope of this article may influence the outcome: for example different methods for orthologous group prediction, large group decomposition and alternative gene tree building methods, different methods for species sampling or the use of other criteria to define bona fide functionally linked group pairs or alternative genetic event types that may also co-occur between co-evolving groups of genes.

in addition to presence-absence profiling, recent work in the field has proposed group size based approaches as an alternative methodology that may improve performance. our analyses indicate that the relative performance of both approaches is for the most part dependent on the gene clustering granularity. while presence-absence profiling is more appropriate for fine-grained gene clusters such as the orthomcl orthologous groups, we show that the sensitivity of the group size based approaches can be increased by using coarser clusters of genes . in our experiments, the type of functional link affects both approaches in the same way, since direct protein-protein interactions  represent stronger interdependences and are generally better predicted than participation in the same kegg pathway, which include a wider variety of relations. we also show that heterogeneous information content between positive and negative control datasets influences performance assessment. moreover, a combination of two frequently adopted evaluation strategies resulted in a clear overestimation of the performance gained using group size approaches  generating a negative control set that involves random or exhaustive unweighted group pair generation and  using a single null hypothesis rejection threshold. here, we have proposed an alternative based on adjusting the profile pair scores based on their information content. in this context, weighted sampling of a negative set helps in obtaining enough cases across the information content range to accurately approximate this distribution with a smaller sampling.

in contrast with gene group size approaches, presence-absence profiling always shows a better positive versus negative classification accuracy in the face of the heterogeneous nature of the information content across profile pair sets. this property is true for both gene clustering granularities tested despite our efforts to improve gene group size based approaches using gene trees to infer ancestral group sizes. therefore, we conclude that presence-absence profiling methods are more suitable for the analysis of datasets where the profiles have sufficient information content.

nevertheless group size approaches are still useful and provide a complementary means of detecting domain or family level co-evolution between groups that may be elusive to presence-absence profiling approaches. moreover positive correlation between co-evolution scores and functional links imply that these methods could be used to estimate functional distances between gene groups and to cluster them based on their functional relatedness.

finally, despite the fact that this study focuses on eukaryotic genomes, we believe these observations should also be considered in future bacterial and archeobacterial phylogenetic profiling analyses.

authors' contributions
vrr performed all the required programming, data collection, analyses and drafted a first version of the manuscript. vrr and jdt jointly interpreted the results, modified and improved the manuscript. jdt and op participated in the study design and management, and the revision of the manuscript. all authors read and approved the final manuscript.

