BACKGROUND
metagenomics describes the functional and sequence-based analysis of dna isolated from environmental sample without first culturing the associated microbes  <cit> . four viral and four prokaryotic shotgun metagenome datasets have been published  <cit> . the acid mine drainage  metagenome data set was taken from a low complexity environment and includes slightly more than  <dig> mb of sequence in  <dig>  contiguous sequences  and ~ <dig>  predicted protein sequences  <cit> . the sargasso sea metagenome data set is from a more complex environment and includes  <dig> mb of sequences in  <dig>  contigs, and approximately a million predicted protein sequences  <cit> .

another conceptual "metagenomic" library can be constructed from the combined sequence data collective generated over the last 30-plus years of dna and protein sequencing and deposited in the international databases. in contrast to the environmental metagenome libraries, the collective metagenome was built by the incremental addition of sequences from many different sources. the seed database, developed by the fellowship for interpretation of genomes , is an annotated non-redundant database, compiled from several sources including genbank , swiss-prot, kegg, and from genome sequencing centers. at the time of analysis, the seed database contained  <dig> , <dig> proteins . although the sampling of sequences that constitute this library is not random, the seed essentially represents essentially all known genomic complexity.

fig pioneered the use of subsystems to annotate both complete and partial genome sequences  <cit> . subsystems are biochemical pathway, fragments of pathways, clusters of genes that function together, or any group of genes that any annotator considers to be related. the subsystems are annotated across genomes by the annotators, providing the most reliable and consistent annotations within and between genomes. the subsystems-based annotations are ongoing and at a given point in time the subsystems represent the snapshot of the best available annotation of the seed database.

comparing metagenome samples could lead to the identification of signature functions associated with each metagenome sample, however this analysis requires reliable statistical techniques that are not only robust but are rapid to perform with hundreds of thousands or millions of data points per sample.

here the sargasso sea and amd metagenomes were compared with the seed database to identify statistically significant differences in subsystems composition. we hypothesized that there were few barriers to the transfer of subsystems between environments and therefore certain subsystems were enriched by selection in those environments where they were important. we used a difference of medians analysis to identify those subsystems that have a statistically significantly presence in each of the metagenomes. these analyses provide a framework for the statistical comparison of metagenomes.

RESULTS
determination of statistically significantly different subsystems
a difference between medians calculation was applied to rapidly identify statistically significant differences between metagenomes. this technique has several advantages over other possible statistical methods that could have been applied. for example, the difference between medians is extremely rapid for the calculation of differences between subsystems from different samples, and the method does not depend on the distribution of samples. the source code and step-by-step description of the method are provided as part of the supplemental material .

number of samples needed to identifying significant differences between metagenomes
fig.  <dig> plots the sample size  of proteins that were sampled against the number of significantly different subsystems when the sargasso data was compared to the seed data at different confidence levels. at the most stringent level  there are about  <dig> unique phylosubsystems in the sargasso sample  and about  <dig> unique phylosubsystems in the seed. in either case at least the sample size needs to approach  <dig>  proteins to achieve statistical significance. in contrast, at lower confidence levels, there are more significantly different phylosubsystems, and the samples need to be smaller to detect them. thus with a 90% confidence that the difference do not occur by error there are approximately  <dig> unique subsystems in the sargasso data, and a sample size of about  <dig>  proteins is required to identify them all.

the amd dataset has many fewer phylosubsystems than the seed dataset, and only those subsystems present in the both samples are used in the comparison to identify significantly different phylosubsystems. this limits the analysis to  <dig> of the  <dig> different phylosubsystems. of those that are present in the amd and the seed, only  <dig> are significantly more abundant in the amd sample  and  <dig> are more abundant in the seed dataset. saturation was reached at ~ <dig>  samples.

subsystem differences between the seed and sargasso sea metagenomes
statistically different phylosubsystems between the seed and sargasso sea metagenomes are shown in fig. 2a. the effect of sample size is apparent. for example, statistically differences between rna metabolism, oxidative phosphorylation, and membrane transporters can be detected at small sample sizes . however, the differences between carbohydrate and amino acid metabolism, as well as most cofactors, vitamins, and pigments are not statistically different until > <dig>  proteins have been sampled. out of the  <dig> phylosubsystems that are significantly overrepresented in the sargasso sea,  <dig> are from the bacteria,  <dig> from the archaea, and  <dig> from the eukarya.

fig. 2b highlights some of the differences for phylosubsystems. a more detailed description of all of the subsystems with statistically significant differences in occurrence between environmental data sets is given in the supplemental material . some ecologically important differences between the sargasso sea and the seed database are discussed below with data extracted from the supplementary table.

potential osmoregulation by amino acids in the sargasso sea
the phylosubsystems involved in the synthesis of serine , threonine , and glycine  are overrepresented in the sargasso sea metagenome . for example, there are  <dig> proteins per million proteins in the sargasso sea database that are similar to bacterial glycine synthesis proteins, and only  <dig> proteins per million proteins in the seed database that are similar to bacterial glycine synthesis proteins. exactly these three amino acids are also the most abundant amino acids found in the sargasso sea  <cit> . however proteins in the sargasso sea metagenome do not contain significantly more s, t, or g , suggesting that the observed bias in amino acid synthesis subsystems and in the water samples is not related to protein synthesis. the primary organic osmolytes used by marine bacteria are small organic, uncharged, solutes that have little effect on the intracellular biochemistry, such as glycine betaine  <cit> . the subsystems for the production of betaine are also overrepresented in the sargasso sea compared to the seed database . similarly, serine and threonine are small, polar, uncharged amino acids that are perfect compatible solutes for balancing osmotic pressure. serine has also been previously shown to be as effective as glycine betaine at protecting enzymes from the effects of increased osmolality  <cit> . in contrast, genes encoding the osmoprotectants proline, sucrose, and trehalose  <cit>  were underrepresented in these samples. therefore, we predict that marine microbes are synthesizing glycine, serine, threonine, and betaine as osmolytes, an hypothesis that can be tested experimentally.

photosynthesis in the sargasso sea
as previously observed  <cit> , there was a strong bias towards subsystems involved in photosynthesis in the sargasso sea metagenome. this bias includes subsystems for the calvin-benson cycle, chlorophyll biosynthesis genes, the cytochrome b6-f complex, photosystem i, photosystem ii, isoprenoid biosynthesis, and carotenoid biosynthesis.

some phylosubsystems involved in one-carbon metabolism, including the synthesis and degradation of carbohydrates, cell walls, and capsules are more abundant in the sargasso sea. in contrast, the genes for the utilization of complex carbon sources including lactose, arabinose, fructose, mannose, galcitol and inositol are all underrepresented in the marine environment suggesting these are not significant sources of carbon in this environment.

nucleic acid and phosphate metabolism in the sargasso sea
phylosubsystems involved in purine and pyrimidine de novo synthesis and scavenging pathways, as well as ribonucleotide reduction  are more abundant in the sargasso sea. similarly, the subsystems involved in the capture of phosphate via the conversion of adp to atp coupled to oxidative phosphorylation are also overrepresented in the sargasso sample. in contrast, nitrogen metabolism phylosubsystems are less abundant in the sargasso than the seed, with the sole exception of ammonia assimilation that is marginally overrepresented in the sargasso sample at larger sample sizes. the sargasso sea has previously been reported to be phosphate limited. the concentration of dissolved inorganic phosphate is approximately  <dig> nm in the sargasso sea. by comparison, the north pacific and typical bacterial minimal media have phosphate concentrations of approximately  <dig> nm  <cit> . together, these results suggest that phosphate acquisition is critical for microbial growth the sargasso sea environment.

mobility of sargasso sea microbes
estimates of the percentage of bacteria in the ocean that are motile vary from less than 5% to more than 80%  <cit> , and there were far fewer genes encoding flagella in the marine environment compared to the seed database. however many marine microbes are thought to use alternative, less well characterized, motility systems, such as the motility mechanism characterized in cyanobacteria  <cit>  or twitching motility previously shown in marine microbes  <cit> . this data leads to the hypothesis that marine microbes are generally not using flagella based motility for movement, and future studies on the genomics of twitching and gliding motility may reveal hints about these mechanisms of movement.

subsystem differences between the seed and amd metagenomes
when the amd and seed databases were compared, only phylosubsystems that were in both the amd and the seed samples were included. this limited the total number of subsystems that were compared for statistically significant differences. there are far fewer phylosubsystems with significantly different distributions between the amd and seed datasets, and phylosubsystems that are significantly more common in the amd dataset are shown in table  <dig>  the different occurrences of subsystems reflect the limited complexity of the amd environment that contains bacteria and archaea  <cit> . the majority of subsystems that are significantly more common in the amd data set are from archaeal proteins. in the amd environment, the production of amino acids does not appear to be critical, and only archaeal arginine and histidine degradation and leucine and chorismate synthesis are overrepresented in these samples. our limited selection of overrepresented subsystems in the amd sample presumably reflects the current bias in annotated subsystems in the seed. as the subsystems continue to evolve and expand, and the nih project to annotate  <dig>  genomes  <cit>  matures the impact of these annotations on the amd sample and other metagenomes will highlight those areas of metabolism and physiology that are critical to survival in different environments.

subsystem differences between the sargasso, seed, farm and whale metagenomes
the seed and sargasso subsystems were compared to both the whale fall and farm metagenome samples  <cit> . for this comparison the individual whale fall samples, and individual farm samples were each combined to create two separate metagenomes. those metagenomes were compared to the subsystems exactly as described in methods, using the blast algorithm to determine similar sequences. the data shown in the supplemental material  was created using 95% confidence, a sample size of  <dig>  proteins, and  <dig>  replicates. this table shows each of the comparisons with the statistically significant subsystems. the normalized data was used to determine the relative abundance of each kegg pathway in each sample  <cit> , and these comparisons are shown in the supplemental material .

the kegg pathways have historically focused on core metabolism, annotating enzymes that have been classified with ec numbers. in contrast, the seed subsystems include core metabolism and the data is extended to subsystems that cover cellular processes and functions, regulation, and so forth. although the two classification techniques are not directly comparable, and statistical confidence was not provided with the differences between kegg pathways in the supplemental data from the previous analysis, some clear parallels can be seen between these analyses . for example, both techniques identified that riboflavin metabolism is more prevalent in the whale fall metagenomes than the other samples, however according to the normalized data from tringe et al folate biosynthesis is less abundant in the sargasso metagenome than either the whale fall or soil metagenomes whereas this analysis demonstrated that there is significantly more folate biosynthesis in the sargasso than the other samples. there were  <dig>  proteins with similarity to folate biosynthesis subsystem from the seed database in the sargasso metagenome,  <dig> proteins with similarity in the farm soil metagenome and  <dig> proteins with similarity in the whale fall metagenome. in contrast, tringe et al. identified  <dig>  proteins,  <dig>  proteins, and  <dig> proteins respectively. these differences are probably due to the difference in annotation of the seed subsystems and kegg pathways. these differences also highlight the need for continued careful annotation of genomes, and comparative analysis of different annotation systems and methods.

discussion
community genome sequencing – metagenomics – can provide fine detailed analysis of the metabolism occurring in different ecosystems. however, metagenomics analysis is limited to a purely descriptive science without a rigorous statistical comparison of the prevalence of different genes in different environments. our analysis demonstrates an application of statistics to identify those areas of metabolism that are significantly over represented in different environments.

the method described here is predicated on the expectation that genes that are more useful in an environment are more commonly found in that environment. or put another way, there is an enrichment or selection for sets of genes in different environments. a statistical analysis, using a resampling with replacement technique, was developed to generate both the difference in occurrence of each subsystem in each sample, and to generate confidence intervals for the likelihood that these differences are observed by chance. by using these statistical techniques to compare the genetic composition of different environments, the areas of metabolism and biochemistry that are important in a particular environment, in comparison to other environments, can be identified. like other studies, this analysis demonstrated that microbes in the surface waters of the ocean are much more likely to contain genes involved in photosynthesis than the control data set. the non-redundant database used as a control is not expected to contain large numbers of photosynthetic organisms because it is skewed towards microbial pathogens.

our analysis also demonstrated more than  <dig> other subsystems that are over represented in the sargasso sea sample when compared to the control set. the skew in the database alone cannot explain this difference, and these subsystems must be important for survival in the ocean. some examples, such as the synthesis of serine, threonine, and glycine, directly testable hypotheses can be generated from these analyses. for other examples, the explanation of the differences between samples may be more elusive. several pieces of evidence will assist in determining the roles of different subsystems in different environments. for example, the inclusion of more environmental data with each sample will allude to some of the differences in metabolic potential between samples; the careful dissection of the presence of different subsystems in different organisms will identify which organism in which environment is performing the different biochemical reactions; and the extension of other techniques such as metabolic modelling into the environmental arena may provide insights into the critical biochemical mechanisms in each environment.

CONCLUSIONS
comparative metagenomics is a powerful mechanism for highlighting the ecological differences between environmental samples. our analysis has generated several hypotheses that can be readily tested on microbes from the sargasso sea:

 <dig>  serine, threonine, and glycine betaine are primarily being used as osmoprotectants. increased intracellular concentrations of serine may protect and against the osmolarity of the ocean. in contrast, sucrose and trehalose are not being used as readily for osmoprotection.

 <dig>  microbes in the sargasso sea are more limited for phosphate than nitrogen.

 <dig>  microbes in the ocean are not generally using flagella based motility but are probably using one of the less-characterized mechanisms of locomotion.

 <dig>  archaea in the amd sample are degrading arginine and histidine.

the subsystems approach to investigating environmental genomes demonstrates the intricate interplay between the abundance of genes in the environment and the biology of that environment. in addition to answering that age-old knock-knock joke  <cit>  by cataloging the organisms that are present in an environment and looking for novel proteins and structures, metagenomics also provides critical insights into our understanding of the physiology, biology, and ecology of an environment. using subsystems to compare the ecology of sites that have been sampled by metagenomics can be applied to any other metagenome samples to provide similar insights into the ecology of those environments.

