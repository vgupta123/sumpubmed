BACKGROUND
cyanobacteria have played an important role in the history of life on earth as the inventors of oxygenic photosynthesis, which gradually changed atmospheric chemistry to allow the evolution of eukarya  <cit> . being at the base of global carbon and nitrogen biogeochemical cycles, the latter due to the ability of many genera to fix atmospheric nitrogen gas, has provided them with essential roles in the evolutionary past and in modern ecosystems. the capacity to form stable symbiotic interactions with eukaryotic hosts is another remarkable feature of cyanobacteria, which led to the plastid we today term chloroplasts, and eventually to the plant dominated biosphere of the globe  <cit> . this green plastid is able to capture and transform the light-energy of the sun into biologically useful forms of energy and thereby to fix the carbon that life is built upon. the eukaryotic hosts in contemporary cyanobacterial symbiosis range from the amoeboid paulinella chromatophora, which harbours a unicellular endosymbiotic cyanobacterium  <cit> , to a number of plant species spread within the plant kingdom  <cit> . the latter all act as hosts to the more complex cyanobacteria differentiating for instance heterocysts, a specific cell type in which nitrogen fixation takes place. the frequency of this nitrogen-fixing cell type is often considerably enhanced in symbiosis to support the plant with its total need of combined nitrogen  <cit> .

the flexibility in life styles of cyanobacteria is underpinned by the highly diverse morphology of the cyanobacterial phylum , in their self-sufficiency in terms of physiological capabilities , which in turn allows their wide habitat occupancy-range on a global scale , often including extreme environments . cyanobacterial diversity is reflected also at the genomic level. sequencing efforts over recent years have clearly shown that genomes within the cyanobacterial phylum vary considerably in aspects such as size , g+c content , number of protein coding genes  and coding nucleotide proportion  .

we recently reported on the complete genome sequence of the heterocystous cyanobacterial symbiont , 'nostoc azollae'  <dig>  in the small aquatic fern azolla filiculoides and discovered features signifying a genome in a state of erosion  <cit> . the azolla symbiosis is a highly integrated mutualistic symbiosis between a pro- and a eukaryote, the heart of which is a nutritional dependence by the plant on the perpetual source of combined nitrogen delivered by the nitrogen-fixing cyanobacterium. this is accomplished through a number of unique features of the azolla symbiosis, many of which suggest a long-lasting co-adaptation between the partners. firstly, the filamentous cyanobacterium colonizes and is kept as a restricted population in the extracellular cavity that is formed in each azolla leaf  <cit> . secondly, the host maintains the cyanobiont population between generations, accomplished through an ingenious and complex vertical transfer mechanism not found in any other plant symbiosis, built on multiple cyanobacterial cell differentiation events  <cit> . in this process the azolla reproductive organ, the sporocarp, acts as the transfer vehicle of the cyanobacterial inoculum between plant generations. thirdly, the cyanobiont seems to have lost  its autonomy as it can no longer grow outside the plant  <cit> , making it an obligate symbiont, again the only known among plant symbioses.

interestingly, our genomic analyses showed that the genome of the azolla cyanobiont contains numerous pseudogenes spread over all functional categories. this indicates a severe loss of function, which has forced the cyanobiont to rely on its host for survival. one central question in relation to the cyanobiont of azolla is to what extent the unique obligate life-style of this cyanobacterium has influenced the eroding process of its genome and, more importantly, whether this is a contemporary example of a nitrogen-fixing plant plastid in the making. recent reports show other interesting examples of reduced genomes within the cyanobacterial phylum, such as the smallest known genomes among the more complex section iv cyanobacteria , cylindrospermopsis raciborskii cs- <dig> and raphidiopsis brookii d <dig>  <cit>  and the streamlined genome of a marine nitrogen-fixing unicellular cyanobacterium . these organisms all show signs of genome reduction, although they, in contrast to the azolla cyanobiont, are not known to form symbioses. c. raciborskii differentiates only terminal and r. brookii only incompletely developed heterocysts, and the cyanobacterium ucyn-a lacks some genes  for photosystem ii. prompted by our findings about the genome of the azolla cyanobiont and these recent reports, combined with the increased wealth of genomic information, we set out to elucidate in greater detail the evolutionary history of the large fluctuations apparent in genome size and content within the cyanobacterial phylum. in the past few years, studies on the phylogeny of cyanobacteria, based upon varying numbers of sequenced genomes and conserved proteins, have been presented  <cit>  and aided the identification of major clades within the phylum. the growing number of available genome sequences, however, warrants an updated and robust phylogeny and an analysis of the genomic changes which have occurred within the cyanobacterial lineage.

based on phylogenetic analysis of  <dig> orthologous protein groups present in  <dig> sequenced genomes, we analysed evolutionary patterns of genome composition in cyanobacteria and reconstructed the genome of the most recent common cyanobacterial ancestor. we also assessed the extent of genome reduction and expansion  within the phylum and searched for genetic and functional signatures related to morphology, cell development and symbiosis.

RESULTS
phylogenetic analysis and the cyanobacterial core
sequences from  <dig> cyanobacterial genomes were included in this study, representing a mix of unicellular, filamentous and filamentous heterocystous phenotypes, including known plant symbionts, as well as a few potential symbionts. a list of the organisms, organism abbreviations used and general information on their genome is presented in additional file  <dig>  in total, the dataset comprises  <dig>  protein sequences,  <dig>   of which were clustered into  <dig>  orthologous groups. the phylogenetic relationship of the  <dig> cyanobacteria was determined based on a concatenated alignment of  <dig> single-copy orthologs present in all genomes . in the resulting tree, many taxonomic groups are found to be non-monophyletic, for example, the paraphyletic chroococcales and the polyphyletic oscillatoriales. on the other hand, the orders nostocales and prochlorales are monophyletic. overall, the major clades are in large agreement with previous studies based on fewer genomes and single genes, such as 16s rrna or parts thereof  <cit> . the phylogeny can be divided into two main clades, here termed clade  <dig> and clade  <dig>  clade  <dig> consists of a wide range and a mixture of phenotypes including both filamentous and unicellular cyanobacteria of the orders chroococcales , oscillatoriales  and nostocales  as well as acaryochloris marina mbic <dig>  the latter a unicellular marine organism without an assigned order. all cyanobacteria with known or suspected symbiotic competence belong to clade  <dig>  the most evolutionary complex representatives within this clade are those capable of cell differentiation, the nostocales . the taxonomy of clade  <dig> is considerably more uniform, containing only small-celled often closely related marine unicellular cyanobacteria of the orders chroococcales  and prochlorales  with small genomes, while the cyanobacteria bacterium yellowstone a and b-prime , respectively), isolated from hot springs, are placed as a sistergroup to clades  <dig> and  <dig>  eight orthologs were identified in all finished genomes of clade  <dig>  to the exclusion of all genomes in clade  <dig>  these orthologs correspond to a techoic acids export protein, a cytoskeleton rodz putative homolog, a putative multidrug resistance efflux pump, a protein with a membrane protease subunit and four orthologs with unknown function. conversely, eight orthologs were found in all finished genomes of clade  <dig>  to the exclusion of all clade  <dig> genomes. these correspond to a nuclease, an aminotransferase, a gnat-family acetyltransferase, a homoserine o-succinyltransferase, a chorismate binding enzyme, the rpod <dig> rna polymerase sigma factor and two orthologs with unknown function. we identified a total of  <dig> orthologous genes present in all  <dig> genomes , a gene set defined here as the most updated cyanobacterial "core". the most abundant functional protein categories encoded by this strict core were not unexpectedly those related to translation , but categories such as coenzyme metabolism , dna replication, recombination and repair , energy production  and cell membrane biogenesis  were also highly represented. four genomes had lost functional gene copies in five of the  <dig> core orthologous groups . by defining a relaxed core gene set, based on orthologs present in the  <dig> finished genomes , we identified  <dig> additional orthologs, of which  <dig> are single-copy genes . this relaxed core, termed rcf, contained  <dig> orthologs involved in translation,  <dig> of which are ribosomal proteins and the rest are trna synthetases, elongation and release factors and one uncharacterised gene putatively involved in translation repression. within rcf are also several dna maintenance genes such as reca, recg and muts, genes involved in carbohydrate and amino acid metabolism such as glucose-6-phosphate dehydrogenase and glutamine synthetase as well as some subunits of the atp synthase and photosystem i. a further relaxation of the core, obtained by allowing orthologs to be missing from one , two  and three  finished genomes, resulted in an additional  <dig>   <dig> and  <dig> identified gene families, respectively . in all of these relaxed cores, the highly reduced genome of cyanobacterium ucyn-a  consistently lacked the highest proportion of orthologs with  <dig>   <dig> and  <dig> genes missing from rcf <dig>  rcf <dig> and rcf <dig>  respectively. several orthologs were also missing from the deep branching species gloeobacter violaceus  and cyanobacteria yellowstone a- and b-prime . glov lacked  <dig> orthologs in rcf1: e.g. the circadian clock kinase gene kaic, genes involved in transport of cobalt, iron and copper as well as several genes of unknown function. yella and yellb both lacked  <dig> orthologs in rcf2: e.g. the gamma subunit of the nad hydrogenase , an n-acetyltransferase involved in membrane biogenesis, a putative hydrolase and several uncharacterised genes.

in total,  <dig> finished genomes were missing genes, or had only pseudogenes, in one or more orthologous groups where all other genomes were represented . these missing orthologs are likely the result of specific adaptations for each individual genome, or of extensive divergence of proteins that may cause them to escape identification. the marine unicellular cyanobacterium ucyn a , misses  <dig> orthologs present in all other genomes corresponding to genes such as those coding for proteins of the psii complex . its minimal genome  and lack of crucial genes suggest that ucyn is in reality an obligate symbiont, although no eukaryotic host has been found  <cit> . in most other genomes only a few  orthologs were missing or non-functional.

'nostoc azollae'  <dig>  is the only obligate plant symbiont among the  <dig> cyanobacteria investigated; the reason for its obligate dependence on its host is as yet unknown. however, we identified two protein groups present in all other genomes, which in noaz were non-functional pseudogenes. these correspond to a geranylgeranyl pyrophosphate synthase and uroporphyrinogen-iii synthase hemd. the former is involved in the synthesis of carotenoids and chlorophyll, and the latter is generating precursors of tetrapyrroles such as haem, chlorophyll and bilins, all with important roles in photosynthesis and protection against photooxidative damage.

of all the protein groups identified,  <dig>  are unique to cyanobacteria. that is, they contain no sequences with similarity to proteins in organisms outside the cyanobacterial phylum . only two of these unique protein groups, which we term cya <dig> and cya <dig>  are represented in all  <dig> genomes . cya <dig> corresponds to a abrb family transcriptional regulator, shown to be involved in triggering a number of physiological processes in cyanobacteria, such as nitrogen metabolism  <cit> , toxin production  <cit> , photosynthesis  <cit>  and oxidative stress  <cit> . paralogs of this gene are present in  <dig> genomes, with the highest total number of gene copies in acaryochloris marina . although no known function could be ascribed to cya <dig>  its relative organization in the genomes was highly conserved. in  <dig> of the  <dig> genomes the gene was found directly upstream of murg, involved in cell wall and membrane biogenesis. the genomes that represented exceptions to this gene organization were those of the five unicellular strains synechocystis sp. pcc  <dig> , thermosynechococcus elongatus , gloeobacter violaceus  and cyanobacteria bacterium yellowstone a- and b-prime . in yella and yellb the cya <dig> gene is situated between a rhodanese domain protein and an isoleucyl-trna synthetase. in thee, a three-gene cluster composed of the ctacde cytochrome c oxidase subunits is located upstream of the gene. lowering the cut-off on searches  we found that cya <dig> is distantly related to a dna-directed rna polymerase of mycoplasma penetrans. among the relaxed core sets, an additional seven orthologs are unique to cyanobacteria. one of these orthologs contains a thioredoxin domain  while the other cyano-unique orthologs in the relaxed core sets corresponded to proteins of unknown function.

gene duplications
of the total  <dig>  orthologous protein groups identified,  <dig> contained recent paralogs  in one or more genome,  <dig> of which contain only in-paralogs from a single species lineage, arising from duplication after speciation or representing ancient duplications retained in one lineage only. we made no attempt to discriminate between the origin of paralogs . however, as the clustering method used  identifies genes within genomes that are more similar to each other than to genes in other genomes our analysis of paralogs consequently refers to in-paralogs. the highest gene-copy number for any single protein group was found for a transposase sequence, with for instance  <dig> copies in crocosphaera watsonii . we determined the proportion of paralogs and the total number of paralogous gene copies in each genome and classified these according to cog functional categories . figure  <dig>  clearly shows that large genomes of clade  <dig> dominate the proportion of paralogs as well as the total paralogous gene copy number in our dataset. the genomes with the highest number in both these categories is the unicellular acaryochloris marina , in line with previous reports  <cit> , but high numbers are also encountered in microcystis aeruginosa  and crocosphaera watsonii , the filamentous microcoleus chthonoplastes  and the heterocystous nostoc punctiforme . it is interesting to note that both acam and nosp represent cyanobacteria with symbiotic competence . the average number of gene copies for paralogs is highest in crow . we found that most paralogs cannot be classified according to cog functional categories  and that the majority of genomes in clade  <dig> have a higher distribution of paralogs in the replication  and signal transduction  categories, compared to clade  <dig> . the high abundance in the latter category indicates that clade  <dig> cyanobacteria have focused protein family expansions towards sensory functions, thus increasing their capacity to adapt to varying environmental conditions. the numerous paralogs in the replication category are mostly linked to transposases which can be seen in figure  <dig> where the "t" column is a sub-set of the l category, representing  <dig> transposase cogs. transposases are genetic elements that may also increase adaptation in bacteria  <cit> . additionally, the poorly characterized categories s and r are more abundant among paralogs in clade  <dig>  indicating putative novel inventions in these organisms. in contrast, paralogs in clade  <dig> have a higher distribution in the posttranslational modification and chaperone  and the cell membrane biogenesis  categories, suggesting an increased need for maintaining correct protein folding and high membrane stability during rapid growth. ucyn, which has the smallest genome not only within clade  <dig> but among all  <dig> cyanobacteria in this study, also contained the lowest number of paralogs. therefore, the few examples of paralogs found within the ucyn genome are highly interesting. these show a high distribution in the replication , post translational modification and chaperone functions , inorganic ion metabolism , cell membrane biogenesis , translation , energy production  and amino acid metabolism  categories. the obligate plant symbiont 'nostoc azollae'  <dig>  is unusual in that it contains comparatively few paralogs, most of which fall into the replication  category, and to some degree the cell cycle control, cell division and chromosome partitioning  functional classes, and the uncharacterised s category. a most striking feature is that not less than  <dig> of the  <dig>  paralogs are pseudogenes in noaz as are  <dig> of the  <dig>  in trichodesmium erythraeum .

evolutionary history of genomes: size and composition
the genome size variation among the  <dig> cyanobacteria examined, illustrated in figure  <dig>  is formidable, spanning from  <dig>   to  <dig>  mbp . cyanobacteria with a genome size of >  <dig>  mbp  are more variable in terms of cell size and include all filamentous cyanobacteria, while all genomes <  <dig>  mbp in size  represent unicellular cyanobacteria, restricted to oceans or hot springs. cyanobacteria with larger genomes are also considerably more variable in their habitat selection, occupying soils, limnic and marine environments as well as a range of eukaryotic symbiont hosts . within this group there is also a large subclade of unicellular cyanobacteria with larger genomes, represented by crow, mica and the six genomes within the genus cyanothece. it is also obvious that cell differentiation is not related to genome size as the heterocystous cyanobacteria represent the largest  and the smallest  genomes within the >  <dig> mbp genome group. however, the two cyanobacteria with smallest genomes in the heterocystous clade , rapb, with 'traces' of heterocysts, and cylr, with terminal heterocysts only, may be on their way to lose the cell differentiation machinery  <cit> . indeed, gene loss is probably also the case for ucyn which, in spite of belonging to clade  <dig> cyanobacteria , has the smallest genome of all  <dig> analysed here. while coding nucleotides  occupy most of the cyanobacterial genomes, those of trie and noaz differ considerably in having a significant proportion of their genomes represented by non-coding dna and a high frequency of pseudogenes, respectively . a pearson's chi-squared test based on  <dig> replicates show that non-coding nucleotides are unequally distributed in cyanobacterial genomes  and that noaz and trie are heavily biased in this respect . another  <dig> genomes show a positive bias in non-coding nucleotides, most of which are in the larger range of genome sizes , while the majority of genomes <  <dig> mbp are biased towards coding nucleotides. the organisms prochlorococcus mit  <dig>  and ucyn harbour the only genomes <  <dig> mbp which display an over-representation of non-coding nucleotides.

to visualize the fluctuations of genome sizes within the cyanobacterial lineage we applied a parsimony reconstruction of genome size at the nodes of the phylogeny. as seen in figure  <dig>  expansions have primarily occurred within clade  <dig> cyanobacteria, and a few genomes within this clade appear to have undergone particularly significant genome expansions: acam, trie and micc. among the seven heterocystous cyanobacteria, the genome of nosp has expanded to become the largest known for cyanobacteria today, while the genomes of cylindrospermopsis raciborskii  and raphidiopsis brookii  have undergone severe reductions. in the subclade consisting of these two cyanobacteria and noaz, a decrease in genome size has occurred since the branching from the anabaena/nostoc clade. however, whereas noaz has retained roughly the size of the ancestor shared with cylr and rapb, the reductions in these latter genomes have been more severe. genome sizes have decreased also in synechococcus sp. pcc  <dig>  and synechocystis sp. pcc  <dig> , while the other members of this subclade are dominated by the more large-celled unicellular cyanobacteria of the genus cyanothece, in which no obvious size changes appear to have occurred since their branching from micc. however, the most notable genome reductions have occurred in ucyn and thermosynechococcus elongatus . in sharp contrast to the high levels of genome size fluctuations of clade  <dig> cyanobacteria, a single event of genome reduction appears to have taken place in clade  <dig> cyanobacteria, from the original  <dig>  mbp to the less than  <dig> mbp genome sizes . the size of the genome at the branching point between clade  <dig> and clade  <dig> cyanobacteria is in turn estimated to be  <dig>  mbp.

differences in genome sizes between clade  <dig> and clade  <dig> were analysed using felsenstein's phylogenetically independent contrasts  <cit> . as seen in figure 5a,b, clade  <dig> cyanobacteria  show a higher evolutionary rate of both genome size  and paralog copy-number . as the differences between the clades make them unsuited for simultaneous regression analysis through the origin  <cit> , subsequent analysis was focused on the more heterogeneous cyanobacterial genomes of clade  <dig>  a phylogenetically correct regression analysis of paralogous gene copy number  and genome size  within clade  <dig> shows a significant positive correlation between genome size and number of duplicated genes  . this is in line with previous reports  <cit> . we also noted a negative correlation  between genome size and coding nucleotide proportion within clade  <dig>  although without statistical support .

as seen in figure  <dig>  the inferred genome size of the most recent common ancestor  of cyanobacteria is approximately  <dig>  mbp. based on the presence/absence of orthologs in the nodes of the tree, the genome of the mrca is estimated to have contained between  <dig> and  <dig> protein-coding genes . given the large number of paralogs in the genomes at the tree nodes we also determined the gene content of the mrca based on the copy number of genes in orthologous groups. however, this did not shift the gene content to a large extent . the coding nucleotide proportion of the mrca, based on the lowest and highest predicted number of genes is  <dig> and 70%, respectively. this indicates that the smaller size of the gene set is likely to be an underestimate. of the estimated mrca gene set,  <dig> of the maximum  <dig> and  <dig> of the minimum  <dig> orthologs are unique to cyanobacteria. in total,  <dig> of these cyano-unique groups could be reliably annotated in one or more of the databases used . the majority of cyano-unique orthologs in the mrca gene set to which a cog category could be assigned belonged to the categories function unknown or general function prediction only , transcription , replication, recombination and repair  and posttranslational modification, protein turnover, chaperones . furthermore, this unique set of ancestral cyanobacterial proteins includes an uncharacterised thylakoid-associated protein, a thylakoid membrane protein, the replication initiation and membrane attachment protein , four bacterial conjugation trbi-like proteins, a number of phycocyanin-associated proteins and the circadian clock protein kaia. additionally, the mrca gene set includes the genes nifehdkub, involved in the nitrogen fixation process, and the transcriptional regulator patb. however, the presence of these genes in the mrca could not be inferred unambiguously.

phenotypic characteristics and functional distribution
an overview of phenotypic characteristics represented by the  <dig> cyanobacteria examined is given in additional file 1: morphology , physiology , symbiotic competence, and typical habitat . to search for any biased functional distribution, which may indicate functions necessary for a specific phenotype/characteristic, cog functional categories were attributed to each protein in the  <dig> genomes. the relative distribution of cog categories is shown in figure  <dig> in relation to their phylogenetic position. the functional distribution of genes in chloroplast genomes - an extreme case of cyanobacterial genome reduction and adaptation - and in the predicted gene set of the cyanobacterial mrca is also given. some conspicuous trends are apparent. for instance, the category replication, recombination and repair  makes up 10%, or more, of the gene repertoire in five genomes: crow, noaz, mica, artm and trie. most of these genes are related to transposases in each genome as can be seen in figure  <dig> where orthologs present in  <dig> transposase cogs in the l category are displayed separately . in the majority of other genomes, the l category contributes 5% or less and transposases are scarce in clade  <dig> genomes. in noaz, most genes in the l category  are pseudogenes, but several functional transposases still exist in the genome . the two other cog categories with the highest proportion of genes in most genomes are general function prediction only , dominating in all genomes including the mrca, and function unknown , indicating that a large part of the proteins in cyanobacteria are as yet not classified. the latter of these two categories was generally more abundant in genomes belonging to clade  <dig> cyanobacteria. the smaller cyanobacteria of clade  <dig> more consistently contain a higher proportion of genes related to amino acid metabolism  but a lower proportion of genes involved in signal transduction  and cell motility  compared to most other cyanobacteria. furthermore, the minimal genome of ucyn has  <dig> % of its genes in the translation  category, and its functional bias is thereby similar to that in chloroplasts, but not to its closest relatives. the extremely reduced genomes of chloroplasts are also highly devoted to energy production and conversion , while ucyn has a low proportion of its genes in this category. rather this genome appears biased towards cell membrane biogenesis  and coenzyme transport and metabolism . it should also be noted that the functional distribution of the mrca is not particularly similar to that of chloroplasts, although it may have been closely related to the chloroplast progenitor.

the filamentous phenotype is exhibited by  <dig> organisms in our dataset and shows an ambiguous evolutionary history as seen in figure 7a. parsimony reconstruction cannot discriminate between the possibilities ranging from two independent gains  to one common gain  with a consecutive loss of the trait . the result of this reconstruction is in line with previous studies of cyanobacterial traits  <cit> . we found  <dig> orthologs  present in all filamentous cyanobacteria with genomes sequenced to completion, but lacking in all unicellular cyanobacteria. neither of these orthologs were present in the predicted gene set of the cyanobacterial mrca but nine are unique to the cyanobacterial phylum. notably, eight of the  <dig> orthologs are pseudogenes in noaz, which implies that they are not directly involved in filament formation. of the remaining  <dig> orthologs, two are present in all  <dig> filamentous cyanobacteria and correspond to a thermonuclease  and a protein distantly related to a bacterial regulator of the luxr family . these two orthologs were identified previously by stucken and co-workers  <cit>  in a set of genes found only in filamentous cyanobacteria. however, the former of the two was not included in their proposed core set  comprising  <dig> genes in total. of the remaining  <dig> orthologs found only in filamentous cyanobacteria, six were also identified by stucken and co-workers. six of the additional nine orthologs identified here show significant similarity to a sucrose porin, a protein kinase, a putative anti-sigma factor antagonist , a peptidase-like protein, a protein with a xylose isomerase domain and a protein with a kgk domain . the two latter are unique to cyanobacteria. three of the nine orthologs show only slight similarity to a histidine kinase, an outer membrane efflux protein and a protein involved in fatty acid synthesis . we found no orthologs uniquely shared by unicellular cyanobacteria, which provides additional support to the hypothesis that the filamentous phenotype is a derived trait  <cit> .

of the  <dig> cyanobacteria in the dataset,  <dig> fix atmospheric nitrogen . the history of nitrogen fixation, as explained by parsimony and our taxonomic sample , does not exclude the possibility that the cyanobacterial mrca was diazotrophic. a number of gains and losses of this capacity have clearly occurred throughout the evolution of the cyanobacterial lineage. nitrogen fixation is, as expected, present in all heterocystous cyanobacteria with the notable exception of rapb, an example of an organism in the process of losing capacity to differentiate heterocysts and diazotrophy  <cit> . another example of loss is seen in the genus arthrospira . interestingly, diazotrophy is retained in a number of unicellular cyanobacteria outside clade  <dig>  including ucyn with its minimal genome, while it seems to have been lost in the globally wide-spread mica and in syn <dig> and scys <dig>  hence, there is a general positive correlation between diazotrophy and filamentation on one hand and unicellular cyanobacteria with larger genomes on the other, while the smaller clade  <dig> cyanobacteria lack this capacity. the hetr gene, encoding the master regulator for heterocyst development  <cit> , is also not unexpectedly lacking in clade  <dig>  the presence of hetr shows a positive correlation with diazotrophy . the correlation is even stronger between hetr and the filamentous phenotype, whether heterocystous or non-heterocystous, with hetr being present in all  <dig> filamentous phenotypes examined here. the hetr gene is in addition found in two unicellular strains of synechococcus , being a diazotroph and a non-diazotroph, respectively, where its function is unknown.

thirteen orthologs were found in all nitrogen-fixing cyanobacteria with finished genomes, but lacking in all non-diazotrophs. six of these are present in all nitrogen-fixing species and correspond to five genes in the nitrogenase  gene cluster: nifbehks . the remaining ortholog is the xre family transcriptional regulator patb, which is found in the vicinity of the nif cluster in a few cyanobacteria, but is distantly located in others. rapb, which appears to have lost the complete nif cluster  <cit> , did not share any orthologs exclusively with all nitrogen-fixers or all nitrogen-fixers with finished genomes. similarly to the flanking regions of the nif cluster in cylr, rapb shows a high similarity to both sides of the patb gene in cylr, suggesting a location for patb in rapb before being lost. the additional six orthologs found only in nitrogen-fixing cyanobacteria correspond to ferredoxin- <dig> and the nifuwxzt gene cluster.

heterocysts are formed by seven organisms in our dataset. we identified  <dig> orthologs present in all heterocystous cyanobacteria with finished genomes that were absent from all non-heterocystous cyanobacteria . as for the filamentous phenotype, neither of the heterocyst signature genes were present in the predicted cyanobacterial mrca. however,  <dig> of the  <dig> heterocyst specific orthologs were unique to cyanobacteria. among these, which mostly correspond to hypothetical genes, are two genes involved in bacterial conjugation , a gene with a domain found in osmotic shock protection proteins  as well as a putative type iv pilus biogenesis gene. two of the cyanobacteria included in the study do not exhibit a complete developmental mode. cylr forms only terminal heterocysts and rapb only partially developed terminal heterocysts  <cit> . the response regulator gene pata, known to be essential to proper heterocyst pattern formation  <cit> , is among the  <dig> heterocyst specific orthologs. rapb lacks this ortholog and a protein alignment of pata shows that the conserved n-terminal patan domain  <cit>  of the protein is missing in cylr, which may underpin the presence of exclusively terminal heterocysts in this organism. of the  <dig> heterocyst-specific orthologs, not less than  <dig> orthologs are pseudogenes in noaz, most of which are involved in solute transport and cell membrane biogenesis. one of the orthologs present in all heterocystous cyanobacteria was found in  <dig> to  <dig> copies in all genomes except in noaz where it is a single-copy gene. no function could be ascribed to this ortholog with the cut-off used. however, lowering the cut-off  we find that the ortholog is distantly related to fimbrial proteins , which enable bacteria to colonize the epithelia of host organisms and to promote virulence  <cit> .

the only two proven plant symbionts examined in this study, nosp and noaz, exclusively share  <dig> orthologs . notably, noaz has lost function in seven of these, two belonging to the receptor/sensory family of proteins, one glycosyl transferase involved in cell membrane biogenesis, a threonine/homoserine efflux transporter, a type i phosphodiesterase, a short-chain dehydrogenase of unknown specificity and one ortholog to which no function could be assigned. of the remaining six orthologs exclusive to the plant symbionts, functions could be assigned to two orthologs: a signal transduction histidine kinase and a glycosyl hydrolase  which catalyses the endohydrolysis between n-acetyl-d-glucosamine and d-glucosamine. no other genome in the dataset contained any proteins annotated with this pfam id. two orthologs were exclusive to noaz, nosp and acam, the latter obtained as a symbiont in colonial ascidians  <cit> , one of which corresponds to a adp-ribosylglycohydrolase while to the other no function could be ascribed. additionally, three orthologs were exclusive to noaz, nosp, cylr and rapb, which may be forming associations. these correspond to a protein with an s-layer homology domain , a tellurite-resistance protein and a protein with unknown function.

in contrast to nosp, which is a facultative symbiont, noaz spends its entire life cycle in a perpetual plant interaction and has suffered severe loss of function with a massive number of pseudogenes mainly in the functional categories related to replication, secondary metabolite biosynthesis, and signal transduction  <cit> . we reconstructed the ortholog content of the most recent ancestor of noaz and its closest relatives, cylr and rapb. assuming that noaz entered into its obligate symbiotic relationship  after diverging from cylr and rapb, this represents the last known free-living ancestor of noaz. thus, any orthologs in this subset which are missing in the extant noaz genome should have been lost during its evolution within the plant environment, and possibly reflect redundant functions in this evolutionary setting. we found that noaz is missing between  <dig> to  <dig> orthologs that were present in this free-living ancestor. most of these belong to the functional classes energy production , inorganic ion transport and metabolism , nucleotide transport and metabolism  and carbohydrate transport and metabolism . numerous orthologs  with similarity to abc-transporters, permeases and secretory proteins were also missing in noaz, as was a cell division control protein with a dna helicase domain, known to resolve holliday junctions that arise during recombination and repair. in contrast, the functional classes transcription, defence mechanisms and translation were the least represented among the missing orthologs.

discussion
our comparative analyses of cyanobacterial genomes revealed a core gene set of  <dig> orthologs, the majority of which are involved in crucial house-keeping functions. the  <dig> cyanobacterial genomes examined here provide a dataset several-fold larger than the  <dig>  <cit>  and  <dig>  <cit>  genomes analysed in two previous studies. by matching our core orthologs to those identified in these studies, we find that the  <dig> cyanobacterial clusters of orthologous groups  identified by mulkidjanian and co-workers  translate into  <dig> of the orthologs in the  <dig> genomes examined here. the latter study identified a core set of  <dig> single-copy genes  <cit> , of which  <dig> are present in our relaxed core  of  <dig> single-copy orthologs. the differences noted obviously relate to the number of genomes examined but also to the method used to cluster orthologs and define the core. the method  used here to define the core gene set in the  <dig> genomes involves an all-against-all blast step, and additional rules to identify recent paralogs . mulkidjanian and co-workers  used the cluster of orthologous groups method  <cit>  and defined the core in their dataset as cyogs that were missing in no more than one genome. of the  <dig> orthologs in our dataset, which correspond to the  <dig> cyogs identified by mulkidjanian and co-workers,  <dig> are likewise present in our relaxed core gene set . the  <dig> cyogs missing from the relaxed cores were mostly lacking in cyanobacterium ucyn-a, the two yellowstone species or in the prochlorococcus clade and belonged primarily to the general prediction only , energy production , amino acid  and inorganic ion transport and metabolism  functional categories. shi and falkowski  <cit> , on the other hand, identified their  <dig> single-copy orthologs using reciprocal best blast hits and divided these into  <dig> core and  <dig> shell genes . the orthologs which are not present among the  <dig> single-copy genes in our rcf gene set most often corresponded to genes involved in coenzyme and amino acid transport and metbolism. the reason that these orthologs are missing from the core in our dataset is due to their absence in one or more finished genome as well as to the existence of multiple gene copies in one or more of the genomes analysed here.

the phylogeny presented in figure  <dig> shows two major cyanobacterial clades and a sister group consisting of the yellowstone species and gloeobacter violaceus, in agreement with gupta and mathews   <cit> . cyanobacteria with the largest genomes  contained the highest number of paralogs. this result suggests that gene duplication is a strong driving force for broadening the phenotypes and subsequently the adaptive behaviour of the cyanobacteria investigated, as proposed for other prokaryotes  <cit> . these duplications can originate from either within the genome itself  or can be introduced by horizontal gene transfer . although we did not attempt to discriminate between these two mechanisms, we observed that approximately 10% of protein groups involved only a single genome . this indicates that several protein families within cyanobacteria may be the result of hgt events or that these sequences have diverged to the point where any significant similarity to homologs in other genomes is lost. additionally, gene transfers both within cyanobacteria and from other phyla have been reported previously  <cit>  and may contribute substantially to the expansion of gene families  <cit> . a striking example of gene family expansion is obvious in the chlorophyll d-containing unicellular acaryochloris marina with the second largest genome among the  <dig> genomes examined and by far the highest number of paralogs . indeed, this cyanobacterium is capable of adapting to a range of specialized environmental niches  <cit> , including symbiosis with ascidians  <cit>  and marine macroalgae  <cit> . the other extreme is the unicellular cyanobacterium ucyn-a with the smallest genome and the lowest number of paralogs among the  <dig> cyanobacteria investigated. the paralogs identified in this genome appear biased towards posttranslational modifications and chaperone functions , events of importance in endosymbionts  <cit>  and exhibiting a positive selection bias in e.g. the insect endosymbiont buchnera  <cit> . the drastically diminished genomic features in ucyn therefore support an implied life-style dependence on other organisms  <cit> , potentially in a fully developed endosymbiotic context.

according to our parsimony reconstructions , the genome size of the most recent common ancestor  of cyanobacteria was approximately  <dig>  mbp and contained 1678- <dig> protein-coding genes. the coding nucleotide proportion would then account for 36-70% of the proposed genome size of the mrca. including the number of genes within orthologous groups in the reconstruction  did not significantly alter the size of the estimated gene set. the relatively low coding proportion may be due to the fact that estimates are based on orthologs in genomes, thereby missing the genes that could not be grouped by our gene clustering method. a parsimony reconstruction of the total number of genes in the mrca puts the gene count at approximately  <dig>  which represents a more plausible size of the ancestral gene repertoire. interestingly, the mrca genome may have included a set of nif genes, opening up the possibility that the cyanobacterial ancestor was a diazotroph .

it is apparent that the genomes of cyanobacteria, ranging almost 10-fold in size from just above  <dig> mbp to close to  <dig> mbp, have been subjected to a range of niche-specific environmental and competitive forces during the billion years of evolution of the phylum, and thus each genome in our dataset may uniquely reflect the characteristics it displays. still, the cyanobacterial genome sizes show two general trends that reflect the two major clades identified . the evolutionary history of genomes within clade  <dig> involves a mix of expansions and reductions while a single event of genome reduction appears to have taken place at the branching of clade  <dig>  dominated by the often closely related marine picocyanobacteria . it is also clear that both genome sizes and number of in-paralogs evolve at a faster rate , and that there exists a strong correlation between genome sizes and gene copy number, in genomes of clade  <dig> . thus, clade  <dig> cyanobacteria appear to employ a survival strategy anchored in genome  expansion capacities, while the unicellular and mostly marine cyanobacteria in clade  <dig> rely on genome streamlining and the maintenance of a minimal gene repertoire. the former strategy allows clade  <dig> cyanobacteria to be highly flexible in terms of not only developmental capacities , but also physiological performance  and a wide habitat occupancy among prokaryotes. a similar pattern has been shown previously within clade <dig> cyanobacteria with significant streamlining having ocurred in prochlorococcus isolates since their divergence from synechococcus  <cit>  . in spite of the constraints imposed by the genomic streamlining in clade  <dig> cyanobacteria, this strategy has been ecologically highly successful, at least in specific niches, considering the abundance of these cyanobacteria in nutrient-deficient warmer oceans with few competitors, or as recently suggested, positive interactions with other co-occurring bacteria  <cit> .

the adaptive potential of the clade  <dig> strategy may also explain the successful entrapment in highly specialized niches. a clear example is the obligate symbiont 'nostoc azollae'  <dig>  which has substituted a free-living life-style with one restricted within a eukaryotic host. still, this symbiotic interaction is highly dependent on the complex developmental modes of the cyanobacterium, involving differentiation of several cell types, including those required for the vertical transmission process  <cit> . such host-restricted conditions impose population size diminishments and relaxed constraints on protein-coding genes, leading to fixation of deleterious mutations  <cit>  and pseudogenization followed by gene loss and genome shrinkage  <cit> . the 'nostoc azollae'  <dig> is apparently at an early stage of a host-adapted life-style, as its genome size has been only slightly reduced since divergence from its free-living ancestor . this is also reflected in the relatively low number of orthologs , which we estimate to have been completely lost during symbiosis and the still evident high proportion of pseudogenes  <cit> , which are likely targets for removal. if these pseudogenes were to be lost, the genome size of 'nostoc azollae'  <dig> would approach that of its closest relatives c. raciborskii and r. brookii . whether any of the lost genes have been targeted to the plant nucleus  is unknown. such a transfer of genetic material from the cyanobiont to the host might be mediated by the dna-containing vesicles seen during the vertical transmission of the cyanobiont between azolla generations  <cit> .

other cyanobacteria in clade  <dig> that show signs of genome reduction include cylindrospermopsis raciborskii and raphidiopsis brookii  <cit> , the unicellular cyanobacterium ucyn-a  <cit>  and thermosynechococcus elongatus  <cit>  which occupies hot-springs  <cit> . however in these cases, the genome reduction has affected distinctly different cellular processes. in cylindrospermopsis and raphidiopsis, free-living aquatic cyanobacteria with the smallest genomes  among section iv heterocystous cyanobacteria, the capacity to differentiate heterocysts has been negatively affected, while in the marine nitrogen-fixing ucyn, genes involved in photosynthesis  are lost. the reduction in genome size in these cyanobacteria has been considerably more dramatic than in 'nostoc azollae'  <dig>  since divergence from their last known ancestor . these genome reductions suggest a symbiotic or other highly interactive life style for these organisms. if this is the case, the former would act as photosynthetic symbionts  while ucyn would act as a diazotrophic symbiont delivering nitrogen to a potentially photosynthetic host supplying carbohydrates. the genome of trichodesmium erythraeum provides another unexpected example in this context as it displays the highest proportion of non-coding nucleotides  among all  <dig> genomes examined . this implies a severe ongoing genome erosion  in a globally wide-spread, free-living, and fully photosynthetic and diazotrophic cyanobacterium, sharing oligotrophic surface waters with cyanobacteria with the smallest genomes known . however, our data also clearly show that the large genome of trichodesmium erythraeum  is not shrinking but expanding in size . this result suggests that this cyanobacterium employs yet another strategy to cover large segments of our oceans. one hypothesis is that the large trichodesmium colonies, which are associated with numerous other microorganisms  <cit> , are highly flexible and 'open' to gene gain via transfers from its co-habitants.

considering the large number of genomes used in this study, the finding of orthologs that are exclusively shared by, or missing from, genomes with specific phenotypes strongly implicates these orthologs in the underlying reason for the resulting phenotype. for instance, we identified  <dig> orthologs underpinning filament formation,  <dig> orthologs exclusive to heterocystous species, as well as  <dig> orthologs shared between the only two sequenced plant symbionts. since no orthologs were identified exclusively in the unicellular cyanobacteria, the filamentous phenotype is most likely a derived trait. our results suggest that the cyanobacterial ancestor was unicellular and that the filamentous morphology was introduced later within the lineage . this finding is in line with previous reports on cyanobacteria  <cit>  and argues against the irreversible end-state of the coccus morphology in prokaryotes  <cit> .

not less than  <dig> of the  <dig> heterocyst-related orthologs are pseudogenes in 'nostoc azollae'  <dig>  suggesting that they are not directly involved in heterocyst formation or that heterocysts are in some way severely impaired in noaz. among the heterocystous cyanobacteria, the n-terminal patan domain of pata  <cit>  is lacking in cylindrospermopsis raciborskii and the whole pata gene is missing in raphidiopsis brookii. the absence of a full-length copy of this otherwise heterocyst-specific ortholog is a likely reason for the exclusively terminal heterocysts  in these strains.

as seven of the symbiont-specific genes are no longer functional in the obligate 'nostoc azollae'  <dig>  these may in turn have key functions in the re-establishment of plant-cyanobacterial associations. the inability of 'nostoc azollae'  <dig> to survive outside the plant host has puzzled researchers. the cyanobacterial symbiont of azolla could be kept alive for months under certain free-living conditions, but was still unable to multiply and exhibited photobleaching  <cit> . our finding of pseudogenized orthologs in noaz involved in pigment synthesis and present in all other cyanobacterial genomes investigated, suggests that these genes are necessary for survival under free-living conditions but dispensable in the azolla symbiosis where the chloroplast canopy of the plant shields the symbiont from excess light. moreover, the discovery of a specific protein family related to carbohydrate metabolism in the two plant symbionts nostoc punctiforme and 'nostoc azollae'  <dig>  makes the substrates of this enzyme, n-acetyl-d-glucosamine and d-glucosamine, a likely candidate for the carbohydrate supplied by cyanobacterial plant hosts. interestingly, d-glucosamine is a signalling factor for nodule development in rhizobia symbioses  <cit> . these orthologs constitute exciting targets for further analyses.

finally, we are aware that bacterial traits often require a complex network of genetic interactions and gene expression dosage, seldom explained by the presence or absence of a single gene product. furthermore, the comparative approach taken here is naturally limited by the data  at hand. importantly, the organisms included should optimally be judiciously sampled in order to reflect the underlying phylogenetic diversity and genetic complexity. such a representative sample might be hard to achieve given the current availability of cyanobacterial genomes, but should definitely be taken into account in further sequencing efforts. nevertheless, we hypothesize that linking protein families to characteristics, and analysed from an evolutionary perspective, provides a valuable starting point for further research on the metabolic and morphological phenotypes of cyanobacteria.

CONCLUSIONS
with the dataset used, based on  <dig> cyanobacterial genomes, the stringent core genetic repertoire of cyanobacteria now represents  <dig> orthologs. a relaxed core gene set, based on  <dig> of these genomes sequenced to completion, contains  <dig> orthologs, of which  <dig> are found in single-copy versions. due to the severe loss of genes in cyanobacterium ucyn-a neither of these core gene sets include genes for the photosystem ii complex . two orthologs in the stringent gene core are unique to all cyanobacteria, one which corresponds to a transcriptional regulator and the other to an unknown protein with a conserved genomic neighbourhood in all species examined. seven additional orthologs were unique to the relaxed core gene sets of the cyanobacterial phylum  but are currently poorly characterized.

genome sizes and number of duplicated genes within the major clade, which comprises species of varying complexity and choice of habitat  evolve at a higher evolutionary rate than the clade of marine picocyanobacteria. variation in cyanobacterial genome sizes is the result of a mix of gains of losses in the former clade and of one single reduction event in the latter. it is also deduced that the common ancestor of extant cyanobacteria had a genome size of ~ <dig>  mbp and contained between  <dig> and  <dig> proteins, ~4-6% of which are unique to cyanobacteria today. the largest genomes of cyanobacteria contain the highest number of paralogs and there is a strong correlation between genome and gene family expansions within the more complex clade. the latter is likely to result in increased adaptive potential but may also lead to a an accumulation of non-coding genomic regions as the organisms shift their habitat and/or life-style, rendering duplicated genes redundant and subject to increased mutation rates. a clear example of this phenomenon is the obligate symbiont 'nostoc azollae'  <dig> in which 64% of in-paralogs are pseudogenes.

a number of orthologous proteins underpin traits of certain cyanobacterial groups. these include a set of signal transduction proteins and a glycosyl hydrolase specific to plant symbionts. conversely, the lack of certain conserved orthologs or domains in a few cyanobacteria can be correlated with the phenotype they exhibit as seen in cylindrospermopsis raciborskii with terminal heterocysts only, and the loss of functional genes involved in pigment biosynthesis in 'nostoc azollae'  <dig> 

