BACKGROUND
discovery of new bioactive molecules that could enter drug discovery programs or that could serve as chemical probes to explore molecular mechanisms is very complex, time consuming and costly. in recent years, various in silico approaches have been reported and are now commonly used prior to or to complement experimental screening techniques with the aim of facilitating the overall process. in particular, virtual screening  methods such as structure-based  and/or ligand-based  allow to screen thousands or millions of small molecules against a biomolecular target  <cit> , and therefore, these approaches play an increasingly important role in modern drug discovery programs. sbvs makes use of docking and scoring techniques to orient and rank small molecules in the context of the protein-binding site, searching for shape and chemical complementarities  <cit> . the general concept behind ligand-based drug design relies on the molecular similarity principle that assumes that similar molecules have similar biological activity  <cit> . both in silico screening methods require a suitable chemical compound collection as input. usually, libraries should be filtered to remove compounds with non-appropriate physico-chemical properties or chemical groups causing toxicology problems   <cit> . further, the 3d structure of each small molecule should be generated since, for the time being, academic or commercial compound collections are most often delivered in 1d smiles  <cit>  , cansmiles  <cit>   or in 2d sdf  <cit>   formats. for some of the methods, for instance rigid ligand docking or for 3d ligand-based screening experiments, a multiple conformer ensemble is also required.

it is well known that generating an accurate 3d structure for a small chemical compound is not trivial  <cit> . several techniques using rule-based methods  or data-based methods  <cit>  have been developed and a number of studies have been carried out in order to compare the existing approaches and to analyze the small molecule conformational preferences  <cit> . several well established commercial packages such as corina  <cit> , omega  <cit> , catalyst  <cit>  or med-3dmc  <cit>  generate single or multiple 3d conformation of small molecules applying various approaches, including algorithms that build linker regions on the fly and combining them with pre-generated fragment libraries for the ring systems  <cit>  and purely stochastic methods  <cit>  among others  <cit> . in addition, several online services provide direct 2d to 3d facilities, such as openeye' omega, molsoft  <cit> , corina, and from academic sites such as  <cit> . recently the web-service frog   <cit>  has been proposed and aims at providing on-line generation of a single or ensembles of 3d conformation for drug-like compounds.

yet, very few standalone tools generating single  3d conformation for a large number of compounds are freely available. the freely available balloon program  <cit>  proposes generating conformer ensembles for small molecules using a multi-objective genetic algorithm  approach. we have recently developed the program multiconf-dock  <cit>  for small molecule multi-conformer generation based on a systematic search that requires as starting point the 3d structure of each input molecule in mol <dig> format, this package is also freely available .

here, we describe a new open source program, dg-ammos , for the generation of a 3d conformations of small molecules using distance geometry and their optimization via automated molecular mechanics optimization for in silico screening. dg-ammos makes use of the program ammp  <cit>  which is available upon gnu license. ammp is a full-featured molecular mechanics, dynamics and modeling program. it allows manipulating both, small molecules and macromolecules with a flexible choice of potentials and a simple way to analyze individual energy terms. ammp has been recently implemented in the well-known opengl molecular modeling package vega  <cit> . the generated 3d single conformer for each molecule could then be additionally subjected to different multiple conformer generator packages, such as our tool, multiconf-dock  <cit> . in this study, in addition to describing the dg-ammos program, we validate our package on compounds from the astex dataset  <cit> , the chembridge diversity database  <cit>  and a number of small molecules  <cit>  with known crystal structures extracted from the cambridge structural database   <cit>  or the pdb  <cit> . the comparison of dg-ammos with the well-known commercial package omega  <cit>  and the free program, balloon, shows convincing performances of our tool. one advantage of our program is that the source code is entirely available to users. dg-ammos accepts a library of chemical compounds in mol <dig> format with protonated molecules, this step can easily be performed using the program openbabel  <cit>  or the hgene utility of the freely available mypresto package  <cit> .

implementation
dg-ammos drives a fully automatic procedure for the generation of 3d conformation of small molecules. the package dg-ammos consists of several programs developed in c and python, and makes use of the molecular simulation package ammp  <cit> . ammp can be easily embedded in other packages and incorporates a fast multipole algorithm for the efficient calculation of long range forces thereby allowing evaluation of non-bonded terms without the use of a cutoff radius thereby increasing the speed of the computations while limiting the risk of errors or biases introduced by cutoffs  <cit> . the ammp force field sp <dig>  <cit> , developed on the basis of the uff potential set  <cit>  has been applied in dg-ammos.

dg-ammos procedure and modules
the procedure and modules of dg-ammos are illustrated in figure  <dig>  briefly, the architecture of the program is as follows: dg-ammos requires as input file a compound collection in mol <dig> format and returns the created 3d conformations in a mol <dig> format. the main python script dg-ammos.py ensures a full automation for a large number of small molecules. firstly, a routine written in c, mol2_to_templ_sp <dig>  creates templates required to the program preammp , preparing the file for the specific input format ammp required for running ammp. the next essential step is the generation of the 3d conformation of the small molecules by ammp via the script build_mol2_dgeom.ammp. the energies of the generated structures are stored, as well as some warning messages appearing during the execution of the program. the final step is the conversion of the generated structures from ammp format to mol <dig> and the saving of the results in the output files .

generation of a 3d conformation
the input structures in mol <dig> format may contain "zero" atomic coordinates. the input structures are treated as topology-only , thus the input atomic coordinates are explicitly set to zero prior to the generation of the 3d conformation. this removes any bias introduced by the input geometry. the initial 3d conformations are constructed by dg-ammos using a distance geometry method which has been reviewed in details elsewhere  <cit> . the gauss-siedel distance geometry , a hybrid krylov solver for distance geometry, as implemented in ammp  <cit>  is applied in dg-ammos. the gsdg method takes into account bond, angle, hybrid torsion, and non-bonded point atom electrostatics and van der waals potentials. the initial structure is corrected with molecular mechanics minimization leading to a structure with both good geometry and self-avoidance. in our implementation, we apply conjugate gradient method with the ammp force fields sp <dig>  <cit> . the protocol employs two subsequent steps with the maximum number of iterations set to  <dig> and a convergence value set to  <dig>  kcal.mol- <dig>  Å- <dig>  the resulting structures have reasonable bond lengths and valence angles provided that the optimization is allowed to iterate until convergence. to speed-up the computations, atom partial charges are assigned with the gasteiger-marsili method  <cit>  using the openbabel package  <cit> . to ensure the charges' calculation for small molecules at physiological ph, we apply an in house python script involving the openbabel python module pybel which provides the protonation of titratable groups according to a physiological ph with the pybel option "ph = true". users can protonate small molecules using the openbabel version  <dig> . <dig> which allows to add hydrogens appropriate for ph applying the option « -p » or using the hgene tool of the mypresto package  <cit> . unrealistic structures can be generated by distance geometry, e.g., intersecting rings that are impossible to correct by using gradient based optimization methods. if unrealistic conformational energy remains after the optimization process, the structure of this particular molecule is written into a separate file.

program input/output
compound libraries must be in a standard mol <dig> format with added hydrogens and gasteiger charges prior to dg-ammos calculations. before running dg-ammos, users should edit and check the parameter file, input.param, containing the name of the input compound collection in mol <dig> and the location of the dg-ammos package. several output files are created, one containing the generated 3d single conformation in mol <dig> format  as well as a file containing the "wrong" molecules  with energy higher than  <dig> kcal.mol- <dig> and a high angle and torsion energy. in addition, a table file reporting the computed non-bonded and total energy for each created structure is provided as well a warning file listing potential atom type errors.

data sets and program parameters
dg-ammos is a computer tool designed to help preparing large compound collections for subsequent virtual screening computations. in order to validate it, we decided to process a relatively large and diverse compound collection, namely the diverset™ database dated june  <dig>  from the chembridge corporation. this database was filtered by the free faf-drugs <dig> program  <cit>  to remove duplicates and salts, and to ensure molecules with reasonable drug-like properties . analysis was also performed on manually selected  <dig> drug-like small ligands co-crystallized with their protein targets  <cit>  taken from the original gold validation set of the astex dataset  <cit>  as well as on a set of  <dig> small diverse rigid compounds which we extracted from ligand-protein complexes with available x-ray structures in pdb.

in this work we run dg-ammos with the default parameters, these ones can be modified by the users in the file build_mol2_dgeom.ammp, a file that ensures the execution of the ammp procedure for the gsdg method. in the main python script dg-ammos.py the energy window for a "wrong" conformation can also be selected and modified. to compare the performance of dg-ammos we ran also the program balloon and generated the single 3d conformation of each compound built with dg-ammos. the following options were used for balloon: "-pstereomutation 0", standing for the genetic algorithm mutation probability for inverting a stereochemical center, set to 0; "-c  <dig> ", standing for the number of conformers to generate, set to 1; "-singleconf", standing for writing only the lowest-energy conformation regardless of the population size. the mmff <dig> potential energy was taken from the balloon output files containing the generated molecule coordinates in sdf format in order to analyze the problematic structures. omega was also run in order to validate dg-ammos. the algorithm implemented in omega v. <dig> dissects the molecules into fragments and uses fragment templates to build a seed conformation  <cit> . conformers are generated and are investigated for potential strain energy that is evaluated using the mmff. one key parameter is the ewindow value, which defines the strain energy range within which conformers are considered as acceptable. we applied the default ewindow of  <dig>  kcal.mol- <dig> 

RESULTS
drug discovery is an interdisciplinary, expensive and time-consuming process and chemical biology projects share a lot of the difficulties seen in drug discovery programs. advances in computational techniques and hardware solutions have enabled in silico methods, and in particular virtual screening, to speed-up modern hit identification and optimization. both in silico techniques, sbvs and lbvs, often require as input chemical libraries with small molecules in 3d. experimental sources of structural information, such as x-ray crystallography or nmr spectroscopy, remain unreachable for the millions of synthesized small chemical compounds. thus, the need for computer-generated 3d molecular structures has clearly been recognized in drug design and chemical biology projects.

in this study we present a new open source tool for the generation of a single 3d conformation for small drug-like molecules, called dg-ammos, written in python and c. the library is loaded into the engine as a mol <dig> file and the program outputs a file that contains the generated 3d conformation in mol <dig> format. the program also reports different energy values for all generated structures and a warning file is also written with possible errors appearing during the execution. in addition, "bad" molecules with very high energy are saved in a separate file, also in mol <dig> format. dg-ammos is fully automated and is user friendly. it has been tested successfully on several compound collections. the dg-ammos generated structures, while generally of low energy and chemically meaningful, are neither guaranteed nor intended to represent the absolute energy minimum of an input compound. this is not necessary, as dg-ammos-produced structures that will normally be used as the starting point for other procedures such as multiple conformer generation by our program multiconf-dock  <cit>  or docking, which will determine the lowest energy 3d conformation.

to validate the new tool dg-ammos, the programs dg-ammos, balloon and omega are firstly tested on the diverset™ database initially filtered with faf-drug <dig>  which resulted in  <dig>  compounds. the molecular weight and rotatable bonds distributions of these compounds are shown in figure  <dig>  both diagrams illustrate the diversity of the molecules in terms of size and flexibility. the resulting collection was subjected to 3d conformation generation with the three programs. the statistics for the generated structures are given in table  <dig>  of the  <dig>  molecules treated by dg-ammos and balloon  <dig> and  <dig>  respectively, failed because the created 3d structures showed very high energies. visual inspection of the "wrong" molecules showed in these cases, the presence of inter-crossing cycles or non-planar aromatic cycles. of the  <dig>  initial molecules omega generated  <dig>  3d single conformers. dg-ammos ensured  <dig> % success for the 3d generation of a large chemical library compared to  <dig> % success by omega, which confirms the robustness of our program. the filtered diverset™ database was processed by dg-ammos, balloon and omega in less than  <dig> h,  <dig> h and  <dig> h, respectively, on a linux machine  demonstrating that dg-ammos is by  <dig> fold more slow than omega and by  <dig> fold faster than balloon for single conformer generation.

conformer generation tools are mostly applied for modeling of protein-ligand interaction  or for ligand-based lead discovery. conformer generation algorithms are therefore typically tested on small molecules co-crystallized within a protein as found at the protein data bank or against single molecule x-ray crystal structures as available from the cambridge structural database. to ensure validation of the generation of bioactive small molecule 3d structures we performed computations over a set of  <dig> relevant compounds manually selected from the original gold validation set of the astex dataset  <cit> . the astex dataset molecules were previously chosen to assess the balloon package. the  <dig> structures were successfully processed by both, the dg-ammos and balloon programs. several of these molecules are shown in figure  <dig>  it can be seen that both programs build correct 3d structures with "good" energy values. we performed additional testing of dg-ammos and omega on a set of  <dig> small rigid compounds selected from ligand-protein complexes with available experimental x-ray structures in pdb  <cit>  in order to compare the experimental structures and the generated ones in single conformer. figure  <dig> presents the obtained results. overall dg-ammos provides similar performance as omega in terms of rmsd between the modeled and the experimental rigid structures. very few compounds generated by dg-ammos or omega significantly differ from the experimental ones. in most of these cases  aliphatic cycles  are generated by dg-ammos in different conformations compared to the x-ray structures. in the cases of 3goy and 2a <dig> a nhco group is turned by  <dig> degree in the omega generated single conformers, and similarly for the 2qlx conformer generated by dg-ammos .

along the same line of reasoning, we performed quality assessment of the generated conformers for several selected compounds extracted from the cambridge structural database  <cit> . the results can be seen in figure  <dig>  for n-ethyl-n-acetamide and n-methylbenzamide both dg-ammos and balloon generate torsion angles τ  that correspond to the preferred ones found experimentally in the csd. for mycophenolic acid and methylulfonyl-benzene, the predicted τ angles still remain close to the experimentally preferred torsion range. the favorable energy values obtained for the generated conformations can also be noted.

the presented results demonstrate the robustness of dg-ammos. all unexpected problems in terms of high energies or unknown atom types are indicated by the program. following the widely accepted computational requirements for a conformer generator  <cit> , dg-ammos is completely automated, able to easily handle large numbers of input molecules within a reasonable time and proposes high quality conformer models.

CONCLUSIONS
dg-ammos provides fast, automated and reliable access to the generation of 3d structures for small drug-like molecules and greatly assists the preparation of compound collections for high-throughput virtual screening computations. generated conformational models were investigated in terms of reliable energies, rigid structures and torsion angles. the obtained results on several different datasets prove that dg-ammos generated structures are generally of equal quality or sometimes better than structures obtained by other tools. dg-ammos requires input molecules in mol <dig> format, even if they do not have coordinate information, and hydrogen atoms and gasteiger charges that can be generated by the free chemoinformatics toolkit openbabel. the program outputs unreasonable conformations, if any, in a separate file. the application is suitable for the generation of 3d structure for large compound collections and runs on linux and mac osx platforms. the dg-ammos package and source code, written in python and c, are freely available, this software is user friendly and should be a valuable addition to users working in the field of drug design.

availability and requirements
• project name: dg-ammos

• project home page: http://www.mti.univ-paris-diderot.fr/fr/downloads.html

• operating system: linux, mac osx

• programming language: python, c

• other requirements: python  <dig> . <dig> to  <dig> .2

• license: gnu gpl

authors' contributions
mam designed and managed the project. dl, tp and mam wrote the code. dl tested dg-ammos, omega and balloon. bov and mam optimized the program. all authors took an active part in manuscript writing, read and approved the final manuscript.

supplementary material
additional file 1
dg-ammos. this file contains the dg-ammos package and the user manual.

click here for file

 acknowledgements
we would like to thank the inserm institute, paris descartes university and paris diderot university for supports. tp thanks the "mairie de paris" fellowship and the national science fund of bulgaria.
