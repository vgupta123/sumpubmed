BACKGROUND
the bottom-up engineering of living systems exhibiting predictable functions is one of the main goals of synthetic biology  <cit> . this approach relies on the modularity of the used components  <cit>  or the predictability of system function upon parts interconnection, environmental change or genetic context variation  <cit> . a reliable biological system design process will open the door to the full exploitation of synthetic biology's potential, which will benefit many application fields, like medicine and bioenergy, via the construction of customized systems for new drugs or fuel biosynthesis  <cit> . however, the interconnection of quantitatively characterized biological parts may lead to composite systems with apparently unpredictable behaviour, that is, the output cannot be intuitively gathered from the available knowledge of sub-parts  <cit> . basic research studies on ad-hoc constructed model systems have been conducted to elucidate the entity of context-dependent variability of biological parts and devices and, ultimately, to identify the factors contributing to this variability  <cit> . in such studies, components like promoters or simple inducible/repressible devices were individually characterized and used to engineer genetic networks of increasing complexity, including transcriptional regulator cascades, feedback-controlled systems or networks mimicking logic functions. the comparison between the experimental output of interconnected circuits and mathematical model predictions has been useful to evaluate the predictability boundaries of biological components when re-used to engineer diverse systems  <cit> . moreover, some of the factors affecting system modularity have been found, such as dna sequences that might enhance or decrease transcriptional activity when placed upstream or downstream of promoters  <cit>  or retroactivity effects due to the presence of dna binding sites in interconnected modules  <cit> .

context-dependent variability studies have also led to the development of specific genetic architectures, which significantly enhance the predictability of re-used components, such as insulation sequences for promoters  <cit>  and bicistronic design  for ribosome binding sites   <cit> .

in almost all the mentioned research studies fluorescent reporter proteins, like the green fluorescent protein  and red fluorescent protein , were adopted to experimentally measure the output of a genetic network in vivo. population or single-cell approaches were used to quantify fluorescence levels: fluorometers or multiwell microplate readers were adopted to measure the average fluorescence in the cell population  <cit> , while flow-cytometry was also commonly adopted to measure the fluorescence of each single cell in the population  <cit> . much of our current knowledge of biology relies on population-average measurements, which can lead to incorrect conclusions when populations are not homogeneous or when inter-individual variability is crucial  <cit> . for this reason, single-cell approaches have widely spread to accurately analyze cell-to-cell variability in populations. however, even when single-cell analyses are carried out, fluorescence distributions among cells are not fully taken into account during the development, training and testing of predictive mathematical models of the network. for this reason, only central tendency measures of fluorescence are used, like arithmetic/geometric mean or median, thus using single-cell approaches as a quality check for measurements, with fluorescence histograms only exploited as a control of cell homogeneity  <cit> . in particular, arithmetic mean can be used to compare data obtained from flow cytometry and fluorometers/microplate reader acquisitions  <cit> . on the other hand, only a few studies fully exploited cell-to-cell variability to build up predictive models able to describe the behaviour of genetic devices re-used in different configurations. for instance, guido et al. used the gillespie stochastic algorithm to capture the single-cell behaviour of a synthetic promoter  and the trained model was successfully used to predict the output distribution among recombinant cells bearing a feedback-controlled network including this promoter, as well as cell-to-cell variability quantitative changes upon plasmid copy number modifications  <cit> .

different fluorescence levels among cells in the same population can be attributable to noise  <cit> . noise is one of the main features characterizing gene expression in living cells and it can be considered as a highly important source of phenotypic variation in cell populations  <cit> . it is important to consider the stochastic nature of chemical reactions, which can lead to important phenomena regarding biological processes such as development, particularly when dealing with molecular species that are present in low or very low copy number inside cells.  <cit> . there are two main aspects of noise that can interact: an "intrinsic" component, due to the stochastic nature of the biochemical processes linked to gene expression itself, and an "extrinsic" one, which is caused by fluctuations in cellular species such as per cell concentrations of polymerases  <cit> . noise in synthetic biological circuits has been widely studied to elucidate the entity of its intrinsic and extrinsic components in different contexts  <cit> , characterize its propagation through interconnected networks  <cit> , investigate its contributions in transcription and translation processes  <cit> , study its effects in complex biological functions like oscillatory networks composed of transcriptional regulators  <cit>  and, finally, even to exploit it for the discovery of unknown regulatory motifs via dynamic correlation in time-course data  <cit> . noise has also been already used to explain apparently unpredictable outputs of genetic circuits that cannot be described by deterministic models  <cit> .

this work aims to study in silico the effects of cell-to-cell variability on the population-averaged output of interconnected biological circuits. in particular, we aim to investigate if central tendency measures, obtained via population-based or single-cell approaches, are suitable to study the input-output behaviour of individual and interconnected devices, or, conversely, if the entity of cell-to-cell variability needs to be included to accurately describe these input-output functions. considering the available experimental data of several studies where the interconnection of modules results in apparently unpredictable circuits, this study can elucidate if some observed inconsistencies might be caused by cell-to-cell variability. the computational analysis of several systems and variability models can support the experiment design of interconnected networks.

methods
genetic circuits topology
the genetic networks studied in this work are shown in figure  <dig>  they are transcriptional regulatory cascades commonly used in synthetic biology studies  <cit> . these networks are composed of inducible and repressible devices with a reporter gene downstream, such as rfp, to measure the circuit output. in particular, an n-3-oxohexanoyl-l-homoserine lactone -inducible device is always used as the input module of the network; it is composed of a constitutive expression cassette for the luxr protein, which activates the plux promoter in the presence of 3oc6-hsl in a concentration-dependent fashion. a genetic not gate is considered as downstream module, composed of a tetr protein expression cassette, driven by the upstream device promoter, and the ptet promoter, which can be repressed by tetr in a concentration-dependent fashion. another not gate device is also considered; its functioning is analogous to the tetr/ptet system and it includes the laci/plac repressor-promoter pair. finally, a genetic yes gate is considered, which is composed of an activator protein  expression cassette, driven by the upstream device promoter, and a promoter  that is activated by a in a concentration-dependent fashion. while the lux, tet and lac systems are well-defined and literature parameters are used to model their functioning , the a/pa system is mock and arbitrary parameters are used for it.

the paper is mainly focused on the network of figure 1a, where the 3oc6-hsl-inducible device is interconnected to a tetr-/ptet-based not gate. two network modifications are also considered, where the not gate is replaced by a yes gate  or where a laci/plac-based not gate device is interconnected downstream of the tetr/ptet-based not gate .

in silico experiments
assuming the modularity of biological parts  <cit> , that is, the module parameters do not change when different units are interconnected, we aim to simulate experimental studies to evaluate the contribution of noise on the population-averaged network output. two main investigations were performed, which are described below. the in silico experiments are carried out by considering the network at the steady-state and by using hill equations to describe the transfer function of each individual module. the output of interconnected networks is obtained by serially propagating the output of hill functions and noise is applied at different levels of the networks, as illustrated in figure 1d-h.

transfer function identification for a single module
the steady-state input-output transfer function of the tetr/ptet-based not gate  is measured by estimating its hill function parameters from simulated data, generated by including noise obeying specified laws. in particular, 3oc6-hsl-inducible devices affected by different noise entities were used to drive the not gate over a range of input values. the input devices are assumed to provide identical population-averaged signals to drive the not gate, except for the noise entity affecting them. in an experimental framework, this is analogous to having a set of inducible devices whose population-averaged transfer function at the steady-state has been identified via central tendency measures and the model of noise affecting it is known. previous studies were performed via a similar setup  <cit> , where the transfer function of the not gate module was identified in the presence of different input modules, pre-characterized via central tendency measures, and different transfer curves were yielded for the not gate; since the different input modules used may have different noise characteristics, this study aims to evaluate the contribution of noise on the resulting difference of the measured transfer curves.

input-output function identification for an interconnected network
the black-box input-output transfer function of interconnected networks  is studied for different noise entities. population-averaged measures of the individual modules, in the presence of noise, are used to identify their transfer functions and to predict the input-output characteristics of the full network. then, noise of different entities is applied to the individual modules and it is propagated throughout the network. finally, the population-averaged measures of the network output are used to identify the black-box hill function of the whole circuit and it is compared to the prediction obtained above. this study aims to evaluate the contribution of noise on the apparent unpredictability of composite biological systems obtained by interconnecting modules characterized via central tendency measures. the studied situation represents a crucial aspect in the synthetic biology world, where predictable systems are expected to be built from the knowledge of a set of individual parts  <cit> .

steady-state transfer functions of the genetic modules
the steady-state input-output activity of all the modules is modelled by hill equations, describing the synthesis rate per cell of the protein encoded by the downstream module, as a function of input molecule concentration  <cit> . in fact, even if all the considered modules are based on transcription, the synthesis  rate per cell of the downstream gene-encoded protein is assumed to be proportional to the transcription rate generated by the input device. this assumption is based on simple gene expression models, such as the ones described in  <cit> .

all the investigated interconnected networks are studied at the steady-state.

the transfer function of the 3oc6-hsl-inducible system  is always modelled as:

  output1=δin+αin1+kin3oc6-hslηin 

in eq. <dig>  the output of the device depends on 3oc6-hsl inducer concentration via four parameters describing its behaviour: δin is the basal activity of the device when no inducer is present, δin +αin is the maximal synthesis rate of the downstream protein, kin is the inducer concentration giving an output of δin+αin <dig>  and ηin is the hill coefficient. the kin parameter is expressed in the same units as 3oc6-hsl , the ηin parameter is dimensionless and the δin and αin parameters are measured relative promoter units   <cit> , which are used to approximate the downstream protein synthesis rate per cell triggered by the device  <cit> .

the function of the tetr-based not gate  is modelled as:

  output2=δout+αout1+output1koutηout 

in eq. <dig>  output <dig> is a decreasing function of output <dig> and parameters have the same meaning as above. although output <dig> is the tetr synthesis rate per cell, it is used to approximate the intracellular concentration of tetr protein, assuming that it is proportional to its synthesis rate per cell  <cit> ; in this case, the proportionality constant is included in the kout parameter.

when considering the three-module network, the function of the laci-based not gate  is modelled as:

  output3=δout3+αout31+output2kout3ηout <dig> 

in eq. <dig>  all the parameters have the same meaning as in eq. <dig> 

the function of the yes gate  is modelled as:

  output2=δout+αout1+koutoutput1ηout 

in this case , output <dig> is an increasing function of output <dig>  as opposed to eq. <dig>  in figure 1d-h, the qualitative trends of the hill functions for all the modules are reported. they can be considered as the deterministic transfer functions of all the devices, in absence of any stochastic effect, i.e., noise.

models of noise
here, noise was assumed to affect protein synthesis rate per cell  and to only be dependent on the interconnected device upstream of the gene encoding the protein. the "default" network condition considered in this paper is illustrated in figure 1a and 1d and its mathematical model of noise is herein discussed. a 3oc6-hsl-inducible input device is interconnected to a tetr-based not gate, whose output is measured; noise affects only output <dig>  considering a vector of n inducer concentrations of 3oc6-hsl, at the i-th 3oc6-hsl concentration , lognormal multiplicative noise  is applied to the deterministic output  of module  <dig> .

  output <dig> i=y <dig> i⋅vi 

  vi~logn 

where the logarithm of the lognormal distribution gives a gaussian distribution with mean µ =  <dig> and variance σi <dig>  which, in general, depends on inducer concentration. the lognormal distribution is widely used to describe noise in biological processes and, in particular, it well describes the fluorescence distribution of reporter proteins in cell populations bearing synthetic gene networks, as it is often shown by experimental measurements performed via flow cytometry  <cit> .

under the hypotheses described above, the mean ave and variance var of the lognormal noise are :

  avei=eσi <dig> 

  vari=eσi2⋅eσi2- <dig> 

since ave is not  <dig>  the average value of output <dig> i is not y <dig> i, but it is :

  eoutput <dig> i=y <dig> i⋅avei=y <dig> i⋅eσi <dig> 

which depends on σi <dig>  in the experiments performed in this paper, different noise entities are applied to module 1; this would produce different average values for the same deterministic transfer function at a given induction . however, in this work we aim to study the effect of equal population-averaged inputs with different noise entities because instruments used in population-based experiments typically measure average values of reporter proteins. for this reason, we introduced a correction term: to have equal average values for output <dig> for different noise variances, we corrected the deterministic output value y <dig> i as reported in eq. <dig> 

  y <dig> i=ypop,i⋅e-σi <dig> 

where ypop,i is the population-averaged output of module  <dig> at the i-th induction. from eq. <dig> and eq. <dig>  the average output value for module  <dig> is always :

  eoutput <dig> i=ypop,i 

considering the hill function of module  <dig> , the αin, <dig> and δin, <dig> parameters are scaled, with respect to their nominal values, as indicated in eq. <dig>  while the kin and ηin parameters remain unchanged. this process enables to set identical population-averaged output values for different noise entities affecting the 3oc6-hsl-inducible module.

two different noise models were considered: with constant coefficient of variation  or with constant variance . the former has been experimentally observed in different works in the literature  <cit>  and unpublished results from our laboratory, while the latter was used in this work to test a different assumption via simulations.

first, a constant cv noise model was assumed for all the 3oc6-hsl input concentrations. from eq.7- <dig> it results that :

  cv=variavei=eσi2- <dig> 

once a cv value is fixed, a value of σ <dig> can be obtained :

  σ2=ln1+cv <dig> 

the σ <dig> value computed from eq. <dig> is independent from ypop,i and it is used to generate noisy samples for output <dig> 

multiplicative lognormal noise model with constant var was also considered. from eq. <dig> and eq. <dig> it results that :

  varoutput <dig> i=ypop,i2⋅eσi2-1=var 

from eq. <dig>  the σi <dig> value can be obtained :

  σi2=ln1+varypop,i <dig> 

in this case σi <dig> is a function of ypop,i and is different for every i-th induction.

when noise was also applied to output <dig> , multiplicative lognormal noise with constant cv or var was considered and generated by following the same concepts as above. in this case, noisy samples were extracted with a correlation coefficient 0<ρ< <dig> to model an extrinsic component of noise in addition to the intrinsic one. in particular, if noise is fully due to an intrinsic component, output <dig> and output <dig> are independent, since intrinsic noise is caused by the stochasticity in processes like gene expression. on the other hand, if part of the noise is due to an extrinsic component, output <dig> and output <dig> are correlated random variables, since biological processes like gene expression in each single cell are influenced by a pure stochastic component  and by fluctuations of cellular species  that are due to the variation between cells of resources like polymerases and ribosomes. in this context, the expression of two different genes shares common resources and, as a result, it will be correlated. the contribution of extrinsic noise is tuned by changing ρ between  <dig>  and  <dig> .

parameter values and implementation
the parameter values reported in  <cit>  and obtained in unpublished experiments performed in our laboratory were used to describe the deterministic steady-state hill functions of the nominal lux, tet and lac systems. such values are reported for each simulation in the results section. the cv values for multiplicative lognormal noise range between 15% and 75%, which are realistic values for cell-to-cell variability according to  <cit>  and to unpublished experiments in our laboratory.

matlab r2010a  was used to implement the study by generating data via in silico experiments and then performing parameter identification. for data generation, lognormal noise with specific entity was applied to the hill function outputs, which were propagated throughout the cascade of interconnected modules in the network. the hill functions were computed as described in eq.1- <dig>  while the lognormal noise was multiplied to the outputs according to eq.5- <dig> and eq. <dig>  the lognrnd function was used to generate independent lognormal noise samples. correlated lognormal noise samples were computed as exp, where vn are gaussian noise samples obtained via the mvnrnd function. for each in silico experiment at the i-th 3oc6-hsl concentration,  <dig>  independent lognormal noise samples were extracted and used to generate synthetic data, which simulate the steady-state output of  <dig>  sampled cells. the lsqnonlin routine was used for parameter estimation. sensitivity analyses were performed by changing parameters individually in the value ranges specified in the results section, while all the other parameters were fixed at their nominal values. parameters were changed by spanning a range of plausible values, according to a number of published  <cit>  and unpublished in vivo experiments carried out by our group. the aim of sensitivity analyses was to evaluate the impact of parameter values on the variability of the parameter estimates.

RESULTS
transfer function identification for a single module
characterization of a tetr/ptet-based not gate
the two-module gene network illustrated in figure 1a was considered as model system and it was analyzed in its default conditions: output <dig> was affected by multiplicative lognormal noise with constant cv, while output <dig> was assumed to be unaffected by noise . hill functions with parameters reported in table  <dig> were used to simulate the behaviour of the two modules  <cit> . cv values were set to  <dig> ,  <dig>  and  <dig> . for each cv value, population-averaged measures of output <dig> are shown, with their 95% confidence intervals, as a function of 3oc6-hsl concentration ; then, population-averaged values of output <dig> are reported in a representative condition  with their 95% confidence intervals derived from the propagation of noise from the upstream module; finally, the population-averaged values are shown and the corresponding fitted curves are also reported . by fitting the population-averaged output <dig> against output <dig> for each cv, the parameters of the not module were estimated and their values are reported in table  <dig>  given a noise model and entity, the cv was computed for the αout, kout and ηout parameters. since in all cases the δ parameter was very low and difficult to accurately estimate  <cit> , it exhibited a very large cv; for this reason, only the variability of the other parameters will be discussed.

α
δ
k
η
the α, δ, k and η parameters correspond to the αin, δin, kin and ηin parameters of the 3oc6-hsl inducible device , αout, δout, kout and ηout of the tetr/ptet-based not gate and of the a/pa-based yes gate  and αout <dig>  δout <dig>  kout <dig> and ηout <dig> of the laci/plac-based not gate . their units are described in the methods section.

 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
0
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
parameters are obtained by fitting population-averaged values of output <dig> as a function of output <dig> for different noise models and entity, applied to output <dig>  the three values reported in each cell correspond to cv =  <dig> ,  <dig> ,  <dig>   and to var =  <dig> ,  <dig> ,  <dig>  . the cv among the estimated parameters is reported in brackets.

first, the tetr/ptet-based not gate will be considered and the results obtained by simulating this system are reported. the variability of parameters was very low, with ηout exhibiting the largest variation . a cv of  <dig> %  was obtained when the same gene network was tested assuming a lognormal noise model with constant variance, set to  <dig> ,  <dig>  and  <dig> , which provides different cell-to-cell variability entities, although not directly comparable to the constant cv model variability levels . this variability value is again very low. the results obtained demonstrate that, in the tested network, population-averaged data can be used to measure the input-output transfer function of the not gate with a low variability, even if input devices affected by significantly different cell-to-cell variability are used. however, it is important to highlight that the measured parameters are not identical to the ones used to generate the data , herein called "true" parameters. the ηout parameter exhibited the highest maximum percentage difference  for lognormal noise with constant cv and represents a relatively low difference; on the other hand, the highest maximum percentage difference observed for lognormal noise with constant var was for kout  and represents a higher difference entity. this high variability in the estimated kout parameter might be due to the high cell-to-cell variability of the 3oc6-hsl-inducible module around the true kout value of the not gate , as opposed to the variability shown in figure 2a. this variability propagates and causes higher cell-to-cell variability in output <dig> when output <dig> is close to kout . the described phenomenon is marked because the not gate is very sensitive to module  <dig> output variation, that is, input values similar to the kout parameter are reached at very low 3oc6-hsl concentrations. this situation is sometimes desired to create switches with steep responses  <cit> , but when the input device is affected by large-entity noise at low-induction levels the not gate could propagate and amplify this noise and the transfer function parameters of the not gate, estimated from central tendency measures, would also be affected. the measurement of the steady-state transfer function of highly-sensitive switches with tuneable upstream modules also results in the inability to span their full activity range, that is, output <dig> could never reach its maximum value δout + αout even for very low output <dig> values. in the configuration presented in figure 2b,c the activity range of the not gate is almost fully covered by output <dig>  but for low output <dig> values the activity is already decreasing; this effect can make the estimation of transfer function parameters difficult in real experiments, where the number of data points might be limited. the described effects are widely known and drive the choice of suitable input devices whose activity range matches the activity range of the device of interest they are supposed to drive  <cit> .

characterization of a laci/plac-based not gate
we performed the same analysis described above considering a not gate with much lower sensitivity  to the input module. the variability entity of estimated parameters is very low and the maximum percentage difference with true parameters is significantly lower  than for the tetr/ptet-based not gate, yielding a cv of  <dig> %  and  <dig> %  in the constant cv and var conditions, respectively. the fitted curves are reported in additional file 1: figure s <dig> and figure s <dig>  even if this difference is lower, this circuit highlights another widely known limit in matching input-output activity ranges; in fact, the lower part of the not gate transfer function is not observable, since output <dig> cannot reach the required maximum activity . as explained above, this effect can complicate the identification of transfer functions in real experiments.

characterization of a yes gate
when the not gate is replaced by a yes gate, that is, a device with an opposite logic behaviour, with the same hill function parameters as the tetr/ptet-based not gate , results do not change significantly when compared to the not gate: ηout is the most variable  in the constant cv model condition, while kout has the highest cv  in the constant var model. in both cases variability is very low. the maximum percentage difference between estimated and true parameters is also limited, with maximum values of 25%  and 61% . the fitted curves are shown in additional file 1: figure s <dig> and figure s <dig>  from additional file 1: figure s4b and figure s5b, it is important to highlight that, since the switch is very sensitive to the input device, the lower part of the curve is not fully observable and this results in δout estimates with low accuracy. this problem is analogous to the one observed for the tetr/ptet-based not gate .

sensitivity analysis
the conditions tested so far depicted different effects whose entity depends on the specific network considered, although results do not change by switching the logic of the module of interest from repression to activation. because it is hard to define general rules to analyze the effects of noise in population-averaged input-output measurements, we performed a sensitivity analysis on the two-module network with the tetr/ptet-based not gate to explore the system response for different parameter configurations and to estimate the parameters of highest impact. for each noise model and entity, two parameters were tested: ηout was varied from  <dig>  to  <dig>  and kout from  <dig>  to  <dig>  results for the constant cv noise model are shown in figure  <dig> in terms of cv among estimated parameters and of maximum percentage difference with true value. the variability among the estimated parameters appears not to be significantly correlated with kout variations for all the tested values; in particular, the estimated kout and ηout exhibit a cv between 8% and 15%, while αout has a cv lower than  <dig> % . the maximum percentage difference of estimated parameters shows the same trend as a function of kout, with kout and ηout exhibiting a difference of 20-30%, while αout of less than  <dig> % . when considering the variability of estimated parameters as a function of ηout, the cv among kout and αout appears to be uncorrelated as above, with a cv below 15% and  <dig> %, respectively; conversely, ηout exhibits a linear increase of cv, up to 28% for the tested values of varied ηout . the maximum percentage difference between estimated parameters and true value shows the same trend as above as a function of varied ηout, with a linear trend of ηout reaching 45% for the tested values .

when considering constant var noise model, trends are different . by varying kout values, the cv among estimated parameters is relatively constant for ηout and αout , while the one of kout shows a decreasing trend, which is of relatively low entity, below 12% . the maximum percentage difference shows a similar trend, with kout exhibiting a difference up to 120%, with the other parameters showing a difference below 20% . on the other hand, by varying ηout, the cv among estimated parameters is always relatively low ; in particular, kout decreases from 17%  to about 10%, αout decreases from 4%  to a value below 1%, while ηout shows a u-like trend with a minimum in ηout =  <dig>  . the maximum percentage difference between estimated and true parameters also depicts the same u-like trend for ηout whose difference varies from 55% to less than 2% ; as for the other parameters, the difference in kout is around 60% for all the tested ηout values except for ηout =  <dig>  where the difference is 30%; finally, αout shows a minor difference .

contribution of extrinsic noise
in a realistic framework, noise would also affect output <dig>  to test this condition, lognormal noise with constant cv was applied to output <dig>  and output <dig>  with a correlation coefficient ρ, in the two-module network with the tetr/ptet-based not gate. the results in terms of estimated parameters variability among the output <dig> noise entities are reported in figure 4a. as it was performed above, the maximum percentage difference between the estimated parameters and the true ones was also computed and reported as a function of ρ . for comparisons, the true αout and δout parameters were rescaled as indicated in eq. <dig> to consider the average value of multiplicative lognormal noise which is different from  <dig> . results depict that the variability and percentage difference in ηout and αout are not affected by ρ, showing a constant cv of about 15% for ηout and  <dig> % for αout  and a maximum percentage difference of about 25% for ηout and 6% for αout . on the other hand, considering kout, cv and maximum percentage difference are affected by ρ, both showing a 2-fold decrease from ρ =  <dig> to ρ =  <dig>  in particular, a linear decrease of cv from 10% to 6%  and a decrease of percentage difference from 25% to 12%  are observed.

by assuming a constant var model for output <dig>  and output <dig>  , variability and percentage difference trends are different from the constant cv case . in this case, cv does not show any strong trend as a function of ρ, except for kout which shows a variability decrease from 10% to 6% ; in contrast, the maximum percentage difference between true and estimated ηout parameter shows a 3-fold linear increase, from 10%  to 30% ; kout shows a decreasing trend of high entity, from ~62%  to 30% ; finally, αout does not exhibit specific trends and shows a difference value below 10%.

the same process was performed by considering the yes gate instead of the tetr/ptet-based not gate and the results, shown in additional file 1: figure s <dig>  do not quantitatively change for constant cv noise model , but for constant var noise the maximum percentage difference of all the parameters increases as a function of ρ, while the cv among the estimated parameters shows a low variability, up to 10% .

overall, the presence of an extrinsic component in the total noise can improve the accuracy in the estimation of some transfer function parameters, by decreasing the variability of the kout parameter in different noise model and entity conditions, and by decreasing the maximum percentage difference between estimated and true kout parameter for the not gate; however, the maximum percentage difference of the ηout parameter for the not gate increases for increasing values of ρ and, in the case of the yes gate with constant var noise, the cv of ηout and the maximum percentage difference of all the three parameters increases with ρ. these results demonstrate that changing the logic of the module of interest can affect the overall results when correlated noise is assumed. a possible explanation of these results is that a correlated noise model propagates the variability of output <dig> in a different way as a function of module  <dig> logic. in fact, the cell-to-cell variability observed for ρ =  <dig> decreases for ρ =  <dig>   when considering the not gate with constant var model , while it increases when considering the yes gate . the same trend is also observed for constant cv noise . this effect is probably due to the amplification of noise by the yes gate for increasing correlation values, since ρ> <dig> and module  <dig> has an increasing activity as a function of output1; on the other hand, the not gate decreases the inter-individual variability, since it has a decreasing activity as a function of output <dig>  thus compensating for the noise applied upstream.

input-output function identification for an interconnected network
in contrast to the previous section, where the aim was to identify the transfer function of a single module, in this case the input-output function of a three-module interconnected network  is identified as a black-box, whose behaviour is described by the hill equation :

  output3=δout*+αout*1+kout*3oc6-hslηout* 

where 3oc6-hsl is the input, output <dig> is the output of the whole network and parameters αout*, δout*, kout* and ηout* have the same meaning as in the methods section.

three-module network prediction from individually-characterized modules
we performed simulated experiments where: i) the transfer function of each single module was identified from population-averaged values  and ii) the identified transfer functions were used to predict the black-box input-output function of the interconnected network. this process was repeated for each noise model and entity considered and hill equation parameters were estimated for the black-box transfer function.

considering the two-module networks with tetr/ptet- and laci/plac-based not gates , the parameters reported in table  <dig> were used to generate data, assuming the constant cv and var noise models, only applied to output <dig> . from an experimental point of view, the described procedure aims to simulate the transfer function learning for individual modules via central tendency measures , and the prediction of the population-averaged output of a complex function  built up by interconnecting such modules.

the parameters describing the transfer function of individual modules were obtained previously , while the estimated black-box function parameters are reported in table  <dig> with their cv. in practice, the tetr/ptet- and the laci/plac-based not gate transfer functions were identified assuming the noise model and entity reported in table  <dig> thus obtaining different parameter estimates; then, the black-box transfer function of the three-module network was predicted by using the tetr/ptet- and the laci/plac-based not gate transfer functions with these parameter sets, thus obtaining  <dig> transfer function combinations for each noise model .

 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
parameters are obtained by fitting population-averaged values of output <dig> as a function of output <dig> for different noise models and entity, applied to output <dig>  the  <dig> values reported in each cell correspond to a noise entity  of cv =  <dig> - <dig> ,  <dig> - <dig> ,  <dig> - <dig> ,  <dig> - <dig> ,  <dig> - <dig> ,  <dig> - <dig> ,  <dig> - <dig> ,  <dig> - <dig> ,  <dig> - <dig>   and to var =  <dig> - <dig> ,  <dig> - <dig> ,  <dig> - <dig> ,  <dig> - <dig> ,  <dig> - <dig> ,  <dig> - <dig> ,  <dig> - <dig> ,  <dig> - <dig> ,  <dig> - <dig>  . the cv among the estimated parameters is reported in brackets.

these results depict that the resulting variability is very low, with the highest cv value for kout*, 16% and  <dig> %, in the constant cv noise model and in the constant var model, respectively.

comparison between network predictions from individually-characterized modules and deterministic output of the circuit
as already discussed in the case of the characterization of a single module, the parameters obtained in the previous study can be different from the ones estimated in a deterministic framework , that is, without noise. for this reason, their maximum percentage difference was computed. in both the constant cv and var noise models, the kout* parameter is affected by the highest difference , thus showing a moderately high deviation. conversely, the other parameters give a maximum difference of  <dig> % and  <dig> %, both on ηout*, in the constant cv and var case, respectively. this deviation indicates that, in the investigated system with the specific parameters and noise assumed, the contribution of noise is significant; for this reason, given the knowledge of the real transfer functions of the modules, the input-output function identification of the whole network is affected by a maximum error of  <dig> %  or  <dig> %  if noise is not considered.

αout*
parameters are obtained by fitting deterministic values of output <dig> as a function of 3oc6-hsl.

comparison between network predictions from individually-characterized modules and network output generated in the presence of noise
to extend the study on the three-module network, another simulated experimental study was performed. the parameters of the black-box function predicted from central tendency measures  were compared to the parameters of the black box function simulated by using the network of figure 1h . in the latter case, as indicated in figure 1h, noise was applied to both output <dig> and output <dig>  and the αout*, δout*, kout* and ηout* parameters were estimated from population-averaged output <dig> measures ; only constant cv noise was considered and applied with different entities . in practice, the  <dig> parameter sets combinations reported in table  <dig> were compared to the  <dig> parameter sets combinations reported in table  <dig>  the identification results show that very low variability occurs among the estimated parameters . when comparing the  <dig> parameter sets of table  <dig> to the  <dig> sets of table  <dig> , the maximum percentage difference was  <dig> %  that was observed in the comparison between the condition where noise with a cv of  <dig>  affects output <dig> in the identification step of both the tetr/ptet- and the laci/plac-based not gates , and the network condition in which output <dig> and output <dig> are both characterized by a noise with a cv of  <dig> , which propagates towards output <dig> . this result indicates that if the transfer function of individual modules is identified via central tendency measures data when noise is low  and these learnt functions are used to predict the output of the three-module network, the outputs have a maximum difference of  <dig> %  if the network is affected by a noise of larger entity on both output <dig> and output <dig>  this can be considered as a low-entity difference  when compared to the possible large prediction errors performed when pre-characterized modules are interconnected and tested  <cit> .

 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
parameters are obtained by fitting population-averaged values of output <dig> as a function of output <dig> for different noise models and entity, applied to output <dig>  the  <dig> values reported in each cell correspond to a noise  of cv =  <dig> - <dig> ,  <dig> - <dig> ,  <dig> - <dig> ,  <dig> - <dig> ,  <dig> - <dig> ,  <dig> - <dig> ,  <dig> - <dig> ,  <dig> - <dig> ,  <dig> - <dig> . the cv among the estimated parameters is reported in brackets.

supplementary results are reported in additional file  <dig> where a two-module network including the tetr/ptet-based not gate  is also studied via an analogous procedure and a sensitivity analysis is performed on its structural parameters.

CONCLUSIONS
in this work we have evaluated the contribution of noise in two different situations, via simulated in silico studies.

first, we have tested the identification of an individual module  via an interconnected network composed of two modules. the results highlighted that central tendency measures can be used accurately to summarize the transfer function of the single module, since the estimated parameters are affected by a low cv . however, a larger percentage deviation  is observed when comparing the estimated parameters with the true ones, which generated the data. for these reasons, the expected differences  in transfer function identification when using different input devices upstream are low, while an accurate measurement of the true transfer function requires, in addition, the full knowledge of noise.

all these results have been found to be dependent on the structural parameters of the module of interest and, for this reason, a sensitivity analysis was carried out to elucidate the cv and maximum percentage difference trends as a function of such parameters. on the other hand, the logic of the module of interest was not important in this step, since the replacement of a not gate with a yes gate with the same structural parameters does not change the conclusions. model refinement, including an extrinsic component of noise, also elucidated a trend in cv and maximum percentage difference, which, in this case, are logic-dependent.

for the above reasons, in the considered case studies noise should be included in models if the aim is to estimate the real parameter values of individual transfer functions. this requires the knowledge of noise model, which can be inferred, for example, by flow cytometric analyses. however, if the aim is to characterize and re-use a biological module, noise can be omitted since different noise entities  do not provide significant changes in estimated parameters. as a result, in the tested conditions, the noise of an input module is not responsible for changes in the estimated parameters of the module of interest.

second, we have tested the identification of a black-box input-output function predicted by interconnecting the three genetic modules that were previously characterized in silico, in the presence of noise, via central tendency-based measurements to identify their transfer function. noise entity did not significantly affect the input-output function identification. however, as observed before for the single module identification, noise significantly affects the percentage difference between estimated input-output function and the function obtained in absence of noise .

as a last study involving the black-box input-output transfer function of a three-module network, we compared the black-box function predicted by using the individual modules identified from data generated with different noise entities affecting output <dig>  and the black-box function simulated by using different noise entities affecting output <dig> and output <dig>  a maximum percentage difference of  <dig> % was observed. this has high relevance in the bottom-up design of gene networks with predictable function. in fact, this difference represents the maximum variability, considering noise as the sole variability source, that can be observed between i) the prediction of the black-box function of a network from the knowledge of individual modules and ii) a black-box function that is generated by the same modules, when the noise affecting the identification step is different from the noise in the final circuit context. the changing of cell-to-cell variability entity when the context is different is a common situation in biological engineering, in which characterized modules are re-used in different contexts to engineer complex interconnected networks.

the same results were confirmed on a two-module network, on which a sensitivity analysis is also reported .

as anticipated above, all the obtained results were dependent on the specific network parameters used; for this reason, the conclusions obtained in this work are confined to the topology and parameter ranges here assumed, although the work can be easily extended to study different systems, according to biological engineers' needs.

on the other hand, in the working context described above, the relevance of this study is high in biological engineering, since it can effectively guide the experimental work of systems and synthetic biologists to carry out suitable in vivo measurements  and it can be a crucial tool to accurately distinguish actual non-modular and unpredictable phenomena from the effects due to noise in the interconnection of biological parts to construct complex gene networks from the bottom-up. as a practical example, in one of our experimental studies  <cit>  we found a cv of 44%  when the transfer function of a tetr/ptet-based not gate was identified from population-based measurements, performed via different input devices assembled upstream. the not gates drove the expression of a reporter gene to easily visualize the output. experimental measurements consisted in population-based fluorescent protein quantification in recombinant cultures. a microplate reader was used to incubate cultures and perform absorbance and fluorescence measurements. considering the exponential growth phase of bacterial cultures, absorbance and fluorescence time series were processed to obtain an individual value representing the activity of the not gate device, expressed as relative promoter units , in response to different input devices and induction levels. although the cell-to-cell variability was not experimentally measured for the input devices outputs, we can conclude that the cv among the estimated kout parameters of the not gate could not be caused by the sole noise , thus highlighting a non-modular behaviour of the used components, although, in principle, part of the total variability could be caused by heterogeneity of cells. by refining the study with the characterization of the cell-to-cell variability of each individual module, the knowledge of the true not gate parameters can be obtained, since the ones estimated in the presence of noise can deviate from the true ones . as gene networks with the architecture studied in this work are widely used in synthetic biological circuits, the proposed approach can be useful to support the characterization and re-use of modules in different circuits and to support the prediction of interconnected circuit output.

it is worth noting that cell-to-cell variability is a very complex element, which  may be dependent on the specific strain and environmental context  <cit> , dynamics of gene expression and specific biological processes  <cit> . finally, cell-to-cell variability may not be solely explained by intrinsic and extrinsic noise, but it might depend on bistability effects in gene regulatory networks  <cit>  or on the evolutionary context that has been found to significantly affect the quantitative behaviour of single cells in several experimental studies, by increasing the failure rate of a biological function  <cit> .

competing interests
the authors declare that they have no competing interests.

authors' contributions
np, lp and pm designed the study. np performed the study. np, lp, sz and pm analyzed the data. np, lp and pm wrote the paper.

supplementary material
additional file 1
supplementary figures, results and tables.

click here for file

 declarations
publication of this article has been funded by the university of pavia.

this article has been published as part of bmc systems biology volume  <dig> supplement  <dig>  2015: proceedings of the italian society of bioinformatics : annual meeting 2014: systems biology. the full contents of the supplement are available online at http://www.biomedcentral.com/bmcsystbiol/supplements/9/s <dig> 
