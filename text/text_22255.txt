BACKGROUND
the recent advent of high-throughput sequencing technologies has enabled genome-wide studies of dna-binding proteins at high resolution. in such studies the protein of interest is isolated together with a fragment of bound dna, which is then separated from the protein and sequenced. this approach has been used to investigate several different proteins including the positioning of nucleosomes  <cit> . for this type of experiment dna is typically digested with micrococcal nuclease  before isolating nucleosome-sized dna fragments  that are then sequenced. this is the application considered here. each nucleosome is expected to produce several sequence reads of approximately  <dig> -  <dig> bp from both strands. this leads to peaks in read density on either side of the nucleosome with the extent of the peaks and the distance between the two peaks determined by the length of dna fragments and binding site. since the dna fragments produced by an mnase digest of nucleosomes are selected to be similar in length to the actual binding site the resulting peaks in read counts are expected to be relatively narrow and peaks on forward and reverse strand should be separated by a region that corresponds approximately to the nucleosome bound dna. this region is expected to be depleted of sequence reads . however, the distance between adjacent nucleosomes is usually short  and this may lead to overlap between peaks. when analysed at low resolution this can lead to the detection of extended enriched regions rather than individual nucleosomes.

in a related type of experiment a subset of nucleosomes is targeted through chromatin immunoprecipitation  followed by high-throughput sequencing of chip fragments  <cit> . this technique, commonly known as chip-seq, has also been used to investigate the binding of transcription factors  <cit> . due to the relatively short binding site of most transcription factors these studies typically produce wider, relatively isolated peaks in read counts compared to those obtained from nucleosome sequencing.

the increasing number of chip-seq and nucleosome positioning studies has led to the development of various approaches to analyse these data. the analysis typically starts by mapping short sequence reads to a reference genome, ignoring reads with non-unique alignments. to identify protein binding sites from these mapped reads, many commonly used methods generate a strand-independent profile of windowed read counts by recording the total number of reads on both strands that fall into a sliding window, or alternatively the number of overlapping extended reads for each position in the genome  <cit> . in both cases the height of the read count profile corresponds to the total number of reads in the window, irrespective of strand. the read extension method implicitly uses separate windows for the two strands, combining the sequence reads in both windows into a single read count. explicitly using two distinct windows to construct the read count profile allows for the inclusion of information about the length of the protein binding site  <cit> . peaks in the resulting read count profile are usually assessed for significance based on total read counts compared to a control sample  <cit> , background model  <cit>  or permutation of observed read counts  <cit> . the use of hidden markov models   <cit>  and kernel density estimators  <cit>  has been suggested as an alternative way to identify significant peaks in the read count profile. although this strand-independent approach to chip-seq analysis has been used frequently with apparent success, it ignores the fact that dna binding proteins are expected to generate a similar number of reads on both strands adjacent to the binding site.

the need for a new approach to chip-seq analysis that incorporates the characteristics of protein binding sites has been recognised and has led to the development of new strand-specific methods. kharchenko et al.  <cit>  suggest three different approaches to utilise strand-specific read counts that outperform established strand-independent methods  <cit> . the sissrs algorithm of jothi et al.  <cit>  considers the difference of read counts on both strands in a sliding window and locates potential protein binding sites by identifying sign changes in this net read count. although these methods were developed with transcription factor analysis in mind, the methods presented in  <cit>  are general enough to be extended to a nucleosome related analysis. the sissrs algorithm assumes that binding sites are isolated, i.e., peaks from neighbouring binding sites do not overlap. this is unlikely to be true for nucleosomes since they are expected to be located close to each other, which restricts sissrs to the detection of extended regions of enrichment. this makes sissrs unsuitable for the identification of individual nucleosome positions. a similar issue arises with the method proposed by zang et al.  <cit> . although their method was specifically designed to identify histone modifications from chip-seq data it focuses on the detection of broad regions of enrichment rather than individual nucleosome positions. spyrou et al.  <cit>  propose a strand specific hmm analysis of chip-seq experiments and demonstrate its utility on transcription factor and histone modification data. although spyrou et al. make a deliberate effort to obtain results at high resolution the hmm framework limits the resolution that can be achieved by this method, which may be insufficient to distinguish between adjacent nucleosomes.

when sequencing nucleosomal dna, either to determine nucleosome positioning or to identify specific histone modifications, it is important to realise that the binding site is substantially longer than for a typical transcription factor. while it may be acceptable to ignore the expected gap between peaks on forward and reverse strands when the binding site is small compared to the window used, as is often the case for transcription factor binding sites, this is not necessarily true for nucleosomes. some studies choose the size of the sliding window to be the average dna fragment length  <cit>  while others choose a smaller window of  <dig> bp  <cit> . it should be noted that these window sizes are substantially larger than the transcription factor binding sites in question, but similar in length to or shorter than nucleosome-bound dna. the use of  <dig> kb windows  <cit>  or even  <dig> mb windows  <cit>  has been suggested. although the increased window size alleviates the need to model the length of binding sites explicitly, it also leads to a notable decrease in resolution.

to locate nucleosomes at high resolution we propose to use an explicit model of protein binding site characteristics and of the resulting read patterns. this requires the model to be adjusted to the details of the experiment under consideration. in particular the impact of changes to the protocol used to isolate and purify nucleosomes has to be considered carefully. we demonstrate our approach to the high resolution analysis of chip-seq experiments by introducing chipseqr, an algorithm designed for the identification of nucleosomes. this method provides a number of parameters that allow it to be adjusted to different types of experiments but here we focus on the analysis of end-sequenced mononucleosomes after digestion with mnase. chipseqr is applied to simulated data on which it is shown to identify nucleosomes at high resolution while achieving better sensitivity and specificity than alternative methods. the favourable performance of chipseqr is confirmed through the application to end-sequenced mononucleosomes.

RESULTS
algorithm
background distribution of sequence reads
to reliably identify nucleosome positions it is necessary to model the read counts associated with a binding event as well as read counts in the absence of protein binding. a frequently used assumption is that background sequence reads, which are unrelated to binding events, are independently and uniformly distributed throughout the genome  <cit> . this implies that the number of these background reads xbg starting at each position of the genome follows a poisson distribution with constant rate parameter λ. examination of the read density in negative control samples suggests a heterogeneous distribution of background reads  <cit> . to allow for this heterogeneity the use of a background model that incorporates changes in read density by assuming that λ follows a gamma distribution has been suggested by ji et al.  <cit> .

here we propose a different approach to address this problem. instead of estimating the background read density for the entire genome at once we estimate the local background read density in a window of width 2wbg +  <dig>  consider ybg ~ poisson), the number of reads starting at position i. then the number of background reads in a window centred at position i is

  xbg=∑j=i−wbgi+wbgybg~ poisson ) 

with λbg=∑j=−wbgwbgΛbg. for each position i the strand specific local background rate can be estimated as λ^bg=xbg, where xbg is the observed number of sequence reads in window i on the relevant strand. this background model adapts to locally observed read densities without imposing a distribution on λ.

confirming the observations made by kharchenko et al.  <cit>  we find that the background read density includes large peaks that are seemingly unrelated to the presence of nucleosomes. while the background estimation procedure described above adapts to changes in the background rate, the presence of large isolated peaks will lead to overestimation of the read rate for the surrounding area. a robust estimate of the background read rate is obtained by limiting the change in read rates between adjacent, non-overlapping, windows. if λ^bg is positive we choose the robust estimate λ˜bg as the largest value j such that j≤λ^bg and p≤γ, for an appropriately chosen probability λ.

nucleosome model
a nucleosome will produce several dna fragments in the sample. during the sequencing process short reads are produced from the 5'-ends of both strands of the dna fragment population. the start position of sequence reads generated from this population corresponds to the start and end positions of dna fragments in the reference genome. although these may vary due to differences in fragment length and relative position of the nucleosome within the fragment, all read start sites will be located in proximity to the nucleosome but not within the strech of histone bound dna itself. this leads to a region of increased read density on the forward strand upstream of the nucleosome which is mirrored by a region of increased read density on the reverse strand downstream of the nucleosome. the nucleosome, located between the two peaks in read density, is relatively depleted of sequence reads. this creates a distinctive pattern that can be partitioned into three regions: forward support , binding  and reverse support  region . note that the forward and reverse support regions only cover the respective strand, allowing for overlapping peaks from neighbouring binding sites.

consider a binding site of length b = 2wbind +  <dig> starting at position i containing xbind sequence reads from both strands, a support region on the forward strand of length s = 2wsup +  <dig> starting at position i - s containing xfwd forward strand reads and a support region on the reverse strand of the same length starting at position i + b containing xrev reverse strand reads. here we assume that the read counts in these regions follow poisson distributions, i.e., xregion ~ poisson), where region is one of fwd, bind or rev. using the same assumptions as for the background distribution we consider xregion to be the sum of wregion random variables yregion  ~ poisson).

scoring potential nucleosome positions
if a nucleosome is starting at position i the following three relations should hold: λfwd > λbg, λbind < λbg, λrev > λbg. we assess these relations for each potential nucleosome position based on a likelihood ratio statistic, wregion. this statistic is computed for each of the three regions of the potential nucleosome position, comparing the estimated read rate in the region to the estimated local background rate . if a nucleosome starts at position i one would expect λfwd and λrev to be equal. to account for this and to avoid inflated values of wfwd in cases where a peak in read density in the forward support region is not matched by a comparable peak in the reverse support region, we use the truncated estimate

  λ˜fwd=max{j: <dig> <j≤λ^fwd and p≤γ} 

for a suitably chosen γ to calculate wfwd. the truncated estimate λ˜rev is defined similarly.

for each of the three regions a score sregion is calculated. for the two support regions the score ssup, sup ∈ {fwd, rev}, is defined as

  ssup={+wsup,if λ˜sup>λ˜bg−wsup,otherwise 

and for the binding region as

  sbind={−wbind,if λ^bind >λ˜bg+wbind,otherwise 

the three region scores for each potential nucleosome are combined into a single nucleosome score

  s=sfwd+sbind+srev. 

note that this score is only meaningful if there is at least one read in each of the two support regions and λ˜bg> <dig> 

significance test
to assess the significance of nucleosome scores the distribution of s under the null hypothesis that no nucleosome starts at position i has to be determined. the nucleosome score for each position in the genome is the sum of the scores for the three regions of the potential nucleosome position ) and the score for each region is derived from the likelihood ratio statistic wregion  and ). if the null hypothesis is true wregion~˙χ12 and thus sregion~˙n. this might suggest the use of s∼n to model the distribution of binding site scores under the null hypothesis. however, it is important to realise that, even under the null hypothesis, sfwd and srev are unlikely to be independent due to the use of truncated rate parameter estimates, and the asymptotic results may not hold. to avoid misleading p-values that may result from the use of an incorrectly specified null distribution we generalize the above model to s~n, where μ¯ is the sample median of the nucleosome scores and σ is estimated from the observed nucleosome scores. to obtain a good fit for the null distribution, and thus reliable p-values, it is necessary to identify a subset of scores that is representative of the null hypothesis.

observing that the presence of nucleosomes will lead to larger nucleosome scores we truncate s at the τth and 50th percentile, where  <dig> ≤ τ <  <dig> is chosen to exclude outliers in the lower tail while retaining a sufficiently large number of observations. this ensures that the vast majority of scores relating to protein binding events have no influence on the parameter estimation while also guarding against extreme values in the lower tail, which are observed when calculating nucleosome scores for positions that place unusually large numbers of sequence reads in the binding region. a maximum likelihood estimate for σ is obtained by fitting a truncated half-normal distribution to the selected subset of nucleosome scores.

the p-values for all observed nucleosome scores are calculated based on the estimated null distribution and corrected for multiple testing. to control the false discovery rate  we use a benjamini-hochberg procedure  <cit> . if the data contain many nucleosomes it may be beneficial to modify this procedure to account for the estimated proportion of true null hypotheses. this is done using the αafdr approach discussed in  <cit> , where it is shown to be equivalent to the procedure proposed by storey et al.  <cit> .

testing
to assess the performance of our method we compared it to a number of other peak-finding methods on simulated data. the three methods presented in  <cit> , mirror strand peaks , mirror tag correlation  and window tag density , were chosen for comparison because they allow for strand specific peaks in read counts and employ different strategies to handle the expected gap between peaks. briefly, wtd calculates a binding score based on the number of forward and reverse strand tags within a window upstream and downstream of a potential binding site. while this utilises the fact that a protein binding event should produce a peak in forward strand read counts upstream and a peak in reverse strand read counts downstream of the binding site, wtd does not require the two peaks to be similar in magnitude nor is the gap between peaks considered. mtc is similar to wtd but uses the correlation between forward strand and reverse strand reads to introduce a measure of similarity between the two peaks. sequence reads close to the centre of the binding site are ignored when calculating the correlation coefficient which effectively introduces a gap between the two peaks. a gaussian smoothing kernel is used by msp to estimate local read densities for both strands and binding sites are required to lie between peaks of comparable magnitude. the r implementation of these methods provides the option to estimate the window size from the cross-correlation between the two strands. we found that this does not produce satisfactory results for the nucleosome data under consideration and used a  <dig> bp window instead. unlike the methods proposed by kharchenko et al. genetrack  <cit>  was specifically designed for the detection of nucleosome positions. like msp, genetrack uses a gaussian kernel to smooth read counts. the algorithm then proceeds to score each peak based on its height and reports the highest scoring set of non-overlapping peaks. genetrack makes no attempt to assess the significance of peaks, which results in a high number of nucleosome predictions but is likely to lead to many false positives if the data contains regions that are depleted of nucleosomes. to fairly evaluate genetrack's performance relative to methods that control the false discovery rate we choose a cut-off that leads to a similar number of significant predictions as the one produced by chipseqr. a further peculiarity of genetrack is that nucleosome predictions are centred on the peak in read counts. this results in predictions that are shifted by approximately half a nucleosome length compared to the actual position of the nucleosome. this inaccuracy was corrected for the purpose of this comparison. chipseqr was used with a binding region of  <dig> bp, support regions of  <dig> bp and a background window with w =  <dig>  these settings were found to perform well on real data  and were used here for consistency.

all methods were applied to simulated data  and various performance metrics are reported. the number of predicted nucleosomes at each level of coverage  suggests very low sensitivity for wtd and mtc. at the lower coverage levels these methods failed to detect any nucleosomes and even for the  <dig> million read samples predicted nucleosome numbers remained very low. better sensitivity was achieved by msp and chipseqr. the lack of a significance threshold for genetrack makes it difficult to assess sensitivity in a meaningful way. however, a comparison of the percentage of stable nucleosomes identified suggests that genetrack's sensitivity is comparable with the one achieved by msp at lower coverage levels and that it lies between the sensitivity of chipseqr and msp for the  <dig> million read samples.

*cut-off was chosen to give the same number of significant predictions as chipseqr.

for each sample the number of predicted nucleosomes is reported. the total number of significant predictions for each level of coverage is reported together with the proportion of stable nucleosomes that were identified in all three samples as well as a measure of repeatability of stable nucleosome predictions between samples .

it may be instructive to consider the number of stable nucleosomes detected by each of the methods. for this purpose we considered a stable nucleosome to be detected if a given method produced a nucleosome prediction within  <dig> bp of the nucleosome centre. although nucleosome predictions not corresponding to stable nucleosomes are not necessarily less valid, it is desirable to detect stable nucleosomes because their stability is likely to be related to a regulatory mechanism. since the positions of these nucleosomes are stable it is straightforward to determine the distance between the location of the stable and predicted nucleosomes. msp, genetrack and chipseqr produced a relatively large number of predictions at all coverage levels and identified increasing numbers of stable nucleosomes with increasing coverage. however, chipseqr consistently produced more stable nucleosome predictions than any of the other methods, indicating that it provides the best sensitivity of the methods in this comparison . assessing the specificity of the nucleosome predictions is less straightforward since many nucleosomes do not have well defined positions and therefore predictions cannot be classified as incorrect in the usual sense. instead we again focused on the methods' ability to identify stable nucleosomes. a method that accurately locates nucleosomes rather than random positions along the genome is expected to predict the location of stable nucleosomes with high confidence as these should be relatively easy to identify due to the well defined peaks associated with them. as the stability of nucleosomes decreases the corresponding reads are increasingly dispersed and peaks become less obvious. to assess how well the different methods are able to separate stable nucleosomes from other nucleosomes we considered all nucleosomes predicted from the third  <dig> m read sample by each method and rank predictions by score. figure  <dig> shows the fraction of predicted stable and non-stable nucleosomes considered significant with varying threshold. from this it is apparent that chipseqr not only identifies more nucleosomes than the other methods, it also is more reliable in terms of locating stable nucleosomes. although genetrack produces a large number of nucleosome predictions, stable nucleosomes are not well distinguished from other nucleosomes.

to further investigate how reliably different methods identify stable nucleosomes we consider the stable nucleosomes identified from different samples at the same level of coverage . for each of the three samples the stable nucleosomes identified by a given method are recorded such that xi =  <dig> when the jth stable nucleosome was detected in sample i and  <dig> otherwise. we assess a method's ability to reliably identify the same stable nucleosomes from different samples by computing the total correlation ctot  <cit>  between the three samples. this provides a measure of the information shared between the samples, i.e. it will be maximised if the same set of nucleosomes is identified for each sample. to obtain a measure of repeatability that is comparable between methods and different levels of coverage regardless of the number of identified nucleosomes, we divide ctot by cmax which is calculated as the total correlation of a permutation of x <dig>  x <dig>  x <dig> that maximises the number of repeated nucleosome detections. this normalises the repeatability such that it lies in  <cit> . over 50% of the stable nucleosomes predicted by chipseqr from the  <dig> m read samples were successfully identified in all three samples which corresponds to a repeatability of  <dig> . none of the other methods achieved a repeatability of more than  <dig> . it is worth noting that while msp produces a relatively large number of predictions they tend to differ substantially between samples, leading to a very low repeatability.

another important performance measure is the resolution at which predictions are made, i.e., how close predicted nucleosome positions are to actual nucleosome locations. peak-finding algorithms like the ones considered here typically involve a smoothing step to elucidate peaks. this comes at the cost of reducing the resolution of the raw data. to measure the resolution achieved by the four methods in this comparison we examined the distance between predicted stable nucleosomes and the underlying stable nucleosome positions . the best resolution was achieved by genetrack followed by mtc and chipseqr. while wtd appeared to produce predictions at an acceptable resolution, the low sensitivity of this method made an accurate assessment of the resolution difficult. the resolution of msp was clearly the lowest in this comparison, limiting its usefulness for localising individual nucleosomes.

characteristics of predicted nucleosome sites
to further investigate the utility of the proposed method we applied it to end sequenced mononucleosomes from arabidopsis thaliana. sequence reads were generated through solexa sequencing of dna fragments. mononucleosome-sized dna fragments were selected for sequencing after mnase digestion. approximately  <dig> million uniquely mapped reads were used for the analysis.

the nucleosome model and scoring procedure described above require the specification of several parameters. we conducted computational experiments to investigate the influence of these parameters on the performance of chipseqr  and chose a background window of  <dig> bp, i.e. w =  <dig> as well as two separate sets of parameters  for the length of the binding and support regions to investigate the properties of nucleosomes predicted from end-sequenced mononucleosome fragments. the first set of parameters only produced about  <dig>  significant nucleosome predictions while the second set identified  <dig>  nucleosomes. an example of nucleosome predictions in a selected region of the genome is shown in figure  <dig>  characteristics of interest are the distance between predicted stable nucleosomes, the location of stable nucleosomes relative to annotated genes and the presence of dna sequence motifs within nucleosome sequences.

the distribution of distances between adjacent predictions should provide some insights into the distribution of stable nucleosomes throughout the genome. note that, while individual nucleosomes along the same chromosome cannot overlap within a single cell, the position of nucleosomes is expected to vary between cells or even between different copies of a chromosome within the same cell to some degree. this may lead to overlapping nucleosome predictions if there is sufficient evidence to support these alternative positions. figure  <dig> shows the distribution of distances between adjacent nucleosome predictions for b =  <dig> and s =  <dig>  this distribution is characterised by a relatively large number of distances that are shorter than  <dig> bp followed by only ten cases with distances between  <dig> and  <dig> bp. the majority of distances between nucleosomes are larger than  <dig> bp. this suggests that some adjacent predictions correspond to adjacent stable nucleosomes while others have larger gaps between them. the relatively high abundance of overlapping predictions and the consistently small difference in position between them may represent some uncertainty about the location of these nucleosomes but also suggests that positioned nucleosomes are more likely to exhibit small rather than large changes in position depending on cell state. this observation is consistent with the findings of albert et al.  <cit>  regarding the translational and rotational settings of nucleosomes.

previous studies of nucleosomes in various organisms have found evidence for nucleosome positioning relative to transcription start sites  <cit> . to investigate whether there is evidence of positioning relative to the 5' and 3' end of annotated genes in the two sets of predicted nucleosomes, we aligned the transcription start sites  and transcription end sites  of all annotated arabidopsis genes and determined the number of predicted nucleosomes centred at each position within  <dig> kb of the respective feature . there is clear evidence for positioned nucleosomes at both ends of genes. the + <dig> nucleosome is followed by a series of positioned nucleosomes of decreasing stability. the region upstream of the + <dig> nucleosome is depleted of nucleosomes. there is some evidence for nucleosome positioning upstream of the nucleosome free region  although this is much weaker than for the + <dig> nucleosome. the nucleosome positions predicted with b =  <dig> show some evidence of a nucleosome located in the nfr similar to the - <dig> nucleosome reported for some genes in humans  <cit> .

it has been suggested based on theoretical considerations as well as empirical findings that stable nucleosomes are associated with a periodic pattern of dinucleotides  <cit> . to assess whether similar patterns play a role in nucleosome positioning in arabidopsis and whether they can be detected based on the stable nucleosomes predicted by our method, we used the over  <dig> non-overlapping nucleosome positions identified with b =  <dig>  s =  <dig> to investigate the properties of nucleosome sequences. to this end the position specific frequency of all dinucleotides was determined in a ± <dig> bp window around the centre of predicted nucleosomes .

dinucleotide frequencies throughout the predicted nucleosome sequences differ markedly from genome-wide frequencies while there is little evidence for this outside the nucleosome region ). note that the a/t bias of mnase leads to a notable increase in the frequency of related dinucleotides in the flanking regions of predicted nucleosomes. studies in yeast and drosophila have reported a periodic pattern of a/t and c/g dinucleotides in nucleosome sequences  <cit> . we observe a similar pattern that is dominated by alternating aa/tt and cc/gg dinucleotides ). these dinucleotides correspond to a subset of previously reported nucleosome-associated patterns. this may be an indication that such patterns vary between species as suggested by kogan and trifonov  <cit> . they also find aa to be the dominant pattern associated with periodic dinucleotide signals at gene splice sites in arabidopsis. the periodic patterns observed in nucleosome binding dna are accompanied by an increase in g/c content compared to the genome average ), which is consistent with previous observations in yeast  <cit>  and humans  <cit> .

verification of predicted nucleosome positions
nine genomic regions containing  <dig> nucleosome predictions with different levels of confidence were selected for qpcr verification. out of the  <dig> predicted nucleosomes  <dig> were verified .

the dna abundance profiles obtained through qpcr show several well defined peaks. many of these correspond to predicted nucleosomes while others appear to suggest the presence of adjacent nucleosomes that were not predicted by the initial analysis. to investigate this further we identified peaks in dna abundance that may correspond to positions of additional nucleosomes that do not overlap predicted nucleosomes and tested them for significance using the same procedure as above. this results in the detection of additional nucleosomes in  <dig> of  <dig> potential nucleosome positions. the remaining four locations are characterised by flat dna abundance profiles and may correspond either to nucleosome free regions or areas of delocalised "fuzzy" nucleosomes .

implementation
an r package implementing the method described here is freely available from bioconductor and from the authors' web page at http://www.bioinformatics.csiro.au/chipseqr together with simulated datasets.

discussion
unlike the majority of existing methods for the analysis of chip-seq experiments the novel approach presented here is suitable for the detection of nucleosome positions. the explicit modelling of nucleosomes increases the sensitivity and makes it possible to detect their positions at low coverage levels. combined with the relatively small amount of smoothing required for the analysis this enables chipseqr to reliably identify nucleosomes at high resolution. this is especially important for the analysis of nucleosome positions and histone modifications since this typically requires the sequencing of a much larger proportion of the genome than would be required for a transcription factor study, which results in lower coverage for the same amount of sequencing. furthermore, nucleosome studies aim to distinguish binding sites that are usually located close to each other and may vary in location throughout the sample. it is therefore important to identify binding sites at high resolution and to allow for partially overlapping peaks in read counts associated with adjacent binding sites.

high resolution and repeatability
although all methods compared here use strand specific read counts and all except wtd are able to handle overlapping peaks from adjacent binding sites only chipseqr achieved good sensitivity and high resolution. the high resolution achieved by chipseqr is further highlighted by the detection of periodic dinucleotide patterns in the dna sequence of predicted binding sites. strong evidence of these patterns was found without any further sequence alignment, suggesting that the predicted positions of stable nucleosomes are highly accurate. this result is also indicative of high specificity since false positives would dilute any sequence motifs. it should be noted that all methods in the comparison would benefit from a further increase in coverage. we expect that differences in performance will diminish as coverage saturates but achieving sufficient coverage to reach saturation is still costly which makes it desirable to obtain reliable results from low coverage data.

another performance measure of interest is an algorithm's ability to produce consistent results for repeated experiments. this is of particular interest when low coverage data is used since this is likely to result in the prediction of only a subset of all binding sites. despite this one would like to obtain results that do not depend too much on the details of a particular sequencing run, i.e., the analysis should be robust towards moderate changes in read position. this is important to enable researchers to draw reliable conclusions from the analysis that can be expected to hold when the experiment is repeated. although all methods in the comparison perform better than random, indicating that they all provide a core of consistently predicted nucleosomes, chipseqr provides substantially higher repeatability than any other method at all levels of coverage.

analysis of mononucleosomes
the favourable performance of chipseqr observed in the comparison on simulated data is confirmed by its application to the mononucleosome dataset. predicted nucleosomes are found close to transcription start and transcription end sites that are known to be associated with stable and phased nucleosomes  <cit> , suggesting that chipseqr is well suited for the detection of moderately well positioned nucleosomes. this is confirmed by the results of the qpcr verification of selected nucleosome predictions. considering the verification results it is evident that predicted nucleosomes corresponding to pronounced peaks in qpcr measurements, which are likely to represent stable or phased nucleosomes, were confirmed reliably. closer inspection of the two unverified nucleosome predictions reveals that one of them is located within  <dig> bp of a significant peak in dna abundance . it seems likely that the location of this nucleosome would be predicted more accurately with increased coverage. it should be noted that the peak in qpcr measurements appears to be wider than expected for a stable nucleosome and may suggest the presence of an alternative nucleosome position in the sample. the other unverified nucleosome position is located at what appears to be the start of a "fuzzy" nucleosome region. this makes it difficult to assess the exact location with any method. we note that the analysis of the short read data produced three distinct peaks in the binding site score located close to the predicted binding site . this is consistent with the presence of overlapping nucleosome positions that one would expect from delocalised nucleosomes.

the regions chosen for qpcr verification were selected to encompass predictions with a range of fdrs. the fact that all low confidence predictions were verified suggests good specificity even for relatively high values of the nominal fdr. consequently the fdr cut-off chosen for the initial analysis may be considered conservative.

influence of model parameters
when discussing the performance of chipseqr it is important to realise that this depends on a number of parameters. apart from the coverage provided by a given dataset, some of the model parameters will impact on the performance characteristics. choosing b, the length of the binding region, close to the actual binding site length will result in high resolution and is expected to improve specificity. however, this will reduce the method's ability to detect less stable binding sites, thus reducing sensitivity. such unstable binding sites can be detected more reliably if b is reduced while the length of the support regions is increased. this increases sensitivity but may lead to reduced resolution. it should be noted that the choice of b =  <dig> that was determined to be optimal for the data considered here is less than the  <dig> bp that may be expected for a nucleosome. however, this reduced binding region is consistent with the presence of alternative preferred positions of a stable nucleosome located ± <dig> bp from a central position that have been observed previously  <cit> .

another important factor is the estimation of the background read rate λbg. there are at least two different approaches to the estimation of this parameter. the one taken here relies on choosing a large window relative to the binding site which is applied to the same sample that contains the binding sites. the relatively large size of the background window results in an average read rate close to a base level even if there are binding sites within the window. however, the presence of binding sites will increase the estimated background rate above the actual background, thus producing conservative binding site scores. an alternative approach would use a separate control sample to assess the background read rate. this has the potential to produce more accurate results and is generally recommended but we note that it may be difficult and costly to obtain good control samples for this purpose. even when a suitable control sample is available the issue of an appropriate normalisation method for this type of data has not been settled . we therefore consider the single sample method presented here to be more practical at the moment, especially for nucleosome sequencing.

CONCLUSIONS
the model proposed here was specifically designed for the analysis of end sequenced nucleosomes after mnase digestion. although several chip-seq analysis algorithms are available for tasks like this they are typically designed for the analysis of transcription factor binding. our analysis demonstrates that it is beneficial to take the substantial differences between transcription factor binding and nucleosome positioning experiments into account explicitly. although some existing methods may be general enough to handle both transcription factor chip-seq and nucleosome sequencing data they will be outperformed by more specialised methods, especially on low coverage data. although genetrack was designed for the analysis of nucleosome experiments and has been used for this purpose with apparent success  <cit>  it does not take advantage of the characteristics of nucleosome experiments. this results in a performance similar to the general chip-seq methods.

the main advantages of the model presented here are the high resolution of nucleosome predictions and its ability to operate on low coverage data. this makes it especially suitable for the analysis of nucleosome positions in situations where it is difficult to obtain high coverage, i.e. many reads per nucleosome position, because the genome under consideration is large or the sample contains a mixture of many cells .

the most important parameters of our model, b and s, are closely related to the underlying biology and length of dna fragments used for sequencing. this makes chipseqr a flexible and versatile method for the analysis of nucleosome positioning and makes it possible to adapt the method to a range of different experiments. we have demonstrated its favourable performance in the context of nucleosome positioning experiments and similar performance is expected for other nucleosome related experiments, such as histone modification studies. more generally it should be possible to apply the approach demonstrated here to other chip-seq experiments. we note however that the binding site model should be adjusted to accommodate the differences in experimental procedures, especially when dna is fragmented through sonication rather than mnase digestion.

