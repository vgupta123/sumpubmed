BACKGROUND
chromosomal abnormalities such as loss-of-heterozygosity  or genomic copy-number changes are frequent in tumour cells. loh occurs when a heterozygous marker in germline dna of an individual becomes homozygous in cancer dna of the same individual. this event is the result of losing one allele of a chromosomal region while the other allele is retained, duplicated , or multiplicated . in the same way, chromosomal amplifications can be unbalanced  or balanced . detecting chromosomal abnormalities is important in cancer research as it allows the discovery of chromosomal regions possibly harbouring cancer-related genes such as tumour suppressor genes or oncogenes. it may also be used to identify genomic markers  that may distinguish between clinically important stages in the disease course, e.g. markers of metastasis or markers of treatment response.

single nucleotide polymorphisms  account for most of the genetic variation in the human genome. they occur every  <dig> to  <dig> bases along the 3-billion-base human genome  <cit> . different techniques  have been developed in order to genotype thousands of snps distributed all over the genome at the same time. in this paper, we focus on affymetrix snp-arrays, but note that the method we have developed can be applied to data obtained from other experimental platforms as well.

the affymetrix technique is based on genomic hybridization to synthetic high-density oligonucleotide microarrays. each of the two alleles of a snp is represented by  <dig> oligonucleotides  and hybridization  intensities are measured for all probes in the probeset  <cit> . different algorithms  <cit> , have been developed to genotype correctly snps from the affymetrix intensities. a very high accuracy and concordance of genotype calls is observed for normal samples as the ploidy is always two. however, it is much more diffcult to genotype cancer samples due to genomic alterations that might change the ploidy number.

hidden markov models  have been used extensively to recover unobserved underlying states that give rise to an observed sequence of data. in relation to loh analyses hmms have been used to infer whether an allele is lost or retained  from genotype data  <cit> . lin et al.  <cit>  and koed et al.  <cit>  developed hmm methods that score the presence of allelic imbalance mainly based on converted snps . in  <cit> , beroukhim et al. describes a hmm-based method to identify loh from unpaired tumour samples. they use the genotype calls to identify whether a snp marker is in a retention state or in a loh state. by integrating copy-number analysis into the analysis, they can distinguish loh from allelic imbalance. however, the loh analysis and the copy-number analysis are performed separately. besides, the loh analysis is highly dependent on the genotype calls even if the possibility of genotyping errors is taken into account.

hmms have also been used for copy-number analysis. in  <cit> , fridlyand et al. developed a hmm to analyse microarray-based comparative genomic hybridization  data. in  <cit> , zhao et al. developed a method to infer dna copy-numbers using affymetrix snp-arrays. they combined probeset intensities for each snp into a single value and used the values as an observed sequence of data in their hmm. these methods are not allele specific and thus cannot distinguish e.g. retention  from uniparental disomy , which appears to be very important and wide-spread in certain cancers  <cit> .

more recently, methods to infer allele specific copy-numbers have been published  <cit> . laframboise et al.  <cit>  used a circular binary segmentation  algorithm which originally was used for array cgh  <cit> . huang et al.  <cit>  used a kernel smoothing method to estimate allelic copy-number changes. in  <cit> , nannya et al. describes a hmm to infer allelic copy-numbers that is based on the observed sequence of snps intensities ratios for which the corresponding normal snp markers are heterozygous.

in this study, we developed a hmm method to infer allele specific copy-numbers using affymetrix snp arrays. in a sense the method works on paired normal-tumour samples. it takes as input the genotype calls of the normal sample, the allelic specific intensities of the tumour sample and outputs the estimated copy-number states of each allele for each snp. to limit the state space of the underlying markov chain, we restricted the possible copy-numbers of each allele to  <dig>   <dig>   <dig> and >  <dig>  many tumour samples contain a large fraction of normal cells and this potentially affects the performance of the method. we therefore included the possibility to estimate the population mixture  from the data and used this in the analysis. we did this in a way similar to fridlyand et al.'s method for array cgh  <cit> . we tested our hmm model on simulated data sets, normal samples from the hapmap project and on bladder and prostate tumour samples.

RESULTS
we first normalized the  <dig> hapmap arrays and the  <dig> cancer arrays and transformed the allele intensities as described in methods. we then selected snps for each of the three groups of arrays: the hapmap, bladder and prostate groups. the selection was done using only the normal samples from each group as described in methods. after selection, we had  <dig>  snps selected for the hapmap group,  <dig>  snps for the bladder group and  <dig>  snps for the prostate group.

the normalized allele intensities and the genotypes of the germline dna were used as input in our hmm. the hmm outputs for each selected snp the allelic copy-number. to limit the number of states of the hmm, we defined six categories corresponding to different events: germline state or normal state, heterozygous deletion state, homozygous deletion state, uniparental disomy or uniparental polysomy state, unbalanced amplification state and balanced amplification state . the transition probabilities  are defined using three parameters: two variable parameters, p and r and one fixed parameter, ε . the p parameter corresponds to jumping from the normal state to an abnormal state, the r parameter corresponds to jumping between two abnormal states and the ε parameter corresponds to jumping between two states involving double events. here ε is fixed to  <dig> .

estimating the parameters
we simulated data sets with known transition parameters and investigated how the true parameters and true states were recovered. six samples were created for each combination of transition parameters. the parameters varied between  <dig>  and  <dig> . a value of  <dig>  means that a change of states occurs every  <dig> snps on average. we observed that our method is able to recover the true values of the transition parameters with a good accuracy. there is however a tendency to slightly underestimate the parameters when they are high. moreover, the method is able to recover the hidden states with a very good accuracy . the worst case is seen when both transition parameters are high, i.e., when there are many copy-number changes .

for each pair of true p and r parameters, we simulated six samples where all snps were given a heterozygous call in the germline dna. here we report the average of the estimation for p and r and how often the true copy-number state is recovered.

next, we applied the method to  <dig> hapmap samples and to the bladder and prostate samples . the transition parameters which are assumed to be the same for all chromosomes in a sample were estimated for each sample. the results show that the estimated transition parameters are within the range where the method obtains a very good accuracy in the simulated data sets. the median for the estimated p is  <dig>  in the normal samples and  <dig>  for the tumour samples. similarly, the median is  <dig>  for the estimated r in the normal samples and  <dig>  for the tumour samples. besides, the average percentage of snps being in normal state  was  <dig>  for the hapmap samples,  <dig>  for the bladder normal samples and  <dig>  for the prostate normal samples. moreover, the normal samples with the lowest percentages of snps in state  <dig> are the ones flagged as bad arrays  by the dchip software. three normal samples from the bladder group were flagged as bad arrays. figure  <dig> shows the results of our method on one bladder cancer sample.

accuracy of the method when the sample is a population mixture
using different values for the transition parameters, we simulated data sets where the sample was a mixture of normal cells and cancer cells. the percentage of cancer cells was chosen between 55% and 100%. the accuracy of the method was estimated assuming the sample was not a mixture . it is observed that if the mixture level is over 70%, then the true hidden states are recovered with high accuracy .

in the simulated data, amplification of an allele always implies that the copy-number increases by one; e.g. if the snp is heterozygous then amplification of the a allele results in two a alleles. in real data, this is not always true: amplification may increase the allelic copy-number by more than one. thus it is easier for the method to recover the true hidden states in the simulated data than in real data.

estimating the population mixture
we simulated data sets based on the results from the analysis of the bladder and prostate tumours. using the estimated hidden states, data sets with known population mixture were created by adding a percentage of normal cells. subsequently the mixture proportion was estimated. this was done on the  <dig> bladder samples for different mixture levels  .

simulated data sets were created based on the analyses of the bladder tumour samples. here the average is calculated for all samples where the amount of informative snps  was suffciently high . the number of correctly identified states is shown with and without estimation of the mixture proportion.

reliable information about mixture is only available if the sample contains snps with different copy-number alterations. for example, if the observed copy-number of a snp is  <dig> , then it is not possible to distinguish between a mixture of 1) 90% tumour cells with  <dig> copies and 10% normal cells  and 2) 54% tumour cells with  <dig> copies and 46% normal cells. however, if snps exist in several different states, then it becomes possible to distinguish between different mixtures. in case 1), a snp in state  <dig> will have an observed copy-number of  <dig>  and in case 2), the observed copy-number will be  <dig> .

knowledge of the mixture level helps to get a more accurate recovery of the hidden states. when the mixture level is about 60%, the accuracy rises from about 90% to 95% . we also estimated the mixture proportion on the real bladder and prostate data sets. as all the prostate samples were microdissected and all the bladder samples were macrodissected, we expected the samples to be almost pure cancer cells . we observed that most of our samples showed no evidence of being a mixture. however,  <dig> bladder samples  and  <dig> prostate samples  presented some mixture level. as all samples were microdissected or macrodissected, the estimated mixture level may not reflect a true mixture of cancer/normal cells. instead it may reflect heterogeneity in the cancer cells which is supported by findings in the literature. in bladder cancer, cells with different genomic alterations have been found in the same tumour  <cit> . in prostate cancer, genomic heterogeneity has been reported in several papers; e.g.  <cit> . however, it is not straightforward to modify the hmm to operate on mixtures of cancer cells.

for all bladder and prostate tumour samples, the mixture proportion was estimated. the averages and standard deviations are only calculated for the tumour samples whose estimates of mixture proportion, m, were not  <dig> .

varying the transition parameters across the chromosomes
until now, the transition parameters were estimated for each sample and were chromosome independent. however, it is known that for a given cancer type certain chromosomes are more prone to abnormalities than others. in order to take this into account, we simulated  <dig> samples where the transition parameters differed for each chromosome, but were similar for each sample . the transition parameters were randomly chosen between  <dig>  and  <dig> . we then analysed the samples and estimated the accuracy of the method . the simulated samples were divided into two categories: one where the germline genotype calls are only heterozygous and one where the germline genotype calls have the same distribution as in a normal sample . this partition of the samples showed that the addition of homozygous snp markers decreased the accuracy of the method slightly .

here the one-array method  and the all-array method  were compared. for each method, the accuracy of the hmm on samples where all snps are heterozygous in the normal sample and the accuracy of the hmm on samples where the call distribution is the same as a hapmap sample  were also compared. moreover, an average of the posterior probability for all snps correctly recovered or not is given.

in order to account for the similarities between different samples from the same cancer type, we also estimated the transition parameters for each chromosome across all samples of a group. this modified version allows the chromosomes to be ranked according to the frequency of changes occurring as reflected in the estimated transition parameters. we ran the modified version on the same  <dig> simulated samples . as expected, we achieved a slightly better accuracy in recovering the hidden states. the two methods agreed on  <dig> % of the recovered states when we put no restrictions on the genotypes and on  <dig> % of the recovered states when all snps were assumed to be heterozygous.

we applied our all-array method to the set of bladder and prostate tumours and compared the results obtained analysing one sample at a time. the two methods agreed on  <dig> % of the states for the bladder group and on  <dig> % of the states for the prostate group. from the results of the all-array method, we were also able to classify chromosomes according to how often a change in copy-number occurs. for the bladder group, copy-number changes occurred most often in chromosomes  <dig> and  <dig>  these two chromosomes are known to be frequently abnormal in bladder tumours  <cit> . for the prostate group, copy-number changes occurred most often in chromosomes  <dig>   <dig>   <dig> and  <dig>  a combined analysis of published cgh studies  <cit>  and a study based on snp arrays  <cit>  showed that these chromosomes are frequently abnormal in prostate tumours.

uniparental disomy
uniparental disomy occurs when one allele of a chromosomal region is lost and the remaining allele is duplicated. in a sample this means that snps in such a region will lose their heterozygosity while the copy-number will remain normal  or higher. andersen et al.  <cit>  and raghavan et al.  <cit>  showed that uniparental disomy is frequent in colorectal cancer and in acute myeloid leukemias, respectively. in bladder and prostate cancer, we also found some examples of uniparental disomy. figure  <dig> shows an example of uniparental disomy in chromosome  <dig> of a bladder sample, demonstrating that the hmm successfully can find cases of uniparental disomy.

using the homozygous snps to estimate allelic copy-number changes
in our hmm approach, there are two ways to estimate allelic copy-number changes. one can choose to use only the snps which are heterozygous in the germline sample or to use all snps including the homozygous snps. both ways have been tested here. using only the snps which are heterozygous in the germline sample is the best way to obtain good estimates of the underlying states because all states of the hmm are differentiable. in this paper, we obtained a high rate of recovery  when the simulated samples had only heterozygous calls. however, the average heterozygosity in the affymetrix genechip  <dig> k snp arrays is only around  <dig>   <cit> . this implies that less than one third of the snps are heterozygous in a normal sample. therefore, including snps with homozygous calls in the germline sample may improve the resolution of the map of allelic copy-number changes. when we included all genotype calls in the analysis, we still obtained a high rate of recovery . snps with homozygous genotypes in the germline sample can also differentiate different states based on their different copy-numbers. however, some states are very similar: states  <dig> and  <dig> or states  <dig>   <dig> and  <dig>  the presence of heterozygous snps helps in differentiating these states. oppositely the presence of homozygous snps might help in differentiating between heterozygous states ; for example, if noise is corrupting the signal from a heterozygous snp with homozygous neighbours, then the copy numbers of the neighbours can point to whether the heterozygous snp is in state  <dig> or  <dig> 

comparison with plasq
plasq  <cit>  was run on  <dig> of the real samples . the states estimated by plasq were converted into the corresponding states in our model and the results were compared. agreement between the two methods was on average  <dig> % . generally, our method detects more abnormalities than plasq. this is concordant with previous observations concerning plasq, where it has been found that plasq is conservative  <cit> ; i.e. plasq has a tendency to prefer the normal state. in order to be more conservative, we ran our hmm with a higher standard deviation in the emission density for the normal state. as expected, agreement between the two methods increased to an average of  <dig> % . additionally we calculated the average posterior probabilities of the states when both methods agree or disagree. as expected, when both methods agree, the average is higher than when they disagree .

CONCLUSIONS
in this study, we described a hmm-based method to estimate allelic snp copy-number changes, loh and allelic imbalance using affymetrix genechip snp arrays. the method takes as input the genotype call of the germline sample and the allelic snp intensities of the tumour sample and outputs the estimated copy-number states for each snp. the different hidden states estimated by the hmm correspond to different events occurring in the cancer cell. a chromosomal region may remain unchanged in a cancer cell, may lose one allele  or both alleles , may lose one allele and multiplicate the other one , may multiplicate one allele  or both alleles . our method is able to reliably differentiate between these events.

when samples are taken from tumour tissue, they often contain a mixture of normal and cancer cells. different techniques such as microdissection can help keep the percentage of normal cells low but this is a procedure that cannot be done automatically and is not always done. in this study, we showed that it is possible to estimate the true mixture proportion of a sample. we also showed that knowledge of the mixture proportion improves estimation of the allelic copy-numbers. in fact, the snp intensity reflects the average copy-number of that particular snp in the different cells in the sample. however, population mixture of normal and cancer cells might be confused with tumour heterogeneity. multiclonality has been shown to occur in bladder cancer as well as in prostate cancer and this could also lead to non-integer copy-numbers, i.e. the average over all cells is not an integer. it would be interesting to tackle this issue in future work.

finally, we discussed the utility of using snps which are homozygous in the germline samples in the estimation of allelic copy-number changes. we showed that despite the fact that they cannot really differentiate between events by themselves, e.g. normal state and uniparental disomy with a single duplication, they are useful in getting a finer map of copy-number changes in the cancer.

