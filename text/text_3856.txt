BACKGROUND
reverse engineering of genetic networks will greatly facilitate the dissection of cellular functions at the molecular level  <cit> . the time course gene expression study offers an ideal data source for transcription regulatory network modeling. however, in a typical microarray experiment usually up to tens of thousands of genes are measured in only several dozens or less samples, data from such experiments alone is significantly underpowered, leading to high rate of false positive predictions  <cit> . network reconstruction from microarray data is further limited by low data quality, noise and measurement errors  <cit> .

incorporating other types of data and existing knowledge of gene relationships into the network modeling process is a practical approach to overcome some of these problems. it has been proven that data integration and useful bias with relevant knowledge can improve the network prediction accuracy from gene expression data  <cit> . among the various approaches of network modeling, bayesian networks  have shown great promise and are receiving increasing attention  <cit> . bn is a graphic probabilistic model that describes multiple interacting quantities by a directed acyclic graph . the nodes in the network represent random variables , and edges represent conditional dependencies between nodes  <cit> . learning a bn structure is to find a dag that best matches the dataset, namely maximizing the posterior probability of dag given data d: p . the sound probabilistic schematics allow bn to deal with the inherent stochasticity in gene expressions and the noise brought in by the microarray technology. furthermore, bn is capable of integrating prior knowledge into the system in a natural way  <cit> .

a number of studies demonstrated that adding prior knowledge to bn improved the performance  <cit> . many sources of data and information are useful to supplement the gene expression data, and they can be incorporated at different steps of bn simulation, from prior structure definition to structure simulation and evaluation.

known protein-dna interaction or other clues of the relationships between transcription factors and their target genes are useful to transcription regulatory network inference. hartemink et al. included data from the chromatin immunoprecipitation  assay  <cit> , and tamada et al incorporated promoter sequence motif information  <cit> , to define the prior probability of network structures. information of other types of gene pair relationship has also been explored. steele et al. developed a gene-pair association score from the correlation of their concept profiles derived from literature, and utilized that to define the prior structure probabilities  <cit> . larsen et al defined a likelihood of interaction  score, which measures the statistical significance of two genes interacting with each other according to their shared gene ontology  information. they then restricted the candidate network edges  to those with significant p -values of loi during the bn structure learning iterations  <cit> . by doing so, the quantitative information of the likelihood is not fully utilized in the network modeling. djebbari and quackenbush utilized literature, high-throughput protein-protein interaction  data, or the combination of both to define the seed  network structure. they observed an improved ability of the bn analysis to learn gene interaction networks from the expression data  <cit> .

imoto et al formulated an novel approach to incorporate prior biological knowledge within the bn framework by adopting the energy concepts from statistical physics  <cit> , which was later further extended by husmeier and werhli  <cit> . in this approach an energy function was first defined to measure the agreement between a candidate network and the prior biological knowledge, and prior distribution of network structure is hence calculated using the gibbs distribution in a canonical ensemble. using this approach, the two groups examined several types of prior knowledge, including ppi, protein-dna interaction, binding site information, literature, and kyoto encyclopedia of genes and genomes  pathways  <cit> . the algorithms were validated using yeast gene expression data  <cit> , and synthetic data  <cit> .

existing studies often utilize prior knowledge to construct the prior distribution of network, or initial network structure. it has been demonstrated that the sampling method during simulation also affects the performance of bn structure learning  <cit> . though prior knowledge has been utilized to bias the sampling step, it is normally done through restricting the search space to sub regions, for instance, only simulate candidate structures whose significance is above a certain threshold according to prior knowledge  <cit> .

in searching for the network structure  that maximize p , the markov chain monte carlo  approach is regarded better than greedy searching algorithms, especially for the microarray data with small sample size where there is often no single structure that is prominently better than others  <cit> . in this study we propose a new approach to incorporate prior knowledge in a quantitative way to bias the mcmc simulation of candidate structure. it utilizes information of functional linkage between gene pairs, assuming that functionally linked genes are likely to interact with each other. it is known that interacting proteins or genes often share similar function, and participate in the same biological pathways and processes  <cit> . interaction has been utilized to infer functional linkage and annotate gene functions  <cit> . increasing evidence suggests that the reverse is also frequently true  <cit> . in our algorithm a probability score is first calculated that measures how likely two genes are functionally linked based on prior knowledge; a candidate edge reservoir is then constructed where the number of copies of each edge is proportional to this probability score; the reservoir is in turn used for sampling candidate network structure during the mcmc simulation. this way the quantitative information of the potential gene pair link predicted by prior knowledge is retained.

we will consider two type of prior knowledge: co-citation in pubmed literature and similarity in ontological annotation according go http://www.geneontology.org/. we will demonstrate they both contain information of functional linkage. the performance of the new algorithm is evaluated using a synthetic data set as well as data from two real microarray experiments: the yeast cell cycle study, and the mouse pancreas development/growth study. we will demonstrate that including the prior knowledge significantly improves the performance of bn modeling of gene expression data.

RESULTS
algorithm
bn is a graphical model to capture complex relationships among a set of random variables {x <dig>  x <dig> ...,xn} encoding the markov assumption, each node representing a variable. in the context of gene network modeling, each node represents a gene, while gene interactions are represented by directed edges between nodes. each variable xi in the dag is conditionally independent of its non-descendants given its set of parents. mathematically the joint distribution of the dag can be decomposed into a product form as:

  p=p= ∏i=1np 

where Πi denotes the parent set of the variable xi. this is referred as the chain rule for bns  <cit> . learning a bn structure is to find a dag that best matches the dataset, namely maximizing the posterior probability of dag given data p . here we adopt the sampling-based approach to bayesian inference, and sample network structures from a candidate edge reservoir with the mcmc network learning method. in the reservoir the edge representation is proportional to the likelihood of the two genes being functionally linked according to prior knowledge. this way, the edges between the strongly-related gene pairs have higher chance to be proposed as part of the candidate network. the overall design is given in figure  <dig>  the major steps included:

 <dig>  determine the probability of functional link plink between each gene pairs

 <dig>  calculate go schematic similarity

 <dig>  calculate p value of pubmed co-citation.

 <dig>  integrate go and pubmed information using the naïve bn to determine plink.

 <dig>  construct candidate network edge reservoir in which copy number of each edge is proportional to the plink of the corresponding gene pair.

 <dig>  learn network structure using the mcmc algorithm through sampling the candidate network edge reservoir.

at each step of the iteration, the proposed network is retained with an acceptance probability that is determined by the relative posterior of the proposed versus current network, penalized by the network complexity  <cit> . in calculating the posterior we use the bde  scoring metric  <cit> . the prior distribution is assumed to be uniform.

to evaluate the performance of our bn algorithm, and the benefit of adding prior knowledge, we compare it to two alternative approaches:  plain bn. in each iteration, a new network is proposed by randomly changing one edge in the current network.  the method developed by husmeier and werhli  <cit> .

go schematic similarity and significance of pubmed co-citation
go annotation and gene citation database  were downloaded from ftp://ftp.ncbi.nlm.nih.gov/gene/data. schematic similarity in go taxonomy was first calculated for each gene pair using the approach proposed by cao et al  <cit> , which calculates the shared information content of the go terms. the value of this measure ranges between  <cit> , with  <dig> being no similarity, and  <dig> being maximum similarity. the go similarity between each gene pair is defined to be the maximum schematic similarity of all the go terms they share.

for a given pair of genes, the total number of pubmed abstracts in which each gene appears , and in which both appear  were determined. the probability of co-citation frequency observed by random chance is calculated by

  ppubmed=1-∑i=0k-1p 

where p=n!!m!!!i!!!n!, and n is the total number of abstracts in pubmed  <cit> .

construction of the candidate network edge reservoir
we used the naïve bayesian network to integrate the go and co-citation information, and a simple bayesian naïve classifier to predict the functional linkage probability plink for all gene pairs. note that the prior knowledge of functional linkage is undirected, i.e. plink  = plink . an edge sampling reservoir was constructed, in which the number of replicates for the edge between gene i and j n  is in proportion to their plink :

  n=ceil) 

where ceil is the smallest integer no less than x. in this definition, any gene pair will be represented at least once and at most  <dig> times. the edges of gene pairs with higher plink will appear more frequently in the edge reservoir, and hence enjoy a higher chance to be selected during the network structure learning.

implementation
our bn simulation algorithm is implemented in matlab utilizing kevin murphy's bnt package  <cit> bnt.googlecode.com, and is summarized in table  <dig>  note that steps  <dig> and  <dig>  contain unique features that separate our approach from others. the source code is available upon request. the networks were visualized with cytoscape  <cit> .

*details of the definition of marginal likelihood, and how to calculate ll, prior probability of dag, can be found in  <cit> .

validation
utility of go similarity and pubmed co-citation in discovering functional linkage between gene pairs
lee et al developed an approach to evaluate if gene-pair functional relationships can be predicted by a certain type of high-throughput genomic data   <cit> . assuming that p and  denote the probabilities of gene pairs to share or not share functional annotation given that they are linked by data d , and p and p represent the prior probabilities of sharing and not sharing functional annotation, they proposed a log likelihood score  <cit> :

  lls=lnp∕pp∕p 

to describe the utility of data d in functional linkage inference. an lls close to  <dig> suggest that the data is not more informative than random pairing, whilst higher positive values of lls indicates that data d contains more information of functional linkage.

we adopted equation  to evaluate whether go schematic similarity and pubmed co-citation were useful in identifying functional linkage. the kegg http://www.genome.ad.jp/kegg and munich information center for protein sequences  database  <cit>  were used to construct the benchmarks of functional linkage. these databases were chosen for their high quality  <cit> . in this study we utilized yeast and mouse gene expression data to validate our algorithm. for each species, the positive control set consists of randomly sampled 5%  of all gene pairs that are in the same kegg pathways  <cit> . the choice of 5% rather than all is to lower the computational complexity. the negative control set was constructed with gene pairs that encode proteins localized in different cellular compartments, with the underlying assumption that they are functionally unrelated and do not interact with each other. four categories in the mips annotation  <cit>  were utilized:  <dig>  cytoplasm,  <dig>  nucleus,  <dig>  mitochondrion, and  <dig>  extracellular/secretion proteins.

again we only kept 5% of all possible gene pairs, totaling  <dig>  for yeast and  <dig>  for mouse, respectively. the same benchmark sets were also utilized to train the naïve bayesian classifier when calculating plink.

the lls of co-citation in discovering functional linkage is then determined by:

  llspubmed=lnp∕pp∕p 

the lls of go schematic similarity was performed in the similar fashion. the lls value for gene pair sets in different ranges of go similarity and co-citation p-value were given in table  <dig>  gene pairs sets with higher go similarity or pubmed co-citation significance, have more positive lls values, and vice versa. note that gene pairs with negative lls means they are less likely to be functionally linked than random pairs, which is expected if they share low go similarity or co-citation. the results suggest that pubmed co-citation and go similarity are efficient at discriminating functionally linked gene pairs from not linked ones.


utility of functional linkage information to interaction network modeling
the distribution of plink for yeast gene pairs is given in figure  <dig>  note that only a small proportion of gene pairs share high values of plink, for about 92% of the gene pairs this value is less than  <dig> . this indicates that most gene pairs share no functional linkage, consistent with the fact that gene networks are usually sparse. the candidate edge reservoir is constructed according to equation  <dig>  and the mcmc samples this distribution to propose new candidate network structure at each iteration. in figure  <dig> we have also included the distribution for gene pairs predicted to be interacting to each other, with and without the prior knowledge. among all possible gene pairs, only ~8% with plink  <dig> . in contrast, this proportion increases to 28% among the predicted interactions. it indicates that the prior knowledge did affect the outcome of the bn learning. the results from the other data sets are similar.

the assumption of incorporating prior knowledge of functional linkage is that they can help network modeling. existing data from yeast revealed that genes sharing the same go attribute interact genetically more often than expected by chance   <cit> . in a very conservative estimate, over ~12% of the genetic interactions are comprised of genes with identical go annotation ; and over 27% are between genes with similar or identical go annotations .

we examined whether plink can potentially discriminate interacting gene pairs from non-interacting ones, using the receiver operating characteristic  curve. roc is a graphical plot of the sensitivity versus , namely the fraction of true positives versus the fraction of false positives, as the discrimination threshold of a classifier is varied. the area under curve  reflects the performance. the roc of a random classifier would be a 45° line with auc =  <dig> . figure  <dig> presents the roc plot for the nine yeast cell cycle regulating transcription factors : fkh <dig>  fkh <dig>  ndd <dig>  mcm <dig>  ace <dig>  swi <dig>  mbp <dig>  swi <dig>  and swi <dig>  and their targets identified using the chip-chip technology  <cit> . the auc of  <dig>  indicating that is positively correlated with interaction and therefore useful in interaction inference.

convergence of simulation
in figure 4a we plot the acceptance ratio versus number of mcmc steps in the yeast cell cycle dataset. obviously in the later steps the probability to accept the new proposed dag is small and flattens. the results from the other datasets are similar. in addition, the mcmc simulation was repeated  <dig> times with independent initializations, and consistency in the marginal posterior probabilities was examined. we found that they correlated well between different runs:  <dig>  ±  <dig>  for the simulated dataset,  <dig>  ±  <dig>  for the yeast data set, and  <dig>  ±  <dig>  for the mouse pancreas dataset. figure 4b presents the scatter plot of the edge posterior probability from two typical runs that simulate the yeast dataset.

validation using simulated data
in our network inference, the mcmc learning simulation is repeated  <dig> times with independent initializations and an interaction will be considered in the final network if it is observed more than  <dig> times. our new bn algorithm was first tested in a simulated time course  gene expression dataset of an artificial network generated using syntren  <cit> . this network contains  <dig> genes, of which  <dig> act as regulators with a total of  <dig> regulatory relationships . the results are summarized in table  <dig>  2nd column. it demonstrates that incorporating the functional linkage as prior knowledge allows the identification of a significantly higher number,  <dig> versus  <dig>  of the true gene-gene relationships compared with the plain bn modeling of gene expression data only. a random network of the same number of edges was also created for the  <dig> genes  <cit> . the improvement of bn with prior knowledge over random is significant , while without prior knowledge it is not .

plain bn over random
* we ignored edge direction with comparing to bind since it contains both directed and undirected interactions.

validation using the yeast cell cycle data
next the new algorithm was applied to one of the stanford yeast cell cycle data http://genome-www.stanford.edu/cellcycle/, where the cells from a cdc <dig> temperature sensitive mutant were studied  <cit> . to evaluate the performance, we compared the predicted interactions from our algorithm to the annotated interactions in bind http://bind.ca <cit> , and the transcription regulation predicted by the chip-chip data  <cit> . tables  <dig>   <dig> list the benchmark interactions for the  <dig> yeast cell cycle genes that were recovered by the bn modeling. the statistical results are summarized in table  <dig>  columns 3- <dig> 

relationships in bold font are predicted both with and without prior knowledge.

relationships in bold font are predicted both with and without prior knowledge.

evidently, our method is capable of identifying a higher number of the positive benchmarks compared with the plain bn without prior knowledge. when evaluated with the bind annotation, the number of correctly identified interactions doubled from  <dig> to  <dig> . the plain bn actually did not perform better than random selection . in contrast, bn with prior knowledge performed significantly better than random selection with χ <dig> =  <dig> , p <  <dig> . when evaluated with the chip-chip data, the story is similar. the number of correctly identified gene regulatory relationships increased from  <dig> to  <dig> with the addition of prior knowledge . without the prior knowledge, the plain bn is not different from random selection .

validation using mouse pancreas development data
we also validated our algorithm using a mammal dataset. the experiment profiled gene expression changes in pancreas during embryonic development or during compensatory growth after partial pancreatectomy. elucidating the networks is key to understand the complex nature of pancreas development and function  <cit> . a number of efforts have been made to manually annotate the key transcription factors and the gene networks they regulate based on low-throughput data, nicely reviewed by servitja and ferrer  <cit> . in table  <dig>  we list the  <dig> experimentally confirmed gene-gene regulatory relationships  <cit> , and their network is depicted in figure 6a. with prior knowledge bn modeling of the expression data is able to recover half of them , as shown in figure 6c and table  <dig>  in contrast, the plain bn is only able to identify  <dig> of them . this is again a ~two-fold enhancement. in figures 7a-7c the roc curves are presented. incorporation of prior knowledge significantly improved the ability to detect known interactions. our algorithm performed comparably to werhli and husmeier's.

bn with prior knowledge can recover half of the experimentally confirmed transcriptional regulations during mouse pancreas development, two times more than the plain bn without prior knowledge.

in additional file  <dig>  we listed the go similarity and pubmed co-citation of the gene pairs with known regulatory relationships that were missed by plain bn. clearly, almost all of them have high go similarity and share a significant number of co-citations. adding the functional linkage as prior knowledge helped to recover them.

discussion
in this study we proposed a new algorithm to quantitatively utilize prior biological knowledge in the network modeling of gene expression data. first the functional linkage of gene pairs was assessed based on multiple data sources using the naïve bayesian classifier. the result was then utilized to construct a candidate network edge reservoir, where the number of replicate edges between each gene pair was proportional to their function linkage probability. during simulation new candidate network structure was formed by sampling from this reservoir at each iteration. since the edges of gene pairs with stronger functional linkage had more representations in the reservoir, these biologically meaningful edges enjoyed a preferential treatment in network simulation. with both the simulated and real gene expression data, we demonstrated that incorporating the prior knowledge significantly improved the network modeling performance. more information of the gene interaction network could be extracted from the microarray data with higher accuracy. in contrast, in all datasets, without the prior knowledge, though the number of benchmark regulations recovered is more than a random selection, the improvement is not statistically significant, demonstrating the necessity to supplement the gene expression data with additional information. this finding that plain bn did not perform better than random selection was not unexpected, similar observations was recently reported for a number of publically available reverse-engineering algorithms when gene expression data is the sole source of information  <cit> .

our algorithm provides a practical way to integrate the probabilistic biological knowledge that is different from previous efforts by others  <cit> . the quantitative nature makes it capable to handle soft constraints. using the approach by werhli and husmeier for instance  <cit> , we differ in several key steps. first, they encode multiple sources of prior knowledge in a weighted sum via an energy function; we integrate information from multiple sources through a bayesian classifier. furthermore, in our approach the mcmc samples from a candidate edge distribution defined by the prior knowledge, rather than from the network posterior distribution where the network prior is defined by the prior knowledge. our algorithm utilizes the prior knowledge at interaction level, while theirs at the network level. finally the werhli and husmeier approach is more computational intensive. to reduce the computational complexity, they sum over all parent configurations of each node and limit the number of parents of each node to  <dig> or less; the complexity of this operation is    <cit> . we find that it is still memory consuming for networks of moderate or large sizes. for instance, a dell optiplex  <dig> with 2ghz duo cpu,  <dig>  gb ram ran out of memory when simulating the 107-gene yeast network. our algorithm does not have this problem.

we used two sources of prior evidence of functional linkage to assist network modeling: the pubmed co-citation and go schematic similarity. however, our framework by design allows the integration of other types of data or knowledge, for instance, high throughput genomic data including ppi and chip-chip; gene-gene relationships derived from advanced methods including text mining  <cit> , database curation, and computational modeling of sequence information; and many other sources. it has been demonstrated that the degree of improvement brought in by prior knowledge highly depends on the quality of the information being added  <cit> . low quality prior knowledge could even lower the performance of bn  <cit> . presently, most of the available prior knowledge each on its own suffers from high false positive rate and being incomplete, which can limit their efficacy in network modeling. integration of data from different sources and utilizing their consensus provides an effective means to deal with this issue  <cit> . a caveat here is, when considering more sources of data, the inter-dependency among them need to be scrutinized more carefully, and maybe a more sophisticated integration method than the naïve bayesian classifier is needed.

a number of different approaches have been developed to integrate multiple sources of prior information in the bn modeling of gene expression data, at the different steps of the simulation process  <cit> . it would be of interest to compare the efficiency of the different approaches, investigate whether the optimal approach depends on the types of prior knowledge, and if the different approaches can be combined for a most efficient utilization of prior knowledge in network modeling.

CONCLUSIONS
in this paper we proposed a new algorithm to integrate and utilize the prior biological knowledge in the bn modeling of gene expression data. our study demonstrated that incorporating prior knowledge at the step of network structure simulation is an efficient way to preserve the quantitative information in it, and to improve the performance of network modeling.

