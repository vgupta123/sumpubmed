BACKGROUND
rapid advancement in high-throughput sequencing techniques has greatly inspired the wave of genome-wide association studies  to unravel the genetic basis underlying complex traits in plants, animals and humans  <cit> . the theoretical kernel of these genetic association studies is statistical inference of linkage disequilibrium  between a tested polymorphic marker locus and a putative trait locus in the population of interest. a review of the rich literature has revealed that a major challenge to association studies lies in the high level of vulnerability of the ld based analyses to several demographic factors, the most prominent among which is the population stratification. it has been well documented that use of samples collected from the population with genetic structure may result in both false positive and false negative inferences of association  <cit> . tremendous efforts have been invested to tackle the problem through either predicting genetic structure in the population under study  <cit>  and incorporating this information into the association analysis  <cit>  or adjusting the test statistic through so called genomic control  <cit> .

in contrast to the problem raised from population stratification, the consequences of using non-random samples in association studies are usually neglected. we recently investigated the effect of using non-random samples in ld analyses and observed that estimates of ld parameters can be severely biased and that the statistical power for testing their significance substantially reduced  <cit> . in practice, the sampling schemes of many genetic association studies involve various types of selection and thus the samples collected are no longer random representations of the corresponding populations. a typical example is the ‘case–control sample’ used in many association studies of human diseases. in such instances, the frequencies of some disease genotypes are artificially inflated relative to the population frequencies so as to ensure sufficient representation of those genotypes carrying a rare allele. although approaches have been developed to model and analyze ‘case-control’ samples, they are usually based on nonparametric statistical tests such as χ <dig> or trend tests etc. and rarely account for the biases described above  <cit> . such approaches are statistically less sophisticated and often not robust in the presence of these influences, exposing the corresponding analyses to the risk of false positive and/or negative inferences of genetic association. we present here a novel likelihood-based statistical framework that confers improved robustness in estimation of model parameters to non-randomness of samples and thus a more powerful statistical test of ld in the presence or the absence of genetic structure. we demonstrate the improved robustness and statistical power by re-analyzing the recently published parkinson’s disease  case and control datasets  <cit> . in addition, we illustrate the statistical properties of the method by computer simulation study.

methods
we consider case and control samples from k genetically divergent populations, of which the ith population contributes a proportion of the cases  and a proportion of the controls . in fact, any association study virtually tests for significance of ld between two polymorphic loci: a putative disease locus and a genetic marker locus which is devoid of effect on the disease incidence. the ld coefficient d measures the level of association where the superscript refers to the ith population. let a and a denote by the two alleles at the disease locus, and m and m by the two alleles at the marker. let p and q be the allele frequencies at the marker and disease loci respectively in the ith population. most association studies using case and control samples virtually test for the disequilibrium through testing for significance of difference in frequency of the marker allele between the case and control groups. in the present notations, the difference in marker allele frequency has a form of

  Δpm=pmcase-pmcontrol=∑i=1kripm|aicaseqaicase+pm|aicaseqaicase-sipm|aicontrolqaicontrol+pm|aicontrolqaicontrol=∑i=1kripm|ai1-qaicase+pm|aiqaicase-sipm|ai1-qaicontrol+pm|aiqaicontrol=∑i=1kri-sipm|ai+pm|ai-pm|airiqaicase-siqaicontrol=∑i=1kri-sipmi+diqai1-qairiqaicase-qai-siqaicontrol-qai 

derivation of equation  implies that the conditional probabilities of a marker allele given an allele at the disease locus are constant in both cases and controls across different subpopulations, that is pm|aicase=pm|aicontrl=pm|ai and pm|aicase=pm|aicontrl=pm|ai. this is true if all the sub-populations are no longer subject to any further structure stratification. the simple algebraic formulation reveals that any association tests, which are based on comparing the marker allele frequency between cases and controls, share at least two common properties. first, the test statistic will not be zero even though the disease and marker loci are in linkage equilibrium in all subpopulations, i.e., all d =  <dig>  if the allele frequency of the tested marker varies from one population to the other, i.e. pmi≠pmji≠j, suggesting the risk of making false positive inference of ld if the case and control samples are collected from genetically divergent populations. secondly, the efficiency of the association test can be greatly influenced by the sampling scheme of the cases and controls as characterized by the term ri-si in equation  as we and others have previously demonstrated  <cit> .

method  <dig> proposed in the present study uses information from the conditional probability distribution of genotypes at the disease locus given any genotype at the tested marker , and develops a likelihood-based framework to infer the ld parameter. on the one hand, this provides a natural way to incorporate samples from multiple resources into the association study, and thus effectively removes the risk of false positive inference due to the genetic structure. on the other, the way, by which the likelihood analysis is formulated on the conditional probability distributions, has virtually avoided the influence of any non-randomness in sample and thus confers robustness to the sampling influence. to compare the method with one of the most popularly used approaches in the current literature of genetic association study, the armitage’s trend test  <cit>  was implemented to analyze the same datasets in parallel to method  <dig>  and we denote the armitage’s trend test by method  <dig>  based on the form of equation , we proposed method  <dig>  which is a modified version of the armitage test  by removing the population structure specific term 

 ∑i=1kri-sipmi 

 from the numerator of the armitage’s trend test statistic. all three methods are detailed in the following text.

cases
controls
conditional probability distribution of  marker genotypes on a given disease genotype,  disease genotypes on a given marker genotype and  marker genotypes given a genotype at the disease locus under the penetrance model of the disease gene in case/control samples. fi is the penetrance that an individual in the population is affected with disease given its genotype at the disease locus is i .

in method  <dig>  we first consider a case–control sample of size n collected only from a single randomly mating population. the method focuses on gene segregation at a marker locus and a putative disease locus in this population. there are two alleles, m and m, segregating at the marker locus and two alleles, a and a, at the disease locus. for simplicity but without loss of generality, a is assigned to be the disease causing allele. the population genetic parameters characterising genotypic distribution of genotypes at the marker and disease loci include p , frequency of marker allele m , and d, the coefficient of ld between genes at the two loci. distribution of genotypes at the two loci can be expressed in terms of the population genetic parameters. let gij = pr{y = j | x = i} be the conditional probability of marker genotype y = j  given the disease genotype x = i . let hij = pr{x = i | y = j} be the conditional probability of disease genotype x = i given the marker genotype y = j. these conditional probability distributions can be expressed in terms of the population genetic parameters p, q and d as given in table 1a and 1b respectively.

the cases and controls collected from the population can be classified according to their genotypes at marker loci, while the sample size n is equal to sum of nij representing the number of individuals with jth marker genotype  in cases  or controls . table 1c illustrates the conditional probability distribution of genotypes at the disease locus for any given genotype at the marker locus among cases or controls. it can be seen that the conditional probability distribution is a function of the penetrance parameters that characterize the inheritance of the disease genes as well as the population genetic parameters. table 1c is derived from table 1a by noting that each disease genotype presents a unique disease risk. the model involves a total of six parameters, leaving their estimation as a typical over-parameterization problem. to ease the problem, we fixed the penetrance parameters f1- <dig> to take either of values ,  or , which correspond to the dominant, additive or recessive inheritance of the disease gene a. our focus was on estimation of the population genetic parameters. consequence of possible mis-specification of penetrance parameters will be evaluated through simulation study as detailed in results section below.

the marker allele frequency p can be derived through an independent population survey, or, if taking controls as a random sample of the population in regard to the marker genotypes, approximately estimated from controls as p^=n21+ <dig> n22/n2
, where n2 = n21 + n22 + n <dig>  appropriateness will be discussed for estimating frequency p from control subjects in discussion. let n =  be a vector of the observed numbers of individuals with different marker genotypes in the case and control samples. the logarithm of the likelihood function of the parameters, q and d, given the observed vector n and the penetrance parameters can be expressed as

  lp,q,d|n,f <dig> f <dig> f3∝∑j=13∑i=13n1jwij+n2jvijloggij, 

where

  wij=fihijf1h1j+f2h2j+f3h3jandvij=1-fihij1-f1h1j+1-f2h2j+1-f3h3j 

are the conditional probabilities that any case or control individual with the jth marker genotype  has the ith genotype at the disease locus . two facts should be noted to the likelihood function . firstly, information about the disease genotypes is missing and n1jwij  represents the expected number of individuals with the ith disease genotype and jth marker genotype in the case  sample. secondly, the conditional probability hij is a function of parameters p, q and d as given in table 1b. the partial derivatives of the likelihood function with respect to the unknown parameters q and d led to two normal equations

  a6q6+a5q5+a4q4+a3q3+a2q2+a1q+a0= <dig> 

and

  b5d5+b4d4+b3d3+b2d2+b1d+b0= <dig>  

the coefficients ai  and bi  in equations  and  were functions of the sample observations n =  and the conditional probabilities wij and vij. mathematical forms of these coefficients were derived using the computer software mathematica  <cit>  and listed in additional file  <dig>  we proposed here an em algorithm to calculate the maximum likelihood estimates  of parameters q and d. the algorithm starts with the estimate of marker allele frequency,
p^, and initial guess for values of the other two model parameters, d and q. with these parameter values, the conditional probabilities wij and vij can be calculated from equation . this constitutes the expectation  step of the em algorithm. the maximization  step calculates new values of the parameters by solving equations  and  respectively. it should be noted that the coefficient of the leading term in the polynomial equations  and  is a positive constant, warranting the existence of at least one real root to these equations. although there was no analytical solution to these equations, they can be solved numerically  <cit> . when multiple real roots were found, we selected the one that was within the corresponding theoretical bounds } ≤ d ≤ min{p, q}) and also resulted in the highest value of the likelihood. as the e and m steps are iteratively repeated, the likelihood function increases monotonically along the sequence of the newly determined estimates of the parameters, which converge to the mles of the model parameters,
q^
and
d^

. significance of the disequilibrium parameter d can be tested using the likelihood ratio  test statistic given by

  lr=-2lp^,q^,d=0|n,f <dig> f <dig> f3-lp^,q^,d^|n,f <dig> f <dig> f <dig> 

it is important to note that the likelihood function under the null hypothesis can be simplified to be l = log + log + log, which is a function of the vector n and marker allele frequency p only and is independent of the other parameters, q and d. thus, the likelihood ratio test statistic can be approximated by a χ <dig> distribution with  <dig> degrees of freedom . under d =  <dig>  the mle of p is given by
p^=2n11+2n21+n12+n22/2n
as expected.

when the cases and controls are collected independently from k subpopulations or genetic cohorts, we formulate the likelihood of the congregate case and control sample as the sum of the likelihoods for the case and control sample from each of these cohorts as given by

  lp <dig> p <dig> ..,pk,q <dig> q <dig> ..,qk,d <dig> d <dig> ..,dk|n <dig> n <dig> ..,nk,f <dig> f <dig> f3=∑i=1klpi,qi,di|ni,f <dig> f <dig> f <dig> 

where the superscript is used to denote the parameters for each subpopulation. to calculate the above likelihood function, we proposed firstly to work out the population specific parameters q and d from the case and control sample of the ith subpopulation separately using the method described above, and then to sum up the likelihoods for all the case and control samples. although the likelihood ratio statistic confers the flexibility to test for significance of ld in any subpopulations, we are interested here in testing for a conservative null hypothesis that there is no ld between marker and disease loci in all the subpopulations based on the ratio of the congregate likelihood with
d^i over the likelihood with d =  <dig>  this likelihood ratio test statistic was approximated by a χ <dig> variable with 2 k d.f..

method  <dig> was modified from the armitage’s trend test  <cit>  for genetic association using case and control samples and from our formulation of the trend test statistic when the cases and controls are collected from k genetically divergent populations or cohorts as demonstrated in equation . the armitage’s method basically tests for association of a polymorphic genetic marker with a disease phenotype through testing for significance of the difference in allele frequency at the marker between cases and controls. in the presence of genetic structure, the difference in frequency of the marker allele m between the cases and controls contains a term ∑i=1kri-sipmi in which ri and si stand for proportion of cases and controls collected from the ith population and pmi for frequency of the marker allele m in the population as shown in equation . we removed this term from the numerator of armitage’s trend test statistic, adjusted the corresponding sampling variance of the difference term and proposed

  χg2=Δp^m-∑i=1kri-sip^mi2∑i=1k <dig> p^mi1-p^miri2/nicase+si2/nicontrol+ri-si2/ni 

to be the test statistic which follows the chi-square distribution with  <dig> d.f.. in equation , the denominator was the sampling variance of the numerator under the null hypothesis, i.e. there is no ld in either subpopulation. nicase  and n are the number of cases  and size of cases and controls from the ith population or cohort.

method  <dig> is virtually the armitage’s trend test, which is the most commonly implemented approach in the literature of gwas with a case and control design. the test statistic is built upon the number of genotypes, nij with i = <dig>   <dig> corresponding to case and control and j =  <dig>   <dig>   <dig> to three genotypes at a tested marker, and has a form of

  y2=nn∑j=13n1jxj-n1⋅∑j=13n⋅jxj2n1⋅n2⋅n∑j=13n⋅jxj2-∑j=13n⋅jxj <dig> 

under the null hypothesis of no association between the marker and the disease locus, this follows a χ <dig> distribution with  <dig> d.f., where n=∑i=12∑j=13nij, ni·=∑j=13nij, n·j=∑i=12nij and the trend coefficients xj  are the weights of effects of different marker genotypes on the disease trait  <cit> . when x1- <dig> take a form of ,  or , the test statistic corresponds to testing for genetic association of the tested marker with a putative disease trait showing dominant, recessive, and additive genetic inheritance respectively. as demonstrated by jackson et al.  <cit> , the armitage’s trend test statistic can be expressed as

  y2=nn2n11+n12-n1⋅2n⋅1+n⋅22n1⋅n2⋅n4n⋅1+n⋅2-2n⋅1+n⋅22=p^mcase-p^mcontrol2p^m1-p^m+p^mm-p^m2} has a term
p^mm-p^m2
, which is zero when the case–control sample is in hardy-weinberg equilibrium . this term is proposed to be a correction for bias in variance estimation when there is departure from hwe due to several factors including population structure  <cit> . however, there is no such a correction term under dominant and recessive models.

re-analysis of the parkinson’s disease datasets
we implemented the three methods described above to re-analyze the pd dataset which was recently published by simon-sanchez et al.  <cit> . the study carried out a genome wide screen for genetic variants predisposing susceptibility to the pd through a two-stage case–control design. in stage i,  <dig>  individuals  recruited from the united states and  <dig>  individuals  recruited from germany were genotyped at  <dig>  snps using infinium beadchips of which  <dig>  snps with genotyping call rate larger than 95%, minor allele frequency  above  <dig>  and no departure from hwe  were remained  <cit> . because estimates of allele frequency from a small sample may vary greatly, we further excluded those markers, at which there were less than five individuals for any genotype, from further analysis. after this quality control, a total of  <dig>  snps were used in the present study. principal component analysis  from genotype data was carried out to investigate the population structure for the stage i dataset by using program gcta  <cit> . in stage ii, which was designed as a confirmation stage,  <dig> ,  <dig>  and  <dig>  individuals were recruited from three different cohorts: the usa , germany  and the uk  respectively. all  <dig>  individuals were genotyped for  <dig> snps which showed significant associations in analysis with stage i dataset. after applying the same quality check on the snp data, two snps were excluded from the present study. the genetic association for each snp marker was evaluated by armitage’s trend test  and the genome-wide significance level was determined by the bonferroni correction for the probability of an overall type i error at 5%.

simulation model and method
to investigate statistical properties and limitations of the method developed in the present study, we considered three schemes for sampling cases and controls from computer simulated randomly mating populations. in the first two sampling schemes, scheme a and b, we fixed the penetrance parameters f1- <dig> for genotypes at the disease locus to be , while in the third sampling scheme, scheme c, mild penetrance parameters  were used. sampling schemes a and c collected cases and controls from a single population, while scheme b sampled individuals from two genetically divergent populations with regard to a tested marker and a putative disease locus. a simulated population in the present study was fully characterized by a set of population genetic parameters, p, q and d , and quantitative genetic parameters, f <dig>  f <dig> and f <dig> . for a given set of these parameters, genotype of a case or control subject at both the marker and disease loci was generated by randomly sampling from the conditional probability distribution given in table 1c. the sampling process continued until the required number of cases or controls was obtained. the computer programs implementing the simulation were described and modified in luo  <cit>  and wang et al.  <cit> .

RESULTS
re-analysis of the parkinson’s disease datasets
to assess the population structure in the stage i dataset, pca was carried out using whole-genome genotype data and illustrated in additional file  <dig>  the analysis revealed genetic structure between the us and german individuals. figure 1a-c illustrate distributions of the logarithmic significance levels  of genetic association tests across the  <dig> human chromosomes using the three pd case and control snp datasets from the stage i, stage ii and stage i and ii combined, respectively. we analyzed each of the datasets using the three methods described above. for method  <dig>  the associations were detected under additive genetic inheritance mode with f1-3 =  <dig>  ½,  <dig>  it can be seen from the stage i data analysis  that method  <dig> developed in the present study  detected  <dig> significant snps, which are distributed across  <dig> chromosomal regions of size < 1 mb . methods  <dig> and  <dig> detected significant snps in only two  of the  <dig> regions at the same bonferroni corrected significance threshold . no extra significant association was detected by method  <dig> or  <dig> outside the  <dig> regions screened by method  <dig>  to explore genetic dependence among the  <dig> significant snps detected using method  <dig>  we calculated the coefficient of ld between all snp pairs using an approach that accounts properly for the case and control sampling scheme  <cit> . the disequilibrium structure illustrated at the bottom of figure 1a shows that the significant snps are not associated with each other across the different regions , removing the concern that the detected snp-disease associations might be due to autocorrelation in genotypic distribution among the snps between these regions. in particular, method  <dig> uniquely detected six snps on chromosome region 10p <dig> , of which, rs <dig> and rs <dig> locate at the introns of gene cul <dig>  the cul <dig> gene encodes a protein of the e <dig> ubiquitin ligase complex  <cit> . the fact that another pd susceptible gene park <dig> also encodes a parkin protein in the same complex  <cit>  suggests that cul <dig> could be a newly detected pd candidate gene. moreover, method  <dig> detected three snps on chromosome region 8p <dig> , which were only  <dig>  mb apart from a previously reported pd susceptible gene fgf <dig>  fgf <dig> and snca have previously been reported to be synergistically associated with pd  <cit> .

significance and bootstrap posterior probabilities  for the  <dig> significant snps detected by method  <dig>  from stage i dataset. shadowed are the regions at which the genetic association was tested by method  <dig>  and method  <dig>  at the same significance level. *distance  from previous significant snp in the same chromosome region.

to assess variation of the predicted genetic associations, we carried out bootstrap sampling with replacement from the stage i dataset  and calculated the empirical posterior probability at each of the  <dig> significant snps. table  <dig> summarizes the significance levels  and the bootstrap posterior probabilities  calculated for each of the three methods. bpp was calculated as the proportion of bootstraps in which the snp of interest was detected given the empirical bonferroni p value threshold of  <dig>  × 10- <dig>  of the three methods tested on the stage i dataset, we find that method  <dig> confers the most powerful test for the genetic association. the bpp values calculated from repeated bootstrap samples by analysis using method  <dig> were consistently higher , suggesting the method is more robust to variation caused from sampling than the other two methods tested in this study. method  <dig> and  <dig> had comparable bpp values  and hence similar robustness to sampling variation.

before reporting our analysis of the stage ii dataset, it is worth stressing that the  <dig> snps originally genotyped were selected only from the previous analysis using method  <dig> <cit> . the dataset contains only  <dig> of the  <dig> significant snps identified using method  <dig> in our analysis of the stage i data. using a bonferroni corrected genome-wide p =  <dig>  significant threshold , we found the snps located within 4q <dig> and 17q <dig> to be repeatedly detected by all the three methods in the stage ii dataset, while an additional six snps were detected by method  <dig> to be in significant association with the disease trait at the bonferroni genome-wide threshold . the maximum r <dig> between the six snps identified only by method  <dig> was  <dig> . in particular, analysis using method  <dig> detected a significant snp  within chromosome 12q <dig>  , located just  <dig> kb from the previously identified pd candidate gene park <dig> <cit> ; neither method  <dig> nor  <dig> detected this significant snp. in addition, a significant snp  within chromosome 14q <dig>  detected by method  <dig> is only  <dig> kb from the gene gch <dig>  which was recently found to be associated with pd through meta-analysis of multiple pd gwas datasets and curated in the pdgene database  <cit> . a full list of significant snps detected by the three methods in the analysis of the stage ii dataset are shown in additional file  <dig> 

when the two datasets  were combined,  <dig> snps were detected significant at the bonferroni corrected p =  <dig>  threshold  using method  <dig>  including all the twenty seven significant snps detected using the same method in stage ii analysis and eight significant snps detected by the same method in stage i data analysis . the  <dig> snps undetected in individual dataset were distributed in  <dig> chromosomes regions . the snp marking the pd candidate gene, park <dig>  detected in the analysis of the stage ii dataset, was also repeated in analysis with the combined dataset. query against the pdgene database  <cit> , we found another  <dig> out of the  <dig> snps that had been reported to be associated with pd: rs <dig>   <dig> - <dig> ), rs <dig> , rs <dig> , rs <dig> , rs <dig>  and rs <dig> . a majority of the thirty-five significant snps that replicated the stage i or ii analysis were detected with markedly more stringent significant levels, reflecting the increased size of the combined dataset.

there have been a total of twenty five candidate genes discovered so far to predispose individuals to parkinson’s disease . we explored the extent to which these candidate genes can be revealed in the present genetic association study. listed in figure  <dig> are the most significant snps within a  <dig>  mb chromosomal region surrounding each of the  <dig> pd candidate genes and estimate of the number of false discoveries evaluated at the probability at which the snp was claimed significant  <cit> . it can be seen that all the three methods detected the snp, rs <dig>  within the pd candidate gene snca <cit>  on human chromosome 4q <dig> as well as the snp rs <dig>  just  <dig>  mb distant from the pd candidate gene mapt <cit>  on chromosome 17q <dig> with negligible risk of being false positives. in addition to these, method  <dig> discovered two additional snps located  <dig>  mb and  <dig>  mb from the pd candidates, fgf <dig> <cit>  and park <dig> <cit>  respectively without invoking the risk of false positive. the identification of significant genetic markers close  to the pd genes further supports the improved efficiency of the newly developed method for genetic association study.

simulation study
table  <dig> presents the parameters defining  <dig> simulated randomly mating populations as well as means and standard deviations of estimates of the model parameters from  <dig>  repeated samples of  <dig> cases and  <dig> controls. methods  <dig> and  <dig> were only implemented to analyze the simulation data because methods  <dig> and  <dig> are effectively interchangeable when the case and control samples were known to come from a single randomly mating population. when the marker and disease genes were in le , marker genotype provides no information on the unobservable genotype at the disease locus and thus no estimate of disease allele frequency q was attempted under the circumstances. means of the test statistic in these populations were approximately equal to  <dig>  or  <dig>  for method  <dig> or  <dig> respectively, corresponding to means of the chi-square variable with  <dig> or  <dig> degree of freedom as expected for the likelihood ratio test in method  <dig> and the chi-square test in method  <dig>  this demonstrates the adequacy of proposed distribution of the test statistic constructed in these methods under the null hypothesis and, in turn, the appropriate control of the type i error of the statistical tests. when ld was actually present , method  <dig> estimated the model parameters, q and d, adequately  and, provided a consistently higher statistical power  to test for significance of the disequilibrium than method  <dig>  we did also investigate the performance of method  <dig> when the disease allele showed either dominant or recessive inheritance and the simulation study demonstrates that the method predicted the model parameters well under these different genetic models .

population genetic parameters for  <dig> simulated populations and statistical inference of model parameters from  <dig> cases and  <dig> controls repeatedly sampled from the simulation populations. p and q are allelic frequencies at the marker and disease loci, d is the coefficient of linkage disequilibrium  between the two loci. means and standard deviations  of the model parameters, q and d, and χ2test statistic were calculated from  <dig> repeated samples. ρ  is the proportion in  <dig> repeats in which the association test surpassed the threshold of p-value at  <dig>  when ld is absent and the bonferroni threshold of p-value at 5 × 10- <dig> when ld is present.

we explored the influence of using case and control samples collected from genetically divergent populations  on performance of the three methods. table  <dig> illustrates  <dig> sets of simulation parameters defining the genetic structure of two randomly mating populations and the empirical power of the methods in the association test using case and control samples from these populations. the case and control samples were either taken separately or using the admixed samples of which 57% cases and 76% controls were from population  <dig> and the rest from population  <dig>  these two percentage values were deliberately chosen corresponding to the constitution of cases and controls in the stage i pd dataset. when the disequilibrium was absent in either of the populations , all three methods shared a low probability of making false positive inference using case and control samples from these populations separately . when cases and controls were contributed by the two populations, the false positive rate remained at the same lower level for methods  <dig> and  <dig> but increased up to 25% for method  <dig>  moreover, the increase in the false positive probability for method  <dig> was in proportion to the difference in marker allele frequency between the two contributing populations. the larger the difference, the higher the false positive probability was observed, reflecting the fact that the test statistic of this method is proportionate to the size of difference between the allele frequencies as expected from the above theoretical analysis. when the disequilibrium did truly exist in either or both simulated populations , method  <dig> was able to detect it with a remarkably higher statistical power than the other two methods. in particular, when the disequilibrium had opposite signs in the two contributing populations , the highest detecting power was observed for method  <dig> no matter whether the case and control sample was collected from the contributing populations separately or as admixture of the populations. in contrast, the χ <dig> test based methods failed to detect the disequilibrium under such circumstances. these findings strongly support the improved statistical efficiency of the likelihood-based method presented here and its robustness to inherent genetic structure in the case and control samples.

population genetic parameters defining two genetically divergent populations and empirical statistical powers of methods 1– <dig>  for detecting significance of linkage disequilibrium between a polymorphic marker and a putative disease locus. the empirical power was calculated from  <dig>  repeated samples of  <dig>  cases and  <dig>  controls as the proportion of the test statistic surpassing the bonferroni threshold 5 × 10- <dig>  the admixed samples were made up of 57% cases and 76% controls from population  <dig> and the rest from population  <dig> 

while the true penetrance parameters at a disease locus are indeed unknown in practice, we proposed incorporation of the penetrance parameters with predefined values of ,  or  into the analysis. this is mainly to ease the problem of over-parameterization and to set the penetrance differ among the different disease genotypes whereas the true but unknown penetrance parameters could be far less than  <dig> for any single locus genotype that contributes to genetic variation of common polygenic disease traits. we investigated how the use of mis-specified penetrance values would influence performance of the association tests through computer simulation. the simulation considered the scenario where the disease genotypes had very low levels of penetrance. table  <dig> illustrates means and standard deviations of the test statistics and empirical power calculated from method  <dig> when true values of the penetrance parameters were used and when the penetrance parameters were set to be constant, i.e. f1-3 =  as those implemented in the above data analysis. it can be seen that mis-specification of the penetrance parameters in analysis of the simulation data with the method has not caused a marked loss of statistical power in detecting the genetic association nor led to increase in false positive inference of association when the marker and disease loci are truly in linkage equilibrium . this thus removes the concern about appropriateness to use the predefined setting of disease penetrance in the method developed here.

means and standard deviations  of estimates of empirical statistical power  and the test statistic based on  <dig> cases and  <dig> controls from  <dig> repeated computer simulations. the left panel lists values of the simulation parameters and the right the estimates. ρ is estimated as proportion  of significant tests at the bonferroni threshold 5 × 10- <dig> in  <dig> simulations.

* when the true simulated parameters were used in the association test.

** when the penetrance parameters f1- <dig> were constantly set to be .

discussion
we have shown that armitage’s trend test  <cit> , the most popular statistical strategy implemented in the current literature of gwas with a case–control setting, is highly vulnerable to sampling schemes and genetic structure embedded in the samples. to address this problem, we have developed a novel statistical method that is robust to these influential factors and confers a more powerful test. we have demonstrated the robustness and improved statistical power of the new method through  re-analysis of the large-scale snp genotype datasets of the pd cases and controls collected from multiple geographical cohorts  <cit> , and  through computer simulation studies. the new method was able to detect a total of  <dig> snps in significant association with the disease phenotype, which distributed in  <dig> chromosomal regions of size < 1 mb largely in le. only two of these regions are detected by the other methods under comparison. among the newly detected significant snps, some are within or nearby the pd candidate genes previously reported in the literature and the rest novel discoveries. a bootstrap-based analysis shows that the new method has consistently higher posterior probabilities at the significant snps than the compared methods, suggesting the remarkably improved robustness of the former to the sampling problem.

we have solved three major problems in the methodology development. firstly, genotype at the disease locus is not observable. this has led formulation of the model parameter estimation to be built on the principles of statistical analysis with missing data  <cit> . secondly, the case and control samples rather than random samples are used to infer ld between any polymorphic marker locus and a putative disease locus. several recent researches addressed this problem and developed methods for association analysis with case and control samples  <cit> . our method differs from them in several key aspects. the present method is developed on the basis of an explicit population genetic model which is fully characterized by population frequencies of alleles at marker and disease loci as well as the coefficient of ld between the two loci. this model enables development of a novel statistical approach for directly estimating the model parameters and in turn statistical test for significance of the genetic association is built on the estimates. given that the accurate estimation of the disequilibrium parameter is crucial for the reliability of any ld analysis including ld-based mapping of complex genetic disease traits  <cit> , this model based analysis may explain outperformance of the parametric approach over the existing nonparametric rivals. moreover, we presented a simple but plausible statistical model  for demonstrating how the population structure embedded in the case and control samples would affect any association study which tests for significance of the difference in marker allele frequency between cases and controls such as the armitage’s trend test and many others such as the well-known mantel-haenszel test. with the present notation used to derive equations  and , we are able to demonstrate that the mantel-haenszel test statistic has a form of

  χm2≈Δp^m-∑i=1kri-sip^mi2/∑i=1k <dig> n2risini∑j=1knjcase∑j=1knjcontrolp^mi1-p^mi 

which follows a chi-square distribution with  <dig> d.f.. comparison of equation  to equation  shows that the two test statistics share the same numerator, and the denominator of χg <dig> is only slightly larger than that of χm <dig>  thus, the mantel-haenszel test is approximately equivalent to the method  <dig> which has been explored in the present study. moreover, we demonstrated in additional file  <dig> that the mantel-haenszel test was indeed equivalent to the widely employed logistic regression approach for analyzing stratified case and control samples such as the pd datasets. either the present method  <dig> or the mantel-haenszel test provides an efficient alternative to the logistic regression in testing for association using case and control samples with known stratification. thirdly, the likelihood-based method developed in the present study confers the flexibility to fit in different fixed effects in different populations and is thus logically appropriate to integrate cases and controls collected from genetically different cohorts or populations like the pd case and control samples we thoroughly analyzed here. although a rich literature has been available for prediction of genetic structure of a census population from random samples of the population, there is no relevant theory and method established to make the prediction from case and control samples. in the present study, we have assumed that the population origin of the case and control samples is previously known. this assumption is perfectly satisfied in many association studies, as illustrated by the pd datasets, where the cases and controls are collected from known populations or cohorts.

it needs to be pointed out that a full model involves a total of six unknown parameters and thus presents an over-parameterization problem to statistical analysis under the model. to ease the problem, we have firstly proposed to estimate the marker allele frequency, p, from control samples. this is largely because the likelihood function  is formulated in terms of two intermediate variables q and r as described in table 1a, and these have imposed non-linear constraints on the three parameters p, q and d. it is thus impractical to work out estimates of these three parameters independently and simultaneously. we explored how the proposed method to estimate p would affect estimation of the parameters q and d and in turn statistical power of the association test. in fact, the marker allele frequency, p, in the controls can be expressed in the present notation as

  p′=prpr+prpr=p+df2-f1q+f3-f21-q1-π 

where π = f1q2 + 2f2q + f <dig> is the population prevalence of the disease attributed to the disease locus. the second term, i.e. the bias, will be negligible when π is low. to illustrate magnitude of the bias, we worked out the absolute difference |p’-p| and illustrated for a wide ranges of the population settings in additional file  <dig>  it is clear that the absolute value of bias will not exceed  <dig>  if π is less than 10%. it should be stressed that the bias presented here is its largest possible value because it was calculated at the maximum value of the disequilibrium parameter d. in addition, we compared the rate of false positive and statistical power of method  <dig> when the true and biased values of marker allele frequency were used in analysis of simulation data under a wide range of settings. the results of the analysis summarized in additional file  <dig> show that use of marker allele frequency estimates from control samples does not result in any notable difference in the false positive rate and test power from use of the true marker allele frequencies. all these thus suggest that the way we proposed to calculate the marker allele frequency will not lead to any serious influence of the method developed in the present study for its efficiency in the association test.

in spite that the population genetic model has been focused on the most prominent ld measure, d as defined in table  <dig>  there are several other scaled or standardized disequilibrium measures such as d’, r <dig> and some others  <cit> , which are frequently used in the literature. the robustness and improved statistical efficiency achieved in inferring d will be inherent to that of the transformed versions of the parameter  <cit> . although the method is developed for complex quantitative traits with discrete phenotypes, it would not involve major technical difficulty to extend the ideas and principles behind the newly developed method to cope with continuous phenotypes. genetic heterogeneity may add extra complication to genetic control of common disease traits and is not taken into account in the present model and analysis. in presence of genetic heterogeneity, disease disposing loci may differ in different populations or cohorts. a direct and intuitive consequence of the heterogeneity would be a weakened test power because the effective sample size for detecting the marker-disease association at a test site is actually reduced when compared to the census sample size.

CONCLUSIONS
we have developed a novel likelihood based statistical approach to model linkage disequilibrium between any genetic marker locus and a putative disease locus in a randomly matting population and to infer the disequilibrium parameter and other population genetic parameters from case and control samples from the population under a likelihood based framework. the model and likelihood based approach are implemented to re-analyze large snp datasets of the parkinson disease case and control samples collected from multiple human cohorts. statistical properties and utility limitations are investigated through simulation studies. based on the simulation data analysis and analysis with the parkinson disease case and control sample, we demonstrate that the likelihood based approach outperforms the trend test and logistic regression methods for an increased statistical power and reduced false positive inference, which are popularly implemented in the gwas literature.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
zl conceived and designed the study. zl and mw developed the theoretical analysis. mw, lw, nj and tj implemented the simulation and analyzed the pd datasets. zl and mw wrote the paper. all authors read and approved the final manuscript.

supplementary material
additional file 1
mathematical forms of the coefficients in normal equations  and .

click here for file

 additional file 2
top two principal components from principal component analysis  of the stage i dataset.

click here for file

 additional file 3
association scans from stage ii and two-stage combined samples.

click here for file

 additional file 4
scheme a simulation under dominant and recessive genetic models.

click here for file

 additional file 5
structured association using logistic regression.

click here for file

 additional file 6
predicting marker allele frequencies from control samples.

click here for file

 additional file 7
simulation results from using biased estimates of maker allele frequency.

click here for file

 acknowledgements
we thank dr. thomas gasser of neurodegenerative diseases and german center for neurodegenerative diseases  and dr. andrew b singleton at national institute on aging  for allowing us to re-analyze the parkinson’s disease datasets. we thank two anonymous reviewers for their comments and suggestions which have been useful for improving presentation of the paper. this study was supported by research grants from the leverhulme trust  and the national basic research program of china . zl is also supported by china’s national natural science foundation.
