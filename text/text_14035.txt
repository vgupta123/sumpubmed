BACKGROUND
the recent progress in genome sequencing techniques has led to the development of genome-level models of metabolism that have been analyzed using constraint-based approaches, such as flux-balance analysis   <cit> . the success of fba stems from the fact that, unlike kinetic models, fba aims to identify optimal metabolic steady-state activity patterns that satisfy constraints imposed by mass balance, the metabolic network structure, and the availability of nutrients. the most common cellular task to be optimized  is that of growth, although other choices are possible depending on the selective environment of the cell  <cit> . the fba framework has been applied to many genome-level models  with great success, as well as the systematic prediction of genetic knockout phenotypes  <cit> , the global organization of metabolic fluxes  <cit> , and the discovery of novel regulatory interactions  <cit> . however, fulfillment of systems biology’s goal to generate models that integrate data from all cellular levels , and can accurately predict metabolic phenomena under different environmental conditions has hitherto been hampered by minimal application of regulatory constraints.

according to the central dogma of biology, information flows from dna to mrna and ultimately to enzymes which catalyze and regulate various cellular functions. hence, one might envision a fully “hierarchical” regulation of metabolism where expression levels of mrna correlate directly with the amount of enzymes and thus with the flux through associated reactions. for some conditions, this simplified assumption can be used for the purpose of modeling metabolic activity  <cit> . however, this type of hierarchical control does not take place in general since there are several levels of flux regulation which operate separately from the purely genetic. these mechanisms include variations in protein translation, protein activation/inactivation and metabolite regulation of enzymatic activity. studies have shown that even within one pathway there may exist a variety of flux regulatory mechanisms for each reaction that range from purely hierarchical to fully metabolic control  <cit> .

the varying role of hierarchical regulation for network reactions has limited the utilization of gene-expression data to improve predictions of genome-scale metabolic models. the earliest attempt at imposing transcriptional regulation on constraint-based models was conducted by palsson and coworkers who developed regulatory flux-balance analysis   <cit>  where, using boolean logic, a transcriptional regulatory network was superimposed on an fba model. rfba can be used to predict a form of quasi-dynamic flux profile  in a changing environment. the time course of an experiment is divided into a number of successive short intervals and at each time step, new regulations based on metabolic steady state of the previous time is formulated. next, fba is used to predict a steady state flux that is consistent with the set regulatory rules at that moment.

later, nielsen and coworkers  <cit>  further developed the idea of combined regulatory metabolic control by implementing gene-expression data as a boolean switch to block the activity of any reaction for which the responsible mrna was not expressed. further progress on this methodology was made when becker and palsson  <cit>  introduced the gene inactivity moderated by metabolism and expression  algorithm which uses a set of pre-determined thresholds for transition of each gene from “on” to “off”. the user selects a priori a minimally acceptable outcome for the fba models and gimme iteratively activates genes that were initially turned “off” in order to ensure that the fba model achieves its required metabolic functionalities.

another method dubbed e-flux  <cit>  uses gene-expression values to relatively regulate the flux that reactions in a model can carry. in a process akin to “setting the width of pipes” in a network, e-flux uses gene-expression data for different conditions to set normalized relative upper flux limits on affected reactions and then optimize a previously chosen objective function. although the method is innovative in that it utilizes the actual gene-expression data, it is still limited in that a) it requires a pre-determined objective function for the condition associated with the gene-expression data, and b) the flux limit for each reaction is purely determined by the value of gene-expression values, and hence is unlikely to account for metabolic regulation. all subsequent advances involve utilizing mixed-integer linear programming  to identify cellular states that optimally adhere to both regulatory and metabolic regulations.

the introduction of steady-state regulatory flux balance analysis   <cit>  which utilizes milp to maximize biomass growth while concurrently trying to adhere to the maximum number of regulatory constraints, allowed a detailed quantification of the extent to which metabolic and transcriptional regulation control the metabolic behavior of a cell. jensen and papin further improved this mode of analysis by developing the metabolic adjustment by differential expression  methodology  <cit> . this method, unlike gimme, does not require a prior selection of expression thresholds and instead uses milp and the statistical significance of changes in gene-expression to develop a metabolic model that recreates the measured expression dynamics while ensuring that the fba model maintains previously determined threshold functionality. although these methods have been useful in qualitatively predicting gene-expression patterns and metabolic adjustments between different conditions, they are limited by the fact that they require an a priori user-defined objective function and also do not fully make use of the predictions of fba models; thus, a significant portion of the available data is not fully utilized.

further work by shlomi et al.  <cit>  that has been incorporated in the imat algorithm  <cit>  uses gene-expression data and a boolean gene-to-reaction mapping to impose hierarchical regulation on a metabolic model. here, affected reactions are classified based on associated gene-expression data as either highly expressed , moderately expressed or lowly expressed . imat utilizes milp to identify a possible steady-state flux distribution among those that maximize the number of reactions with predicted flux consistent with the gene-expression data as well as the model’s stoichiometric and thermodynamic constraints. thus, the goal of imat is to maximize the sum of the number of reactions in rl that carry a flux of zero, and the number of reactions in rh that carry a flux greater than an arbitrarily chosen threshold  <cit> . consequently, imat maximizes only the pattern of hierarchical regulation. although the method has been successfully applied to model different human tissues  and other multi-cellular organisms  <cit> , the utility of the method is limited since ensuring that active reactions carry a minimum flux does not necessarily ensure that the model can predict correct cellular objective flux. despite these deficiencies, imat has a strong advantage over other methods  <cit> , in that it does not need a predefined set of required metabolic functionalities and an fba objective function.

here, we present a new approach that uses gene-expression data to optimize not only the pattern of hierarchical regulation, but also the level of differential gene-expression within the rigid framework of metabolic constraints placed on a system by the connectivity of the reaction network. although our steady-state based method does not account for capacity limitations in various enzymes, and thus the beneficial, deleterious or regulatory role of metabolite concentrations, the model's adherence to conservation of mass balance and network connectivity imposes pseudo-metabolic regulation. the coupled interaction of this absolute form of metabolic control with optimal hierarchical control in gene-expression fba  improves our theoretical capabilities for analyses of a wide range of phenomena, such as cellular responses to environmental perturbations which traditionally have been considered outside the realm of fba.

a recently published approach by lee et al.  <cit>  is also focused on using actual gene-expression levels to guide metabolic flux prediction. however, this method differs significantly from gx-fba in that it minimizes the absolute difference between metabolic fluxes and gene-expression data from rna-seq experiment.

to illustrate the utility of gx-fba, we have analyzed the genome-scale metabolic model for the etiological agent of bubonic plague, the gram-negative bacterium yersinia pestis   <cit> . we have studied yp’s genome-scale metabolic response in physiologically important conditions: temperature shifts known to induce virulence in low calcium media  <cit> , as well as its response to stress induced separately by the antibiotics streptomycin and chloramphenicol. our analyses open windows into the metabolic workings of this bacterium while it survives within macrophages following initial introduction into a mammalian host, proliferates in the blood, and attempts to resist therapeutic efforts. our analyses indicate that majority of cellular metabolic changes associated with response to stress is unique to the type of perturbation. the only common adaptive response to all four types of stress was for yp to initiate a series of energy saving measures.

methods
reconstruction of the metabolic network
the yersinia pestis model ian818m  <cit>  is based on the annotated genome of strain  <dig>  <cit> . the model was extensively hand-curated to ensure compliance with experimental observations, accounting for the activity of  <dig> of the  <dig> metabolism-related genes  in the genome. several studies  <cit>  have shown that the composition of yp’s cellular membrane changes when the cell transitions from the flea gut environment  to that of the mammalian host . this phenomenon has been implemented in the model by developing two separate biomass compositions. the model includes the pathways for production of yersiniabactin virulence factor; however it currently does not contain the biosynthetic pathways for the production of other pathogenic proteins such as yersinia outer proteins. for a detailed summary of the model characteristics and a complete list of the metabolic reactions see  <cit> . recently, another reconstruction for a virulent strain of yp was developed  <cit> . we have used the ian818m model in our analysis since the gene-expression data are collected from avirulent strains that are more closely related to strain  <dig> 

flux balance analysis 
fba is based on representing known metabolic reactions of an organisms by the stoichiometric matrix, s , where m is the number of metabolites and n the number of different reactions. applying the assumptions of mass balance and metabolic steady-state, we find the following set of linear equations governing the system’s behavior:

 dxidt=∑sijνj= <dig>  

where xi is the concentration of metabolite i. other limitations that are imposed on a system based on experimental studies enforce that the amount of flux through a reaction, the amount of nutrients imported, or waste products secreted from the organism have a lower and upper boundary:

 α≤vi≤β, 

 χ≤bi≤ϕ, 

where bi and vi are the export/import flux of metabolite species i, and the flux through internal reaction i respectively, and α, β, χ, and ϕ are the lower and upper limits for these fluxes. finally, fba utilizes linear programming to determine a feasible steady-state flux vector that optimizes an objective function, most commonly chosen to be the production of biomass, i.e., cellular growth.

gx-fba: flux optimization constrained by mrna expression data
we combine mrna expression data with a constraint based framework through the following multi-step approach. note that, we only use mrna expression data for genes that are included in our metabolic model. additionally, we choose to only take into account gene-expression changes of at least 50% . we have ensured that this particular choice of threshold value does not significantly impact our results. note, however, that if the threshold is set to a large value, only a few constraints are imposed on the model, which obviously will have a large impact on the gx-fba predictions.

we have implemented the gx-fba algorithm in a script  that is contingent upon the cobra toolbox for matlab  <cit>  with the gurobi optimizer  <dig> . <dig> linear programming solver . our methodology is as follows:

  generate the wild-type flux distribution νiwt for the starting condition  using an interior point optimization algorithm with biomass growth or any other appropriate goal as the objective function.

  for nutritional constraints associated with the post-transition environment ), flux variability analysis   <cit>  with minimal flux for biomass production set to zero is utilized to calculate the lower and upper fluxes that each model reaction i  can carry solely based on environmental limitations and network connectivity. from these results, the mean possible flux value for each reaction i  and average flux carried by all active reactions  is determined.

  identify the set of reactions t for which an mrna expression value can be associated. using the results of the fva analysis , reactions that carry unreasonably high flux values  are eliminated, since these reactions could cause numerical problems when solving the gx-fba objective function and likely take part in type iii extreme pathways  <cit> . for protein complexes and reactions catalyzed by isozymes, the maximal up- or down-regulation value is used unless the mrna expression values are inconsistent . in the latter case, the reaction is excluded from t.

 for each internal metabolic reaction i in t, a new constraint βi = cimrnaνiwt is assigned if the mrna expression is up-regulated, and αi = cimrnaνiwt if it is down-regulated, where cimrna is the mrna expression ratio and αi and βi are the lower and upper constraints of flux i.

 construction of the new objective function:

 z=∑i∈tlog2cimrnaνiν―i. 

  if the wild-type value of a reaction i is zero, νiwt and v―i are set equal to the average value for all active reactions  and hence:

  · for up-regulated reactions βi=cimrnaν―all.

  · for down-regulated reactions αi = <dig> 

note that reversible reactions are not included in t and z. this is because of challenges in reconciling the biochemical concept of reaction flux with mathematics of linear programming. for example, whereas in linear programming a value change from  <dig> to − <dig> is a minimization, in terms of biochemical flux, the activity of the enzyme has increased by a factor of  <dig> . in order to decrease the number of reversible reactions and increase the number of reactions that are included in z, the result of the fva analysis is used to identify those reactions that although normally reversible, under the conditions imposed by environmental constraints carry flux in only one direction. subsequently, the designations of these reactions in the model are changed and they are included in the formulation of z. also note that biomass production is not explicitly included in this choice of objective function z. when studying the transition of yp from 26°c to 37°c, we used the growth of yp in tmh at 26°c as the wild-type reference state. for the case of antimicrobial agents, we used yp growing at 37°c in tmh as the reference state.

comparison with measured flux measurements
in order to test the accuracy of gx-fba’s predictions, we analyzed a set of experimentally measured flux changes for yeast growing on  <dig> different carbon sources  <cit> . we employed the yeast model  <cit>  derived from lange  <cit>  and used the reported gene-expression measurements to constrain the gx-fba model. for each analysis, as the primary nutrient for yeast switched from a to b, we used the fba predicted flux pattern for yeast as it grows on nutrient a as the reference flux. we evaluated gx-fba by calculating the relative deviation between the fluxes for a reaction in two conditions as:

 dr=x−yx+y 

where x is the flux of a reaction in condition  <dig> and y is the flux of the same reaction in condition  <dig>  since |dr| ∈ , we consider dr a percentage flux change from condition  <dig> to condition  <dig>  for conditions where both x and y are zero, we define dr= <dig>  thus, we may calculate the average  percentage error in gx-fba predicted flux by calculating

 e=1n∑i=1n|dgx−fbai−dexpi| 

where the sum is over the n reactions for which there is experimental flux data.

degeneracy of optimal fba solutions
to gauge the effect of degeneracy in the fba optimal flux state  above) on the set of gx-fba solutions, we used the following approach which is a variation on an effective random sampling method previously suggested  <cit> :

 identify the optimal value of the fba objective function, z*fba.

 for each model reaction i, use flux variability analysis  <cit>  to identify a lower and upper flux bound αi* and βi* respectively, for which zfba=z*fba is feasible.

 identify the reaction set r, consisting of all reactions for which αi* ≠ βi*.

 randomly select a reaction from r and fix its reaction flux to a random value νi* ∈ .

 calculate the fba optimal flux state subject to νi = νi*.

 calculate the gx-fba optimal flux state using the fba optimal state in . from the resulting flux profile, we determine the value of zgx-fba, the maximum and minimum biomass production flux, as well as agreement with fluxomic measurements.

 repeat from step .

for each of our simulations we sampled  <dig> different fba optimal flux states.

RESULTS
we argue that to properly analyze mrna experiments for their systems-level impact on cellular metabolism, it is necessary to couple these experimental data with a theoretical framework that takes metabolic network connectivity and mass conservation into account. in contrast to the expression activity of a single gene, the metabolic activity of a reaction not only depends on the expression of the enzyme, but also on the abundance of its substrates and products. thus, the activity of a single reaction is conditional on the structure of the metabolic network as well as the network’s global activity pattern.

it has previously been observed experimentally that gene-expression profiles provide qualitative descriptions of metabolic flux activity  <cit> . however, while a direct coupling between mrna expression and enzyme activity has been observed for some genes, such a quantitative relationship between levels of transcripts and metabolic flux does not exist in general  <cit> . for some genes, it is even observed that the strength of the coupling changes with variations in cellular environment, going from direct coupling to independent behavior  <cit> .

by maximizing the qualitative and quantitative agreement between flux profile and gene-expression pattern subject to metabolic feasibility, we allow the relationship between transcription level and flux to span the full range of possible coupling strengths. to this end, we have developed a new constraint-based approach for combining gene-expression data and metabolic flux analysis, gx-fba, which explicitly takes mass conservation and the connectivity of a metabolic network into account . a simple example of how gx-fba implements regulation via gene-expression is presented in figure  <dig> 

sample case: central carbon metabolism following external perturbation
in figure  <dig>  we use an abbreviated description of central carbon metabolism to demonstrate how gx-fba incorporates gene-expression data, mass conservation, and network connectivity to predict cellular behavior following an external perturbation . in this simple model , glucose is the sole nutrient imported into the cell. as with most fba calculations, we chose maximum biomass  production as the objective function by formulating a simple bm reaction composed of carbohydrates and nucleotides . we finally impose an upper limit on import  of glucose  and an arbitrary energy maintenance cost of  <dig> units of atp. a complete stoichiometric description of this model is included in the additional file  <dig> 

as shown in figure 1a, fba predicts that the cell fully uses oxidative metabolism, producing atp with complete conversion of glucose carbons into bm and co <dig>  figure 1b, displays the possible range of fluxes for reactions  <dig> and  <dig> when satisfying both the stoichiometric and the import/export constraints of the model. due to the fixed energy burden associated with cellular maintenance, the flux associated with glycolysis  can never be zero. additionally, the tca flux cannot be zero for a growth state, since gtp is essential for the production of bm.

in figure 1c, we impose a possible genetic up/down regulation on select network reactions, emulating an incomplete set of expression data for genes associated with metabolic reactions. the expression pattern portrays a possible cellular response to decrease in the concentration of oxygen in the medium: the glyoxylate shunt and reactions involved in anaerobic atp production are up-regulated, whereas reactions associated with oxidative energy production are down-regulated. the displayed reaction flux values correspond to the gx-fba predicted metabolic activity pattern, showing that imposition of these gene-expression dictums in combination with the constraints of network connectivity lead to a notable decrease in the rate of bm production. also, as is common with anaerobic metabolism, a large fraction  of imported carbons is not fully utilized, instead being exported as co <dig> and malate. figure 1d, shows the new allowable flux ranges for reactions  <dig> and  <dig> when subject to the constraints imposed by gx-fba. note that, the glycolytic fluxes increase only by 14%, far less than the 700% and 50% up-regulation prescribed by the gene-expression levels. the two reasons for this are: a) based on the linear connectivity of the glycolytic pathway, the up-regulation of reaction  <dig> cannot surpass the smaller up-regulation of reaction 2; and b) a further increase in glycolysis would produce atp molecules that cannot be consumed in this simple metabolic model, and thus, the absence of a pathway for atp export limits the rate of glycolysis.

finally, a direct consequence of the network connectivity is that down-regulation of reaction  <dig> is incommensurate with up-regulation of reaction  <dig>  since the gx-fba flux solution corresponds to the activity pattern maximizing its objective function and reaction  <dig> has a greater shadow price  than reaction  <dig>  reaction  <dig> is up-regulated while the flux for reaction  <dig> remains the same. this serves as an example of hierarchical regulation through the gene-expression dictum not controlling the final flux activity pattern. overall, the predicted gx-fba solution for this sample problem agrees with expected metabolic behavior when oxygen concentration in the medium is reduced.

it is immediately evident that gx-fba shares certain features with the imat method, in particular, the use of gene-expression data to constrain the overall metabolic activity pattern and absence of a need to predetermine required cellular functionalities. however, in the following we will point out three significant differences between the two approaches. first, imat maximizes the number of up and down regulated reactions, not taking into account the magnitude of change in expression level. instead, gx-fba aims to maximize the correlation between differential changes in gene-expression and reaction fluxes, explicitly taking the level of differential gene-expression into account. second, gx-fba does not use a binary criterion for pattern maximization whereby the metabolic flux of reactions corresponding to highly expressed genes must exceed an arbitrarily chosen threshold value and that of lowly expressed genes should be zero  <cit> . third, gx-fba is based on the level of differential gene-expression between two activity states, here chosen as the unperturbed wild-type  and a stress state, although other pairs of activity states are possible. in contrast, imat may use as input the gene-expression pattern of either a single experiment or the consensus pattern from a compendium of experiments, thus forgoing the introduction of an objective function for any of the activity states.

application to saccharomyces cerevisiae metabolic network
in order to validate gx-fba’s utility for predicting changes in flux activity based on gene-expression data, we used the method to examine the metabolic behavior of s. cerevisiae under different nutritional environments. the experimental flux measurements and microarray data are from daran-lapujade et al.  <cit> . the metabolic network model used for the simulations is the same augmented model developed by lange  <cit>  that was used in  <cit> .

to compare gx-fba with the experimental data, we used the measured flux values to calculate the relative changes  in each reaction’s flux activity as the eukaryote transitions between different growth conditions . this calculation was repeated for the gx-fba predicted results using wild-type fba flux values as reference state. the average percentage error   between measured and predicted flux magnitude changes was calculated, finding on average that e = 21%. furthermore, to assess the capability of gx-fba to accurately identify metabolically active reactions after a perturbation, we compared the results of our predictions with experimental measurements and calculated the average precision  and recall  values . these results compare favorably to those reported by shlomi et al.  <cit> . 

effects of alternate optimal fba solutions
the gx-fba objective function depends on details of the fba optimal state , making it necessary to evaluate the possible impact of degenerate optimal fba flux states  <cit>  on the gx-fba solutions. implementing a random sampling approach of the degenerate fba optimal states , we used the s. cerevisiae model and gene-expression results to measure the impact on the optimal value of the gx-fba objective function, zgx-fba . we found that approximately 99% of the samples are contained within a 10% variation  of the most likely value for zgx-fba. furthermore, panel 2c demonstrates that the optimal fba flux state degeneracy has minimal impact on the gx-fba predicted growth yield. note that, in the remainder of this paper we have ensured that reported responses are robust to degeneracy in the fba optimal state.

application to yersinia pestis metabolic network
yp is one of the most prolific killer organisms of all time. conservative estimates stipulate that  <dig> million people have been victims of bubonic plague in various pandemics throughout human history  <cit> . there is still no working vaccine available for this malady. while plague is frequently considered a disease of the past, several thousand new cases are reported each year, predominantly in africa  <cit> . hence, the recent reports of multiple-antibiotic-resistant strains of yp  <cit>  are cause for great concern. we have applied gx-fba to four publicly available mrna expression data sets of yp using the published genome-level metabolic model ian818m  <cit>  and identified common motifs of yp metabolic response to different forms of stress. table  <dig> displays the number of genes and reactions that were constrained in our model for each set of mrna expression results. in particular, we focused on alterations in gene-expression of yp following environmental temperature changes  <cit>  and exposure to antibiotics  <cit> . figure  <dig> summarizes the predicted changes to microbial metabolism following each perturbation. 

the number of up/down regulated genes in the gx-fba simulations differs from the number of genes present in the model because of the imposed selection criterion .

genome-level evaluation of metabolic response to temperature perturbations
we used two available mrna expression data sets for yp’s response to temperature change, one for strain  <dig>  <cit>  and one for strain kim <dig>  <cit> , to examine global changes in the cell’s metabolism resulting from this lifecycle transition. it has previously been demonstrated that for yp an increase in temperature from 26°c to 37°c may induce a transition from avirulent phenotype to virulence  <cit> .

a scatter plot for the overlap of the two mrna expression data sets, figure  <dig> demonstrates that, although both strains are of the mediaevalis biovar, their response to the temperature increase is highly non-uniform. the primary difference between the datasets is presence of ca2+ cation in the medium. gene-expression data for strain  <dig> were derived from bacteria grown in a calcium-poor environment while the data for strain kim <dig> are from samples grown in a ca2+-rich  medium. this single difference results in phenotypic variations that can explain the observed dissimilarities between the gene-expression results. the cellular behavior dubbed ‘low-calcium response’  refers to the observation that following the transition from  <dig> to 37°c and in the absence of ca2+ , virulent strains of the bacteria undergo bacteriostasis within one to two generations. it has been suggested that lcr is necessary for adaptation of yp to the intracellular host environment  <cit> . start of lcr occurs under a narrow range of conditions. at 26°c, yp does not require specific amounts of ca2+ to grow; however, at 37°c, a minimal ca2+ concentration of  <dig>  mm is required to repress the lcr. 

using the available gene-expression data and gx-fba, we analyzed the metabolic underpinnings for the observed phenotypic behaviors. computational simulations for strain  <dig> predict a significant decrease in flux for biomass production upon transition from 26°c to 37°c, while simulations of strain kim <dig> find the flux of biomass production at 37°c is nearly equal to that of 26°c . these results are in good agreement with experimental observations  <cit>  despite the fact that gx-fba does not directly manipulate or optimize cellular growth rate. 

metabolism of yp at 37°c in a low calcium environment
as can be expected, the onset of lcr in yp leads to a great deal of metabolic change. our gx-fba simulations of the temperature transitions in ca2+-free and ca2+-rich aerobic tmh environments  <cit>  also point to drastic differences in the metabolic activity . the two most significant differences in genome-scale metabolic activity pattern in the presence and absence of ca2+ involve use of oxidative means for the generation of energy and metabolism of amino acids and fatty acids. 

in the lcr case, the oxidative portion of the tca cycle is greatly down regulated and the organism relies more on the glyoxylate pathway to bypass this diminished process and convert the byproducts of glycolysis into malate and oxaloacetate. this behavior makes sense for an organism preparing to enter bacteriostasis and reducing its energy demands.

although transition from 26°c to 37°c elevates metabolism of some amino acids such as arginine, the onset of lcr reduces biosynthesis of some amino acids that are essential for growth . in case of arginine, the up regulated pathways point to subsequent conversion of this amino acid to the metabolically more tractable compounds succinate and glutamate, and thus the process is clearly linked to the global carbon and nitrogen metabolism.

in addition to being used as a carbon source, another possible reason for increased production of arginine could be the need to boost production of ornithine, which is a precursor for production of polyamines. polyamines are cationic organic compounds which modulate dna, rna and protein synthesis and are essential for cellular growth  <cit> : in yp, polyamines are also necessary for the production of biofilms in the flea gut and thus aid in the process of transmission from fleas to mammals  <cit> . however, more important for conditions that resemble intracellular environments, polyamines can act as free radical scavengers and protect the cell from oxidative damage  <cit> .

furthermore, it is known that polyamines up-regulate the oxyr and katg genes in e. coli, which are responsible for the induction of catalase and peroxidase detoxifying enzymes  <cit> . gx-fba results also suggest that the change in temperature leads to increases in the catalase-peroxidase activity in strain  <dig>  this activity is known to play a prominent role in aiding colonization of the host by helping the bacteria resist oxidative attacks of phagocytes  <cit> . the catalase or catalase-peroxidase activity is common to most pathogens; however, experimental data have shown that this activity in yp is extremely high  <cit> . thus the gx-fba predicted increase in catalase-peroxidase activity is in agreement with known fact that resistance to reactive oxidative species  produced by macrophages is critical for yp during initial stages of infection  <cit> . thus, it is plausible that the elevated rate of the arginine production following onset of lcr is an attempt by yp to combat oxidative stress.

in order to determine the primary causes for the reduced flux of biomass production in strain  <dig>  we systematically analyzed the effect of the mrna expression value of each individual gene. although we observe reduced activity in energy metabolism, particularly oxidative phosphorylation , our detailed analysis suggests that the noted diversion of amino acids toward energy consumption pathways is one of the leading causes for the predicted reduced cellular biomass production. for example, an increase in the activity of threonine dehydratase  leads to diversion of serine toward production of pyruvate and ammonia and away from production of biomass. threonine dehydratase plays a critical role in production of isoleucine and valine; however, because these amino acids cannot be produced by yp, the increased activity is directed toward catalyzing alternate reactions. note that uncovering such drastic system level shifts in metabolism and assessing their importance on altering the bacterial growth rate is difficult purely from the analysis of gene-expression data, and hence underscores the importance of using tools such as gx-fba to fully extract information from empirical data.

metabolism of yp at 37°c in a calcium-rich environment
although the growth rate for yp in presence of ca2+ does not differ between  <dig> and 37°c, gx-fba analyses indicate that there is a significant difference in yp metabolism between the two temperatures. particularly, our analyses indicate that upon transition to 37°c and environments akin to human blood yp switches to an extensively profligate mode of metabolism. it has previously been observed that metabolism of yp can be highly inefficient  <cit> . it initiates extensive uptake of metabolites from the medium and given that the growth rate is similar to that at 26°c, majority of these compounds are not used for production of biomass.

although the pathways for production of fatty acids and glycerophospholipids  are enhanced, the products are not being used for biomass production. empirical analysis of the fate of these compounds could provide important new insight into bacterial objective during proliferation.

metabolic response to antimicrobial agents
early treatment with antibiotics is an effective method of caring for plague patients. two of the antibiotics of choice for such treatment are chloramphenicol and streptomycin  <cit> . we used available microarray mrna expression profile of yp  following interaction with these two antibiotics  <cit>  to gain a better understanding of each antibiotic’s mode of operation. the results of these studies are reported in table  <dig> and figures  <dig> and  <dig>  our model predicts that, if one focuses on metabolism alone, neither antimicrobial agent fully halts cellular growth. following contact with either antibiotics, growth potential drops to about half of its wild-type value. because it is known that the primary targets of both of these antimicrobial drugs are protein-production processes, and given the fact that our model does not explicitly account for the different stages of mrna translation, our prediction of finite growth yields is not surprising. 

for streptomycin the reduction is caused by changes in the activity of a number of critical energy-producing pathways such as the citric acid cycle and oxidative phosphorylation, as well as some biosynthetic pathways such as those for production of purines and some amino acids . interestingly, gx-fba predicts that after treatment with streptomycin, production of another set of essential amino acids  is increased. given the reduced growth yield of the bacteria, these amino acids must serve an alternate purpose than inclusion in microbial biomass. elucidating this role might aid in enhancing the bactericidal capacity of streptomycin.

upon interaction with chloramphenicol, the activities of nearly all of yp pathways that are crucial for synthesis of biomass, including glycolysis, urea cycle, and pathways for production of fatty acids and lipopolysaccharides, are reduced.

interestingly, our simulations show that following interaction with both antibiotics, pathways of riboflavin metabolism in yp are enhanced. some early studies  <cit>  have shown that treatment with streptomycin and some other antibiotics stimulates growth of rats receiving suboptimum amounts of riboflavin, thiamine and pantothenic acid. it has been believed that antibiotic-induced elimination of certain gut bacteria that compete for these compounds is the main reason for the growth stimulation. however, our results seem to indicate that increased bacterial production of these compounds could also serve a stimulatory role.

common post-stress metabolic motifs
as can be seen from figures  <dig>   <dig> and  <dig>  when comparing the metabolic activity of yp in the four experiments discussed above, we can identify only a small set of metabolic pathways for which the flux always either increased or decreased when compared with the pre-perturbation metabolism. metabolic activity for pathways  of purine and pyrimidine metabolism, alanine, aspartate and glutamate metabolism, and tyrosine metabolism were consistently reduced when placed in stressful environments.

in yp, it has been shown that following a transition from ambient temperature to 37°c and a calcium-deficient medium, the adenylate energy charge of the cells decreases  <cit> . the results of our gx-fba simulations seem to indicate that conservation of energy post-stress is a common adaptation strategy for yp. the results indicate that for such conditions the cell ameliorates any energy shortcoming by reducing the rates of some unnecessary atp-consuming reactions while simultaneously lowering the degradation rate of adenosine and other energy-carrying purine nucleosides. the reduction in the rate of de novo purine biosynthesis has been attributed to the lowered rate of growth  <cit> . however, this explanation does not agree with the observation that significantly reduced mrna expression levels in strain kim <dig> at 37°c were not followed by a reduction in growth. on the other hand, de novo biosynthesis of purines consumes significant amounts of energy. down-regulation of this pathway could be part of a cell-wide energy-saving strategy.

discussion
to date, implementations of fba have been incapable of addressing states of metabolic activity resulting from perturbations other than gene losses/additions, incorporation of genetic expression data based on boolean logic  <cit>  or changes in nutrient availability. consequently, analyses of important mechanisms such as cellular stress response , which usually results in the induction of specific stress or shock proteins, have been outside the scope of genome-level metabolic investigations.

csr is a system-level response, and hence, any study of such phenomena that only focuses on the altered activity of a handful of enzymes will overlook the cascading effects of gene-expression changes on the entire cellular metabolism. in order to expand the utility of fba genome-scale models toward solving such state transitions, we developed gx-fba, which combines hierarchical regulation imposed by gene-expression with the rigid constraint of metabolic reaction connectivity. we have applied our methodology toward studying the metabolic response of bacterium y. pestis to a number of environmental perturbations which are known to cause phenotypic changes, ranging from induction of virulence to cellular death.

one of the first questions about the utility of gx-fba that has to be answered involves verification that the constraints imposed by network connectivity alone have the ability to partially mimic metabolic regulation, and if need be, oppose the dictum of hierarchical regulation. through imposition of soft internal constraints  on a network by gx-fba , the behavior of a reaction can oppose hierarchical directives.

this flexibility of gx-fba is a strength and can be used to aid in identifying reactions in a pathway that might be least susceptible to hierarchical regulation in response to a given environmental condition. in order to illustrate this capability of gx-fba, we used available flux measurements for s. cerevisiae <cit>  to examine the quality of the computationally predicted fluxes . our results show that for an optimal gx-fba objective function, our predictions on average display a percentage error relative to experimentally measured flux changes of only e = 21%.

a number of studies have shown that in some cases, there is not a strong correlation between mrna expression levels and protein abundance  <cit> . such inconsistencies can also be found between proteomic and transcriptomic results for yeast  <cit>  and yp  <cit> . for the gx-fba simulations of yeast metabolism, the majority of such inconsistencies were resolved and the models correctly predicted the directions of flux change.

given that our gx-fba methodology can predict some of these differences, we surmise that network connectivity can serve as an appropriate constraint for ensuring that gx-fba does not summarily impose hierarchical regulation on the network, since network connectivity is a critical component of metabolic flux regulation.

cellular stress response
environmental perturbations usually cause a cellular response that is characterized by adjustments in genetic expression levels and cellular physiology. this rearrangement, if successful, permits the cell to adapt to the new environment. study of cellular response mechanisms to external changes provides the basis for addressing questions related to cellular robustness and opens the possibility to identify drug targets. to date, studies on cellular stress response have primarily focused on the identification of expression patterns  and how these translate into system-wide effects on the metabolome, fluxome, and ultimately, realized cellular phenotypes.

yersinia pestis' metabolic response to temperature changes
the flea/host/flea life cycle of yp forces the bacteria to adapt to two environments that differ in temperature and nutrient levels. analysis of yp's acclimation from ambient temperature in the flea gut to 37°c in the mammalian host can provide us with information about how the cell prepares for inducing virulence and combating the host’s defenses.

our analyses suggest that immediately following introduction into the host and encapsulation within a phagocyte ; the yp cell's primary metabolic response involves reducing the activity of most prominent producers of ros, most notably oxidative phosphorylation. the reduced rate of atp production via atp synthase coupled with increased energy demand associated with csr can explain the observed depletion of the atp pool in stressed cells  <cit> . as a result, the cell attempts to conserve energy by reducing the activity of non-essential reactions and pathways. production of purines is one such process which can be metabolically compensated by reduced rate of nucleotide degradation. concomitant to decreased ros production, the cell increases the activity of enzymes  that protect cellular macromolecules from harmful interactions with ros such as hydrogen peroxide. the cell also starts utilizing some amino acids such as arginine and serine as sources of carbon.

in nutritionally rich environments that contain sufficient quantities of ca2+, yp initiates a highly wasteful metabolic strategy whereby generation of energy via oxidative means is favored. the cell downregulates pathways for production of some nitrogen-based compounds and instead scavenges these compounds from the host medium.

yersinia pestis' metabolic response to antimicrobials
analyses of the predicted metabolic profiles resulting from subjecting yp to streptomycin and chloramphenicol provide a better insight into the effects of these antimicrobial agents on the energy economy of the cell. focusing on the reduced rate of growth in the presence of streptomycin, we identify reduced activity of oxidative energy production pathways, as well as reduced production of key biomass components such as purines and amino acids as the responsible processes . however, unlike metabolic augmentations after treatment with chloramphenicol, activities of metabolic pathways that are linked to production of cellular membrane are not drastically altered. this is an intriguing observation by itself, as it is known that part of the bactericidal action by streptomycin is to permeabilize the cellular membrane  <cit> .

gx-fba simulations predict that interaction with chloramphenicol leads to extensive decrease in nitrogen metabolism of the cell. pathways producing amino acids and nucleotides are particularly downregulated . also as noted the activity of pathways associated with production of cellular membrane are reduced.

interestingly, the only process that is upregulated upon interaction with antibiotics is the pathway for metabolism of riboflavin . this upregulation diverts some of the gtp needed for biomass production. thus increased production of riboflavin coupled with reduced production of purines contributes to the predicted diminishing of growth yields. the enhanced rate of riboflavin production also provides an intriguing alternate explanation for an empirical observation. during the 1950’s it was observed that certain antibiotics, including streptomycin, stimulate growth in rats whose diet is deficient in certain forms of vitamin b  <cit> . it was generally agreed that the vitamin-sparing effects of antibiotics resulted from alterations to the intestinal flora. while some believed that antibiotics decrease the number of bacteria, and hence reduce competition for scarce resources  <cit> , others had theorized that antibiotics might increase the rate of synthesis of some types of vitamin b  <cit> . given the fact that y. pestis is closely related to enterobacteria via its progenitor yersinia pseudotuberculosis, the result of our simulations seem to lend credence to the latter hypothesis as a possible factor for how antibiotics relieve vitamin b deficiency in mammals.

finally, for both streptomycin and chloramphenicol, the activities of a majority of the tca cycle reactions do not change drastically. in contrast, a majority of the reactions associated with oxidative phosphorylation are downregulated. this is unexpected because recent work by kohanski et al.  <cit>  have shown that treatment with bactericidal antibiotics  leads to increased oxidative phosphorylation and production of superoxide anion which leach irons from iron-sulfur clusters in e. coli and s. aureus. availability of this iron in the cell leads to production of hydroxyl radicals via fenton reaction, and these deleterious compounds are believed to be the most significant contributor of cellular death among ros. however, the results of our simulations and a detailed examination of measured gene-expression levels in yp following interaction with streptomycin clearly show that genes associated with oxidative phosphorylation  are significantly downregulated. this suggests that an examination of metabolism of hydroxyl radicals in yp could highlight either exceptions to the reported mechanism of cellular death by bactericidal antibiotics or could find alternate means for generation of this ros.

common cellular stress motif
we grouped the metabolic reactions that behave similarly under the four stress conditions based on function and pathway affiliation to look for a possible global stress-response strategy in yp. overall the metabolic activity of only a handful of pathways was similarly altered among all  <dig> conditions. gx-fba predicts that for all examined perturbations, the metabolic activity of pathways of metabolism for purines, pyrimidines as well as amino acids alanine, aspartate, glutamate, and tyrosine were constantly reduced.

the likely consequence of these motifs is conservation of energy. this is in agreement with the observation that csr is usually accompanied by exhaustion of cellular atp pool  <cit> , as the energetic requirements of protein degradation, chaperoning, and dna repair are very taxing on the cell’s energy metabolism. gx-fba predicts that yp cells partially ease this strain by decreasing rates for some atp-consuming reactions.

the reduced production of purines after stress has previously been ascribed to lowered growth rates  <cit>  and a reduced demand for these metabolites. however, this explanation does not agree with the observed reduction in purine production in kim <dig> since no significant changes in cellular growth were detected  <cit> . we propose an alternative explanation based on the thesis that the cell attempts to conserve energy post-stress: the process of de novo purine biosynthesis consumes considerable energy. production of inosine 5'-monophosphate starting from ribose 5-phosphate demands five molecules of atp. hence, reduced de novo production of purines could be part of the cellular energy conservation efforts.

CONCLUSIONS
in summary, we have developed a new method to combine microarray data with a constraint-based formalism to gain deeper understanding of the system-level metabolic behavior of cells following a wide range of perturbations. applying our framework to a large-scale model of metabolism in the gram-negative bacterium yersinia pestis to study csr and metabolism of this pathogen as it transitions between host and vector environments and combats deleterious effects of antibiotic treatment, we find that the cell primarily tries to conserve energy while maximizing import of needed metabolites. our efforts also show that by using this methodology that successfully couples gene-expression data to system-level models of metabolism, we can glean new insights that might not be readily discernible through other means.

competing interests
the authors declare that they do not have any competing interests.

authors’ contributions
an and ea conceived the idea and designed the experiments. an performed the computations and analyzed the results. ea led the project and programmed the cobra gx-fba program. an and ea wrote the paper and approve of its final version.

supplementary material
additional file 1
matlab script of gx-fba algorithm for use with the cobra toolbox.

click here for file

 additional file 2
complete description of the sample model  in sbml format.

click here for file

 acknowledgements
the authors would like to thank dr. walter van gulik for his invaluable help with the daran-lapujade experimental data and dr. henry shaw for helpful comments on the manuscript. the work was performed under the auspices of the u.s. department of energy by lawrence livermore national laboratory under contract de-ac52-07na <dig>  the project  was funded by the laboratory directed research and development program at llnl. llnl-jrnl- <dig> 
