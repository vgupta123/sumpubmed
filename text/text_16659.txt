BACKGROUND
initially named for a group of intestinal bacteria, members of the family enterobacteriaceae are distributed worldwide and are found in soil, water, agronomic crops and produce, plants and trees, and in animals ranging from insects to humans. pathogenic enterobacteria cause biomedically and agriculturally significant diseases, and historically have resulted in numerous pandemics, foodborne outbreaks, and nosocomial infections, arguably impacting human health more than any other microbial family. enterobacteria have been extensively studied in the laboratory due to their importance to human health and as standard laboratory strains for molecular biology. the family includes  <dig> distinct genera and  <dig> named species  <cit> , and there are over  <dig> complete or nearly complete genomes currently available for enterobacteria. extensive comparative analysis between these genomes has revealed some of the genomic variations linked to host/niche specialization. the metabolic gene content of these genomes is complex, with each strain predicted to contain over  <dig> genes encoding metabolic enzymes and transporters. one method to investigate the complexity of genome-scale metabolic networks is through the construction of computational models.

computational modeling of bacterial metabolism offers a promising approach to predict strain-to-strain variation in metabolic capabilities and microbial strategies used in different environments, including host tissues. the number of available genome-scale metabolic models  has grown in the last ten years to over  <dig> gems, and they capture the metabolic capabilities of numerous microbial taxa important to human health, biotechnology and bioengineering  <cit> . systems biology combines computational and experimental approaches to study the complexity of biological networks at a systems level, where the cellular components and their interactions lead to complex cellular behaviors. genome-scale biological networks have proven useful for interpreting high-throughput data and generating computational models. mathematical models are constructed from network reconstructions, and they include variables, parameters, and equations to describe the potential behavior of these networks. starting with e. coli k- <dig> numerous types of genome-scale biological networks have been constructed including metabolic, regulatory, and transcriptional and translational machinery  <cit> , and additional gems for additional enterobacteria have recently been constructed  <cit> .

to date, gems of enterobacteria have been constructed for three standard laboratory e. coli strains  <cit> , four pathogenic e. coli strains  <cit> , one salmonella strain  <cit> , one klebsiella strain  <cit> , two yersinia strains  <cit> , and one insect endosymbiont, buchnera <cit> . these gems have been used to bioengineer strains for valuable end product formation  <cit> , to conduct simulations to investigate metabolic processes during host-pathogen interactions  <cit> , to identify differentiating metabolic properties between commensal and pathogenic e. coli strains  <cit> , and to provide insight into the genome evolution of other enterobacteria  <cit> . in addition to strain-specific enterobacterial gems, recently  <dig> e. coli genomes were used to construct models from the combined genomic content of these e. coli strains, representing the intersection  and union  and revealed new insight into the evolution of this species  <cit> .

members of the family enterobacteriaceae diversified from a common ancestor ~300- <dig> million years ago  into a wide variety of free-living and host-associated lifestyles  <cit> , yet based on conserved metabolic phenotypes of all modern enterobacteria, little is known about ancestral traits of metabolism beyond that they were able to catabolize glucose and grow in the presence or absence of oxygen  <cit> . here the metabolism of ancient microorganisms has been investigated by identifying orthologous genes shared in the genomes of  <dig> free-living enterobacteria from  <dig> genera, and constructing metabolic networks representing the ancestral core at three phylogenetic points: the e. coli/shigella ancestral core , the e. coli/shigella/salmonella ancestral core , and the enterobacterial ancestral core . using these metabolic models we have analyzed the metabolic capacity for carbon, nitrogen, phosphorous, sulfur, and iron utilization in aerobic and anaerobic conditions and have identified conserved and differentiating catabolic phenotypes and validated these predictions by comparison to experimental data. apart from our previous publication on e. coli, this is the first study to use constraint-based modeling to examine the metabolic properties of ancestral bacteria and provides new insight into the evolution of metabolism for the family enterobacteriaceae.

RESULTS
the first gem for e. coli k- <dig> mg <dig>  was developed 10 years ago and has undergone numerous improvements and updates. it is now a sophisticated compartmentalized model containing over  <dig>  genes and  <dig>  reactions  <cit> . it has been used extensively for biotechnology, discovery applications, and to study evolutionarily related enterobacteria. here we generated ancestral core metabolic gems at three phylogenetic branching points within the family enterobacteriaceae from a e. coli k- <dig> mg <dig> gem  <cit>  based on the retained metabolic capability determined through a comparative genomic analysis of  <dig> enterobacterial genomes. we validated these models by comparing in silico carbon source utilization predictions to experimental data spanning  <dig> extant strains from  <dig> genera to examine the shared metabolic capabilities of modern-day enterobacteria and the impact of changes in the metabolic network on phenotypic traits.

phylogenetic reconstruction for the family enterobacteriaceae
a total evidence tree was constructed for the enterobacteria with available genome sequence data . the total evidence tree is extremely robust with full support at every internal tree node. trees were concordant between the neighbor joining and maximum likelihood methods, as well as between the total evidence trees and consensus trees. this phylogeny in phylogram form indicates a general trend that plant-associated clades have a relatively deeper split including both the soft-rotting clade with dickeya and pectobacterium, as well as the erwinia-pantoea clade, suggesting ancient speciation events for these genera. the clade including escherichia, salmonella and other animal-associated organisms shows relatively shorter intra-clade branches length, indicating their relatively recent speciation. this phylogenetic tree for the enterobacteria was used to determine the order of genomes used in subsequent analysis for ancestral core metabolic gene determination.

generation of an e. coli/shigella core metabolic network
e. coli and shigella strains are thought to have diverged from a common ancestor ~ <dig> mya  <cit> . although this is the most recent ancestral state we investigate here, gene losses and acquisition of genes via horizontal transfer have led to extensive differences in genome content among descendants of this node with some e. coli strains differing by as much as 25% of their gene content  <cit> . it is of interest to understand the extent to which this has impacted the metabolic network over this time frame. we assume that genes conserved across all strains represent a conservative estimate of the core genome of the ancestor of modern e. coli strains. from the  <dig> e. coli and seven shigella spp. genomes we identified a collection of  <dig>  conserved genes to construct iecoli_core . of these conserved genes,  <dig> have been experimentally characterized for metabolic function and are present in the e. coli k- <dig> mg <dig> gem   <cit> . as previously described for construction of ancestral core metabolic models  <cit> , a metabolic network for the e. coli/shigella ancestral core was made by removing reactions from the ieco1339_mg <dig> network if orthologs to the associated gene were absent in one or more of the  <dig> genomes and if the reactions did not have any isozymes. if removing a reaction prevented biomass production  then the reaction was added back to the metabolic model without a gene associated with it and the reaction was classified as an orphan reaction . using this approach  <dig> orfs associated with  <dig> reactions were removed from ieco1339_mg <dig> resulting in an e. coli core metabolic network  consisting of a total of  <dig> orfs and  <dig>  reactions , and the reactions retained in the core model were classified based on metabolic subsystem .

generation of an e. coli/shigella/salmonella core metabolic network
e. coli and salmonella strains are thought to have diverged from a common ancestor ~ <dig> mya  <cit>  and it is of interest to understand how the metabolic networks have evolved over time to have an estimate of the metabolic capabilities of an ancestor to modern day e. coli and salmonella strains. we assume that genes conserved across all strains represent a conservative estimate of the core genome of the ancestor of modern e. coli and salmonella strains and from these  <dig> e. coli, seven shigella spp., and  <dig> salmonella spp. genomes the collection of  <dig>  conserved genes were used to construct the ancestral metabolic model isalcoli_core . there are  <dig> of these genes that have characterized metabolic function in the e. coli k- <dig> mg <dig> gem   <cit> . a metabolic network for the e. coli/shigella/salmonella ancestral core was made as before by removing reactions from the ieco1339_mg <dig> network if orthologs for the associated genes were absent in one or more of the  <dig> genomes. reactions were added back as orphan reactions if they were essential for biomass production during growth simulation in minimal media with glucose as the sole carbon source. using this approach  <dig> orfs associated with  <dig> reactions were removed from ieco1339_mg <dig> resulting in an e. coli/salmonella core metabolic network  consisting of a total of  <dig> orfs and  <dig>  reactions , and the reactions remaining were classified based on metabolic subsystem .

generation of an enterobacterial core metabolic network
all members of the family of enterobacteria are thought to have diverged from a common ancestor ~300- <dig> mya  <cit> . the metabolic network present at that time represents the backbone on which the metabolism of all modern enterobacteria was built. we again assume that genes conserved across all strains represent a conservative estimate of the core genome of the ancestor of modern enterobacterial strains and from these  <dig> genomes the collection of  <dig> conserved genes to construct ientero_core . there are  <dig> of these genes that have characterized metabolic function in the e. coli k- <dig> mg <dig> gem   <cit> . a metabolic network for the enterobacterial ancestral core was made by removing reactions from the ieco1339_mg <dig> network if one or more of the  <dig> genomes did not have an orthologous gene to associate to the reaction and if the reaction was not essential. in the case of transport outer membrane porin reactions , no single othologous gene was found that spans all  <dig> enterobacterial genomes, yet four genes  have equivalent function for  <dig> of these reactions in the ieco1339_mg <dig> network. for all  <dig> genomes of enterobacteria examined, one or more of these genes encoding functionally equivalent proteins were found, and led to the retention of these  <dig> reactions in the enterobacterial core network classified as orphan reactions. using this approach  <dig>  orfs associated with  <dig> reactions were removed from ieco1339_mg <dig> resulting in an enterobacterial core metabolic network  consisting of a total of  <dig> orfs and  <dig>  reactions , and the reactions remaining were classified based on metabolic subsystem .

assessment and validation of models for carbon source utilization
to evaluate the accuracy of three ancestral core gems, we predicted if these ancestral strains could use  <dig> different carbon sources under aerobic and anaerobic conditions. these predictions were then compared to experimental growth phenotypes for current strains measured using biolog phenotypic arrays or published carbon source utilization data for  <dig> enterobacteria spanning  <dig> genera listed in table  <dig> <cit> . there are numerous strain-specific differences in carbon source utilization in both aerobic  and anaerobic conditions . for the experimental growth phenotypes, if any of the current strains could not grow on a carbon source then we assumed the ancestral core model could also not grow on the carbon source. these expected experimental results for the ancestral strains were then compared to fba predictions of growth for the different ancestral core gems using different carbon sources. for those compounds included in the biolog plates that have transporters in the model, fba was used to predict if they could be used for growth as sole carbon source. comparisons were made for all three ancestral metabolic models . we compared the accuracy of the ancestral models for carbon source predictions to all other microbial gems that were validated through a comparison to carbon source utilization data , and determined that the accuracy of carbon source utilization predictions for ancestral metabolic models was similar to the range of accuracy for gems of extant bacteria under both aerobic and anaerobic conditions  <cit> .

in silico predictions for nitrogen, phosphorous, iron, and sulfur utilization predictions
once all three ancestral core models were validated through comparison to experimental data for determining accuracy of in silico carbon source utilization using fba, predictions were generated for utilization of sole nitrogen, phosphorous, iron, and sulfur compounds. as the number of genomes used for the generation of the three ancestral core models increased, the number of metabolites decreased that were predicted as useable nitrogen, phosphorous, iron, or sulfur source under aerobic  or anaerobic conditions .

analysis of gene essentiality
to further explore the metabolic similarities between all enterobacteria, we determined reaction essentiality predictions of the enterobacterial core metabolic network  for conditions simulating aerobic and anaerobic growth in glucose containing minimal media . of the  <dig> genes included in the enterobacterial ancestral core model, we compared the  <dig> genes predicted in silico as essential to orthologous genes in other enterobacteria strains for which gems have been constructed  <cit> , to experimentally determined essential genes  <cit> , and to “superessential” gene predictions  . 39% of genes predicted as essential  using the enterobacterial ancestral core metabolic network were also predicted as essential in silico in one or more gems generated from genomes of extant enterobacteria. of the  <dig> genes contained in the enterobacterial ancestral core metabolic network,  <dig> genes were predicted as non-essential and 98%  of these predictions matched non-essential gene predictions from orthologous genes contained in gems generated from genomes of extant enterobacteria.

when the predicted  <dig> genes predicted as essential using the enterobacterial ancestral core metabolic model were compared to experimental data for modern day enterobacterial strains, 39% of essential gene predictions  were in agreement with the experimentally determined essential genes for e. coli and salmonella strains, and out of the  <dig> non-essential gene predictions generated using the enterobacterial ancestral core metabolic network  <dig> % were in agreement with experimentally determined non-essential genes  . when gene essentiality predictions generated using the enterobacterial ancestral core metabolic network were compared to “superessential” genes,  <dig> %  were in agreement for essential gene predictions and  <dig> % were in agreement for non-essential gene predictions . for each of these comparative gene essentiality data sets, overall predictions using the enterobacterial ancestral core metabolic model were in agreement with gene essentiality predictions from in silico enterobacterial gems for 68%  of gene essentiality predictions, 76%  when compared to experimental data from enterobacterial members, and  <dig> %  when compared to “superessential” gene predictions. in summary, essential gene predictions from the enterobacterial ancestral core were  <dig> % in agreement with essentiality data determined previously in one or more published studies from individual enterobacterial members .

discussion
this study describes the generation of three computational models designed as a first approximation of the metabolic capacity of ancestral enterobacteria. we selected three nodes in a well resolved phylogenetic tree of enterobacteria with complete genome sequences . the first node represents the common ancestor of e. coli and shigella , the second represents the ancestor of ecoli/shigella and salmonella , and the third represents the ancestor of all enterobacteria . each model includes all identifiable metabolic reactions from a previous gem for e. coli k- <dig> that are linked to genes conserved among  descendants of the phylogenetic node, plus orphan reactions from the e. coli k- <dig> model that must be retained because removal would prevent production of biomass. thus, these three models are progressively smaller subsets of the e. coli k- <dig> model. the models were created in a step-wise fashion by deleting reactions missing from one taxon at a time selected approximately in order of increasing phylogenetic distance from e. coli k- <dig>  figure  <dig> shows the impact of each successive addition on the number of genes and reactions retained. the number of orphan reactions is also shown in figure  <dig> and increases with divergence time of the ancestral node.

for the model representing the ancestor of all enterobacteria, over  <dig> of the approximately  <dig>  reactions in the model are orphans . there are several possible explanations. these orphans may arise from false-negative ortholog predictions that support removing a reaction that appears to be missing from a taxon, but for which the genes are truly present in the annotated genome. similarly, orphans could arise from false-negative gene prediction errors. both these mundane error sources could be corrected manually, but this would require a good deal of effort. a more interesting explanation is that these reactions might be carried out by non-orthologous isofunctional equivalents in the organisms that suggested removing them from the model. this was the case for  <dig> transport outer membrane porin reactions that were retained in the enterobacterial ancestral core model that did not have a single ortholog conserved across all  <dig> genomes, yet each of these genomes contained one or more functionally equivalent genes encoding isozymes for these reactions. further examination of these cases could advance understanding of the rates and patterns of non-orthologous displacement in the evolution of metabolic processes. it is also likely that we will see a reduction of orphan reactions in the next generation of ancestral models that makes use of parsimony or maximum likelihood based ancestral state prediction to determine which genes are present at each internal node, because this approach will be more tolerant of annotation or orthology errors affecting a subset of taxa. it will also expand the models to include reactions that were legitimately lost in individual taxa and lineages allowing us to further probe the evolutionary dynamics of metabolic networks and perhaps discover system-scale emergent phenotypes linked with losses of particular reactions.

here, we focus on these models representing core absolutely conserved reactions to examine a conservative estimate of the metabolic capacity of each ancestral lineage. we compared the reactions retained in each ancestral model to the total set of reactions in the mature e. coli k- <dig> model for each reaction subsystem classification category . some subsystems are particularly highly conserved. murein biosynthesis and transport outer membrane porin reactions are almost entirely conserved across all phylogenetic depths assayed. other categories, like alternate carbon metabolism, transport inner membrane and glycerophospholipid metabolism are highly variable across the models. for example,  <dig> reactions involved with alternate carbon metabolism were deleted from the e. coli k- <dig> model in order to create the e. coli ancestral core model,  <dig> additional deletions were required for the e. coli/salmonella ancestral core model, and  <dig> more were required for the enterobacteria ancestral core model. this pattern suggests that much of the variation in this biological process lies at the species level. in contrast, for the glycerophospholipid metabolism subsystem, the e. coli/shigella core and e. coli/salmonella core models are identical, but  <dig> reaction deletions were required to create the enterobacteria core model. this tells us that this metabolic process was largely intact by the time e. coli and salmonella diverged, but these metabolic capabilities were likely acquired since the ancestor of all enterobacteria. future modeling of additional nodes with incorporation of ancestral state reconstruction will further illuminate the timing of these metabolic innovations. this in turn, can be used to simulate metabolic evolution in the forward direction, adding capabilities in step-wise evolutionary order. with each addition, it will be possible to compete each “evolved” strain against its ancestor in silico altering the environmental conditions in the simulation to examine the relative predicted biomass .

since the biomass of ancestral cells is impossible to determine empirically, we used the e. coli biomass equation from iaf <dig>  <cit>  for all ancestral core metabolic models in this study. the iaf <dig> biomass equation is the most extensive biomass equation of all enterobacterial gems containing  <dig> metabolites including many trace metals and elements such as iron and sulfur that are known to be essential for supporting microbial life. since unique biomass equations exist for three other strains of enterobacteria with gems  <cit> , we compared the metabolites present in all strain-specific enterobacterial gems and determined that there are  <dig> present in all four biomass equations,  <dig> in three of the four,  <dig> in two of the four, and that there are metabolites specific to each strain-specific biomass equation for e. coli , salmonella , klebsiella , and yersinia . as more enterobacterial members have gems constructed with strain-specific biomass equations, a future direction may be to generate an average biomass composition from all modern-day gems of enterobacteria to use in the enterobacterial ancestral core metabolic model, or to use parsimony-based ancestral state reconstruction to estimate node-specific ancestral biomass composition. future studies are warranted to investigate whether and how these alternative approaches impact insights gained through simulations.

we used the models to predict whether each ancestral “strain” would grow on a large number of carbon, nitrogen, phosphorous, iron, and sulfur sources under aerobic and anaerobic conditions. we compared these predictions to previously published experimental growth data for  <dig> extant enterobacteria representing the  <dig> genera used in the phylogenetic analysis   to investigate the accuracy of the models . for each node corresponding to one of our models, we first compiled published experimental data recording whether each nutrient could serve as a sole source for growth in all reported wild-type descendants of the node. if even a single report indicated that a strain was unable to utilize the nutrient as a sole source, we recorded it as a negative. for the e. coli/shigella, ecoli/shigella/salmonella, and the enterobacteria core model reconstructions, the total number of experimentally reported carbon sources utilized by all relevant strains in anaerobic conditions were  <dig>   <dig>  and  <dig>  and in anaerobic conditions were  <dig>   <dig>  and  <dig>  respectively . previously it was appreciated that all free-living enterobacteria could utilize glucose as a sole carbon source  <cit> . our compilation of experimental data identified  <dig> additional carbon sources that are utilized by all free-living enterobacteria . catabolism of these substrates has been conserved in all free-living enterobacteria as they diverged over ~300- <dig> million years.

once experimental data was summarized, we sought to determine how well the ancestral core metabolic models accurately predicted carbon source utilization phenotypes. in order to compare experimental data  to in silico predictions, experimental growth data was summarized for the members contained at each major branching point for e. coli/shigella , ecoli/shigella/salmonella , and the enterobacteria . growth or no-growth data was then determined, and if one member had a no growth phenotype, the consensus of experimental data to compare with ancestral core metabolic models was no growth. for each experimental growth prediction, all of the strains with experimental data had to be positive for growth or not determined for a positive growth prediction to compare with in silico ancestral core predictions. of the  <dig> carbon sources with experimental data,  <dig> of these are present with exchange and transport reactions in the metabolic ancestral core models and thus provide an opportunity for a comparison between experimental and in silico carbon source utilization predictions. based on these  <dig> carbon sources, the accuracy of the three models, iecoli_core, isalcoli_core, and ientero_core, for aerobic carbon source utilization predictions were  <dig>   <dig>  and 75%, and in anaerobic conditions were  <dig>   <dig> , and 86%, respectively . when compared to all existing microbial gems that used experimental carbon source utilization data to validate in silico metabolic model predictions, the accuracy observed for the three ancestral metabolic models for aerobic  or anaerobic  conditions is within the range of accuracy for all  <dig> gems  that have been published . this supports the use of more general ancestral models in cases where a genome sequence, or specific model, or both are lacking. these core models are also an excellent starting point for generation of additional strain-specific models for other enterobacteria.

having validated the ancestral core models using a subset of experimentally determined carbon source utilization data, we examined the predictions of each model for a wider variety of carbon, nitrogen, phosphorous, iron, and sulfur source utilization phenotypes . there were three carbon sources , five nitrogen sources , four phosphorous sources , one iron source , and one sulfur source  predicted to support growth of the ancestral core of enterobacteria . these results provide new insight about the metabolic capability that has been retained in almost all free-living enterobacteria over ~300- <dig> mya of divergence.

finally, we examined which genes/reactions are predicted as essential based on the enterobacteria ancestral core metabolic model. we conducted in silico gene essentiality analysis of all  <dig> genes contained in the ientero_core model, and identified  <dig> genes/reactions that were predicted to be essential for growth. we compared these predictions to available in silico and experimental essential gene data for extant strains of enterobacteria. when genes predicted as essential for ientero_core were compared to in silico predictions of gems for e. coli k <dig>  <cit> , salmonella <cit> , klebsiella <cit> , and yersinia <cit> ,  <dig> enterobacterial ancestral core metabolic model essential gene predictions matched the essential genes predicted for all four enterobacterial strain-specific gems, and five predicted essential genes matched essential gene predictions for  <dig> out of  <dig> strain-specific gems . when genes predicted as essential for ientero_core were compared to experimental data for e. coli k <dig>  <cit>  or salmonella <cit> ,  <dig> ientero_core essential genes matched at least one of the experimental essential gene predictions for e. coli k <dig>  and  <dig> matched experimental essential gene predictions for salmonella. in addition “superessential” genes identified for reactions essential to almost all prokaryotic organisms  <cit>  were compared to enterobacterial core predictions, and  <dig> were found to match genes predicted as essential and  <dig> predicted as nonessential. overall, gene essentiality predictions using the ientero_core ancestral model were in  <dig> %  agreement with at least one other data set from previously published data . this analysis also pinpoints which genes have been identified or predicted to be essential across nearly all studies, and these may represent the best targets for the generation of antibiotics or other control strategies for infectious diseases associated with enterobacteria.

CONCLUSIONS
the work presented here are the most advanced and comprehensive quantitative ancestral metabolic models to date to investigate metabolism through genomic comparison of extant descendants, and has provided insight into aspects of metabolism of ancient microbes. we showed evidence that different subsystems of the metabolic network evolved according to different rates and patterns. this includes subsystems that vary extensively within species after remaining relatively stable for much longer evolutionary times, as well as subsystems whose composition has been retained in all extant strains. this work demonstrated a new approach for validation of carbon source utilization of ancestral models, yielding accuracies of >75%, for aerobic and anaerobic conditions for the ancestral core models for ecoli/shigella, e. coli/shigella/salmonella, and enterobacteria. importantly, the ancestral core models showed comparable accuracy to organism-specific models suggesting they will be useful starting points for modeling lesser-characterized enterobacteria. essential gene predictions for the enterobacterial ancestral core were compared to extensive experimental data and revealed the most promising new targets for future development of control strategies such as new broad-spectrum antibiotics to treat disease caused by enterobacteria. these insights support the use of this “paleo systems biology” approach to study ancient metabolism and metabolic network evolution through reconstruction of models of ancestral lineages that are otherwise inaccessible for experimentation.

materials and methods
bacterial strains and growth conditions
six e. coli strains, one salmonella strain, one shigella strain, one erwinia strain, one pantoea strain, one dickeya strain, and one pectobacterium strain were used in this study . frozen cultures were streaked onto luria bertani  agar plates and grown overnight at 37°c for e. coli, salmonella, and shigella strains, and at 28°c for the erwinia, pantoea, dickeya, and pectobacterium strains. for carbon plate utilization assays, isolated colonies were used to inoculate bug sheep blood agar plates  and incubated at 37°c or 28°c overnight aerobically or anaerobically in sealed whirl-pak® long-term sample retention bags  saturated with an anaerobic gas mixture  as described  <cit> . cells were collected and used to inoculate biolog pm <dig> and pm <dig> plates following the manufacturers recommendations with a minor modification of adding a top layer of mineral oil to each well for anaerobic culture conditions as described  <cit> , and biolog plates were monitored for up to 48 h for the e. coli, salmonella, and shigella strains, and up to 72 h for the erwinia, pantoea, dickeya, and pectobacterium strains.

genome-wide phylogenetic reconstruction
genomes used in this study for phylogenetic reconstruction, their sources, dates of isolation, and hosts are listed in additional file  <dig>  out of the total  <dig> genera and  <dig> named species for the family of enterobacteriaceae <cit> , there are over  <dig> complete or nearly complete genomes from  <dig> genera currently available, according to ncbi microbial genome project and asap databases  <cit> . for all strains with available genomes, one strain from each genus was selected for phylogenetic analysis from those contained in the asap database vibrio cholerae and pseudomonas syringae were designated as outgroup taxa, because they are members of phylogenetically closely related families from the order of gamma proteobacteria. genome-wide orthologous genes among selected genomes were retrieved in two steps. we first generated all-against-all blastp reciprocal  matches for all investigated sequences, using an e-value ≤  <dig>  cutoff. we then use a threshold based on a metric that is defined as the minimal number of pair-wise comparisons consistent across a putative orthologous sequence cluster, in order to preserve a genome-wide dataset with maximal phylogenetic informativeness. alignment of each retrieved orthologous data among all strains under investigation was performed in amap   <cit>  with  <dig>  as the gap factor. amino acid sequence alignments were concatenated to form a single composite alignment. we further employed both neighbor joining  and the maximum likelihood estimation  for phylogenetic reconstruction. nj trees were calculated in paup*  <dig> b <dig>  <cit>  and maximum likelihood trees were constructed in phyml  <cit>  for both individual genes and the composite data sets. bionj tree  <cit>  is used as starting tree topology in phyml, and optimized tree topology and optimized branch lengths and rate parameters are also used. wag  is employed as the amino acid substitution model  <cit>  and gamma distribution parameter and proportion of invariable sites are estimated using four substitution rate categories are used. the 50% majority-rule consensus trees were calculated using  <dig> bootstrap pseudo-replicates with sampling limited to non-excluded, parsimony-informative characters.

generation of ancestral metabolic networks
draft and complete enterobacterial genomes in the asap database have been continually updated using new publicly accessible genomes since the database’s inception  <cit> . orthologs in the asap database are derived from multiple criteria, including pairwise reciprocal blastp searches filtered with comparison-specific thresholds for percent identity restricted to hits encompassing > 60% of both aligned proteins, followed by manual curation based on local and larger-scale conservation of genome context as well as expert review of alignments, and comparison to large-scale orthomcl analyses  <cit> . there are more than  <dig> genomes of enterobacteria in the asap database, of which  <dig> genomes  were chosen that all have gene orthology predictions determined in comparison to e. coli k <dig> mg <dig> . using the phylogenetic tree as a guide, we generated a table of genes  contained in the ieco1339_mg <dig> metabolic model  <cit>  with the  <dig> genomes  and column entries correspond to orthologous asap gene identifiers, with blank entries representing cases in which no orthologous gene exists . we then chose three phylogenetic branching points to identify genomes representing the conserved ancestral core for e. coli/shigella , ecoli/shigella/salmonella , and the enterobacterial core . the gems for these ancestral core models were made by removing orthologous orfs and their associated reactions from the ieco1339_mg <dig> gem if one or more of the enterobacteria genomes leading up to the phylogenetic branching point did not have a gene assigned. if removing a reaction prevented biomass production for anaerobic growth on glucose  then the reaction was added back to the metabolic reconstruction without a gene associated with it. gene-to-protein-to-reaction associations representing the metabolic models of the e. coli/shigella ,e.coli/shigella/salmonella , and the enterobacterial  ancestral core are provided . ancestral core metabolic models were converted to sbml file format and are provided for iecoli_core , isalcoli_core , and ientero_core .

flux balance analysis
fluxes through metabolic network reactions can be predicted using flux balance analysis   <cit> . in fba, fluxes are constrained by steady-state mass balances, enzyme capacities and reaction directionality. these constraints yield a solution space of possible flux values, and fba uses an objective function to identify flux distributions that maximize  the physiologically relevant predicted solution. cellular growth rate  is often used as an objective function for fba  <cit> , and was used for fba analyses performed in this study in addition to an objective function for respiration which has been shown to improve comparisons to biolog carbon source experimental data  <cit> . the same biomass equation, gam and ngam values, and po ratio were used for all developed models, and were the same as that in iaf <dig>  <cit> . using fba, in silico predictions of carbon, nitrogen, phosphorous, iron, and sulfur source utilization were compared to experimentally determined values for  <dig> enterobacterial strains spanning  <dig> genera for both aerobic and anaerobic conditions. for carbon, nitrogen, phosphorous, iron, and sulfur source utilization and gene deletion simulations, a maximum uptake rate of 10 mmol per gram of dry weight per hour  was used. fba was also used to predict essential reactions by constraining reactions to have zero flux and maximizing growth rate. if the resulting maximum predicted growth rate  was zero then the reaction and the associated genes were considered to be essential. reaction deletion simulations were evaluated under both aerobic and anaerobic conditions.

competing interest
the authors declare that they have no conflict of interest.

authors’ contribution
np conceptualized and db designed the study. bm conducted all phylogenetic analysis, and np and bm analyzed the results. db constructed all three ancestral core metabolic network reconstructions and performed all in silico analyses. db obtained all of the experimental data. db and jr analyzed and interpreted the data and performed the statistical analysis. all authors helped draft and edit the final manuscript. db generated all sbml model files. all authors approve the content of this manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
aerobic experimental carbon source utilization for  <dig> enterobacterial strains.

click here for file

 additional file 2
anaerobic experimental carbon source utilization for  <dig> enterobacterial strains.

click here for file

 additional file 3
dataset  <dig>  a list of experimental carbon source utilization data of enterobacteria.

click here for file

 additional file 4: table s1
list of genomes used for the phylogenetic analysis of the enterobacteria.

click here for file

 additional file 5
dataset  <dig>  a list of orthologous genes from  <dig> genomes of enterobacteria to those from e. coli k- <dig> mg <dig>  and to genes contained in the metabolic models of the e. coli/shigella ,e.coli/shigella/salmonella  , and the enterobacterial  ancestral core.

click here for file

 additional file 6
dataset  <dig>  gene-to-protein-to-reaction associations representing the metabolic models of the e. coli/shigella , e.coli/shigella/salmonella , and the enterobacterial  ancestral core.

click here for file

 additional file 7
computational model  <dig>  sbml format of iecoli_core for distribution and use in other modeling environments.

click here for file

 additional file 8
computational model  <dig>  sbml format of isalcoli_core for distribution and use in other modeling environments.

click here for file

 additional file 9
computational model  <dig>  sbml format of ientero_core for distribution and use in other modeling environments.

click here for file

 acknowledgements
this work was funded by the national library of medicine, national institutes of health, grant no. 5t15lm <dig> to the computation and informatics in biology and medicine training program for a post-doctoral traineeship  and a graduate student fellowship . this work was also supported by an nsf grant no.deb- <dig> to ntp. finally, we would also like to thank bryan biehl and dr. jeremy glasner, guy plunkett iii, and eric neeno-eckwall for insightful discussions of the manuscript, and dr. eric cabot and christopher tervo for assistance in generation of the sbml model files.
