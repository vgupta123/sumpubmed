BACKGROUND
clinical and environmental microbiology often requires the detection of a particular bacterial strain with/without the presence of other closely related strains/species in the samples  <cit> . standard pcr is by far the most efficient method in pathogen detection and disease epidemiology research. the critical part of this method is the specific primer design. the challenge of the primer design is that pcr primers are being designed to amplify from one sequence, but not from other homologous sequences. the general approach of specific primer design by biologists is often performed manually by searching primer sequences against a dna database, followed by experimental tests. however, single nucleotide polymorphisms , which represent micro but stable dna variations, are difficult to analyze through regular blast searches and are often ignored while designing specific primers. further, manually designing genome-wide primers based on sequence alignments can be challenging if strains have low sequence variability. an effective approach to process such a large amount of genomic data requires computational tools that are capable of processing large amounts of data and yet are easy to handle.

although a large number of primer design programs are available, very few packages are available for allele-specific primer design. primer premier from premier biosoft international has an allele-specific pcr primer design function but it is a commercial package which is not free to the public. primo  <cit> , primique  <cit>  and amplicon  <cit>  are both free to the public but they require either user-defined homologous genes or sequence alignment files. all these software do not support batch design for multiple query sequences of a particular strain/species. none of these programs take into consideration the whole genome sequences of the non-target strains when designing specific primers. therefore, the primers' specificity needs to be further improved before they can be used for detection.

in this paper, we describe a new software program, primersnp, which designs strain-specific primers that can specifically amplify the genomic sequences of a particular bacterium strain but not the genomic sequences of other phylogenetically-related strains. it automatically identifies unique snps of the strain and design primers based on these unique snps. it also quantifies the primer specificity by calculating a weight score, which takes into account both the number and location of snps on the primers.

although primersnp is initially developed to design specific primers, a second function is also added, which designs common primers that could amplify all the homologous genes. similar programs for common primer design exist such as genefisher  <cit> , but this program does not support the batch design of primers.

compared to currently available software, primersnp reduces users' involvement to a minimum level: only uploading of multiple genomic sequences is required. it can automatically search for unique snps from the input genomic sequences. importantly, this software has a high successful prediction rate  as validated by our experiments.

for user's convenience, a windows version of this software is prepared and can be downloaded from the main page.

implementation
primersnp is built around other public domain programs, such as blast  <cit> , clustalw <dig>  <cit> , me-pcr  <cit>  and primer <dig>  <cit> . implementation of primersnp is shown in figure  <dig>  panel a shows the flowchart of specific primer design  and panel b shows the flowchart of common primer design .

the spec subprogram consists of the following steps:

 <dig>  extract homologous regions of each query sequence using blast search against all the reference genomic sequences. multiple sequence alignment of these sequences is made with clustalw <dig> 

 <dig>  identify unique snps and generate candidate primers. based on the multiple sequence alignment file, snps that are unique to the query sequence are next identified. a snp is defined as unique if it is specific only to the query sequence . using each snp as the 3' end base, a series of sequences to the left and right of the snp are selected as either candidate left or right primers .

 <dig>  all the candidate primers generated in the previous step are evaluated using primer <dig> based on the user-defined pcr parameters. if a candidate primer is appropriate, the second half primer is generated by primer <dig>  if possible.

 <dig>  calculate the weight score and free energy of melting  of primer-dna duplex. the weight score is a measurement of the number and the locations of snps in the designed primer pair. a weight score of a specific primer pair is calculated for the first  <dig> nucleotides as shown in figure 4a. a score of  <dig> is assigned to a base if it is a snp and its position is n . the weight score of a primer pair is the sum of all the score values of snps on the primer sequences. in addition to weight score, the free energy of melting  is also calculated. this thermodynamic parameter is often used to estimate nucleic acid stability  <cit> . to calculate Δg° of the primer-dna duplex, we used the improved thermodynamic nearest-neighbor model  <cit> .

 <dig>  checking the primer specificity. a primer pair is defined as specific if it satisfies the following conditions: a) the primer pair has a perfect match with the target genome sequence only once; b) both left and the right primer do not show consecutive nucleotide matches of more than eight , can be user-defined) base pairs  with the reference genomes simultaneously; and c) in case of the second condition is not satisfied, the amplicon size should be greater than  <dig>  bp , figure 5).

 <dig>  sort output primers. the primer pairs are sorted in the descending order of the weight score. the program output format is similar to primer <dig> with the additional parameters of weight score and Δg°. a graphic view of the locations of the primers and their snps within the multiple sequence alignment file is also provided .

the comn subprogram consists of the following steps:

 <dig>  extract homologous sequences for each query sequence.

 <dig>  generate primers for each query sequence using primer <dig> according to the user defined pcr parameters.

 <dig>  select those primer pairs that have perfect match with all the other homologous sequences.

 <dig>  calculate the weight score, which is the difference between the amplicon size of the possible pcr product and the optimum product size . for each query sequence, the primer pair whose amplicon size is closest to the optimum product size is selected.

using primersnp
required input
genomic sequences
the genomic sequences of microorganisms  are uploaded by the user in fasta format.

optional inputs
query sequence file
the user can optionally provide a file containing multiple query sequences  of the target strain for which allele-specific primers are to be designed. in case the user does not provide such a file, the program automatically generate a query file by splitting the target genomic sequences into  <dig>  bp fragments.

maximum perfect match 
the maximum number  of base pairs  of both left and right primer that have consecutive matches with a non-target genomic sequence.

minimum amplicon size 
the minimum distance  between left and right primers on a non-target genomic sequence .

pcr parameters
primer length  , annealing temperature  , amplicon size  , gc percentage  .

email address
upon completion of the program, the user is notified by email with a web link to the result.

output result
the output primers are presented in a table format. for each primer pair, the snps, weight score and the free energy of melting  are displayed in addition to the pcr parameters of primer <dig>  a hyperlink button is also provided by primersnp to graphically view the locations of the primers and their snps within the multiple sequence alignment file .

RESULTS
common primer design
forty pairs of primers were designed for  <dig> homologous genes among the four strains  of xylella fastidiosa. the experimental validation result showed that all the  <dig> common primers successfully amplified the corresponding homologous sequences on each of the strains .

specific primer design
to design strain-specific primers,  <dig>  genes of strain 9a5c,  <dig>  genes of strain dixon,  <dig>  genes of strain temecula- <dig> and  <dig>  genes of strain ann- <dig> were used as the input query sequences for specific primer design. when one strain was used as the target, the genome sequences of the other three were used as the reference. these gene and genomic sequences were downloaded from . except for pcr product length which is set at  <dig> –  <dig> bp for dixon and  <dig> –  <dig> bp for others, the rest of the parameters are the default values of this program. primersnp generated  <dig> specific primers for strain 9a5c,  <dig> for strain temecula- <dig>   <dig> for strain ann- <dig> and  <dig> for dixon. since the number of specific primers for strain dixon was too low, we tried to increase the number of specific primers by manipulating the input files in various ways. first, dixon genome sequence was cut at  <dig> bp interval and primersnp designed specific primers for each individual piece. next, a similar process was repeated for the same genome sequence that was cut at  <dig> bp,  <dig> bp,  <dig>  bp and  <dig>  bp intervals. finally, all the specific primers were combined together and the total number was  <dig>  since the number of specific primers for strain 9a5c was too many, we ranked the  <dig> primers in the descending order of weight scores. a total of  <dig> specific primers were selected at an even interval . we tested the specific primers with three  of the four strains of x. fastidiosa due to the availability of genomic dna.

pcr reactions were done followed by running agarose gels stained with ethidium bromide  after electrophoresis. the results  showed that  <dig> % of the strain specific primers were successfully predicted . they only amplified the target genomic dna, while no amplifications were detected using non-target dna. further analysis of the result found that the successful prediction rate was influenced by both the weight score and the free energy . if the weight score <  <dig> , 75% of the primers were specific. at this weight score level, Δg° did not affect the prediction rate. however, if the weight score was above  <dig> , Δg° did influence the prediction rate. if Δg° < = - <dig> ,  <dig> % of the primers were specific; if Δg° < = - <dig> , 100% of the primers were specific. to test the effect of the weight score and Δg° on the prediction rate, we categorized the data into two groups. group i consisted of the primers with weight scores > =  <dig>  and Δg° < = - <dig> , and group ii consisted of the rest. in both groups, the primer pairs with false positive result were given a value of  <dig>  and  <dig> otherwise. a t-test was done with r- <dig> . <dig> on two independent sample inference with unequal variances showed that the value of group i was significantly higher than group ii at 95% confidence level with a p-value less than  <dig>  .

system performance
the following example files were used to test the system performance: four genomic sequences  of xylella fastidiosa and a file  of  <dig>  query sequences. when no other jobs submitted, it took  <dig>  hours to complete the design of specific primers and  <dig>  hours for the common primers. the program efficiency of windows version was also tested on a pc with windows xp . it took  <dig>  and  <dig>  hours for specific and common primer design, separately. although the pc version takes double the time of an online version, it recommends that the user use the pc version since the time for the completion of a job by the server is significantly delayed by the number of jobs in the server.

discussion
an advantage of using primersnp is that the generated specific primers are not only allele-specific, but also genome-specific. to ensure genome-specificity, primersnp takes into consideration the partial matches of primers with non-target genomic sequences. the partial sequences of a primer pair, especially sequences close to the 3' end, are critical to primer specificity  <cit> . they may have multiple matches with the target and reference genomes. to eliminate this possibility, primersnp checks the first eight  nucleotides  to ensure that only one perfect match exists between the partial 3' end sequence and the target genomic sequences, and no match with the non-target genomic sequences.

primersnp uses a binary exponent system to accurately quantify the number and position of snps in each primer. the weight score takes into consideration both the number and the locations of snps. thus, weight score is a means to compare the specificity among the primer pairs. no other programs have attempted to quantify the specificity of primers. our initial thought was that higher weight score could result in more specific primers. however, our experiment showed that both the weight score and the free energy of melting  influenced the specificity of primers. a weight score of  <dig>  is critical for specificity. below this value, 25% of primers are non-specific. if the weight score is greater than  <dig> , the lower the Δg° value, the more specific of the primers. when Δg° value is less than - <dig> ,  <dig> % primers are specific; when Δg° value is less than - <dig> , all primers are specific. based on this result, we suggest the following selection criteria for the user: weight score > =  <dig>  and Δg° < = - <dig> .

since the purpose of primersnp is to select reliable specific primers for detection purpose, it uses strict algorithm to filter out those primers that have partial matches with the non-target genomic sequences. therefore, no specific primers are generated for most query sequences. only 1% to 10% of query sequences have specific primers designed. the strictness of this program ensures a higher prediction rate .

primersnp is ideal for bacterial species. it may not be suitable for virus species whose genomic sequences have high mutation rate and therefore many strains. the detection of a particular strain is usually out of the research interest.

primersnp finds its potential usage in screening for risky species and disease epidemics study. the gram-negative, xylem-colonizing bacterium xylella fastidiosa  is the causative agent of several important diseases including pierce's disease  of grape vines, almond leaf scorch disease  and citrus variegated chlorosis   <cit> . citrus variegated chlorois , caused by the 9a5c strain, is not known to occur in america. should xf-cvc be introduced into california, preventing its spread and establishment in citrus growing areas would be very difficult and perhaps impossible. the availability of multiple specific primers could be used to reliably identify this pathogen from thousands of environmental samples. similarly, specific primer design could be used in identifying pathogens of citrus canker disease, caused by xanthomonas axonopodis pv. citri , whose genomic sequences are available and no occurrence has been reported in california.

strain differentiation is another area that primersnp could be used. since each primer contains unique snps for the strain, the change in these snps could be easily detected by pcr. instead of sequencing many target regions, standard pcrs on these strains using specific primers that are designed by primersnp can provide a rapid clue to this question for biologists. multiple specific primers can also be used for strain genotyping research.

currently, the specific primer design using primersnp for higher organisms such as fungi is greatly limited due to the availability of genomic sequences. with the rapid development of sequencing technology such as  <dig>  the cost and time would be significantly reduced. primersnp will certainly be a useful tool for higher organisms.

CONCLUSIONS
primersnp is a convenient tool that automates the process of selecting specific primers that contain strain-specific snps at the genome level which can be used to reliably differentiate one strain from other phylogenetically-related strain/species.

availability and requirements
project name: primersnp

project home page: 



operating system: platform independent

programming language: perl

other requirements: none

license: primersnp is free to academic users while commercial users must acquire a license.

authors' contributions
ec conceived of the study, jy did all programming, jy and dh and wrote the main manuscript. lh, da, fm and le performed the lab experiments, made suggestions to program functionality and edited the manuscript. all authors have read and approved the final manuscript.

supplementary material
additional file 1
the specific primers designed for 9a5c, temecula <dig> and dixon strains of xylella fastidiosa. the specific primers designed for strains of xylella fastidiosa using primersnp.

click here for file

 additional file 2
the result of experimental validation of the specific primers designed for 9a5c , temecula <dig> and dixon strains of xylella fastidiosa. the data provided the experimental validation of the specific primers that are designed using primersnp.

click here for file

 additional file 3
t-test on the effect of weight score and free energy  on the specificity of primers. the data provided the statistical analysis of the primers' specificity of two groups' primers that have different values of weight score and free energy .

click here for file

 acknowledgements
this project is supported by citrus research board  and university of california .
