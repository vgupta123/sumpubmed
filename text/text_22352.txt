BACKGROUND
with the advent of large gene expression experiments, new methods of analysis have become necessary to extract relevant information from the data. exploratory data analysis methods like cluster analysis are regularly used to examine the expression profiles  <cit> . other methods use annotation information and look for overrepresentation in sets of significantly regulated genes  <cit> . a next step would be to associate relevant profiles with annotation information and experimental variables simultaneously. in this paper we will show advances in finding associations between annotation categories and experimental variables in microarray experiments.

one of the most extensive and systematic methods of categorizing information about genes is the gene ontology  database  <cit> . a problem when relating go classes with expression profiles is the fact that the genes in these functional classes can have diverse expression profiles. this could mean that a class is not responding to the experimental factors and is not related to the specific biological settings. however, a second possibility is that interesting subgroups are silenced by other heterogeneous or anti-correlated expression profiles present within the class. this may obscure interesting relations. to address this problem, we propose to cluster the expression profiles of genes in every category, and select relevant clusters before applying principal component analysis .

pca has been applied frequently to explore the microarray data in a low-dimensional space  <cit> . either genes or arrays are described with so called principal components, in order to assess relations between arrays or to identify genes with similar expression profiles. the technique is very versatile and can easily cope with large datasets. work done by alter et al.  <cit>  is an example of the application of pca to reduce the dimensionality of microarray data. pca was applied to the yeast cell cycle dataset of spellman et al.  <cit> , with each gene as an individual object. we will use the same dataset, but will focus on improvements in the application of pca to find relations between specified classes of genes and phases in the cell cycle. the work by goeman et al.  <cit>  is an example of the direct association between annotation information and data analysis. a global test is introduced, determining the relation between a global expression pattern of a group of genes and a clinical outcome of interest. the global expression pattern summarising a group of genes is a method to perform research, based on previous research stored in databases like for instance go. a second example of summarization of annotation categories is from chen and wang  <cit> . in this paper, gene expression data with prior biological knowledge are integrated by constructing "supergenes" for each gene category by summarizing information from genes related to outcome using a modified principal component analysis  method. instead of using genes, these supergenes representing information from each gene category were used in further analysis. both methods  <cit>  indicate that analysing the data on the level improves the results of predictions.

here, we show that summarizing a go category in a single profile or supergene can give problems for certain classes, and can be improved. an example of a heterogeneous go category is shown in figure  <dig>  the expression data are from the saccharomyces cerevisiae dataset  <cit>  and all the profiles belonging to the genes annotated with go: <dig>  are shown in figure 1a. at first glance, there are several particular profiles distinguishable, but it would be hard to give a suitable general description for this category. previously, busold et al.  <cit>  also included go information in their analysis and touched upon this problem by discarding of the categories like the one described here. thus with the criteria of busold et al.  <cit>  this category would not be included in the analysis, because the whole category has a low mean correlation over all the genes. the fact that this category is discarded is surprising, because organization of the cell wall is expected to be important in the cell cycle.

we propose to perform clustering of expression profiles present in individual go classes before applying pca. this is a reversal of the order with respect to more common analyses, where clusters of genes with similar expression profiles are mapped to go terms. an indication of the improvements of go class descriptions after cluster analysis is given in figure 1b, c and 1d. after clustering with model-based clustering  <cit>  these three new subgroups with more distinct profiles can be formed for this class. the new subclasses will not be discarded because the mean correlation of each newly formed class is higher and the role of this process will not be obscured any longer.

the advantages of the cluster analysis will be shown by comparing results from pca performed with and without preclustering. the saccharomyces cerevisiae dataset and a mesenchymal stem cells  dataset will be used. the intra-class correlation of clusters will be analyzed to identify better defined subgroups, and two specific examples of go categories benefiting from the clustering will be given.

methods
all calculations are performed in r  <cit> . go information is obtained from the r data packages "yeast" and "hgu133a".

datasets
two datasets are used to show the advantages of the method proposed here. the first dataset is the well known saccharomyces cerevisiae cell cycle dataset of spellman et al.  <cit> , from here on referred to as the yeast cell cycle  dataset. the focus is on a subset of  <dig> genes involved in the cell cycle  <cit> . from this set, genes are selected for which go annotation information is available. only go classes which contain at least  <dig> genes are considered, which are members of the biological process definition in go. the  <dig> time points of the cdc <dig> synchronization method in the experiment are used. as a result of these choices, a data matrix of  <dig> time points by  <dig> genes is obtained.

the second gene expression experiment analyzed in this paper, was performed on human mesenchymal stem cells, triggered to undergo osteogenic differentiation . this is a time series dataset with multiple osteogenic treatments: dexamethasone , bone morphogenetic protein , vitamin d <dig>  and an untreated control . the hybridizations were performed with affymetrix human genome u <dig> a genechips  <cit> . the dataset was used previously to demonstrate the advantages of applying principal component analysis  on interaction terms from an analysis of variance for a large dataset  <cit> . the msc dataset has four dimensions . rather than focussing on the expression values, as in the ycc dataset, we analyze the "gene-treatment" two-way interaction matrix from the anova model, described in de haan et al.  <cit> . it represents the relations of genes with specific treatments - in this case, we want to extend this to describe the relation of specific go classes and treatments. starting from the interaction matrix, genes are selected having go annotations, where the corresponding go classes contain at least  <dig> genes and have the definition biological process. this gives us a data matrix of  <dig> treatments times  <dig> genes. furthermore, a subset of this set is considered containing  <dig> relevant go categories. these categories have been defined beforehand by domain experts.

principal component analysis and biplots
principal component analysis  <cit>  can be used to give a succinct overview of the structure in a high-dimensional data set using a small number of principal components . these pcs are linear combinations of the original variables x <dig>  x <dig>  ..., xz, chosen in such a way that pc  <dig> describes the largest fraction of variation in the data, and subsequent pcs describe maximal portions of the remaining variation. an essential requirement is that all pcs orthogonal to each other. thus, only the first few pcs need to be considered to get a good overview of the data. in our datasets, the variables x <dig>  x <dig>  ..., xz represent time points or treatments. the data of n objects, each measured at m time points or treatments, can be written as an n by m matrix x. in our case, each object represents the mean profile of a go category . the matrix x is then decomposed by singular value decomposition , as follows:   

where u  and v  are orthogonal and Λ is an n by m matrix containing the so called singular values. the superscript t means the transpose of the matrix v. for the biplot  <cit> , the n ×  <dig> matrix u <dig> of the first  <dig> pcs represents the objects in the data. the m ×  <dig> matrix containing the first  <dig> loading vectors represents the variables in the data. a biplot is then constructed by plotting u <dig> and v <dig> in the same graph.

combining experimental data with go information
in order to relate go information with experimental data, either expression profiles or interaction effects from anova, we should combine both entities. here, we use matrices to represent expression information  and go category information . in both matrices, rows correspond to genes. columns in e indicate time points  or interactions . in matrix g, columns represent go terms in a binary coding: if a gene is annotated for a specific go term the corresponding value in the matrix is  <dig>  otherwise it is  <dig> 

by combining the e and g matrices, categorical information about groups of genes is obtained:   

the resulting data table x is then scaled column-wise so that the sum of each column is one. the x matrix can now be considered to contain the mean expression profiles - or interaction profiles - for all go categories of interest.

finally, pca is performed on the x table containing combined information sources. the results can be visualized with a biplot  <cit> . in the biplots the go classes are shown as points; cell cycle phases and treatments are indicated as arrows. the biplot allows the go terms to be correlated with the treatments or the cell cycle phases.

preclustering
in order to prevent interesting profiles within one go category to cancel out, we propose to perform a cluster analysis on all go categories of interest individually, provided they contain enough genes. the actual clustering is performed on the submatrix of the gene expression matrix e, that corresponds to all columns and genes within a go cluster. based upon the results of the gene expression clustering, new go groups  are added to the go matrix. this step is indicated with the term "preclustering". in the remainder of the paper, we will only consider go categories containing at least four genes. in principle, any clustering method can be used. we have chosen to cluster the genes, present in each go class, with model-based clustering  <cit>  because this is one of the few methods giving an indication of the optimal number of clusters automatically. when this optimal number equals one, the category is not split; if it is larger than one, the go class is split into several subclasses. model-based clustering is available in several r packages, such as flexmix and mclust. which method is used is not very important - the main motivation is to achieve an automatic assessment of the optimal number of clusters. in our scripts, we have used the  <dig> version of mclust . model-based clustering has been applied to gene expression data before . the data are described as a mixture of  distributions. the method applies a number of different models, identified by more or less stringent constraints. parameters for these models include different variations of shape, volume, and orientation of the clusters. selection of the best model is performed using the bayesian information criterion . this index corrects for several parameters used in the clustering - for instance the number of clusters - to enable a fair comparison between the results of different models. the clustering of the model with the best bic was chosen with a minimum of  <dig>  and maximum of  <dig> clusters; it is not to be expected that a higher number of clusters is needed in practice, but one can easily check whether the results improve upon increasing this upper limit. the steps in the preclustering algorithm are displayed below:

 <dig>  construct the e matrix of expression values and the g matrix containing go category information.

 <dig>  set maximum number of clusters and minimum number of genes in cluster 

 <dig>  for each go class:

3a. select the submatrix from matrix e that contains only the genes from that particular go class

3b. perform gene-wise clustering of the submatrix and select the best clustering

3c. accept only clusters with at least the minimum number of genes

 <dig>  define a new g matrix containing either the original go classes or, when clusters have been detected, the go subclasses - one column is used for each class

 <dig>  multiply e and the new g matrix to obtain the x matrix

 <dig>  perform column-wise scaling of x by dividing by the number of genes in each subclass

 <dig>  perform pca on the scaled x matrix and show the biplot

of course, the best clustering model will not necessarily result in interesting clusters only. from a go class, clusters which contain noise or have a less interesting profile, can also be formed. therefore a measure is used to assess the cluster quality of each individual cluster. one way to do this is to calculate the volume for each cluster, available from the model-based clustering. small volumes indicate tight clusterings. an alternative measure, independent of the clustering method, is to use the mean of all the  correlations between the genes within a cluster, the intra cluster correlation :   

here, ci is an element in the lower triangle of the correlation matrix of the genes in a cluster. the measure is also used by busold et al.  <cit>  but was not specifically given a name. by using the icc it is possible to assess the quality of the newly formed subgroups from a go class: high values indicate tight clusters. an additional advantage of the icc over a measure like cluster volume is that uninteresting clusters around zero, which may cover a small volume and therefore would seem interesting according to the volume criterion, usually show only low icc values.

the result of the preclustering stage is a new set of go categories, nested in the original categories. these new categories now are used as matrix g in equation  <dig> to obtain matrix x, the focus of attention. as a consequence, one original go category now may have several representatives in this matrix, and in that case will show up multiple times in pca plots. the matrix e containing the expression values is not changed by the preclustering algorithm.

RESULTS
in this section, we will compare the results of pca using the original go categories with the results of pca on the preclustered go data. besides the restrictions mentioned previously in paragraph  <dig> , all go classes are taken into account, no cuts were made to exclude parts of the go tree. in table  <dig> the number of go terms before and after preclustering is summarized for the datasets. besides the number of unchanged original go categories, the number of original go categories split into new subgroups based on the clustering is shown. furthermore the number of new subgroups containing more than  <dig> genes is given - these are used for further analysis.

only categories containing more than four genes are considered. the header #> <dig> means the number of groups which contains more than  <dig> genes.

clearly, for the msc data set and the relevant subset of  <dig> go categories, many go categories are heterogeneous with respect to the expression data. for the subset, for example, all go categories are split, leading to  <dig> new categories. of these  <dig>   <dig> contain more than four genes. for the much smaller and simpler ycc data set, there is still a group of  <dig> go categories that is split, leading in total to  <dig> categories each containing more than four genes.

ycc data
to investigate whether the new go subcategories generated with preclustering show relevant cluster structure, the iccs of the original go classes and the new subgroups are compared in figure  <dig>  for most classes  the icc has not changed. these classes lie on the diagonal, and consist of go terms for which the optimal number of clusters is determined to be 1: no meaningful subclasses are formed. however, several new subclasses with an increased icc can be observed above the diagonal line. these are examples of groups of genes having a specific profile, which is cancelled out to some extent when the go category as a whole is taken into account. in some instances, a new subclass with fewer than four genes is found. such a class will not be taken into account and is not shown in the figure. note that in this case there is no subclass showing a decrease in icc.

as an example of a heterogeneous go class benefiting from preclustering the term "cell wall organization and biogenesis" is taken. the three subclasses are shown with asterisks in figure  <dig>  the expression profiles and clusters for this term can be seen in figure  <dig> in the introduction. the term is chosen because it is expected to be involved in the cell cycle, where the cell wall has to be organized and assembled during cell division. the new subclasses generated with clustering have an increased icc compared to the icc of the whole class. the profiles are more specific now and will not cancel out in the analysis.

the results of pca of the ycc dataset with the normal go classes, and pca of this dataset after clustering of profiles within go classes can be seen in figure  <dig>  this allows for a comparison of the results and shows the advantages of preclustering go classes in pca. the  <dig> time points of the cdc <dig> experiment are shown as loadings, and are connected by lines. the fact that the cell cycle is passed through more than once results in a large number of time points associated with the same phase . a separation of phases can be seen in both figure 3a and figure 3b. the g <dig> phase is separated from the m and g <dig> phases on the x-axis and the m phase is separated from the g <dig> and s phase on the y-axis. the explained variance in the first two principal components  is more than  <dig> percent.

the consequences of preclustering are shown by a number of differences between figures 3a and 3b. the term "cell wall organization and biogenesis", represented with a star, is used as an example showing interesting changes. when the whole go class is used , the term seems uninteresting and is close to the center of the pca biplot. it is hard to associate it with a specific phase of the cell cycle. when the different profiles are separated by the clustering however, the new subgroups can be associated with phases g <dig>  m, and between m and g <dig> 

msc data
for the msc dataset similar questions about the comparison between normal pca and pca after preclustering of go classes can be asked. the corresponding icc plot is shown in figure  <dig>  the original number of  <dig> go classes has increased to  <dig> subclasses after preclustering, indicated with gray dots. as shown previously, not all classes are divided into subgroups and the unchanged classes are appearing on the diagonal. a considerable number of newly formed classes has an increased icc. many of these subclasses have a low icc for the original go classification, which results in vertical band of points at around x =  <dig>  the plot also tells us that a number of new subclasses are formed with a lower icc than the original go classes. these subclasses arise when a group of less related expression profiles remains after relevant profiles are split off in the preclustering.

because of the large number of go terms for this dataset we will focus on the terms involved in cell differentiation and osteogenesis. out of a list of  <dig> go terms which could be expected to be responsive to the conditions and the setup of the experiment,  <dig> terms were present in our dataset  <dig>  taking into account our criteria for the minimum number of genes in a class. for these  <dig> classes, clustering of the expression profiles in the original go classes gives rise to  <dig> classes. these subclasses are marked with black dots in figure  <dig>  a large number of new subclasses show an increased icc; they all lie in the vertical band described above. there is also a number of new subclasses which has a decreased icc.

for the msc dataset, pca results with and without preclustering are shown in figures 5a and 5b. one should remember that in contrast to the ycc dataset, where expression values are used, here, the interaction values from the anova model are analyzed. four loadings are shown as arrows, corresponding to the three osteogenic treatments and the untreated control . the first two pcs describe  <dig>  percent of the total variation in figure 5a, and  <dig>  percent in figure 5b. a separation between go terms associated with the untreated control and the osteogenic treatments can be seen in the first pc for both figures 5a and 5b. the direction of the unt arrow is opposite of the three treatments  <cit> . in the second pc, a separation between vit and the two other treatments can be observed.

the number of subclasses associated with cell differentiation and osteogenesis has increased from  <dig> original go classes to  <dig> subclasses, as mentioned before. the go term "skeletal development" is shown as an example of a category which benefits from preclustering. the group is marked with a star symbol in figure 5a. after preclustering, six subclasses are identified. as can be seen in figure 5a, the original term could not be associated with a specific treatment and is present in the center of the plot. this has changed dramatically after clustering, as shown in figure 5b. one subgroup is still in the center of the plot, but the other subclasses can be associated with individual treatments. two subgroups can specifically be correlated with osteogenic treatments, one for vit and one for bmp. these groups are even lying on the corresponding arrows for the loadings. a number of genes within the subgroups corresponds with information known from biological literature. the new subgroup lying on the arrow of the bmp contains the gene msx <dig> for instance, which has been proven to be induced by bmp in mice  <cit> . an example of a gene present in the newly formed subgroup lying on the loading of the vit treatment is msx <dig>  which is known to be regulated by vitamin d  <cit> . finally, there are two subgroups which lie in the direction of the untreated arrow and one final class which could possibly be correlated with dex.

to give additional statistical evidence of the improvements of preclustering, the identification of the  <dig> terms mentioned previously was generalized. the generalized procedure was used for both unclustered and preclustered x matrices of the msc dataset . from the first  <dig> pcs of the x matrix, interesting profiles were selected from the outside of the scores in steps of decreasing "interestingness". the larger the distance from the center, the more interesting a profile can be. the selection was based on the mahalanobis distance of a group or subgroup to the center of the data. to assess the relevance of a selection, the set of  <dig> go terms in table  <dig> is used as a reference. at each step the selectivity and specificity of the selection can be determined from the number of reference go terms, which are either present or not present in the selection.

the terms are present in the genes which were used to generate the mean pro les in the x matrix, before and after preclustering. the terms were selected by biologists and expected to be relevant to the biologic context of the experiment, which is the development of human mesenchymal stem cells to osteoblasts.

now a comparison between unclustered and preclustered data can be made by drawing roc curves - see figure  <dig>  the preclustered method is clearly more sensitive and specific, compared to the data where no preclustering has been performed. this means that newly formed preclustered profiles are more to the outside of the data in the first  <dig> pcs, and are more readily marked to be interesting.

discussion
we have shown a simple and general method to relate expression levels, either directly, or after an anova, to go categories at all levels in the hierarchy simultaneously. the crucial step is the realization that genes, although they are in the same go category, may show different profiles. as a result, the application of preclustering leads to more differentiated information. the method is generic; we have opted to use model-based clustering, but in principle any other clustering method can be used, provided that it is possible to automatically generate a reasonable estimate of the number of clusters. the method may be adjusted in a number of ways. the lower limit on the number of genes for a go category to be considered in the analysis is rather arbitrary. for other problems and datasets this can be adjusted depending on the questions for the specific dataset. the same is true for the cutoff for selecting go categories. it is possible to inadvertently remove categories which are of interest to your dataset, but are very small.

other techniques have been proposed for relating measurements to annotation information. an example of relating class information and experimental factors is shown by jeffery et al.  <cit> , who use transcription factor binding sites information. these are sites in the promoters of genes to which a transcription factor can bind. the transcription factors play an important role in the regulatory networks of gene expression. a method called correspondence analysis  was applied to relate classes and experimental information. ca is similar to pca; the algorithm can reduce the multidimensional data matrix to a lower dimension containing the important information from the data. in the standard way of applying ca, the dependency of values in the rows on the columns of a contingency table for two sets of conditions is investigated. after scaling of both the rows and columns, pca is applied to the scaled data.

for the analysis of gene expression data, the first articles which applied ca treated the matrix with expression values as a contingency table. the aim was then to associate genes with variables. kishino et al.  <cit>  applied ca to show the relationship between genes and tissues of a dataset which was designed to investigate colon cancer  <cit> . fellenberg et al.  <cit>  also showed the possibility to investigate the associations between genes and variables. the application of ca to incorporate go information as class information in the visualization of results was shown by busold et al.  <cit> . datasets investigating glucose metabolism and from human pancreatic adenocarcinomas were used.

for our data, ca and pca would lead to very similar results, because of the fact that the column means and row means, used for scaling in ca, are very similar, something that is also true for the data used in, e.g.,  <cit> . in figure  <dig>  the ca curves would completely overlap with the pca curves and therefore have been left out. since pca is more easy to interpret, we prefer it for this case. preclustering of go information as presented here could also reveal interesting findings otherwise discarded in methods using class information like ca.

go information  is to some extent limited, because not all genes are annotated. this will have a limiting effect on the size of clusters for less well known go categories; if a certain go category in the database is not described correctly, or extensively enough, it will obviously be hard to link this go category with the experimental factors of interest. however, the number of annotations will increase rapidly so that the method will only gain in importance.

with the division of go classes in clusters with similar profiles, it is possible that one of the new classes gets a high icc, but remains in the center of the biplot. such a subgroup will contain relatively flat profiles; nevertheless, it is beneficial that it is clustered separately, to prevent other interesting subgroups to be obscured. one final result of the preclustering is that a category can be found more than once in the same pca biplot. this can make it more difficult to draw conclusions for a single go category as a whole. on the other hand, the results will be more indicative of what is really happening within a go class.

CONCLUSIONS
the advantages of clustering heterogeneous go classes have been shown here for two real gene expression datasets, the well-known ycc dataset and the msc dataset. the results show that preclustering yields an increased number of interesting groups deviating from the center of the pca biplot. in this center the less interesting groups with flat profiles are present. in future, more formal selection criteria could be used to identify interesting go classes and newly formed subclasses, based on statistical significance.

these properties of preclustering allow for a better association of go categories with phases or treatments, because interesting subgroups which are obscured by different profiles are separated from each other. new meaningful relations are discovered which would not have been found otherwise with pca. for the go processes "cell wall organization and biogenesis"  and "skeletal development"  this is explicitly shown.

authors' contributions
jdh participated in the design of the study, conceived and performed the statistical analyses, and drafted the manuscript. ep, rcvs, and jcdv helped in the biological analysis of the results. sb participated in generating the msc data set and in the design of the study, and helped in the biological analysis of the results. lmcb participated in the design of the study and helped in the statistical analysis of the results. rw participated in the design of the study, helped in the statistical analysis of the results, and drafted the manuscript. all authors read and approved the final manuscript.

