BACKGROUND
the increasing number of sequenced genomes of multicellular eukaryotes, including human, along with high-throughput methods such as whole genome microarray expression data, allows for systematic characterization of the cis-regulatory elements that control gene expression. regulation of gene expression occurs at multiple levels in metazoans, including transcriptional and post-transcriptional. transcriptional regulation involves binding of transcription factors  to short cis-regulatory elements, or transcription factor binding sites , that are generally 5– <dig> basepairs  long. tfs bind to specific tfbss on dna, which leads to activation or repression of gene transcription  <cit>  into mrna. mrna stability and translation efficiency may be further regulated at the post-transcriptional level. one of the most well studied forms of post-transcriptional regulation involves binding of micrornas  to cis-regulatory target sites residing in the 3' untranslated regions  of mrna and results in translational repression  <cit> . the above mechanisms of regulation of gene expression are the most well studied, but other forms of regulation can also be deciphered at the dna level, such as targets of rna binding proteins   <cit> .

existing experimental methods to identify cis-regulatory elements, or motifs, are time-consuming and cannot easily be scaled up to analyze a large number of genes  <cit> . some other techniques for large scale analysis of sequences, such as chromatin immunoprecipitation-on-chip , require prior knowledge of the trans-acting factor . in contrast, certain types of computational algorithms can be used to discover de novo motifs in the noncoding regions  on a genome-wide scale without prior knowledge of the trans-acting factor and the labor costs of experimental techniques. ncrs are defined as any dna sequence residing outside the translational start and end site of all known genes of a genome. in general, motifs are more difficult to detect in metazoans because the overall genomes are much larger than yeast, including the ncr . furthermore, regulatory elements can reside far upstream, downstream, in introns  <cit> , or utr  <cit>  regions of the genes they regulate. the larger sequence search space leads to an increase in background noise and more difficulty in detecting true regulatory elements. there are existing computational algorithms that identify tfbss  and mirna targets . to identify tfbss, most algorithms start out with a set of co-regulated genes that are functionally related, which may be obtained using microarray data, to search for enriched motifs  <cit> . many of these algorithms were developed and tested in yeast, where the intergenic regions are much shorter and the motifs less degenerate than in metazoans. many mirna target prediction programs in metazoans begin with known mirnas  and use specific base-pairing rules between the mirna and its targets to predict putative binding sites  <cit> .

algorithms for detecting motifs in metazoans tend to leverage evolutionary conservation to reduce the background noise  <cit> . there may be a disadvantage for algorithms that solely rely on alignments as input because studies have shown that the conservation of cis-regulatory sites tend to be low for the same trans-acting factor across different species  <cit> . multiple studies have shown that tfbss often do not fall within conserved regions  <cit> . odom et al. demonstrated that approximately two-thirds of the binding sites of orthologous genes between human and mouse for the same transcription factor occurred in sequences that did not align. due to the lack of verified mirna binding sites, studies have not been as extensive in studying turnover of target sites across species. however, recent studies indicate there is approximately 50% conservation of mirna targets between human and mouse, and that 30–50% of nonconserved sites might be functional in human when the mirna and mrna are expressed in the same tissue  <cit> . alignment algorithms also have their own set of technical problems such as misalignments due to large insertions and/or deletions  <cit> , which may affect defining conserved sites as nonalignable. therefore, computational algorithms that incorporate both sequence conservation and species specific information for detecting cis-regulatory motifs are advantageous.

we previously introduced the compmoby  algorithm for the study of transcriptional regulation in metazoans, which was successfully applied to embryonic stem  cells  <cit> . we have further developed the compmoby software by developing a friendly user web interface that streamlines the analysis pipeline by formatting the user input and filtering the output with suggested default thresholds. the website also allows the user to download the necessary software for extraction of aligned ncrs that are not easily obtainable from a public database , includes sample input files for both 5' upstream and 3' downstream sequence analysis, and documentation that explains the results in the output files. the algorithm has also been extended to accommodate analysis of 3' utrs for post-transcriptional regulatory studies. the utility of this software for 5' upstream and 3' downstream sequence analysis will be demonstrated in the results and discussion section.

the compmoby software integrates species specific and evolutionary conservation information as input into the mobydick algorithm  <cit>  and formats the output files to systematically identify over-represented putative tfbss in upstream sequences, or putative mirna and rbp targets in 3' utr sequences. our tool requires no prior knowledge of the trans-acting factor and allows de novo motif discovery, which may lead to identification of a new tf, mirna, or rbp. currently, we restrict analysis of mirna and rbp target sites to the 3' utr sequences since studies have shown that most known metazoan mirna targets reside in the 3' utr  <cit> .

compmoby has the advantage of being comprehensive and flexible because the software does not only rely on alignments, and cis-regulatory motifs that are alignable do not have to be 100% conserved. compmoby can also capture degenerate cis-regulatory sites in its clustering step, where similar motifs that are not necessarily exact matches are grouped together. this flexibility is a useful feature because cis-regulatory sites for both tfs and mirnas are often degenerate in animals  <cit> . our algorithm also allows the user to identify multiple putative cis-regulatory motifs of different lengths in one run by capturing both strong and weak motifs without having to iteratively mask the strongest motif in the input sequences  <cit>  or rerunning the algorithm for varying motif widths. the ability to capture multiple motifs of varying width and enrichment is a useful feature because there may be multiple tfbss per upstream region of a gene  <cit>  or multiple mirnas per mrna  <cit>  that are often involved in combinatorial regulation of gene expression in metazoans. most existing algorithms use either specific species information or multiple alignments in any one run and output the results separately. in comparison, the compmoby software automatically combines all the mobydick dictionaries derived from aligned and non-aligned sequence sets into clusters of motifs and calculates a p-value of over-representation for each cluster.

the compmoby software provides the user with a tool to identify de novo cis-regulatory elements functioning at the transcriptional as well as the post-transcriptional level in metazoans. the nature of the algorithm allows the biologist to systematically identify the exact positions of putative cis-regulatory elements that are conserved and/or species specific on a genome-wide scale for experimental follow-up, which may provide insight into further understanding the complex regulatory networks of metazoans.

methods
algorithm overview
compmoby is a general cis-regulatory motif discovery algorithm that can be used to identify motifs enriched in intergenic  <cit>  and 3' utr sequences. the flow of input data to compmoby is shown in figure  <dig>  overall algorithm architecture in figure  <dig>  and the user interface in figure  <dig>  this software has been demonstrated to work effectively in mammalian species  <cit> , where upstream regions of length 2kb were used compared to lengths of 600bp typically used in the promoter analysis of yeast. the compmoby software integrates all the tools necessary to incorporate evolutionary conservation and species specific sequence information as input into the mobydick algorithm and filters and processes the output into two files: the first contains all motif clusters with their corresponding -log <dig> p-values; the second contains only motif clusters that pass a user defined bonferroni corrected -log <dig> p-value cutoff and identifies the sequence source  of the motifs within the cluster .

input sequences
the algorithm is based on input sequences derived from a set of co-expressed genes. the input data consists of three sets of repeatmasked  <cit>  fasta formatted sequences with ensembl gene identifiers   <cit> . the sequences can be the upstream regions from the transcriptional start site  or the 3' utr sequences of a group of co-expressed genes . upstream sequences can be used to identify tfbss, and 3' utr sequences to identify targets of mirnas or rbps. one set of sequences is derived from the reference species, or the species from which the group of co-expressed genes is obtained. the second set of sequences is obtained from the orthologous genes in another species and the mapping is user defined. sources for orthologous gene mapping include the ensembl and ucsc genome browser  databases. the third set of alignable sequences from the reference species is derived from the genome-wide pair-wise alignment between the species used for the reference and orthologous sequences. the pair-wise alignment data can be downloaded from the ucsc genome browser site  <cit> . only the aligned, or conserved, blocks in the ncrs of the co-expressed genes are extracted for compmoby analysis. the aligned blocks are only extracted if they lie within the same length upstream or downstream of the gene as the reference species sequence set. the aligned set of sequences reduced the search space by a third in a pair-wise alignment between mouse and human compared to mouse alone using a group of co-expressed genes specific to mouse pluripotent cells  <cit> . alternatively, the user may choose to use a pair-wise alignment algorithm of their choice and may input the third set of alignable sequences in fasta format.

perl scripts to extract all ncrs from the ucsc genome-wide pair-wise alignment can be downloaded on the compmoby website at . we provide a wrapper script that implements all necessary scripts for extraction. this script is computationally intensive because it scans the entire genome for ncrs, but only needs to be run once per build for the reference species of interest and the type of sequence analysis . depending on the user specified options, there are three different types of output files that can be produced from the alignment wrapper script: a file containing all ncrs in the entire genome; a file containing ncrs from only a subset of genes if the previous file has already been created; or both of the above files .

the ncrs are either associated with the nearest downstream gene for tfbs sequence analysis or with the nearest upstream gene for 3' utr analysis. for subsequent runs on the same build and type of sequence analysis, the user may implement the wrapper script to extract only the ncrs of a specified length from a subset of genes. this file containing the subset of aligned ncrs is used as input into compmoby . a tab delimited text file containing all known reference species genes using ensembl gene identifiers and their chromosomal coordinates is required to locate ncrs. this file can be obtained from the ensembl biomart feature  <cit> . for an example of this file, see . the user should make sure that the builds of the reference and orthologous sequences, as well as the ensembl file of known genes, are the same as those of the pair-wise alignments.

given the set of input sequences, the user can choose to analyze a certain length of noncoding region . for the 3' utr analysis, the user has the option to analyze the entire length of the utr sequences . this feature is only offered in the 3' utr option since utr sequences are generally not as long as upstream regions which can be 100's of kbs long, and it would be computationally intensive to search such a large sequence space. the background sequence set, clustering threshold parameter and p-value cutoff options in figure  <dig> will be discussed further on.

building dictionaries and filtering
once the set of sequences is obtained, the software inputs these sequences into the mobydick algorithm  <cit>  to build three dictionaries of putative motifs in parallel. the general idea behind the mobydick algorithm is that dna sequences are decomposed into a set, or dictionary, of motifs based on a probabilistic segmentation model. the following mobydick adjustable parameters are used: l, the maximum word length, was set to  <dig>  and maxp, the probability of seeing at least one false positive at each testing step, was set to  <dig> . once the three motif dictionaries are obtained, compmoby filters out unlikely motifs by the following criteria: one, motif length less than 5; two, number of copies greater than a user defined number to eliminate repetitive elements, such as short at-rich repeats ; three, a quality factor  to be greater than  <dig>  .

from the set of three filtered dictionaries, all the motifs are grouped together by sequence similarity with the cast clustering algorithm  <cit>  to obtain a single dictionary of motif clusters . all pairs of motifs in the dictionaries are scored for similarity based on a gapless pair-wise alignment using a simple mutation model described in  <cit> . the gapless pair-wise alignment does not take into account reverse complements for 3' utr analysis, unlike tfbs analysis, since mirnas and rbps targets are single stranded mrnas. after scoring all pair-wise alignments based on sequence similarity, the cast algorithm is used to group motifs into clusters, referred to as motif clusters, with the default threshold parameter set at  <dig>  . a higher threshold parameter will lead to smaller motif clusters, while a lower threshold parameter will lead to larger clusters of motifs with less sequence similarities within each cluster. this clustering step allows for degeneracy of the cis-regulatory sites within and across species.

calculating motif cluster enrichment
-log <dig> p-values are calculated from a poisson distribution based on the number of occurrences of the motif cluster in the input reference species sequence set compared to an expected number of occurrences derived from a random background set. the background set usually consists of the upstream or 3' utr sequences of the same length as the input data from the entire genome of the reference species, or all other genes on the microarray from which the co-expressed genes were derived. this background sequence set can be obtained using the ensembl biomart feature . the user has the flexibility to upload a sequence file in fasta format containing a background set of their choice. we recommend using a background set consisting of  <dig> sequences or less and uploading a gzipped file to the compmoby web interface due to the upload time. the -log <dig> p-value of each motif cluster is then bonferroni corrected by the total number of clusters .

output files
compmoby processes the results into two output files: one contains all motif clusters with their corresponding -log <dig> p-values; the second contains only motif clusters that pass a user defined bonferroni corrected -log <dig> p-value cutoff  as well as the input sequence source  from which each of the motifs within the motif cluster are derived . the website address to the output files are emailed to the user when the analysis is completed. explanation of the output files can be found from the web interface at .

implementation and user interface
compmoby is implemented in perl and the interface is written in html and cgi. the mobydick algorithm is mainly implemented in c with a perl wrapper. the compmoby software and all dependencies were developed and tested on a  <dig>  ghz intel xeon desktop machine. the compmoby software can be found at  .

RESULTS
application to analysis of transcriptional regulation in embryonic stem cells
in our previous study, we applied compmoby to a dataset of  <dig> co-expressed genes  that were highly up-regulated in mouse embryonic pluripotent cells compared to differentiated cells to gain insight into the transcriptional regulation of es cells . part of one motif predicted by compmoby, attacaat, was extended using a four species alignment  <cit>  into the flanking regions  and experimentally verified by two different labs  <cit>  as a binding site for oct <dig> and sox <dig> upstream of nanog, a key regulator of es cells . experimental validation of  <dig> out of the  <dig> predicted motif clusters that passed our bonferroni corrected cutoff  from the compmoby analysis of the pluripotent co-expressed gene set, showed that in mouse es cells 56% of the tested motifs  showed significant luciferase reporter activity compared to a control containing only a basal promoter . interestingly, when the motifs that had significant reporter activity in mouse es cells compared to differentiated cells were experimentally tested in human es cells, the luciferase reporter activity was conserved. four out of the ten motif clusters also demonstrated sequence specific binding by proteins present in es cells using electrophorectic mobility shift assays . it is interesting to note that the reporter activity of a couple of the motifs are comparable to that of the known oct <dig> enhancer , which suggests that they may bind novel tfs with an important role in regulating es cells. the other bound motif clusters are also novel predictions for which there are no known regulators and may bind tfs with important, yet undiscovered roles in regulating es cells.

an advantage of using computational tools such as compmoby over experimental methods is the ability to systematically predict tfbss and their location upstream of many genes at once, thus reducing the time-consuming experimental dissection of large ncrs. in this particular case of cis-regulatory motif analysis in mammalian species, compmoby improves upon mobydick. the oct <dig> and sox <dig> binding site upstream of nanog would not have been discovered using mobydick on the mouse sequences alone because the motif is only found in the set of sequences containing aligned blocks between mouse and human . another motif cluster shown to be bound by a protein present in es cells would not have been discovered using only mobydick since the motif is only found in the aligned blocks sequence set. other cis-regulatory prediction algorithms such as meme  and bioprospector  also failed to identify the oct4/sox <dig> binding site using only the mouse sequences. meme was independently run eight times with the following adjustable parameters: nmotifs =  <dig>  width =  <dig>   <dig>   <dig>  or max width =  <dig> and min width =  <dig>  bioprospector was independently run  <dig> times, with five trials per width due to the stochastic nature of the algorithm, with the following adjustable parameters: width =  <dig>   <dig>  or  <dig> and background = same background sequence file used for compmoby analysis of motif enrichment. we also compared compmoby to compareprospector, which uses alignment information from multiple species. compareprospector  <cit>  discovered a consensus motif that was a  <dig> out of  <dig> bp match to part of the experimentally verified oct4/sox <dig> binding site using alignments between mouse and human, while compmoby found a motif cluster, where one motif within the cluster was an exact match. in order to identify the oct4/sox <dig> binding site, compareprospector had to be run multiple times with the following adjustable parameters: 1kb or 2kb mouse and human aligned sequence file using lagan  <cit> , width =  <dig>   <dig>  or  <dig>  conservation threshold = default values, and background = aligned input sequences or 1kb mouse background sequence file used for compmoby calculation of motif enrichment. only when compareprospector was run with width =  <dig> and background = aligned input sequences was the oct4/sox <dig> binding site found.

by analyzing both species specific and aligned sequences simultaneously, compmoby enables a user to decide what type of motif they would like to experimentally test depending on the biological study. this feature is important for regulatory studies in model species, where the user may wish to study conserved as well as divergent regulatory pathways. our previous study demonstrates the power of compmoby to identify regulatory motifs that may be functional in the model organism and applicable to human, and to discover novel tfs that may have important roles in regulation by not requiring a priori knowledge of known tfs.

compmoby identifies the target sites of mammalian tissue-specific mirnas
mirnas play an important role in controlling gene expression at the post-transcriptional level and studies have shown that one mirna may have multiple binding sites on the same target mrna, which leads to stronger repression of the mrna  <cit> . in animals, mirnas match target sites in 3' utrs of mrna with imperfect complementary pairing. the seven consecutive nucleotides starting from the first or second bp of the 5' end of a mirna is the seed region, which is one of the important criteria for determining mrna target recognition. we reasoned that since the seed region is a motif often occurring in multiple copies in 3' utr sequences, we could treat mirna target site prediction similarly to that of tfbss given a set of co-regulated genes. compmoby was tested on two human datasets  <cit>  to access the algorithm's ability to correctly identify the mirna target motif in the 3' utr sequences of a set of co-expressed genes.

lim et al. generated the datasets by independently over-expressing mir- <dig> or mir- <dig> in human hela cells and then profiling the mrna on whole genome microarrays. both mir- <dig> and mir- <dig> are known for their tissue specificity in mammals, where the former is preferentially expressed in heart and skeletal muscle, while the latter is preferentially expressed in brain. lim et al. identified  <dig> genes that were significantly down-regulated  at both  <dig> and  <dig> hours with mir- <dig> over-expression and  <dig> genes with mir- <dig> over-expression.

we considered each set of the down-regulated genes to be co-regulated and used the human 3' utr sequences  of these genes mapped to ensembl gene identifiers  for input data into compmoby as the reference species . 3' utr sequences from the orthologous mouse genes  were used as the orthologous sequence set. the aligned blocks set containing 3' utr sequences of the co-regulated genes were derived from whole genome pair-wise alignments between human  and mouse  downloaded from the ucsc genome browser. for cases where there are multiple transcripts per gene, the longest transcript was used to avoid over counting motif occurrences. the background sequences consisted of all 3' utrs from the entire human genome minus the set of 3' utrs from the set of co-expressed genes. compmoby was instructed to analyze the entire 3' utr sequences . the motif cluster with the most significant p-value predicted by compmoby was the target site of mir- <dig>  and mir- <dig> . the input sequence files for the mir- <dig> over-expression analysis used in the compmoby analysis can be found at . mobydick analysis on the human 3' utr sequences alone would not have been able to identify the target site of mir- <dig>  which is derived from only the mouse sequence set , where the signal for the target site may be stronger than in human.

compmoby identifies a regulatory motif in the 3' utr of n-myc in mouse es cells
we applied compmoby to analyze the 3' utr sequences of  <dig> co-expressed genes  that were  <dig> -fold up-regulated in all pair-wise comparisons of different types of mouse pluripotent cells, including es cells, to various types of differentiated cells  to identify putative mirna and/or rbp target sites.  <dig> predicted motif clusters passed our bonferroni corrected cutoff of -log <dig> p-value >  <dig>  to assess the performance of compmoby on this dataset, we experimentally validated a motif cluster that was derived from the mouse and human sequence sets  and found in the 3' utr of n-myc. this motif cluster was not found using bioprospector  or meme  on the mouse 3' utr sequences alone. we focused on the n-myc motif because n-myc is highly up-regulated in pluripotent cells  <cit> . furthermore, there is likely redundancy of the different forms of myc proteins regulating self-renewal in es cells  <cit> . c-myc is capable of reprogramming fibroblasts to pluripotent stem cells in combination with other tfs  <cit> , but n-myc is largely interchangeable with c-myc  <cit>  and can substitute for c-myc in reprogramming fibroblasts  <cit> . we transfected mouse es cells with a firefly and renilla luciferase reporter construct containing the motif in the 3' utr region of the renilla gene . the construct contained a single copy of the motif plus a 50bp flanking region. this construct showed a significant increase in luciferase expression when compared to the empty construct  transfected into mouse es cells . to verify that the predicted motif and not the flanking region was driving luciferase expression, we made three different mutants of the motif as well as deleting the motif altogether . the increased luciferase expression was significantly reduced or abolished indicating that the predicted motif is responsible for the enhanced activity.

these experimental results suggest that this motif is a functional activator in es cells. rbps recognize binding sites on their target mrnas and may act as an activator or repressor on gene expression by controlling mrna stability and translation during post-transcriptional regulation  <cit> . in human neuroblasts, n-myc has been demonstrated to be regulated by a rbp that affects the stability of n-myc mrna  <cit> . the results from analyzing published datasets and our experimental validation of es cell data demonstrate that compmoby can be used to identify cis-regulatory motifs in the 3' utr sequences of mammalian species given a set of co-regulated genes. compmoby also allows for discovery of novel mirnas and other trans-acting factors by assuming no prior knowledge of the trans-acting factor. many mirna binding sites are not evolutionarily conserved   <cit>  and compmoby offers the advantage of allowing detection of both conserved and nonconserved binding sites in the 3' utrs.

future directions
with the increasing number of sequenced genomes, future versions of compmoby will allow for multiple species alignments to be used. another addition will be the option for users to upload gene identifiers instead of 5' upstream and 3' utr sequences, which will reduce the upload time and allow for the analysis of a greater number of sequences per species. for the pair-wise alignment sequence set, uploading gene identifiers will eliminate the computationally intensive work of ncr extraction for the user. this additional feature will require storage of sequences from the most commonly used species and recent builds. compmoby will also be extended to allow for 5' utr and intronic sequence analysis in future versions.

CONCLUSIONS
compmoby is a comprehensive and flexible software tool with a user web interface for de novo detection of conserved and nonconserved motifs from a set of co-regulated genes. compmoby is an improvement over mobydick for cis-regulatory motif detection in mammals by allowing for multiple input sequence files to take advantage of evolutionary conservation information, and filtering the output files into user-friendly formats. our software is a useful tool that has been demonstrated to successfully identify known and novel motifs in real biological datasets that have been experimentally validated by other studies as well as in our previous study, which may lead to discovery of new tfs, mirnas, or rbps. our results using experimentally validated datasets demonstrate that compmoby can be used to study regulation at both the transcriptional and post-transcriptional levels in metazoans by systematically identifying regulatory motifs on a genome-wide scale.

availability and requirements
project name: compmoby

project home page: .

operating system: platform independent , unix .

programming language: perl, c.

license: accessible and free for all users.

abbreviations
bp: basepair; chip-chip: chromatin immunoprecipitation-on-chip; compmoby: comparative mobydick; es cells: embryonic stem cells; mirna: microrna; ncr: noncoding region; rbp: rna binding protein; tf: transcription factor; tfbs: transcription factor binding site; tss: transcriptional start site; utr: untranslated region

authors' contributions
cc and hl conceived and designed the project. cc developed and coded compmoby and web interface, and analyzed and interpreted 5' upstream and 3' utr sequence results for all datasets. cm and rb designed, performed, and analyzed luciferase reporter experiments, and cm, rb, cc, and hl interpreted luciferase results. ry, gw, and mrs analyzed and provided list of up-regulated pluripotent cell genes for the 3' utr analysis. cc and hl wrote the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
accession numbers of embryonic stem cells for upstream sequence analysis. ensembl accession numbers of genes up-regulated in mouse embryonic stem cell compared with differentiated cells.

click here for file

 additional file 2
accession numbers of mir- <dig> over-expression. ensembl accession numbers of genes down-regulated in human hela cells with mir- <dig> over-expression.

click here for file

 additional file 3
accession numbers of mir- <dig> over-expression. ensembl accession numbers of genes down-regulated in human hela cells with mir- <dig> over-expression.

click here for file

 additional file 4
accession numbers of embryonic stem cells for 3' utr analysis. ensembl accession numbers of genes  <dig> -fold up-regulated in all pair-wise comparisons of different types of mouse embryonic pluripotent cells to various types of differentiated cells.

click here for file

 additional file 5
materials and methods for luciferase reporter assays. materials and methods for es cell culture and luciferase reporter assays in 3' utr sequence analysis.

click here for file

 acknowledgements
we would like to thank members of the li and ramalho-santos laboratories for their useful discussion and input on this project. we give special thanks to jiashun zheng for setting up the webserver and helpful discussions regarding cgi scripts. this work was supported by predoctoral national science foundation fellowships to cc and cm, nih grants  to rb, larry sandler internal ucsf grant to gw, funding from the ucsf center for bioinformatics and molecular biostatistics to ry, california institute for regenerative medicine and ucsf institute for regeneration medicine funding to mrs, and nih grant  and lucille packard fellowship to hl. rb is a pew scholar.
