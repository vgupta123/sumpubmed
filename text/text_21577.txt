BACKGROUND
metabolic fluxes in animal tissues can be identified by measuring the incorporation of stable isotopes in intracellular metabolite pools. to quantify metabolic fluxes, isotope label incorporation is usually measured at several time points  <cit> , among others in heart tissue  <cit> – <cit> . heterogeneity of metabolism inside the heart often confounds time series of small tissue samples, therefore a single time point protocol to quantify metabolic fluxes has been developed  <cit> . such single time point measurements in individual samples allow to define spatial profiles of metabolic fluxes in heterogeneous organs  <cit> .

the incorporation of stable isotopes  in metabolic intermediates can be detected by nuclear magnetic resonance  spectroscopy or mass spectrometry . the data is then analyzed with computational methods that require  detailed mathematical models of carbon transitions between the metabolites in the system and  sophisticated optimization procedures for estimating the flux parameters. in the past, we have developed a bioinformatics method to estimate metabolic fluxes in aerobic metabolism from very noisy nmr measurements resulting from the labelling with isotope for a pre-steady-state snapshot  protocol  <cit> . for lipsss, isotope labeled substrate for a metabolic pathway is infused for a short, definite period of time, and the metabolism is stopped before a steady state of label incorporation is reached. finally, pathway metabolites are extracted and measured. although the original computational analysis method  <cit>  explores parameter space extensively to avoid local minima, only a rough estimate of parameter confidence regions was obtained by assuming local linearity. here we introduce a markov chain monte carlo  parameter estimation strategy which allows a full description of the confidence regions of the estimated metabolic fluxes, including correlations and nonlinear dependencies between parameter estimates.

brown et al.  <cit>  and gutenkunst et al.  <cit>  sampled ensembles of parameter sets for systems biology models with mcmc. correlations between model parameters were taken into account and confidence bounds for parameters and model predictions were defined  <cit> . monte carlo methods have previously been applied to metabolic flux analysis  in order to handle inaccuracies in data and model  <cit> . sensitivity analysis by monte carlo sampling is also implemented in a 13c mfa analysis software package  <cit> . in 13c mfa, mcmc sampling has been used for uncertainty analysis  <cit> , for flux estimation with noisy data  <cit> , and for in silico experimental design to determine optimal substrate labeling protocols  <cit> . antoniewicz et al. proposed a different approach of determining confidence bounds on fluxes by calculating the agreement between model and experiment data as a function of the flux of interest  <cit> .

we developed and applied an mcmc procedure to estimate the tca cycle flux, carbon substrate uptake, and oxygen consumption from nmr spectra of 13c enriched glutamate sampled at a single time point. for the computational analysis, we expanded the r-package fluxes  <cit> . this analysis was applied to cardiac tissue biopsies flash-frozen  <dig>  minutes following 13c acetate infusion in porcine hearts in vivo. the method was validated experimentally for a range of cardiac stress conditions. our first goal was therefore to determine the uncertainty in the estimation of metabolic flux parameters based on the quantified uncertainty in the nmr measurements and in the prior knowledge. the second goal was to validate the computational estimations in experiments in vivo.

methods
ethical statement
the study was approved by the advisory board for the use of experimental animals of the vrije universiteit amsterdam. the procedure is in accordance with the american physiological society “guiding principles in the care and use of animals,” which state that muscle relaxants may be used in conjunction with drugs known to produce adequate anesthesia.

experimental strategy
in this study the metabolic flux in the tca cycle was measured in tissue biopsies taken from cardiac tissue via the lipsss experimental protocol which consists of a brief, timed infusion of 13c labeled acetate in the left anterior descending  coronary artery of anesthetized pigs  <cit> . we began with unlabeled acetate which was infused for  <dig> minutes, in order to establish a stationary metabolic state, followed by  acetate for  <dig> minutes and  acetate for  <dig>  minutes. after exactly  <dig>  minutes of 13c enriched acetate infusion, metabolism was arrested by freeze-clamping part of the left ventricular wall of the heart before the isotopic steady state was reached. biopsies from different regions of this part of the left ventricular wall were cut from the tissue slab after freeze-drying, and divided into approximately nine samples per heart with around  <dig>  g dry mass per sample. after extraction with perchloric acid, the 13c nmr multiplets of glutamate were measured. 13c-nmr spectra were obtained at  <dig>  mhz and analyzed with the mrui/amares software package .

up to nine separate multiplet intensities were detected for glutamate. for independent testing of the lipsss method and the associated parameter estimation procedures, “gold standard” myocardial oxygen uptake was calculated from blood flow, hemoglobin content and blood-gas measurements taken before and during acetate infusion  <cit> . note that these classic oxygen uptake measurements are entirely independent of the lipsss method. we analyzed data from lipsss samples taken from n =  <dig> porcine hearts divided into  <dig> different experimental groups:  basal state of the heart , two groups with constriction  of the coronary vessels to reduce blood flow  mild stenosis group, n =  <dig> and  a moderate stenosis group, n = 6),  peripheral venous infusion of dobutamine to induce cardiac stress  or  infusion of adenosine for cardiovascular dilatation  and  finally, a combination of stenosis and adenosine administration . in the mild and moderate stenosis groups, lad blood pressure was adjusted with an occluder to amount to about  <dig> and  <dig> mmhg downstream of the occluder, respectively. in the adenosine and stenosis + adenosine groups, adenosine was infused into the lad at a rate of  <dig> μg/kg/min. in the stenosis + adenosine group coronary blood pressure was reduced to about  <dig> mmhg. in the dobutamine group, dobutamine was infused at a rate of  <dig> μg/kg/min. note that the dobutamine group initially contained  <dig> hearts from which two were excluded from further analysis, due to a low mean arterial blood pressure and insufficient nmr signal for parameter estimation , respectively.

anesthesia and animal experimental procedures
in all groups, sedation was performed with ketamine  <dig> mg/kg and midazolam  <dig> mg/kg intramuscularly, and anesthesia was maintained by continuous infusion of sufentanil , midazolam , and pancuronium . the trachea was intubated and the lungs were ventilated with a mixture of 60% oxygen/40% air. fluid-filled catheters were introduced and hemodynamic parameters collected as previously described . a continuous infusion of lidocaine was started to help prevent cardiac arrhythmias . five cm h2o of positive end-expiratory pressure  was applied before opening the thorax. the thorax was opened via a midsternal incision and the heart exposed by opening the pericardium. the left hemiazygos vein was tied off to prevent mixing of noncoronary venous blood with coronary venous blood. the lad was dissected free over a distance of about  <dig> cm and was catheterized with a 24g catheter. in the stenosis and adenosine + stenosis groups, a custom-made adjustable aluminium occluder was placed around the artery, and lad pressure was measured.

after finishing instrumentation the animal was allowed to stabilize for at least  <dig> minutes, the first batch of microspheres  was injected into the left atrium for baseline blood flow measurements. the intervention was performed and  <dig> minutes later a second batch of microspheres was injected for final blood flow measurements. throughout the procedure hemodynamic data were recorded continuously.

experimental procedures have been described more extensively previously  <cit> .

computational model
the nmr measured enrichment of glutamate with isotopes was analyzed with a computational model. the model of carbon transitions in the tca cycle used in this study was described previously in detail  <cit>  and is therefore only described here in brief. the model contains ten metabolite pools, consisting of metabolites which contain 2– <dig> carbon atoms, and  <dig> transitions of carbon atoms between the metabolites . isotopically labeled substrate enters the system via the acetate pool. acetate is then converted into acetyl coenzyme a , which then enters the tca cycle. since acetyl-coa can also be formed from endogenous unlabeled substrates such as glucose, glycogen, or fatty acids, a diluting pool was introduced to account for dilution of the labeled acetate. the intermediates of the tca cycle are represented by the 6-carbon metabolite pool labeled as citrate , α-ketoglutarate, succinate  and oxaloacetate . glutamate and aspartate are amino acids synthesized by transamination from α-ketoglutarate and oxaloacetate, respectively. the replenishment of tca cycle intermediates was modeled by an anaplerotic influx connected to succinate. malloy et al. have given detailed descriptions of the equations for anaplerosis  <cit> . the metabolite concentrations were given as fixed parameters in the calculations: the glutamate pool size was measured by biochemical assay in each sample  <cit> , because sensitivity analysis showed that results are sensitive to its value. however, the same sensitivity analysis showed that the metabolite pool concentrations of citrate, α-ketoglutarate, oxaloacetate and aspartate had little effect on the results and these concentrations were taken from previous studies  <cit> . all metabolite concentration parameters were therefore fixed and all flux parameters estimated during the markov chain monte carlo procedure . more information about the model and a listing of all model equations can be found in additional file  <dig> 

the dynamic behavior of the model is affected by five system parameters . the flux parameters jtca and jexch, were expressed in μmol/ and represent reaction fluxes through the tca cycle and exchange reactions with amino acids, respectively. the dynamics of incorporation of 13c label from acetate into the acetyl-coa pool depends on transport in the blood vessels, permeation of the cell membrane, the flux of the conversion of acetate into acetyl-coa, the flux of acetyl-coa into the tca cycle and the acetate and acetyl-coa pool sizes. fortunately, the time course of incorporation of 13c label into the acetate pool is almost mono-exponential  <cit>  and can be represented by a single time constant which we term ttrans. we incorporated this efficient way to represent acetyl-coa dynamics into our model  <cit> . the two parameters pdil and panap account for the degree of dilution of labeled acetate and the rate of anaplerosis relative to tca cycle flux, respectively. both are flux parameters which are expressed as fractions of jtca. jtca and pdil describe energy and substrate turnover which are our targets to measure and are therefore labeled “primary parameters”. on the other hand, jexch, ttrans and panap are constrained during parameter estimation by bayesian priors  and because they are not our primary target parameters they are termed “auxiliary parameters” which are allowed to vary to determine the uncertainty which they cause in the primary parameters, the lipsss estimate for myocardial oxygen consumption is calculated from the primary parameters, . note that primary and auxiliary parameters are estimated together in the same procedure.

matching model simulations to nmr measurements
the computational model described above accounts for all possible carbon isotope labeling states  of each of the metabolites. the system is described by  <dig> ordinary differential equations  to calculate the rate of change of each isotopomer over time. for instance, the metabolite glutamate, which contains  <dig> carbons, is represented by  <dig> =  <dig> odes. the isotopomer composition is expressed as fractions of the metabolite concentration of the corresponding pool. thus, at each time point, the sum of all isotopomer fractions in a pool is  <dig>  all odes are then integrated over time to yield the simulated isotopomer fractions. for comparison with the 13c nmr measurements , simulated nmr multiplet intensities  were calculated from the simulated isotopomer fractions for the time point at which the sample was taken in the experiment  <cit> . to this end all isotopomers contributing to a particular nmr intensity were added. the simulated multiplet intensities are dependent on the values of the five model parameters. to quantify the agreement between model simulation and experimental data we define a least-squares cost function c as a function of the parameter vector θ, in which the squared residuals for all multiplets are weighted by their standard deviations and summed. additionally, we include bayesian prior terms in the cost function which reflect prior knowledge on auxiliary parameter values :

  cθ=12∑i∈multipletsmi,sim−mi,expσi,exp2+∑j∈θpriorθj 

the σi,exp represents the measurement error of the nmr intensity. this cost function is used for the optimization procedures. it is also used as the argument of the normal probability distribution used for the mcmc procedure . the cost function integrates data measured directly in the experiment with literature information incorporated in the priors on parameter values.

priors on parameter values
the main objective of this study was to estimate jtca and pdil, the two primary parameters which define aerobic and substrate metabolism and allow the calculation of oxygen consumption in the sample immediately before metabolic arrest. the three remaining parameters ttrans, panap, and jexch are not our target parameters and cannot be determined with great precision. however, these auxiliary parameters are taken into account to evaluate their effect on the estimation of the primary parameters. to improve the estimation and to help avoid local minima in parameter space with physiologically implausible values of the auxiliary parameters, a priori information for such parameters  can be directly entered into the cost function by adding a prior term to the cost function in equation  <dig> for the deviation from a certain reference value θi*

  priorθi=12lnθi−lnθi*σlnθi <dig> 

where σlnθi is the standard deviation for the auxiliary parameter in log-space. the advantage of logarithmic parameters is that the parameter values with a gaussian prior distribution are positive and dimensionless. note that the prior probability in equation  <dig> does not include the normalization factor for the lognormal distribution of 1σ2π. normalization was not necessary because our method applied the metropolis-hastings algorithm which uses the ratios of probabilities.

in previous studies, the value of ttrans had been estimated to be  <dig>  min which is compatible with the time constant of the enrichment of acetyl-coa with radioactive label  <cit> . we constrain ttrans around this prior value with σlnθi set to  <dig> , a high value used in a previous study for unreported experimental errors  <cit> . this is slightly higher than the value for the standard deviation of these parameters determined in simulations by binsl et al.  <cit> . the central 95% region of the prior for ttrans lies between  <dig> / <dig>  and  <dig>  * <dig>  min, since σlnθi =  <dig>  = 1/4*-ln), .

the accurate quantification of the exchange flux jexch between α-amino and α-keto acids was found to be challenging  <cit> . a previous analysis of the model used in this study revealed a low sensitivity of estimations of jtca to variations of jexch in the physiological range from 5– <dig> μmol/  <cit> . reported values of exchange flux in the literature vary substantially. some report high values for the exchange flux . several other studies report jexch to be approximately equal to jtca <cit> . to address this issue, we set a prior on jexch relative to the value of jtca. instead of calculating the prior cost directly from jexch, it is therefore determined by entering the ratio θi = jexch/ jtca into equation  <dig>  the reference value θi* for the ratio is set to  <dig>  based on values for jexch/ jtca reported by nuutinen et al.  <cit>  and yu et al.  <cit> .

because of the large spread of values found in the literature , we assumed a high standard deviation for the ratio jexch/ jtca and set σlnθi to 1/4*-ln) =  <dig> , with θi =  <dig>  it is thereby ensured that jexch lies with 95% probability between jtca/ <dig> and jtca* <dig> 

for the parameter panap, the anaplerotic flux relative to the tca cycle flux, most of the values found in literature were smaller than  <dig> and the highest experimental value found was reported to be  <dig> ±  <dig>   <cit> . hence the prior cost for panap was set to be uniform for values of panap between  <dig> and  <dig> combined with a half-normal distribution which had a standard deviation of  <dig>  taken from lloyd et al.  <cit>  for the values above 1:

  priorpanap=−lnc <dig> ≤panap≤1−ln,panap> <dig> 

with c1=1− <dig> .5+12πσ <dig> and c2= <dig> +12πσ <dig>  the normalization constants c <dig> and c <dig> ensure that the probability density function of the prior is continuous and that its integral is equal to one. n denotes the normal distribution. the probability density functions for prior, prior, and prior are shown in figure  <dig> .

parameter estimation and sampling of parameter ensembles
in biological models, usually many different combinations of parameters can describe the experimental data  <cit> . to address this, we decided to not merely rely on a single best-fit of the model parameters to the nmr data for fixed values of the auxiliary parameters, but instead, we systematically generated ensembles of model parameters that fit the data with reasonable precision. this approach clarifies how well the primary parameters are defined by the data despite uncertainty in the nmr intensities and auxiliary parameters. through the use of an mcmc approach, confidence bounds can be set on the estimated parameter values. sampling is based on bayesian inference of a posterior parameter distribution

  prθ|d=prd|θ*prθ 

where pr is the probability of a parameter vector θ to describe the given data d and pr is the prior probability of the parameters . the right-hand side of equation  <dig> is equal to e− c where the cost function of equation  <dig>  is used. the probability functions were not all normalized because this was not necessary for the mcmc procedure which relies on the ratios of probabilities rather than absolute values. note that the cost function  forms the basis of a probability function  that defined the ensemble of estimated parameter values.

in order to estimate the model parameters and to quantify the uncertainty of the estimated values, we sampled an ensemble of parameter sets which could describe the available nmr data by performing a random walk through the parameter space through the application of the metropolis-hastings algorithm. the starting point of the random walk was an optimized set of parameters, which had been obtained by a grid optimization strategy introduced by binsl et al.  <cit> . the grid optimization was designed to cope with a shallow basin shaped by the cost function in order to avoid optimization towards local minima. the procedure covered the 5-dimensional parameter space by a grid so as to find the best starting point for optimization. the second phase of optimization starting at this grid point was then performed using the nelder & mead simplex algorithm, and in the third phase we used the metropolis-hastings algorithm to sample a parameter ensemble with its probability density proportional to a probability function based on the cost function c of equation  <dig> entered in equation  <dig> 

quality criteria for flux estimations in nmr samples
in many of the available in vivo samples, nmr peak intensities are low and often below the threshold of observability, i.e. often six or seven of the nine multiplets of glutamate are not discernible from noise and were assigned an intensity of zero. in some of these low intensity samples, monte carlo sampling leads to very large ensemble standard deviations of the estimated primary parameters. we excluded such samples which did not yield reliable estimates for jtca. the exclusion criterion was that the standard deviation of jtca in the posterior parameter ensemble exceeded  <dig> μmol/.

software package fluxes
the analysis was performed using the r package fluxes introduced by binsl et al.  <cit> . in order to process parameter ensembles, a monte carlo module was added to the software. this module uses the amcmc algorithm implemented within the package spbayes  <cit> . the amcmc algorithm is a metropolis-hastings variant which automatically adapts the proposal step size for the sampled parameters in the random walk. this leads to quicker convergence to a posterior distribution. for the primary parameters, the time constant of the autocorrelation function of the sampled ensemble was calculated in order to inspect whether the algorithm converged to a stationary distribution. for samples with a high autocorrelation time in the primary parameters, we visually inspected the parameter trace.

a single model simulation run takes approximately  <dig>  seconds on a computer with  <dig>  ghz clock frequency. the grid optimization for a single sample took on average  <dig> minutes, the subsequent sampling with the adaptive metropolis-hastings algorithm took on average  <dig> minutes per sample.

the calculations for all samples were performed in parallel on the lisa computer cluster system at sara computing and networking services . all code required for the analysis and part of the experimental data can be found in additional file  <dig> 

RESULTS
monte-carlo sampling
we estimated the tca cycle flux from the nmr peaks of glutamate for  <dig> tissue samples from  <dig> hearts. applying the exclusion criterion described above we removed  <dig> low-quality samples - leaving  <dig> samples for further analysis. for each sample, an ensemble of  <dig>  parameter sets was generated with the metropolis-hastings algorithm. although convergence was not the first criterion for sample rejection, all ensemble estimates with a high autocorrelation time constant were rejected according to the quality criterion.

an example of a parameter ensemble for one single sample of the control group is given in figure  <dig>  for ttrans, jexch, and panap, the probability density functions of the prior distributions are plotted together with the histograms of the posterior distributions. the posterior distributions for these auxiliary parameters are very broad and relatively close to their corresponding prior distributions. in this way the mcmc ensemble method allowed defining the uncertainty in the primary parameters taking into account the large spread in auxiliary parameters. despite the broad distribution of the auxiliary parameters, the estimates for jtca and pdil form relatively well-defined peaks and their standard deviations are relatively low.

for the primary parameters we can thus provide point estimates for each sample. to determine which measure best reflects the true value of a parameter, we conducted a simulation experiment in which multiple sets of artificial nmr multiplets were generated by model simulation and subsequent addition of gaussian random measurement noise. the parameters were then re-estimated and we compared the estimates from the best fit after grid optimization  and the mean, median, and mode of the monte carlo ensemble with the “true” parameter values from the initial simulation. regarding the primary parameters, the best fit gave the most reliable point estimate. below, we therefore report the best fit values for the primary parameters.

validation by estimation of myocardial oxygen consumption
in order to validate our flux estimation method we compared the lipsss estimated myocardial oxygen consumption ) with independent “gold standard” measurements. the “gold standard” was determined by blood-gas oxygen and blood flow measurements and the lipsss estimated oxygen consumption was calculated from the parameter estimates of the model  <cit> . the mvo <dig> for a single sample is determined from the primary lipsss flux parameters by stoichiometric biochemical relations and can be calculated as follows  <cit> :

  mvo2sample=2+pdil*jtca 

the mvo <dig> determined from blood-gas measurements reflects the oxygen consumption of the entire heart. when averaging the samples taken for lipsss measurements to estimate oxygen consumption for the entire heart , individual sample sizes were taken into account. as in binsl et al., the contributions of the individual samples were weighted by the dry weight wsample for each sample  <cit> .

  mvo2heart=∑wsample*mvo2sample∑wsample 

for all six experimental groups, the comparison of mvo <dig> estimated with the lipsss method  with the “gold standard” oxygen measurements is shown in figure  <dig>  one heart from the stenosis + adenosine group was excluded from the analysis since none of its samples satisfied the quality criterion.

for all groups, lipsss mvo <dig> correlated with blood-gas mvo <dig> relatively well. for the control group oxygen consumption measured by the two methods corresponded, but for the ischemic conditions , oxygen consumption tended to be lower for the lipsss method. we calculated pearson correlation coefficients of  <dig>  for control ,  <dig>  for mild stenosis ,  <dig>  for moderate stenosis ,  <dig>  for dobutamine ,  <dig>  for adenosine , and  <dig>  for the stenosis + adenosine group . the pearson correlation for all groups combined was  <dig>  . the dobutamine group showed higher oxygen consumption than the other groups reflecting the increased cardiac work load. it is important to note that the small tissue biopsies used in the lipsss experiment only covered a relatively small cardiac region, in contrast to the physiological blood-gas measurements which covered the entire left ventricle. furthermore, the estimation of mvo <dig> from the parameters of the tca cycle model only reflects myocardial oxygen consumption linked to the tca cycle flux, disregarding other oxygen consuming reactions which were covered by the blood-gas measurements. the oxygen consumption measurements in a small ischemic region dependent on a constricted coronary artery would be very difficult to obtain with classic blood-gas measurements.

estimation of tca cycle fluxes
lipsss-based estimates for the primary model parameters under all experimental conditions are shown in figure  <dig>  estimates for jtca in the control group averaged  <dig>  ±  <dig>   μmol/. for mild and moderate constriction of the coronary vessels, we estimated jtca to be  <dig>  ±  <dig>  and  <dig>  ±  <dig>  μmol/, respectively.

dobutamine infusion, which stimulates cardiac contraction, leads to a high average jtca estimate of  <dig>  ±  <dig>  μmol/ of tissue. estimations for the adenosine group show no difference with the control condition. the tca cycle flux in the stenosis + adenosine group is in between the mild and moderate stenosis condition.

the relative contribution to the tca cycle flux of substrates other than labeled acetate, i.e. pdil is higher in all experimental groups compared with the baseline condition . low fractional acetate usage, i.e. high dilution has been previously documented in experiments with dobutamine  <cit> .

the estimations of ttrans for all the groups did not differ substantially from the prior value of  <dig>  minutes . ensembles for the auxiliary parameters jexch and panap show large standard deviations. this indicates that these parameters cannot be estimated properly from the nmr data. indeed, the experimental protocol was optimized to estimate the primary parameters, disregarding the auxiliary parameters. nevertheless the effect of the potential spread in these auxiliary parameters on the uncertainty limits of the primary parameters was taken into account. estimations of the auxiliary model parameters are described in supplemental file  <dig> 

discussion
the fluxes of biochemical reactions linked to cardiac energy metabolism are of significant interest. here we investigated a computational method to quantify fluxes in the tca cycle using nmr data from 13c labeling experiments in porcine hearts. we took measurement error in the data and uncertainty of model parameters directly into account. to test the method, distinct 13c labeling patterns  in glutamate were measured under six different cardiac stress and control conditions. the data were analyzed with a detailed model of carbon transitions in the tca cycle and two primary flux parameters of interest  were estimated. possible variation in three auxiliary parameters, taken from experimental literature was included in the application of bayesian priors. to define the uncertainty in estimated flux parameters from measurement error and uncertainty in prior knowledge, we used an mcmc method. as a result, we were able to derive estimates for the tca cycle fluxes under various experimental conditions despite the high noise level in the available nmr data. for validation, we compared blood-gas measurements of myocardial oxygen consumption with oxygen consumption calculated from our own parameter estimates. the oxygen consumption estimated with our model correlated with the classic physiological measurements for the whole heart .

however, because the lipsss parameter estimates relied on small samples obtained from the heart while the blood gas measurements represented the oxygen consumption for the whole heart, the lipsss estimates are expected to deviate from the whole heart measurement. the deviation may have a random component because of the limited tissue sample size, and a systematic component because of functional differences between regions in the heart. the random component is expected because heterogeneity of blood flow and metabolism has been measured in heart muscle  <cit> . a systematic component is expected especially in the stenosis groups, because the lipsss nmr measurements are taken from regions with lower oxygen consumption caused by low perfusion. however, it should be noted that this reasoning is incomplete because the blood gas estimation of oxygen consumption takes the local blood flow measured in the stenosed region into account. nevertheless, systematic differences between the small region and the average for the whole heart may contribute to the deviation from the line of identity  at low oxygen consumptions.

additional physiological measurements of oxygen consumption and metabolic fluxes, independent from the stable isotope labeling experiments, are desirable for further validation of our method. regional rates of oxygen consumption can be measured by measuring oxygen content in small veins  <cit>  with a spectroscopical method in frozen tissue. the latter method is difficult and its validation has been criticized. a further method is the simultaneous determination of myocardial perfusion and oxygen content in small regions of the heart  <cit> . oxygen consumption can also be measured using pet and tca cycle fluxes using in vivo nmr . however, these methods mostly have very limited spatial resolution  <cit>  and were in turn subject to rather limited validation themselves. the difficulty in measuring local energy metabolic flux provided motivation to develop our present method in the first place. despite the limited possibilities, further validation of the lipsss method in the future is desirable.

part of the dataset used here, namely the control and dobutamine group, had been analyzed in a previous study  <cit> . the estimates of binsl et al.  <cit>  relied on prior information on the model parameters ttrans and panap. the latter parameter, describing anaplerosis relative to the tca cycle flux was constrained to  <dig> ± 3% of jtca, based on information from literature studies on isolated hearts. the latter studies however, only accounted for anaplerosis from either propionate  <cit>  or from pyruvate  <cit> . it has been suggested that relative anaplerosis is often underestimated by conventional approaches, including isotopomer analysis or fractional enrichments of carbons in glutamate  <cit> . tracer experiments also exist using 13c labeled propionate that report the relative anaplerotic flux in rat hearts to be much higher than 6%, e.g. 16%  <cit>  or 29%  <cit> . higher relative anaplerotic fluxes were reported during low flow ischemia, reaching 100%  <cit>  and 35%  <cit> . higher values have also been reported for hypertrophy  <cit> . although our estimates for the parameter panap in the present study have a relatively low precision, they suggest the possibility that in porcine heart anaplerotic flux in vivo is relatively high in contrast to low values often found in isolated hearts .

since three different stenosis conditions were included in the present study, we chose a less constraining bayesian prior on the parameter panap which covered a broad range. it is important to note that the bayesian priors were the same for the analysis of nmr data from all experimental conditions. despite the use of different choices of priors on the parameters, and although a higher anaplerotic flux was estimated , our present estimates for fluxes in the control and dobutamine groups did not differ much from the previous estimates of binsl et al.  <cit> . our estimates for cardiac ischemia induced by coronary stenosis show that the tca cycle flux decreases whilst the relative anaplerosis increases  which is compatible with existing literature .

due to the high velocity of the exchange reactions between α-amino and α-keto acids, the determination of jexch using tracer experiments is expected to be practically infeasible  <cit> . because of the uncertainty on jexch, we decided to evaluate the effect of variation in jexch. values for jexch/jtca found in literature vary between  <dig>  and  <dig>  <cit> , but are often around  <dig> in the heart  <cit> , in contrast to the very high jexch/jtca reported for the human brain  <cit> . initial estimations of jexch in our data showed that, particularly in samples with low nmr peak intensity, the simulated isotope enrichment was not very sensitive to jexch. rather than constraining jexch around an absolute value, we chose to set a bayesian prior relative to jtca. the standard deviation of the prior was set to a very high value, reflecting the high variability of jexch/jtca measurements found in the literature. jexch/jtca estimated with our method ranged from  <dig>   to  <dig>  . weiss et al. reported a decreased absolute exchange flux compared with control conditions during post-ischemic reperfusion in rat hearts  <cit> . a decrease in jexch during stenosis was estimated in the present study .

literature information on parameter values was incorporated into the analysis as bayesian priors because of the high noise level in the nmr data. without using prior information, flux parameters sometimes reach physiologically infeasible regions in parameter space. we investigated the sensitivity of our estimates of the primary parameters to the priors for the auxiliary parameters by re-performing the analysis with doubled prior standard deviations in equations  <dig> and  <dig>  the estimate for parameter pdil is rather insensitive to changes in the prior standard deviation  while estimates of jtca are more sensitive to alterations in the priors on auxiliary parameters . especially in the moderate stenosis group, for which the nmr signals are on average very low, many estimates fail to meet the quality criteria if the standard deviation for all three priors simultaneously was made twice as large. this shows that the estimate of jtca is sensitive to the prior. however, bayesian priors are necessary to constrain the estimates within reasonable ranges. it is therefore important to emphasize that the prior values and their standard deviations are not arbitrarily chosen. the prior distributions of panap and jexch are based on experimental data  <cit> – <cit>  and were given large standard deviations. the prior on ttrans is based on previous estimates  <cit>  and its standard deviation allows for a broad range. we therefore argue that although constraining parameters in this study was necessary due to the high noise in the data, our framework still allowed to define reasonable point estimates of flux parameters and additionally to define the variability in parameter estimates taking reasonable, sometimes deliberately high, values for the uncertainty of auxiliary parameters into account.

parametric sensitivity analysis is commonly applied in systems biology  <cit> . in this investigation, we chose an approach that explored the multidimensional space around a set of best-fit parameters using a random walk with the metropolis-hastings algorithm  <cit> . the advantage of this method is that it takes into account possible correlations and nonlinear dependencies between the model parameters. antoniewiecz et al. approached the problem of defining confidence regions for flux estimates by minimizing a sum of squared residuals objective function as a function of the flux value  <cit> . in their approach, the confidence interval for a flux of interest is derived by setting the flux constant while optimizing all remaining fluxes in the system. this step is repeated for a range of fixed flux values until the objective function value exceeds a predefined confidence limit. the advantage of the mcmc approach to determine confidence regions is that it takes all possible correlations between the fluxes into account, since no flux parameter is fixed during the mcmc sampling.

the challenge in analyzing the data in this study was the high noise level. up to seven of the nine measured multiplet intensities could sometimes not be detected. ensemble modeling proved to be a feasible method to separate samples with flux parameters that could be estimated from samples with poor information on the fluxes in the system. this ensemble approach made it possible to identify  <dig> out of  <dig> samples that gave useful estimates for the primary parameters. the quality selection of the samples allowed us to use the best-fit parameters from each sample as a point estimate for the primary parameters. the mcmc approach allowed us to define confidence bounds on all estimated parameter values taking their correlations into account. this is a significant advantage compared with previous approaches, where linearized or analytical methods were used to calculate errors on estimated model parameters  <cit> .

adding the monte carlo ensemble sampling to the lipsss framework enables us to estimate the confidence regions of flux parameters in a single sample. the small size of the tissue samples makes it feasible to identify the spatial variation of flux parameters expected because of the known heterogeneity in the tissue. the physiological meaning of our measurements of heterogeneity in metabolism in heart muscle will be addressed in future studies.

CONCLUSIONS
in this study we improved the lipsss method in order to quantify metabolic fluxes using stable isotope labeling integrated with mathematical models of carbon transitions: auxiliary information was taken into account in the form of bayesian priors and emphasis was placed on the uncertainty analysis of the estimated flux parameters. the method was used to quantify tca cycle fluxes from noisy nmr measurements in porcine hearts under different physiological conditions. two important metabolic fluxes could be determined in single biopsies taken during animal experiments and confidence regions could be calculated for single samples.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
dja, abjg and jhgmvb designed and conducted the animal experiments. hh, twb and jhgmvb designed and conceived the in silico experiments, hh and twb performed the in silico experiments. hh, dja, jh and jhgmvb analyzed the data. hh and jhgmvb wrote the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
model equations. in this supplemental text, we give a detailed description of the computational model and list all model odes.

click here for file

 additional file 2
code and data. in this supplemental file we provide all r code and part of the experimental data used to produce the results of this study. the zip file contains a file readme.txt which describes all code and data.

click here for file

 additional file 3
estimation of auxiliary model parameters. in this supplemental text, the results of estimating the auxiliary model parameters panap and jexch are presented and discussed.

click here for file

 acknowledgements
we thank sara computing and networking services  for their support in using the lisa computer cluster. we thank frans de kanter for assistance with the nmr measurements. we also thank erik van dijk for scientific advice and irisa ono for editorial assistance.

funding
hannes hettling was supported by the centre for medical systems biology , the netherlands consortium for systems biology  and the netherlands bioinformatics centre  which are centres of excellence supported by the dutch government via the netherlands genomics initiative. parts of the open access costs for this article were paid by nwo, the netherlands organisation for scientific research.
