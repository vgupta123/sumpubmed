BACKGROUND
metabolomics, the popular modern approach to screening large numbers of low molecular mass compounds in biological samples, has been successfully applied in drug discovery  <cit> , food science  <cit>  and systems biology  <cit>  studies. the three most commonly used analytical platforms for the identification and quantification of metabolites in biological samples are perhaps gas chromatography-mass spectrometry , nuclear magnetic resonance  and liquid chromatography-mass spectrometry   <cit> . while none of these is stand-alone in the sense that it provides complete coverage of a sample’s metabolome, gc-ms is among the most widely applied because of its ability to separate complex mixtures of metabolites with high efficiency and at low cost  <cit> .

the automated mass spectral deconvolution system  is the most popular freeware available for metabolite identification and quantification in biological samples analysed by gc-ms  <cit> . originally developed for the identification of chemical weapons and related compounds in complex chemical mixtures  <cit> , it is now used in environmental chemistry  <cit>  and metabolomics studies  <cit> . amdis is linked to the nist standard reference database: one of the most popular mass spectral databases for metabolite identification.

while amdis performs well in the identification and quantification of target metabolites within a single biological sample, it does not, in general, use a common reference ion mass fragment  to quantify the same metabolite across different samples  <cit> . this limits the reproducibility of the intensity data generated by amdis and, therefore, its direct utility for comparative metabolomics studies. such data may, for example, lead to erroneous identification of chemical signatures  and, potentially, to the misinterpretation of the activity of metabolic pathways. amdis is also known to yield a high rate of false identifications of metabolites, referred to simply as the false positive rate  <cit> . furthermore, amdis reports different results according to the zoom level applied to the chromatogram under analysis. some compounds are only correctly identified when a smaller portion of the chromatogram is analysed. finally, the layout of metabolomics data preprocessed by amdis is such that it requires further manipulation before it is amenable to subsequent processing and analysis  <cit> . the necessary manual curation of amdis-generated datasets can, therefore, potentially require months to complete.

recent years have seen exponential growth in the number of metabolomics studies. at the same time, spectral libraries have themselves continued to grow in size, thereby enabling an ever-increasing number of target metabolites to be identified within individual gc-ms-analysed samples. additionally, high impact scientific journals have raised their standards with respect to the validation of results from metabolomics studies, requiring higher numbers of samples and technical replicates. the net result has been an explosion in the amount of gc-ms-generated data  <cit> , making manual curation post-processing by amdis impracticable. an algorithm which more reliably identifies and quantifies metabolites analysed by gc-ms and which is implemented in a software package that reports results in a format that facilitates further data processing without manual intervention is urgently needed.

numerous programs and software packages to automate processes for the analysis of metabolomics data have become available in the last couple of years. these tools enable quick data normalisation, statistical analysis and the production of graphs for data visualisation  <cit> . among them is web-based xcms online . it is widely used for the comparative analysis  of the abundances of unidentified imfs in raw gc-ms data. while xcms online enables the identification of metabolites present at significantly different levels across experimental conditions, it is important to note that this involves manual processing. thus, although xcms online can be particularly useful when searching for potential biomarkers, it does not fit the requirements of high-throughput identification and quantification of gc-ms data. consequently, despite amdis’s limitations, it remains the most popular software for the identification and quantification of metabolites in raw gc-ms metabolomics datasets.

we introduce here a new algorithm, pscore, which we have developed for the identification and quantification of metabolites in biological samples analysed by gc-ms. pscore scores the metabolites contained in a pre-defined spectral library according to their likelihood of being associated with a specific chromatographic peak; the higher the score, the greater the similarity between the expected  and observed spectra and rts . for a given metabolite:  the closer its fragments’ detected peaks are to its expected rt,  the more closely its fragments’ relative intensities follow those defined in the spectral library, and  the higher the correlation between the intensities of its fragments, the higher its score. pscore enables the use of threshold scores based on the certainty requirements of each metabolomics experiment, with higher threshold scores resulting in greater precision in compound identification.

pscore is implemented in our new r package, metabox, which generates an integrated list of identified metabolites and their corresponding intensities from replicate samples analysed by gc-ms. metabox includes functions for removing specific ion mass fragments from gc-ms files and for the generation of graphical outputs. the reports generated by metabox can be directly applied to other tools, such as metaboanalyst  <cit>  and the r package metab  <cit> , in order to perform further data processing and statistical analyses. in addition, metabox accepts spectral libraries built using amdis, including the original formats in which they were generated. furthermore, metabox’s use of pop-up dialog boxes makes it more accessible to novice r users. finally, being an r package, metabox is open-source, allowing users to adapt it to their own pipelines for data analysis.

we validated the results produced by pscore through metabox via a two-step approach. first, we compared its performance against amdis’s when identifying and quantifying volatile organic compounds  present in standard mixtures of metabolites. metabox yielded a smaller proportion of misidentifications and higher accuracy in quantification. second, we used xcms online to generate reference datasets for comparing metabox’s performance against amdis’s when identifying compounds present at different levels in faecal samples from female and male mices. metabox yielded a higher percentage of metabolites matching xcms online’s results.

implementation
pscore: the algorithm
pscore is a gc-ms-based retention time  scoring algorithm used to assess the likelihood that the observed rts in a biological sample correspond to known metabolites within a user-defined spectral library.

metabolite identification and quantification by gc-ms
gc-ms instruments usually generate a single file per biological sample, each file containing a list of mass spectra together with their corresponding rts. these spectra are commonly shown on a chromatogram represented by rt on the horizontal axis and signal intensity on the vertical axis. peaks in intensity on the chromatogram correspond to putative metabolites in the analysed sample. pscore performs metabolite identification based on a spectral library containing the rt and fragmentation patterns of potential target metabolites.

spectral library requirements
metabolite identification and quantification require a spectral library containing reference information against which observed spectra can be compared. pscore requires that for each metabolite, m say, in a spectral library, l say, information is included about its expected retention time, ert, and typically its four most abundant imfs’ mass-to-charge  ratios, which we will denote by mi . additionally, pscore requires that l contains the intensity ratios ri=ii′/i <dig>  where ii′ denotes the expected intensity of imf mi′, i.e. ri is the intensity of mi′ relative to that of m <dig>  we will refer to relative intensities simply as intensity ratios. for example, consider the first row of the spectral library shown in table  <dig>  corresponding to the compound ethanol. it has an expected retention time of  <dig>  minutes; its four most abundant imfs have m/z ratios of  <dig>   <dig>   <dig> and 29; the intensities of the last three of these imfs, relative to the first, are  <dig> ,  <dig>  and  <dig> , respectively.this table shows an example of the mass spectral library required by pscore, which contains each standard compound’s name , its expected rt  in minutes, the
m/z
 ratio of its four  most imfs  and the relative intensities,
ri′
, of each
mi′
  to that of
m
1


imf
m
/
z
 ratio
intensity relative to
m
1

compound
e
rt
m
1
m
2
m
3
m
4
r
2
r
3
r
4


many algorithms applied for identifying metabolites analysed by gc-ms, such as amdis and x-rank  <cit> , for example, make use of more than  <dig> ion mass fragments, if available, when calculating the similarity between two mass spectra. our experience analysing gc-ms data suggests that the  <dig> most abundant ion mass fragments and the rt are generally the key factors defining the identity of an analyte. for many compounds, the remaining fragments are generally close to or at the noise level, which increases their variability across samples and may reduce the accuracy in identification. in addition, in the way pscore was developed, every additional fragment to be analysed requires additional computer power, which may considerably increase the analysis’ time. compounds showing less than  <dig> fragments in their spectra may have the existent fragments recycled. for example, a compound x containing only the fragments  <dig> and  <dig> in their spectra would have these fragments analysed twice by pscore. in this case, the row of the ion library defining compound x would have its most abundant fragment defined as m <dig> and m <dig> in the ion library and the second most abundant fragment defined as m <dig> and m <dig> 

in the remainder of this section we describe pscore, a peak scoring method which utilises the information available within a single gc-ms sample to score observed peaks occurring within a range of rts and that are potentially associated with a metabolite, m, in the spectral library, l. the highest scoring peak is inferred as belonging to m. we describe the pscore algorithm according to the four stages shown in figure  <dig> pscore - algorithm. pscore searches a gc-ms file for metabolites contained in a defined mass spectral library. it analyses a region of the chromatogram searching for chromatographic peaks representing a metabolite and scores retention times  potentially representing a metabolite if:  peaks of the imfs expected to originate from this specific metabolite are present at the same rt and if their intensities are equal to the highest intensity observed for each imf; if  these imfs are detected at the expected proportions defined in the mass spectral library; and  if the intensities of these imfs show positive correlation. finally,  pscore calculates the final score associated to each potential rt, it assigns the metabolite searched to the rt showing the highest score and registers the intensity of the most abundant mass fragment associated with this metabolite.



stage 1: scoring peaks associated with imfs m <dig> – m4
when a metabolite elutes from the gas chromatography column and enters the mass spectrometer, it is bombarded by electrons and fragmented into ionised components, or imfs. in theory, the imfs from the parent metabolite, m, should almost simultaneously reach the mass spectrometer’s detector, where their intensities and rts are recorded. this information is commonly used to build both their individual chromatograms and their cumulative or total ion chromatogram. ideal process would result in entire complement of imfs yielding a set of overlapping peaks centered precisely on a single expected rt. in practice, however, rt shifts may be observed depending on the type of sample being analysed and the variability across gc-ms runs. consequently, a metabolite’s imf peaks may occur in the vicinity of, but not precisely at, its expected rt. thus, a search must be conducted across a window of rts spanning the region of the chromatogram which most plausibly contains the imf peaks corresponding to the metabolite.

consider a metabolite m in spectral library l with expected retention time ert. we define a rt window , with the window parameter, w, being user-defined. the region  is searched for groups of peaks potentially corresponding to imfs m <dig> …,m <dig> belonging to m. the jth group’s observed peak intensities are recorded as , where Îij is the observed intensity of imf mi and tj is the rt at which m1’s peak is observed. letting Îmax=max{Îij}, each observed intensity, Îij, in  is scored according to



the total score for  is the sum over the scores assigned to each of its imfs, i.e.



allowing a maximum possible score of  <dig> 

stage 2: similarity scoring of theoretical and observed spectra
if metabolite m is present in a gc-ms-analysed sample, not only do we expect a group of peaks to be observed at its expected rt, we also expect its observed intensity ratios to be identical to their corresponding theoretical values in l. however, due to variability across gc-ms runs and the possible convolution of metabolites, the values of the observed and theoretical ratios may differ from one another. thus, at stage  <dig> we compute the intensity ratios  from the jth group’s observed peak intensities, , where r^i′j=Îi′j/Î1j. it follows that if the observed intensities in  are from metabolite m then we expect r^i′j=ri′ or, equivalently, r^i′j/ri′= <dig> 

we make allowance for variability between observed and theoretical intensity ratios by introducing a match factorf  which we use to construct intervals around each theoretical ratio, ri′, associated with metabolite m. the lower and upper limits of this interval are given by li′=fri′ and ui′=ri′, respectively, with the value of f chosen to yield sufficiently narrow intervals such that only observed peaks from a group of imfs corresponding to m will lie within them. to reflect this, we give each observed ratio r^i′j a score of  <dig> if it falls within its match factor interval . the total score for  is given by the sum over all of its ratios’ scores, i.e. 
 t2j=∑i′=241r^i′j∈,  where 
 1r^i′j∈ <dig> ifr^i′j∈li′,ui′ <dig> otherwise.  allowing a maximum possible score of  <dig> 

stage 3: scoring the correlation between imfs’ intensities
the ion chromatogram of each imf originated from a single compound is expected to form an approximately bell-shaped curve over a range of rts tj±Δ, where Δ is chosen to capture the non-zero intensities with magnitudes that are dependent on rt. we represent this by expressing the intensity of imf mi of m  as a function of retention time t, i.e. Îij. if the imfs corresponding to the intensities in  are perfectly aligned, then theoretically their intensity ratios would be expected to be constant across t∈tj±Δ, i.e. rij=Îij/Î1j=cij, where cij denotes the proportionality constant in the linear relationship between Îij and Î1j and independent of rt. in other words, imfs originating from the same compound are expected to have highly correlated intensities, as they are expected to increase and decrease at the same time.

at stage  <dig> we compute the correlation between the intensities Îi and i <dig>  of m <dig>  , across the retention time window tj±Δ, denoted by ρi1|tj which is calculated using pearson’s correlation coefficient. in our experience, the optimal neighborhood of tj is Δ= <dig> . ideally, ρi1|tj= <dig>  however, this is not always the case. metabolite coelution, for example, may affect the correlation between imfs’ intensities. thus, we define a correlation threshold, ct, such that 0<ct< <dig>  we then give metabolite m a score of  <dig> for each of its observed imfs at tj which have ρi1|tj≥ct; that is, the value of the pearson’s correlation is greater or equal to the correlation threshold ct. the stage  <dig> score function is then given by 
 s3j=∑i=24k{ρi1|tj±Δ|ct},  where 
 kρi1|tj±Δ|ct=1ifρi1|tj±Δ≥ct0otherwise. 

metabolites found at similar rts, e.g. rtma−rtmb≤| <dig> | where rtma is the rt of metabolite a and rtmb is the rt of metabolite b, and sharing imfs, e.g. mam1=mbm <dig> where mam <dig> is the m/z of imf m <dig> originated from metabolite ma and mbm <dig> is the m/z of imf m <dig> originated from metabolite mb, may have lower ρi1|tj and, potentially, lower scoring at stage  <dig>  three pairwise correlations are scored in stage  <dig>  which allows a maximum possible score of s3j= <dig> 

stage  <dig> - defining the rt and the abundance of metabolite m
we calculate the score sm of metabolite m at time tj by 
 sm=s1tj+s2tj+s3tj. 

then, we obtain the intensity of m <dig> at the tj associated with the highest score, sm, and with the lowest difference to the expected rt, ert. this intensity represents the abundance of m <dig> 

stages  <dig>   <dig>   <dig> and  <dig> are performed for every metabolite m in library l. after all metabolites in l are analysed, it may happen that different metabolites were associated to the same time tj. in these cases, we select for each time tj only the metabolite showing the highest score sm and the lowest difference between time tj and the ert.

implementing pscore in metabox
we have implemented our pscore algorithm in an r package named metabox. for each gc-ms sample, it generates a list of metabolites, m, with their respective abundances, pm, their unique rt, tj, at which they were identified and their calculated score sm. metabox then merges the results of individual gc-ms samples into a single r data frame called total using metabolite’s names as reference . optionally, the data frame total can be exported to a csv file.

ideally, sm= <dig> when metabolite m is actually present in the analysed sample. however, it is not always the case. a specific compound’s spectrum may vary slightly from sample to sample as a result of gc-ms variation, matrix effect and metabolite coelution. therefore, we define a score threshold st, such that 8≤st≤ <dig>  metabox then selects metabolites that have a calculated score sm≥st and stores them in a second r data frame called cutoff, containing the name of each metabolite in the first column and their respective abundances in each gc-ms sample in the following columns . optionally, the data frame cutoff can be exported to a csv file.

the rt index is an excellent system for obtaining reproducible results within and across labs. it is currently implemented in amdis and other tools such as tagfinder  <cit> . however, pscore was initially developed to use only the rt. the possibility to use the rt index will most probably be implemented in a further version of metabox.

validation
as we implemented pscore in the r package metabox, we compared metabox’s performance against amdis’s in identifying and quantifying vocs present in standard mixtures of metabolites and in faecal pellets of female and male mice.

methods
standard mixtures
a single standard mixture containing  <dig> metabolites  was prepared and divided into  <dig> aliquots:  <dig> aliquots of  <dig> μl and  <dig> aliquots of  <dig> μl. each  <dig> μl aliquot was diluted by adding  <dig> μl of water, resulting in a final volume of  <dig> μl. each aliquot was then warmed in an incubator oven at 60°c for  <dig> minutes, then vocs were adsorbed onto a solid phase microextraction fiber car-pdms  <dig> μm  for  <dig> minutes and analysed by a perkin elmer  gc-ms using solvent delay,  <dig> min; temperature program ,  <dig> min; ramp of 5°c/min to 220°c; finally held at 220°c for  <dig> min . the ms was operated in ei positive mode scanning mass ions in the range  <dig> to  <dig> . room and lab air were used as controls.

metabolite identification
metabolites were identified using a mass spectral library built using amdis and nist   . we first characterised algorithm performance on a per-sample basis, calculating the percentage of false positive and false negative metabolite identifications, defining the percentage of false positives as 100pi+%, where pi+ is the proportion of misidentified metabolites  in the ith standard sample, and the percentage of false negatives as 100pi−%, where pi− is the proportion of unidentified metabolites in the ith standard sample. for example, consider the standard sample described above containing  <dig> metabolites. if an algorithm identifies  <dig> metabolites, including  <dig> of which are in the standard sample, it is reported as having  <dig> % of false negatives  and 90% of false positives .

high percentages of both false positives and false negatives may lead to erroneous inferences being drawn from the data. optimal metabolite identification tool is one which yields the smallest percentages of both false positives and false negatives. we evaluate the performances of amdis and metabox over all n= <dig> with these criteria in mind.

the match factor used by amdis may affect the number of false negatives and positives reported. therefore, amdis was applied using the match factor values of  <dig>   <dig> and  <dig>  metabox was applied using match factor of  <dig>  correlation of  <dig>  and score cut of  <dig> 

metabolite quantification
all aliquots from the standard mixture were analysed by both amdis and metabox. for amdis, its ‘base peak’ values were reported for the metabolite intensities. a reference dataset , containing the intensity of each metabolite’s most abundant imf, was manually obtained for each sample using the r package xcms  <cit> . the abundances reported by metabox, amdis and reference for each metabolite are expected to be very similar. we confirmed this by performing a hierarchical cluster analysis  and a principal component analysis  on the combined datasets.

mice samples
five female and five male five-week old inbred wild-type c57bl/ <dig> mice were purchased from charles river laboratories  and acclimated to standard animal house conditions at the university of liverpool for a minimum of  <dig> week. the mice were individually housed for a total of  <dig> weeks, when one ten-pellet faecal sample was taken from a clean cage. mice were then sacrificed under schedule  <dig> animals act  <dig>  mice were used in accordance with local ethics approved from the university of liverpool. each  ten-pellet sample was then analysed by gc-ms using the same configuration described in standard mixtures. the mice samples were analysed using amdis and metabox, using a mass spectral library built using amdis and nist database  . in order to remove potential false positives, we only analysed those metabolites present in at least  <dig> samples per experimental condition .

it is difficult to generate a reference or control when analysing mice samples, as the identity and concentrations of metabolites in these samples are unknown. therefore, we applied an approach used for biomarker discovery  <cit> . we used xcms online to generate a reference dataset containing the list of imfs present at significantly different levels between female and male samples , including the rt where the peak of each imf is detected. then, we used our spectral library , which contains the expected rt and the imfs of each metabolite, to identify the imfs reported by xcms online. we then conducted a welch’s t-test on the amdis and metabox datasets comparing males and females for each listed metabolite and compared these algorithms’ performances against the t-test results from xcms online. for clarity, compounds found at significantly different levels between female and male mice samples will be called as biomarkers. 

the cas numbers of all metabolites used in this study are available in table s <dig> of the additional file  <dig> 

RESULTS
standard mixtures
for clarity, aliquots of  <dig> μl of standard mixture +  <dig> μl of water will be described simply as  <dig> μl samples, while aliquots of  <dig> μl will be described as  <dig> μl samples.

metabolite identification
to enable the comparison of amdis’s and metabox’s efficacies in metabolite identification, we calculated the percentages of false positives and false negatives reported by each algorithm when analysing  <dig> samples of a standard mixture of metabolites , using match factors of f= <dig>  and  <dig> for amdis; and match factor of f= <dig> and score cut of  <dig> for metabox. every compound reported by amdis was considered in the analysis, including multiple identifications for a single rt. for f= <dig>  amdis reported an average ± se  of  <dig> % ±  <dig> % of false positives and an average of  <dig> % ±  <dig> % of false negatives. f= <dig> and  <dig> resulted in  <dig> % ±  <dig> % and  <dig> % ±  <dig> % of false positives, respectively, and  <dig> % ±  <dig> % and  <dig> % ±  <dig> % of false negatives, respectively . metabox performed overwhelming better than amdis, reporting no false positives and no false negatives.average percentages of false positives and false negatives. a standard mixture containing  <dig> metabolites was divided in  <dig> aliquots and analysed by gc-ms. each sample was then processed by metabox and amdis using match factors of  <dig>   <dig> and  <dig>  shown are the average percentages, plus error bars representing two times the standard error, of false positives and false negatives produced by each tool. false positives are compounds that are misidentified, while false negatives are unidentified compounds that are present in the standard mixtures.



although, amdis performed reasonably well in terms of low percentages of false negatives, it was a poor performer with respect to its high reporting of false positives. it may be that amdis is actually performing as expected given the primary motivation for its development, single-sample analyses of complex chemical mixtures to identify any signs of potential target compounds or chemical weapons  <cit> . in this context a low false negative rate is crucial and amdis’s performance meets this requirement. however, the primary motivation for most metabolomics experiments, is the identification and quantification of the highest possible number of metabolites present in biological samples for the comparisons of their abundances, or relative abundances, across experimental conditions. it is non-targeted analysis generally limited only by the metabolites represented in the spectral library. the biological interpretation is then achieved based on the metabolite profile generated by each sample. in this case, the percentages of both false negatives and false positives are crucial for biologically meaningful interpretations of the data. a high percentage of false negatives represents potential losses of biological evidence, while a high percentage of false positives may provide misleading evidences. therefore, results generated by amdis should be manually curated and critically assessed in order to achieve sound biological interpretations.

metabolite quantification
average-linkage hierarchical cluster analysis   and principal component analysis   were performed on the metabolite abundances reported by amdis and metabox . the hca yielded two main nodes, or clusters: one containing the  <dig> μl samples and the other the  <dig> μl samples. within samples, the metabox and reference datasets always clustered together under the same node in the first agglomeration round and this node excluded the corresponding amdis dataset. this is indicative of metabox-generated abundances being closer in value to those in the reference datasets than the amdis-generated ones. the pca yielded results consistent with those from the hca, i.e. the  <dig> μl samples clustered together around negative values of the first principal component  while the  <dig> μl samples clustered around positive values of pc  <dig>  the  <dig> μl samples varied little in the direction of the second principal component , indicating that amdis and metabox yielded datasets that were similar to one another and to the reference datasets. samples corresponding to metabox-based datasets were always adjacent to the matching reference dataset, showing once again the high degree of agreement between the metabox and reference datasets. the  <dig> μl samples showed separation of datasets in the direction of pc  <dig>  the reference and metabox datasets derived from the same sample consistently yielded approximately equal values for pc  <dig>  once again showing a high degree of similarity between the two sets of data. amdis, on the other hand, yielded datasets with pc  <dig> values less than or equal to zero, demonstrating that only when a high match factor is used will amdis yield datasets containing abundances approaching values close to those in the reference datasets.hierarchical cluster analysis  and principal component analysis .
 dendrogram from hca  and  scatterplot of first two principal components from pca on data resulting from the application of amdis and metabox to the raw data from  <dig> gc-ms-analysed standard mixture samples . reference datasets  were obtained using the r package xcms. samples are labeled using a combination of sample number  and the algorithm applied .



part of the dissimilarity between the amdis and the reference datasets may be a result of background noise subtraction performed by amdis and/or the use of different imfs when deconvoluting and quantifying the same metabolite across samples. the potential use of different imfs for metabolite quantification by amdis is another indication of its development without a view to comparing the same metabolite across different samples, and yet this is a fundamental concern of metabolomics studies. further evidence lies in the format it uses for reporting results. amdis can generate two types of reports: individual reports or a single report  for several samples by simply appending results sample-by-sample without actually matching metabolites identified in the different samples. furthermore, amdis reports multiple potential identities associated to a single rt. consequently, when applied to metabolomics studies, amdis’s results must be manually cleaned , the ion mass fragment used to quantify each metabolite must be manually verified and the results produced for different gc-ms files must be combined in a single table or spreadsheet, and this can be enormously time-consuming depending on the number of samples being processed. metabox, however, was developed specially for metabolomics studies. its results are reported in a single spreadsheet containing the identified metabolites and their respective abundances in every analysed sample, and in the format most commonly required for downstream data normalisation and analysis.

mice samples
to compare the efficacies of amdis and metabox in identifying potential biomarkers, we evaluated the datasets generated by each against the xcms online reference dataset. xcms online reported a total of  <dig> imfs , from which  <dig> showed significantly different intensities  between female and male mice faecal samples . based on the imfs and rts in the spectral library used by amdis and metabox , we identified  <dig> compounds associated to the total list  of imfs reported by xcms online. eleven compounds were associated to  <dig> of the  <dig> imfs reported by xcms online at significantly different intensities between female and male samples . however, only  <dig> of these compounds  showed imfs that were both present at significantly different levels according to xcms online results and used by amdis and metabox for metabolite quantification. therefore, only these  <dig> compounds were expected to be found as potential biomarkers by amdis and metabox. amdis and metabox were able to identify all  <dig> compounds associated to the xcms online results . for all match factors tested, amdis identified  <dig> potential biomarkers, being only one confirmed by xcms online . metabox identified  <dig> potential biomarkers, being two confirmed by xcms online . in summary, amdis was able to report  <dig> out of  <dig> potential biomarkers, while metabox reported  <dig> out of  <dig>  although metabox missed the identification of  <dig> potential biomarkers, its results represent 100% improvement in relation to amdis’.list of compounds identified from xcms online results as differentially abundant  between gc-ms-analysed female  and male  mice faecal samples



compound
metabox
amdis70
amdis80
amdis90
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
amdis analyses were performed using match factors of  <dig>   <dig> and  <dig>  p-values <  <dig>  in italics indicate differentially abundant metabolites.



CONCLUSIONS
identification and quantification of metabolites is among the most critical and time-consuming steps in gc-ms metabolome analysis. the reliability of the biological inferences that can be drawn from metabolomics studies is directly related to the quality of the data upon which they are based. in addition, as the size and number of metabolomics studies conducted by individual laboratories has grown, the time available to analyse each single dataset has reduced. therefore, to satisfy the criteria of metabolomics studies ideally software must reliably identify and quantify metabolites, and the results must be reported in a format that facilitates further data analysis. although amdis has been widely used in metabolomics, results show that its performance no longer meets the requirements of modern high-throughput analysis of metabolomics experiments.

we presented here a new algorithm, pscore, which uses a spectral library to analyse gc-ms samples and score retention times according to their probability of representing a metabolite. we implemented pscore in an r package, metabox, and compared its performance against amdis when analysing standard mixtures of metabolites and mice faecal samples. pscore greatly reduces the percentage of false positives and false negatives, and it considerably improves the quantification of metabolites analysed by gc-ms. in addition, our new r package metabox incorporates functions to generate graphical outputs and reports results in a format accepted by other software, such as metab and metaboanalyst, allowing users to perform further data processing and statistical analyses in a high-throughput way. as an r package, metabox allows users to construct flexible pipelines for data analysis and allows pop-up dialog boxes, which facilitate its usage by r beginners.

availability and requirements
project name: metaboxproject home page:http://raphaelaggio.github.io/operating system: platform independentprograming language: r  <cit>  version  <dig> . <dig> or higherother requirements: r packages xcms  <cit> , svdialogs  <cit> , pander  <cit>  and massspecwavelet  <cit> license: general public license version 3

additional files
additional file  <dig> 
supplementary data. file containing the tables to be used as supplementary data.



additional file  <dig> 
xcms online results. file containing the results from the xcms online analysis performed on mice samples.



competing interests

the authors declare that they have no competing interests.

authors’ contributions

ra developed the algorithm , implemented pscore into the r package metabox, designed the experiments for validation, analysed the data, created the figures and wrote the manuscript. am generated the standard mixtures used for validation, assisted on the implementation of pscore into metabox and revised the manuscript. sr generated the mice samples used for validation and revised the manuscript. csjp assisted on the development of pscore and revised the manuscript. kr assisted on the development of pscore, assisted on the implementation of pscore into metabox and wrote the manuscript. all authors read and approved the final manuscript.

