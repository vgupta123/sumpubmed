BACKGROUND
flowering plants  display a bewildering diversity and, in many cases, complexity of mating systems compared to most animal groups  <cit> . the overwhelming majority of angiosperms are characterized by cross-pollination of their flowers, whereby mechanisms preventing self-fertilization range from the separation of sex functions within flowers  and plants , to separate sexes , and self-incompatibility  systems  <cit> . still, about 20– <dig> % of all flowering plant species are predominantly selfing  <cit> , which is commonly thought to reflect two main advantages, which are not necessarily mutually exclusive. first, selfing genes should enjoy a two-fold transmission advantage over genes for outcrossing  and, second, the loss or paucity of pollinators or mates should selectively favour selfing individuals/populations because it provides reproductive assurance . on the other hand, inbreeding depression has long been recognized to counteract the evolution of selfing and explaining the maintenance of outcrossing . in fact, selfing lineages or taxa are typically assumed to be an evolutionary ‘blind alley’, or ‘dead end’ , presumably because of their limited capacity to adapt to changing environment, or their susceptibility to the accumulation of deleterious mutations  <cit> . taking a macroevolutionary perspective, however, our body of knowledge is still limited regarding the historical evolutionary dynamics of mating system transitions among closely related taxa differing in outcrossing vs. selfing strategies and over extended time scales.

several underlying assumptions of the sede hypothesis, as originally proposed by stebbins  <cit> , have turned out to be more complex than initially thought. nonetheless, there is wide consensus about two major predictions:  evolutionary change is unidirectional and irreversible from outcrossing to selfing; and  selfing lineages suffer from an increased risk of extinction owing to a reduced potential for adaptation  <cit> . consistent with both connotations, several molecular phylogenies have inferred outcrossing systems to be ancestral, with selfing species commonly located at terminal branches . however, the historical dynamics of outcrossing-to-selfing transitions are often difficult to reconstruct and a few studies have even pointed out the possibility of reversals . moreover, potential departures from theory are generally suspected to result from methodological difficulties associated with, for example, phylogenetic estimation per se, incomplete or missing taxonomic accounts, ambiguous character state coding, and/or subjectively chosen character transformation weights  <cit> . other challenges are posed by the presence of intraspecific mating type polymorphisms , and possible confounding effects of diversification and character state evolution  <cit> . perhaps most strikingly, the second claim of the sede hypothesis, concerning the assumed higher extinction  associated with selfing, has largely been ignored in the literature  <cit> , possibly because of the difficulties of obtaining accurate and unbiased estimates of extinction rates from molecular phylogenies .

however, recent developments of model-based methods of phylogenetic inference, molecular dating, and ancestral character state reconstructions  <cit>  should overcome at least some of the past methodological obstacles encountered in phylogenetic studies of mating type evolution. more reliable tests of the sede hypothesis are also expected from a recently developed, yet sparingly employed tree-based model of character evolution  that allows the joint estimation of rates of binary character change as well as state-dependent rates of extinction and speciation . by capitalizing on these recent advances, the present study investigates mating type shifts  during the diversification of a well-defined clade of epidendroid orchids of the genus bulbophyllumthouars from madagascar and adjacent islands. no study to date has subjected members of orchidaceae to such kind of macroevolutionary analysis, and there are several reasons detailed below why this group of tropical orchids provides a particular interesting system for the study of selfing evolution.

most species of bulbophyllum  are tropical epiphytes, self-compatible, and adapted to cross-pollination by flies or more rarely bees  <cit> , with flowers typically possessing an erect, non-receptive ‘rostellum’. this is a shelf-like projection of the column , which separates the single anther from the stigmatic cavity below, thereby preventing self-fertilization without the aid of a vector  and aiding in gluing the pollinia to the pollinator  <cit> . however, recent micro-morphological and experimental studies in bulbophyllum from madagascar and adjacent islands  <cit>  have identified eight species that vary intra-specifically for rostellum and thus mating type. in detail, auto-pollinating individuals  differ from their outcrossing conspecifics  in the lack of the rostellum  or, in case of a single species, in displaying a sub-erect rostellum with stigmatic function . these dimorphic species belong to a taxonomically and phylogenetically well-circumscribed clade  comprising sects. calamaria, humblotiorchis, and bifalcula  <cit> ; fischer et al., unpubl. data). all remaining species of this lineage, as well as, representatives of related sections studied so far, are monomorphic for the outcrossing rostellum type  <cit> . although the precise genetic control and heritability of types i–iii remain obscure, each morph is presumed to be genetically encoded and unresponsive to environmental influences, as within-individual variation in mating type was not observed under controlled conditions  <cit> .fig.  <dig> eight species of madagascan bulbophyllum clade c vary intra-specifically for mating type. a habit and detail of inflorescene  and  flower close up of a member of madagascan bulbophyllum clade c . c outcrossing individuals  differ from their  auto-pollinating conspecifics  by the presence of the rostellum. note that the pollinia in  were lost during sample preparation. abbreviations: a, anther; c, column ; l, labellum; p, pollinia; pe, petal; r, rostellum; rr rudimentary rostellum; s, stigma; se, sepal; st, stelidium. scale bars: a = 20 mm; b = 1 mm; c, d =  <dig>  mm. photographs by a. sieder  and a. gamisch . the habitus photograph  and the scanning electron microscopy micrographs of b. quadrifarium and sketches of the different gynostemium morphs  are modified from  <cit> 



observing a relatively high incidence of auto-pollination in bulbophyllum is rather unexpected because this genus has long been considered to be highly pollinator-dependent . even though estimates of auto-pollination in orchidaceae as a whole  are relatively high with about  <dig> % of species  <cit> , auto-pollination is generally considered to be rare in species from the tropics  <cit> , excepting small islands . when compared to other earlier phylogenetic studies of selfing evolution , our study system is notable in at least two respects:  selfing is not achieved through the breakdown of a floral multi-organ  or genetic  mechanism associated with outcrossing but rather due to a structural, discrete-state character transition affecting floral micro-morphology ; and  selfing morphs  apparently only coexist with their pollinator-dependent conspecifics , i.e., selfing is never fixed within species. because conspecific individuals differing in morph-type are virtually identical in overall  phenotype  <cit> , selfing may have evolved only recently and multiple times within clade c. this hypothesis, however, has yet to be tested since phylogenetic relationships within clade c still remain obscure due to incomplete taxon and gene sampling in an earlier phylogenetic analysis  <cit> .

the overall aim of this study was to examine the polarity, frequencies, time scales, and consequences of mating type transitions during the diversification of clade c in order to test major predictions raised by the sede hypothesis, i.e., irreversibility of transitions to selfing and high extinction rate of selfing species. our first aim was to infer a robust, fossil-calibrated phylogeny of clade c using dna sequence data  to explore the timing and tempo of species diversification. second, we reconstructed ancestral character states onto the phylogenetic tree to evaluate when and how often transitions occurred between outcrossing and ‘selfing’  mating types, and whether uni- or bi-directionally. finally, we used the state-dependent bisse model of character evolution to recover the processes proposed by the sede hypothesis, and to test in particular whether the evolution of selfing in these tropical orchids was associated with higher levels of extinction. overall, this study is the first to demonstrate within a macroevolutionary framework that, contrary to prevailing views, selfing not always needs to be an endpoint of mating type evolution in flowering plants, suggesting instead more frequent origins of this character than previously thought.

methods
study system and mating system categorization
the most recent taxonomic treatment of sects. calamaria, humblotiorchis, and bifalcula recognizes  <dig> species . fifteen of those species were included in the study of madagascan bulbophyllum conducted by  <cit> , using a combined sequence matrix of one nuclear ribosomal  and four plastid gene regions, and were identified as a monophyletic group , albeit with poorly resolved interspecies relationships.

most species of clade c are leaf-succulent epiphytes restricted to madagascar  and/or adjacent islands , with the remainder found in madagascar and/or the east african mainland  of fig.  <dig> and .fig.  <dig> majority-rule consensus of madagascan bulbophyllum clade c  estimated under bayesian inference  for the eight-gene dataset . solid dots indicate nodes with bayesian posterior probability  of  <dig> and parsimony bootstrap percentage  ≥  <dig>  branches only weakly supported by bayesian analysis  are indicated through stippled lines. the maps on the left show the potential current distribution of each section in madagascar and adjacent islands  based on bioclimatic variables 



recent micro-morphological and experimental studies  <cit>  revealed that mating type in clade c is directly related to column  type, most often involving the presence or absence of the rostellum. in detail, of the  <dig> species analysed by  <cit>   with the conventional  rostellum ; by contrast, seven species proved to be dimorphic for mating type, comprising both type i individuals and others  capable of vector-less, autonomous fruit set  due to the lack of the rostellum . moreover, a single species  was found to have three mating types by additionally possessing selfing individuals with a receptive  rostellum .

we use the per-species mating type classification of  <cit>  as a basis for reconstructing the history of selfing evolution in clade c presented here . notably, for two species , there is morphological  as well as population genetic  and reproductive  evidence available  suggesting that selfing individuals are indeed frequent enough to be thought of representative for the whole species . as regards the other six species likewise designated as ‘selfing’ , selfing individuals are probably also common, if not predominant, although this inference is based on morphological evidence only and a more limited sampling . hence, all currently available data point to selfing as the predominant mode of reproduction in the eight species designated here as ‘selfing’ .table  <dig> coding of mating types for  <dig> bulbophyllum clade c species included in this study, following the mating type classification of  <cit> . species fixed for outcrossing were coded as state ‘0’, and dimorphic  species as state ‘1’ . for two species  mating type was coded as missing 


bifalcula
 
 
 
 
 
b. sp. nov. ‘a’
 
b. sp. nov. ‘b’

calamaria
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
b. sp. nov. ‘c’
 
b. sp. nov. ‘d’
 
b. sp. nov. ‘e1’
 
b. sp. nov. ‘e2’

humblotiorchis
 


the bisse method used in the present study  requires that the states that are compared must be coded as a binary character  <cit> . if species exhibit multiple  character states, the most common state is usually taken as the only one present . however, such a frequency-dependent coding strategy is prone to sampling bias if sample sizes of character statement assessment are low  <cit> , as in the present study. to accommodate this latter problem, we used the ‘any instance’ method  and coded the mating types of clade c species  as being either outcrossing  or selfing , and thus regardless of the fact that selfing species also harbour outcrossing morphs. following , we justify this ‘any-instance’ coding, as  population-level estimates of morph frequencies are mostly lacking for these tropical orchids ; and  some assessment of selfing as a derived condition in clade c can be made a priori by comparison with other madagascan bulbophyllum species used as outgroups  <cit> .

taxon sampling and dna sequencing
thirty species  out of the  <dig> species ascribed to sects. calamaria , humblotiorchis , and bifalcula  were included in our study [additional file 1). this taxon sampling comprises  <dig> species that were not sampled in  <cit> , six yet undescribed species , and  <dig> species with known mating type, including eight selfers . we were unable to obtain material for dna extraction from the two remaining species of sect. calamaria, i.e., b. sp. ‘f’  and b. cryptostachium . we also included, as outgroups, one species each from sects. kainochilus, inversiflorum, and alcistachys, whose close relationship to clade c is supported on molecular and morphological grounds  <cit> . like all extra-clade c species of madagascan bulbophyllum, these outgroups have so far proved to be monomorphic for the outcrossing mating type  <cit> .

most bulbophyllum samples used in this study were field-collected in madagascar, with all necessary permits obtained by the département des eaux et fôrets , or received from botanic gardens  and herbaria . additional dna samples were obtained from the jodrell laboratories, kew. whole genomic dna was extracted from fresh, silica-dried leaf material using the 2x ctab method  <cit> . a few accessions, preserved as leaf extract on fta® mini cards, were processed using the fta® starter pack  according to the manufacturer’s specifications.

we pcr amplified and sequenced five plastid and three nuclear gene regions. the former comprised four intergenic spacers  and a hypothetical open reading frame gene region . nuclear regions were the internal transcribed spacer  region of ribosomal dna  and portions of two low-copy genes, i.e., the structural gene encoding phosphoenolpyruvate carboxylase , and the floral homoeotic gene pistillata/globosa . for amplification we used protocols and primers from  <cit>  for its, psba–trnh, and trnd–trne,  <cit> ) for atpi–atph and trnt–trns, and  <cit>  for ycf <dig>  details of the newly designed primers for pepc and pi are provided in . amplification products were sequenced at macrogen inc.  using the above pcr primers. sequences were edited and aligned using the muscle algorithm with default settings as implemented in geneious version  <dig>   <cit> . for all plastid and nuclear regions, sequence length variation among species was low. hence, gaps were generally treated as missing data. genbank sequence accession numbers and voucher details are summarized in [additional file 1). we included outgroups and multiple intra-specific samples in the phylogenetic analyses and removed outgroups for the dating analysis in beast version  <dig> . <dig>  <cit>  , but removed each of those in all subsequent beast, diversification, and mating-type transition analyses, resulting in a total of  <dig> terminal species. for these latter analyses, multiple accessions of the same species were pruned by keeping the most early-branching accession.

phylogenetic inference
four data partitions were defined, corresponding to each nuclear dataset  and the five plastid regions combined. we identified the best-fit models of nucleotide substitution for each partition using the akaike information criterion  in jmodeltest version  <dig> . <dig>  <cit> , i.e., the gtr + g model for the its and plastid datasets and the hky + g model for pepc and pi. these models were then applied to the phylogenetic analyses of each partition using bayesian inference  as implemented in mrbayes version  <dig> . <dig>  <cit> , with b. variegatum  assigned as outgroup . the markov chain monte carlo  algorithm was run with two independent runs of four metropolis-coupled chains with  <dig> million generations each, with trees sampled every  <dig>  generations. after assessing convergence between runs by monitoring the standard deviation of split frequencies in mrbayes and using the effective sampling size  criterion in tracer version  <dig>   <cit> , the first  <dig> % of sampled trees were discarded as burn-in . a  <dig> % majority-rule consensus tree was constructed from the remaining  <dig>  trees to estimate posterior probability values for each node. for comparison, node support was also estimated by bootstrapping under maximum parsimony  in paup* version  <dig> b <dig>  <cit>  using  <dig> heuristic search replicates and the following settings:  <dig> random addition sequence replicates with three trees held at each step, tree bisection reconnection  branch swapping, and saving no more than  <dig> trees per replicate. the degree of incongruence among the four data partitions was checked by looking for conflicting clades that were strongly supported in terms of both bayesian posterior probability  and parsimony bootstrap percentage  . since no such incongruence was detected see , we concatenated all partitions into a single alignment, and re-analysed it under the above bi and mp settings.

bayesian hypothesis testing of monophyletic selfers
to test whether selfing species comprise one or more monophyletic lineages, we used logarithmic bayes factor  comparisons  <cit>  to evaluate the support for different topological scenarios in clade c based on the combined  bi tree . essentially, this analysis helped to provide an initial assessment of topologically independent shifts in mating type. we used tracer to compare the marginal tree likelihoods of models constrained for monophyly of selfers , with those obtained under the unconstrained  hypothesis . for model comparison, we used the bf ‘test statistic’ of  <dig> log – log. following  <cit> , evidence against the constrained model  was considered to be ‘positive’ , ‘strong’ , or ‘very strong’ .table  <dig> results of the monophyly tests for selfing bulbophyllum clade c species using logarithmic bayes factor  comparisons

all selfers of sects. calamaria + humblotiorchis
all selfers of sect. calamaria


evolutionary transitions in mating types
based on the data of mating type , we reconstructed transitions between outcrossing and selfing mating types in clade c using a two rate  model of character evolution in the bayesian  framework of the submodule multistate of bayestraits version  <dig>  . following , we designated the species as outcrossing or selfing using the ‘any-instance’ coding method . mating types were traced over the last  <dig>  post-burn-in trees of the bi analysis to incorporate branch length and topology uncertainty. the mcmc analyses were run during  <dig> , <dig> generations, with a ratedev parameter of  <dig> , a reversible-jump hyperprior with an exponential prior , and a burn-in of  <dig>  generations.

because mk <dig> models cannot account for the effect of the character on rates of speciation and extinction  <cit> , we complemented our ancestral character reconstructions by obtaining marginal estimates of ancestral node states over  <dig>  beast trees under our best fitting bisse model using maximum likelihood  reconstructions . for each method employed, ancestral character states were plotted onto the  <dig> % majority-rule consensus tree of the bi analysis . the ml reconstructions of the best fitting bisse model were also plotted on the chronogram .fig.  <dig> ancestral state reconstructions of mating type and chronogram of madagascan bulbophyllum clade c. a reconstruction under an unconstrained mk <dig> model using bayestraits.
b maximum likelihood  reconstruction under the best-fitting bisse model . pies at internal nodes indicate mean relative posterior probabilities assigned to alternative states based on  <dig>  bi  or  <dig>  beast trees . transitions in mating type are marked by an asterisk. c branch lengths proportional to time  estimated with a relaxed clock approach  and summarized onto the topology of the majority-rule consensus of the bayesian analysis. divergence dates were inferred using both fossil-based and biogeographic  calibration points . branches only weakly supported by bayesian analysis  are indicated through stippled lines. horizontal bars indicate  <dig> % highest posterior density  for node ages. also shown are ancestral state reconstructions of mating type under the model-based  reconstructions, with all internal nodes  reconstructed as outcrossing. in all probability, selfing evolved independently at five times within clade c since about the mid-pleistocene . the inset shows a log-lineage-through-time  plot for madagascan bulbophyllum clade c, based on the chronogram  and  <dig>  trees sampled from the posterior distribution of the beast analyses 



estimating times of divergence
estimation of divergence times of clade c was performed in beast with outgroup taxa removed and using the same unlinked gene partitions and substitution models as in the bi analysis . a birth-death  speciation model was specified as tree prior and an uncorrelated lognormal relaxed clock was assumed  <cit> . five independent mcmc runs were performed with  <dig> million generations each, sampling every  <dig>  generations. following the removal of a conservative burn-in of  <dig> %, the mcmc samples were combined using logcombiner version  <dig> . <dig>  <cit>  and inspected in tracer to confirm convergence of the chain to stationary and assess sampling adequacy . the results of the beast analysis were summarized with treeannotator version  <dig> . <dig>  <cit> . the remaining  <dig>  trees were summarized onto the topology of 50% majority-rule consensus tree of the bi analysis with a threshold of zero for the posterior probability of clades and with node heights estimated using median values. the resulting chronogram  was visualized in figtree version  <dig> . <dig> . as there are no fossils of bulbophyllum that can be used to assess the timing of divergence of clade c, we used a multi-step secondary calibration approach based on three fossils of other orchid genera and two geological calibration points taken from island ages. see  for full details.

course and mode of diversification
to visualize how lineages accumulate within clade c through time, we used the r package ape  <cit>  to derive log-lineage-through-time  plots from both the chronogram  and  <dig>  dated beast trees resampled at a lower frequency in logcombiner. under the rate-constant bd model with speciation  and extinction rate  being constant and μ >  <dig>  we would expect a near-straight line whose slope approximately estimates r  , but with a slight upturn in the number of lineages near the present with slope ≈ λ  <cit> . based on the chronogram, we also used birth-death likelihood  analysis as implemented in laser version  <dig>   <cit>  to test the fit of clade c to two rate-constant diversification models  against four rate-variable models : the yule model with two  or three  rates, and two diversity-dependent models with either linear  or exponential  diversification  <cit> . we compared the aic scores of the best rate-constant model  and the best rate-variable model  by computing the test statistic ∆aicrc = aicrc – aicrv  <cit> . critical values of ∆aicrc were assessed by simulating  <dig>  trees of  <dig> species under the pb model  in laser , and by comparing the original value against the distribution from simulations  <cit> .table  <dig> results of fitting rate-constant and rate-variable diversification models to the maximum clade credibility chronogram of bulbophyllum clade c  using birth-death likelihood  analysis

r
1
r
2
r
3
st
1
st
2
a
x
k

yr3
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
–
–
–
 <dig> 
- <dig> 
0
the best fitting model based on the aic is in bold


r = net diversification rate , st = time  of rate shift, a = extinction fraction, x = x-parameter from the ddx model, k = k-parameter from the ddl model, ln l = log-likelihood, aic = akaike information criterion, Δaic = change in aic relative to the best model



estimates of state-dependent diversification/transitions rates
we used the binary-state speciation and extinction  model in the r package diversitree version  <dig> – <dig>  <cit>  to estimate  state-dependent rates of speciation  and extinction  for clade c species with outcrossing  and selfing  mating types, with respective net diversification rates  derived as r = λ–μ  <cit> ; and  rates of transition from outcrossing to selfing  and vice versa . we compared the fit of the full  bisse model with unconstrained parameters  to  three models with these parameters constrained to be equal ;  six models with one parameter each fixed to zero ; and  three models with two to four parameters fixed to zero  . together, this approach allowed us to explicitly test the hypotheses that  speciation and extinction rates were different between outcrossing and selfing species;  there were asymmetrical transition rates between mating types ; and  each parameter was significantly different from zero.table  <dig> median maximum likelihood  estimates of parameters, log-likelihoods and aic values of alternative bisse models estimated across  <dig>  beast trees of bulbophyllum clade c. speciation rates are λ, extinction rates are μ, and character transition rates are q. outcrossing is coded as ‘o’ and selfing as ‘s’

λ
o
λ
s
μ
o
μ
s
q
os
q
so

q

λ

λ
o = λ
s

q
os = q
so

q

μ
o = μ
s

μ

μ

λ

λ
s =  <dig>  μ

λ
s =  <dig>  μ
o =  <dig>  q

λ
s 
=  <dig> 
μ
o 
=  <dig> 
μ
s 
=  <dig> 
q
so 
= 0
2
 <dig> 
0
0
0
 <dig> 
0
- <dig> 
 <dig> 
0
0
for each model a “=” sign indicates constrained model parameters, while all other parameters were allowed to freely vary. d.f. = degrees of freedom, ln l = log-likelihood, aic = akaike information criterion, Δaic = change in aic relative to the best model. models are sorted in ascending order of Δaic values. the best fitting model based on the aic is in bold

*the final column shows the percentage of trees where the more complex  model provided a significant improvement  over the simpler constrained model  according to a likelihood-ratio test, where p-values were based on a χ
 <dig> distribution with degrees of freedom  equal to the difference in the number of free parameters allowed by the two models 



all models were fitted by ml nonlinear optimization across a sample of  <dig>  of our beast trees, using a heuristic starting point based  on the state-independent bd model. for each model, ml parameter estimates, log-likelihoods and aic values were recorded as median values , with the frequency distribution of full-model parameter values plotted along with their  <dig> % credible intervals. model results were evaluated and compared using both median aic values as well as likelihood ratio tests . when differing by less than two Δaic units, models were considered being of essentially equivalent fit  <cit> . for each tree, lrts were calculated as twice the difference in log-likelihoods between the full  model and the constrained  model , which should follow a χ <dig> distribution with degrees of freedom equal to the difference in the number of free parameters allowed by the two models  <cit> . we then recorded the percentage of trees where the full model provided a significant improvement  over the constrained model.

RESULTS
phylogenetics and hypothesis testing of monophyletic selfers
our final dataset consisted of 670 bp from its, 765 bp of pepc, 358 bp of pi, and 4712 bp of five plastid regions . the combined nuclear/plastid dataset included  <dig>  nucleotide positions,  <dig> of which were parsimony informative. the bi analysis of the four individual partitions  yielded largely congruent tree topologies albeit with different levels of resolution. in our focal bi tree of the combined analysis , which produced highest node support values, members of clade c grouped according to their sectional affiliation . the species-poor sect. bifalcula and the monotypic sect. humblotiorchis  formed successive sister taxa to the species-rich sect. calamaria . while these sectional groupings and relationships are in agreement with previous phylogenetic studies  <cit> , our increased taxon and gene sampling resulted in better-resolved interspecies relationships, with most intra-specific accessions recovered as monophyletic , except for the paraphyletic b. implexum and the likely polyphyletic b. sp. nov. ‘e1’. however, especially within sect. calamaria, several internal branches were not supported well , indicating some phylogenetic uncertainty for character state reconstructions. nonetheless, the scattered phylogenetic distribution of the eight selfing species strongly suggested that they do not form a monophyletic group . in support of this, tree topology tests  decisively rejected models in which all selfing species of clade c, or only those of its sublineages  were constrained to be monophyletic , pointing at multiple independent shifts in mating type across clade c .

evolutionary transitions of mating type in clade c
our mk <dig>  ancestral state reconstructions of mating type over  <dig>  bi trees yielded mostly similar results when compared to those obtained with ml reconstructions over  <dig>  beast trees following the best fitting bisse model . both analyses identified outcrossing as the most probable ancestral state of clade c, and revealed that transitions to selfing were in general concentrated in terminal branches . however, under the mk <dig> reconstruction, two subterminal nodes had relatively high probabilities of being selfing , resulting in six transitions. by contrast, the best fitting bisse model reconstructed all internal nodes as being outcrossing, resulting in eight independent transitions to selfing along terminal branches leading to extant species . in any event, these results qualitatively indicate that mating type transitions within clade c are a strikingly recurrent evolutionary phenomenon, but which requires further temporal delimitation and quantitative evidence as provided in the following sections.

diversification times
our relaxed molecular clock analyses  dated the onset of diversification  of clade c to the late tertiary/early pliocene, at ca.  <dig>  ma . by contrast, the most recent common ancestor  of sects. humblotiorchis/calamaria was placed in the mid-pliocene, at ca.  <dig>  ma , and the crown age of sect. bifalcula in the late pliocene, at ca.  <dig>  ma . the origins of most extant clade c species were dated to the quaternary , excepting few species inferred as late tertiary/pliocene relics . notably, five of the eight selfing species originated within a relatively recent time frame starting at about the mid-pleistocene . by contrast, of the three remaining selfers, one originated in the early pleistocene  and two in the pliocence . all these latter taxa evolved selfing independently , leaving the possibility of a more complex history of selfing  over extended time scales.

diversification and transition rates
the ltt plots for the phylogeny of clade c , derived from the chronogram  and  <dig>  dated beast trees, suggested an almost constant lineage accumulation over time, with no apparent upturn near the present as typical for either high  extinction rates or recent and rapid speciation rates  <cit> . concomitantly, the ∆aicrc test in laser  indicated no significant departure of the best-fit rate-constant model, i.e., pure-birth  without extinction , from the best-fit rate-variable model  with likewise no extinction but three distinct rates of diversification . the overall speciation rate  of clade c calculated under the null  model was  <dig>  species myr- <dig>  this value is within the range observed for other plant taxa that have been identified as undergoing rapid rates of relatively recent speciation .

although the above results indicate no shifts in lineage diversification over time within clade c, mating system per se might have conferred unequal probabilities of speciation and extinction  <cit> . in order to address this issue, we calculated mating-type-dependent speciation and extinction rates along with transition rates  under the full  bisse model  across  <dig>  dated beast trees using ml procedures . according to the full model, speciation rates were high in outcrossing lineages  but next to zero in selfing lineages , whereas the reverse was true for extinction rates . as a result, net diversification rates were negative in selfers  but still high in outcrossers . rates of transition from outcrossing to selfing were high  but near-zero for the reverse . for speciation and net diversification rates, the corresponding frequency distributions of parameter values showed no overlap in their  <dig> % credible intervals , but overlap did occur for extinction rates, and more unexpectedly, transition rates . when we compared the fit of the full  model against each of twelve simpler constrained  models , likelihood-ratio tests  clearly rejected models with zero outcrosser speciation , equal speciation , and zero transition from outcrossing to selfing . by the same tests, all other constrained models provided no better fit than the full model. however, using median aic values, the best-fit model overall  was one in which the speciation rate of selfers, and the extinction rates of both outcrossers and selfers, were set to zero, along with irreversible transitions from outcrossing to selfing . the resulting estimates of this two-parameter model were λo =  <dig>  and qos =  <dig> . significantly though, a three-parameter model, in which the extinction rate of selfers  was allowed to vary , was only marginally less supported  and suggested a moderate extinction rate for selfing lineages ; the other estimates of this ‘second-best model’ were comparable to those of the best-fit model  . following our best-fit model, all the internal nodes of the  <dig>  beast trees were reconstructed to be outcrossing , and the same applied to the second best model .fig.  <dig> frequency distributions of diversification and transition rates. a speciation rates,  extinction rates,  character transition rates, and  net diversification rates for outcrossing  and selfing  lineages estimated under the full  bisse model across  <dig>  dated beast trees using maximum likelihood procedures. the  <dig> % credible intervals of parameter values are shown along the x-axes



discussion
according to recent reformulations  <cit> , stebbins’ sede hypothesis conflates two distinct claims:  transition rates from selfing to outcrossing are zero; and  the net diversification rate  is negative for selfing taxa, implying a higher risk of extinction  for selfing relative to outcrossing taxa  <cit> . our results for madagascan bulbophyllum clade c support the first claim of the sede hypothesis  and we find some, albeit no definite evidence for the second . in principle, therefore, our data are largely congruent with predictions raised by the sede hypothesis  <cit> , but some of the patterns observed suggest that selfing represents a starting-point rather than a terminus of mating-system evolution in these tropical orchids. below we discuss the evidence and possible causes for the strikingly recurrent and probably very recent transitions to selfing in our study system.

multiple origins and irreversibility of selfing
we support the first assumption of the sede hypothesis in that outcrossing  represents the ancestral state of bulbophyllum clade c  and that transitions exclusively occurred from outcrossing to selfing , as also confirmed by the state-dependent bisse analyses . although our ancestral state reconstructions using the mk <dig> model indicate two subterminal nodes where transitions could have occurred , this is not supported by the ml reconstructions under the best fitting bisse model . accordingly, selfing via rostellum loss  most likely evolved independently at eight  times within this clade of  <dig> species. in addition, selfing via rostellum receptivity  evolved uniquely in the trimorphic b. bicoloratum  <cit> . these results also imply that the sharing of selfing/outcrossing morph variation among the eight focal species is unlikely due to the retention of an ancestral polymorphism, and the consistent rejection of their monophyly  further supports this view.

unidirectional transitions from outcrossing to selfing are commonly reported in flowering plants  but see  <cit> . however, this is one of few studies to estimate a time-calibrated transition rate to selfing based on a discrete-state character. the only comparable studies we are aware of, focussing on the breakdown of si in solanaceae  <cit>  and the loss of heterostyly in primula  <cit> , reported higher and lower rates than observed here . we note that bisse is currently the best method to test character state irreversibility, as it is less prone to falsely infer reversions  <cit> , and has been used previously for clades of similarly small size . however, it has relatively low power to detect rate differences among states of a binary trait when dealing with topologies of less than about  <dig> terminals and a high degree of asymmetry in tip states . our clade c phylogeny has  <dig> tips of which  <dig>  have state one . the results of our bisse analysis must therefore be treated cautiously .

the fact that selfing has arisen multiple, independent times within clade c may imply a selective advantage of this trait , and that inbreeding depression, as the principal counterweight to this advantage , has not impeded the evolution of selfing in these tropical orchids. in support of the latter hypothesis, controlled mating experiments have found no evidence of inbreeding depression at the level of seed viability and fruit set in, respectively, the outcrossing morph of madagascan b. occultum  and neotropical bulbophyllum species  <cit> . there is also little evidence of such early-acting  inbreeding depression in other self-compatible orchid species . at least in part, this may be explained by the fact that selfed offspring usually does not depend on parental  resources in orchidaceae  <cit> .

but what intrinsic factor then could promote the parallel evolution of selfing via rostellum loss within clade c? one possible genetic explanation for this parallelism is that it ultimately reflects recurrent, perhaps loss-of-function mutations at only one or a few genes affecting the timing of rostellum development . morphological divergence within and between plant species involving the presence versus absence of structures, as observed here for rostellum type, has often been demonstrated to have such a simple genetic basis , and selection on such traits should lead to rapid evolutionary response  <cit> . on the other hand, given the morphological and developmental complexity of the rostellum  <cit> , it is not unexpected that we find no evidence for the regain of this organ. in general, such kind of irreversibility is expected from ‘dollo’s law’, which posits that complex characters, once lost, are unlikely to re-evolve  <cit> , as also demonstrated for other morphological structures associated with outcrossing . however, at least for the orchid species studied here, a non-mutually exclusive explanation is that transitions to selfing evolved too recently to detect reversals .

explanations for the ‘twiggy’ phylogenetic distribution of selfing
it has long been noted that selfing taxa often occur in scattered positions at the tips of plant phylogenies  distributions have typically been interpreted as a hallmark signature of the elevated extinction risk of selfers, as proposed by the second part of the sede hypothesis  <cit> . however, these’twiggy’ distributions can also arise if transitions from the ancestral state are rare or asymmetrical, but this has rarely been tested using sophisticated analysis methods, such as the state-dependent bisse model  <cit> , and with partly contrasting results. for example, in primula  <cit> , this latter model proved useful in explaining the phylogenetic ‘twigginess’ of the selfing state by highly asymmetrical transitions to selfing from outcrossing, albeit coupled with increased speciation and zero extinction . interestingly, these results demonstrate that selfing lineages, perhaps freed from selective constraints, can evolve at higher rates than outcrossing ones, but also suggests that sufficient time is needed for the negative effects of selfing to accumulate .

for bulbophyllum, our data best fit two bisse models in which the outcrossing state is generally associated with high rates of speciation and zero extinction , and the selfing state with zero speciation  ; however, we did not find definite evidence for the prediction of increased extinction of selfing species, even though the second-best model with moderate extinction  fit reasonably well compared to the best-fit model without extinction  . this lack of ‘measurable’ extinction may simply reflect the above caveat about the statistical power of bisse, coupled with the relatively short branch lengths subtending the selfing species of bulbophyllum . in sum, the results of our bisse analyses must be regarded as inconclusive on whether or not extinction contributes to the twiggy phylogenetic distribution of selfing in clade c , and thus in addition to the repeated  transition to this character, coupled with strongly reduced  speciation in selfing compared to outcrossing taxa. that said, if selfing had evolved only recently in this group, as discussed below, then time might have been insufficient to detect elevated extinction and/or speciation rates associated with this state .

relatively recent shifts in mating system
there is mounting evidence from population genetic studies indicating that outcrossing-to-selfing transitions are often rather recent in flowering plants  <cit> , with most origins dated to quaternary  or even millennial time scales . our results lend support to this view in that selfing evolved independently, in all probability at five times, within clade c since about the mid-pleistocene . however, given that all eight transitions are most likely associated with terminal branches leading to extant species , it remains unclear when selfing evolved within a particular species. this could have happened at any point along such a branch, with the possibility in three species  of tracing back to even early pleistocene/pliocene times. nonetheless, for each of the eight focal species, there is circumstantial evidence to suggest that selfing evolved only recently, possibly over late quaternary, if not historic time scales.

first, molecular genetic data in particular from brassicaceae indicate that selfing tends to evolve much more recently within a species than the time of separation from its closest extant relative  <cit> . for example, the common ancestor of arabidopsis thaliana and a. lyrata  was presumably outcrossing and self-incompatible, yet a. thaliana is thought to have acquired self-compatibility only within the last  <dig>  million years . an even more recent origin of selfing seems plausible for each of the eight bulbophyllum species, where – unlike in a. thaliana – selfing individuals still co-exist with ancestrally outcrossing ones at the intraspecific level. in addition, apart from their diagnostic rostellum traits, these conspecific morphs hardly differ in other morphological or functional changes to the flowers  <cit> . this further suggests that these morphs only recently diverged, whereby insufficient time may have elapsed for such a ‘floral selfing syndrome’  <cit>  to develop, as has been demonstrated in a large number of genera where selfing lineages have been derived from outcrossing ancestors . on the other hand, if selfing had evolved in the more distant past in bulbophyllum, we would expect to observe at least some of the older species  to be entirely fixed for selfing, especially given the evidence for low inbreeding depression in this group . accordingly, the eight clade c species that currently vary for mating type may well be in a transitory phase towards increased selfing, as postulated for other species polymorphic for selfing/outcrossing individuals  <cit> .

potential environmental catalysts for the evolution of selfing
observations on cultivated material suggest that the selfing morphs  of madagascan bulbophyllum species are unlikely to reproduce through outcrossed pollinia, and thus most likely behave as exclusive rather than partial selfers  <cit> . if this holds true in nature, then the origin and maintenance of selfing within clade c is unlikely due to a mere ‘selective transmission advantage’ of selfing , because this advantage disappears when pollen discounting  is maximised  <cit> . it is feasible, therefore, that recurrent transitions to selfing within this clade mostly, if not exclusively, reflect an adaptive ‘reproductive assurance strategy’  in response to similar selective environments that favour reproduction when pollinators or mates are rare or absent, conditions that might accrue from island colonization or habitat fragmentation  <cit> . in our system, however, we find no support for the oft-invoked idea that the evolution of selfing promotes long-distance colonization  <cit> . although in some species  selfing may have increased colonizing ability of neighbouring islands, such as la réunion, all these taxa vary for mating type in madagascar  <cit> . on the other hand, we suspect that potential catalysts that may have initiated fragmented habitat conditions in madagascar include  climate-induced vegetation shifts during the  quaternary ; and  human-mediated degradation of primary forest over the last  <dig>  years . effects of both quaternary climate change and human-modified landscapes on the evolution of selfing in flowering plants are well documented  <cit> . our phylogenetic data cannot determine the relative importance of these ‘shallow-time’ effects to mating system evolution in bulbophyllum clade c; however, they emphasize the need for comprehensive field and population-level data  to elucidate the past and/or present selective environments under which selfing evolved within a particular bulbophyllum species  <cit> .

CONCLUSIONS
in this study, we examined the evolution of selfing  in madagascan bulbophylum orchids  in the light of two predictions raised by the classical sede hypothesis:  irreversible transitions from outcrossing to selfing; and  elevated extinction rates associated with the selfing state. although we find convincing support for the first prediction, results remain inconclusive on whether or not extinction contributes to the twiggy phylogenetic distribution of selfing in clade c. despite this latter limitation, we suspect that selfing has evolved too recently in this group to detect elevated extinction and/or speciation rates associated with this state. we further hypothesize that a simple genetic basis of rostellum loss may explain the strikingly recurrent transitions to selfing in our study system , perhaps reflecting rapid response to parallel and novel selective environments over late quaternary  time scales. future demographic and genomic studies of these and other tropical orchids with an apparent lability towards rostellum abortion have thus the potential to unravel novel perspectives on the ability of some natural systems to rapidly evolve selfing as a means of avoiding extinction in the face of ever changing environments.

availability of supporting data
the data sets supporting the results of this article are included within the article . nucleotide sequence data supporting the results of this article are available in genbank . the phylogenetic data sets supporting the results of this article are available in the dryad digital repository .

additional files
additional file 1: 
summary of specimens used for the phylogenetic study of madagascan
bulbophyllum
clade c. including information on species distribution, geographic origin of specimens , voucher numbers, and associated genbank  sequence accession numbers for the three nuclear regions  and the five plastid regions . 

additional file 2: 
newly designed primers for
pepc
and
pistillata
/
globosa

based on the studies of  <cit>  and  <cit> . 

additional file 3: 
majority-rule consensus tree of madagascan
bulbophyllum
clade c from the bayesian analysis of the plastid five-gene
 dataset. closed circles indicate nodes with bayesian posterior probability  of  <dig> and parsimony bootstrap percentage  ≥  <dig>  branches only weakly supported by bayesian analysis  are indicated through stippled lines. 

additional file 4: 
majority-rule consensus tree of madagascan
bulbophyllum
clade c from the bayesian analysis of the nrits dataset. closed circles indicate nodes with pp of  <dig> and bp ≥  <dig>  branches only weakly supported by bayesian analysis  are indicated through stippled lines. 

additional file 5: 
majority-rule consensus tree of madagascan
bulbophyllum
clade c from the bayesian analysis of the single/low copy nuclear marker
pepc. closed circles indicate nodes with pp of  <dig> and bp ≥  <dig>  branches only weakly supported by bayesian analysis  are indicated through stippled lines. 

additional file 6: 
majority-rule consensus tree of madagascan
bulbophyllum
clade c from the bayesian analysis of the single/low copy nuclear marker
pi. closed circles indicate nodes with pp of  <dig> and bp ≥  <dig>  branches only weakly supported by bayesian analysis  are indicated through stippled lines. 

additional file 7: 
estimating times of divergence: secondary calibration approach. 

additional file 8: 
secondarily calibrated chronogram of the genus
bulbophyllum
used for the estimation of the crown group age of madagascan
bulbophyllum
clade c. branches only weakly supported by bayesian analysis  are indicated through stippled lines. ages of major nodes are indicated by yellow circles, and the corresponding age estimates can be found in . colored circles indicate age-constrained nodes . 

additional file 9: 
time-calibrated phylogeny of the orchidaceae from the
beast
analysis of the plastid two-gene
 dataset, used for the estimation of the stem group age of 
bulbophyllum. numbers at nodes are median ages in million years ago  . branches only weakly supported by bayesian analysis  are indicated through stippled lines. colored circles indicate age-constrained nodes . 

additional file 10: 
genbank  accession numbers of plastid dna  sequences of orchidaceae used to estimate the stem node age of the genus
bulbophyllum. 

additional file 11: 
list of  <dig> accessions of nrdna  sequences of
bulbophyllum
and
dendrobium
used to estimate the crown node age of madagascan
bulbophyllum
clade c. 

additional file 12: 
age estimates of the family orchidaceae and various subclades as compared to previous ones. 

additional file 13: 
infrageneric age estimates of the genus
bulbophyllum. 



competing interests

the authors declare that they have no competing interests.

authors’ contributions

ag, hpc and gaf conceived and designed the experiments. ag performed the experiments. ag and hpc analysed the data. ag and hpc drafted the manuscript. all authors read and approved the final manuscript.

