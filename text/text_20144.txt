BACKGROUND
whole genome sequencing projects are within the scope of single laboratories. the genomes online database  <cit>  reports  there are  <dig>  sequenced organisms, of which  <dig>  are eukaryotes. however, only  <dig>  are reported as being complete. annotation of gene models is a requirement for a complete genome  <cit> . there are several complementary strategies for achieving gene annotation in novel genomes including gene prediction  <cit> , expressed sequence tag  libraries  <cit>  and rna sequencing  data  <cit> . gene prediction methods are limited in the complexity of the gene models they are able to produce; alternative splice sites are unpredictable and untranslated regions  have subtle signals  <cit> . est libraries, if available, are usually fragmented and incomplete. rna-seq data is dependent on good alignments to the reference. de novo transcriptome assembly is equally able to fulfil this function, although it can be computationally challenging . transcriptome assembly methods can be either reference-guided or reference-free  <cit> . reference-guided methods have the advantage of simplifying the search space, but are dependent on the relevance, quality and completeness of the reference. reference-free methods do not have any dependencies, but need to deal with sequencing errors sufficiently well to avoid poor assemblies . we present the application of a de novo transcriptome assembly to four eukaryotic species: dictyostelium discoideum, polysphondylium pallidum, dictyostelium fasciculatum and dictyostelium lacteum. the genome of d. discoideum was published in  <dig>  it is 34 mb in size and has been assembled into six chromosomes, a mitochondrial chromosome, an extra-chromosomal palindrome encoding ribosomal rna  and three ‘floating’ chromosomes  <cit> . the genome was generated via dideoxy sequencing and contigs were ordered into chromosomes by happy mapping  <cit>  and still contains  <dig> assembly gaps.

in contrast, the similar sized genomes of p. pallidum, d. lacteum and d. fasciculatum were sequenced more recently using both dideoxy and roche  <dig> sequencing. their assembly was assisted by a detailed fosmid map and primer walking, leading to only  <dig> to  <dig> gaps per genome, but are more fragmented with  <dig>   <dig> and  <dig> supercontigs, respectively  <cit> . the d. discoideum genome has been extensively annotated via the dictybase project  <cit> , whereas the gene models for p. pallidum, d. fasciculatum and d. lacteum, available in the social amoebas comparative genome browser  <cit> , are primarily based on computational predictions.

the social amoeba d. discoideum is a widely-used model organism for studying problems in cell-, developmental and evolutionary biology due to their genetic tractability allowing elucidation of the molecular mechanisms that underpin localized cell movement, vesicle trafficking and cytoskeletal remodeling as well as multicellular development and sociality. the social amoebas form a single clade within the amoebozoa supergroup and are divided into four major taxon groups according to molecular phylogeny based on ssu rrna and α-tubulin sequences  <cit> . the four species under study here represent each of the four groups: d. discoideum , p. pallidum , d. fasciculatum  and d. lacteum . genome annotations are not static and benefit from the application of additional evidence and new methodologies  <cit> . therefore we present, for the first time, substantially updated annotations based on a de novo transcriptome assembly for the d. discoideum, p. pallidum, d. fasciculatum and d. lacteum genomes.

methods
sample preparation
sequencing data were obtained from four rna-seq experiments. the d. discoideum data were obtained from an experiment comparing gene expression changes between wild-type cells and a diguanylate cyclase  null mutant at 22 h of development  <cit> . the p. pallidum data were obtained at 10 h of development in an experiment comparing wild-type and null mutants in the transcription factor cuda . in this experiment p. pallidum cells were grown in hl <dig> axenic medium , starved for 10 h on non-nutrient agar, and harvested for total rna extraction using the qiagen rnaeasy kit. the data for d. lacteum and d. fasciculatum were obtained from developmental time series  <cit> . for these series cells were grown in association with escherichia coli  <dig>  washed free from bacteria, and plated on non-nutrient agar with  <dig> % charcoal to improve synchronous development. total rna was isolated using the qiagen rnaeasy kit at the following stages: growth, mound, first fingers, early-mid culmination, fruiting bodies. d. lacteum rnas were also sampled at three time points intermediate to these stages.

illumina paired end sequencing
total rna was enriched for messenger rna  using poly-t oligos attached to magnetic beads and converted to a sequencing ready library with the truseq mrna kit , according to manufacturer’s instructions and  <dig> basepairs  paired-end sequenced using an illumina hiseq instrument. for the d. discoideum and p. pallidum samples, 1 μg of total rna was used as starting material, with  <dig> ul of 1: <dig> dilution external rna controls consortium  exfold rna spike-in mixes  added as internal controls for quantitation for the rna-seq experiment and sequenced at the genomic sequencing unit, dundee. in total there were 433 m, 413 m, 171 m and 319 m reads respectively for d. discoideum, p. pallidum, d. fasciculatum and d. lacteum.

data processing and de novo transcriptomics assembly
the quality of the raw reads was checked with fastqc  <cit>  and the reads were found to have high quality scores across their full length. no trimming of the data was performed, as aggressive trimming can negatively impact on the quality of assemblies  <cit> . all reads for each species were separately combined prior to de novo assembly. being a more mature genome the d. discoideum data was used to verify the methodology, thereby giving a reference point for the other, less well characterised, species. figure  <dig> shows a schematic of the overall workflow.fig.  <dig> the de novo transcriptomics assembly workflow. the reads are input at the top in green, all computational steps are in blue and all data or quality control outputs are shown in grey. pasa is the program to assemble splice alignments tool  <cit> . see main text for description of pasaaa and pasaua steps. busco is benchmarking universal single-copy orthologs  <cit> 




trinity version  <dig> . <dig>  <cit>  was used for de novo assembly, and normalisation of the read data was achieved with a kmer of  <dig> and aiming for 50x coverage of the genome. following normalisation there remained  <dig>  m,  <dig>  m and  <dig>  m read pairs in d. discoideum, p. pallidum and d. lacteum, respectively. d. fasciculatum reads were not normalised as there were fewer than the recommended  <dig> million reads as per the trinity manual. trinity was run on the normalised reads using the –jacard-clip parameter and setting –k-min-cov to  <dig> in an attempt to reduce the number of fused transcripts in p. pallidum only. in the other species the parameter made little difference. for the initial transcript set of d. discoideum and p. pallidum assemblies, any transcripts with blat  v35x <dig>  <cit>  hits to the ercc spike-in sequences were removed from the d. discoideum and p. pallidum assemblies. d. fasciculatum and d. lacteum were not cultured axenically and thus the samples were contaminated by their bacterial food source. in order to remove the bacterial contamination d. fasciculatum and d. lacteum, transcripts were filtered with the tagc  plot pipeline  <cit> . tagc determines for each contiguous sequence  the proportion of gc bases, their read coverage and best phylogenetic match. with this information it is possible to identify which transcripts are mostly likely to be contaminants and removed. in order to remove the contamination, first all the transcripts were aligned to the blast ‘nt’ database using blast megablast. using the trinity assembled transcripts, the bam file of the reads mapped back to the transcripts and the transcripts to species mapping, non-target related transcripts were removed. the contaminant transcripts were differentiated on the coverage vs gc plots .

the normalised set of reads were aligned with bowtie   <cit>  to the whole transcript set and the total number of reads matching to each transcript were stored .

transcript refinement
program to assemble spliced alignments  v <dig> . <dig>  <cit>  was used to refine the trinity transcripts into more complete gene models including alternatively spliced isoforms. initially developed for est data, pasa has been updated to also work with de novo transcriptome data. using the seqclean tool available with pasa, all the transcripts were screened and trimmed for low complexity regions, poly  tails and vector sequences. gmap   <cit>  and blat  <cit>  were used to align the transcripts to their respective genomes. trinity transcripts that failed to align to the already existing genome in both gmap and blat were removed as ‘failed’. remaining ‘good’ transcripts at this stage are termed the pasaaa dataset. next, pasa takes existing annotations and compares them to the pasaaa dataset. pasa uses a rule-based approach for determining which transcripts are consistent or not with the existing annotation and updates the annotation as appropriate: new genes, new transcript isoforms or modified transcripts. pasaua is the term used for the pasa assembled transcripts after updating with existing annotation.

assembly quality check
at each stage, the transcript datasets were assessed with benchmarking universal single-copy orthologs, busco,  <cit>  and transrate v <dig> . <dig>  <cit>  these methods take complementary approaches in assessing completeness and/or accuracy. transrate v <dig> . <dig> uses the read data and optionally the reference sequence as input. busco defines a set of  <dig> core eukaryotic genes. these genes are used as a proxy for minimum completeness based on the assumption that a eukaryotic genome or transcriptome assembly should encode a large proportion of the core set of genes. the busco  tool uses hidden markov models , defined for each of the core genes in the set, returning whether there are complete or partial matches within the de novo transcripts. when run in genome mode, busco additionally uses augustus  <cit>  to generate a predicted gene set against which the hmms are tested. transrate calculates the completeness and accuracy by reporting contig score and assembly score. contig score measures the quality of the individual contig, whereas assembly score measures the quality of whole assembly.

orphan rnas
the full set of trinity transcripts constitutes the best approximation of the assembly of transcripts expressed in the rna-seq sequencing data. the transcripts were aligned against the existing genome and coding dna  references  and sacgb  <cit> , ) using blat. any transcripts not matching the existing references were searched against the ncbi ‘nt’ database with blast  <cit>  and with psi-blast against the ncbi ‘nr’ database for the longest predicted orf in any remaining transcripts without a match to ‘nr’. this exhaustive search allowed the categorisation of ‘annotated’ , ‘known’ , ‘artefact’ ) and ‘putative novel’  datasets.

pcr and subcloning

d. discoideum genomic dna  was extracted using the genelute mammalian genetic dna extraction kit . polymerase chain reaction  reactions were run for 30 cycles with 50 ng of gdna and 1 μm of primers with 45 s annealing at 55 °c, 2 min extension at 70 °c and 30 s denaturation at 94 °c. the reaction mixtures were size-fractionated by electrophoresis, and prominent bands around the expected size were excised, purified using a dna gel extraction kit  and subcloned into the pcr4-topo vector . after transformation, dna minipreps of clones with the expected insert size were sequenced from both ends.

RESULTS
de novo transcript assembly
table  <dig> shows a summary of the trinity output for the d. discoideum, p. pallidum, d. lacteum and d. fasciculatum de novo transcriptome assemblies. overall, the raw assemblies are similar in terms of total transcripts, gc content, and contig n <dig> or e90n <dig> . d. discoideum is slightly anomalous in n <dig>  e90n <dig>  mean length and transcripts ≥  <dig>  bp with all features being smaller than the other three assemblies. the mean length over all the annotated dictybase coding sequences is  <dig>  bp which is substantially larger than in the assembled transcripts  suggesting that the d. discoideum transcripts are fragmented.table  <dig> trinity assembly summary statistics

d. discoideum
p. pallidum
d. fasciculatum
a
d. lacteum
a

aassembly statistics calculated after removal of bacterial transcripts 




figure  <dig> shows the distribution of transcript lengths for d. discoideum, p. pallidum, d. fasciculatum, d. lacteum  when compared to the available cdna datasets . the d. discoideum cdnas are manually curated, whereas the others are predicted. the transcript sets are enriched in short transcripts  as compared to their cdnas with the effect being most marked in d. discoideum, d. fasciculatum and d. lacteum . the p. pallidum assembly is more similar to its cdna reference dataset . interestingly, the longest assembled transcript in d. discoideum  was found to be approximately half of the mitochondrial chromosome. we speculate that as the mitochondrion is gene rich and highly expressed, trinity was unable to resolve overlapping reads from adjacent genes thereby joining them all into one ‘supercontig’.fig.  <dig> trinity transcript length distributions. comparison of assembled transcript sequence lengths  versus known cdna sequence lengths  for d. discoideum , p. pallidum , d. fasciculatum  and d. lacteum 




the subsequent steps in the assembly were performed with pasa  <cit>  which uses reference genome and transcript datasets to generate a refined and updated transcriptome assembly. the first stage takes the transcriptome assemblies, aligns them against the genome and clusters them into gene structures according to their genome alignments. any transcripts, which do not align adequately to the genome are filtered out by pasa, under the assumption that they are misassemblies. this dataset will be referred to as ‘pasa annotated assemblies’, pasaaa. in unfinished and complex genomes, it is possible that there are missing gene loci in the genome reference. the missing loci may appear in a de novo transcriptome assembly and would be filtered out by pasa. the second stage uses the aggregated and filtered set of transcripts to refine the existing annotations for each of the species. at this stage, the gene models are updated with new or extended utrs, new alternatively spliced isoforms are added, and introns are added or removed. new genes are identified, and existing genes are split or merged as required by the de novo assembly data. this dataset is referred to as ‘pasa updated annotations’, pasaua.

table  <dig> shows the results of each stage of the assembly workflow from trinity to each of the pasa steps and compared to the existing set of gene models from dictybase  or augustus predictions . it is clear that at each stage the assemblies become more similar to the existing gene models . for example, in all the species the total number of transcripts was 3-4-fold larger in the trinity data than in the existing annotations. although de novo assembly has the potential to identify novel genes and transcripts, a 3-fold increase is unlikely. by the end of pasaua, the transcript counts were within  <dig>  of the existing models, with d. fasciculatum, d. lacteum and p. pallidum having more genes than in their augustus-predicted models, and d. discoideum having  <dig> fewer genes than in the dictybase-curated models. this is to be expected as the gene prediction algorithms are unlikely to have found all transcripts, whereas the d. discoideum curated set will include genes expressed under certain conditions only  that were not part of the experiment included here. mean transcript lengths increased through the workflow. in particular, for d. discoideum, the mean trinity transcript length was 871 bp and the final pasaua length was  <dig>  bp indicating that the high fragmentation observable by an excess of short transcripts  has been reduced. similarly, the total number of identified exons was reduced from the initial trinity dataset.table  <dig> comparison of transcript statistics at each stage of assembly


d. discoideum

p. pallidum

d. fasciculatum

d. lacteum

aexisting models retrieved from dictybase for d. discoideum and derived from augustus predictions for p. pallidum, d. lacteum and d. fasciculatum





overall, the initial trinity assemblies have been refined from a fragmentary and redundant dataset to a more full-length and less redundant set of transcripts, which are more similar to the existing reference datasets in terms of total transcript counts, mean length, number of exons and exons per transcript .

quality assessment
benchmarking universal single-copy orthologs  and transrate are tools which allow the assessment of completeness and accuracy of transcriptome assemblies. a set of  <dig> core eukaryotic genes  was defined by busco, for the purpose of assessing completeness in eukaryotic genomes  <cit> . cegs are conserved across taxa and the majority should be present in the majority of eukaryotic species. a large fraction of missing busco genes could be indicative of an incomplete assembly. figure  <dig> shows the comparison of complete and partial busco matches in all four species for the genome reference, trinity assembly, pasaaa refined transcripts and pasaua updated annotations. in the ideal situation all the buscos would be detected in an assembly, however high sequence divergence or absence in the species will give a lower maximum detection level. the whole genome busco score represents the upper limit for any of the assemblies. all except the pasaaa datasets have >80% complete or fragmented buscos and are close to the whole genome count, suggesting the transcriptome assemblies are nearly complete. it is noticeable, that the number of identified buscos is consistently lower in the pasaaa data for all four species . this drop is due to the strict pasa filtering during transcript assembly. pasaaa only retains transcripts, which align to the reference with 95% identity and 90% length coverage. manual checking of the buscos that are identified in the trinity data, but not in pasaaa reveals that they all are labelled as failed alignments. this suggests that either busco is overly permissive in defining the orthologues or that pasaaa is overly aggressive in filtering transcripts. pasaua appears to ‘rescue’ this behaviour, presumably by including good annotations for genes that are poorly assembled in the trinity data.fig.  <dig> busco complete and partial matches for d. discoideum , p. pallidum , d. fasciculatum  and d. lacteum  in the trinity assembly, reference genome, pasaaa refined transcripts and pasaua updated annotations




transrate assesses transcript quality by calculating several contig-level metrics based on the input rna-seq data, and measures how well the read data support the contigs. contigs are scored individually and then combined into an overall assembly score which ranges from  <dig> to  <dig>  an optimal score is also reported, which predicts the best potential assembly score achievable by removing the worst scoring contigs in the dataset. an assembly score of  <dig>  and optimised score of  <dig>  were found to be better than 50% of  <dig> published de novo transcriptome assemblies  <cit> . a high transrate score with a small improvement in the optimal score indicates a good de novo assembly, which is unlikely to be improved without further data or information.

figure  <dig> compares the distribution of transrate contig scores from the trinity assembly, pasaaa refinement, pasaua update and reference transcript/coding sequence  datasets for each of the four species. in contrast to the busco data, the pasaaa data shows an improvement in transrate contig scores when compared to the raw trinity output meaning that the pasaaa transcripts are more consistent with the data, confirming that perhaps busco is too permissive when assigning orthologues rather than pasaaa being too aggressive with its filtering. notably the reference sequence datasets  for d. discoideum and p. pallidum, show a lower median score than the pasaua data, indicating that pasaua is working well in combining the data with the existing annotations. there is little difference in d. lacteum. in d. fasciculatum the cds data shows the best transrate score of any of the assemblies.fig.  <dig> distribution of transrate contig scores   <cit>  for the trinity assembly  <cit> , pasaaa, pasaua  <cit>  and reference transcript  datasets for d. discoideum , p. pallidum , d. lacteum  and d. fasciculatum 




figure  <dig> compares the transrate assembly scores and optimal scores between pasaua and the annotated cds over the four species. the assembly scores range from  <dig>   to  <dig>   and the optimal scores range from  <dig>   to  <dig>  . it is clear that pasaua has better transrate scores  than the annotated cds , except for d. fasciculatum, with all the pasaua assemblies scoring better than 50% of published transcriptome assemblies . the optimal scores for pasaua are also all better than 50% of published transcriptome assembly data , with the exception of d. fasciculatum. in d. fasciculatum the difference between the assembly  and optimal pasaua scores  is small , suggesting that there is little improvement to the assembly possible given the read data for this species. using the optimal score, transrate defines a set of ‘good’ contigs which best fit the data. the proportion of pasaua good contigs ranges from  <dig> %  to  <dig> %  which, for all species, is a higher proportion than the annotated cds .fig.  <dig> transrate assembly scores and reference coverage metric. a compares the transrate  <cit>  assembly score and the optimised score between the cds and pasaua  <cit>  datasets in the four species . the dotted lines represent the transrate scores that would be better than 50% of  <dig> published de novo transcriptomes as found by smith-unna and co-workers  <cit> :  <dig>  overall score  and  <dig>  optimal score . b the proportion of reference protein sequences covered by transcripts in the cds and pasaua datasets by at least 25%, 50%, 75%, 85% and 95% of the reference sequence length




transrate additionally has a reference-based measure, which aligns the transcripts to the reference protein sequences and the results are shown in fig. 5b. the y-axis in fig. 5b shows the proportion of reference protein sequences covered with transcript sequences at several thresholds  of the reference. clearly the majority of the datasets recapitulate the reference annotations completely - only when looking at the raw numbers can a tiny  difference between the cds and pasaua assemblies be observed. the exceptions are the d. discoideum datasets where the cds shows a  <dig>  proportional coverage of the reference and the pasaua dataset is worse at  <dig>  proportional coverage. it is unclear why the d. discoideum set would be different to the other datasets with this metric given its comparable behaviour using other metrics. it is possible that by focussing on the known annotations only, there are features in the predominantly manually curated reference in d. discoideum, which are not captured in the assembly; for example developmental specific genes not observed under the conditions here presented.

interpretation
what does an rna-seq-based de novo assembly achieve when there is an already existing annotation either manually curated or generated via prediction? is it worth it?

table  <dig> details the results following pasa refinement of the existing gene models. despite being a manually curated genome, the d. discoideum gene models where extensively modified by pasa with  <dig>  being updated. most of the updates in d. discoideum  are the result of utr additions at 5′ and 3′ ends of genes, which were mostly missing in the existing models. the assemblies in the other species have a similar number of updates, but utr-only updates to transcripts are a smaller fraction of the total.  <dig> new alternatively spliced transcripts, in  <dig> genes, were identified in d. discoideum . there are currently  <dig> alternatively spliced transcripts, in  <dig> genes, annotated in dictybase so this new data represents a  <dig> -fold increase in the number alternatively splice transcripts and a 5-fold increase in genes. this number in d. discoideum could be an underestimate as the d. fasciculatum, d. lacteum and p. pallidum assemblies all have ~ <dig> alternate splice isoforms.table  <dig> summary data following pasa transcript refinement and re-annotation

d. discoideum
p. pallidum
d. fasciculatum
d. lacteum



figure  <dig> provides examples, in each of the four species, of changes to the transcript models determined by pasa that are well supported by all the data. each panel highlights a different type of change to the reference model. gene ddb_g <dig> has a single transcript  with two exons and a single intron. the rna-seq data , trinity assembly  and pasaaa refinement  identifies extensions to the model, adding 5′ and 3′ utrs to the annotation . the trinity transcript  is on the opposite strand to the reference transcript  and is corrected by pasa . the example in p. pallidum  shows three new alternatively spliced products of the gene . the three new models have the same coding region, but differ in their 5′-utrs: two with differently sized introns and one without an intron. the new models also include a longer second coding exon , which increased the sequence of the protein product by  <dig> amino acids. figure 6c shows an example, in d. fasciculatum, where an alternatively spliced transcript alters the protein product. the alternatively spliced isoform  removes the first intron and extends the 5′-utr when compared to the updated gene model . the cds is shortened by  <dig> amino acids with the use of alternate start site, but the rest of the protein is identical. in the rna-seq data it appears that this new alternative transcript is not the dominantly expressed isoform in the context of the whole organism. the final example is the merging of two d. lacteum genes into one . the black bars show two distinct genes , but the rna-seq data  and the trinity assembly  show uninterrupted expression across the intergenic region between the two genes . the pasa refinement and re-annotation  encapsulate the expression as a contiguous region with the coding region being in-frame over the two existing gene models. the annotation for the upstream dla_ <dig> gene in sacgb  <cit>  gives its best bi-directional hit in uniprot/trembl as gxcn in d. discoideum . gxcn codes for a  <dig>  amino acid protein where dla_ <dig> codes for a  <dig> amino acid protein and the pairwise alignment of dla_ <dig> with ddb <dig> shows no overlap over the c-terminal  <dig> residues. the pasaua gene fusion of dla_11596/dla_ <dig>  codes for a longer,  <dig>  protein which aligns across the full length of ddb <dig> in a pairwise alignment. we suggest that the existing gene model, dla_ <dig>  is a truncated form of a d. discoideum gxcn orthologue and that the fusion with the downstream dla_ <dig> gene represents the more accurate gene model.fig.  <dig> examples of updated annotation in each species. panels a-d compare the existing gene model  to pile-up of aligned rna-seq reads , trinity de novo transcripts , pasaaa refinement , pasaua update . intronic regions are shown by lines and utrs by thinner green bars. the dna strand is depicted by triangles at the end the bars: left end for reverse strand, right end for forward strand. genes shown are: a ddb_g <dig> , b ppl_ <dig> , c dfa_ <dig>  and d dla_11596/dla_ <dig> 




given that d. discoideum has been extensively studied and the annotation curated by dictybase, it is of note that our pipeline identified putative changes which altered the protein sequence of  <dig> genes  . d. discoideum has been the focus of many functional studies including about  <dig> deletions in genes that are required for normal multicellular development  <cit> . comparing the  <dig> d. discoideum genes with modified proteins to the developmentally essential genes, we found  <dig> genes  that overlapped . out of the  <dig>  nine are either truncated or extended at the n- or c-terminal. in the remaining seven proteins, there is loss or gain of exons. five proteins were updated with additional exons: ddb_g <dig>  ddb_g <dig>  ddb_g <dig>  ddb_g <dig> and ddb_g <dig>  and two proteins have an exon deletion: ddb_g <dig> and ddb_g <dig> 

investigating these protein changes in more detail revealed some errors in the underlying genome sequence, which resulted in some unusual gene models. figure  <dig> shows clcd  as an example. in the domain architecture of clcd, there are two cbs  domains present at positions 827– <dig> and 929– <dig> in the transcript sequence. in the updated sequence the protein is truncated and these two domains have been removed. this is likely to be incorrect since all eukaryotic clc proteins require the two c-terminal cbs domains to be functional  <cit> . how did this change occur in the de novo transcript assembly? in the existing annotation, there is an impossibly short two-base intron between the clc domain and first cbs domain. splicing requires a two-base donor and a two-base acceptor at either end of the splice site meaning at least four bases are required, not including any insert sequence. careful investigation of the rna-seq genome aligned reads reveals a single-base insertion immediately after the intron in  <dig> out of  <dig> reads overlapping the region . the rna-seq data turns the two-base intron into a three-base, in-frame codon inserting an isoleucine into the protein sequence and retaining the cbs domains. by implication there is a missing base in the genome reference, which interrupts the open reading frame with a premature stop upstream of the cbs domains . pasa cannot deal with missing bases in the reference and erroneously truncates the, now out-of-frame, coding region four codons downstream of the missing base at a tga stop codon. it also cannot create an impossible intron, which a human annotator presumably added in order to keep the transcript in-frame and retain the conserved cbs domains. pasa did make an error updating this gene, but it does not seem possible for it to have dealt with the missing base any other way.fig.  <dig> pasa update of the clcd locus . see fig.  <dig> for meaning of coloured bars. boxed in yellow, zoom in of rna-seq reads covering dictybase annotation of two-base intron. reads are coloured by base, except in red highlights a region with an inserted base. top right, smart  <cit>  protein domain architecture. arrow shows the protein position of the yellow boxed region




inspection of all the d. discoideum gene models identified  <dig> sites in  <dig> genes with introns shorter than 5 bp . of these genes, five have three tiny introns each. four of them are either in poorly expressed genes or in poorly expressed regions within genes. one gene , however, is well expressed across the full length. the gene contains two 3 bp introns and one 1 bp intron. the two 3 bp introns contain a taa sequence encoding a stop codon, but according to the rna-seq data the codons should be tta  with evidence from  <dig> and  <dig> reads in the two sites, respectively, 100% of which contain the tta codon. the 1 bp intron region is covered by  <dig> reads and one would not expect to see introns in rna-seq data, by definition, it does seem highly unlikely for a 1 bp intron to exist given our current knowledge of mrna splicing: canonical gu-ag dinucleotides and a branch point >18 bp upstream from the 3′ splice site. for this gene, there are clear errors in the genome sequence, which have lead to the creation of an erroneous gene model to compensate for them. it is arguable that none of the 119 < 5 bp introns are genuine but are artificial constructs to fix problems with the gene models. we recommend that gene annotators revisit these genes and consider updating the models  <cit>  and the underlying genome using rna-seq data as evidence  <cit> .

in addition to what we have shown here, it would be possible to use the rna-seq data to directly improve the genome assembly of the four dictyostelid species mentioned herein. xue et al.  <cit>  have shown with their ‘l_rna_scaffolder’ tool that improved scaffolding of complex genomes such as human and zebrafish is possible with rna-seq indicating the feasibility in more gene dense species.

the protein changes in d. fasciculatum, d. lacteum and p. pallidum number in the thousands  highlighting that computational gene prediction is only a first step in annotating a genome. a reliable genome annotation requires evidence from many sources of information  <cit> . the types of protein changes seen in these three species range from inappropriately fused or split genes  via insertions/deletions to changes in protein coding start/stop codons positions resulting in extended or truncated coding sequences. all the pasaua outputs are in the form of gff files viewable within any genome browser. we have made an igb quickload server available for easy browsing of the data .

in the d. discoideum, d. fasciculatum, d. lacteum and p. pallidum datasets  <dig>   <dig>   <dig> and  <dig> novel putative genes were identified by pasa respectively . these novel genes are in genomic loci with no current annotated gene model or where an existing model is substantially modified. the  <dig> d. discoideum novel genes, defined by  <dig> transcripts, were examined by eye in igb  <cit>  against all known d. discoideum reference datasets, including predicted gene models . of the  <dig> transcripts,  <dig> are novel alternate splice transcripts . although ‘novel’ suggests there is no existing annotation at the locus of interest, if a gene update is sufficiently different from the reference gene model, pasa may consider that locus as a novel gene. in most of these cases the new transcript represents a corrected model for a previously computationally predicted gene. many of the predicted gene models were annotated in dictybase as pseudogenes and were originally ignored by pasaua, which only considers protein coding genes. fragments of the pseudogenes do encode orfs and pasa has reported them as being novel genes , but it is not possible to be sure whether the protein products are expressed in vivo with this data. out of the  <dig>  it appears only  <dig> are truly novel as they do not overlap any previously annotated transcripts: novel_model_ <dig>  novel_model_ <dig>  novel_model_ <dig>  novel_model_ <dig>  novel_model_ <dig> and novel_model_ <dig>  all except novel_model_ <dig> have a sequence match to existing genes, suggesting that they are paralogues. the longest novel unannotated model is  <dig> aa in length  and appears to be a duplicate copy of the leucine rich repeat protein lrra present on the chromosome  <dig> 

notwithstanding the large number of updates to the existing d. discoideum annotations it is clear from table  <dig> that there are substantially more changes in the other three species. in particular, the numbers of modified protein sequences are  <dig>   <dig> and 10-fold larger in p. pallidum , d. lacteum  and d. fasciculatum , respectively. similarly, there are  <dig>   <dig> and 6-fold more novel alternate splice isoforms in the three species, respectively. for p. pallidum , d. lacteum  and d. fasciculatum , the gene models were predicted with augustus  which, given the updates found with pasa, suggests that although the predicted gene models are in the correct locus, many are inconsistent with empirical rna-seq evidence. with respect to novel genes annotated by pasa, it is notable that d. fasciculatum and d. lacteum have fewer than either d. discoideum or p. pallidum. it is unclear why this would be. many genes were inspected by eye with igb  <cit>  and overall the annotations appear appropriate, but there are many occasions where human intervention would make further improvements.

orphan rnas
as mentioned above, pasa requires that transcripts align to the genome before it can consider them for further analysis. it makes sense to use the genome as a filter for valid transcripts, however this makes the assumption that the genome is complete. any gaps in the genome that include genes will result in filtering out perfectly valid transcripts.

to determine whether this has happened here, we isolated the transcripts that did not align to the genome and used a process of elimination to identify those transcripts that could be genuine. table  <dig> breaks down the number of orphan rnas and whether they match non-dictyostelid genes , genes in other dictyostelids  or neither . d. fasciculatum and d. lacteum have far more ‘novel’ non-genome transcripts  than d. discoideum  or p. pallidum . this is likely due to the fact that these species, which were cultured on bacteria, contain chimeric misassemblies of bacterial and dictyostelid transcripts. despite this, they still have  <dig> and  <dig> ‘known’ transcripts which have sequence matches to other dictyostelids, higher than seen in d. discoideum  and p. pallidum . these transcripts are probably the best candidates for experimental assessment as genuinely non-genome transcripts.table  <dig> annotation of trinity transcripts

d. discoideum
p. pallidum
d. fasciculatum
d. lacteum

not aligned to reference



we further investigated the  <dig> d. discoideum ‘novel’ transcripts with a more sensitive psi-blast search on their longest orfs and queried their cognate proteins for functional domains using smart. table  <dig> shows the  <dig> most interesting hits based on the sequence match, read count and orf length. they are all well expressed and have orf lengths consistent with functional proteins. three novel transcripts  show similar sequence matches to ddb_g <dig> via psi-blast searching, in spite of very low sequence similarity between them. ddb_g <dig> codes for a hypothetical protein which is not conserved in other dictyostelids and is poorly expressed  at all time points in dictyexpress  <cit> . the three transcripts match across different parts of ddb_g <dig> indicating that they are different parts of the same larger gene. all transcripts identified in table  <dig> were selected for experimental validation via pcr amplification, 8/ <dig> were confirmed.table  <dig> homology and functional information for novel transcripts in d. discoideum


pfam:heat_ez

amatches to related species via psi-blast


b
d. fasciculatum



c
d. discoideum



d
dictyostelium purpureum



e
p. pallidum





the comp5787_c28_seq <dig> transcript has putative homologues in d. fasciculatum, d. purpureum and p. pallidum as shown in fig.  <dig>  sequence conservation is high as well as conservation of the importin-beta n-terminal domain  and heat-like repeat  domain architecture although the d. discoideum sequences appears to have an additional heat repeat domain .fig.  <dig> protein sequence for comp5787_c28_seq <dig> alignment with homologues from d. fasciculatum, d. purpureum and p. pallidum. a jalview  <cit>  multiple sequence alignment together with jpred secondary structure prediction and its associated confidence, ‘jnetconf’  <cit> . green arrows represent extended strands and red bars represent helical regions. in the alignment ibn_n  and heat_ez  domains are highlighted. b mrbayes  <cit>  phylogenetic tree annotated with smart  <cit>  domain architectures determined. each amino acid in the multiple alignment is coloured according to the clustalx  <cit>  colour scheme




genomic cloning of orphan dictyostelium discoideum mrnas
the newly assembled transcripts that could not be mapped onto the genome are either contaminants or genuine mrnas for which the genomic counterpart is in an assembly gap of the genome. to investigate the latter option, we used pcr to attempt to amplify the genes from d. discoideum genomic dna . oligonucleotide primers were designed to amplify regions of about  <dig>  –  <dig>  kb of  <dig> transcripts . the amplified size can however be larger due to the presence of introns. for eight transcripts, corresponding gdnas could be amplified, but for two genes two transcripts were part of the same gene . the six genes in total were all protein coding genes. for three transcripts, comp470_c0_seq <dig>  comp4678_c1_seq <dig> and comp2066_c1_seq <dig> no pcr products were obtained, but the first two transcripts contained multiple stop codons in all reading frames and are likely assembly errors. the amplified pcr products were sub-cloned and sequenced from both ends. sequences were assembled and aligned with the transcript sequence. apart from just a few mismatches, the transcript and gdna sequences were identical . only one amplified fragment contained introns . six out of seven of the protein coding orphan transcripts therefore had a counterpart in the genome. overall, deciphering the genomes of organisms is a key step in being able to probe their biology. with the advent of high-throughput sequencing technologies this has become a simpler problem to solve. yet it is still not trivial to finish a genome assembly without any gaps  <cit> . the genome sequence on its own, however, imparts very little functional information and requires annotation of genes, transcripts and regulatory regions to be scientifically useful  <cit> . many gene annotation methods are dependent on either homology to related species  <cit>  or via gene finding prediction algorithms  <cit>  or ideally both. however, the first method will miss all unusual or species-specific genes, while both methods fall short of accurately predicting intron-rich genes, genes with alternative or non-canonical splice sites or genes with very short exons. the ability to generate a whole transcriptome for a given species and use it to empirically annotate the genome has the power to confirm and correct any errors introduced with other methods. this has been achieved with expressed sequence tags  in the past  <cit> , but now can be performed with rna-seq short read data  <cit> .

this evidence-based methodology is non-trivial and is not perfect. there are examples where the data is not adequately represented in the final transcript set when interpreted by the human eye. in addition, pasa only defines protein-coding genes meaning that all non-coding rnas  will be ignored and will not be in the final annotation unless already identified in the reference. identifying ncrnas is difficult as they have no obvious products and well-defined sequence features  <cit> . this does not negate their importance or relevance to the dictyostelia.

CONCLUSIONS
in this study, we present a de novo transcriptome assembly in four social amoeba species for the first time and with these data we have:created a final set of of  <dig>  ,  <dig>  ,  <dig>   and  <dig>   transcripts.

substantially updated the existing transcript annotations by altering models for more than half of all the annotated transcripts.

identified changes to thousands of transcripts in the predicted gene models of p. pallidum, d. lacteum and d. fasciculatum many of which affect the protein coding sequence.

identified and validated six novel transcripts in d. discoideum.


putatively identified dozens to hundreds of novel genes in all four species.

identified errors in the genome sequence of at least two d. discoideum genes . with the possibility of, at least, another  <dig> genes having sequence errors.

found hundreds of putatively alternatively spliced transcripts in all species, something which has not been identified before in p. pallidum, d. lacteum or d. fasciculatum.




by combining methodologies we now have a better and more complete description of the transcriptome for these four species. this is not an end-point, however, but a further step towards fully finished genomes. more data and more manual refinement will be required to improve the annotations further.

additional files

additional file 1: figure s <dig>  tagc plot for d. fasciculatum  and d. lacteum  before and after filtering. each colour blob represents different taxa with unmatched transcripts are shaded in grey. the unannotated grey coloured transcripts after filtration set further filtered by high gc and low read coverage. this plot shows a major blob of transcripts that are annotated with the dictyostelium fasciculatum species with high coverage and lower gc content. other contaminations form e.coli, pseudomonas fluorescence and other species has also been highlighted with different colours. these contaminations clearly make different blobs with lower read coverage and high gc content. however, it’s good to see that there are some other transcripts that showing matched to dictyostelium discoideum- that clearly reflect the presence of some novel unannotated transcripts in the new assembly. figure s <dig> a comparison of assembled transcripts read count. the boxplots represent the range between the 1st and 3rd quartiles of the data by the coloured boxes, the median is the horizontal bar and points shown beyond the whiskers are >95% of the data. table s <dig> transrate good contigs. table s <dig> olignucleotide sequences. table s <dig> alignment with dna sequence of pcr product. 


additional file 2: figure s <dig>  annotated domain diagrams for  <dig> d. discoideum developmentally relevant proteins which have had their protein sequence altered. 


additional file 3: table s <dig>  
d. discoideum gff file of genomic positions with introns <  <dig> bp. 


additional file 4: table s <dig>  list of pasaua novel genes in d. discoideum. 




abbreviations
blatblast-like alignment tool

bpbasepairs

buscobenchmarking universal single-copy orthologs

cdnacoding dna

cdscoding sequence

contigcontiguous sequence

erccexternal rna controls consortium

estexpressed sequence tag

gdnagenomic dna

gmapgenome mapping and alignment program

mrnamessenger rna

ncrnanon-coding rna

pasaprogram to assemble spliced alignments

pcrpolymerase chain reaction

rna-seqrna sequencing

rrnaribosomal rna

utruntranslated region

