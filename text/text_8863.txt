BACKGROUND
the study of dissimilarity between samples, known as beta-diversity , is crucial for studying microbial communities from environmental or human niches  <cit> . beta-diversity gives a quantitative measure of differences between two microbial samples, forming the basis for a quantitative comparison of multiple samples. the dissimilarity matrix defined by beta-diversity measures between all pairs of samples in a set of multiple samples can be utilized to study group relationships of the samples  <cit>  and to understand environmental gradients affecting microbial samples  <cit> .

valuable insights into the diversity of hundreds of uncultured microbial samples from various environments or niches have been provided by sequencing the small subunits of ribosomal rna, specifically the 16s rrna, with the conventional sanger sequencing or the next-generation sequencing  technologies from a variety of environments, including soil  <cit> , ocean  <cit> , mammalian gut  <cit> , human skin  <cit> , human gut  <cit> , and human oral cavity  <cit> , among many others. in 16s rrna-based surveys, several analytical procedures have been carried out to compare multiple microbial samples using different beta-diversity measures  <cit> . the two general categories of beta-diversity measures include phylogenetic- and taxon-based methods. using unifrac  <cit>  as an example, phylogenetic-based methods first generate a phylogenetic tree of sequences in each sample and then compare samples by counting overlaps of branches of their corresponding trees. taxon-based methods, on the other hand, calculate beta-diversity through binning sequences to operational taxonomic units , or assigning sequences to, for example, species or genera, and then comparing samples by counting overlaps in the taxa  <cit> .

with the rapid development of ngs technology, whole metagenome shotgun sequencing  is becoming a new powerful approach to investigate complex microbial samples  <cit> . metagenomics data provide more complete information on the microbial community, but beta-diversity measures for metagenomic sequencing reads from different microbial communities are significantly under-studied. a common practice of analyzing metagenomics data is to first map the short reads to known genes or pathways in existing databases, such as nr, kegg or img and then compare their abundances between samples based on the mapped functional categories . however, as a result of the incompleteness of microbial genomic annotation and function databases, only a small fraction of reads can be mapped to known genes and pathways, resulting in significant loss of information in the comparison of metagenomes.

genome sequence signatures refer to the frequencies of k-tuples  in a genome. previous studies have shown that k-tuple frequencies are similar across different regions of the same genome, but differ between genomes  <cit> . sequence signatures have been widely used to study the evolutionary relationships among genomic sequences  <cit> , to study horizontal gene transfer among different genomes  <cit>  and to bin genome fragments from metagenomic samples  <cit> . in metagenomic studies, the number of organisms in the communities, the complete genome sequences of the organisms, and their abundance levels are usually not known. thus, samples cannot be directly compared on the basis of abundance levels of organisms within communities. methods based on mapping reads to known genes or functional categories are also restricted by the availability and completeness of existing databases. however, since genomes have their sequence signatures, differences in microbial compositions of samples will result in differences in sequence signatures of the metagenomes.

thus far, sequence signatures have not been widely applied in the quantitative comparison of metagenomic samples, except a few studies that used di-, tri-, and tetra-nucleotide signatures . on the other hand, with the availability of ngs data, sequence-signature-based methods have high potential for the comparison of metagenomes. ngs technologies have provided efficient approaches to sample short reads of dna sequences from the metagenomic communities. maillet et al.  <cit>  recently presented an algorithm to efficiently find similar reads between two metagenomic datasets based on k-tuple signatures. without using complete genomes or information of any known genes, sequence signatures of the metagenomes can be reflected from the ngs short reads and can be easily calculated. thus, we can use sequence signatures to compare metagenomic samples from ngs short reads without doing sequence assembly or alignment.

key steps in sequence signature methods include the counting of frequencies of all k-tuples to compose the sequence signature vector for each sample, calculating the dissimilarity measure between samples based on their sequence signature vectors, and analyzing relationships between multiple samples based on dissimilarities of all sample pairs. in this study, we systematically investigated these key steps using a series of simulated and real metagenomic datasets, giving special attention to the choice of dissimilarity measures, the length of the sequence signatures, and the model for the background genome sequences for the comparison of multiple metagenomic samples.

RESULTS
we conducted a series of computational experiments by both extensive simulations and real data analyses to study the effectiveness of the sequence signature methods in identifying group and gradient relationships of microbial community samples. we first simulated four types of datasets to investigate factors that may affect the performance of the sequence signature methods. the simulated datasets were generated by sampling from mixtures of multiple true genomes with different abundance levels. we studied three d2−type dissimilarity measures, as defined in  <cit> , based on k-tuple count vectors and three dissimilarity measures defined on the basis of comparing the actual k-tuple frequency vectors to evaluate the beta-diversity between different samples. we also studied the performance of a dissimilarity measure used in cvtree   <cit>  and measures based on di-, tri-, and tetra-nucleotide signatures   <cit> . to calculate d2s and d2*, the expected count of the k-tuples under a suitable probability model for the background sequences is needed. here markov models of different orders for the underlying background genomes were used to calculate the expected counts of k-tuples. we studied a total of  <dig> dissimilarity measures . using the dissimilarity matrix obtained from any one of the measures, we studied the relationships of the samples.

simulation 1: detecting group relationships among metagenomic samples of relatively low complexity
in some situations, metagenomic samples may form different groups. for example, gut samples may group based on diet, and marine samples may group based on locations. in order to evaluate the ability of the dissimilarity measures to detect such group relationships, we simulated datasets of  <dig> metagenomic samples belonging to  <dig> different groups  similar to the simulation method of kuczynski et al.  <cit> . each sample was generated by simulating ngs short reads from a mixture of the genomes of  <dig> microbial species detected in soil  <cit>  with different abundance levels .

we applied the  <dig> dissimilarity measures based on sequence signatures  with different k-tuple sizes k = 2-- <dig> in this dataset to detect the group relationships of the  <dig> samples by clustering analysis. for a specific tuple size k, k-tuple count/frequency vector of each sample was first calculated, and samples were compared with each other using each dissimilarity measure. we then used the upgma method  <cit>  to cluster the samples based on the dissimilarity matrix. the parsimony test  <cit>  was finally used to compare the derived clusters with the actual groups given in the simulation model.

the number of sequences in each sample, termed sequencing depth, may affect the accuracy of the sequence signature methods. we simulated three different sequencing depths:  <dig> ,  <dig> , and  <dig>  reads per sample. to study the stochastic variation of the results, the simulation was repeated  <dig> times at each sequencing depth. as an example, figure  <dig> shows one clustering result of the  <dig> samples at sequencing depth of  <dig>  obtained with k =  <dig> and the dissimilarity measure d2s|m <dig>  which is the d2s dissimilarity measure  under the markov model of order  <dig> , the independent identically distributed  model. it can be seen that most of the samples in the original  <dig> groups can be clustered together. compared with random clustering results, the parsimony test score is highly statistically significant with monte carlo p-value << <dig> .

we studied various factors, including the order of the markov model for the background sequence, the tuple size k, and sequencing depth, affecting the performance of d2s and d2* in recovering the group relationships of the samples. figure  <dig> shows the relative performance of d2s and d2* coupled with the i.i.d. model for the background sequence with other dissimilarity measures, including d <dig>  ma, eu, ch, hao, and willner. overall, the dissimilarity measures d <dig>  ma, eu, ch, hao and willner do not perform as well as d2s and d2*. the poor performance of d <dig> can be explained by the fact that it is dominated by the variation of the tuple occurrences within one sample, and is less affected by the relationship between the sequences in both samples. meanwhile, the poor performance of hao could be attributed to the high number of parameters that need to be estimated to fit a markov model of order k- <dig>  ch considers the maximum difference between the tuple frequencies for the samples only and does not make full use of the information from all the tuples. most importantly, the normalization of the tuple counts plays an important role in the superior performance of d2s and d2*. for each dissimilarity measure, the optimal tuple size giving the lowest parsimony score depends on the sequencing depth. for example, when the sequencing depth is  <dig> , the optimal tuple size for d2s, d2*, eu, and ma is around  <dig> to  <dig>  when sequencing depth is high , the parsimony score for d2s, d2*, ma, and eu decreases as the tuple size increases from  <dig> to  <dig> 

next we studied the effect of the order of the markov model for the background sequences on the parsimony score of d2s and d2*, and the results are given in additional file 1: figure s <dig>  when the sequencing depth is low , the i.i.d. model gives the lowest parsimony score in general. when the sequencing depth is high , the effect of the order of the markov model is negligible and the results are similar across the different orders , especially when the tuple size is relatively large . one potential explanation for the above observations is as follows. when the sequencing depth is low, the absence of sufficient data to accurately estimate the many parameters in high-order markov models results in the low accuracy to cluster the metagenomic samples. however, when the sequencing depth is high, this is not a problem and markov models of different orders give similar results.

finally, we studied the standard deviations of the parsimony score of d2s and the results are given in additional file 1: figure s <dig>  from the figure we can see that at lower sequencing depth , the best performance is obtained at k =  <dig>  when the sequencing is  <dig> times deeper, the best k becomes  <dig>  and it further increases when the sequencing depth further increases. we can also see that the standard deviation of the parsimony score among the  <dig> repeated experiments at each sequencing depth is quite moderate and stable with different choices of k, and deeper sequencing will decrease the standard deviation of the parsimony scores, as expected.

simulation 2: revealing environmental gradients from metagenomic samples of relatively low complexity
the second simulation experiment was designed to evaluate the effectiveness of sequence signature methods for analyzing gradient variation of microbial communities. a set of  <dig> metagenomic samples was generated by simulating ngs reads from  <dig> soil bacterial species as in the above simulations  <cit>  with varying abundance levels. we designed the proportion of the  <dig> genomes to vary from sample  <dig> to sample  <dig> in a way that mimics the situation of gradient variation across the samples, and we then studied how well the sequence signature methods reveal such gradient variations from the metagenomic data. dissimilarity matrices were calculated using different dissimilarity measures and different k-tuple sizes as above. pcoa  <cit> , an effective approach to display beta-diversity among multiple samples, mapped the  <dig> samples to a two-dimensional space. then the pearson correlation coefficient  was calculated between the first principal coordinate  given by pcoa and the predetermined gradient axis built in the simulation model. the pcc can be taken as an index of how well the sequence signature method reveals the gradient variation in samples . a higher pcc indicates better performance of the dissimilarity measure in recovering the gradient among the microbial samples.

similar to simulation  <dig>  we repeated the simulation experiments  <dig> times at each of the three sequencing depths of  <dig> ,  <dig>  and  <dig>  reads per sample. figure  <dig> shows the average pcc of the different dissimilarity measures at different sequencing depths and tuple sizes. we can see that the dissimilarity measures perform with greater differences than observed in the case of group relationships in simulation  <dig>  specifically, the performance of d2s and d2* is quite robust with respect to the tuple size and the sequencing depth. in most situations, d2s and d2* perform similarly manner, and outperform other dissimilarity measures. the average pccs for these two measures are larger than  <dig>  when tuple size k is between  <dig> and  <dig>  and the sequencing depth is  <dig> . deeper sequencing can slightly increase the pcc but the improvement is not as significant as that observed in simulation  <dig>  additional file 1: figure s <dig> shows that the performance of d2s and d2* is highly robust with respect to the order of markov model used to calculate the expected occurrences of k-tuples. additional file 1: figure s <dig> shows the means and standard deviations of pcc obtained using the dissimilarity measure d2s with tuple sizes k = 2-- <dig> at different sequencing depths. we can see that the optimal tuple sizes, at lower or moderate sequencing depths, are between  <dig> and  <dig>  and this range also gives the smallest standard deviation although the standard deviation is, in general, very small.

simulations  <dig> and 4: revealing group relationship and environmental gradients from metagenomic samples of relatively high complexity
the above simulation experiments illustrated the performance of the various dissimilarity measures for microbial communities of relatively low complexity. most microbial communities are much more complex with hundreds to thousands of genomes. in order to see the performance of the dissimilarity measures for discovering group or gradient relationships among metagenomic samples of high complexity, we simulated two ngs metagenomic datasets with more complex microbial compositions. the simulated communities consist of  <dig> microbial genomes from a collection of genomes given by the fames dataset  <cit> . we simulated short reads with both roche/ <dig> and illumina/solexa platforms.

in simulation  <dig>  we generated  <dig> samples belonging to  <dig> groups, as defined by different compositions of the microbial genomes . in simulation  <dig>  we simulated  <dig> samples related through a gradient . as in simulations  <dig> and  <dig>  we generated datasets at three sequencing depths:  <dig> ,  <dig>  and  <dig>  reads per sample. for each setting, we generated  <dig> duplicated datasets to simulate possible stochastic effects in real ngs data.

the complete simulation results are given in additional file 1: figures s5-s <dig>  the qualitative results for the relative performance of the different dissimilarity measures are similar to that from the first two simulations for metagenomic samples of relatively low complexity. we also changed the read length for roche/ <dig> and illumina/solexa in our simulations and the results reported above continue to hold.

detecting group relationships among mammalian gut samples
we applied the sequence signature methods to analyze a real mammalian gut metagenomic dataset by muegge et al.  <cit> . it includes the ngs short reads of  <dig> metagenomic samples from  <dig> mammalian species of herbivores, carnivores and omnivores . previous studies showed that the microbial compositions of omnivores are very diverse and cannot be distinguished from other samples  <cit> . consequently, we first excluded the  <dig> omnivore samples and focused on the remaining  <dig> herbivore and carnivore samples. these samples include  <dig> groups: hindgut-fermenting herbivores , foregut-fermenting herbivores , and simple-gut carnivores . we investigated how well the sequence signature methods identified these  <dig> groups from the ngs metagenomic data. similar to the simulation studies, we used upgma to cluster the samples based on the dissimilarity matrix, as defined by different dissimilarity measures based on sequence signatures, and we assessed how well the resulting cluster tree revealed the underlying  <dig> groups by the parsimony test.

the resulting parsimony scores for the different dissimilarity measures and tuple size are summarized in table  <dig>  for most choices of the tuple size k and dissimilarity measures, the sequence signature methods could group the samples well. this indicates significant group differences in sequence signatures of the metagenomes among hindgut-fermenting herbivores, foregut-fermenting herbivores and simple-gut carnivores. the smallest parsimony score  was achieved with d2s coupled with the i.i.d. model for the background sequences and k =  <dig>  when k varies between  <dig> and  <dig>  the parsimony scores obtained with d2s|m <dig> are never greater than  <dig> and are always the smallest among those with other dissimilarity measures. this shows that d2s|m <dig> has the best performance among all the dissimilarity measures we considered and that the optimal performance is not very sensitive to the choice of tuple size k as long as it is within a reasonable range. when the tuple size k was increased to  <dig> or above, we also observed that the performances of all dissimilarity measures became worse. to explain, with a given data size and large k, the number of occurrences of each k-tuple will be too small, causing the result to be unstable. we also experimented with k =  <dig>  which also resulted in poor performances. however, when k =  <dig>  the sequence signature vector only has  <dig> dimensions and therefore cannot adequately reflect the diversity of the samples.

the “mi” indicates that the expected counts are calculated based on i-th order markov model for the background sequences. monte carlo p-values were estimated by comparing observed parsimony score to the scores in  <dig> randomly-joined trees: parsimony score = 2-- <dig>  p <  <dig> ; score =  <dig>  p =  <dig> . boldfaced are the two lowest parsimony scores.

figure 4a shows the clustering tree obtained with tuple size k =  <dig> and d2s|m <dig>  clear separations among the three groups of samples can be observed. the relationships of the samples can also be visualized in 2-dimension by the pcoa plot in additional file 1: figure s <dig>  from the pcoa plot, we can see that  <dig> of the  <dig> pairs of samples with the same host species are also clustered together:  <dig> okapis ,  <dig> bighorn sheeps  and  <dig> rock hyraxes , while the  <dig> lions  are separated. moreover, the digestive physiology of the host samples  is the most distinguishing information extracted by the sequence signature method. this observation was not reported from this dataset in the original study  <cit> .

then we added back the  <dig> omnivorous samples to the dataset and reanalyzed the data, and the result is shown in figure 4b. we can see that the omnivore samples are not grouped as a single cluster, but are scattered throughout the clustering tree. this suggests more diversity in the fecal microbiome of omnivores than that of herbivores or carnivores, consistent with previous observations based on 16s rrna data  <cit> . some omnivore samples are clustered together with samples of other diets. for example, samples from omnivorous bears  share considerable similarity with those from carnivores, as previouslyreported in  <cit> . the pcoa plot including the omnivore samples is given in additional file 1: figure s <dig> 

detecting group and gradient variations in global ocean metagenomics data
we applied the sequence signature methods to analyze the metagenomics data of global ocean samples collected from different geographic locations and conditions by rusch et al.  <cit> . the geographic locations of the samples include the sargasso sea, caribbean sea, eastern tropical pacific and tropical south pacific, and the samples also contain variation in microbial habitat types  and environmental temperatures  . all these factors may influence the composition of seawater microbiomes. to avoid the interacting effect of locations and habitat types, we applied the sequence signature methods on the  <dig> open ocean samples and the  <dig> coastal water samples separately.

the  <dig> open ocean samples form four geographic groups: sargasso sea , caribbean sea , eastern tropical pacific , and tropical south pacific  . we conducted clustering analysis with sequence signatures on these samples and used the parsimony test to study how well the grouping information was revealed . again, for most tuple size values, it can be seen that d2s|m <dig> achieves the lowest parsimony score among all the dissimilarity measures we studied, and also the clustering results are quite stable when the tuple size k is between  <dig> and  <dig>  figure 5b shows the clustering tree of the open ocean samples with k =  <dig> and d2s|m <dig>  we observed that the three major groups identified by the sequence signature method reflect three major environmental temperature conditions: north temperate, north tropical, and south tropical. the samples from the caribbean sea were clustered together with those from the eastern tropical pacific ocean. they both lie between the tropic of cancer and the equator.

the “mi” indicates that the expected counts are calculated based on i-th order markov model for the background sequences. monte carlo p-values were estimated by comparing observed parsimony score to the scores in  <dig> random joined trees: parsimony score = 4-- <dig>  p <  <dig> ; score =  <dig>  p =  <dig> ; score = 8; p =  <dig> ; score = 9; p =  <dig> . boldfaced are the two lowest parsimony scores.

we also found significant separation among  <dig> coastal water samples , mainly consisting of  <dig> samples from the north american east coast and  <dig> samples from the galapagos islands in the eastern tropical pacific ). in the clustering tree obtained with 5-tuples and d2s|m <dig>  coastal water samples from the north american east coast are separated from those from the galapagos islands ). however, we also see some possible errors in the clustering. for example, sample  <dig> from the south of charleston, sc, was clustered with samples from the galapagos islands, and sample  <dig> from the galapagos islands was clustered together with samples from the north american east coast. these outliers deserve further investigation.

we then pooled all  <dig> global ocean samples and carried out pcoa on all samples. figure 6b gives the pcoa plot with k =  <dig> and d2s|m <dig>  it can be clearly seen that geographic location as the gradient primarily drives the samples in the pcoa plot. samples along the back-diagonal of the pcoa plot are geographically located along the s-shaped line sequentially running through the sargasso sea , north american east costal , caribbean sea , eastern tropical pacific , galapagos islands , tropical south pacific  and polynesian archipelagos . it is worth mentioning that sample  <dig> is both located and pcoa plotted between the galapagos islands  and the tropical south pacific , although it belongs to the eastern tropical pacific group . however, the habitats  do not significantly affect the clustering of the microbial communities.

experiments on the human gut metagenome data
we applied cluster analysis based on sequence signatures of the  <dig> human gut metagenome samples published by kurokawa et al.  <cit> . one set of samples consists of <dig> unweaned infants, and the other consists of  <dig> adults and  <dig> weaned children  <cit> . the sample information is provided in additional file 1: table s <dig>  although the sample size is very small in this study, we asked whether sequence signature methods could still reflect meaningful relationships. additional file 1: table s <dig> gives the parsimony scores on the separation of these two groups by the clustering based on sequence signatures. again, we see that d2s|m <dig> has the best performance for almost all values of tuple size k. the clustering tree and the ordination plots for the samples are shown in additional file 1: figure s <dig>  it can be seen that the samples from the unweaned infants tend to cluster together but show more diversity than the adults and weaned children.

discussion
in this study, we examined the application of sequence signature methods for the comparison of microbial metagenomic samples with ngs read data. we studied both traditional and recently developed dissimilarity measures of sequence signature vectors, and we used markov models of different orders to estimate the background when a measure requires a background model. the dissimilarity measures, with a wide range of choices of tuple size k, were compared on the basis of four sets of simulated metagenomics data and three sets of real metagenomics data, including metagenomes of gut samples of multiple mammalian species, water samples of global ocean, and human gut samples. the data represent a wide spectrum of topics that can be studied with metagenomic approaches.

in all the data we studied, sequence signature methods were able to reveal the major group and gradient variation among the samples from the short reads of metagenomic data. the performance of different dissimilarity measures varies with different choices of tuple size. the recently proposed d2s measure performs the best in all scenarios and the optimal tuple size for it is between  <dig> and  <dig>  for ngs data with moderate sequencing depth of about  <dig>  sequences of 200nt. its performance is not highly sensitive to the tuple size, making it easier to apply the method on real data. the experiments also show that new biological insights on factors affecting the k-tuple compositions of the metagenomes can be obtained. in the mammalian gut data experiment, the first factor is the diet, followed by the digestive physiology. for the global ocean samples, the most important factor is location, followed by habitat. for the human gut samples, weaning is a key factor that distinguishes microbiomes of adults and children from those of infants.

in summary, this work shows that the recently developed dissimilarity measure d2s provides a powerful approach for metagenomic sample comparison based on ngs shotgun reads. it is simple and computationally efficient, and it can reveal underlying relationships between microbial community samples. the rapid development of ngs technology has provided great opportunities for metagenome sequencing. because availability of known microbial genome references are limited and de novo assembly of metagenome sequences is challenging, the alignment-free sequence signature method is a promising approach for analyzing multiple metagenomic samples.

in this study, we concentrated on the comparison of metagenomic samples using alignment-free methods with sequence signatures. however, with respect to optimizing strategies for the comparison of metagenomic samples, several questions remain. first, we did not study how sequence signature methods compare with other methods using tag sequences such as 16s rrna or its variable regions for microbiome comparison. since the 16s gene is only a very small fraction of the metagenome, our prior experiences showed that extracting 16s sequences and classifying the samples using only the 16s gene sequences do not work well. only using the 16s sequences of the metagenomic samples loses information, resulting in inaccurate clustering of the samples. second, we do not know whether metagenome shotgun reads or assembled contig sequences should be used for metagenomic sample comparison. we did not conduct experiments to specifically address this question, but based on our experiments on the shotgun reads, sequence signatures can be extracted reasonably well with ngs short reads without any assembly. third, for most metagenomics studies, investigators are interested in what genes or pathways are active. to achieve this objective, reads are usually mapped to the known genes or pathways, and then the samples are compared using the active genes or pathway. such approaches can give important insights about functions of genes and pathways, which sequence signature-based approaches cannot. on the other hand, not all genes/pathways are known, and typically only a relatively small fraction of the reads can be mapped to known genes/pathways. therefore, such gene/pathway-based approach cannot make full use of the data for metagenome comparison. sequence signature-based methods use all reads and can potentially reveal more accurate relationships of samples. finally, all our experiments were based on real datasets with all the potential complexities, such as sequence errors, heterogeneous sampling of reads from different organisms or different genomic regions, as well as biases arising from different techniques for sample preparation and sequencing. despite all these potential complexities, it is surprising that the clustering of samples using sequence signatures with the d2s measure still performs very well. theoretical and further simulation studies to understand the effects of such complexities on the performance of different dissimilarity measures will be a topic for future research. the code for calculating the three d2-type measures is provided at http://www-rcf.usc.edu/fsun/programs/d2meta/d2metamain.html.

CONCLUSIONS
with the rapid development of ngs technologies and applications, metagenomics is becoming an important approach for studying microbial communities in environments and/or the human body. analyzing shotgun metagenomic data by assessing similarity to existing genome sequence databases is limited by the imcompleteness of these databases, especially for environments that have not been extensively studied. we conducted a systematic study on the application of sequence signature methods for the comparison of metagenomic samples, and found that, if dissimilarity measures are chosen properly, alignment-free methods based on sequence signatures can successfully reveal major group and gradient relationships among metagenomic samples from ngs reads without using reference databases or sequence assembly. these observations showed that analysis of sequence signatures provides an additional tool to evaluate patterns in microbial community data, and this tool is not subject to the biases in existing databases.

