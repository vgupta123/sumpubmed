BACKGROUND
micrornas  form a recently-discovered family of single-stranded rna molecules of length approximatively  <dig> nucleotides that are present in all higher eukaryotes  <cit> . as shown by the growing number of specific examples, they regulate gene expression at a post-transcriptional level by binding to specific mrna targets whose translation is thereby inhibited  <cit> . although some details of mirna biogenesis are still missing, a consensus scenario has now emerged: primary mirna  are transcribed generally by polymerase ii  <cit> , these transcripts are processed in the nucleus by the drosha endonuclease  <cit>  and exported as individual pre-mirna stem loops to the cytoplasm by exportin  <dig>  <cit> . in the cytoplasm, the mature forms are produced through the action of the dicer endonuclease  <cit> . it appears that a crucial feature throughout these processing steps is a stem loop secondary structure  <cit> .

an upper bound on the number of mirnas present in the human genome was initially set by lim et al. to a few hundred  <cit> . recently however, this number has been re-evaluated by berezikov et al. who argued that mammalian genomes encode close to a thousand mirnas  <cit> . thus, the debate about the number and identity of the mirnas in mammalian genomes is open, especially considering that these estimates concern only mirnas that are conserved between relatively distant species such as primates and rodents and not mirnas that are of a more recent evolutionary origin.

the complete mirna transcription units  remain to be defined, although some studies have already associated mirnas with cdnas sequences corresponding presumably to pri-mirnas that can be found in sequence databases  <cit> . this and other studies  show that some mirnas are transcribed as polycistronic transcripts which are several kb long. additional support for this hypothesis comes from a recent study that revealed that mirnas that are found within  <dig> kb of each other on the same strand display correlated expression in microarray experiments  <cit> . therefore the genomic regions around the loci of known mirnas appear particularly promising for discovering additional mirnas.

in the past few years several algorithms have been designed for detecting mirnas, and they proved to be extremely efficient in supporting experimental mature mirnas discovery  <cit> . very generally, these methods identify specific secondary structures corresponding to mirna precursors in regions of the genome that are conserved between species. recent experiments have uncovered, however, a number of mirnas that do not have close homologs in the sequenced genomes available to date, such as for example the mirnas encoded by the epstein-barr virus   <cit> . this finding emphasized that it would be desirable to have a method able to predict mirnas in a single genome, without an absolute requirement for cross-species conservation. we developed such a prediction method and we used it to discover mirnas in a number of members of the herpes virus family  <cit> . by similarity with protein-coding gene prediction methods that only scan genomic regions looking for signals characteristic to protein-coding genes and do not use external transcripts or other genomes, we called our method ab initio.

here we apply our method to search for novel mirnas that are in close proximity, and may be co-transcribed, with already known mirnas. as the set of known mirnas we take the human, mouse and rat sequences from the april  <dig> release of the rfam mirna repository  <cit> . to evaluate the performance of the method, we use a growing set of mammalian sequences that are cloned in the tuschl laboratory  <cit> . in the following we first present the general ideas behind our pre-mirna prediction method, then show the results of two validation tests and finally move on to its application to the discovery of potentially co-transcribed mirnas in human, mouse and rat.

RESULTS
overview of the pre-mirna prediction method
the general idea of our approach to pre-mirna prediction is to design a computational method that can be used to better understand the constraints that define mirna precursors in relationship to their processing enzymes. we start with the observation that one of the generic features shared by all mirna genes is the secondary structure assumed by the transcript region surrounding the mature mirna. indeed, mature mirnas appear to reside inside one arm  of a stem loop with good, though not perfect, base pairing during the various steps of the biogenesis  <cit> . this stem loop structure is important for mirna precursor recognition by rnaase iii enzymes drosha  <cit>  and dicer  <cit>  as well for the export of the mirna precursor from the nucleus  <cit> . the intermediates in this processing pathway differ in the length of the sequence surrounding the mature mirna, implying that the stem loop structure of the pre-mirna persists independently of the precise sequence context that varies from several kb for the pri-mirna transcripts to 50â€“ <dig> nucleotides for the relatively short pre-mirna. we thus design our prediction method to identify such "context-robust"  stem loops and then characterize their compositional and secondary structure properties in relationship to those of known pre-mirna as well as negative examples. our approach consists in three steps:

 <dig>  from the input sequence we first extract a set of genomic regions that are predicted to exhibit the same stem loop secondary structure, irrespectively of the size of the larger transcript in which they are embedded. we call these "robust" stem loops.

 <dig>  each of the stem loops thus detected is assigned a score that reflects its similarity to known cases of human pre-mirnas. since the precise structural features that contribute to mirna precursor recognition by processing enzymes are not known, we use a device from statistical machine learning called "support vector machine" , as follows. we describe any given stem loop in terms of sequence and structure features. then, using two training sets consisting of known human mirna precursor sequences as positive examples and random subsequences from genomic regions, trna, rrna and mrna genes as negative examples we build a model which describes the relative contribution  of each of the features to the score assigned to any given stem loop. the score measures the distance  from the candidate stem loop to the hypersurface that best separates the positive from the negative examples. the weights associated with the features that we used to describe the stem loops give us insight into the constraints that appear to be most important for the recognition of mirna precursors by the processing enzymes.

 <dig>  in order to guide experimental investigations, we develop a probabilistic mathematical framework that enables us to estimate the pre-mirna content of the input genomic sequence from the scores assigned to all the stem loops identified in this sequence. this framework that has the advantage of not being dependent of the somehow arbitrary score cut-off used to define the predicted mirna precursor stem loops.

further details about each of these components are presented in the "methods" section.

validation of the method
identification of viral mirnas
we initially validated our method on a set of eight human pathogenic viruses for which experimental investigations were simultaneously undertaken  <cit> . we made  <dig> pre-mirna predictions, out of which  <dig> were confirmed by the cloning study, giving a confirmation rate of 41%. as explained in the "method" section, the first step of our prediction method consists in extracting genomic regions which are able to form robust stem loop structures. the number of such regions grows linearly with the genome size . the number of predicted pre-mirnas, however, is not merely a linearly function of the genome size  <cit> . this property shows that the classifier that we have developed captures specific features of pre-mirnas that are not uniformly distributed across the input genomic sequence. we have also developed a method for estimating the expected number of pre-mirnas in a given genomic sequence . as shown in the lower panel of figure  <dig>  the expected number of pre-mirnas in a genome is, as expected, strongly correlated with the number of predicted pre-mirnas . at the same time this statistics is more robust against small variations in the value of the score threshold defining the predictions. an additional advantage of using this estimation approach is that it enables us to identify genomic regions that are likely to give rise to mirnas without having to pinpoint their precise location. this is useful for directing experimental studies to promising genomes or genomic regions.

recovering known mirna in distantly-related species
it is perhaps not surprising that we can predict viral mirnas, given that they are processed by the mirna processing machinery of the human host, as are the mirnas with which we have trained our model. to test the ability of our method to identify pre-mirnas in distantly-related species, we applied it to the regions known to encode mirna loci in the invertebrate caernorhabditis elegans. of the  <dig> known mirna precursors, we recover  <dig>  as predictions. this results indicates that our prediction method has a reasonable sensitivity for a wide range of genomes from worms, to vertebrates to animal viruses.

predictions: clustered mirnas in human, mouse and rat
identification of novel clustered mirnas
mirnas are often found in genomic clusters, some of which are believed to be transcribed as a single transcript . a nice example is the cluster of hsa-mir- <dig>  whose elements reside within a  <dig> kb interval on human chromosome  <dig> and are indeed co-transcribed . motivated by the recent microarray study by baskerville and bartel showing that correlated expression of mirnas can be shown up to the order of  <dig> kb of relative genomic distance  <cit> , we set to discover novel mirnas in the neighborhood of confirmed mirnas from the rfam database  <cit> . we adopt the following strategy. we first group into clusters the known mirnas from human/mouse/rat rfam <dig>  that are closer than  <dig> kb from each other and have the same transcription sense. we find that 105/111/ <dig> of the total 227/232/ <dig> pre-mirnas  belong to a cluster of at least two elements. by adding these to the mirnas that so far appear to be isolated, we obtain a total of 162/161/ <dig> clusters. we then extend the genomic regions of all of these clusters by  <dig> kb on each side and submit the resulting sequences to the prediction method. in total, we analyze  <dig> / <dig> / <dig>  million nucleotides and we find that 224/192/ <dig> of the 3829/3537/ <dig> candidate stems are classified as predicted pre-mirna by our prediction method. after filtering out the known pre-mirnas in these clusters, we obtain a total of 89/66/ <dig> predictions, given in the additional files  <dig>   <dig>  and  <dig> 

in order to validate these predictions, we have searched a large database of small rnas from human, mouse and rat that have been cloned in the tuschl lab  <cit> . we consider a prediction to be validated if one of the arms of the stem loop matches perfectly a cloned small rna that is not known to be derived from a rrna, trna, snrna or snorna. additionally, although our predictions include sequences coming from repeated regions, we discard cases where the cloned small rna has more than two perfect mappings to the genome of the species it originates from. we then find that 20/17/ <dig> of the predictions have a match from the same species, and these numbers raise to 22/20/ <dig> if matches from small rnas from all three species are allowed. this corresponds to confirmation rates between 25% and 30%, which are somewhat lower than the one obtained with the earlier application of our method to viruses . the pre-mirnas predicted in repetitive elements are partially responsible for these lower confirmation rates. the complete list of the confirmed predictions together with the sequences of the cloned mirnas are given in the additional files  <dig>   <dig>  and  <dig> 

the false negative rate of our prediction method, as determined from the cloning data, is 34%, a value which is close to the false negative rate of 29% that we obtained for our svm training set, using a threshold score of  <dig>  this indicates that the prediction method behaves as expected. for completeness, the false negative predictions are shown in the additional files  <dig>   <dig>  and  <dig> 

if we consider our results at the level of genomic clusters, we find  <dig> novel clusters in human,  <dig> in mouse and  <dig> in rat. by "novel clusters" we mean a set of precursor mirnas that contains, beside the confirmed predictions, known cases that were not considered to be in clusters, i.e. which did not have another known pre-mirna with same transcription sense at distance smaller than  <dig> kb from its genomic location. this corresponds to an increase of the total number of clusters from 40/40/ <dig> to 44/45/ <dig> in human/mouse/rat.

phylogenetic conservation of the clustered mirnas
since cross-species conservation was not used in the process of generating our predictions, we can now go back and ask the question of whether the predicted pre-mirnas are indeed conserved between human, mouse and rat. we define the "conservation" relation between two given species at three progressive levels, corresponding to the three columns labeled "conservation" in the additional files  <dig>   <dig>  and  <dig>  the first level requires that a homologous sequence is found for a predicted mirna precursor in another genome . the second level requires that both the predicted precursor as well as the homologous sequence fold into simple  stem loops. the third level requires that the two homologous sequences are predicted to be mirna precursors by a method that uses cross-species conservation. for this purpose, we use the web interface to the mirscan method with the default parameters   <cit> .

as shown in the additional files  <dig>   <dig>  and  <dig>  the predictions that are conserved across species are more likely to be experimentally confirmed than the one that are not. indeed the confirmation rates are 1%, 22% and 49% for predicted precursors with homologs in none, precisely one and both species, respectively. we thus conclude that the cross-species information strongly improves the specificity of the prediction method. if we now restrict ourselves to predictions that have experimental confirmation, we find that for almost all of them  a strong sequence homology is equivalent to a conserved stem loop structure. additionally, we learn from the third conservation column that only 68% of the conserved and confirmed mirnas that we predict are also classified as mirna precursors by mirscan.

in some cases we discovered mirnas that are known in some species, but were not reported in others. this is the case of the rat homolog of mmu-mir- <dig>  which corresponds to our predicted rp- <dig>  the predicted precursor has over 97% identity relative to the mouse precursor, and the region corresponding to the mature mirna is perfectly conserved. this mirna has not been cloned in rat. in other cases we discovered mirnas that are conserved across all three species but that are found in the neighborhood of a mirna only known to exist in one of the species. this is the case of rp- <dig>  which is close to rno-mir- <dig>  for this mirna we found cloning and conservation evidence in mouse and human as well. note, however, that we do not report here candidate pre-mirnas that are homologous to some of our predictions but that were not part of our predicted set because in their species of origin they are not found in the neighborhood of a known mirna.

genomic locations of the mirna clusters
most of the confirmed predictions come from a relatively small number of clusters. these are the following:

 <dig>  the orthologous loci located on chromosome  <dig> in human, chromosome  <dig> in mouse and chromosome  <dig> in rat, each of which is less than  <dig> kb in length. the human locus has been shown to be imprinted  <cit> . only a few mirnas from these loci have been deposited in rfam, although other studies have also published computational predictions matching them  <cit> . the fine-grained structure of these loci has some species-specific aspects, as illustrated by figures  <dig> and  <dig>  the figures show all the validated mirnas in these regions, including those with suboptimal prediction scores from the additional files  <dig>   <dig>  and  <dig>  we find that some mirnas that are related in sequence, and have presumably arisen by duplication  have different numbers of copies in rodents and human. we also find rodent-  and human-specific  mirnas, meaning that they do not have very close mature form homologs in the other species. yet in other cases the human and mouse sequence have diverged slightly, as the predicted mirnas hp-30/mp- <dig> and hp-41/mp- <dig>  because the mature forms of these mirnas differ by a deletion or a substitution, and because we only considered perfectly matching small rnas from human as validation, only the human mirna genes end up being validated . finally, there are cases of more complicated species-specific evolutionary pattern. for example, mir- <dig> appears to have diverged between human and mouse: at the syntenic location in human we find two identical copies of a mirna distantly-related to mmu-mir- <dig> . furthermore, this cluster has a complex composition, containing other related sequences {hsa-mir- <dig>  hp- <dig>  hp- <dig>  hp- <dig>  hn-6} whereas the corresponding mouse cluster {mmu-mir- <dig>  mmu-mir- <dig>  mp- <dig>  mn- <dig>  mp-37} additionally contains a rodent-specific sequence, mn- <dig>  which is not related to the other sequences in the cluster. a similar situation can be found in the human cluster {hsa-mir- <dig>  hp- <dig>  hn- <dig>  hsa-mir-376a} which corresponds to the mouse {mmu-mir-376a, mmu-mir-376b, mp-38}.

 <dig>  chromosome x also contains a substantial number of novel mirnas in all three species. they are spread over the full chromosome and eventually form small clusters with only a few elements. in the mir- <dig> cluster paralog on chromosome x, whose evolution has been analyzed in detail by tanzer and stadler  <cit> , we found two additional mirnas that are conserved in all three species. in the order of genome location, the cluster then reads: mir-106a, hn-14/mp-56/rp- <dig>  mir-19b- <dig>  mir-92- <dig>  and hp-85/mn-8/rp- <dig>  consistent with the evolutionary scenario proposed by these authors we find that these novel mirnas are relatively close in sequence to other mirnas in the cluster. for instance the mature mirna sequence of mp- <dig> has only two mismatches with mmu-mir- <dig>  mmu-mir- <dig> and mmu-mir-106a. we observe a similar situation for another cluster on human chromosome x: hsa-mir- <dig>  hn- <dig>  hp- <dig>  hn- <dig>  and hn- <dig> . whereas only hp- <dig> is a confirmed prediction and possesses a close homolog in mouse , this cluster contains further three related mirnas that have negative scores but that have been confirmed experimentally.

 <dig>  apart from the above mentioned mirnas, we found a few other cases of clustered, and potentially co-transcribed mirnas: two in human , four in mouse  and three in rat .

comparison with other prediction methods
to evaluate the performance of our approach relatively to other large-scale mirna prediction methods, we perform the following test. we take the mirna predictions sets provided by the most extensive predictions studies in the recent past  <cit> . since these results have been published at different times and some of the predictions sets contain also known mirnas, we set the rfam <dig>  release as the reference set of known mirnas. the set of mirnas used to perform sensitivity/specificity tests contains those that have been introduced in the most recent version of the mirna repository, rfam <dig>  and that only became available while our manuscript was under revision, as well as those mirnas that are predicted by any of the four methods  and that are confirmed by the cloning data  <cit> . this set comprises  <dig> mirnas. table  <dig> shows that, when tested on mirnas that are conserved between human and mouse or human and rat, our method has comparable performance to methods that make predictions from conserved genomic regions. overall, we have somewhat higher sensitivity, at the expense of somewhat lower specificity compared to the methods of berezikov et al. and xie et al.. interestingly, each of four methods is able to predict some mirnas that are not predicted by any of the other ones.

discussion
we have developed a computational method for ab initio prediction of precursor mirnas that we applied here to the problem of identifying clustered, probably co-transcribed mirnas. as explained in details in the "pre-mirna prediction method" subsection and in the "methods" section, our approach is based on a mechanistic model for the action of enzymes like drosha or dicer, and uses only the information contained in the input sequence and secondary structure. in doing so we neglect important aspects such as the fact that any stem loop that we consider a candidate pre-mirna has to be be transcribed and accessible to all the processing enzymes responsible for ultimately producing a mature mirna. this aspect is, in part, responsible for a relatively high number of false positives that we would obtain if we were to run the prediction method on an entire mammalian genome. but by applying the method to regions around loci of already known mirnas, we believe that we circumvent the issue of whether the genomic regions that we analyze are transcribed and are accessible to all the processing enzymes. our results  show that this assumption was justified. this is also indicated by another recent study that identified  <dig> of our  <dig> predicted and confirmed mirnas  <cit> . the given percentage is a lower bound for the performance of our method on these genomic regions, since it cannot be excluded that some of the predicted pre-mirnas are not detected or are expressed in tissues or developmental stages other than the ones that have been used in the experiments. furthermore, we did not filter out from our predictions those that fall inside repeat elements and may have higher likelihood of being false positives. although this inclusion lead to a lower hit rate, we have seen above that this allowed us to discover a rich structure in the imprinted clusters.

virtually all of precursors of the validated mirnas have some homolog  in at least one other species, and a number of factors may contribute to this effect.

 <dig>  we have focused our search on regions that are already known to contain conserved mirnas and, as can be observed from out comparison of human and mouse loci, mirnas that are close to each other in the genome are frequently related in sequence.

 <dig>  we have used for validation data from all three species, and we have considered a predicted pre-mirna to be confirmed even in cases in which the supporting small rna cloning data came from another species.

 <dig>  finally, the mouse and rat genomes are quite close to each other and we therefore expect that almost all of the mouse mirnas have rat homologs, and vice versa.

note however that  <dig> out of the  <dig> confirmed mouse and rat mirnas appear to be rodent-specific , and one confirmed mirna appears to be human specific . these mirnas would be difficult to discover using other methods either due to lack of cross-species conservation or because the genomes that are sharing the mirna are too close.

although our "ab initio" approach to pre-mirna discovery was initially designed and successfully applied to detect species-specific mirnas  <cit> , we find that it retains its value when applied to a situation where cross-species conservation plays a important role. in fact, we were able to discover conserved mirnas that were missed by three methods that use cross-species comparisons to make their predictions  <cit> . concretely, in the large imprinted clusters from human chromosome  <dig>  mouse chromosome  <dig> and rat chromosome  <dig>  almost half  of the mirnas that we predicted and were confirmed experimentally are novel .

it would be, of course, very instructive to understand what factors contribute to the different results obtained by different prediction methods. although this is not the topic of our current study, we discuss some of these factors below. generally, all these approaches, including ours, are based on a two-level strategy: first identify a relatively small set of candidates and then examine these candidates in detail to make predictions.

 <dig>  a fundamental difference between the first layer of our method and any cross-species-based analysis is the fact that we have tried to take into account mechanistic considerations rather than evolutionary conservation or statistical properties. that is, by first identifying "robust" stem loops  we not only pick up genomic regions which are likely to form suitable rna secondary structure , but we also take into account the fact that the stem loop has to be present in the various stages of the mirna biogenesis. this implies a dependency of the stem loop secondary structures that we identify on the flanking genomic regions, which should not compete too strongly for pairing with nucleotides within the mirna precursor and thereby destroying its secondary structure. this mechanism naturally gives a basis to the observation that the functional rnas, and in particular mirna precursors, have thermodynamically more stable structures than randomized sequences with the same nucleotide composition  <cit>  . the same property, namely robustness of functional rna secondary structure elements with respect to varying sequence context, has been described in rna viruses  <cit> .

 <dig>  the second layer of the approach consists in scoring the candidate regions. in our case, these regions are already predicted to form stem loop secondary structures. our choice of implementing a support vector machine  to distinguish between "good" and "bad" precursor mirna candidates has several advantages. first it also includes information about what a mirna precursor should not be, unlike the mirscan scoring scheme which is only based on positive examples. additionally, our procedure enables us to use the positive and negative examples to compute the weights with which the various features in our model should contribute to the score . this detailed description of the sequence composition and structural features of the mirna precursors enables our classifier to perform better than classifiers based simply on the thermodynamic stability of mirna precursor stem loops  <cit> : on our training data, the svm has at least 3-fold lower false positive rate compared to a classifier based on the randfold algorithm for any given rate of false negative predictions . additionally, the weights assigned by the svm for individual features give us a deeper understanding of mirna processing than procedures that only use statistics of secondary structure stability of pre-mirnas relative to randomized variants  <cit> .

adding our confirmed predictions  to the already known mirnas from rfam <dig>  , we have reached the upper bound on the number of mirnas that was estimated by lim et al. to be around  <dig>  <cit> . it is now important to realize that this estimate was based on an assumption of mirna conservation over an evolutionary distance up to the pufferfish fugu rubripes. the more recent estimate of berezikov et al., with less stringent assumptions about conservation lies in the range of about a thousand mirnas  <cit> . from the present work we have learned that these methods have missed some conserved mirnas. moreover, some mirnas are only represented in closely-related species  and there are also families of closely related mirnas that differ in precise composition across species. all these considerations lead us to conclude that the mirna discovery is still not completed, and moreover, that hundreds of mirnas are yet awaiting experimental confirmation.

although the hypothesis that mirna loci tend to occur in clusters which are probably co-transcribed has been useful in the discovery of novel mirnas, there are interesting open questions about the expression of the co-transcribed mirnas. in particular, not all of the known examples of co-transcribed mirnas show strongly correlated expression patterns  <cit> . this indicates that yet unknown processing factors lead to differential expression of the clustered mirnas by either making the processing enzymes having different efficiencies on different templates or by directing transcription from alternative transcription start sites.

CONCLUSIONS
we have developed a computational method to estimate the pre-mirna content and to predict the location of precursor mirnas in genomic sequences. this method can be used to guide experiments to find both mirnas that are evolutionarily conserved as well as species-specific mirnas such as those known now to exist in viruses. here we applied our method to the discovery of clustered, probably co-transcribed, mirnas in human, mouse and rat. we have shown that our method successfully identifies evolutionarily conserved mirnas that have been missed by various other methods that are based on cross-species comparisons. most of the novel mirnas that we discovered reside in a conserved imprinted locus from chromosome  <dig> in human,  <dig> in mouse and  <dig> in rat and on chromosome x . in these regions we found species-specific patterns of mirna duplication and diversification. the web interface to our prediction method can be accessed on the world-wide-web  <cit> .

