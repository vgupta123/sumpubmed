BACKGROUND
many eukaryotic proteins have highly modular architectures. multidomain proteins are usual for transmembrane receptors, signalling proteins, cytoskeletal proteins, chromatin proteins, transcription factors and so forth. as a consequence, many programs have been developed for the detection and alignment of protein domains. online resources can now provide a good overview of the globular domain architecture of a polypeptide sequence and the functions these domains are likely to perform, e.g. pfam  <cit> , smart  <cit> , interpro  <cit> . however, less research has been directed towards the analysis of the large segments of multidomain proteins that are non-globular, intrinsically lacking the capability to fold into a defined tertiary structure  <cit> . sometimes such regions may simply act as linkers connecting globular domains and in this case, the sequence of amino acids is not critical to function. very often, however, these unstructured regions contain important functional sites such as protein interaction sites, cell compartment targeting signals, post-translational modification sites or cleavage sites. large parts of many proteins, such as the insulin receptor substrates, or sometimes even the entire protein, such as the alzheimer's protein tau  <cit> , are natively unstructured. the functional sites within these unstructured regions can often be defined as short, linear motifs  â€“ linear in the sense that only the local peptide sequence is relevant to function. in order to avoid confusion, in this paper we will use the term 'sequence' to refer to the full-length protein, while a specific region of a protein sequence will be referred to as a 'segment' or a 'motif'. the eukaryotic linear motif resource  has entries describing ~ <dig> varieties of linear motif  <cit> , but it is not fully comprehensive with respect to current literature and it has been estimated that hundreds more have yet to be discovered  <cit> . when eubacterial, archaebacterial and viral motifs are also considered, the true number of unknown functionally important lms is likely to be huge. given the fundamental roles these motifs play in cell regulation and signalling, identifying these motifs will be of crucial importance in many biological disciplines.

until recently, and in stark contrast to protein domain discovery, the bioinformatics field has had a negligible impact on lm discovery: motif discovery is generally performed by low throughput experimental delineation of protein interaction segments. the central problem confounding computational methods has been the lack of significance of motif matches when searching sequence databases, making it impossible to confidently identify all the motifs present in a given protein sequence by simple sequence analysis tools. the majority of lms are between  <dig> and  <dig> amino acids in length and most have one or more ambiguous  or wildcard  residues. their short and degenerate nature makes real lms difficult to distinguish from the background distribution of randomly occurring false positive motifs. nevertheless, efforts are now underway to develop bioinformatics tools that will contribute to the linear motif discovery problem. as a first step, it is necessary to catalogue linear motifs and particular instances that are known to be functional. such data collections include the eukaryotic linear motif  resource  <cit>  and scansite  <cit> . a number of tools have been developed, e.g. elm  <cit> , quasimotifinder  <cit> , minimotif  <cit>  and the acs method  <cit> , that employ various methods, such as domain masking and evolutionary filtering respectively, to discover new occurrences of previously known motifs. other methods, such as the lmd method  <cit>  , slimdisc  <cit> , slimfinder  <cit>  and miner  <cit> , explicitly attempt novel lm discovery using large scale interaction datasets and/or motif conservation.

one of the major limitations in predicting short linear motifs is the evaluation of the many potential motifs found in each protein, to distinguish between true functional sites and incorrect occurrences of a given pattern. in the worst case, there are motifs which have such low support and low information content as to be almost indistinguishable from random noise in most datasets, e.g. the pcsk cleavage site k/rr  <cit>  which plays a role in proteolytic processing of neuropeptide and peptide hormone precursors, or the peroxisomal targeting motif wxxxy/f   <cit> . it is vitally important, therefore, to develop novel scoring methods or to consider other information, such as contextual information, e.g. loop region, n/c-terminus, cellular localisation, if such data is available, or evolutionary information, since motifs conserved during evolution are more likely to be functional. conservation has been shown to be an essential factor in the prediction of functional motifs. for example, many motif discovery systems, such as lmd, quasimotifinder miner, minimotif and the acs method use a combination of traditional motif scores and evolutionary conservation to rank potential motifs. it is worth pointing out though, that while lmd explicitly utilises conservation, the method used is alignment-free and, as such, would not be affected by the developments described in this article. slimfinder and slimdisc make use of automated multiple alignments and conservation scores to help visualise and interpret results. we have also recently developed a rapid automated conservation scoring pipeline suitable for real time operation in the elm resource  <cit> .

it follows therefore that, in order to exploit evolutionary information optimally, we need to construct multiple sequence alignments of the highest quality. lms that occur in several different phyla should appear as short patches of conservation in this alignment. however, a large majority of lms are found in the natively disordered regions  <cit>  that are difficult to align using classical multiple sequence alignment programs, which are better adapted to protein domain alignments. the biological relevance of the alignments produced by these programs is usually assessed by systematic comparison with established benchmark sets, e.g. balibase  <cit> , prefab  <cit>  or sabmark  <cit> , based on 3d structure superpositions of globular domains. the introduction of these objective benchmarks has had a considerable effect on the evolution of alignment algorithms and has led to a significant improvement in overall multiple alignment quality  <cit> . however, there is also a risk that alignment software optimised on structure superpositions has been overfitted to globular domains and may not adequately account for awkward features of full length protein sequences, such as n- and c-terminal extensions and motif-rich non-globular sequence segments. therefore, to evaluate the ability of multiple alignment methods to identify and align lms, new test sets are now needed. benchmarks have already been developed for motif discovery in genomic dna sequences, such as transcription factor binding sites, e.g.  <cit> , but these benchmarks are not generally organised into evolutionarily related sets that might be used to evaluate multiple sequence alignment programs. another reference database, irmbase  <cit> , consists of simulated conserved motifs implanted into non-related artificial protein sequences. however, this benchmark does not reflect the problems associated with identifying and aligning the short linear motifs that are essential for the function of real multimodular proteins.

the main objective of the work presented here is to provide a standard way to assess the ability of a multiple alignment program to correctly align the linear motifs occurring in a set of related sequences. however, if the multiple alignment is to be used in a subsequent motif discovery system, it is important that  the sequences containing the motif should be accurately aligned and  the sequences that do not contain the motif should not be aligned in the corresponding region. to address these issues, we have developed a new reference set that has been incorporated in the balibase benchmark suite  <cit> . the benchmark includes example multiple alignments for most of the motifs annotated in the elm resource  <cit> . for each lm, a representative set of homologous sequences has been selected and a multiple alignment of the complete sequences  has been constructed and manually refined. a number of different test subsets are provided, representing typical scenarios and problems that occur when trying to align the motifs in the context of a global multiple alignment.

using the new balibase reference set, we then evaluated the accuracy of the motif alignments obtained from a number of widely used or recently developed multiple alignment programs. the performance of the different programs was assessed by comparing the alignments constructed by each program with the reference alignments. we show that none of the programs currently available is capable of reliably aligning lms in distantly related sequences and we highlight a number of specific problems. this will hopefully generate interest in developing new algorithms and should provide program developers with guidelines for future enhancements that will improve the quality of motif alignments.

methods
the new reference set in the balibase benchmark contains multiple alignments of sequences with functional linear motifs . to avoid confusion, the term 'sequence' will be used to refer to the full-length protein, while a specific region of a protein sequence will be referred to as a 'segment' or a 'motif'. the alignments are constructed from a set of reference sequences with experimentally verified motifs, known as elm motif instances, extracted from the elm database  <cit> . putative functional sites in elm are identified by patterns  that are similar to prosite patterns  <cit> . although the elm regular expressions are highly discriminative and provide a useful resource for the identification of functional lms, these regular expressions are not 100% accurate and may either  exclude true motifs or  may find false, but apparently plausible, motif matches  <cit> . for this study, the  <dig> motif instances in the elm database associated with experimental evidence were extracted. they correspond to the  <dig> different linear motifs  present in the elm version i- <dig>  for each reference sequence containing an elm motif instance, a semi-automatic protocol has been developed to detect related sequences in the uniprot  <cit>  protein database, and to construct a 'primary' multiple alignment that is then used to select suitable sequences for each subset in the reference set. a general overview of the protocol is shown in the flowchart in figure  <dig> 

primary multiple alignments
for each reference sequence containing an elm motif instance, the first step involves the detection of similar sequences in the uniprot database  <cit>  and the construction of a multiple alignment of the complete sequences, using the following protocol:

 the uniprot database is searched using the blastp program  <cit>  with the full-length reference sequence as query and all sequences detected with e < 10- <dig> are initially selected.

 the selected full-length sequences are aligned using the pipealign  <cit>  protein family analysis toolkit to construct a multiple alignment of complete sequences . at this stage, sequences that do not contain any regions considered to be homologous to the reference sequence are removed from the macs, using the leon program  <cit> .

 the sequences in the macs are then annotated using the macsims information management system  <cit> . macsims mines information from the public databases, including known structural domains, functional sites and other motifs. at the same time, a number of prediction algorithms are run to detect sequence features, including transmembrane regions, low-complexity segments and disordered regions. at this stage, all motifs that match the elm regular expressions are also identified and annotated using a perl script.

 finally, the automatic multiple alignment is manually verified and refined to assure the accurate alignment of the potential motifs with the current motif instance. a number of factors were taken into account during the manual validation, including the macsims functional annotations, the presence of known globular domains or functional sites or the presence of conserved sequence segments close to the instance lm. the globular domains were generally well aligned by the pipealign toolkit and the manual refinement was limited to the potential lms, identified by the elm regular expressions. low complexity regions were not realigned, as these could not be validated in most cases. during the manual refinement, any sequences containing motifs that could not be validated unambiguously were removed from the multiple alignment. these included motifs occurring in unrelated proteins  and sequences with multiple occurrences of a motif, where the correspondence with the elm motif instance was uncertain.

selection of reference primary alignments
each primary multiple alignment contains the complete set of sequences detected by blastp, that share some similarity with the query sequence. in order to construct benchmark test sets, sequences are selected that correspond to a certain number of criteria. the following protocol is used to identify suitable alignments and sequences:

 in order to reduce the size of the test sets, redundant sequences sharing >80% residue identity that are easy to align, are removed in a clustering step, based on the multiple sequence alignment.

 true positive, false positive and false negative motifs are defined . a true positive motif corresponds to a motif that matches the elm regular expression, and that occurs in a region that can be aligned on the motif instance. a false positive motif is a motif that matches the elm regular expression, but that is detected in a region that does not align on the motif instance. in contrast, a false negative motif is defined as a sequence segment that can be aligned unambiguously in the region of the motif instance, but that does not match the elm regular expression. in the example shown in figure  <dig>  the motif in p <dig> is defined as a 'false negative', since it can be aligned unambiguously with other sequences  that do match the elm regular expression. sequences that do not contain any matches to the elm regular expression and that cannot be aligned manually in the region of the motif instance are also included in the primary alignments. it should be noted that this classification of true positive, false positive and false negative motifs refers to the current motif instance only, based on the presence of a match to the elm regular expression and the quality of the alignment in this region. the classification is useful for the purposes of this study, but it does not imply anything about the alignment of the motifs at other positions, nor does it imply anything about the functionality of the motifs, which cannot be assessed exclusively by sequence analysis tools. the false positive motifs provide a control to avoid over-optimisation of multiple alignment algorithms when using the reference set as a benchmark, since aligning the false positive matches on the elm motif instance will lead to a misalignment of the globular regions in the sequences . the false negative motifs are important because, given their amino acid sequence they should be aligned on the motif instance, even if they do not match the elm regular expression.

 primary alignments containing less than  <dig> sequences with true positive motifs were excluded from the benchmark.

 finally, primary alignments with at least one sequence in common were merged together to form a single reference alignment. this step is necessary because the original set of query sequences contains a certain number of homologous sequences, resulting in an overlap between the corresponding sets of blastp detected sequences.

construction of reference subsets
the reference primary alignments are then divided into  <dig> subsets, designed to evaluate the accuracy of multiple alignment algorithms under different conditions. subsets 1â€“ <dig> are constructed by automatically selecting the sequences from the primary multiple alignment that correspond to a number of specific criteria.

 for subset  <dig>  only sequences with validated lms  are selected. additional "false positive" motifs that match the elm regular expression may be present at other positions in the alignment, as long as the lm corresponding to the motif instance can be identified unambiguously. the subset is further organised into three different groups, according to sequence variability: <20% identity, 20â€“40% identity and 40â€“80% identity.

 subsets 2â€“ <dig> include the sequences in subset  <dig>  together with additional sequences that cannot be aligned in the region of the motif instance. these additional sequences may cause problems for automatic multiple alignment programs:-

â–ª subset  <dig> includes additional sequences that share some homology with the reference sequence, but that have possible 'errors'  in the region of the motif instance. although these 'error' sequences do not contain a validated lm, they may or may not contain false positive matches to the elm regular expression elsewhere in the sequence.

â–ª subset  <dig> includes additional sequences with false positive matches to the elm regular expression, that are found at other positions in the alignment and do not correspond to the motif instance.

â–ª subset  <dig> includes additional sequences that do not have any examples of the lm, either in the region of the motif instance or elsewhere in the alignment.

 for each alignment in the benchmark, the validated lms aligned on the motif instance are characterised according to three different features:

â€¢ structural context . globular segments were predicted using the iupred program  <cit> . iupred estimates the capacity of polypeptides to form stabilizing contacts. the underlying assumption is that globular proteins make a large number of interresidue interactions, providing the stabilizing energy to overcome the entropy loss during folding. in contrast, disordered regions are assumed to have special sequences that do not have the capacity to form sufficient interresidue interactions.

â€¢ motif conservation. motifs are defined as 'conserved' if all the true positive sequences in the multiple alignment share at least one conserved residue. motifs in which no residues are conserved are defined as 'variable' motifs. the conservation is calculated based only on the validated motifs present in the multiple alignment, and does not necessarily correspond to non-wildcard positions in the motif regular expression.

â€¢ motif length .

definition of a quality score for alignment of motifs
to assess the accuracy of the programs evaluated in this study, we calculate a sum-of-pairs score  which estimates the accuracy of the alignment of the motifs. the sps corresponds to the percentage of correctly aligned pairs of residues in the alignment produced by the program. only the sequences with true positive or false negative motifs, which can be aligned unambiguously in the region of the reference motif, are taken into account. the alignment of the other sequences has no effect on the sps quality score.

suppose we have a test alignment and that n sequences in the alignment contain true positive or false negative motifs. suppose also that the reference motif corresponds to m columns in the alignment. we can designate the ith column in the alignment of the motif by ai <dig>  ai <dig> ...... ain. for each pair of residues aij and aik, we then define pijk such that pijk =  <dig> if residues aij and aik are aligned with each other in the reference alignment, otherwise pijk =  <dig>  the score si for the ith column is defined as:

 si=âˆ‘j= <dig> jâ‰ knâˆ‘k=1npijk 

the sps for the alignment is then:

 sps=âˆ‘i=1msiâˆ‘i=1mrsri 

where mr is the number of columns corresponding to the reference motif and sri is the score si for the ith column in the reference alignment. the score thus includes all columns in the alignment that correspond to residues in the motif instance, including variable and wildcard positions. for variable length motifs, positions containing gaps in the reference alignment are ignored.

multiple alignment programs tested
eight different alignment programs were tested, representing the mostly widely used approaches for the construction of multiple alignments:

 <dig>  clustalw  <cit>   performs a progressive multiple alignment using a series of pairwise alignments that follow the branching order in a phylogenetic tree. a global dynamic programming algorithm is used to construct an alignment of the full length of the sequences.

 <dig>  dialign  <cit>   uses an alternative 'segment-to-segment' alignment method. segments consisting of locally conserved residue patterns or motifs, rather than individual residues, are detected and then combined to construct a local multiple alignment of the most conserved regions of the sequences.

 <dig>  t-coffee  <cit>   uses information from a pre-compiled library of different pairwise alignments including both local and global alignments, which are then incorporated in a global multiple alignment.

 <dig>  mafft  <cit>   is an efficient method that includes fast pairwise alignments, and a progressive multiple alignment strategy that uses local anchors to reduce the area of the dynamic programming matrix that must be computed. here, we have tested two alternative strategies: mafft_fftns <dig>  and mafft_linsi .

 <dig>  muscle  <cit>   uses a similar strategy to that developed in mafft and includes a variety of options that offer different trade-offs between speed and accuracy. muscle_fast uses k-mer counting to estimate the pairwise sequence distances and identifies diagonals that are used as local anchors for the progressive alignment, while the default muscle program uses more accurate progressive alignment options and includes an iterative refinement strategy.

 <dig>  probcons  <cit>   uses hmm-derived posterior probabilities and three-way alignment consistency in a global, progressive alignment, together with an iterative refinement step.

 <dig>  kalign  <cit>   again follows a strategy analogous to the standard progressive method, but uses the wu-manber approximate string-matching algorithm in the sequence distance calculation.

 <dig>  mummals  <cit>   incorporates more complex pairwise alignments based on hidden markov models, and a probabilistic consistency-based progressive multiple sequence alignment.

all the programs were installed on a sun enterprise v40z server running redhat enterprise linux  <dig> and each program was tested using default parameters and, for the purposes of this study, no optimisation of parameters such as residue weight matrix or gap penalties was performed.

availability
all the reference alignments are available for viewing on the www at  and are also provided in msf format. the annotated alignments are also provided in xml format. a c program is provided to estimate the accuracy of the multiple alignments constructed by different alignment programs compared to the balibase references. the complete database and the evaluation program are available for downloading by ftp from .

RESULTS
the elm database  <cit>  provides a unique source of eukaryotic sequences with experimentally verified instances of functional motifs. these functional sites are identified by patterns  that are similar to prosite patterns  <cit> . the sequences containing the functional motifs, known as elm motif instances, were used to search the protein databases for other similar sequences and reference multiple alignments of the full-length sequences were then constructed automatically using the pipealign protein family analysis toolkit  <cit> . the final output from the pipealign system is a high-quality, validated multiple alignment of complete sequences , in which the globular domains are accurately aligned. however, manual validation and refinement of the disordered regions is necessary, paying particular attention to the conserved lms. an example alignment is shown in figure  <dig>  corresponding to elm entry mod_pkb_ <dig> and representing the motif recognized by protein kinase b  for serine/threonine phosphorylation.

in order to obtain information that might be used to improve the quality of multiple alignment programs, it is essential to provide sets of homologous sequences with different characteristics, representing specific problems for the alignment algorithm. one obvious issue is the similarity of the sequences to be aligned. it has been shown previously that multiple alignment methods can accurately align sequences that share similarity above the twilight zone of evolutionary relatedness, between 20â€“30% residue identity  <cit> . however, other characteristics may affect motif alignment quality, such as  sequence fragments,  the presence of sequences containing false positive lms that cannot be aligned on the motif instance or  the presence of related sequences that do not contain the specific lm. in addition, alignment quality may depend on the nature of the lm itself: in terms of motif length, conservation and structural localisation. for these reasons, we have designed a number of different test sets that address these particular problems . the number of alignments in each test set in shown in table  <dig> 

the different reference subsets were then used to analyse and compare eight different multiple alignment programs. in these tests, we concentrated on the accuracy of alignment of the lms, rather than the quality of the overall alignment since this has been previously assessed in a number of different, independent studies  <cit> .

accuracy of motif alignment at different levels of overall sequence similarity
the alignments in subset  <dig> consist of sequences that all contain the reference lm, and are divided into  <dig> different categories according to the residue similarity shared by the sequences .

the first test is designed to study the effect of sequence similarity on motif alignment accuracy and is used as the basis for the subsequent tests. figure 3a shows the sps  obtained by the different programs in the three similarity categories. a decrease in accuracy of alignment with decreasing overall sequence similarity is clearly observed for all the programs tested, with the greatest loss occurring in category v <dig> below 20% identity. nevertheless, some alignment is still possible below this threshold, with most programs aligning more than 50% of the lms successfully. the program probcons achieves the highest scores in v <dig> with a mean of 73%, while mafft_linsi , mummals  and muscle  ranked next highest, although the differences are not statistically significant according to a friedman rank sum test . the worst score at this level of identity was obtained by clustalw, with a mean of 43%. the results of the friedman test, together with a more detailed investigation of the scores obtained in category v <dig>  show that none of the programs tested here scores systematically higher for all alignment test cases.

although probcons has improved the alignment of motifs in highly divergent sequences, it takes longer to run than mafft or muscle. as shown in figure 3b, the cpu time required to construct the complete set of alignments in subset  <dig> is  <dig> sec for mafft_linsi and 1297s for muscle, compared to  <dig> for probcons. in a typical molecular biology study involving the analysis of a small number of sequences, the speed of the algorithm is generally not critical. however this may become an important deciding factor in high throughput experiments.

further investigation of factors affecting alignment quality
the similarity of the sequences is not the only factor affecting the accuracy of alignment of the lms. as shown in figure 3a, the scores obtained by all the programs are highly variable , even when the sequences are in the same similarity range.

in order to further investigate possible causes for this variability, the lms in subset  <dig>  category v <dig>  were annotated and classified according to three different criteria that might have a potential effect on motif alignment accuracy. pearson correlation coefficients  were then calculated for the sps quality scores obtained with the eight different alignment programs and  structural context ,  motif conservation  and  motif length.

pearson correlation coefficients for sps scores versus structural, motif conservation and motif length, for the eight different alignment programs evaluated. values in bold indicate a significant correlation 

the largest correlation, for all the programs tested, is observed with the structural context of the lm . in this context, globular domains were predicted using the iupred  <cit>  program. in fact, the highest sps scores are obtained for lms that occur within globular domains  compared to the lms found in disordered regions . somewhat surprisingly, less correlation was observed with motif conservation . this is probably due to the very short, degenerate nature of most lms, even those defined as 'conserved' . although conserved motifs are generally aligned better than variable ones, the differences are not significant .

accuracy of motif alignment when other sequences are included in the alignment
here we test the degree to which the alignment of the validated lms is disrupted by the introduction of other sequences. figure  <dig> shows the sps scores obtained by the different alignment programs, in the presence of a) sequences with errors, b) sequences with false positive motifs , c) sequences that have at least one domain in common with the query sequence, do not contain any matches the elm regular expression and do not align in the region of the motif instance. the two slowest alignment methods, namely mummals and tcoffee were excluded from these tests, due to their excessive time and memory requirements.

in the case of sequences with 'errors', i.e. predicted sequences with missing exons, sequence fragments or splicing variants, the alignment of the validated motifs is not significantly affected for any of the programs tested. as might be expected, sequences with false positive motifs have a greater effect on alignment quality, and clustalw, kalign and muscle show a significant reduction in alignment accuracy. more surprisingly, the introduction of related sequences that do not contain the lm also has an effect on alignment quality, although the difference is generally not significant.

quality of overall alignment
the sps scores obtained in the tests described above represent the accuracy of the alignment of the validated lms. they do not in any way indicate the overall quality of the complete alignment, and notably, they do not take into account the alignment of the homologous globular domains. unfortunately, we do not have high quality reference alignments for the full length proteins in these tests. therefore, in order to estimate the overall alignment quality, we calculated the normd scores  <cit>  for the full-length sequences in the reference alignments in subset  <dig> . normd is based on the mean distance  scores introduced in clustalx  <cit>  and combines the advantages of a column-scoring technique with the sensitivity of methods incorporating residue similarity scores. the normalised scores allow us to define a cutoff above which the alignment is probably of high quality.

for sequences sharing >20% residue identity, all the programs tested achieved high quality alignments with mean normd scores above  <dig>  confirming previous studies  <cit> . for the more divergent sequences in the twilight zone of sequence similarity , alignment quality is more variable , with the more recent methods, mafft, probcons, muscle and kalign, achieving the highest scores. a comparison of the normd scores  versus the sps scores   shows that lm alignment accuracy is not correlated with the overall quality of the complete alignment, which consists predominately of globular domains .

discussion
the balibase benchmarking suite
the systematic application of benchmarking approaches has been shown to be effective in many areas of bioinformatics, both for objective validation of existing tools and for identification of promising directions for future research. for example, the original version of the balibase benchmark has been widely used to evaluate multiple sequence alignment methods and has lead to significant improvements in alignment quality  <cit> . the alignments in balibase  were organised into reference sets that were specifically designed to represent the problems encountered by multiple alignment methods when aligning globular proteins, from a small number of divergent sequences, to sequences with large n/c-terminal extensions or internal insertions. in version  <dig> of the benchmark, three new reference sets were included, devoted to the particular problems posed by sequences with transmembrane regions, repeats and inverted domains.

the main objective of this study was to establish a benchmarking system that could be used to compare, evaluate and improve the alignment of short motifs in protein sequences. these linear motifs , including protein interaction sites, cell compartment targeting signals, post-translational modification sites and cleavage sites, play an essential role in the correct functioning of many multidomain proteins. the multiple alignments, developed here and included in the new balibase reference set  <dig>  represent real test cases and contain examples of experimentally verified functional motifs, extracted from the elm database. in this version of the benchmark, we only included lms that could be accurately aligned using a manual validation process. motifs that could not be aligned unambiguously were removed from the reference alignments. this led to a bias in the benchmark test sets towards the known linear motifs that occur in globular domains, which is clearly not representative of all possible linear motifs, many of which are found in disordered regions that are difficult  to align based solely on sequence information. in this case, the incorporation of multiple sequence alignment methods will not improve the motif prediction accuracy and other information will be needed, such as 3d structure, taxonomic range or cellular context. nevertheless, it should be possible in future versions of the benchmark to include examples of these more difficult motifs, whenever experimental or other evidence allows an objective assessment of the alignment.

the number of sequences in each reference alignment was then augmented by identifying related proteins in the public databases containing putative functional sites. the alignment of these potential motifs was validated and refined manually to ensure the correct alignment of the conserved residues.

an important feature of the benchmark is the organisation of the reference alignments into different subsets that represent typical scenarios and problems that occur when trying to align short linear motifs in the context of a global multiple alignment. thus, subset  <dig> provides sequence sets at different levels of residue similarity, ranging from conserved sequences sharing 40â€“80% residue identity to more divergent sequences with <20% residue identity. in these alignments, all the sequences contain validated lms. subsets 2â€“ <dig> provide alignments that represent a control to avoid over-optimisation of multiple alignment algorithms when using the reference set as a benchmark. for example, in subset  <dig>  aligning the false positive matches on the elm motif instance would lead to a misalignment of the globular regions in the protein sequences. subsets  <dig> and  <dig> consist of alignments that include sequences that do not contain the elm motif instance and alignment of these sequences on the elm motif instance would lead to over-prediction in subsequent motif discovery systems.

accuracy of motif alignment
the assessment of alignment quality was based only on the sequences containing verified motifs and only took into account the alignment of the lms, ignoring the globular domain regions and the less well conserved, disordered regions. nevertheless, we have shown that the accuracy of the lm alignment depends critically on the overall similarity of the sequence set, with a significant loss of accuracy for the most divergent sequences sharing less than 20% residue identity. this is true for all the programs tested in this study, regardless of whether a global or local alignment algorithm is used. for sequences sharing more than 20% identity, all the programs tested are capable of correctly aligning on average 80% of the motifs. below this level of identity, in the "twilight zone" of protein sequences  <cit> , the alignments produced by the programs are often unreliable with a larger dispersion of the scores. however, more recent programs, such as mafft, muscle, mummals and probcons, achieve significantly better scores here than the more traditional methods. further investigation showed that the motif alignment quality for the most divergent sequences was significantly affected by the structural context of the motif. in fact, motifs that occurred within globular domains were aligned more successfully, compared to the motifs found in disordered regions. this result is not surprising since most multiple alignment programs are optimised for the alignment of globular domains. introducing noise in the form of other related sequences, with or without false positive motifs, also affected the ability of some of the programs to correctly align the manually validated motifs. currently, probcons provides the best alignment of lms  and should therefore be used where quality is paramount and slow execution is not a hindrance. in the conservation score pipeline recently developed for the elm resource  <cit> , probcons would be too slow, and therefore mafft has been adopted, since it provides the best current combination of performance and motif alignment quality.

CONCLUSIONS
most of the modern multiple sequence alignment programs have not been optimised to align the full length, highly modular protein sequences which abound in the human and other eukaryotic proteomes. instead, they have primarily been designed to align individual globular domains by reference to their 3d structure superpositions: i.e. relatively short and collinear sequence regions. we consider that there may be a number of different ways to improve alignment of motifs, by taking them into account either when developing new alignment algorithms and optimising parameters, or when performing the alignment. hopefully, an in-depth investigation of the factors affecting lm alignment quality and a subsequent optimisation of the diverse parameters should improve the performance of the different alignment programs. in this case, the risk of overfitting to the motifs may be acceptable when motif detection is the prime consideration.

we have shown that none of the algorithms tested here is capable of reliably aligning all the lms in distantly related sequences. it should be possible in the future to improve the reliability of lm alignment, either by combining a number of different algorithmic approaches and selecting a consensus alignment, or by including other contextual information, such as 3d structure, taxonomy or cellular context. if the resulting co-operative, knowledge based systems are capable of identifying the globular domain organisation of the proteins, then it should be possible to apply dedicated algorithms within the disordered, inter-domain regions, that can be used for the detection and alignment of over-represented or conserved sequence motifs. the success of such an approach will clearly hinge on the pertinence of the scoring function used to distinguish real motifs from random noise.

the use of more accurate multiple sequence alignments should in turn increase the precision of the new motif discovery systems now being developed, with subsequent consequences in a number of important applications. for example, since lms represent sites of protein interaction and act as nodes in regulatory networks, cell signalling cannot be understood until we can accurately identify such functional motifs. furthermore, linear motif targets are now considered to play a role in drug discovery  <cit> , as exemplified by the nutlins, lead compounds that block the p53:mdm <dig> interaction with dramatic effects on cultured tumour cells  <cit> .

competing interests
the authors declare that they have no competing interests.

authors' contributions
ep constructed the reference multiple alignments and contributed to their validation and analysis. cc conceived the initial idea together with jdt and tjg and contributed to the definition of the scoring methods. tjg and op contributed to the formalization of the alignment program evaluation. jdt supervised and took part in all stages of the project. all authors read and approved the final manuscript.

supplementary material
additional file 1
legend to additional figures s <dig>  s <dig> and additional tables s1- <dig>  tables contain friedman rank sum tests for data shown in figures  <dig> and  <dig> and wilcoxon signed rank tests for data shown in figures  <dig> and  <dig> of the main article.

click here for file

 additional file 2
figure s <dig>  comparison of sps scores for lm alignment  for each reference dataset  in subset  <dig>  v <dig> . the scores obtained by the different programs are shown in different colours and the maximum score obtained for each reference dataset is indicated by a red circle. on the x-axis, g denotes lms found in a globular domain, while n denotes lms found in a non-globular domain. figure s <dig>  comparison of motif alignment accuracy  versus overall quality of complete alignment  obtained by the different alignment programs for the different similarity categories in subset  <dig> .

click here for file

 acknowledgements
we would like to thank the bioinformatics platform of strasbourg , jean-claude thierry and dino moras for their support. the rÃ©seau national des gÃ©nopoles, anr  and european commission  are gratefully acknowledged for financial support. ep, op and jdt are supported by institute funds from the institut national de la santÃ© et de la recherche mÃ©dicale, the centre national de la recherche scientifique, the universitÃ© louis pasteur de strasbourg.
