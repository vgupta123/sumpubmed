BACKGROUND
microarrays enable us to monitor expressions of thousands of genes simultaneously and generate enormous amount of data. using such techniques, it is possible to explore the secret of biology at the molecular level and understand the fundamental biological processes ranging from gene function to development and to cancer  <cit> . in microarray experiments, the expression levels of several thousands candidate genes have been monitored in two opposite conditions, such as treatment versus control conditions, where each condition is represented by several samples. unfortunately, most monitored genes are unrelated to the conditions and their expression levels do not change or change by chance, while other genes are strongly related to the conditions and truly change their expression levels according to conditions. however, these differentially expressed genes are very useful in latter research and clinical applications  <cit> . therefore, one of the important tasks in microarray data analysis is to compare the expression levels of genes in samples drawn from two different conditions and to select genes with differential expression under those two conditions. specifically, we are interesting in identifying which of several thousands candidate genes have had their expression levels changed by condition, given a microarray data.

one simple approach used in literature to detect differential expression genes is "fold change" method, in which a gene is declared to be differentially expressed if its average expression level varies by more than a given constant between two conditions. however, "fold change" method has been demonstrated to be unreliable and inefficient, because statistical variability is not considered  <cit> . then, many sophisticated statistical approaches have been proposed  <cit> . these approaches can be roughly classified into two categories. the parametric methods based on statistical model is the first category of methods. this kind of methods include various versions of the two-sample t-test  <cit> . due to the reason that gene expression data are often noisy and not normally distributed  <cit> , the strong assumption of parametric method can be violated in practice. the second category of approaches is nonparametric statistical methods, including the wilcoxon rank-sum test  <cit> , the significance analysis of microarray  method  <cit> , the empirical bayes  method  <cit> , the mixture model method  <cit>  and other modified nonparametric methods  <cit> . for recent reviews, please see  <cit> .

however, very few studies consider the problem of sample imbalance in detecting differential expression genes and there are no studies as well as quantitive method to investigate the effect of sample imbalance on differential expression genes selection. sample imbalance means that the size of samples in one group is very different to that in another group. in fact, the problem of sample imbalance usually appears in gene expression data, especially in the data about tumor samples. for example, the data in  <cit>  are all unbalanced. there are many factors causing the problem of sample imbalance, such as the limit of source of tumor samples, budgetary constraints and reducing samples in the control group artificially and factitiously. coupled with the small sample in gene expression data, the problem of sample imbalance may be more serious. consequently, two important and natural questions may be asked by biologists as follows: how does the sample imbalance affect the methods for identifying differential expression genes? which method is more suitable for the unbalanced data? in addition, previous studies  <cit>  have found that the variability of gene expression may be related to the average expression. it suggests that the two sample t-test being used should be based on unequal variances. an instant but reasonable question is: whether the above suggestion is still true on the unbalanced data.

in this paper, we investigate the new problem about the impact of sample imbalance on identifying differential expression genes. two evaluation models based on random sampling are proposed and six famous methods are compared on both the real data and the simulated data. under each evaluation model, the random sampling is utilized to estimate the expected performances of methods on the unbalanced data which satisfy one specific sample ratio between two groups. then the variations of performances are used to illustrate the effect of sample imbalance on differential expression genes selection and method selection.

RESULTS
in this section, six methods including two-sample t-test with equal variances   <cit> , two-sample t-test with unequal variances   <cit> , wilcoxon rank-sum test  <cit> , sam  <cit> , regularized t-test  <cit>  and the permutation-based method of pan  <cit>  are systematically compared on real data and simulated data according to two evaluation models. all experiments are conducted in matlab environment on a pentium pc with a  <dig>  ghz cpu and  <dig> mb ram. the processing procedure is as follows. for every pair of fixed parameters n <dig> and n <dig>  in each experiment under two evaluation models, first, we randomly create a set of x independent artificial data or simulated data and test all six methods on these x data to get the results. for a specific method, each one in the x random data will only get one result for each measure, for example overlap rate, precision rate or recall rate. then, these x values are treated as a random sample of size x from the fixed parameters n <dig> and n <dig>  last, the expected performance of each method and its  <dig>  confidence interval are calculated from this kind of random samples.

datasets
two real datasets are the liver dataset  <cit>  and the prostate dataset  <cit> . taking a data preprocess protocol similar to that in dudoit et al  <cit> , we screen out genes with missing data in more than 5% arrays, impute other missing data by  <dig>  and then apply a base  <dig> logarithmic transformation. each experiment is standardized to zero median across the genes. the prostate data finally consists of gene expression profiles of  <dig> primary prostate tumours and  <dig> normal specimens with expression values of  <dig> genes. the liver data consists of gene expression profiles of  <dig> primary hcc and  <dig> non-tumor liver tissues,  <dig> benign liver tumor samples,  <dig> metastatic cancers, and  <dig> hcc cell lines on  <dig> genes. we select two largest classes from the liver dataset to do experiments.

the simulated data is created according to the protocol in  <cit> , where the gene expression value is a normally generated random value with a noise generated from one uniform distribution of u, which is very similar to real data. in each simulated data, there are  <dig> genes  and two classes c <dig> and c <dig> . for any non-differential expression gene j , its expression value aij on each sample i is randomly generated from n and u, where μ ~n. for gene j ≤  <dig>  the value of gene j on any sample in class c <dig> is generated from n and u, while that in class c <dig> is generated from n and u, where μ <dig>  μ2~n. for the problem of multiple testing involved in identifying differential expression genes, bonfenorri correction of the significant level α can be used to reduce the error of type i. but a very small α will be disadvantaged to compare the performances of methods. in this paper, a relatively small significant level α will be used to control the type error i. on the real data, the value of α is set to  <dig> . on the simulated data, the significant level α is set to  <dig> .

results on real data
in the experiments of the evaluation model  <dig>  the number of samples in class c <dig> of the artificial data, which are created from the liver data or the prostate data, is always fixed at  <dig>  the results under the evaluation model  <dig> are presented in figure  <dig>  because of the limitation of sample size in real data, in the experiments of the evaluation model  <dig>  the value of n1+ n <dig> in the artificial data created from the liver data is fixed at  <dig> and that from the prostate data is fixed at  <dig>  the results of the evaluation model  <dig> on real data are presented in figure  <dig>  the expected overlap rates and its  <dig>  confidence interval  of each method at each specific sr are obtained from  <dig> randomly generated artificial data. furthermore, in order to test whether the average overlap rate at sr ≠  <dig> )is significantly different with that at sr =  <dig> , we make a two sample t-test, where the observations are these  <dig> overlap rates calculated from  <dig> random artificial data with sr =  <dig> and those calculated from  <dig> random artificial data with sr ≠  <dig>  so our null hypothesis states that i =  <dig>  while the alternative hypothesis states that i ≠  <dig>  the p-values associated with the t-statistic in the evaluation model  <dig> and  <dig> are summarized in table  <dig> and  <dig>  respectively. the experiments on real data indicate that the sample imbalance has a great influence on the performances of all six methods. as can be seen in figures  <dig> and  <dig>  on both real datasets, the overlap rates of all methods are gradually decreasing in response to the increasing amounts of sample ratio. for example, in the figure  <dig>  the margins between the average overlap rates at sr =  <dig> and that at sr =  <dig> on  <dig> methods  are  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig>  and  <dig> . according to the p-value showed in table  <dig>  we can conclude that on the real data the difference of the performance for each method between sr =  <dig> and sr ≠  <dig> has a very high statistical confidence. additionally, there is also a difference among the overlap rates of different methods. it can be seen from figure  <dig> and  <dig> that welch t-test and the method of pan create higher overlap rates on the unbalanced liver data than other  <dig> methods, while wilcoxon test shows a lower overlap rate compared with other  <dig> methods on the unbalanced prostate data. however, because of without true solution, we can't decide directly and strictly which one of the six methods has the best performance on real data.

results on simulated data
in this section, under two proposed evaluation models, we generate two kinds of simulated data to compare the performances of different methods on the unbalanced data. in the first category, the differential expression genes have equal variances in sample class c <dig> and sample class c <dig> , but have unequal variances  in the second category of simulated data. the result on a simulated data is the average result on  <dig> random data generated with a specific sample ratio.

equal variances
the results on the simulated data with equal variances indicate the performances of all methods are greatly affected by the sample imbalance. each of two metrics for the performance of method  is steadily declined as the sample ratio increases. this result is consistant with that of previous experiments on the real data.

furthermore, the downward trend of recall rate in response to the increasing amounts of sample ratio is steeper than that of precision rate. in other words, the recall rate  of the method for selecting differential expression genes is more sensitive than the precision rate  to sample imbalance, although they are all affected by sample imbalance.

it is certain that the sample imbalance appears to have different effects between different methods. the difference between different methods become great when the degree of sample imbalance increases. in detail, the precision rates of the wilcoxon rank-sum test and the regularized t-test are higher than those of others, that is, the wilcoxon rank-sum test and the regularized t-test have lowest false positive rate . whereas, the recall rate of sam is superior to that of other methods, i.e. the method of sam has the lowest false negative rate . and welch t-test shows the worst performance.

unequal variances
in this section, under two evaluation models, the simulated data are generated in two case: the first case satisfies σ <dig> ≤ σ <dig> and n <dig> ≥ n <dig>  for example, σ <dig> =  <dig> , σ <dig> =  <dig> and sr =  <dig>   <dig>   <dig>  the second case is that σ <dig> ≤ σ <dig> and n <dig> ≤ n <dig>  for example, σ <dig> =  <dig> , σ <dig> =  <dig> and sr =  <dig>  , . the results of the evaluation model  <dig> on the two case of simulated data with unequal variances σ <dig> =  <dig> , σ <dig> =  <dig> are showed in figure  <dig>  figure  <dig> plots the results of the evaluation model  <dig> with n <dig> + n <dig> =  <dig> on two case of simulated data with unequal variances σ <dig> =  <dig> , σ <dig> =  <dig> 

as observed in figure  <dig> and  <dig>  the performance of each of six methods degrades when the degree of sample imbalance increases, and on the same unbalanced data there exists great variance among the performances of six methods. these features are the same as those on the simulated data with equal variances. furthermore, there are surprising variation on the performances of all methods compared in this paper between two different types of unbalanced data with unequal variances. in the case of σ <dig> =  <dig> , σ <dig> =  <dig> and n <dig> ≥ n <dig>  regularized t-test shows the highest precision rate and recall rate while welch t-test performs the worst capability. in contrast, regularized t-test has the medium performance and welch t-test shows the best performance when σ <dig> =  <dig> , σ <dig> =  <dig> and n <dig> ≤ n <dig>  this surprising observation can be easily explained by figure  <dig>  as we can see in figure  <dig>  the curve of each method performance under the evaluation model  <dig> is a function of sample ratio, which maximize its value at a specific sample ratio. these results imply that one should select a relatively feasible method to detect differentially expressed genes on an actual and specific unbalanced data. if one more suitable method has been selected to process the unbalanced data, then the result of analysis can be improved greatly.

in order to investigate the combined influence of sample ratio and varied variance on method performance, regularized t-test and welch t-test are selected as examples to demonstrate the dependency of the difference between methods with respect to different variances and sample ratios. figure  <dig> shows the difference between regularized t-test and welch t-test against varied variance at different sample ratios. when σ <dig> ≤ σ <dig>  regularized t-test is always superior to welch t-test on the unbalanced data which satisfies n <dig> ≥ n <dig>  when σ <dig> ≤ σ2and n <dig> ≤ n <dig>  the results become relatively complex. in the plot b of figure  <dig>  several curves cross the line of zero, which implies that both methods of regularized t-test and welch t-test have some region of superiority. but when σ1≤ σ <dig> and n <dig> ≤ n <dig>  welch t-test have obvious dominance. in addition, the more difference between variances σ <dig> and σ <dig> in unbalanced data, the higher different effects on different methods.

discussion
from this study, it is clear that there is a great effect on the performances of methods for selecting differential expression genes by the sample imbalance. because of many objective factors, the gene expression data always involve the problem of small sample. as mentioned earlier in the previous section, coupled with the problem of small sample, the presence of the unbalanced data makes detecting differential expression genes more difficult. the sample imbalance is an important and inevitable problem in gene expression data analysis. hence, one need to consider the problem of sample imbalance in the design of microarray experiments and the following data analysis.

careful experimental design is necessary to improve the result of data analysis and reduce the cost of experiment simultaneously. by the comparison between plot a and b in figure  <dig>  we can find that the expected recall rates and the expected precision rates at sr =  <dig> in plot b are higher than those at sr =  <dig> in plot a. in other words, because of the influence of sample imbalance, the result from one gene expression data of size  <dig> can be superior to that from another similar gene expression data of size  <dig>  this finding is very considerable and exciting.

furthermore, our results also indicate that on the unbalanced data, there have a great difference between the performances of different methods, especially on the data with heterogeneity. some previous studies  <cit>  have found that the variance   of expression values for gene j may depend on the mean expression value μi. hence, it will be very helpful to the result of analysis if a more suitable method has been selected to process the unbalanced data. for example, given an unbalanced data with unequal variances, one can improve the result of analysis if a feasible method from the six methods is selected. however, it is very likely that all six methods are not feasible for the unbalanced data and there is a requirement to find new methods more suitable to process the unbalanced data.

it should be noted that this paper does not consider the problem of determining sample size for detecting differentially expressed genes in microarray data. an interesting topic is how to assign samples between two groups in order to maximize a method performance under the constraint of the given number of overall samples n <dig> + n <dig> 

the results of this paper are based on six popular and typical methods for identifying differential expression genes including parametric method and nonparametric method. the similar effect of the sample imbalance on both kinds of methods leads us to believe that the findings in this paper should have, at least qualitatively, a comprehensive meaning. also, two proposed evaluation models can be used to compare and evaluate other methods.

CONCLUSIONS
the experiments in this paper demonstrate that sample imbalance has a great effect on identifying differential expression genes and two proposed models are effective to quantify the effect of sample imbalance. moreover, different methods have different performances on the unbalanced data and we can not find one method to be suitable for all unbalanced data in the experiments. among the six methods, the welch t-test appears to perform best when the size of samples in the large variance group is larger than that in the small one, while the regularized t-test and sam outperform others on the unbalanced data in other cases. in conclusion, two proposed evaluation models and the results provide some help in selecting suitable method to process the unbalanced data.

in future work, we will apply the evaluation models to evaluate more methods, for example the methods based false discovery rate. furthermore, we attempt to investigate the problem of determining the sample size to maximize the performance of a given differential expression genes selection method.

