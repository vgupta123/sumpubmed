BACKGROUND
consistently with the increasing availability of big data regarding biological systems, is the need of mathematical and computational models aimed at their effective analysis and interpretation  <cit> . many methodologies aim at inferring such models from the data, with the final goal of selecting a unique descriptive model for a phenomenon of interest. other techiques, instead, explore the space of all possible models via a generative approach, with the aim of identifying the common characteristics, properties and regularities of those models that are “consistent” with the data. the rationale underlying the latter approach is that, although lack of reliable data might prevent us to infer the exact true model, the statistical analysis of ensembles of plausible models can provide fundamental insights about the reference phenomenon, its origin and, in specific cases, its evolutionary history. this methodology is typical of complex systems science, which borrows ideas and techniques from statistical physics, in order to focus on the emergent dynamical behaviours and the so-called generic or universal properties of real-life phenomena, often by means of simplified mathematical and computational models  <cit> .

within this context, one of the best examples, involving genomic data, is provided by boolean models of gene regulatory networks , which have repeatedly proved fruitful in describing key properties of real systems, as well as in providing cues and hints for wet-lab experiments . the simulation of partially characterized regulatory architectures with a boolean approach, in particular, has recently gained attention . a first motivation lies in the inherently “dynamical” nature of gene regulation processes, and in the clear limitations of a “static” analysis capturing only a partial picture of such complex processes. for example, a structural analysis of the genomic interactions might preclude to determine the influence of a target-selective therapy on the overall grn interplay ruling tumorigenesis. moreover, as compared to other quantitative approaches, such as odes models , the boolean abstraction allows for a clear and effective characterization of the gene activation patterns  characterizing the different phenotypic functions, such as cell types, modes and fates, under the metaphor of “emergent collective behaviours” . in this context, phenomena such as tumorigenesis can be explained as rare emergent pattern, triggered by signals, stochastic fluctuations and biological noise .

in line with this approach, we here continue on a recent research strand that has involved the development of simulation and analysis tools for dynamical boolean grns . the foundations of our theoretical framework lay in the seminal work by stuart kauffman on random boolean networks   <cit>  and, more recently, on the dynamical model of cell differentiation introduced in  <cit>  and based on noisy random boolean networks . in this theoretical framework, cell types are associated to dynamical gene activation patterns and differentiation to cell-specific noise-resistance mechanisms, the underlying hypothesis being that such mechanisms refine along with differentiation stages . in the background section the main features of this approach are outlined.

in this paper we introduce cabernet, a cytoscape  <cit>  app to generate, import, simulate and analyse boolean models of grns. in addition to the simulation of specific regulatory architectures, a key feature of this new tool lies in the possibility of generating and analysing ensembles of grn models sharing user-defined structural and dynamical features , in order to investigate the generic properties of classes of grns, in the spirit of the previously mentioned ensemble-based generative approach. most importantly, cabernet allows to augment partially-characterized grns by adding user-defined entities and relations. the underlying motivation is that, despite the increasing knowledge on gene regulation in real organisms, the topological and functional characterization of real networks is stil far from being comprehensive, thus preventing to capture the complexity of the overall interplay. cabernet is conceived to randomly generate the missing portions of these partially-characterized grns, in order to accommodate the advantages of the ensemble when we want to study grns that share a common core and other structural and functional parameters. clearly, this shall allow to test hypotheses on the yet unknown missing portions of real networks.

in addition, cabernet guides the user through various robustness analyses of the grns, which can be matched against genomic experimental data. notice that cabernet can also generate completely random grns with defined structural and functional constraints, as well as simulate the dynamics of completely characterized grns.

the paper is organized as follows. in the background section a quick overview of the grn dynamical model is presented. in the implementation section the main features and functionalities of cabernet are described. as a proof of principle, in the results section we present the augmentation of the t-helper cell signaling network and describe the analysis of its dynamics, with particular focus on the emergent differentiation scheme and its robustness against the knockout of specific genes. conclusions are presented in the last section.

background: the grn model
in cabernet, grns are represented as noisy random boolean networks   <cit>  . canonical rbns are oriented graphs in which boolean nodes represent  genes, and edges stand for regulatory interactions, modeled as boolean functions. the dynamics of rbns is synchronous and deterministic, and the activation value of each node is updated at every discrete time step, according to a node-specific boolean function depending on the value of the input nodes. accordingly, the overall dynamics eventually ends up in  state cycles, termed attractors, which represent the emerging gene activation patterns displayed by the grn1

in the more recent nrbn model  <cit> , transitions among attractors are made possible as a consequence of random modifications of the node’s activation value, lasting a defined time span . thus, it is possible to determine the so-called attractors transition network , i.e., a stability matrix displaying the noise-induced transition probability among attractors.

in the biological metaphor proposed in  <cit> , the sets of attractors in which the dynamics can wander via noise-induced transitions  represent the gene patterns of specific cell types. besides, given that it is hypothesized that less differentiated cell types are characterized by less refined noise-control mechanisms , different thresholds are introduced to exclude those transitions that are unlikely to occur for a cell in a specific differentiation stage. accordingly, each threshold determines a set of  tess representing the distinct cell types of a specific differentiation stage, starting from toti-/multi-potent stem cells  to intermediate states, to fully differentiated cells . thus, such an emergent hierarchical structure resembles and can be compared to that of differentiation trees in real cells. notice that the approach is general as it does not refer to any specific organism .
fig.  <dig> simplified representation of the grn model in cabernet. a example rbn with  <dig> genes  and edges representing regulatory interactions . b example dynamics to highlight network’s attractors, modeling gene activation patterns a
 <dig>  …, a
 <dig>  and possible transitions among them induced by noise . c the transitions yield an attractor transition network that generates  <dig> cellular types when  <dig> thresholds, δ
i, i= <dig> , <dig> are evaluated to asses the corresponding threshold ergodic sets. in this approach, where the efficiency of noise-control mechanisms is related to differentiation types, stem cells , intermediate stages  and fully differentiated cells  emerge. the corresponding differentiation tree, is shown 



implementation
cabernet is a java tool developed as cytoscape’s version  <dig> x application; see the availability section for information about download and installation of the tool. cabernet sessions are user-defined batch computations. parameters are specified by a step-by-step wizard and various post-simulation functions are accessible directly from the cabernet menu in the cytoscape active window. the tool implements a wide range of simulation and analysis functions, which can be summarily listed as follows . instructions on obtaining and using the code used in the paper are available on the page website. tutorials include a package to reproduce the example application discussed in the paper .




input grns 
cabernet can randomly generate and simulate ensembles of grns with certain structural parameters such as:  number of genes;  ingoing/outgoing grn’s topology, e.g., fixed, erdös-rényi’s random  <cit> , barabasi-alberts’ scale-free   <cit>  or watts-strogatz’s small-world  <cit> ;  type of regulation functions . concerning the latter, these can be set by the user or randomly generated to accomodate: bias-based random functions, canalyzing  <cit>  or logical functions - expressed in the canonical and/or notation. network and simulation parameters  can be defined either via an input form or a textual file <dig> 

 grns that are characterized with respect to both the topology and the regulatory functions, can be loaded in cabernet via input textual file. limited to the network topology, cabernet can also directly import grns from any public database that cytoscape interfaces with or from any database that allow export in sbml format.

 any grn loaded in the tool  can be augmented by cabernet, by randomly generating a chosen number of augmented networks, in which entities and relations are added to the input network according to user-defined structural and functional parameters. parameters for augmentation are the same that must be defined for the random generation . the resulting ensemble of augmented networks will share the input topological and functional core and will differ for the randomly generated portion.

for instance, in the results section, the t-helper cell signaling network curated from  <cit>  , is augmented with  <dig> further nodes and  <dig> edges according to a erdos-rényi random topology. assessment of the functional effect of this augmented network is also discussed.

grn’s dynamics simulation
given that the space of the possible configurations of a nrbn can be dramatically large , cabernet can simulate the dynamics of a network by either:  uniformly sampling the initial conditions to test  or  performing an exhaustive search . cabernet allows to investigate key statistics of the emerging attractors such as, e.g., number, length, robustness and reachability. the stability of any pattern to perturbations can be assessed either via temporary flips  or via permanent gene knock-in/knock-out.

following the simulation, cabernet can compute and display the threshold-dependent atn  for specific threshold values. different views on such a network are available in the tool and, for instance, allow to display the genes’ configurations in a pattern, and the variation of the number of tess alongside thresholds, as proposed in  <cit> .

grn-selection constrained by differentiation scheme
one might look for a grn giving rise to a specific differentiation tree, as done e.g. in  <cit> . trees can be inputed to cabernet in textual format or from the cytoscape active window; cabernet can select those nrbns that display a differentiation tree structurally similar to the loaded one, where the measure of similarity is defined by the user. this feature is implemented as a batch process scanning among generated nrbns. notice that, usually, a single nrbn exhibits various emerging trees, according to the various possible combinations of thresholds thus this feature is the computationally most demanding in cabernet.

besides, the statistically representative differentiation tree of each specific network, defined as the most frequent emerging tree for different  threshold combinations, provided a specific tree depth, can be computed.

visualization
each computational task is tracked by a progress bar. once the simulation of the dynamics is completed, the powerful visualization capabilities of cytoscape can be used to analyze the topological and dynamical properties of the networks.

in particular, with cabernet it is possible to visualize:  the nrbns,  the attractor graph network, in which all the states of the attractors and the transitions among them are displayed,  the threshold dependent atns and  the representative differentiation tree. by clicking on a specific network, it gets visualized within cytoscape, so that it can be further analyzed.

different network styles have been defined and can be selected: cabernetnetwork, aimed at visualizing the properties of the nrbn: the color of each node being related to the boolean function bias and the size of each node proportional to its degree, cabernetattractors, for the visualization of the attractor graph network, cabernettes, for the visualization of the atn and cabernetcollapsed tes, for the collapsed visualization of the atn: in these last two styles, the edge size is proportional to the transition probability.

robustness analysis
different kind of perturbations can be simulated to assess the robustness of the attractors of a network. in particular, it is possible to perform a user-defined number of  temporary  or  permanent  perturbations on  a chosen number of randomly selected nodes or  specific nodes. the robustness analysis can be performed on single networks or on the whole ensemble of simulated grns.

network’s stability is assessed via robustness analyses, by means of standard measures such as avalanches  and sensitivity   <cit> . the results of the analyses can be exported in csv files.

network analysis
cabernet offers a wide range of network-specific statistics. these include  the distribution of the attractors’ lengths,  the basins of attraction,  the proportion of frozen and oscillating nodes, plus other classical network measures such as clustering coefficient, network diameter and average path length. all the statistics can be visualized and exported; further network measures are accessible via the network analysis tools included in cytoscape.

outputs
all the networks and the relative topological, functional and dynamical properties can be exported as textual files, from both the wizard and the function menu. for instance, the complete topological and functional description of the networks can be exported so that it can be used in simulation environments external to cytoscape such as, e.g., chaste  <cit> , compucell3d  <cit>  or the simulator described in  <cit>  . also, it is possible to export the complete description of all the attractor states, as well as information of their basins on attraction.

comparison with other tools
in table  <dig> the main features and functionalities of the state-of-the-art tools for the dynamical simulation and analysis of qualitative models of grns are compared, highlighting the similarities and differences and the specific relevance of cabernet. in particular, cabernet is positioned within the current landscape as a tool that do not require programming skills, by virtue of its graphical user interface and ease of usage. more precisely, cabernet is a stand-alone software that does not require internet connection nor on-line storage of personal files . among the main additional features of cabernet, with respect to the competing tools , is the possibility of either simulating specific regulatory architectures  or generating ensembles of gnrs, as typically done in complex systems and, specifically, in rbn research. furthermore, the network augmentation module is uniquely present in cabernet, as well as the grn-driven modeling of the differentiation process and the explicit representation of biological noise, as discussed in the background section.




we conclude by noting that cabernet is a follow-up of our previous software gestodifferent  <cit> , an earlier grn tool developed by our group. novelties include, but are not limited to, the following key functionalities and simulation options: the network augmentation module, the simulation of specific regulatory architectures, the possibility of querying publicly available databases, new network topologies, functions and constraints, the robustness analysis and the network structural analysis modules, new visualization styles and new i/o functions.

performance evaluation and computational complexity
in order to provide a quantitive assessment of cabernet computational performance and scalability, table  <dig> presents the results of extensive simulations on grns with different size and complexity.
the average computation time and standard deviation of  <dig> steps of the dynamics is reported for different classes and sizes of nrbns with random topology. three classes are considered: i) ordered , i
i) critical  and chaotic . four different sizes are simulated: n= <dig> , <dig> . for each class and size,  <dig> different randomly generated networks are simulated starting form  <dig> different initial conditions. the average computation time of the  <dig>  x  <dig>  is considered. simulations were performed on a macbook pro with a  <dig>  ghz dual-core intel core i <dig> processor with  <dig> mb shared l <dig> cache and  <dig> gb of ram



we also remark that it is not possible to provide a precise upper bound for the size of the networks to simulate cabernet, because, as it is known from rbn/nrbn literature, the dynamical behaviour of even small networks can be dramatically heterogeneous, strongly depending on the dynamical regime, which is defined by a series of key structural parameters . this aspect, which is particularly relevant when dealing with critical and chaotic networks, is reflected on the computation of the attractors and their stability, as well as on the optional tree-matching procedure. accordingly, computation time cut-offs can be set to avoid excessively long simulation. clearly, the generation of large ensemble of grns, as opposed to the simulation of single architectures, increases the risk of encountering a dynamically complex network. as a general comment, cabernet can generate and simulate networks with a few thousands nodes, yet networks with higher average connectivity are more likely to display very heterogeneous behaviours.

in regard to the network augmentation function, its computational complexity corresponds with that of simple incremental approaches. indeed, our general task is that of augmenting a network with n nodes and m edges, regardless its current topology, to one with n>n nodes and m>m edges. thus its cost is that of adding n−n new nodes and m−m new edges; the way we select edges determines the cabernet’s network type. no matter what, we can exploit standard generative algorithms with no computational overload <dig> 

RESULTS
our group has recently been focusing on the investigation of the dynamical properties of multicellular systems via multiscale simulations, with particular attention to the conditions that would favor the emergence and development of tumors. to this end, cabernet was recently used to generate, simulate and visualize the grns ruling the behaviour of an intestinal crypt in chaste’s multiscale simulation engine, allowing to identify conditions for cancer’s emergence and crypt’s colonization  <cit> . in the following, we propose a further example to show some of the potential applications of cabernet.

 the signaling network of human t-helper cells was recently characterized with respect to both the topology and the regulatory functions. in  <cit>  the dynamics of such network was simulated with a boolean approach and it was shown that the attractors actually reproduce real gene activation patterns of distinctly differentiated t-helper cell types.

the following paragraphs present an experiment of grn’s augmentation possible in cabernet. as far as it can be ascertained by the authors, no experiments of this sort are possible with other rbn-based tools. the final goal is to:  generate a large ensemble of random networks with the t-helper functional core,  select only those networks in which the emergent dynamical behaviour is in accordance with the hematopoietic differentiation tree, in which the t-helper cell type is supposed to be one of the leaves, and  eventually detect and analyze the generic properties of the selected networks, which result as plausible grns ruling the hematopoietic differentiation fate, specifically investigating their robustness .
fig.  <dig> dynamical simulation and robustness analysis of an augmented t-helper grn with cabernet. a the t-helper signaling network, mapped in  <cit> . edges stand for regulatory interactions, either activating  or inhibiting . the network is composed by  <dig> genes and  <dig> interactions. b the augmented nrnb that displayed a differentiation tree matching the hematopoietic one. to find it,  <dig> nrbns were randomly generated by augmenting the t-helper grn in cabernet; the augmented networks include  <dig> nodes  and  <dig> edges . the nodes are wired according to a random erdos-renyi topology, and random boolean functions with bias =  <dig>  are associated to the nodes. only matching nrbn is shown, the original core and the augmented portion of which are highlighted. in cabernet’s visualization the size of each node is proportional to its connectivity degree and the color-scale to the function bias. c the attractor transition matrix of the matching nrbn is plot by cabernet, highlighting the noise-induced transitions among attractors and the threshold ergodic sets representing cell types. the progressive splitting of the tess due to increasingly larger noise resistance-related thresholds  is shown, stressing the perfect matching between the emergent differentiation tree and that of hematopoietic cells, from multi-potent cells to fully differentiated cell types. d the differentiation tree of hematopoietic cells from  <cit>  is depicted. notice that t-helper cell type represents one of the leaves of the tree. for the description of the acronyms please refer to the main text. e configuration of the  <dig> attractors of the augmented network . in this specific case, the length of each attractor is equal to  <dig>  f robustness analysis performed via cabernet. single node knockout experiments  are performed on each node of the original core of the augmented network and the dynamics is simulated again via cabernet. the emergent tree is then compared with that of hematopoietic cells and the distribution of the similarity measure d^  is displayed, highlighting  <dig> genes that, when silenced, still lead to a matching emergent tree 



the distinct networks differ for the augmented portion, which is randomly generated with structural parameters  that are classically used in similar studies . accordingly, only certain networks will eventually display the desired emergent dynamical behavior. the underlying idea is that the matching networks might allow for the formulation of hypotheses on the missing portions of the relevant grn ruling the overall hematopoiesis process. besides, the characterization of the attractors could be matched with the real gene activation patterns driving the functioning of the various cell types <dig> 

in the experiment, a large number of distinct augmented networks was generated and simulated with cabernet: only  <dig> on a total of  <dig> augmented nrbns actually displayed the expected dynamical behavior, i.e., the correct differentiation tree, hinting at the complexity of the tuning process driven by the evolutionary pressure that led to the topology of current grns <dig> 

in fig.  <dig> one can see the original t-helper signaling network, originally mapped in  <cit> , and the nrbn that was selected as correct, in which the augmented portion is highlighted. notice that, in the augmented network, both the topology and the functions of the original core are slightly different from those of the t-helper grn, as a consequence of adding new relations linking the new and the original portions of the net. the visualization of the network is provided via cabernet, by applying the suitable styles .

in fig.  <dig> one can notice that this specific network exhibits  <dig> distinct attractors . by pruning the atn with increasingly larger thresholds, the tes at the higher level, including all the  <dig> attractors connected by noise-induced transitions and representing multi-/toti-potent cells, progressively splits in tess enclosing an increasingly lower number of attractors, up to the  <dig> tess at the lower level, which correspond to single attractors, when the threshold is equal to  <dig>  this network was specifically selected as plausible because the resulting emergent differentiation tree matches that of hematopoietic cells  <dig> 

note that, in case augmented networks were more likely to display a matching emergent tree, one may exploit cabernet to perform ensemble-level analyses on the matching set, aimed at the formulation of hypotheses on the generic properties of real networks.

a robustness analysis on the matching nrbn was also performed. by simulating selective single knockouts of the genes in the original t-helper core, we can assess the distinctive relevance in maintaining the correct differentiation scheme. in this example, we performed  <dig> single knockout experiments , by forcing the specific boolean function of each gene to inactivation , and we tried to match the resulting differentiation trees with that of hematopoietic cells. remarkably, in  <dig> cases , the ko experiment resulted in a mismatching tree, hinting at the role of those specific genes in the interplay leading to the emergence of the hematopoietic tree. the similarity among the hematopoietic tree, h, and a tree t resulting from a ko experiment was measured as follows: 
  d^h=∑l=0l∗∑k=0k∗|nh−nt| 

where l∗ and k∗ are the maximum depth and the maximum number of a node’s children in both h and t. function nx returns the number of nodes at level l with k children in tree x; thus, this quantity measures the structural level-by-level similarity of two trees by assessing the number of parents with k children, per level. since we focus on differentiation trees, this can be interpreted as a measure of the ability of a certain cell type, a progenitor, to differentiate in a set of distinct subtypes.

in fig.  <dig> we show values of d^ in our experiments; the lower the value the closer is t to h. values of d^ range around  <dig>  with a maximum of  <dig> and minimum 0; in  <dig> cases, the value lower than  <dig> suggests a close similarity between the emergent and the hematopoietic tree. besides, the dynamics turned out to be completely insensitive  to the ko of  <dig> specific genes, i.e., cre, ca, plcg-a, fos and gads, which, accordingly, might be not relevant in the differentiation process. clearly, further investigations are needed to corroborate this hypothesis.

we finally remark that the generated networks could be used within any multiscale simulation frameworks, in order to investigate, e.g., the processes of homeostasis and clonal expansion, as proposed in  <cit> .

CONCLUSIONS
in this work we introduced cabernet - a new cytoscape app for the generation, simulation and analysis of augmented boolean models of gene regulatory networks - and described some of its key functionalities, as well as an example application to real grn data.

cabernet is the result of a long-time effort aimed at bridging different fields and disciplines, such as computer science, statistics and complex systems science, for the effective study of complex biological systems. the numerous modeling and simulation functionalities, the various effective analysis tools and the fine integration within the widely used cytoscape framework, might settle the ground for cabernet becoming a powerful instrument for bioinformaticians and computational biologists, especially in providing a computational support for experimentalists.

in particular, cabernet can provide an essential tool to effectively investigate key and still partially undeciphered biological phenomena, such as, e.g., gene regulation, cell differentiation and tumorigenesis, with particular focus on the properties of dynamical gene activation patterns and their relation with biological noise.

availability and requirements
project name:cabernet: a cytoscape app for the generation and the analysis of boolean models of gene regulatory networks version:  <dig>  plugin website:http://bimib.disco.unimib.it/index.php/cabernetoperating systems: platform independent software requirement: cytoscape  <dig> x  programming language: java license: bsd-like license 

endnotes
 <dig> we remark that one of the key advantages of employing a boolean modeling approach lies in the possibility of including entities involved in the regulatory interplay other than genes and proteins, such as, e.g., non coding rnas. in fact, any gene product can be considered as a boolean entity  interacting with other genes/products. for instance, mirnas - non coding rnas characterized by inhibitory functions that are able to modulate gene expression and are supposed to confer robustness against biological noise - might be represented by associating a canalyzing inhibitory function  <cit>  to their target genes.

 <dig> an extension of the software to import/export grn models in the sbml qual file format  <cit>  is currently underway.

 <dig> erdos–renyi random network are generated regardless the initial structures. for the barabasi-albert preferential attachment model the initial network determines the attachment probability, via the degree. for the power-law network, we sample the number of edges to assign to each node from a power law, and augment the original network accordingly. for the small word, we operate similarly. constraint such as fixing the number of edges for a node can be set with no computational overload of this generative procedure – see the manual for details.

 <dig> notice that the quest for an effective characterization of the relation between the functional modules of biochemical networks  and the phenotypic functions, in normal and aberrant cells, is nowadays central in biomedical research. this is not in contrast with the complexity of the regulation/differentiation complexity, whereas, instead, highlights the importance of the evolutionary pressure-based mechanisms that led to the specialization, modularization, hierarchical organization and plasticity of current grns. to this end, cabernet can provide an effective instrument to investigate the properties of such modules, as in the presented example.

 <dig> the analysis of the possible relation between the topology of the augmented portion, e.g., random, scale-free or small-world, and the likelihood of displaying the correct differentiation tree could be easily performed with the tool. we leave this interesting further application of cabernet to future works.

 <dig> the hematopoietic differentiation scheme is characterized by a multi-potent progenitor , with the potential to differentiate into two lineages, i.e., common myeloid progenitor  and common lymphoid progenitor . cmp further divide into megakaryocyte-erythroid progenitor  and granulocyte/monocyte progenitor , finally committing to mature blood cells including erythrocytes , megakaryocyte , monocyte  and granulocytes, i.e. neutrophils, eosinophils, basophils . conversely, clp further differentiate into b-cell progenitors  and t-cell and natural killer cell progenitors , with a final commitment to mature b cells , t cells  and nk cells   <cit> .

competing interests

the authors declare that they have no competing interests.

authors’ contributions

ap, ag, gc, cd, gm and ma developed the theoretical framework and conceived the idea for the plugin. ap, ag, gc designed the software architecture. ap implemented cabernet, under the supervision of ag, gc and cd. ap, ag and cd ideated and performed the application example. ag wrote the paper. gm and ma supervised the project and coordinated the research team. all authors read and approved the final manuscript.

