BACKGROUND
direct in vivo investigation of human metabolism is complicated by the distinct metabolic functions of different sub-cellular locations. for example, lysosomes are organelles containing digestive enzymes that break down polymeric macromolecules into their smaller building blocks. the lysosome membrane enables an acidic internal environment  to maximize the enzyme activities  <cit> . due to localization of metabolic enzymes, many metabolic processes involve coordinated interactions between different organelles, and one metabolic step may be dependent upon the successful completion of the previous step. for example, the decomposition of very long chain fatty acids  is a process shared by peroxisomes and mitochondria. likewise, the final steps in the synthesis of plasmologens occur in the endoplasmic reticulum, but the process depends on precursors which are synthesized in peroxisomes  <cit> . at the regulation level, the efficacy of many cellular processes is dependent on proper regulation of proteins trafficking to and from their site of action. the endoplasmic reticulum  and golgi apparatus  are known as the main organelles for protein targeting or protein sorting which transport proteins to the appropriate locations inside a cell or outside of it  <cit> . therefore it is quite usual that an enzyme synthesized in er may be active only in another sub-cellular location. in addition, diverse micro-environments in different organelles may lead to distinct functions of the same enzyme. for example, acid ceramidase  is the lipid hydrolase responsible for the degradation of ceramide into sphingosine and free fatty acids within lysosomes. however, at higher ph in the cytosol ac can also synthesize ceramide from sphingosine and free fatty acids  <cit> . reduced lysosomal ac activity causes farber disease, which is a member of a group of diseases called lysosomal storage diseases  which results from defects in lysosomal enzyme function  <cit> . therefore, determining the location of enzymes and reactions is important for the investigation of the mechanism of a metabolic process and its related diseases. currently there are two high quality literature based human metabolic networks available, the edinburgh human metabolic network  reconstructed by our group  <cit>  and the human recon  <dig> reconstructed by palsson's group  <cit> . human recon  <dig> contains eight sub-cellular locations while ehmn did not include location information  <cit> . localization of reactions in human recon  <dig> was determined from "protein localization data, sequence targeting signals, and indirect physiological evidence". if these data were unavailable, reactions were assigned to cytoplasm   <cit> . as mentioned in our previous paper, ehmn is a more complete network with  <dig> more reactions and  <dig> more metabolites  <cit> . therefore, it is valuable to ehmn to include the information on sub-cellular location distribution of proteins and reactions. in this work, we chose  <dig> locations for enzyme proteins mainly based on information from go   <cit> . the localization of reactions was initially determined by protein locations and then the gaps and isolated reactions in the preliminary compartmentalized network were examined and revised based on information from literature. by integrating the protein location information and the reaction  location information, we also corrected hundreds of wrong protein-reaction relationships in ehmn. furthermore, over  <dig> transport reactions were added in order to obtain a connected compartmentalized network. the metabolic pathways for the synthesis and degradation of dozens of metabolites were investigated to validate the reconstructed network.

RESULTS
 <dig>  localization based on protein location
 <dig>  protein location information
there are  <dig> human proteins associated with one or more go  terms in the "cellular component" part. they were classified into the eight selected high level locations including: cytosol, nucleus, endoplasmic reticulum , golgi apparatus , peroxisomes, lysosomes, mitochondria and extracellular . proteins associated with "cell part" or some other locations not within the above eight locations were assigned to "uncertain". from swiss-prot keywords we obtained location information for  <dig> human proteins and among them  <dig> proteins have no clear location information from go. in the case that a protein has different locations in the two resources, we choose to assign the protein to all the locations. altogether we obtained location information for  <dig> human proteins and  <dig> of them are in ehmn . the high number of proteins allocated to "uncertain" reflects the fact that our knowledge on protein location distribution is still very limited.

 <dig>  sub-cellular localization of reactions
the reactions in ehmn were assigned to different locations based on the protein-reaction relationships and the obtained protein location information. there are also  <dig> non-enzyme catalyzed  reactions and  <dig> reactions with unknown protein location information. they were assigned to "uncertain" location by default. in this way all the reactions in ehmn were assigned to the  <dig> locations and their distribution is shown in table  <dig> 

it should be noted that one reaction may be catalyzed by different enzymatic proteins and these proteins can be in different locations. for example, r <dig> -malate + nad+ = oxaloacetate + nadh + h+) can be catalyzed by two proteins: mdh <dig> and mdh <dig>  which function in cytosol and mitochondria respectively. figure  <dig> shows a summary of  <dig> different types of protein-reaction-location relationships: one reaction may be catalyzed by one  or multiple proteins. when a reaction is catalyzed by multiple proteins, these proteins can be active in the same  or in different locations. for example, r <dig>  is catalyzed by two proteins: gls <dig> and gls <dig>  they both function in mitochondria but in different organs   <cit> . r <dig> mentioned above belongs to type c where two proteins are in totally different locations. there are also cases in which some proteins for one reaction may have common locations but some of them may also have their unique locations . for example, r <dig>  <dig>  <dig>  <dig> = udp +  <dig>  <dig> 1) is catalyzed by proteins mgat4a, mgat4b and mgat4c. they all exist in ga but mgat4a can also be secreted to extracellular space. however, the expression locations of these enzymes in tissues are somehow different although they have the common sub-cellular locations in cells. mgat4a and mgat4c are expressed in almost totally different organs. whereas mgat4b is widely expressed in many human tissues and highly over-expressed in pancreatic cancer  <cit> .

we paid special attention to type c in the four types. proteins catalyzing the same reaction in different locations are called "complementary proteins" in the study. we identified  <dig> such complementary protein groups . the two most common cases are:  the proteins are in the cytosol and mitochondria respectively ;  the proteins are in peroxisomes and mitochondria respectively. most of the protein groups in case b are involved in lipid metabolism and often catalyze a large class of reactions. as reported in literature, peroxisomes are the main places for the oxidation of vlcfas  <cit> . therefore the protein location information may be used to identify the correct reactions catalyzed and thus improve the annotation of the protein-reaction relationships in ehmn. for example, re <dig>  is a step in beta-oxidation of omega- <dig> fatty acid, which is a family of long chain and very long chain unsaturated fatty acids and their oxidation was known to take place in peroxisomes  <cit> . re <dig> is associated with four proteins  in ehmn. however, only acaa <dig> is in peroxisomes and the other three are mitochondria proteins. therefore, the relationships between re <dig> and the three mitochondrial proteins in ehmn are wrong and should be corrected. using this method, we have removed  <dig> incorrect protein-reaction relationships .

 <dig>  location revision based on pathway connectivity analysis
according to the location of the reactions, we obtained the reaction location distribution for all the pathways in ehmn . we found that there are many poorly-studied pathways in which the number of reactions in any one specific location  is less than one quarter of the total number of reactions in the pathway. this rather patchy feature of the localized network indicates that the location information from go and swissprot is still quite limited and more information is needed to improve the network for functional analysis. as the first step, we tried to improve the network connectivity by identifying the gaps or isolated reactions in the localized network by network structure analysis.

from additional file  <dig> we can also see that there are many cases in which only one isolated reaction in a pathway exists in one location. even when there are several reactions in a pathway in the same location, they may be separated by a reaction in another location  as shown in figure  <dig>  we need to address these issues to improve the quality of the compartmentalized network.

 <dig>  gap filling
as depicted in figure  <dig>  a gap is a reaction which is in a different location with its two neighbour reactions in a pathway. details about the methods for gap identification can be found in the methods section. altogether we found  <dig> gaps from  <dig> reactions in the  <dig> pathways . interestingly, a major part of the gap reactions  are in "uncertain". we directly assigned these reactions to the corresponding location to fill the gaps. this gap filling method is similar to previous approaches to identify the gaps in a reconstructed metabolic network for searching the missing genes/enzymes in pathways  <cit> . now we applied this connectivity-based gap filling method to the localized network, thus complementing the patchy location data obtained solely from protein location information.

for the  <dig> gaps whose gap reactions are not in "uncertain", we used the information from the literature to decide whether we should assign the gap reaction to the corresponding location or not. only those with positive evidences in the literature to support the existence of a gap reaction in the missing location were filled. due to the limited research on reaction location, we only found  <dig> gaps with positive evidence in the literature. for example, r <dig>  was identified as a gap in extracellular whereas dolcetta et al  <cit>  reported that the corresponding protein galc actually catalyzed the reaction in the extracellular space. for the other  <dig> reactions, we found some new proteins that can catalyze the reaction in the missing locations. for example, one of the gaps in the di-unsaturated fatty acid beta-oxidation pathway in peroxisomes can be filled by adding reaction re <dig> . in ehmn, this reaction is catalyzed only by protein acadl which is active in mitochondria. however, bode and couee  <cit>  reported that two peroxisomal proteins: acox <dig> and acox <dig> have the same catalytic activity as acadl. therefore, re <dig> is catalyzed by acox <dig> and acox <dig> in peroxisomes. in this case, we updated ehmn by adding the protein-reaction relationships to the database. altogether we added  <dig> protein-reaction relationships from literature and  <dig> gaps were filled, including  <dig> gaps from reactions with "uncertain" location and  <dig> gaps from reactions with other clear locations. the distribution of the reactions in each location after gap filling is shown in table  <dig> 

 <dig>  isolated reactions
gap filling may join some isolated reactions in a location together. however, even after gap filling, there are still some isolated reactions as not all reactions can be linked by a gap reaction. as for the gap definition, isolated reactions are also location-specific. one reaction may be isolated in two different locations. it can also be an isolated reaction in one location but not isolated in another location. more precisely it should be called an isolated reaction-location relationship . altogether we obtained  <dig> irlrs by identifying the one-node connected components in the location-specific pathway graph and investigating them carefully in the literature. we found that some of them are wrong because of  incorrect reaction location annotation;  incorrect protein-reaction relationship in ehmn. in the first case, the existence of a protein in a location does not mean that the catalyzed reaction occurs in that location because the protein may be not active. for example, r <dig>  in the phytanic acid peroxisomal oxidation pathway is catalyzed by protein slc27a <dig> which exists in both peroxisomes and endoplasmic reticulum  <cit> . however, many researches  <cit>  reported that the oxidation of phytanic acid takes place in peroxisomes but not in endoplasmic reticulum. the activity of slc27a <dig> in endoplasmic reticulum may be involved in the bile acid biosynthesis pathway to catalyze r <dig>    <cit> . an example of the second case is r <dig> , a galnac transformation reaction. in ehmn the corresponding protein for this reaction is mgea <dig>  however, the description of the function of mgea <dig> in swiss-prot is "it cleaves glcnac but not galnac from glycopeptides". therefore the annotation for mgea <dig> in ehmn was wrong and should be corrected. altogether  <dig> protein-reaction relationships were deleted in this way.

for some isolated reactions, we found positive evidence in the literature. for example, the l-pipecolic acid oxidation reaction r <dig>  should occur in human peroxisomes. its deficiency in this location will cause a disease belonging to a group of disorders called peroxisome biogenesis disorders   <cit> . even though it is the only reaction in lysine metabolism which occurs in peroxisomes, its location should not be changed, especially considering that oxygen is a reactant in this reaction. there are  <dig> such cases in our network. it is very likely that these reactions may be linked with other parts of the network through transport reactions.

we did not find any related literature for more than 80% of the irlrs. in this case, we decided to keep an irlr if the corresponding protein exists only in that location and it does not catalyze other reactions. as discussed above, if the protein exists in several locations, it may be inactive in the isolated location. alternatively, if a protein catalyzes several reactions, it may imply that the protein may prefer to catalyze the other reaction rather than the isolated one. for example, reaction r <dig>  <dig>  <dig>  <dig>  <dig> =  <dig> udp +  <dig>  <dig>  <dig>  <dig> 1) in the n-glycan biosynthesis pathway is an isolated reaction in the cytosol. protein b4galt <dig> is the protein related to this reaction in the cytosol but this protein also functions in extracellular and ga where it is connected with other reactions. in addition, b4galt <dig> is responsible for the synthesis of complex-type n-linked oligosaccharides in many glycoproteins. therefore, even if b4galt <dig> has activity in the cytosol, its function may not be for reaction r <dig> but for some other reactions. accordingly, the location annotation of r <dig> in the cytosol was deleted. however, further experimental studies would be needed to validate such predictions. in all the  <dig> isolated reaction-location relationships,  <dig> of them were revised, including  <dig> revised because of incorrect protein-reaction relationships and  <dig> without any related literature citations. the distribution of reactions in each location is shown in table  <dig> 

 <dig>  literature-based revision
the objective of gap filling and irlr revision is to make the compartmentalized network more amenable for further network analysis and functional analysis. however, even after such structure-based revision, there are still many pathways in which the number of reactions in any one specific location  is less than one third of the total number of reactions in the pathway. to further improve the usability of the network, we manually examined the location distribution of all the pathways in ehmn, with a focus on pathway level, to check the literature for location information about a biological process including a series of reactions.

although in total such information is still limited, we did find evidences in textbooks or in the literature for a number of pathways. in addition to the well known mitochondrial occurrence of the tca cycle pathway, many studies are focused on the location of fatty acid beta-oxidation pathways. three main criteria were used to decide the location of the beta-oxidation reaction. firstly, it was reported that very long chain  fatty acids underwent initial oxidation in peroxisomes which ceases at octanyl coa and was then followed by mitochondrial oxidation  <cit> . thus, the length of fatty acid chain can be considered as a rule to distinguish between beta-oxidation in mitochondria and in peroxisomes. secondly, oxidation reactions coupled with atp should occur in mitochondria while those coupled with h2o <dig> should be in peroxisomes  <cit> . the third criterion is the knowledge on the location of some specific metabolites. it has been reported that stearic acid and palmitic acid are oxidized firstly in peroxisomes to octanyl coa and then oxidized in mitochondria. the unsaturated fatty acids  can be oxidized in both peroxisomes and mitochondria  <cit> . according to the above criteria, the locations of  <dig> reactions in the beta-oxidation pathways were revised. due to the revised reaction location, the incorrect protein-reaction relationships were also corrected. for example, the location of r <dig>  was revised from both peroxisomes and mitochondria to peroxisomes only because it is a step in the degradation of palmitic acid in peroxisomes before ceasing at octanyl coa. in ehmn, r <dig> is linked with two proteins: mecr in mitochondria and pecr in peroxisomes. the mecr-r <dig> relationship can therefore be deleted because the reaction only occurs in peroxisomes. in this way, a total of  <dig> protein-reaction relationships were deleted in the beta-oxidation pathways. we also revised the location information for  <dig> reactions in other pathways  based on evidences from textbooks or the literature and more than  <dig> incorrect protein-reaction relationships were deleted . the reaction distribution in each location is shown in table  <dig> 

the limited knowledge on sub-cellular location information from databases was remedied to some extent by the revisions described above. the valine, leucine and isoleucine degradation pathway is shown in figure  <dig> as an example to illustrate how the quality of the localized network was improved. firstly, in the step of revision of type c reaction, the location of r <dig>  was revised from both mitochondria and peroxisomes to only mitochondria according to its chain length. subsequently, in the gap filling step, we found that r <dig>  and r <dig>  in this pathway were in two different components in mitochondria, respectively. these two reactions can actually be connected by r <dig>  whose original location is "uncertain". therefore r <dig> was classified as a gap reaction to fill the gap between r <dig> and r <dig>  with this gap filled, the l-leucine degradation pathway in mitochondria was completed. similarly, we found that the three reversible transamination reactions catalyzed by branched-chain amino-acid aminotransferase : r <dig> , r <dig>  and r <dig> , were isolated reactions in the nucleus. two bcats exist in mammalian cells: bcatm in mitochondria and bcatc in the cytosol. bcatm functions in brain and kidney while bcatc is ubiquitous in most human tissues  <cit> . therefore, this step can occur in both mitochondria and cytosol but not in the nucleus. therefore we revised the locations of these three reactions to cytosol and mitochondria. in addition, hutson et al reported that all the steps which commit the bcaa carbon skeleton to the degradation pathway take place in mitochondria  <cit> . based on this information, eight reactions in the degradation pathway , which also exist in several other locations besides mitochondria , were relocated to be exclusively in mitochondria. from this example, we can see that the structure-based and literature-based revisions do greatly improve the location distribution of the pathways.

 <dig>  transport reactions
it is important to include transport reactions between different compartments in a localized network in order to make the network connected. it is unreasonable to add a transport reaction involving the "uncertain" location. therefore we assigned all the reactions with "uncertain" location to cytosol as that used in recon  <dig>  <cit> . as recon  <dig> already included transport reactions, we first took it as a reference to add the transport reactions to our network. there are  <dig> transport reactions in recon  <dig> and  <dig> of them are for metabolites that are also in ehmn. among the  <dig> reactions, only  <dig> reactions that are based on biochemical or genetic experiments  were directly added into ehmn. for the  <dig> reactions based on physiological data or biochemical/genetic evidence from a nonhuman mammalian cell , a transport reaction was added only if the corresponding metabolite exists in both compartments involved in the transport reaction. the reactions with confidence score less than  <dig> in recon  <dig> were ignored because those reactions were added merely based on in sillico simulation. finally  <dig> transport reactions were added from recon  <dig> and  <dig> of them are related with  <dig> transport proteins.

at the second step, we searched human transport proteins in transportdb  <cit>  and all the proteins with gene ontology annotation go:  <dig>  in uniprot. there are over  <dig> transport proteins obtained from the two resources. however, a large number of the proteins are ion channel related proteins or proteins annotated based on sequence similarity but without clear substrate information. excluding the  <dig> transport proteins already obtained from recon  <dig>  only a small proportion of the transport proteins were investigated to add corresponding transport reactions based on information from the databases and literature. altogether  <dig> new transport reactions from  <dig> transport proteins were added to ehmn. some of them are actually also in recon  <dig> but with a low confidence score and without assigned transport protein.

after adding  <dig> reactions based on recon  <dig> and transporter information from databases and literature, there are still many gaps between different compartments in the network mainly because of our limited knowledge on the function of transport proteins and the existence of non-protein required transport reactions. to make the network connected and thus amenable for pathway analysis, we calculated the "dead ends" in each location for each pathway  and tried to link the dead ends in different locations by adding new transport reactions. a dead end was defined as a metabolite that is only produced or consumed in a location. if a dead end metabolite is also appeared in other locations then transport reactions are added for it. by default, cytosol was used as a bridge to connect other locations and transport reaction to/from cytosol were added for the dead end metabolites. altogether  <dig> transport reactions were identified for the dead end metabolites. among them,  <dig> reactions were already added in the first two steps . therefore  <dig> new transport reactions were needed to make the network connected. it should be noted that the reactions added solely based on dead end analysis are of low quality and the existence are subjected to further experimental investigation. among these reactions,  <dig> are between cytosol and nucleus which actually can be carried out by the nuclear pore complexes formed by the  <dig> nucleoporin proteins in human  <cit> .

as a summary  <dig> transport reactions were added to the network and  <dig> of them are associated with transport proteins. the whole network containing  <dig> reactions is available at http://www.ehmn.bioinformatics.ed.ac.uk and free for academic use.

 <dig>  comparison of ehmn with other human metabolic networks
besides ehmn and recon  <dig>  human metabolic networks are also available from reactome  <cit>  and humancyc  <cit> . humancyc is a computationally reconstructed network including  <dig> reactions . however there is no location information for reactions included in humancyc. therefore, we mainly compared the two compartmentalized human metabolic networks  with ehmn. reactome contains both metabolic pathways and signal pathways. only the  <dig> reactions in the  <dig> metabolic pathways were extracted . reactions in recon  <dig> were obtained from the bigg database. the numbers of reactions in different compartments of the three networks are shown in table  <dig>  it can be seen that comparing with ehmn and recon  <dig>  the human metabolic network from reactome is small. especially the reaction information in the compartments other than cytosol and mitochondria is rather patchy. due to the different compound names used in the three networks, it is very difficult to check which parts of the network are common in all three networks. actually by matching the compounds through common kegg compound ids or exact name we only found  <dig> common compounds between ehmn and reactome and  <dig> between ehmn and recon  <dig>  to match reactions between two networks all the reactants involved in the reaction need to be matched. therefore we got even smaller numbers of matching reactions . many of the common reactions are in the central pathways, nucleotide metabolism and metabolic pathways for some amino acids. however, the small number of found common reactions makes it very difficult for a comprehensive comparison of the networks. generally, ehmn has more metabolic reactions which are allocated to clear locations  than recon  <dig>  by comparing the pathway maps of recon  <dig>  and those from ehmn http://www.ehmn.bioinformatics.ed.ac.uk/pathway/, we can find that many reactions in the lipids metabolism pathways  in ehmn are missing in recon  <dig>  there are also some reactions which are in both networks but are assigned to different locations. for example, r <dig>  is a step of saturated fatty acids beta-oxidation pathway after octanyl coa, which is localized to mitochondria in ehmn but not in peroxisomes according to literature  <cit> . in recon  <dig>  however, this reaction occurs in both peroxisomes and mitochondria. r <dig>  was assigned to cytosol, ga, er and mitochondria in ehmn whereas it is only in cytosol and mitochondria in recon  <dig>  the extra locations of ga and er in ehmn are based on the new evidence that the corresponding enzyme irp <dig> is also in the two locations  <cit> .

a the numbers is based on the data downloaded from bigg database and may be different from those in their published paper. b the metabolic reactions from reactome include metabolism of amino acids and derivatives, carbohydrates, nitric oxide, nucleotides, polyamines, porphyrins, vitamins and cofactors, pyruvate and citric acid cycle, lipids and lipoproteins, energy, biological oxidations and electron transport chain. the transport reactions include membrane trafficking and transmembrane transport of small molecules pathways. c the number in the parentheses includes the reactions which were assigned to "cytosol" from unclear location or locations other than the chosen ones. d the number in the parentheses includes the reaction which are assigned to "cytosol" from "uncertain". e a reaction occurs in different locations was counted only once. f the number in the parentheses includes the exchange reactions.

 <dig>  function analysis of the compartmentalized ehmn
to validate the reconstructed network, we have systematically analyzed the pathways for the synthesis and degradation of certain key metabolites using a newly developed pathway analysis tool . around  <dig> metabolic conversion processes were examined including the synthesis and degradation of amino acids, ribonucleotides, deoxyribonucleotides, fatty acids, sterols, glycans, prostaglandins and heme . all the pathways can be visually inspected through the hyperlinks in the additional file. actually, pathways between any two metabolites can be checked through the pathway analysis tool and this tool has been used in manual examination of our network. in most cases, the synthesis/degradation pathways found are in consistent with those reported in literature or textbooks. taking the synthesis of heme as an example , l-serine is synthesized in the cytosol and then transported into mitochondria for the production of 5-aminolevulinate. then 5-aminolevulinate is transported back into the cytosol for the further synthesis of coproporphyrinogen iii. the final steps from coproporphyrinogen iii to heme take place in mitochondria again  <cit> .

CONCLUSIONS
a compartmentalized human metabolic network has been reconstructed by adding the sub-cellular location information to enzymes and reactions in ehmn. network structure analysis and manual curation of literature were used to improve the quality of the localized network which was mainly based on protein location information. transport reactions were added to obtain a connected sub-cellular location specific metabolic network. the refined network was validated by in silico investigation of the metabolic functions for the production/degradation of certain important metabolites.

