BACKGROUND
by measuring the abundance of tens of thousands of mrna transcripts at once, dna microarrays have become an important laboratory tool for analyzing gene expression and its regulation over a wide range of conditions and cell types. since their introduction in  <dig>  <cit> , microarrays have measured expression in both large-scale multi-condition assays as well as individual condition queries. though multi-condition analyses are most well known, individual condition queries are common, as most labs are interested in one or a few phenotypes and cannot afford to test all possible perturbations of a given cell type or organism. in particular, microarrays are often used to detect differentially expressed  genes – which are defined here as genes whose transcripts are expressed at different levels between two conditions. in this work we consider differential expression to be a binary state; to estimate this state we ask whether the level of measured expression of each gene in the two conditions is significantly different.

unfortunately, even though limiting the number of tested conditions simplifies the experimental protocols, it also creates a problem. typically, only a small number of genes are differentially expressed between two conditions; it therefore becomes difficult to separate the biologically relevant genes from the vast majority of genes that are unchanged or whose changes are artifactual. this stems in large part from the inherent noisiness and often poor reproducibility of the microarray assay, especially with respect to genes expressed at low levels  <cit> . in addition, though differential expression  is a binary characteristic, some genes undergo a greater fold change increase/decrease than others. it is relatively easy to detect differentially expressed genes with large changes in expression; the challenge is detecting those genes that exhibit a statistically significant but small fold change. importantly, there is no guarantee that the most biologically relevant genes are those with the most extreme changes in expression; indeed, "innocent bystander" expression changes – unrelated to the phenotype of interest – may dilute the signal of the assay  <cit> . the difficulty in sensitively detecting expression changes is in part a result of methods that treat each transcript on the chip as an independent biological and statistical entity  <cit> . examples of such methods include the t test, sam, and the b statistic  <cit> . yet it is widely accepted that gene products act together in networks to carry out their functions  <cit> . although our knowledge of these networks is incomplete, it is attractive to have methods that use this information.

experimental approaches to these analysis challenges include performing more biological replicates and validating results using more precise assays such as qrt-pcr or protein quantification, but the former solution has a practical limit  <cit>  and both approaches are resource-limited. therefore, informatics solutions offer an opportunity to leverage dependencies and functional relationships between genes to better identify de genes. lu, liu et al. use a multivariate statistic to test for de genes, though the dependency information here comes only from the microarray data and ignores additional known biology  <cit> . more commonly, researchers use methods that incorporate prior biological knowledge into microarray analysis to enhance the experimental signal. the knowledge can come from other high-throughput genomic assays, like chromatin immunoprecipitation or protein-protein interaction assays, or more commonly, from gene functional annotation, like gene ontology terms  <cit>  or kegg pathway information  <cit> . of these methods, nearly all sacrifice resolution at the de gene level in favor of aggregated statistics associated with the presumably more robust de "gene group" level. thus, several statistical approaches seek enrichment of gene groups in the high or low scoring end of a ranked list derived from a single condition microarray  <cit> . the latter three methods have the advantage of not requiring an arbitrary cut-off of significant vs. non-significant genes, and all methods have been used with some success in detecting de gene groups. however, there are certainly situations where gene-level resolution is more useful than gene group resolution, such as a search for candidate genes or potential biomarkers. while the members of the highest scoring gene groups can be a source of high scoring genes, it is not clear how to consistently compare the significance of genes from different groups. additionally, certain forms of biological knowledge, such as binary protein-protein interaction data, are not easily amenable to methods requiring discrete gene groupings.

thus, we need a formal, consistent method to incorporate known biological relationships with gene expression data to identify differential expression at gene-level resolution. such an approach should yield more accurate and reproducible identification of de genes than would be possible with any data source alone or with a less sophisticated data integration strategy. one such method, generank  <cit> , uses the same principles as google's pagerank algorithm  <cit>  to rank differentially expressed genes based on gene expression data and prior biological knowledge. this method relies on a parameter d, which governs the relative weight given to knowledge versus expression data. the authors of generank suggest setting d to  <dig>  for general use, but it is clear even in simulated studies that the optimal choice for this parameter varies by dataset and there is no obvious way to choose such a value. in addition, the method validation used simulations and perturbations of existing data; thus it is not known how well the approach would work in a traditional unsupervised learning task with a proper gold standard.

in this paper, we develop, implement, validate, and apply to an experimental dataset m-bison , a formal probabilistic model that integrates biological knowledge with microarray data to better identify de genes. our model lets us assess the significance of each gene's difference in measured expression level between the conditions of interest, accounting for experimental noise and expected correlations in expression with other genes based on biological knowledge. m-bison relies on two parameters, α and α, and we introduce a strategy to choose these parameter values. we use a simulation study to establish the limits of m-bison's ability to improve results, both in terms of microarray data accuracy and knowledge structure. we then apply the method to a real world biological dataset by predicting heat shock-related de genes from a saccharomyces cerevisiae hsf <dig> mutant microarray dataset  <cit> , conserved yeast dna sequence motifs  <cit> , and a gold standard based on hsf1p chromatin immunoprecipitation assays  <cit> . in so doing, we assess the accuracy and interpretability of m-bison's predictions, and we compare m-bison's performance to that of generank.

RESULTS
simulated data
we simulated six  <dig> gene microarray datasets with either  <dig> or  <dig> de genes  and nine knowledge sources  with a variety of configurations for a total of  <dig> data-knowledge combinations . we ran m-bison on each of these  <dig>  using a grid of parameter values composed of all pairwise combinations of {αi}, ranging from  <dig> to . <dig>  and {αj}, ranging from  <dig> to . <dig>  both in . <dig> increments . for each run at each parameter combination αt= t, we used the resultant de scores b* compared to the known truth to estimate an area under the curve  of the receiver operating characteristic  curve. figure  <dig> displays the results for all data-knowledge sets. with all but one of the  <dig> , m-bison at one or more parameter combinations yields a higher auc than what is achieved using microarray data alone in conjunction with the b statistic  <cit>  .

it is clear from figure  <dig> that the optimal parameter values vary for different data-knowledge combinations. as detailed in the methods section, standard parameter estimation approaches were not successful in yielding good performance, so we implemented an empirical approach to combine results from a large number of runs using different parameter combinations. we used this approach on each of the  <dig> simulated data-knowledge sets, this time on a grid where both {αi} and {αj} ranged from  <dig> to . <dig> in . <dig> increments. in this case the scores pmin⁡∗ were used to estimate auc of the roc curves. figure  <dig> shows a comparison of the performances of these scores, the b* generated using optimal parameter values, and the b statistics from microarray data alone. using the empirical approach, m-bison achieves higher aucs than auc <dig> for a defined subset of the simulated data+knowledge sets. in particular, our approach performs best when the array data are noisiest , the number of truly de genes is low , and when the knowledge imparts a high relative connectivity  and mean degree among de genes . these are precisely the conditions for which m-bison was developed.

yeast dataset validation
we tested m-bison on a yeast microarray dataset querying the response to a c-terminal regulatory domain mutation of the hsf <dig> transcription factor  gene and knowledge consisting of genome-wide conserved intergenic motifs . the domain disrupted by the hsf <dig> mutation is known to affect the transcription of hsf1p targets  <cit> , so the comparison between wild type and mutant represents an individual condition query for which m-bison was developed. the collection of motifs is likewise relevant, because hsf1p recognizes its targets through a conserved upstream motif  <cit> . we treated physical binding sites of hsf1p as a silver standard for de genes. clearly direct targets of hsf1p should be affected by the hsf <dig> mutation, although this standard will miss other genes whose regulation is downstream of the physical targets. thus the standard will be better at confirming positive predictions than disproving them. we chose a grid of parameter values that was slightly wider than that used on the simulated data, and for each combination we calculated both standard auc and partial auc at a false positive rate of  <dig>  . figure  <dig> displays the results for both measures. m-bison with a large range of parameter values yields better auc/pauc. <dig> values than the b statistic with microarray data alone, and a subset of this range yields both maximal auc and pauc. <dig> 

next, we tried the empirical method on the yeast data and knowledge, using the same size grid as in figure  <dig>  the resulting roc curve is displayed in figure  <dig>  along with the curves for an optimal single parameter combination run of m-bison , the microarray data alone with b statistic, and the knowledge alone . empirical m-bison gives the best performance, at a substantial auc improvement over microarray data or knowledge alone.

a closer look at the true positive genes with the highest scores reveals that using the b statistic with microarray data alone, single parameter m-bison, or empirical m-bison leads to somewhat different answers. figure  <dig> shows lists of true positives  in the top  <dig> scoring genes for each of these three approaches along with their associated biological knowledge. motifs colored orange or red are related at least peripherally to heat or stress response. we also looked in detail at the top  <dig> high-scoring genes of the b statistic and single parameter m-bison for genes involved in stress or heat response. figure  <dig> shows these two lists.

comparison to related method
differential expression stories
we chose to further explore m-bison's impact on two intriguing genes from the hsf <dig> datasets in the context of their biological knowledge. we created a "differential expression story" for each gene, which displays m-bison's effect on the gene of interest and all knowledge-associated genes, along with all of their connections. figure 9a shows the de story of yor020c , an hsf1p-bound gene and the highest-scoring true positive hit for single parameter m-bison. encoding a mitochondrial chaperonin, yor020c's de score ranks  <dig> out of  <dig> based on the b statistic with microarray data alone. upon application of m-bison, the score is boosted to a rank of  <dig>  yor020c contains four upstream motifs: reb <dig>  ume6/ndt <dig>  ars, and an uncharacterized conserved sequence. it is worth noting that the absence of an hse preceding this gene suggests, as is supported in figure  <dig>  that the hse is not necessary for the physical binding of hsf1p. the vast majority of the  <dig> genes in yor020c's de story have similarly high de scores, explaining the large boost the gene receives from m-bison. however, four genes in the story: yjr044c, ymr182c, ymr145c, and yor310c earn relatively low m-bison de scores. an expansion of the story in figure 9b to include all of yjr044c's knowledge neighbors illustrates why this gene receives a low score: two additional motifs  are present upstream of yjr044c that connect it to  <dig> low-scoring genes.

discussion
a robust and properly validated method to incorporate known biological relationships with gene expression data to identify gene-wise differential expression would be useful and has not been available. to address this need, we created m-bison, a probabilistic approach to integrating biological knowledge with microarray data.

one might argue that in microarray expression analyses, we should "let the data speak for themselves" and not bias the analysis of differential expression with potentially inaccurate or irrelevant biological knowledge. there are a few points to make. first, it is always possible to run unbiased analyses given the experimental data , but the data may be speaking in a noisy room with echoes, in which case having some idea of what the data may be saying could assist in interpretation. second, our method  is an effective way to formally define "surprising results" and thus focus attention on potentially novel findings. if the analysis with biological knowledge and the unbiased analysis lead to marked changes in rank for a gene  then it deserves study; there is clearly an interesting tension between the data and current knowledge worth examining. if the biased and unbiased analyses rank a gene similarly, then the data and knowledge roughly agree and so a startling discovery is less likely. thus, m-bison allows correct knowledge to assist the analysis and highlights inconsistencies so that potentially incorrect knowledge can be identified and reconsidered.

biological knowledge can take many forms, including gene functional annotation, protein-protein interactions, dna motifs, and microarray data compendia. each of these sources can readily be represented as a graph whose nodes are genes and whose edges connect genes that either share a biological function, code for interacting protein products, contain the same upstream dna motif, or correlate significantly across array experiments. using these graphs, we are able to represent knowledge ranging from labelled groups  to binary connections  in a format amenable to a graphical model. in this manner, m-bison can incorporate many different kinds of biological knowledge and treat them identically, governing their degree of influence by two parameters α and α. intuitively, α and α determine the amount of weight we give to the knowledge to decrease and increase, respectively, the overall de score for each gene. with these two parameters set to zero, the scores are calculated from the microarray data only; as the parameters' values increase, knowledge plays a larger and larger role.

using simulated data, we tested m-bison on a variety of data/knowledge structures and, using an empirical approach for combining results from runs obtained with different parameter values, demonstrated better performance in identifying de genes in a subset of these structures. we acknowledge that such an empirical approach is unconventional in the context of undirected probabilistic models, but as mentioned in the methods section, standard parameter estimation strategies were ineffective. specifically, empirical m-bison works well when applied to noisy microarray data , conditions resulting in a small number of de genes, and knowledge sources with a high relative connectivity and/or high β value. while these characteristics might be viewed as limitations, we note they are also precisely the conditions that call for a method like m-bison. first, improving de gene identification with expression data is only really necessary when the data are noisy. second, as the cost of additional experimentation often limits how many de genes can be pursued in the lab, a method giving higher quality de predictions is more useful when the overall number of de genes is expected to be low. if there are many de genes, experiments can be restricted to the most significant de gene candidates, which even when identified with a method using only microarray data are likely to be correct. finally, a knowledge source that is relevant to the conditions of the microarray experiment will likely have a high relative connectivity and β value. we note that while it is impossible to know the exact values of the above features without knowing the right answer, rough estimates of the first two can be obtained from an analysis of the microarray data, while the third can be made favorable by careful choice of the knowledge source.

the above three conditions pertain only to using empirical m-bison. in our simulation studies, we have shown that using m-bison with optimal parameter values yields better de gene identification over a wide range of data and knowledge structures. though the optimal parameter values vary for differing data-knowledge configurations, they are generally the same for different instances of the same configuration . thus, knowing the  configuration of the data and biological knowledge would allow intelligent choosing of parameter values and expand the number of examples where m-bison would be useful. we are currently focusing on this task.

we validated m-bison on a yeast microarray dataset by showing improved performance in heat shock-related de gene prediction. we used genome-wide conserved motif data as knowledge and hsf1p transcription factor binding data as an approximation to a de gene gold standard . using empirical m-bison, we show a substantial increase in auc and pauc. <dig> when compared to performance using the b statistic with array data alone. figure  <dig> illustrates the differences in high-scoring true positives between the b statistic, single parameter m-bison, and empirical m-bison. the empirical method gives the longest list, though the overlap with the b statistic is extensive. the genes not present in the b statistic list are those that became significant due to their associated knowledge; there are nine such genes in the top  <dig> when using the empirical approach. most of these genes make good biological sense: the top two genes yer037w and ylr350w share an ste <dig> motif, predicted to be involved in stress response  <cit> , and ybl075c and ypl106c are both atpases involved with the hsp <dig> family and hsp <dig> complex, respectively. the most unique  list belongs to single parameter m-bison. nearly all of these true positives became significant due to dna motif knowledge. as before, many of these unique genes make biological sense: yal005c and ymr186w are both members of a heat shock protein family, yor020c inhibits the activity of a heat shock protein, and ydr184c is involved in stress response. interestingly, the top two genes of this list  share two motifs, reb <dig> and ars, neither of which have a known relation to heat or stress response. each list has at least a few genes that do not appear in the other two, so all three methods of analysis have some value in identifying true positive genes.

we took a closer look at the behavior of m-bison with respect to two gene stories: yor020c and ybr045c. we displayed the effects knowledge had on these genes in the context of their knowledge neighbors and saw that the boosting or lowering of these genes was biologically justified. those few genes whose behavior seemed contradictory to the majority of their network neighbors were explained by expanding the amount of the knowledge neighborhood considered. in addition, viewing m-bison's effect on the ndt <dig> transcription factor  in the context of its associated knowledge has suggested it to us as a potentially novel player in heat shock/stress response pathways. while the assumptions of the hypergeometric p-value in testing motif enrichment are not fully met , the overwhelmingly small p-value achieved by ndt <dig> lends some confirmation to our hypothesis.

using physical dna binding data as a substitute for a de gene gold standard, while biologically reasonable, is clearly not perfect. to investigate possible shortcomings with this approach, we looked in detail at the top  <dig> high-scoring genes from the lists generated by the b statistic with microarray data only, single parameter m-bison, and empirical m-bison . for each gene, we searched for background information implicating it in stress or heat response. four of six such genes uncovered by single parameter m-bison were not considered truly de by the hsf1p physical binding data, while the b statistic found only one such gene. thus, a perfect gold standard might be expected to reveal even better m-bison performance, at least in the highest-scoring part of the gene list.

it is worth considering what would constitute a perfect gold standard for validating a de gene predictor. ideally, a more accurate quantification of rna  would be used, but obtaining such a measurement for every gene present on a microarray for a given condition is not feasible. approaches used in the past include evaluating gene lists based on gene annotations or prior knowledge of a condition, but these methods are at best indirect and apply to only a subset of all genes. we believe that using a related high-throughput assay like chip-chip for a silver standard is a good compromise, as tfs are expected to regulate the expression of many of their target genes. by choosing a closely related knowledge source like genome-wide motifs, which should predispose de genes to be those containing motifs used by tfs, we hope to further minimize discrepancy between the silver standard and the unknown truth. we note that though a standard like this will always miss some true positives , it will still be useful in comparing relative performances between de predicting methods.

we compared m-bison performance to that of a competing method, generank, using the heat shock dataset. we note that generank depends on a single parameter, d, whereas the m-bison model requires specification of three: α, α, and α, the first two of which are non-trivial to estimate. in terms of auc and pauc. <dig>  m-bison outperforms generank, both in performance using optimal parameter choices and, more importantly, in performance when knowledge of the truth  is withheld. we believe the reason for such improved performance is two-fold. first, because m-bison utilizes a probabilistic framework, uncertainty present in gene expression data is automatically incorporated into the model. this is in contrast to generank, which uses log ratios of expression. we would expect this to improve results in much the same way that a statistically sound method of detecting de genes with microarray data improves over fold-change based methods. we also note that though m-bison requires a gibbs sampling procedure for inference, the computational time required to evaluate a parameter combination is approximately the same as is needed by generank, which must solve a large system of linear equations. second, when considering the good performance of empirical m-bison, we note that this approach effectively tries many combinations of parameter values for each gene, choosing the combination that yields the most significant p-value. in contrast, generank uses one value of the parameter d, and thus we would expect better m-bison performance in cases where different de genes would benefit from different strengths of knowledge influence  and α).

one additional advantage of using a probabilistic model in m-bison is that any genome-wide experimental modality using scores that can be converted to probabilities is a candidate for m-bison. thus, chip-chip, protein microarray, and even genome-wide association data might benefit from such a knowledge integration approach.

several challenges remain in using m-bison for its intended purpose. as mentioned above, one difficulty is choosing optimal parameter values in data-knowledge configurations that do not benefit from the use of the empirical approach. a second and related challenge is the proper handling of knowledge that is uninformative to the condition queried by the microarray experiment. in this case use of any amount of knowledge would be expected to introduce error into the results. by treating all knowledge as a structured graph, we believe we can solve this issue in the process of solving the first challenge, by predicting the unknown configuration of data and biological knowledge. lastly, we should accommodate more complicated forms of knowledge. one example of this is continuously valued  connections between genes. this would prove useful if gene ontology semantic similarity measures between genes were used as knowledge. another example is use of multiple forms of knowledge, each separately parameterized. with more than a few sources, a grid search becomes computationally prohibitive, and thus a more sophisticated approach to sampling parameter values becomes necessary.

CONCLUSIONS
in this work we have developed, validated, and made available m-bison, a probabilistic method for integrating biological knowledge with gene expression data to identify de genes. the method in its current state shows good performance in a useful subset of microarray data-biological knowledge configurations. in addition, our work provides a solid foundation to explore such a method's utility with other high-throughput data sources.

