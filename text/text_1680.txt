BACKGROUND
recently, mirnas have been shown to be a large and diverse class of regulators  <cit> . a large effort has been under way to clone and sequence mirnas using a variety of technologies in multiple species and tissues  <cit> . these molecules are 18- <dig> nt and function via binding to the 3'utrs of their target transcripts  <cit> . this binding event is targeted via complementarity between mirna and target sequence. the binding of a mirna to its target transcript causes repression of translation and also transcriptional destabilisation  <cit> . mirnas have been implicated in a large and growing number of diseases and processes across both animal and plant kingdoms  <cit> . the mirbase database is the primary repository for these data  <cit> . it focuses on both nomenclature and recording of precursor and mature sequences and their probable genomic loci. currently many deposited mirnas are derived from model organisms . given that many mirnas are highly conserved between species  <cit>  it is likely, for example, that a mirna discovered in c. elegans will also be present in c. briggsae. in other cases even in one species there may be multiple genomic loci which could encode a detected mature mirna sequence and not all of these may be annotated in mirbase. this implicit bias towards model organisms hampers mirna research in other organisms and makes evolutionary and phylogenetic analysis of mirna families across species extremely difficult. given a mature mirna sequence in one species it is possible to detect the likely location of its orthologue in another species using both sequence analysis and rna secondary structure prediction. our assumption here is that an orthologous mirna will possess both a high degree of similarity to the mirna mature sequence and that identified orthologous loci should have the capability to form the stem-loop structure typical of mirna precursors. some groups use ad hoc methods for mirna mapping analysis, however such approaches are generally either not available to the community, have not been validated or are too specific for general use. for example, mirortho  <cit>  provides web-access but not methods or raw data, while cogemir  <cit>  provides raw data but does not allow sequence searches. another tool, mirnaminer  <cit>  requires the user to provide both the mature sequence and the precursor sequence and runs on a limited set of species. for these reasons, it is very difficult to directly compare the existing methods to mapmi in terms of performance. however, where possible we have compared predictions from mapmi against cogemir, mirnaminer and mirortho . the most complete comparison is with mirortho where there is a high degree of overlap between the methods, for the species where their data is freely available. when human mirbase mirnas are used as a reference set, both methods predict a shared set of  <dig> loci, while mirortho predicts  <dig> loci that mapmi does not and mapmi detects  <dig> loci not detected by mirortho . many methods have focused on prediction of novel mirnas from genomic hairpins  <cit>  which is a non-trivial problem. in our case we focus on the simpler task of mapping an identified mirna in one species to others using both sequence similarity and rna secondary structure. while our system has not been designed for predicting the loci of novel mirnas, it is useful to leverage on the data produced by other methods, expanding it to other species. we describe our approach to mirna mapping and demonstrate that it performs well, discriminating between true mirnas and false-positives. the approach is freely available as both software and a web interface. furthermore, we provide precomputed mappings of all mirbase mirna sequences across  <dig> ensembl genomes and  <dig> ensembl metazoa genomes  <cit> . we will maintain this resource through subsequent updates of mirbase for all species available in ensembl.

implementation
pipeline
the mapmi pipeline works as follows . the system is supplied with a set of input sequences corresponding to mature mirna sequences. the user then decides which species to map these sequences against. the stand-alone version of mapmi allows the user to supply their own genomic sequence. the genomes used have previously been processed using repeatmasker  <cit>  to remove repetitive elements, that are not similar to known mirnas  <cit>  . the provided input sequences are scanned against selected genomes using the bowtie algorithm  <cit> , which is designed for efficient short sequence matching. the system allows no gaps but up to three mismatches, allowing one mismatch by default. each match is extended to produce a pair of potential mirna precursors through extension of  <dig> nt . each of these potential precursors is then folded using viennarna  <cit> . a scoring function is used to evaluate each candidate. the scoring function  takes into account both the quality of the sequence match and the structure of any predicted hairpin. the best candidate is selected based on the score . candidates are further filtered according to a score-threshold. this is defined by the user, however a number of suggested thresholds are provided. these thresholds have been selected according to an empirical analysis of true and shuffled mirna sequences . all mirna precursor loci above threshold are reported to the user with their associated scores and other relevant information. as an alternative, the user can query a database of pre-computed results, using a mirna name as a query, and selecting the desired species and threshold.

finally, the web version of mapmi provides detailed further analysis capabilities for precomputed results. this includes the generation and display of maximum likelihood phylogenetic trees , multiple sequence alignments  and rna structural logos .

scoring function
mapmi takes into account several properties of known mirnas in its scoring function . in this context, mismatches, matches and perfectmatches correspond to the number of nucleotides that are part of the predicted structure between the two arms of the stem loop. mismatches correspond to the number of structurally unpaired bases, matches to the number of structurally paired bases and perfectmatches to actual basepairing. mature mismatches are obtained by parsing the output of bowtie, the hairpindeltag is the value of minimum free energy returned by rnafold, and mismatchpenalty is a parameter specified by the user. the mismatchpenalty parameter is important to distinguish sequences with mismatches from sequences with no mismatches, that can match to the same loci. the parameter can be set to a value that is large enough to enable this distinction but at the same time does not hamper the method's functionality by penalising mismatches too much . a warning is displayed if this is likely to be the case.   

validation
the negative dataset was generated by using ushuffle  <cit>  to generate  <dig> and  <dig> shuffles per initial nucleotide sequence. due to their nucleotide composition, some of the  <dig>  initial sequences could not be shuffled the required number of times. the resulting in datasets contained  <dig>  and  <dig>  random shuffled sequences respectively. these datasets were mapped against all  <dig> genomes under analysis.

repeat masking
the repeat masking procedure applied to the genomes prior to the analysis is useful to avoid the detection of repeat elements that contain sequences similar to known mirnas. nevertheless, as a consequence of this procedure some mirbase annotated mirnas  <cit>  are masked and therefore reduce the sensitivity of our method .

RESULTS
we applied mapmi to  <dig> ensembl and ensembl metazoa genomes using all  <dig>  metazoan mirbase mirnas, of which  <dig>  have a unique sequence . in total, we identify  <dig>  loci in all genomes under analysis using the default threshold , including  <dig>  loci not previously reported in mirbase . the phylogenetic profiles of mirnas in each species are shown . the phylogeny derived from clustering these profiles broadly agrees with known phylogenetic relationships . genomes were masked for repetitive elements before further analysis .

summary of the number of loci per species that overlap mirbase annotated loci, and the number of times the overlapping loci is correctly named by mapmi. this analysis could not be performed for all species, as mirbase loci coordinates were not readily available. we present results for two different parameter sets.  mapmi default parameters with no repeat element post-filtering.  mapmi allowing only perfect matches, post-filtering for sequences that are associated with repeat elements and map to multiple places in the genome .

validation
we evaluate the performance of the scoring function  by comparing score distributions from a positive dataset containing  <dig>  mirbase  deposited unique sequences from metazoan species, to a negative dataset composed of dinucleotide shuffled versions of the sequences in the positive control . the score distributions from both positive and negative control sequences are shown . this illustrates that real mirnas perform significantly better than shuffled mirnas according to the scoring function described above. this also allows us to derive reasonable thresholds for large-scale mapping projects that balances sensitivity and specificity .

to assess the performance of our pipeline when predicting mirna orthologues in a more general context, we analysed mapmi predictions of horse mirnas. horse was chosen because it was recently introduced in the latest release of mirbase. we used mirbase v <dig> deposited metazoan mirnas, that do not include horse sequences, to predict horse mirnas. the overlap of mapmi predictions and mirbase v <dig> deposited horse mirnas was  <dig> % . the ability of our classifier function to distinguish mirna hairpins from other genomic hairpins was verified by classifying the  <dig>  non-mirna hairpins as reported in  <cit> . we obtained a correctly classified ratio of  <dig> %.

further verification was done for the genomes for which mirbase genomic coordinates are available, to assess how many mapmi predictions overlap with mirbase annotated mirna loci and how many of those are correctly named. we found that  <dig> % of our predictions overlap with mirbase with  <dig> % of those being assigned the same name as mirbase .

nine mirnas appear to be highly conserved across the majority of species . these mirnas include the well-known let- <dig> family, previously known to be highly conserved  <cit> . conversely, a total of  <dig> mirnas were shown to be species-specific mostly in chicken, c. elegans, cow, platypus, human and mouse. this result may arise due to some organisms being more heavily profiled . additionally, some species have few related species available for comparison  and would appear to have an excess of species-specific mirnas. saccharomyces cerevisiae is not believed to possess machinery for mirna processing, however it is present in ensembl and was retained as a negative control. as expected, no mirnas were found in s. cerevisiae. these results indicate that while mirbase has excellent coverage of many species, it appears to be only capturing a fraction of the total number of mirnas in some species. hence, we believe that these results can complement mirbase.

CONCLUSIONS
we present a new system for mirna mapping through sequence similarity and secondary structure, which is available both as a stand-alone tool and an online web resource. we demonstrate the selectivity and sensitivity of the approach on a variety of datasets and have applied it to a large number of genomes. this is particularly useful for recently sequenced genomes where mirna information may be absent or sparse. using this approach we have mapped mirna loci in  <dig> genomes, many of which are not present in mirbase. we provide a web-interface and a database of pre-computed mirna loci, multiple sequence alignments and phylogenetic trees for many genomes and we hope this system will prove useful to the community.

availability and requirements
• project name: mapmi

• project home page: http://www.ebi.ac.uk/enright-srv/mapmi/

• operating system: platform independent , linux and macos x 

• programming language: perl

• other requirements: bowtie, dust, rnafold 

• license: gnu gpl

authors' contributions
jag-a performed the analysis and wrote the manuscript. aje conceived the experiment and also wrote the manuscript.

supplementary material
additional file 1
supplementary information. multi-page file containing supplementary figures and tables in pdf format. can be opened with any standard pdf viewing application .

click here for file

 acknowledgements
the authors would like to acknowledge the other members of the enright lab at embl-ebi.

we also thank tzu-hao chang of national central university, taiwan for kindly making a standalone version of the rnalogo software available.

jag-a would like to thank mali salmon-divon  for useful comments and discussion and gregory jordan  for assisting with the integration of phylowidget.

jag-a is a member of clare hall college of the university of cambridge.

jag-a was supported by fellowships sfrh/bi/33193/ <dig> and sfrh/bd/33527/ <dig> from the fundação para a ciência e tecnologia as part of the ph.d. program in computational biology of the instituto gulbenkian de ciência, oeiras, portugal. the ph.d. program is also sponsored by fundação calouste gulbenkian and siemens sa.
