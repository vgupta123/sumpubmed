BACKGROUND
the yellow fever mosquito, aedes aegypti , is the major vector of human arboviruses. because of its tight connection to humans and its distribution in most sub-tropical and tropical regions, this insect causes a substantial burden on global public health  <cit> . the development of anti-viral vaccines has been largely unsuccessful and has therefore shifted focus in disease prevention back to the control of ae. aegypti populations  <cit> . understanding basic ecological and microevolutionary processes in mosquito populations is necessary for the efficient implementation of many control measures. for example, knowledge of the rates of ongoing gene flow, fine scale mosquito movement and adaptive genomic changes are important for predicting the spread of wolbachia infection  <cit>  or insecticide resistance  <cit> .

ecological processes can often be inferred indirectly from observed genetic patterns  <cit>  and this has led to interest in developing molecular markers for population studies in ae. aegypti. in the last decade, mitochondrial dna  sequences have commonly been used for ae. aegypti population genetic studies  <cit> . however, mtdna markers are best suited for analyses of historical processes at larger geographic scales, as they can only provide information on long-term accumulated effects of female dispersal due to their moderate mutation rate and maternal mode of inheritance  <cit> . furthermore, the recent discovery of mtdna pseudogenes  in the nuclear genome of ae. aegypti limits the reliability of inferences from mtdna  <cit> . fast-mutating, highly variable nuclear markers such as microsatellites enable efficient analyses of fine-scale contemporary processes  <cit> . close association with repetitive genetic elements and lower polymorphism has hindered the development of a robust set of microsatellite markers in ae. aegypti until the complete genome sequence became available  <cit> . population genetic structure of this vector has since been usually ascertained with up to  <dig> microsatellite loci  <cit> , that were sometimes supplemented with a few single nucleotide polymorphism  markers  <cit>  or exon-primed intron crossing  markers  <cit> .

based on these marker systems, some details of ae. aegypti movement and gene flow patterns have been inferred. studies have investigated genetic structure across different spatial scales  <cit> , and some have also included a temporal component  <cit> . despite reports of limited active dispersal of this mosquito  <cit> , a high level of gene flow has often been found even at broader regional and continental scales  <cit> . unexpected structure may be explained by passive, human-mediated dispersal of mosquito eggs, larvae and adults coupled with low migration rates  <cit> . however, methodological issues associated with the available genetic markers  <cit>  remain a major obstacle in using these markers to understand population movement patterns and microspatial scale structuring across time.

next generation sequencing provides an opportunity to generate snp markers at a genome-wide level even for non-model species. a mere  <dig> bi-allelic snps can provide the same resolution as  <dig> highly variable microsatellites for distinguishing closely related individuals  <cit> . a large panel of snps should therefore detect weak genetic structure caused by recent ecological and evolutionary processes  <cit>  and provide reliable inferences of demographic history  <cit> . genome-wide snps would thus be ideal for determining patterns of dispersal, gene flow and genetic structure at all spatial scales for populations of ae. aegypti.

an analysis of genome-wide sequence variation via whole genome sequencing is still prohibitively expensive for ae. aegypti, given its large genome size . a cost-effective alternative is to sequence a fraction of the genome through restriction-site associated dna sequencing   <cit> . rad sequencing has been successfully used for the discovery of thousands of markers in yeast, plants and animals  <cit> . rad loci are dna fragments adjacent to the cut site of a particular restriction enzyme, or a combination of two enzymes  <cit> . choice of restriction enzyme  and the fragment size selection window can be used to optimize the number of tags, capturing a certain proportion of the genome for snp detection and comparison across multiple individuals or populations.

recently, brown et al.  <cit>  used  <dig>  snps generated with rad sequencing to test the hypothesis about global invasion and domestication of aedes aegypti. here, we developed bioinformatics tools that support the customization of restriction-enzyme-based protocols and used them to discover over  <dig>  snps in ae. aegypti collected on three continents. we have positioned these snps onto the newly assembled ae. aegypti reference genome  <cit>  and provided their annotation and prediction of effects. we tested the resolution of these new markers against a set of previously isolated microsatellites in delineating neotropical populations and establishing relatedness patterns at a fine spatial scale. overall, we demonstrated the high potential of genome-wide snp markers to advance our understanding of mosquito population dynamics which is crucial for improving the control measures against this major disease vector.

RESULTS
bioinformatics tools: ddsilico and ddemux
we developed ddsilico as a memory efficient program written in c language for in silico genome digestion with a single restriction enzyme or a combination of enzymes. this program calculates the number of potential rad loci from the available genome sequence . ddsilico can be used for any restriction-enzyme-based protocol and is particularly suitable for customizing the double digest radseq protocol  <cit>  because it separates fragments that have different overhangs on two ends  from non-usable fragments. we tested the performance of ddsilico by comparing results with the bioanalyzer profiles of empirical digestions. dna of the transformation vector stinger gfp was digested with restriction enzymes nlaiii and mluci . observed and expected fragment profiles were highly concordant for sizes over 150 bp . due to the purification of digestion reactions required for the bioanalyzer run, fragments smaller than 150 bp were only partially retained with the paramagnetic bead solution.

to estimate the number of potential ddrad tags in the ae. aegypti genome, we performed in silico double digestion with various combinations of restriction enzymes. distinguishing between usable fragments is a feature of ddsilico, as some double digestions produce numerous fragments in the desirable size range , but only a small proportion constitutes potential ddrad loci . based on in silico results, we chose two frequent cutter enzymes  for our ddrad library construction. the ratio between the number of loci in the ae. aegypti catalog  and the number of loci predicted with ddsilico  was  <dig> %.

ddsilico can be used for any method that utilizes restriction enzyme to create libraries with a reduced genome representation, such as genotyping-by-sequencing   <cit> , reduced-representation bi-sulfate sequencing   <cit> , ezrad  <cit>  or restseq  <cit> . simulating genome digestions enables researchers to choose optimal enzymes for specific species and research questions. for example, using rare cutting enzymes allows for higher level of sample multiplexing but can result in a non-uniform complexity reduction and biased distribution of sequenced fragments  <cit> , leading to inaccurate estimation of population parameters or average methylation levels  <cit> .

we also developed ddemux as a demultiplexer of fastq files under various barcoding schemes . our program is memory efficient, developed in c language and easy to execute on windows and ubuntu platforms. it supports samples labelled with one or two barcodes that can vary in length. ddemux can use barcode sequences found in p <dig> and/or p <dig> reads, and in the index reads . in our library, each sample was defined by a combination of variable length barcodes at the 5’ and 3’ ends . such a combinatorial scheme reduces the cost for generating adapters with unique barcodes, while the varying length of barcodes increases library diversity at the 5’ and 3’ ends. this is particularly useful for ddrad and other non-shearing-based libraries, where paired end  reads can be used for snp discovery but lack any diversity in the initial sequencing cycles when barcodes are absent.

we developed a customized pipeline that takes individually sorted raw sequences and outputs files ready for snp calling . it automates standard processes for read quality control and aligning to a reference genome. following demultiplexing, sequence quality scores are automatically converted into the sanger format. this ensures standardization of quality scores for data generated by sequencing machines with different qc set-ups. single  and paired  reads are then filtered and trimmed according to the chosen phred score with fastx-toolkit . p <dig> and p <dig> reads are then matched, leaving the unpaired reads as orphans. paired reads are first aligned to the reference genome using bowtie  <cit>  according to the selected parameters. user can choose to also perform single-end alignment using joined orphans and all unaligned paired reads. in the final step, all aligned output files are merged per individual and are ready for downstream analyses.

discovery and characterization of snps in ae. aegypti
prior to any quality filtering, the average number of reads per individual was  <dig>  million, ranging between  <dig>  and  <dig>  million reads. quality filtering removed on average  <dig> % of reads, retaining sequences with a mean quality score of  <dig> and a gc content of 41%. on average,  <dig> % high quality reads aligned uniquely to the ae. aegypti reference genome. with a minimum depth of five reads per individual, aligned sequences formed  <dig>  rad loci in the catalogue created with the stacks pipeline for snp discovery  <cit> .

we further filtered loci that were present in at least 75% of individuals and retained  <dig>  loci with an average 12× read depth .  <dig>  loci  were polymorphic in at least one geographic sample, giving  <dig>  putative biallelic snps . when we applied the same filtering criterion to each of the four samples, between  <dig>  and  <dig>  snps per sample were obtained. number of private variants was the largest in the collection from brazil  and the lowest from vietnam . average minor allele frequency per sample was between  <dig>   and  <dig>   .

n
p
h

o
h

e
f

is
π
n

e
n - the number of analyzed individuals from brazil , australia , indonesia  and vietnam ; t - the number of rad loci; % pol - percentage of polymorphic loci; snp - total number of snps; private - the number of private snps; p - average frequency of the more common allele; ho, he – observed and expected heterozygosity at polymorphic sites; fis - fixation index across polymorphic sites; π – average nucleotide diversity ; ne – lower range effective population size .

most common sequencing errors of the illumina machines are a↔c and g↔t transversions  <cit> . in our filtered data-set, two thirds of snps were transitions , suggesting a very small influence of sequencing error on our snp calling. this is highly comparable to other radseq studies that reported a ratio of  <dig>  in the european eel  <cit> ,  <dig>  in the eggplant  <cit>  and  <dig>  in the great tit  <cit> .

snps from our catalog were distributed across  <dig>  supercontigs that constitute 89% of the ae. aegypti genome. their number was significantly correlated with the size of supercontigs . thanks to the recently improved assembly of the a. aegypti genome  <cit>  we were able to position  <dig> % of uncovered snps onto the three a. aegypti chromosomes:  <dig>  snps on chromosome  <dig>   <dig>  on chromosome  <dig> and  <dig>  on chromosome  <dig> .

we found  <dig> % of snps in intergenic regions,  <dig> % in introns and  <dig> % in exons of  <dig>  genes . they had very low occurrence in splice-site donor sequences and utr 5’ region , and somewhat higher occurrence in utr 3’ region . using the program snpeff  <cit> , we imputed the overall impact of all variants as largely modifying , followed by low , moderate  and high impact  .

reduced representation libraries generally locate only around 2% of snps in the transcribed part of the genome  <cit> , but they are generated using a rare cutting enzyme and random shearing. here, we demonstrate the advantage of using two very frequent cutting enzymes that generate rad loci evenly distributed across the genome. other methods, such as rrsb, restseq or modified gbs, also utilize “common-cutters” to improve genome coverage and achieve unbiased distribution of sequenced loci  <cit> .

recently, bonizzoni et al.  <cit>  used rnaseq to analyze sequence variation in the transcriptome of three ae. aegypti laboratory strains. they characterized over  <dig>  snps in open-reading frames  and untranslated regions  of  <dig>  genes. in our catalog, 19% of all snps were found within orfs and utrs of  <dig>  genes. as in bonizzoni et al., the most common snps were synonymous, 3’utrs contained  <dig> times more snps than 5’utrs, and snps that affect splice site donors, start and stop codons were very rare . we uncovered more non-synonymous changes than the mentioned study, likely because we analyzed pantropical ae. aegypti populations that are very divergent from the laboratory reference strain lvp  <cit> .

genetic diversity and effective population size
average observed heterozygosity per variable snp site was lower  than the expected heterozygosity  in all samples, with overall fis values ranging between  <dig>  and  <dig>  . microsatellite loci also showed lower than expected heterozygosity in all samples except for vietnam, with fis ranging between  <dig>  and  <dig>  . microsatellite loci were moderately polymorphic in all samples, with two to seven alleles per locus .

nucleotide diversity averaged over all snp loci  was lower and comparable among samples . due to numerous low frequency alleles, this diversity index  was an order of magnitude lower than previously reported . based on average nucleotide diversity, long term effective population sizes were estimated to range between  <dig>   and  <dig>   across four collections . we note that snps may provide more biased estimates of long-term ne than faster evolving markers such as microsatellites, because they are likely to be more affected by mutation-drift deviations  <cit> . however, our long term ne based on the higher mutation rate  are concordant with the estimates of census population sizes at these collection sites. for example, jeffery et al.  <cit>  found that the number of ae. aegypti adult females in tri nguyen village  could be as high as  <dig>  individuals , while we found the lower range of ne to be  <dig>  individuals . based on wolbachia-infected ae. aegypti releases in gordonvale , a recent estimate for adult females within the release area was  <dig>  individuals  <cit> . assuming equal sex ratio, total census size in gordonvale would be around  <dig>  individuals, while our lower range ne estimate was  <dig>  individuals. hence, we consider our snp panel to be reflecting true evolutionary processes in ae. aegypti populations.

using genome-wide snps to examine population processes
broad-scale structuring
our genome-wide snp set demonstrated high power in resolving ae. aegypti genetic structure at a broad spatial scale. discriminant analysis of principal components  with  <dig>  snps revealed a clear separation of distinct genetic clusters, while the eight polymorphic microsatellites showed much less resolution in delineating australian, indonesian and vietnamese samples . ten principal components and three discriminant functions were retained in both analyses, conserving  <dig> % of the variation for the snp data and  <dig> % of the variation for the microsatellite data. membership probabilities, interpreted as proximities of individuals to different clusters  <cit> , showed that genome-wide snp markers achieved unambiguous separation of all groups.

using  <dig>  rad-generated snps, brown et al.  <cit>  recently provided strong evidence for the african ancestry of domesticated ae. aegypti that spread throughout the tropical new world and from there, relatively recently, invaded southeast asia and the pacific. their set of snps enabled clear separation of african and neotropical populations, but provided no resolution within the southeast asia/pacific group  <cit> . here we showed that strong separation between populations from vietnam, indonesia and australia is achieved with more markers.

pair-wise fst values were larger for snp markers than for microsatellites , which is expected given the intrinsic mathematical dependence of fst on heterozygosity, number of alleles and their frequency  <cit> . despite our small sample sizes, degree of differentiation for microsatellite markers was high and comparable to previous studies. for example, gordonvale and tri nguyen collections had a pair-wise fst value of  <dig>  in endersby et al.  <cit>  and  <dig>  in our study.
f

st
 <cit> 

fst values computed over all loci are reported for microsatellite markers  and genome-wide snps .

fine scale relatedness
 <dig> snps showed remarkable power in distinguishing closely related individuals at a small spatial scale . kinship coefficients  and maximum likelihood relatedness  were highly correlated  and all imputed relationships had a strong support . six full-sib pairs and one half-sib pair were detected in the same trap , while three half-sib pairs were found 420 meters apart. conversely, only 19% of all putative relationships obtained with microsatellite markers were statistically supported. microsatellite kinship coefficients were higher across spatial distances, but their log likelihood was not significantly greater than the log likelihood of the alternative relationships. the only supported related pair  was found in the same trap .

the advantage of snps over microsatellites is increasingly reported in kinship and parentage analyses. biallelic snps provide less information per locus, but this can be offset by their larger numbers. unlike  <dig> microsatellites with low variability, a set of  <dig> snps ensured successful paternity and identity analysis in the european bison, bison bonasus <cit> . in the wild sockeye salmon ,  <dig> snps outperformed  <dig> highly variable microsatellites in parentage and kinship assignment  <cit> . on the other hand, using too many snps can lead to a decrease in power due to information redundancy from non-independent markers  <cit> , but selecting a subset of approximately independent snps  can overcome this issue.

with high-resolution genetic data, analyses of ecological processes in ae. aegypti can shift from traditional ‘deme-based’ methods to new individual-based methods. assignment tests and similar approaches provide more direct inferences of dispersal and contemporary gene flow, avoiding a number of problems associated with traditional indirect inferences  <cit> . fine scale mosquito movement and egg-laying patterns become tractable with numerous markers that reveal genetic differences even between highly related individuals. identification of barriers or corridors for dispersal of this mosquito can be undertaken via individual-based landscape genetic analyses  <cit> .

we have demonstrated that rad sequencing provides insight into various population patterns and processes, going from broad-scale structuring, effective population size to fine scale relatedness. rad-based markers therefore have the great potential to advance our understanding of mosquito ecology and assist in developing appropriate measures of vector control at local and regional scales.

CONCLUSIONS
next-generation sequencing techniques such as radseq provide an increasingly-affordable approach for generating numerous genetic markers to study disease vector populations. here we developed a new set of bioinformatics tools that support the customization of restriction enzyme-based protocols for snp discovery. we identified more than  <dig>  putative snps in field samples of the major arbovirus vector ae. aegypti. our approach of using frequent cutting enzymes enabled unbiased sampling of genomic regions; we found 48% of variants in intergenic regions and 35% in exons and introns of over  <dig>  genes. their imputed effects in orfs and utrs were highly concordant with the effects found in the recent ae. aegypti transcriptome sequencing study  <cit> . our snp set provided remarkable resolution in detecting broad-scale population structure and in estimating fine-scale relatedness. we demonstrated that a large snp panel enables strong separation of ae. aegypti populations even within a recently invaded neotropical region. familial relatedness of samples collected from a small area could be confidently established with a subset of snps. rad-based genetic data enables studies of basic mosquito ecology and evolution in a versatile manner and at an extremely fine resolution, facilitating targeted control measures designed for a particular local mosquito population.

