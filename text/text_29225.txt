BACKGROUND
rnas are amongst the most versatile and oldest biomolecules; they play crucial roles in many biological processes. as in the case of proteins, the function of many types of rnas critically depends on the three-dimensional structure of the molecules. however, the 3d structure of rnas is determined to a larger degree by their secondary structure, which arises from base-pairing interactions within an rna strand and stacking of the resulting base pairs.

since the direct determination of 3d structures is difficult and costly, computational structure prediction methods, and in particular, secondary structure prediction methods, are widely used. a prominent and versatile approach for predicting rna secondary structures is based on thermodynamic models, such as the turner model
 <cit> , and uses dynamic programming algorithms , to find a structure with minimum free energy  for a specific rna sequence. over the last five years, considerable improvements in the predictions obtained by such algorithms have been achieved.

it is important to note that, while it might seem natural to use experiments to determine the parameters of a thermodynamic model and machine learning and optimisation to determine those of a stochastic model, because of the equivalence between the free energy and probability of rna structures, in principle, both approaches can be used in either setting. indeed, the largest improvement in prediction accuracy has resulted from the use of sophisticated methods for estimating the thermodynamic parameters of a given energy model , based on a set of reliable rna secondary structures
 <cit> . particularly good results have been achieved for methods in which parameter estimation additionally takes into account thermodynamic data from optical melting experiments, such as cg, lam-cg and bl,
 <cit>  and expand the standard energy model with probabilistic relationships between structural features , such as bl-fr
 <cit> . improved prediction accuracy has also been reported for an approach that determines structures with maximum expected accuracy  rather than minimum free energy, based on base pairing probabilities obtained from a partition-function calculation
 <cit> . contrafold implements a conditional log-linear model  for structure prediction. maxexpect starts from base-pair probabilities calculated by partition functions
 <cit>  and uses dynamic programming  to predict the mea structure
 <cit> . and finally, centroidfold uses a similar strategy except that it uses a weighted some of true positives and true negatives as the objective function
 <cit> .

while the overall improvement in accuracy achieved over the baseline provided by the zuker & stiegler algorithm using the turner model is clearly significant, there is less certainty about the more modest performance relationships between some of the more recent methods. for example, lu et al. reported a difference of only  <dig> % in average sensitivity between their maxexpect procedure and contrafold  <dig>  <cit> . similarly, andronescu et al. found a  <dig> % difference in average f-measure between contrafold  <dig>  and their cg ∗ procedure
 <cit> . whether such small performance differences can be considered significant is an open question; in fact, a cross-validation experiment for the bl and lam-cg parameter estimation methods suggests that 3% differences in accuracy may be statistically significant, but the evidence is far from conclusive
 <cit> . this suggests that there is a need for methods that make it possible to assess the statistical significance of differences in prediction accuracy observed between rna secondary structure prediction methods. in this work we present such methods, based on two well-established resampling techniques from statistics, bootstrapped confidence intervals and permutation tests. using these methods and a well-studied, large set of trusted rna secondary structures, we assess progress and the state of the art in energy-based, pseudoknot-free rna secondary structure prediction.

also, it has been demonstrated that the accuracies of predictions based on their bl ∗, cg ∗ and turner <dig> parameter sets  are not consistent across large and diverse sets of rnas, and that differences in accuracy for many individual rnas often deviate markedly from the average accuracy values measured across the entire set
 <cit> . this suggests that by combining the predictions obtained from different procedures, better results can be achieved than by using any one of the given procedures in isolation. this general idea has been previously applied to a wide range of problems in computing science . more recently, it has been used successfully for solving various problems from computational biology, including gene prediction
 <cit> , clustering protein-protein interaction networks
 <cit> , as well as analysis of data from microarrays
 <cit>  and flow cytometry
 <cit> .

here, we introduce a generic rna secondary structure prediction procedure that, given an rna sequence, uses an ensemble of existing prediction procedures to obtain a set of structure predictions, which are then combined on a per-base-pair-basis to produce a combined prediction. empirical analysis demonstrate that this ensemble-based prediction procedure, which we dub averna, outperforms the previous state-of-the-art secondary structure prediction procedures on a broad range of rnas. on the s-strand <dig> dataset
 <cit> , averna obtained an average f-measure of  <dig> %, compared to the previous best value of  <dig> % achieved by bl-fr ∗ <cit> . averna can easily be extended with new prediction procedures; furthermore, it provides an intuitive way of controlling the trade-off between false positive and false negative predictions. this is useful in situations where high sensitivity or high ppv may be required and allows averna to achieve a sensitivity of over 75% and a ppv of over 83% on s-strand <dig> 

methods
in this section, we first describe the data set and prediction accuracy measures used in our work. next, we introduce the statistical methodology for the empirical assessment of rna secondary structure prediction algorithms we developed in this work. this is followed by a brief summary of the set of procedures for mfe-based pseudoknot-free rna secondary structure prediction we used in this work. finally, we present averna, our novel rna secondary structure prediction approach, which combines predictions obtained from a diverse given set of procedures by means of weighted per-base-pair voting.

data sets
in this work, we used the s-strand <dig> dataset
 <cit> , which consists of  <dig> pseudoknot-free secondary structures from a wide range of rna classes, including ribosomal rnas, transfer rnas, transfer messenger rnas, ribonuclease p rnas, srp rnas, hammerhead ribozymes and group 1/ <dig> introns
 <cit> . this large and diverse set is comprised of highly accurate structures and has been used for the evaluation of secondary structure prediction accuracy in the literature
 <cit> . for the parts of our work involving the optimization of prediction accuracy, in order to avoid overfitting, we used a subset of the s-strand <dig> dataset obtained by sampling  <dig> structures uniformly at random as the basis for the optimization process, and the full s-strand <dig> dataset for assessing the resulting, optimized prediction procedures.

existing secondary structure prediction methods
we used  <dig> secondary prediction procedures known from the literature. the simfold- v <dig>  procedure
 <cit> , which is based on zuker and stiegler’s classic dynamic programming algorithm, was used to predict secondary structures using six different sets of free energy parameters: turner99
 <cit> ; nom-cg
 <cit> ; dim-cg
 <cit> ; cg ∗, bl ∗ and bl-fr ∗ <cit> . furthermore, we used contrafold- v <dig> , contrafold- v <dig> 
 <cit> , maxexpect- v <dig> 
 <cit>  and centroidfold- v <dig> .9
 <cit> . the two versions of contrafold as well as centroidfold are based on probabilistic methods that do not make use of physically plausible thermodynamic models of rna secondary structure, while the seven other procedures are all based on  the widely used free energy model by the turner group
 <cit> .

while we originally also considered taverna
 <cit>  and sarna-predict
 <cit> , it turned out to be infeasible to run these procedures on the the longer sequences from the s-strand <dig> dataset .

accuracy measures
consistent with existing work on rna secondary structure prediction, we assessed the prediction accuracy achieved by a given rna secondary structure prediction procedure based on a given set of references structures, using sensitivity, positive predictive value  and the f-measure. we define a correctly predicted base-pair to be a predicted base-pair, exactly identical to one of the base-pairs in the reference structure. for a single rna  pair, sensitivity is the ratio of number of correctly predicted base-pairs to the number of base-pairs in the reference structure: 

  sensitivity=#correctly predicted base-pairs#base-pairs in the reference structure; 

ppv is the ratio of number of correctly predicted base-pairs to the number of base-pairs in the predicted structure: 

  ppv=#correctly predicted base-pairs#base-pairs in the predicted structure; 

and the f-measure is defined as the harmonic mean of sensitivity and ppv: 

  f-measure=2×sensitivity×ppvsensitivity+ppv. 

if there are no base-pairs in the predicted structure and the reference structure, we define ppv and sensitivity to be  <dig> and otherwise  <dig>  the f-measure, sensitivity, and ppv for the prediction of any individual structure are always in the interval , where  <dig> characterizes a perfect prediction. when assessing the prediction accuracy on a given set of structures, we usually report the average f-measure, sensitivity, and ppv achieved over the entire set.

statistical analysis of prediction accuracy
to formally assess the degree to which prediction accuracy results measured for a given set of rnas depend on the precise choice of this set, we employ two well-known statistical resampling techniques: bootstrap confidence intervals and permutation tests . details on the respective procedures developed and used in the context of this work are described in the following. here, we applied these statistical analysis procedures to the average f-measure determined for predictions on a given set of rnas, but we note that they generalize in a straightforward manner to other measures of accuracy and other statistics of these over the given benchmark set. we note that these statistical techniques are limited to assessing the impact of different samples from the same underlying distribution – an important issue, considering the large variation of prediction accuracy within the sets of rnas commonly used for evaluating structure prediction procedures – but do not allow assessment of prediction accuracy might vary as the underlying distribution is changed ; to address this latter question, we use a different approach described later.

to investigate the consistency of predictions obtained from different rna secondary structure prediction procedures, we used scatter plots as well as the spearman correlation coefficient .

bootstrap percentile confidence intervals
following common practice , for a vector f of f-measure values achieved by a given prediction procedure on the structures contained in a given set s of rnas , we perform the following steps to determine the 95% confidence interval  for the mean f-measure: 

•repeat for  <dig> times: from f, draw a uniform random sample of size |f| with replacement, and calculate the average f-measure of the sample.

•report the  <dig> th and  <dig> th percentiles of the distribution of f-measures from step  <dig> as the lower and upper bounds of the ci, respectively.

the choice of  <dig> samples in step  <dig> follows standard practice for bootstrap cis .

permutation test
following common practice , for vectors fa and fb of f-measure values achieved by given prediction procedures a and b, respectively, on the structures contained in a given set s of rnas , we perform the following steps to perform a permutation test for the null hypothesis that the mean f-measure achieved by a and b is the same: 

•repeat for  <dig> times: for each rna in s, swap the f-measures of a and b with probability 1/ <dig>  resulting in vectors
fa′ and
fb′, respectively.

•construct the cumulative distribution function  of
avg−avg from the  <dig> permuted pairs of vectors
fa′,
fb′ from step  <dig>  where avg denotes the average over the elements of a given vector.

•determine the percentile c of the cdf from step  <dig> that is equal to avg−avg, as determined from the original, unpermuted performance vectors for a and b; p=/ <dig> is the p-value of the test.

•reject the null hypothesis of equal performance if, and only if, p from step  <dig> is smaller than a given significance threshold α.

the choice of  <dig> repetitions in step  <dig> follows standard practice for permutation tests. in this work, we used this test with a standard significance threshold of α= <dig> .

averna
as explained earlier, the key idea behind averna is to exploit complementary strengths of a diverse set of prediction algorithms by combining their respective secondary structure predictions for a given rna sequence. our averna procedure can make use of an arbritrary set of prediction procedures, a:={a <dig> a <dig> …,ak}, which it uses in a black-box manner to obtain predictions for a given input sequence, s. to emphasise the fact that the subsidiary structure prediction procedures in a are effectively just an input to averna that can be varied freely by the user, we use averna  to denote averna with set a of component structure prediction procedures.

applied to input rna sequence s, averna  first runs each al∈a on s, resulting in predicted structures s,s,…,s. let each of these structures s be represented by a base-pairing matrix bp defined by bpi,j= <dig> if i and j form a base-pair in s and bpi,j= <dig> otherwise, where i,j∈{ <dig> ,…,n}. we note that any rna secondary structures, pseudo-knotted or not, corresponds to exactly one such binary matrix, but not every binary matrix represents a valid secondary structure.

we now consider the normalised sum of these binary matrices: 

  p=∑l=1kbp)k. 

each entry bi,j of this matrix can be interpreted as the probability of a base pair between bases i and j in input sequence s, under the assumption that the predictions obtained from each of the al should be considered equally likely to be correct. this is equivalent to tallying votes for each possible base pair, where each predictor has one vote per candidate pair i,j.

however, it may well be that some predictors are generally more accurate than others, as is known to be the case for the set of secondary structure predictors we consider in this work. therefore, we associate a weight  with each predictor and consider the weighted normalised sum of the individual secondary structure matrices: 

  p=∑l=1kwl·bp), 

where w=, each wl is the weight assigned to predictor l, and
∑i=1kwi= <dig>  we note that the unweighted case from above corresponds to wl=1/k for each l. before discussing the interesting question of how to determine appropriate weights, we describe in the following how we infer the pseudoknot-free rna structure ultimately returned by averna from the entries in the weighted probability matrix p.

structure inference
the final structure prediction returned by averna  for a given sequence can be obtained in different ways. first, we note that the problem of extracting a pseudoknot-free structure from the resulting probability matrix can be solved using a nussinov-style dynamic programming  algorithm to infer maximum expected accuracy  structures
 <cit> . we refer to the variant of averna that uses this procedure as avernadp. unfortunately, this dp procedure requires Θ running time, which becomes problematic in the context of the parameter optimisation described later. therefore, we designed the following greedy algorithm as an alternative way for estimating mea structures. let p= be the sorted list of base-pair probabilities in p in decreasing order and v= be the respective set of base-pairs. for a given threshold θ , we begin with an empty set of base-pairs s, set i:= <dig>  and repeat as long as pi≥θ:  add vi to s if  it is compatible with all other pairs in s, i.e., does not involve a base already paired with another position or introduce a pseudoknot in s;  increment i. we refer to the variant of averna using this greedy inference method as avernagreedy.

we note that, while the greedy inference method is not guaranteed to find a mea structure, as we will show later, it performs very well compared to the exact dp inference algorithm and is computationally much more efficient. when either variant of averna is applied to a set of rna sequences, prediction and structure inference are performed for each given rna sequence independently, and the results are independent of the composition of the set or the order in which sequences are considered.

parameter optimization
clearly, the performance of averna  depends on the set a of component prediction procedures as well as on the previously mentioned parameters, namely the weights wl and, for avernagreedy, the pairing threshold θ. before using averna  for prediction tasks, we would like to find settings for these parameters that would result in optimised prediction accuracy obtained on a set of reference rnas . we solved the resulting numerical optimisation problem using a well-known procedure called covariance matrix adaptation evolution strategy  <cit> . cma-es is a non-convex, gradient-free parameter optimization procedure that has proven to be empirically successful in many real-world applications and appeared to be the most appropriate tool for finding performance-optimising parameters of averna. we used the matlab implementation of cma-es with default settings, except that we had to increase the maximum number of iterations to  <dig>  since in some cases we observed clear evidence that a global optimum was not reached with the lower default setting for this parameter
 <cit> .

time complexity
the running time required to run averna   is essentially the sum of the running times of the component prediction procedures a <dig> …,ak . while for avernadp, the latter time is of order Θ, and therefore no worse than the complexity of most rna secondary structure prediction methods based on dynamic programming, for avernagreedy, it is o in the  worst case and negligible in practice.

parameter optimisation requires substantially more computational effort, but has to be performed only once, off-line, very much like optimisation of the parameters of a given energy model. in the context of avernadp, each iteration of this optimisation process involves running the Θ dp procedure on all sequences in the given training set of rnas, and as we will demonstrate later, it turns out to be important to use reasonably large and diverse training sets. in our experiments, using a training set of  <dig> sequences, one iteration of cma-es on avernadp took  <dig>  <dig> seconds . each iteration of optimising avernagreedy, on the other hand, took only  <dig>  <dig> seconds . note that these runtimes do not include the time required by the individual algorithms for predicting the structures, which are the same for both approaches and need to be expended only once at the beginning of the optimisation process. once the parameters of averna are optimised, it runs efficiently, as described at the beginning of this section.

ablation analysis
measuring the contribution of each algorithm to avernas performance can help us answer a wide range of questions, including the following: which component prediction procedure contributes the most to the overall performance of averna? is there a certain number of component prediction procedures that must be included before the ensemble method outperforms the individual ones? are there prediction procedures that can compensate for each other, in the sense that including one procedure from a certain set is important, but adding others from the same set does bring significant further gains? for averna  with a={a <dig>  a <dig> ...,ak} we assessed the contribution of each al using the following ablation procedure: 

•determine the al∈a for which averna  performs worst <dig>  i.e., whose average f-measure on the give set of rnas is lowest.

•remove al from step  <dig> from a.

•if a still contains more than two algorithms, go to step  <dig> and iterate.

step  <dig> involves re-optimising the parameters of averna for each set of component algorithms, starting from the values of averna .

RESULTS
in our computational experiments, we pursued two major goals: firstly, to critically assess the state of the art in predicting pseudoknot-free mfe rna secondary structures, and secondly, to demonstrate that our averna ensemble-based structure prediction method does indeed achieve significantly better results than previous algorithms.

performance of existing prediction methods
table
 <dig> shows the the mean f-measure value for each method on the s-strand <dig> dataset, along with bootstrap confidence intervals calculated as explained in the previous section, which are also shown graphically in figure
 <dig>  table
 <dig> shows the results  obtained from permutation tests for each pair of methods. as can be seen from this table, the only statistically insignificant performance differences were observed between t <dig> and contrafold  <dig> , and between contrafold  <dig>  and nom-cg.

f measures and 95% confidence intervals, calculated using bootstrapping, and shown in parentheses.

spearman correlation coefficients for the f-measure values of of pairs of prediction algorithms over the s-strand <dig> dataset.

consistent with previous work
 <cit> , we found that the oldest algorithm, t <dig>  achieves a mean f-measure just below  <dig> . contrafold  <dig>  performs slightly better than t <dig> on our benchmark set, but the performance advantage is not statistically significant; we believe that the reason for this lies primarily in the fact that it was trained on a small set of rnas not representative of the broad range of structures found in s-strand <dig>  maxexpect and centroidfold do perform significantly better than t <dig>  but fall short of the performance achieved by contrafold  <dig> . the latter method was trained on the s-strand <dig> dataset, which partly explains why it, exactly like nom-cg, achieves an average f-measure that is  <dig>  higher than that of contrafold  <dig> .

the methods recently developed by andronescu et al., dim-cg, cg∗, bl∗ and bl-fr∗, each achieve significantly better performance than any of the previously mentioned methods; although the confidence intervals obtained for these methods show some overlap, the respective differences in mean f-measure are all significant. the best of these methods, bl-fr∗, represents an improvement of more than  <dig>  in average f-measure over t <dig>  and of almost  <dig>  over contrafold  <dig> .

performance correlation
for an ensemble-based approach like averna to work well, the set of component prediction algorithms need to have complementary strengths, as reflected in less-than perfect correlation of prediction accuracy over sets of rna sequences. as can be seen in table
 <dig>  the pairwise performance correlation between the procedures we considered in our study is not very strong . figures
 <dig> and
 <dig> illustrate this further by showing the correlation in f-measure across our set of rnas for the two pairs of algorithms whose average performance does not differ significantly, t <dig> and contrafold  <dig> , and contrafold  <dig>  and nom-cg, respectively. 

performance of averna
after optimizing the weights on our training set of rnas, we found that there was no statistically significant difference between the predictions of avernadp and avernagreedy on the s-strand <dig> set . because of its substantially lower run-time requirements, especially during training, we therefore decided to focus on avernagreedy for the remainder of our study, and we refer to this variant simply as averna.

as can be seen in table
 <dig>  averna achieved an average f-measure of  <dig>  on s-strand <dig>  compared to  <dig>  obtained by the best previous method, bl-fr∗.

moreover, even when assessing averna on a test set obtained by excluding the  <dig> sequences used for parameter optimisation from s-strand <dig>  it achieves significantly higher prediction accuracy than any of its constituent algorithms. we note that although this performance improvement might appear to be modest, it is about as much as the difference between bl∗ and bl-fr∗ and, according to a permutation test, statistically highly significant .

p-values obtained from permutation tests to determine the statistical significance of performance differences  between prediction algorithms. all p-values larger than a standard significance threshold of  <dig>  are bolded, indicating cases where the performance differences are insignificant.

to study averna’s performance on sets of rnas of different types and provenance, we optimised the parameters for averna on subsets of s-strand <dig>  from which one of the  <dig> classes that make up the rna strand database had been excluded, and then tested on the excluded class only, such that there was not only no overlap between training and test set, but also very little similarity. this is a situation where many machine learning techniques are known to perform quite poorly. the results from this experiment, shown in table
 <dig>  indicate clearly that, even in this very challenging setting, averna performs very well: only on  <dig> of the  <dig> classes, averna performs significantly worse if trained under exclusion of that class, and in the two remaining cases, the loss in accuracy was only about 2% .

f-measure values for different algorithms for different classes in the s-strand <dig> dataset. averna-i has been trained on 20% of the given class sampled uniformly at random, and the overall f-measure for the entire class is reported. averna-e has been trained on 20% of s-strand <dig> excluding the given class, and the f-measure for the given class is reported.

we further note that, as per the results shown in table
 <dig>  prior to averna, the best energy-based prediction algorithm varied between rna classes. on the other hand, averna was found to not perform significantly worse than the previous best method on any of the  <dig> classes, and in  <dig> of them , it performed significantly better. this suggests  that averna is likely to perform at least as well as other general purpose energy-based secondary structure prediction algorithms on previously unseen classes of rnas. furthermore, we also optimised averna on a small part of each of the  <dig> classes and then evaluated it on the entire class; the results of this experiment, also shown in table
 <dig>  indicate that by training a generic version on the broader set of sequences described earlier gives surprisingly good and robust performance – only for  <dig> of the  <dig> classes  the respective class-specific version of averna performs significantly better and in one class  it performs worst. table
 <dig> also shows the mean sequence length for every class of rnas and provides clear evidence that averna’s performance relative to its constituent algorithms does not deteriorate with increasing sequence length.

one interesting property of averna  is that the trade-off between sensitivity and ppv can be easily and intuitively controlled by the threshold θ∈ : for high θ, only base pairs are predicted for which there is high agreement between the procedures in a, and therefore, we expect relatively few false positive predictions at the cost of relatively many false negatives, while for low θ, even base pairs predicted by very few procedures in a tend to be included in the overall prediction, leading to relatively many false positive, but few false negatives. contrafold  <dig> , contrafold  <dig> , centroidfold and maxexpect also afford control of this trade-off, via the parameter γ∈ , but in a less intuitive manner.

figure
 <dig> illustrates the trade-off between sensitivity and ppv for all of these algorithms and shows clearly that overall, averna dominates all previous methods, and in particular, gives much better results than the previous best algorithm that afforded control over this trade-off, contrafold  <dig> . we note that, in all cases, as a procedure becomes increasingly more conservative in predicting base pairs, eventually, both sensitivity and ppv drop ; we believe this to be a result of the high detrimental impact of even a small number of mispredicted base pairs when overall very few pairs are predicted.

ablation analysis
the results of the ablation analysis we conducted to study the relative impact of the various component prediction procedures in a on the performance of averna  are shown in table
 <dig>  the top  <dig> rows contain the weights assigned to each algorithm; cases in which a procedure from a was dropped during the optimisation process are indicated by a value of zero. the bottom three rows show the value of threshold θ and the average performance on the training and test sets, respectively.

each data column corresponds to one stage of the ablation analysis, with the  weights of each prediction algorithm included in the ensemble shown in the top part of the table, followed by the  pairing threshold and the training and testing performance  in the bottom part.

it is interesting to note that although bl-fr∗ has a weight of over 40% in the full ensemble, excluding it leads to a rather modest drop of only  <dig>  in average f-measure, and this drop in performance is the highest caused by removing any single procedure from the full set a. similarly, the decreases in performance as additional procedure are removed, are mostly quite small. this indicates that, within the set of prediction procedures we considered here, there is not only sufficient complementarity in the strength of individual procedures to obtain benefits from the ensemble-based approach, but also enough similarity in strength between some of the procedures to permit compensating for the removal of one by increasing the weight of others.

as seen in table
 <dig>  up to the point where only one procedure is left in a, the performance of averna  is always higher than that of any of its constituents, indicating the efficacy and robustness of our ensemble-based prediction approach.

training set selection
clearly, averna’s performance depends on the training set that is used as a basis for optimising its weight parameters. to study the effect of training set size on performance , we generated  <dig> training sets of size  <dig> and  <dig>  as well as one training set of size  <dig> and one set of size  <dig>  we then optimised averna  for each of these sets and measured the performance obtained on the full s-strand <dig> test set. as can be seen from the results of this experiment shown in the table
 <dig>  decreasing the training set size from  <dig> to  <dig> lead to a modest drop in mean f-measure by  <dig> , and further decrease to  <dig> caused a larger drop by  <dig> . on the other hand, increasing the size of the training set from  <dig> to  <dig> merely resulted in a very small performance improvement of less than  <dig> . this indicates that, while it is important to use a reasonably large and diverse training set, at least for the set of prediction procedures considered here, there is only very limited value in using sets larger than that of size  <dig> we used for all other experiments.

mean f-measure on s-strand <dig>  with 95% confidence intervals shown in the last column. for the bottom two rows, training set size was sampled  <dig> times uniformly at random, and the median  of the prediction accuracies from these samples are reported, along with confidence intervals for the medians.

we note that we did not use the training set developed by andronuescu et al.  in the context of energy parameter estimation, primarily because many of the prediction procedures we study here have been optimised on that set . we also note that all training sets we considered were obtained by random uniform sampling from the full s-strand <dig> set.

additionally, in table
 <dig> we have reported the f-measures of testset <dig>  a new testset which consists of all members of s-strand <dig> which have not been used by averna or any of the individual algorithms for training purposes. permutation tests on this new test set  confirm that averna remains significantly more accurate than the other algorithms.

discussion
to no small extent, our work presented here was motivated by the observation that in many cases, the differences in accuracy achieved by rna secondary structure prediction methods are quite small on average, but tend to vary very significantly between individual rnas
 <cit> . while this is not surprising, it suggests that care should be taken when assessing different prediction methods to ensure statistically meaningful results, and that potentially, benefits could be derived from combining predictions obtained from different methods. the statistical procedures we use in this work make it possible to assess statistical significance in a well-established, quantitative and yet computationally affordable way, and our averna procedure provides a practical way for realising the benefits inherent in a set of complementary prediction methods.

our results demonstrate that there has, indeed, been steady progress in the prediction accuracy obtained from energy-based rna secondary structure prediction methods. the fact that contrafold  <dig>  provides no statistically significant improvement in accuracy over the standard t <dig> energy model when both are evaluated on our large and diverse set of reference structures needs to be viewed in light of the fact that contrafold  <dig>  was trained on a limited set of rna structures from the rfam database. the fact that contrafold  <dig> , which was trained on the the same larger and richer set used by andronescu et al. <cit> , performs much better further highlights the importance of the training set used as a basis for empirically optimising the performance of prediction methods. it is interesting to observe that the performance difference between contrafold  <dig>  and nom-cg, which are trained on the same set of references structures, are insignificant, which indicates that both methods are equally effective in making use of the information inherent in this set. however, nom-cg, thanks to its additional use of thermodynamic data, produces a physically plausible energy model, while the probabilistic model underlying contrafold  <dig>  does not produce realistic free energy values.

we further interpret the fact that dim-cg, cg∗, bl ∗ and bl-fr∗ all perform significantly better than contrafold  <dig>  as evidence that the thermodynamic data used by the former methods can effectively inform methods for optimising prediction accuracy based on data. our statistical analysis provides further support for the claim that the computationally more expensive boltzmann likelihood parameter estimation method leads to better results than the constraint generation method, and that the additional use of probabilistic feature relationships enables further significant improvements
 <cit> .

the accuracy results we obtained for the maxexpect procedure
 <cit>  and for centroidfold <cit>  are markedly lower than those reported in the respective original studies, mainly because our evaluation is based on a more extensive set of reference structures. however, we note that the underlying approaches of maximizing expected base-pair accuracy and γ−centroid estimators can in principle be applied to any prediction method that produces probability distributions over the secondary structures of a given sequence. we therefore expect that these ideas can eventually be used in combination with parameter estimation methods, such as the ones that gave rise to the cg ∗, bl∗ and bl-fr∗ parameter sets.

the results of our correlation analysis revealed that prediction methods whose accuracy over the entire benchmark set does not differ much  show large differences in accuracy on many individual rnas. consistent with earlier observations that predictions that are slightly suboptimal according to a given energy model can sometimes be much more accurate , we conjecture that this is a consequence of systematic weaknesses  and inaccuracies  in the energy models underlying these procedures. particularly when using automated methods for optimising the parmaters of a given energy models, such weaknesses and inaccuracies could easily lead to multiple solutions that show similar performance on average, but give very different results on many individual rnas.

this situation, while at the first glance somewhat unsatisfactory, provides the basis for our averna approach, which obtains more accurate predictions by means of weighted combination of the predictions obtained from a set of given prediction procedures. while our study is focussed on the prediction of pseudoknot-free mfe structures, we note that the weighted sum calculation performed by averna on base pairing matrices naturally extends to methods that produce base pairing probabilities and to pseudoknotted prediction methods. in the latter case, the calculation of the weighted probability matrix p proceeds exactly as in the pseudoknot-free case, but the procedure used for structure inference would have to be modified to produce pseudoknotted mea structures. in the former case, probability matrices are used instead of boolean matrices, and the result of the calculation would be normalised to yield a well-formed base pairing probability matrix.  we pursued neither of these directions here, because currently, the number of high-accuracy prediction procedures for pseudoknotted rna structures of base-pair probabilities is more limited and because the development and assessment of extensions of averna to those cases pose challenges that are beyond the scope of this work, but we strongly believe that these directions are very promising and should be explored further in the future.

we note, however, that averna as presented here already realises an advantage usually found only in approaches that produce base pairing probabilities: an easy and intuitive way for assessing the confidence with which certain bases are predicted to pair or remain unpaired, by means of inspecting the entries of the probability matrix p. values close to one indicate base pairs that are predicted consistently by many of the underlying prediction procedures, and values close to zero indicate bases that are consistently predicted to be unpaired. intermediate values indicate base pairings for which there is more disagreement between the given prediction procedures. from the fact that by thresholding these values, the sensitivity and specificity  for predicting base pairs can be increased quite substantially , we conclude that the set of prediction procedure used by averna in this work is sufficiently diverse to allow for this interpretation. the threshold parameter θ controls the trade-off between sensitivity and ppv in an intuitive way. it is conceivable that even higher sensitivity and ppv values can be obtained by optimising the weight parameters of averna specifically for that purpose .

CONCLUSIONS
the ensemble-based rna secondary structure prediction method averna introduced in this work not only improves over existings state-of-the-art energy-based methods, but also holds much promise for the future. averna can make use of arbitrary secondary structure prediction procedures; in particular, as demonstrated here, it can be used to combine both mea and mfe structures. we expect that by adding new prediction procedures to the set used by averna, even better ensemble-based predictions can be obtained. it is conceivable that eventually, a prediction procedure becomes available that dominates all previous methods, in the sense that it provides predictions as least as accurate as these on all rnas of interest, and in that case, the ensemble-based prediction approach of averna would not realise any additional gains. based on our assessment of existing methods, and considering the weaknesses and inaccuracies known to exist in all current energy models, we do not expect this situation to arise in the foreseeable future. the results of our ablation analysis further supports the view that further increases in prediction accuracy achieved by the ensemble-based prediction approach underlying averna are likely to arise as new prediction procedures become available, since – as seen in table
 <dig> – that was the case when adding new procedures to sets of previously known procedures in the past.

in fact, bl-fr∗ was introduced when averna was under development and achieved an f-measure of higher than the version of averna available at that time. including bl-fr∗ in averna produced the version of averna studied here, which – as expected – performs significantly better than bl-fr∗. this suggests that averna not only represents the state of the art in secondary structure prediction at the time of this writing, but is likely to remain so, as improved prediction algorithms and energy models are developed and added to the generic ensemble-based approach.

it should be noted, however, that in cases where additional information about the specific secondary structure of a particular rna is available , prediction methods that utilise this information should be expected to achieve higher accuracies .

we see several avenues for future work: here, we focused on pseudoknot free structures, but the general framework  can be applied to pseudoknotted structures as well once a wider range of these algorithms are developed. similarly, our framework can be applied to algorithms that are able to calculate base-pair probabilities  or to algorithms that are able to predict several sub-optimal structures. new algorithms  or different configurations of the existing algorithms  can be included in averna. we showed that the correlation between the predictions of different algorithms is not very strong. these algorithms can be studied to identify their strengths and weaknesses to provide guidance to the end-users. alternatively, this information could be used to design an instance-based selection algorithm that instead of combining the predictions of all of the algorithms, either selects the most suitable algorithm for each sequence or selects a number of candidates for averna to combine.

competing interests
both authors declare that they have no competing interests.

authors’ contributions
hh conceived the original idea. na and hh designed the methodology, conceived the experiments, interpreted the results, and wrote the manuscript. na implemented the methodology and performed the experiments. all authors read and approved the final manuscript.

supplementary material
additional file 1
supplemental information. a pdf file with supplementary figures and tables as described in the main text.

click here for file

 acknowledgements
we thank anne condon and mirela andronescu for their insightful comments on this work, and dave brent for help with setting up the web server for the averna software. this work was supported by a msfhr/cihr scholarship to na, a university of british columbia’s graduate fellowship to na, and by an nserc discovery grant held by hh.
