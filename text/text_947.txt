BACKGROUND
considered for a long time to be insignificant variations around a significant mean, stochasticity in gene expression is now clearly demonstrated to be important in many situations and in many organisms  <cit>  and to participate in various biological processes  <cit> , as formerly proposed  <cit> . the molecular bases of this stochasticity are multiple and constitute now a major subject of investigation. they are frequently distinguished between intrinsic and extrinsic stochasticity  <cit> . although this distinction requires a clear statement of the considered system  <cit> , this system is often  implicit and corresponds to what we would call a "node" in a regulatory network. then, extrinsic and intrinsic stochasticity are respectively the propagation through this node of global fluctuations of the concentration of transcription factors , rna polymerase ..., and the generation of randomness due to the molecular events, discrete and probabilistic in nature, that take place within the system .

a major challenge in this field is to isolate and characterize the various sources of stochasticity in different organisms  by theoretical  <cit>  and/or experimental means  <cit> . stochasticity gets significant when some discrete molecular events become rare. typically, when rna or proteins are in low copy number, synthesis and degradation events are rare and represent important variations relatively to the total amount of these molecular species. this generates a so-called poisson noise at both rna and protein levels  <cit> . also, because at low copy number tfs cannot be considered to be uniformly distributed, spatial proximity of the few tfs to the promoter becomes important and contributes to enhance stochasticity  <cit> . finally, and independently of molecule concentrations, the transition of the promoter between different states  provokes heterogeneity in transcription  and appears to be a major source of stochasticity  <cit> .

the vast literature describing the molecular machinery involved at the promoter reports very elaborate properties. the various classes of molecules involved in transcriptional regulation show quite wide-ranging but surprisingly short residence time  within complexes  <cit> . moreover, despite this rapid turnover of most  molecules, eukaryotic regulatory complexes also demonstrate a clear slow-timescale activity: they proceed through a periodic pattern of occupancy level by molecules, conformal changes and epigenetic modifications with a precise timing and a period in the order of few tens of minutes  <cit> . this phenomenon referred to as the cyclical recruitment, occupancy pattern or loading profile of molecules on the promoter, or even as chromatin breathing. this provides a new vision of regulatory complexes as highly dynamic structures in constant assembly and disassembly, with alternative functionally redundant pathways of formation and with phenomena occurring concomitantly at different timescales  <cit> . an important point is that, in both prokaryotes  <cit>  and eukaryotes  <cit> , the association/dissociation of most molecules involves cooperation and competition with the other molecules bound to the promoter. also, alternative conformations , post-translational covalent modifications of histone tails residues  and dna methylation are other factors that influence and are influenced by the molecules present on the promoter in a dynamic, highly combinatorial and possibly energy-dependent manner  <cit> . these combinatorial aspects also take place in rna polymerase recruitment  <cit>  and provides the promoter with a variety of levels of transcriptional competency  <cit> , far from the binary vision of all-or-nothing active/inactive genes. all this elaborate molecular interplay provides the regulatory structure with a complex dynamics and certainly have major outcomes on stochasticity of gene expression. two-state on/off promoters with exponential switching times  <cit>   have been used for a long time and gave many valuable insights into the importance of promoter dynamics. beyond this simple description, few authors recently focused on more precise descriptions of promoters from the viewpoint of stochastic gene expression  <cit> . these studies revealed interesting results but remained focused on specific features  or on restricted systems  so that general principles on the capacity of regulatory molecular interplay remain mostly unexplored. recently, the stochastic dynamics of a eukaryotic promoter has been modeled considering the interplay between tfs and chromatin modifications and in relation with experimental data  <cit> . this work provided several important insights into the relation between single-cell and population dynamics and showed that the approach is very promising. however, being essentially based on simulations, the understanding of the structure of the dynamics and all its potentiality as well as parameter explorations remain more limited than when using an analytical approach. moreover, the very synthetic metrics commonly used in studies of stochastic gene expression  miss most of both steady-state and dynamic aspects of the system's activity. here, we employ more comprehensive measures such as power spectra or autocorrelations  <cit>  and full distributions  <cit>  that are known to reveal many more relevant features. a power spectrum is a measure that describes the temporal fluctuations of a signal  by revealing its frequency content. for instance, a peak in a power spectrum at a given frequency tells that the considered signal tends to repeat itself periodically . on the opposite, a plateau up to a given frequency followed by a decrease tells that the signal fluctuates aperiodically with a typical correlation time as short as the plateau spans over high frequencies.

we first present a generic promoter-centered model of the stochastic expression of a single gene - that can represent arbitrary regulatory systems from prokaryotes to eukaryotes - and describe its spontaneous activity in terms of power spectra, normalized variance and full distribution. it reveals that a single gene can demonstrate the same type of complex dynamics as those that were previously identified at the network-level . in particular, it can reproduce with realistic parameters the periodic occupancy patterns observed experimentally on eukaryotic promoters and highlight the central role of energy-dependence in this context. then we show that instantiation into minimalist systems can help to identify novel properties  and verify their applicability to larger and more biologically plausible systems. finally, we show how tf concentration can modulate many aspects of the promoter activity in a highly complex and flexible manner, suggesting the transcriptional regulation as a central piece for the cell to control and take advantage of stochasticity. we discuss our results and their theoretical and experimental implications in different fields.

methods
dedicated to the study of the impact of stochastic promoter dynamics on gene expression, this model  describes the molecular events of various sorts occurring at the promoter. mechanisms subsequent to transcription initiation are kept simple  but explicit so that we can assess how promoter stochasticity propagates up to rna and protein levels and confronts to other sources of gene-intrinsic stochasticity. the reader can refer to the additional file  <dig> for an extensive description of the model. for simplicity, we only give here a brief description of a simplified version. however, all derivation and conclusions of this paper stand for both versions. the following model shares some similarities with previous models  <cit>  and can be solved as an instance of generic techniques  <cit>  or simulated using generic frameworks  <cit> . we highlight here the key difference in its definition, interpretation and resolution.

molecular interplay at the promoter - kinetic formulation
we first consider tf molecules associating with and dissociating from the promoter. as we will see, these can actually represent many other aspects of regulatory complexes. we consider an arbitrary number n of tfs, noted f ∈ ℱ . the set of tfs that are bound to the promoter at a given instant  is referred to as the promoter state and noted s ∈ {ø, a, b, ab, c, ac, ...}. classically, a tf a at concentration  binds and unbinds on/from its target site with rates  kon and koff respectively. however, because of cooperation and competition  <cit> , the association and dissociation constants kon and koff of any tf actually depend on the combination of all the other tfs present on the promoter. we define the n × 2n matrix k <dig> summarizing the association and dissociation constants of each of the n tfs and for each of the 2n states.  describes the transition from state s to state s ⊖ f . multiplying each association rate by the concentration  of the tf that binds, we obtain the n × 2n matrix k describing all the transition rates of the weighted directed graph of promoter states . to focus on gene-intrinsic stochasticity, any source of gene-extrinsic stochasticity is avoided by considering tfs to be uniformly distributed in space and in constant concentration, so that the n-vector f ∈ ℱ of tfs' concentrations is a parameter of the model. this generic description can represent arbitrarily complex relations of combinatorial cooperation/competition and kinetic influence.

although for simplicity this short description of the model as well as the examples in this paper do not consider tfs associating and dissociating simultaneously as a complex , the model can actually account for these transitions . the influence of considering such reactions is discussed .

combinatorial cooperation/competition also takes place in rna polymerase recruitment and provide each promoter state with a certain competency to initiate transcription  <cit> . this is described more accurately than the binary view of on/off promoter activity, by a 2n-vector ρ of state dependent transcriptional efficiency.

subsequent steps of gene expression
as in most models of stochastic gene expression, rna and protein levels  and p respectively) follow classical stochastic birth-and-death processes with instantaneous and first order reactions . the time-dependent transcriptional efficiency of promoter x determines the synthesis rate of rna molecules which, in turn, degrades with rate γ. protein level p is driven by the translation of rna molecules at rate  and a degradation rate  . implications of the very usual simplifications of instantaneous transcription and translation and first order degradations will be discussed .

energetic signification
regulation is classically approached with thermodynamic methods  <cit> . we show that our model can be expressed in energetic terms and constitute a generalization of these approaches by extending the range of systems that can be represented  and the type of metrics that can predicted . the usual thermodynamic formulation of cooperative and competitive association/dissociation of tfs  <cit>  is equivalent to assign a gibbs free energy to each promoter state. for our system, it corresponds to a 2n-vector g <dig> in the standard condition . this representation allows one to predict the equilibrium steady-states  and has been widely used to investigate the mean aspects of prokaryotic regulation  <cit> . but it has the drawback to restrict the analysis to energetically-closed systems and, not carrying any kinetic information, it forbid any investigation of the stochastic aspects of expression.

for this energetic formulation to be equivalent to the kinetic one, we have to consider an additional set of energy values that are difficult to access experimentally  <cit> , namely the energy of the activation barrier for each reaction. representing them by the n × 2n matrix e <dig>  the energy that must be overcome for reaction s → s ⊖ f to occur is  - . the kinetic constants k <dig> can then be obtained as . this reformulation allows us to explicitly make the distinction between open and closed systems . for a closed system, nothing else than tfs and promoter dna are involved and the energy of the activation barrier is the same in both directions of each reaction s ⇄ s ⊖ f so that . for an open system, energy-dependent reactions  are possible, resulting in  . it can be shown that it is only in the case of an open system that the transition graph  can contain directed cycles so that the detailed balance property of the chemical system  does not hold  <cit>  . this property has meaningful biological implications in the context of promoter dynamics and is most likely an essential feature of eukaryotic promoters .

description ability
many biologically relevant features of regulatory systems can be easily represented with this generic model only as a matter of parametrization. in particular, it can account for multiple tfs competing for the same binding site or a tf having multiple binding sites . the general formulation of the model  allows one to represent the association/dissociation of molecules either on their own or within complexes of various composition. this is an essential aspects of most ligand-receptor regulated genes  where the ligand modifies the receptor's affinity with dna and ability to recruit different cofactors. moreover, what was so far considered a tf molecule bound or not can be generalized to represent other aspects of the state of a promoter: alternative conformational states  and the status of histone tail residues . furthermore, these epigenetic factors can be represented to be modified by explicit remodeling complexes and histone modifying enzymes, taking into account their essential energy-dependent and nearly irreversible nature. also, the affinity and the enzymatic/remodeling activity of any molecule can be defined to depend on these various epigenetic factors in a combinatorial way in order to account for all the potentiality of the histone code. for instance, one can set parameters so that the acetylation of a given histone tail residue can only occur in the presence of a given histone acetyletransferase  with specific cofactors and corresponds to an highly energetic reaction. the property of epigenetic changes and promoter occupancy by tfs to occur cyclically on eukaryotic promoters  <cit>  can be represented with various sorts of deviations from an ideal sequential recruitment  in overview of derivations and additional file  <dig>  § <dig> ). in the results section, we show that this behavior is directly due to the energy-dependent modifications of chromatin that our model can represent. other situations of interest can be described such as multiple copies of the same gene  or two genes in the same chromatin context , reproducing a situation that has demonstrated experimentally that chromosome positioning and chromatin dynamics is a key factor of noise in eukaryotic gene expression  <cit> .

overview of derivations
here we provide a short description of the theoretical derivations of this paper. for details, the reader can refer to the additional file  <dig> .

several generic approaches have been proposed for deriving steady-state and/or spectral indicators of the stochastic activity of an arbitrary  reaction network  <cit> . these techniques are based on a reformulation of the chemical master equation  in terms of moments or on its approximation into a langevin equation which is then solved by different methods . these powerful methods could be applied to our system and may lead to similar expression of noise power as ours. however, the methods we employ here makes no approximation of the cme, thus providing exact results. it takes advantage of the fact that the cme for the whole system can be decomposed into a  promoter-cme from which rna and protein levels fluctuations are deduced using inhomogeneous poisson birth-and-death processes. the promoter-cme is solved as a continuous-time markov chain with standard eigenvalues-decomposition techniques  <cit>  that have the great advantage to result in expressions of power spectra and normalized variances in terms of simple elementary components that reveal the structure of the dynamics. note that the application of the previously mentioned generic methods on an arbitrary system as the one we consider would also require to solve a linear system or an eigenproblem.

previous models of gene expression that incorporate a detailed description of promoter states were either solved for the steady-state mean  <cit>  or moments  <cit>  of expression or simulated with a gillespie algorithm  <cit> . although these simulation studies provided valuable insights into the dynamic aspects of promoter stochastic activity, the lack of analytical results do not allow for complete understanding of the dynamics and extensive exploration of parameters. thus the dynamic aspects of promoter stochastic activity  remain partially unexplored from the modeling point of view and the steady-state ones were not described in terms of distribution . here, we derive both power spectra and distributions for an arbitrary regulatory structure.

in our model, the time-dependent vector ϕ describing the probability for a promoter to be in each state evolves according to the cme   

where the 2n × 2n-matrix m represents the state-to-state transition rates . diagonal elements of m are set so that .

the forward solution ϕ of the cme is simply obtained from the decomposition of m into eigenvalues λi and eigenvectors Λi. combined with ρ, it gives the autocorrelation of process x   

from which is deduced the power spectrum sx .

in the general case, the eigendecomposition of m is obtained numerically, but we provide analytical expressions in the case of  a two-states promoter and  a homogeneous isolated directed cycle with backward reactions, ie. a cycle of n states noted  

in that case, the eigendecomposition   

shows that the spectrum of m consists of n eigenvalues regularly spaced on a circle tangent to the imaginary axis at  <dig> for an irreversible cycle . it flattens as an ellipse toward the real axis as backward reactions kb increase. therefore the coherence of the periodic dynamics increases with the number of steps and the ratio kf/kb.

the steady-state rate of free energy change Ė  is obtained by noticing that any reaction s→ s, occurs at a rate Λs,0ms',s and results in a change of free energy of kbt log ms',s/ms,s'.

power spectra sr and sp are obtained by remarking that r ) is a birth-and-death process with birth rate being an inhomogeneous poisson process with instantaneous rate x ). normalized variances σx2/⟨x⟩ <dig>  σr2/⟨r⟩ <dig> and σp2/⟨p⟩ <dig> are deduced from power spectra using the property .

distributions of rna levels are obtained by solving numerically the system of equations corresponding to the steady-state of the cme that considers both the promoter and the rna level   

where dρ is the diagonal representation of ρ and the sth element of ϕr is the probability to have r rna molecules and the promoter in state s.

RESULTS
with this model that can represent arbitrarily complex regulatory system from prokaryotes to eukaryotes, we show that the molecular interplay can cause a single gene with constant concentrations of tfs to demonstrate various forms of complex activity  that are usually found at the network-level. we describe these activities in relation with experimental observations from the literature and highlight underlying mechanisms that might cause them and properties that they might provide.

spontaneous activity of an arbitrary regulatory structure
we show that the power spectrum sx of transcriptional efficiency x  can be simply written as the sum of 2n simple elementary components    

with  from the decomposition of the transition rate matrix m into eigenvalues λi  and eigenvectors Λi.

each eigenvalue λi that lays on the real axis  corresponds to an aperiodically fluctuating signal with characteristic relaxation time -1/λi determined by its position on the axis . for instance, the purple eigenvalue on figure 2b corresponds to the purple component on figure 2a <dig>  eigenvalues that are not on the abscissa axis come in pairs of conjugates  and correspond to periodic stochastic signals which oscillating frequency |im/2π| is given by the ordinate of the eigenvalue . the thinness of the peak in the power spectrum of the component is an important characteristic of the oscillatory behavior. it is described by the coherence factor  

that corresponds intuitively to the number of oscillations after which two initially synchronized promoters are significantly desynchronized. this can be directly measured on experimental data such as obtained by chromatin immunoprecipitation   <cit> , laser cross-linking  <cit>  and fluoresence microscopy techniques  <cit> : the damping of the oscillations upon synchronous activation of a large number of identical promoters reflects the desynchronization among the population due to the stochastic timing in each individual cell  <cit> . gray lines on figure 2b represent a coherence factors of  <dig>  and  <dig>  the most coherent eigenvalues  have a coherence of ~ <dig> 

it is important to mention that the repartition of eigenvalues on the complex plane  - called the spectrum of matrix m - provides a picture of the whole dynamics of the promoter. indeed, the power spectrum of any observable  can be derived similarly to sx  and results from the same set of eigenvalues.

interestingly, the spontaneous activity of a single-gene with all input constant  is very similar to what has been indentified at the network-level  <cit>  considering the interaction of several  genes. this shows that single nodes of gene regulatory networks can be much more complex than they are usually considered.

the example provided in figure  <dig> to illustrate the generic decomposition eq  <dig> aims at reproducing the behavior of an eukaryotic promoter with realistic parameters and timescale relationships. experimental studies of eukaryotic promoter dynamics reveal slow oscillatory patterns of occupancy and chromatin modifications with a period in the order of few tens of minutes  <cit>  and a rapid turnover of tfs in the order of tens of seconds  <cit> . the transition rates k <dig> were obtained using a stochastic optimization algorithm that promotes a coherent oscillatory behavior at a timescale significantly slower than the rest of the dynamics, based on criteria regarding the spectrum of m and with concentration of tfs set in the physiological range for eukaryotes  <cit> , ie.  <dig> nm . the resulting system demonstrates a strong cyclic activity with a period of  <dig> min while the fastest events occur at a timescale of less than  <dig> s . however, these fast events do not necessarily correspond to tf residence times and the question of how a slow global activity arises from the rapid dynamics of the molecules remains open. most propositions from the literature suggest that at least some of these factors  are slow  <cit> .

within the framework of our model, the particular ideal system consisting in a cycle of homogeneous directed transitions  produces a circle of eigenvalues in the spectrum of m , similarly to what results from the optimization algorithm . the shape and number of points of this circle indicate that the promoter progresses along a 22-steps cycle of strongly directed transitions. in comparision,  <cit>  supposes a priori a cycle of  <dig> of such transitions and is also able to reproduce oscillations with simulations. note that the further development regarding energy consumption we will make in this paper also argue for the physical realism of the system of figure  <dig> 

we described the spontaneous fluctuations of promoter activity for any arbitrary promoter by a modal decomposition of the power spectrum sx  and illustrated it with an eukaryotic example . now we will focus on how these fluctuations propagate through the rna and protein levels.

transmission of promoter stochasticity to rna and protein levels
both rna and protein levels r and p follow an inhomogeneous birth-and-death process which inhomogeneous birth rates are x and r  respectively. from this scheme, we derive the power spectra of rna and protein levels  and sp ) from sx :   

with , ⟨r⟩ = ⟨x⟩/γ and ⟨x⟩ = β <dig>  this expression clearly separates the different gene-intrinsic stochasticities and their physical principles from a dynamic viewpoint. in agreement with previous analyzes  <cit> , each of the two steps  result in  the addition of a shot noise  due to the finite number of random birth-and-death and determined by rna and protein abundance and  a low-pass filtering due to time averaging determined by rna and protein life-times .

transcript and protein life-times, as reported by global analyzes on the yeast transcriptome  <cit>  and proteome  <cit>  for instance, are broadly distributed: from  <dig> min to  <dig> min for rna half-lives and from less than  <dig> min to more than a day for protein half-lives. interestingly, in regard with the typical period of 40~ <dig> min of promoter cycling observed in vivo  <cit> , these life-times can either dampen the promoter oscillations or let it propagate up to the protein level. indeed, several studies showed that the rna level can display the same cyclical patterns as observed on the promoter  <cit> . in the example of figure  <dig>  transcript and protein life-times were chosen rather short  and oscillation can be observed clearly in rna fluctuations and slightly in protein fluctuations. another global analysis in yeast  <cit>  showed that rna abundance ranges from less than  <dig> copy per cell to a hundred and that proteins are typically a thousand times more abundant. in figure 1a <dig>  where rna and protein abundances are ⟨r⟩ ≃  <dig> and ⟨p⟩ = 1000⟨r⟩, the oscillations are more important than the shot noises are. approaching  <dig> for rna abundance increases the shot noise level with respect to promoter fluctuations sx and leads to the regime where the noise of rna birth-and-death dominates.

noticeably, the derivation from power spectrum sp of the normalized variance  reads :   

an expression similar to the well-known expression due to j. paulsson  <cit>  who first provided such a clear separation, but considered a set of independent two-states genes. the time-averaging coefficients and poisson 1/⟨p⟩ terms directly result from the filters and shot noise terms in sp.

while power spectra describe the dynamic aspects of fluctuations , it cannot capture several important features that reside in steady-state distributions. we provide here a numerical method for finding the full steady-state distribution of rna molecules without any further simplification to the model . a previous analysis proposed a method for finding the set of moments with a similar generic model for the promoter  <cit> , but this does not reveal meaningful features such as multimodality and position/size/shape of the different modes as it will be illustrated in figures 3c and 4c.

power spectra, normalized variance and full steady-state distribution are complementary indicators that, being derived prior to instantiation of the model, provide a comprehensive description of any arbitrarily complex regulatory system.

cyclical promoter occupancy and remodeling, periodic activity and energy-dependence
our system is able to reproduce the strongly periodic activity that is observed experimentally on eukaryotic promoters  <cit>  and referred to as cyclical recruitment or loading profile . this arises when the graph of promoter states contains directed cycles . the very few previous works also accounting for this oscillating behavior with different modeling frameworks  <cit>  indeed relied on a similar mechanism. we show that the absence of directed cycle in closed systems imposes that all eigenvalues are on the real axis, thus forbidding any oscillation . the signature of cycles are circles of eigenvalues in the spectrum of matrix m , as in figure 2b for instance. as also remarked by  <cit>  but in less quantitative and/or generic terms, the essential resulting property is that the longer, the more directed and the more homogeneous the cycle, the more coherent the periodic activity.

the energetic formulation of the model  show that directed cycles are necessarily due to energy-dependent transitions in promoter state and that the more energy is consumed along the cycle, the more directed it is. the well-known property that energy-dependence is required for oscillations in metabolic networks  <cit>   can be transposed to our case .

this observation has important consequences on our understanding of promoter dynamics and stochasticity. indeed, the cyclical occupancy and remodeling profiles observed on eukaryotic promoters is highly coherent  <cit>  . in the light of our results, such a coherence requires the presence of cycles that  span over a very large number of states  and  are highly energy-consuming. this first point is strongly supported by the profusion of possible promoter states provided by the combinatorial patterns of histone tails modifications and nucleosome positioning  <cit>  and the alternate compositions of multiprotein complexes found on promoters  <cit> . the second point comes in good agreement with the fact that many atp-dependent chromatin remodeling complexes  and histone modifying enzymes  actively participate in the cycling behavior of active promoters  <cit> . moreover, atp depletion has been observed to totally suppress oscillations  <cit> . hence, the oscillatory activity observed on eukaryotic promoter cannot be explained without energy consumption, a feature indeed widely present on these promoters.

the very stereotyped case consisting in a cyclic sequence of homogeneous irreversible transitions  of overview of derivations and additional file  <dig>  § <dig> ) results in a highly coherent periodic dynamics. but, considering reactions irreversible, this system theoretically consumes an infinite amount of energy. also, in this ideal system, events of recruitment are perfectly ordered and sequential . away from this unrealistic case, when the whole set of kinetic constants of the promoter-state graph contains directed cycles with heterogeneous transitions, alternative pathways  and includes backward, incoming and outgoing transitions then the system can still demonstrate a periodic activity . similarly to the "preferentially random" scheme of  <cit> , although events do not follow a predefined sequence and display a significant level of randomness, they can still tend to occur in a preferred order and result in a periodic global pattern. as a result, organizing the molecular interplay to provide the promoter with a structured dynamics  has a clear energetic cost. the relevant measure reflecting this fundamental cost is the steady-state energy consumption rate:   

indeed, during the optimization process used to obtain the example of eukaryotic promoter, the energy consumption rate Ė increases along with the coherence. for the system shown in figure  <dig>  Ė equals  <dig> kbt.s- <dig>  the period of oscillations being  <dig> min and considering 20kbt for an atp hydrolysis in physiological conditions  <cit> , this energy consumption corresponds to the equivalent of ~ <dig> atp hydrolyzes per cycle. this is reasonable although real promoters are actually larger, more coherent and their energy consumption is certainly more important  <cit> .

however, although necessary, energy-dependence is not sufficient for a periodic activity and is not the sole factor influencing the extent of this phenomenon . hence, the correlation between structured promoter activity and energy-dependence is not direct, raising questions about their probably non-trivial evolutionary relation .

stochasticity can be induced by a high tf concentration
one possible use of this model is to identify a behavior of interest, isolate its minimal requirements and then test its applicability with realistic parameters and on larger and more biologically plausible systems. we give here an example of such use of the model.

as stochasticity is often due to the rareness of some discrete events, it is very commonly associated to low concentrations. however, we show that, in some situations, stochasticity can on the contrary be induced by a high concentration of a tf. the simplest system for this behavior to occur is described on figure 3a <dig>  it consists of a promoter with two tfs  where the transcription rate only depends on b. the only mutual influence between tfs is that b associates and dissociates more slowly when a is bound to the promoter. we used realistic parameter values similar to those reported by quantitative thermodynamics  <cit>  and single-molecule kinetics studies  <cit>  of bacterial regulation for concentrations , for bimolecular tf-dna residence times  and equilibrium constants  and for modification of activation energy upon interaction . rna and protein life-times are  <dig> and  <dig> min  <cit> . all parameters are summarized in table s <dig> of additional file  <dig> 

this simple system demonstrates not only that a tf can regulate the variance of rna and protein levels without influencing their mean , but more interestingly, that normalized variance can increase with the concentration of a tf . indeed, here it is at high concentrations of a that events influencing transcription  become rare and, as it has been known for a long time  <cit> , slow promoter dynamics result in strong variability. rna distribution goes from unimodal to bimodal as  increases . thus, the oversimplistic assumption that increasing the concentration of a tf necessarily reduces the stochasticity is not always valid.

moreover, this property appears to be quite robust when exploring all sorts of deviations from this ideal case , and even for a more complex regulatory system with a larger number of tfs and randomly drawn parameters .

simple molecular scenarios can be imagined that would give rise to this behavior. for instance, the shape of a tf  can be so that, when bound, it prevents other tfs  from association/dissociating from the promoter . another example would be to consider b the chromatin state and a a tf that binds to the same site as chromatin remodeling complexes. then, designing molecular constructions to verify this hypothesis experimentally appears to be promising.

potentiality of the molecular interplay
using this generic model and the prediction of the different indicators we provided allows us to explore in detail the activity of regulatory systems on large ranges of concentration. to illustrate the potentiality of steady-state and dynamic properties, we consider here two examples  dedicated to represent respectively a prokaryotic promoter - with typical features as in  <cit>  - and a eukaryotic promoter  - reproducing the periodic behavior as observed in  <cit> . although it is the expected behavior that complex activities can arise from large systems with many parameters, we show that such behavior can occur with physically realistic parameters and be due to relevant biological mechanisms. we further argue in discussion that several typical features of eukaryotic promoter are precisely those that give rise to a complex dynamics. we also show how this complexity is hidden by common measures and/or modeling frameworks and identify what kind of features can modulate or constrain it.

steady-state aspects
representing the behavior of a gene as a function of tf concentrations by a combination of hill functions is very common and often matches experiments  <cit> . however, we show that considerable complexity can be hidden beyond this apparently simple mean activity.

dynamic aspects
the dynamic aspects of promoter activity and in particular the periodic cyclical promoter occupancy and remodeling patters can demonstrate a complex concentration-dependent behavior. we showed earlier that the position of the eigenvalues λi  reflects the dynamics of the whole regulatory structure. each λi determines the correlation time of aperiodic fluctuations or the frequency and coherence of periodic fluctuations as elementary components of the global dynamics. since the matrix m depends on tf concentrations, the position of its eigenvalues change with the concentration of a tf. as illustrated on figure 5a with the same system as in figure  <dig>  these eigenvalues can demonstrate non-trivial trajectories. they describe how the temporal characteristics of the periodic loading patterns of molecules change with concentration of tfs and have a direct impact on the resulting transcriptional activity sx . indeed, the basic fact that the concentration of a given tf impacts its association rate not only affects the duration of specific states in the cycle , but it also changes the relative probability between the transitions leaving these states. this can have a large variety of effects: influencing the amount of backward reactions in cycles, the probability of outgoing transitions , the balance between alternative pathways within a given cycle, and even the commitment of the system between multiple dynamics. each one of these phenomena has its own effect on the dynamics. in simple ideal systems, these effects could be predicted, but in non-stereotyped system, they can all occur together at different points and with various intensities, resulting in a non-trivial and highly non-linear activity and providing the dynamics with a strong plasticity. indeed, eigenvalues move along trajectories that can include sharp bends and bifurcations  and with very variable velocity . also, we see that, in this context, energy consumption rate Ė is related but non-directly correlated to the periodic activity of the promoter and that other factors may play a role in their relation .

figures 5d and 5e present three different promoters obtained at different stages of the optimization process used to construct the system of figure  <dig>  the presented systems range from a very unstructured promoter where states have many in- and out-transitions  to a stereotyped system close to the homogeneous cycle as indicated by the clear circle on figure 5d <dig> and the fact that most states have a unique outgoing transition . the decreasing complexity observed along the optimization process suggest a tradeoff between the coherence of the periodic activity and the flexibility of its regulation. interestingly, it is at an intermediate level of structuring , where the system still retains a certain level of disorganization, that a promoter can achieve a significantly coherent dynamics that nonetheless demonstrates a complex concentration-dependent behavior. we argue in discussion that different features observed on real promoters correspond to this intermediate regime.

discussion
the promoter as a central piece in the control of stochasticity
stochasticity in gene expression can be advantageous in some situations and harmful in others  <cit> . therefore, it appears that it should take place at specific times , on specific genes and with a certain form. we showed how the dynamics of the regulatory structure can induce a large variety of stochastic activities on which a tight control can be exerted. other mechanisms identified at other stages of the expression process have been shown to influence stochasticity  <cit> , but none of them provide such a diversity and such a control. regulation has long been considered as a way to control the mean expression, but it results to be a very powerful and flexible tool for the cell to take advantage of stochasticity by modulating it depending on the context.

moreover, these capacities require no particular unusual molecular machinery and can be obtained in realistic parameter ranges. they only rely on common features of living systems such as protein-dna and protein-protein interactions, conformational changes, energy-dependent activity of molecules and, more specific to eukaryotes, modifications of chromatin structure and epigenetic state of histones. hence, controlling stochasticity is not only possible, but it also appears to be easy to achieve.

limitations and future work
pedraza et al.  <cit>  described the effect on σp2/⟨p⟩ <dig> of considering molecular memories  on a two-state on/off promoter  and on rna and protein lifetimes. our work can be viewed as a deep focus on the causes and consequences of the molecular memory that takes place at the promoter. but the fact that indeed rna and proteins degradations are not first order , but also that synthesis are not instantaneous  influences the shape of filters in eq  <dig> and hence the normalized variance. however, these phenomena only constitute deviations  from the global tendency that our simple description of these steps can capture.

protein-protein interactions can occur away from the promoter and can result in the binding of complexes to the promoter  as well as tfs unbinding as complexes . this is taken into account in the general version of the model . in that case, concentrations of complexes are not null and simply imply a larger set of kinetic constants than k <dig>  still, once the matrix m is constructed, all the mathematical derivations are strictly identical. off-promoter tfs associations/dissociations  determine the concentration of free tfs  and of complexes  so that varying the amount of one tf potentially results in variation of concentrations of all tfs and complexes. in particular, if on-promoter and off-promoter interactions are different, this results in the coupling of two different dynamics, leading to additional complexity in eigenvalues trajectories and providing even more flexibility for regulating the dynamic activity of promoters.

this model of gene expression focuses on intrinsic stochasticity of non-autoregulated genes. going further by considering extrinsic stochasticity and autoregulation could be achieved with various techniques  <cit> . in the light of the highly non-linear spontaneous behavior we showed, revisiting with the present model properties of signal transmission and stochastic resonance that have been identified with simple models of promoter  <cit>  can already be expected to reveal new properties of gene regulatory structures.

back to experimentation: what can be expected?
the in vivo activity of promoters can be explored experimentally as a function of tfs concentrations  <cit> . typically, setty et al.  <cit>  measured the mean rna levels of the lac operon of e. coli as a function of camp and iptg concentrations and interpreted their data in terms of hill functions. we showed that the steady-state stochastic aspects of expression  carry much more information . the normalized variance demonstrates a more characteristic profile than the mean level and the distribution itself carries several singularities , constituting a real signature of the promoter activity. indeed, different systems can be obtained showing a large variety of stochastic profiles for a strictly identical mean activity . however, inferring parameters from such measurements appears conceivable only for rather simple prokaryotic promoters for which some information is already partially known. nevertheless, it can reveal the kinetic information that is known to be difficult to obtain  <cit> . focusing on mean equilibrium activity, thermodynamic approaches can only infer ratios of pairs of kinetic constants  and therefore only state energies g <dig>  on the contrary, our approach can provide the kinetic constants themselves and reveal the energies of the activation barriers e <dig> 

the greater complexity of eukaryotic promoters certainly moderates the success of the previous approach. nevertheless their singular dynamics promotes the use of time-dependent measures - as obtained by photobleaching  <cit> , chromatin immunoprecipitation  <cit>  or laser-crosslinking techniques  <cit>  - and ask for the investigation of their concentration-dependent behavior. this would reflect, although partially, trajectories of eigenvalues λi . for instance, frequency and damping of cyclical occupancy patterns have been observed to change strongly with inducer concentration . information on the matrix spectrum can also be obtained by timelapse microscopy measurement to follow across time the amount of proteins or transcripts. giving access to spectral measurements such as sr or sp, this technique was shown to give mechanistic insight into the underlying system  <cit> .

this generic model can thus constitute a unified theoretical framework for all these very different techniques, making them complementary views of the same system.

high mobility, functional redundancy and alternate promoter states
it appears from our study that a very constrained system that consists in a unique cyclic sequence of events  in overview of derivations) results in a simple and stereotyped concentration control ability . on the other hand, a very random transition graph can demonstrate complex trajectories of eigenvalues but lacks of a coherent periodic activity . it is when the system has long directed cycles  but retains a certain level of disorganization  that a complex control of a sensibly coherent periodic activity can occur . it is worth noting that similar characteristics of molecular interactions have also been proposed to account for a different phenomenon: the generation of a slow population dynamics from rapid molecular kinetics  <cit> . interestingly, such properties correspond to what is actually observed experimentally  <cit> : within a slow and coherent periodic dynamics, multiprotein complexes are very unstable due to transient and dynamic interactions of most proteins and can therefore be in a variety of alternate composition. the various proteins species, which recruitment varies along the slow cycle, can have different mobility, therefore inducing kinetic heterogeneities in the slow cycling dynamics. also, different subcomplexes have been shown to be mutually exclusive but functionally redundant and to form alternatively on the promoter at the same point in the slow cycle, corresponding to stochastic temporary commitments between distinct pathways  <cit> . this depiction of the dynamics of eukaryotic regulatory structures is likely to result in a complex and flexible concentration dependence. it can even be speculated to have evolved to provide this powerful control mechanism.

the evolutionary cost of the "transcription clock"
cyclical patterns of promoter remodeling and occupancy by tfs are often associated to the idea of "transcription clock"  <cit>  for its tendency to provide the dynamics with a certain timing and to synchronize cells in response to external factors. however, as we have shown, imposing periodicities in the dynamics of the regulatory structure requires energy and is limited by the number of possible promoter states. the clear cyclical recruitment of tfs observed in vivo on eukaryotic promoters and its strong coherence indicate a large number of steps and a strong energy-dependence.

moreover, any deviation from the stereotyped cycle results in a diminution of the coherence of oscillations and makes it suboptimal with respect to energy consumption. this raises an indirect additional cause of energy cost: achieving a complex concentration-dependent activity  while keeping a coherent periodic dynamics could represent another evolutionary pressure toward stronger energy consumption and larger regulatory structures.

CONCLUSIONS
in the light of the various capabilities of gene promoters we have demonstrated in this study, it seems that the importance of the single-gene level has to be reconsidered. indeed, systems biology has set gene networks to the front of the stage, expecting complexity to arise from the interaction of many genes, often considered simple and deterministic. it appears now that single nodes of these networks should be given more attention since their spontaneous stochastic dynamics can be a considerable source of complexity.

authors' contributions
ac, og and gb designed the study. ac performed the theoretical derivations of the model and conceived/analysed the different systems presented as examples. ac, og and gb interpreted the results and wrote the paper. all authors read and approved the final manuscript.

supplementary material
additional file 1
supplementary information. this document contains two supplementary figures, an extensive description of the model in different versions and formulations, details of theoretical derivations and all the parameter values of each system presented as example in the main article.

click here for file

 acknowledgements
the authors want to thank raphaël métivier for helpful discussions and comments on this work, david parsons for critical reading of the manuscript, as well as daniel kahn, jean-jacques kupiec and the members of the biologie des systèmes et modélisation cellulaire  group for discussions. this work was funded by the rhône-alpes region , the rhône-alpes complex systems institute  and the french national network of complex systems .
