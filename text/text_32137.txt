BACKGROUND
to gain more mechanistic insights into the underlying biology of the condition being studied, analyzing high-throughput molecular measurements at the functional level has become more and more appealing  <cit> . especially, the knowledge base-driven pathway analysis is becoming the first choice for many investigators, which mainly exploit pathway knowledge in public repositories, such as gene ontology  and kyoto encyclopedia of genes and genomes   <cit> . kegg pathway databases store the higher order functional information for systematic analysis of gene functions. importantly, kegg pathway databases can be viewed as a set of ortholog group tables including category pathways, subcategory pathways and the secondary pathways, which are often encoded by positionally coupled genes on the chromosome and particularly useful in predicting gene functions  <cit> . therefore, kegg pathway databases are more widely used in current enrichment analysis platforms. there are two advantages in this kind of pathway analysis. one is to reduce the complexity through grouping thousands of differentially expressed genes  from those high-throughput technologies to just several hundred pathways; another is to increase the explanatory power for the experiment through identifying the most impacted pathways under the given conditions  <cit> .

in the last decade, the pathway analysis has experienced the over-representation approach   and a functional class scoring approach  stages . both ora and fcs, including singular enrichment analysis , gene set enrichment analysis  and modular enrichment analysis , aim to identify the significant pathways by considering the number of genes in a pathway or gene co-expression  <cit> . however, these methods are currently limited by the fact that they handle each pathway independently  <cit> . in fact, the pathways can cross and overlap because each gene has multiple functions and can act in more than one pathway  <cit> . hence, exploring advanced data analysis methods and considering inter-pathway dependence are still the most important challenge in pathway analysis up to now. to our knowledge, only go-bayes method has incorporated the dependence structure of the directed acyclic graph  in assessing gene ontology  term over-representation  <cit> . besides, a kegg-path approach took into account the correlation among the kegg pathways in identifying the most impact pathways and exploiting the regulations among the kegg pathways  <cit> .

for time-course experiments and multiple treatments experiments, the dynamic impact approach  had been validated to be an effective functional analysis method in real study based on a priori biological knowledge  <cit> . in dia, the impact values and the impact direction were calculated as “impact =  ×  × ” and “impact direction = impact of up-regulated deg-impact of down-regulated deg”  <cit> . in fact, the impact value was a pathway-level statistic aggregated the gene-level statistics for all degs in the pathway. by ranking the estimated impact values of pathways and considering the sign of impact direction values, the dia approach can efficiently identify the most impact pathways and provide the impact direction of pathways. the outstanding advantage of this method is to capture the dynamic nature of the changing transcriptome. but, this ranking method by ‘average values’ had two limitations: 1) handling each pathway independently; 2) considering the effect of transcriptome expression in a cell for each time-course as “equal weight”. in fact, a biology mechanism  is a very complex network consisting of multiple pathways/functions. obviously, the mutual regulations among pathways must exist and the effect weight of transcriptome expression at different time-course is unequal. in kegg-path approach, the indirect regulation from the other related pathways was considered in the calculation of total effect for each pathway, neglecting the retro-regulation of this pathway to the other related pathways.

in this study, we attempted to develop a decision analysis model to select the most important pathways from the same kegg category or subcategory pathways, and to demonstrate the regulation mechanisms among the pathways belonging to the same kegg category or subcategory. in this method, a decision coefficient  index was conceived by considering the mutual regulation between pathways and was used to identify the most impacted pathways. besides, the subdivision of dc included not only the direct determination factor of each pathway itself, but also the indirect determination factors from its related pathways. meanwhile, the mutual regulation mechanisms among pathways can be demonstrated by the subdivision of dc. in addition, the impact direction of each pathway can be preliminarily estimated by using the sign of dc. moreover, the decision percentage can be obtained by the ratio of dc absolute value of the given subcategory pathway divided by the sum of dc absolute values of all subcategories in the same category. according to the decision percentage, a decision tree can be constructed to visualize the decision results. we tested the utility of the method using the dia impact value dataset from a functional analysis of the bovine mammary transcriptome during the lactation cycle.

methods
to introduce the decision analysis model, we take the kegg pathways for an example to define the following notations.

we assumed that x = t, x
i = t, , x
ij = t,  are the sets of kegg pathway categories, subcategories and the secondary pathways, respectively. let y
i be the impact values of the i-th kegg pathway category and x = t be the impact values of its corresponding subcategory. the vector x is assumed to follow a normal distribution x ~ n, where r
x is the correlation matrix of x. based on the path analysis model, the total effect can be subdivided into the direct effect and indirect effect through the equation r^xb*=r^xy, where r^x=rjtp×p is the maximum likelihood estimation of correlation matrix r
x, and r^xy=rjyp× <dig> is the correlation matrix of x and y
i, b* = t is the solved path coefficient indicating the direct effect of subcategory pathways  <cit> . in fact, the path analysis approach is a standard multiple linear regression model. in the linear regression analysis, the coefficient of determination   is the proportion of total variation of outcomes explained by the model, which provides a measure of how well observed outcomes are replicated by the model  <cit> . in other words, the larger the value of cd is, the better the model is. usually, the cd were defined by the formula r2=1−ssressstot, where ss
res is the residual sum of squares, indicating the discrepancy between the data and an estimation model; ss
tot is the total sum of squares, indicating the total “variability” of data set.

in the path analysis, the cd  can be subdivided into the direct cd  and indirect cd , which can be denoted with the equation  <dig> r2=∑j=1prj2+∑j=1j<tprjt=∑j=1pbj*2+∑j=1j<tp2bj*rjtbt*. 


the parameter r
 <dig> characterizes the proportion of total variation of dependent variables y
i determined by all independent variables x
i <dig>  x
i <dig>  ⋯, x
ip. according to the subdivision, the ratios of direct cd and indirect cd in the total cd can be calculated by the formulae ∑j=1prj2/r <dig> ∑j=1j<tprjt/r <dig>  


the comparison result of these two ratios for each pathway category or subcategory will indicate clearly which kind of determination is more important. the fact that the ratio of indirect cd of given pathway was larger indicates that the correlated regulation was more important than the direct determination for this pathway.

to demonstrate the proportion of total variation of dependent variables y
i determined by a specified pathway x
ij, the decision coefficient  r
 of a specified pathway is constructed as the sum of two terms  based on the ‘coefficient of determination subdivision’ principle of path analysis:fig.  <dig> the construction principle of decision coefficient for a specified pathway. a one path-chain including one bi-directional arrow. b the decision coefficient of one specified pathway including the direct determination factor and the indirect determination factors from all other p −  <dig> pathways


  <dig> rj=bj*2+2∑t=1j≠tpbj*rjtbt* 


the first term 2) is the direct determination factor that demonstrates the direct decision-making capacity of the given pathway. the b
j* value corresponds to the direct effect in the path analysis model. the second term  is the indirect determination factor including correlation determinations of the given pathway from all other p −  <dig> pathways. the indirect determination factor shows the indirect decision-making capacity of the given pathway. the phenomenon 2∑t=1j≠tpbj*rjtbt*>bj* <dig> and 2∑t=1j≠tpbj*rjtbt*> <dig> showed that the correlation regulation will strengthen the decision capacity of the given pathway. on the contrary, 2∑t=1j≠tpbj*rjtbt*>bj* <dig> and 2∑t=1j≠tpbj*rjtbt*< <dig> demonstrated that the correlation regulation will weaken the decision ability of the given pathway. in detail, each term 2b
j*
r
jt
b
t* can reflect the magnitude and direction of correlated regulation between pathways x
ij and x
it. the larger the absolute value of this term is, the larger the correlated regulation between pathways x
ij and x
it is. the phenomenon that the sign of 2b
j*
r
jt
b
t* was negative revealed that the regulation was inhibited each other. otherwise, the regulation was activated. therefore, the complex regulation mechanisms among pathways can be demonstrated in numerical form through the subdivision of decision coefficient . in addition, dc cut-off with the different significance level can be calculated according to the t-test statistics of dc as follows  <cit> :table  <dig> the detailed subdivided result of decision coefficient

x
i1
x
ij
x
it
x
ip
j*
r
j1
b
1*
t*
r
t1
b
1*
p*
r
p1
b
1*
2b
1*
r
1j
b
j*
t*
r
tj
b
j*
p*
r
pj
b
j*
2b
1*
r
1t
b
t*
j*
r
jt
b
t*
p*
r
pt
b
t*
2b
1*
r
1p
b
p*
j*
r
jp
b
p*
t*
r
tp
b
p*
r

r

r

r


r
jt  indicates the correlation coefficient x
ij and x
it. obviously, the data satisfy r
jt = r
tj and rj=bj*2+2∑t=1j≠tpbj*rjtbt* according to the decision analysis method. in order to distinguish between the direct and indirect determination factor clearly, the direct determination factor has been indicated in bold italics


  <dig> rjcut−off=2tpn−q−1rjy−bj∗cjj1−r2n−q− <dig> 


where c
jj is the j-th main diagonal element of inverse matrix of r
x, p is the significance level , and n is the sample size, q is the number of independent variables. the t
p is the upper  ‐ quantile of t-test statistics with degrees of freedom n − q −  <dig> under the given p probability threshold. this quantiles will increase when the probability threshold decreases due to p = p{|t| > t
p}. the quantiles t
p can be obtained by consulting the ‘quantiles  for student’s t-distribution table’. for example, let p =  <dig> , t
 <dig>  can be consulted, then r
cut − off can be calculated. the results {|r
obs| ≥ r
cut − off} demonstrate that the observation values  have statistical significance at the significant level of  <dig> . obviously, the two processes of p = p{|r
obs| ≥ r
cut − off} ≤  <dig>  and {|r
obs| ≥ r
cut − off} are equivalent.

the decision coefficient  is a more scientific and comprehensive index conceived in reflecting the decision-making capability of the given pathway, and it truly reflects the variable decision of each independent variable to dependent variable. in this way, the most impacted pathway can be chosen. the larger the absolute value of dc of given pathway is, the larger the decision-making ability of given pathway to its upper level pathway. the value of dc can be positive or negative due to the positivity and negativity of indirect determination factor. therefore, the sign of dc can characterize the impact direction of given pathway to a certain degree. additionally, the decision tree was constructed below  to display the decision results visually for biological researchers according to the decision percentage. the decision percentage  is calculated as follows:fig.  <dig> the decision tree of kegg pathways according to the decision percentage. the red sign ‘?%’ denotes the decision percentage of kegg subcategory pathway to its corresponding category pathway. similarly, the black sign ‘?%’ denotes the decision percentage of the secondary kegg pathway to its corresponding subcategory pathway. in addition, the activated kegg subcategory pathways were marked with red color, the inhibited kegg subcategory pathways were marked with blue color. in the same way, the activated secondary kegg pathways were marked with red circles; the inhibited secondary kegg pathways were marked with blue circles


  <dig> dp=rj∑j=1prj×100% 


demonstration of decision analysis on simulated data
to explain how the proposed decision analysis to identify the most significant pathways and to demonstrate the regulation among pathways, we performed computer simulations. the random data satisfied the assumption of normal distribution under the regression analysis. the detailed analysis results of simulated data were listed in table  <dig> table  <dig> the decision analysis and path analysis results of simulated data


xjtoy
b
j∗
x
j ↔ x
k → y
r
jk
b
k∗
j∗
r
jk
b
k∗
∑k≠jrjkbk∗
r
jy
∑j≠krkjbj∗
r


x1toy
x
1 ↔ x
2 → y

x
1 ↔ x
3 → y

x
1 ↔ x
4 → y

x2toy
x
2 ↔ x
1 → y

x
2 ↔ x
3 → y

x
2 ↔ x
4 → y

x3toy
x
3 ↔ x
1 → y

x
3 ↔ x
2 → y

x
3 ↔ x
4 → y

x4toy
x
4 ↔ x
1 → y

x
4 ↔ x
2 → y

x
4 ↔ x
3 → y



by fully incorporating the correlated structure of kegg pathways, the decision analysis model shows distinctive advantages as below. first, the significant pathways can be identified through the dc cut-off calculated by formula  with the given significance level. to the given simulated data, when the significance level  was set at  <dig> , the two most significant subcategory pathways  were identified. but when the significance level was set at  <dig> , the three most significant subcategory pathways  were all selected. this result demonstrated that more significant pathways can be identified with the significance level increasing. second, the direct and indirect determination factors from the dc can clearly display the correlated regulation among the pathways . for illustrative purpose, we selected the most significant subcategory pathways x
 <dig> and x
 <dig>  to probe into the regulation mechanisms among pathways. as table  <dig> shown, according to the subdivision of dc, the indirect regulations of x
 <dig> and x
 <dig> to x
 <dig>  were all positive, but the regulation of x
 <dig> to x
 <dig>  was negative and far exceeded the positive regulation from x
 <dig> and x
 <dig>  thus, the total indirect determination factor of x
 <dig>  was negative. obviously, the dc value of pathway x
 <dig>  = −  <dig> ) was negative because the total negative indirect determination from x
 <dig>  x
 <dig> and x
 <dig> exceeded the direct determination of x
 <dig> 2 =  <dig> ). however, the indirect regulations of x
 <dig>  x
 <dig> and x
 <dig> to x
 <dig> were all negative. the larger negative indirect regulation led to the negative dc value. the detailed comparison of indirect regulation determination of x
 <dig>  x
 <dig> and x
 <dig> to x
 <dig> showed that the negative regulation of pathway x
 <dig> was the largest and that of pathway x
 <dig> was the smallest. third, the sign of dc value can be used to predict the impact direction of pathways. the calculated results of simulated data demonstrated that the impact direction of pathways x
 <dig> and x
 <dig> were up-regulated and that of the pathways x
 <dig> and x
 <dig> were down-regulated.

we have also compared the dc value ) of decision analysis and the total effect  of path analysis  <cit>  based on the simulated data . in general, both the path analysis and the decision analysis method emphasized the ‘correlation problem’ caused by the dependent structure among pathways. the path analysis demonstrated the identification of the significant pathways and the regulation among pathways through the total effect  and its subdivision. in fact, the regulations between pathways were mutual and non-equivalent. take x
 <dig> and x
 <dig>  for example, the regulation of x
 <dig> to x
 <dig> was positive , conversely, the regulation of x
 <dig> to x
 <dig> was negative . the total effect of path analysis included the direct effect  and indirect effect  of pathway x
j, but ignored the retro-regulation of pathway x
j . the decision coefficient of decision analysis gave consideration to the regulation and retro-regulation of pathway x
j on the basis of the subdivision of the coefficient of determination of path analysis. for example, pathway x
 <dig> had a lower rank  according to the total effect of path analysis. in contrast, pathway x
 <dig> had a higher rank  according to the dc value of decision analysis due to the retro-regulation of pathway x
 <dig> to x
 <dig>  x
 <dig> and x
 <dig>  the strategy of borrowing information from retro-regulation allows the decision analysis to identify the most significant and mainly contributed pathways. it is true that there is no gold standard to compare the methods in real studies because the biological truth is unknown. therefore, the analysis results based on the simulated data only help to illustrate the distinctive characteristics of decision analysis.

application
datasets
the dia impact values of the kegg pathways from the functional analysis of the bovine mammary transcriptome during the lactation cycle were chosen to test the utility of decision analysis model  <cit> . the two most important pathway categories related to ‘metabolism’ and ‘environmental information processing’ were selected and discussed in detail in our analysis due to their high biological significance in bovine mammary  <cit> . the decision analyses results of the other pathway categories were also attached in additional file 1: table s <dig>  the detailed impact data of selected kegg pathway categories and subcategories from - <dig> to  <dig> vs. -30d were shown in additional file 2: table s <dig>  in addition, few pathways were deleted in that the number of missing data of these pathways was greater than or equal to three. meanwhile, when the number of the missing data included in the pathway was less than three, they were filled with the average value of the other values belonging to this pathway. the filled data were marked in red color in additional file 2: table s <dig> 

in order to compare the results of impact direction produced by the decision analysis model and the dia method, the detailed impact direction data of selected kegg pathway categories and subcategories from - <dig> to  <dig> vs. -30d were also listed in additional file 3: table s <dig>  similarly, the pathways including the missing data were processed as mentioned above.

RESULTS
the results of kegg pathway categories and subcategories based on the subdivision of total cds were shown in table  <dig>  the most impacted pathways identified according to different dc cutoff values were displayed in additional file 4: table s <dig>  the comparison results of the most impacted pathways  under decision analysis model and dia method were listed in additional file 5: table s <dig>  the detailed comparison results of all pathways under the decision analysis model and dia method were displayed in additional file 6: table s <dig>  the dc subdivision results of selected kegg pathway categories and subcategories were listed in additional file 7: table s <dig>  the decision trees of selected pathway categories and subcategories were displayed in additional file 8: figure s <dig> according to the decision percentage.table  <dig> the percentage of direct and indirect cd in the total cd for selected kegg pathway categories and subcategories




the subdivision results of total cds
according to the path analysis approach, the total cd  of the selected kegg pathway categories and subcategories had been calculated. the cds  of subcategories ‘energy metabolism’ and ‘metabolism of other amino acids’ were  <dig>  and  <dig> , respectively. the cds  of the other kegg pathway categories and subcategories were almost up to  <dig>  these results showed that the observed outcomes were replicated by the model very well.

the detailed ratios of direct and indirect cd for all selected pathways were shown in table  <dig>  for the selected kegg pathway category, the indirect cd ratio of category ‘metabolism’  was far greater than its corresponding direct cd ratio, indicating that the correlated regulations among pathways in this category were very important. on the contrary, the direct and indirect cd ratios of the other category ‘environmental information processing’  generally balanced, which showed that the direct and indirect effect were almost equally important. similarly, the indirect cd ratios of almost all subcategory pathways were greater than their corresponding direct cd ratios. the exceptions were subcategories ‘energy metabolism’ and ‘nucleotide metabolism’ in category ‘metabolism’. among of them, the direct cd ratio of ‘energy metabolism’ was far greater than the indirect cd ratio. the direct cd ratio of ‘nucleotide metabolism’ was only slightly larger than its indirect cd ratio. in short, the fact that almost all indirect cd ratios were greater than their corresponding direct cd ratios further revealed that the complex regulating mechanisms existed and were very important in the kegg pathways.

the results of decision analysis
identification of the most impacted pathways
the kegg categories ‘metabolism’ and ‘environmental information processing’, including their all subcategories and the secondary pathways, were analyzed to test the utility of the decision analysis model. in order to use a more suitable dc cut-off to identify the most impacted pathways, the significance levels of  <dig> ,  <dig>  and  <dig>  were set to calculate the dc cut-off based on formula . the results showed that the different dc cut-offs were identified for different category and subcategory pathways. after integration, three dc cut-offs  were chosen to compare . it should be noted that the cut-off of  <dig>  satisfied the condition of p ≤  <dig>  for all category and subcategory pathways; the cut-off of  <dig>  satisfied the condition of p ≤  <dig>  for a large majority category and subcategory pathways, with very few exceptions; the cut-off of  <dig>  satisfied the condition of p ≤  <dig>  for only some of category and subcategory pathways, with some exceptions. the results of comparison showed that more suitable cut-off was ≥ <dig> . therefore, when the absolute value of calculated dc for a pathway was greater than or equal to  <dig> , this pathway was considered to be the most impacted.

as additional file 5: table s <dig>  shown, for kegg pathway category ‘metabolism’, its four subcategories are found to be the most activated pathways based on the dc values. the pathway with the highest positive dc value is ‘lipid metabolism’. four subcategories are found to be the most inhibited pathways. especially ‘carbohydrate metabolism’ has the largest negative decision capability. differently, the three most impacted subcategories of category ‘environmental information processing’ are all activated. the most impacted pathway is ‘signal transduction’, with the largest positive dc value.

as additional file 5: table s <dig>  shown, for the secondary pathways, the dc measure suggests that six pathways are the most impacted pathways  in subcategory ‘lipid metabolism’. four pathways related to subcategory ‘glycan biosynthesis and metabolism’ are found to be the most impacted . five the secondary pathways of ‘signal transduction’ are the most impacted  according to the dc values.

in some cases, the most impacted pathways highlighted by the decision analysis model match our expectations. it is well known that the three main components of milk in dairy cow are lactose, fat and protein  <cit> . thus, the presence of ‘lipid metabolism’ pathway with the highest positive dc value might be expected to appear, in that the lipid metabolism has something to do with the lactose synthesis. in other cases, the pathways are not immediately expected, but subsequent investigations revealed that these pathways identified by decision analysis are supported by previous experiment results. for example, the largest activation of ‘glutathione metabolism’ in subcategory ‘metabolism of other amino acids’ appears to confirm previous data  <cit> , demonstrating that this process was very important in amino acids availability to mammary gland. in subcategory ‘glycan biosynthesis and metabolism’, the secondary pathways related to ‘glycosphingolipid biosynthesis’, particularly ganglio series, showed the largest decision-making ability in agreement with the findings reported by dia method. in fact, the glycosphingolipid synthesized by these pathways have been reported to display beneficial health properties, especially for the defense of newborns against pathogens  <cit> . in addition, gangliosides have an important role in membrane function including cell signaling, cell adhesion and protein sorting  <cit> . in still other cases, no direct corroborative evidence could be found . thus, this finding serves as a hypothesis for future testing.

comparative analysis of kegg pathways
in order to compare the results of the decision analysis method with those of the dia approach, we checked the permutation order of dia mean impact value of the most impacted pathways  and their impact directions. the details of compare results are listed in additional file 5: table s <dig>  as a whole , for the most impacted pathways comparison, the results showed that in about 85 %  of the selected pathway categories and subcategories, the concordance rate of the most impacted pathways under the two methods reaches or exceeds 50 %, even to 100 %. for the impact direction comparison, in 77 %  of the selected pathway categories and subcategories, the concordance rate of impact direction under the two methods reaches or exceeds 50 %, and in the remaining pathway categories and subcategories, the minimum concordance rate was  <dig>  %.table  <dig> the comparison results of the most impacted pathways and impact direction under decision analysis model, kegg-path and dia method

for the ‘the concordance rate of impact direction’ column, the denominator of each fraction in the parentheses denotes the number of subcategory pathways and the secondary pathways from the front corresponding categories and sub-categories for two columns, and the numerator of each fraction for two columns denotes the number of pathways with the same impact direction under dia and decision analysis, and under dia and kegg-path respectively. for the ‘the concordance rate of the most impacted pathways’ column, the denominator of each fraction in the parentheses denotes the number  of the most impacted pathways identified based on dc values in corresponding pathway categories and sub-categories for two columns, and the numerator of each fraction for two columns denotes the number of pathways which also appeared in top a pathways identified by dia average impact values and by total effect from kegg-path, respectively




in addition, we roughly compared the results of the decision analysis with those of kegg-path approach. the results demonstrated that the concordance rate of pathway impact direction under decision analysis was significantly higher than that under kegg-path approach when dia pathway impact directions were used as standard. for example, for pathway categories ‘metabolism’ and ‘environmental information processing’, the concordance rates of pathway impact direction under decision analysis were  <dig>  %  and 100 % , respectively. however, the corresponding concordance rates under kegg-path were  <dig>  %  and  <dig>  % . from the view of all the secondary pathways belonging to the same category, the concordance rates of pathway impact direction were also obviously improved from  <dig>  %  and  <dig>  %  under kegg-path to 58 %  and  <dig>  %  under decision analysis for categories ‘metabolism’ and ‘environmental information processing’, respectively. for the most impacted pathways comparison, the concordance rate compared with kegg-path seemed still higher than that compared with dia . based on this comparison, several distinctions between the three approaches can be made.

first, overwhelming majority of the most relevant function pathways in the mammary gland during lactation are captured based on dc values . some of them also were found by mean impact values in dia approach and by total effect in kegg-path approach. for example, for the subcategories ‘energy metabolism’, ‘nucleotide metabolism’, ‘metabolism of other amino acids’ and ‘signaling molecules and interaction’, the most impacted secondary pathways are almost the same under the three methods. the results showed that the correlation regulations strengthen the direct determination of these secondary pathways to some extent. these results also can be confirmed by the subdivision of decision coefficient. ) in addition, the decision analysis method highlights some more biologically meaningful results. for example, the ‘lipid metabolism’ subcategory has the largest positive dc value. this result is potentially the most interesting given the strong literature support described above. the largely impacted pathway ‘glycosphingolipid biosynthesis–ganglio series’ was also present in the results as we expected due to its importance role of modulating enzyme properties, cell signaling, cell adhesion  <cit> . it is interesting that the inhibition of gangliosides presents in the results. this is in consistent with the fact that the concentration of glycosphingolipids showed a large decrease during the transition from colostrums to mature milk  <cit> .

second, the pathways were identified as the most impacted pathways based on the dc values, but they were not found according to the mean dia impact value. for example, two subcategories, ‘nucleotide metabolism’ and ‘metabolism of other amino acids’, are not the most impacted by dia mean impact values, but are demonstrated to be the most impacted based on the dc values. the subdivision results of decision coefficients ) showed that subcategory ‘nucleotide metabolism’ has the relatively larger direct determination, and is positively regulated by pathways ‘lipid metabolism’ and ‘metabolism of other amino acids’ to a large extent. the subcategory ‘metabolism of other amino acids’ is also largely positively regulated by ‘nucleotide metabolism’ and ‘lipid metabolism’. these subdivision results revealed that the correlation regulation among pathways highlights the importance of these two subcategories. in category ‘environmental information processing’, subcategory ‘signal transduction’ is unexpectedly ranked the first according to the dc value. on the contrary, this subcategory has the smallest average impact value in dia approach. obviously, ‘signal transduction’ is very important to the mammary gland during lactation  <cit> . these three sub-categories, ‘nucleotide metabolism’ and ‘metabolism of other amino acids’ and ‘signal transduction’, also were selected as the most impacted pathways under kegg-path approach. the phenomenon showed that the correlation regulation was very important in identifying the most impacted pathways. in addition, the strongly inhibition of pathways ‘lysine degradation’ and ‘tryptophan metabolism’ appeared to be consistent with the inhibition of ‘citrate cycle ’. the result can be supported by the fact that many of the products of these two pathways could be precursors of tca cycle pathway  <cit> . the secondary pathways ‘fatty acid elongation in mitochondria’, ‘fatty acid metabolism’ and ‘steroid hormone biosynthesis’ in the subcategory ‘lipid metabolism’ are selected as the most impacted pathways based on the dc values. but their dia mean impact values are relatively small. the result indicated that the correlation regulation has resulted in the change of the importance of these pathways. but it was strange that these three secondary pathways were not selected as the most impacted pathways according to kegg-path. the result demonstrated that the retro-regulation among these pathways should be very important. therefore, researchers should pay much more attention to these correlation regulations. to shed light on the difference, we checked the subdivision of decision coefficient. ) the results showed that the ‘fatty acid elongation in mitochondria’ and ‘fatty acid metabolism’ pathways were inhibited in that they were negatively regulated by pathway ‘arachidonic acid metabolism’ to a great extent. the reduction of fatty acid metabolism also can be supported by the fact that the fatty acid taken up by the mammary tissue mainly was used towards the synthesis of milk fat, including the components of cellular membranes  <cit> . conversely, few of the most impacted pathways based on mean dia impact values were not found according to dc values. for example, the subcategories ‘metabolism of terpenoids and polyketides’ and ‘biosynthesis of other secondary metabolites’ in category ‘metabolism’ were not found based on dc values. as additional file 9: table s <dig>  showed that the two subcategories have very small direct determination and were slightly regulated by the other pathways. the importance of these two subcategories was weakened just because of the approximate balance of direct and indirect determination. although the secondary pathways ‘hedgehog signaling pathway’ and ‘tgf-beta signaling pathway’ in subcategory ‘signal transduction’ were not found to be the most impacted pathways based on the dc values, they would be selected when the cut-off of ≥  <dig>  was used.

third, the results based on the decision analysis model were displayed through the construction of decision tree . in the decision tree ‘network’, the activated kegg subcategory pathways were marked with red color, the inhibited kegg subcategory pathways were marked with blue color. similarly, the activated secondary kegg pathways were marked with red circles; the inhibited secondary kegg pathways were marked with blue circles. meanwhile, the red and black numbers were used to denote the decision percentage of kegg subcategory pathway to its corresponding category pathway, the decision percentage of the secondary kegg pathway to its corresponding subcategory pathway, respectively. in this way, the researchers can catch important information fleetly and exactly.

why does decision analysis perform better prediction effects?
to explain why decision analysis outperforms the kegg-path approach, we calculated the retro-regulation of each pathway in detail and listed all the results of decision analysis and kegg-path approach in additional file 9: table s <dig> 

the first superiority of the decision analysis model was that the retro-regulation of each pathway was considered in identifying the most significant pathways based on the coefficient of determination. as additional file 9: table s <dig>  showed, in category pathway “environmental information processing”, the total effects of the three subcategories were all relatively large by kegg-path method and there was few difference among them; but their dc values had very big difference when the retro-regulation was considered. more importantly, the selected significant subcategory pathway “signal transduction” based on the dc values was highly impacted indeed as the documents reported during the lactation  <cit> . obviously, the calculation results was also demonstrated that the retro-regulation of “signal transduction” was relatively larger compared to the other subcategory pathways. thus, the positive mutual regulation highlighted the significance of pathway “signal transduction”. differently, the subcategory pathway “lipid metabolism” was negatively regulated by the other subcategory pathways; conversely, the pathway “lipid metabolism” had larger positive retro-regulation on the other subcategory pathways and the positive direct effect. thus, the pathway “lipid metabolism” had the positive decision-making ability. similarly, the subcategory pathways “carbohydrate metabolism” and “glycan biosynthesis and metabolism” were positively regulated by the other subcategory pathways; conversely, they had larger negative retro-regulation on the other subcategory pathways and the negative direct effect. thus, the two pathways had the largely negative decision-making ability.

another superiority of the decision analysis model was that the impact directions of pathways could be estimated preliminarily and directly according to the sign  of the dc. still further, the sign of the dc also gave consideration to the dependences among the pathways. in this study, the result of the decision analysis showed that the subcategory pathway “lipid metabolism” had the largest positive decision-making ability; however, the impact direction of its secondary pathway ‘fatty acid metabolism’ was negative. these results match our expectations because the lipid metabolism had a lot to do with the synthesis of the lactose and the reduction of fatty acid metabolism was considered towards the synthesis of milk fat through taking up the fatty acids by the mammary tissue. besides, the fact that the impact direction of the tgf-beta pathway was negative based on the decision analysis was in accordance with the fact that this pathway appeared to have a negative role on mammary cell proliferation  <cit> .

discussion
in this study, a decision analysis model is first proposed to identify the most impacted pathways. the decision analysis model borrows the decision coefficient to judge the importance of the pathways, which not only considers the direct determination factor of pathway itself, but also adds the correlation indirect determination factor with the other related pathways. compared with dia approach, the decision analysis method overcomes the deficiency of analyzing each pathway independently. compared with kegg-path approach, the decision analysis method constructs a dc index based on the coefficient of determination of regression analysis, rather than correlation coefficient. importantly, the retro-regulation among pathways was considered in decision analysis. therefore, the decision analysis model is a statistical data mining at a deeper level. for the estimation of impact direction, the dia method averages the impact direction values of the pathway during different time course. the kegg-path approach needs to use the gradient analysis from principal component analysis  to estimate the impact directions of pathways. however, the decision analysis can judge the impact direction directly through the sign of decision coefficient. more importantly, the sign of decision coefficient was caused by the correlated regulation from the other related pathways. thus, the identification of pathway impact direction  through the decision coefficient also gave consideration to the dependences among the pathways. hence, it is a major bright spot of the decision analysis model that the identification of the most impacted pathways and their impact directions through the decision coefficient took account of the correlation among pathways from the angle of ‘variation determination’.

in addition, the regulation mechanisms among pathways can be demonstrated through the subdivision of decision coefficient. this numerical expression of the correlation regulation among pathways is another major highlight of the decision analysis model. the construction of decision tree can visually display the results of decision analysis. we have developed a program in matlab  to implement the decision analysis . in the calculations, we found that the results might be inaccurate when the correlation matrix was close to singular or badly scaled. but the relative error is basically controlled to 10− <dig> and it can be neglected.

although the decision analysis model is designed to analyze the kegg pathways, it is theoretically also applicable to the other databases with similar dependency structure, such as reactome, wikipathways, etc. however, considering the information about how cell and tissue type, age, and environmental exposures affect pathway interactions, how to apply the decision analysis to general cases with the original gene expression value rather than the dia impact values is still a challenge. in order to better understand large biological system, addressing these issues, coupled with technological advances will likely improve the confidence in results.

CONCLUSIONS
the decision coefficient  based on coefficient of determination  of regression analysis gives consideration to the inter-pathway dependence in identifying the most impacted pathways and their impact directions. meanwhile, the regulation mechanisms among pathways were demonstrated from the angle of ‘variation determination’. the decision analysis model is an initial attempt of optimizing pathway analysis methodology.

additional files

additional file 1: table s <dig>  this file provides the original dia impact values and the detailed subdivided results of decision coefficient for the other kegg subcategory pathways and the other kegg secondary pathways in table s <dig> –, respectively. in order to distinguish between the direct and indirect determination factor clearly, the direct determination factor has been indicated in red box. 


additional file 2: table s <dig>  this file provide the detailed impact data of selected kegg pathway categories, subcategories and the secondary pathways from−  <dig> to  <dig> vs.− 30d in bovine mammary tissue during lactation in table s <dig>  and , respectively. the numbers colored in red color are the filled data by the average of all the other impact values in this pathway, which is the missing data originally. 


additional file 3: table s <dig>  this file provide the detailed impact direction data of selected kegg pathway categories, subcategories and the secondary pathways from−  <dig> to  <dig> vs.− 30d in bovine mammary tissue during lactation in table s <dig>  and , respectively. the numbers colored in red color are the filled data by the average of all the other impact values in this pathway, which is the missing data originally. 


additional file 4: table s <dig>  the file gives the comparison results of the most impacted pathways identified according to different decision coefficient  values. 


additional file 5: table s <dig>  this file gives the comparison of the most impacted pathway subcategories and the most impacted secondary pathways  under decision analysis model and dia method in table s <dig>  and , respectively. in ‘group’ column, ‘a’ showed that the pathway was the most impacted pathway under both decision analysis model and dia method; ‘b’ showed that the pathway was the most impacted pathways only under decision analysis model, and was not under dia method. ‘rankdia’ was the order of mean impact value for the pathway. the sign “+” and “−” represent the up-regulating and down-regulating impact direction, respectively. 


additional file 6: table s <dig>  the file gives the comparison results of all the selected subcategory pathways and all the selected secondary pathways under dia method and decision analysis method in table s <dig>  and , respectively. the sign “+” and “−” represent the up-regulating and down-regulating impact direction, respectively. 


additional file 7: table s <dig>  this file provides the detailed subdivided results of decision coefficient for the selected kegg subcategory pathways and the selected kegg secondary pathways in table s <dig>  and , respectively. in order to distinguish between the direct and indirect determination factor clearly, the direct determination factor has been indicated in red box. 


additional file 8: figure s <dig>  the file gives the decision trees of selected pathway categories and subcategories plotted according to the decision percentage.  metabolism and  environmental information processing) the activated kegg subcategory pathways were marked with red color, the inhibited kegg subcategory pathways were marked with blue color. in the same way, the activated secondary kegg pathways were marked with red circles; the inhibited secondary kegg pathways were marked with blue circles. 


additional file 9: table s <dig>  this file provides the decision analysis and path analysis results of the selected category pathways and the selected subcategory pathways in table s <dig>  and . 


additional file 10: s <dig>  this file provides the code for the decision analysis model in matlab . 




