BACKGROUND
protein structure is more conserved than protein sequence during molecular evolution  <cit> . remote homologous proteins constitute an extreme example of sequence divergence where proteins with similar function and no apparent sequence similarity present almost the same fold  <cit> . however, protein sequences are far from being random. rather, they are selected through evolution in such a way that functional constraints modulate sequence variability. usually, only a few residues are directly related to the protein function. however, these residues must maintain adequate spatial relationships for the protein to remain functional, so that the whole 3d structure is conserved. in turn, structure conservation constrains sequence variability in such a way that residue substitution does not disturb the overall 3d structure of the protein. this results in emergent non-random sequence patterns.

the restrictions imposed by the environment of a given protein site onto its pattern of amino acid substitutions have been largely discussed  <cit> . briefly, highly constrained positions are more conserved. furthermore, each site has a biased composition related to its structural environment. models of protein evolution that take this into account outperform other, simpler, models  <cit> . recently, a number of models of protein evolution have been developed that take explicit account of protein structure, stability, and/or foldability  <cit> . even though such models have not been used yet for phylogenetic inference purposes, they are useful to gain insight into the detailed mechanism of protein evolution. noteworthy, some of these models have been able to reproduce quantitatively observed amino acid substitution patterns  <cit> .

to study how protein structure conservation modulates sequence divergence, we recently developed the structurally constrained protein evolution  model  <cit> . the starting point of an scpe simulation is the coding-sequence of a protein of known three-dimensional structure, which we shall call the "ancestral sequence". at each evolutionary time-step, a new "trial sequence" is generated by random mutation, at dna level, of the "current sequence" . then, the trial dna is translated using the universal genetic code and a "score" that estimates the protein structure perturbation introduced by the mutation is evaluated. the trial sequence is accepted, becoming the new current sequence, only if its score is below a certain "cut-off", λ, that measures the amount of structural perturbation allowed by natural selection. in this way, for λ =  <dig> only synonymous mutations are accepted, whereas for λ ~ ∞ all mutations are accepted. the procedure is repeated until a desired number of mutations are reached. in the present work the dna is mutated using the jukes-cantor model, so that each nucleotide substitution occurs with the same probability.

the model depends on one parameter, the cut-off λ, that must be fit by comparison to actual sequence data. different properties could be used to fit the cut-off. as we will show below, the model is quite robust with respect to the property used. therefore, we have used the simplest way, which is to fit λ such that the acceptance rate, ω, inferred for actual sequences is reproduced. the acceptance rate is the probability that an amino acid mutation is accepted. thus, it can be estimated by the ratio between the number of amino acid substitutions  and the total number of trial amino acid mutations. the acceptance rate has been extensively used to characterize the strength of the selective pressure under which proteins evolve  <cit> . if all mutations were neutral they would be accepted and ω would be  <dig>  in general the ω values are usually below  <dig>  due to the deleterious effects of most amino acid mutations  <cit> . in proteins under very strong selective pressure ω can take values very close to zero.

one of the main factors determining the quality of the scpe model is the scoring function. given the structure of the ancestral protein, which we assume constant throughout the simulation, the score of a given trial sequence is defined as the rmsd between the mean-field energy profile of the trial sequence and that of a reference sequence. in our previous work, the same reference sequence, the ancestral one, was used for each time-step. therefore, the score of each trial sequence was a measure of the dissimilarity between the trial sequence and the ancestral sequence, given the structure. such a score depends only on the trial sequence and the ancestral sequence, but not on the particular sequence mutated to obtain the trial. hence, it does not depend on the precise evolutionary path between the ancestral and the trial. therefore, this will be called from now on "global score".

even though the global score has been proved to be very good at reproducing the sequence patterns of a test case, it also shows some problems. mainly, at the beginning of a simulation most mutations fall below the optimum cut-off. this results in too high values of the acceptance rate. only after about 5% of the sites have been substituted, the cut-off is purifying enough to reproduce the acceptance rate inferred for the actual family. from a more qualitative point of view, since at the beginning of global-score simulations almost all mutations are accepted, erroneous amino acids, which are not found in the natural sequences of the family studied, can be introduced with relatively high probability during the first few steps of a global-score simulation. we shall see below that these are unwanted artefacts of the global-score scpe simulations.

to tackle the problems described in the previous paragraph, in this paper we introduce a "local score", in which the reference sequence for a given trial is that accepted in the previous evolutionary time step, the current sequence, rather than the ancestral one. thus, the local score measures the mutational perturbation introduced in a given time-step, rather than the global difference between the trial and ancestral sequences.

the new approach is compared with the previous one on the same test system studied before: udp-n-acetylglucosamine acyltransferase  from escherichia coli. a portion of this protein presents a left-handed parallel beta helix , a fold generally associated with transferase activity and broadly distributed in different taxons  <cit>  . all the lβh proteins contain a hexapeptide-repeat motif which is closely related with the topology of the fold . this superfamily is characterized by the high conservation of the fold that contrasts with an elevated sequence and functional divergence.

we shall show below that when the local score is used, the acceptance rate averaged over independent runs does not depend on the amount of divergence from the ancestral sequence. furthermore, no erroneous amino acids are accepted during the simulations. thus, these artefacts of the global-score simulations are absent when the new scheme is used. to further compare both schemes, other properties were analysed. specifically, we evaluated and compared structure conservation, entropy profiles, amino acid distributions, and substitution matrices. we show that scpe simulations that use the lpxa from e. coli as ancestral sequence can be used to estimate site-dependent amino acid substitution matrices  <cit>  which outperform the usually used jtt model  <cit> . moreover, we consider the applicability of the scpe substitution matrices obtained from lpxa simulations to other protein families which adopt the lβh fold.

RESULTS
acceptance rates
in figure  <dig> we show the number of nonsynonymous substitutions versus the number of nonsynonymous mutations averaged over several independent simulations. note that nonsynonymous substitutions  at dna level are amino acid substitutions  at protein level. the slope of each plot is the acceptance rate ω. figure  <dig> shows that for the global-score case, ω decreases from ω =  <dig> when the simulation begins to a constant asymptotic value ω <  <dig> for longer times. in an actual case, such behaviour could be due to a sequence that for some reason is particularly robust with respect to mutations. in the present case, however, this is an unintended artefact of our model. it happens because the global score of the mutations introduced in the first steps of a simulation lie below the global cut-off, no matter how nonconservative the mutation is. thus, at the beginning of a global-score simulation almost all amino acid mutations are accepted, leading to an acceptance rate ω =  <dig>  furthermore, clearly wrong amino acids, that will irreversibly upset the structure, can be introduced. in contrast, the local-score simulations display a constant average ω, which we think is more consistent with a neutral model, such as scpe, with constant selection pressure λ. we should mention that despite the constancy of the average ω, the acceptance rate ω of a single simulated run changes from sequence to sequence. this is expected, since any substitution at a given site changes the scores of the sites that are in contact with it in the 3d structure. this could account for features such as overdispersion of the molecular clock and rate-shifts in substitution rates .

determination of optimal λ
as discussed in methods, we have chosen to determine the optimum value of the scpe model parameter λ so that the acceptance rate of the simulations matches that inferred from actual sequences. for the scpe simulations, the value of ω is easily estimated by just counting the number of amino acid substitutions accepted throughout the simulations and dividing by the number of trial amino acid mutations. for the reference alignment, however, one has to estimate ω using some inference method. these methods tend to overestimate the actual ω. this can be seen in figure  <dig>  where we show two different ω inferences for a set of scpe simulations as a function of the cut-off λ, together with the value calculated by counting the proportion of accepted mutations . the inferences were made with the module yn <dig> of paml  <cit>  as explained in methods. it is worthwhile to note that the inferred ω departs from the calculated ω as λ increases. this behaviour is expected since, for a given number of mutations, for larger λ there are more accepted nonsynonymous substitutions, which results in loss of sequence signal.

using the method yn00+w+f, which best estimates the calculated ω, we obtained the ω of the reference alignment of  <dig> sequences homologous to the udp-n-acetylglucosamine acyltransferase from escherichia coli . the average ω for this alignment is  <dig> . using this value in figure 3a and 3b the optimal values of λ obtained are  <dig>  and  <dig>  for local and global score, respectively.

we note here that the optimal λ values for local and global score are very different. thus, for the sake of comparison, we take advantage of the one-to-one relationship between λ and ω, shown in figures 3a and 3b, and use the calculated acceptance rate ω instead of λ as model parameter. in figure 3c we plot the inferred ω versus the calculated ω for local-score and global-score simulations. using this plot and the inferred ω value for the lpxa reference alignment, ω =  <dig>  ±  <dig>  , we calculate an optimal ω of  <dig>   for local score and  <dig>   for global score.

assessment of structure conservation
it is important to assess if the scpe models are able to preserve protein structure. to this end we used threader  <dig> to analyze the percentage of sequences that recognize the correct structure using different models. results are shown in table  <dig>  clearly, jtt is unable to conserve structure even for relatively low amounts of divergence: at ka =  <dig>  only 20% of sequences obtained from jtt simulations recognize the correct structure. in contrast, a significant proportion of sequences simulated with scpe recognize the correct structure even after long simulations of  <dig>  substitutions per site: 62% for local-score scpe and 39% for global-score scpe.

when both scpe schemes are compared, table  <dig> shows that local-score simulations perform better than global-score ones. this result is counterintuitive, because one might expect, a priori, that in the long term the global-score would be better at conserving structure than the local-score, since in the later case the reference sequence is reset at each step so that it would be easier to lose memory of the ancestral protein. one of the reasons of the global-score scpe being worse at conserving structure could be the erroneous amino acid substitutions introduced at the beginning of the simulations . to gain more insight into this issue, further work involving much longer simulations would be needed. however, for long enough evolutionary time it is not longer reasonable to assume that structure remains constant. in this limit, any model based on assuming structural conservation will break down.

entropy profiles
to evaluate the capacity of the scpe model to reproduce the sequence patterns found in the lpxa family, the variability of each site was analysed. the different protein positions were accumulated into  <dig> structural classes. for each class, we calculated the entropies corresponding to the equilibrium distributions of scpe models. these entropies represent the average structural constraints of each structural class and do not depend on simulation time. scpe entropy profiles are compared with those obtained from the reference alignment of the lpxa family. one could argue that these are not only determined by structure, but also contain historical information. however, since we are accumulating over several sites of the same class, which would have independent evolutionary histories, we expect such information to be somewhat averaged out. for the sake of comparison we also calculated the entropy profiles of jtt simulations of  <dig>  amino acid substitutions per site . the resulting entropy profiles are shown in figure  <dig>  it can be seen from this figure that both, the local-score and the global-score schemes reproduce very well the variability pattern of the lpxa family. also, in figure  <dig> we show that simulations performed using the jtt model produce less accurate results, especially for the most conserved  structural classes i and i+ <dig> 

to further study the effect of varying the model parameter, we calculated an "error" which quantifies the difference between simulated and observed entropy profiles . in figure  <dig> this error as a function of ω is shown. comparing figures  <dig> and  <dig>  we see that the ω for which the entropy error is minimum is consistent with the value at the optimum cut-off for both the local and the global score schemes.

probability distributions
although entropy is commonly used to evaluate sequence conservation in an alignment  <cit>  and to compare simulated data with natural sequences  <cit> , it is not enough for a thorough assessment of the sequence pattern. an entropy value of  <dig> at a given site, for example, means that there is only one amino acid, but it could be any one out of twenty. thus, to perform a more complete evaluation of the scpe model, we looked into the amino acid probability distributions. to this end, we calculated a similarity score between the asymptotic scpe distributions and those obtained from observed sequences. we used the similarity score used by yona and levitt to perform sequence profile-profile comparisons  <cit> . in figure  <dig> we show the similarity score between observed and scpe equilibrium amino acid distributions as a function of the calculated acceptance rate ω. we also show results for a simulation performed using the jtt model  <cit>  of evolution. overall, it can be seen that the local-score scpe performs somewhat better than the global-score scpe, and that both scpe models clearly outperform jtt for a significant range of parameter ω around the optimum value.

a more detailed analysis shows that the maximum of the local-score plot corresponds to a ω =  <dig> , that is in good agreement with the optimum cut-off determined from the acceptance rates, as explained previously. in contrast, for the global-score case the cut-off at the maximum of the similarity score plot is significantly below the optimum ω value previously obtained. this difference would be due to the wrong behaviour of the global-score scheme for small amounts of divergence , which will affect the scpe substitution pattern and, therefore, the amino acid probability distributions. the same behaviour, though less marked, is found in the plots of figure  <dig> 

finally, it is interesting to note that the similarity score for ω =  <dig> is much better than jtt. since ω =  <dig> corresponds to a simulation where no nonsynonymous substitutions are accepted, this is the score obtained using just the initial sequence. memory of this sequence might favour the good agreement observed for scpe. however, it is noteworthy that the actual agreement increases for ω >  <dig>  showing that the good fit is not due exclusively to a memory effect. the substitution matrix assessment described in the next section should be less sensitive to memory effects.

substitution matrices
even though it has long been recognized that substitution patterns are site-specific and depend on protein family, it is in general very difficult to estimate site-specific and family-specific substitution matrices due to a lack-of-data problem. as we reported previously, a possible strategy to overcome this obstacle is to obtain site-specific substitution matrices from scpe simulations  <cit> . to further evaluate how the scpe model is able to reproduce the substitution pattern of the lpxa family, a maximum likelihood analysis was used. scpe runs were used to obtain a substitution matrix qc for each structural class. then, these matrices were used to calculate the maximum likelihood of the lpxa reference alignment using a given topology .

in figure 7a we show the likelihood vs. ω plots obtained using local-score and global-score scpe substitution matrices. the global-score likelihood peaks near ω =  <dig>  in good agreement with the previous determinations, showing that it reproduces quite well the amino acid substitution patterns found in real sequences. the best ω of the local-score scpe likelihood  corresponds to ω =  <dig> , larger than that determined previously . to understand this behaviour, we analysed the log likelihood components for each structural class, which are shown in figure 7b. it is seen from this figure, that the local-score maximum likelihood peaks near ω =  <dig>  mainly because of the contributions of structural classes i+ <dig>  i+ <dig>  i+ <dig>  and i+ <dig>  which, being the least structurally constrained sites, are not expected to be very well reproduced by scpe. in contrast, for those sites that point towards the inside of the lβh helix, which are the ones the model should best describe  the maximum likelihood peaks near ω =  <dig> , in better agreement with figures  <dig>   <dig>  and  <dig>  in the global-score case, from figure 7b, the maximum likelihood plots for different classes behave more evenly: for all classes, the maximum likelihood peaks near ω =  <dig> .

other lβh families
as a further example of the applicability of the scpe model, we considered other families of the lβh superfamily . we used the local-score and global-score schemes with the optimum cutoffs estimated using acceptance rates, as explained previously, to obtain site-dependent probability distributions and substitution matrices for the six different structural classes.

in figure  <dig> we show the probability distributions of the lβh families considered  and the equilibrium distributions obtained using the local-score and global-score scpe models . it can be seen that both scpe schemes perform quite well in reproducing the sequence pattern of our test system.

to test the substitution matrices, we performed maximum likelihood calculations on each family of table  <dig>  since the models compared have the same number of parameters, they can be compared using maximum likelihood  values obtained using a reasonable phylogenetic tree topology  <cit>  . in table  <dig> we show the ml values per site for local-score scpe, global-score scpe, and jtt, applied to different sets of sites. better models have larger ml values.

for lpxa, scpe  are clearly better than jtt for all sites considered. cat and sata behave similarly, though the advantage of scpe over jtt is less marked. for other families, scpe  is better than jtt for class i sites. for other structural classes there is no definite advantage of scpe over jtt.

when comparing local-score scpe with global-score scpe one finds no definite advantage of either one over the other. for sites i, where the more meaningful results are expected, local and global give very similar results for all families except for laca where global is better than local.

CONCLUSIONS
we presented in full detail the structurally constrained protein evolution model , developed recently. we improved on our previous model by introducing a new scoring function. our previous work was based on a "global" score, which measures how a trial sequence differs from the ancestral sequence in its ability to fit a reference structure assumed constant. in contrast, the "local" score measures the perturbation introduced by a given mutation with respect to the previously accepted sequence, rather than the ancestral one.

both schemes, global and local, were compared in their ability to match the substitution patterns of the protein family lpxa. we performed a thorough assessment comparing structure conservation, entropy profiles, amino acid distributions, and substitution matrices. lβh proteins were found to be particularly suited for such a detailed characterization of the sequence pattern, because of the fact that most of their sites belong to one of only six different structural classes. furthermore, these properties were studied as a function of the single parameter of the model: a cutoff that measures selection pressure against structural divergence. finally, we applied the model to all other members of the lβh superfamily whose structure is known, extending previous studies performed only on the lpxa family.

in general, we found that the local-score scpe behaves either similarly or better than the global-score scheme, depending on the property considered. furthermore, for lpxa, and for sites of the structurally constrained class i of all other families studied, both scpe models clearly outperform the widely used jtt model, showing the power of the scpe model to account for substitution patterns conditioned by structural constraints.

currently, we are using the scpe model to investigate several issues important in protein evolution, such as overdispersion of the molecular clock, correlation between the evolution of different sites, and heterotachy. also, we are testing the applicability of the scpe model to other protein families, in order to assess its generality. nevertheless, we should mention that since most protein families do not display the regularity of lβh proteins, it is more difficult to perform a detailed quantification of sequence patterns, which makes such tests at the same time more difficult and less demanding than the lβh superfamily.

