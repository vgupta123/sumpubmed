BACKGROUND
high-throughput sequencing technologies  <cit>  allow the measurement of expression of multiple genomic loci in terms of discrete counts. a number of methods have been developed in recent years for the detection of differential expression in high-throughput sequencing data. the data are generally modelled using an over-dispersed poisson distribution , although the beta-binomial distribution  <cit>  has also been used. these methods offer relatively robust and sensitive detection of differential expression either through pairwise comparisons  <cit>  or a model-based approach  <cit> .

analysis methods for an important class of experimental design, that involving paired data, are less well developed. in a paired experimental design, we are generally interested in examining how the ratio of expression between paired counts varies, a scenario that arises naturally in a number of important settings. for example, in oncological studies we may take normal and tumour tissue from the same patient and wish to determine whether the ratio of gene expression differs from a one-to-one ratio between patients within a treatment group, or whether this ratio varies between treatment groups. similarly, we may wish to compare individuals pre- and post-infection to establish how different strains of a species respond to infection. paired samples provide a useful approach to such problems as even when the expression of particular genes varies substantially between individuals, the effect of treatment may be relatively consistent. by using paired samples, we can account for individual-specific effects and consequently better detect treatment effects.

two key questions arise in analyses of paired data. firstly, we can examine differential expression within each pair. that is, we are interested in distinguishing those data which show an approximately one-to-one ratio of expression  for each pair of counts, and those which show a consistent change between each pair. in the examples above, this is equivalent to discovering differential expression between normal and tumour tissue, or between pre- and post-infection cases, taking into account individual-specific effects. in the second case, we are interested in discovering differential expression between groups of paired samples. in our examples, this would correspond to changes in relative expression as a result of treatment. depending on the nature of the experiment and the data produced, either or both of these forms of differential expression may be of interest.

we present here an empirical bayesian method based on an over-dispersed binomial distribution, the beta-binomial, for addressing the problem of detecting both types of differential expression in paired sequencing data. the beta-binomial distribution has previously been suggested as a suitable model for the analysis of unpaired high-throughput sequencing data  <cit> , in which the number of reads observed at a single genomic locus is modelled as a proportion of the total number of reads sequenced. in contrast, we model the number of reads observed at a single genomic locus in one member of a pair of samples as a proportion of the number of reads observed at that locus in both samples. consequently, the application and interpretation of the methods we develop here are substantially different from those of previous work in the analysis of high-throughput sequencing data.

analyses that account for paired data have thus far employed simplifying assumptions that neglect the full structure of the data. the only published method that has attempted the analysis of paired data is the generalised linear model approach implemented in the edger bioconductor package and described in mccarthy et al <cit> . we refer to this method subsequently as the edger-glm method. however, this method assumes a log-linear model for the data. this approximation may be appropriate for highly expressed genomic loci, but is likely to lack precision for lowly expressed genomic loci, in which the discrete nature of count data is particularly pertinent to their analysis. a similar generalised linear model approach is implemented in the deseq bioconductor package  <cit> , which we refer to subsequently as the deseq-glm method. we compare these alternatives to the approach developed here, and show that our approach offers gains in performance on both simulated and real data.

methods
the data from high-throughput sequencing experiments used in differential expression analysis may be thought of as a set of tags, defining the unique reads sequenced in the experiment, and a set of counts, giving the number of times each tag is observed in each of the sequenced libraries made from the samples. in many cases, the data for individual tags is combined to give a count for a larger genomic object. a common example is the summation of tags that map to a gene to give a single value for that gene’s expression. however, the same methods apply to any genomic object whose ‘expression’ can be quantified by high-throughput sequencing, whether that object is a single tag, a gene, mirna, sirna, methylation locus, et cetera. for each distinct genomic object, we thus have an ordered list, or tuple, of discrete counts with the sample order being identical in each tuple.

in analyses of paired data, we introduce the concept of a tuple pair. suppose that we have the count data from a set of n samples a={a <dig> ⋯,an}, paired with the samples a′={a1′,⋯,an′} respectively so that samples ai and ai′ form a sample pair. we define the observed data for a particular tuple pair, c, as  where uic is the count of the cth tuple for sample ai, and the data for the sample pairs as  where uic′ is the count of the cth tuple for sample ai′. the data for the tuple pair can then be defined as dc={,}. we adapt the methods developed for differential expression analysis in our previous work  <cit>  as these have been reported to show the best performance  <cit>  in analysis of high-throughput sequencing data. an empirical bayesian approach is used to estimate the posterior probabilities of each of a set of models that define patterns of differential expression for each tuple pair.

model definitions
in forming a set of models for the data, we consider which patterns are biologically likely. in the simple case of a pairwise comparison, we have count data for some sample pairs from condition a and condition b. if we suppose that we have two biological replicates for each condition, then there are counts from four sequencing libraries a <dig>  a <dig>  b <dig>  b <dig> paired with, respectively, counts from sequencing libraries a1′,a2′,b1′,b2′. in most cases, it is reasonable to suppose that at least some of the tuple pairs may be unaffected by our experimental conditions a and b. the count data for the sample pairs in these tuple pairs will then share the same underlying parameters. however, some of the tuple pairs may be influenced by the different experimental conditions a and b. for such a tuple pair, the data from the sample pairs a <dig> a1′ and a <dig> a2′will share a set of underlying parameters, the data from the sample pairs b <dig> b1′and b <dig> b2′ will share a set of underlying parameters, but, crucially, these sets of parameters will not be identical.

we can represent the models described in terms of the sets of samples for which the data are equivalently distributed under the model. thus, the model of no differential expression between experimental conditions can be represented by a single set 

 {,,,} 

 the model for differential expression between the two experimental conditions can similarly be represented by the two sets 

 {,},{,} 

 this set based description of the models allows great flexibility in constructing multiple models that may describe the observed data. the evaluation of the posterior likelihood of such a model based on the observed data for a single tuple pair is described below.

posterior likelihood of a model
consider some model m for these data defined by the sets {e <dig>  ⋯, em}. if, in this model, the ith and jth sample pairs ai,ai′and aj,aj′ are in the same set eq, then for these sample pairs, the data at tuple pair c shares the same underlying parameters ζq, and are conditionally independent given these parameters. the ζq are in turn drawn from some underlying distribution Θ
q. for computational simplicity, we assume that the ζq are independently sampled from the distribution Θ
q for each set eq.

given a model m for the data, the quantity of interest for each tuple c is the posterior likelihood of the model m given the data dc, that is 

  p=ppp 

we can then calculate p by considering the marginal likelihood 

  p=∏q∫ζq∈Θq∏i∈eqp∣ζq)pdζq 

the assumption of independence of the ζq reduces the dimensionality of the integral allowing a numerical approximation to this integral to be more easily calculated. we suppose that for each Θ
q we have a set of values Θ
q that are sampled from the distribution of Θ
q. then, following evans & swartz  <cit> 

  p≈∏q1|Θq|∑ζq∈Θq∏i∈eqp∣ζq) 

the task that then remains is to derive the set Θ
q from the data.

beta-binomially distributed data
there are a number of possible distributions which could be used for ∣ζq and ζq∣Θ
q. we develop our method based on the beta-binomial distribution for the tuple pair data, and derive an empirical distribution for the set of underlying parameters using the whole data set. we justify the use of the beta-binomial through the assumption of a poisson distribution for the number of sequenced reads for a given tuple c from an individual library sequenced for sample i. the poisson distribution has been justified as an approximation to an underlying multinomial distribution  <cit>  and has been shown to be a good approximation for the variation found between technical replicates  <cit> .

if the count uic is poisson distributed, and the count of the paired library uic′ is poisson distributed, then conditional upon the sum uic+uic′, uic is binomially distributed with parameter p indicating the expected proportion of reads belonging to the first of the sample pairs. however, biological variation will cause this proportion to vary between biological replicates, leading to over-dispersion in the observed data. in the absence of prior knowledge about the nature of this over-dispersion we suggest the beta-binomial model as the most convenient approach to model this over-dispersion.

we suppose that the expected proportion of reads from which uic is sampled is Π. if the library scaling factors  <cit>  of samples ai and ai′ are identical, then  this is sufficient to describe the distribution of uic and uic′ conditional upon their sum. however, if the library scaling factors li and li′ are the non-identical library scaling factors of samples ai and ai′ respectively, then the expected proportion becomes p=ΠliΠli+li′.

using the beta-binomial as a model for over-dispersion, we adopt the following parameterisation for the distribution 

 p=!uic!uic′!×bb,ϕ>0p=!uic!uic′!puicuic′,ϕ= <dig> 

where α=p1-ϕϕ and β=1-ϕϕ. Π defines the expected proportion of reads in uic and ϕ ∈ <cit>  is a measure of the over-dispersion of the data, where ϕ =  <dig> makes the model equivalent to the binomial distribution.

the variance of the binomial distribution under this parametrisation is p. the variance of the beta-binomial distribution is pϕ), making the additional variance in the beta-binomial distribution scale linearly with the dispersion parameter ϕ for fixed uic+uic′ and p.

empirically derived distributions
we can derive an empirical distribution for the parameters of a model m by sampling from the dataset. for each set of samples eq, we would like to find an estimate of the mean and dispersion of the distribution underlying the data from a single tuple pair; dc. by finding estimates of the mean and dispersion for a large number of tuple pairs, we create the sampling Θ
q. the chief difficulty here lies in properly estimating the dispersion. suppose that the data from a given tuple pair shows genuine differential expression. if the model that we are testing assumes that there is no differential expression, then the dispersion will be substantially over-estimated for this tuple pair. since we do not know in advance which tuple pairs are genuinely differentially expressed and which are not, we need to consider the replicate structure of the data in order to properly estimate the dispersions. we define the replicate structure by considering the sets {f <dig>  ⋯fs} where i, j ∈ fr if and only if sample pair aj,aj′is a replicate of sample pair ai,ai′.

given this structure for the data, we can estimate the dispersion of the data in a tuple pair dc by maximum-likelihood methods. we consider the likelihood of the tuple pair dc under the replicate structure to be 

  p=∏r∈1:s∏i∈frp 

and choose Πrc and ϕc to maximise this likelihood. this gives us a value for ϕc, the dispersion of the cth tuple pair.

in analysis of paired data, one question of interest may be to identify tuple pairs which show a particular ratio of expression between the sample pairs. the most usual case will be a one-to-one ratio , indicating that there is no differential expression of the tuple pair between the sample pairs. to model this, we simply set the Πqc as the constant proportion of expression to be examined for all c.

alternatively, we may wish to consider a model in which we are not interested primarily in the value of the ratios of expression between sample pairs, but only on whether these ratios are similar or different amongst various experimental groups defined by the sets eq. to approximate a distribution on the Θ
q for such a model, we can estimate the proportion Πqc of reads in the first count of each pair of samples for the tuple pair c. we achieve this by using the value previously acquired for ϕc and estimating Πqc by maximum likelihood methods. for notational simplicity, we define the data associated with the set eq as dqc={:i∈eq} and consider the likelihood of the tuple pair dqc to be 

 p=∏i∈eqp 

 we then choose Πqc to maximise this likelihood for each q. we can then form the set Θ
q = {} by repeating one of these processes for multiple sampled tuple pairs. we can then calculate p from eqn.  <dig> 

this method of estimating the dispersion assumes that the dispersion of a tuple pair is constant across experimental groups. where the number of samples is small, this is likely to be the best approach. where there is an expectation that the dispersion will be substantially different between experimental groups, and there are adequate numbers of replicates, there may be advantages to estimating the dispersions individually for each of the different sets of samples in each model, while still considering the replicate structure within these sets. this is easily done by restricting the data  to dqc when estimating the dispersion in eqn  <dig> 

estimation of prior probabilities of each model
a number of options are available when considering the prior probabilities of each model p required in eqn  <dig>  if we can estimate these from other sources, this may provide an easy solution. however, in many cases we may not be able to provide a reasonable estimate of prior probabilities. one option is to use the iterative re-estimation of the prior likelihoods as described in our previous work  <cit> . an alternative approach, which we have found subsequently to give more accurate estimates of the prior probabilities in most cases  is to use the bayesian information criterion . for each tuple pair dc we apply the bic to select the most likely model based on the calculated likelihoods p for each model m. this allows us to estimate the proportion of data that are best modelled by each of the models, which can be used as an estimate of the prior probablities of each model when calculating p for any individual tuple pair dc.

the scaling factor p
finally, we need to consider the scaling factor p in eqn.  <dig>  since the number of possible models is finite, though potentially large, the scaling factor p can be determined by summing pp over all possible m. in practice, the number of models may be further reduced by considering only those that are biologically plausible.

false discovery rates from posterior likelihoods
false discovery rates can be estimated directly from the posterior likelihoods estimated for each model. if the likelihood of a model m given the observed data for tuple pair c is pcm then the likelihood that this is not the true model for the data is 1-pcm. if hm is the set of the top m tuple pairs for the given model m, the false discovery rate is thus estimable as ∑c∈hm|hm|.

RESULTS
we use both simulated and real data to compare the beta-binomial method described to the edger-glm  <cit>  and deseq-glm methods.

simulated data
we base our simulations on those described by robinson & smyth  <cit> , simulating ten thousand tuple pairs from n sample pairs . we begin by simulating differential expression within pairings only, that is, some of the tuples are simulated so that the relationship between the paired counts is not one-to-one. a more complex experimental design is then simulated by the inclusion of simulated data in which the ratio of expression between the paired counts also differs between experimental groups.

we assess the performance of the methods by ranking the tuple pairs by their strength of association with each type of differential expression and computing the true and false positive rates using these ranked lists. for increased robustness, we estimate the mean of these rates over one hundred simulations under each set of conditions.

for the ith sample of a non-differentially expressed cth tuple pair, the paired counts uic and uic′ are simulated from poisson distributions with means λcliqicmic and λcli′qic respectively. the λc, which define a baseline of expression for the tuple pair when scaled by the library size, are sampled randomly from a set of values empirically estimated by the edger method  <cit>  from a sage dataset consisting of both normal and cancerous cells  <cit> . the li and li′, representing library scaling factors specific to each sequencing library, are sampled from a uniform distribution between  <dig> and  <dig> 

we simulate individual effects in the data by allowing qic to vary for each sample pair i as well as for each tuple pair c. we simulate this variation by setting qic=2νic where ν is sampled from a uniform distribution between - <dig> and  <dig>  allowing for up to sixteen-fold variation in expression between sample pairs due to individual effects.

the mic allow us to introduce differences between experimental groups of sample pairs and between the members of a pair, while allowing for variation between biological replicates. they are sampled from a beta distribution with shape parameters aic=μicμic+μic′1-ϕcϕc and bic=μic′μic+μic′1-ϕcϕc. in the case of a non-differentially expressed tuple pair c, μic=μic′= <dig> for all i. for differentially expressed tuple pairs, we select the values μic and μic′ in various ways to simulate different types of differential expression. the values ϕc, which indicates the level of dispersion  are drawn from a beta distribution with shape parameters  <dig>   <dig> 

we begin by simulating the simplest case of a paired analysis. in this scenario we are interested only in the differences within paired counts, that is, we search for tuple pairs which show evidence for a deviation from a one-to-one expression ratio between the paired counts. we simulate one thousand differentially expressed tuple pairs. for a differentially expressed tuple pair c, μic=2fc and μic′=2-fc for each i, where fc is drawn from a uniform distribution between -b and b, where b is allowed to vary.

we examined the performance of the methods on the basis of roc curves. figure  <dig> demonstrates the performance of the methods on simulated data for b =  <dig>   <dig> and  <dig> for n =  <dig> and  <dig> 

for low false positive rates, the performance of the methods is approximately equal as each identify the ‘low-hanging fruit’, those tuple pairs showing high differential expression with relatively low biological variation. however, for higher false positive rates the beta-binomial method shows a clear and consistent gain in performance over the generalised linear modelling approaches. the deseq-glm in general performs better than edger-glm, especially for higher numbers of sequenced libraries. for high library numbers, the performance of deseq-glm approaches that of our beta-binomial approach.

we next consider the more complex case where differential expression exists both within paired counts, and between experimental groups. this is equivalent to an experimental set-up in which we have sample pairs from condition a, a <dig>  …, an paired with samples a1′,…,an′ respectively, and sample pairs from condition b, b <dig>  …, bn paired with b1′,…,bn′ respectively. we want to find not only tuple pairs that show a consistent variation of expression from a one-to-one ratio within paired counts across all sample pairs , but also those which show an altered ratio of expression between conditions a and b.

we again simulate ten thousand tuple pairs. for one thousand of these, we simulate differential expression within paired counts as before. for a second group of one thousand tuple pairs, we also simulate differential expression between experimental conditions. we simulate differential expression between experimental conditions by applying a scaling factor gc to one of the two experimental conditions. this is applied such that for a differentially expressed tuple pair c, the data for half the sample pairs, representing the first experimental condition, are simulated using the values μic=2fc2iicgc and μic′=2-fc2-iicgc. for the remaining half of the sample pairs, representing the second experimental condition, using the values μic=2fc2gc and μic′=2-fc2-gc. here fc is simulated as before and gc is drawn from a uniform distribution between -d and d. iic is an indicator variable randomly sampled from { <dig> } for each tuple pair c indicating whether the effect is assigned to the first or second experimental condition.

both the beta-binomial approach and the generalised linear modelling approaches are capable of simultaneously detecting both types of differential expression, however, the form of results acquired by these two approaches differs. for the beta-binomial approach, posterior likelihoods are calculated for each available model, and hence only one model for each tuple pair can be assigned a high posterior likelihood. if the true differential expression of a tuple pair involves changes in expression ratios between experimental groups, the model for consistent change from a one-to-one ratio between paired counts will have a low posterior likelihood as the change will not be consistent across the tuple pair. for the generalised linear modelling approaches, both a pair effect and an experimental group effect, and the significance with which these differ from zero, are calculated for each tuple pair. consequently, both effects can be present with high significance even when changes in expression are driven primarily by a change in expression ratios between experimental groups.

if those tuple pairs simulated as showing differential expression ratios between experimental groups are treated as false positives when considering differences from a one-to-one ratio between paired counts, this heavily penalises the generalised linear model methods. if they are treated as true positives, the generalised linear modelling approaches are evaluated on the basis of two thousand true positives where the beta-binomial method is evaluated on the basis of one thousand true positives, making performance comparisons difficult. to allow fair comparisons between the methods, we therefore exclude the thousand tuple pairs simulated as showing differential expression ratios between experimental groups when calculating the true and false positive rates for detection of differences from a one-to-one ratio within paired counts.

in this more complex case, the difference between the performance of the methods is considerably more pronounced. particularly in identifying differential expression between experimental groups, the beta-binomial method shows considerably better performance than that of both generalised linear modelling approaches. in identifying differential expression from a one-to-one ratio within paired counts, the performance of the beta binomial method is similar to that shown in figure  <dig>  where this is the only type of differential expression present in the data. however, the performance of the generalised linear modelling approaches is substantially degraded in this more complex scenario.

the simulated data described above are drawn from sets of poisson distributions whose parameters are a multiple of a random variable drawn from a beta distribution. therefore, the simulated data have a beta-binomial distribution, the model proposed for the analysis. we can examine the robustness of the model by considering an alternative distribution for the simulations. since the poisson distribution is a well established model for the technical effects observed in high-throughput sequencing data  <cit>  we test the robustness of our method by using the minimax distribution  <cit>  as an alternative to the beta distribution for the random variables mic. the minimax distribution is also a two-parameter distribution on  with density 

 f=f=α^β^xα^-1β^- <dig> 

 the moments of this distribution are given in terms of the beta function such that 

 e=β^b 

 consequently, it is not possible to establish closed-form expressions for the parameters α^ and β^ in terms of the desired mean and variance of the random variables mic, nor is it possible to define a dispersion parameter for this distribution. in order to select parameters for the minimax distributions used to simulate the data, we therefore calculate the parameters for the beta distribution as described above. we then  calculate the parameters of the minimax distribution such that the mean and variance of each random variable are identical to those which would be used in the case of the beta distribution. this approach has the advantage that, for given parameters of simulation, the results are directly comparable between those data simulated using a beta distribution and those simulated using a minimax distribution.

results for the application of the three methods to data simulated using the minimax distribution are shown in additional file  <dig> . these results are consistent with those acquired on the simulated data using the beta distribution, suggesting that the methods we propose are reasonably robust to the underlying distribution of the data.

biological data
we examine a set of paired data from a recent study of oral squamous cell carcinoma  <cit> . the study includes three patients with samples taken from tumour and matched normal tissue. as far as possible, we duplicate the analysis conducted by mccarthy et al <cit>  using the edger-glm method to allow comparison with our beta-binomial approach. our analysis begins with the processed data provided as supplementary material to tuch et al <cit> . we map the refseq identifiers included in the dataset to gene symbols using the bioconductor annotation package org.hs.eg.db . we then discard data associated with a refseq identifier whose gene symbol is not identified and all but one of any duplicated gene symbol, keeping the data with the greatest number of exons. this results in paired count data for  <dig> genes.

we analyse these data to find both genes displaying a consistent fold-change between tumour and normal tissue, and those genes which show heterogeneity in fold-change between the paired counts belonging to the individual patients. the patients are treated as biological replicates for the purposes of dispersion estimation  despite the presence of some genes displaying patient-specific effects. in the absence of true biological replicates, this is required in order to carry out a meaningful analysis. we construct a set of models testing both for consistent differential expression between tumour and normal tissue and for differing ratios of expression between individuals. we acquire posterior likelihoods for each of these models of differential expression and hence can evaluate either the likelihood that each gene displays consistent differential expression between normal and tumour samples, or the likelihood that a gene displays differential expression of any kind .

we identify  <dig> genes displaying a consistent ratio of differential expression between tumour and normal samples at a false discovery rate  of  <dig>  . this is considerably lower than the  <dig> genes reported by mccarthy et al <cit>  as differentially expressed between tumour and normal tissue, reflecting the premium that our approach places on consistency of expression ratios across the samples. in examining differential expression of any kind, we discover  <dig> genes at a false discovery rate of  <dig> , indicating the heterogenous nature of the patients. the effect of this heterogeneity can also be seen in an examination of previously reported genes. of  <dig> genes reported by yu et al <cit>  in a systematic review of head and neck squamous cell carcinoma transcriptomics, we find twenty that have differential expression of some kind between normal and tumour samples with an fdr of less than  <dig> ; of these, however, only two  show consistent changes in ratio of expression between normal and tumour samples at the same fdr . this pattern is repeated in the nine genes reported as being of particular interest in tuch et al <cit> ; we find that seven of the nine genes have differential expression of some kind between tumour and normal at an fdr of  <dig>  but none show strong evidence for consistent fold-changes in ratio .

comparisons with the highest-ranked differentially expressed genes discovered by the edger-glm approach show a more consistent picture. of the reported ten most significant genes from their analysis, five are also selected in our list of the twenty-nine genes showing consistent differential gene expression ratios at an fdr of  <dig> , while the remainder still have an estimated likelihood of consistent differential expression greater than 90%. rank correlation between the gene lists produced by the two methods is  <dig>  if the genes are ranked by the likelihood of consistent differential expression but  <dig>  if they are ranked by the likelihood of differential expression of any kind.

as in mccarthy et al <cit> , we also demonstrate the biological relevance of the genes we identify by comparisons with the curated gene sets in the msigdb database  <cit> . from the twenty-nine genes identified with consistent differential expression, the msigdb gene sets identified as showing enrichment are predominantly cancer related ; of these, the top two sets are from two separate studies of head and neck squamous cell carcinomas  <cit> . comparisons using the  <dig> genes identified as showing differential expression of any kind also show a overwhelming preponderance of cancer related gene sets  and identify an extremely high proportion of the up and down-regulated genes from cromer et al <cit>  as well as in various subsets of genes associated with various subclasses of head and neck squamous-cell carcinomas  <cit>   and a set of hypoxia associated genes in head and neck carcinomas  <cit> .

CONCLUSIONS
we have presented here an empirical bayesian approach to analysing differential expression in paired sample high-throughput sequencing data based on the beta-binomial distribution. the distributions of the parameters of the beta-binomial distribution are estimated by repeated sampling from the observed data, and these distributions are used to estimate posterior likelihoods for each proposed model of expression for each tuple pair. estimating the distributions of the prior parameters in this way creates a ‘borrowing’ of information across tuple pairs, as the posterior likelihoods for each tuple are calculated using the observed data for all sampled tuple pairs. in analyses with large numbers of outliers, it may be advantageous to ‘squeeze’  <cit>  the estimated distributions to diminish the effects of these outliers. however, we do not consider this approach here.

our method is implemented as part of the software package bayseq . the methods are computationally intensive but readily parallelisable, so that a full analysis of the tuch et al <cit>  data can be carried out in approximately fifteen minutes on a single machine with eight 2ghz processors.

as with the most successful approaches to analysis of unpaired sequencing data  <cit> , our approach for paired data requires no transformation of the data but deals with raw counts directly. this approach should allow for considerably greater accuracy in the detection of differential expression between paired counts. the model-based approach outlined here extends our previous work in the analysis of high-throughput sequencing data  <cit>  and provides great flexibility in the analysis of complex experimental designs, allowing for various types of differential expression in paired data to be simultaneously identified.

a key assumption made in developing this method concerns the nature of the over-dispersion between samples caused by biological variation. in the absence of available data from which to infer the precise nature of the over-dispersion, we have assumed for computational convenience that the beta distribution is a suitable model for the biological variation in ratios of expression between sample pairs and hence that the distribution of the count data may be modelled with the beta-binomial. the beta distribution is remarkably flexible and is thus likely to be capable of accounting for the behaviour of most paired data, although in certain circumstances this assumption may fail. we note, however, that the principles of the empirical bayesian approach may be applied for any underlying distribution, and so might be adapted to meet this circumstance.

we demonstrate the performance of our methods on both simulated and real data. in analyses of simulated data using a range of parameters, we show considerable gains in performance compared with two implementations of a generalised linear modelling approach, especially when more complex patterns of differential expression are present in the data. the gain in performance using our methods is particularly marked for larger numbers of samples, a result that is likely to be increasingly important as the cost of sequencing experiments declines, allowing larger studies. this gain in performance is also found when the minimax distribution  <cit>  is used in the simulations, suggesting that our methods are reasonably robust to the underlying distributions that may be present in biological systems.

the analysis of the biological data from tuch et al <cit>  demonstrates that similarly good results can be attained in real-world scenarios. there is a fairly strong correlation between our results and those from the edger-glm approach  <cit> , particularly for the highest ranked genes. this not surprising; those genes showing the largest and most consistent levels of differential expression will be readily identified by any method. however, the analysis of enrichment of those genes identified by the beta-binomial method in curated gene sets from msigdb identifies not only an overwhelming preponderance of cancer related genes but also those specifically related to head and neck squamous carcinomas. these results compare favourably with those reported in mccarthy et al <cit> , which, although also showing enrichment in primarily cancer-related sets, do not show the same level of association with head and neck squamous carcinoma gene sets. more detailed comparisons using real data are desirable, but at present no well validated data exists on which to make such comparisons.

the comparison of paired mrna-seq samples is a major application for our method. however, there are other key applications. in particular, paired data arise naturally in studies of epigenetic markers, such as chromatin and methylation marks, where the prevalance of a particular marker is compared to a baseline measurement for each marker. our method is, therefore, likely to have wide applicability not only in cancer and other areas of medicine but also in fundamental life science research.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
tjh designed and implemented the methods described and drafted the manuscript. kak helped to draft the manuscript. both authors read and approved the final manuscript.

supplementary material
additional file 1
supplementary figures and tables. figure s1: roc curves showing the performance of the beta-binomial, edger-glm and deseq-glm methods in identifying differential expression within paired counts in data simulated using the minimax distribution to simulate biological variation. simulations are carried out for various combinations of b, a measure of the level of differential expression, and n, the number of paired libraries. figure s2: roc curves showing the performance of the beta-binomial, edger-glm and deseq-glm methods in simultaneously identifying differential expression from a one-to-one ratio within paired counts  and differential expression between experimental groups  in data simulated using the minimax distribution to simulate biological variation. simulations are carried out for various combinations of b, a measure of the level of differential expression within paired counts, d, the level of differential expression between experimental groups, and n, the number of paired libraries. table s1: the top twenty-nine genes  showing consistent ratios within patients of differential expression between normal and tumour samples. table s2: the twenty-five genes identified by yu et al  as being of interest in a systematic review of head and neck squamous cell carcinoma transcripts, as ranked by their likelihood of showing differential expression of any kind in the tuch et al  data. table s3: the nine genes identified by tuch et al  as being of particular interest, as ranked by their likelihood of showing differential expression of any kind. table s4: gene sets showing enrichment  in the eight up-regulated in tumour genes showing consistent differential expression at fdr >  <dig> . head and neck squamous cell carcinoma gene sets are highlighted. table s5: gene sets showing enrichment  in the twenty-one down-regulated in tumour genes showing consistent differential expression at fdr >  <dig> . head and neck squamous cell carcinoma gene sets are highlighted. table s6: gene sets showing enrichment  in the  <dig> down-regulated in tumour genes showing any differential expression at fdr >  <dig> . head and neck squamous cell carcinoma gene sets are highlighted. table s7: gene sets showing enrichment  in the  <dig> up-regulated in tumour genes showing any differential expression at fdr >  <dig> . head and neck squamous cell carcinoma gene sets are highlighted.

click here for file

 acknowledgements
thomas j. hardcastle is supported by the european commission seventh framework programme grant number  <dig> 
