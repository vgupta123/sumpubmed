BACKGROUND
strategies for effectively sequencing entire large genomes typically employ one of two approaches: a) bac-by-bac sanger sequencing of clones that represent a minimum tile path  derived from a physical map  as has been carried out for rice and maize  <cit> ; or b) a whole-genome shotgun  sequencing paradigm in which genomic libraries are sequenced using the sanger technique as was done for, e. g., populus, grapevine, and sorghum  <cit> . the mtp approach requires library preparation and the construction of a physical map which increases assembly accuracy at an additional cost. however, a prime advantage to using an mtp and individual bac clones relative to a wgs strategy is that assembly errors are localized to individual sequenced clones and the incorrect pasting of distal chimeric regions of the genome is prevented.

with the advent of next-generation sequencing technologies, it has become possible to sequence genomic dna at high coverage and quickly relative to sanger-based methods. for example, the roche/ <dig> pyrosequencing approach has been shown to be effective in sequencing genomic dna fragments from several species including barley  <cit> , rice  <cit> , and atlantic salmon  <cit> . given the reduction in time and cost offered by new sequencing technologies, it is now possible to modify the mtp strategy by pooling bac clones and "cheaply" sequencing them at sufficient coverage to provide for accurate assembly. pooling speeds up the sequencing process and dramatically reduces cost. this approach was taken by rounsley et al.  <cit> ; they used roche  titanium next-generation sequencing reads of  <dig> bac pools of ~3mbp mtp each to assemble a 19mbp region of the short arm of rice chromosome  <dig>  <cit> . in our study, we sought to extend the findings of rounsley et al. and others by using a simulation approach. we constructed mtps from several plant genomes and assembled them using simulated roche/ <dig> reads with injected sequencing error.

choosing the best sequencing strategy has received attention recently  <cit> . schatz et al.  <cit>  discussed the tradeoffs among read length, coverage, and expected contig length in a genome assembly. they also reviewed recently published genome assemblies generated with various second-generation sequencing strategies. gnerre et al.  <cit>  briefly explored the effect of using different read coverage levels in a mouse chromosome assembly. additionally, goldberg et al.  <cit>  have determined proportions of conventional sanger vs.  <dig> sequencing data that would yield high-quality yet cost-effective assemblies.

our goal in this work was to a) implement a scoring system to determine assembly accuracy through re-alignment with a reference genome; b) determine which sequencing coverage yields optimal assembly results on an a. thaliana 3mbp pool; c) test whether the pooled bac approach could be extended beyond 3mbp pools; and d) determine if the approach would work on genomes of varying complexity.

RESULTS
construction of simulated reads
simulated  <dig> sequencing reads were generated for each genome sequence studied. read lengths and quality scores were extracted from actual  <dig> sequencing data generated from t. cacao . models for generating uneven sequencing coverage and sequencing errors were developed and applied . the error rates applied correspond to published estimates  <cit> , with insertion/deletion type errors being more frequent than nucleotide substitutions, and homopolymer runs being especially prone to errors. each bac pool consists of a collection of bacs organized as a mtp. the mtp organization of the bacs was extracted from actual data available in the msu rice database  <cit> , and is characterized in materials and methods. bac end sequences  like those that would be produced as a result of sanger sequencing were generated for each pool's minimum tiling path, and additional bes were generated once per every  <dig> kbp, on average, across the reference sequence. sanger-sequencing type errors were also introduced into the bes.

scoring functions
we developed a scoring system to use in evaluating each assembled pseudomolecule against the reference sequence. each score has a value from  <dig>  to  <dig> . higher scores indicate better pseudomolecule sequence quality with respect to matching regions, relocations, inversions, and redundancy. we chose these features as an intuitive and comprehensive set that captures the effects of correct and erroneous assembly. coverage of the reference and various assembly size statistics are often used to evaluate assemblies. here we also focus on the misassembled regions; we are able to capture these since we know the reference sequence. our scoring functions can be applied to any genome comparison and provides a common reference point in evaluating assembly algorithms. details on the scoring functions are given in materials and methods.

optimizing linear and shotgun read mixtures for various arabidopsis bac pool sizes
the effect of mixing 5x coverage increments of linear  and paired   <dig> read mixtures on 3mbp, 6mbp, 9mbp, 12mbp arabidopsis genome pools was tested. all combinations, up to 20x coverage , were assembled using 'default' or 'optimized' cabog assembly parameters . dot-plot alignments between the template and assembly pseudomolecules under both assembly conditions are shown in additional file  <dig> while numerical score comparisons of the same pseudomolecules are shown in table  <dig>  assembler statistics for the  <dig> mbp and  <dig> mbp pool assemblies can be found in additional file  <dig> and even more complete accounting, including data for the  <dig> mbp and  <dig> mbp pool sizes, is shown in additional file  <dig> 

assembly evaluation scores and scaffold statistics determined for pseudomolecules created using  <dig> mbp pools with 15x linear + 5x paired read coverage are shown for all of the genomes studied. scores were determined using default and optimized assembly parameters, except for z. mays that was only assembled using default parameters.

measures of assembly correctness were obtained using our scoring functions, all five scores for the arabidopsis assemblies are shown in figure  <dig>  the assembly with the best combined score was obtained using a 15x linear  and 5x paired  mixture derived from a 3mbp pool . the best read mixtures for the 6mbp, 9mbp, and 12mbp pools were 10l-5p, 20l-15p, and 20l-15p, respectively. the assembly scores for all of the arabidopsis pool mixtures can be found in additional file  <dig>  dot-plots of  <dig> mbp assemblies obtained using the 'optimized' assembly parameters graphically revealed that various read mixes can inhibit proper assembly . for example, the 3mbp assembly with the worst score, showing a strikingly poor assembly in figure  <dig>  was derived from a 5l-0p mix.

when initiating an expensive genome sequencing project, it is important to decide the minimum amount of sequence information required for an assembly of desired quality. our simulations indicate that there is an optimal sequencing depth required for obtaining an accurate assembly that covers a high percentage of the target genome sequence. under-sequencing is intuitively an obvious problem which can be visualized using our methods . less intuitively, over-sequencing can inhibit assembly quality as well as evidenced by the  <dig> mbp 20l-20p assembly being ranked 18th out of the twenty-four 3mbp assemblies analyzed . we also found that 15l-5p was sufficient to yield a 3mbp super-scaffold of reasonable quality making it an excellent target sequence mix and depth for a 3mbp pooled bac project; however, the addition of 5l + 15p would double the sequencing cost and diminish the assembly quality of such a project, as suggested by the low rank of the 20l-20p assembly in figure  <dig>  furthermore, coverage can be reduced even further if a lower-quality draft is sufficient for applications such as whole-genome comparisons with a high-quality reference genome.

exploring assembly scores vs. coverage
to better understand the dependencies between read coverage and assembly scores, we studied their relationships in detail. we divided the scores into two categories: match scores  and other scores , and studied the relationship between scores and total read coverage. figure  <dig> shows the results for all arabidopsis 3- <dig> mbp pools. these results indicate that increasing read coverage up to a certain saturation point  improves match scores; after that point increasing coverage may not improve the results. the other scores stay more or less constant across read coverages.

we also took a closer look at the behavior of all individual scores for the  <dig> mbp arabidopsis assemblies, the results are shown in figure  <dig>  each line represents a fixed paired coverage, with each x-axis point represents a linear coverage. one can for example see that the best relocation score at 0l linear coverage is achieved with 5p paired coverage, and that the match score at 10p paired coverage always improves when linear coverage increases. this detailed look at the assembly scores shows that adding coverage does not always produce better results, and explains which aspects of some of the high-coverage assemblies contribute to poor scores compared to lower-coverage assemblies.

comparing assemblies among six plant genomes
in order to verify that our simulation results are applicable to other genomes, we simulated additional  <dig> , <dig>  mbp paired and linear datasets derived from the grape , rice , black cottonwood , sorghum , and maize  genome assemblies. differences between these genomes are outlined in table  <dig>  and the studied sequences are detailed in additional file  <dig>  these five genomes represent two additional dicot and three monocot genomes comprised of very different gc and repeat sequence contents. we then assembled the simulated sequence data using the 15l-5p mix that had been optimal for the arabidopsis  <dig> mbp assembly . the scores we obtained for these assemblies are comparable to those we obtained in the arabidopsis simulation using the 15l-5p mix  indicating that while our assembly results vary somewhat from genome to genome, reasonable assemblies of reasonably good quality can be reliably generated using the 15l-5p mix. additional file  <dig> contains all cabog assembly statistics, including n <dig> and gap statistics, for each assembly in our simulation study.

repeat fraction was determined by counting the fraction of masked nucleotides from http://www.phytozome.net  masked assemblies except for ath <dig> which was taken from the premasked genome  from http://www.repeatmasker.org/premaskedgenomes.html.

evaluation scores and scaffold statistics for assemblies determined using 15x linear + 5x paired read coverage and pool sizes  <dig> mbp,  <dig> mbp,  <dig> mbp, and  <dig> mbp are shown for all of the genomes studied. default assembly parameters were used.

assembly simulations of whole genomes: whole genome shotgun vs.  <dig> mbp pooled bac approaches
we studied the differences in whole genome assembly results obtained using the wgs and pooled bac approaches. read coverages of 15x linear + 5x paired were used. all five arabidopsis chromosomes were first modeled as an mtp of bacs . for the wgs approach, reads were generated across the chromosomes and provided to the assembler. the resulting assembly consisted of pseudomolecules for each of the five chromosomes. for the pooled approach, the mtp was divided into pools of approximately  <dig> mbp and each pool's reads were assembled independently. thirty-nine pseudomolecules, one for each pool, were subsequently assembled. the pools for each chromosome were combined to produce chromosome-scale pseudomolecules.

dot plots of the chromosome-scale pseudomolecules are shown in figure  <dig>  these pseudomolecules were scored against the reference chromosome sequences. the scores are provided in table  <dig>  and scores for individual pools are provided in additional file  <dig>  in figure  <dig>  a few major relocation errors were observed for the wgs approach . closer examination of the relative changes in individual wgs scores with respect to the pooled bac scores  revealed that the pooled bac approach improves all assembly scores, as expected. a great improvement was observed in coverage, e.g., increase from 76% with the wgs method to 93% with the pooled bac approach for chromosome  <dig>  we achieved only 76—90% coverage per chromosome using the wgs approach but 93—97% coverage per chromosome, a definite improvement, using the pooled bac approach. the redundancy score was also clearly better for pooled bacs compared to wgs.

assembly evaluation scores and scaffold statistics are shown for the arabidopsis chromosome pseudomolecules obtained from assembling wgs and pooled bac data. chromosome scaffold statistics for pooled assemblies are averages over the values for each pool in that chromosome. optimized assembly parameters were used.

we also examined whether repeated sequence content could have contributed to the lower scores we determined for some assemblies as opposed to others. we compared the arabidopsis repeat sequence content annotated by repeatmasker  <cit>  to the corresponding assembly scores for each bac pool. the results are shown in additional file  <dig> and additional file  <dig>  gradual decrease of assembly scores with increased repeat sequence content was observed, which supports the common understanding that repeat-rich regions of genomes are more challenging to assemble.

comparing a single insert size library with multiple insert size libraries with the same combined coverage
our assemblies thus far are based on various combinations of linear and paired reads, where paired reads arise from a  <dig> kbp insert size library. however, multiple insert libraries are critical for assembling whole-genome shotgun libraries in practice. longer reads tend to bridge repetitive dna which is difficult to resolve by short reads. however, the fact that sequencing pooled 3kbp fragments by  <dig>  alone is sufficient for a reasonable assembly is a useful observation since only a single library construction is required thereby significantly reducing costs.

the fact that more 3kbp fragments are nested within repeats relative to 8kbp fragments and we still get good assemblies is an indication of the robustness of the genome measurements made by the mixed linear/paired 3kbp  <dig> approach. with that said, we still performed some assemblies with 8kbp fragments to see if the assembly correctness changes when assembling 5x paired 3kbp pairs coverage, compared to assembling the same amount of paired coverage but from two different insert size libraries . additional 15x linear coverage was used in both cases. the results of this comparison are shown for 3— <dig> mbp segments from the maize genome in table  <dig>  when using two different insert size libraries, coverage improves but relocation and redundancy scores are reduced, indicating more assembly mistakes with the 3kpb + 8kbp paired read mixture. the scaffold n <dig> size also increases when using the two insert size libraries, indicating the assemblies with the 3kpb + 8kbp paired read mixture are less fragmented.

assembly evaluation scores and scaffold statistics are shown for maize 3-- <dig> mbp pool assemblies constructed from  15x linear + 5x paired  <dig> kbp insert size library reads, and  15x linear +  <dig> x paired  <dig> kbp insert size library +  <dig> x paired  <dig> kbp insert size library reads.

CONCLUSIONS
high-throughput sequencing technologies enable the sequencing of genomic dna at high coverage and much more rapidly than sanger-based methods. with the decrease in both time and expense it is possible, as well as practical, to pool bac clones and sequence the pools at coverages that provide for accurate assembly. the obvious advantage of such an approach, over whole genome shotgun sequencing , is that errors in assembly related to distal chimeric regions are completely avoided and any other errors are restricted to only local regions of the assembly. we have examined this approach for assembling genome sequences of varying complexity and for pool sizes up to  <dig> mbp. we have also performed a whole-genome assembly simulation of the  <dig> mbp arabidopsis genome and compared the results to results obtained using the wgs approach. to quantify the assembly quality in relation to the different variables of our experiment, we devised measures that enable comparisons of multiple assemblies. we found that although a physical map, or some alternative additional information, is required to order the scaffolds in both the wgs and pooled bac approaches, the latter results in assemblies of higher quality as determined using our objective quality scores.

 we achieved only 76—90% coverage per chromosome using the wgs approach but 93—97% coverage per chromosome, a definite improvement, using the pooled bac approach. since bac pools of up to 12mbp were assembled well, and assuming an approximate roche/ <dig> titanium limit of 400bp reads and 200mbp/plate, our results suggest that a  <dig> mbp genomic region could be re-sequenced with only a full plate of linear reads and a half plate of paired-end reads, which would yield what we found to be the optimal 5x paired and 15x linear coverage combination after read pre-processing. our results also indicate that over-sequencing may not yield more accurate results, sequencing beyond 30x coverage is not required and a 15l-5p mix of a 3mbp dna fragment library may be adequate to produce a draft genome sequence of good quality.

 we believe that the simulated pooled bac assemblies turned out to be of sufficient quality for de novo assembly of targeted regions. these assemblies have imperfections like all assemblies, but we feel they are of sufficient quality for gene discovery as well as providing a mapping template for re-sequencing applications. therefore, we see the pooled-bac approach targets researchers who require a quality assembly from only a portion of the genome for a) re-sequencing or b) validation of a wgs assembly. of course, there are limitations to using a partial genome as a template for mapping short reads since homologous reads from distal parts of the genome could map to the sub-genome assembly. however, this problem can still occur with a full genome assembly.

finally, the scoring measures presented here can be used generally to evaluate and compare results of simulated genome assemblies.

although factors such as cost and speed have influenced the change of sequencing technologies over the years, challenging the assembly process the algorithms have coped well and more and more genomes are getting sequenced every day. however the nagging worries continue to be accuracy as well as completeness of these genome assemblies. sequencing technologies are changing rapidly but our basic expectation from them, which is the correctness the genome assembly, continues to remain the same. in this study, for the sake of tractability, we removed the assembler out of the equation to the extent possible and focused on the effect of regimes on the correctness of the sequence assembled. we observed in our experiments that increasing the sequencing depth progressively or introducing multiple libraries did not necessarily improve the quality of the assembled sequence. this lack of monotonicity in the accuracy is counter-intuitive and we can only speculate as to what the possible reasons could be. thus in this complex multifactorial task of genome sequencing, a natural and reliable approach to examining the effectiveness of different regimes suggested by the underlying technologies and prevalent wisdom, we believe is a controlled  environment. the community will greatly benefit by the establishment of benchmark set of genomes  with a range of varying characteristics such as repeat content and genome sizes, to check the effectiveness of both the technologies as well as the algorithms. in this paper, we used a set of six plant genomes with repeat contents varying from 16% to 73% and size from  <dig> mbp to  <dig> gbp. we also presented a set of objective  correctness scores to evaluate the results. we believe the combination of the benchmark genomes and the assembly evaluation criteria is a good starting point and an effective test-bed even for the technologies of the future.

