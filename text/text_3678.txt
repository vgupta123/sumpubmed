BACKGROUND
the goal of the microarray quality control  project was to identify quality metrics for evaluating gene expression measurement technologies <cit> . the maqc study provided a set of reference rna samples with large numbers of differentially expressed genes consisting of the commercially available a sample from pooled human cell lines and the b sample from a pooled human brain preparation. these two samples were exhaustively analyzed on a number of different whole genome microarray platforms and quantitative real-time pcr  <cit> .

with the advent of the new "next-generation" sequencing technologies, it is now practical to analyze gene expression by the direct shotgun sequencing of complementary dna  synthesized from rna samples <cit> . this approach has already been applied to discover novel gene sequences in the transcriptomes of human cell lines <cit>  and plants <cit>  and to identify cancer related single nucleotide polymorphisms  in transcribed sequences in human cancer transcriptomes <cit> . more recently papers have appeared using this technique to confirm predicted genes in the bacteria <cit>  and to identify novel transcription products and to quantify expression levels in the yeast <cit> , mouse  <cit> , human hela cells <cit> , and the cerebellar cortex of schizophrenic patients <cit> .

to provide a preliminary evaluation of the performance of these promising technologies for gene expression analysis, we performed deep sequencing of the microarray quality control  reference rna samples using roche's  <dig> genome sequencer flx  <cit> . for this study, we generated more than  <dig>  million sequence reads of average length  <dig> bp for cdna generated from the maqc a and b samples <cit> . using our expressseq pipeline over 90% of the reads mapped to the human genome and 64% of the reads mapped to the refseq database of well annotated genes using blast with e-values ≤ 10- <dig>  corresponding to at least  <dig> perfect match bases.  by counting the numbers of reads that map to individual genes we can measure the gene expression levels in the two samples to evaluate the maqc quality metrics and compare the results with dna microarrays and qrtpcr.

we have also performed a careful mapping of the transcriptome reads to the genome using the aceview alignment programs used to construct the aceview database of genes and alternative splice variants from cdna sequences in all public databases <cit> . many of the gs flx reads spanned one or more exon junctions recovering approximately 60% of the exon junctions already annotated in the refseq database and 36% of the exon junctions in the comprehensive aceview database. in addition thousands of new exon junctions were identified spanning standard introns in the genome that have not been previously annotated in any public databases. these additional results speak to the great promise of deep transcriptome sequencing to rapidly shed new light on the complexity of the eukaryotic transcriptome.

RESULTS
mapping of reads to the refseq, ccds, and aceview databases
complementary dna  for the maqc a and b reference rna samples was shotgun sequenced in  <dig> separate sequencing runs on the gs flx platform. a total of  <dig>  million transcriptome reads were generated of average length  <dig> bp,  <dig>  million for sample a and  <dig>  million for sample b. two different protocols were compared in this study for the preparation of cdna from the rna samples: 1) odt: an oligodt reverse transcription  protocol to generate double stranded cdna which was then converted into a single-stranded library for sequencing and 2) tseq: a random primer rt process directly to single-stranded cdna library for transcriptome sequencing. 

the reads were mapped to the human genome and to the refseq database of well-annotated rna sequences using the expressseq pipeline implemented on a windows desktop. to evaluate the coverage of the expressed sequences, only the best blast alignment with the smallest e ≤ 10- <dig> value was counted as a hit. table  <dig> provides a summary of these mapping results for both the odt and tseq protocols. overall more than 90% of the reads mapped to genomic dna, while only 58–73% of the reads mapped to refseq gene sequences, indicating that there are still many more expressed sequences to be included in refseq. only a small number of reads  failed to map to the human genome with e ≤ 10- <dig>  although some of these unmappable reads may be poor quality reads or sequencing artifacts, many may still represent novel spliced exons or edited transcripts worthy of further study.

*an expressseq "hit" is the single best blast alignment of the gs flx reads to sequences in each database with e ≤ 10- <dig> 

of the  <dig>  million reads that mapped to the refseq sequences, approximately 80% aligned to the well annotated mrna sequences denoted with an nm identifier while the remaining refseq reads hit the predicted xm mrna sequences or the well annotated or predicted regulatory sequences designated by nr and xr, including ribosomal rrna. in addition, approximately 60% of the pooled cell line nm reads and 45% of the brain nm reads mapped to the protein coding regions identified in the consensus coding sequences  database which suggests that transcripts in the brain tend to have longer 3' utrs.

finally, since the aceview databases of expressed transcripts provides the most comprehensive listing of spliced and unspliced human mrnas compiled from all public cdna sequences, we applied the expressseq pipeline to count all reads that hit sequences in the aceview database of  <dig>  "good" genes and their splice variants that are supported by at least  <dig> overlapping genbank sequences or encode a putative protein. table  <dig> shows that an additional  <dig> – 27% of the total reads hit at least one of these aceview genes and splice variants that are not yet described by the refseq.

depth and breadth of gene coverage
since the shotgun sequencing procedure is expected to provide a random sampling of the different cdna strands, most of the reads will hit the most abundant genes. consequently, more sequencing reads must be generated to detect the less abundant genes. fig. 1a and fig. 1b show how increasing numbers of genes are detected as the number of reads is increased using multiple sequencing runs on the maqc a and b samples. in the upper curves we have plotted the numbers of nm genes in the refseq database that are hit by at least  <dig> read as a function of the total number of reads that hit any nm genes. as the numbers of reads increase, the numbers of different nm genes detected increases rapidly and then gradually approaches saturation. 

these detection curves indicate that after  <dig>  –  <dig>  reads are generated which map well to any nm gene in the refseq database , the detection of new genes in the a and b samples by at least  <dig> hit reaches a level of approximately 60% of all of the  <dig>  nm genes in refseq. with increasing numbers of reads the detection of new genes continues to increase at a decreasing rate. combining all of the approximately  <dig> , <dig> mapped reads from both the odt and tseq sample preparations, the depth of gene coverage increases to 73% of all nm genes for both the pooled human cell lines  and the human brain . even with one million mapped reads the detection curves in fig.  <dig> do not appear to have reached saturation. it is likely that deeper transcriptome sequencing would detect even more of the less abundant genes in these transcriptionally complex reference rna samples.

data points for the detection of genes with at least  <dig> and  <dig> hits are also displayed in fig.  <dig> corresponding to 1× and 10× coverage of a typical  <dig> bp gene. the dotted curves also indicate how the  <dig> hit results can be used to predict the  <dig> hit coverage curve and the  <dig> hit results predict the  <dig> hit curve, consistent with the assumptions of random sampling of the cdna samples  although there are far fewer genes with  <dig> hits , there may be sufficient numbers of reads for the full assembly of gene sequences and the identification of homozygous and heterozygous snps for these most abundant transcripts <cit> .

fig. 1a and fig. 1b also show a comparison of the depth of coverage provided by the two different sample preparation protocols. the odt method appears to be slightly more sensitive in detecting rare genes than the tseq method, perhaps due the shorter effective gene length caused by 3' bias in the cdna synthesis. these differences are illustrated in fig. 2a and fig. 2b which show the breadth of the transcript coverage for the two protocols for the long , medium , and short  transcripts. as expected the tseq method provides more uniform coverage of the transcripts from the 5' to 3' end for transcripts of all sizes; however, the odt method still gives surprisingly good results even for the longest transcripts where the coverage density decreases only 50% from the 3' to 5' end.

reproducibility of expression levels
the number of reads that map to specific transcripts provides a direct quantitative measure of the gene expression level in the sample. unfortunately, uncertainties in the length and uniformity of coverage of individual genes and the relative efficiencies of the reverse transcription  reactions used to transform rna into cdna currently prevent this digital readout from being used as an absolute measure of gene expression. nevertheless, it can still be effectively used to quantify the relative expression of transcripts in different samples. in particular, for computing gene expression ratios the dependence of hit counts on the length of the gene and the rt efficiency should factor out.

the first metric examined in the maqc project was reproducibility of gene expression levels <cit> . for shotgun transcriptome sequencing, this metric can be evaluated by comparing the fraction of reads that hit each transcript in multiple sequencing runs and measuring the coefficient of variation  of the read counts. fig. 3a shows a typical scatter plot of the hit counts for each of the  <dig>  refseq genes measured for the same sample preparation on two regions of the same sequencing plate. in this example, both sequencing regions had approximately the same numbers of total reads and the straight diagonal line shows the expected read counts if both sequencing regions measured equal expression levels. the results are similar when the same sample preparation is run on two different sequencing plates. however, gene specific differences do arise when comparing the counts from the two different  sample preparation methods which suggests that different methods of generating cdna from rna may provide the largest source of variability in the absolute read counts. 

for the  <dig>  –  <dig>  reads used to generate fig. 3a, the dynamic range spanned only  <dig> orders of magnitude up to ~ <dig> hits for the most abundantly expressed gene. however, for random sampling this dynamic range is expected to increase linearly with increasing depth of coverage, n. in addition, the variability from the ideal is well described by a simple poisson sampling model for the shotgun sequencing process which predicts that the hit count cv should decrease with increasing hit number, n, as . consequently, the median cv of the expression levels is expected to be < 10% for genes with n >  <dig> since the best microarray platforms in the maqc study achieved median cv's < 10%, this poisson error model predicts that the level of reproducibility of the gene expression measurements from transcriptome sequencing will be comparable to the dna microarrays for genes that have been detected by at least  <dig> reads. this random sampling error model, requiring no background correction, is much simpler than most error models for microarray-based gene expression data. moreover, both the dynamic range and cv of the transcriptome gene expression measurements exhibit systematic improvement with increasing depth of coverage, n.

accuracy, sensitivity, and specificity
additional metrics considered by the maqc studies for the evaluation of gene expression platform performance include the three interrelated measures of accuracy, sensitivity, and specificity <cit> . the relative accuracy of the gene expression levels inferred from transcriptome read counts can be assessed by comparing the fold changes of differentially expressed genes between the a and b samples with the dna microarray and with qrtpcr results from the maqc study. fig. 3b shows a comparison of the fold-changes measured using transcriptome sequencing of the a and b samples with the taqman results for  <dig> refseq genes that were detected at sufficient levels to be called "present" in both the a and b samples by taqman and by all the major commercial microarray platforms  <cit> . this scatterplot shows that the expressseq results for gene expression changes show excellent correlation with the corresponding taqman results with a pearson correlation of r <dig> =  <dig> . by comparison the pearson correlations for the microarray measurements with taqman for these same  <dig> genes were affymetrix , agilent , and illumina . 

the success of sequencing based expression profiling is a result of the high sensitivity of transcriptome reads in detecting and counting these abundant genes. for each of the  <dig> genes called "present" in both the a and b samples on every microarray platform and individual taqman assays, the  <dig>  million reads generated by the transcriptome sequencing gave at least one hit in both the a and b samples with a maximum of  <dig> hits and a median of  <dig> for the a sample and a maximum of  <dig> hits and a median of  <dig> for the b sample. these numbers translate to median read counts of ~ <dig> reads per gene per million mapped reads. since the detection limit for a "present" call on dna microarrays is frequently estimated to be ~ <dig> copy per cell <cit> , the expressseq results are in good agreement with the estimates presented in ref.  <cit>  that a gene present at the level of  <dig> copy/cell should yield at least  <dig> shotgun reads per kbp per million mapped reads  or  <dig> reads per  gene per million mapped reads.

high specificity is also necessary for accurate measures of gene expression changes since signals associated with more than one gene can mask the true expression level of a rare transcript. for example multiple reads from repeat regions such as long interspersed nuclear elements , short interspersed nuclear elements , and alus in the untranslated regions of the transcriptome can distort the true expression level. the expressseq pipeline avoids this problem with a stringent requirement that each read to be counted only once for the best blast hit to each refseq. as an illustration, for a highly expressed, brain specific genes, such as the myelin basic protein , there were a total of  <dig> unique reads that hit the  <dig> annotated splice variants in refseq for the maqc brain sample b while only  <dig> reads hit the maqc pooled human cell lines sample a. this dynamic range of 109-fold difference compares well with the dna microarray measurements for the same gene in the a and b samples, affymetrix , agilent , and illumina .

discovery of new splice variants
the aceview database of transcribed sequences was generated by co-aligning all publically available cdna sequences generated in the past  <dig> years of sanger sequencing to the human genome <cit>  the same alignment software was used here to successfully map 88% of the long gs flx reads for the maqc a and b samples to the ncbi build  <dig>  of the human reference genome with the requirement that over 90%  of the entire sequence align perfectly.

*exon junctions were identified by the requirements that the reads align to the genome separated by standard gt-ag, gc-ag, or at-ac introns.

using these criteria, the  <dig>  million maqc reads recovered over 60% of the  <dig>  exon junctions currently supported by cdna sequences in the march  <dig>   <dig> release of refseq. in addition these gs flx reads identified  <dig>  exon junctions not yet in refseq.  these new exon junctions were supported by slightly more reads from the tseq random primer sample preparation method  and from the pooled cell line sample a . although 62% of these novel exons junctions have already been described in the comprehensive aceview database culled from all publicly available cdna sequences ,  <dig>  appear to be novel to both refseq and aceview.

from the  <dig>  new exon junctions we also identified  <dig> cassette exons defined by the requirements that the gs flx reads support both bordering gt-ag intron-exon boundaries inside of an intron already defined by refseq. although  <dig> were already represented in the aceview database, the gs flx reads provided support for  <dig> novel cassette exons.  in addition, the gs flx reads identified  <dig> new exon junctions that skip exons in refseq genes and  <dig> of these junctions events were new to the aceview database as well.  in this analysis, the new cassette exon and skipping exon events were only counted as alternative splicing events if other gs flx reads also supported the conventional refseq junctions for these genes.

not surprisingly, the conventional refseq exon junctions were biased to the more commonly expressed junctions with an overall average support of  <dig>  gs flx reads, while the additional junctions also found in aceview were supported by an average of  <dig>  flx reads and the novel candidate junctions by an average of  <dig>  reads. since the maqc a sample consists of pooled rna from  <dig> different cell lines, it might be expected that some of the novel exon junctions may arise from abnormal chromosomal arrangements in these immortalized cells. however, the b sample from normal human brain tissue contributed comparable numbers of novel exon junctions: 51% in b, 52% in a and 3% in both.

finally, we note that the expressseq results can be used to directly measure the differential expression of both the novel and well documented transcript variants, providing a complementary platform to the new exon microarrays. for example, fig.  <dig> compares the transcriptome sequencing results with the affymetrix exon array measurements for two transcript variants of the elavl <dig> found in the original maqc studies to be differentially expressed in the maqc a and b samples <cit> .

discussion
transcriptome sequencing using the massively parallel, next-generation sequencing technologies provides a high-throughput method for rapidly generating millions of reads for expressed sequences from different rna samples <cit> . these reads can be used to verify predicted genes and discover new transcription products and the expression levels can be quantified by direct counting of the numbers of reads mapping to different genes and transcript variants. in addition single nucleotide polymorphisms  in both the coding and noncoding regions of expressed genes can be identified by comparing the sequences of multiple matching reads with reference sequences  <cit> . in the past year these new technologies have already provided radically new insights into the transcriptional complexity of a number of different organisms from bacteria <cit> , to yeast <cit> , plants <cit> , mouse <cit> , and man  <cit>  as the new sequencing technologies strive toward the capability of sequencing the entire human genome for $ <dig>  these approaches will become routine tools for every facet of gene expression analysis.

in this paper we have focused on the quantification of gene expression levels and have compared the results with dna microarrays and quantitative rtpcr using the microarray quality control  reference rna samples <cit> . we have generated  <dig>  million reads of average length  <dig> bp on roche's  <dig> gs flx for the maqc a and b reference rna samples. using the expressseq pipeline these reads can be easily mapped to the human refseq genes on a windows desktop computer and gene expression levels conservatively determined by simply counting the numbers of unique hits with e-values ≤ 10- <dig> 

using the macq quality metrics for evaluating the reproducibility, sensitivity, specificity, and accuracy of the gene expression analysis, we have demonstrated that these expressseq results already compare favourably with the results for dna microarrays and qrtpcr in the maqc studies. moreover, a simple poisson error model for the random shotgun sequencing process describes how these metrics systematically improve with increased numbers of reads.

the presence of repeated sequences arising from homologous gene families and from line, sine, and alu elements in untranslated regions of the transcriptome pose a significant challenge to the accurate quantification of gene expression by read counts. this is a problem that is well appreciated by the dna microarray and qrtpcr communities that have been very careful to try to avoid these problems by carefully designing gene probes and primers. here we have tried to minimize the problem by counting each read only once. however, quantitative errors from the miss-assignment of this read are inevitable. better strategies for dealing with reads with multiple alignments are required. for example, reads with multiple equivalent alignments to the genome could be eliminated altogether or reads counted only when they map to gene coding regions or to known exons  <cit> .

we have also used the aceview alignment software <cit>  to co-align these  <dig>  million reads for a and b samples to the human genome to identify over  <dig>  new exon junctions in the human transcriptome. although these candidate exon junctions may be less common than the well-annotated refseq junctions, they may still play an important role in determining the diversity of biological phenotypes. these results indicate that there is still a significant amount of biology to be uncovered using transcriptome sequencing.

at present genomics researchers can choose among several next-generation sequencing platforms for transcriptome sequencing that generate either long,  <dig> bp– <dig> bp,  or short, ~ <dig> bp,  reads. the larger numbers of reads generated by the short read platforms provide greater sequencing depth and should provide better reproducibility, sensitivity, specificity, and accuracy for the measurement of differential gene expression. however, the longer reads are easier to map and to assemble. consequently, the long reads should be better for the discovery and assembly of novel genes and splice variants.

for example, three papers have recently appeared with deep sequencing results for transcriptomes of different human cell lines  <cit>  and tissues <cit>  using the illumina genome analyzer. although these studies generated between  <dig> million <cit>  and  <dig> million <cit>  reads for expressed transcripts, they succeeded in only identifying between  <dig> <cit>  and  <dig>  <cit>  new exon junctions not contained in the human ensembl and refseq databases by aligning the short,  <dig> bp, reads to databases of predicted splice junctions. in particular, the largest study <cit>  with more than  <dig> million reads discovered only  <dig> new "isolated" cassette exons in all of the  <dig> human tissues and cell lines examined, as compared with the  <dig> new cassette exons found here by aligning  <dig>  million long reads for the maqc samples directly to the human genome.

a remaining challenge is the proper assembly of the transcribed exons into the full-length alternative transcripts  <cit> . this will require preservation of the identity of the transcribed strand to distinguish reads from overlapping transcripts  and longer read lengths and/or paired end reads for the transcriptomes will be necessary to link all of the pieces together. fortunately, the new gs flx titanium upgrade now provides average  <dig> bp reads and all of the new sequencing platforms have protocols for paired end reads to bridge across the full length transcripts. as read lengths and throughput continue to increase and new sequencing platforms  <cit>  and software tools  <cit>  for mapping the reads emerge, the combination of the long and short read technologies may be most effective for exploring the complexity of the transcriptome, where the long reads are used for gene discovery and assembly and the short reads for confirmation and quantification <cit> .

CONCLUSIONS
gene expression analysis by transcriptome sequencing using the next-generation sequencing technologies shows great promise. using the metrics introduced for evaluating the performance of gene expression platforms in the maqc studies, our expressseq results for gene expression levels of the maqc reference rna samples showed excellent specificity, sensitivity, and reproducibility that improve systematically with increasing sequencing depth, and quantitative accuracy that compare favourably with dna microarrays and quantitative rt-pcr. in addition, a careful mapping of the long gs flx reads to the genome using the aceview alignment programs shed new light on the complexity of the human transcriptome including the discovery of thousands of new splice variants.

