BACKGROUND
currently, a number of molecular-based prognostic and predictive tests for breast cancer are offered as laboratory services for clinical use  <cit> . such assays, which include mammaprint  <cit> , oncotypedx  <cit> , pam <dig> breast cancer intrinsic subtype classifier  <cit> , mapquant dx  <cit>  and theros breast cancer index  <cit> , are implemented by providing multiple gene expression measurements obtained from tissue samples to multivariate classification algorithms. currently, published evidence on clinical validity and utility for such assays as they are offered to the patients is only available for mammaprint and oncotypedx; for the remainder of these tests the evidence derives from analyses performed in academic settings  <cit> .

according to a recent report  <cit>  from the institute of medicine , oncotypedx was the most widely used among these breast cancer assays, with more than  <dig>  patients tested as of mid  <dig>  followed by mammaprint, used for  <dig>  patients. oncotypedx combines the expression levels of  <dig> genes and was developed to predict the risk of distant recurrence at 10 years for women with lymph node negative, estrogen receptor  positive breast cancer  <cit> . mammaprint utilizes  <dig> genes to report a good or bad prognosis for each patient, and was developed from microarray experiments to predict 5-year metastatic recurrence of breast cancer as a first event among er positive and negative patients  <cit> . the mammaprint algorithm is based on correlating the 70-gene expression profile of a patient with a stored cancer profile in order to determine a risk score for the patient.

a relative small fraction of published cancer prognostic markers have subsequently been introduced in clinical practice, despite the large number of available studies focusing on biomarkers development. a major hurdle hindering the translation of this research into clinically useful assays has been identified in the lack of rigorous criteria to report and publish tumor prognostic marker studies  <cit> . this issue has been addressed by introducing the remark guidelines, a set of recommendations for tumor marker prognostic studies, which provides the necessary framework for reporting all relevant information about prognostic marker development   <cit> . another key issue in the development of cancer biomarkers is the need for detailed and complete disclosure of all data and software  <cit> . this need is not specific to the development of predictive signatures from high-throughput molecular data but extends to many other branches of computational medicine and biology  <cit> . whereas the guidelines for transparency in genomic data sharing date back a decade to the adoption of the minimal information about microarray experiments  standards  <cit> , the recent scandal leading to the decision to cancel three clinical trials based on microarray-based gene expression screening tests has dramatically underscored the need for revised genomics research criteria  <cit>  that extend and/or integrate the remark and miame guidelines.

maximizing the level of evidence on the spectrum of reproducibility requires complete, independent replication  <cit> . as measured by this criterion, neither of the two successful breast cancer assays, mammaprint and oncotypedx, provides a paradigmatic example of the way genomic predictors should be developed. in the case of oncotypedx, the prediction algorithm is described in detail and can be reprogrammed, but the original datasets used for the implementation and validation  <cit>  of the assay were never placed in the public domain. conversely, in the case of mammaprint, although the original discovery and validation datasets  <cit>  are available, the pre-processing protocol and prediction algorithm are only partially described.

thus the entire development, including data and code, is not available for either mammaprint nor oncotypedx. however, in the case of mammaprint it is possible to undertake a transparent re-analysis of the data using an alternative approach, since the raw microarray data are available. we therefore focus here our efforts on reproducing the results of mammaprint. we collect and organize the original mammaprint discovery and validation data. we also coordinate the associated metadata for these experiments and develop reproducible documents for their analysis. we reproduce and implement the preprocessing described in the original manuscripts. these data represent a resource that can be used by other investigators both to verify the original claims about the mammaprint signature and to build alternative predictors. as an example of the utility of these data, we use the mammaprint discovery and validation data to develop an alternative signature and prognostic test for breast cancer, which is based on several two-gene comparisons  <cit> . this provides a detailed, transparent and fully reproducible example of constructing a multi-gene classifier.

methods
data assembly and code
we collected the data from the original experiments used to identify  <cit>  and develop  <cit>  the mammaprint 70-gene prognostic signature as provided as additional files with the original manuscripts. we also collected from arrayexpress  <cit>  the dataset used to retrain this signature on the custom array currently used in the mammaprint assay  <cit>  as well as the independent validation cohort using the same array  <cit> . all of these datasets have been organized in an open resource that can be used to develop and compare prognostic signatures for breast cancer  and bioconductor  <cit> . this resource also encompasses the r  <cit>  code and libraries used to retrieve, pre-process, manipulate, annotate, and analyze these data. the code, fully annotated and executable, is provided in the additional files  <dig> and  <dig>  all the analyses performed in our study were based on de-identified publically available data, and they were performed in compliance to the helsinki declaration. the research did not involve any experiment on human subjects or animals and for this reason no ethical approval was necessary.

an example of reproducible signature development
in order to build our new classifier we selected the  <dig> patients originally used in the 70-gene prognostic signature discovery and limited our analysis to the  <dig> genes contained in the original signature. we made these decisions for two reasons:  to make our development process entirely analogous to the process for mammaprint and  so that our signature can be calculated on the basis of the data from any current mammaprint assay. to this end it should also be noted that the mammaprint microarray platform only includes the prognostic signature genes and a set of housekeeping genes used for normalization purposes. these latter genes are designed not to change across samples and were therefore not used to train our predictor. we adopted an extension of a rank-based approach to classification called “top-scoring pairs”  for developing understandable and powerful genomic signatures. this approach is invariant to all data preprocessing and normalization steps that maintain the ordering within sample gene expression profiles. the tsp algorithm selects the pair of genes whose expression levels switch their ranking most consistently between the two prognostic groups . the original tsp algorithm  <cit>  and extensions  <cit>  have previously been successfully applied to differentiate  <cit> , predict treatment response in breast cancer  <cit>  and acute myeloid leukemia  <cit> , and grade prostate cancers  <cit> .

building the k-tsp classifier
we recorded the relative ordering of each pair of genes in the 70-gene mammaprint signature in each of the  <dig> training samples. in other words, for each pair of genes g and g’, and for each sample j, we record whether the expression of g in sample j is larger than the expression of g’ in sample j or vice-versa. the “signature” for the tsp classifier is the pair of genes that most consistently changes its relative expression ordering between the two groups of patients and the corresponding decision rule for a new profile is determined entirely by the ordering between these two genes: choose group one if the observed ordering was most often seen in group one and group two otherwise. here, the two groups of patients are those that recurred within 5 years  and those that who did not recur . the k-tsp algorithm uses k pairs of genes. it proceeds by first identifying the tsp, removing these two genes from the 70-gene signature, then searching for the pair of genes among the  <dig> remaining that most often switch their ordering between groups, removing these from the list, and so forth. individually, each pair of genes “votes” for one of the two groups based on the observed ordering. for a fixed number k of pairs, the final prognostic score is the sum of the votes for the poor prognosis group among all k pairs. the higher the score, the more evidence there is for poor prognosis.

selecting the number of pairs
for each possible number of pairs k we measured the accuracy of the prognostic score on the training set by calculating the area under the receiver operating characteristic curve   <cit>  determined by considering all possible score thresholds for declaring poor prognosis. here we used re-substitution auc for training, since the tsp approach is based on binary decisions and is not prone to overfitting. the auc increased with k until reaching a peak and then declined as further pairs were added . we focused on values of k near the peak auc, namely k =  <dig> to k =  <dig>  and only considered score thresholds achieving 100% sensitivity. the number of gene pairs k was then chosen to maximize specificity, which is equivalent to choosing the maximum score threshold which achieves 100% sensitivity. this resulted in the 8-tsp classifier  with score threshold two. such resubstitution estimates obtained from the training set of samples were used only for the model optimization and do not reflect its performance, which in turn was assessed on an independent cohort of patients .

validation of the 8-tsp signature in an independent patients cohort
to evaluate the classifier on a new sample, the relative ordering of each of the k =  <dig> pairs of genes is determined and the sample is assigned to the poor prognosis group if there are two or more votes for poor prognosis , using the same procedures previously defined in the training set of patients. the 8-tsp signature and the mammaprint test were hence compared in terms of classification performance, using standard measures such as accuracy, sensitivity, specificity, and auc, and in term of survival, by kaplan-meier and cox regression analyses.

RESULTS
we compared our prognostic test to the mammaprint test based on a large independent validation cohort consisting of  <dig> patients from a european multi-center study  <cit> . in this independent validation cohort our test achieved 91% sensitivity, 47% specificity, and 69% overall accuracy . sensitivity refers to correctly classifying poor prognosis patients and specificity refers to correctly classifying good prognosis patients. for comparison, the mammaprint prognostic test achieves 89% sensitivity, 42% specificity, and 65% overall accuracy  <cit>  in this same validation set. such performance in predicting metastatic recurrence within 5 years was reflected in the auc estimates:  <dig>   and  <dig>   for the 8-tsp and mammaprint respectively.  finally, while in the prediction of a metastatic event within five years the 8-tsp classifier performed better than the mammaprint test, this latter assay maintained a better performance at later time points as revealed in survival analyses. this finding probably indicates that the additional features of the 70-gene signature not used in the 8-tsp classifier might carry additional prognostic information beyond five years .

we have therefore built a prognostic classifier based on the genes from the mammaprint signature that is as accurate in predicting 5-year disease-free survival as the mammaprint prognostic test based. our classifier only requires the measurement of expression for  <dig> of the  <dig> genes used in mammaprint. moreover, the new test is easy to interpret and is robust with respect to any preprocessing of the expression data that maintains the ordering among expression levels within sample profiles.

finally, all design decisions and choices of parameters were based entirely on the training set. there was no “data leakage”: no test data was examined until all aspects of classifier development were “locked up.” these are considered critical steps in developing reproducible and accurate genomic signatures as defined by the iom report  <cit> . the two key parameters are k, the number of pairs of genes in the signature, and the score threshold. we only considered values of k between  <dig> and  <dig> since these values maximized overall performance, and we only considered thresholds that obtained 100% sensitivity. under these design constraints, we selected the k =  <dig> since this value maximized specificity at 100% sensitivity . our final classifier labels a sample as poor prognosis if two or more among the  <dig> pairs votes for the poor prognosis group .

our 8-tsp signature can be viewed as the combination of multiple coordinated biological processes. of the  <dig> genes originally identified in the study by van’t veer and colleagues  <cit> ,  <dig> genes had expression values positively associated with good prognosis, while  <dig> were associated with metastatic recurrence. four of the k =  <dig> pairs combine genes positively correlated with good prognosis  with genes associated with bad prognosis . these pairs represent a coordinated change from good prognosis expression patterns to poor prognosis patterns across multiple gene pairs. the remaining pairs comprise only genes originally associated with a poor prognosis , suggesting that it is the quantitative level of expression of these genes that is important for predicting prognosis.

it is of note that each individual tsp involved in the final classification scheme can be viewed as a separate molecular switch between the two prognostic groups, possibly entailing also a mechanistic underpinning. to this end some of the pairs we have identified appear to have an additional underlying mechanistic biological relationship. for instance one of the gene pairs, dtl-rcf <dig>  appears to be tightly associated with the regulation of the replication fork and the dna damage response. dtl and rcf <dig> physically interact and modulate the activity of the proliferating cell nuclear antigen   <cit> , which plays a central role in the coordination of these processes. similarly, another pair, gpr180-gnaz, code for proteins involved in g protein mediated cellular signaling.

CONCLUSIONS
our goal was to provide a transparent example of the manner in which a genomics-based cancer predictor might be developed from training data and evaluated on independent test data with sufficient detail and documentation to allow the full process to be replicated by other researchers. due to the unavailability of the original data, it was not possible carry out this process for oncotypedx, which is presently the most used and validated predictor of this kind. consequently, we performed a re-analysis of mammaprint data. to this end, we selected the same samples and end-point originally used for the implementation of this assay, although we are aware that a stratified analysis across er positive and negative patients would be much more appropriate. in order to illustrate the development process from end to end, including a transparent decision rule, we have introduced a more parsimonious classifier with sensitivity, specificity, and overall accuracy very similar to the 70-gene mammaprint signature.

our analysis was performed in complete adherence to the principles of transparent and reproducible research  <cit> , providing all data sources used, and the complete code and software necessary for data preprocessing, analysis and validation. to our knowledge, this is one of the few, if not the first, development of a genomic signature adhering to these standards.

abbreviations
tsp: top scoring pair; roc: receiver operator curve; auc: area under the curve; fda: food and drug administration; iom: institute of medicine; er: estrogen receptor; remark: reporting recommendations for tumour marker prognostic studies; miamie: minimal information about microarray experiments; ci: confidence intervals; rtn4rl1: reticulon  <dig> receptor-like 1; lgp2: dhx <dig> dexh  box polypeptide 58; ms4a7: ms4a <dig> membrane-spanning 4-domains, subfamily a, member 7; gstm3: glutathione s-transferase mu  <dig> ; oxct1: 3-oxoacid coa transferase 1; hrasls: hras-like suppressor; melk: maternal embryonic leucine zipper kinase; gpr180: g protein-coupled receptor 180; dtl: denticleless e <dig> ubiquitin protein ligase homolog ; igfbp5: insulin-like growth factor binding protein 5; serf1a: small edrk-rich factor 1a ; gnaz: guanine nucleotide binding protein , alpha z polypeptide; rfc4: replication factor c   <dig>  37kda; cdca7: cell division cycle associated 7; uchl5: ubiquitin carboxyl-terminal hydrolase l5; pcna: proliferating cell nuclear antigen.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
lm, jtl, and dg conceived the study; lm performed all the analysis and assembled all the datasets; lm and ba implemented the software packages used in the analysis; lm, jtl and dg wrote the manuscript. all authors read and approved the manuscript.

supplementary material
additional file 1
fully reproducible vignette of the analysis.

click here for file

 additional file 2
the archive contains the following files: “bmc_article.bst”: bmc series bibliography style; “localfiles/contactagendia": instructions to obtain the hybridization mapping information from agendia; “objs/buyseeset.rda”: expressionset for the buyse cohort; “objs/glaseset.rda”: expressionset for the glas cohort; “supplement.bib”: bibliography in bibtex format; “supplement.rnw”: rnoweb/sweave file containing code and text used to create the “supplement.tex” file; “supplement.tex”: latex file resulting from running the sweave with the “supplement.rnw” file; all source code, data, and software packages used in the analyses are also available for download online from: http://luigimarchionni.org/breasttsp.html.

click here for file

 acknowledgements
the authors express gratitude to antonio c. wolff for the invaluable comments, and annuska m glas for the information on the datasets.

funding
this work was supported by the johns hopkins breast cancer program through funding from the safeway research foundation, and by the national institute of health .
