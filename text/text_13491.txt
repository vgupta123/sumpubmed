BACKGROUND
amino acid replacements in proteins may be advantageous in the course of an organism's adaptation to changing conditions in an established habitat or upon its spread into a novel habitat  <cit> . such recently-acquired mutations may occur independently in genetically distinct allelic backgrounds, in small numbers per allele and in different protein regions. this makes it difficult to detect the signals of adaptive snps using traditional molecular evolutionary analyses, such as ka/ks  ratio  <cit> , tajima d  <cit>  or fu & li d*  <cit>  statistics, primarily due to an overwhelming level of pre-existing neutral snps  in the loci under selection  <cit> . additionally, the adaptive mutations may provide only short-term advantage to the organisms. this occurs in the course of so-called 'source-sink' dynamics of evolution, where species populations are continuously spreading from established, evolutionarily-stable reservoir habitats  into novel, evolutionarily-untested habitats  that commonly are transient in nature  <cit> . in these cases, mutational adaptation to sink habitats may constitute a liability upon the collapse of sink habitat, due to functional trade-offs that these mutations generally demonstrate in the reservoir source habitat. the source-sink dynamic is characteristic, for example, of pathogenicity-adaptive  evolution of microbial pathogens  <cit> .

we have recently developed zonal phylogeny  analysis, to detect adaptive amino acid changes in proteins under selection during short-term habitat adaptation  <cit> . along each branch in a dna tree, we indicate the number of synonymous and non-synonymous mutation information. then, the synonymous-only branches are collapsed in the tree and the dna tree is converted to a protein tree where each node corresponds to a evolutionarily unique structural variant. this minimizes the effect on the protein tree of nucleotide homoplasy and reversion events that obscure phylogenetic relationships of protein variants. zp then separates structural variants of the protein into two categories, or zones: those encoded by multiple haplotypes  are assigned to the primary zone, while each of the variants encoded by a single unique haplotype is assigned to the external zone. accumulation of synonymous substitutions in genes that encode proteins from the primary zone indicates their circulation over extended evolutionary time, thereby suggesting evolutionary stability of the protein variants. on the contrary, the external zone variants would have evolved relatively recently, because synonymous variation is yet to accumulate within the encoding genes.

the external zone variants are likely to be under positive rather than neutral or purifying selection  when:  their number is higher than expected relative to the frequency of primary zone variants  <cit> ;  the amino acid replacements are more commonly occur in same positions   <cit> ;  silent snps along the connecting branches are relatively rare  <cit> , and  haplotype diversity  of the external zone is significantly higher than in neutrally-evolving genes  <cit> . such statistical comparisons of the two zones show the unambiguous signature of positive selection in, for example, fimh and papg-ii , but not in genes from the same strains that are involved in either fimbrial biogenesis or housekeeping functions  <cit> .

here, we present zonal phylogeny software  that computerizes zp. zps uses dna tree topology and haplotype alignment of a gene under analysis to recreate the dna-based phylogeny, to demarcate the number of synonymous  and non-synonymous  changes along each branch, to separate haplotype nodes into primary and external zones, and then to provide zone-wise information on amino acid substitutions, structural hot-spots and haplotype diversity.

implementation
the zps program presented here can be downloaded as zps.pl  to be run in command prompt under windows environment. the attempt is, at one hand, to design a visualization tool to have insights onto a gene phylogeny based on distribution of synonymous vs. non-synonymous snps, and on the other hand, to incorporate quantitative statistical measures of recent adaptive evolution based on zp analysis  <cit> .

inputs
two input files are used:  a dna alignment in fasta format   using a dna alignment software, such as clustalx  <cit> ; and  a maximum-likelihood dna tree topology   generated by paup*  <cit> . in the representative haplotype name, the user should only use alphanumeric characters . to allow for haplotype size/frequency-based analysis, duplicate haplotypes need to be removed in the input files, but with the user marking haplotypes with multiple representatives in the dataset by n< no. of representatives> . for example, if seqa, seqb and seqc haplotypes are identical, the user should use seqan <dig>  as input. if there is a single representative of a haplotype, the user can use the name as it is and the program would be able to detect it as 'n1'.

outputs
there is one tree output – "zp_tree.dnd" where each node name  depicts  haplotype separation to either the external  or primary  zone, with intermediate hypothetical  nodes marked as 'h';  followed by an arbitrary number assigned to a protein variant encoded by the haplotype ;  original name of the representative haplotype and the user defined number of haplotypes that are identical to it in the dateset , with zps automatically adding '-n1' to the haplotypes with single representatives;  number of synonymous/non-synonymous snps along the connecting branch , and  specification of amino acid changes due to the non-synonymous snps . the zps output tree can be viewed with tree-presenting software, like treeview  <cit>  or hypertree  <cit> . the latter application also enables usage of color coding to visually distinguish different type of haplotypes and branches. keeping hypertree in mind, zps generates an additional color-code file, for the output tree file, to color-code the primary and the external zone representatives. two color-codes have been used: blue for all the primary zone haplotypes that exhibit same-protein silent variability and red for all the external zone representatives. to color-view "zp_tree.dnd" in hypertree, the user needs to 'import colors' calling "color-zp_tree.txt" file.

there are two analytical outputs: "pairwise-variation.txt" and "analysis-results.txt". the former file details the positions and specific changes along each branch in the tree, while the latter presents  the primary and external zone representatives;  haplotype ratio ;  position-wise structural mutation information, both overall and zone-based structural hot-spot frequency , and  calculations of α and simpson's diversity statistics  <cit> .

RESULTS
zps has been extensively tested with different genes from escherichia coli of diverse origin  <cit> , burkholderia cenocepacia  <cit> , vibrio vulnificus and hepatitis c virus genotype  <dig> .

the "analysis-results.txt" output includes the calculations to compare the patterns of evolution for different genes quantitatively, as shown in table  <dig>  the external zone frequencies of strains, haplotypes and structural hot-spots are significantly higher in fimh than in fumc. the diversity measures  show that the primary zone λ and α values for the two genes are comparable , suggesting the presence of long-circulated stable structural variants in the population of both fumc and fimh. the haplotype diversity of the primary zone of fimh or fumc is significantly lower than the haplotype diversity of fimh external zone, but not of fumc external zone. in fimh, the low diversity of the primary zone compared to the corresponding external zone could be hypothesized to be due to selective sweeps or bottleneck effects. however, the increased diversity of the fimh external zone can only be explained by positive selection, as we found its diversity being significantly higher than the diversity of both zones of fumc and, also, of primary and external zones of three other genes from same strains – another housekeeping gene, adk, and type  <dig> fimbrial biogenesis genes, fimi and fimc  <cit> . at the same time, relatively high diversity was shown for external zone of papg-ii gene encoding another, di-galactose-specific e. coli adhesin, indicating that adhesin genes could be prone to accumulation of adaptive amino acid changes under a short-term positive selection  <cit> .

it is noteworthy that an advantage of zp analysis of the haplotype diversity is that it considers both haplotype richness  as well as frequency distribution  of these haplotypes in a zone. the latter feature of the diversity index incorporates the idea of relative fitness of a particular haplotype through the extent of its predominance in the sample set .

to compare performance of zps with other commonly used methods for detecting signals of positive selection, we analyzed our datasets for fumc and fimh with codeml program implemented in the paml package  <cit> . for each gene, we initially used two different models: one-ratio null model of neutral evolution  and one-ratio selection model of adaptive evolution . for fumc there is no difference  between the log likelihood values of neutral  and selection  models. for fimh also, the neutral  and selection  log likelihood values are not statistically different , though unlike fumc, the p value shows a possible trend toward selection. thus, based on the entire tree, codeml was unable to detect unambiguously the presence of positive selection in fimh, demonstrating higher sensitivity of zps in this type of analysis. then we used branch-specific selection model approach and assigned ω >  <dig> to clades containing multiple external zone nodes. for some of such clades on the fimh tree the log likelihood values for the selection model either differed significantly from the neutral model value , or differed considerably suggesting a distinct direction of selection . no such difference was detected for the fumc clade that contained two external zone nodes . thus, clade-specific codeml analysis confirmed presence of positive selection for non-synonymous mutations in fimh, but not in fumc. however, unlike codeml, zps does not require any preliminary knowledge about the clade composition to detect the selection. at the same time, zps can be used in combination with codeml to ease singling out of the clades or branches on gene tree that were derived under positive selection.

CONCLUSIONS
synonymous mutations are generally considered to be selectively neutral and to accumulate randomly at a constant rate for a given gene. zps utilizes dna trees to differentiate haplotypes that have evolved with accumulation of silent variations from those derived only through amino acid replacements, enabling visualization of adaptive structural variations that have recently emerged under positive selection. information about the presence of mutational hot-spots and comparative zonal statistics on the size and frequency of various haplotypes provides insights into the adaptive evolution of genomic loci in any organism, from virus to human.

availability and requirements
project name: zonal phylogeny software 

project home page: 

operating systems: windows

programming language: perl

other requirements: clustalsx, paup* and any tree-viewing software, e.g. treeview or hypertree

license: gpl 

abbreviations
zp – zonal phylogeny

zps – zonal phylogeny software

snps – single nucleotide polymorphisms

authors' contributions
sc designed the software, implemented it and drafted the manuscript. ded contributed to the idea of the zonal phylogeny and helped to draft the manuscript. evs conceptualized the zonal phylogeny, designed the software and wrote the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
the perl program code for zps.

click here for file

 additional file 2
the fasta alignment input files of fumc and fimh genes respectively

click here for file

 additional file 3
the fasta alignment input files of fumc and fimh genes respectively

click here for file

 additional file 4
the paup*-output tree files of fumc and fimh genes respectively as other inputs for zps.

click here for file

 additional file 5
the paup*-output tree files of fumc and fimh genes respectively as other inputs for zps.

click here for file

 acknowledgements
the authors would like to thank scott j. weissman for critical reading and discussion of the manuscript. research was supported by grants from the national institutes of health.
