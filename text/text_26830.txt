BACKGROUND
the sizes of organs are often achieved with high precision, commonly being specified both genetically and autonomously   <cit> . such observations imply that growing tissues ‘know’ the size they need to attain, but how this is implemented is not generally understood.

in engineering, set-point control is commonly achieved through feedback, especially ‘integral’ feedback, in which corrections to system behavior grow in magnitude the longer a system’s output differs from a set-point. the idea that feedback is important in tissue growth control is old  <cit> , but only recently has it been shown that one particular form of feedback - in which the differentiated cells at the ends of lineages  inhibit the self-renewal probability of the stem or progenitor cells that produce them - has the characteristics of an integral control circuit, and can thereby set a steady state or final tissue size that is insensitive to multiple types of perturbations  <cit> .

the existence of this type of feedback has been documented in several cell lineages, including skeletal muscle, the olfactory epithelium, and the hematopoietic system  <cit> . in the first two cases, the direct mediators of feedback are secreted molecules of the tumor growth factor beta  superfamily. the fact that tgf-β family members suppress self-renewal  in other lineages as well  suggests that this growth control strategy may be widespread, although the limited spatial ranges over which growth factors and other secreted signaling molecules act  suggest that this type of local feedback most likely operates on the tissue, rather than the organ scale . still, even if other feedback mechanisms come into play at larger scales , the general strategy of using a measure of differentiated cell content to feed back upon the renewal-versus-differentiation behavior of stem and progenitor cells - which we refer to here as renewal control - provides an appealing strategy for achieving set-point control of growth, as well as dynamics of growth and regeneration that fit with what is often observed in vivo  <cit> .

despite the appeal of the renewal control strategy, there are reasons to expect that it comes at the expense of performance tradeoffs  <cit> , that is, the cost of making tissue growth more robust to certain kinds of perturbations  might be to make it more fragile to others. here we show that this is indeed the case, regardless of whether continually renewing or fully differentiated tissues are being produced. in particular, we show that the high-gain feedback necessary for fast response and rejection of certain classes of disturbances invariably renders such systems less robust  in the face of other disturbances. using tools from robust control theory, we show that the reasons for this limitation are structural, that is, they relate to the nature of the feedback strategy, not choices of parameters used to implement it.figure  <dig> 
disturbances and their impact on the dynamics of a two-stage cell lineage. stem or committed progenitor  cells can self-renew or differentiate to terminally differentiated  cells. the processes of cell division, renewal or differentiation, and cell death can be affected by a number of biologically relevant disturbances that affect the steady state populations of terminal and stem or cp cells.



intriguingly, we find these tradeoffs can be alleviated through an alternate strategy that we refer to as fate control, whereby lineages branch - that is, stem or progenitor cells produce more than one type of differentiated product - and the branching decision becomes the target of feedback control. remarkably, just such behavior was recently described in the olfactory epithelium, where two tgf-β family members, activin and gdf <dig>  that mediate feedback control of neuron number were found to regulate the progression of neural stem cell progeny down a non-neuronal, supporting-cell lineage branch  <cit> . indeed, lineage branching is a common feature of many tissues, both during development and regeneration  <cit> . we show here that such differentiation schemes solve an important, generic control problem in the feedback regulation of growth.

RESULTS
feedback regulation of stem cell renewal robustly stabilizes lineage pathways
we begin by considering the simplest example of renewal control, in which feedback acts upon a stem cell  whose progeny either remain stem cells or differentiate into terminal, post-mitotic  cells . we let v stand for the rate of cell division ; pd for the probability, at each division, that daughter cells differentiate; pr for the probability, at each division, that daughter cells remain stem cells ; and d for the probability, per unit time, that terminal cells die. if we let x <dig> and x <dig> stand for the concentrations  of stem and terminal cells, respectively, then for large enough cell numbers, the dynamics of the system may be described by a pair of ordinary differential equations:figure  <dig> 
effects of disturbances on the performance of renewal control. in all panels, time is given in units of cell cycles  and the system is at steady state at time t =  <dig>  x¯2* is the desired  terminal cell population. for parameter values used see additional file 1: table s <dig>   cartoon representation of renewal-controlled two-stage cell lineage. red line represents negative feedback regulation of p
r.  shown is terminal cells  and stem cells  response to stochastic fluctuations on d .  shown is stem cell population over time in response to periodic oscillations of d with frequency  <dig>   and  <dig>  . feedback suppresses the oscillations at low frequency  but amplifies them at higher frequency   plotted is the terminal cell population response to stem cell loss at a constant. stronger feedback reduces steady state error but also introduces stronger oscillations.  shown is the terminal cell population after abrupt removal of half the terminal cell population x
 <dig> at t =  <dig>  aggressive feedback has faster rise time but causes oscillations in terminal cell population.  main plot shows terminal cell response to stochastic disturbances directly affecting the stem cell population. the inset shows the standard deviation  of responses for each feedback level. moderate feedback can reduce the variance, but more aggressive levels increase variance.  shown is the distribution of stem and terminal cell populations for the response shown in  with n =  <dig>   shown is the plot of the sensitivity function s for renewal control as a function of disturbance frequency . aggressive feedback improves performance at low frequency  but by necessity this results in poorer performance at a higher frequency range . for additional disturbances see additional file 1: figure s <dig> 

  <dig> x˙1=2prx2−1vx1x˙2=2pdx2vx1−dx <dig> in which renewal control is represented by the fact that pr and pd are taken to be functions of x <dig> , subject to the condition pr + pd =  <dig>  the form of each equation derives from the fact that the rate of production of each cell type occurs at the rate of the stem cell cycle multiplied by two  times the probability that a stem cell daughter becomes either a stem cell  or a differentiated cell . the additional ‘-1’ in the first equation reflects the fact that, with each stem cell division, one ‘mother’ cell disappears. this model reduces to the one used by  <cit> , if the parameter pr is replaced p and pd by 1-p.

for constant values of pr and pd, system  <dig> trajectories necessarily blow up for pr >  <dig>  and converge to zero for pr <  <dig> . a stable steady state requires negative feedback, that is, pr must be a declining function of x <dig> around the value of x <dig> at which pr =  <dig> . such feedback produces not only stability, but also robustness, in the sense that the level of terminal cells in the system at steady state becomes determined only by the relationship between x <dig> and pr, and not by the other parameters of the system, v and d, or by initial conditions. such ‘perfect’ robustness is a result of integral-like control implemented by the feedback loop, with integrator σ = lnx <dig> and error e = -1)v 

for some steady state properties of system  <dig>  the exact shape of the feedback function is irrelevant, but to understand dynamic behaviors or responses to external perturbations, the details are important, particularly the steepness, or ‘aggressiveness’ with which pr changes with x <dig>  if we let kr stand for the propensity of stem cells to self-renew, and kd their propensity to differentiate, then the net renewal probability pr can be written as kr/ = 1/. in other words, pr can be thought of as a monotonic function of the ratio between underlying propensities to differentiate and renew. in the simulations presented here, we take this ratio to be  <dig> + <dig> x2/x¯2n, such that parameter x¯ <dig> corresponds to the value of x <dig> at which stability  is achieved, and parameter n captures the feedback gain . this parameterization approximates most smooth, monotonic saturating functions well enough that the qualitative behaviors we report below hold true even when pr is defined in a variety of other ways. this is because, as we show, the critical feature for these behaviors is the slope of pr near the steady state, which is directly related to the aggressiveness  of the feedback.

renewal control is sensitive to many types of biologically relevant disturbance
as shown in figure  <dig>  stem cell systems potentially face many kinds of perturbation. ‘active’ stem cells may be recruited from ‘quiescent’ populations, and stem cells may undergo cell death, or become quiescent themselves. the speed of the cell cycle may vary from cell to cell, and may be influenced by environmental factors . environmental inputs may also affect the decision to renew or differentiate, but even without environmental forcing, stochastic effects that result from symmetric patterns of divisions  will create substantial fluctuations in stem cell pool sizes  <cit> . rates of loss of terminally differentiated stem cell progeny can also be expected to fluctuate because of disease, injury, or variable patterns of organ use. for example, in the olfactory epithelium, in which feedback controls neuron number  <cit> , the rate of neuron turnover is highly dependent on the environment in which animals are reared  <cit> .

figure  <dig> illustrates the effects of some of these kinds of perturbations on the behavior of a renewal-controlled lineage . for example, simulations in panels b-e explore the effects of a time-varying rate of loss of terminal cells . in panel b, stochastic noise is added to this loss rate . notice how, even though the system’s steady state behavior would be perfectly robust to a constant step change in d, it does not compensate well for fluctuating d. in panels c and d, the fluctuations imposed on d are oscillatory, at fixed frequencies, and the effect of different feedback gains is considered . the results show that increasing feedback gain helps suppress the effects of low frequency oscillations in d, but amplifies the effects of high frequency ones.

it is not necessary to use fluctuating or periodic disturbances to bring out the limitations of high-gain feedback. for example, in figure 2e, the system was subjected to a constant loss of 10% of stem cells per cell cycle . this produces a steady state error in the number of terminal cells. with increasing feedback gain the error can be diminished , but this occurs only at the expense of producing ever larger oscillations in terminal cell numbers.

figure 2f models the response to an acute injury that removes a large proportion  of all terminal cells. with increasing feedback gain, the system can recover its terminal cells  ever more rapidly, but only at the expense of larger, longer-lasting oscillations. indeed, for high enough gain , oscillations become so large that, effectively, no steady state is achieved. in tissues that rapidly regenerate after just such injuries, for example, the olfactory epithelium and the liver, such large swings in terminal cell number are not observed  <cit>  although, interestingly, marked oscillations in terminal cell numbers do happen in some tissues  <cit> , as well as in a variety of pathological conditions  <cit> .

finally, figure 2g,h models the impact of stochasticity in stem cell numbers, as might be expected to arise due to random patterns of division. such fluctuations can be large for small, compartmentalized stem cell pools  but may even be significant in large, non-compartmentalized epithelia. this is because secreted factors that mediate lineage feedback will have limits to their spatial range, so that if most cells tend to remain close to where they were generated, feedback will be effectively compartmentalized, even if there are no fixed boundaries. in these simulations, stochasticity was introduced through adding a noise term  to the right hand side of the first equation of system  <dig>  as the results show, for low feedback gains, feedback reduces the variation in stem and terminal cell numbers, but with increasing gain this effect reverses, and the variance increases. at the highest gains , the probability distribution for terminal cell numbers becomes very broad .

simulations of the effects of other types of disturbances show similar tradeoffs between the ability of high feedback gains to reject disturbances and the ability of the system to avoid oscillation and instability . these include constant increases to stem cell numbers  or fluctuations in the parameters underlying the feedback function itself , as might reflect normal variability in the levels of cellular proteins that drive cellular decision-making.

performance limitations are imposed by the structure of the lineage pathway
in the above examples, steady state errors created by some, but not all, disturbances to a renewal-controlled lineage can be reduced by aggressive feedback, but high feedback gains also bring on oscillations and instability. what accounts for such behavior? is it a result of particular choices of parameters, or the means of realizing the feedback?

the tools of robust control theory provide a way to address such questions. briefly, for a given system, one can calculate a frequency-dependent function s - the sensitivity function - that captures the ability of feedback control to attenuate disturbances of different frequencies . when |s| <  <dig>  feedback diminishes the effect of a perturbation; when |s| >  <dig> it amplifies it. because time-varying disturbances can be decomposed into components of different frequencies, a plot of |s| versus frequency provides a global view of performance. such a plot is shown for system  <dig> in figure 2i, for different values of feedback gain. in all cases, feedback attenuates low-frequency  disturbances, but amplifies high-frequency  ones. the higher the gain, the better the performance at low frequencies and the worse the performance at high ones. this suggests that ‘hard limits’ underlie the behaviors observed in figure 2b-h. indeed, as shown in box  <dig> , the architecture of system  <dig> ensures that |s| must obey a conservation law, implying that |s| cannot be made small for all frequencies simultaneously. in effect, improved performance  for a certain range of frequencies necessarily implies poorer performance  for some other range of frequencies. the existence of this tradeoff is independent of both the parameters of the system and the way feedback is realized, that is, the functional form of pr.

a second limitation imposed solely by the structure of the system involves a relationship between the aggressiveness of feedback and stability . as shown in figure 2i, beyond a certain level of gain, perturbation frequencies exist at which |s| approaches infinity . this corresponds to the observation, seen in figure 2e-g, of sustained oscillations when feedback gains are sufficiently high .

in figure 2i, disturbance frequencies are expressed in time units equal to the length of the stem cell cycle. thus, one way to make the system better able to reject higher-frequency perturbations would be to speed up cell division so that, relative to the cell cycle, any given perturbation would be of lower frequency. indeed, introducing additional negative feedback control of cell cycle speed v - as does occur with gdf <dig> in the olfactory epithelium  <cit>  - can modestly extend the range of disturbance frequencies over which robust control can be achieved. it does not, however, remove the performance limitations imposed by the system’s structure . such limitations also persist if the length of the lineage is increased .

removing performance limitations through controlled pathway branching
the reason the performance limitations discussed above are inherent in the structure of system  <dig> is that the probabilities of renewal and differentiation are necessarily coupled. with stem cells able to make only two choices at each division, negative regulation of one of them implies positive regulation of the other. but stem and progenitor cells could have other choices. they could differentiate along an alternate trajectory, producing a different cell type, becoming quiescent, or even choosing to die. such choices create branches in cell lineages, and examples of such branching exist in both vertebrates and invertebrates, during development and regeneration, and in both solid and blood-borne tissues  <cit> . even in tissues in which lineage branching has not been demonstrated directly, the observation that different cell types appear in temporal waves  is consistent with the model of a common stem or progenitor cell that gradually alters its differentiation choices over time .

the behavior of the simplest system in which a stem cell under feedback control by descendants of one cell type  can choose stochastically to switch to production of an alternate differentiated cell type  is:  <dig> x˙1=2prx2−1vx1x˙2=2pdx2vx1−dx2x˙3=2pax2vx1−d3x <dig> in which pa stands for the probability of choosing the type  <dig> fate. because type  <dig> cells are not taken to have any influence on the production of type  <dig> or type  <dig> cells, the first two equations are identical to those in system 1; indeed if the alternative cell fate is death, then the third equation can be omitted altogether. what is significantly different about system  <dig> is that the condition pr + pd =  <dig> no longer holds, being replaced by pr + pd + pa =  <dig>  this means that regulation of pr in one direction no longer guarantees that pd must change in the opposite direction. the possible ways in which pr and pd may now be jointly regulated are enumerated in figure 3a.figure  <dig> 
control strategies and layered architectures.  lineage branching allows for different control strategies, depending on how the probabilities of differentiation and replication are regulated. any strategy with a positive regulation of p
r is unstable. negative feedback on all the probabilities is unrealizable because the probabilities must add up to  <dig>  any strategy implementing negative feedback on p
r and positive feedback on p
d is akin to renewal control. the last strategy, which implements positive feedback on p
a with simultaneous negative feedback on p
r and p
d, is free from the limitations described in the text. we refer to this feedback strategy as fate control.  multi-layer cell lineage with renewal control strategy.  multi-layer cell lineage with a fate control strategy. red lines represent negative feedback regulation, and green arrows represent positive feedback regulation.



the first two strategies shown are either unstable or unrealizable. the third strategy is, essentially, renewal control, and suffers from all the limitations discussed above. the last strategy, however, in which there is positive feedback regulation of pa with simultaneous negative regulation of pr and pd, behaves dramatically differently. a cartoon representation of system  <dig> with this feedback strategy - which we refer to here as fate control - is shown in figure 4a.figure  <dig> 
effects of disturbances on the performance of fate control. in all panels, the system is at steady state at time t =  <dig>  and larger n corresponds to stronger feedback. for parameter values used see additional file 1: table s <dig>   cartoon representation of fate-controlled two-stage lineage. stem cell progeny can remain stem cells, differentiate into terminal  cells, or differentiate into alternate terminal cells. p
a is the probability of differentiation to alternate terminal cells . red lines represent negative feedback regulation on p
r and p
d, and the green arrow represents positive feedback on p
a.  shown is the population of terminal cells  and stem cells  in response to stochastic fluctuations on d .  shown is stem cell population response to periodic oscillations of d with frequency  <dig>   and  <dig>  . feedback suppresses oscillations due to both disturbance frequencies.  plotted is terminal cell population response to stem cell loss at constant rate. stronger feedback reduces steady state error without causing oscillations.  shown is the terminal cell population after abrupt removal of half the terminal cell population at t =  <dig>  more aggressive feedback has faster rise time and less transient oscillations.  main plot shows terminal cell populations response to a stochastic disturbance directly affecting the stem cell population. the inset shows the standard deviation  of responses for each feedback level. aggressive feedback reduces the variance of the response.  shown is the distribution of the stem and terminal cell populations for the response shown in  with n =  <dig>   shown is the plot of the sensitivity function s for fate control as a function of disturbance frequency. aggressive feedback improves performance  across all frequencies. for additional types of disturbances see additional file 1: figure s <dig> 



as before, we motivate our choice for the form of the feedback function by considering that the three probabilities, pr, pd, and pa, arise from independent propensities, kr, kd, and ka, to self renew, differentiate into type  <dig> cells, or differentiate into type  <dig> cells, respectively. with positive feedback on ka, that is, ka that is monotonically increasing in x <dig>  there can now be negative feedback on both pr and pd, because:  <dig> pr=krkr+kd+kax <dig> pd=kdkr+kd+kax <dig> 

for simplicity, we consider here the situation in which kr and kd are not themselves regulated, so that they maintain a fixed ratio κ = kd/kr; consequently pd = κpr. in most numerical simulations we take kr= <dig> kd= <dig> ,kax2= <dig> x2/x¯2n. however, as before, the results are not particularly sensitive to this parameterization. this is because, as before, the critical feature is the slope of pr and pd near the steady state, which is directly related to the aggressiveness of the feedback.

figure  <dig> illustrates the performance of this system in exactly the same disturbance scenarios that were explored for renewal control in figure  <dig>  the previously identified performance tradeoffs and instabilities are now gone. fluctuations in the turnover rate of type  <dig> cells are effectively suppressed by high-gain feedback without introducing any oscillatory tendency . high feedback gain also enables the system to compensate for both a constant rate of loss of stem cells, and an abrupt removal of terminal cells, without the risk of instability in either case . such feedback also prevents stochastic fluctuations in stem cell numbers from propagating to terminal cell numbers .

the reason for these dramatic improvements is evident in the plot of |s| versus disturbance frequency . no longer does a conservation law require reductions in |s| at some frequencies to be balanced by increases in |s| at others. no longer does high feedback gain promote instability. as a result, high gains can be used to enable responses to disturbances that are arbitrarily fast . under such conditions, the response to a deficit of terminal cells of type  <dig> would be for stem cells to renew and generate cells of type  <dig> at a constant, high rate until a sufficient number were produced, then rapidly switch to generating cells of type  <dig> 

branched lineages and layered architectures
branched lineages can escape the performance limitations of unbranched ones because, through fate control, they can realize negative feedback on both the probability of replication  and the probability of differentiation into terminal cells . but what about the alternative fate that the lineage branch creates? in the event that that fate is not cell death, will the numbers of such cells be well controlled? in system  <dig>  with pr a decreasing function of x <dig>  we see that the value of the alternate cell population  always reaches a steady state, but unlike x <dig>  it is not robust, being linearly dependent on d/d <dig>  the ratio of the turnover rates of x <dig> and x <dig>  moreover, cell type  <dig> is highly ‘exposed’ to disturbances, as disturbances on the other cell types directly affect the dynamics of x <dig>  and there is no direct influence of x <dig> on its own value. put another way, whereas the existence of cell type  <dig> can help solve some of the control problems faced by cell type  <dig>  controlling cell type  <dig> requires additional mechanisms .

if cell type  <dig> is a terminally differentiated cell, there are not too many options, other than to regulate its turnover. but if it is a progenitor cell, it could receive negative feedback from its own differentiated progeny, much like cell type  <dig> does. we refer to this as a ‘layered’ lineage architecture because one layer  branches to give rise to a second layer . of course, we might expect that negative feedback at the second layer will be subjected to the same challenges and tradeoffs discussed for simple unbranched lineages , unless that layer itself branches, creating a progenitor cell type  <dig> that is fed back upon by a differentiated cell type  <dig> 

indeed, one could imagine a succession of many layers, each controlling itself through feedback, and branching to produce the next layer. in fact, there are many in vivo systems in which the dynamics of cell type production and progenitor cell potency suggest the existence of such layered architectures . to explore their control implications, we compare two different layered scenarios: in one , negative feedback occurs at each stage only through down-regulation of pr and up-regulation of pd . in the other , feedback at each stage occurs through up-regulation of pa, with concomitant down-regulation of both pr and pd .

analysis of steady state behavior indicates that either strategy improves parametric robustness , although perfect robustness exists only at the first layer. at each subsequent layer, integral feedback control is ‘leaky’, due to the  influx of cells from the previous layer. the size of this leak at any given level can be kept small by having the influx from the previous level be small compared with the expansion of progenitors at that level.

in terms of responses to the sorts of disturbances described in figures  <dig> and  <dig>  the renewal control and fate control strategies perform very differently. figure  <dig> illustrates responses to the same kind of stochastic disturbances that were explored in figures 2b and 4b, applied now to all three stem/progenitor cell types in a three-layer branched lineage. with renewal control , disturbances are transmitted to and may even be amplified at the level of the terminal cells. by contrast, with fate control , the effects of such disturbances can be damped out . these results closely mimic what was seen in figures 2b and 4b, and the reasons are the same: fate control can exploit high-gain feedback to suppress disturbances, whereas renewal control cannot.figure  <dig> 
control of multi-layered lineages.  shown are populations of the different cells types over time in response to a stochastic forcing function in all three types of stem-like cells x
1
, x
3
, and x
 <dig> for a renewal-controlled multi-layer lineage  and a fate-controlled multi-layer lineage .  histogram of the distribution of the total population of terminal and stem cells for the sample path in panel a.  histogram of the distribution of the total population of terminal and stem cells for the sample path in panel b. for parameter values used see additional file 1: table s <dig> 



branched lineages and ‘final state’ tissues
not all tissues arrive at a final size through a balance between cell production and cell loss. many tissues are generated by stem cells that exist only transiently during development, producing terminal cells that survive for the life of the organism. for example, most of the mammalian nervous system falls into this category  <cit> . such self-terminating, or ‘final state’ tissues can be modeled using the same approach as for steady state tissues, by simply setting the turnover rates for terminal cells to zero  <cit> . for a simple, unbranched, one-stage lineage with renewal control, nearly perfect robustness of final terminal cell numbers can be observed  <cit> , demonstrating that renewal control provides integral feedback in final state tissues as well as steady state ones.

should the effects of perturbations on models of final state tissues also resemble what occurs in steady state models? intuition suggests that terminal cell oscillations will not occur in final state models, because the oscillations in steady state models depend upon cell turnover . instead, the consequence of overshooting a goal should simply be an irremediable overproduction of terminal cells.

to explore, quantitatively, the effect of feedback and branching on final state systems, we studied the same three-layer lineages and feedback strategies shown in figure  <dig>  but set cell turnover rates to zero. figure 6a,b shows the dynamics of production of the initial terminal cell type , either using renewal control or fate control at different feedback gains. parameters were chosen to produce the same final numbers in both cases. we note that the total number of cell divisions does not differ substantially between the two cases.figure  <dig> 
control of final state systems.  shown are populations of terminal cells over time for renewal control  and fate control  for a two-stage lineage. the inset shows the corresponding stem cell populations. large feedback gains  do not significantly alter development time. the initial population consists of  <dig> stem cells of type x
 <dig> and no other cell types.  shown is the error  in development as a function of n in response to constant loss rates ρ =  <dig>  and ρ =  <dig>  of stem cells for the renewal control  and fate control . for renewal control, the benefits of feedback are modest. for fate control, sufficiently high gain can suppress the effects of stem cell loss nearly completely.  shown are populations of the different terminal cell types x
 <dig>  x
 <dig>  x
 <dig> in the multi-layered topology. solid lines show population trajectories when there is no disturbance, and the dashed lines the trajectories when there is loss of all stem-like cells x
 <dig>  x
 <dig>  x
 <dig> at rate ρ =  <dig> . for renewal control , stem cell loss does not affect development time, but it results in smaller concentration of terminal cells  at every feedback level. for fate control , stem cell loss causes a delay in development time, but for high feedback gain the concentration of terminal cells is preserved. for panels a and c, p
r 
= 1/n), b
n =  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  and  <dig> for n =  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  and  <dig> respectively. for panels b and d, p
r = 1/n), p
d =  <dig> p
r, b
n =  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  and  <dig> for n =  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  and  <dig> respectively. for parameter values used in panels e and f see additional file 1: table s <dig> 



in figure 6c,d we explore the effects of a constant perturbation to stem cells , by imposing a steady loss rate on x <dig>  similar to what was done in figures 2e and 4e. as anticipated, oscillations are not seen, but final state errors in the numbers of terminal  cells occur. these are plotted in figure 6c,d as a function of the feedback gain. here we see that high gain improves performance for both control strategies, but with renewal control  the effect is modest at best, with the final disturbance to terminal cell numbers actually exceeding the fractional rate of stem cell loss. by contrast, with fate control , a sufficiently high gain can suppress the effects of stem cell loss nearly completely .

figure 6e,f shows the dynamics of terminal cell production for a three-layered topology when there is no disturbance present and when there is loss of stem-like cells at each of the layers. one noticeable difference is that fate control  generates terminal cell types in distinct temporal waves, whereas with renewal control , all cell types appear more or less at the same time. furthermore, with renewal control the timing of cell type production does not change substantially when there is stem cell loss, whereas with fate control the production of terminal cell types is markedly delayed .

discussion
feedback regulation of cell lineage progression has recently been recognized as an important strategy for the control of tissue growth and homeostasis . negative regulation of stem or progenitor cell renewal by differentiated progeny - a strategy we refer to here as renewal control - can stabilize stem cell numbers, speed regeneration, and establish tissue sizes that are robust both to growth parameters  and initial conditions  <cit> . yet, as we demonstrate here, this strategy also limits the ability of tissues to deal with a variety of realistic perturbations, including losses or additions to stem cell pools, or time-varying disturbances to cell numbers or growth parameters. by contrast, feedback regulation of lineage branching can circumvent these limitations. we refer to fate control as the strategy by which differentiated cells drive stem or progenitor cells to differentiate along a secondary fate pathway, at the expense  of stem or progenitor cell renewal. the latter stipulation ensures that fate control also incorporates negative feedback on renewal, which is why it still achieves the desirable stability and robustness properties of renewal control, even while escaping the latter’s limitations.

fundamentally, the limitations of renewal control arise because of the unavoidable coupling between renewal and differentiation, which causes responses to perturbations initially to go in a ‘wrong’  direction. for example, with renewal control, an excess of differentiated cells will eventually restore their numbers through suppression of stem cell renewal . but because the only alternative to renewal is differentiation, reducing renewal will always initially lead to an increase in differentiated cell numbers, the opposite of a restoring effect. such maladaptive dynamics are characteristic of what, in control theory terminology, is referred to as a ‘non-minimum phase’ system, and it is straightforward to show that an unbranched, renewal-controlled lineage is structurally non-minimum phase. by contrast, a fate control strategy is minimum phase, because differentiation  and renewal can be suppressed simultaneously . control engineers make considerable efforts to avoid non-minimum phase systems, as they are generally subject to undesirable tradeoffs, the most serious of which can be captured by conservation laws requiring that the attenuation of some disturbances must come at the expense of the amplification of others. the presence of such tradeoffs for renewal control is clearly shown in figures  <dig>   <dig>  and  <dig>  one of the most severe tradeoffs is that increasing feedback gains, which might otherwise help with the rejection of disturbances, can lead to increasing oscillation and, ultimately, instability. by contrast, with fate control, high gains  are never problematic .

in view of these findings, one might expect fate control to be especially prevalent in biology. identifying it in biological data requires showing both that a lineage is branched, and that feedback promotes differentiation toward an alternative fate. many lineages are indeed branched, including ones in the hematopoietic system, the nervous system, and connective tissue  <cit> . even in tissues in which lineage relationships are not fully understood, the sequential appearance of cell types over time, during development or regeneration, often suggests lineage branching . moreover, hematopoietic and neural lineages are commonly depicted in terms of layered branching architectures similar to those in figure  <dig>  <cit> . it should be noted that nothing about fate control as a feedback strategy requires layered lineages to be as deterministic and irreversible as suggested by figure 3: even an architecture in which a multipotent stem cell always has some probability of producing every differentiated cell type, and simply gradually changes those probabilities as different cell types are produced, should behave similarly - from the standpoint of control - to an architecture with fixed layers.

evidence that feedback factors produced by terminal cells promote fate transitions is harder to come by, but observations in at least two systems - the olfactory epithelium and the neural retina - support this view. in the mouse olfactory epithelium, it was recently shown that a single type of stem cell acts as the precursor of both the committed progenitors of neurons and sustentacular  cells  <cit> . activin βb, which is produced by the neuronal cells of the epithelium, feeds back onto this stem cell to inhibit neuronal, and favor glial, differentiation. the fact that stem cell numbers rise in activin βb-null mutant mice implies that activin not only promotes glial fate choice but also decreases stem cell renewal, as required by an effective fate control strategy. the molecular mechanism of activin action in this tissue provides a likely explanation for its fate-controlling effect, as it targets for rapid degradation the transcription factor ascl <dig>  which is known to drive neuronal fate choice .

in the mouse retina, ganglion cells  produce gdf <dig>  which feeds back on multipotent retinal progenitors to decrease the probability that their offspring adopt a ganglion cell fate, and increase the probability that amacrine and photoreceptor cells  are produced  <cit> . the production of still other cell types of the neural retina in an orderly sequence suggests that other fate-controlling signals either direct sequential lineage branching , or gradually alter the alternate fates available at the end of a single lineage branch . the molecular nature of such signals has yet to be discovered, however.

studies in the intestine also provide evidence for fate control as a strategy for regulating cell numbers. in mouse intestine, the effects of genetic ablation of bone morphogenetic protein  receptors from the intestinal epithelial lineage indicate that the bmps produced by one class of terminal cells  feed back to promote differentiation of a common progenitor into enteroendocrine cells, an alternate lineage branch  <cit> . that this feedback is involved in the control of terminal cell numbers is demonstrated by the increased number of dividing cells per crypt, and increased villus length, in the receptor-mutant animals.

other examples of cell number control via fate control are likely to exist, especially if one expands the notion of fate choice to include cell emigration or death. for example, in the hematopoietic system, regulated stem cell death is known to play an important role in controlling steady state cell numbers  <cit> , and it has been suggested that mobilization of stem cells from the marrow to the blood serves a similar homeostatic role  <cit> . the high rate of progenitor cell death that is observed in lymphoid lineages  <cit>  could also play a role in numerical homeostasis, outside of its known role in selection for appropriate antigen-reactivity. even in the nervous system, it has recently been argued that regulated progenitor cell death plays an important role in tissue size control  <cit> .

as discussed above, one of the advantages of a fate control feedback strategy is that it allows for the use of high gain  to suppress disturbances. although it is not simple to measure gains in vivo, recent observations in the developing mouse intestinal epithelium  <cit>  support the view that, in at least some cases, gains are indeed high: in that tissue, postnatal development is characterized by a period of nearly pure exponential expansion of stem cells, which switches abruptly to one of stem cell homeostasis . switching occurs in each crypt as it reaches a threshold size, suggesting control by local feedback. the abruptness of the switch  suggests a high feedback gain.

although the present study demonstrates some of the advantages of fate control over renewal control, in terms of stability and disturbance rejection, it should come as no surprise that fate control also entails tradeoffs. for example, the mechanisms required to enable controlled lineage branching and high gain are likely more complex than those needed simply to regulate renewal. in addition, high-gain control forces cells of different types to appear in a sequential fashion , which might not be desirable in all tissues. and when the purpose of an alternative fate is solely to control the numbers of cells that adopt a primary fate , fate control is associated with the extra ‘overhead’  of producing cells that are not actually needed. thus, the extent to which tissues are better served by renewal control or fate control is likely to depend strongly on the timing with which cells of different types are needed, the types of disturbances that are likely to arise, and the costs of implementing each type of strategy.

it should also be kept in mind that the analysis and simulations in the present study explore only some of the simplest possible implementations of renewal and fate control. a variety of additional interactions could modify or expand the options for achieving effective control; these might include feedback from non-terminal cells; alternative fates that can later be reversed ; a ratio of propensities to renew versus adopt a primary fate that is not held constant, but varies with feedback; positive feedback on renewal; and spatial effects . exploration of these and other possibilities may be needed before detailed validation of specific control models with biological data will become practicable.

CONCLUSIONS
tissues achieve and maintain appropriate sizes in large part through the regulated progression of cells through lineages. although negative feedback control of self-renewal has been shown to play an important role in this process, pure renewal control - in which differentiation along a single pathway is the only alternative - brings with it a variety of undesirable properties. using tools from robust control theory, we show that the limitations of renewal control can be circumvented through the introduction of lineage branching, with feedback promoting alternate fate choice at the expense of both primary fate choice and self-renewal. generic results such as these allow us to interpret common biological phenomena, such as lineage branching, sequential production of cell types, and programmed cell death, in a new light: not as mechanisms required to produce the cells of a tissue, but as hallmarks of a strategy for achieving control over cell numbers and dynamics.

