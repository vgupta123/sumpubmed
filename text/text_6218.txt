BACKGROUND
the popularity of microarray technology as means of deriving a comprehensive view of gene expression under particular environmental stimuli has necessitated the development of computational strategies for linking expression patterns to sample phenotypes  <cit> . in charactering disease, the gene expression matrix serves as input to a classification task where each sample is allocated to a relevant phenotypic class via specific gene signatures or biomarkers that can best differentiate between outcomes. such disease classification tasks have been successful in deriving biomarkers for diagnosis  <cit> , prognosis  <cit>  and response to treatment  <cit>  in complex disorders.

despite successful reports, disease classification is impeded by the so-called “large p small n” property, whereby the number of samples  is typically several orders of magnitude smaller than the number of genes , making it difficult to extract reliable information from transcriptomic profiles  <cit> . feature reduction methods are therefore employed as means of extracting a smaller set of genes, able to discriminate between disease states. we note as example methods based on partial least squares  <cit> , heuristic breadth-first search algorithm  <cit> , and ensemble feature selection methods  <cit> . subsequently, a classifier can be trained on the reduced feature set to predict the disease status or prognostic characteristic of any given samples  <cit> .

such diagnostic or prognostic profiles relate to genes that do not act in isolation, but in fact work in concert, forming sub-networks that collectively modulate or determine cell fate. accounting for such molecular synergies in feature reduction and disease classification protocols can also alleviate challenges of single-gene classifiers related to cellular heterogeneity in tissue, genetic heterogeneity among patients, measurement noise  <cit> , thereby leading to increased biological interpretability of biomarkers and enhancing insights into the mechanisms of the disease  <cit> . therefore, feature selection and classification methods where all genes are treated independently are increasingly replaced by approaches where the effects of groups of genes on disease prediction are considered simultaneously. such gene sets can either reflect curated biochemical pathways or functional modules derived from protein interaction networks  <cit> .

the availability of pathway information from publc databases, for example kyoto encyclopedia of genes and genomes   <cit> , gene ontology   <cit>  and reactome  <cit> , provide the possibility of analysing functional sets of genes that fall within common pathways and identifying the disease-relevant pathways as biomarkers. initial efforts of gene-set based approaches included gene set enrichment analysis  <cit> , which calculates to what extent a set of genes show statistically significant difference between samples belonging to either of the two phenotypes. other similar computational tools have also been reported  <cit> . however, those statistical frameworks commonly assign one score for each set of genes to quantify the deregulation of this gene-set under disease status of interest, but do not provide more information on the level of gene-set deregulation for each sample. it is argued that this drawback compromises their potential in personalised pathway analysis  <cit> .

therefore, a more informative approach may be to assign a score to each pathway and sample, which represents the activity of that particular pathway for that sample  <cit> . the mean and median expression value across all constituent genes within a pathway, termed pathway activity, has been proposed in  <cit> . other studies produce pathway activity measures based on principle component analysis  to derive the top principle component that captures the maximum variance in the dataset  <cit> . more recently a supervised greedy search algorithm was proposed that ranks genes according to their individual discriminative power and then searches for a subset of highly ranked genes whose averaged expression profiles yield better discriminative power  <cit> . this method was modified so that it accounts for up- and down-regulated genes by assigning positive sign and negative sign respectively  <cit> . both methods are inherently applicable to binary classification problems. a statistical inference method  <cit>  proposes to aggregate the probabilistic evidence of all genes within a pathway for predicting a sample into one of the two phenotypes. other relevant studies based on the concept of pathway activity either require other biological information as prior, for example copy number variation and protein interactions  <cit>  or are not designed for classification tasks  <cit> .

pathway activity-based classification approaches provide competitive or higher prediction accuracy when compared to traditional single genes-based classifiers  <cit> , so extending or refining their use is a promising avenue for biomarker discovery. despite rapidly increasing interest in developing novel and robust pathway activity inference methods, most of the existing methods still use rather simple means of summarising the expression patterns of either some or all constituent genes into the composite pathway level attribute, for example the mean or median value of sample expression across all or a subset of constituent genes  <cit> . pca-based methods  <cit>  calculate the first principal component, representing the maximum variance of the data set, as pathway activity. however such methods do not take into account the phenotype information of samples. furthermore, some current pathway activity inference methods are constrained to two-phenotype  classification problems  <cit> , disallowing their use in more complex problems of multi-phenotype classification.

in this work, we propose a novel multiclass method that infers pathway activity in a supervised manner. the proposed method summarises expression patterns of constituent genes into pathway activity via weighted linear summation of gene expression. as opposed to some methods in literature where gene weights are taken as a prior, in our work gene weights are decided by the model, so that the constructed pathway activity can optimally distinguish samples from different phenotypes. furthermore, the mathematical framework of this method offers the ability to the user to explicitly constraint the maximum number of constituent genes contributing to pathway activity inference. using a number of published gene expression profile datasets, we show that this pathway activity inference method is robust in terms of the number of constituent genes allowed to determine the pathway activity metric. comparative analyses show that the method is an effective means of reducing classification features, as it either outperforms or at least matches competing pathway activity inference methods in two-phenotype disease classification problems, and provides significantly better classification rates in multi-phenotype classification problems.

methods
data sources
complex diseases such as breast cancer and psoriasis are the product of multiple gene interactions that collectively contribute to the etiology of the disease through largely unknown mechanisms  <cit> . breast cancer is the most frequently diagnosed malignancy and has been intensively studied by gene expression profiling  <cit> . psoriasis is a systemic, inflammatory skin disease with autoimmune underpinnings affecting 2-3% of the world population  <cit> . prostate tumor is the most frequently diagnosed cancer in american men  <cit>  and displays a broad range of clinical and histological behaviors  <cit> . diffuse large b-cell lymphoma  is the most common lymphoid malignancy in adults  <cit>  with less than 40% patients responding desirably to the current therapy while the remainders succumb to the disease, highlighting the unidentified molecular heterogeneity in the tumors  <cit> .

a total number of  <dig> published microarray gene expression profiles were obtained that represent these diseases . in terms of disease phenotypes in these datasets, used as class outcomes in the relevant classification tasks, for psoriasis samples are either lesional or non-lesional tissue from psoriasis patients, as well as healthy controls  <cit> . for breast cancer,  <dig> samples belong to three disease classes, apocrine, basal and luminal  <cit> ;  <dig> samples are divided into healthy, luminal, erbb <dig> and basal  <cit> ; expression profiles of  <dig> breast cancer patients  <dig> of whom became residual invasive cancer free in the breast or lymph nodes after a 6-month preoperative chemotherapy and the remainder still had residual invasive cancer after the treatment. gene expression data were generated using specimens of breast cancer before any treatment  <cit> ; lymph-node negative breast cancer patients with some of them diagnosed with distant metastasis  <cit> . for prostate cancer,  <dig> expression profiles are used to distinguish tumour samples from normal samples  <cit> . finally,  <dig> expression profiles of patients either diagnosed with diffuse large b-cell lymphoma or follicular lymphoma  are used  <cit> .table  <dig> 
datasets



dataset
disease
samples
samples per phenotype
source
www.broadinstitute.org
www.broadinstitute.org


all microarray datasets have been obtained on affymetrix platforms. for each dataset, raw data have been downloaded and pre-processed using the bioconductor package limma  <cit> . kegg c <dig> functional gene sets have been downloaded from msigdb database   <cit> , which included a total number of  <dig> curated pathways and  <dig> genes.

pathway activity-based classification procedure
an overview of the computational procedure developed for pathway activity-based disease classification is illustrated in figure  <dig>  a microarray gene expression profile and a set of pathways with their constituent genes form the input to create pathway-specific gene expression matrices. for each pathway, m denotes member genes, s samples and asm the expression value of gene m in sample s. asm are standardised to gsm by subtracting the population mean from the raw value and then dividing by the standard deviation. the first stage of our computational procedure derives a new composite feature, pathway activity pas, from the standardised pathway specific gene expression profile gsm. in the second stage of our protocol, the inferred pathway activities for all pathways are assembled to form a pathway activity profile matrix, on where a classifier is trained to predict the phenotype of a new sample. in next section, we present a novel mathematical model, which infers pathway activity with optimal classification accuracy.figure  <dig> 
schematic flow chart of the digs-based approach for multiclass disease classification problems. pathway specific gene expression profiles are created by integrating gene expression profile and pathway information. for each pathway, build pathway activity as a weighted  linear summation of expression of member genes, with the objective function maximising the number of samples whose pathway activity are inside the range of their own classes. the maximum number of member genes in a pathway allowed to have non-zero weights is explicitly constrained in the model by specifying the parameter nog. create pathway activity profile by assembling all pathway activities and a classifier is trained on the pathway activity profile and predicts the class label of a new sample. it is important to note that training procedure, i.e., inferring pathway activity and training a classifier, is always blind to testing samples to achieve an objective evaluation of classification performance.



a novel mathematical programming formulation to infer pathway activity
the indices, parameters and variables used in the model to infer pathway activity for each pathway are described here and are listed in additional file  <dig>  two sets of positive variables rpm and rnm are introduced, quantifying the positive and negative weights of gene m towards pathway activity inference. for sample s, pathway activity, pas, is defined as the summation of the standardised gene expression values, gsm multiplied by the gene weight  over all member genes:  <dig> pas=∑m=1mgsmrpm−rnm∀s= <dig> ,…s where m is the total number of member genes for this particular pathway and s is the total number of samples. both positive and negative weights of a gene m are defined as positive continuous variables; their values are determined by the optimisation model. one set of binary variables, lm, which takes values of either  <dig> or  <dig> has been introduced, while equations  and  below ensure that for each gene m at most one of rpm and rnm can take positive values:  <dig> rpm≤lm∀m= <dig> ,…,m   <dig> rnm≤1−lm∀m= <dig> ,…,m 

when lm 
=  <dig>  rpm can take any value between  <dig> and  <dig> while rnm is forced to be equal to 0; otherwise when lm 
=  <dig>  rpm is forced to be equal to  <dig> while rnm can be between  <dig> and  <dig>  in either case, both rpm and rnm can be equal to  <dig>  which means this particular gene has zero weight in inferring pathway activity. overall, a gene can have positive, negative or zero weight towards the composite feature construction. for normalisation purpose, the summation of absolute gene weights should be equal to one:  <dig> ∑m=1mrpm+rnm= <dig> 

inspired by lee et al.  <cit> , where a small subset of member genes is selected  to construct pathway activity, we add constraints to limit the number of genes having non-zero weights in inferring pathway activity. thus a new set of binary variables, wm, are introduced to the model to indicate whether a member gene m is active, i.e. having non-zero weights in constructing pathway activity or not:  <dig> rpm+rnm≤wm∀m= <dig> ,…,m 

if wm takes the value of  <dig> then both positive weight  and negative weight  of gene m are forced to be equal to  <dig>  while when wm is equal to  <dig>  gene m is allowed to take any weight  between − <dig> and  <dig>  the next equation restricts the maximum number of genes allowed to have non-zero weights to a manually specified value :  <dig> ∑m=1mwm≤nog 

in the case where nog is equal to or larger than the number of member genes available in the pathway, the constraint is redundant as all the member genes will be allowed to take any weight  between − <dig> and  <dig>  we aim to construct pathway activity as a feature with good discriminative power, which can separate samples from different phenotypes as much as possible.

for each phenotype/class c, two continuous variables have been introduced as loc and upc, denoting the lower and upper bound respectively, of the range of pathway activity for phenotype c. in addition, a set of binary variables, es, have been introduced, defined by: es= <dig> ifactivityvalueofsamplesfallswithinthelowerandupperboundsofitsclassrange; <dig> otherwise 

together with the following constraints:  <dig> 0≤pas−loc+u1−es∀s= <dig> ,…,s,cs   <dig> pas−upc−u1−es≤0∀s= <dig> ,…,s,cs where cs is the phenotype for sample s and u is an arbitrarily large positive number. on the constructed pathway activity, ranges of different classes are not allowed to overlap. a set of binary variables, ykc, have been introduced as follows: ykc= <dig> ifupperboundofrangeforclasskislowerthanlowerboundofrangeforclassconpathwayactivity; <dig> otherwise 

the additional two sets of constraints have been introduced to guarantee the non-overlapping condition:  <dig> upk+ε≤loc+u1−ykc∀k<c   <dig> upc+ε≤lok+uykc∀k<c where ε is an arbitrarily small positive number ensuring that pair-wise classes do not share a border. equations  and  are generated for each pair of classes. the objective of the optimisation problem is to infer the pathway activity such that it is as discriminative as possible, i.e. as many samples as possible can fall within the range of its corresponding classes . in other words, the objective function is to minimise the number of misclassified samples:  <dig> min∑s=1s1−es 

the resulting mathematical programming-based formulation for inferring pathway activity is summarised below:objective function 

subject to:

pathway activity definition 

positive and negative gene effect constraints  and 

normalisation constraint 

restriction of the number of active genes  

pathway activity enclosing constraints  and 

non-overlapping constraints for ranges of different classes  and 

 lm,es,wm,ykc∈ <dig> ;rpm,rnm≥0;pas,loc,upc:unrestricted 

the proposed mathematical programming formulation consists of a linear objective function and a number of linear constraints. the linearity and presence of binary and continuous variables define a mixed integer linear programming  model, named digs  here, and can be solved to global optimality using some of the standard algorithms like branch-and-bound.

to facilitate the use of digs, we make available the gams executable, example input files and user guide at www.ucl.ac.uk/~uceclap/digs.

comparison of the digs model with genes-based methods and other pathway activity inference methods
to compare the results obtained with the digs model, we have implemented a number of pathway activity methods from the literature . in overview, these methods include: i) the method that uses the microarray gene expression profile without pathway information, for example sg; ii) the method that utilises pathway information but is based on the pathway specific gene expression profile instead of inferring pathway activity, for example per_pathway, and iii) those that take advantage of pathway information and infer pathway activity, for example  <cit> .table  <dig> 
overview of evaluated methods


















in detail, comparative results are presented by implementation of the following methods: i) a genes-based approach has been implemented for comparison where, given a whole gene expression profile, a feature selection  <cit>  method is applied to select a subset of top genes with the best discriminative power for classification. the multiclass feature selection method  <cit>  used here employs a distance metric, for example weighted l <dig> metric or k-l divergence and gives a subset of top attributes/genes with respect to the aggregated pair-wise class distances, where the number of attributes in the subset obtained is pre-set by the user. a classifier is then trained using only the small subset of discriminative genes for disease classification problems; ii) the ainali et al.  <cit>  method, where each pathway-specific gene expression profile is treated independently, i.e. training and testing are conducted for each pathway-specific expression profile separately and classification accuracies across all pathways are averaged to obtain the final classification rate , and iii) the two methods from guo et al.  <cit>  , which take either the mean or median gene expression values of all genes within a pathway for each sample. the bild et al.  <cit>  approach  of using the first principal component as representation of pathway activity, which represents a family of principal component analysis-based methods  <cit> . the lee et al.  <cit>  method, which identifies and averages a subset of condition-responsive genes , which has been implemented only for two-phenotype disease classification problems, as it is not suited to multi-class problems.

evaluation of classification performance
the performance of the various pathway activity metrics is evaluated by the classification accuracy achieved across the eight disease datasets. for each dataset, samples are split randomly in training and testing sets of  <dig> and 30% respectively and this procedure is repeated fifty times. composite features are constructed using mean, median, corgs, pca and digs on the training samples, resulting in low dimensionality matrix of samples across pathway activities, on which five popular classifiers smo  <cit> , neural network   <cit> , k-nearest-neighbours   <cit> , logistic regression   <cit>  and hyperbox   <cit>  are trained. the classifiers are then tested on the testing sample set and the prediction accuracy is calculated as the number of correctly classified samples divided by the total number of testing samples, averaged across the fifty training/testing sets.

the above procedure is modified where pathway activities are not used, i.e. in the sg and per_pathway approaches. in the genes-based approach, the feature selection method  <cit>  has been applied using training samples only and the top genes are selected. the number of top genes is set to be identical to the number of pathways  in order to derive comparable dimensionalities between the pathway activity-based and the genes-based approach. for the per_pathway approach, each of the  <dig> classifiers have been trained using training samples only and then validated on the testing samples sets for each pathway separately.

overall,  <dig> microarray gene expression profiles ,  <dig> competing methods  and  <dig> classifiers  are employed in our study. for each combination of dataset, method and classifier, classification accuracies over  <dig> individual testing sets are averaged as the prediction accuracy for this combination. it is important to note that lee et al.  <cit>  is applicable for only two-phenotype problems, therefore we divide the  <dig> datasets into a group of  <dig> binary datasets and the other group of  <dig> multiclass datasets. for the binary classification comparison, for each method we average the prediction accuracies over all  <dig> binary datasets and all  <dig> classifiers, which gives a comprehensive indication of the efficiency of the evaluated methods . for the multiclass case, the same analysis is applied and all comparative analyses are discussed in the next section.

the digs model has been implemented in the general algebraic modelling system   <cit>  using the cplex milp solver in a centos  <dig>   <dig> bit unix computer environment. the optimality gap is set as  <dig>  computational resource limit is set as 200 seconds per run. among the  <dig> classifiers smo, nn, k-nn and logistic have been implemented in weka machine learning software  <cit>  with the following parameters for nn: hidden layers  <dig>  learning rate  <dig> , momentum  <dig> , training time 10000; and for k-nn: the number of nearest neighbours is selected as  <dig>  for other classifiers, their default settings have been retained. hb has been reproduced in gams according to its original publication  <cit> .

RESULTS
in this work, we propose an optimisation-based model that infers a pathway activity metric as a weighted linear combination of the constituent gene expression values. the digs model can identify a subset of pathway constituent genes with cardinality no more than the user-specified value, nog, whose expression can be combined via different weights to best separate samples from different phenotypes. the effect of nog is illustrated through sensitivity analysis below, followed by a comparison of the model against a variety of disease classification strategies, including both single-gene and pathway activity based approaches.

sensitivity analysis for nog, influencing the number of active genes in constructing pathway activity
parameter nog determines the maximum number of pathway member genes that have non-zero weight in activity inference. tuning this parameter is important as a small value may not fully utilise the discriminative member genes, while an excessively large value may potentially cause over-fitting, i.e. in the case where too many genes are allowed to take non-zero weights for pathway activity against a relatively small number of training samples, leading to decreased prediction accuracy.

here, the digs model is applied to infer pathway activity with nog set to  <dig>   <dig>   <dig> and  <dig>  followed by training and testing using a range of classifiers for each microarray dataset. as a comparison, digs is also run with nog set equal to the number of member genes for each pathway, so as to allow all member genes in a pathway to take non-zero weights for pathway activity inference. the prediction rates achieved by these different values of nog are denoted by digs_ <dig>  digs_ <dig>  digs_ <dig>  digs_ <dig> and digs_all and are shown in figure 2a and b with smo and nn classifiers and other classifiers in additional file  <dig> figure  <dig> 
sensitivity analysis of parameter
nog
for digs model with smo  and nn  classifiers. for each of the  <dig> datasets, the proposed digs model is applied to infer pathway activity while setting nog, i.e. the maximum number of member genes in a pathway allowed to have non-zero weights, to  <dig>   <dig>   <dig> and  <dig>  in addition, digs model is also applied with nog set to equal to the number of available member genes in a pathway, i.e. all member genes can take non-zero weights to construct pathway activity. a classifier is trained using the pathway activity profiles and tests the prediction accuracy. for both smo  and nn  classifiers, it is clear that the proposed digs model is robust to the parameter nog during the tested ranged  <dig> to  <dig>  furthermore, constraining the maximum number of active constituent genes appears to generally improve classification accuracy as digs_all usually leads to lower prediction rate compared with the others.



generally, the digs model is robust with respect to parameter nog, as in the range of  <dig> to  <dig>  classification prediction performance is found to be mostly stable, with some improvement observed between nog  <dig> and  <dig>  overall, it is noted that prediction performance is case-dependent, not only depending on the dataset under investigation, but also varying with the particular pathway in question . in some cases, some improvement is observed against the case of no selection, for example on yao, farmer and pawitan datasets with smo classifier classification rates increase from  <dig> %,  <dig> % and  <dig> % to  <dig> %,  <dig> % and  <dig> %  respectively .

the model performs well even in the case where the number of genes is not reduced , indicating that, although reducing the total number of genes per pathway through parameter nog may be beneficial to a particular application, it is by no means compulsory. therefore, nog offers the flexibility of feature reduction, if looking into the effect of a subset of genes is desired, without imposing any additional limitations that would stem from cases where parameter specification would be mandatory. for the implementations discussed below, nog equal to a value of ten was chosen as a sensible compromise of the effects discussed above.

classification rate comparison across other methods
the performance of the proposed digs model against other competing methods in literature is compared and discussed here. as described in the methods section, extensive comparisons were implemented across  <dig> datasets  and  <dig> competing methods . to also account for the effect of classifier choice in the computational procedure, we tested the digs model across  <dig> classifiers . the results across all dataset, method and classifier combination are illustrated in figure 3a and b  and in the additional file  <dig> .figure  <dig> 
classification accuracy comparison of  <dig> competing methods using 5-nn  and nn  classifiers. the proposed digs pathway activity inference method is compared against other pathway activity inference methods  and also genes-based methods . classification accuracy is summarised as average prediction rates over  <dig> runs of random partition of datasets into a 70% training set and a 30% testing set. with 5-nn classifier , it is evident that digs outperforms other methods by some distance as topping the chart on  <dig> datasets  while being tied 1st on the other  <dig> datasets . prediction rates achieved by digs are generally high, over 80% in most datasets, which facilities its application in real world. with nn classifier , the same trend can be observed that prediction accuracies achieved by digs at least matches the state-of-the-arts methods in literature for binary disease classification problems, while consistently outperforms the competing methods for multi-phenotype problems.



it is obvious from figure 3a that using 5-nn as classifier digs-based classification approach achieves higher classification rates than other pathway activity inference methods, including mean, median, pca, corgs. on all  <dig> datasets, digs model inferring pathway activity has always outperformed other pathway activity inference methods. it is not a surprise as digs seeks to infer pathway activity as of optimal discriminative power. it is also true that digs-based pathway activity classification approach results in higher prediction accuracy than per_pathway, where pathway-specific gene expression profiles are trained and tested independently without constructing pathway activity features. lastly, the same observation can be made when comparing digs to sg, where  <dig> genes of best discriminative power are selected for classification. digs leads to better classification rates than sg on six occasions , while being tied with sg on yao and trailing sg by marginal extent on shipp. overall it is evident that the proposed digs-based classification approach leads to more robust and accurate classification than other state-of-the-arts approaches in literature.

with regards to the actual prediction rates, the combination of digs model inferring pathway activity and 5-nn classifier offers prediction rates of above 90% for  <dig> out of  <dig> employed datasets, including singh, shipp, yao, farmer, around 80% for another  <dig> datasets, including popovici, swindell and pawitan, while still managed 70% for the last dataset desmedt. the generally high prediction rates demonstrate the applicability and efficiency of the proposed digs model in practice.

to show that the desirable prediction rates achieved by digs-based approach is not due to a specific bias of digs model with 5-nn classifier, we present the classification accuracy comparison using neural network classifiers in figure 3b. according to figure 3b, when employing neural network classifier, digs-based disease classification approach again shows great competitiveness in  <dig> binary datasets that it gives the highest classification rate in popovici; is tied as the top method in singh with single genes-based approach and in desmedt with corgs; in shipp digs trails the most accurate approach only marginally. in terms of  <dig> multiclass datasets, digs-based classification approach dominates in all of them. the same phenomenon can be observed using the other  <dig> implemented classifiers that digs model either provides competitive classification accuracies or gives the highest classification rate .

to obtain an overview of how our methodology compares across all combinations of dataset, method and classifier, we used a simple normalisation procedure where for each pair of dataset and classifier the actual prediction rates for every method is divided by the highest prediction rates achieved throughout all methods. in other words, the normalised prediction rates, scaled between  <dig> and  <dig>  reflect the relative performance of a particular method compared against the best performance across all methods for this specific combination of method and classifier. for example, on the popovici dataset with 5-nn as classifier, the highest prediction rate across all  <dig> methods  is given a score of  <dig> and for all other methods their prediction rates are divided with the highest prediction rate , to express the relative performance of that method to the best, e.g. raw prediction accuracy of  <dig> % achieved by corgs is normalised to:  <dig> %/ <dig> % =  <dig> . for each combination of method and classifier, normalised prediction rates are averaged over  <dig> binary datasets and  <dig> multiclass datasets and are shown in tables  <dig> and  <dig> respectively.table  <dig> 
mean normalised classification rates over  <dig> two-phenotype datasets according to performance



two-class
digs
sg
mean [
28
]
median [
28
]
per_pathway [
72
]
pca [
45
]
corgs [
19
]
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
the highest classification rate achieved across all competing methods is highlighted as bold for each classifier.
mean normalised classification rates over  <dig> multi-phenotype datasets according to performance



multiclass
digs
sg
mean [
28
]
median [
28
]
per_pathway [
72
]
pca [
45
]
1
1
1
1
1
1
the highest classification rate achieved across all competing methods is highlighted as bold for each classifier.



in terms of binary datasets, table  <dig> clearly indicates that digs pathway inference model comes at the top of all methods. this is true in the case of most classifiers used and it is only when using with logistic as classifier where digs is outperformed by corgs and sg. for multi-class datasets  digs is the best method throughout, indicating the strength of our proposed methodology for the most challenging cases where multiple outcomes need to be predicted. this highlights that one of the contributions of this work is to design, according to the authors’ best knowledge, the first supervised pathway activity inference method applicable to both binary and multiclass datasets.

digs release significant disease relevant pathways
besides the high classification rates achieved by the proposed digs model, we have also identified a number of breast cancer pathways that may indicate pathway biomarkers. for pawitan, where around 90% classification rates can be achieved using digs with all  <dig> classifiers, we employed an information gain feature ranking method in weka to rank the constructed pathway activities for each random training set. we record  <dig> pathways that are ranked more than  <dig> times as the most discriminative. as we have constrained the proposed digs model to allow only  <dig> genes per pathway to participant in pathway activity inference, we further extract for each identified significant pathway the set of constituent genes included in the active genes more than  <dig> times.

the set of pathways and genes that are found as most discriminant with our method are listed in the table  <dig> below. apart from obvious links to cancer pathways, such as prostate cancer, and other well-known signalling pathways that are known to be deregulated in tumorigenesis , we note deregulation of nitrogen metabolism that has recently been linked to breast cancer  <cit> . ubiquitin-mediated proteolysis is also identified, in accordance to previous reports about the importance of this pathway in disease  <cit>  and is linked to poor survival in breast cancer  <cit> . glycosylation is also known to be altered in cancer cells where overexpression of large glycoproteins such as mucins has been characterized  <cit> . enzymes from the family of galnt <dig> and galnt <dig> that we have identified were found to be elevated in breast and gastric carcinomas  <cit> . we also identify the adherens junction complex, that comprises of cadherins and the catenins, is a major adhesion structure in endothelial cells and has been implicated in playing a fundamental role in controlling the transport across the endothelial barrier and in regulating angiogenesis  <cit>  and has been shown to be affected in invasive breast cancer  <cit> .table  <dig> 
significant pathways and constituent genes identified by the proposed digs model for pawitan



pathway name
significant constituent genes


we also draw pathway activity heat maps for the significant pathways identified in pawitan. in figure  <dig>  pathway activities are inferred using all samples. pathways are clustered based on similarity of activities on euclidean distance. it is clear from figure  <dig> that pathways are divided into two main clusters, showing distinct patterns of expression. ubiquitin mediated proteolysis pathway, erbb signalling pathway, o glycan biosynthesis pathway, dorso ventral axis formation pathway and prostate cancer pathway are shown to be associated with up-regulation in luminal tumour, and down-regulation in basal tumour. the other significant pathways appear to have the opposite regulation mechanism, i.e. they are down-regulated in luminal tumour and up-regulated in basal tumours.figure  <dig> 
pathway activity of the significant pathways in pawitan. pathway activities are inferred with digs model using all samples. red/green blocks indicate up-/down- regulation of pathways  in samples . pathways are clustered according to similarity of their activities.



we repeat the same analysis of identifying significant pathways and genes for popovici dataset  <cit>  and swindell  <cit>  where desirable classification rates can be achieved. the significant pathways/genes and heat map can be accessed at additional files  <dig>   <dig>  and  <dig> 

CONCLUSIONS
incorporating pathway information as biological priors into microarray gene expression profile has been demonstrated to be a promising alternative to conventional genes-based approach in various disease classification problems. however to the authors’ best knowledge there are no supervised pathway activity inference methods for multiclass disease classification problems. in this work, a novel supervised pathway activity inference method for both binary and multiclass disease classification problems, digs, has been proposed using mathematical programming optimisation techniques. for each pathway, a new composite feature, called pathway activity, is constructed as a weighted linear summation of expressions of member genes. in each pathway the number of member genes contributing to pathway activity inference by taking non-zero weights is constrained explicitly. the proposed digs model provide three main benefits over the existing pathway activity inference methods in literature:  the weights of constituent genes in building pathway activity are optimised by digs in order to maximise the discriminative power of the pathway activity;  the maximum number of constituent genes taking non-zero weights when building pathway activity can be explicitly specified by user;  the proposed pathway activity inference model is applicable to both binary and multiclass disease classification problems.

a total number of  <dig> microarray gene expression profiles totalling  <dig> samples and ~ <dig>  genes have been used to demonstrate the applicability and efficiency of the proposed pathway activity inference scheme. the classification results show that for  <dig> two-class problems digs-based classification approaches lead to higher normalised classification performance compared to other existing pathway-based approaches as well as genes-based approaches. in terms of multiclass classification problems, mathematical programming inferring pathway activity here gives consistently the highest prediction accuracies that with the same classifier digs always outperforms others by distance.

additional files
additional file 1: 
notations for mathematical model.


additional file 2: 
sensitivity analysis of parameter 
nog
 for digs model with 5-nn , hb  and logistic regression  classifiers. for each of the  <dig> datasets, the proposed digs model is applied to infer pathway activity while setting nog, i.e. the maximum number of member genes in a pathway allowed to have non-zero weights, to  <dig>   <dig>   <dig> and  <dig>  in addition, digs model is also applied with nog set to equal to the number of available member genes in a pathway, i.e. all member genes can take non-zero weights to construct pathway activity. a classifier is trained using the pathway activity profiles and tests the prediction accuracy.

additional file 3: 
classification accuracy comparison of  <dig> competing methods using smo , hb  and logistic regression  classifiers. the proposed digs pathway activity inference method is compared against other pathway activity inference methods  and also genes-based methods . classification accuracy is summarised as average prediction rates over  <dig> runs of random partition of datasets into a 70% training set and a 30% testing set.

additional file 4: 
significant pathways and constituent genes for popovici dataset.


additional file 5: 
significant pathways and constituent genes for swindell dataset.


additional file 6: 
pathway activity of the significant pathways in swindell dataset. pathway activities are inferred with digs model using all samples. red/green blocks indicate up-/down- regulation of pathways  in samples . pathways are clustered according to similarity of their activities.



competing interests

the authors declared that they have no competing interests.

authors’ contributions

conceived and designed the experiments: ly, lgp; performed the experiments: ly, ca; analysed the data: ly; wrote the paper: ly, st, lgp. all authors read and approved the final manusrcipt.

