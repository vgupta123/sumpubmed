BACKGROUND
inferring transcriptional regulatory networks in animals is challenging. for example, the large number of genes, the spatial and temporal complexity of expression patterns, and the presence of many redundant and indirect interactions all make it difficult to learn the network. in the long term, it will be necessary to use multiple data sets--including gene expression, genome wide in vivo dna binding, and network perturbation data--to accurately represent all interactions. combining multiple data classes in this way, however, is an open and challenging problem.

an alternative, intermediate approach is to use only gene expression data to infer regulatory networks. here the relationships between the expression levels of one or more transcription factors and those of many putative target genes are used to predict which genes are the most likely targets of each factor. while much work has been done in this area, it is critical to understand the maximum amount of information that can be obtained about the network using this strategy.

typical approaches for inferring regulatory networks have been to assume a model formulation and then fit the data to this formulation  <cit> . many models have been proposed, including coexpression networks  <cit> , information-theoretic representations  <cit> , regression onto dynamical systems  <cit> , bayesian networks  <cit> , and other graphical models  <cit> , each of which has advantages and disadvantages. the primary differences between these models lie in the trade-off between statistical and interpretational issues. techniques like bayesian networks, graphical models, and information-theoretic models have protections against over-fitting ; however, these techniques do not provide dynamical models which can generate new biological insights. on the other hand, techniques such as nonlinear regression and regression onto dynamical systems provide more biologically interpretable models, but sometimes suffer from inaccurate assumptions or over-fitting of the model to the data.

there is disagreement on the necessity of dynamical  <cit>  as opposed to static  <cit>  models. we feel that dynamical models are more philosophically pleasing because regulatory networks contain temporal characteristics: for example, a protein binds to dna and initiates transcription, which eventually leads to transport of the mature mrna to the cytoplasm. yet the argument is often made that static models provide a quasi-steady-state interpretation of the network that may provide a sufficient approximation. rigorous comparison of the two approaches, however, is lacking.

dynamical modeling of animal regulatory networks has a long history  <cit> . it is a powerful approach in which researchers hypothesize a set of nonlinear, differential equations to describe the network, but it generally requires significant prior knowledge about the network. if there is insufficient biological knowledge about the network, then the structure of the equations can be incorrectly chosen. and if the model is not carefully chosen, it will have a large number of parameters, possibly leading to weak biological effects being erroneously identified as strong effects. furthermore, it is sometimes shown that a wide range of different parameter values can reproduce the biological behavior of the network, which could be taken as evidence for either network robustness or over-fitting  <cit> .

the purpose of this paper is to describe a novel approach for inferring regulatory networks from expression data, and it provides a new way to trade off statistical issues and model interpretability. we generate a quasi-genetic, formal model of regulatory networks using nonparametric ordinary differential equations  which are fit using the nonparametric exterior derivative estimator   <cit> . for these reasons, we call our method and the resulting model the node  model. our node model is similar to qualitative piece-wise linear network modeling and identification  <cit> , and we extend these models by using identification techniques that have improved statistical properties and protect against over-fitting. the nede estimator adds constraints to the identification problem by learning correlations between factors, and these constraints protect the model from over-fitting and erroneously identifying weak biological effects as strong effects. though we focus the discussion in this paper to temporal-spatial expression patterns, our node method can easily be used with time-series micro-array datasets. it is also scalable to a network sized on the order of hundreds of species.

we focus our modeling effort on the formation of eve mrna stripes during stage  <dig> of drosophila melanogaster embryogenesis. we apply our technique to this portion of the regulatory network, and compare the performance of our method to that of other more commonly used models. we show that there are significant differences in the regulatory predictions made by the node model and other commonly used models, including the fact that our technique predicts that factors frequently have both positive and negative effects on the same targets, depending on the concentration of the factor. we also show that the node model performs better than a static, spatial-correlation model.

RESULTS
our node model is a formalization of a quasi-genetic model that seeks to capture the total net effect of direct and indirect influence of each factor on a target gene, and it is generated by looking at the correlation between factor concentrations and the change in target mrna concentration over time. this is done in small windows of neighboring cells on the embryo and at different time intervals during development. by looking at the change in target mrna over time, we are able to generate a dynamic equation model that describes each factors' influence on each gene in space and time; tuning parameters for our method are selected in a data-driven manner using cross-validation . in general, the model formally predicts repression in all cases where increases in the concentration of a factor leads to a decrease in the rate of change in target mrna over time. similarly, it formally predicts activation as all instances where increasing the concentration of a factor leads to an increase in the rate of change in target mrna over time.

we applied our technique to experimental measurements, gathered by the berkeley drosophila transcription network project , of spatial and temporal expression levels of transcription factor protein and mrna in drosophila embryos  <cit> . a node model was established that describes the formation of eve mrna stripes during stage  <dig> of development using data for five transcription factors known to be responsible for initiating much of the patterning of eve: krüppel , giant , knirps , hunchback  and bicoid   <cit> . for each factor and for eve mrna, there are  <dig>  data points that represent  <dig>  cells at  <dig> time points. our technique was able to compute the model in approximately  <dig> hours on a desktop computer. the seven distinct eve mrna stripes in the measured data can be seen in figure  <dig>  where both a three-dimensional view and a two-dimensional, cylindrical projection of the embryo are shown.

model fit
we assess the fit of our node model to the experimental data both qualitatively and quantitatively. because we have an ode model that describes the formation of the eve mrna stripes, we can run a simulation of the model using only the experimentally measured eve concentration at the first time point of stage  <dig> as the initial condition of the ode. only transcription factor protein and eve mrna data from the first two time points was used to derive the node model for predicted regulatory interactions. by using this model along with the transcription factor protein expression data from all time points, we can then simulate the eve mrna pattern for all six time points and then compare this to the experimentally measured eve pattern.

qualitatively speaking, the eve mrna pattern generated by our node model simulation matches the temporal behavior of the experimental pattern quite well. the experimental and simulated eve patterns are compared in figure  <dig>  the black lines on each of the maps in figure  <dig> show the boundaries of the experimental measurements of the eve mrna stripes, and how they change location during stage  <dig>  looking first at just the experimentally observed eve mrna pattern shown in figure  <dig>  we can see that the stripe regions narrow, and eve concentration in the stripes becomes stronger. the stripes also shift anteriorly. the simulation of our node model matches this experimental behavior, and captures the changing boundaries of the eve stripes particularly well.

to quantify the accuracy of the model, the simulation error is also shown in figure  <dig>  the node model is able to accurately predict the eve pattern at stages 5:9- <dig>  5:26- <dig>  and 5:51- <dig>  its predictions are less accurate for stage 5:76- <dig> in some regions, especially in stripe  <dig>  but this is not unexpected as it is known that at the end of stage  <dig> a new set of transcription factors begin to regulate eve expression  <cit> . this could not have been learned using only data taken from early stage  <dig> as we have done here. indeed, if eve mrna expression data from all time points is used to learn the node model, better agreement is seen .

factor activity plots
the model generated by our technique can be visualized as spatio-temporal maps of factor activities. an example of a spatial map for our node model for stage 5:9- <dig> is shown in figure  <dig>  which shows how the five factors  affect eve mrna pattern formation. blue values correspond to predicted repression  and yellow/red values correspond to predicted activation .

such factor activity plots show the intensity and variation of predicted effects of factors at different locations on the embryo and at different time points. our model is a formal, quasi-genetic ode model. it is not a mechanistic model, because it cannot capture the various mechanisms involved in the regulation of eve mrna. this, however, is a strength because of the flexibility gained by not having to make a priori assumptions on the regulatory mechanisms. this comes at the cost of not being able to identify which interactions are direct or indirect.

comparison to spatial-correlation model
to aid understanding of our node model and help establish its utility, we compared it to a spatial-correlation model. such models have also been used for identifying regulatory interactions from quantitative expression data  <cit> , and are based on the descriptions of the relationship between transcription factor and target gene expression that have been most widely used by developmental biologists. these models are not dynamic and look at the correlation, at fixed time points, between factor concentrations and target mrna concentrations. to make the result comparable to our node model, we consider a new variant of spatial-correlation models which looks separately at the correlation between factor levels and target mrna levels in different, small regions of the embryo and at different stages of development.

we first compared the embryo-wide spatial maps of factor activity in figure  <dig> to that predicted by the spatial-correlation model . viewed in this way, the two models show many similarities, which is encouraging because many experimentally validated regulatory interactions have been implicitly interpreted using a spatial-correlation model, and this agreement provides mutual support both for our model and the previously determined interactions.

closer inspection, however, reveals significant differences in the precise locations of factor activity predicted by each method and, in some cases, differences in the direction of correlation at some stripes. to examine these in more detail, we next examined interactions during stage 5:9- <dig> of two transcription factors, giant  and krüppel , with part of eve stripe  <dig> that other data suggest they repress   <cit> . figure 6a shows the concentrations of gt protein  and eve mrna  along the anterior-posterior  axis, showing the classic anti-correlation of gt protein with the anterior boundary of eve stripe  <dig>  the factor activity predicted by the "spatial-correlation" model is shown as the plot of the gt correlation . in contrast, figure 6b shows gt protein  concentration; the change in eve mrna concentration over time ; and the factor activity predicted by the node model for gt protein . while both models use the same protein expression data , the concentrations of eve mrna and the temporal change in mrna  show marked differences, as do the predicted factor activity profiles . similar differences are seen for kr .

these differences raise the question: which model is more accurate and useful? to quantitatively compare the two models, we generated a spatial-correlation model which used eve mrna expression data only from stage 5:0- <dig> and stage 5:4- <dig> and used it to predict the experimental eve pattern at later portions of stage  <dig> . this spatial-correlation model much more poorly predicts the eve pattern at stages 5:9- <dig> and later.  the node model predicts an eve pattern that has 59% less error over the last four time points than the pattern predicted by the spatial-correlation model. thus, in a direct comparison of a static  model and a dynamical  model, the dynamic model is superior.

this result fits with the idea that the node model is intrinsically more biologically realistic than a spatial-correlation model. as stated earlier, biological networks are marked by temporal effects. for instance, a protein binds to dna which initiates transcription. this is not an instantaneous process, and there is some delay between when a factor initiates transcription and when the target mrna is expressed. the spatial-correlation model does not model this notion of temporal effects, whereas the node model does.

concentration-dependent effects
in many cases it is known that individual gene expression stripes can be controlled via a single cis-regulatory module  and current computational models generally assume that a given factor acts only as an activator or a repressor on a given crm . however, both our node model and our variant of the spatial correlation model frequently predict concentration dependent effects whereby, on and around the same expression stripe, a factor has both repressing and activating effects . for example, consistent with previous molecular genetic evidence, kr is predicted as a repressor of posterior eve stripe  <dig>  but is also implied by the model to be as an activator just anterior of this in cells where kr concentrations are lower . this and the many other similar cases could represent spurious correlations, perhaps due to other factors having dominant effects on targets in cells where the factor under study is expressed at lower levels. however, there are a number of cases where factors, including kr, have been shown to switch from activating to repressing the same target as their concentrations increase  <cit> . thus, the predictions of both our node model and our variant of the spatial correlation model make it more obvious that gene regulation can involve multiple mechanisms of factor action that should be considered hence forth.

in some cases, the node model predicts factor activities that are closer to biological expectations than the spatial-correlation model. figure  <dig> indicates that both models predict strong repression by gt in almost the same anterior portion of eve stripe  <dig> . on the other hand, figure  <dig> indicates that the spatial-correlation model predicts repression by kr mostly in the inter-stripe region between stripes  <dig> and  <dig>  whereas the node model predicts repression by kr in the posterior half of stripe  <dig>  since it has been experimentally observed that the eve stripes narrow over time  <cit> , and the node model more accurately indicates narrowing of the stripes, this provides further support for the idea that the node model performs better.

another significant difference between the two models is that the node model can distinguish between multiple regions of the embryo where target mrna either increases or decreases over time, whereas spatial-correlation models, by definition, cannot. this allows the node model to provide more subtle distinctions of factor activity.

we make the following formal definitions :

• type i repression - at current factor concentrations, the target mrna will decrease in concentration over time. an increase in factor concentration will lead to a faster rate of decrease in target mrna amounts over time.

• type ii repression - at current factor concentrations, the target mrna will increase in concentration over time. an increase in factor concentration will lead to a slower rate of increase in target mrna amounts over time.

• type i activation - at current factor concentrations, the target mrna will increase in concentration over time. an increase in factor concentration will lead to a faster rate of increase in target mrna amounts over time.

• type ii activation - at current factor concentrations, the target mrna will decrease in concentration over time. an increase in factor concentration will lead to a slower rate of decrease in target mrna amounts over time.

with these definitions in hand we can readily see that, for example, while kr is a repressor within the posterior half of eve stripe  <dig>  for most of this region it is a type ii repressor, acting in cells where eve mrna concentrations are increasing over time . only in the very posterior margin of this stripe does the level of eve mrna decrease. similar distinctions between the two modes of activation and repression can be seen in embryo wide plots . the distinction between type i and ii effects does not necessarily reflect different biochemical mechanisms between say, anti-activation and active repression, but equally they might. certainly, the ability of the node model to make these distinctions provides a richer understanding of the relationship between factor and target expression than spatial-correlation models.

comparison to dynamical models
it is also instructive to compare our node model to existing dynamical models of spatial pattern regulation in drosophila embryogenesis. there are dynamic models, some using nonlinear odes, that describe the developmental change in the expression of gap genes  <cit>  and the eve stripes  <cit> . some of these models only describe the network at the level of protein expression  <cit>  whereas others include more detailed processes such as protein binding  <cit> . like our model, these models can replicate experimentally measured gene expression patterns.

the models in  <cit>  are similar to our work in some regards in that they concern the network at the expression level. however, they require significant biological knowledge in order to hypothesize the structural forms of their equations, which can be problematic because this limits their ability to provide new biological insights. for instance, an a priori biological assumption made by the models in  <cit>  is that factors do not have concentration-dependent effects. a factor always either represses, activates, or does not affect the target gene. biological experiments  <cit>  and our models suggest that this is not always true.

the main disadvantage of the models in  <cit>  is that they use in vitro data in fitting models for in vivo behavior. these models contain detailed predictions of the regulatory network such as levels of protein-dna binding in vivo. this is problematic because the parameters of the models were calculated using only gene expression data and in vitro dna binding data. no comparison was made between the models' inferences and actual measurements of in vivo dna binding. work by the bdtnp shows that there is no simple correlation between in vitro affinity and in vivo occupancy, even on highly bound functional targets  <cit> . this suggests that the models in  <cit>  are unlikely to be accurate and that more quantitative data, such as chip-chip or chip-seq binding data, needs to be used to calculate the model parameters.

CONCLUSIONS
we have described a novel approach for inferring interactions within animal regulatory networks. our approach uses nonparametric statistics to generate ordinary differential equation  models from expression data, and it has certain statistical and mathematical advantages over existing approaches. it is able to generate spatio-temporal maps of factor activity, highlighting the times and spatial locations at which different regulators might affect target gene expression levels.

we identified an ode model for eve mrna pattern formation in the drosophila blastoderm, and our model was able to reproduce the experimental patterns well. it gives 59% better agreement to the experimentally measured pattern, as compared to a spatial-correlation model. our model suggests that protein factors frequently have the potential to behave as both an activator and inhibitor for the same cis-regulatory module depending on the factors' concentration, and implies different modes of activation and repression. this suggests further avenues of research.

