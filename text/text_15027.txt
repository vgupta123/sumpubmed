BACKGROUND
restriction-modification  systems were discovered and characterized as bacterial systems defending cells from an invasion of foreign dna, e.g., phage dna  <cit> . r-m systems are divided into four types   <cit> . classical r-m systems of types i–iii include a dna methyltransferase  and a restriction endonuclease   <cit> . mtase methylates specific dna sequences  in the host genome. rease recognizes the same unmethylated site and cleaves the dna. as a result, the methylated host dna remains intact whilst any foreign dna with unmethylated recognition sites is cleaved. in contrast to classical r-m systems, methyl-directed ones of type iv and iim include only reases, which cleave modified  sites preventing attacks of phages that have acquired modifications of the genomic dna as an antirestriction strategy  <cit> .

besides defence from phages, r-m systems may participate in:  containment of the horizontal gene transfer  <cit>  and maintenance of bacterial or archaeal population structure  <cit> ,  the regulation of gene expression by site methylation ,  modulation of the genome recombination  <cit> .

r-m systems are widely spread among prokaryotes: they have been found or predicted with computational methods in the vast majority of bacterial and archaeal genomes  <cit> . besides prokaryotes, r-m systems were found in chlorella viruses  and a few other eukaryotic viruses  <cit> .

acquirement and loss of an r-m system is a routine event in the evolution of most bacteria and archaea. a bacterium can occasionally acquire an r-m system with a new specificity by the horizontal gene transfer  or by the alteration of the dna recognition domain of an existing r-m system by an intragenomic recombination  or point mutations  <cit> . a large number of corrupted r-m system genes in rebase  <cit>  testify in favor of a rather frequent loss of r-m systems. it allows us to talk about their lifespan in bacteria. r-m system gain and loss is observed even on the level of strains of the same species, strains often carry different sets of r-m systems. well studied examples are neisseria meningitidis  <cit> , streptococcus pneumoniae  <cit> , helicobacter pylori  <cit> .

r-m system recognition site avoidance is one of numerous antirestriction strategies of phages  <cit> . the avoidance was revealed in many phage genomes  <cit> . a similar effect was found in prokaryotic genomes. karlin and co-workers  <cit>  supposed that the underrepresentation of short palindromes in prokaryotic genomes is associated with a selection aimed at reducing the number of restriction sites. it was shown that some palindromes are the most underrepresented “words” among all possible “words” of certain length in a genome. the known sites of r-m systems were often found among the most underrepresented palindromes . the avoidance of r-m system sites was explained by occasional failure of site methylation resulting in dna cleavage at this site. in the light of recent data on the modulation of gene expression by r-m systems  <cit> , it is possible that unfavorable methylation of particular sites could also provoke their removal.

in this work we study recognition site underrepresentation for thousands of r-m systems in thousands of prokaryotic genomes. all data on cleavage sites of reases were obtained from rebase  <cit> . underrepresentation of the sites was estimated in those genomes that encode corresponding r-m systems. such site-genome pairs are called ‘actual pairs’. we found two factors, r-m system type and its lifespan, that seem to be the most essential and can basically explain statistical data on site underrepresentation.

methods
r-m system recognition sites
the list of studied r-m systems recognition sites is available in additional file  <dig>  this list consists of  all recognition sites of restriction endonucleases  from rebase  <cit>  and  all 4 bp and 6 bp palindromic sequences that are not in the above list from rebase . each considered site was attributed to one of six groups corresponding to r-m system types: type i, type iic/g, type iim, type ii except iic/g and iim, type iii, and type iv. type ii r-m systems except type iic/g and iim ones are called “orthodox” here for shortness. note that our “orthodox” sites include both palindromic and non-palindromic recognition sites, in contrast to the terminology used by pingoud et al.  <cit> . ten added palindromes are considered as sites of orthodox type ii r-m systems because the majority of non-degenerate palindromes of length four and six belong to this type. statistical data on recognition sites are shown in table  <dig> table  <dig> statistical data on recognition sites of r-m systems of different types. numbers of degenerate sites are shown in parenthesis



in  <dig> cases the same nucleotide sequence can be a recognition site of reases of different types. sites of orthodox type ii reases that are at the same time sites of reases of type i , type iic/g , type iim , or type iii  are counted in table  <dig> as orthodox type ii. two sites of type iic/g reases that are also sites of type iii reases are counted as type iic/g.

recognition sites can be non-degenerate  or degenerate .

genomic sequences
in rebase genome section  <cit> , a list of r-m systems is available for several thousand prokaryotic genomes. in this work, we used only genomes with assembled chromosomes according to ncbi genome assemblies information  <cit> . the used genome set includes  <dig> genomes of bacteria and  <dig> genomes of archaea. these genomes belong to  <dig> species of  <dig> genera. sequences of the genomes were downloaded from genbank  <cit> , totally  <dig> sequences of chromosomes and plasmids. the list of all sequence ids is available in additional file 2; in that list, genomes encoding no r-m systems are marked “no” in the column “genome with r-m systems”. in this paper “genome” means sequences of all chromosomes and plasmids of a certain organism.

according to rebase   <dig> bacterial and  <dig> archaeal genomes from our genome set encode at least one r-m system and  <dig> bacterial genomes and one archaeal genome encode no r-m systems.

genomes of eukaryotic viruses were downloaded from ncbi  <cit> , the list of all sequence ids is available in additional file  <dig>  three groups of viruses, chlorella viruses, marseilleviridae viruses and phaeocystis globosa viruses, encode r-m systems. in the list, these viruses are marked “yes” in the column “encodes r-m system”.

datasets of site-genome pairs
to study underrepresentation of r-m system recognition sites in corresponding genomes we used the following datasets. the first set, the actual pairs dataset, consists of all site-genome pairs where  the site and the prokaryotic genome are listed in the additional file  <dig> and additional file  <dig> correspondingly and  the genome encodes a rease that recognizes the site. in this paper, such sites are called ‘actual’ for the genome. the actual pairs dataset is available in additional file  <dig>  the list includes  <dig> bacterial and  <dig> archaeal site-genome pairs.

an r-m system recognition site can be experimentally proven as well as predicted by rebase. a predicted r-m system may be inactive or recognizing another site than predicted one  <cit> . we analyzed separately the dataset of experimentally proven pairs. the site-genome pair is considered to be experimentally proven if  the genome encodes an r-m system that is included in “gold standard set” of rebase  <cit>  and recognizes this site, or  for the genome there are data on restriction site methylation obtained by pacific biosciences smrt sequencing  <cit>  and the methylation level of the site is above 50 %. the dataset of experimentally proven pairs is a subset of the actual pairs dataset and is marked in additional file  <dig> 

to verify the results obtained for the actual pairs dataset we have also prepared two negative control datasets, namely the viral control dataset and the prokaryotic control dataset.

the viral control dataset consists of all recognition sites of r-m systems and all available sequences of eukaryotic viruses  except the viruses that encode r-m systems . we analyzed all possible pairs of viral genomes with restriction sites from additional file  <dig>  eukaryotic virus genomes were used here as a negative control because eukaryotic viruses meet no r-m systems in their life. nevertheless, usage of this set as a control dataset has some limitations. viral genomes are significantly shorter than prokaryotic ones that may affect the statistical results. even more important is a potential influence of certain other inevitable factors, differentiating viruses and prokaryotes.

the prokaryotic control dataset consists of all site-genome pairs where the site is listed in additional file  <dig> and the genome is in additional file  <dig>  the actual pairs dataset is the subset of the prokaryotic control dataset. moreover, some pairs from the prokaryotic control set may correspond to sites of yet unknown r-m systems. however the fraction of such pairs is negligibly small. we estimate it to be less than 1 % because about six hundred sites in each genome are included in the prokaryotic control dataset whilst there are only  <dig>  r-m systems per genome on average according to data of oliveira and co-workers  <cit> , and  <dig>  r-m systems according to our data.

the subset of site-genome pairs from the prokaryotic control dataset with genomes encoding no r-m systems have advantages of both control sets. presumably, ancestors of these prokaryotes also met no r-m systems. at the same time, these genomes are prokaryotic genomes and thus have prokaryotic features that could affect sites number. however, this control set is much smaller than the prokaryotic control dataset , that is why we mostly use the latter one in this work.

measurement of deviation of site occurrences number
deviation of number of site occurrences was measured by the ratio kr of the observed number of sites to the expected number. we used a formula suggested by karlin et al.  <cit>  for calculation of the expected number of sites. see  for the formula for kr. also we calculated an analogous value mr using another method, namely the maximum order markov model  <cit> . comparing distribution of two values for the control sets we found that the variance of kr is less than the variance of mr . due to this observation and other arguments  we choose kr as the main measure of deviation.

thresholds of under- and overrepresentation
we used the two-sample kolmogorov–smirnov test to compare distributions of kr in two sets of site-genome pairs.

to obtain numbers of under- and overrepresented sites in different datasets we used as the first choice the kr value cutoffs according to  <cit> :  <dig>  for underrepresentation and  <dig>  for overrepresentation. we roughly estimate percents of sites over- and underrepresented due to other causes besides r-m system influence as 1 % by comparison with the viral control dataset. indeed, we found that  <dig>  % pairs of the viral control dataset have kr ≤  <dig>  and  <dig>  % pairs have kr ≥  <dig> . in the subset of site-genome pairs from the prokaryotic control dataset with genomes encoding no r-m systems there are  <dig>  % of underrepresented sites with this threshold.

the thresholds of underrepresentation were adjusted for particular subsets of site-genome pairs .

χ <dig> test or exact fisher test were used for comparison of fractions of underrepresented sites in datasets.

in our work we considered only site-genome pairs for which the expected number of the site occurrence in the genome is more than  <dig>  if the expected number of sites is small, then the ratio of the observed number of sites to the expected number of sites may be unreliable and thus should not be considered. to find the threshold for the expected number we performed the following procedure. for each range of expected number of sites we estimated the standard deviation of kr by comparison of kr value for each non-palindromic site with the same value for the complementary site. all recognition sites in all prokaryotic genomes with the expected number of sites within ranges  <dig>  to  <dig> ,  <dig>  to  <dig> , etc. were considered. we found that starting from the range of  <dig>  to  <dig>  the standard deviation is less than  <dig>  and decreases for larger expected numbers of sites. thus if the expected number of sites is  <dig> or more, then the probability to observe kr <  <dig>  by chance is less than  <dig> , and decreases rapidly.

identification of putative horizontally transferred restriction endonuclease genes
putative horizontally transferred dna fragments of prokaryotic chromosomes were predicted by alien_hunter program with default parameters  <cit> . this program returns a score threshold and, for each putative horizontally acquired dna, its coordinates and score. the score reflects the compositional deviation of putative horizontally transferred fragments from the genome background. a higher score corresponds to a more atypical fragment. we used scores over the threshold as a measure of reliability for detection of alien fragments.

the coordinates of rease genes were compared with coordinates of the obtained putative horizontally transferred fragments. if such fragment overlaps an rease gene, then we marked the gene as a putative recently acquired one and assigned the score of the fragment to the site-genome pair, where the site is the rease recognition site. if the genome encodes two or more reases recognizing the same site, then the minimum of their scores was assigned to the site-genome pair .

RESULTS
avoidance of restriction sites in prokaryotic genomes depends on r-m system types
taking into account different molecular organization of r-m systems and mechanisms of site recognition by reases, we classified the sites by the type of corresponding r-m systems  and analyzed site-genome pairs with the sites of each type in each dataset separately.

the sites of type ii reases were subdivided into type iic/g, type iim and the rest called ‘orthodox’ . type iim sites were considered separately because type iim reases cleave only modified sites and are comparable to type iv reases in that regard  <cit> . in contrast to orthodox r-m systems, type iic/g systems consist of a single protein that combines endonuclease, methyltransferase, and dna recognition functions. therefore type iic/g r-m systems are similar to type i and type iii by structural and functional organization  <cit> .

percentages of site-genome pairs with the underrepresented sites for different r-m system types are shown in table  <dig>  underrepresentation is stated if kr is less or equal to  <dig> . we observed site avoidance in the actual pairs dataset only for orthodox type ii sites and for gatc site of type iim methyl-directed reases, which is underrepresented in  <dig> of  <dig> cases. nearly full avoidance of gatc site in this case is surprising, since methyl-directed r-m systems are presumably not deleterious for a bacterial genome if it is not methylated. we consider possible causes of gatc avoidance in discussion.table  <dig> percentage of underrepresented sites of different types in the different datasets

38/54a

aall  <dig> underrepresented sites are gatc



eukaryotic viruses do not meet any r-m systems in their life usually and do not avoid any r-m system sites, see table  <dig>  however several eukaryotic viruses, i.e. chlorella viruses, marseilleviridae viruses and phaeocystis globosa viruses encode orthodox type ii r-m systems. in these viral genomes the sites of the corresponding r-m systems are underrepresented in 47 % cases  .

in the prokaryotic control dataset, we analyzed the subset with genomes encoding no r-m systems at all. in this subset, sites of all r-m systems are underrepresented in only  <dig>  % of all site-genome pairs and in  <dig>  % site-genome pairs with orthodox sites.

figure  <dig> presents histograms of kr for two subsets of the actual pairs dataset. the first subset consists of all site-genome pairs with orthodox type ii sites  and the second one consists of all pairs with sites of types i, iic/g and iii grouped together . histograms of kr for prokaryotic and viral control datasets with the corresponding sites serve as a control.fig.  <dig> histograms of kr for various sets of site-genome pairs. there are  <dig> equal bins at the segment [0; 2), the percent of site-genome pairs with kr falling into a bin is shown over its middle. a blue dotted line shows the distribution for actual pairs of orthodox r-m-systems; green dashed line is for the subset of orthodox site-genomes pairs of the prokaryotic control set; red solid line is for the similar subset of the viral control set. b blue dotted line shows the distribution for actual pairs of r-m-systems of types i, iic/g, and iii together; green dashed line is for the subset of non-orthodox site-genomes pairs of the prokaryotic control set; red solid line is for the similar subset of the viral control set. in both cases the cutoffs for under- and overrepresentation are shown by solid vertical lines



the histogram of kr for actual pairs with orthodox sites drastically differs from the histograms for both control sets ; the latter ones basically coincide in the underrepresentation area. note that in the figures  we restricted control sets to subsets of site-genome pairs with sites of considered groups . the difference between the kr histograms for actual dataset of orthodox sites and the prokaryotic control dataset is especially demonstrative because both the list of sites and the list of genomes are the same. the only difference is that in the case of the prokaryotic control dataset all site-genome pairs are examined while in the case of the actual pairs dataset the genome is required to encode a rease recognizing this site.

although the prokaryotic control dataset includes a certain fraction of actual pairs, this fraction is negligibly small  and thus the corresponding histogram well approximates kr distribution for non-actual pairs in the case of prokaryotic genomes.

we found a site avoidance in  <dig>  % actual pairs with orthodox sites . in the prokaryotic control dataset we found orthodox site avoidance only in  <dig>  % cases. many of these cases might be traces of lost r-m systems . the kr distribution for the subset of prokaryotic control dataset with genomes encoding no r-m systems is similar to that of the entire prokaryotic control dataset . however, there are significantly less underrepresented site-genome pairs in the subset of site-genome pairs lacking r-m systems, namely  <dig>  % vs  <dig>  % in the entire prokaryotic control dataset for kr <  <dig>  threshold.

in contrast to orthodox type ii r-m system sites, kr distribution for the joined subsets of the actual pairs of types i, iic/g, iii practically does not differ from the distribution for the corresponding subset of the prokaryotic control dataset . a certain difference between the histograms in the area  <dig>  < kr <  <dig>  is observed. we found that this difference is due to the contribution of only one site cagag of type iii reases from  <dig> salmonella enterica strains. no significant difference was found between the histograms of the non-orthodox pairs  in the actual pairs dataset and the prokaryotic control dataset in the area of underrepresentation .

our list of actual pairs includes a large amount of sites of predicted r-m systems. to estimate the effect of misannotation of sites, we analyzed site avoidance in the experimentally proven dataset. we found  <dig>  % cases of site underrepresentation in the experimentally proven dataset with orthodox type ii r-m systems site. this value is close to  <dig>  %, the overall percent of avoidance cases of the orthodox type ii r-m systems sites in the actual pairs dataset . thus despite the fact that our set of annotated sites could contain some mispredictions, their influence on the results of recognition site avoidance seems to be negligible.

underrepresentation of palindromic and non-palindromic sites
it was shown  <cit>  that palindromes are the most underrepresented short words in a prokaryotic genome. this effect was mainly explained by r-m system presence because the recognition sites of the majority of orthodox reases are palindromes  <cit> . however even for control sets kr distribution for palindromic and non-palindromic sites are different .fig.  <dig> 
kr distributions for palindromic  and non-palindromic  sites of orthodox r-m systems for the prokaryotic control dataset



to compare the fractions of underrepresented palindromic and non-palindromic sites, this difference evidently should be taken into account. we consider kr threshold tpal for palindromes comparable with kr threshold tn/pal for non-palindromic sites if the fractions of underrepresented sites in the corresponding control datasets are equal; let us denote this common fraction by f. the fraction f can be considered as a fraction of false positives, i.e. sites underrepresented for reasons not related to r-m system presence in the genome. thus, the difference ypal = fpal– f , where fpal is the fraction of underrepresented sites in actual palindrome dataset, is an estimation of the fraction of sites underrepresented due to r-m system presence in a genome. the analogous value yn/pal is defined for the non-palindromic actual dataset. figure  <dig> demonstrates that fractions of underrepresented sites in actual palindromic and non-palindromic datasets nearly coincide. fluctuations of the graph yn/pal are likely caused by a rather small amount of actual site-genome pairs with non-palindromic sites .fig.  <dig> graphs of site avoidance due to r-m system presence for palindromic  and non-palindromic  sites. fraction f of underrepresented sites in a subset of the prokaryotic control dataset  is on the x axis. the difference between percentage of underrepresented sites in the corresponding actual dataset and the false positive rate is on the y axis. at each point of the graphs, kr threshold for underrepresentation is fixed at the value giving f of underrepresented sites in a control dataset



false positive rate f  =  <dig>  % corresponds to the already used kr threshold tpal =  <dig>  for palindromes and tn/pal =  <dig>  for non-palindromic sites . using these thresholds, we obtained  <dig>  % underrepresented pairs in the dataset of actual pairs with non-palindromic sites and  <dig>  % underrepresented actual pairs with palindromic sites.fig.  <dig> 
kr distributions for palindromic  and non-palindromic  orthodox r-m system sites. histograms for the prokaryotic control dataset are shown with dashed red  and blue  lines, for the actual pairs dataset with dotted orange  and green  lines. kr thresholds are marked by vertical lines. the prokaryotic control datasets are the same as in fig. 2




we conclude that the fractions of orthodox recognitions sites avoided due to r-m systems presence in the genome are the same for palindromes and non-palindromes. at the same time palindromes generally are underrepresented in a greater degree than non-palindromes perhaps due to reasons that do not concern r-m systems.

other site peculiarities
we found no considerable difference in the avoidance for sites of different length or degeneracy.

there are a number of particular sites with outlying behavior. for example, there is only one site ctag that is underrepresented in the majority of tested genomes . this phenomenon was described earlier , see also discussion. at the same time there are  <dig> orthodox recognition sites underrepresented in the majority of those genomes where an r-m system with this site is annotated. other outliers are ccgg and gatc .

influence of lifespan of r-m systems on palindromic site underrepresentation
the reduction of the number of recognition sites in a prokaryotic genome needs many generations. thus the influence of recently acquired r-m systems on the number of recognition sites can hardly be detected. this assumption was discussed in literature  <cit>  and confirmed by seshasayee et al.  <cit> .

as it is shown above, the underrepresentation is observed almost only for orthodox type ii r-m systems, and we limited our analysis to such systems. to avoid the input of uneven distributions of kr for palindromic and non-palindromic sites, we analyzed only palindromic sites because there are few non-palindromic sites for a detailed statistical analysis. to avoid any influence of site length, we considered only 4–6 bp palindromic sites, because they constitute the majority of all palindromic sites. totally  <dig> site-genome pairs were taken for the analysis.

it is impossible to directly measure the lifespan of an r-m system. thus we used the following indirect approach. we divide  all actual site-genome pairs into two groups, where one group is presumably enriched with the sites of recently acquired systems and the other one is enriched with sites of long-lived in the genome r-m systems. the increase of fraction of underrepresented r-m system recognition sites in the ‘long-lived’ group can be considered as an evidence of the role of the lifespan of r-m systems.

we considered three ways to divide actual site-genome pairs into two groups. first, we separated r-m systems encoded on plasmids from chromosome-encoded ones. significant fraction of plasmids are commonly horizontally transferred. among them there are conjugative plasmids as well as non-conjugative ones  <cit> . thus we may assume that plasmid-encoded r-m systems are enriched with recently acquired ones due to plasmids interventions into bacterial populations. the second way is to pick out chromosome-encoded r-m systems that are found in many related genomes; such systems are presumably long-lived. the third way is to take into account the difference of nucleotide composition in chromosome fragments encoding the r-m system from the average genome composition. genes disposed in a fragment with a contrasting composition are likely to be recently horizontally transferred. the influence of the lifespan of an r-m system on the number of its recognition sites was observed for all above ways of division.

plasmid-encoded r-m systems vs. chromosome-encoded ones
we compared percentage of underrepresented sites in prokaryotic genomes for plasmid-encoded and chromosome-encoded r-m systems in the actual pairs dataset. the sites of plasmid-encoded r-m systems are avoided in corresponding bacterial genomes more rarely than of the chromosome-encoded ones:  <dig>  %  and  <dig>  %  respectively  . this result is in agreement with the assumption that sites of recently acquired r-m systems are less underrepresented .fig.  <dig> sites representation of both recently acquired and old r-m systems in the actual site-genomes pairs dataset. percentages of underrepresented, normally presented and overrepresented sites of:  plasmid-encoded and chromosome-encoded r-m systems,  rare and common r-m systems among chromosome-encoded ones,  r-m systems encoded in genomic fragments with various ratios of score to threshold calculated with alien_hunter program, among chromosome-encoded that are neither rare nor common ones. np is for r-m system genes encoded in the genomic loci that are not predicted by alien_hunter as putative horizontally transferred ones. blue color denotes underrepresented pairs , grey color is for overrepresented pairs, pairs with kr between  <dig>  and  <dig>  are in white. helicobacter pylori genomes were excluded from the histograms 



rare systems vs. widespread ones
some r-m systems are encoded in the majority of strains of one species, other ones are encoded only in a few strains. we consider a chromosome-encoded r-m system as rare if r-m systems with the same specificity are annotated in less than 25 % species strains. r-m systems that are annotated in more than 75 % species strains are considered as widespread ones. only species with five or more strains were analyzed. helicobacter pylori strains were excluded from the analysis and analyzed separately .

for 4–6 bp palindromes that are the sites of chromosome-encoded orthodox type ii systems in the actual pairs dataset we compared percentage of avoided sites in genomes for rare and widespread systems. sites of rare r-m systems are avoided in  <dig>  %  of cases, while the sites of widespread ones are avoided in 100 %  of cases  .

h. pylori is an exception from the rule: in the actual pairs dataset the sites of rare r-m systems are avoided in  <dig>  % of  <dig> cases, while the sites of widespread r-m systems are avoided in only  <dig>  % of  <dig> cases. moreover,  <dig>  % sites of widespread r-m systems in the actual pairs dataset are even overrepresented. h. pylori strains are known outliers with respect to r-m systems  <cit>  .

recently horizontally acquired r-m systems
the comparison of rare and widespread r-m systems provides the evidence in favor of a high rate of site avoidance for ancient r-m systems, but the analysis concerned a small fraction of the available data, that is  <dig> actual site-genome pairs of  <dig> ones with chromosome-encoded r-m systems. for the rest  <dig> chromosome-encoded actual site-genome pairs we used alien_hunter program  <cit>  for a prediction of reases encoded on chromosome regions of ‘alien’ origin. we found that recognition sites of type ii reases encoded in a genomic fragment with greater composition bias according alien_hunter are underrepresented in the entire genome less often . the relatively low sensitivity of the program  should be taken into account for a correct interpretation of this result.

these results confirm the assumption about the linkage between site underrepresentation and the lifespan of r-m system genes in a genome.

helicobacter pylori strains deviate from the trend. sites of r-m systems, encoded on putative recently acquired genome fragments  are underrepresented in  <dig>  % cases . sites of r-m systems encoded in the genome fragments that do not differ from the background are underrepresented in  <dig>  % cases  and are overrepresented in  <dig>  % cases .

traces of lost r-m systems
prokaryotes often avoid the sites of r-m systems that are encoded in the genomes of their closest relatives, but not in their own genomes . sites of r-m systems that are not encoded in the genome but encoded in chromosomes of other strains of the same species are underrepresented in  <dig>  %  of cases, and those encoded in chromosomes of other species of the same genus in  <dig>  %  of cases, as compared to  <dig>  %  of underrepresented cases for all 4– <dig> length palindromes in all prokaryotic genomes from the prokaryotic control dataset. in other words, closely related genomes share similar underrepresented sites pattern regardless of encoded r-m systems. these results confirm earlier discussed assumptions  <cit>  that the site avoidance could be a vestige of lost r-m systems.fig.  <dig> representation of sites in genomes for cases the r-m system encoded only in related genomes. only 4–6 bp palindromic recognition sites of orthodox type ii r-m systems are considered. a
kr distributions for site-genome pairs. blue dotted line is for pairs of the actual pairs dataset, red solid line is for pairs of the prokaryotic control dataset. green dash-dotted line is for sites of r-m systems that are not encoded in the current genome, but are present in some strain of the same species. orange dashed line is for sites of r-m systems that are not encoded in any genome of current species, but are present in some species of the same genus. b percentages of site representation. colored part of stacked column denotes underrepresented sites, grey part of stacked column is for overrepresented ones, white part of stacked column corresponds to pairs with kr for the site between  <dig>  and  <dig> . colors correspond to . legend: act — actual pairs, sp — actual in another strain of the same species, gn — actual in another species of the same genus, ctr — the prokaryotic control dataset



we similarly analysed  <dig> actual site-genome pairs of plasmid-encoded r-m systems. these r-m systems belong to  <dig> species of  <dig> genera. among them  <dig> r-m systems are encoded in species that have one strain with the plasmid-encoded r-m system and other strains without this r-m system. for  <dig> of them corresponding sites are underrepresented in only  <dig>  %  strains without the r-m system. two remaining plasmid-encoded r-m systems, ecoce10orf1p and ecoo26orf5p, belong to e. coli strains. sites of ecoce10orf1p are not avoided in any strain not encoding this r-m system. sites of ecoo26orf5p are avoided in all  <dig> e. coli strains while the plasmid encoding it is known only for one strain.

it is likely that r-m systems encoded on mobile plasmids typically have short lifespans and do not leave noticeable traces in visited genomes. at the same time, certain plasmids are long-living and not mobile  <cit> ; the plasmid encoding ecoo26orf5p could be of such kind. thus these results are also in agreement with the lifespan influence on the site avoidance.

it should also be noted that according to our data there are much more underrepresented sites than annotated r-m systems per genome in the prokaryotic control dataset. this can be partly explained by unannotated r-m systems and partly by traces of lost r-m systems.

we estimated roughly the fraction of avoided sites which are the traces of lost orthodox r-m systems. in prokaryotic genomes that do not encode any r-m systems only  <dig>  % of all  <dig> orthodox site-genome pairs are underrepresented. this percentage allows us to estimate the site avoidance which results from other reasons than r-m systems. if so, the majority of underrepresented sites in the prokaryotic control dataset are traces of lost r-m systems. thus the avoidance of the sites of lost r-m systems is widely spread in prokaryotic genomes.

site overrepresentation
we found  <dig> cases of overrepresentation of orthodox type ii r-m systems sites in the actual pairs dataset . in  <dig> of these cases the site is ccgg and the genome is one of genomes of helicobacter genus .

activity of r-m system genes recognizing ccgg site was proven to a restricted number of h. pylori strains. rease activity was shown in h. pylori strain atcc  <dig>  <cit> ; the activity of mtase was shown in h. pylori strain j <dig>  <cit> . the corresponding genes are inactive in h. pylori strain  <dig>  <cit> . although other h. pylori r-m genes recognizing ccgg in our dataset are marked ‘predicted’ in rebase, the great number of them suggests that overrepresentation of ccgg sites is unlikely to be associated with inactive r-m systems.

overrepresentation of ccgg sites might be explained by a positive effect of their methylation with mtases that overrides negative effect of probable dna cleavage with reases. one of possibilities for the positive effect of the methylation is an influence on the gene expression. a correlation between the methylation and the regulation of gene expression was studied by vitoriano et al.  <cit>  for 30 h. pylori strains. the site ccgg was not found among the sites whose methylation status affects gene expression  <cit> .

thus we have no reasonable biological explanation for ccgg overrepresentation in the h. pylori genomes.

discussion
the avoidance of palindromic restriction sites in prokaryotic genomes was demonstrated earlier for several dozens of r-m systems  <cit> . here we present, for the first time, the results of a full-scale analysis of the phenomenon. importantly, the current amount of r-m systems with annotated restriction sites exceeds  <dig> in rebase. thus we were able to study the avoidance of restriction sites directly and systematically, no matter how long are they, are they degenerate or not, palindromes or not. this is in contrast to the previous works, where restriction sites were selected from the lists of avoided non-degenerate palindromes  <cit>  or words of certain length  <cit> .

methods of site avoidance detection and estimation can significantly influence the results of the analysis  <cit> . all of them are based on the comparison of the number of occurrences of an examined word in a genome with the statistically expected number of its occurrences. various methods for the estimation of an expected number of word occurrences were used in literature. simpler methods consider base composition only  <cit> , more sophisticated ones take into account a number of occurrences in a genome of certain subwords of the word  <cit> . elhai  <cit>  compared these methods applied to e. coli genome and concluded that the results of different methods can greatly vary from each other, and karlin’s method  <cit>  is more reliable.

we have additional arguments to use karlin’s method in our work. this method takes into account frequencies of all subwords including degenerate ones. this approach seems to be appropriate for studying r-m system recognition sites because half of them are degenerate. higher precision of karlin’s method in comparison with the commonly used method based on maximal order markov model  <cit>  is indirectly confirmed by less variance of the expected to observed number ratio for the former .

as a measure of site underrepresentation  we used the ratio kr of the observed number of sites to the expected one according to karlin’s model. we presume that the ratio is a better measure of selection pressure than used in a number of works  <cit>  p-value because the latter significantly depends on genome size. at last, it is not possible to compute p-value for the deviation of the observed number of sites from the expected one according to karlin’s method because, as far as we know, no mathematical results on this subject were published.

like in previous works, we consider r-m site avoidance  in the case of site underrepresentation, i.e., if the kr value is less than a threshold. certainly, the threshold choice influences the fraction of underrepresented sites in the cohort of site-genome pairs under our study. the usage of control datasets allowed us to substantiate the choice and also to estimate the fraction of false positives among the cohort of underrepresented sites.

our approach can not detect site avoidance for the r-m systems recently transferred into host genome or changed their specificity, because the kr value clearly depends on selection pressure as well as on the lifespan of an r-m system.

we found the avoidance for the sites of orthodox type ii r-m systems approximately in half of the cases. no avoidance was observed for non-orthodox sites, i.e., the sites of type i, type iii and type iic/g and methyl-directed type iim and type iv, except of the gatc site of type iim r-m systems and cagag of type iii r-m systems.

site avoidance in prokaryotic genomes for orthodox r-m systems agrees with our expectations and results of previous works  <cit> . this effect was attributed to cleavage of prokaryotic dna by restriction endonucleases due to incomplete methylation of dna sites . on the other hand, genome methylation by methyltransferases from r-m systems can affect gene expression  <cit> . thus it is likely that selection is addressed primarily against recognition sites, methylation of which is unfavorable for bacteria.

the absence of site underrepresentation is surprising for non-orthodox non-methyl-directed r-m systems. indeed, all types of r-m systems  are well known to be toxic for unmethylated foreign dna  <cit> . so a similar self-toxicity could be expected for all types of r-m systems.

we hypothesize that both less self-toxicity and shorter lifespan of non-orthodox r-m systems contribute to the failure to detect site underrepresentation. first, restriction endonucleases from non-orthodox r-m systems become active only in complex with cognate mtases. thus in the case of mtase failure  the only consequence is the loss of defence function. in contrast, reases and mtases of orthodox type ii r-m systems act independently from each other. thus mtase failure results in cleavage of the prokaryotic dna by the corresponding rease. it makes the orthodox type ii r-m systems more toxic for a prokaryotic host. we conclude that non-orthodox r-m systems could be considered less self-toxic.

second, non-orthodox r-m systems utilize the same dna recognition domain for both endonuclease and dna methyltransferase complexes. therefore, the change of their recognition sequences is due to mutations in the single dna recognition domain. consequently, an active r-m system is retained  <cit> . mechanisms for frequent and even programmed  specificity changes were shown for type i and iii r-m systems  <cit> . fast recognition site evolution of type iic/g and type iv genes was also shown  <cit> . in contrast, orthodox type ii r-m systems require two simultaneous concordant mutations in two different genes  for coordinated change of their specificity. thus, specificity changes seem to be much rarer for orthodox r-m systems than for all others. as a result, selection has more time to eliminate the sites of orthodox r-m systems than of non-orthodox ones.

in the attempt to explain the drastic difference of site underrepresentation among orthodox r-m systems we examined the role of site features, their palindromicity, length and degeneracy, because the sites of r-m systems of different types can be distinguished by these parameters.

in our dataset 90 % sites of orthodox r-m systems are palindromes. considering palindromic and non-palindromic sites of orthodox r-m systems separately, we found that among  <dig> non-palindromic sites of orthodox r-m systems the percentage of the avoided sites is almost the same as among palindromic ones. note that kr thresholds were chosen separately for palindromic and non-palindromic sites because palindromic sequences are more underrepresented than non-palindromic ones, regardless of the existence of active r-m systems in genomes .

we found that orthodox r-m system sites of a half of actual site-genome pairs are underrepresented in the corresponding genomes. hence sites of the other half of pairs are not underrepresented.

most likely the majority of non-underrepresented sites of actual site-genome pairs are the sites of recently acquired r-m systems. a lot of time is required for the site underrepresentation to become detectable. a smaller fraction of underrepresented sites of r-m systems in horizontally transferred regions  was shown in the work  <cit> .

in this work we demonstrated that the frequency of underrepresentation for orthodox r-m system sites in the datasets presumably enriched with recently acquired r-m systems  is two-three times lower. especially demonstrative is the 100 % site avoidance detected in the group of 4–6 bp length palindromic sites of the orthodox r-m systems that are chromosome-encoded in the majority of strains of a species. it is likely that in these cases the r-m systems were at least in the common ancestor of strains and thus lifespan of these r-m systems is rather long. this observation confirms that a significant part of non-underrepresented sites of the orthodox r-m systems could be the sites of recently acquired r-m systems. there should be a certain caution in the interpretation of this data as the number of cases in the group with 100 % site avoidance is only  <dig> 

some other reasons for non-underrepresentation of orthodox r-m system sites should also be taken into account. it is well known that reases differ in their efficiency, therefore selection pressure against the sites may vary significantly. for example, bbriii is about  <dig> times more effective than bbri  <cit> . besides, self-toxicity may depend on specific properties of sites distribution in a genome. in several cases, reases efficiency can depend on the number of restriction-modification sites, for example ecl18ki, ecorii, etc. are more active when dna possesses several restriction sites  <cit> . for several reases such efficiency depends on the site context  or peculiarities of sites distribution between dna chains  <cit> .

we also found a large amount of cases when a site is avoided in a particular genome while an r-m system with this site is not encoded in this genome. in many cases such system is encoded in a closely related genome, and we may assume that the r-m system was recently lost by the organism. these data confirm that some underrepresented sites are the vestiges of lost r-m systems . we speculate that the majority of underrepresented sites could be traces of lost orthodox r-m systems.

based on our data we propose the following model of r-m system effect on the number of its site in a bacterial or archaeal genome .fig.  <dig> model of r-m system influence on the underrepresentation of its site. a denotes the moment of acquiring a new r-m system. b is the persistence period of the r-m system in the genome, which leads to the underrepresentation of its site. c is the period after the loss of the r-m system. the red circle is for r-m system genes, the blue line is for the genomic dna, the dashed blue line is for the genomic dna that lost some recognition sites of the r-m system



acquiring a new r-m system a bacterium gets the effective defense tool against bacteriophages. due to this advantage the r-m system spreads fast in the bacterial population. at the same time the r-m system self-toxicity results in the decrease of the restriction site number in the host genome. the same process of restriction sites elimination may occur in phage genomes, probably in parallel with obtaining or adjusting other antirestriction mechanisms.

long term bacterium – phage – r-m system coevolution and arms race result in their mutual adaptation. as soon as the phage has adapted to the r-m system, this system does not defend the bacterium anymore and becomes useless  <cit> . the lifetime of useless genes in bacterial genomes is relatively short  <cit> . thus the genes of the r-m system that has become ineffective would soon be corrupted and lost. however, the r-m system recognition site avoidance would remain in the bacterial genome for a long time.

the decrease of the number of r-m system recognition site occurrences in a genome requires a huge amount of generations. a restoration of site occurrence number after a loss of an r-m system is an even longer process. its duration is likely to be similar to the time of the base composition restitution of horizontally transferred genes. lawrence and ochman estimated this time to be on the order of magnitude of hundred million years  <cit> .

it is of special interest to analyze the outliers with specific features among restriction sites. the gatc site is the only underrepresented site among the sites of methyl-directed r-m systems. gatc is known to be the recognition site of a number of iim reases  as well as of many orthodox type ii r-m systems. this site is underrepresented in most genomes  where corresponding methyl-directed r-m systems are encoded. surprisingly, gatc avoidance in a genome carrying type iim r-m system is often accomplished with the presence of gatc-recognizing orthodox type ii r-m system genes in other strains of the same species  or genus .

for example, in s. pneumoniae there are strains encoding dpnii-like r-m systems, which cleave unmethylated gatc and methylate their own dna, as well as strains encoding type iim dpni-like r-m systems, which cleave methylated gatc  <cit> . such complementary dpni/dpnii-like systems can defend mixed bacterial population from phage attacks more effectively  <cit> .

however, such systems might prevent dna exchange between strains with the different methylation status of gatc. to facilitate horizontal gene transfer, genomes of s. pneumoniae with type ii dpnii-like r-m system encode an additional methyltransferase, which methylates gatc in the single-strand dna and thus prevents degradation of the acquired unmethylated dna  <cit> .

we suppose that the gatc avoidance also facilitates dna exchange between the strains with different methylation status of gatc.

the avoidance of gatc site can be also associated with activity of the methyl-directed mismatch repair system. unmethylated gatc is target for the muth nicking enzyme  <cit> . the toxicity of muth for enterophage dna with unmethylated gatc was shown  <cit> . all strains with the gatc-recognizing type iim r-m systems are dam- and therefore mismatch repair system might be the reason of gatc avoidance.

the other outlier is ctag site which is the most avoided 4 bp palindrome in the bacterial genomes  <cit> . in our data it is underrepresented in  <dig>  % of all site-genome pairs of prokaryotic control dataset while only  <dig>  % of bacteria are known to have the r-m system with such specificity. the ctag avoidance was explained by its structural role in dna  <cit>  . also it could be explained by the vsp repair system that is likely to turn ctag into ccag after a to g transition  <cit> . furthermore ctag is often the target site for insertion sequences  <cit>  and can be under negative selection to prevent their expansion in a genome. thus underrepresentation of ctag can hardly be attributed exclusively to influence of orthodox type ii r-m systems.

CONCLUSIONS
the phenomenon of restriction sites avoidance was discovered earlier for palindromic sites of type ii r-m systems. we showed that, with respect to the site avoidance, the r-m systems have to be divided into ‘orthodox’, which are type ii r-m systems except iig and iim subtypes, and the remaining, ‘non-orthodox’ ones. the sites of orthodox r-m systems are underrepresented in about 50 % of bacterial genomes encoding corresponding r-m system genes while site underrepresentation practically was not detected for non-orthodox r-m system sites. many of non-underrepresented orthodox r-m system sites are likely to be the sites of recently acquired r-m systems.

as to non-orthodox r-m systems the absence of recognition site underrepresentation may be explained by a significantly shorter lifespan in bacteria due to efficient mechanisms of specificity changes, or less self-toxicity of such r-m systems. indeed, methyltransferase corruption may prevent dna cleavage because endonuclease complex in these group of r-m systems includes methyltransferase subunit.

our data confirms also that underrepresented sites that are not sites of any orthodox r-m system encoded in a prokaryotic genome often are restriction sites of lost r-m systems. the underrepresentation of sites may be considered as a specific kind of traces of orthodox r-m system activity in a bacterial cell.

systematic study of site avoidance shed light on r-m system evolution, mobility and interaction with host genomes.

additional files
additional file 1: 
list of sites of all r-m systems available in rebase. tab-delimited table of recognition sites of r-m systems that were analyzed in the work. 

additional file 2: 
list of all analyzed prokaryotic genomic sequences. tab-delimited table of chromosomes and plasmids of complete prokaryotic genomes that were analyzed in the work. 

additional file 3: 
list of all analyzed genomic sequences of eukaryotic viruses. tab-delimited table of viral genome sequence ids. 

additional file 4: 
the actual pairs dataset. tab-delimited table of site-genome pairs where site is the recognition site of one of r-m systems encoded in the genome. 

additional file 5: figure s <dig>  formula for kr calculation by karlin’s method. figure s <dig>  distribution of kr and mr in the prokaryotic control dataset. figure s <dig>  distribution of kr for the orthodox sites from the prokaryotic control dataset  and the subset of prokaryotic control dataset with genomes encoding no r-m systems . figure s <dig>  distribution of kr for the non-orthodox sites except cagag from the actual pairs dataset  and the prokaryotic control dataset . 



abbreviations
r-m systemrestriction-modification system

mtasedna methyltransferase

reaserestriction endonuclease

competing interests

the authors declare that they have no competing interests.

authors’ contributions

ase and ava performed preliminary data analysis. isr created programs for data downloading and analysis. ase and isr contributed equally to the statistical analysis of the results. ava, sas and ask contributed to the conception of the study. all authors contributed to the writing of the paper, read and approved the final manuscript.

