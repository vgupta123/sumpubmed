BACKGROUND
encoding enzyme reactions and mechanisms
almost all biological processes proceed at a significant rate only because of enzymes, proteins that catalyse the chemical reactions found in nature. for half a century, enzymes have been annotated using enzyme commission  numbers  <cit> . the scheme is a hierarchical organization of enzyme reactions into six main classes , which are then split at a further three hierarchical levels. in general, these successive levels describe the reaction at increasingly fine levels of granularity. the six top level classes are very broad reaction types. the second level subclass and third level sub-subclass usually describe the specific bonds or functional groups involved in the reaction. the fourth level serial number defines the actual substrate and therefore the specific chemical reaction catalysed. the ec classification can be conveniently browsed and searched via the explorenz database  <cit> , while the official website maintained by the nomenclature committee of the international union of biochemistry and molecular biology   <cit>  is a valuable and regularly updated resource. numerous other online databases allow the user to explore enzyme structure and function, including the enzyme structures database  <cit> , intenz  <cit> , brenda  <cit>  and kegg  <cit> .

our motivation is to investigate the relationship between the reaction mechanism as described in the macie  <cit>   database and the main top-level class of the ec classification. in order to do this, we generate supervised machine learning models to predict ec class from data on the chemical reaction or its mechanism. we consider two ways of encoding the mechanistic information in descriptors, and also three approaches that encode only the overall chemical reaction. these five sets of descriptors are described in detail in the methods section, and also in additional file  <dig>  additional file  <dig>  additional file  <dig>  additional file  <dig>  additional file  <dig>  additional file  <dig> 

by definition, the ec number describes the overall chemical transformation. thus a full description of the overall chemical transformation from starting materials to products should, in principle, lead to perfectly accurate assignment of the ec number. however, our objective is not to create perfect cheminformatics algorithms to assign ec numbers, but rather to look at descriptor definitions that encode mechanism-rich information. if similar reactions have a strong tendency to proceed by similar mechanisms, then we would expect descriptors of the mechanism to be  as good as descriptors of the transformation in predicting or assigning ec class. if, however, similar reactions proceed by diverse mechanisms, then we would expect mechanistic descriptors to be relatively poor predictors of ec class.

work by o'boyle et al.  <cit>  showed that multi-step enzyme catalysed reaction mechanisms can be represented by descriptors, and that a procedure analogous to bioinformatics sequence alignment can be used to measure similarity between stepwise reaction mechanisms. their study presented instances where quite different chemical transformations were carried out by similar mechanisms. almonacid et al.  <cit>  built on that work with a study of the mechanisms of analogous enzymes, that is pairs of enzymes which catalyse similar overall reactions  while sharing no detectable common evolutionary ancestry. they showed that the mechanisms catalysed by analogous enzymes are less similar than their overall chemical transformations - demonstrating that convergent evolution typically uses a different mechanism when reinventing an existing kind of enzyme chemistry. this suggests that there are plural chemical mechanisms available to effect a given variety  of overall transformation. this is true despite the usual constraints of approximately ph neutral aqueous chemistry catalysed by a limited alphabet of amino acids and cofactors. in this context we note that, though  <dig> of the  <dig> mechanisms in macie  <dig>  were taken from extremophiles, all but two  of these have close homologues in mesophiles that are highly likely to share the same mechanism. these two studies  <cit>  motivate our interest in investigating the extent to which predicting ec number from mechanism is possible.

a brief history of ec prediction
numerous papers have attempted ec prediction, but on the basis of quite different information and with different scientific objectives. it is helpful to divide them into those predictions based on protein properties, and those based on the chemical changes taking place in the reactions. a number of groups have attempted to use protein sequence and structure to predict ec number  <cit> . a different class of computational methods tries to automatically link overall chemical reactions to ec numbers, not considering mechanism and ignoring protein sequence and structure  <cit> .

firstly, we take the bioinformatics problem of protein function prediction, where predicting an ec number from a previously unseen protein sequence or structure is the objective. bray, doig & warwicker  <cit>  constructed a predictive model based on a combination of sequence, structural and active site features of a diverse set of enzymes. their model operates by generating a vector describing the average features of each top level ec class in a normalised descriptor space, and then assigning each instance to the closest class, as measured by the angle between vectors. their overall headline accuracy figure was only  <dig> %. this is stated to be significantly better than random assignment, which they take as the die-rolling value of one sixth, though an accuracy of  <dig> % could be obtained by assigning everything to the largest of their unbalanced classes. dobson & doig  <cit>  had earlier achieved a similar accuracy of 35% using a svm model based on sequence and structural features. these figures demonstrate the difficulty of constructing a truly global model for predicting ec from protein structure.

a well-designed answer to the challenge of prediction from sequence has been provided by de ferrari et al.  <cit>  who use a knn model  along with a very large training set. this means that the information used to make the prediction is extremely local, the single nearest neighbour in a descriptor space built on binary fingerprints of presence and absence of specific interpro sequence signatures, but the coverage of their model is global. headline prediction accuracy above 97% was achieved, outperforming other bioinformatics based predictions. this excellent result shows that ec number annotation is highly conserved between neighbouring sequences in their bioinformatics descriptor space and that almost all test sequences had a suitably close homologue available in their large dataset. their method's predictive success might broadly be ascribed to evolutionary conservation of both protein sequence signatures and catalysed chemical transformation,  <cit>  though almonacid & babbitt have demonstrated that over a third of evolutionarily related families of enzymes carry out more than one catalytic function  <cit> . however, the construction of de ferrari et al,'s method relies on sequence-similar proteins sharing the same functional label, which is analogous to the principles by which such functional annotations are assigned in the first place. we note that any propagation of functional mis-annotation in bioinformatics databases  <cit>  is unlikely to be detected by a neighbour based method. this would register a correct prediction since the training and test instance have the same label; even if that label was actually mis-assigned at some earlier stage in its propagation through the databases.

now we come to the cheminformatics version of the problem, finding the ec number for a known chemical reaction. since ec numbers, at least at the first three levels, are ontologically related to the chemical bond making and breaking inherent in the reaction, one might argue that the cheminformatics problem is more about assignment than prediction. that problem, though more simply stated than executed, is to encode an algorithm that mimics the role of the humans charged with deciding upon the ec number for a new reaction. two papers from the gasteiger group  <cit>  looked at the classification of enzyme transformations using kohonen maps, svm, and hierarchical clustering. they worked with physicochemical descriptors relating to the reacting bonds and classified only within classes ec  <dig> and ec  <dig>  the main accuracy figures reported, between  <dig> % and  <dig> %, do indeed seem impressive. latino & aires-de-sousa similarly use physicochemical and topological descriptors encoding the bonding changes during a chemical reaction  <cit> . their rf predictor, run on a genome-wide set of reactions, gave respective accuracies of 95%, 90% and 85% at the first three levels of the ec classification. their training set included an example of every available full ec number, analogously to reference  <cit> . their work also showed that the predictions became much more reliable if a full balanced description of the reaction was used. yamanishi et al.  <cit>  used a graph theory description of reactants, products and reactants to predict possible ec numbers, also making use of their rdm approach.

the work of egelhofer et al.  <cit>  has close links to the iubmb nomenclature committee through dietmar schomburg, and uses a fairly typical cheminformatics encoding of chemical structure in terms of atom and bond types, with a tanimoto similarity metric. they found a concordance of over 80% for their method as compared with the ec, over a dataset of  <dig> enzymatic reactions . this illustrates the difficulty of designing an effective automated and algorithmic process to reproduce a classification, ec number, which is occasionally idiosyncratic and inconsistent and whose definition has involved some arbitrary human decision making. thus, the necessary use of the actual ec classification as a gold standard is a limitation inherent in the validation of these methods. also in the schomburg group, leber et al. investigated the correspondence between the ec classification and dugundji-ugi r-matrices describing the formal electron changes associated with the reaction  <cit> .

methods
enzyme reactions and mechanisms
version  <dig>  of the macie database of enzyme reaction mechanisms, used in the first part of this study, includes  <dig> entries. macie is unique amongst enzyme databases in combining detailed stepwise mechanistic information with wide coverage of both chemical space and the protein structure universe. macie usefully complements both the mechanistic detail of the structure-function linkage database ,  <cit>  which provides great detail for a small number of enzyme superfamilies, and the wider coverage with less chemical detail provided by ezcatdb  <cit> . we have previously employed macie in a major survey of the chemistry involved in enzyme catalysis,  <cit>  to describe quantitatively the similarity between different enzyme reaction mechanisms,  <cit>  to study the geometry of interactions between catalytic residues and their substrates,  <cit>  and to investigate the functional roles of the different residues in enzyme catalysis  <cit> . macie has been extended by incorporating metal ions,  <cit>  and by using cmlreact  <cit>  and animations  <cit> . newer applications of macie are graph theory for identifying atom-atom correspondences between the structures of starting materials, intermediates and products,  <cit>  and the evolution of pathways for cofactor biosynthesis  <cit> .

as we are interested in reaction mechanisms, our dataset is limited to the  <dig> entries in macie  <dig>  and the further  <dig> added in version  <dig> , whereas overall reaction based ec number assignment studies have the full set of around  <dig> ec numbered reactions to work with. sequenced-based protein function prediction has hundreds of thousands of annotated sequences available  <cit> .

machine learning algorithms
machine learning is the development of algorithms that enable computers to learn and evolve the behaviours that allow them to interpret data. the many different available machine learning methods are categorised into two main groups: supervised learning where classification is performed based on prior information and unsupervised learning where no information is given prior to learning. we focus on the analysis and comparison of performance of three commonly used supervised approaches, svm  <cit> , rf  <cit>  and knn  <cit>  with enzyme mechanistic descriptors derived from the macie  <cit>  database.

svm is a learning method based on statistical learning theory. the svm maps the inputs into a high-dimensional feature space through a chosen kernel function. the dimensionality of the feature space is determined by the number of support vectors extracted from the training data. in principle, we seek the optimal separating hyperplane between the two classes by maximizing the margin between the closest points  . noble has explained the essence of svm with respect to four basic concepts  <cit> :  the separating hyperplane,  the maximum-margin hyperplane,  the soft margin and  the kernel function. svm is used to solve the task of assigning objects to classes.

linear svm can be used where two classes are linearly separable. for more complex nonlinear classification problems, the kernel trick  <cit>   provides an elegant and effective way of dealing with this, mapping the data through some nonlinear transformation into a higher dimensional feature space before finding a separating hyperplane in that transformed space with the maximum margin. common kernel functions include the firstly the polynomial, and secondly the gaussian radial basis function .

the various kernel functions contain characteristic hyperparameters that need to be optimised in order to find the best svm model. in the gaussian rbf kernel, the number of free hyperparameters to be determined is two: a regularization parameter c which controls the complexity of the decision boundary, and the kernel width σ. three hyperparameters need to be settled for the polynomial kernel: the regularization parameter c, scale and degree. the advantage of kernel based methods is that once the valid kernel is selected, one can practically work in any dimensionality without paying attention to computational cost. svm has many applications and it is extensively used for classification problems in bioinformatics and cheminformatics.

a random forest is an ensemble of diverse decision trees, generated by sampling the same training data. trees are constructed by the classification and regression trees  algorithm. each tree is based on a different randomly selected bootstrap sample of the data; a sample of n items from the pool of n, chosen with replacement. thus, some items will occur more than once in the sample from which a particular tree is grown. other items will therefore not be chosen for this bootstrap sample; these form the out of bag data for this tree. the probability of omission from a bootstrap sample is 
n
, which tends towards a limit of e- <dig> ≈  <dig>  as n becomes large. the second tree is based on a fresh randomly chosen bootstrap sample, and so on throughout the forest.

as a tree is grown, the possible branch splittings are investigated, based on the values of a subset of descriptors. a fresh subset of descriptors is randomly selected at each new node to generate potential splits; we treat the subset size mtry as a hyperparameter of the method, but as a default the randomforest package in r uses √m, where m is the number of descriptors. the best available split  at the given node is used, and branches grown to two child nodes. the tree continues to be grown in this way until no further subdivision is possible; unlike some other decision tree methods, in rf the trees are not pruned.

trees grown in this way can then be used to predict data they have not seen before. the usual internal validation of a rf is based on the out of bag data; each tree is asked to predict the data omitted from its own bootstrap sample. each item is thus predicted by roughly 37% of the trees in the forest. in rf classification, as relevant to this work, each tree's predicted class assignment is counted as one vote and the forest's consensus prediction for an item is simply that with the most votes; ties are broken at random. unseen test data are predicted just as for out of bag samples, except that every tree now predicts every test item.

advantages of rf include not having to split the data into separate training and test sets , and especially rf's tolerance of unimportant descriptors. this means that it is not usually necessary to carry out descriptor selection with rf.

the k-nearest neighbour  classifier is an instance-based learning algorithm based on the minimum distance from the query instance to the training samples. descriptors, which if numerical are usually scaled, are used to locate each instance in a multidimensional coordinate space. euclidean distance  is used to determine the k-nearest neighbours in this space, where k is a small integer. the class of the query item is then assigned by majority vote amongst the k neighbours. in the case of k =  <dig>  the class label is therefore copied directly from the nearest neighbour. instances with the same class label  are expected typically to have smaller separating distances compared to instances belonging to different classes. the knn algorithm is, perhaps, the simplest among all machine learning methods. only one parameter in knn needs to be optimised; this is k, the number of nearest neighbours used to vote for the classification. knn is a local method, in that the prediction for a test item is determined only by training items close to it, but its coverage is as broad as the diversity of the training set. even where the descriptors are actually similarity measures, our knn procedure locates neighbours in the high dimensional descriptor space, rather than just finding the highest similarity value in a row or column.

for parameter tuning we have used the caret package in the statistical software suite r  <cit> . the train method creates a grid to evaluate the parameter settings with a fixed step-size through a wide range of values and to assess the performance of every combination. the model with the highest accuracy is selected as the candidate model.

five sets of descriptors
our study uses five sets of numerical descriptors. three of them encode information derived from the overall chemical transformation. the other two represent information relating to the chemical mechanism by which the transformation occurs.

the human designed descriptors belong to the first category since we based them on features of the overall reaction. many are calculated directly from the overall bond change descriptors; examples are f:x-h, the total number of bonds to hydrogen formed, and dv:c, the total change in the sum of all bond orders to carbon. other human designed descriptors are derived from the chemical structures of the molecules involved or the equation of the reaction. some are designed very deliberately to correlate with certain ec classes. for example, water.oh-.su is set to  <dig> whenever water  is a substrate; it should take the value  <dig> for every ec  <dig> -.-.- reaction, though the converse is not true. the descriptor mod_diff is the difference in molecular weight between the largest substrate and largest product, and was designed to be  <dig>  for every ec  <dig> -.-.- reaction . these descriptors are expected to predict ec class better than any of the less artificial types of descriptor. in addition, their development using the training set data means that their performance on internal validation measures, including the rf out-of-bag error, may overestimate their true discriminatory power; the external validation is, however, a fair test of them. full details of the human designed descriptors, and their values, are available in additional files  <dig> and additional file  <dig> 

the overall bond change descriptors of holliday et al.  <cit>  list the numbers of covalent bonds between a given pair of elements that are formed, cleaved or changed in order on going from the starting materials to the products. for instance, the descriptor c.n_ <dig>  is the number of carbon-nitrogen single bonds formed in the reaction, and o.o_ <dig>  is the number of oxygen-oxygen double bonds in the starting materials that become single bonds in the products. thus, these descriptors consist of integers describing the number of occurrences of each bond change in each overall transformation. their values are given in additional file  <dig> 

the overall reaction similarity descriptors of almonacid et al.  <cit>  give the similarity of each overall reaction to each of the  <dig> entries in macie  <dig> ; for the external validation a further  <dig> columns give the similarity to the additional training set reactions. the similarity is based on combining bond changes to give tanimoto scores. the overall reaction similarity is based on the similarity of the overall chemical transformation, with no reference to its stepwise mechanism. the overall reaction similarity is calculated for both reactions in the canonical direction indicated in macie only. in all cross-validation tests, columns of the descriptor matrix corresponding to any entry in the  test set for that cross-validation fold are deleted before training takes place. note that since rf out-of-bag performance is defined on the training set, the out-of-bag results do not reflect such deletions, though the rf cross-validated results do. thus, these descriptors consist of real numbers between  <dig> and  <dig> expressing the similarity between each pair of overall transformations; see additional file  <dig>  their values are given in additional file  <dig>  while they convey closely related underlying information to the overall bond change descriptors, both sets are included here in order to make a comparison between them.

the composite bond change descriptors  <cit>  consist of bond change information, analogous to the overall bond change descriptors. for the composite bond change descriptors, however, these changes are considered for each step, rather than for the overall reaction. the composite descriptors are derived by summing the descriptors corresponding to each step of the reaction. the composite bond change descriptors are therefore mechanistic features consisting of integers expressing the number of occurrences of each bond change summed over each step of each reaction. this means that, for example, a c-o single bond formed in one step and broken in a subsequent one will appear as both c.o_ <dig>  and c.o_ <dig>  in the composite bond change description of the mechanism; see additional file  <dig>  in contrast, such a transient bond will not appear in the representation of the chemical transformation from substrates to products, and hence would be absent from the overall bond change description of the reaction. the values of the composite bond change descriptors are given in additional file  <dig> 

the mechanistic similarity descriptors  <cit>  give a different representation of mechanistic information. they give the similarity of each stepwise mechanism to each of the other entries in macie. the similarity is obtained by aligning the steps of the two mechanisms using a needleman-wunsch alignment procedure, as explained in almonacid et al.,  <cit>  and is analogous to sequence similarities obtained via sequence alignments. the mechanistic similarity is calculated for both reactions in the canonical direction in macie, and then recalculated with one reaction reversed; the higher similarity is selected. thus, these descriptors consist of real numbers between  <dig> and  <dig> expressing the similarity between each pair of chemical mechanisms. their values are given in additional file  <dig>  though they express related information to the composite bond change descriptors, the two sets are included here in order to facilitate comparison. during cross-validation, column deletion is carried out for mechanistic similarity, as described for overall reaction similarity above.

a number of individual numerical descriptors are distributed over different ranges, affecting three of the five given descriptor sets. the most strongly affected are the human designed descriptors, which included both small integer counts of bond changes and large numbers corresponding to molecular weights. we anticipated that knn would be particularly vulnerable to differences in descriptor ranges, with the larger valued descriptors dominating computations of distance. hence, we scaled all descriptors in the overall bond change, human designed, and composite bond change sets such that each had a mean of  <dig>  and a standard deviation of  <dig> . the overall reaction similarity and mechanistic similarity descriptors are by definition all real numbers between  <dig> and  <dig>  and are not further scaled.

cross-validation strategy
there are many methods for estimating the performance of machine learning such as the hold-out method, leave-one-out, and k-fold cross-validation. in the first part of this study, we performed  <dig> fold cross-validation to estimate classifier performance. the cross-validation involves training and prediction procedures in which the class instances were randomly distributed into  <dig> folds, where nine out of  <dig> were used as a training set, and the remaining one as the test set. n-fold cross-validation has been widely accepted as a reliable method for calculating generalization accuracy and experiments have shown that cross-validation is relatively unbiased  <cit> . our procedure is illustrated in the flow chart of figure  <dig>  in addition to the cross-validation results, we also calculate the out-of-bag accuracy for the rf models.

accuracy, calculated as the proportion of the predictions made which are correct, is an easily understood and very widely used measure of predictive power. nonetheless, it may not be a good measure for data which are unbalanced between classes, and a prediction based simply on assigning instances to the largest class might score a reasonable accuracy without being of any practical use. in our work, the train procedure selects models based on accuracy in an internal validation, and hence our predictions may show a small bias towards larger classes. mindful of this, we also present values of gorodkin's k-category correlation coefficient rk,  <cit>  which is an extension of the matthews correlation coefficient  <cit>  to multi-class data and gives a more balanced measure of prediction success across classes.

external validation set
during the course of this study, macie version  <dig>  was released, containing a further  <dig> entries. this presented us with the opportunity of generating an external test set in addition to the existing cross-validation. to ensure that the test set was reasonably representative, it was chosen by construction to be non-redundant at the third level of the ec classification. this led to a test set of  <dig> entries, while the  <dig> third level ec duplicates amongst the  <dig> new macie entries were added to the training set for this validation exercise; the training set thus comprised  <dig> entries. training set descriptors for the human designed, overall bond change and composite bond change sets were scaled as described above, and the equivalent test set descriptors were scaled using the corresponding training set distributions.

significance tests
we assessed the statistical significance of the difference in prediction performance between each pair of methods for a given descriptor set, and between each pair of descriptor sets for a given method. for a given pair of classifiers and definition of cross-validation folds, the difference is given by

 d0=++...+, 

where na <dig> is the number of correct predictions made by classifier a for fold  <dig> and so on. we used a permutation test as described by menke & martinez,  <cit>  in which  <dig> permutations were created via all  <dig> combinations of

 dp=±±±...±. 

the rank of the true difference in performance  amongst the population of values obtained by the  <dig> permutations is used as an indicator of the p-value; the probability that such an extreme value would be obtained if there were no intrinsic difference between the classification abilities of the two classifiers. this equates to

 p=n <dig>  

where n is the number of permutations which give

 dp≥d <dig>  

the value of n can never be smaller than  <dig>  since both d <dig> 
and -d <dig> 
must be found amongst the set of differences {dp
}.

RESULTS
the cross-validation results are given in tables  <dig>  and  <dig> . we find that the three descriptor sets encoding overall chemical transformation perform better than the two descriptions of mechanism. thus, amongst directly comparable pairs of descriptors, overall reaction similarity always gives better predictive accuracy than mechanistic similarity. similarly, overall bond change descriptors give better accuracy than composite bond change. thus, mechanism cannot be used as a proxy for chemical reaction in assigning an ec number. this seems to reinforce the conclusion of almonacid et al.  <cit>  that pairs of similar  enzyme reactions tend to proceed by different mechanisms; hence ec class is more accurately predictable from similarity of chemical transformation than from similarity of mechanism.

average cross-validated accuracy over  <dig> repetitions of 10-fold cross-validation, as shown in figure  <dig>  for four methods and five descriptor sets

the human designed descriptors were specifically constructed to facilitate the identification of the correct ec class from the other information available in a macie entry. these  <dig> descriptors seek to recognise characteristic features of reactions in each ec class, such as: involvement of known oxidising and reducing species , water , starting material and product being isomers , and hydrolysis of atp . these allow a classification accuracy of 91% with rf; more exhaustive development of these descriptors would lead us closer to an algorithmic cheminformatics implementation of the definition of ec class  <cit> .

the second and third best performing sets, overall reaction similarity and overall bond change descriptors, both carry information about the overall chemical transformation. while it is unsurprising that neither can match the human designed set's results, all three encodings of overall chemical transformation outperform both descriptions of mechanism, of which the composite bond change descriptors are slightly more effective than the more sophisticated alignment-based mechanistic similarity descriptors of almonacid et al.

for all four machine learning classifiers, the ranking of the five descriptor sets is identical, and in every case the differences between all pairs of descriptors are statistically significant:

human designed > overall reaction similarity > overall bond change > composite bond change > mechanistic similarity.

tables  <dig> and  <dig> also show that the two different svm kernels and rf all produce similar quality predictions, though the knn predictions are generally less successful. the relative performance of the methods varies somewhat with the descriptor set used, and is illustrated in figure  <dig>  taking into account the statistical significance tests, the relative performance  was as follows.

average cross-validated value of gorodkin's k-category correlation coefficient over  <dig> repetitions of 10-fold cross-validation, as shown in figure  <dig>  for four methods and five descriptor sets

overall bond change; rf ≈ svm  > svm  > knn.

human designed; rf > svm  > svm  > knn.

overall reaction similarity; svm  ≈ rf ≈ svm  > knn; svm  > svm .

mechanistic similarity; svm  > svm  ≈ rf > knn.

composite bond change; svm  ≈ rf ≈ svm  > knn.

prediction accuracies by ec class and descriptor type. these data are for the rf method as implemented in the r package randomforest  <cit> .

prediction accuracy on the 43-entry external test set for four methods and five descriptor sets.

discussion
almonacid et al. showed that, for convergently evolved pairs of enzymes sharing an ec sub-subclass, overall reaction similarity was almost universally higher than mechanistic similarity  <cit> . in our current work, overall bond change descriptors can predict ec class with up to 68% accuracy, compared to 62% for the mechanism dependent composite bond change description of the reaction. overall reaction similarity gives 71% prediction accuracy, mechanistic similarity only up to 60%. thus, we find that the descriptor definitions based on overall reaction tend to be better predictors than those based on chemical mechanism, though composite bond change does well on the external test set. since ec numbers are defined on the basis of the overall chemical transformation catalysed, the strong performance of overall reaction-based measures is reassuring - albeit that some questions arise over the congruence of the ec sub-subclass-based and descriptor-based definitions of a "similar reaction". in the present work, we are necessarily looking at predicting the top level ec class, since macie contains insufficiently many examples of each category at the subclass or lower levels. hence the overall reactions sharing the same label in this study are considerably less similar than those sharing third or fourth level labels. nonetheless, the superiority of the predictions made using descriptors based on overall chemical transformation is entirely in accordance with the conclusions from  <cit> ; mechanisms of analogous reactions tend to be less similar than are the overall reactions.

ec class  <dig>  the oxidoreductases, covers a diversity of chemistry - the unifying feature being that all are redox reactions. within the breadth of biological redox reactions, there are some recognisable clusters: significant proportions of these reactions involve interconversion of nad and nadh, or nadp and nadph . overall, the oxidation and reduction reactions of ec class  <dig> seem to leave recognisable chemical signatures in the descriptors; for instance c-h cleavage, o-h formation and c-c bond order changes are all common, and class  <dig> is generally well-recognised. our chemical interpretations here, and indeed for all six classes, are based on analysis of both descriptor values and rf variable importance scores.

ec class  <dig>  transferases, encompasses any chemical reaction that transfers a functional group from one molecule to another; quite commonly phosphate moieties, in the cases of kinases and phosphatases, or methyl groups are transferred. the  <dig> macie  <dig>  entries in ec class  <dig> are diverse reactions, seeming to lack clear chemical patterns. unsurprisingly, they are poorly predicted.

ec class  <dig>  the hydrolases, is more tightly defined than many of the other classes, since it consists of reactions where water is used to hydrolyse a chemical bond. in fact, two of our  <dig> hydrolases are exceptions to this rule: m <dig> is annotated as the reverse reaction, while m <dig> is presented as utilising a hydroxide ion rather than neutral water. almost half of the hydrolases in macie  <dig> ,  <dig> out of  <dig>  catalyse the hydrolysis of biopolymers such as peptides, proteins, dna or rna. hydrolases are well-predicted by all the descriptor sets, though less so for composite bond change descriptors. hydrolysis leads to simple repeated and recognisable patterns of bond making and breaking. an example for the overall bond change is c-n single bond cleavage, combined with c-o and n-h single bond formation, for amide or peptide hydrolysis. these are recognisable from both overall reaction and, to a slightly lesser extent, mechanistic data. in the mechanistic case, the corresponding patterns also include bond changes which occur in one step of the mechanism and are subsequently undone in a later step.

ec class  <dig>  lyases, includes those enzymes that catalyse the breaking of a covalent bond, other than by redox or hydrolysis reactions. while a typical text book definition of a lyase may specify that there should be one substrate and two products, only  <dig> of the  <dig> lyases in macie  <dig>  obey this rule. six are presented as the reverse reaction, and as many as  <dig> present an assortment of stoichiometric or other complexities. despite these extra challenges, lyases are generally well-recognised as overall reactions, primarily due to the prevalence of c-c single bond cleavage and c-h single bond formation.

ec class  <dig>  isomerases, comprises enzymes that catalyse a reaction in which the product is an isomer of the starting material. twenty seven of the  <dig> examples in macie  <dig>  have the simple stoichiometry of one starting material being transformed into one isomeric product;  <dig> of the  <dig> enzymes catalyse constitutional isomerisation, seven are epimerases or racemases, two topoisomerases catalyse winding or unwinding of dna, one enzyme is a cis-trans isomerase and one a tautomerase. we find that isomerases are well predicted by overall reaction descriptors, but are extremely hard for the mechanistic descriptors to predict. we interpret the lack of a relationship between membership of ec class  <dig> and mechanism as indicating that the class comprises a diversity of reactions, united only by the feature that the product is an isomer of the starting material. thus, our results support the hypothesis that isomerisation reactions can evolve from mechanistically diverse starting points. the two overall reaction based descriptors do rather better, possibly because the reactions often involve formation or cleavage of o-h single bonds. given knowledge of the definition of an isomerase as an enzyme whose substrate and product are isomers, it is a simple matter for a human to design a cheminformatics descriptor or descriptors to capture isomerisation reactions. the human designed descriptors were deliberately engineered to include the change in molecular mass between the largest substrate and the largest product. this descriptor is zero for all but one of the isomerases and allows this descriptor set to recognise isomerases with high accuracy. the isomerase most often incorrectly predicted by the human designed predictions is m <dig>  where the starting material and product are a  protonation state away from being isomers.

ec class  <dig>  ligases, is composed of enzymes that catalyse the joining together of two molecules coupled with the conversion of atp to amp, or atp to adp. the human designed descriptors are chosen so that they specifically include a feature recognising atp hydrolysis; this allows them to recognise ligases accurately. ligases are characterised by both the formation and cleavage of p-o single bonds and we suggest this as the reason why both the overall and composite bond change descriptors do well in recognising ligases.

as expected, the human designed descriptors fared less well on the external test set than in the cross-validation. unlike the other descriptor sets, the human designed descriptors were developed and tested specifically to predict ec class at a time when version  <dig> , but not version  <dig> , of macie was available. this illustrates what we believe to be a general principle, that prediction and classification methods tend to do better on data that were available while they were being developed, and less well on prospective or blind tests. we note also that the class balance of the 43-reaction test set differed from that of the previous cross-validation set. the other descriptor sets, which were defined by their original authors and not developed for classification in the light of available data, generally perform somewhat better on the external test. the overall bond change and composite bond change methods do relatively well on the external test set.

it is common in the literature to compare the performance of different machine learning methods. we believe that the relative performance depends on context. some studies have reported that svm outperforms rf,  <cit>  while others suggest that rf and svm give very similar prediction quality  <cit> . our results here suggest that there is no significant difference: both svm  and rf achieve an average accuracy of  <dig>  across the whole cross-validation exercise. knn is clearly less effective in this work, but extremely good in a different ec prediction context  <cit> . knn is an essentially local method with global coverage and, where class labels are strongly conserved in small regions of descriptor space, will prove a good methodology. for the current problem, the strategy of non-redundancy used in populating macie means that most macie entries do not have a very close neighbour and knn is less useful.

CONCLUSIONS
our results strongly suggest that different enzymes typically bring about similar chemical transformations by dissimilar mechanisms. we conclude this because we find that the use of mechanistic information in a set of descriptors encoding an enzyme reaction diminishes its ec prediction performance relative to analogous descriptors with information only on the overall transformation. thus, composite bond change  <cit>  descriptors do significantly less well than overall bond change; similarly, mechanistic similarity  <cit>  is outperformed by overall reaction similarity.

we observe that oxidoreductases and hydrolases have distinctive signatures which are relatively easy to recognise in cheminformatics descriptors; these classes can be identified accurately from overall reaction descriptors and fairly accurately from mechanism. if we specifically design descriptors to recognise cases where the product is an isomer of the substrate, we can identify isomerases. however, isomerases are very hard to assign from mechanism alone; we find no common mechanistic patterns amongst ec class  <dig>  rather, a diversity of mechanistically quite different enzymes comprise the isomerases, catalysing a disparate group of reactions united only by one property: the substrate and product being isomers. a specific feature to identify atp hydrolysis allows our human designed descriptors to identify ligases. transferases and lyases are hardest to recognise, without any clear chemical signature in either the overall reaction or mechanistic data.

the performance of the various machine learning algorithms is in line with many cheminformatics applications, with svm and rf performing about equally well in the cross-validation. rf does slightly better than svm on the external test set. the relatively modest performance of knn illustrates the importance of non-local information for recognising ec class from reaction, as opposed to protein, information.

we note also that, despite a lack of clarity in the literature, ec number prediction is not a single problem. the challenge of predicting protein function from available sequence data is quite different from assigning an ec classification from a cheminformatics representation of a reaction. the wide range of prediction success, with headline figures between 33% and 98% in the literature, tells us as much about the difficulties of prediction from different data sources as about the quality of various machine learning algorithms.

competing interests
the authors declare that they have no competing interests.

authors' contributions
nn designed the workflow, carried out the majority of the computations, performed the statistical analysis and participated in the drafting of the manuscript. jm conceived the study, carried out some computations and participated in the drafting of the manuscript. both authors read and approved the final manuscript.

supplementary material
additional file 1
details of the five sets of descriptors used in this work.

click here for file

 additional file 2
the values of the human designed descriptors used in this work.

click here for file

 additional file 3
the values of overall bond change descriptors used in this work.

click here for file

 additional file 4
the values of overall reaction similarity descriptors used in this work.

click here for file

 additional file 5
the values of composite bond change descriptors used in this work.

click here for file

 additional file 6
the values of mechanistic similarity descriptors used in this work.

click here for file

 acknowledgements
we thank the scottish universities life sciences alliance  and the scottish overseas research student awards scheme of the scottish funding council  for financial support. we thank eastchem for access to the ecrf computing facility. we are grateful to dr gemma holliday for the use of her overall bond change and composite bond change descriptors. we thank dr daniel almonacid for providing software to compute the overall reaction similarity and mechanistic similarity descriptors.
