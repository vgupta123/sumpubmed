BACKGROUND
meiotic recombination is a crucial step in the reproduction of many species. the reciprocal exchange of genetic material between homologous chromosomes during the meiosis  is an important evolutionary force for increasing genetic diversity and also essential for proper chromosome segregation. knowledge about recombination is important for understanding the linkage disequilibrium  structure of the genome  <cit> , phenotypic diversity and evolution in a population  <cit> , and a variety of genetic diseases  <cit> . recombination events do not occur randomly along the chromosomal dna, but would rather cluster on short chromosomal intervals, typically 1- <dig> kb long, named recombination hotspots  <cit> . recent development in the construction of genome-scale, high-resolution recombination map and new biological techniques for analysing this cellular progress have provided a comprehensive view of the distribution of recombination hotspots as well as insights into the regulatory systems that control the recombination landscape. in particular, the prdm <dig> protein was found to be an important trans-regulator controlling the activity of recombination hotspots through binding to a 13-mer dna motif  in the human genome  <cit> . however, the binding motif of prdm <dig> does not cover all the human hotspots  <cit> , and there still exists a substantial gap in our understanding of the regulatory system. moreover, open questions and challenges remain, such as the recombination variation in association with gender and age, epigenetic regulators of meiotic recombination, the roles of recombination hotspots in human diseases, etc. thus finding other trans- and cis- regulators that can also regulate recombination hotspots is highly desired.

most existing methods for the statistical analysis of recombination mainly rely on the estimation of average recombination rate from a population, such as coalescent based analysis of linkage disequilibrium   <cit> . software tools have been developed to help researchers identify recombination hotspots by ld analysis, such as ldsplit  <cit>  which has been applied to disease study  <cit> . yet the power of individual recombination events tends to be overlooked by most approaches despite the accumulating evidence that recombination frequencies differ significantly between ethnic groups, genders, and also among individuals  <cit> . although some methods including pedigree analysis  <cit>  and sperm typing  <cit>  can handle sex-specific and individual recombination analysis, they are limited by technical factors such as the high cost, short regions, or low resolution. therefore, algorithms that can infer individual-specific recombination rates both on a large scale and with high resolution would be very useful for genomic studies of recombination hotspots.

ancestral recombination graph  is a topological structure that captures the genealogical history of individuals, including historical mutations, recombination events and merging, back to a common ancestor. thus arg is indispensable for study of the recombination events in various evolutionary scenarios. despite the computational complexity of the arg inference, in recent years, there emerged several methods that have largely solved this problem. for example the algorithm of iris  <cit>  can detect past recombination events based on a graph reconstruction algorithm  <cit>  followed by integrating these recombination events into a subarg; acg  <cit>  estimates the full likelihood of the arg using a bayesian markov chain monte carlo  procedure; argweaver  <cit>  can infer args from genome-wide data based on hidden markov models .

in this paper, we propose a graph mining method, namely arg-walker, to infer the different strengths of a recombination hotspot among individuals in a sample. given a set of extant haplotypes, we first adapt the iris algorithm to detect the recombination events and integrate them to construct the arg; then a random walk method is applied on the arg to estimate the individual-specific recombination propensities; as such, arg-walker can translate snp sequences to a recombination profile, i.e. a vector of floating numbers each representing the corresponding individual strength of a recombination hotspot. this method can be used to exploit the power of the variation in individual recombination frequency, to shed light on the regulatory system of recombination hotspots. our extensive simulation tests demonstrated the statistical power of arg-walker in detecting phenotypic variations of recombination rate. then, applying arg-walker on the hapmap phased snp data for gwas of recombination hotspots, we detected strong association signals of cis-regulation, corroborated by the enrichment of the aforementioned 13-mer prdm <dig> binding motif ccnccntnnccnc in proximal regions of snps identified by our gwas. through further analysis of the flanking dna sequences of associated snps, we found two new motifs, aaaatana and cngcctcc, which could be potential cis-regulators of the meiosis recombination hotspots in the human genome. moreover, by screening the gwas results on mhc  region in human chromosome  <dig>  we detected two significantly associated snps, rs <dig> and rs <dig>  the two snps are located in the coding regions of ksr <dig> and znf <dig> protein respectively, both of which have been reported to have regulatory roles in t-cell activation. it demonstrates the potential of arg-walker for detecting trans-factors of meiotic recombination hotspots, and for study of recombination hotspots important in the human immune system.

methods
experimental data
the input data of arg-walker consist of snp data generated by simulations or collected by the hapmap project. our simulation data was generated by a python script which we developed using python  <dig>  and based on simupop   <cit>  which is an open source framework for forward simulation of population genetics. to evaluate the performance of arg-walker under different situations, we set multiple groups of parameters in simupop according to different scenarios. each simulation data set consists of haplotypes of  <dig> individuals, each individual has two homologous haplotypes of about  <dig> snps  spanning  <dig> kb, and each snp has two alleles, denoted as  <dig> and  <dig> . for testing arg-walker on the real data, we used the snps in the  <dig> human autosome chromosomes of hapmap phase  <dig> data and recombination hotspots therein detected by ldhat  <cit> . we first extracted the haplotypes of  <dig> autosome chromosomes of jpt+chb  population of the hapmap phase  <dig> dataset. the length of each haplotype sequence was set to  <dig> snps and overlapped haplotypes were filtered, also the pre-processing required for running the iris software was applied to filter snps with minor allele frequency  less than  <dig> , and non-tag snps were removed from the sequences. in this way we obtained  <dig>  haplotype sequences with hotspots in the middle. then, the haplotypes were fed to arg-walker to estimate the individual-specific strengths of the recombination hotspot located inside the 100-snp window. for each hotspot, a profile of the estimated recombination strengths will be output. for the genotype data, we applied the fasttagger  <cit>  tool to select all tag snps with maf higher than  <dig>  from the hapmap phase  <dig> data of jpt+chb population. the minimal r <dig> was set to  <dig> . as such we obtained  <dig>  tag snps. the python script for generating the simulation data and perl scripts for extracting and pre-processing of these snp data are available in additional file  <dig> 

description of arg-walker
the main idea of arg-walker is to estimate, through analysis of arg topology, the frequencies of historical recombinations, which are then used to approximate the recombination propensities of extant individual chromosomes. first, to reconstruct the arg, we use the iris algorithm which is able to infer historical recombination events from a set of extant haplotypes and integrate these events into an arg  <cit> . then, we apply a random walk algorithm to mining the arg in order to estimate the recombination strengths of individuals corresponding to the input haplotypes. with random walks on the arg, we assign positive weights indicating signals of recombination to the root nodes, and then like raindrop collection, the information flow runs from top to bottom of the arg. if one extant haplotype has more ancestral recombination events in the history, then more information flows, flowing downward along the paths in the arg, will be gathered at the downstream arg leaf nodes corresponding to the haplotypes in the end. as such, individuals with different recombination histories can be distinguished by the amounts of information they collected from the random walks, which represent their strengths of recombination hotspot. the algorithm of arg-walker, which consists of two stages, is illustrated in figure  <dig>  and described as follows.

stage 1: arg construction and node classification
the input of our method consists of a sample of extant human haplotypes. the software of iris is employed to reconstruct the arg from the input haplotype sample. iris first cuts the haplotypes into segments, from which phylogenetic forests can be inferred to explain the segmentation. from the segments and forests, compatible sub-networks are constructed using an algorithm called dsr , which is a greedy algorithm that attempts to minimize the number of recombinations needed to explain the given data. these sub-networks are merged to construct the arg represented as a directed graph g. readers interested in details of the algorithm behind iris are referred to  <cit> . for each node ν ∈ v, three types of degrees are calculated, i.e. indegree deg-, outdegree deg+- and degree deg = deg- + deg+. with the information of degrees, the nodes are classified into three types:  the root nodes in set rv with deg- =  <dig> and deg+ >  <dig>   the recombination nodes in set recomv with deg- ≥  <dig> and deg+ >  <dig>  and  the leaf nodes with deg- >  <dig> and deg+ =  <dig>  here each node is represented by an integer, which is an index in the vertex set v. note that the arg constructed by iris could contain more than one root nodes because the reconstructed graph is only partial arg , which may contain only a subset of nodes and edges of the true arg. for conciseness, however, we will hereafter still refer to the output of iris as arg, rather than subarg.

stage 2: arg mining using backward-forward random walks
after the nodes are classified, a backward random walk from the leaf nodes to the root nodes is conducted to assign weights on the edges which are stored into an edge-weight matrix wn×n, where n is the number of nodes in the arg. initially, each entry of the matrix w is set to  <dig>  then, the matrix entries are iteratively updated according to the topological structure of the arg, following the rule that wij=1+∑k≠i,k∈vwjk if there is a directed edge from node j to node i in the arg. in other words, the weight of the edge from node j to node i is set to be the number of all descendants of node j plus one. if there is no edge from node j to node i, the corresponding entry in the matrix w will be  <dig>  due to its y-shape structure in the arg, a recombination node will be double-counted as two descendants, and as a result, edges with more recombination nodes as descendants can collect larger weights through the backward walk. later the edge weights will be passed downward all the way to the leave nodes to reflect the inherited propensity of recombination. to apply the forward random walk on the arg, we transform the edge-weight matrix wn×n into the transition probability matrix tn×n by normalization, i.e. tij=wij∑k∈vwik. through forward random walk the signals of recombination will be passed from the root nodes layer by layer towards the leaf nodes. for a coalescent node, the signal will be split to two children proportional to the transition probabilities, whereas for a recombination node in the next generation, the signals from two parental nodes will be combined. the procedure is executed by iteratively updating two vectors, each consisting of n entries corresponding to the arg nodes. the first vector, denoted by i, contains the amounts of signals flowed to arg nodes at the end of a step, which will be passed to their children in the next step. the second vector, denoted by vl, records the amounts of signals that the leaf nodes will gather at the end of the random walk. at the beginning, vector i is initialized by setting each entry corresponding to a root note equal to the sum of weights of its outgoing edges, and setting other entries to  <dig>  i.e. i={∑k∈vwik,if i∈rv <dig> otherwise for i =  <dig> ,...,n. vector vl consists of all 0s initially. for each iteration of the forward random walk, the following two operations are carried out to update the two vectors:  i = i × t, and  vl = vl + i. note that an entry of the transition probability matrix, say tuv , contains a positive value if there is a directed edge from node u to node v, and is equal to  <dig> otherwise. thus, by the first operation of i = i × t, the signal in a node i will all be passed to its child nodes in proportion to the transition probabilities. this iterative procedure is repeated until every entry of vector i is equal to  <dig>  which means every node has no more information to pass on. after the repeated updates, the signals are collected in vector vl by the second operation above. but we will set to  <dig> all the entries in vl that do not correspond to the leaf nodes, so that vl only contains signals of recombination of the extant haplotypes. moreover, the recombination probability of each individual leaf node is estimated by normalization of vl, i.e. vp=vl∑j∈lvl, where l is the set of indices of leaf nodes in the vertex set of arg, and i ∈ l. thus the final result of arg-walker is a vector vl which contains the amount of information flow gathered by each individual haplotype corresponding to a leaf node in the arg. this information flow is used to represent the strength of recombination of each individual chromosome. in addition, vector vp is also output to represent the recombination probability of each individual chromosome. arg-walker was developed in perl  and the source code is available in additional file  <dig> 

filtering hotspots without variation in recombination strength
in the simulation, we adapted the hartigan's dip test  <cit>  to test the unimodality of the distribution of estimated recombination strengths. this is for the case when there are only small variations of recombination strength in a population, e.g. the majority of haplotypes have cold  alleles, or it is hard to divide the population into two phenotypic groups. in our method, we assumed that when there are both hot and cold alleles of a recombination hotspot, the distribution of recombination strengths given by arg-walker should be more likely to be bimodal. in the dip test for these two situations, we found significant difference of p values between these two groups. with a threshold of  <dig>  of the dip −log <dig> value, we can filter out 88% samples with non-variant recombination strengths, while keeping  <dig> % samples of two-allele recombination strengths. applying this strategy in our gwas analysis, we selected  <dig>  recombination hotspots  as phenotypes.

combination of recombination phenotype by chromosome
besides individual hotspot phenotype analysis, we also merged recombination strengths of hotspots on the same chromosome into one collective chromosome-wise phenotype. first, we did standardization for each hotspot using formula /sd, and then we combined the standardized hotspot phenotypes by chromosomes, i.e. the mean value of all the standardized hotspot phenotypes on the same chromosome was calculated to represent the chromosomal recombination strength of each individual. finally we got  <dig> combined chromosomal recombination phenotypes. each of this newly generated phenotype was then mapped to the genotypes for gwas analysis.

RESULTS
simulation study
the evolution of meiotic recombination hotspots is notoriously dynamic and complicated, partly due to processes such as biased gene conversion . to slightly simplify our simulation , we focused on the common scenario of two-allele variation of recombination, i.e. hot versus cold alleles in a population. currently large amounts of evidence from both sperm typing and genetic analyses suggest that the general patterns of recombination in the human genomes are highly unstable throughout the genome  <cit> . hence, we tested different sets of parameters to simulate different recombination scenarios, of which key parameters include the recombination rate, the position of labelled snp, maf of the labelled snp and the bgc rate. for each set of parameters, we generated  <dig> samples, and fed each sample to arg-walker. then, the accuracy was calculated and presented with a boxplot. we compared the performance of arg-walker under different situations by the boxplot of accuracy with the median accuracy connected with a red line in figure  <dig>  first, we tested the change of recombination rates including the crossover rates of the hot individuals and the cold individuals. the ratio of these two crossover rates was set to  <dig> which means equal rate,  <dig>   <dig>   <dig> and  <dig>  the result shows that our method has better performance with the increase of hot/cold ratio from  <dig> to  <dig>  while the accuracy is slightly decreased and seems to become stable when the ratio is higher than  <dig>  this suggests that some recombination events are not detected by arg-walker, probably due to the loss of traces on the patterns of linkage disequilibrium when there is a high frequency of recombination. then we analysed the effect of the position of the snp controlling crossover rate, from the centre to the far ends of the window. the accuracy of our method does not fluctuate much, but with a tendency that the accuracy gets higher when the causal snp is closer to the centre. another important factor we tested is the maf of the causal snp. when the maf is low, say between  <dig>  and  <dig> , the performance of arg-walker is poor, with accuracy less than  <dig> . a lower maf means a lack of homogeneity of phenotype in the sample, which shall be filtered out before using arg-walker. when the maf is bigger than  <dig> , however, arg-walker is able to achieve a higher accuracy. another key parameter is the bgc rate along with a crossover. bgc was suggested to be in favour of hotspot-disrupting alleles thus it has crucial influence on the recombination hotspots and their evolution  <cit> . our result shows that arg-walker can be affected to some degree by bgc but it still achieved good performance when the bgc rate is lower than  <dig>  .

in addition to these tests of parameters, we also investigated two special cases, i.e. all-hot and all-cold. in these two cases, there is no difference in recombination strengths among individuals. hartigan's dip test was used to test if our arg-walker can identify these two special cases . in contrast to two-allele cases, here the test shows a significant difference on dip p-values, as shown in the boxplot in figure  <dig>  moreover, the roc curve in figure  <dig> shows a very high auc of  <dig>  indicating that a threshold of  <dig>  can dramatically differentiate these two scenarios with a specificity of  <dig>  and a sensitivity of  <dig> .

in summary, with relatively higher differences in recombination rates, an maf of  <dig>  or higher at the causal snp, and bgc rate less than  <dig> , our arg-walker has a reasonably good performance of prediction, with the average accuracy about  <dig>  . in addition to the hot-cold variation, arg-walker can also identify the all-hot and all-cold cases, which is important for gwas of recombination phenotypes later.

genome-wide association study of recombination hotspots
a major motivation of estimating the individual-specific strengths of recombination hotspots is to perform genome-wide association study  to identify trans- and cis-regulators for meiotic recombination hotspots. encouraged by the results of our simulation study, we performed a gwas analysis on the real hapmap data. for each pair of phenotype  and genotype , we used unpaired t-test to get the p-value of association between the recombination strengths and the snp. to view the association, we did log transformation for the p-values and plotted the result in figure  <dig>  where the gradient colour intensities and sizes of dots represent the strengths of association. from figure  <dig>  we can see that there are strong and prevalent signals of cis-regulation shown as the diagonal red line on the plot, compared with trans-regulation. it could be that snps located inside or proximal to a recombination hotspot may change the dna sequence thereby affecting the binding affinities of trans-factors. with a threshold of 1e- <dig>  for the p-value, we identified  <dig>  significantly associated snps. then we extracted the flanking dna sequences of these significant snps, each with a length of  <dig> kb. using the software of fimo  <cit> , we matched the aforementioned 13-mer motif ccnccntnnccnc  to these sequences.  <dig>  motif occurrences were found in these  <dig>  sequences. the strong cis-regulatory signal provides new evidence to confirm the relation of this 13-mer motif with recombination hotspots previously reported  <cit> . however, for the sophisticated regulation with meiotic recombination, it is unlikely that there is only one motif controlling all the recombination hotspots. in fact, this 13-mer motif can only explain a part of human hotspots. to search for other potential motifs, we fed these dna sequences to the dreme software  <cit>  for discriminative dna motif discovery. from the output motifs, we selected three top-ranking motifs shown in figure  <dig>  the first motif has  <dig>  positive occurrences in the  <dig>  sequences with an e-value of  <dig> e- <dig>  the second motif has an e-value of  <dig> e- <dig> with  <dig>  positive occurrences in the sequences. the third motif, which is quite similar to the second one but ends with gg rather than cc, has  <dig>  positive occurrences in the sequences with an e-value of  <dig> e- <dig> 

from the gwas, we have not found any single snp that is significantly associated with hotspots from different chromosomes. the number of hotspots affected by each single snp was quite small compared with the sample size of  <dig>  hotspots. for the three snps, rs <dig>  rs <dig>  and rs <dig>  located inside prdm <dig> gene, we only find one significant association between the three snps and one hotspot on chromosome  <dig> as shown in figure  <dig>  for a trans-regulator like prdm <dig>  it is expected to show association with many hotspots, but it seems not the case according to our analysis. a reason might be that our gwas method does not have sufficient statistical power to capture the trans-regulatory signals, e.g. the association might have been eliminated due to low maf values in our pre-processing. it might also be the case that the assumption of two-allele recombination strengths  does not always apply for prdm <dig>  in addition, as demonstrated in  <cit> , the hotspot activity can be influenced by multiple loci including both cis- and trans-effects.

to see whether the hotspot-snp association is robust across different resolutions of recombination rate, we combined the recombination strengths of hotspots in the same chromosomes into  <dig> chromosome-wise recombination phenotypes. with the genotype of all tag snps, we did a gwas analysis for these  <dig> phenotypes. the manhattan plot in  <dig> shows the top  <dig> snps with significant associations . interestingly, these snps are mostly located near the ends of the chromosomes, implicating there might be an enrichment of regulators of genome stability at telomere regions of chromosomes. from the flanking dna sequences of these  <dig> significant snps, two motifs were found using dreme and they turned out to be the same as the motif  <dig> and motif  <dig> found earlier by gwas of individual hotspots, as shown in figure  <dig> 

mhc screening
recombination in the mhc  region on human chromosome  <dig> is of particular interest due to the roles of recombination in the generation of genetic diversity at hla  loci and the functions of mhc genes in the human immune system. many studies have shown some associations between susceptibility to autoimmune diseases and particular alleles of mhc genes  <cit> . however the functional relationship between recombination and polymorphism of genes in mhc is not clear yet. checking the gwas results of hotspots in the mhc region, we found  <dig> hotspots significantly associated with  <dig> snps  . all of these significantly associated snps are located inside the mhc region, except for two snps: rs <dig> on chromosome  <dig>  and rs <dig> on chromosome  <dig>  interestingly, the rs <dig> snp is located inside the gene of znf <dig> which is one of the zinc finger genes reported to be expressed in human t cells  <cit> . and rs <dig> is located in the gene of ksr <dig> which is a marker of immortalization, and was predicted to have a role in cell proliferation  <cit> . ksr <dig> also has association with the il- <dig> expression through mir- <dig> thereby affecting the t cell differentiation  <cit> . these findings suggest that both znf <dig> and ksr <dig> proteins may participate in the regulation of mhc activation or expression through the regulation of recombination in that region, which however needs to be verified through wet-lab experiments. overall, our gwas on mhc suggests that using arg-walker is promising to help search for trans-regulators through gwas.

CONCLUSIONS
in this paper, we proposed a method named arg-walker which is a graph mining algorithm for estimating individual-specific recombination strengths by random walks on ancestral recombination graphs. most existing ld-based algorithms can only estimate the average recombination rate of a population. to the best of our knowledge, arg-walker is the first computational method for estimating individual-specific strengths of recombination hotspots using only sequence polymorphism data. in most testing cases, arg-walker performed well. in our simulation, arg-walker can not only differentiate the recombination alleles of individuals, but also detect the cases of no variance in recombination frequency among individuals. applying arg-walker to the haplotype data of jpt+chb population of hapmap phase  <dig>  we detected strong cis-regulatory signals that can corroborate the function of the 13-mer prdm <dig> binding motif ccnccntnnccnc, which is known to be critical for the regulation of meiotic recombination hotspots of human. in gwas at both levels of hotspots and chromosomes, we identified two new motifs in the flanking regions of the significantly associated snps, i.e. aaaatana and cngcctcc, which could be cis-regulators for the meiotic recombination hotspots of the human genome. moreover, the significantly associated snps we detected in the combined chromosomal association study are mostly located near the ends of the chromosomes. it would be interesting to investigate the functional and evolutionary implication of this observation. by screening the gwas results on the mhc region, two trans-regulatory snps were detected, and the genes flanking these two snps are both functionally related with the t-cell activation, demonstrating the potential of arg-walker for the detection of trans-regulators of recombination hotspots. nonetheless, arg-walker and gwas of recombination hotspots could be further improved by incorporating more advanced algorithmic and statistical techniques and new types of data . moreover, it would be interesting to also apply arg-walker to understanding the relation of recombination hotspots with human autoimmune diseases.

list of abbreviations used
arg - ancestral recombination graph; ld - linkage disequilibrium; gwas - genome-wide association study; bgc - biased gene conversion; mhc - major histocompatibility complex; mfa - minor allele frequency.

competing interests
the authors declare that they have no competing interests.

authors' contributions
jz, tmp and py envisioned the idea behind the arg-walker method. ch and py implemented the arg-walker in perl script and conducted simulation analysis and gwas. hc and jz did the analysis of the gwas results. hc and jg did screening analysis on the mhc region. hc drafted the manuscript with input from jz, py, ckk and tmp. all authors read and approved the final manuscript.

supplementary material
additional file 1
python and perl scripts for generating simulation data. python scripts for generating simulated snp data, and perl scripts for pre-processing the snp data as input of arg-walker.

click here for file

 additional file 2
arg-walker source code. perl scripts for the implementation of arg-walker and a sample input file.

click here for file

 additional file 3
perl script for gwas and supplementary mhc screening result. a perl script for the implementation of gwas, and snps significantly associated with hotspots in the human mhc region.

click here for file

 acknowledgements
this work was supported by the following funding sources: moe acrf tier  <dig> grant rg32/ <dig> , moe acrf tier  <dig> seed fund on complexity rgc2/ <dig> , and moe acrf tier  <dig> grant arc6/ <dig> , ministry of education, singapore.

declaration
publication charges for this article were funded by the ministry of education, singapore.

this article has been published as part of bmc genomics volume  <dig> supplement  <dig>  2015: joint 26th genome informatics workshop and 14th international conference on bioinformatics: genomics. the full contents of the supplement are available online at http://www.biomedcentral.com/bmcgenomics/supplements/16/s <dig> 
