BACKGROUND
spectrophotometric measurements are ubiquitous for quantitative analyses of dynamic biological processes. in contrast, many other useful measurements require laborious sample treatment that may include separation or extractions, colorimetric reactions, electrophoresis as well as many other biochemical analyses. these latter measurements are generally done as endpoint or offline measurements. as opposed to the high temporal resolution of online measurements, offline measurements cannot generally be used to monitor a dynamic process with the same frequency. furthermore, when the analyses require sample destruction then the offline method can only be used for endpoint measurements. this raises the question whether offline measurements can be integrated with high-resolution online measurements for a more comprehensive examination of biological processes.

here, we propose a simple method to integrate cell growth data monitored at high temporal resolution with endpoint measurements of secreted metabolites that require offline sample treatment. the method takes advantage of the exponential growth of bacterial cultures  <cit> . for typical cell cultures, where growth curves are highly reproducible, the serial dilution of an inoculum will lead to growth curves that are shifted in time. the time-shift is the combination of a period of cell adaptation  and the time it takes for the culture to grow to detectable values of cell density. the total shift is longer in cultures started from lower concentrations because it takes more cell divisions to reach the detectable cell density. if the lag period is independent of cell density, then the growth curves are only shifted in time due to the differences in initial density and growth curves can be synchronized a posteriori by calculating the time-shift that maximizes the overlap between them. performing endpoint assays on cultures started at the same time but with different dilutions will then allow a time series of measurements to be reconstructed from the calculated time-shifts.

this approach of growth curve synchronization has several advantages over sampling a system at different times. firstly, the endpoint measurements can all be performed at the same time, thereby decreasing experimental variability. secondly, efficiency will be improved compared to processing multiple samples at different times. thirdly, no invasive sampling is necessary and the method requires no constant vigilance or presence. finally, as we discuss throughout the paper, it allows measuring the division rate of cells directly from optical density with very high precision.

we exemplify the growth curve synchronization method by analyzing rhamnolipid secretion by the bacterium pseudomonas aeruginosa. p. aeruginosa is an opportunistic human pathogen found in long-term, often terminal, infections in cystic fibrosis patients and various nosocomial infections occurring in immunocompromized patients  <cit> . rhamnolipids are among the predominant virulence factors of p. aeruginosa  <cit> . these glycolipid surfactants are involved in the formation and maintenance of biofilms, cytolysis of polymorphonuclear leukocytes  and swarming motility . their synthesis is regulated by quorum sensing, a mechanism for cell density-dependent gene regulation. as such, rhamnolipid secretion in p. aeruginosa is a valuable model system to investigate how pathogenic bacteria coordinate population-wide traits at the molecular level  <cit> .

the rhamnolipid quorum-sensing regulation consists of at least two hierarchical systems governed by two different autoinducers  <cit> . these two systems, called rhl and las, share a common motif. an autoinducer synthase  synthesizes the autoinducer -l-homoserine lactone or 3o-c12-hsl), which binds to its cognate transcription factor  that, in turn, up-regulates the autoinducer synthase in a positive feedback. lasr controls expression of rhlr, and thereby the las system is hierarchically above rhl. the rhl system induces expression of rhlab, resulting in rhamnolipid production  <cit> . in spite of this knowledge, the rhamnolipid system has puzzled microbiologists because it does not behave like the paradigm of quorum sensing  <cit> . in either rhli- or lasi- bacteria, adding autoinducers to the growth media does not induce rhamnolipid secretion from the outset of the culture, indicating there is at least one other factor regulating rhlab expression  <cit> .

here we illustrate our growth curve synchronization method by integrating high-resolution spectrophotometric measurements of cell density and gene expression with endpoint rhamnolipid quantification to produce multi-measurement time series of the latter. we monitor cell density by optical density at  <dig> nm, rhlab expression using a gfp reporter fusion under the control of the rhlab promoter  and secreted rhamnose using the sulfuric acid anthrone assay  <cit> . we also illustrate how this simple method can be used in combination with isogenic mutants lacking specific genes in the rhamnolipid synthesis or quorum sensing regulation to shed new light on the regulation of p. aeruginosa virulence.

methods
all chemicals were acquired from fisher scientific  unless specified.

bacterial strains
the strains used in this study are listed in table  <dig>  we used pseudomonas aeruginosa pa <dig> as the parental strain for all further constructions. a published gfp reporter fusion  <cit>  was cloned into wild-type pa <dig> cells . a clean rhamnolipid-deficient deletion mutant  was used to construct a strain with rhlab under the control of the arabinose-inducible pbad promoter  as well as a gfp reporter fusion strain . the quorum sensing signal negative strain  is a transposon insertion obtained from the pa <dig> non-redundant mutant library  <cit> . the gfp reporter fusion was also cloned into this strain, yielding p. aeruginosa pa <dig> rhli-/prhlab::gfp .

media and growth conditions
overnight starter cultures were inoculated directly from glycerol stocks into  <dig> ml of lb broth, miller  and incubated for 16- <dig> h at 37°c in a rotator shaker. growth curve assays in microtiter plates were carried out in minimal synthetic media with the following composition:  <dig> g/l of na2hpo <dig> h2o,  <dig> g/l of kh2po <dig>   <dig>  g/l of nacl,  <dig> mm of mgcl <dig>   <dig>  mm of cacl <dig>   <dig> grams of carbon per liter in glycerol and  <dig>  grams of nitrogen per liter in ammonium sulfate. when necessary, media were supplemented with either  <dig> %  l-arabinose  or  <dig> μm n-butyryl-l-homoserine lactone  to induce rhlab expression in ind or to activate the quorum sensing conditions for qsn, respectively.

microtiter plate assays
cells from overnight cultures were washed twice in  <dig> × phosphate-buffered saline . each of the serial dilutions was then diluted into minimal synthetic media at the appropriate dilution ratio in  <dig>  ml microcentrifuge tubes . at the lowest densities even small numbers of bacterial cells sticking to the walls of the tubes will introduce high variability. this problem can be avoided by systematically vortexing the bacteria immediately before transferring to new tubes or to the microtiter plate where the growth will be measured. growth assays were conducted in clear flat-bottom bd falcon 96-well plates , containing  <dig> replicates of  <dig> μl per sample . the plates were incubated at 37°c in a tecan infinite m <dig> plate reader  set to "incubation mode" with orbital shaking of  <dig> mm amplitude. optical density at  <dig> nm  and gfp fluorescence  were measured every  <dig> minutes for the duration of the assay .

anthrone assay to quantify rhamnolipids
after each assay, the eight replicates of each sample were pooled together in a microcentrifuge tube. the cells were spun down at  <dig>  rcf for  <dig> minutes. pooling the replicates will lead to considerable foaming because of rhamnolipids in the supernatant. this foam contains a significant amount of rhamnolipids and must therefore be collected.  <dig> μl of the supernatant were transferred to a new microcentrifuge tube. rhamnolipid extraction was then carried out twice via liquid-liquid extraction using  <dig> μl of chloroform:methanol at 2: <dig>  each time. when experiments had only four replicates we used a variation of this extraction protocol, transferring  <dig> μl of the supernatants and extracting with  <dig> μl of chloroform:methanol each time. the organic phases of both extractions were pooled and then evaporated to dryness in a vacufuge concentrator  at 60°c. each sample was subsequently re-suspended in  <dig> μl of pure methanol, so that the final rhamnolipid concentration is  <dig>  × higher than in the initial culture . quadruplicate samples of  <dig> μl each were then prepared together with quadruplicate samples of an l-rhamnose  ladder in a thermogrid 96-well pcr plate . the plate was put in iced water and  <dig> μl of anthrone  solution  in 70%  h2so4) were added to each sample before heating the entire plate to 80°c for  <dig> minutes. at this point the degree of blueness indicates the amount of rhamnose in a sample.  <dig> μl of each sample were then transferred to a clear flat-bottom 96-well plate and the absorbance was measured at  <dig> nm. the absorbance levels were converted to rhamnose concentration using the rhamnose calibration values.

computational alignment of growth curves
all growth curve analysis and plotting was carried out in matlab . an in-house algorithm  was written for time shift calculations, which maximizes time-series overlap between all possible permutations of different growth curves by minimizing the error of the median values. the minimization routine uses the function fminsearch from the matlab optimization toolbox, which is a derivative-free method to search for minima of unconstrained multivariable functions. the time-shifts  of the different curves were then used to recreate a time series of l-rhamnose quantifications.

RESULTS
mathematical model supporting the growth curve synchronization method
the range of inoculum densities that may be used for growth curve synchronization has both an upper and a lower limit. while one can determine these limits experimentally by testing whether the experiment works over a large range of values, the factors behind these constraints have the following straightforward theoretical explanation. the lower limit for initial cell density is set by small number statistics. if the inoculum is too dilute then there is a significant probability that some wells will not receive any cells. the probability of having empty wells can be calculated since the number of cells in the inoculum follows a poisson distribution. for example, in the extreme case where an inoculum has an average of  <dig> cell per replicate, the probability of having at least one replicate among eight with zero cells is 97%. the upper limit for inoculum density, on the other hand, is determined by the carrying capacity of the growth media. in order to guarantee reproducibility between growth curves started from inocula at different densities, the differences between the initial cell densities must be negligible compared to the carrying capacity yet they must not suffer from the small number statistics.

typical growth curves are subdivided into three phases  <cit> : a lag phase, an exponential phase and a stationary phase. the exponential phase starts when cells begin dividing at a constant rate, such that density increase follows   the stationary phase starts when growth slows down as the system approaches carrying capacity. decreasing growth rate can attributed to nutrient depletion, accumulation of metabolic waste or density-dependent growth regulation, among other things  <cit> . here, we formulate a mathematical model assuming that growth limitation is due to nutrient depletion, but the same analysis can be applied to any other limiting factor. without loss of generality we use monod's equation  <cit>  to model bacterial growth based on nutrient concentration   

where kn is the half-saturation constant. the nutrient concentration, initially n <dig>  decreases as a function of cell growth and the yield  such that at a time t it has the value  

the maximum cell density reached  is 

growth starts to slow down as nutrient levels decrease to levels close to the half-saturation constant, kn. for example, when n is equal to  <dig> × kn, the growth rate is theoretically ~95% of μmax. such a 5% decrease is typically undetectable by optical density measurements  <cit> . therefore, in theory, as long as the initial cell density is x <dig> <<y ×  <dig> × kn, variations in the inoculum density have negligible impact on growth curve reproducibility. this therefore sets an upper limit to the inoculum density.

besides the lower and upper limits of inoculum density, another important condition for the growth curve synchronization is that the lag phase must be independent of inoculum concentration. we can confirm if this is true by testing whether the time shift  between growth curves starting from cell densities x <dig> and x <dig>  obeys the following relationship  

below, we show how we tested this condition empirically for all growth curves aligned by calculating the linear regression between τ and ln .

application to virulence factor secretion by pseudomonas aeruginosa
we used high-resolution od <dig> curves of wild-type p. aeruginosa pa <dig> to demonstrate the growth curve synchronization method. the wild-type strain will be referred to as wt . figure  <dig> shows  <dig> growth curves obtained by serial dilution before  and after alignment . although visual inspection shows the alignment was successful, we evaluated the quality of the alignment by plotting the time delays  as a function of the log of the dilutions . for this case, we obtained r <dig> =  <dig> , which confirmed the alignment is appropriate and confirms that the lag phase is independent of inoculum density, which is a central requirement of our method. figure 1c shows gfp expression measured for the same samples. gfp expression is under the control of the rhlab-promoter, making gfp an indication of the expression of rhamnolipid synthesis genes. figure 1d shows the alignment of gfp expression obtained using the time delays calculated from the original synchronization based on od <dig>  this alignment shows that gene expression monitored by a reporter protein can be synchronized using the same time-shift, without the need for a separate calculation, again supporting our theoretical model.

next, we performed the same experiment for an isogenic mutant lacking the gene rhla  as a negative control . as for wt, the growth curves aligned well . an average growth curve and an average gfp expression curve were constructed, showing that neg cells would still express the rhla synthesis genes when entering the stationary phase if the gene was present . as expected, rhamnolipid secretion was undetectable .

we then used the same method for a signal-negative mutant, qsn, both in the absence and in the presence of autoinducer  supplied in the media. again, the growth curves aligned well for both conditions . as expected, the cells did not secrete rhamnolipids in the absence of c4-hsl , but the addition of  <dig> μm c4-hsl to the media restituted rhamnolipid production . importantly, although the amount of gene expression and rhamnolipid secretion in the presence of c4-hsl was lower than for wt both at the population-  and individual cell-level , the timing remained the same . this is consistent with previous observations that the time delay of the quorum sensing-controlled rhlab operon in signal-positive p. aeruginosa is maintained even when the medium is complemented with high concentrations of autoinducers  <cit> .

we then carried out experiments with an inducible strain , which expresses rhlab constitutively upon induction with l-arabinose. the purpose of this experiment was to provide a positive control showing that the only requirement for rhamnolipid secretion is the expression of rhlab  <cit> . the growth curves for this strain also aligned well . when ind was grown with  <dig> %  l-arabinose, rhamnolipid production was detected much earlier, starting already in the exponential phase, instead of at the beginning of the stationary phase .

time-shifts provide high precision measurement of growth rate
since the relation τ =  ln  governs the time shift  between different growth curves, τ can be plotted as a function of ln  yielding a straight line with a slope of 1/μmax. this allows calculating the maximum specific growth rate  from the growth curve synchronization. when performing this quantification, we observed that wt and neg have comparable growth rates , which was already shown qualitatively in previous experiments with rich media based on casamino acids and in direct competition experiments  <cit> . qsn also showed growth rates comparable to wt in the absence of c4-hsl . however, when c4-hsl was added to the media, qsn grew markedly slower . c4-hsl was solubilized in acetonitrile, but the addition of acetonitrile without autoinducer did not affect growth . to the best of our knowledge, this effect has not been observed before. the addition of  <dig> % l-arabinose to the growth media of ind did not affect their growth, as the growth rate was similar to wt cells .

discussion
we introduced the method of growth curve synchronization for the a posteriori synchronization of high-resolution time series and integration of online spectrophotometric data with endpoint measurements. we demonstrated the method with growth curve data from the opportunistic human pathogen pseudomonas aeruginosa pa <dig> and isogenic mutants. the quality of the growth-curve alignments was assessed by measuring the r2-values for the linear regression of the calculated time-shift  versus the logarithm the inoculum , a relationship that we formulated based on a simple mathematical model of exponentially growing cell cultures.

in addition to carrying out data integration, our method provides a high-precision measurement of maximum specific growth rate. figures  <dig> and  <dig> show the maximum specific growth rates  measured from the slope of the τ vs. ln. the average error of these measurements evaluated from the regression was  <dig> %. in the worst case, being qsn in the presence of c4-hsl , the error was  <dig> %. this precision is quite good for growth rates measured from optical density, approaching the 5% error reported for a high-precision bioluminescence-based method  <cit> . however, in contrast to a bioluminescence assay, our od-based method does not require introduction of a constitutively expressed luciferase reporter or the use of an expensive bioluminescence-capable reader.

besides serving as examples of the application of the growth curve synchronization method, the experiments reported here help to further clarify the regulation of rhamnolipid secretion in p. aeruginosa. the wt time series  show, as before  <cit> , that rhlab promoter-controlled gfp was expressed at the onset of the stationary phase. here we complement this observation by showing for the first time that the onset of rhamnolipid production follows the same timing as the gene expression using the reconstructed time series of rhamnolipid secretion . this supports biochemical studies suggesting that expression of rhlab is the main step controlling the start of rhamnolipid synthesis  <cit> . the strain with the reporter fusion in the Δrhla background  showed that up-regulation of the gene is still active and that cells would still produce rhamnolipids if rhla was not deleted . the fact that the timing and quantity of gfp expression for this strain  resembles that of wt expression  suggests that there is no feedback of biosurfactant synthesis on the expression of rhlab. our experiments also confirmed that cells lacking autoinducer synthesis  do not express rhlab nor produce rhamnolipids in the absence of autoinducer . as expected, both rhlab expression and rhamnolipid secretion were recovered when the autoinducer was supplied in the medium . interestingly, however, even in the presence of autoinducer in the medium rhlab expression and rhamnolipid secretion were not constitutive but rather the delay until entry into the stationary phase  that is characteristic of the wild-type was maintained. we then confirmed that it is, in fact, possible for p. aeruginosa to start rhamnolipid secretion earlier in growth by using an rhlab-inducible strain . with the level of inducer used  l-arabinose) ind started rhamnolipid secretion already in the exponential phase of growth . taken together our observations further support that rhamnolipid secretion has additional regulation besides quorum sensing. such regulation was recently proposed to be a molecular mechanism of metabolic prudence that stabilizes swarming motility against evolutionary 'cheaters'  <cit> .

our measurements are population averages even though systems biology is increasingly focusing on single-cell measurements. however, there is presently no method to measure rhamnose secretions in single cells. nonetheless, reconstruction of distributions of single-cell gene expression is possible using reporter fusions either by fluorescence microscopy  <cit>  or flow-cytometry  <cit> . such single-cell measurements can be carried out offline and reconstructed into time series using our method of growth curve synchronization. the colorimetric anthrone assay used here measures the amount of rhamnose, which is an indication of the amount of rhamnolipids. this does not necessarily correspond linearly to the mass of rhamnolipids secreted. the rhamnolipids secreted by p. aeruginosa can have variable composition  and rhamnolipids exist both in mono- and di-l-rhamnose forms. methods such as thin layer chromatography, to distinguish the mono-l-rhamnose from di-l-rhamnose rhamnolipids, or mass spectrometry  <cit>  allow more precise measurements. these analyses could be used to complement reconstructed time series and help further characterize the regulation of rhamnolipids, which are important virulence factors for p. aeruginosa  <cit> . in the long term, unveiling the molecular mechanisms regulating the timing and quantity of rhamnolipid secretion can lead to the rational development of new therapies that specifically target virulent secretions to fight p. aeruginosa infection.

cell density in bacterial and other cell populations is often monitored by optical density at  <dig> nm , in spite of its inherent noisiness and limited dynamic range. for this reason, we chose to apply our method to time series of od <dig>  we envision that any other high-resolution time series data should be useable for aligning curves, including fluorescence or bioluminescence. the only requirement is that the calculated time delays and inoculum dilution must have a linear relationship for the range of inoculum concentrations used . the alignment method we used was an algorithm developed specifically for our purpose . nevertheless, any other algorithm that aligns sets of growth curves and that determines concomitant time delays can in principle be used. we also tested our analysis by aligning the growth curves visually. although the visual alignment gave acceptable results , an automated method using an unsupervised yet robust algorithm such as the one provided here is preferable for speed and consistency .

the method introduced here can potentially be applied to many other experimental problems that have exponentially growing cultures and where the integration of online and offline measurements is desired. besides the growth of p. aeruginosa and its rhamnolipid secretion, another example is indole production by altruistic bacteria  <cit> . indole was found to be important for antibiotic resistance of bacterial populations, but the secreted quantities must be assessed through offline measurements. growth curve synchronization could be used to quantify the timing and quantity of indole production and help further elucidate the population dynamics. our method could also be extended to include other online measurements such as ph quantification by color change of ph indicators . other endpoint measurements that can be integrated include direct measurements of gene expression , quantifications of metabolite levels or protein quantities.

CONCLUSIONS
the method of growth curve synchronization proposed here provides a simple, inexpensive solution to integrate rich time-resolved data with endpoint measurements. like other model-based data integration methods  <cit> , our method aims at a major limitation in systems biology -the scarceness of high quality time-resolved quantitative data. in the specific case of p. aeruginosa, this method can be used to validate and complement metabolic models. for example, the fluxes of secreted secondary metabolites measured for isogenic mutants can help further refine metabolic models from whole genome reconstruction  <cit> . beyond p. aeruginosa, growth curve synchronization can be a general method to help unravel regulation dynamics in biological systems.

competing interests
the authors declare that they have no competing interests.

list of abbreviations
μmax : maximum specific growth rate; λexcitation : excitation wavelength; λemission : emission wavelength; τ: timeshift; 3o-c12-hsl: n--l-homoserine lactone; c4-hsl: n-butyryl-l-homoserine lactone; gfp: green fluorescent protein; ind: strain with inducible rhamnolipid promoter; lb: lysogeny broth; neg: rhamnolipid-deficient strain with gfp reporter fusion; od <dig> : optical density at  <dig> nm; pbs: phosphate-buffered saline; pmn: polymorphonuclear leukocyte; rcf: relative centrifugal force; qrt-pcr: quantitative reverse transcription polymerase chain reaction; qsn: quorum sensing-negative strain with gfp reporter fusion; wt: wild-type strain with gfp reporter fusion.

authors' contributions
dd conceived the study, performed the experiments, analyzed and interpreted the data and wrote the paper. jxb conceived the study, wrote the alignment algorithm, interpreted the data and wrote the paper. all authors read and approved the final manuscript.

additional files
general comments

in order to run the matlab demonstration  place the two. csv files  in the same folder. inside of this latter folder both of the .m files should be saved. the matlab code was written for matlab r2010a with the statistics and optimization toolboxes.

supplementary material
additional file 1
matlab-based growth curve synchronization algorithm. this is the main algorithm for growth curve alignment. the script calls additionalfile <dig> m and uses functions from the statistics and optimization toolboxes. the program draws plots of the data before alignment, after alignment, a time series of rhamnolipid production and the time shift versus dilution, yielding the growth rate.

click here for file

 additional file 2
matlab suite. additionalfile <dig> m is a matlab file implementing a suite of functions for reading, processing and plotting growth curve data.

click here for file

 additional file 3
raw data file for growth curve synchronization. this file contains the raw data from a typical growth curve synchronization experiment. in this document, all the data is included, started with the optical density measurement  and then the gfp measurement . time is given in seconds. the first  <dig> samples  are the blank, the second set of eight  are from the culture inoculated at  <dig>  od <dig>  etc. the ninth set of eight  contain the last set of data, the last sets  are empty wells. this is one of the files used by the matlab algorithm  in order to synchronize the growth curves.

click here for file

 additional file 4
rhamnose quantification for different time points. this file contains an example of rhamnose quantification from the sulfuric acid anthrone assay. the first column is from the sample inoculated at  <dig>  od <dig>  with subsequent dilutions for the following columns. the data is pre-processed for blank and averaged over four replicates, as well as normalized compared to a standard ladder of rhamnose. the first row is the average, the second row the maximal value and the third row the minimal value. this second file allows for the time series of rhamnolipids to be constructed.

click here for file

 additional file 5
excel-based growth curve synchronization. excel implementation of growth curve synchronization. includes a spreadsheet readme that explains the procedure. the included example uses the same data as the matlab example.

click here for file

 acknowledgements and funding
the authors would like to thank justina sanny for cloning the reporter fusion strains and comments on the manuscript. additional thanks go to vanni bucci, laura de vargas roditi, will chang and alex root for comments on the manuscript. this work was supported by a seed grant from the lucille castori center for microbes, inflammation and cancer.
