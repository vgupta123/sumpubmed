BACKGROUND
during the last decade microarrays have become the technology of choice for dissecting the genes responsible for a phenotype. by monitoring the activity of virtually all the genes from a sample in a single experiment they offer a unique perspective for explaining the global genetic picture of a variant, whether a diseased individual or a sample subject to whatever stressing conditions. however, this strength is also their major weakness, and has led to the "gene list" syndrome. following careful experimental design and data analysis, the result of an experiment with microarrays is often summarized as a list of genes that are differentially expressed between two conditions, or that allow samples to be classified according to their phenotypic features. once this list of genes, typically a few hundreds, as been obtained, its meaning still has to be deciphered, but the automated translation of the list into biological interpretation is often challenging.

the interpretation of the results in terms of biological functions and pathways involving several genes is of particular interest. many databases and tools help verify a posteriori whether genes known to co-operate in some biological process are found in the list of genes selected. for example, gene ontology  <cit> , biocarta  <cit> , genmapp  <cit>  and kegg  <cit>  all allow a list of genes to be crossed with biological functions and genetic networks, including metabolic, signalling or other regulation pathways. basic statistical analysis  can then determine whether a pathway is over-represented in the list, and whether it is over-activated or under-activated. however, one can argue that introducing information on the pathway at this point in the analysis process sacrifices some statistical power to the simplicity of the approach. for example, a small but coherent difference in the expression of all the genes in a pathway should be more significant than a larger difference occurring in unrelated genes.

there is therefore a pressing need for methods integrating a priori pathway knowledge in the gene expression analysis process, and several attempts have been carried out in that direction so far. several authors have used a priori known gene networks to derive models and constraints for gene expression. for example, logical discrete formalism  <cit>  can be used to analyse all the possible steady states of a biochemical reaction network described by positive and negative influences and can determine whether the observed gene expression may be explained by a perturbation of the network. if only the signs of the concentration differences between two steady states are considered, it is possible to solve the corresponding laplace equation in sign algebra  <cit> , giving qualitative predictions for the signs of the concentration differences measured by microarrays. other approaches, such as the metareg formalism  <cit> , have also been used to predict possible gene expression patterns from the network structure, although these approaches adhere less to the formal theory of biochemical reaction networks.

unfortunately, methods based on network models are rarely satisfactory because detailed quantitative knowledge of the complete reaction network parameters is often lacking, or only fragments of the network structure are available. in these cases, more phenomenological approaches need to be used. pathway scoring methods try to detect perturbated "modules" or network pathways while ignoring the detailed network topology . it is assumed that the genes inside a module are co-ordinately expressed, and thus a perturbation is likely to affect many of them.

with available databases containing tens of thousands of reactions and interactions , the problem is how to integrate the detailed graph of gene interactions  into the core microarray data analysis. some promising results have been reported with regard to this problem.  <cit>  developed a method for correlating interaction graphs and different types of quantitative data, and  <cit>  showed that explicitly taking the pathway distance between pairs of genes into account enhances the statistical scores when identifying activated pathways. the co-clustering of gene expression and gene networks has been reported  <cit> , and a dimension reduction method, called "network component analysis"  <cit> , was proposed to construct linear models of gene regulation based on a priori known network information. the patika project  <cit>  proposed a score to quantify the compatibility of a pathway with a given microarray data, and in  <cit>  a network topology extracted from literature was used jointly with microarray data to find significantly affected pathway regulators.

in this paper, we investigate a different approach for integrating gene network knowledge early in the gene expression analysis. by "gene network" we mean any graph with genes as vertices, and where edges between genes can represent various biological information. for example, an edge between two genes could represent the fact that their products interact physically , the presence of a genetic interaction such as a synthetic-lethal or suppressor interaction  <cit> , or the fact that these genes code for enzymes that catalyse successive chemical reactions in a pathway . as an illustration we focus on the latter case in this article, although the method proposed is not limited to the metabolic network. our approach is based on the biological hypothesis that genes close on the network are likely to have similar expression, and consequently that noisy measures of gene expression, such as those obtained by microarrays, can be denoised to some extent by extracting their "low-frequency" component on the gene network. in the case of the metabolic gene network of the yeast s. cerevisiae considered in this study, this biological hypothesis is motivated by previous observations that genes coding for enzymes involved in a common process are often co-regulated ensuring the presence of all the necessary proteins  <cit> .

the approach is formally based on the spectral decomposition of the gene expression measurements with respect to the gene network seen as a graph, followed by an attenuation of the high-frequency components of the expression vectors with respect to the topology of the graph. we show how to derive unsupervised clustering and supervised classification algorithms for expression profiles, resulting in classifiers that can be easily interpreted in terms of pathways. we illustrate the relevance of our approach by analysing a gene expression dataset monitoring the transcriptional response of irradiated and non-irradiated yeast colonies  <cit> . we show that by filtering out 80% of the eigenmodes of the kegg metabolic network in the gene expression profile, we obtain accurate and interpretable discriminative model that may lead to new biological insights.

data
we collected the expression data from a study analysing the effect of low irradiation doses on saccharomyces cerevisiae strains  <cit> . the first group of extracted expression profiles was a set of twelve independent yeast cultures grown without radiation . from this group, we excluded an outlier that the author of the article indicated to us. the second group was a set of six independent irradiated  cultures exposed to a dose of 15– <dig> mgy/h for  <dig> h. this dose of irradiation produces no mutagenic effects, but induces transcriptional changes. we used the same normalisation method as in the first study of this data , then we attempted  to separate the ni samples from the i ones, and  to understand the difference between the two populations in terms of metabolic pathways.

the gene network model used to analyse the gene expression data was therefore built from the kegg database of metabolic pathways  <cit> . the metabolic gene network is a graph in which the enzymes are vertices and the edges between two enzymes indicate that the product of a reaction catalysed by the first enzyme is the substrate of the reaction catalysed by the second enzyme. we reconstructed this network from the kgml v <dig>  version of kegg, resulting in  <dig> edges between  <dig> genes. we kept only the largest connected component  for further spectral analysis.

RESULTS
unsupervised classification
first, we tested the general effect of modifying the distances between expression profiles using the kegg metabolic pathways as background information in an unsupervised setting. we calculated the pairwise distances between all  <dig> expression profiles after applying the transformations defined by the filters  and , over a wide range of parameters. we assessed whether the resulting distances were more coherent with a biological intepretation by calculating the ratio of intraclass distances over all pairwise distances, defined by:

r=∑u <dig> v1∈v1d2+∑u <dig> v2∈v2d2∑u,v∈vd <dig> 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgybgccqgh9aqpdawcaaqaamaaqababagaemizaqmaeiikagiaemydau3aasbaasqaaiabigdaxaqabagccqggsaalcqwg2bgddawgaawcbagaegymaedabeaakiabcmcapmaacaaaleqabagaegomaidaaaqaaiabdwha1naabaaameaacqaixaqmaeqaasgaeiilawiaemoday3aasbaawqaaiabigdaxaqabawccqghiiizcqwgwbgvdawgaaadbagaegymaedabeaaasqab0gaeyyeiuoakiabgucarmaaqababagaemizaqmaeiikagiaemydau3aasbaasqaaiabikdayaqabagccqggsaalcqwg2bgddawgaawcbagaegomaidabeaakiabcmcapmaacaaaleqabagaegomaidaaaqaaiabdwha1naabaaameaacqaiyagmaeqaasgaeiilawiaemoday3aasbaawqaaiabikdayaqabawccqghiiizcqwgwbgvdawgaaadbagaegomaidabeaaasqab0gaeyyeiuoaaoqaamaaqababagaemizaqmaeiikagiaemydaunaeiilawiaemodaynaeiykakyaawbaasqabeaacqaiyagmaaaabagaemydaunaeiilawiaemodaynaeyici4saemovayfabeqdcqghris5aaaakiabcycasaaa@6d6a@

where v <dig> and v <dig> are the two classes of points. we compared the results with those obtained by replacing kegg with a random network, produced by keeping the same graph structure but randomly permutating the vertices, in order to assess the significance of the results. we generated  <dig> such networks to give an average result with a standard deviation. figure  <dig> shows the result for the function φexp = exp with varying β , and for the function φthres =  <dig> for varying λ <dig> . we observe that, apart from very small values of β, the change of metric with the φexp function performs worse than that of a random network. the second method , in which up to 80% of the eigenvectors are removed, performs significantly better than that of a random network. when only the top 3% of the smoothest eigenvectors are kept, the performance is similar to that of a random network, and when only the top 1% is kept, the performance is significantly worse. this explains the disappointing results obtained with the φexp function: by giving more weight to the small eigenvalues exponentially, the method focuses on those first few eigenvectors that, as shown by the second method, do not provide a geometry compatible with the separation of samples into two classes. from the second plot, we can infer that at least 20% of the kegg eigenvectors should be given sufficient weight to obtain a geometry compatible with the classification of the data in this case.

pca analysis
we carried out a principal component analysis  on the original expression vectors f and compared this with a pca of the transformed set of vectors sφ  obtained with the function φthres to further investigate the effect of filtering out the high frequencies of the expression profiles on their relative positions.

analysis of the initial sample distribution  shows that the first principal component can partially separate irradiated from non-irradiated samples, with exception of the two irradiated samples "i1" and "i2", as they have larger projections onto the third principal component than onto the first one. the experimental protocol revealed that these two samples were affected by higher doses of radiation than the four other samples.

gene ontology analysis of the genes that contribute most to the first principal component shows that " pyruvate metabolism", " glucose metabolism", " carbohydrate metabolism", and " ergosterol biosynthesis" ontologies  are over-represented . the second component is associated with " trehalose biosynthesis", and " carboxylic acid metabolism" ontologies and the third principal component is associated with the kegg glycolysis pathway. the first three principal components collect 25%, 17% and 11% of the total dispersion.

the transformation  resulting from a step-like attenuation of eigenvalues φthres removing 80% of the largest eigenvalues significantly changes the global layout of data  but generally preserves the local neighbourhood relationships. the first three principal components collect 28%, 20% and 12% of the total dispersion, which is only slightly higher than the pca plot of the initial profiles. the general tendency is that the non-irradiated normal samples are more closely grouped, which explains the lower intraclass distance values shown in figure  <dig>  the principal components in this case allows them to be associated with gene ontologies with higher confidence . this is a direct consequence of the fact that the principal components are constrained to belong to a subspace of smooth functions on kegg, giving coherence in terms of pathways to the genes contributing to the components. the first component give "dna-directed rna polymerase activity", "rna polymerase complex" and " protein kinase activity". figure  <dig> shows that these are the most connected clusters of the whole kegg network. the second component is associated with "purine ribonucleotide metabolism", "rna polymerase complex", "carboxylic acid metabolism" and "acetyl-coa metabolism" ontologies and also with "glycolysis/gluconeogenesis", "citrate cycle " and "reductive carboxylate cycle " kegg pathways. the third component is associated with "prenyltransferase activity", "lyase activity" and "aspartate family amino acid metabolism" ontologies and with "n-glycan biosynthesis", "glycerophospholipid metabolism", "alanine and aspartate metabolism" and "riboflavin metabolism" kegg pathways. thus, the pca components of the transformed expression profiles are affected both by network features and by the microarray data.

supervised classification
we tested the performance of supervised classification after modifying the distances with a support vector machine  trained to discriminate irradiated samples from non-irradiated samples. for each change of metric, we estimated the performance of the svm from the total number of misclassifications and the total hinge loss using a "leave-one-out"  approach. this approach removes each sample in turn, trains a classifier on the remaining samples and then tests the resulting classifier on the removed sample. for each fold, the regularisation parameter was selected from the training set only by minimising the classification error estimated with an internal loo experiment. the calculations were carried out using the svmpath package in the r computing environment.

interpretation of the svm classifier
although from a biological point of view, very little can be learned from the classifier obtained in the original euclidean space , it is indeed possible to distinguish several features of interest for the classifier obtained in the second case . first, oxidative phosphorylation is found among the pathways with the most positive weights, which is consistent with previous analyses showing that this pathway tends to be up-regulated after irradiation  <cit> . an important cluster involving the dna and rna polymerases is also found to bear weights slightly above average in these experiments. several studies have previously reported the induction of genes involved in replication and repair after high doses of irradiation  <cit> , but the detection of such an induction at the low irradiation doses used in the present biological experiments is rather interesting. the strongly negative landscape of weights in the protein kinases cluster has not been seen before and may lead to a new area of biological study. most of the kinases are involved in signalling pathways, and therefore their low expression levels may have important biological consequences.

discussion
our algorithm constructs a classifier in which the predictor variables are grouped according to their neighborhood relations in the network. we assume that the genes close on the network are likely to contribute similarly to the prediction function. our working hypothesis is that the genes close on the network should have similar expression profiles. this hypothesis was validated in several studies that demonstrate that co-expressed genes tend to have similar biological functions and vice versa . our mathematical framework based on spectral decomposition helps to systematically exploit this experimental fact and include it into data analysis.

nevertheless, one must understand that this tendency is only a trend, valid when we take the average on a large scale. it is of course possible to find many local exceptions to this trend, for example when a signaling pathway or a metabolic cascade is influenced by over- or under-expression of only one regulator without systematically affecting the expression of the rest of the pathway participants. thus, our technique is rather coarse-grained, it does not allow to infer a precise network logic but rather detects average excitation of relatively big network modules.

in our example we use a metabolic network as gene network. our hypothesis here is based on the fact that for a smooth synthesis flow, all enzymes required for a metabolic cascade should be present in sufficient quantities, i.e., stably expressed. on the opposite, various sensor and feedback mechanisms ensure that for inactive metabolic cascades the expression of corresponding enzymes remains low. if this is true on average then our technique will help to highlight active and inactive parts of the network. several previous studies have highlighted the significant correlation that exists between gene expression and distance over the metabolic network, thus justifying our attempt  <cit> . for other network types, like transcriptional regulatory or signalling network, more elaborated measures of " smoothness" are certainly needed to take into account signs and directions of individual gene interactions.

our working hypothesis motivates the filtering of gene expression profile in order to remove the noisy high-frequency modes of the network. therefore, the variation of the weights of the classifier along the graph are of low frequency and should allow grouping of variables, which is a very useful feature of the resulting classification function as the function becomes meaningful for interpreting and suggesting biological factors that cause the class separation. it allows classifications based on functions, pathways and network modules rather than on individual genes. classification based on pathways and network modules should lead to a more robust behaviour of the classifier in independent tests with equal if not better classification results. our results on the dataset we analysed show only a slight improvement, although this may be due to its limited size. the two samples with different experimental settings are systematically misclassified in both the initial and our smoothed classifier which means that they probably are members of a " third" class which should be treated differently. introduction of network topology can not resolve this issue but can help to understand which part of the network differentiate the outliers from the other members of the same class.

interestingly, the constraint we impose on the smoothness of the classifier can also be justified mathematically in the context of regularisation for statistical estimation. classification of microarray data is an extremely challenging problem because it usually involves a small number of samples in large dimension. most statistical procedures developed in this context involve some form of complexity reduction by imposing some constraints on the classifier. for example, perhaps the most widely-used complexity reduction method for microarray data is to impose that the classifier has only a small number of non-zero weights, which in practice amounts to selecting a small number of genes. mathematically speaking, this means constraining the l <dig> norm of the classifier to be small . alternatively, methods like svm constrain the l <dig> norm of the classifier to be small. our method can therefore be seen as just constraining a different norm of the classifier, for the purpose of regularisation. of course the choice of regularisation should be related to the problem at hand: it corresponds to our prior belief of what the optimal classifier, that would be discovered if enough samples were available, looks like. performing feature selection implicitly corresponds to the assumption that the optimal classifier relies on a small number of genes, which can be a reasonable assumption in some cases. our focus on the smoothness of the classifier on the gene network corresponds to a different implicit assumption, namely, that the optimal classifier is likely to be so. this is justified in many cases because the classes of samples to be predicted generally correspond to differences in the regulation of one or several pathways. of course if this turns out not to be the case, reducing the effect of regularisation by decreasing the parameter c in  allows a non-smooth classifier to be learned as well.

an important remark to bear in mind when interpreting pictures such as figures  <dig> and  <dig> is that the colors represent the weights of the classifier, and not gene expression levels. there is of course a relationship between the classifier weights and the typical expression levels of genes in irradiated and non-irradiated samples: irradiated samples tend to have expression profiles positively correlated with the classifier, while non-irradiated samples tend to be negatively correlated. roughly speaking, the classifier tries to find a smooth function that has this property. this means in particular that the pictures provide virtually no information regarding the over- or under-expression of individual genes, which is the cost to pay to obtain instead an interpretation in terms of more global pathways. constraining the classifier to rely on just a few genes would have a similar effect of reducing the complexity of the problem, but would lead to a more difficult interpretation in terms of pathways.

an important advantage of our approach over other pathway-based clustering methods is that we consider the network modules that naturally appear from spectral analysis rather than a historically defined separation of the network into pathways. thus, pathways cross-talking is taken into account, which is difficult to do using other approaches. it can however be noticed that the implicit decomposition into pathways that we obtain is biased by the very incomplete knowledge of the network and that certain regions of the network are better understood, leading to a higher connection concentration.

another important feature of this approach is that we make no strong assumption on the nature of the graph, and that the method can in principle be applied with a variety of other graphs, such as protein-protein interaction networks or co-expression networks. we leave this avenue open for future research.

on the other hand, like most approaches aiming at comparing expression data with gene networks such as kegg, the scope of this work is limited by two important constraints. first the gene network we use is only a convenient but rough approximation to describe complex biochemical processes; second, the transcriptional analysis of a sample can not give any information regarding post-transcriptional regulation and modifications. nevertheless, we believe that our basic assumptions remain valid, in that we assume that the expression of the genes belonging to the same metabolic pathways module are coordinately regulated. our interpretation of the results supports this assumption.

another important caveat is that we simplify the network description as an undirected graph of interactions. although this would seem to be relevant for simplifying the description of, e.g., protein-protein interaction networks, in reality metabolic networks have a more complex nature. similarly, gene regulation networks are influenced by the direction, sign and importance of the interaction. although the incorporation of weights into the laplacian  is straightforward and allows the extension of the approach to weighted undirected graphs, the choice of the weights remains delicate since the importance of an interaction may be difficult to quantify. conversely the directions and signs that accompany signalling or regulatory pathways are generally known, but their incorporation requires more work. it could nevertheless lead to important advances for the interpretation of microarray data in cancer studies, for example.

CONCLUSIONS
we have presented a general framework to analyse gene expression data when a gene network is known a priori. the approach involves the attenuation of the high-frequency content of the gene expression vectors with respect to the graph. we derived algorithms for unsupervised clustering and supervised classification, which enforce some level of smoothness on the gene network for the classifier. this enforcement can be considered as a means of reducing the high dimension of the variable space, using the available knowledge about gene network. no prior decomposition of the gene network into modules or pathways is needed, and the method can work in principle with a variety of gene networks.

