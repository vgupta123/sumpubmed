BACKGROUND
abattoir post-mortem inspection offers good opportunities for pig health monitoring  <cit>  and it has been widely used as a data source for epidemiology-based analyses. most of these studies focus on the identification of risk factors influencing the presence of the major abattoir pathologies: pneumonia, pleurisy and milk spot liver  <cit> . few reports investigate how the different pathologies are interrelated  <cit> . identification of the associations between pathologies may assist in elucidating theories on their biological connection and could greatly contribute to facilitating their control – for example by encouraging veterinarians to establish intervention strategies aimed at reducing the prevalence of not just one, but two or more conditions simultaneously. knowledge of associations between lesions could also be employed to inform official abattoir inspection systems, in which the presence of one pathol ogy could trigger an inspection for others.

official routine meat inspections are implemented world-wide with the main objective of ensuring food safety. this system, however, is imperfect and is particularly lacking in sensitivity  <cit> . pig health schemes were proposed to provide an integrated system to capture abattoir information based on more detailed post-mortem inspection  <cit>  which is considered to improve classification characteristics, particularly sensitivity  <cit> . good examples of these initiatives in europe are the british pig health schemes. on a regular basis, swine specialists carry out detailed post-mortem examinations in parallel to the official food-safety routine meat inspections. these schemes monitor the presence of various pathologies detected by means of a detailed inspection of the pluck and the skin of the slaughtered pig. these pathologies are normally associated with a reduction in performance traits or are potential indicators of the presence of welfare problems in the herds  <cit> .

graphical modelling has been increasingly used in veterinary epidemiology to investigate and express the relationships between factors influencing diseased/unproductive status in livestock  <cit> . frequently, studies utilising graphical models are based on structure discovery approaches, which are data-driven multivariate methodologies resulting in graphical outputs such as networks or path/chain models. structure discovery has been employed to explore how mastitis and fertility management influence production in dairy herds  <cit> ; to identify changes in pig behaviour related to early piglets mortality  <cit> ; to investigate the most likely pathogens involved in clinical mastitis in dairy cows  <cit> ; and to identify those farm risk factors associated with bovine viral diarrhoea  <cit> . besides these examples, other studies employed graphical models informed using existing/expert knowledge to describe risk factors influencing the prevalence of mycoplasma hyopneumoniae  <cit> ; and to estimate the risk of leg disorders in finishing pigs  <cit> . a crucial distinction among the abovementioned papers, is that these two latter studies  <cit>  did not use structure discovery to inform structure of the network, but were rather based on published knowledge and expert opinion. the latter is highly subjective and if, as in this study, extensive data are available, then extracting the co-dependence network structure from observed data provides objective and robust empirical analyses.

multi-dimensional machine learning methodology  is a variety of graphical modelling structure discovery techniques used to identify the dependency structure that encodes the joint probability distribution between variables  <cit> , allowing for both visualization and estimation of associations. in short, this process consists of a series of model searches to identify the multi-dimensional model that best explains the data, using bayes factors to compare between models  <cit> . this approach allows estimation of the associations between variables and distinguishes between direct and indirect dependence  <cit>  , contributing to generate hypotheses about the nature of the interrelationships. multi-dimensional machine learning methodology offers an intuitively appealing and technically elegant way to investigate multiple associations between variables compared to more conventional multivariate statistical approaches . this methodology is used extensively in fields such as bioinformatics and genetics  <cit>  and only recently has been applied in the veterinary field  <cit> .

this paper uses a multi-dimensional machine learning methodology to identify whether associations exist between the different pathologies reported by the british pig health schemes. the results of this study could assist veterinarians in the control of these conditions by implementing strategies to control several conditions at once. these results could be also utilised to review current pig abattoir inspection strategies, and inform more targeted risk based inspections. farmed pigs are normally considered as a grouped unit, where complex interactions take place between the environment, mainly determined by the housing system and the husbandry practices, and the pigs, characterised by their genetics, idiosyncratic behaviour and baseline health status  <cit> . for these reasons this study focuses on the interrelationship occurring between pathologies at batch level.

methods
data source
abattoir data were accessed through the databases of the two pig abattoir lesion scoring health schemes which exist in great britain: wholesome pigs scotland   and british pig health scheme    <cit> . the health schemes provide services in  <dig> pig abattoirs. both schemes obtain a sample from each batch of pigs by assessing every second pig on the slaughter line. the scoring was carried out by swine veterinarians trained in this method of testing on the abattoir inspection line. the data were from a three year period .

dataset
for the purpose of this investigation, a batch is defined as a group of pigs from a single farm submitted to the abattoir on a particular date. a total of  <dig> batches were included, submitted from  <dig> farms, with a median of  <dig> batches assessed per farm . all the batches consisted of exactly  <dig> pigs assessed.

scoring for the different pathologies
ten pathologies reported by the health schemes are included in this study: enzootic-pneumonia-like lesions, pleurisy , milk spots, hepatic scarring, pericarditis, peritonitis,  abscess, pyaemia , tail damage and papular dermatitis. a further explanation on the gross pathology description, the most typical cause associated and the scoring system for each condition are presented in table  <dig>  in this study, a positive case for each pathology was defined as a pig affected with any degree of lesion and a negative when lesions were absent.

consistency in the scoring of the pathologies
both health schemes carried out exercises to standardise the definition of each lesion across the inspectors. one wps assessor was involved in the training of all the other inspectors that carried out wps and bphs assessments during the three year period included in this study. once a year, all the inspectors underwent a refresher/training day where the same pigs and pathologies were assessed by all the assessors and feed-back was provided by the trainer. these assessment exercises aimed to maintain the consistency in the scoring criteria across assessors by identifying and correcting potential misclassifications. furthermore, the schemes aimed to include at least two assessors per abattoir and to place each assessor in at least two different abattoirs, thereby minimising the potential of operator bias.

definition of pathology batch-status variables
the machine learning approach utilised requires working with categorical variables. batches were categorised into lesion present/absent using the frequency distribution of the batch prevalence for the different pathologies to determine data-derived cut-off points . in the context of this study, where all the batches have the same number of pigs inspected , frequency and proportion are equivalent and the cut–offs are defined in terms of frequencies per batch. for enzootic pneumonia-like lesions, three categories were identified based on within batch prevalence: ep high) when more than  <dig> pigs were affected with any degree of severity; ep moderate-low) when between one and  <dig> pigs were affected; and ep zero) when no pigs were affected. for pleurisy, thee categories were also identified based on within batch prevalence: pl high) when more than seven pigs were affected; pl moderate-low) when between one and seven pigs were affected and pl zero) when no pigs were affected. the three prevalence level categories identified for enzootic pneumonia-like lesions and pleurisy were each separated into three binary variables  to reflect the pathology batch-status. splitting the prevalence level categories into three binary variables was chosen over creating a single multinomial variable to add flexibility in the modelling and facilitate the interpretation of the model outputs. for the other pathologies which have a much lower prevalence  batches were considered positive if at least one pig was found affected, and negative otherwise. in summary, the ten different pathologies were studied through  <dig> binary variables reflecting the pathology batch-status. a data break-down of the frequencies for the pathology batch-status variables is presented by pairs in table  <dig> 

abbreviations/initials: ep, enzootic pneumonia-like lesions; pl, pleurisy; ms, milk spots; hs, hepatic scarring, pc, pericarditis; pt, peritonitis; abs., abscess; pya., pyaemia; tail, tail damage; pd, papular dermatitis; m/l, moderate/low.

multi-dimensional machine learning methodology
the process explained below aims to identify an optimal multi-dimensional model, i.e. a graphical model displayed as a network of connections, where each connection  describes a statistically significant association between the different lesions in the data. figure  <dig> schematically represents the machine leaning structure discovery process utilised, which is initiated with numerous series of searches followed by steps to summarise the results of each search. this methodology consists of fitting models which are network structures technically referred to as directed acyclic graphs , in which nodes correspond to the pathology batch-status variables and arcs between nodes  indicate that a direct probabilistic dependency  exist between nodes.

direction of the arrows
the direction of the arcs connecting nodes is informed by the data, reflecting the dependency structure which generated the data  <cit> . the direction only implies association and says nothing of causality. arc direction is as a result of the underlying mathematics used to construct the models . models with particular arc directions may be better fit to the data than with the reversed directions, and therefore preferred, however, it would be incorrect with this information alone to infer that the biological dependence between two nodes is supported more in one direction over another, all that can be inferred is that association exists between nodes.

searching for locally optimal structures
the machine learning structure discovery process was performed through series of local heuristic searches using a standard approach proposed by heckerman et al.  <cit> . locally optimal models are identified by random-restart local hill climbing searches, also known as a “greedy search”  <cit> , which seek to maximise the goodness of fit metric  for each model. this network score is given by the  marginal likelihood of the data given the model; equivalent to the bayes factor when using equal prior on each model structure. this search process can be thought of as roughly analogous to stepwise regression in linear modelling but conducted in multiple dimensions where the initial model from which the search commences is randomly chosen. the interrelationships within different batch-status categories for the same pathology are inversely related – i.e. when one batch-status is present the others are not. therefore arcs connecting the different batch-status categories for the same pathology  were banned from the search.

summarising the results from the local searches
alternative and competing explanations of the data are produced during the local search process; different local searches may lead to different structural features  that appear in some networks but not in others  <cit> . a great deal of commonality across the search results is expected and strong features should be extracted reliably  <cit> . the aim is to produce an optimal structure that robustly represents the main associations. three main ways are proposed to summarise the results from the local searches:

 the “overall best network” is the single structure with the best score  across all the searches. this structure identifies the potential pathways  of associations between variables. some of these pathways may be weak, however, i.e. only identified for this particular network and may incur over-fitting; a common problem within structure discovery approaches  <cit> .

 the “majority consensus network” is the structure that represents those common features present in the majority of the best-scored networks identified across all the heuristic searches. by using this, those associations  that were present in the majority  of all the locally best networks were kept. this approach is typically employed in phylogenetic studies  <cit>  and it has been suggested for structure discovery  <cit> .

 the “pruned network” is the structure that combines the two approaches mentioned above to produce a more robust output. only those arcs that were part of the overall best network and also recruited by the majority consensus network were kept. lewis et al.  <cit>  proposed this approach mimicking pruning performed in decision tree inferences, which is essential to reduce over-fitting  <cit> .

identifying the final network
out of the three structures described above, the pruned network is the model that provides the most robust and conservative approach and is therefore considered in this paper as the principal result. the strength of the association between two nodes  present in the pruned network was estimated by calculating the relative risk    <cit> . rr is calculated as the proportion of batches affected with condition a given condition b is present in the batch, divided by proportion of batches with the condition a but with condition b not present. the 95% confidence intervals  for the rr were estimated using monte-carlo simulation.

parameters in the search algorithm
three major characteristics define the algorithm of the heuristic search:

set.seed a single value that sets the starting point for the search.

i.permutations a number that defines the times an initial empty network is perturbed to construct a random network from which a stepwise search is performed.

max.parents a number between  <dig> and total number of variables minus  <dig>  this number defines the maximum number of arcs reaching a particular node. in this study no restrictions were placed upon the number of parents and the maximum,  <dig>  was allowed in all searches.

the optimal number of local searches required to identify a robust machine learning structure is problem specific. in this study, the number was determined empirically by running two parallel sets of searches, differing in the set.seed value. the number of local searches was increased until both sets reached the same majority consensus network, thereby suggesting that a sufficient numbers of searches had been run to provide robust outputs. the results from both sets of searches were pooled to identify the best overall single network which, combined with the majority consensus network, led to the pruned network.

the analyses were performed in r  <cit>  using a library written by fil  to perform the structure search. other broadly similar libraries are available for use within r from cran  website, and similar toolboxes are available for use with matlab.

RESULTS
empirical investigation determined that  <dig> local searches were sufficient to ensure robust modelling results.

graphical outputs
the “majority consensus network” is presented in figure  <dig> and provides complementary information to the main output from this investigation, the “pruned network”, which is presented in figure  <dig> completed with estimated rrs. the arcs presented in the “pruned network” could be identified in the “majority consensus network” to determine the percentage of local searches in which the particular arc appears, informing about the robustness. thus, the “majority consensus network”  shows that the connections leading to milk spots from hepatic scarring and papular dermatitis, are the most robust – present in more than 90% of searches. in the pruned network  these arcs are retained, and it is observed that those batches with hepatic scarring had a moderate risk of milk spots compare to those batches not presenting hepatic scaring; likewise batches with papular dermatitis had a milder risk of milk spots compare to those with papular dermatitis absent. figure  <dig> also shows that batches with mild or moderate levels of pleurisy were more likely to be enzootic pneumonia-like free than those with other category levels of pleurisy. the pneumonia free batches were more likely to be also free of papular dermatitis than those with pneumonia. batches with a high level of enzootic pneumonia-like lesions had a moderate risk  of having a high level of pleurisy compare to those batches with pneumonia absent or with moderate/low level. having abscesses is associated with batches with a higher level of pleurisy compare to those with no abscesses. batches with a moderate/low level of pleurisy had a negative risk of abscess and pericarditis compare to other batches with other levels of pleurisy. there is stronger risk  of having peritonitis if pericarditis is present in the batch than if it is absent; conversely those batches with zero level of pleurisy are more likely to be peritonitis free than those with pleurisy present. batches with peritonitis also had a milder risk  of hepatic scarring compare to batches without peritonitis. batches with pyaemia had a mild risk of hepatic scarring and a strong risk of having tail damage compare to those batches with pyaemia absent.

discussion
this paper describes the application of a multi-dimensional machine learning methodology to multivariate epidemiological analyses. applying this methodology to the data comprising of the typical pathologies present in slaughtered finishing pigs has led to an easy to interpret, highly visual, and statistically robust output: a network in which the main associations between the pathologies are easily identifiable.

the interrelationship between the pathologies
this study has provided information on the nature of hepatic scarring which is thought to be a post healing stage of milk spots; but for which other aetiologies can not be discarded. the results suggest that both ascaris suum and systemic bacterial infections are independently interrelated with the presence of the liver capsule scarring. the former is reflected in the moderate association with milk spots, which seems to be a highly robust interrelationship as it was recruited in 92% of the searches. different stages of a. suum parasitism within the same batch may take place; leading to coexistence of active milk spot lesions with those already healed, i.e. hepatic scarring. the potential bacterial aetiology of hepatic scarring is suggested as its risk increases with the presence of pyaemia – suggesting that both pathologies may be associated with arcanobacterium pyogenes. in addition, hepatic scarring appears interrelated with peritonitis, which is typically present in systemic infections by haemophilus parasuis  or streptococcus suis <cit> . these latter infectious agents would also explain the positive association between peritonitis and pericarditis. likewise it was observed that when pleurisy was absent the chance of being peritonitis free increased.

severe pneumonic pasteurellosis is typically manifested by abscessation and thoracic wall adherences  <cit>  which explains the associations detected between pleurisy and abscess. conversely, absence of pneumonia is associated with lower levels of abscesses. high batch prevalence of enzootic pneumonia-like lesions is interrelated to high levels of pleurisy, which is an expected finding as both respiratory conditions share common husbandry risk factors  <cit>  and mycoplasma hyopneumoniae  contributes to the occurrence of pleurisy  <cit> . this latter association may reflect the presence of poor health levels, particularly in the control of respiratory diseases. alternatively, batches with mild or moderate levels of pleurisy appear more likely to be free of enzootic pneumonia, pericarditis and abscess, reflecting perhaps high health batches. papular dermatitis is associated with the presence of milk spots, both being parasitic conditions. this association could reflect poor parasitic control strategies for some producers and highlights the fact that, even with current systems of production, parasitism is still neglected by some sectors of the industry. these results could be used to optimise abattoir inspection strategies. for example, when papular dermatitis is detected in the pigs  the meat inspectors should place more emphasis in the liver inspections of those batches. this would be a proxy for the implementation of risk based surveillance abattoir polices that could optimise the use of industry and government resources  <cit> .

presence of pyaemia in the batch is associated with presence of tail damage. this latter pathology is known to be involved in early stages of the pathogenesis of pyaemia, by facilitating an entry access for bacteria  <cit> . at pig level these two lesions might not coexist simultaneously due to the time gap between the tail damage and the development of the pyaemia  <cit> , but a batch level investigation may have assisted to find such association. the approach used in this study, investigating batch level prevalence, not only maintains coherence with the nature of pig production, but would have also assisted in the identification of any association when two pathologies may be part of the same causal pathway . in this scenario it is likely that the pathologies do not coexist in the same pig, therefore pig level investigation would be an inefficient way of exploring their association. furthermore, pathologies presented in a mild form or during the healing process can be missed in the abattoir inspections; whereas if they are present in more than one pig, the chance of being detected by the abattoir assessors increases leading to a more adequate batch level classification.

clustering in the structure of data
in this study the impact on the analyses of the potential clustering structure in the data has been mitigated by modelling the data at batch level. batch is typically the lowest and likely the strongest level of clustering present in abattoir data  <cit> , particularly in health scheme pig abattoir data  <cit> . it is also arguable that for the type of analyses presented – particularly the multi-dimensional aspect– clustering is of far less concern than in other types of traditional statistical analyses. for other potential levels of clustering to be an issue, e.g. on-farm , this would require that on different farms the proportion of batches which have, for example, {lesion a present given that lesion b is present and lesion c is not present and lesion d is present and so on…} are substantially different, and similarly for all the other conditional probabilities in the model. this form of "group-effect" is unlikely to be sizable after having already jointly adjusted for all the other conditions present in a batch. hence, intuitively it could be argued that the machine learning methodology is robust to clustering, whether this is at farm/abattoir/season level. in practical terms, this assertion cannot be rigorously tested with this methodology and it should therefore be acknowledged as a potential limitation in this study.

constraints of abattoir gross pathology data
the different pathologies were presented in this paper with their most typical cause  and although some of them, i.e. ep-like lesion, milk spots and papular dermatitis, can be considered good proxies for specific pathogens  <cit> , none of them are strictly pathognomonic. the data obtained from abattoir monitoring carried out by the health schemes offered here a unique opportunity to explore the associations between these relevant pig pathologies. the presence of operator bias across the assessors, affecting the gross pathology classification cannot be absolutely ruled out, but the definition of the lesions did not change during the period included in our study. additionally, the health schemes organise training and refresher days for the veterinarians and conduct internal comparisons on the same pigs assessed by different veterinarians, aiming to maintain assessor consistency over time

the results from this study are applicable to the whole study population, i.e. those farms participating in the pig health schemes, and particularly to those units that submitted several batches of pigs over the time period included in the study. additionally, the results could be extrapolated to the population of british pig commercial units, as the assessments carried by the health schemes are considered representative of the british commercial sector  <cit> .

further discussion on the structure discovery approach
the multi-dimensional machine learning methodology presented is well suited for investigating multiple associations between pathologies, generating hypotheses about potential interrelationships. linear models and their generalizations, for example, would have required designating one variable as a response and modelling the rest as a set of independent predictors. multivariate techniques like principal component and factor analyses utilise dimension reduction to facilitate the identification of uncorrelated subgroups of variables . in contrast, machine learning structure discovery does not reduce the dimensions of the data and its graphical nature allows for ready interpretation of all associations present. in this study, a small variable domain – ten pathologies studied in  <dig> variables – is modelled with a substantial amount of data, providing the ideal scenario for structure discovery multivariate analyses  <cit> .

CONCLUSIONS
the application of novel multi-dimensional machine learning methodology provided new insights into how typical pig pathologies are interrelated at batch level, assisting in elucidating theories on their biological associations. the results from this study could be also used to optimise abattoir inspection utilising risk based surveillance strategies. the methodology presented is a powerful hypothesis-generating exploratory tool, applicable to wide range of studies in veterinary research.

authors' contributions
mjsv conceived the study, carried out the statistical analyses and drafted the manuscript. fil contributed to the conception of the study, wrote the statistical software required and assisted in drafting the manuscript. mn participated in its design and helped to draft the manuscript. sae participated in its design and coordination and helped to draft the manuscript. gg helped to review the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
data derived batch categorization for enzootic pneumonia and pleurisy.

click here for file

 acknowledgements
these investigations were partly funded by defra as project od <dig>  we are grateful to wps and bphs for providing the data for the analyses in this project. we would like to acknowledge and thank jill thompson, who reviewed the manuscript, for her contribution with technical expertise on pig pathology.
