BACKGROUND
self-incompatibility  polymorphisms are maintained by balancing selection over long evolutionary time scales. selection continually favors rare alleles because they are less frequently rejected as mates  <cit> . shared ancestral polymorphism is commonly observed as a result of strong balancing selection with alleles from different species and genera clustering together in phylogenetic reconstructions  <cit> . this implies that s-alleles are often much older than the species from which they are sampled. coalescence times of s-locus polymorphisms are often estimated as a few tens of millions of years, far longer than coalescence times of polymorphism at loci not subject to balancing selection  <cit> . sequence divergence at s-loci is also extreme, with stylar s-alleles often differeing at 40% or more of their amino acids. this is another sign of their great age, as well as the rarity of recombination at known s-loci. also of importance for the current study, alleles undergoing diversification can leave distinct signatures of positive selection among amino acid sites across related taxa.

richman et al.  <cit>  detected a remarkable reduction in the extent of shared ancestral polymorphism among alleles from the s-rnase locus, which encodes the stylar specificity component of the gametophytic si system of solanaceae. in particular, physalis crassifolia alleles, while numerous, all belonged to just three trans-generic lineages while alleles sampled from most other solanaceae represented far more ancient lineages. estimates of historical effective population sizes of solanum carolinense and p. crassifolia showed at least an order of magnitude decrease in physalis relative to solanum  <cit> . the pattern found in p. crassifolia, in which all s-alleles within the species represent only three ancient lineages, is shared by other si physalis species and by si members of the closely related genus witheringia  <cit> . these findings have been interpreted as the result of a historical restriction of s-locus diversity that occurred approximately  <dig> mya  <cit>  in a common ancestor of physalis and witheringia that is not shared with solanum or other sampled genera of solanceae  <cit> .

genealogical patterns suggest that physalis s-rnase alleles underwent rapid re-diversification following the historical restriction at the s-locus  <cit> . because allele numbers in physalis species are comparable to those found among species of solanum, it is thought that post-bottleneck rediversification has returned allele numbers to equilibrium or nearly so  <cit> . this provides an opportunity to examine patterns of selection on sets of s-rnase alleles that have different evolutionary histories. the more recently diversified s-alleles of physalis might be expected to show greater rates of non-synonymous substitutions because of the increased strength of recent diversifying selection  <cit> . the intensity of selection on s-alleles is inversely proportional to their number. so when the number of alleles is below equilibrium, as after a severe bottleneck, selection intensity is predicted to be higher than it is after equilibrium in allele number is achieved  <cit> . the time frame over which a period of heightened selection would be evident at the self-incompatibility locus is not known.

here we compare selective regimes acting on the s-rnase alleles drawn from species of physalis and solanum . positive selection has been estimated among self-incompatibility alleles of several taxa using various methods  <cit> , most commonly the maximum likelihood phylogenetic approaches first proposed by nielsen and yang  <cit>  and more recently by coalescent-based methods described by wilson and mcvean  <cit> . these methods use the ratio of non-synonymous  to synonymous  nucleotide substitutions  to estimate patterns of selection at individual codons. in this study, we investigate positive selection on amino acids among s-rnases both within and across species of physalis and solanum . these polymorphic s-alleles provide useful contrasts because diversification at the s-locus in the different genera took place during different time periods and among different s-allele lineages.

several previous studies  <cit>  have utilized paml  <cit>  to assess which codons within s-allele sequences were subject to positive selection in different taxa. however, none of these studies have been able to statistically determine how the strength and location of selection differs between groups of sequences. for instance, castric and vekemens  <cit>  compared patterns of selection among several taxa at the s-receptor kinase  locus which controls stylar recognition in the sporophytic si system found in brassicaceae. using paml on separate datasets from each taxon, a higher intensity of selection  was estimated among positively selected sites in brassica relative to those in two self-incompatible species of arabidopsis. this was attributed to post-bottleneck diversification of srk alleles in brassica. however, given the methods used, the statistical significance of the difference in estimates of selection intensity could not be evaluated.

paml analyses  <cit>  also found different sites under significant positive selection in different sets of s-alleles. it was concluded, however, that this was poor evidence for selection occurring on different sites. in their study  <cit> , the power to detect selection was shown to be low so non-overlap in the codons found to be under selection in different datasets would be expected, even if selection acted on the same sites in each set of alleles. similarly, vieira et al.  <cit>  looked at positive selection across s-rnases and found evidence for different positively selected sites in s-rnases from different families and sub-families of flowering plants. again however, they did not employ a statistical framework capable of testing the significance of differences in selective pressures acting on the same codons in different taxa.

in this study we apply both phylogenetic maximum likelihood and coalescent bayesian methods, treating s-allele alignments and phylogenies from species in each genus either as a) distinct datasets compared using a series of nested maximum likelihood and bayesian models of selection or b) as a combined data set in which specific clades of interest within single phylogenies are examined. our primary goal is to apply statistical frameworks using formal hypothesis tests to answer the following questions: 1) can we detect significant differences in the strength of selection between genera? 2) do the proportions of sites under selection differ among genera? 3) which sites show significantly different selection intensities between genera? 4) are differences in the strength of selection due to significantly higher dn or ds in one dataset relative to the other? 5) do sites under selection differ among s-allele lineages?

RESULTS
a bayesian consensus phylogeny of s-alleles from physalis and solanum is shown in figure  <dig>  the three ancient physalis lineages  are consistent with previously published topologies  <cit>  that use s-alleles from more genera and illustrate re-diversification from within only those lineages. no solanum alleles are found within those lineages. estimates of average pairwise nucleotide diversity  show synonymous divergence is greater for solanum while non-synonymous divergence is similar among the genera . a greater accumulation of synonymous substitutions is expected for solanum s-alleles if these lineages are older than those of physalis as suggested by previous studies  <cit> .

do selection intensities or the proportion of sites under selection differ among s-alleles from solanum versus physalis?
a random effects likelihood  approach  <cit>  was used to compare the distributions of non-synonymous  and synonymous substitutions  across genera and found that they differed significantly in three of four likelihood ratio tests . the alternative hypothesis  where dn and ds were free to vary had the highest log-likelihood score . the estimated dn/ds ratio for the positively selected class of codons in physalis alleles under this model was roughly twice that estimated from solanum alleles . the null model  that constrains both datasets to have equivalent dn/ds ratios for the class of sites under positive selection is strongly rejected  while the null model  constraining the proportions of selected sites across datasets was not rejected . this test allows dn/ds ratios of selected sites from the two genera to vary freely but enforces the proportions  in the positive selection class to be equal. the selective regime test , which constrains dn/ds ratios for the positively selected sites and the proportion of selected sites to be equal across both genera, was also strongly rejected . rejection of this model is unlikely to be due to variation in proportions of selected sites based on the results of  and appears largely the result of differences in the strength of selection on positively selected sites across datasets. the shared distributions test  combines the joint distributions of dn and ds for both datasets and was also found to have a significantly lower likelihood  than ha which allows for variation in rates in both datasets. see methods for full descriptions of each model. to summarize, the rel approach found significantly greater intensity of selection on positively selected sites in physalis but no evidence that the proportion of sites under selection differed between genera.

note: null models  were tested using likelihood ratio tests  against the alternative model ha where dn and ds rates are free to vary in each dataset. significance of p ≤  <dig>  was determined using χ <dig> with degrees of freedom  equal to the number different parameters between models

which sites show significant differences in strengths of positive selection?
because the rel approach used above does not indicate which codons show different dn/ds ratios, subsequent analyses were conducted to determine where along the s-rnase sequence selection differs between genera. we first estimated positive selection at individual codons using the nielsen and yang  <cit>  method implemented in paml v <dig> . these results detected considerably more positively selected codons in physalis than solanum as indicated by posterior probabilities >  <dig>  . because we cannot determine whether the selective regime at these sites differs significantly between datasets under the current framework of the maximum likelihood method implemented in paml, we employed a bayesian coalescent method described by wilson and mcvean  <cit>  to compare highest posterior densities  for point estimates of ω . we first compared our results from omegamap with the nielsen and yang m <dig> model for both datasets to determine how similar were the estimates of which codons were under positive selection. posterior probability scores show consistent trends across methods for each dataset , though some sites have higher scores using m <dig> in solanum. most importantly, both methods identify nearly all of the same sites under positive selection upon which to estimate ω values. wilson and mcvean  <cit>  suggested that inconsistencies between their coalescent method results for estimating ω and those of codeml in paml could be the result of recombination. we did not detect the presence of recombination in either dataset using the likelihood permutation test described by mcvean et al.  <cit>  .

to compare selection intensities at specific sites across genera, estimates of the mean and upper and lower highest posterior densities  for ω from each dataset were used to generate distributions from  <dig>  mcmc iterations of the ratio of ω values from physalis and solanum . confidence intervals  that do not include  <dig>  indicate that the codon specific estimates of ω from each dataset  are significantly different. the hpds of ωp/ωs ratios are more heavily concentrated in the upper half of figure  <dig>  indicating that codons from physalis generally have higher dn/ds ratios than those from solanum. significantly different ω values are found at  <dig> positions. not all  <dig> sites with ωp/ωs ratios significantly > 1showed significant posterior probabilities of being under positive selection  when genera were analyzed separately. we therefore removed sites that, for neither genus, showed ≥  <dig>  posterior probabilities of positive selection using either omegamap or paml . that is, we removed sites showing no strong evidence of being under positive selection in either genus. of the remaining sites, all but  <dig> had posterior scores ≥  <dig>  for ω >  <dig>  thirty-six sites had significantly higher ωp/ωs ratios and posterior probabilities ≥  <dig>  for physalis . by the same criteria, no sites showed significantly stronger selection in solanum relative to physalis.

we also used a fixed effects likelihood  method  <cit>  to compare selective pressures  at individual sites across data sets. like the bayesian coalescent method, we used independent phylogenies for each genus, then statistically compared individual codons across taxa under a hypothesis testing scheme . this method also finds several codons in physalis that are under significantly greater positive selection than solanum as shown by contrasts of mean dn/ds values at these particular sites . fel-csp identified fewer differentially selected sites than the bayesian method with  <dig> sites predicted to be differentially selected at the p ≤  <dig>  level and one site with p =  <dig> . all but six of these sites were also identified by the coalescent method . because this method does not utilize rate distributions across sites, it is sensitive to the number of taxa present in each dataset  <cit> . we performed a power analysis to determine whether p-values ≤  <dig>  were sensitive to potential type ii errors for the fel analysis. we found that that the power to detect positively selected sites for physalis is only  <dig> %, and 34% for solanum at p =  <dig> . however, the false positive rate for sites predicted under this method is also low,  <dig> % and  <dig> % for physalis and solanum respectively. this means that when a site is predicted to be under selection, accuracy of this prediction is expected to be ≥ 95%.

ωp/ωsα
 <dig>   <dig> ,
 <dig>   <dig> 
 <dig> , 59
-
-
 <dig>   <dig> ,  <dig> ,
 <dig>   <dig> , 125
fel cspb
fel clade a
fel clade c
fel clade sc
fel clade sc
bold indicates sites predicted to be under stronger selection in physalis than in solanum by both ωp/ωs and fel csp tests. fel-clade tests comparing clades a and c show mostly different sites under selection as well as several different sites selected in solanum depending on the foreground physalis clade present.

a) for the ω1/ω <dig> test codons had a posterior probability score ≥  <dig>  unless otherwise indicated in parentheses.

b) for the fel test all sites listed had a p-value ≤  <dig>  except site  <dig> 

c) the fel clade tests had either clade a or clade c as the foreground with all other physalis alleles removed from the alignment and phylogeny.

do different s-allele lineages experience greater selection intensities?
to test whether a branch or clade model fits the data better than models with all lineages combined within a phylogeny  <cit>  we set physalis clades a and c against a background phylogeny of all solanum alleles and the alternative clade . this test also uses the rel framework . physalis clade a had a significantly higher dn/ds ratio  than all background lineages . the branch extending to physalis clade a had the greatest dn/ds estimate  but models where this branch was included either as part of the background or as part of clade a did not provide a statistically worse fit than models in which the dn/ds ratio for this branch was estimated independently . likelihood ratio tests and aic scores show that models with physalis clade a specific selection provide a better fit to the data  than the model that assumes a single best global estimate of dn/ds. the same procedure was conducted for physalis clade c and also found significantly increased selection relative to background lineages. for clade c the estimated dn/ds ratio  is lower than estimated for clade a and the best fit model does not include its subtending branch . phyalis clade b was ignored in this and the following analysis because it contains too few sequences to be informative.

dndsdnds shared clades a + alla =  <dig> ;
phys dnds branch a = dnds; clade alla =  <dig> ;
a) background branches include all solanum alleles and physalis alleles outside of sub-clade a

alternative models  were tested using likelihood ratio tests  against the null model  <dig> where dn and ds rates are shared among all branches on the phylogeny. significance of p ≤  <dig>  was determined using χ <dig> with degrees of freedom  equal to the number different parameters between models.

*model  <dig> showing a common dn/ds for clade a and the subtending branch has the best fit aic score sharing a distinct dn/ds.

do selected sites differ among lineages?
it is possible that diversification of different specificities occurs by changes at different sites in different lineages. using clade-specific fel  based variations of branch models  <cit> , we removed the other major physalis clade  to determine whether each physalis clade exhibits different selected codons relative to the many background lineages from solanum. this test finds  <dig> codons that have significantly greater dn/ds for clade a, while  <dig> show significantly higher selection intensites in solanum than in physalis clade a . for physalis clade c ,  <dig> sites show higher dn/ds than in the background lineages from solanum while seven codons are subject to more intense selection in the background lineages than this clade. sites indicated to be under differential selection in each clade-specific analysis are mostly different . the majority of sites found to be under higher levels of positive selection in solanum are in hypervariable regions a and b while sites under greater positive selection in physalis clades a and c are often outside these regions.

what causes higher dn/ds ratios in physalis?
higher estimated dn/ds ratios in physalis could result from increased fixation of non-synonymous substitutions in physalis because of increased selection, or from fixation of more synonymous changes in the s-alleles of solanum because they are generally older. in order to determine the cause of the difference in estimated selection intensities we used paml to estimate dn and ds for all terminal branches leading to p. longifolia and s. chilense alleles, the species which posess the largest s-rnase samples within each genus. linear regression analysis shows that the y-intercept  is not different for the two genera ; s. chilense: y-intercept =  <dig> , ). apparently, dn = approximately  <dig>  is the minimum average divergence among alleles of either genus when synonymous divergence is zero. however, as ds increases, p. longifolia alleles show significantly higher accumulation of non-synonymous substitutions as the slopes of the regressions  are significantly different ; s. chilense  <dig>  . for equivalent levels of synonymous divergence, p. longifolia alleles have accumulated nearly twice the number of non-synonymous changes as have alleles from s. chilense. quadratic terms are not significant in either genus. results are nearly identical when all physalis and solanum alleles are used .

discussion
when allele numbers at the s-locus are below equilibrium, as after recovery from a demographic restriction, selection favoring new alleles is expected to increase  <cit> . we have used a series of statistical methods to determine if the intensity of selection acting on s-rnases differed among taxa and lineages, and whether the number and positions of sites under selection differed. as indicated by the distributions of dn and ds along the entire s-rnase gene in the initial rel models , there is a significantly greater dn/ds ratio in physalis. this method is similar to paml models that begin by categorizing dn and ds rates into discrete distributions, but with the added use of a framework of nested models that compare those rates across two taxa with homologous polymorphism. subsequent likelihood  and coalescent  analyses found more sites under significant positive selection in physalis rendering the second result of the rel analysis somewhat surprising: that no significant difference in the proportion of sites under selection was detected. the rel method may be less sensitive in detecting differences in local processes than in overall selective pressure, but the main difference we can confirm between the genera is in the intensity of selection rather than the proportion of sites subject to it.

we used a novel adaptation of omegamap  <cit>  to determine which codons are subject to stronger selection in one genus versus the other. the markov chain process of the bayesian method produces a distribution of ω values around a mean for each codon that allows one to establish upper and lower 95% confidence intervals. this feature of bayesian statistics makes this method useful for hypothesis tests regarding dn/ds ratios across taxa, something that is not possible using existing maximum likelihood methods such as paml. these tests found  <dig> codons under significantly higher selection in physalis. we also used an alternative fixed effects maximum likelihood method to compare selective pressures  using likelihood ratio tests for increased dn/ds in one genus relative to the other. this method detected roughly half as many sites under differential selection as the bayesian method, suggesting that either the bayesian approach is prone to high false positive rates or that the fel-csp method has reduced power. based on our power analysis, we suspect the latter as the bayesian method appears to perform similarly to a rel method . previous simulations  <cit>  comparing both rel and fel methods on individual datasets showed that fel is less powerful when the number of sequences is below  <dig> as are each of our datasets.

as expected, both the bayesian and fel-csp methods predict that the greatest differences in the magnitudes of positive selection on individual codons occur in the previously identified hyper-variable regions hva and hvb  <cit> . the hyper-variable regions are thought to play a major role in determining specificity  <cit> . for example, matton et al.  <cit>  demonstrated alteration of specificity using mutagenesis experiments involving these hypervariable regions. these studies showed that as few as  <dig> amino acid changes in corresponding positions of the s <dig> and s <dig> s-rnases of s. chacoense could alter specificity to that of the alternative allele. however, entire domain swapping in studies  <cit>  using s-rnases of petunia inflata and nicotiana alata, suggest that while hva and hvb are important, other regions are also likely involved in recognition at least in some alleles or lineages. consistent with this idea, both codon-based methods used here also show considerable differential selection in the v <dig> region near the 3' end of the s-rnases, supporting previous analyses of both lycium  <cit>  and solanum chilense  <cit>  s-rnases which also found evidence of selection in this region.

the genealogy of s-alleles from physalis suggests that extant s-rnases evolved from only  <dig> lineages, giving rise to the expectation of strong selection within each of these three clades. indeed, physalis clade a shows the highest dn/ds as expected during early strong selection on a reduced number of s-alleles. these results suggest that the clade model captures increased post-bottleneck diversifying selection intensities. clade c also shows increased selection pressure relative to background lineages while clade b contains too few alleles for testing by this method. this test confirms the findings of the rel test but on isolated foreground lineages and shows that selection is generally stronger in each re-diversified clade relative to average selection estimated for background lineages.

all methods used found higher dn/ds ratios in physalis, as expected following a severe reduction in s-allele numbers. however, due to saturation, dn may be more severely underestimated in long branches potentially leading to reduced estimates of dn/ds ratios  <cit> . because its alleles are generally older, this could providing a potential alternative to greater selection for lower dn/ds estimates from solanum. we therefore estimated dn and ds at terminal branches for the two species with the most alleles  to a) estimate dn and ds in the absence of interspecific branch lengths, b) gain insight into non-synonymous substitution rates of similarly aged s-alleles, and c) estimate recent selection by ignoring internal branches. for alleles separated by equivalent amounts of synonyomous change, physalis alleles have accumulated non-synonymous substitutions at about twice the rate for solanum . evidence for increased dn/ds ratios is apparent even at relatively low levels of divergence . this is strong evidence that saturation of non-synonyous substitutions is not the cause of higher inferred intensity of selection in physalis.

in comparison to tests for increases in selection across the gene or at specific codons, methods for testing whether the same or different codons are under selection in different groups or lineages are considerably less well developed. the fel-clade models returned the only evidence suggesting that sites under positive selection in a particular clade might be under neutral or purifying selection in the background phylogeny . fel-clade analyses also showed mostly different sites under selection across the two main physalis clades examined . finding different sites under selection in different clades might indicate that different residues contribute to specificity differentiation in different groups of alleles. however, this finding could also reflect low power to detect selection, given the reduced sample sizes represented within each clade. with low power, the expected overlap in sites predicted to be under selection would also be low  <cit> .

the fel-clade models also indicated several sites where the strength of positive selection in solanum was greater than in the contrasted clade  from physalis. this is in contrast to other methods explored here where all significant differences in the strength of positive selection at specific sites showed increased selection intensity in physalis. if clades differ in sites subject to positive selection, analyses combining all physalis clades might mask these effects while the fel-clade method may expose these differences.

CONCLUSIONS
several methods detected increased selection intensities acting on the alleles from physalis when compared to those from solanum, consistent with recovery from a historical restriction in s-locus diversity in physalis. however, another question, whether the same or different residues were under selection in alleles from the two sources was more difficult to answer. the rel method did not detect a higher proportion of sites under selection in physalis and the method cannot detect whether selection acts on the same or different codons. other methods found more sites under significant positive selection and higher selection intensities acting on selected sites in physalis, but both may result from increased selection intensities rather than differences in sites subject to positive selection. the fel clade-specific approach provided some evidence that different sites were under selection in specified physalis clades than across the background solanum alleles but the assumption of this test, that selection on the background clade is uniform, may not hold and these results should be treated cautiously. while the methods explored here for testing differential strengths of selection across a gene or at specific codons appear adequate, further development of statistical methods for testing whether the same or different sites are under selection is needed.

