BACKGROUND
a variety of microscopic imaging techniques have long been used to study chromatin architecture and nuclear organization  <cit> . recent advances triggered by the invention of chromatin conformation capture  enable ascertainment of genome architecture on a genome-wide scale for virtually any genome, including human  <cit> , mouse  <cit> , budding yeast  <cit> , bacteria  <cit> , fruit fly  <cit>  and a malarial parasite  <cit> . these studies have revealed that the three-dimensional form of the genome in vivo is highly related to genome function through processes such as gene expression and replication timing. therefore, understanding how chromosomes fold and fit within nuclei and how this folding relates to function and fitness is crucial in gathering a thorough picture of epigenetic control of gene regulation for eukaryotic organisms.

hi-c was the first molecular assay to measure genome architecture on a genome-wide scale  <cit> , and the assay continues to be widely used  <cit> . hi-c involves seven steps:  crosslinking cells with formaldehyde,  digesting the dna with a six-cutter restriction enzyme,  filling overhangs with biotinylated residues,  ligating the fragments,  creating a sequence library using streptavidin pull-down,  high-throughput paired-end sequencing, and  mapping paired ends independently to the genome to infer contacts. a subsequently described assay by duan et al.  <cit>  is more complex, involving a pair of restriction enzymes  applied in three separate steps , as well as the introduction of ecop <dig> restriction sites to produce paired tags of 25–27bp. more recently, the tethered conformation capture  assay enhances the signal-to-noise ratio by carrying out a hi-c-like protocol using dna that is tethered to a solid substrate  <cit> .

one limitation of current genome architecture assays is their inability to identify simultaneous interactions among multiple loci. chromosomes are composed of complex higher order chromatin structures that bring many distal loci into close proximity. in particular, evidence suggests that eukaryotic transcription occurs in factories containing many genes  <cit> . recently, multiple-gene interaction complexes associated with promoters were found to contain an average of nearly nine genes  <cit> . however, currently available experimental data cannot ascertain to what extent these multiple gene interactions occur simultaneously or are confined to different sub-populations of nuclei. this distinction is analogous to the distinction between “party hubs” and “date hubs” in protein-protein interaction networks, in which a hub protein interacts either simultaneously or in a serial fashion with a series of partner proteins  <cit> . in the context of genome architecture assays, distinguishing between “party loci” and “date loci” will be a crucial first step in elucidating the role of combinatorial regulation of gene expression.

a molecular colony technique recently developed by gavrilov et al.  <cit>  investigated multicomponent interactions among remote enhancers and active β-globin genes in mouse erythroid cells. this assay, however, is pcr-based and requires a primer design step, which prevents it from providing a genome-wide picture of potential multicomponent contacts. an earlier genome-wide assay by sexton et al., which is adapted from the traditional hi-c protocol and is similar to the assay we present here, acknowledged the existence of multi-locus contacts that can be identified from paired-end reads in their data  <cit> . however, due to a number of differences in that protocol compared to tm3c , identifying a substantial number of multi-locus contacts was not possible when we apply our two-phase mapping pipeline to the sexton et al. data . therefore, genome-wide methods that distinguish between simultaneous contacts among multiple loci and pairwise contacts that happen in different sub-populations of cells are still necessary.

to address this issue, we developed the tethered multiple chromosome conformation capture assay , which involves a simple protocol of restriction enzyme digestion and religation of fragments within agarose gel beads  followed by high throughput paired-end sequencing . we apply tm3c to two human cell lines and confirm that the dna–dna contact matrices produced by tm3c exhibit features characteristic of existing genome architecture datasets, including the expected scaling of contact probabilities with genomic distance, enrichment of intrachromosomal contacts, megabase scale chromosomal compartments and sub-megabase scale topological domains. we confirm that tm3c in kbm <dig> cells captures several known cell type-specific contacts, ploidy shifts and translocations, such as ph+ formation. in addition, we demonstrate that tm3c enables genome-wide identification of contacts among more than two loci simultaneously. we identify multi-locus contacts involving three  or four  loci by a two-phase mapping strategy that separately maps chimeric subsequences within a single read . this mapping strategy potentially allows us to identify co-regulation or combinatorial regulation events, while also greatly increasing the number of distinct pairwise contacts  identified. we also validate a subset of the triple contacts involving the igf2-h <dig> imprinting control region  using pcr for kbm <dig> cells. we demonstrate that pairwise and triple contacts prefer to link open chromatin regions to each other and regions with higher numbers of dhss to each other.overview of tm3c experimental protocol and mapping of paired-end reads to human genome.
 <dig>  cells are treated with formaldehyde, covalently crosslinking proteins to one another and to the dna. the dna is then digested with either a single 4-cutter enzyme  or a cocktail of enzymes .  <dig>  melted low-melting agarose solution is added to the digested nuclei to tether the dna to agarose beads. thin strings of the hot nuclei plus agarose solution is then transferred to an ice-cold ligation cocktail overnight.  <dig>  after reversal of formaldehyde crosslinks and purification via gel extraction, the tm3c molecules are sonicated and size-selected for  <dig> bp fragments.  <dig>  size-selected fragments are paired-end sequenced  after addition of sequencing adaptors.  <dig>  each end of paired-end reads are mapped to human reference genome. if both ends are mapped then the pair is considered a double and retained because it is informative for genome architecture.  <dig>  read ends that do not map to the reference genome are identified and segregated according to the number of cleavage sites they contain for the restriction enzyme used for digestion.  <dig>  reads with exactly one cleavage site are considered for the second phase of mapping. these reads are split into two from the cleavage site and each of these two pieces are mapped back to the reference genome.  <dig>  read pairs with either one or both ends not mapped in the first mapping phase are reconsidered after second phase. depending on how many pieces stemming from the original reads are mapped in the second phase, such pairs lead to either no informative contacts, doubles, triples or quadruples.



finally, we use the contact maps gathered from tm3c to infer a local 3d structure of the igf2-h <dig> region at  <dig> kb resolution and a whole genome 3d model at  <dig> mb resolution for the near-haploid kbm <dig> genome. our 3d models place h <dig> and igf <dig> genes far away from each other, consistent with their opposite transcriptional status, and place gene-rich small chromosomes  and large chromosomes  near each other, confirming previous observations of gene-density- correlated arrangements of higher-order chromatin in human cells  <cit> .

RESULTS
tethered multiple chromatin conformation capture 
to identify simultaneous chromatin contacts among two or more loci, we digest crosslinked chromatin with one or more 4-cutter restriction enzymes  . when using multiple res, we select a set of enzymes such that sticky or blunt ends left by one enzyme are incompatible with the ends left by any other, thereby preventing ligation between fragments generated by different enzymes. we then encapsulate and ligate the digested dna within agarose beads , which replaces the tethering step of kalhor et al.  <cit> . we then size-select dna fragments of around  <dig> bp and subject the selected fragments to high throughput paired-end sequencing . our assay differs from the original hi-c assay in three primary ways:  tm3c can use multiple res simultaneously,  tm3c does not include a step where sticky ends of restriction fragments are biotinylated, and  tm3c carries out the ligation step within agarose gel beads. digestion using multiple res greatly increases the resolution that can be achieved via these genome-wide 3c-based techniques . however, comparison of two libraries, one generated with four 4-cutters and the other with only one, suggests that the noise-to-signal ratio is much higher for the multiple 4-cutters case. our second modification, elimination of the biotinylation step, greatly reduces the complexity of the overall protocol and has already been applied successfully by sexton et al.  <cit> . this simplification, however, comes with the drawback of sequencing many uninformative, unligated sonication products both for the tm3c and the sexton et al. protocols. because detection of such uninformative read pairs is computationally trivial, this simplification, fortunately, does not contribute an additional noise factor. the third modification we implement, in-gel ligation, is similar to but simpler than the tethering achieved using protein biotinylation in the tethered conformation capture  assay  <cit> . our initial experimental data which omitted the in-gel ligation demonstrated that without this step the resulting signal-to-noise ratio for the case of four 4-cutters is very low . addition of in-gel ligation step improved the percentage of intrachromosomal contacts from 5% to 20% and 48% for the four 4-cutter  and one 4-cutter  libraries, respectively. therefore, we only present the results from the libraries generated using the in-gel ligation and focus mainly on the results from our one 4-cutter library for both kbm <dig> and nhek cell lines.

we use tm3c to investigate the chromatin architecture of the near haploid cell line kbm <dig>  extracted from a heterogeneous chronic leukemia cell line  <cit> , and nhek, a normal diploid human keratinocyte primary cell line . we construct libraries using only one four-base cutter restriction enzyme  for both kbm <dig> and nhek. we also create two libraries from kbm <dig> cells using four different four-base cutters, one from crosslinked cells  and one from non-crosslinked cells  as a control . in what follows, we report results from application of tm3c to these two human cell lines mainly focusing on kbm <dig> summary of datasets generated in this paper



cell type
tethering
restriction enzymes 
identifier
alui
mboi/dpnii
mspi
nlaiii
ag |ct
|gatc
c |cgg
catg |
✓
✓
✓
✓
✓
✓
✓
✓
✓
✓


tm3c reveals multi-locus chromatin contacts
in addition to providing higher resolution, the use of frequently cutting res  or multiple res together allows identification of simultaneous contacts among more than two loci, even with reads as short as  <dig> bp. the original hi-c method only retains read pairs in which both reads map completely to the reference genome. here we refer to this type of contacts as type f-f . unlike current hi-c mapping pipelines, after identifying f-f pairs, we further process the unmapped paired-end reads to see whether we can still rescue some informative chromatin contacts from them. our motivation to pursue these reads stems from the striking difference between the number of restriction sites within fully-mapped versus non-mapped reads . in both the tm3c- <dig> and tm3c- <dig> libraries, greater than 70% of the non-mapped reads contain at least one re cut site, whereas 90% of the mapped reads contain no cut sites for the tm3c- <dig> library . this difference suggests that read ends that fail to map as a whole can still be informative of chromatin contacts because they potentially contain real ligation events leading to chimeric reads. in order to extract this contact information, we further process the read ends containing one restriction site, thereby identifying contacts between a partially mapped read and a fully mapped read  or between two partially mapped reads . this two-phase mapping strategy not only identifies a greater number of pairwise contacts  but also allows us to identify contacts involving three or four loci from only one paired-end read. step  <dig> of figure  <dig> summarizes the different cases arising from the second mapping phase for a read pair that did not qualify as f-f in the first phase. overall, after excluding intrachromosomal contacts with genomic distance < <dig> kb, we identify more than 210k triples from our kbm7-tm3c- <dig> library together with  <dig> m and 857k additional pairwise contacts from p-f and p-p type read pairs, respectively . we also investigate the mapping orientations  of ligated fragments that create different contact types . the distribution of reads among all possible sign combinations is expected to have a bias for reads that are sonication products  and to be uniform for de novo chromatin contacts due to ligation events. table  <dig> shows this is the case for both the contacts that are identified by traditional hi-c pipelines  as well as for the contacts we identify here that produce triples. since we size select for fragments that are approximately  <dig> bp, the genomic distance threshold of  <dig> kb eliminates all sonication products, resulting in uniform distribution for the remaining contacts from tm3c.consistency of tm3c data with known organizational principles and kbm <dig> karyotype.
 number of re cut sites within reads that are fully mapped and nonmapped in the first phase mapping for kbm <dig> libraries.  scaling of contact probability with genomic distance for three crosslinked libraries and one non-crosslinked control library.  scaling of contact probability in log–log scale for three different sets of contacts identified in kbm7-tm3c- <dig> library. pairwise chromosome contact matrices for  kbm7-tm3c- <dig>   kbm7-tm3c- <dig>   nhek-tm3c- <dig> and  kbm7-mccont- <dig> libraries. for these plots contact counts are averaged over all pairs of mappable  <dig> mb windows between the two chromosomes.
summary of informative pairwise and multi-locus contacts for each kbm <dig> library



library
total reads
doubles 
triples
quadruples



contact type
genomic dist.
read orientations 
+/+
+/-
-/+
-/-
+/++,-/–
+/+-,-/-+
+/-+,-/+-
+/–,-/++
++/+,–/-
++/-,–/+
+-/+,-+/-
+-/-,-+/+


two-phase mapping rescues contacts informative of genome architecture
following identification of all three types of contacts , we evaluate the quality of the resulting contact sets for each library in four ways. first, we confirm that the contact probability between two intrachromosomal loci exhibits a sharp decay with increasing genomic distance for crosslinked libraries but not for the control library when all contact types are pooled . second, we observe that this scaling relationship is consistent for different contact types , and the scaling is log-linear for the genomic distance range of  <dig> – <dig> mb, consistent with observations from hi-c data  <cit> . third, we confirm visually and quantitatively that the interchromosomal contact maps we obtain from each contact type are consistent with each other ,  and , respectively) and that the contact maps are consistent with known organizational hallmarks of human genome architecture, such as the increased number of contacts between small chromosomes  . fourth, we confirm that our contact profiles capture known karyotypic abnormalities of kbm <dig> cells, such as diploidy of chromosome  <dig> , partial diploidy of chromosome  <dig>  and t) translocation between chromosomes  <dig> and  <dig> that leads to philadelphia chromosome formation  <cit>  . normal diploid human keratinocyte  cells exhibit no karyotypic abnormalities except higher average contact counts between chromosomes  <dig>   <dig> and  <dig> . for the non-crosslinked kbm <dig> control library, only the changes related to copy number  are apparent from the heatmap . translocations are not visible in the control because digestion of non-crosslinked chromatin does not preserve genomic distances. together, these results indicate that tm3c successfully assays genome architecture of human cells and suggests that contacts recovered by our two-phase mapping strategy, which are traditionally discarded from hi-c analysis, are consistent with traditionally retained contacts. therefore, for all remaining analyses with pairwise contacts we combine all three types  into an aggregated contact map for each library.

tm3c data confirms chromatin compartments and topological domains
in addition to evaluating whether results from the tm3c data sets are consistent with polymer models of chromatin folding and karyotypic properties of assayed cell lines, we assess whether tm3c contact maps exhibit the expected compartment-scale and domain-scale organization. for this purpose we perform eigenvalue decomposition on our contact maps and compare our compartment calls to those of previous hi-c data sets on other human cell lines  <cit> . the resulting compartment calls exhibit a nearly perfect overlap for chromosome  <dig> between kbm <dig> and gm <dig>  and a high level of genome-wide conservation  between these two cell lines. conservation between pairs of contact maps from the five previously published contact maps ranged between 70–82%.comparison of tm3c data with existing genome architecture datasets. eigenvalue decomposition to identify open/closed chromatin compartments of chromosome  <dig>  from the kbm <dig> cell line assayed by tm3c and  from gm <dig> cell line assayed by hi-c  <cit> . topological domain calls and contact count heatmaps of a  <dig> mb region of chromosome  <dig>  for the kbm <dig> cell line assayed by tm3c and  for the imr <dig> cell line assayed by hi-c  <cit> .



similarly, we perform topological domain decomposition at  <dig> kb resolution on kbm <dig> contact maps and compare our calls to those of two human cell lines published by dixon et al.  <cit>  . figures 3c–d demonstrate the significant overlap of topological domain calls from kbm <dig> and imr <dig> contact maps on a  <dig> mb region of chromosome  <dig>  overall, 73% of imr <dig> and  <dig> % of esc domain boundaries overlap with the boundaries that we identify for the kbm <dig> cell line .

together, the compartment-scale and domain-scale similarities between our data and previous hi-c data suggests that tm3c, a simpler protocol, provides similar results to hi-c and that kbm <dig>  which has a distinct karyotype, preserves the large scale organizational features of other human cell lines.

genome-wide characterization of triple contacts
after identifying chromatin compartments at  <dig> mb resolution and topological domains at  <dig> kb resolution for the kbm <dig> cell line, we evaluate whether the triple contacts identified by tm3c preferentially link regions with the same compartment labels and regions within the boundaries of a topological domain. figure 4a shows that triple contacts, similar to doubles, are enriched among regions of open chromatin . out of all intrachromosomal triples , we see that  <dig> % are within the same topological domain. note that we exclude from this percentage all short range intrachromosomal triples  as well as all those that link at least two loci within the same  <dig> kb window which would otherwise inflate the reported percentage. we assess the significance of this observed percentage of intradomain triples by generating a null model with  <dig> shuffled topological domain decompositions for each chromosome . the median and the mean percentages are both ∼ <dig> % with a standard deviation of  <dig> % for the null model suggesting a statistically significant enrichment of intradomain triples for the observed domain decomposition compared to shuffled configurations .genome-wide characterization of triple contacts.
 observed over expected percentages of double and triple contacts that link  <dig> mb regions with the same  or different  compartment labels for the kbm7-tm3c- <dig> library . both double and triple contacts prefer to link open compartments to each other with triples showing slightly more enrichment for this trend.  similar percentages as in  but when  <dig> mb windows are segregated according to the number of dhss they contain . contacts linking regions with higher numbers of dhss than the median number are enriched within the doubles and the triples of the kbm7-tm3c- <dig> library. due to lack of dnase data for kbm <dig> cells, we use data from six other human cell lines for this analysis. since the results are very similar among different cell lines, here we only plot the results for k <dig> which is also a leukemia cell line.



next we carry out an analysis similar to the compartment label analysis described above using the numbers of dnase hypersensitive sites within each  <dig> mb window . figure 4b shows that, consistent with and slightly surpassing the enrichment for open chromatin compartments, triple contacts as well as doubles are enriched among regions with higher numbers of dhss .

verification of triples involving igf2-h <dig> locus
we next investigate whether the multi-locus contacts identified by the tm3c assay correspond to possible combinatorial regulatory interactions in kbm <dig> cells. specifically, we focus on triples  involving the igf2-h <dig> locus, which is a classic example of imprinting that leads to allele-specific gene expression and regulation in both mouse and human  <cit> . our previous work in human cells has shown that a region that is located just upstream of the h <dig> promoter which is differentially methylated between maternal and paternal copies is involved in formation of allele-specific long-range chromatin loops  <cit> . methylation status of this imprinting control region  determines whether igf <dig> is transcribed  or not . because kbm <dig> cells are haploid for chromosome  <dig>  we expect our tm3c data to be consistent with only one mode of operation of this icr. analyzing the triples inferred from kbm7-tm3c- <dig> data involving the icr region , we observe contacts that link this icr region to distal loci on the same chromosome as well as to a trans loci on other chromosomes .validation of triples using pcr.
 ten triples extracted from the kbm7-tm3c- <dig> library that have at least one of their three ends in the  <dig> kb region surrounding the imprinting control region  of igf <dig> and h <dig> genes. these triples involve short- and long-range contacts within chromosome  <dig> which are all indicated by tick marks with coordinates in kilobases  displayed only for long-range contacts. interchromosomal contacts with other chromosomes are indicated by the chromosome identifier followed by the coordinate in megabases . orientation of the displayed locus is in the direction of igf <dig> and h <dig> transcription.  pcr verification of pairwise contacts from triples  <dig> and  <dig>  one pair of forward/reverse primers is used for each gel .



in order to verify these contacts, we design three primers per each triple and perform pcr experiments . we test whether pairs of forward/reverse primers give rise to pcr products with expected sizes to confirm contacts identified from our two-phase mapping . for triple  <dig>  we use primers 3a and 3c designed for two loci that are  <dig> kb away and are linked by a contact found from a ligation occurring within one end of a paired-end read. for triple  <dig>  we use primers 5a and 5c that link two loci that are  <dig> kb apart on chromosome  <dig> and are found  in two separate ends of a paired-end read. for both of these cases we observe pcr products near the expected size from our primer design . validation of contacts found by our two-phase mapping either within a single end of a read or from two different ends supports the idea that chimeric reads contain information about genuine chromatin contacts.

next, we perform pcr on all the triples shown in figure 5a using all three primers simultaneously. out of  <dig> triples tested,  <dig> of them  resulted in either one or more pcr products that have the expected size, confirming these contacts . detailed analysis of the distal loci that are contact partners of icr  in these six triples reveal that most of these loci  lie in regions consisting mainly of unmethylated cpgs in k <dig> cells and mainly methylated cpgs in at least one other cell line assayed by encode  <cit> . these contacts suggest existence of complex chromatin loops that bring together the differentially methylated icr in 3d with loci that show cell type-specific methylation and specifically unmethylation in k <dig> cells. these results together with our preliminary methylation analysis of the icr suggest a 3d organization which silences igf <dig> by restricting enhancer access to its promoter similar to igf <dig> silencing of the maternal copy of mouse chromosome  <dig>  <cit> . in order to test our hypothesis that the single copy of chromosome  <dig> in kbm <dig> corresponds to the maternal allele, we check the expression status of h <dig> and igf <dig> genes from a recently published data set  <cit> . additional file 1: figure s <dig> shows that h <dig> is expressed but igf <dig> is not as we expected. this expression data confirms the prediction from tm3c data for the parent-of-origin of chromosome  <dig> in kbm <dig> cells. furthermore, our 3d model of the  <dig> mb region centered on the icr  demonstrate that the two genes, expressed h <dig> and non-expressed igf <dig>  are placed in distal chromatin domains, consistent with the proposed gene regulation model in the maternal copy of the homologous region in mouse  <cit> . however, the depth of our data is not sufficient to do a finer scale 3d modeling that can distinguish between allele specific loops established by several differentially methylated regions and ctcf binding sites.three-dimensional modeling of kbm <dig> genome architecture.
 three-dimensional structure of the  <dig> mb region of chromosome  <dig>  which is centered around igf2-h <dig> imprinting control region. this structure is inferred from normalized contact counts of kbm7-tm3c- <dig> data at  <dig> kb resolution using the poisson model from varoquaux et al.  <cit> .  three-dimensional structure of the kbm <dig> genome, which is haploid for all chromosomes other than diploid chromosome  <dig>  and partially diploid chromosome  <dig>  . different colors represent different chromosomes, and white balls represent chromosome ends. same 3d structure as  when confined to  only a subset of long chromosomes,  only a subset of small chromosomes,  two small and two large chromosomes.



three-dimensional modeling of kbm <dig> genome recapitulates known organizational principles of human cells
finally, to visualize the genome architecture of near-haploid kbm <dig> cells, we generated a set of 3d structures using an optimization framework that alternates between inferring the 3d configuration of beads that best summarize tm3c contacts  <cit>  and re-estimating the distribution of contact counts between diploid chromosomes. since this optimization is non-convex, we ran the optimization  <dig> times and selected the  <dig> structures with the highest log likelihoods . figure 6b–e plots the structure with highest likelihood inferred at  <dig> mb resolution. visual observation of figure 6b suggests that individual chromosomes preserve their territories in 3d . in order to better visualize which chromosomes are closer to each other, we plot subsets of different chromosomes in figures 6c–e. consistent with previous models  <cit>  and our contact count heatmaps, we observe strong colocalization among the small gene-rich chromosomes . however, chromosome  <dig>  which is small but gene-poor, does not colocalize with gene-rich small chromosomes in 3d . we also observe colocalization of large chromosomes with each other, but not as strongly as small chromosomes . visualization of two large and two small chromosomes clearly demonstrates that the two sets of chromosomes are far from each other in our 3d models .

discussion
catalyzed by the availability of genome-wide chromatin architecture data generated using chromatin conformation capture assays, the field of regulatory genomics has recently witnessed increased interest in the functional role of higher order dna structure. organizational principles of eukaryotic nuclei that are uncovered by these genome wide assays range from large scale patterns such as open/closed chromatin compartments  <cit>  and topological domains  <cit>  to more local patterns such as silencing or activating of individual genes by altering the 3d proximity of enhancers to gene promoters  <cit> . however, one important question that remains to be answered is how the simultaneous proximity of more than two loci in the nucleus impacts gene regulation. current conformation capture assays cannot address this question because they only characterize pairwise contacts that involve exactly two loci.

here we demonstrated how to discover simultaneous multi-locus contacts using a straightforward conformation capture assay. we aimed at distinguishing between proximity of multiple loci measured from different nuclei in the form of pairwise contacts and simultaneous proximity between these loci within a single nucleus. we showed that our tm3c assay, which can employ more than one restriction enzyme at a time to increase chromatin digestion, results in chimeras even within a single end of a short paired-end read. accordingly, we developed a two-phase mapping pipeline that uses cleavage information to extract from these chimeras informative contacts that involve two, three or four loci. an additional advantage of tm3c is that it is significantly simpler and yet provides increased resolution for the resulting contact maps compared to current hi-c assays.

it is important to note, however, that there are two drawbacks to our assay compared to traditional hi-c or tcc assays. the first drawback is a tradeoff between resolution and the noise level of the data. frequent digestion of chromatin with multiple 4-cutters increases the resolution but also the noise level of the data, as measured by the ratio between inter and intrachromosomal reads . the second drawback is a tradeoff between the simplicity of the assay and the proportion of informative reads from the paired-end sequencing. in the tm3c assay we omit the steps of re overhang biotinylation and streptavidin pull-down which are present in both the hi-c and tcc assays. this omission results in a higher percentage of sonication products  in the sequencing libraries of tm3c  which we discard after read mapping.

despite these drawbacks, we believe that tm3c is an effective assay in profiling genome architecture—evident by the consistency of our results with characteristic features of genome organization—with the added benefit of revealing multi-locus contacts. in order to demonstrate the utility of tm3c, we applied it to two human cell lines. we specifically chose one of these cell lines as the near-haploid kbm <dig> which has been used in settings where having multiple copies of a chromosome is problematic, such as loss-of-function genetic screens  <cit> . we first established that tm3c contact maps are consistent with karyotypic features of kbm <dig> and that kbm <dig> cells share common large scale organization with other mammalian cell lines previously assayed by hi-c. focusing on a well-studied locus  that has been shown to be involved in parent of origin specific long-range chromatin loops, we showed that tm3c identifies multi-locus contacts , more than half of which were validated using pcr. confirmed triples involved intrachromosomal loops bringing together regions that are more than megabases away in genomic distance as well as regions from different chromosomes. together with results from previous fish experiments that reveal igf <dig> is located outside of its chromosome territory in the majority of nuclei  <cit> , our findings suggest that complex regulation of igf <dig> and h <dig> may involve interactions with multiple distal regions simultaneously.

another important aspect of our work is the modeling of 3d organization of a human cell line without averaging data from multiple copies of a chromosome or resolving the haplotype. to date 3d modeling efforts on the human genome have been limited to haploid chromosomes such as the x chromosome in male cells  <cit> , one chromosome or one portion of a chromosome at a time  <cit>  or have assumed artificially that only one copy of each chromosome exists per cell  <cit> . in this work the near-haploid karyotype of kbm <dig> allowed us to overcome these limitations to infer whole-genome 3d models. by extending an algorithm that we developed previously for haploid genomes  <cit>  to handle the diploid portions of kbm <dig> cells, we generated 3d models for this leukemia cell line. due to the lack of independent data available on kbm <dig> cells, we were unable to verify our 3d models further or correlate them with features such as histone modifications and transcription binding. however, our models are consistent at the large scale with previous observations that suggest chromosomes with similar sizes tend to be closer to each other in 3d. it is also important to note that, similar to many previous approaches, our 3d models are consensus structures that summarize the genome architecture of a cell population. capturing the heterogeneity of genome architecture across cells may be possible in the future, especially in conjunction with single-cell techniques  <cit> .

overall, we showed that tm3c provides a framework to identify multi-locus contacts genome-wide in conjunction with commonly used next generation sequencing platforms that produce short paired-end reads . we believe that with broader use of longer reads  tm3c will be able to profile a larger number of multi-locus contacts with higher signal-to-noise ratio. such profiling is important in understanding better the combinatorial regulation of gene expression and complex chromatin loops that involve more than two loci simultaneously.

CONCLUSIONS
tm3c is a simple protocol for ascertaining genome architecture and can be used to identify simultaneous contacts among three or four loci. application of tm3c to a near-haploid human cell line revealed large-scale features of chromosomal organization and multi-way chromatin contacts that preferentially link regions of open chromatin.

materials and methods
tm3c library generation
approximately six million nhek and ten million kbm <dig> cells were fixed in  <dig> % formaldehyde at room temperature for  <dig> minutes. the fixed cells were washed with tn buffer  and collected by centrifugation at  <dig> g for  <dig> minutes. to increase digestion efficiency, fixed cells  were treated with sds  at 64°c for  <dig> minutes and then at 37°c overnight . the sds concentration was reduced gradually to  <dig> % by adding five times of  <dig> ul  with mixing. triton x- <dig>  was added to  <dig> % concentration and the sample was incubated at 37°c for  <dig> hour. sample volume was adjusted to  <dig> ul by adding  <dig> x restriction buffer, atp  and bsa . digestion with appropriate restriction enzymes  was carried out on a rotate shaker at 37°c for  <dig> hours. we used high concentration neb enzymes to keep the final volume of the enzyme mixture less than  <dig> ul .

the digested samples were deactivated at 65°c for  <dig> minutes and then centrifuged at  <dig>  g for  <dig> min. we recovered ∼95% of cellular dna in the pellet fraction. the pellet fraction was re-suspended with t <dig> ligation buffer  heated at 65°c and mixed with  <dig> ul of melted  <dig> % low-melting agarose. we used  <dig> ul pipette to deliver the hot agarose sample to ice-cold ligation buffer  in a steady fashion within ∼ <dig> seconds, on melted ice. strings of gel bead appeared instantly at 0°c. we sealed the tube with parafilm and perform ligation at rt  overnight on top of a shaker , then transfer the tube to a iced water bath.

the sample pellet was recovered by centrifugation at  <dig>  g for  <dig> minutes, then  <dig> ul of 1% sds  was added and heated at 80°c for  <dig> hour. cross-links were reversed by treatment with proteinase k  at 65°c and  <dig> rpm overnight . melted tm3c-agarose sample was incubated with rnase a  at 55°c for  <dig> minutes and then purified by qiaquick gel extraction protocol . purified tm3c dna was quantified using both a nanodrop spectrophotometer  and a qubit  <dig>  fluorometer. the qubit quantification represents the more accurate dna concentration.

first phase mapping of sequence data
we mapped the paired-end reads to the human reference genome  using the short read alignment mode of bwa  with default parameter settings. each end of the paired reads was mapped individually. we post-processed the alignment results to extract the reads that satisfy the following three criteria:  mapped uniquely to one location in the reference genome,  mapped with an alignment quality score of at least  <dig>   mapped with an edit distance of at most  <dig>  reads that satisfy these criteria are named fully-mapped , and the rest of the mapped reads that did not satisfy these criteria are discarded from further analysis. we identified pairs of fully-mapped reads that share a common identifier to generate the set of contacts that we denote as f-f . the reads that did not map to any location in this phase of mapping are named non-mapped and are analyzed further.

second phase mapping of non-mapped reads
re-mapping the reads that are deemed non-mapped in the initial mapping is necessary to avoid discarding a significant number of informative reads for an assay such as tm3c that uses a frequently cutting restriction enzyme  for digestion. due to the high frequency of cleavage sites in the genome, tm3c is highly likely to capture ligations between dna fragments from two different loci in a single end of a read. we call each such read chimeric because the sequences do not come from a continuous piece of dna but instead from two loci that are in proximity in the three-dimensional space. therefore, for these chimeric ends, after splitting into smaller fragments from the cleavage sites of the restriction enzymes used in the digestion step, we applied a second phase of mapping.

within each non-mapped read, we first counted the number of cleavage sites, taking into account all the restriction enzymes that are used in the digestion step for that specific library. we discarded reads that contain more than two cleavage sites. we also discarded reads that contain no cleavage sites because such reads surely are not chimeric. we split the remaining reads that contain only one cleavage site into two smaller fragments, preserving the entire cleavage site on both adjacent fragments. we mapped the two resulting fragments to the genome using bwa with default parameter settings. the 3-point filtering criteria mentioned in the previous section are applied to the aligned reads, but allowing an edit distance of at most  <dig> to make sure we only extract the unique and high quality mappings. the reads that are extracted from this phase of mapping are named partially-mapped because they did not map as a whole, but their constituent fragments were successfully mapped to different loci. the two classes of mapped reads  and partially-mapped ) yield three possible types of contacts, namely f-f, f-p and p-p. the first set  is extracted after the initial mapping in which each paired-end read can contribute at most one interaction between two loci. the second set  consists of paired-end reads with one end fully mapped and the other end having either one or two smaller fragments that mapped to the genome. if the latter contains only one mapped fragment, then the only interaction is between this fragment and the fully-mapped end. however, if the end has two mapped fragments, then this paired-end read produces three contacts: one between the two mapped fragments on the partially-mapped end and two others that have one side from a fragment from the partially-mapped end and the other side from the fully-mapped end. in addition, the same paired-end read produces one triple  of type p-f. for the contacts of the third type , each paired-end can produce either one, three or six pairwise contacts, depending on whether one or two fragments from each end are successfully mapped. if only one fragment from one end and two from the other is mapped, then, similar to the case of p-f, three pairwise contacts and one triple is produced. if both ends have two mapped fragments, then six pairwise contacts, four triples  and one quadruple  are produced.

normalization of contact maps
for each possible pair of  <dig> mb loci, we refer to the total number of read pairs that link the two loci as the contact count, and we refer to the two-dimensional matrix containing these contact counts as the raw contact map. to normalize the 3113× <dig> raw contact maps, we extended the iterative correction procedure, ice  <cit> , for a nearly haploid genome. first, we corrected for the bias caused by the partial diploidy of the genome. for that, we constructed a “deduplicated” contact counts matrix, where contact counts associated with diploid loci are divided into two equal parts, each of which is associated with one of the homologous chromosomes. contact counts between two different copies of diploid chromosomes/regions are set to  <dig>  the deduplicated matrix is akin to an artificially created allele-specific contact counts matrix, where homologous chromosomes interact in identical ways and do not interact with each other. as a preprocessing step, we ranked loci by their percentage of intrachromosomal contacts with zero counts and filter out the top 10% of this list. this filtering removes all loci for which the signal to noise ratio is too low . last, we applied ice, a method that attempts to eliminate systematic biases in hi-c data. ice assumes that the bias for each entry can be decomposed as the product of the biases associated with each locus, and estimates a bias vector β under the equal visibility hypothesis: the coverage of counts should be uniform. the tensor product β⊗β generates a bias matrix that can be used to convert the raw contact map into a normalized contact map. to generate a contact count matrix of the original size, we summed all counts from homologous chromosomes associated with the same loci. this procedure yields a  contact counts matrix for which diploid loci interact twice as much as haploid loci.

eigenvalue decomposition
we carried out eigenvalue decomposition on the normalized contact maps of kbm <dig> and nhek tm3c datasets as described in  <cit> . for each chromosome we used the intrachromosomal contact matrices at  <dig> mb resolution. we calculated the pearson correlation between each pair of rows of the contact matrix and apply eigenvalue decomposition  to the correlation matrix. the sign of either the first or the second eigenvector defines chromosome compartments for each chromosome. similar to  <cit> , we used the second eigenvector in cases where the first eigenvector values are either all positive or all negative. to map signs of eigenvectors to open/closed compartment labels we used gc content as a marker. for each chromosome the sign with higher gc content is selected as open chromatin. we then compared the percentage of  <dig> mb bins that are assigned the same compartment label by tm3c data versus previously published hi-c data in four human cell lines .

topological domain analysis
we identified topological domains using a previously described hidden markov model-based software tool  <cit> . to facilitate direct comparison with the previously published topological domains in human cell lines, we carried out the domain calling for these published datasets using the human grch36/hg <dig> assembly. we applied the topological domain calling on normalized contact maps of our tm3c data at  <dig> kb resolution. to measure the consistency between the topological domains inferred from tm3c and those from published hi-c data, we calculated the overlap of domain boundaries obtained between these two assays. we deemed two boundaries, one from each assay, as overlapping if they overlap by at least  <dig> bp or are adjacent to each other, as described in  <cit> .

contacts among regions with the same compartment label
we used compartment labels assigned by the eigenvalue decomposition as described above and computed the number of read pairs that define double and triple contacts between two or among three regions all with the same compartment label  or at least two with opposite labels . we used only interchromosomal doubles and interchromosomal triples  for this analysis and eliminated regions that have less than 50% uniquely mappable bases. we then computed the number of all possible pairs and triples of  <dig> mb windows and segregated this number into three groups  giving us the expected percentages of contacts that should fall into each group. with exactly equal numbers of open and closed compartments for each chromosome, these percentages would be 25%, 25%, 50% for pairs of compartments and  <dig> %,  <dig> %, 75% for triples of compartments for the groups of all open, all closed and mixed, respectively. we then reported the ratio between the percentage of observed double and triple contacts to expected percentages within each of these three groups. a ratio > <dig> represents an enrichment for the observed contacts for that compartment label group.

contacts among regions with similar numbers of dhss
we performed an analysis similar to the compartment label analysis described above using joint  dnase hypersensitivity peak calls for the six tier  <dig> cell lines  downloaded from http://ftp.ebi.ac.uk/pub/databases/ensembl/encode/integration_data_jan2011/bydatatype/openchrom/jan2011/fdrpeaks. since there is no dnase data for kbm <dig> we reported results for only k <dig> which is also a leukemia cell line. we computed for each  <dig> mb window with mappability of at least 50% the number of dhs peaks that overlap with this window. we sorted all these windows by decreasing number of dhss and labeled the top 50% as “high” and bottom 50% as “low” dnase sensitivity. we then calculated and reported the expected over observed percentage of doubles and triples as described for compartment labels.

contacts within the same topological domain
after carrying out the topological domain calling using our kbm7-tm3c- <dig> data, we computed the percentage of intrachromosomal doubles and triples that link loci within the same topological domain. to estimate the significance of the observed percentages, we randomly shuffled topological domains by preserving the distribution of the domain lengths for each chromosome arm as described in ay et al.  <cit> . we reported the mean and the standard deviation for the percentage of within domain doubles and triples across  <dig> randomized shufflings.

inference of the 3d structure
we modeled each chromosome as a series of beads on a string, spaced approximately  <dig> mb apart. we denote by x=∈ℝ3×n the coordinate matrix of the structure, where n denotes the total number of beads in the genome including the newly introduced chromosomes 8b and 15b , and xi∈ℝ <dig> represents the 3d coordinates of the i-th bead. contacts from tm3c data can be summarized as an m×m matrix c, where each entry ckl corresponds to the observed contact count between loci k and l. because contact information does not distinguish between homologous chromosomes, m only includes one copy of each chromosome and m<n. for loci in diploid regions, the contact counts are the sum of contact counts due to each copy of the region. if we denote by Φ:→ the mapping that associates a bead i to a locus Φ of the contact count matrix, this means that the contact count ckl between loci k and l is the sum of counts due to interactions between beads in Φ− <dig> and Φ− <dig>  for any two beads i and j mapping respectively to loci k=Φ and l=Φ, let us denote by 0≤μij≤ <dig> the proportion of counts in ckl due to interactions between beads i and j. since all contact counts must be accounted for by interactions between beads, we must have for any loci k and l: 
 ∑i∈Φ− <dig> j∈Φ−1μij= <dig>  

we propose to jointly infer the structure x and the distributions of contact counts μij’s by maximizing the likelihood of the observed contact counts. for that purpose, we modeled the contact frequencies Φ)∈d  as independent poisson random variables, where the poisson parameter of μijcΦΦ is a decreasing function of the euclidean distance dij between beads i and j. our and others’ previous work suggested that the relationship between μijcΦΦ and dij is approximately of the form dijα, with α=− <dig>  <cit> . we can then express the likelihood of the model as: 
  ℓ=∏i,jdijαμijcΦΦμijcΦΦ!exp−dijα. 

to infer the position of each bead, we maximized the log likelihood of the model which is: 
  ℒ=∑i,jμijcΦΦαlog−dijα−logμijcΦΦ!. 

in practice, we solved the following relaxation since μijcΦΦ may not have integer values 
  ℒ=∑i,jμijcΦΦαlogdij−dijα−logΓμijcΦΦ+ <dig>  

with the following constraints: 
dij≤dmax. to find a suitable dmax, we first computed the expected distances ci,i+1−1/ <dig> for adjacent beads of haploid chromosomes. we set dmax to the 97% quantile, thus excluding outliers values arising in the normalization procedure.

 <dig> ≤μij≤ <dig> , where i and j corresponds to loci from the same copy of a diploid chromosomes.



to optimize this non-convex function, we iterated between two steps:  infer the 3d structure x;  re-estimate the distribution of contact counts μij between diploid chromosomes. the first step is solved using an interior point method, as described in  <cit> . for the second step, the optimization problem can be performed with respect to each pair of loci k and l independently. thus we perform a grid search on {μij|Φ=k,Φ=l}, with a step size of  <dig> .

we ran the optimization  <dig> times varying the initialization of the distribution of the contact counts, and another  <dig> times varying the initial structure x. we then selected the top  <dig> structures with the highest log likelihoods.

additional files
additional file  <dig> 
supplementary information. this file contains supplementary figures and tables.



additional file  <dig> 
summary of the two-phase mapping results. this file contains separate worksheet describing in detail the numbers of reads processed at each step of our two-phase mapping.



additional file  <dig> 
rotating view of our kbm <dig> 3d model. this file contains a movie of the kbm <dig> 3d structure that resulted in the highest log likelihood inferred by our algorithm. each chromosome is colored as indicated in figure 6b.



abbreviations
3cchromatin conformation capture

tm3ctethered multiple 3c

tcctethered 3c

icrimprinting control region

pcrpolymerase chain reaction

rerestriction enzyme

ph+philadelphia chromosome positive

cpgcytosine—phosphate—guanine

dhsdnase hypersensitive site

tsstranscription start site

competing interests

the authors declare that they have no competing interests.

authors’ contributions

arh, thv and wsn conceived the project. thv developed the assay and carried out the experiments. fa analyzed the data under the supervision of wsn nv inferred 3d structures under the supervision of jv. fa, wsn, nv and thv wrote the manuscript. all authors discussed and edited the manuscript. all authors read and approved the final manuscript.

