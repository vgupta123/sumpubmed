BACKGROUND
more than six decades ago, conrad h. waddington portrayed a conceptual landscape of development . in his “epigenetic landscape” a ball that indicates the whole or part of an egg or an embryo is rolling down a sloping and undulating surface with several valleys that represent distinguished organs or tissues  <cit> . beyond its deceptive simplicity, the epigenetic landscape has entailed numerous embryogenesis facts:  decreased differentiation potency during development as illustrated by tilt of the landscape;  the epigenetic barriers between sharply distinct cell fates, depicted as the hills between the valleys;  derivation of distinct cell types from identical cells, portrayed as bifurcated valleys.fig.  <dig> waddington landscape of the mouse preimplantation embryo. a the original artwork of waddington . b principal component analysis  of the mouse preimplantation embryo gene expression profiles. each point represents one cell, and the color of each point shows the developmental stage of the cell. c schematic representation of mouse preimplantation embryonic development. d the computational waddington landscape of the mouse early development based on the gene expression profiles. each ball represents a single cell. pc: principal component, icm: inner cell mass, te: trophectoderm, pe: primitive endoderm, epi: epiblast



waddington’s innovation suggested that genetic interactions were the major determinants of a landscape’s shape  <cit> . in support of this idea, a genetic circuit of two tfs each stimulating itself  and repressing the activity of the other  has been shown to form a tristable dynamical system  <cit> . this system can model a lineage bifurcation, which is the differentiation of two distinct cell types from the common progenitor. the triple stable steady states or “attractors” represent the progenitor and two bifurcated lineages. in the progenitor cell state both tfs are expressed at balanced rates. in either of two bifurcated cell states, one tf is active or highly expressed whereas the other tf is silent or slightly expressed.

an example of the mutual-inhibition and auto-activation circuit between two tfs is the gata <dig> versus pu. <dig> circuit, which has been proposed to govern the bifurcation of common myeloid progenitors  to either erythroids  or myeloids   <cit> . other examples of two-tf regulatory circuits suggested for lineage bifurcations are provided in table  <dig>  furthermore, a hierarchy of mutual-inhibition and auto-activation circuits among several pairs of tfs is suggested for the hierarchy of cell type bifurcations during early development  <cit>  and pancreatic differentiation  <cit> .table  <dig> examples of two-tf regulatory circuits that are suggested for lineage bifurcations


gata1
pu.1

oct4
cdx2

nanog
gata4/6

sox10
phox2b

ptf1a
nkx6

pax3
foxc2


as a major drawback, the two-tf circuit is highly dependent on the concentrations and functions of a pair of tfs. in this model, a genetic or environmental perturbation that affects one of the tfs can change the behavior of the circuit and result in a deficient lineage bifurcation. some experimental studies, however, show the cell differentiation is more robust.

for instance, the recent finding that the inner cell mass  is formed after complete inactivation of oct <dig> expression  <cit>  rejects the hypothesis that icm vs. trophectoderm  bifurcation is switched solely by the oct <dig> versus cdx <dig> circuitry.

here we introduce a computational framework for modeling the epigenetic landscape. using the single cell resolution gene expression profiles of preimplantation mouse embryonic cells  <cit>  we visualize the waddington landscape of early development. after analysis of the expression patterns of the key tfs that are suggested to form early lineage bifurcations, we provide an extended form of hierarchical regulatory circuitry in which each bifurcation is decided by two clusters of tfs, rather than two single tfs. we show this extended circuitry is more robust against perturbation, which suggests it can better safeguard the development.

RESULTS
the waddington landscape of a preimplantation embryo
we constructed the epigenetic landscape of mouse preimplantation embryonic development using the expression profiles of  <dig> genes – mostly tfs – in  <dig> single pre-implantation embryonic cells  <cit> . for this purpose, we quantified three axes: cell type , time of development , and pseudo-potential function . time of development was quantified according to the developmental stage of each cell in the dataset. we used principal component analysis   <cit>  to project the expression profiles of the cells into a two-dimensional space , in which the cells with similar fates during embryonic development  were clustered together. the angular coordinates of the cells in the pca plot were used to put them across the x-axis of the epigenetic landscape. in this way the cells were sorted along the x-axis according to their types. we also defined a pseudo-potential function using the gaussian mixture model and boltzmann distribution, and computed the z-coordinates accordingly.

the result is shown in fig. 1d. each ball represents a single embryonic cell. the y-axis  shows different developmental stages from 1-cell  to 64-cell . the height of each region shows the pseudo-potential function level, which reflects both stability and differentiation potency. there is a single valley from the 1- to 16-cell stages that shows no significant difference between single embryonic cells at these stages. the first bifurcation appears at the 32-cell stage, where icm is distinguished from te. at the 64-cell stage the icm cells undergo a second bifurcation that discriminates epiblast  from primitive endoderm .

regulatory circuitry of two transcription factors  can form lineage bifurcations
in order to inspect how the epigenetic landscape bifurcations were formed we examined the expression levels of four key tfs of preimplantation development: oct <dig>  cdx <dig>  nanog and gata <dig>  these tfs were selected due to their known critical functions in the formation of early embryonic cell types  <cit> . our analysis shows that oct <dig> is expressed in icm and its sub-lineages, but becomes silent in the te valley . in contrast, cdx <dig> is overexpressed in the te, and underexpressed in the icm and its sub-lineages. both nanog and gata <dig> are underexpressed in the te valley, but have a sharp contrast in icm sub-lineages. nanog is overexpressed in the epi and underexpressed in the pe cells, while gata <dig> is overexpressed in the pe and underexpressed in the epi valley.fig.  <dig> expression levels of four key transcription factors  in early embryogenesis. a the gene expression levels of oct <dig>  cdx <dig>  nanog and gata <dig> in the single cells of preimplantation embryos. the cells with the highest expression level of each tf are depicted in red, while the intermediate and the lowest expression levels are shown as white and blue, respectively. b the regulatory circuitry between oct <dig> and cdx <dig> , and nanog and gata <dig> . green and red arrows show positive and negative regulatory interactions, respectively. te: trophectoderm, pe: primitive endoderm, epi: epiblast



competition in expression of oct <dig> and cdx <dig> is suggested to arise from the particular form of regulatory circuitry between them  <cit> . while binding of oct <dig> to its own promoter has a positive regulatory effect, its binding to the cdx <dig> promoter is suppressive. similarly, cdx <dig> activates itself but inhibits oct <dig> . the regulatory circuitry between nanog and gata4/ <dig> has a similar structure   <cit> .

a set of ordinary differential equations  are previously used to model the regulatory circuitry between two generic tfs, such as a and b, with auto-activation and mutual inhibitions  <cit>  . such odes form a tristable dynamical system that can be visualized in a force-field representation . each grid point of the plot represents one system state with certain concentration levels of the tfs a and b, which are specified as the point dimensions. for each grid point, an arrow shows the direction of changes in the tf concentrations after a short period of time. the areas with longer arrows, in violet, represent the system states with higher tendency to change. in contrast, the shorter red arrows represent the more stable states of the system.fig.  <dig> attractor states of the two-tf regulatory circuitry. a force-field representation of the dynamical system of a regulatory circuitry consisting of two tfs with auto-activation and mutual-repression interactions. b regulatory states of the tfs in the three enumerated attractor states. highly expressed tfs and strong interactions are shown as thick lines, whereas thin lines represent intermediate expressions or interactions. null expressions or interactions are depicted as dashed-lines. c, d phase space representations of the two-tf circuits. red regions represent the highly stable states.  both tfs have equal degradation rates. d the degradation rate of the transcription factor a is increased by 50 % 



in the attractor  <dig>  as enumerated in fig. 3a, a is highly expressed and b is silent, and this state is maintained through the positive and negative feedback loops . the same conditions hold for the attractor  <dig> in which dominant expression of b suppresses expression of a and maintains a high abundance of b . in attractor  <dig>  however, both tfs are expressed at lower and balanced rates . in the same attractor, the positive feedback each tf receives from auto-activation forms equilibrium with the negative feedback from the other tf. the attractor  <dig> represents a progenitor cell type, while  <dig> and  <dig> denote two bifurcated cell lineages.

two-cluster regulatory circuitry can resist perturbations
although the two-tf regulatory circuitry could account for a developmental bifurcation, we conjectured that this type of regulatory circuitry would be too sensitive. in other words, genetic mutations or environmental perturbations that affect the concentration or function of either tf could influence the bifurcation and the ratios of the cells that differentiate into either lineage, or even lead some cell type to completely vanish.

to test this conjecture, we computationally examined the effect of an increased degradation rate of one tf. as shown in fig. 3c, the original two-tf circuit with similar degradation rates of both tfs forms three attractor states indicated by red areas surrounded by the green epigenetic barriers. increasing the degradation rate of the protein a by 50 % in the ode model significantly changes the position of the stable states . while the attractor  <dig> remains isolated, the attractors  <dig> and  <dig> fuse together. as a result, it would be more likely for the progenitor cells in attractor  <dig> to differentiate into the attractor  <dig> rather than  <dig> during the lineage bifurcation.

we hypothesized that the regulatory circuitry would be more robust against perturbations or noise if there were more tfs involved in the formation of either branch of the bifurcation. to check this hypothesis we designed a new ode system that represented a regulatory circuitry consisting of two clusters, with a couple of tfs in each cluster. the tfs of the same cluster have positive mutual regulatory interactions, whereas the tfs of opposite clusters inhibit each other .fig.  <dig> attractor states of the two-clusters regulatory circuitry. a the regulatory circuitry consisting of two clusters: a and c in one cluster, and b and d in the other. the interactions between the members of the same cluster are positive, and the interactions between the tfs of different clusters are negative. b phase space representation of the system. red regions are highly stable. c, d regulatory circuitry and phase space representation of two clusters, in which the degradation rate of the protein c is increased by 50 % 



to show a 4-dimentinal  expression-space of the  <dig> tfs as a 2d plot, we assigned the total expression of the tfs in each cluster to one axis . the pseudo-potential function of the two-tf cluster circuitry shows a tristable system, which is very similar to the two-tf model. both tfs a and c that belong to the same cluster are highly expressed in the attractor  <dig>  whereas b and c are silent. in contrast, b and d are overexpressed in the attractor  <dig>  while a and c are silent. the progenitor attractor state  <dig> represents the equilibrium in which all tfs are expressed at balanced rates.

in the two-cluster circuit, we analyzed the effect of a 50 % increase in the degradation rate of protein c . the attractor areas are slightly moved in the perturbed model  compared to the original two-cluster model . in particular, attractor  <dig> is slightly closer to attractor  <dig>  due to the decreased concentration of protein c in the equilibrium state. however all three attractors are maintained and none them are fused together.

to have a quantitative insight into the robustness, we simulated the differentiation of four cell populations, each population having one of the regulatory circuitries shown in fig. 3c, d and fig. 4a, c . we forced the cells to leave the progenitor state  and differentiate into the attractor states  <dig> or  <dig>  this was performed by gradually decreasing the auto-activation strengths of the tfs, as previously suggested  <cit> .

in both two-tf and two-cluster circuits, the number of cells that differentiate into the attractors  <dig> and  <dig> are very similar , when there is no perturbation. after increasing degradation rate of one tf, only 3 % of the cells with two-tf circuit differentiate to the attractor  <dig>  nevertheless, the fraction of the cells with two-cluster circuit that differentiate to the attractor  <dig> is significantly higher . this simulation shows that one cell lineage  is almost vanished when the two-tf circuit is perturbed, while the two-cluster circuit is significantly more robust and safeguards differentiation into both lineages.

early developmental bifurcations are switched by two clusters of tfs
we sought to determine whether the hypothesized tf clusters existed in the regulatory circuitry of the early embryogenesis. for this reason, we analyzed the expression profiles of the single mouse blastomeres at the 64-cell stage . our analysis indicates three clusters of genes, which are mostly tfs . the expression profiles of the genes in the same cluster are highly correlated, but lower or negative correlations are observed among the genes of different clusters. the first cluster consists of  <dig> genes, including cdx <dig>  eomes and gata <dig>  which are highly expressed in te. the second cluster includes  <dig> genes such as gata <dig>  gata <dig> and sox <dig> that mark pe cells. the  <dig> genes of the third cluster, including nanog, fgf <dig> and sox <dig>  are overexpressed in epi cells. the genes of the te cluster show lower coexpression with the genes of the other clusters. some epi genes are highly coexpressed with pe genes, which might reflect the limited time passed from the bifurcation of epi and pe cell types at 64-cell stage.fig.  <dig> co-expressions of  <dig> genes in single blastocysts of the 64-cell stage mouse embryos. each square shows the correlation value between expression profiles of two genes. hierarchical clustering trees of the genes are shown in the top and left sides. there are three clusters of genes with high positive correlations, as indicated on the left side. the cell types in which each cluster is highly expressed are also shown



through a literature search we revealed the experimentally validated regulatory interactions among the genes that pioneer early lineage bifurcations . there are reports of positive interactions among tead <dig>  eomes, gata <dig>  cdx <dig>  elf <dig> and a number of other genes that are upregulated in te cells . the regulatory effects among pou5f <dig>  nanog, sox <dig> and sall <dig>  as key tfs of the icm cells, are also positive. however, the tfs in one cluster have been shown to repress the tfs in the other cluster. this finding is in agreement with the structure of the two-cluster circuitry. a similar regulator pattern can also be observed among the pe markers gata <dig>  gata <dig>  sox <dig> and sox <dig> in one cluster, and epi markers nanog, sox <dig> and oct <dig> in the other cluster. assigning the color of the cells on the epigenetic landscape based on the average expression level of each cluster confirmed the proposed tf clusters experimentally .fig.  <dig> regulatory circuitry of lineage bifurcations in the mouse preimplantation embryo. left side shows two clusters of genes that are active either in the icm or the te. the interactions among the genes of each cluster are positive, while the interactions between the members of distinct clusters are negative. right side shows similar network for the epi and the pe. icm: inner cell mass, te: trophectoderm, epi: epiblast, pe: primitive endoderm



discussion
we computationally visualized the waddington landscape of mouse preimplantation development using the experimental data and depicted the differentiation of cell lineages as bifurcations of the valleys. in this study, we modeled the dynamical system of a regulatory circuit consisting of two individual tfs with auto-activation and mutual inhibitions, which has been proposed for lineage bifurcation  <cit> . this circuit formed a tristable dynamical system with clear borders of epigenetic barriers among them. an increased degradation rate of one tf caused the epigenetic barriers between the progenitor and one of the lineage committed cell states to be broken. this experiment showed that the circuit of two individual tfs is not very robust, and the ratios of the cells that commit to each lineage may be significantly affected by perturbations.

we investigated whether the presence of more tfs in the regulatory circuitry that governs a developmental bifurcation could lead to a more robust system. extension of the initial circuit to a pair of clusters with multiple lineage-instructive tfs in each cluster, which activated themselves and inhibited the other cluster members, resulted in another tristable dynamical, similar to the one formed by the two-tf circuit. in the extended network, however, the epigenetic barriers were not vastly affected by increased decay rate of one tf, which was quantitatively confirmed by a simulation.

the positive feedbacks from the other tfs of the same cluster could buffer the effect of perturbations on a particular tf. this buffering property is somehow similar to the waddington’s original idea of “canalisation” – the capability of the system to recover after slight perturbations  <cit> . we expect this property would be even stronger in larger clusters of tfs having more positive feedback loops. this is in agreement with a suggestion by waddington in the same book: “canalisations are more likely to appear when there are many cross links between the various processes, that is to say when the rate of change of any one variable is affected by the concentrations of many of the other variables”  <cit> . as the second property, the total expression of one tf cluster can overcome and inhibit the expression of the other tf cluster. we call these properties together as the collective decision-making of the tfs.

the extended regulatory circuitry was further illustrated by our analysis of the expression profiles of key tfs in mouse blastocysts. we indicated three clusters of genes  that represented the epi, pe and te cell types . a literature review of regulatory interactions among members of each cluster confirmed the structure of two-cluster regulatory circuitry and its role during early development .

the proposed concept of two-cluster circuitry can be extended in a modular way to form a hierarchy of developmental bifurcations . early stages of development involve minimal cell quantity, and a small change in the fate of each single cell will pass on to a large number of offspring cells. thus stronger safeguarding against perturbations is more crucial in the early development. this can be achieved by the presence of more tfs in each cluster and/or stronger feedback loops. the later developmental bifurcations are less sensitive and might rely on smaller clusters or even individual tfs.fig.  <dig> developmental bifurcations are governed by a hierarchical regulatory circuitry. each circuit consists of two clusters of transcription factors , with positive feedbacks within each cluster and negative feedbacks between the two clusters. prior to each developmental bifurcation, the tfs of both corresponding clusters are expressed at a balanced state. in each post-bifurcation branch, one cluster is downregulated while the other is upregulated. this triggers the competitive expression of clusters that switch later bifurcations



to identify the tf clusters of each bifurcation circuit we suggest assigning the expression profiles of embryonic and adult cell types to the network of differentiation  <cit> . then we can look for the differentially expressed tfs and chromatin remodelers between a pair of cell types and offspring lineages, which are bifurcated from the common progenitor cells. this can be a systematic method to identify cocktails essential for cell type conversions such as reprogramming and transdifferentiation  <cit> .

while the proposed hierarchical regulatory circuitry provides a basis for better understanding and analysis of developmental bifurcations, we do not exclude more complicated mechanisms such as the role of signaling networks and morphogens. for example, during embryonic stem cell differentiation, oct <dig> and sox <dig> have mutual positive feedbacks and belong to the same cluster of upregulated tfs in the icm and epi. the repressive effects of wnt3a and activin on sox <dig>  and also inhibition of oct <dig> by fgf and retinoic acid result in asymmetric upregulation of sox <dig> in the mesendoderm and oct <dig> in the neural ectoderm  <cit> . this example lends support to the concept that signaling cascade forces dominate regulatory interactions of tfs, and will eventually cause the tf cluster to split.

a second example of the cryptic mechanisms in bifurcation regulation is the presence of master and supportive tfs. in the symmetric computational model, we have assigned identical effects to different tfs of the same cluster in determining the cell lineage. this can be further extended to an asymmetric model where one, or a small number of tfs in each cluster are the master lineage indicators and the other members support their expression and function. the latter suggests inactivation of different tfs in the same cluster will have different effects on formation of the corresponding cell lineage, which is supported by experimental evidences  <cit> .

there are even more aspects of the cell biology that are critical for understanding development and differentiation. while gene-to-gene interactions are essential for the cells to differentiate, cell-to-cell communications are crucial for the embryo to balance the required quantity of each cell type, and to develop tissues and organs. as an example, the icm and epi cells secrete the fgf <dig> signal, which binds to the fgfr <dig> receptor on the membrane of te and pe cells . the development of te and pe cells are significantly influenced by this signal  <cit> ; for instance the increased fgf <dig> concentration results in enhanced pe and diminished epi cells  <cit> . as a result, the proportion of the cells that differentiate into either epi or pe would be balanced, which is another mechanism of developmental robustness. in absence of signals and intercellular communication, development would terminate in a salt-and-pepper mixture of differentiated cell types without any pattern.

cell division and epigenetic mechanisms such as dna methylation and histone modifications are the other crucial factors that influence the starting point and shape of the epigenetic landscape for each cell. to address these biological aspects, we suggest assigning individualized epigenetic landscapes to different cells, which are dynamically changed by the inherited parental cytoplasm and epigenetic modifications, the environmental signals and the other mechanisms of intercellular communication . hence the cells that are divided from the same parent or the adjacent cells would have similar epigenetic landscapes, which bias their differentiation towards particular cell types of the same tissue. we expect that this comprehensive approach to the waddington landscape will provide new insights to the developmental biology.

CONCLUSIONS
in this work we presented a framework for modeling the epigenetic landscape of the single cell resolution gene expression profiles. we visualized the epigenetic landscape of mouse preimplantation embryogenesis based on the expression profiles of  <dig> genes in  <dig> embryonic cells  <cit> , which resembled the original metaphoric waddington landscape of cellular differentiation  <cit> . next we scrutinized to determine the regulatory circuitry that governs each developmental bifurcation.

we examined, through an ode based model, the two-tf genetic circuits, which were previously suggested to regulate lineage bifurcations  <cit> . perturbation, in form of increased decay rate of one tf, severely changed the shape and position of the attractor states. it could be concluded that any factor that has the potential to affect the expression or function of those tfs, such as genetic mutations, extrinsic stimuli and intrinsic noise, could deviate the corresponding cell fate decision.

next we developed a hierarchical regulatory network consisting in pairs of auto-activating and mutual-inhibiting clusters of tfs. our analysis showed the enhanced buffering capacity of the two-cluster regulatory circuitry against biological perturbations, due to the collective decision-making of tfs. our finding can be a further explanation for the determinism and robustness of the embryonic development.

