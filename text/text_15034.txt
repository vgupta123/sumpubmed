BACKGROUND
cooperation is predicted to evolve more easily when social partners are genetically related  <cit> . in many species, individuals are able to assess the genetic similarity of conspecifics using heritable phenotypic cues, for example by comparing their own cues to those of their social partners , or by directly identifying individuals with the same genotype as them at a particular locus . such cue-dependent cooperation is thought to be common in all domains of life, including plants  <cit> , fungi  <cit> , bacteria  <cit> , vertebrates  <cit> , insects  <cit> , slime moulds  <cit>  and sessile marine invertebrates  <cit> .

cooperation based on genetic cues is a conundrum because it requires polymorphic recognition loci, yet cooperation is predicted to erode this genetic variation . this problem, sometimes termed crozier’s paradox, applies whenever individuals with common recognition cues receive greater average fitness returns from social interactions. for example, individuals with common cues might be aggressively rejected less often  <cit> , or might receive altruism from a greater proportion of the population  <cit> . disproportionate fitness benefits for individuals with common recognition alleles should produce positive frequency-dependent selection at recognition loci, depleting the genetic variance necessary for kin recognition.

the origin and maintenance of polymorphic genetic recognition cues remains incompletely understood despite substantial theoretical and empirical research . previous models of cue-dependent cooperation have treated the cooperative behaviour and the recognition cue phenotype either as products of a single locus  or separate loci  <cit> . in one such two-locus model, individual recognition alleles increased in frequency when in linkage disequilibrium with the cooperative allele, but were prevented from fixing by non-cooperating "freeloaders" with the same recognition allele  <cit> . intermediate recombination rates produced cycles in which cooperation and multiple recognition alleles could coexist, suggesting that genetic recognition systems can remain somewhat stable under some conditions. by contrast, subsequent analytical models and simulations suggested that a very restrictive combination of high population structure, low recombination and frequent mutation is required to preserve recognition cue diversity  <cit> . hence, the paradox of highly variable genetic recognition cues remains largely unresolved, at least under the assumption that recognition loci function only in the selection of social partners. the prevailing consensus is therefore that recognition loci likely have more than one function , and that the pleiotropic function introduces negative frequency-dependent selection that preserves recognition cue diversity  <cit> .

such negative frequency-dependent selection could be provided by pathogens and parasites, for example when parasites evolve to preferentially infect hosts with common recognition cues . some loci used in kin recognition also affect parasite resistance, notably the major histocompatibility complex  of vertebrates . additionally, social insects use heritable chemical cues to identify colony members  <cit>  as well as allospecific social parasites; these parasites may evolve to chemically mimic the commonest host genotypes  <cit> . host-parasite interactions may similarly maintain cue diversity in parasitic species. copidosoma floridanum parasitoid larvae identify and attack unrelated larvae present inside the same host using cues present on a membrane surrounding the larvae  <cit> . common cues might therefore confer protection against unrelated larvae, but the membrane also defends larvae from the host’s immune system, which may select for rare phenotypes  <cit> . rare cues have also been proposed to improve the precision of intra-specific recognition and thereby reduce the frequency of costly errors  <cit> .

recognition cues that inform social behaviour might also be used in the context of mate or gamete choice . a pleiotropic function in mate choice might preserve genetic polymorphism at recognition loci by at least four non-exclusive mechanisms.

firstly, individuals with rare recognition cues might be attractive to or compatible with a greater proportion of potential mates, for example if individuals avoid inbreeding by discriminating against potential mates with similar recognition cues, or if matings between partners with the same recognition locus genotype are infertile  <cit> . individuals with rare cues would therefore have a sexually-selected advantage that might counterbalance their disadvantage in social interactions. this hypothesis reflects the well-known population genetic result that disassortative mating can increase genetic diversity provided that it creates inequalities in mating success  <cit> .

secondly, disassortative mating with respect to recognition loci should increase their heterozygosity. assuming that cooperation increases the fitness of common genotypes, this would increase the fitness of heterozygotes, promoting genetic polymorphism. this hypothesis  assumes that cooperation occurs primarily or solely between individuals that share both alleles at the recognition locus .

thirdly, for species in which cooperation occurs between individuals sharing at least one recognition allele , we suggest that the increase in heterozygosity caused by disassortative mating could provide "hiding places" for rare recognition alleles. under 1-allele matching, rare alleles may receive substantial amounts of cooperation when sharing a body with a common allele. disassortative mating causes rare alleles to exist as heterozygotes even more often than predicted under random mating. this could prevent rare alleles from being lost from the population, increasing the ability of mutation and migration to maintain recognition locus diversity  <cit> .

fourthly, we propose that disassortative mating for recognition cues may indirectly lead to disassortative mating for condition. this is because matings between individuals with common and rare cues should be more frequent under disassortative mating, and individuals with common cues will tend to be in better condition since they receive greater average payoffs in social interactions. under disassortative mating, individuals with rare cues might tend to have a mating partner in better condition than themselves and vice versa, potentially improving the relative fitness of individuals with rare recognition alleles.

previous models of genetic kin recognition have mostly assumed random mating and haploidy , so the effect of mating systems on crozier’s paradox is currently unclear. here, we explore in detail the hypothesis that mate choice affects the evolution of cooperation based on genetic recognition cues using individual-based simulation. we also review the available literature in order to evaluate the relative importance of mate choice in stabilising cue-dependent cooperation in diverse taxa.

methods
the individual-based simulation was inspired by simulations in rousett and roze  <cit> . in brief, we consider the evolution of cue-dependent cooperation in a finite, patch-structured population of sexually reproducing individuals that possess two loci that control recognition and cooperation respectively. in each generation, individuals potentially cooperate with their patch mates, then mate and produce offspring, some of which disperse to other patches. the key differences of our model are that mating within patches can be non-random with respect to the recognition locus, and individuals are diploid not haploid, facilitating investigation of the consequences of heterozygosity differences between mating systems.

table  <dig> summarizes the parameters and their possible ranges. patches contain n diploid hermaphrodites, the number of patches is given by the population size divided by n, and n is assumed to be even. the recognition locus has k possible co-dominant alleles, while the behaviour locus has a cooperative allele and a non-cooperative allele . cooperation is contingent on the actor sharing either one or both recognition alleles with the recipient; we modelled such "1-allele matching" and "2-allele matching" systems separately. in each generation, all possible pairs of individuals within each patch meet, and if the actor is homozygous for the cooperative allele and is sufficiently similar to the recipient at the recognition locus, the condition of the recipient is increased by b at a net cost c to the condition of the actor. we therefore assume either that the recognition locus also causes individuals bearing the cooperative allele to only cooperate with others bearing similar recognition cues , or that genes causing such a preference are fixed at other loci . heterozygous cooperators provide h times as much help as homozygous cooperators , such that they confer a benefit bh and pay a cost ch, while non-cooperator homozygotes never provide help.

an individual’s net condition after the helping phase is equal to a base value, adjusted for the costs and benefits of cooperative acts performed and received. base condition was set to cn, i.e. the cost of helping all individuals in the patch. condition is therefore equal to cn + bsum- csum, where bsum and csum are the summed benefits and costs of cooperative actions received and performed by the focal individual; csum is zero for non-cooperators.

after the cooperation phase, individuals mate with a single partner from their patch, produce offspring and then die . to explicitly model the effect of different mating systems on the persistence of cue-dependent cooperation, we allowed for non-random mating within patches. the mating system was determined by the parameter m, which ranges from - <dig>  to  <dig> . when m = - <dig>  individuals always mate with partners that share no recognition alleles whenever such partners are present in the same patch; once there are no such pairings left, individuals that have one allele in common are mated. the remaining unmated individuals are then mated at random. the reverse is true when m =  <dig>  i.e. all individuals share one or both alleles with their mate whenever possible. for values between - <dig> and  <dig>  there is a probability equal to 1–|m| that the "preferred" mating type will not occur; for example, for m =  <dig>  we first pair up all the same-type individuals, and each pair mates with a probability  <dig> . those that do not mate then go on to be paired up with individuals with which they share one allele, and again mate with a probability of  <dig> . all the remaining unmated individuals then mate with a random partner. thus mating becomes increasingly random as m approaches zero, and is completely random when m =  <dig> 

the number of offspring that are produced and survive until the migration phase is equal to the condition of one randomly selected parent , rounded down to the nearest integer. mating pairs that are non-identical at the recognition locus produce an additional x offspring. higher values of x disproportionately increase the fitness of rare recognition alleles, because rare genotypes are more likely to be involved in a dissimilar-type mating for any given m. we envisage x as representing the sum of the possible direct benefits  and indirect benefits  of dissimilar-type matings. as x increases, the results of the model converge on those that would be obtained had we assumed that only disassortative matings are fertile. disassortative mating is more likely to evolve if it is selectively advantageous, such that x and m will tend to be negatively correlated in nature.

diploid offspring were produced assuming mendelian inheritance. recombination occurs between the two loci with probability r , and mutation with probability μ. mutation converts a cooperative allele to a non-cooperative allele and vice versa, and converts a recognition allele to one of the other  possible alleles. each offspring has a probability d of dispersing to another randomly-selected patch; otherwise, it remains at the natal patch. after the migration phase, the populations in each patch are randomly culled down to the patch size n.

at the start of each simulation, all individuals had a random recognition locus genotype and were homozygous for the non-cooperative allele; the model therefore considers the origin of cooperation based on pre-existing, polymorphic recognition cues. simulations were run for  <dig>  generations with a population size of  <dig> . recognition locus diversity was measured using an index, calculated as /1–1/k, where fk is the frequency of the kth allele. this index is zero when one allele has fixed and one if all k alleles are present at equal frequencies.

RESULTS
the primary findings of the model are: 1) disassortative mating and beneficial outbreeding can maintain cue-dependent cooperation over evolutionary time under certain conditions, and 2) mate choice interacts with other parameters in its effects on recognition locus diversity and the frequency of the cooperative allele.

two illustrative runs of the model are shown in figure  <dig>  in figure 1a , individual recognition alleles excluded nearly all of the others by hitchhiking to high frequency with the cooperation allele, before declining once non-cooperators bearing the same recognition allele became common. they were replaced by another dominant lineage of cooperators, which in turn succumbed to "freeloaders" and were replaced; this figure shows crozier’s paradox in action. by contrast, in figure 1b , multiple lineages of cooperators persisted indefinitely at largely equal frequencies.

figures  <dig> and  <dig> examine the effects of the model’s parameters on recognition locus diversity and the frequency of cooperation at equilibrium. redder colours denote higher recognition locus diversity, while the frequency of the cooperative allele is shown by contour lines; parameter spaces favouring the evolution and maintenance of cue-dependent cooperation thus have red colours and high values on the contour lines. the figures show the average values of the last  <dig> generations . the high similarity of neighbouring parameter spaces indicates that the simulations produced consistent results, and thus that  <dig> replicates per parameter space was sufficient. moreover, the standard error of the output of the  <dig> runs was low:  <dig>  for recognition locus diversity and  <dig>  for the frequency of the cooperative allele .

maintenance of cue-dependent cooperation by mate choice
we first held all parameters constant except for b, m and x, to test how the mating system affects the evolution of cue-dependent cooperation. assuming 2-allele matching and no direct fitness consequences to mate choice , recognition locus diversity was lost whenever cooperation invaded, even under disassortative mating. with 2-allele matching and x >  <dig> , negative frequency-dependent selection arose at the recognition locus because individuals with rare recognition alleles produce an additional x offspring more often, which in some cases maintained maximal values of cue diversity and cooperation. disassortative mating increased the parameter space under which cue-dependent cooperation was able to persist. note also that when the b:c ratio was low, cooperation did not evolve  but recognition locus diversity persisted at maximal values. this shows that recognition cue diversity remained at high levels under mutation-drift balance when selection from cooperation was absent under our assumptions, such that all non-red parts of the figures signify the erosion of diversity by cooperation .

figures 2c and 2d show the same parameter space as figures 2a and 2b, but assume 1-allele matching. the cooperative allele required a higher b:c ratio to invade and persist with this less stringent mode of recognition, which causes cooperators to help non-cooperators more frequently. comparing figures 2a and 2c, one can see that 1-allele matching coupled with disassortative mating creates a parameter space under which fairly high  values of cue diversity and cooperation can persist even when x =  <dig>  which is not true of 2-allele matching. we therefore found evidence that disassortative mating paired with 1-allele matching can counteract crozier’s paradox even if inbred and outbred matings are equally fit. this effect occurs because disassortative mating increases the heterozygosity of the recognition locus, and 1-allele matching means that heterozygotes containing one rare and one common recognition allele will experience at least as much cooperation as individuals homozygous for the common allele. selection against rare alleles therefore becomes weaker, promoting polymorphism at mutation-selection balance. however, we found little support for crozier’s  <cit>  prediction that disassortative mating can preserve polymorphic recognition cues by increasing the frequency  of heterozygotes. if this effect were strong, one might expect diversity to sometimes be preserved under 2-allele matching, disassortative mating and x =  <dig>  yet it was always lost once cooperation invaded .

disassortative mating also caused the cooperative allele to be maintained at lower frequencies than under random or assortative mating . this result possibly arose because disassortative mating leads to relatively more matings between individuals with common and rare recognition genotypes, which tend to be high-condition and low-condition respectively. because the cooperative allele is typically in linkage disequilibrium with common recognition alleles , this negative correlation between parental qualities simultaneously lessens the fitness gap between common and rare recognition alleles, and between the cooperative and non-cooperative alleles. conversely, assortative mating produces a positive correlation between parental qualities, which benefits the most common recognition alleles, as well as the cooperative allele .

interactions between mate choice and other parameters
because mate choice was found to have less effect on the maintenance of cue-dependent cooperation when x =  <dig>  we set x =  <dig> for subsequent simulations , i.e. we assumed that matings between individuals with non-identical recognition genotypes produce additional offspring, equivalent to being helped 6/b times. we also assumed 2-allele matching.

population viscosity generally fostered the evolution of cue-dependent cooperation. smaller patches and intermediate dispersal rates produced the highest number of cooperators, and both patch size and dispersal rate interacted with mating system in their effects on the evolution of cue-dependent cooperation . cue-dependent cooperation did not persist at any patch size under assortative mating under the present assumptions, but diverse cues and relatively high rates of cooperation were maintained if mating was disassortative and patches were small. dispersal rate had a stronger effect on the frequency of cooperation under disassortative mating than assortative mating; disassortative mating allowed cue-dependent cooperation to persist even in relatively unstructured populations. as expected, cooperation did not persist when dispersal rates were close to zero, because competition among kin counteracts the inclusive fitness benefits of cooperation  <cit> .

the amount of extra offspring produced by mating pairs with dissimilar recognition alleles  was positively related to both recognition locus diversity and the frequency of cooperation, especially under disassortative mating . this result means that if rare recognition alleles are advantageous in sexual interactions, cue-dependent cooperation is more likely to persist. the interaction with mating system arises because the benefit of dissimilar matings is obtained more often when individuals tend to mate disassortatively. the precise value of x needed to stabilise cue-dependent cooperation is presumably a function of the b:c ratio, mating system and current frequency of cooperation.

the number of recognition alleles present  was positively related to both diversity and the frequency of cooperation, up to an asymptote ; this effect was especially pronounced under disassortative mating. the cooperative allele also failed to invade when the number of possible recognition alleles was low , because the recognition locus provided inadequate information on relatedness at the cooperation locus for cooperation to be selectively favoured in this parameter space.

strong or complete linkage between the two loci caused a drop in recognition locus diversity ; however, varying the recombination rate from  <dig>  to  <dig>  had little effect on equilibrium allele frequencies. with very low recombination, recognition alleles can remain associated with the cooperative allele for longer periods, and can therefore displace more of the other recognition alleles before linkage disequilibrium between the common recognition allele and the cooperative allele decays via recombination and mutation . there was no evidence that recombination rate and mating system interacted in their effects on cue-dependent cooperation.

we also investigated the effects of dominance at the behaviour locus, but found that the phenotype of heterozygotes  had no effect on the equilibrium recognition locus diversity or the frequency of cooperation .

discussion
the simulations reaffirm that genetic kin recognition presents an evolutionary paradox  <cit> , and demonstrate that disassortative mating provides a potential resolution.

disassortative mating was especially powerful at maintaining cue diversity when matings between individuals with different recognition cues were assumed to be more fecund . individuals with rare cues reaped this "bonus" fecundity more often, particularly under disassortative mating. even when all mating types were equally fecund , meaning that individuals with rare cues received no direct fitness benefits, disassortative mating helped to preserve diversity by increasing the frequency of recognition locus heterozygotes, which increases heterozygote fitness. this effect is strongest with 1-allele matching, which turns heterozygotes into refugia for rare alleles.

there was also evidence that disassortative mating preserves rare alleles by increasing the frequency of matings between high quality  and low quality  individuals. the four mechanisms discussed in the introduction together rescued cue-dependent cooperation under a range of parameter spaces. their relative importance likely varies under different assumptions, but overall we found strong support for the hypothesis that disassortative mating can resolve crozier’s paradox.

as in previous theoretical treatments  <cit> , we found that population structure was a key determinant of the invasion and persistence of cue-dependent cooperation. we further showed that the effects of mate choice interacted with those of population structure, affecting the range of parameters under which cue-dependent cooperation could evolve and persist. for example, cue-dependent cooperation remained stable under most dispersal rates with disassortative mating, a narrow range of dispersal rates with random mating, and was never stable under assortative mating. similarly, the evolution of cue-dependent cooperation is constrained if only a small number of distinct recognition alleles can exist  <cit> , but disassortative mating allows cooperation to invade for smaller numbers of alleles.

empirical evidence that disassortative mating increases diversity at recognition loci
the hypothesis that disassortative mating stabilises cue-dependent cooperation has three principal assumptions: 1) the recognition cues that facilitate assortative cooperation also affect mate choice, 2) individuals mate disassortatively with respect to their recognition cues, and 3) recognition cues are heritable and are under positive frequency-dependent selection from social behaviours, such that cue variation could in principle be eroded as predicted  <cit> .

evidence that kin recognition cues are simultaneously used in sexual and social interactions is fairly abundant; certainly, inbreeding avoidance and positive effects of outbreeding are very common  <cit> . the heritability of recognition cues has also been documented a number of times, though the relative importance of genetic and environmental variation likely differs among taxa.

we will now review the empirical evidence that polymorphism at recognition loci can be maintained by selection on a pleiotropic function in mate choice, with the aims of evaluating the relative importance of this mechanism across taxa and identifying gaps in our knowledge. these data are summarised in table 2; much of the data may seem inconclusive, but it is out hope that this review will highlight gaps in our knowledge and stimulate further work.

we list cases in which a cue used to facilitate assortative cooperation has been identified, state whether inbreeding avoidance or disassortative mating has been reported and examine whether the cues used in social and mate choice contexts are the same, potentially resolving crozier’s paradox. chcs: cuticular hydrocarbons, mhc: major histocompatibility complex.

microorganisms and marine invertebrates
in the social amoeba dictyostelium discoideum, individuals aggregate to form a multi-cellular "slug" when starved. this behaviour is cooperative because many of the cells die to produce a stalk, which lifts the asexual spores formed by the remaining cells to aid their dispersal  <cit> . cells are more likely to form a slug with related cells  <cit> , and kin recognition is mediated by at least two transmembrane proteins encoded by the highly polymorphic genes tgrb <dig> and tgrc <dig>  <cit> . d. discoideum also reproduces sexually; mating is disassortative with respect to a mating type locus, which determines whether two strains can mate, and sexual recombination appears frequent in natural populations  <cit> . early reports suggested that the mating type locus was either the same as or linked to the loci controlling slug formation  <cit> , implying that negative frequency dependent selection on the mating type locus could maintain cue polymorphism. however this conclusion was later disproved: tgrb <dig> and tgrc <dig> do not directly affect mating type  <cit>  and they are on a different chromosome to the mating type locus  <cit> . disassortative mating is therefore unlikely to be important in the maintenance of allelic diversity at tgrb <dig> and tgrc <dig> 

fungi possess genetic recognition "heterokaryon" loci that allow somatic fusion between sufficiently similar genotypes  <cit> . assortative somatic fusion is a ubiquitous form of cooperation amongst fungi, and diversity at these loci is therefore predicted to be unstable. several pleiotropic functions of these loci have been proposed to maintain diversity including selection from sexual reproduction  <cit> , as the mating type locus also functions as an allorecognition locus for somatic fusion in a number of species  <cit> . sequence data for these loci suggest that they are under balancing selection in several species in the neurospora/sordaria complex, consistent with maintenance of polymorphism by selection on the mating functions of the loci  <cit> .

the disassortative mating hypothesis was explicitly tested in the colonial ascidian botryllus schlosseri  <cit> . this organism has a single recognition locus with > <dig> alleles; neighbouring individuals sharing one or both alleles undergo somatic fusion, which is thought to be beneficial among clonemates  <cit> . gametes from individuals of known genotype were mixed to investigate if dissimilar-type crosses produced more offspring  <cit> . all crosses yielded the same amount of offspring, suggesting that the recognition locus does not affect "mate choice" , and therefore that recognition locus diversity is maintained by other factors in this taxon. the mechanisms promoting diversity are uncertain, although recognition locus homozygotes have high juvenile mortality, suggesting that the kin recognition locus has a pleiotropic effect  <cit> . our model also predicts that the 1-allele matching recognition should slow the cue-eroding effects of selection from fusion. additionally, fusing with non-clonemates can be harmful, because individuals may have their germline replaced by that of the partner  <cit> . fusion might therefore impose negative frequency-dependent selection on the recognition locus, because rare types will fuse with non-clonemates less often. the net direction of selection from fusion should depend on the net inclusive fitness effects and relative frequencies of fusion between clone mates and non-clonemates.

insects
in many species of insects, kin recognition is mediated by cuticular hydrocarbons , a waxy layer present on the body surface  <cit> . hydrocarbon production has a strong genetic component in diverse insects . some of the strongest evidence that chcs have a dual role in kin recognition and mate choice comes from the group-living cockroach blattella germanica. behavioural experiments that disentangle genetic similarity and familiarity have found that individuals prefer to aggregate with kin in the absence of sex pheromone , but that both sexes apparently avoid inbreeding using olfactory genetic kin recognition  <cit> .

in ants, chcs are the main cue used to identify and aggressively reject non-nestmates  <cit> , which tend to be non-relatives. because ants identify non-nestmates by detecting novel odours  <cit> , rare chc phenotypes may receive more aggression from neighbouring colonies, leading to erosion of genetic variation for chc production. in support of this prediction, inter-colonial aggression in the argentine ant linepithema humile is polarised, such that genetically diverse colonies are aggressed by colonies with lower diversity but are comparatively non-aggressive in return  <cit> . a loss of genetic polymorphism at recognition loci may explain the origin of "supercoloniality" in ants, in which whole populations are mutually cooperative  <cit> . in our model  and others  <cit> , losses of recognition locus diversity were often followed by a decline in cooperation, but ants are likely prevented from losing cooperative traits by strong evolutionary constraints  <cit> . many hymenopterans possess complementary sex determination and should therefore be selected to mate disassortatively , and inbreeding can be costly despite the purging effects of haplodiploidy  <cit> . a number of behavioural studies have found evidence for inbreeding avoidance in social hymenoptera , but the role of chcs in mate choice has yet to be experimentally verified. however, oppelt et al.  found that leptothorax gredleri ant queens prefer to mate with non-nestmate males and that the chcs of both sexes are colony-specific, suggesting that chcs encode sufficient information for mate choice.

in the primitively eusocial bee lasioglossum zephyrum, related females are more likely to be accepted as a social partner regardless of familiarity, suggesting heritable recognition odours  <cit> . moreover, males were less attracted to females that were close relatives of previously encountered females, suggesting mate choice based on learned genetic cues  <cit> . macrocyclic lactones from females’ dufour’s glands correlate with relatedness and may be used in both selection of social partners and mates  <cit> , possibly in combination with chcs. wasps and bumble bees also apparently use chcs to distinguish kin from non-kin  <cit> , though the role of chcs in mate choice is quite poorly understood. polistes fuscatus paper wasps mate preferentially with non-nestmates, which are apparently identified by learned genetic recognition cues  <cit> , and p. dominulus males displayed a preference for non-nestmate females  <cit> . however, no such mating preference was detected in ropalidia marginata  <cit> . bombus frigidus and b. bifarius bumble bees showed a mating preference for non-nestmates, but b. californicus and b. rufocinctus mated indiscriminately  <cit> . additionally, b. terrestris reproductives took longer to mate with siblings than with non-relatives  <cit> .

one assumption of crozier’s paradox, that social behaviours cause positive frequency-dependent selection at recognition loci, has been questioned in social insects. ratnieks  argued that because nestmate recognition cues are used to identify and exclude conspecific intruders, colonies with rare recognition alleles might actually have higher fitness because they are better at identifying enemies. the relative frequency of robbing versus other forms of social interactions differs between taxa, and it is presently unclear whether selection acts to increase or decrease recognition cue diversity in most species .

vertebrates
the mhc loci of vertebrates play a critical role in the immune system but also function in mate choice, such that mhc diversity may be generated by both parasite pressure and disassortative mating . common mhc alleles may be more susceptible to parasites, which evolve to preferentially infect the most commonly encountered host genotypes, providing a rare-allele advantage  <cit> . disassortative mating with respect to mhc genotype has been reported in diverse taxa, and may offer fitness advantages such as increased/optimal mhc diversity or increased genome-wide offspring heterozygosity  <cit> .

the role of mhc-based recognition in social and cooperative behaviour is understudied relative to mate choice. putative examples have been observed in mice mus musculus; females are more likely to nest with, and thus nurture the offspring of, individuals of a similar mhc genotype  <cit> . also, adults preferentially retrieve pups with a similar mhc genotype to themselves when presented with scattered pups  <cit> . strong evidence for disassortative mating based on mhc is provided by studies of inbred mouse lines differing solely in their mhc genotypes  <cit> . mates from the other line were preferred, but this preference was reversed in mice that had been reared by foster mothers from the other line. young mice therefore imprint on the mhc-based odours of family members and later develop a sexual aversion to familiar odours, and preferences for mhc-derived odours are opposite in mating and social contexts. disassortative mating based on mhc genotype has also been demonstrated in semi-natural populations  <cit> .

in the zebrafish danio rerio, juveniles prefer the odour of unfamiliar kin over unfamiliar non-kin when shoaling, but females reverse this tendency when sexually mature  <cit> . the odour cues involved are unknown, although they are learned from siblings early in life, and mhc-derived odours are a likely candidate  <cit> . mhc-based mate choice is well-documented in other fish  <cit> , and preferential shoaling with familiar individuals  <cit>  or mhc-similar individuals  <cit>  has been found in gasterosteus aculeatus, salvelinus alpinus, salmo salar and s. trutta. in s. alpinus, mhc-heterozygous males were more successful in sperm competition than homozygotes, and the data imply that eggs may select sperm based on the male’s mhc genotype  <cit> . s. salar also mates disassortatively for mhc genotype  <cit> .

amongst reptiles, tuataras  apparently use the mhc to avoid kin both in mate choice and in territorial fights  <cit> , although the effect was relatively weak. rare phenotypes should in theory thus receive more mating success and more territorial challenges as compared to common phenotypes.

kin recognition based on odour has been reported in birds  <cit>  and may affect their mate choice  <cit> . although there is no direct evidence that genetic kin recognition is used to inform cooperative behaviour, males have been found to preferentially lek next to relatives in a few species  <cit> , in at least one case independently of familiarity  <cit> . joint lekking is thought to increase mating success and may therefore be viewed as a form of cooperation with the potential to deplete recognition cue diversity. the recognition systems underlying kin-biased joint lekking remain to be found.

auditory recognition cues may also be used to inform cooperative decision-making in birds. in the cooperatively breeding long-tailed tit , individuals distinguish kin from non-kin by their calls, and preferentially become helpers at the nests of relatives  <cit> . vocalizations are learned in the juvenile stage from the provisioning parents, and are in that sense heritable; moreover, the identity-signalling song component of zebra finches has a genetic component  <cit> . there is evidence of inbreeding avoidance in long-tailed tits  <cit> , but the role of song in this context is unconfirmed. kin-biased helping has been reported in a number of other cooperatively breeding vertebrates , but the cues involved are usually unknown.

naked mole rats  form eusocial colonies containing a single reproductive female and many sterile helpers  <cit> . cooperation is therefore directed solely towards kin, but when selecting mates, females choose individuals bearing unfamiliar odours  <cit> . mate choice appears to involve sexual imprinting, but the nature and heritability of the odours used for discrimination remain to be elucidated.

there are also reports of disassortative mating for mhc genotype in primates  <cit> . for example, mandrillus sphinx mates disassortatively with respect to mhc genotype , and mhc diversity predicts reproductive success  <cit> . assessment of relatedness by olfactory cues may also be used in the selection of social partners in this species  <cit> . in humans, evidence for mhc-based mate choice is mixed, although the majority of studies imply a preference for mhc-dissimilar partners  <cit> . however, we know of no strong evidence that mhc-derived odours affect cooperative decision-making or the choice of social partners. by contrast, humans are able to infer relatedness from facial cues, and the degree of facial similarity between the actor and recipient has been experimentally linked to a range of cooperative behaviours  <cit> . moreover, men and women rate opposite-sex faces digitally manipulated to resemble themselves or their close relatives as less attractive, suggesting disassortative mating for facial cues  <cit> .

CONCLUSIONS
our model and the available empirical data suggest that selection from disassortative mating may be an important mechanism maintaining variation in genetic recognition cues across diverse taxa. no recognition loci have been definitively shown to facilitate both assortative cooperation and disassortative mating, although there are many examples in which the data are consistent with this interpretation. we hope that future research will be able to tackle the difficult next step: explicit quantification of the relative strength and direction of selection acting on recognition loci from different sources, namely social interactions and pleiotropic functions such as mate choice.

competing interests
the authors declare they have no competing interests.

author contributions
lh performed the simulations and wrote the manuscript, jsvz gathered data for the literature review and co-wrote the manuscript, tal and pde co-wrote the manuscript. all authors read and approved the final manuscript.

acknowledgments
we are very grateful to the theoretical biology group at the university of groningen, especially i. pen and j. bakker, for extensive advice and computing facilities. we thank d. aanen and h. kokko for comments on the manuscript. lh and tal were funded by marie curie fellowships, jsvz by a fellowship from the danish council for independent research, and all authors received support from the danish national research foundation.

dedicated to ross h. crozier.
