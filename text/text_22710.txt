BACKGROUND
in embryonic stem cells , the promoters of oct <dig>  sox <dig> and nanog can be bound by their own products together or separately and an auto feedback loop forms. they also can activate other pluripotent genes and inhibit lineage specific genes. in this way, embryonic stem cell state is reinforced  <cit> . differentiated cells are reprogrammed to induced-pluripotent stem cells  by ectopic expression of factors which induce the reestablishment of transcription regulation in embryonic stem cell state.

however, up to now, the reprogramming efficiency is still low and the mechanism of reprogramming is not fully understood. in order to enhance the reprogramming rate and reduce the reprogramming latency, the changes of gene expression and epigenetic modifications in the reprogramming process  <cit>  and their differences among somatic cells, ipscs and escs  <cit>  are studied extensively, showing that epigenetic modifications and gene expression change dramatically during reprogramming. in addition, epigenetic modification  plays an important role in development. knockout experiments show that the deletion of dna methyltransferase or histone modifiers leads to embryonic lethality. loss of such epigenetic modifications in escs will affect cell differentiation  <cit> . as the epigenetic landscape shows dynamic change during differentiation and reprogramming, we considered not only the gene expression but also epigenetic modifications in our model to study the basic principles in reprogramming, which may serve as an important medium for gene expression change in reprogramming.

several models have been established to explain the phenomena in reprogramming, standing to help improve reprogramming efficiency. for example, macarthur et al.  established a set of differential equations according to the transcription regulatory network in esc and found that differentiated cells can achieve the ipsc state by amplifying the transcription fluctuation globally  <cit> . furusawa et al. proposed that the trajectory in the gene expression phase space is chaotic in the stem cell state, while as the cell differentiates, the complexity of the trajectory decreases. they inferred that the differentiated cells might be reprogrammed by increasing the diversity of expressed proteins  <cit> .

distinguished from these dynamic equation models, waddington depicted that cell differentiation is like a ball rolling down the hill in the epigenetic energy landscape. the reprogramming process is just the opposite by inducing a set of reprogramming factors  to push the system going up with positive probability. although all the cells have the potency to be reprogrammed, only the cells having overcome all the epigenetic barriers can be reprogrammed to the ipsc state, which depends on some stochastic events with small probability and thus explains the low efficiency of reprogramming. this is the “stochastic model” by yamanaka , opposite to the “elite model” in which only a small portion of cells can be reprogrammed  <cit> . artyomov et al.  developed an ising model taking account of several general rules governing the interaction between the cell type specific genes  <cit> , which can be used to simulate the rare and stochastic event of successful reprogramming. most of these rules are crucial and may reveal the underlying principles of cell differentiation and reprogramming; whereas others are redundant and are lack of experimental support. we developed a stepwise reprogramming markov  model based on some of the modified rules, which can partly explain gene expression changes, morphology changes and the barriers in the induced pluripotent process.

in this paper, we support the point that cells achieve the pluripotent state gradually through several ordered and well-defined stochastic events  <cit>  and some of them happen with small probability, as the epigenetic state in some regions of genome are always hard to be converted to an embryonic stem cell like state  <cit> . by our model, we also showed that different types of cells have different potential in reprogramming, as less differentiated cells can achieve the ipsc state easier  <cit> .

RESULTS
cell lineage tree, module tree and cell state
we assumed that as the cell differentiates, the number of cell types increases exponentially, forming a binary tree. here we selected groups of cell type specific genes, called modules, for all cell types in the cell lineage tree and arranged them into a module tree with the same hierarchical structure as the cell lineage tree. we denoted neighbors of module a as na , a set including its sibling, children and parent module; descendents of module a in set pa and progenitors of module a in set qa  . we identified the cell type with its corresponding gene module as genes in a module only highly express in the corresponding cell type and have similar behavior in reprogramming. for example, esc can be represented by a module including oct <dig>  nanog. they highly express in esc but express low in other cell types .

the cell experiences dramatic change of gene expression and epigenetic patterning during reprogramming. as the expression of the modules sequentially turn on and their epigenetic states temporarily change from “closed” to “open”, we assumed that the cell gradually transits from a more to a less differentiated level in the reprogramming process  <cit> . we defined that a cell is in state k  if the cell assumes one of the cell types in the kth level of the cell lineage tree. the embryonic stem cell state is staten, while the initial differentiated cell is in state  <dig>  when the cell transits from state <dig> to staten after many steps, the cell will stay at state n in the suitable culture condition since endogenously expressed pluripotency genes can reinforce their expression  <cit> . however, specific genes of different cell types may express together; in this case, we cannot say which cell type on the cell lineage tree the cell is in. we denoted this state as partially reprogrammed state, ε. on the other hand, expression of modules in different lineage may be in conflict with each other, disrupt cell’s transcriptional regulatory network and finally leads to cell death, denoted by state  <dig>  then we considered a markov chain transit among the states  <dig>   <dig>  2… n and ε in which state  <dig> and n are two absorbing states .

each cell type or state is characterized by a particular combination of the genetic and epigenetic state of all modules. since the genetic and epigenetic state of all the genes in a module change in the similar manner in reprogramming, we defined the genetic state and epigenetic state of a module by a single value respectively:  with  

measures the epigenetic state and genetic state of module i at time k respectively. we defined a cell in cell type  if only . for example, in escs, the pluripotency genes in esc module enrich for h3k4me and are depleted of dna methylation, inferring the open epigenetic state  <cit>  , ); while other modules are not open ). we defined cell death  as all of the modules in a cell does not express and defined partially reprogrammed state  if more than one module is in open epigenetic state.

rules of modules’ states transition
in order to determine the transition probabilities between states in the markov chain above, we first considered the state transition of modules in reprogramming. we focused on two general phenomenological gene regulation rules deduced in the light of artyomov et al.  where six rules governing transcriptional regulation in cell differentiation and reprogramming were summarized:  the epigenetic state of a gene affects its expression  gene expression auto-regulates its epigenetic state  expression of sibling modules repress each other  expression of a module puts inactive epigenetic marks on its progenitor and sibling modules  expression of a module puts bivalent epigenetic marks on its progeny  expression of a module put negative epigenetic marks on modules on other lineage and upper levels  <cit> . however, rule  and rule  may be deduced by the others. instead, rule , , ,  are relatively fundamental and supported by a lot of experiments. based on these four rules, we established our srm model with two simplified rules:

rule1: effect on epigenetic state by gene expression. expression of a module makes its epigenetic state open   <cit>  . it also makes its neighbors or non-descendent modules close , which maintains the identity of the cell and prevents cell differentiation. besides, the repression dominates the auto-activation when they coexist  <cit> . since the repression strength gets weaker as the distance in the module tree gets shorter, the repression by neighbor modules will be cancelled out by auto-activation. one can compute the state of module at the next time point, k+ <dig>  as follows:   

rule2: effect on gene expression by epigenetic state. when the epigenetic state of a module is open, the module express otherwise the module doesn’t express . if more than one module is in open epigenetic state, they will express low as they repress each other and the cell gets to the partially reprogrammed state . it also shows that sometimes some genes in different lineages express together in reprogramming  <cit> , which can be represented by state ε. thus, one could compute the state of module at the next time point, k+ <dig>  as follows:   

noticing that in the update by  for epigenetic states all genetic states never change, one can see that the update process does not depend on the order of selection for i. after doing  for all i, do  for all i, called a round, in phase with one cell cycle, and repeat until the cell gets to the equilibrium state when all the modules are invariant under rule <dig> and rule <dig>  in equilibrium state, the cell will be in one of the cell types, death or partially reprogrammed state .

the role of the reprogramming factors and procedure in srm model
the reprogramming factors can bind to genes associated with differentiation or pluripotency, repressing or activating gene transcription respectively. in esc, the repression effect of the reprogramming factors is related with the recruitment of repressive chromatin remodeling complexes such as nurd and polycomb, resulting in histone deacetylation and h3k <dig> trimethylation  <cit> . on the other hand, downregulation of somatic markers is related with c-myc mostly, which has significant effect in the early reprogramming and seems more likely to bind genes with accessible chromatin state  <cit> . taking into account these phenomena, we simulated the reprogramming factors repression as choosing a module with open or bivalent epigenetic state  randomly and making it close.

to simulate the activation of the reprogramming factors, as most of genes chosen in modules are regulated by the reprogramming factors, a module is chosen randomly with equal probability regardless of which epigenetic state it is in , made express and made its chromatin state open. however, in reality, the reprogramming factors are more likely to activate some specific genes, which is similar with knockdown of some specific transcription factors and thus the reprogramming factors can’t induce them. the consequence is shown below.

further, transcriptional repression is always associated with a single reprogramming factor binding. in contrast, when bound by multiple reprogramming factors, gene will be actively transcribed since basal transcriptional machinery is recruited  <cit> . when the module chosen to be repressed happens to be the same as the one to be activated, the module will express and the epigenetic state of the module will be open.

in sum, if the reprogramming factors repress module a, then: since some protein still remains in the cell. if the reprogramming factors activate module a, then: . if reprogramming factors activate and repress module a at the same time, then: . in particular, if the cell is in stateε, the reprogramming factors will activate a module randomly and the cell leaves stateε. the cell can get out of the partially reprogrammed state when cultured for longer time  <cit> .

in the reprogramming process, the reprogramming factors will change the epigenetic state and/or expression of the module. then, in one round, the epigenetic state of each module will be further changed by the protein content in the cell according to rule <dig> and the new epigenetic state will change the module expression following rule <dig>  after two rounds, the cell gets to the equilibrium state . then, the reprogramming factors take its effect again unless the cell is in the absorbing state. thus, the induction of the reprogramming factors will take place every other round. the procedure is shown below:

i. initially, assume the cell is in type  in the kth level.

ii. the effect of the reprogramming factors is to activate a module and repress one.

iii. in one round:

∀i ∈ { <dig>  2⋯2n – 1}, si is changed according to the rule .

∀i ∈ { <dig>  2⋯2n – 1}, gi is changed according to the rule .

iv. repeat iii once. then, the cell would reach an equilibrium state. record the cell state transition.

v. stop if cell reaches ips state or dies, otherwise go to ii.

then, we could estimate all the transition probabilities every two rounds in the markov chain .

estimating reprogramming rate and average reprogramming time
we defined a vector , xi is the probability the cell in state i, i=1…n,  <dig>  ε. define p as the transition matrix of the markov chain. suppose that all of the cells are in state i initially, . as the number of rounds 2k goes to infinity, , in which pn is the proportion of cells successfully reprogrammed and dn is the death rate. suppose there are  <dig> levels in the cell lineage tree. then the reprogramming rate is  <dig> % when reprogrammed from the first level , which is consistent with the real experiment where the reprogramming rate is about  <dig> %~1%  <cit> . we estimated the reprogramming rates in the case of other number of levels, which are roughly in the range above when there are not too many levels between the initial cell type and esc . our simulation also showed that the reprogramming rate for cells from different differentiated level is different. further, we calculated the average time needed for reprogramming by computing the expectation of time arriving in state n  on the condition that the cell is still alive: expectation  =  <dig>  cell cycles.

when knockdown of somatic transcription factors, reprogramming rate from first level is  <dig> % and average reprogramming time is  <dig>  cell cycles. in reprogramming ising model, reprogramming rate from first level is  <dig> %.

from pn, the portion of cells reprogrammed after 2k rounds , it shows that the number of successfully reprogrammed cells increase in the sigmoid pattern . it takes  <dig> cell cycles to reach the half of the maximum . as the reprogramming is achieved for some time, the epigenetic states of more modules are not closed, since the module in the upper level is already open. thus, the repression effect of the reprogramming factors is diminishing, as also observed experimentally that withdrawal of c-myc after day  <dig> would not affect reprogramming rate  <cit> .

simulating reprogramming in the condition of somatic transcription factors knockdown or dna methylation inhibition
in the condition of knocking-down somatic transcription factors, the reprogramming rate would be a little higher, about  <dig> %. the cell can get to the ips state faster with the average time  <dig>  cell cycles and the response time  <dig> cell cycles ). also, it has been shown that knock down of pax <dig> will improve the reprogramming efficiency of b cell  <cit> . moreover, when treating the cells with dna methyltransferase inhibitor which attenuates the global repression of dna methylation, reprogramming efficiency accelerates a lot, about  <dig> % in  <dig> cell cycles ). previous experiments demonstrate that inhibition of dnmt <dig> can improve reprogramming efficiency  <cit> .

simulating gene expression changes in reprogramming
suppose all of the cells are in state  <dig> initially, namely . we calculated the expression of modules in different level in terms of cell cycles . we defined the total expression of all modules in kth level at time t as the portion of living cells arrived at state k at time t:     

the gene expression of modules in level  <dig> decreases dramatically at the beginning of the reprogramming, as the reprogramming factors inhibit the expression of somatic genes. next, some genes from upper level express transiently but the cell can’t stay at the de-differentiated state, so it drops back to state  <dig>  leading to a period when the gene expression in level  <dig> does not change much. finally, more and more living cells get to the esc state and stay there stably, so expression of somatic genes drops rapidly again and decreases to zero. the expression of esc’s specific genes increases at last, after the dramatic drop of somatic cell gene expression and the peak time of genes from other levels, which agrees with the real experiment that the endogenously expression of esc specific genes is the last step in reprogramming. in the early time point, even if pluripotency genes are activated by the reprogramming factors, their chromatin state may close again when inhibited by other modules. the auto-regulation loop cannot form, so pluripotency genes express transiently and their expression doesn’t show any increase in our equilibrium state curve. moreover, the reprogramming factors only bind transiently and show weak binding strength in intermediate reprogramming cells than escs or ipscs, as observed in  <cit> . only in the late period when repression by other modules attenuates can the esc specific genes continuously express, which may explain the expression curve of esc specific genes and the long latency of reprogramming. the expression of genes in all other levels first rise then drop although their peak times are different. the genes in level  <dig> get to peak earlier than level  <dig> . only genes in these two levels express in a large amount in reprogramming although total number of cell levels are different. as cell levels increases, gene expression changes more dramatically as all the curves become steeper . the tendency of gene expression change in our model mimics the real data roughly ).

although some stochastic events will affect cell reprogramming, reprogramming follows a series of defined steps  <cit> . in our model, the somatic cell de-differentiates level by level and gene expression change follows the same steps as observed in experiment. after esc specific genes express, still some adjustments of epigenetic state of other modules are needed to get to the equilibrium state, leading to a state more similar to esc state, as observed that there are some differences in dna methylation in early cultured and late cultured ipscs  <cit> .

from the simulated gene expression, our model can track cell type transition in reprogramming. for example, in reprogramming of mef, fibroblast will change to tightly arranged round cells, inferring that mesenchymal to epithelial transition  takes place  <cit> . the reprogramming model can simulate met in reprogramming process . these results may verify the existence of met and a series of cell type transformations toward less differentiated cell types during reprogramming.

reprogramming ising model
in order to simulate the fluctuations in reprogramming, we computed the cell “energy” according to the epigenetic and genetic interactions between different modules based on a related model similar to artyomov’s model in  <cit> , so that module state is changed approximately by  and  when the perturbation is small. construct the four level cell lineage binary tree, but esc in the first level and initial somatic cell in the fourth level. the state of each node in the corresponding module tree contains the genetic and epigenetic state of specific genes of such cell type. g= <dig>  representing the expressed and silenced genetic state respectively; while s=- <dig>   <dig>   <dig> representing the closed, bivalent and open epigenetic state respectively. then the cell “energy” is defined based on the interaction between genetic state and epigenetic state of the nodes . at every other cell cycle, the reprogramming factors, following the same rule as in srm model, will activate a node to make its epigenetic state open  <cit>  while repress a node with open epigenetic state to make its epigenetic state close randomly. then the cell reaches equilibrium state which can be found by monte carlo simulations and cell type may change. there are much more varieties of cell states than that in the srm model. however, the srm model captures major cell states in reprogramming  <cit> .

we simulated  <dig> cells for  <dig> cell cycles with  <dig> cells successfully reprogrammed. the reprogramming rate is  <dig> %, consistent with rare reprogramming event. the successfully reprogrammed cells reach the esc state in 8~ <dig> cell cycles , much shorter than the time we can detect them, since it takes some time for the total expression of pluripotent genes increasing to reach the detection threshold as successfully reprogrammed cells divide faster and others die. we averaged the epigenetic and genetic state of each node in each cell cycle of the  <dig> cells ). the epigenetic state of initial cell type node changes from open to closed and arrives at bivalent state finally . the epigenetic state of esc node changes from closed to open, during which change occurs rapidly from the 11th cell cycle and on . from 13th cell cycle and on, the epigenetic state of other nodes begins to change rapidly from closed to bivalent state. in esc, many genes related to differentiation are in bivalent state  <cit> . the time point of these three situations agrees with the observation that initial epigenetic change confines within genes with open epigenetic mark in somatic cell and the repression markers are lost later on  <cit> . we also found that the cell “energy” increases during the reprogramming process, because of less repressive histone markers and thus repression potential h <dig>  is less. in vivo, it is also known that pluripotent cells have the lowest dna methylation level  <cit> .

the expression of initial cell type node decreases rapidly in the first several cell cycles; the expression of esc node increases rapidly from 11th cell cycle on; the expression of upper level neighbor and sibling node first increases and then decreases; the expression of nodes in lineages other than that of the initial cell type remain near zero. however, some nodes in other lineages may be weakly expressed during late reprogramming and may represent the partially reprogrammed state.

then, we did kmeans clustering of the real gene expression data in reprogramming . the gene can be divided into  <dig> groups. the average profile of each cluster matches the gene expression curve predicted in the reprogramming ising model ). the expression change of the first cluster resembles the nodes in other lineages. we found that the cluster is enriched in rna processing and rna splicing . besides, the genes related with other lineage  are in this group.

the expression change in the second cluster resembles nodes of father and sibling. this cluster is enriched in actin filament-based process and actin cytoskeleton organization . besides, the genes that are related to basolateral plasma membrane, adherens junction, mesoderm development  and embryonic skeletal system development  are in this group.

the average profile of the third cluster is very similar to the curve of somatic cell node. both of them arrive at 50% of the initial value at 4th cell cycle. we also did the simulation without considering the repression of reprogramming factor. in that case, the expression of somatic cell node decreases so slowly that arrives at 50% at 9th cell cycle. it may mean that the reprogramming factor has a significant role in repressing somatic specific genes in the early reprogramming. this cluster is enriched in appendage development, skeletal system development and extracellular matrix, such as biglycan , which are specific genes of fibroblast. besides, fibroblast marker thy <dig> and fibroblast structure genes col1a <dig>  col1a <dig> are also in this group.

the average profile of the last cluster resembles the curve of esc node. this cluster is extremely enriched in condensed chromosome, chromosome in centromeric region and cell division . this means that chromatin remodeling may be the major event in late reprogramming and cell obtains the ability of self-renewal gradually. besides, genes maintaining esc state or related to self renewal  are in this group.

in summary, the gene expression change predicted by our reprogramming ising model is consistent with the real time-serial gene expression data in reprogramming.

CONCLUSIONS
in this paper, we attempted to explain observed phenomena in reprogramming by a mathematical model. based on the model in  <cit> , we simplified the regulation of epigenetic and genetic network into two rules and defined the role of reprogramming factors as repressing and activating specific modules according to papers studying the binding sites and function of these factors  <cit> . the module state and cell state transition are shown more clearly in srm model than the reprogramming ising model and thus we could see that the epigenetic barriers are created by the expression of modules in lower levels and other lineage. therefore, we may design more efficient way to overcome these barriers. we simulated the trajectory of rare reprogrammed cell and showed that knockdown of somatic transcription factors or inhibition of dna methylation or other repressive histone markers can accelerate reprogramming. the srm model can predict the gene expression change in met and ising model can predict the expression change of cell type specific genes, which provides support for these models and the proposed underlying rules governing epigenetic and genetic regulatory network in the cell. reprogramming is a battle between the reprogramming factors and the cell’s intrinsic transcriptional network. cells can only reprogram gradually in several ordered and defined steps because of the inhibition of intrinsic interaction. the probability that the cell can overcome all the barriers is very small. thus, the reprogramming efficiency is often very low. besides adding specific transcription factors of desired cell type, the intrinsic network in the original cell must be disrupted either by global fluctuation or knocking down specific transcription factors in order to convert itself to the desired cell type.

the two models construct a blue picture of cell type conversion and may be used to study the cell type conversion between different differentiated lineage and transformation between cancer and normal cells. they may be used to identify significant factors in cancer development, for example emt mentioned in the paper is related to metastasis of cancer cells.

however, these two models are simple. they can only simulate the gene expression and epigenetic change qualitatively but not quantitatively. we neglected some degree of heterogeneity between modules. for example, the expression level of different modules in “on” state is not the same; the probability distribution of the reprogramming factors inducing different modules may be non-uniform. although these models can provide some insight into the effect of adding histone modifiers or dna demethylase, knocking out apoptosis factors or somatic cell specific transcription factors, only by taking account of particular gene regulation network can these models help experiment design. meanwhile, the rules in the model need further experimental verification. as the development of single cell rna-seq  <cit>  and chip-seq advance, the variations between cells can be revealed. using new technologies, we can understand the mechanism underlying reprogramming more clearly.

we believe that reprogramming efficiency and the safety of ipsc can be further improved by combing experimental result with modeling. as the mechanism of induced pluripotency is understood more comprehensively, ipsc can be widely used in modern molecular medicine.

