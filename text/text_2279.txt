BACKGROUND
polymerase chain reaction  is a common laboratory technique in biological and medical sciences, with a wide range of applications such as dna cloning, dna resequencing for single nucleotide polymorphism  discovery and quantification of gene expression. in the design of any pcr experiment, the first step of designing oligonucleotide primer pairs is crucial for the success of the experiment. selection of inappropriate primers can result in no amplification  or amplification of non-targeted regions . therefore, the primer pair is tailored to be specific to the desired target sequence.

the design of target-specific primers for pcr experiments typically requires consideration of different types of genomic information besides the target dna sequence, such as repetitive dna elements, intron/exon boundaries, and snps, which must be retrieved from various databases. all information is then combined to construct a sequence template for a primer design program. to confirm their specificity, designed primers are usually aligned against the corresponding genome sequence using tools like blast  <cit> , blat  <cit> , and primerblast in ncbi. if the aligned results return multiple hits, then the primers are regarded as non-specific and have to be redesigned by constructing a new template avoiding previously considered primer-binding regions. the whole process needs to be repeated manually until the desired primers are found. thus, manually assigning an appropriate primer pair can be a tedious and time-consuming process, especially when high-throughput assays are required.

to resolve this situation, a number of automated primer designing tools have been developed based on primer <dig>  <cit>  as web applications. these programs include snpbox  <cit> , elxr  <cit> , exprimer  <cit> , mutscreener  <cit> , easyexonprimer  <cit> , primerz  <cit> , and others. most existing tools are limited to specific regions of the human genome and hence they are not flexible enough for users to choose desired target genomic regions  to be amplified. after primers have been picked, most of the tools use ucsc in-silico pcr  <cit>  to verify the uniqueness of desired primer pair; however, when the selected primers perform poorly, the information from these unsuccessful primer pairs is not considered by these tools for redesigning primers.

while these programs provide some solutions related to the aforementioned primer design process, they are not always able to effectively design primers for two main problems, namely 1) no amplification due to severe mismatching, or lack of target and 2) mis-priming . these two problems lead to increased pcr failure rate  <cit> . the first problem may arise because of unexpected snps in the primer 3' end . alternatively, insertion/deletion  polymorphisms may exist which either alter the length of the desired target, or prevent primer binding to the desired target. in some cases, the target sequence may be entirely absent, e.g. copy number variation  covering large stretches of dna. three prominent primer-designing tools that attempt to avoid snp-in-primer include exonprimer  <cit> , easyexonprimer  <cit>  and variantseqr  <cit> . however, it is becoming increasingly clear that cnvs are also common and population-specific  <cit> . length and copy number polymorphisms can also cause both mismatching and non-primer binding to the desired target, yet these genetic variants are not considered by current primer designing tools. the second problem of mis-priming arises from the structural complexity of the genome. the human genome has many layers of repetition ranging from widespread chromosome segmental duplications, to gene families and pseudogenes to numerous repetitive elements , which can all contribute to mis-priming  <cit> . to our knowledge, there are no primer designing tools that can simultaneously address both of these issues.

to address these issues, we present a graphical web-based tool, named rexprimer, which allows users to automatically design pcr primer pairs for amplifying human genomic sequence without leaving the website. rexprimer uses primer <dig> as the design core, since this open source software has been continuously adopted by research communities as the de facto standard  <cit> . the novel modules that address the aforementioned problems were created on top of the primer <dig> core by locally incorporating annotated human genomic sequences. rexprimer assesses primer candidates for snp-in-primer, indel polymorphisms, cnv, and related target sequences  by crosschecking with local databases. large integrated snp and indel polymorphism databases can notify snp-in-primer effects, while information from structural variation databases identifies possible mis-priming. rexprimer uniquely offers a redesign module for assisting users to correct the notified problems.

RESULTS
input processing
rexprimer offers three modules of primer design: 1) for resequencing genomic dna , 2) for snp genotyping , and 3) for oligonucleotide checking. the following types of identifiers are supported as input: hugo gene name, ncbi gene id, and chromosomal locations. since there are also other interesting non-gene regions, such as regulatory regions and intergenic regions, our program also supports arbitrary genomic regions as input based on chromosome location. for the snp genotyping module, the program allows one additional input format as a snp id  or set of snp ids. because this application supports batch design for snp genotyping primers, it can enhance productivity of high-throughput snp sequencing projects.

after the input is received, the local human genome database module is interrogated and the corresponding target sequence information, including the genomic sequence, annotations  and polymorphisms is subsequently identified and retrieved using query language. when a gene name is used as an input, more than one associated sequence, such as splicing variants may be found in the database. in this case, users have an option to choose the desired isoform. then, the program supplies the option of selecting the gene regions to be amplified: whole gene , region of interest .

non-unique pcr primers are one of the main factors that lead to pcr failure. multiple regions of homologous, or near-homologous sequence in the genome can compete with the target sequence for primer hybridization leading to pcr artifacts. the human genome contains many pseudogenes, which can have near-perfect homology to their functional counterparts. to avoid designing non-specific primers for genes with pseudogene counterparts, the input sequence's pre-defined pseudogene sequences are retrieved from the pseudogene database module. multiple sequence alignment of these pseudogene sequences and target gene including alignment scores by the mummer program  <cit>  are displayed . the target sequences where primer pairs could not be successfully designed owing to potential mis-priming are highlighted. users can take this information into consideration when selecting the gene regions to be amplified. optionally, rexprimer can automatically exclude ambiguous target regions based on similarity with pseudogene copies. in the case that whole target genes are highly similar to their pseudogenes and no unique region could be identified, users could analyze the gene structure and look for unique sequences flanking the sequence of interest. for dna resequencing, it is suggested that a primary primer pair which can discriminate the target gene from the corresponding pseudogene is designed. then, nested primers for sequencing can be generated which do not have to be discriminatory. in this paper, a case study of the cyp2d <dig>  which has highly similar pseudogenes is illustrated.

after all of the target dna sequence information is retrieved from the local database module, it is passed as input to primer <dig> for the automatic generation of primer pairs. the rexprimer user interface allows the users to specify parameters for primer <dig> primer selection, such as product size, melting temperature , gc content. if desired, each designed primer could be screened against a repeat database to reduce nonspecific priming by choosing this available option. the amplicon size is user-defined according to the constraints of the experiment, e.g. accurate sequencing limits amplicons to a few hundred base pairs. if the input sequence is larger than a user-specified product size limit, the program automatically subdivides the template sequence into smaller segments with user-defined segment overlap size in order to ensure that the overlapping sequences can give high quality sequencing data. primers are then designed separately for each overlapping fragment.

sequence variation in the 3' end, particularly the last three bases can severely disrupt primer hybridization and thus decrease pcr efficiency to the point of pcr amplification failure  <cit> . hence, primers should be designed to avoid regions of known polymorphisms based on the information in available snp databases. to avoid snp-in-primer and to design primers for snp genotyping, rexprimer utilizes a snp database module. this snp database module enables effective primer design for snp genotyping and snp identification. for resequencing primers, designed primers are checked for snp-in-primer regions, and any snps present are notified through a color-coded graphical display output module, the color reflecting the level of the mismatching primer-destabilizing effects  <cit>  . with this information, users can adjust primer positions to avoid snp-in-primer. in addition, information from different snp databases provides clues for population-specific primer design, i.e., snps found only in some populations will give snp-in-primer effects for those populations, and not in others.

output report
results reported from rexprimer include two parts: svg graphical display and html primer information summary. the graphical representation displays resulting primer pairs with their respective locations in the target gene in the same window . if present, snp-in-primers, pseudogenes, cnvs, and indel polymorphisms are also displayed. in addition to the visual summary, the designed primer text summary describing primer <dig> parameters and primer conditions is also generated in html format . each designed primer pair can quickly be verified for uniqueness against the entire genome using the locally installed ucsc in-silico pcr in rexprimer.

when strong primer-destabilizing effects such as snp-in-primer are reported, users can immediately redesign primers without repeating the same procedure again. optionally, the users can directly specify the approximate range of primer or target region, e.g., to avoid regions of high snp density. the redesign of primer pairs can then be forced to a confined user-specified region.

case study: cyp2d6
to validate whether rexprimer is effective in designing primers in challenging pcr applications, rexprimer was used to design primers for the cytochrome p <dig> 2d <dig> locus , which is thought as one of the most important enzymes for the metabolism of many clinically used drugs. cyp2d <dig> is highly polymorphic, which can be expressed as variation in cyp2d6-related drug metabolism among individuals. besides a growing number of snps, numerous cnvs have been reported worldwide for this locus. therefore, extensive population-wide study of genetic variations at cyp2d <dig> has medical importance. there are several problems that could interfere with the accuracy of genotyping, including:

• pseudogenes 

• cnvs from unequal crossing-over

• snps reported to influence the enzyme activity

existing primer design tools could have failed to consider the effect from cyp2d <dig> pseudogenes, snps, and cnvs. mis-priming to pseudogenes can lead to artifactual pcr. snps and cnvs can lead to mismatching and non-primer binding to the desired region. the number of potential primers that are specific to cyp2d <dig> are thus limited.

in this study, primers were cautiously designed by considering every possible problem mentioned above using rexprimer. the primers designed by rexprimer for the cyp2d <dig> locus are shown in table  <dig>  pcr experiments were then carried out to verify the effectiveness of the designed primers. rexprimer detected four pseudogenes which showed high similarity with cyp2d <dig> before the primer designing step . in order to detect every snp on the active cyp2d <dig>  the information in figure  <dig> guided us to perform whole gene amplification which can separate the active gene from the pseudogene counterparts . once the active gene was isolated, the snp genotyping can be further conducted. for cnvs, we chose semiquantitative analysis  <cit>  to detect the different number of cnvs by quantifying the resulting pcr products. samples were collected from volunteers in accordance with a local ethical committee in an ongoing study of human variation, details of which will be published elsewhere. penta-plex pcr was developed from genomic dna and the resulting products were analyzed with dhplc  in semiquantitative mode. three regions from cyp2d <dig> gene were selectively amplified covering exons  <dig> to  <dig>  exons  <dig> to  <dig>  and exon  <dig>  the low density lipoprotein  and dystrophin  genes were used as internal controls . the intensities of the cyp2d <dig> pcr products when compared with the internal standards dmd and ldl by dhplc indicate that cyp2d <dig> copies are present in each individual . these results demonstrate that the primers designed by rexprimer are suitable for cnv genotyping.

rows 2- <dig> represent semiquantitative analysis of cnv

discussion
in this study, we have developed a comprehensive tool for pcr primer design which covers a broad range of functionalities including resequencing target genes and snp genotyping. the primer design pipeline is composed of three key components: 1) pseudogene detection, 2) primer design core, and 3) snp-in-primer/genomic variation notification. additional file  <dig> presents the feature comparison among existing primer designing software.

rexprimer utilizes the publicly available sequence information including the human genome and annotation database, snp databases, and the pseudogene database. by incorporating these databases and the primer <dig> program, reliable and accurate primer designs can be achieved. the current pseudogene database module comprises of approximately sixteen thousand pseudogenes  <cit>  while the genomic variation module  consists a total of thirty-eight thousand entries  <cit> . snp database hosts more than nineteen million common and population specific snps from various populations, which is larger and more comprehensive than existing primer design programs  <cit> .

most primer design tools verify the uniqueness of the pcr target sequence by using ucsc in-silico pcr  <cit>  after the primer candidates are picked. however, if the desired target has no unique segments, the primer specificity search would run indefinitely, thus slowing down the primer generation procedure. rexprimer avoids this problem by excluding target regions shared with pseudogenes and other related sequences before primers are generated. the program also takes care of other genomic variation issues. this was demonstrated in the cyp2d <dig> case study provided in the result section.

rexprimer appends several key features before and after the primer design process using primer <dig>  enabling the selection of unique primer sequences and reliably amplifiable targets, which other currently available software cannot match. however, with the caveat that the primers designed are unique and the targets are amplifiable , no extra claims for the actual performance of the primers beyond what is predicted by primer <dig> are made. hence, we have not attempted to determine the success rate of rexprimer for designing primers, since the cost of performing multiple pcr experiments is not justified. finally, rexprimer has a major strength on its graphical web interface, especially the gene structure visualization, which makes rexprimer intuitive and user friendly.

future development
currently, rexprimer can offer the oligonucleotide primer design for human genomic sequence in which snp and pseudogene data are largely available. in the future, the program and locally built databases will be expanded to support primer generation for different organisms once their pseudogene and polymorphism data are readily available. to enhance the quality of primer design, the local snp databases will be automatically updated to make use of the latest information, including as wide a range of population diversity as available.

CONCLUSIONS
rexprimer is a one-stop tool for pcr primer design, which can support high-throughput resequencing and mutation screening research. the incorporation of large snp and genomic variation databases make it possible to efficiently detect sequence variation in the designed primers that might cause pcr failure. the notification system of target pseudogenes before the primer design step helps users to select the appropriate target regions, which can significantly shorten the design process. rexprimer is shown in this study to be indeed effective for designing primers for cyp2d <dig>  we expect that rexprimer is able to fill the gap and accomplish current needs for automated primer design procedure.

