BACKGROUND
transcriptional regulation is essential for all eukaryotes and is central to the complex development and environmental responses of higher organisms. the identification of transcription factors , tf-target genes and transcriptional regulatory networks is therefore of fundamental importance for biology. the ability of tfs to modify the expression of many physiologically important target genes has made them attractive targets for biotechnology  <cit> . traditionally, experimental approaches have sought to identify tf-targets by measuring gene expression in loss- or gain-of-function mutants, whilst tf binding to their target promoters has been measured using gel-shift assays, co-transfection assays or chromatin-immunoprecipitation . with the arrival of genome-scale technologies, approaches have been scaled up to allow for the unbiased identification of either genes with altered expression in tf mutants using expression profiling, or promoters and other genomic sequences that are bound by a tf in vivo by hybridizing chip samples to dna microarrays   <cit> .

however, phenotypes of tf mutants are the product of the combination of temporal, developmental and genetic interactions with the altered gene function. target identification may therefore be confounded by factors such as redundancy, pleiotropic overlap, severe developmental phenotypes or lethality . the use of inducible expression or inducible nuclear targeting of the tf may overcome these limitations but such systems have been rarely used and can also lead to secondary effects  <cit> . likewise, genome-wide location data for tf binding from chip-chip experiments does not provide definitive evidence of target regulation. observed dna binding is not always sufficient to accurately predict a regulatory interaction  <cit>  as it may be related to a process other than transcriptional control of gene expression, or simply be biologically irrelevant. in yeast, chip-chip has been comprehensively applied to all  <dig> predicted tfs. however, such data provides only a snapshot of the complete regulatory network as interactions are dependent on many variables such as the cell type, genetic background and developmental stage of the organism, and the timing and type of environmental or biological stimuli  <cit> . in the case of higher eukaryotes, which have an order of magnitude greater diversity of both tfs  <cit>  and potential targets, mapping the regulatory network would require a currently unfeasible amount of time and resources. the central role of tfs and the limitations of the available data have together generated considerable interest in the computational prediction of tf-targets and regulatory networks. applied simply, genes with altered expression in a tf mutant may be filtered by the presence or absence of a binding motif for the tf or for those showing a similar treatment-response to the tf . more complex algorithms have been used to improve the target prediction accuracy by combining chip-chip data with other resources such as phylogeny, tf binding motifs, co-expression data, or a combination of these  <cit> . the power of combining multiple forms of evidence was recently demonstrated by beyer and coworkers, who, by using eight forms of evidence, were able to predict previously unknown tf-binding interactions that could subsequently be proven by new, condition-directed, chip-chip experiments  <cit> . in the absence of more comprehensive chip-chip data, the application of these methods to higher eukaryotes is not yet feasible. one form of evidence that is also widely available for higher eukaryotes is co-expression data, which has become commonly used in computational biology since the increase in public availability of microarray data. several tools that support such analyses have been developed . these analyses have been used to identify additional components of enzymatic modules  <cit>  and assign specific functions to generalist enzymes  <cit> . co-expression relationships may also support the known regulation of target genes by a tf  <cit> . however, such examples are limited and the utility of co-expression data to predict targets of a given tf in an unsupervised fashion has not been explored. given the importance of translocation and post-translational modification  this is understandable. however, tfs and their targets do tend to be co-expressed and by applying methods that overcome problems such as time shifts  <cit>  and conditional responses  <cit> , gene expression data can be used as a proxy to measure tf activity. shi et al.  <cit>  recently demonstrated this by using expression data from multiple time series and considering the possibility of time shifts when predicting tf-targets. by modeling the known regulatory relationships, they estimated treatment specific time scales which they then used to estimate the correct time shifts for predicting novel interactions. their method depends on comprehensive prior knowledge in the form of large scale chip-chip data  <cit> , and is therefore not yet applicable to organisms for which such resources are still unavailable. furthermore, given the demonstrated condition dependency of chip-chip data and that its utility for inferring general properties of tf – tf-target interactions is not fully assessed, it is unclear whether the chip-chip data now becoming available will be useful beyond the directly studied tfs. hence, it is of interest to examine the performance of methods that do not require prior information about regulatory interactions.

lacking appropriate training data, one has to resort to fully unsupervised  approaches. several clustering methods that include the possibility of time shifts for gene expression data  have been described, but all of them take an ab initio approach by not using the information of which genes are supposed to be tfs, and are therefore unsuitable for querying the data for targets for a particular tf. recently, heard and coworkers also proposed a clustering method that can use multiple gene expression time series  <cit> , but without considering time shifts.

a prerequisite for incorporating temporal information into tf-target gene prediction is the selection of an appropriate dataset and the concomitant selection of a model organism. as will be discussed, the atgenexpress consortium's stress series dataset for the model plant arabidopsis thaliana was selected as the most technically and biologically appropriate. in particular, tf-target prediction in higher eukaryotes is appealing due to the aforementioned unfeasible task of comprehensive mapping of all tf-target gene interactions, meaning that such a method could have immediate biological application.

we developed a method to identify potential tf-target genes as those responding strongly to the same stimuli as their controlling tf in a coordinate temporal response. initially, simulated data with predefined tf-target gene expression relationships showed that, by selecting treatments and incorporating temporal information, our algorithm can improve performance as compared to conventional co-expression based methods. we then applied the method to identify known tf – target gene relationships, as experimentally determined, using expression profiling on tf mutants. these data revealed that the method was useful to enrich targets for a diverse set of experimentally determined tf – target gene relationships. furthermore, for half of the studied tfs, the enrichment of true targets among extracted genes was sufficient to obtain usable numbers of high-confidence target genes. by looking at a large set of annotated tfs, we also observed that the targets predicted using our approach are more enriched with both functional annotations and putative cis-elements compared to those obtained by conventional methods, hence, indicating a higher biological relevance.

we envisage our method could be immediately useful in narrowing the search for target genes of candidate tfs using publicly available data either through direct prediction or by filtering data obtained by expression profiling of tf mutants. this would be particularly applicable for organisms lacking comprehensive tf binding data. we show that considering other evidence has the potential to improve the methods performance and, in the future, we believe its incorporation into methods using multiple forms of evidence may improve integrative genome-wide predictions of transcriptional networks.

RESULTS
covariance based extraction of regulatory targets using multiple time series
in a simple scenario, assuming full transcriptional control of gene expression, the target genes will have the same characteristic expression pattern as the regulating tf itself, although possibly shifted forward in time. however, other genes can have similar expression pattern as a direct response to an applied treatment even though they are unrelated in a regulatory sense. in order to separate such co-expression from the more interesting co-regulation one has to look at many different time series of the same system but exposed to different perturbations.

a direct approach to utilize such data for co-expression analysis is to concatenate the available time courses and compute correlations based on the constructed pseudo time series as was done in the co-expression databases csb.db and atted-ii  <cit> . however, there are two main conceptual problems with this approach. biological interaction patterns are very dynamic and genes that are co-regulated in one condition can share little resemblance in the next, particularly if they happened to regulated by more than one tf  <cit> . thus, the inclusion of an experiment in which the tf is not active could theoretically worsen predictions. the second problem is that transcriptionally controlled regulation is delayed, so if the resolution of the time series is high enough then the tf will only be correlated with its target in a time shifted manner. moreover, this delay might not be the same across the different treatments because even though the studied physical time frame is the same, the biological time frame might differ. for example, transcription  is affected by temperature and so the time shift between the tf and its target is likely to be different under high versus low temperature treatments. ergo, the problem is two-fold. in order to make good predictions of plausible targets we propose that it is necessary to, from the total set of considered treatments, i: pick the 'right' subset of treatments and ii: introduce the 'right' time shift for these. finally, the use of the correlation coefficient implies that the scale of changes in gene expression is irrelevant and only the shape matters. to overcome the background noise from the numerous untranscribed genes one usually applies some sort of variance threshold. here, we instead experiment with using the covariance, which pays attention to both shape and magnitude, instead of correlation and thus assume that big changes are more relevant than small changes. to summarize the previous section, the following assumptions will lay the ground for our approach:

• the expression of the true target genes are transcriptionally controlled by the investigated tf.

• the tf-targets have a similar  response to the tf but may show a treatment dependent delay.

• genes can be part of more than one regulon so any treatments in which the tf does not respond are also not informative.

• because not all genes are transcribed at the same time, the sought tf-targets will have higher variance than the bulk of genes.

given a set of gene expression time series and a tf of interest, the output of the proposed method is a cluster of co-expressed genes that, given the assumptions above, look like they are controlled by the tf of interest. because the cluster is directly associated with a known tf, we will instead refer to it as a predicted regulon. figure  <dig> shows a flow scheme of the proposed algorithm, and below we outline the main strategies.

method outline
the method we suggest predicts regulons by first removing the time series in which the tf does not respond. we do this by only including treatments in which the tf exceeds two thresholds; the overall maximum response of the tf and the maximum difference between the tf of the stressed plant and the same tf under control conditions. the latter is necessary to account for the extensive diurnal expression changes of arabidopsis  <cit> .

the remaining treatments are organized in a three dimensional expression matrix, x = xi, j, k, with measurements from nt different time points , ng genes  and npdifferent treatments . following the stipulated assumptions, we rank the genes according to how strongly associated they are with the tf, by seeking a set of treatments, m, and corresponding lags, l, for which the covariance

 cj,k,lk=∑i=1nt−lknt−lk,
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaacpc6xni=xi8qivkypfjydhavhbbf9v8qqaqfr0xc9vqfj0dxdbba91qpepei8k8fii+fsy=rqgqvepae9pg0db9vqaivgfr0xfr=xfr=xc9adbaqaaegacagaaiaabeqaaeqabiwaaagcbagaem4yam2aasbaasqaaiabdqgaqjabcycasiabdugarjabcycasiabdygasnaabaaameaacqwgrbwaaeqaaawcbeaakiabg2da9maaqahabaqcfa4aasaaaeaacqggoaakcqwg5bqedawgaaqaaiabdmgapjabcycasiabdugarbqabagaeyoei0iafmyeaknbaebadawgaaqaaiabdugarjabcycasiabdygasnaabaaabagaem4aasgabeaaaeqaaiabcmcapiabcicaoiabdiha4naabaaabagaemyaakmaey4kasiaemibaw2aasbaaeaacqwgrbwaaeqaaiabcycasiabdqgaqjabcycasiabdugarbqabagaeyoei0iafmieagnbaebadawgaaqaaiabdqgaqjabcycasiabdugarjabcycasiabdygasnaabaaabagaem4aasgabeaaaeqaaiabcmcapaqaaiabd6gaunaabaaabagaemidaqhabeaacqghsislcqwgsbabdawgaaqaaiabdugarbqabaaaaawcbagaemyaakmaeyypa0jaegymaedabagaemoba42aasbaawqaaiabdsha0bqabawccqghsislcqwgsbabdawgaaadbagaem4aasgabeaaa0gaeyyeiuoakiabcycasaaa@7073@ 

is maximized for the genes in the sought regulon in all k ∈ m. in , x¯j,k,lk
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaacpc6xni=xh8vivgi8gi=heeeu0xxdbba9frfj0xb9qqpg0dxdb9aspei8k8fii+fsy=rqgqvepae9pg0db9vqaivgfr0xfr=xfr=xc9adbaqaaegacagaaiaabeqaaeqabiwaaagcbagafmieagnbaebadawgaawcbagaemoaaomaeiilawiaem4aasmaeiilawiaemibaw2aasbaawqaaiabdugarbqabaaaleqaaaaa@3504@ is the average expression of gene j in treatment k shifted backward by lk time points and y¯k,lk
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaacpc6xni=xh8vivgi8gi=heeeu0xxdbba9frfj0xb9qqpg0dxdb9aspei8k8fii+fsy=rqgqvepae9pg0db9vqaivgfr0xfr=xfr=xc9adbaqaaegacagaaiaabeqaaeqabiwaaagcbagafmyeaknbaebadawgaawcbagaem4aasmaeiilawiaemibaw2aasbaawqaaiabdugarbqabaaaleqaaaaa@32c9@ is the average expression of the tf in treatment k truncated by lk time points.

finding the optimal solutions for m and l is difficult as it would require knowledge about the identity of at least some of the true targets. this information is unavailable in our setting and therefore we design the following greedy heuristic. assuming that the regulon is large enough and under control of the tf in at least two treatments, m <dig> and m <dig>  after time lags l <dig> and l <dig>  then the product of the two corresponding covariance vectors will be high for a good pair of treatments and lags. the product of the covariance vectors from two lagged treatments is defined as:

 c=∑j=1ngcj,k <dig> l1×cj,k <dig> l <dig> 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaacpc6xni=xi8qivkypfjydhavhbbf9v8qqaqfr0xc9vqfj0dxdbba91qpepei8k8fii+fsy=rqgqvepae9pg0db9vqaivgfr0xfr=xfr=xc9adbaqaaegacagaaiaabeqaaeqabiwaaagcbagaem4qamkaeiikagiaem4aas2aasbaasqaaiabigdaxaqabagccqggsaalcqwgrbwadawgaawcbagaegymaedabeaakiabcycasiabdygasnaabaaaleaacqaixaqmaeqaaogaeiilawiaemibaw2aasbaasqaaiabikdayaqabagccqggpaqkcqgh9aqpdaaewbqaaiabdogajnaabaaaleaacqwgqbgacqggsaalcqwgrbwadawgaaadbagaegymaedabeaaliabcycasiabdygasnaabaaameaacqaixaqmaeqaaawcbeaakiabgena0kabdogajnaabaaaleaacqwgqbgacqggsaalcqwgrbwadawgaaadbagaegomaidabeaaliabcycasiabdygasnaabaaameaacqaiyagmaeqaaawcbeaaaeaacqwgqbgacqgh9aqpcqaixaqmaeaacqwgubgbdawgaaadbagaem4zacgabeaaa0gaeyyeiuoakiabc6cauaaa@5b78@ 

if we only consider a relatively small number of possible lags, we can set the seed pair of treatments to:

 {m^ <dig> m^ <dig> l^ <dig> l^2}=arg⁡max⁡m <dig> m <dig> l <dig> l2c
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaacpc6xni=xi8qivkypfjydhavhbbf9v8qqaqfr0xc9vqfj0dxdbba91qpepei8k8fii+fsy=rqgqvepae9pg0db9vqaivgfr0xfr=xfr=xc9adbaqaaegacagaaiaabeqaaeqabiwaaagcbagaei4easnafmyba0mbakaadawgaawcbagaegymaedabeaakiabcycasiqbd2gatzaajawaasbaasqaaiabikdayaqabagccqggsaalcuwgsbabgaqcamaabaaaleaacqaixaqmaeqaaogaeiilawiafmibawmbakaadawgaawcbagaegomaidabeaakiabc2ha9jabg2da9igbcggahjabckhayjabcegannaaxababagagiyba0maeiyyaemaeiieaghaleaacqwgtbqbdawgaaadbagaegymaedabeaaliabcycasiabd2gatnaabaaameaacqaiyagmaeqaasgaeiilawiaemibaw2aasbaawqaaiabigdaxaqabawccqggsaalcqwgsbabdawgaaadbagaegomaidabeaaasqabagccqwgdbwqcqggoaakcqwgtbqbdawgaawcbagaegymaedabeaakiabcycasiabd2gatnaabaaaleaacqaiyagmaeqaaogaeiilawiaemibaw2aasbaasqaaiabigdaxaqabagccqggsaalcqwgsbabdawgaawcbagaegomaidabeaakiabcmcapaaa@61f3@ 

by exhaustively trying all pairs of treatments and lags. figure  <dig> exemplifies the idea. the sought regulon co-varies with its tf in two treatments at a certain time shift and causes  to reach its maximum for these.

once the best pair has been found we create a summary of the two treatments by concatenating the measurement vectors to obtain a pseudo treatment with 2nt - l <dig> - l <dig> time points and again calculating the covariance between the tf and the rest of the genes according .

by ordering the genes after their covariance with the tf we assume that the proposed regulator is an inducer. if desired , repressed targets can be extracting by reversing the search order, i.e. by replacing cj,k,lk
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaacpc6xni=xh8vivgi8gi=heeeu0xxdbba9frfj0xb9qqpg0dxdb9aspei8k8fii+fsy=rqgqvepae9pg0db9vqaivgfr0xfr=xfr=xc9adbaqaaegacagaaiaabeqaaeqabiwaaagcbagaem4yam2aasbaasqaaiabdqgaqjabcycasiabdugarjabcycasiabdygasnaabaaameaacqwgrbwaaeqaaawcbeaaaaa@34c2@ with -cj,k,lk
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaacpc6xni=xh8vivgi8gi=heeeu0xxdbba9frfj0xb9qqpg0dxdb9aspei8k8fii+fsy=rqgqvepae9pg0db9vqaivgfr0xfr=xfr=xc9adbaqaaegacagaaiaabeqaaeqabiwaaagcbagaem4yam2aasbaasqaaiabdqgaqjabcycasiabdugarjabcycasiabdygasnaabaaameaacqwgrbwaaeqaaawcbeaaaaa@34c2@. this does not affect the initial search for a good pair of treatments and lags.

in order to investigate if there are more treatments for which  is high for the same genes, we order the remaining treatments according to  by setting m <dig> to the artificial pseudo treatment. if a cross-validation based goodness-of-fit test suggests that the next treatment is useful, it is added and the procedure is reiterated.

by selecting treatments and lags we construct a pseudo-time series in which the top-ranked genes have high covariance with the tf. this would be true even if all of the expression data were completely independent of the tf. therefore, we must investigate how likely it is to observe regulons of the same quality from randomized data. we did this by adapting the gap statistic described by hastie et al.  <cit>  to our problem. the gap statistic is beneficial as it both provides an estimate of the statistical quality of the proposed regulon, and simultaneously recommends the best number of genes to extract.

comparisons with other approaches
conceptually, our approach differs from other co-expression based methods in that it aims to directly associate a known tf with target genes. as it does not require extensive prior knowledge , it also differs from a recently described method  <cit>  to identify target genes for known tfs. methodologically, our method is characterized by two main aspects. firstly, it incorporates the a priori assumption that true tf-targets have higher variance then the bulk of the represented genes by using the covariance instead of correlation. secondly, it performs a selection of treatments and time shifts to increase overlap between the tf and putative targets. in order to investigate the importance of both of these components we assessed the performance of both the full cermt approach and a reduced version, cermt- <dig>  which always uses all treatments without considering any time shifts.

by choosing a different initial pair of treatments, by for example excluding treatments that are previously suspected to be irrelevant, it is possible to obtain different regulons. for simplicity, we will in this study restrict ourselves to consider only one regulon for each tf.

the standard work-horse for detecting co-expression is the pearson correlation and we therefore compare our results to just concatenating all time series and ranking genes against their correlation with the tf. here, we refer to this approach as 'cor'. however, considering the timescale, limited number of samples and relatively controlled conditions, the atgenexpress dataset may not allow for the best comparison with a correlation based method. we therefore chose act  <cit>  to provide a more stringent comparison, which like other co-expression tools  <cit> , uses a highly diverse dataset from hundreds of steady state conditions. repressed targets were sought by ordering the genes after their negative correlation.

to measure performance, we first looked at the threshold-free auc statistic , but this performed poorly with such grossly different sample sizes . therefore, we simply counted the number of true targets among of the top  <dig> predicted genes, thereby also allowing us to assess the ability of the method to return true targets in the very top of the gene list; an important aspect as experimental validation rapidly becomes infeasible with the number of predicted genes.

simulated data
we compared cermt with its reduced version, cermt- <dig>  on  <dig> simulated data sets that contained  <dig> genes, six different treatments and seven time points. in three of the treatments, a regulon of varying size was added that followed the pattern of the tf directly or lagged by either  <dig> or  <dig> time points. figure  <dig> shows boxplots on the percentage of the true positives that were found in the top 2n genes, where n equals the size of the planted regulon. the performance of cermt- <dig> is high if there is no time lag, but, not surprisingly, very poor if we plant a delay. the full cermt approach performs poorly if the sought regulon is too small as the 'right' treatment pair becomes increasingly diffcult to find with decreasing regulon size. on the other hand, for sufficiently large regulons, cermt shows good performance regardless of whether response is delayed or not. the size of the smallest detectable regulon decreases with the amount of time points in the experiment . note that though the limit for the minimum regulon size in the simulation seems to be around  <dig> genes, this estimate is strongly data specific and is not transferable to performance on real data.

comparison with over-expression and knock-out experiments using the atgenexpress dataset
the abiotic stress series from the atgenexpress project  <cit>  was selected for evaluation of the proposed method. this large data set uses the standardized affymetrix platform and was all generated in parallel through the coordinated work of five different research groups. it consists of data from root and shoot of  <dig> days old arabidopsis seedlings exposed to nine different abiotic stresses as well as control conditions, giving a total of  <dig> different usable time series . the seven time points commonly measured in all treatments were selected from each experiment to arrive at an expression matrix with  <dig> samples. these time points were  <dig>   <dig> ,  <dig>   <dig>   <dig>   <dig> and  <dig> hours, which approximates a log timescale. for this data, log scaled sampling seems preferable as we noted that a log-linear model yields higher absolute t-values than a linear model, thus, a majority of the genes have a more linear response in log-time than in linear time. non-linear sampling could otherwise have detrimental effects on any time shifting attempts. considering the response of plant gene expression to various perturbations , it seems reasonable to assume that this timescale will reveal at least some of the biologically relevant tf-tf-target relationships.

cermt depends on having expression estimates at the same time points in all treatments. datasets which do not fulfill this can also be used if common time points are first interpolated, which preferably can be done using sophisticated interpolation strategies such as that proposed by bar-joseph et al.  <cit> . relying solely on gene expression data, we can only expect to extract tf-targets for tfs that actually respond to the applied treatments. therefore, we conducted a literature study specifically to find experiments investigating the targets of abiotic stress related tfs either by over-expression, knock-out or chip-chip experiments, see additional file  <dig>  also, in the cases where we could find known motifs for tf's  <cit>  we extracted all genes with those motifs in their  <dig> base upstream regions regarding that gene list as a set of 'targets' to predict. we expect the experimentally obtained lists of tf – target relationships to likely contain many erroneous findings. for example, as many tfs regulate other tfs, it has been pointed out that the effects of constitutive tf mutants, as defined by expression profiling, will likely include those of the regulated tfs  <cit> . despite this, we feel this tf target practice is a useful exercise. firstly, only some of the experimentally predicted targets need to be true targets in order for these lists to be useful for the comparison of methods. secondly, the targets predicted by the method could help in reducing the number of false-positives in experimental predictions. thirdly, even if all genes represent indirect effects of regulated downstream tfs, these effects may relate to the overall biological function of the candidate tf and so their prediction could still be useful. previously, a simplified version of the second of these arguments was used to restrict gene lists obtained by over-expressing cold-responsive tfs by also requiring the genes to be cold-responsive  <cit> . to maximize the number of tf datasets against which we could assess our method, we somewhat loosened our selection from considering only fully transcriptionally regulated individual tfs. we included mbf1c, a transcriptional co-activator  <cit> ; the functionally paired myc2/myb <dig> tfs  <cit>  and hsfa1a/hsfa1b  <cit> ; the functionally redundant cbf1- <dig> tfs  <cit>  and the post-translationally regulated tfs dreb2a  <cit>  and areb <dig>  <cit> . all tfs considered as pairs/functionally redundant showed very similar expression patterns . the inclusion of dreb2a and areb <dig> was motivated by their demonstrated parallel transcriptional and post-translational stress regulation  <cit> , which should allow their transcription to act as a proxy for their direct target regulation. their inclusion could therefore validate wider use of the proposed method beyond strictly transcriptionally controlled tfs. therefore, we do not expect these lists to wholly represent direct tf-target genes, but considering these down-stream effects, there is still utility in their prediction.

target accuracy and input specificity
an important property of a prediction method is that it shows specificity towards the input tf, i.e. the real tf should really be a better input for enriching its own targets than a random tf. to measure this, we ran the algorithm on all  <dig> genes in our data set annotated to bin  <dig> , 'rna.regulation of transcription', by the mapman project and computed an empirical specificity p-value, pspec, as the number of random genes that gave the same or better enrichments than the 'true' tf divided by the total number of tested tfs. known tf families comprise approximately 90% of this annotation bin with the remaining 10% being putative tfs or other regulatory proteins. as our method is not specific to tfs but can also apply to other genes that regulate transcription  this bin is useful for our purposes, however, in the worst case, pspec will have negligible 10% error. note that to calculate pspec one has to know the true regulon and it is therefore only applicable for validation purposes.

the upper part of table  <dig> shows the performance of the proposed method along with that of the simplistic methods and the conventional co-expression database act. in general, it seems that co-expression methods can be used to identify experimental targets of a given tf. the covariance based methods cermt- <dig> and cermt perform better than the others in most cases and cermt has the overall best performance, although, with the exception of the cbf regulon, the performance increase compared to cermt- <dig> is admittedly modest. in half of the cases, the ratio of true targets is sufficient  to deliver a usable number of high-confidence target genes. act is the only method that ever substantially outperforms the proposed method. interestingly, it does so for pap <dig>  for which the other methods perform poorly. this indicates that these targets are better found in a larger, mostly steady state correlation dataset and that the proposed method can be complementary to existing methods. pspec follows the over-representation significance as expected, and are generally not different between the covariance or correlation based methods. despite this, covariance appears to be inclined towards finding genes that are really regulated rather than noise genes that happen to have the same expression trajectory. presumably, the benefit of using covariance over correlation will decrease rapidly with increasing number of studied time points. for mbf1c, zat <dig> and cbf, the original studies also reported target genes that were suspected to be repressed by the corresponding tf. the lower part of table  <dig> shows the predictions for these target pools, assuming that the tf is a repressor. cermt finds a significant number of repressed targets in the top  <dig> extracted genes for cbf and zat <dig>  significant overlap with the repressed targets of mbf1c were only found in the top  <dig> predicted targets . however, as the gap-statistic and the corresponding recommended cluster size indicates, the statistical significance of the extracted regulons is not convincing. furthermore, the pspec indicates that the found targets are unspecific to their corresponding tf. it is difficult to assess the utility of the method for extracting repressed genes with only three examples, hence, cermt should be used with caution when searching for repressed targets. repression of transcription is only visible using microarrays after subsequent degradation of available mrna and the observed response could be less coordinate among a regulon than during induction as degradation rate varies between different mrnas. the time scale is also likely to be quite different compared to that of induced responses. thus, searching for repression using expression data could very well be more difficult than searching for induced targets.

hit ratios based on real data for the top  <dig> genes associated with  <dig> different transcription factors . bold entries are the highest values for that target pool, italic entries are insignificant over-representations according to fisher's exact test . targetpool size is the number of the true targets in our expression set, e is the expected number of hits when picking  <dig> genes genes at random and pspec is an empirical p-value indicating the probability that a random tf would give the same or better hit ratio. for cermt, the best cluster size as indicated by the gap statistic is shown along with the number of true targets for that regulon size. a large gap statistic  indicates that the suggested regulon is significantly more related to the expression of the tf than could be expected from the expression of a shuffled tf. target pools were defined from over-expression experiments , knock-out experiments , chip-chip experiments  or by all genes carrying a known cis-regulatory element .

statistical properties of the predicted regulons
cermt can propose biologically interpretable target lists
one of the key benefits of the increasing public availability of expression data is the ability to quickly generate hypotheses on gene function. standard co-expression analyses have yielded several insights that were experimentally validated  <cit> . we therefore investigated the functional insight provided by the cermt predicted cbf regulon. remarkably, among the top seven genes there are four cor/lea genes and one galactinol synthase. the cold-regulated  genes are the defining members of the cbf-regulon as the cbf tfs were first identified through their binding to the c-repeat element present in the promoters of these genes  <cit> . galactinol synthase catalyzes the first committed step of raffinose synthesis which is an important component of cold acclimation known to be under the control of the cbf tfs  <cit> . overall, the predicted regulon reveals many more known cbf targets including further cold responsive cor genes, enzymes and tfs. these data clearly offer significant biological insight into the central function of the cbf tfs in controlling transcriptional and metabolic changes during cold acclimation. in addition to the predicted target lists, the information about the used treatments shown in table  <dig> can also provide useful biological insight into the function of the tf and of the predicted regulon. several of the studied examples verify known biological information such as cbf's and zat12's importance for the response to cold, hy5's for uv, hsfa2's for heat and mbf1c's for heat and osmotic stress  <cit> . table  <dig> also shows which time shifts were used for each tf along with the time shift for which the median covariance between the tf and all the genes in its regulon is maximized in the used treatments. this can be seen as a supervised 'answer' to what the algorithm is trying to predict. it is clear that there often exists a transcriptional time shift for the studied regulons, which justifies one of our primary assumptions. however, the correct time lag is frequently missed by the algorithm. the reason for this becomes apparent when one considers the plots of the over-expression defined regulon for pap <dig> and the first  <dig> genes in the predicted regulon for pap <dig>  see figure  <dig>  the difference is glaring so it is not surprising that the true regulon is overlooked. in order to increase performance it would be necessary to use additional resources rather than the gene expression data alone. by, for example, using the information that the deep purple phenotype of the pap <dig> over-expresser is due to anthocyanin accumulation and therefore only consider genes involved in flavonoid metabolism  <cit> . when this information is combined with the a priori assumption that there exists a time shift, the algorithm picks out nine of the true targets in its top  <dig> . including such additional data therefore adds one more tf to those whose hit ratio is sufficient to deliver a usable number of high-confidence target genes. this illustrates an unavoidable problem with gene expression data for tf-target prediction; there are no unique solutions. given these data sets however, we draw the conclusion that the true regulons often, but far from always, can be discovered with simple statistical functions thus conceptually strengthening the approach by beyer et al.  <cit>  which integrates many different techniques to boost target predictions.

the treatments and time shifts cermt selected for the real data. also shown are the 'best' time lags based on maximizing the covariance between the tf and the experimentally determined regulon. these data can be useful for interpreting the biological relevance of the predicted regulon. treatments ending with 's' and 'r' are from shoot and root respectively.

biological significance of the predicted regulons for a large set of transcription factors
having used existing experimentally validated tf-targets to assess the utility of the proposed algorithm for predicting plant regulons, we wished to extend the study to also include less characterized tfs. although no known targets are available for validating the predictions for such tfs, it is still possible to estimate the statistical significance of the extracted regulons from a biological point of view, and this information can be used to compare the different prediction methods. by searching for significance, we can estimate how randomly chosen a selection of genes seems to be, and, lacking stronger guidelines, we prefer a method which is less random.

a standard method for assessing the biological significance of gene expression clusters is to look at the overlap between the clusters and existing functional annotations  <cit> . the predicted regulons are in a sense also clusters and because targets of a given tf often share biological functions , we reasoned that the predicted regulons, just like standard gene expression clusters, also should share functional annotations, and that these should be detectable by searching for over-representation.

tfs regulate the expression of their target genes by binding to sequence motifs, i.e. cis-regulatory elements , in their promoter regions. a group of genes that is more likely to share sequence elements amongst each other is therefore also more likely to be co-regulated. measuring this likelihood could possibly be done by identifying the best motif and assessing its significance. there are many excellent algorithms for identifying motifs given a set or promoters available , however, the use of these methods is not feasible for our purpose as most of them are very time consuming and need data specific parameter tuning  <cit> . fortunately, we are not directly interested in finding the correct motif, but merely to score how reasonable the existence of such a motif is. therefore we chose a more simplistic method, which was inspired by the enumeration strategy used by the efficacious weeder algorithm  <cit> , and estimate the likelihood of motif-existence by the number of over-represented nucleotide hexamers. although it might be naively assumed that a single, highly over-represented motif would be found for each regulon, there are at least two reasons why better regulon prediction is more likely accompanied by an increased number of over-represented motifs. firstly, the hexamers searched for are redundant or overlapping in sequence, resulting in multiple hits from a single cre. secondly, genes may be regulated by more than one cre, and these 'hitchhiking' elements may also be enriched.

to assess the plausibility of our assumptions about regulon characteristics, we counted the over-represented hexamers and functional annotations in the experimentally defined regulons. six of the seven target pools that contained more than  <dig> genes had between  <dig> to  <dig> over-represented hexamers and seven had between  <dig> to  <dig> over-represented functional annotations, see additional file  <dig>  in addition, by examining the gene lists annotated to a common known tf binding site by atcisdb  <cit> , we found that 80% had significantly more over-represented hexamers than could be expected by chance. this strongly indicates that biologically relevant regulons are more likely to contain over-represented annotations and hexamers than random selections of genes. note that these numbers are dependent on the size of the regulon and are thus not readily transferable to regulons of different sizes.

from the simulated data, we could draw the conclusion that, if the proposed method is better than a simple correlation based measure using concatenated time series, then the improvement would be most apparent when there is a time shift between the tf and its regulon. therefore, we ran the proposed algorithm, treating the tfs as both inducers and repressors, on each of the  <dig> genes in our data set annotated in the mapman software  <cit>  to bin  <dig> , 'rna.regulation of transcription'. for the  <dig> and  <dig> genes that the algorithm chose to introduce a time shift in at least one treatment in induction and repression mode respectively, we counted the over-represented annotations and upstream motifs.

CONCLUSIONS
we designed a method for extracting potential targets to known tfs using gene expression data in the form of multiple time series. the method provides a heuristic for solving the combinatorial problem of selecting informative treatments and appropriate time shifts between the tf and its targets. by maximizing the overlap in covariance between the tf and all other genes in two treatments and then systematically adding further treatments, we not only avoid the need for computationally expensive optimizations, but also increase the interpretability and quality of the predictions.

using existing experimental data on target associations for twelve tfs, the method showed higher performance than existing steady-state co-expression tools, but indicated that both methods could be complementary. this not only highlighted the utility of the method but also showed that the targets identified by mutant profiling in normal conditions indeed often are highly covariant with the associated tf in a treatment and time dependent fashion in the wild-type plant.

the predicted regulons for unknown tfs also showed appealing properties in terms of enriching both annotations and upstream motifs. these results indicate that the described approach could be used both as a method for exploratory analysis of regulatory relationships of a particular tf, and as a means of obtaining high-confidence subsets from putative target genes identified by mutant profiling or other experimental techniques.

gene expression based techniques are especially useful for extracting potential targets when no information about the regulatory relationships is available. such methods can therefore just as well be used for aiding hypothesis generation regarding regulatory properties of e.g. metabolites.

