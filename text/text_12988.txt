BACKGROUND
microarray chips are a powerful technology capable of measuring expression levels of thousands of genes simultaneously. expression profiling has led to dramatic advances in the understanding of cellular processes at the molecular level, which may lead to improvements in molecular diagnostics and personalized medicine  <cit> . the number of experiments involving microarrays grows nearly exponentially each year  <cit> . several platforms are currently available, including the commonly used short oligonucleotide-based affymetrix genechip® arrays, which utilize multiple probes for each gene and automated control of the experimental process from hybridization to quantification. although microarrays have tremendous potential, great effort and care is required in planning and designing microarray experiments, analyzing gene expression data, and interpreting results  <cit> .

a typical microarray experiment has many different sources of variation which can be attributed to biological and technical causes  <cit> . biological variation results from tissue heterogeneity, genetic polymorphism, and changes in mrna levels within cells and among individuals due to sex, age, race, genotype-environment interactions and other factors  <cit> . biological variation reflects true variation among experimental units  and is of interest to investigators. however, preparation of samples, labeling, hybridization, and other steps of microarray experiment can contribute to technical variation, which can significantly impact the quality of array data  <cit> . to ensure highly reproducible microarray data, technical variation should be minimized by controlling the quality of the rna samples, and by efficient labeling and hybridization  <cit> .

identifying sources of experimental variation and assessing their magnitude are important for optimal experimental design, as for example, in the planning of mrna pooling in microarray experiments  <cit> . similarly, this information is useful for estimating the optimal number of required technical replicates because measurement accuracy and reliability affect researchers' power to identify differentially expressed genes  <cit> . however, other considerations, such as the goals of the study, the features of a particular microarray platform, or the cost of arrays and samples may influence experimental design  <cit> . several studies have been conducted to examine the relative contributions of various factors in different experimental settings  <cit> . here, we estimated the relative magnitudes of sources of variation in experiments involving affymetrix genechip® arrays and evaluated agreement between biological and technical replicates.

RESULTS
experimental design
the experiment was set up as described in materials and methods . source *.cel data files from  <dig> genechip® arrays were subjected to image processing by four popular methods for probe-level data implemented in bioconductor  <cit> : dna chip analyzer   <cit> , mas  <dig>   <cit> , rma  <cit> , and gcrma-eb  <cit> .

variance components estimation
for each probe set, expression levels were modeled as follows: yg = μg + bg + lg + εg, where bg ~ n is the effect of biological variation among experimental units; lg ~ n is the effect of labeling nested within biological replications; and, εg ~ n is the residual error. it should be noted that in our case biological variation could be confounded by technical variation arising during tissue isolation and preparation of mrna samples. dobbin et al.,  <dig>  found that variation at this stage of microarray processing was small compared to variation at the hybridization step  <cit> . the model was fit separately on the gene expression measurements of each of dchip, mas  <dig> , rma and gcrma-eb probe set summaries. both the effects of biological replication and the labeling effect nested within biological cases were treated as random. we estimated variance components and applied shrinkage variance estimators to them. these shrunken estimators borrow information across genes and have been shown to improve statistical tests  <cit> . figure  <dig> shows the density plots of the distributions of relative magnitudes of different sources of variation. the results indicated that for most of the genes, the biggest source of variation was biological when using dchip and rma, whereas the biggest source of variation was residual error when using gcrma-eb or mas  <dig> . for all algorithms, a significant number of probe sets had biological and labeling variance components estimates equal or very close to zero. the findings are summarized in table  <dig> 

assessment of reproducibility
we investigated agreement between technical replicates and biological replicates using pearson correlations between chips. the correlations for the following three groups were compared:  correlations between two technical replicates at the hybridization stage within a biological replicate ;  correlations between two technical replicates at the labeling stage within a biological replicate ;  correlations between different biological replicates . results indicated that technical replicates at the hybridization step agree more closely  either than technical replicates at the labeling stage or than different biological replicates . this finding can be illustrated using scatter plots: regardless of the image processing method, technical replicates of the same biological replicate  show less dispersion than data from different animals .

the reproducibility at the hybridization stage was assessed by testing the significance of the differences between expression levels of technical replicates at the hybridization step using a paired t-test analysis as described in material and methods. briefly, for each probe set we tested the hypothesis that a difference in expression levels between two technical replicates  is equal to zero. a total of  <dig>  paired t-tests were conducted and  <dig>  p-values obtained for each image processing algorithm. the distribution of p-values was modeled using a mixture model approach  <cit> . under a global null hypothesis, there are no differentially expressed genes and distribution of p-values is expected to be uniform on  <cit> . if some genes are truly differentially expressed, we expect an increased number of small p-values . distributions of p-values for the data obtained by four image processing methods are presented on figure  <dig>  by fitting the mixture of two beta distributions, one can estimate proportion of differentially expressed genes. we obtained the following estimates: dchip –  <dig> %; mas  <dig>  –  <dig> %; rma –  <dig> %, and gcrma-eb –  <dig> %. thus, at the nominal α-level  <dig> , the number of differentially expressed genes was smaller than expected by chance when data were processed with mas  <dig>  or rma, but above the nominal α-level when data was processed with dchip or gcrma-eb.

discussion
using affymetrix genearray® chips, we examined the relative magnitudes of different sources of variation in microarray experiment. analysis of variance using mixed-effects linear models is a common way to account for and test the significance of various factors contributing to overall variation  <cit> . due to limitations of our hierarchical unbalanced experimental design and relatively small number of degrees of freedom, we did not include factors that can potentially contribute to variation such as day of processing, scanning order, mrna preparation, etc. we assume that such factors were not significant. however, to formally test this assumption, another experiment is needed.

we used a general linear model to partition variance for each probe set into three components. the first source was biological  variation. the biological variation may be confounded by technical variation at the mrna preparation step, but this variation is probably relatively small compared to variation at the hybridization step  <cit> . thus, we assume that most of the variation for this effect was due to true biological differences among animals. the second source of variation was the effect of labeling. although our experiments were carried out by the same person, using the same equipment, under the same experimental conditions as much as realistically possible, there is always some variation caused by minor environmental differences in temperature, duration, pipetting etc., which influences labeling efficiency. the third source of variation other than animal-to-animal variation and labeling-effect variation was residual error caused by differences in hybridization, scanning and other factors. to compare the relative magnitudes of different sources of variation, we estimated variance components and applied shrunken variance estimators that borrow information across genes. we constructed these shrunken variance estimators by shrinking a group of individual variance estimators toward their common corrected geometric mean  <cit> . the amount of shrinkage depends on the variation on the individual variance components estimators. these estimators were shown to be robust in respect to variance heterogeneity in gene expression data among groups  <cit> .

we found that our results depend on the image processing algorithm used: biological variation was the largest source when dchip or rma were used, but when *.cel files were processed with gcrma-eb or mas  <dig> , the largest source was residual error. bakay et al.,  <dig>  found that biological variation presumably caused by tissue heterogeneity and genetic polymorphism was a major source of variation while technical variation was minor  <cit> . han et al.,  <dig>  found that biological variation was about of the same size as other sources combined  <cit> . whitney et al.,  <dig>  found that inter-individual variation in gene expression profiles was correlated with gender, age, and the time of day at which the sample was taken. these intrinsic differences in expression patterns were likely caused by differences in genotype, although they might also reflect epigenetic or environmental factors  <cit> . oleksiak et al.,  <dig>  in their studies of teleost fish have observed significant differences in gene expression levels between individuals from the same population and between different populations. these differences could be caused by genetic variation as well as other factors, including maternal effects and genotype-environment interactions  <cit> . on the contrary, dumur et al.,  <dig>  found that day-to day variation was the main source of variation  <cit> . woo et al.,  <dig>  in studies of inbred mice strains, detected that most of the genes had small biological variance, but about 10% of genes showed large variation between individuals  <cit> .

we found that technical replicates within a biological replicate had higher and more consistent correlations with each other than with other biological replicates. generally, our correlations were higher than those observed by dobbin et al.,  <dig>  for interlaboratory correlations between tumor samples  <cit>  and were compatible with values for in-lab correlations obtained in another study  <cit> .

the consistency of the hybridization step was evaluated using paired t-tests following by modeling of distribution of resulting p-values. the significance depends on the image processing algorithm used: the hybridization effect was not significant for mas  <dig>   and rma , but the proportion of differentially expressed genes was higher than expected by chance for dchip  and gcrma-eb .

the low-level data were analyzed using four popular methods implemented in the bioconductor  <cit>  package: dchip  <cit> , mas  <dig>   <cit> , rma  <cit> , and gcrma-eb  <cit> . we found that different low-level data processing algorithms produced different results. we provide comparisons mainly to illustrate the compatibility of several algorithms. evaluation of the strengths and weaknesses of different image processing algorithms may require other experimental settings, such as spike-in data. shedden et al.,  <dig>  performed a comprehensive comparison of seven image processing methods for affymetrix arrays and demonstrated that the choice of image processing algorithm has a major impact on the results of microarray data analysis  <cit> . the authors found that the dchip method operates consistently well, while mas  <dig>  and gcrma-eb consistently performed poorly. gcrma-eb had a particular disagreement with other methods when a t-test was used for group comparison, presumably because it might be more sensitive to the underlying statistical assumptions of a test . similarly, we observed that estimates of the proportion of differentially expressed genes between two technical replicates at the hybridization stage were different than those for data processed with gcrma-eb compared to other methods, which is consistent with finding of shedden et al.  <cit> .

the results presented here are specific for the systems being studied, and other experimental conditions may yield different estimates. for example, we used an outbred strain of rats, which had greater inherent biological variation than inbred strains. in cell cultures of inbred mice strains under otherwise equal conditions, the relative magnitude of biological variation presumably would be smaller. different steps in microarray data analysis, such as normalization, transformation, and gene filtering, may affect results as well  <cit> . a microarray platform and microarray facility can also have a significant impact, as was demonstrated in several recent studies  <cit> . testing the influence of these various factors could be an interesting topic of future research.

CONCLUSIONS
identification of sources of variation and their relative magnitudes, among other factors, is important for optimal experimental design and the development of quality control procedures. in this study, we evaluated the relative magnitudes of different sources of variation in affymetrix microarray experiments. different image processing algorithms gave different variance components estimates: the greatest source was animal-to-animal  variation when dchip and rma were used, and residual error when mas  <dig>  or gcrma-eb were used. we observed that correlations between technical replicates within one biological replicate were consistently higher than between different biological replicates. it should be noted that estimates obtained here were specific for our experimental system, and results would probably change if we used another organism or tissue, or another microarray platform.

