BACKGROUND
one of the results from human genome project is the use of human variation data called single nucleotide polymorphism . such polymorphisms including rare ones such as mutations reflect how we have different genetic responses to the environment as well as predispositions to certain diseases and varying effects to drug treatments. these variations, therefore, play a crucial part in many studies including population genetics, molecular genetics and pharmacogenomics. consequently, to capture the underlying variations, many genotyping technologies have been proposed, such as restriction enzyme assay, hybridization assay, ligation assay, invasive cleavage assay and allele-specific polymerase chain reaction assay. each of these techniques has both advantages and disadvantages. in this work, we focus on a simple and cost-effective protocol, namely the allele-specific polymerase chain reaction or as-pcr genotyping technique. this assay protocol were adopted by many recent studies, for instance, the detection of common alleles of cytochrome p <dig> that mediates different level of drug metabolisms  <cit> , the screening of mutations responsible for beta-thalassemia  <cit> , and the evaluation of using a set of snps as genetic markers of a disease  <cit> .

in literature, as-pcr is also known as amplification refractory mutation system   <cit> . this technique is a quick and dependable genotyping protocol that requires minimal instruments found in most laboratories. it is based on the extension of primer only when its 3'-end is a perfect complement to the allele present in the input sample. thus, if a single base polymorphism occurs, the genotyping results can be observed by simply comparing the length of pcr products. several automated bioinformatics tools are available for specifically designing as primer, such as, tetra-primer  <cit> , primo snp  <cit> , and a commercial software visual-omp  <cit> . however, none of the available tools offer an integrated input system that users can retrieve markers to be genotyped from within the program framework. furthermore, the resulting as primers from these programs may not be specific enough; that is only one mismatch at the terminal base may not discriminate the amplification results from wild and mutant types since the extension of the allele-nonspecific primer may continues if terminal mismatching has weak-destabilizing effect  <cit> .

to address these difficulties a snp database and intuitive graphical interface should be integrated with the as primer design tool while primer-destabilizing condition must be considered to ensure effectiveness of primer results. consequently, a novel tool, wasp , is presented in this paper. this tool automatically generates well-calibrated discrimination conditions for as-pcr assay. by adopting the protocol, our proposed tool can increase the as primer specificity during pcr reaction by creating a mismatch on the penultimate  base of the as primer. wasp utilizes a local snp database, comprising snps from dbsnp  <cit> , hapmap  <cit> , and jsnp  <cit> , to search and retrieve input snp information from within the tool. therefore, this eliminates extra steps of gathering snps from different websites and copying/pasting to a primer-designing tool. through a unique svg graphical user interface, wasp offers a primer design for multiple snps that store in public databases. note also that wasp calculates as-pcr assay for genotyping snps, which are not in this database by providing flanking sequences as well as the target snp to the program. optionally to optimize pcr experiment, standard pcr conditions can be modified through the primer-parameters. if design conditions are met, as primers and their common oligo-primers will be graphically visualized or otherwise displayed the reasons why they cannot be designed. once resulting as primer set is obtained, these primers can also be verified for their global uniqueness by running through an in silico pcr  <cit> .

implementation
wasp is a web application constructed using ruby on rails framework. the application is integrated into the local snp database  running mysql database server. this database frequently collects public snp information and related reference data from public snp databases. at the time of writing current version of these databases are dbsnp build  <dig>  hapmap public release  <dig> and jsnp release  <dig>  the computing core runs within unix environment comprising four modules: 1) the input module, 2) the parsing module, 3) the as-pcr assay analysis module and 4) the graphic display module.

1) input module
the purpose of this module is to read in target snp or mutation that users want to construct an as-pcr assay. wasp uses two alternative input formats, namely keyword and user-defined input. first, the keyword search is designed for looking up related snp information such as possible alleles and their corresponding flanking sequences. the allowed keywords can be gene name and reference snp rs number. the input module creates a set of sql queries to retrieve underlying information such as the 5' and 3' flanking sequences and the target alleles of snp; then pass the resulting information to the parsing module to further prepare inputs for primer <dig> program . for visualization and selection of snps to be genotyped, an svg-based graphical view of snp locations will also be displayed once a gene is selected.

the second input format is constructed to facilitate the as primer design for novel snps and/or mutations. the target variations and their corresponding 5' and 3' flanking sequences must be entered to the given text box or upload a file containing the information to the server. instead of constructing sql queries described previously, the input data will be converted to the internal forms by the parsing module and later sent to the as primer analysis module. for example, figure  <dig> demonstrates two possible sample inputs that wasp would except to calculate the corresponding as primer. the input format for this section comprises 5' and 3' flanking sequences or a target variation, which is described in iupac  or bracketing format . note that for both inputs , their primer conditions can be modified such as primer length, melting temperature , gc content for primer oligos and other standard primer design parameters.

2) parsing module
this module is responsible for transforming the underlying variation information and their primer conditions to pcr template sequences and primer selection criteria that are used in the primer <dig> program  <cit> . both wild and mutant type templates are generated separately, however, they must share the same primer selection criteria in order to be performed in single pcr reaction. the main contribution of this module is the preparation of an additional deliberate mismatch at the penultimate base of as primers to increase the reaction specificity  <cit> . for instance, if there exists a weak destabilizing at the terminal mismatch, it is likely that such a mismatch is not enough to stop the extension by taq polymerase. to increase the discriminative power, hence, an additional mismatch with a strong destabilizing effect should be introduced at the penultimate base of the as primers. figure  <dig> demonstrates the decision criteria, based on the destabilizing conditions, in which the underlying additional mismatch should be added to as primer. the areas shaded in red and yellow respectively represent the strong and weak destabilizing effect of any two nucleotides while blue ones imply the medium effect. starting from the center of this figure  and working outward, we can decide which base  to be placed on the penultimate position of the designed as primer. an example situation showed under the diagram, as primer was designed for genotyping c>t snp at + <dig> locus of the cyp2d <dig> gene  <cit> . the polymorphisms, c  and t , are displayed in the box on the template sequence . on top of each template, primer extension direction is indicated by → whereas × marks a non-extended scenario. note that nucleotides in the as primers that are not complementary to the target appear afloat from the primer oligos. basically, four binding scenarios could happen in a single as-pcr experiment: wp-wt, wp-mt, mp-wt and mp-mt. to design the as primers the above polymorphism, wild type and mutant as primers must have respectively bases g and a at the 3' terminus; thus gel electrophoresis bands can be observed when successful hybridization occurs.

in order to enhance reaction specificity, a deliberate mismatch is introduced at the penultimate base. using the above diagram, we first consider wild type primer with the case wp-mt in which t/g () presents a weak-destabilizing mismatch . we then look at the penultimate location to observe the base on the template sequence, which is g () in this case. according to the diagram only nucleotide a () should be put next to the terminal base in both as primers to ensure the stronger destabilizing . note here that the same additional mismatch is also introduced to mutant primer. if the terminal base is not mismatching, the additional mismatch on the penultimate base  of the primer will not prevent the extension.

3) as-pcr assay analysis module
three oligo primers are to be produced by the parsing module, namely wild-type, mutant and common primers. the as-pcr assay will be conducted in two parallel experiments: one is "wild+common" primer experiment  and the other is "mutant+common" primer experiment . the results will be interpreted from each experimental result. three scenarios are to be detected, which are homozygous wild type, heterozygous and homozygous variant type respectively. a band from wc but none from mc tube entails homozygous wild type. on the other hand, single band on mc but none from wc tube implies homozygous variant type. if this kind of band appears on both wc and mc tubes, being heterozygous will be inferred.

with the above as-pcr assay, the core engine of this module is the primer <dig> program with some modification to make primer <dig> fit the needs of as primer designing. two criteria must be considered for this as-pcr assay. first, as primers must be used with their common primer in the same reaction. secondly, the reaction conditions should promote the discrimination of wild and mutant reactions. in this module, optimal primer candidates will be computed. both wild and mutant primers are examined if they follow given as-pcr assay criteria. once satisfied, each primer pair will be aligned against the human genome reference sequence stored in the local database using in silico pcr. this technique utilizes blat  to rapidly search for all possible pcr products in the target genome that complement with both directions of pcr primers. in our case, the input of in silico pcr is a pair of optimal primer candidates and the output returns pcr products if any. this feature ensures that the global uniqueness of a primer pair can be achieved.

4) graphic display module
the graphic display module is responsible for graphically displaying the query snps as well as the designed primer. we adopted the scalable vector graphic  display  <cit>  that allows users to interact with high quality vector image that can be scaled and move around without viewing degradation due to losses in image compression. the construction of such images is performed "on-demand", i.e., no images are pre-calculated and stored. first, for snp location map , relative locations on each gene are computed upon the query to the local snp database. on svg enabled web browsers such as firefox and opera svg images can be displayed without extra installation while all other browsers svg plug-in module must be installed.

second, for displaying as primers results, the display module waits for results from as-pcr assay analysis module to be completed. then the primer information such as orientation, location, and other calculated conditions are converted to svg image. here, target snps/mutations and the resulting as primers will be visualized in graphical objects. when moving a mouse over each object, there will be a popup window whose contents show related primer conditions. if no as primer is reported, only input sequence and original primer parameter conditions will be presented. in this case, some primer selection criteria should be optimized such as varying primer length, tm, gc content as well as increasing the 5'and 3' flanking sequence length. figure  <dig> demonstrates svg graphical user interfaces described previously using as primer design for snps in cyp2d <dig>  this example demonstrates the case when multiple snps on the gene can be selected for as primer design . figure  <dig> presents primer report  as well as the svg output representation . the results are collectively reported in one continuous page if there are multiple snps to be designed. such results can directly be saved as a text file for future experiments.

RESULTS
integrating snp database to wasp makes it possible to display snp related information to users ; hence we can use such information to decide which snp in a given gene to be designed for as primers. the proposed tool can design more effective as primers than other available software  since wasp checks the uniqueness of the primer using in silico pcr during the design. moreover, by incorporating arms enhancement protocol to the software, such as primer results can be even more effective as this technique has been adopted by several recent studies. note that other existing tools only produce mere primers but not the counterpart "common primer", which needs to have very similar condition to the as primers. wasp also offers svg graphical user interface for both snp selection and as primer viewing. for snp selection, wasp allows users to visualize snps from a gene structure view . users need not to construct the input information by accessing other public snp databases. finally, unlike other tools, wasp graphically displays location of top  <dig> output primers as well as their common primers. this kind of outputs should help users tailor their final primers to fit the as-pcr assay.

CONCLUSIONS
we presented wasp, a web-based allele specific primer design application. the tool conveniently assists scientists in getting snp information from local snp database, mirrored from all major public databases, in order to design as primers for existing snps. while current as-pcr tools such as tetra-primer, primo snp and visual-omp, require manual entering snp information, wasp simplifies the data preparation step by graphically displaying available snps to be genotyped and transparently send such information to be computed by primer <dig> program. this tool also offers a conventional input for either confirming the information in the database or designing as primers for novel snp/mutation.

to improve the specificity of pcr reactions, wasp deploys an in silico pcr by searching if a given primer is unique in the genome. furthermore, wasp offers a missing feature in other primer design tool to improve the effectiveness of the resulting as primers; that is the introduction of a proper mismatch to the penultimate nucleotide next to the allele specific site in the primer. svg visualization is integrated into wasp so that primer results can be displayed interactively and intuitively; thus helping users to adjust primer parameters for the negative as primer outputs. for positive as primer results, users can export the primer conditions as a text file.

availability and requirements
wasp sever is available for public access at 

wasp requires svg enabled web browser opera and firefox, which are freely available on almost all major operating systems , . for mac os x, browser such as safari, omniweb must have an svg plug-in installed. the plug-in can be downloaded from . on microsoft windows system, a built-in web browser, ie, would also require svg plug-in to be installed. without the plug-in rendering all other features will still work except svg visualization.

abbreviations
as-pcr, allele specific polymerase chain reaction

arms, amplification refractory mutation system

as primer, allele specific primer

snp, single nucleotide polymorphism

authors' contributions
pw and jc wrote the core engine of wasp while kc and ur contributed to the svg visualization of the tool. cn and st took care of all local snp database construction. st and aa initiated the idea of wasp. st and pw wrote the manuscript whereas aa reviewed and tested the software.

