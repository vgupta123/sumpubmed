BACKGROUND
most engineered multi-task systems show a tradeoff between efficient and flexible design. a common example is the swiss army knife, which is a flexible tool that can realize many functions but the performance of each tool function cannot reach the efficiency of specialized tools. here the tradeoff arises from the constraint that a hand tool should not be too big to be useful, resulting in components that are shared between different tool functions. to give a more quantitative example for an efficiency-flexibility tradeoff, imagine two workers that drive between home and their common working place . they both benefit from short traveling times and – as tax payers – suffer from road maintenance costs. traveling times are minimized by direct routes from homes to working place . however, the road maintenance cost can be reduced if both workers share a part of the road network . if we assume that both benefit and cost scale linearly with road distances, the performance of the two road networks can be easily compared. the result shows that the ‘efficient’ road network has shorter driving time but higher maintenance costs than the ‘flexible’ road network . by weighting traveling time and maintenance cost by a factor that reflects their relative importance, the road network with highest benefit-to-cost ratio is realized by either a more flexible or a more efficient design, depending on the weighting factor. such a situation where one objective can only be optimized to the expense of another objective is known as pareto optimal solution .
fig.  <dig> trade-off between traveling time and road maintenance costs in road network design. left panel: road networks that minimize either traveling time  or maintenance cost . right panel: comparison of traveling time and maintenance cost for both road networks



due to the generality of the efficiency-flexibility tradeoff we ask whether metabolic networks show similar signatures of such a tradeoff. we define a highly flexible metabolic network by its ability to minimize the cost of up and down regulating enzymes when switching between different growth conditions. in turn, a highly efficient network is defined as one that minimizes the overall enzymatic cost under constant environmental conditions. similar to our road network example, we expect that the catabolic pathways of a highly flexible network are shorter and converge faster to common metabolic routes. in contrast, we expect efficient metabolic networks to be more streamlined as a consequence of minimizing the overall enzymatic cost. focusing on bacterial, our hypothesis is that species that shuttle between diverse environments show a stronger bow-tie structure than bacteria that live under more constant conditions.

for metabolic networks, a tradeoff between flexibility and efficiency can arise from limitations of cellular resources. there is currently accumulating evidence that the distribution of cellular resources is under high selective pressure, especially in fast growing prokaryotes. for example, increasing the expression of an unnecessary protein in e. coli leads to a linear reduction in growth rate  <cit> . this linear relation is best explained by assuming a fixed upper bound for the protein synthesis capacity per unit biomass of a bacterial species  <cit> .

many attempts have been made to describe the structural features of metabolic networks  <cit>  by considering degree distributions, small word properties  <cit> , bow-tie-like structures  <cit>  and minimal paths between precursor metabolites  <cit> . yet, it remains unclear if there exists a selective advantage that corresponds to these features. a possible evolutionary scenario is that the large-scale structure of metabolic networks is a consequence of preferential attachment, where newly acquired enzymes functionally extend the existing metabolic network structure as this can lead to an immediate fitness benefit  <cit> . although this principle can affect the structure of metabolic networks to significant extent, new data about the e. coli pan-genome showed an extreme flexibility of the gene content among closely related species by rapid acquisition of genetic material even from distantly related species due to horizontal gene transfer  <cit> . this observation indicates that the universe of possible metabolic networks  <cit>  can be scanned on rather short time scales and thus evolutionary innovation is not necessarily the limiting factor for structural variability. it is therefore more likely that a combination of evolutionary principles  <cit> , biochemical constraints  <cit> , and limitations of cellular resources have shaped metabolic network structures on larger scale.

in the following, we give strong evidence that limited cellular resources in combination with fluctuating environments can lead to the observed global structure of metabolic networks. first, we formulate our assumptions within a mathematical model. second, we illustrate the concept using a toy-model for a metabolic network structure. we show that within this simplified model, hub nodes and bow-tie structure emerge in strongly fluctuating environments. then, we investigate the core metabolic network of e. coli and show that a significant structural reshaping occurs if we increase the share of investments for switching between different nutrient conditions. finally, we investigate the large scale structural properties of more than  <dig> reconstructed bacterial metabolic networks. we find a highly significant correlation between the global structure of bacterial metabolic networks and their lifestyle that confirms the results of our model.

RESULTS
resource constrained flux balance model
flux balance analysis  is a simple but efficient constraint-based model for cellular metabolism  <cit> . fba has been successfully employed to predict genotype-phenotype relations of single gene knockout mutants  <cit>  and the outcome of evolutionary experiments  <cit> . the flux balance constraint ensures that the production rate of a metabolic compound equals its consumption rate at steady state. in the following we extend fba to account for limitations of intracellular resources  <cit>  and use this approach to simulate fluxes under fluctuating environments.

in a first step we define the universe of metabolic reactions  <cit>  as a large set of possible metabolic reactions that can be used to convert all available nutrients into biomass. an optimally adapted metabolic network for an organism can then be defined by a subset of this reaction universe that maximizes the average biomass production rate over all nutrient conditions under physicochemical constraints.

the first physicochemical constraint we account for is flux balance, which is given by 
  ∑ismiνik= <dig> 

for each metabolite m . here, s is the stoichiometric matrix of the universe of metabolic reactions and νik is the flux of the reaction i  for the environmental condition k , where m, n and p are the number of metabolites, reactions and environmental conditions, respectively. note that s is common for all environmental conditions and therefore does not depend on k.

for an enzymatic reaction, the related flux of an upregulated enzyme can be zero due to the lack of the corresponding substrate. therefore, it is convenient to introduce the enzyme investment vector, φ, in addition to the flux vector, ν, in our model. in this manner, we separate the regulation of an enzyme and the related carrying fluxes. the relations between fluxes and investments are given by 
  −βiφik≤νik≤αiφik 

here, φik is the enzyme investments due to the flux νik and the index i runs over all of the enzymatic reactions plus the biomass reaction. for each enzymatic reaction, αi and βi are the catalytic rates of the related enzyme in forward and reverse directions, respectively, where αi,βi> <dig>  it has been shown that the concentrations for most intracellular metabolites are much higher than the km values of the corresponding enzymatic reactions in e. coli  <cit> . this fact allows us to approximate the catalytic rates αi and βi as constants and thus independent of the substrate concentrations. in addition, since we consider the biomass production rate, νi=biomassk, as a separate reaction in our model, φi=biomassk reflects the resource investment in synthesizing biomass, where the most dominant contribution comes from the investment in ribosomes. therefore, αi=biomass is tightly connected to the translation rate of the ribosomes.

the environmental conditions are defined by the presence or absence of exogenous metabolites. since metabolite concentrations do not appear in our approach, we define pseudo-reactions representing the flow of exogenous metabolites into and out of the cell environment. the bounds on the pseudo-reactions are used to express the availability of an exogenous metabolite in an environmental condition. therefore, we consider an additional constraint, which is given by 
  νik≤uik 

where the index i only runs over the pseudo-reactions. the upper bounds, uik, depend on k and are different in different environmental conditions. the metabolites that are not available in the environment k are constrained by setting the corresponding upper-bounds, uik, to zero. for the available metabolites, uik is set to infinity. note that there are no resource investment for the pseudo-reactions, since they are not real enzymatic reactions. defining lower bounds on the pseudo-reactions is not necessary.

to generalize the resource constraint to fluctuating environments, we define two kinds of investments: metabolic investments for each environmental condition ; and investments required for switching between different environmental conditions . these two contributions lead to a resource constraint that is given by 
  ∑iφik+φ′k≤φ <dig> 

where the index i runs over all enzymatic reactions, including the biomass reaction. here, φ <dig> is the maximum capacity for cellular resources and ∑iφik represents the constant investment in transporters, enzymes, ribosomes and other essential parts required for growth in environment k. in addition, φ′k represents the switching investments that arise from the necessity of sufficiently fast de novo synthesis of proteins – which implies additional allocation of ribosomes and components involved in regulating gene expression, such as transcription factors and signaling pathways  <cit> .

changes in nutrient conditions are in general followed by large changes in the distribution of metabolic fluxes, which in general involves the up- and downregulation of metabolic pathways  <cit> . the regulation of enzymes and transporters with respect to nutrient availability is likely the consequence of an efficient distribution of the protein synthesis capacity in prokaryotes. this view is supported by the experimental fact that the increase of the protein production rate for an unnecessary protein linearly decreases the growth rate  <cit> . it therefore makes sense to approximate the resource investments associated with switching from environment l to environment k, φ′k, by a linear function of the investment differences between these environments 
  φ′k=rp−1∑l≠k∑i|φik−φil|. 

here, we assume for simplicity that all environments are visited with equal probability. the relative contribution of the resource investment associated with switching between environments are related by a coefficient r> <dig> – the switching parameter. by definition, r is a dimensionless factor which represents the importance of the switching investments relative to the resources invested in growth. organisms that need to adapt their metabolism faster to a new environment, are expected to show a higher investment on resources associated with switching between environments. evidence is provided by e. coli, where only five of the seven ribosomal rna genes are needed to support near-optimal growth under constant nutrient conditions, but all seven are necessary for rapid adaptation to nutrient changes  <cit> . the link to the growth rate is given by the fact that ribosomal rna genes limit the synthesis rate and thus the abundance of ribosomes.

to generalize the objective function to fluctuating environmental condition, we use a linear combination of biomass reaction fluxes with equal weight on each environmental condition 
  maxν,φ1p∑kνi=biomassk. 

in other words, we maximize the average biomass production rate  of the organism over all environments. note that by maximizing this objective function, the optimal fluxes and the optimal investments are found simultaneously.

to infer a metabolic network, we solve the linear programming problem of eqs.  <dig>   <dig>   <dig>   <dig>   <dig> and  <dig>  the reactions for which the corresponding optimized investment is nonzero, at least for one environmental condition, are considered to be present in the metabolic network. the reactions for which the corresponding optimal investment is zero for all environmental conditions are superfluous and therefore are not included into the metabolic network.

network structure and regulation transitions
to understand the concept of optimal design in metabolic networks we start with a simple toy-network as the universe of reactions, which mimics the relevant large-scale features of real metabolic networks. consider the simple universe of metabolic reactions illustrated in fig.  <dig>  this directed network has  <dig> metabolites  including two extracellular substrates s <dig> and s <dig> and  <dig> enzymatic reactions , which includes a biomass reaction. the first two reactions are responsible for the uptake of two alternative input metabolites s <dig> and s <dig>  which we assume to be available under two different environmental conditions. the final reaction is the biomass reaction, which takes part in the objective function of our resource-constrained optimization approach. all other reactions are intermediate reactions that convert input metabolites into biomass. the catalytic rates of all reactions are equal. for each environmental conditions, an optimal network is inferred via our resource constrained fba represented by eqs.  <dig>   <dig>   <dig>   <dig>   <dig> and  <dig> 
fig.  <dig> toy-model. the universe of metabolic reactions for a simple toy-model containing  <dig> metabolites including two extracellular substrates s <dig> and s <dig> and  <dig> reactions. a fluctuating environment is generated by shuttling between the two alternative substrates, s <dig> and s <dig>  the objective function is to maximize the biomass production rate averaged over all environmental conditions



we observe two different types of transition in the structure and the regulatory strategy of the optimized network by increasing the switching parameter, r. the first transition occurs at r= <dig>  and shows a change in the structure together with a change in the regulation of the network. the different structures of the optimized metabolic network for r< <dig>  and r> <dig>  are shown in fig. 3a and b, respectively. the two different pathways in fig. 3b have six reactions each and are therefore longer and more costly than the two pathways in fig. 3a, which have only five reactions. however, the cost for switching to the new environment is lower for the network in fig. 3b with longer pathways, as it has less unshared reactions for the two different environmental conditions. the pathways in fig. 3b have just two unshared reactions which are upregulated upon switching conditions, whereas the network of fig. 3a has four unshared reactions to be regulated . the reactions that are shared between pathways are constantly upregulated under all environmental conditions . here, a tradeoff between the constant investment in enzymes and the investments in up- and down regulation of sub-pathways shapes the structure of the network. however, the strategy of regulation, which is expressing enzymes only when they are needed, does not change in this regime of switching parameters.
fig.  <dig> structural transitions and regulations of the toy-model. blue and red arrows are regulated enzymatic reactions and black arrows are constantly active enzymatic reactions. light-gray arrows shows the remaining reactions that belong to the universe of reactions of fig.  <dig>  but not selected within the optimal metabolic network. bold-lines illustrate the active reactions in each environmental condition. a low switching parameters, r< <dig> , result in an efficient network design that connects the actual present substrate to the biomass reaction using the most direct metabolic route. b intermediate switching parameters,  <dig> <r< <dig> , shows a strong reduction of enzymes that are regulated and the emergence of a common permanently upregulated metabolic route. c high switching parameters, r> <dig> , result in permanent upregulation of all enzymes and a network design of minimal size



the second transition occurs at r= <dig> . the nature of this transition is different from the first one, as it changes the strategy of regulation but preserves the structure . for r< <dig> , the organism tries to regulate the necessary enzymes of each environment with respect to nutrient availability. however for r> <dig> , the organism expresses all enzymes of the network constantly over time so that they can be utilized immediately in the appropriate condition. here, the cost of preparing the cell for the new environment becomes higher than the cost of permanently synthesizing the unnecessary enzymes which can happen in really fast fluctuating environments comparable to the cell cycle timescales.

as it is shown in fig.  <dig>  both of the transitions are reflected by two discontinuities in the slope of the growth rate as a function of r. the transition at r= <dig>  is accompanied by changes in structural parameters . the analytic calculations of transition points are presented in .
fig.  <dig> structural parameters for the toy-model. a growth rate for different switching parameters, r. two discontinuities exist in the slope of the curve at r= <dig>  and r= <dig> . b pathway length vs. r. c number of nodes vs. r. d number of reactions vs. r. structural parameters of the optimized network confirm that only r= <dig>  is a structural transition



emergence of the hub nodes and bow-tie structure
all currently reconstructed cellular metabolic networks show a bow-tie structure on larger scale  <cit> , where one side of the bow-tie consists of catabolic pathways and the other side consists of anabolic pathways. the both sides converge at about twelve precursor metabolites. the precursors can be considered as hub nodes in the network, which are defined by their comparatively higher number of connections to the other nodes in the network. under fluctuating environmental conditions with high enough switching parameter, the optimized toy-network shows similar structure where the blue and red pathways meet at the hub node and share the remaining enzymes to realize biomass production . this structure reflects the principles of a bow-tie structure by having a hub node as center part, two short catabolic pathways, and a single anabolic pathway. according to this observation our theory predicts that under fluctuating nutrient conditions with sufficiently high demand for switching cell resources and under limited cellular resource condition a bow-tie structured network emerges, which performs better than a streamlined network.

e. coli core metabolic network as a universe of reactions
to generalize the toy-network to real metabolic networks we would need to define a suitable universe of possible enzymatic reactions. one could imagine to include all metabolic reactions that are classified by an enzyme commission number . unfortunately, the corresponding chemical reactions associated with each ec number are not clearly defined. alternatively, we could consider all enzymatic reactions of known enzymes that are listed in databases such as the kegg database  <cit> . however, as the known enzymes are already a part of the evolved bow-tie structured networks, it is unclear if alternative enzymatic routes exist that can circumvent the existing precursor metabolites. therefore, it is not possible to define the genuine universe of metabolic reactions. however, investigating any realistic network seems beneficial to see whether the general restructuring observed in the toy-network can be observed in real metabolic networks when the switching parameter is sufficiently large. for this purpose, we consider the well characterized e. coli core metabolism, defined in  <cit> , as the universe of metabolic reactions . as e. coli is a generalist bacterium that can digest many different nutrients, its core metabolism is a collection of various important metabolic pathways that are observed in different organism. furthermore, it has relatively small network size which simplifies the demanding numerical calculations. due to the numerical complexity of the optimization problem, standard linear programming routines as provided by numerical packages are in general not able to find a solution for larger networks, such as the reconstructed e. coli metabolic network, in presence of several environmental conditions. we consider  <dig> different environmental conditions each containing a different carbon source as substrate which the number of carbon atoms range from two to six by using acetate, pyruvate, l-malate, l-glutamate and d-glucose. all of the carbon sources are considered to be metabolized under aerobic conditions under saturating concentrations of ammonium, phosphate and co <dig>  except d-glucose, which is metabolized under anaerobic conditions. one can use the same catalytic rates for all enzymes since different values for catalytic rates just change the position of observed transition points and do not change the qualitative behavior of transitions. however, to check the sensitivity of the results to the catalytic rate values, we compare the results for equal catalytic rates with a various catalytic rates case taken randomly from a uniform distribution with equal mean value and  <dig> percent of random fluctuations . the results are almost the same . we also take the average over  <dig> realization for an extreme case with  <dig> percent of random fluctuations to observe the overall behavior independent from the exact values of the catalytic rates . the optimal solutions are not degenerate as the resource constraint, eq.  <dig>  breaks the degeneracy of alternative pathways  <cit> , if αi and βi have different values.
fig.  <dig> schematic graphical representation of the e. coli core metabolism. the network contains  <dig> metabolites and  <dig> reactions, including pseudo reactions  <cit> . some important metabolites are named explicitly. ex_ac, ex_pyr, ex_mal-l, ex_glu-l and ex_glc represent the extracellular concentrations of acetate, pyruvate, l-malate, l-glutamate and d-glucose, respectively, that are provided in random order to mimic fluctuations in nutrient availability

fig.  <dig> structural parameters for the e. coli core metabolic network. the average over  <dig> random realizations of α and β with  <dig> percent noise is taken. here,  <dig> different environmental conditions that represent different carbon sources with  <dig> to  <dig> carbon atoms is used. a average growth rate vs. r. b average shortest path from an input metabolite to each of the biomass contents for the optimized network vs. r. c number of selected input metabolites after optimization process vs. r. d number of nodes of the optimized network vs. r. e number of reactions of the optimized network vs. r. f number of regulons vs. r




we observe a significant structural reorganization of the core metabolic network by increasing switching parameters, r . the behavior of the structural parameters are similar to the toy-network. an obvious effect of an increase in r is a decrease in the growth rate . as the resource capacity of the cell is limited, an increase in the investments for switching conditions reduces the ability of the cell to dedicate resources to biomass production.

as discussed before, by choosing the e. coli core network we restrict the solution space to a pre-structured bow tie like universe of metabolic reactions. however, the optimally selected metabolic networks are subsets of the core network and therefore do not have necessarily similar structures. our results show a tendency for higher switching parameters toward having more bow tie like structure. similar to the toy-network the average pathway lengths increases while r increases . here, we measure the average pathway length by the average shortest path , which is the average of the shortest routes from an input metabolites to each of the biomass metabolites. viability ensures that each biomass content is connected to at least one input metabolite. an increase of the asp shows the transformation of the network structure from having short direct pathways to having longer but partially shared pathways.

the number of regulons offers a simple measure to monitor strategic changes in the metabolic regulation. here, regulons are the set of metabolic genes that are regulated in concert. therefore, it is reasonable to assume that genes that are regulated together under different environmental conditions are a part of the same regulon. in fig. 6f, the number of regulons varies for different switching parameters r, which indicates the changes in the strategy of regulation of the network. for high switching parameters , we have just one regulon. like for the toy-network, the organization of metabolic genes in a single regulon means that enzymes and transporters are constantly upregulated to avoid switching cost. a generalization of the toy-network to a large metabolism-inspired hierarchical random network, shows similar behavior as the e. coli core-network .

unexpectedly, by increasing the switching parameter, r, the number of selected input metabolites for the optimal organism drops down for both the e. coli core network  and also for the hierarchical random network . note that all potentially available metabolites in the environmental conditions can be taken up and converted to biomass by means of the relevant subset of the universe of metabolic reactions. therefore, the optimal organism is able to digest a potentially available nutrient if the relevant reactions are selected in the optimal metabolic network of the organism. the obtained result shows that, for sufficiently high switching parameters, the optimal network does not choose all of the available metabolites as substrates to produce biomass. as a result, a growth rate optimized organism is not able to live under all available environmental conditions. for example, for r> <dig>  the optimized network of e. coli core shows no biomass production when grow on d-glucose as the only carbon source. note that, d-glucose supplied media considered to be the only anaerobic environment in our system setup. it seems that, it is too costly for the organism to adapt to all possible environments for high switching parameter conditions.

considering the fact that most bacterial species, such as e. coli, have evolved in a highly competitive environments under strongly fluctuating nutrient conditions, our results suggest that a true bacterial generalist with the ability to survive under almost all environmental conditions will not evolve. this theoretical finding could explain the species richness of bacteria that share a common habitat  <cit> .

comparison of reconstructed metabolic networks
to track the consequences of our theory, we focus on metabolic networks of bacteria, since they are considered to be metabolically optimized organisms that live in competitive environments. some bacteria are able to reproduce in many different habitatslike e. coli. on the other hand, some others such as mycoplasma pneumoniae, which is a parasite living inside mammalian cells, are able to reproduce just in the stable environment of the host. now, the question is whether the properties of the metabolic networks of different bacteria living in different environmental conditions reflect their different lifestyle  <cit> . according to the predictions of our resource constrained flux balance approach, organisms that can adapt to more diverse environments are expected to have more hub nodes of higher degree and a more pronounced bow-tie structure than organisms living under more stable conditions. to confirm this hypothesis we analyzed the structure of  <dig> reconstructed metabolic networks from the model seed database  <cit>  with different lifestyles that are reported in the ncbi database  <cit>  .

unfortunately, it is very difficult to get information about the different nutrient conditions under which bacterial species have evolved. we therefore classified bacteria in facultative and non-facultative  groups and compared the structural features of their metabolic networks. the reason behind this classification is that aerobic and anaerobic growth conditions are usually associated with different habitats and most facultative bacteria reproduce under both conditions whereas obligates reproduce only under anaerobic or aerobic conditions. as growth under aerobic and anaerobic conditions requires substantial readjustment of metabolic fluxes, facultative bacteria need to invest more resources for adaptation to these growth conditions than the non-facultative bacteria. the view is confirmed by observing a statistically significant difference between the structural parameters of these two groups, using the kruskal-wallis test  <cit> .

as a control observation, we found no significant difference in the distribution of the genome size between facultative and non-facultative organisms . also, the difference in the distribution of the number of metabolic genes used in the reconstructed model is not significant . these distributions show that a fair comparison between these two groups is possible.
fig.  <dig> structural parameter distributions of reconstructed networks. distribution of different structural parameters of  <dig> different species classified in two groups of facultative and non-facultative organisms with size of  <dig> and  <dig> species, respectively. the distributions of a number of genes used in reconstructed metabolic model, b number of input metabolites , c average in- or out-degree of the networks considering directed links, d average of shortest path between an input metabolite and each of biomass ingredients, e the average of distances between input metabolites and f fraction of essential reactions. p-values are calculated by the kruskal-wallis test



the facultative group has a significantly higher number of input metabolites than the non-facultative group , which reflects the ability of the facultative group to make use of a large variety of nutrients in comparison to non-facultative organisms. also, the facultative group has relatively higher average degree than the non-facultative group . this is consistent with the results of our model, which predicts differences in the structural organization of metabolic networks for organisms having either low or high switching parameters. the lowest average degree in fig. 7c belongs to onion yellows phytoplasma which is an aerobe obligate intracellular plant parasite living in a relatively constant environment  <cit> .

considering lmin as the shortest path between any of the external metabolites and each of the metabolites that are part of the biomass reaction, the average pathway length averaged over biomass metabolites, 〈lmin〉, is significantly smaller in the facultative group than in the non-facultative group . as it is mentioned previously, the number of input metabolites are on average higher in facultative organisms, which implies higher number of transporters. many of these additional transporters are responsible for direct import of biomass metabolites, as the number of direct imports for biomass metabolites are significantly higher for facultative organisms . this fact artificially decreases the average lmin for facultative organisms.

as a direct measure for the bow-tie-ness of a network, we study the distance between different input metabolites or between different biomass ingredients. since bow-tie networks have relatively more hub nodes than streamlined networks, the distances between different input or output metabolites in a bow-tie network expected to be less than streamlined networks. the results show significantly shorter distances between input metabolites or biomass metabolites for facultative organism rather than non-facultative ones.  this indicates the more bow-tie structure in facultative groups. however, another direct measure of bow-tie structure is the overall closeness centralization index  introduced by  <cit> . the facultative group has significantly higher occi than the non-facultative one , which is what we expect for more bow-tie structures.

there exists a connection between essential metabolic genes and structural features of the metabolic network. essential reactions are defined as reactions for which their single knock-out is lethal for the organism. only a small subset of enzymatic reactions of a bacterial metabolic network is essential for the survival in rich media  <cit> . this fact reflects the existence of a significant amount of alternative metabolic pathways in bacteria. the existence of hub nodes in a bow-tie structured network provides more connections between different pathways rather than a streamlined network. more connection between pathways increases the possibility of using an alternative pathways. we therefore expect a significant correlation between essential metabolic genes and number and degree of hub-nodes. for example, for parasites, for which the environmental condition is stable, the structure is more linear and most of the genes are essential  <cit>  but for more complex bacteria with the ability of living in many kinds of habitats like e. coli, the fraction of essential genes is low and the structure is more bow-tie like. as it is obvious from fig. 7f, facultative organisms have significantly less essential reactions than non-facultative organisms . therefore, facultative organisms have likely more alternative pathways than non-facultative organisms, which is reflected by their bow-tie structure.

CONCLUSIONS
in summary, our results suggest that an efficiency-flexibility tradeoff can shape the structure of the metabolic networks in fluctuating environments under cellular resource constraints. this finding adds a new aspect to the evolution of microbial metabolic networks. from this point of view, the low number of precursor metabolites and thus the emergence of bow-tie structure could be the consequence of maximizing the average biomass production rate and is not necessarily the exclusive consequence of a neutral evolutionary process, as previously suggested  <cit> .

it is currently believed that precursor metabolites are essential metabolites that connect catabolic pathways with anabolic pathways and their small number and their universality is a relict of evolution  <cit> . however, it can be argued that it is not necessary for the cell to rely on the existing precursors since many of them are not directly used as biomass metabolites and it is possible to bypass some of them by means of shorter alternative pathways. in fact, some of the precursor metabolites  are absent in the metabolic network of parasites like mycoplasma pneumoniae  <cit> , which lives in a more stable environmental condition. given that specialized bacteria are usually derived from generalist bacteria by genome reduction  <cit> , it is possible that a efficiency-flexibility tradeoff is an important driving force for the universality of precursor metabolites among living cells.

besides precursors, the efficiency-flexibility tradeoff might have narrowed down also other molecular alternatives in living cells. for example, one might ask why atp is the only energy carrier in the cell while some other similar high-energy content molecules could also be used as energy carriers. the hydrolysis of gtp to gdp and pi  <cit>  is an example that can provide energy comparable to the hydrolysis of atp to adp and pi. note that changes of helmholtz free energy during a reaction can vary considerably with ph, temperature, atmospheric pressure, and concentrations of reactants and products. therefore, under appropriate conditions, alternative energy carriers could provide a different quantity of energy than atp hydrolysis. the question arises why the set of possible energy carriers for metabolic reactions are narrowed down to one alternative, which is atp. our constrained optimization approach gives a possible answer: energy carriers are involved in different pathways that are upregulated under different conditions. by using a common energy source for all pathways the cell avoids extra investments that would be needed to generate different energy sources under different conditions.

the demand for accurate computational models is increasing due to their predictive power that could be used for designing synthetic organisms. in particular, many efforts have been made to improve fba for achieving more realistic results  <cit> . our approach generalizes fba to fluctuating environments that can provide a more realistic model for designing robust synthetic organisms living in fluctuating conditions. considering all known enzymatic reactions  as the universe of reactions, one could design an optimized organism under changing environments. as the growth conditions in batch or fed-batch bioreactors can change significantly over time, our approach can be used to design organisms that can adapt to these changes.

