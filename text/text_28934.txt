BACKGROUND
covalent modification of histone tails is a major epigenetic mechanism. furthermore, multiple intra-nucleosomal or inter-nucleosomal histone modifications are frequently observed within the same genomic loci. the histone code hypothesis postulates that multiple histone modifications act in a combinatorial fashion to specify distinct chromatin states, which in turn regulate gene activities  <cit> . to completely characterize the histone code is a major goal of epigenetics research.

to date, chromatin immunoprecipitation coupled with microarray chip  or deep sequencing  is the predominant experimental technology for obtaining genome-wide maps of histone modifications. however, chip-based technologies have inherent resolution limit given the fragmentation limit of chromatin dna  <cit> . recently, mass spectrometry  has been applied to effectively characterize and quantitate combinatorial histone codes within the same histone tail  <cit> . generally speaking, the ms-based approach is not yet amenable to high-throughput analysis though progress has been made constantly. given their higher resolution and more quantitative nature, combinatorial histone modifications obtained from ms-based studies provide valuable complementary information to genome-wide combinatorial histone modification analysis based on chip technologies.

using chip-based and ms-based technologies, characteristic histone modification combinations have been observed at various functional dna elements  <cit> , such as the combination of h3k4me <dig> and h3k27me <dig> at transcriptionally poised gene promoters  <cit> . collectively, these observations provide strong support to the histone code hypothesis and suggest that a diverse array of histone modification combinations is associated with a variety of dna elements  <cit> .

computational methods have been developed to reveal histone code hidden in global histone modification maps. hon et al.  <cit>  developed chromasig to find histone modification “motifs” that are repeated across the genome. jascheck and tanay  <cit>  proposed a spatial clustering algorithm to identify sets of common patterns defined over contiguous genomic regions. ernst and kellis  <cit>  introduced an hmm-based algorithm to segment the epigenome into regions with characteristic histone mark combinations. unlike above-mentioned algorithms that aim to identify combinatorial patterns involving all histone marks in the input data, ucar et al.  <cit>  proposed a biclustering-based algorithm, the coherent and shifted bicluster identification algorithm , which comprehensively searches for combinatorial patterns involving only subsets of histone marks. given that many combinatorial patterns only involve a few chromatin modifications  <cit> , cosbi is better suited for identifying subsets of re-occurring modifications given a compendium of histone modification maps. because it focuses on subsets of most correlated patterns, the resulting patterns are more precise.

the rapid accumulation of global histone modification maps represents an invaluable body of knowledge, which from a computational perspective, can be leveraged to guide a clustering algorithm, i.e. providing a limited form of supervision. such an approach is known as semi-supervised learning in the machine learning field  <cit> . traditionally, machine learning has been studied either in the unsupervised paradigm  where all the data are unlabelled, or in the supervised paradigm  where all the data are labelled. the goal of semi-supervised learning is to understand how combining labelled and unlabelled data may change the learning behavior, and design algorithms that take advantage of such a combination. semi-supervised learning is of great interest because it can use readily available unlabelled data to improve supervised learning tasks when labelled data are scarce or expensive.

here, we describe a semi-supervised version of the cosbi algorithm , which incorporates existing knowledge of histone codes into the learning process. specifically, combinatorial histone modifications observed using tandem ms is used as prior probabilities of histone mark co-occurrence and incorporated into the biclustering process.

using a set of known transcriptional enhancers and histone modifications characterized by both ms and chip-seq protocol, we demonstrate that ss-cosbi outperforms its predecessor by finding biclusters with higher enrichment of enhancers. we apply ss-cosbi to enhancers in three human cell types, b, t and embryonic stem  cells. our analysis reveals cell-type-specific preferences of histone modification states associated with enhancers. we found that genes near enhancers with the same histone modification states have highly correlated expression between b and t cells but not es cells, suggesting that histone modification states mostly potentiate enhancers but ultimately it is specific transcription factors at enhancers that determine their regulatory outcome. finally, by overlapping enhancer histone modification states with dna methylome data, we found that at es cell enhancers h3k4me <dig> significantly correlates with a higher level of dna methylation and reduced expression of nearby genes, suggesting that different combinations of histone modifications and dna methylation at enhancers could lead to distinct regulatory consequences.

RESULTS
derivation of prior probabilities of histone mark co-occurrence using mass spectrometry data
we compiled a list of  <dig> unique combinatorial histone modifications involving  <dig> modifications of histones h <dig> and h <dig> in human cells from published literature  <cit>  . each combinatorial modification is observed in a single histone tail by tandem mass spectrometry. using this list, we generated a 27 ×  <dig> co-occurrence matrix based on the ms data. to construct the co-occurrence matrix, the raw counts of histone mark pairs were normalized by the count of the most frequent pair among all histone modification pairs. figure  <dig> shows a hierarchical clustering on the rows of the co-occurrence matrix. the two apparent blocks in the dendrogram correspond to modifications within histone  <dig> and  <dig> tails, respectively. as more ms-based histone modification data becomes available, the co-occurrence matrix will become more accurate and comprehensive.

in the semi-supervised biclustering algorithm proposed here, the co-occurrence matrix derived from ms data is used as prior co-occurrence probabilities of histone modifications. in the rest of the paper, we used the 27 ×  <dig> co-occurrence matrix defined by ms data in different ways depending on the histone modifications studied. in the section “use of prior knowledge improved the quality of identified biclusters”, we constructed a 39 ×  <dig> prior co-occurrence matrix by adding zeros for histone modifications not covered in the ms data. in the section “application of semi-supervised cosbi to enhancers in three human cell types”, we extracted a 5 ×  <dig> submatrix covering the  <dig> histone modifications known to be associated with enhancers .

use of prior knowledge improves the quality of identified biclusters
we compared the performance of ss-cosbi and cosbi in terms of their abilities to identify coherent biclusters from an input genomic locus x chromatin modification x position in signal peak  matrix  consisting of functional dna elements and random genomic loci. based on the histone code hypothesis, we expect genomic loci that share functionality to have a common chromatin modification signature. in contrast, random loci would lack a consistent signature. given this assumption, an effective algorithm should be able to group together genomic loci of the same functional class along with their signature chromatin modifications. for comparison purpose, we used the dataset presented in  <cit> . it contains  <dig> high-confidence transcriptional enhancers,  <dig> random genomic loci, and the associated signals of  <dig> histone marks in human t cells.

both cosbi and ss-cosbi have four parameters: ming, mins, alpha, and beta. the first two parameters are the minimum numbers of genomic loci and histone modifications in the sought biclusters, respectively. for this benchmarking analysis, we set ming to  <dig>  and mins to  <dig> to be consistent with the previous study using cosbi. the other two parameters, alpha and beta, together determine the overall coherency of identified biclusters . to compare the performance of the two algorithms, we ran both algorithms using alpha ranging from  <dig>  to  <dig>  with a step-size of  <dig>  and beta ranging from  <dig>  to  <dig>  with a step-size of  <dig> , resulting in  <dig> parameter combinations for each algorithm. the other two parameters, which determine the minimum size of the biclusters, were kept the same for both algorithms.

to evaluate the quality of the resulting biclusters we determined the functional ‘purity’ of the identified biclusters, i.e., the fraction of enhancers present in each bicluster. to do so, we calculated a hypergeometric p-value of enhancer enrichment for each bicluster. figure  <dig> shows a comparison of the average significance of enhancer enrichment among bicluster sets generated by the two algorithms using a range of parameter combinations. ss-cosbi outperformed cosbi in terms of enhancer enrichment over the entire range of parameter settings tested. to assess the statistical significance of the enrichment p-value difference, we did a kolmogorov-smirnov test for each pair of bicluster sets of the same or similar size generated by the two algorithms. again, in all cases the difference in enhancer enrichment was significant . this comparison demonstrates that incorporation of prior knowledge in the learning process increases the purity of biclusters generated by ss-cosbi.

application of semi-supervised cosbi to enhancers in three human cell types
accumulating evidence suggests that histone modification patterns at enhancers are complex  <cit> . to gain insight into the histone code associated with enhancers, we applied ss-cosbi to three human cell types, b, t and es cells. for each cell type, we identified a set of high-confidence enhancers as p <dig> chip-seq peaks that are distal from gene promoters . the resulting sets of enhancers are mostly cell-type-specific . for histone modification, we studied the following five marks, h3k4me <dig>  h3k4me <dig>  h3k4me <dig>  h3k9ac and h3k27ac, because various subsets of these marks have been used as signatures for enhancers in previous studies  <cit> .

for this genome-wide analysis, we set mins to two since we are interested in combinatorial patterns involving at least two histone modifications. with five histone modifications, the total number of combinations containing at least two histone modifications is  <dig>  these combinations represent possible histone modification states at enhancers. after biclustering, an observed histone state was defined as the set of histone marks associated with a particular bicluster. in the rest of the paper, we used a set of codes to represent these states in a compact and meaningful way. for instance, the code m12a <dig> represents the histone mark combination of h3k4me <dig>  h3k4me <dig>  and h3k9ac. for comparison purpose, we ran ss-cosbi with parameter combinations  to obtain the same number of biclusters  and enhancer coverage  for all three cell types, respectively. in the resulting set of biclusters, enhancer coverage ranges from  <dig> % to  <dig> % . sixteen of the  <dig> histone states  are shared by all three cell types and have enhancer coverage greater than 1%.

to compare the identified chromatin states of enhancers with that of promoters, we performed the same biclustering experiment on promoters, using  <dig> most highly expressed genes in each of the three cell types. to be consistent with what we have done for enhancers, we used a 5 k bp window for promoters . the same parameter setting of ss-cosbi was used as in the enhancer analysis. additional file 2: figure s <dig> shows the percentage of promoters containing each combinatorial histone modification pattern. to compare the overall similarity of chromatin states between enhancers and promoters, we calculated pearson correlation of chromatin state distribution between the two types of dna elements, using the  <dig> chromatin states that are common to all three cell types and have enhancer coverage larger than 1% in the enhancer analysis. the correlation coefficients are  <dig> ,  <dig> , and  <dig>  for b, t, and es cell, respectively. all three correlations are not statistically significant using the theoretical distribution of pearson correlation coefficient . therefore, we conclude that the overall chromatin state distributions of our enhancer biclusters are distinct from promoters.

recently, ernst et al.  <cit>  applied a multivariate hidden markov model  to chip-seq data of  <dig> histone modifications to infer chromatin modification states associated with various types of functional dna elements, including enhancers. we compared the sets of enhancer biclusters from this study and enhancers identified using hmm in human es and b cells. among the  <dig> biclusters for both es and b cells,  <dig> and  <dig> of them significantly overlap with the set of enhancers identified by ernst et al., respectively additional file 1: table s <dig> and table s4), suggesting that both approaches can reveal histone states associated with enhancers. on the other hand, for those biclusters that do not have significant overlap with the ernst et al. set, they could mean that these are enhancer histone states that were missed by the hmm approach, highlighting the strength of the biclustering approach.

enhancers exhibit cell-type-specific histone states
as shown in figure 3a, enhancers in different cell types have characteristic distributions of histone modification states. for instance, the top three histone states are ,  and  for b, t, and es cells, respectively. furthermore, the occurrence frequencies of individual histone marks and pairs of histone marks are also different among different cell types as shown in figure 3b and c, respectively. for b and es cells, the most frequent mark is h3k4me <dig>  for t cell, the most frequent mark is h3k4me <dig>  clearly, occurrence frequencies of histone marks in enhancer biclusters are different from their genomic frequencies , consistent with the notion that these histone marks are signatures associated with enhancers. with regard to pairwise occurrence frequency, the most frequent pairs are , , and  for b, t, and es cells, respectively. for each of these histone mark pairs, their co-occurrence in enhancer bicluster is  <dig> times more frequent than what is expected based on their individual genome-wide frequencies, consistent with the combinatorial nature of these histone codes for enhancers. many histone modification enzymes are recruited to enhancers by transcription factors. therefore, the observed cell-type-specific histone codes of enhancers may reflect the activities of cell-type-specific tfs at enhancers.

correlation between enhancer histone code and gene expression
to better understand the functional difference of the enhancer classes defined based on their histone modification states, we asked if there is a correlation between enhancer histone modification state and expression level of their target genes. since identifying enhancer targets is an unsolved problem, following common practice, we used the closest refseq gene as the target of an enhancer. for each enhancer bicluster, we obtained the expression levels of all genes closest to the enhancers in the bicluster. to allow comparison of gene expression across biclusters and cell types, we applied z-score transformation of gene expression data followed by median normalization on all available genes for each cell type. figure  <dig> shows the normalized expression levels associated with different enhancer biclusters.

overall, expression levels of target genes of all biclusters are equal to or higher than the genome average, which is consistent with the role of enhancers. across all three cell types, median expression levels of target genes vary among different enhancer biclusters. furthermore, the variations are highly correlated between b and t cells . however, we only observed moderate correlations between es cells and t or b cells. the pearson correlations are  <dig>   and  <dig>  , respectively.

in summary, the above results demonstrate that multiple classes of enhancers can be defined by their histone modification states, which in turn may influence the activities of the enhancers as judged by the expression levels of their nearby genes. on the other hand, although histone modification states of enhancers can modulate their activities, it is clearly not the only determinant as indicated by the lower correlation between lymphocytes and es cells. other factors, such as tfs and nucleosome remodelling proteins also play an important role in modulating enhancer activity.

two classes of enhancers defined by h3k4me <dig> and dna methylation level in es cells
besides histone modifications, dna methylation is also found at enhancers  <cit> . however, how the two types of epigenetic marks interact at enhancers is poorly understood  <cit> . to address this issue, we first examined dna methylation levels of es cell enhancers in the biclusters, using a recently published single-base-resolution methylome map of human es cells  <cit> . we could not study b and t enhancers since the same type of data is not available for these two cell types.

consistent with a recent finding about enhancers in mouse  <cit> , we found a decreased dna methylation level at enhancers compared to random genomic loci . in addition, average dna methylation level of enhancers is negatively correlated with expression levels of nearby genes , consistent with the notion of dna methylation being a repressive marker of transcription.

next, to elucidate the interplay between dna methylation and histone code at es cell enhancers, we compared dna methylation levels of different enhancer biclusters. strikingly, we found that the different enhancer biclusters can be grouped into two classes based on their dna methylation levels . enhancers with the h3k4me <dig> mark  tend to have significantly higher dna methylation levels than those without the h3k4me <dig> mark , although for both classes dna methylation levels are lower than random genomic loci . furthermore, genes closest to class i enhancers have significantly lower expression levels compared to those closest to class ii enhancers . next, we examined the functional annotations of the genes near the two classes of enhancers using the great software  <cit> . at a fdr of  <dig> , we found that genes near class ii enhancers are highly enriched for stem cell development and maintenance and other early developmental processes. in contrast, genes near class i enhancers have fewer enriched terms that are involved in non-developmental processes .

enhancer class is defined by the presence  or absence  of the histone mark h3k4me <dig> in their histone states. to compute the median dna methylation level of a given bicluster, we first calculated a methylation level for each cpg cytosine with at least  <dig> sequencing reads as the ratio of the number of methylated reads versus the total number of reads, using the single-base-resolution methylome map by lister et al.  <cit> . next, for each enhancer region, an average dna methylation level of all cpg cytosines was calculated. finally, a median dna methylation level of all enhancers in a bicluster was then calculated. the median dna methylation level of all  <dig> es cell enhancers used in this study is  <dig> . we compared the dna methylation levels of each set of bicluster enhancers to that of all es cell enhancers used in this study using the komolgonov-smirnov test. p-values are corrected for multiple testing using the bonferroni method.

recently, pekowska et al.  <cit>  demonstrated that reduced enhancer activity is associated with the loss of h3k4me <dig> and concurrent increase in h3k4me <dig> in t cells. our result above is consistent with their observation with regard to the relationship between different h3k <dig> methylation marks and enhancer activity. furthermore, beyond histone methylation, our data suggest that there is an intricate interplay between different h3k <dig> methylation marks and dna methylation, which in turn can modulate the activities of enhancers. enhancers that are marked by h3k4me <dig> and/or h3k4me <dig> but lack h3k4me <dig> appear to have lower dna methylation levels and higher activities, and are located near genes important for early developmental processes. in contrast, enhancers marked by h3k4me <dig> tend to have higher dna methylation levels and lower activities, and are located near genes that are not involved in early development.

discussion and 
CONCLUSIONS
chip-seq and tandem ms are the two dominant technologies for mapping combinatorial histone modifications. both technologies have pros and cons. ms-based data is less noisy and more quantitative. however, it does not provide information about the histone modification status at individual genomic loci. chip-seq-based data provides information for all genomic loci but it is noisier and has a lower resolution . here, by incorporating ms-based combinatorial histone code with chip-seq data in a semi-supervised biclustering framework, we not only improve the accuracy of discovering combinatorial histone codes but also extend the utility of ms-based data by connecting them back to specific loci across the genome.

here we used ms-based data to learn the prior probabilities of histone mark co-occurrence. however, in principle, any prior knowledge about combinatorial histone modifications can be used to learn priors, including knowledge obtained using biochemical assays and published chip-chip/seq data. the latter type of data is particularly useful given the rapid and steady accumulation of chip-seq-based epigenomic maps under various conditions. however, care must be taken to avoid using the same chip-chip/seq data in a circular fashion.

the analysis presented here provides a systematic characterization of combinatorial histone codes of enhancers across three cell types. most previous studies of enhancer histone modification focused only on a subset of these five histone marks. among the five histone marks, h3k4me <dig> is the first and thus most widely used surrogate for enhancers  <cit> . however, more recent studies have demonstrated that histone modifications at enhancers are complicated, both in the number of different modifications and their combinations. besides h3k4me <dig>  h3k4me <dig>  h3k9ac and h3k27ac have been shown to mark enhancers  <cit> . more recently, even h3k4me <dig>  which is regarded by many not an enhancer marker, has been shown to mark active enhancers  <cit> . this finding is consistent with the wang et al. analysis of t cell enhancers, which also demonstrated an enrichment of h3k4me <dig> at enhancers  <cit> . a possible explanation for this apparent discrepancy is that h3k4me <dig> activity is cell type specific. clearly, more studies are needed to resolve this issue. nevertheless, in this study, we took a step further by using five histone marks reported to be associated with enhancers in various studies and focusing on their combinations, our result highlights the complexity of histone modifications at enhancers and possibly other functional dna elements. for instance, we found enhancers that have combinations of other histone marks but h3k4me <dig>  given that h3k4me <dig> is frequently observed at enhancer, this was initially a bit surprising. our additional analysis indicates these enhancers are enriched for cis-regulatory modules  and some of these overlap with enhancers predicted in ernst et al. . therefore, they are likely bona fide enhancers.

in the future, analysis of multiple epigenetic marks and comparing them across different cell types and conditions will greatly improve our understanding of how epigenetic factors affect gene expression. in addition, the biclustering framework of ss-cosbi can also be applied to study combinatorial binding of multiple transcription factors in enhancers.

