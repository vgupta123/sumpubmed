BACKGROUND
the observable downstream effect of perturbing gene expression offers clues about a gene's normal operations in the cell. the discovery of rna interference  in caenorhabditis elegans provides an efficient method for gene knock-down  <cit> . multiple efforts have systematically knocked down large numbers of genes in c. elegans and scored the consequences of their disruptions using a controlled vocabulary of predefined phenotypic descriptors . descriptors record, for example, whether a gene knock-down causes embryonic lethality, results in uncoordinated motor control, produces altered genital structures, or gives rise to sterile worms.

genes that participate in a common cellular function often yield similar phenotypic effects when knocked down  <cit> . the presence or absence of a set of predefined phenotypes constitutes the phenotypic signature of a gene, a vector of binary values that can be used to compare the observed phenotypes of one gene's knock-down to another's  <cit> . large genetic networks have been constructed for both c. elegans  <cit>  and saccharomyces cerevisiae  <cit>  in which genes are connected if they have highly similar  phenotypic signatures. previous methods have also clustered genes based on the congruency of knock-down phenotypes  <cit> . genes have been grouped together based on sharing a single phenotype  <cit> , by visually screening for highly similar phenotypic signatures  <cit> , by counting the number of shared phenotypes  <cit> , by measuring the correlation of phenotypic signatures  <cit> , and by constructing consensus phenotype profiles  <cit> . some of these methods take advantage of a potential benefit of genome-wide studies: while experimenters often focus on recording the presence of specific phenotypes, the absence of phenotypes may also provide useful information for elucidating co-functional groups of genes. although previous studies have used a variety of approaches to measure phenotypic congruency, to our knowledge a detailed evaluation of congruency metrics has not been performed. the optimal way to compare the knock-down phenotypes of genes remains an open question.

to motivate our discussion, consider the four pairs of phenotypic signatures collected from the current c. elegans dataset shown in figure  <dig>  according to the literature, gene pairs a and d contain genes that are known to be functionally related, while b and c contain genes which are unrelated. rnai of a's two ribosomal genes produces identical sets of phenotypic observations, which is expected for genes encoding subunits of the same protein complex. likewise, rnai silencing of b's unrelated genes – snr- <dig>  the small nuclear rna involved in pre-mrna splicing and clr- <dig>  a regulator of fgf signaling – produces dissimilar phenotypes. in these two cases, the similarity  of phenotypic signatures reflects the similarity  of the corresponding genes' functions.

on the other hand, there are also cases in the c. elegans dataset where the similarity of two phenotypic signatures may not correlate with the functions of their genes. for example, rnai of c's unrelated genes, his- <dig>  an h2b histone, and sqv- <dig>  a udp-glucose 6-dehydrogenase, has thus far resulted solely in 'embryonic lethality' , a common phenotype observed in roughly half of all knock-downs. in this case, although the phenotypic signatures of the genes are identical, the similarity might be purely coincidental. conversely, the phenotypic signatures for d's two related cuticle collagen-encoding genes are considerably different. however, knock-down of both genes produces two relatively rare phenotypes, 'dumpy'  and 'roller' , a combined result that is unlikely to occur by chance.

the above examples illustrate that the incorporation of phenotype background frequencies can potentially help interpret gene functional similarity from phenotypic congruency. false-positives  might be reduced by down-weighting common phenotypes, and true-positives  might be increased by up-weighting rare phenotypes.

in this paper, we systematically evaluate  <dig> standard metrics for measuring phenotype congruency. the metrics include well known vector-based similarity and distance measures, such as pearson correlation and euclidean distance. we focus on comparing information-based metrics, those that incorporate phenotypic frequency across the genome, to non-information-based metrics. we provide evidence that information-based metrics outperform non information-based metrics for comparing genes based on phenotype congruency. the top-scoring information-based metric rewards genes for shared present phenotypes  and absent phenotypes , while factoring in the background frequencies of both types of matches. we use the top-scoring measure to identify new functional gene modules in an integrated functional network. we conclude that information-based approaches show promise for integrating genome-wide phenotype data with other functional genomic data sources for both gene annotation and revealing new frontiers of genetic networks.

RESULTS
rna interference knock-down phenotype data
we collected data from three high-throughput rna interference screens  <cit> . synonymous phenotypes were merged to unite the data from these different sets . in total, we collected data measuring the presence or absence of  <dig> different phenotypes under the knock-down of each of  <dig>  c. elegans genes . this dataset has approximate genome-wide coverage, as the majority of c. elegans knock-downs  have no discernable phenotype. thus, it is important to note that the results of comparing phenotype metrics apply only to the minority of genes that produce at least one recordable rnai phenotype. phenotypic signatures were recorded in a g × v binary matrix , k, where kgv was set to one if phenotype v was observed under the knock-down of gene g and was set to zero otherwise. the full matrix of compiled rnai phenotypes is available as additional data file  <dig> 

there are several sources of noise in the data, and we expect the false-negative rate to be high, mostly due to the inherent limitations of rnai. for example, many neuronal genes are known to be refractory to rnai. a false-negative may also occur when one phenotype excludes the observation of a second phenotype. for example, embryonic lethality could preclude observing adult phenotypes such as uncoordinated motor control. as another example, a false-positive may occur when a knock-down produces an off-target effect. to compare across congruency metrics, a complete data matrix was constructed by replacing missing values with zeros. we expect this preprocessing step to introduce a negligible amount of additional noise to the data, as the false-negative rate is likely to be much greater than the false-positive rate.

the prevalence of a phenotype, or the frequency that it is recorded for knock-downs of genes in the genome, may provide important clues for predicting gene function. differences in phenotype prevalence may reflect technical differences , biological differences , or a combination of both. some phenotypes are observed for hundreds of knock-downs, while others are recorded for only a few . other factors, such as the mutual correlations of phenotypes with one another, might also have influence on their use in predicting gene function. as each phenotype congruency metric will incorporate  these sources of information to varying degrees, it is not obvious which metric is optimal for comparing genes based on their phenotypic profiles.

evaluation of phenotype congruency metrics
a good congruency metric should assign high values to functionally-related gene pairs, while assigning low values to gene pairs which are not likely to have similar function. we calculated the phenotypic congruency between all gene pairs using  <dig> different metrics , yielding a total of  <dig> , <dig> pairwise congruency scores for each metric. we evaluated each metric based on its ability to capture associations between genes belonging to the same functional group. we used a collection of functional categories as an estimate of gene functional groups . category assignments created from mutant phenotype data were excluded to avoid circularity in our evaluation. we evaluated the functional coherence of each metric at the level of individual gene-gene links and at the level of gene neighborhoods.

a: the metric type indicates whether the metric rewards for shared present phenotypes , rewards for shared absent phenotypes , factors in frequencies of phenotypes across all genes , and/or factors in pairwise co-occurrence of phenotypes across all genes .

functional coherence of metric links
we first evaluated each metric by measuring how often two genes with congruent phenotypic signatures were functionally related. for a given metric, we linked two genes if their congruency score was above a threshold. we then calculated the precision of each metric for each threshold . overall, most metrics performed better than what would be obtained by sampling gene pairs randomly . however, methods which give equal or greater weight to shared absent phenotypes  performed worse than random guessing at more stringent thresholds. for example, matchabsent , match , pcc , and upc  all perform worse than random for networks containing  <dig>  or fewer links. these results indicate that, although some information might be conveyed, shared absent phenotypes are likely to be less informative than shared present phenotypes.

information-theoretic metrics, led by the agreement score , consistently outperformed the other metrics at most levels of network size, where network size was measured either as the number of links  or as the number of genes . for example, when considering the top  <dig>  scoring gene pairs of each metric, agree resulted in gene pairs with a precision of  <dig> , which is significantly higher than previously published methods such as the phenoblast metric  and upc . an evaluation of the same metrics in saccharomyces cerevisae using genome-wide phenotype data downloaded from the saccharomyces genome database  <cit>  produced similar results . as in worm, the information-based metrics connect yeast genes more likely to share functional relatedness compared to correlation, euclidean distance, and counting based metrics.

the metric with the second-best performance was the phenoblast metric  <cit> , which first ranks genes around a query gene using the matchpresent metric, then ranks ties using the matchabsent metric, and any remaining ties by an information-based metric similar to the frequency dot product . it is likely that the phenoblast metric's ability to improve upon the matchpresent metric is due to its incorporation of phenotype background frequencies into the tiebreaking step of its scoring scheme. conversely, the upc metric  <cit>  performed poorly. as indicated by the location of the peak of the upc line, the highest upc precision was not obtained at the highest upc value. this might be due to upc linking perfectly correlated genes that share only a single frequent phenotype.

functional coherence of metric neighborhoods
the functional coherence of gene pairs may be influenced by noise in the phenotype data. in order to obtain another, possibly more robust estimate of coherence than what is obtained from individual links, the functional coherence of gene neighborhoods was also assessed. gene neighborhoods were induced for each metric by using each gene in the dataset as a query and identifying the  <dig> most similar genes. for each metric, we then plotted the number of gene neighborhoods with high precision . most metrics resulted in a similar number of high-precision neighborhoods. the agree metric resulted in the second highest number , which is eight fewer than the similar weighted agree metric. similar results were obtained when using neighborhoods of different sizes, and when comparing the mean precision across query genes instead of the number of high precision genes . agree performed substantially better than the phenoblast metric , which is implemented in an online utility for the identification of gene neighborhoods with phenotypic signatures similar to a query gene  <cit> . bootstrap estimates indicate that agree significantly outperformed the phenoblast metric , suggesting that phenoblast's ranking algorithm might be improved by using the agree metric instead of its current approach.

investigation of the advantages of information-based metrics
information-based metrics reward gene pairs for sharing both present and absent phenotypes while factoring in their background frequencies. to understand why these metrics produced higher functional coherence, we identified example gene pairs where the information-based measures produced high similarity while the correlation-based approach produced low similarity, and vice versa.

gene pairs illustrating each case are shown in figure  <dig>  consider again the functionally-unrelated gene pair his- <dig> and sqv- <dig> , which share only the frequently-occurring 'embryonic lethal' phenotype. this pair receives a poor agree score , while it receives the best possible upc score. this illustrates that the incorporation of background frequencies may help to reduce false positive gene pair associations. conversely, the phenotypic signatures of sqt- <dig> and dpy- <dig>  two related collagen-associated genes, have several mismatches . nevertheless, the agree metric ranks the pair in the 99th percentile , because the genes share two relatively rare phenotypes: 'dumpy'  and 'roller' . in contrast, this gene pair is assigned a poor rank by upc . this second example demonstrates that the incorporation of phenotype background frequencies can help in the identification of true-positives. thus, the combination of reducing false-positives by down-weighting frequent phenotype coincidence and reducing false-negatives by up-weighting shared rarely occurring phenotypes may contribute to the ability of information-based methods to identify functionally similar gene pairs.

the differences in performance of the various metrics may be due to their use of properties of the phenotypes which vary in their ability to predict shared gene function. different metrics may make either explicit or implicit use of such properties in their ability to connect functionally-related genes. to gain insights into what makes one metric better than another, we considered three properties and found that the frequency of shared function between two genes 1) increases with increasing number of shared present phenotypes; 2) increases with increasing number of shared rare present phenotypes; and 3) is unaffected by correlations between phenotypes .

network topology comparison
based on its high performance relative to the other information-based metrics, we chose the agree metric to help provide novel insights into the systems biology of c. elegans. we compared a phenotype congruency network constructed using the agree metric  to a network constructed with a previously published method. in a recent study, gunsalus and colleagues demonstrated the utility of combining phenotype congruency with other high-throughput data for the identification of 'molecular machines'  <cit> . the authors constructed a upc-induced phenotype congruency network  by linking gene pairs with upc values of  <dig>  or higher. due to our larger dataset, a upc threshold of  <dig>  results in a network in which a quarter of all possible gene pairs are connected, which is not specific enough for practical use. therefore, we constructed the unet by linking genes with upc scores exceeding  <dig> , which corresponds to a upc significance of p <  <dig>  . we chose an agree threshold such that the same number of gene pairs  was included in the anet. the resulting networks have precisions of  <dig>   and  <dig>  .

we first compared general topological features of the networks. we found that the anet and unet exhibit different connectivity. on average, genes in the anet are linked to  <dig> other genes , while genes in the unet are linked to  <dig> other genes . the anet is comprised of one large connected component containing  <dig>  genes, and six smaller connected components containing the remaining seventeen genes. in contrast, the unet is comprised of a large connected component, containing  <dig> genes , and  <dig> smaller components, all but eight of which are fully connected.  <dig> of the fully-connected unet components  consist of gene pairs with identical phenotypic signatures that contain only a single knock-down phenotype, which results in a perfect upc score. for example, the largest connected components include a component of  <dig> genes whose knock-downs result solely in an 'embryonic lethal'  phenotype, a component of  <dig> genes with only a 'slow post-embryonic growth'  phenotype, and a component of  <dig> genes with only an 'uncoordinated'  phenotype. these gene pairs which share only a single frequently-occurring phenotype are unlikely to be co-functional, as evidenced by the precisions of these connected components .

we next sought to compare the number of shared present phenotypes between genes linked in the anet and unet. to quantify this, we define the complexity of a link to be the total number of present phenotypes co-induced by a pair of genes. we refer to a link with a complexity of two or more as a complex link, and otherwise a simple link. we found that the anet connects genes exhibiting a higher number of phenotypes than genes connected in the unet . most of the links in the anet are complex , while most links in the unet are simple . the anet contains a total of  <dig> simple links , where each simple link connects genes sharing one rare phenotype . conversely, there are  <dig>  simple links  in the unet. almost two-thirds  of these links connect genes sharing the 'embryonic lethal' phenotype . we also measured the complexity of the unet after removing simple links from consideration. the resulting unet still contained links with lower complexity than the anet . additionally, for each level of complexity, the anet contains gene pairs with higher precision than the unet . these results indicate that agree not only identifies links of higher complexity, but also links of greater biological relevance.

the networks induced by agree and upc are orthogonal, having little overlap in their gene pairs . these shared links have a precision of  <dig> . the links unique to the anet have a precision of  <dig> , whereas links unique to the unet have a precision of  <dig> , which is significantly less than the precision of the shared links . taken together, these results indicate that the agree metric not only identifies many gene associations that are missed by the upc metric, but also finds associations that are of an overall higher quality.

while the set of gene pairs in the anet and unet are different, it was still possible that the metrics brought genes into proximity from the same pathways, albeit through different gene pairs. however, we found that pathways containing high-scoring agree gene pairs are largely not the same as the pathways containing high-scoring upc gene pairs. we created a non-redundant set of functional categories from our evaluation set, and calculated the significance of the pairwise scores of its gene members for each category using the agree and upc metrics . this calculation assigns high scores to categories whose gene members have significantly similar phenotypic signatures according to the metric. figure  <dig> plots the highest significance achieved for each non-redundant category using each metric. overall, three housekeeping-related categories were enriched for high scores using both metrics:'ribosome', 'rrna metabolic process', and 'protein-rna complex assembly.'  <dig> classes were exclusively enriched for agree, and  <dig> were enriched only for upc . overall, the agree metric captured several categories involved in development and cell structure, while the upc metric identified categories involved in translation and other protein expression-related activities. thus, the genes that are brought into proximity by the two metrics largely belong to complementary biological processes.

comparison of subnetworks
decomposing large interaction networks into their constituent subnetworks has proven useful for the elucidation of genetic pathways  <cit> . as the majority of links in the anet and unet connect different pairs of genes, we investigated how the different link content of the networks could influence subnetwork identification, which in turn could influence the prediction of functional modules. to detect subnetworks, we used the modes algorithm  <cit>  , and identified a total of  <dig> anet subnetworks and  <dig> unet subnetworks. anet subnetworks contained  <dig> genes on average , while unet subnetworks were smaller, containing  <dig>  genes. for each unet subnetwork, we determined if its genes had a significant number of links in the anet. the density of the links within a subnetwork was assessed using a connectivity score calculated as the fraction of links connecting the genes of the subnetwork out of the total possible number of such links. the significance of the score was estimated for each subnetwork size using a random sampling procedure .

as expected, the anet and unet share many small , low-complexity  subnetworks in which the genes share one or two rare phenotypes. even though the number of shared subnetworks amounts to half  of the subnetworks identified in the unet, the total fraction of network links included in these subnetworks is small . the subnetworks unique to the unet are much larger  and lower in complexity , whereas the majority of anet subnetworks are enriched for five or more phenotypes . the overall difference in complexities is significant based on bootstrap resampling . thus, both the anet and unet produce a similar number of small subnetworks of genes sharing a single rare phenotype. however, the majority of genes and links in the unet reside in large subnetworks that are not well-connected in the anet.

integration into a c. elegans genetic network
previous studies have demonstrated the utility of combining phenotype congruency data with other data types in order to identify functional relationships  <cit> . we investigated how the anet integrates with other data types, including interactions based on coexpression, protein-protein interactions, and a compendium of low-throughput genetic interactions . to this end, we took the union of all of these interactions with the anet links to create a superimposed agree network . in an identical manner, a superimposed upc network was constructed using unet links.

we first investigated agree's ability to identify gene associations supported by other data sources and found that significantly more anet links were multiply-supported links  compared to unet links . furthermore, the anet performs comparably to, or better than, the unet for each data type considered separately . in a manner similar to the approach by gunsalus et al.  <cit> , we restricted our analysis to multiply-supported links. this revealed that only  <dig> of  <dig>  multiply-supported anet links were also supported by unet links. the  <dig> multiply-supported anet links have a precision of  <dig> , while the  <dig> multiply-supported unet links have a precision of  <dig> . thus, the multiply-supported anet contains gene interactions that are different from, but of higher quality than, the multiply-supported unet.

we next searched for gene modules composed of multiple data types that are undetectable using the upc metric. we first identified multiply-supported subnetworks  using previously published methods  <cit>  . a total of  <dig> agree and  <dig> upc mssns were identified with phenotype congruency links as one of the enriched link types . many of these mssns represent functionally coherent gene groups, as  <dig>  agree mssns and  <dig>  upc mssns are enriched for at least one category in our validation set .  <dig> of the agree mssns represent novel gene combinations with respect to the upc metric . all of these unique subnetworks are enriched for at least one functional category, indicative of their potential in the discovery of novel gene modules.

module mssn <dig>  contains ten genes, seven of which are annotated as being involved in ribosomal biogenesis. many of the genes in this module are components of the core translational machinery. other genes in the module are predicted to be necessary for ribosome synthesis, including byn- <dig>  <cit> , k07c <dig>   <cit> , and eif- <dig> f  <cit> . furthermore, two of the three genes that are not annotated with ribosomal function or biogenesis are predicted to be involved in translation. hrs- <dig> is a predicted histidyl-trna synthetase, and cct- <dig>  is a cytosolic chaperonin involved in folding of nascent proteins  <cit> . since many developmental pathways are regulated by translation, it is not surprising that disruption of the genes in this module results in multiple severe phenotypes such as 'sterile', 'embryonic lethal', 'larval arrest', 'slow growth', and 'sick'. thus, the agree metric correctly identifies components of the translational machinery which the upc metric is unable to identify, due to the multiple phenotypes of the genes in this module being present in slightly differing combinations.

we also identified modules of densely connected genes in the multiply-supported superimposed network using a module discovery method similar to the method used by gunsalus and colleagues to detect 'molecular machines'  <cit> . we identified a total of  <dig> molecular machines, and labeled them with the prefix 'mm' . module mm <dig>  contains seven body morphology-related genes with similar phenotypic signatures supported by multiple functional sources. three of the genes in the module, sma- <dig>   <cit> , sma- <dig>   <cit> , and sma- <dig>   <cit>  are tgf-β pathway components that play a role in body size and male tail development. both gei- <dig> and pdi- <dig> , are thought to regulate tissue morphology  <cit> . the presence of the 'small' phenotype and, importantly, the lack of other common phenotypes, enables agree to connect genes that regulate different aspects of morphology which are missed by upc. upc fails to connect most of the sma genes because some of them are also annotated with the 'dumpy' phenotype, and others are not.

finally, we estimated the predictive influence of adding phenotype congruency links to the integrated c. elegans network of lee et al.   <cit> . we found that the log-likelihood scores  placed significantly more weight on the agree-derived links, as compared to the upc-derived links .  <dig> agree links were above the lls cutoff of  <dig> , and would therefore be included into the lee et al. network. in contrast, none of the upc links have sufficiently high lls scores on their own to merit inclusion. nearly all of the agree links  represent new connections into the lee et al. integrated network. thus, the phenotypes provide a small, but appreciable set of new connections not elucidated by the combination of the other data sources.

discussion
we compared the ability of several metrics to connect functionally related genes using high-throughput rnai knock-down phenotype data. we found that the agreement score  performed better than  <dig> other metrics in this regard. additionally, with respect to the previously published upc metric, the phenotype congruency network induced by the agree metric connects genes with more shared phenotypes, and contains more links that are supported by additional data sources.

while the agree metric outperforms the metrics tested in this study, the results provide information about how it could be improved upon. for example, although the frequency of a phenotype does carry some information, placing too much weight on rare phenotypes may lead to erroneous functional predictions. this may explain why agree outperformed the similar information-based metric symmetric frequency dot product . to illustrate, let idfv be the inverse document frequency of phenotype v. the component of the agree metric that rewards for shared present phenotypes is a sum over the set {idfv}, while sfdp is a sum over {idfv2}. our results indicate that squaring the inverse frequencies may over-emphasize rare phenotypes. thus, the exponent in the summation could be parameterized to give the generalized sum over the set {idfvp}. for example, using this notation, match corresponds to p =  <dig>  the observation that match outperformed sfdp indicates that one might find an improvement over the agree metric by optimizing p between  <dig> and  <dig>  likewise, a corresponding parameter could be optimized for the component of agree which rewards for shared absent phenotypes.

recently, approaches inspired by natural language processing  have been applied to a range of biological problems . in this study, the task of finding related genes based on common phenotypic consequences can be likened to the task of identifying similar documents based on the presence and absence of particular words. other studies have proposed nlp-based methods for protein interaction prediction , protein subcellular localization prediction  <cit> , prediction of gene function , go-based protein semantic similarity calculation  <cit> , and the identification of candidate genes for complex traits  <cit> .

for this study, we focused on the analysis of high-throughput rnai phenotype data in c. elegans. such data is currently also being generated for other species, most notably in s. cerevisiae  and d. melanogaster . our results on s. cerevisiae  suggest that metrics such as the ones evaluated in this paper may be useful for analyzing data from other species.

finally, all of the metrics evaluated in this study are limited in the sense that they treat phenotypes as vectors, ignoring any known or latent relationships that may exist among the phenotypes. rather than use binary presence/absence calls, comparisons could make use of quantitative values representing "strengths" if replicates of gene-phenotype observations are available either within or across studies. additionally, the introduction of more formal knowledge representations for c. elegans that describe is-a or part-of relations among phenotypes, such as the mammalian phenotype ontology  <cit> , may allow comparisons that incorporate semantic structure such as the work by pesquita et al.   <cit> .

CONCLUSIONS
with the maturation of rnai technology, it is now possible to knock down genes in a high-throughput manner. we found that an information-based measure, which we call the agree metric, outperforms other tested metrics and that its use in the construction of a superimposed network containing data from several sources results in high quality predictions, many of which go undetected using other methods. other measures of phenotype congruency that we did not test may outperform those tested in this study. our results indicate that metrics borrowed from the field of natural language processing may prove useful in this domain. we suggest that metrics which incorporate the frequency of shared phenotypes, such as the agree metric, should be used in place of unweighted correlations for functional genomics analyses involving rnai knock-down data.

