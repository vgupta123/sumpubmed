BACKGROUND
in high-throughput non-electrophoretic proteomics complex mixtures of proteins are subjected to proteolytic digestion with an enzyme such as trypsin before the fragments are separated by liquid chromatography  and analyzed by tandem mass spectrometry. however, for a particular protein, only a portion of the peptides are actually observed experimentally and the set of peptides that are observed from a single protein can vary substantially from one experiment to another. a number of factors contribute to the inability to detect some peptides and to variations in the peptides that are detected from one experiment to another. these include incomplete proteolytic digestion, small size, poor binding or elution from the type of lc column used, the limited mass range that can be detected by the mass spectrometer, bias toward detecting peptides with an intense ms signal in mixtures, the phenomenon of "ion suppression", the charge prior to ionization, and non-covalent interactions between peptides in the gas phase while in the mass spectrometer  <cit> . in addition, are substantial differences in the peptides observed due to variations in the protein extraction and or solublization methods, tissue types, prefractionation, lc separation conditions, and differences between gradients even when the same lc separation conditions are used. furthermore, different databases, different search software and even different versions of the same software also influence which peptides that are detected.

we refer to peptides that can be detected as "flyable". the fact that most proteins in a complex mixture are represented by only a small number of proteolytic peptides presents several difficulties for proteomics researchers  <cit> . these problems include assessment of the level of confidence in protein identifications  <cit> , determining the peptide coverage of proteins  <cit> , determining if "missing" proteins are potentially observable  <cit> , and using peptide observability as an adjustment factor for protein quantification based on observed peptides  <cit> . recently reported methods for predicting peptide observability have been based on large training datasets from multiple experiments dealing with a single organism  <cit> . however, because the observability of peptides depends not only on the properties of the peptides themselves but also on specific experimental, instrumental, and analytical procedures, we contend that it is necessary to provide a method for predicting peptide observability for a specific experimental set at the local level. this ability to construct a classifier for a particular dataset is particularly important for researchers who work in smaller laboratories, deal with a variety of organisms and/or tissues, employ a variety of protein extraction protocols, and/or who use a centralized facility for proteomics where they have little control over instrumental and analytical protocols.

here we describe a method for constructing a classifier for a proteomics data set that can predict peptide observability for a particular set of experimental conditions. we demonstrate that the classifiers constructed using this method provide critical information for assessing the validity of protein identifications and valuable evidence to support competing hypotheses about the presence or absence of "missing" proteins in a pathway of interest.

the set of tryptic peptides that are observed under experimental conditions can be divided into two classes – proteotrypic and flyable. proteotrypic peptides are those experimentally observable peptides that can be used to uniquely identify a protein, while flyable peptides are all peptides that are experimentally observable but may not be proteotrypic  <cit> . proteotypic peptides are a subset of flyable peptides and flyable peptides are a subset of all possible tryptic peptides. the spectra generated by mass spectrometry analysis of a complex peptide mixture are matched against theoretical spectra generated from an in silico trypsin-digested protein database. the resulting set of peptide identifications is then used for protein identification. by definition, detection of at least one proteotypic peptide is required for protein identification.

there is, however, disagreement among researchers about the number of peptide matches and the peptide coverage of the protein that are required for an identification to be considered valid. protein identifications based on a single proteotypic peptide  are often viewed with skepticism. some researchers contend that a protein identification needs at least two proteotypic peptides to be valid, while others contend that a single high quality peptide can be used for identification purposes  <cit> . furthermore, some proteins produce only one proteotypic peptide. in addition to the number of peptides identified, the degree of coverage of the protein by peptides may also be used as a measure to assess the validity of the identification – this is typically provided in terms of the percentage of amino acids in the protein "covered" by identified peptides. however, an additional and more meaningful statistic is the percentage of potentially detectable peptides that are observed. this information has the potential to increase  the credibility of some single proteotypic peptides for identification and can prevent loss of important data  <cit>  or the inclusion of erroneous identifications.

researchers using proteomics are interested in not only cataloging proteins present, but also in studying the location and differential expression of the proteins involved in biochemical pathways  <cit> . often, one or more proteins referenced to participate in a canonical pathway are not observed in a proteomics dataset, but most other proteins in the pathway are present  <cit> . conversely, a protein that has never been identified in that pathway may be identified by a single proteotypic peptide. in the first case, it is important to know whether these missing proteins generate a sufficient number of potentially observable proteotypic peptides to support identification under the specific experimental conditions or whether the protein truly appears to be absent. in the second case, it is important to determine if a protein may reasonably be expected to be identified by only one peptide under the experimental conditions – an identification of a protein with a single peptide where the protein is predicted to produce many observable proteotypic peptides should be viewed with suspicion.

two recently published papers describe methods for the prediction of peptide detection using mass spectrometry, but their methods are distinct from ours. mallick et al.  <cit>  have compiled a large training set from multiple yeast proteomics experiments and built gaussian mixture discriminant function predictors for a number of different proteomics platforms. their goal is to characterize the general properties of peptides that can be detected using different proteomics technologies, to determine the coverage of the predicted proteome that is detectable using different technologies, and they also argue that their method can be used to improve protein quantification. lu et al.  <cit>  describe a classifier for predicting peptide observability that is a component of a method for absolute protein quantification and that adjusts scores for protein abundance based on the predicted detectability of in silico generated tryptic peptides. in contrast, our procedure is specifically developed for generating a classifier for a single data set to predict flyable peptides for a particular set of experimental conditions  and to be applied locally. we demonstrate that the resulting classification provides valuable information with regard to peptide coverage of a protein and can assist the proteomics researcher in a systems analysis of the dataset.

RESULTS
we have developed a procedure for building a classifier to predict peptide flyability from a proteomics dataset. the output of the protein identification algorithms for a proteomics dataset includes the proteins that were identified and the peptides that were used for each protein identification. as figure  <dig> illustrates, the classifier construction process includes selection of a set of observed and unobserved peptides for the training set, extraction of features to represent the peptides in the training set, normalization of the feature values, feature subset selection, and training and testing of the classifier.

training set compilation strategy
the first step in the process is selection of a set of peptides for the training data set. the naïve approach is to use all observed peptides for the positive examples and all non-observed in silico generated peptides from identified proteins for the negative examples. however, this approach ignores several complications that arise when processing proteomics datasets. first, some of the "observed" peptides will be false positive identifications. the probability that a peptide is a false positive identification is greatly reduced if it is one of multiple peptides used to identify a protein since the probability of this occurring by chance is small  <cit> . therefore, we limit the positive examples to the peptides associated with proteins that were identified using multiple unique peptides. peptides chosen for negative examples are also limited to the set of proteins identified by multiple peptides. however, selection of negative examples is also complicated by the fact that the number peptides observed for a protein is directly related to protein abundance in the sample. isotope-free quantification methods for proteomics datasets make use of the relationship between the number of peptides observed and protein concentration  <cit> . to avoid the problem of labeling peptides that were not observed as negative examples because they are associated with low abundance proteins, we have chosen to compile the negative examples from the proteins that were identified with the largest number of peptides. although this introduces a bias for peptides from abundant and large proteins, this strategy insures, to the extent possible, that the peptides used for negative examples were present in sufficient quantity to be potentially observable. we have developed the following procedure for selection of the training set to ensure that the peptides selected for the class of observable peptides are high confidence identifications and that the peptides selected for the negative examples are truly "unobservable" under the specific experimental conditions.

 <dig>  rank the protein identifications by the number of peptides used in the identification and include only identifications based at least two distinct peptides.

 <dig>  retrieve the amino acid sequence for each of the proteins in step  <dig>  perform in silico trypsin  digestion of the proteins, and compile a list of all predicted tryptic peptides of length greater than  <dig> amino acids .

 <dig>  if a peptide is present in the experimental data, it is assigned a value of  <dig> and if it is not observed in the experimental data it is given a value of  <dig>  there will be many more with a value of  <dig> than with  <dig> 

 <dig>  the peptides labeled with a  <dig> in the previous step are used as the positive examples in the training set. suppose the size of this set is n. in order assure that peptides used as negative examples were present in sufficient quantity for detection and to also help produce a balanced training set, we select the first n "unobserved" peptides from the proteins ranked by the number of peptides used for identification.

feature generation and classifier construction
our approach for generating features to represent each peptide in the training set uses both the features listed in table  <dig>  and features constructed using properties from the aaindex  <cit> . the first set of features  includes basic properties of the peptide  and features related to the amino acid composition of the peptide. the aa index is a compilation in a set of tables of  <dig> different indices used to characterize amino acids. it includes indices for wide variety of characteristics of amino acids including hydrophobicity, participation in certain types of structures, etc. a feature value was generated for each peptide for each index representing the sum of the index values for all amino acids in the peptide. combination of feature set  <dig> and the aaindex features results in a total of  <dig> features for each peptide. although this set includes a large number of redundant features, we have shown that using both sets as input for the feature selection process yields improved classifier performance over use of each feature set alone. for example, with the avian bursal dataset described below, the 10-fold classification accuracy of neural networks built with the aaindex features only is 72%, with feature set  <dig> only is 71%, and with both feature sets is 81%. because the values of the features cover a wide range of numeric values, nv normalization is used to make the numeric range of all features 0– <dig>  feature subset selection is then performed to find the set of feature most relevant to the task of predicting flyability and to remove redundant and non-informative features. we use a feature selection method that performs a greedy search through feature space to identify features based on the level of consistency with class values when the training data is compared to the entire set of attributes  <cit> . the reduced set of features is used to train the classifier. a 3-layer neural network classifier is constructed with an input unit for each of the selected features, / <dig> hidden units where i is the number of input units, and a single output unit. the neural network is trained using the training set constructed with the strategy described above and tested using 10-fold cross validation. multilayer neural networks provide a robust method for learning a functional mapping from numeric attribute values to a class value – in this case a mapping from numeric features describing the peptide to the classes "observable" and "unobservable."

a feature selection procedure is used to reduce dimensionality prior to classifier construction.

in order to demonstrate the utility of our approach, we have used the methodology described above to build classifiers for two different published mudpit data sets: 1) an avian bursa of fabricius data set consisting of  <dig> proteins  <cit> , and 2) a hodgkin's lymphoma model data set consisting of  <dig> proteins  <cit> . the classifiers built using our procedure had 10-fold cross validation classification accuracies of 81% and 72% respectively. table  <dig> lists the features selected that best distinguish observed peptides from unobservable peptides for both datasets. table  <dig> reports the accuracy and confusion matrices for the neural networks for both data sets based on 10-fold cross validation.

the features selected tend to be related to structural properties of the peptides. for example, consider the features selected for the avian bursa classifier. prolines tend to break alpha helices and prolines located adjacent to lysine or arginine also interfere with trypsin digestion. amino acids with small side chains such as glycine and alanine increase the flexibility of the peptide. the charge, polarity, hydrophobicity, and the behavior of the peptide in solvent also influence flyability.

our classifiers achieved classification accuracies comparable to the rates reported by mallick et al.  <cit>  and lu et al.  <cit>  for much simpler yeast systems. the accuracy statistics reported by mallick et al. are difficult to compare to ours because they report specificity in terms of  where the positive predictive ratio is defined as ) rather than the more traditional true positive ratio . lu et al. report a 69% true positive rate for observed and a 90% true positive rate for non-observed. note that it is possible to achieve an 82% true positive rate for the non-observed class for their classifier by guessing non-observed in every case. in addition, they include very small peptides  in their analysis and we exclude peptides of this length from our study because of the high probability of random matches to multiple proteins and their lack of power as unique identifiers.

in order to evaluate the importance of building classifiers that are specific for a particular dataset, we tested each of the classifiers above with the data used for training the other classifier . the results  demonstrate that there is a substantial loss of classifier accuracy when using a classifier trained with one data set to predict peptide observability with the other data set. in both cases, the true positive rate  decreased dramatically . these results are consistent with those reported by mallick et al.  <cit>  when a classifier trained with yeast data was used to predict observability with human data. these results clearly demonstrate the need for classifiers to be trained for each experimental set.

we use the two classifiers described above for the avian bursa dataset and the hodgkin's lymphoma model dataset to demonstrate the utility of the classifiers for calculating an informative peptide coverage statistic for proteins and for analysis of system's biology datasets. in table  <dig>  for a subset of proteins that were observed in the data, the total number of tryptic peptides generated by in silico tryptic digestion, the number observed, the number of peptides predicted to be detectable by each classifier, and the amino acid coverage both in terms of the total number of tryptic peptides and in terms of those predicted to be observable. as expected, in most cases the amino average coverage for peptides predicted to be detectable is higher, sometimes substantially higher, than the total amino acid coverage. in general, this approach allows the researcher to determine how many peptides might reasonably be expected to be detected.

1) for the avian bursa dataset,  <dig> randomly selected observed proteins and the dr <dig> protein that was expected but not observed. 2) for the hodgkin's lymphoma model dataset,  <dig> proteins that were observed in the pathway under consideration and  <dig> that had been observed using other methods in previous experiments but not observed in this dataset.

we have also used the bursal neural network and the hodgkin's lymphoma model neural network to determine if proteins that are "missing" from a pathway of interest are likely to be potentially observable. the results are given in table  <dig>  as mccarthy et al.  <cit>  reported, most components of the programmed cell death pathway with known orthologs in chicken were observed in the avian bursa data set with the exception of the protein dr <dig>  the peptides produced by in silico tryptic digestion of dr <dig>  were used as input to our neural network for this data set. as shown in table  <dig>  none of the peptides for this protein were predicted to be observable. in contrast, for proteins that were observed, the average number of observable peptides was  <dig>  for the hodgkin's lymphoma model dataset, there were five proteins that we expected to observe because we have observed them using other methods in other experiments  <cit>  but we did not see them in this experiment . the results in table  <dig> show that none of the tryptic peptides for these proteins is predicted to be observable under the given experimental conditions while a set of proteins of similar size that were observed were predicted to be observable. although these results cannot be used to demonstrate conclusively that a protein does or does not exist in a data set, they can be used as one piece of evidence to confirm or refute a hypothesis about the presence of a protein under certain conditions and to plan further wet lab experiments.

CONCLUSIONS
we present a procedure for constructing a classifier to predict which tryptic peptides in a protein are likely to be detectable by mass spectrometry for a specific set of experimental and instrumental conditions. we demonstrate that it is possible to construct a classifier with accuracy comparable to those previously reported based on the accumulation of large training sets from multiple experiments. we also show that a classifier constructed based on one dataset does not perform at an acceptable level when predicting observability for another dataset and thus it is necessary to construct classifiers that are specific for one set of experimental conditions. the resulting classifier provides researchers with a tool that can provide information about peptide coverage of proteins in terms of which proteins are likely to be detectable. it can also be used as one line of evidence in a systems analysis to evaluate alternative hypotheses concerning proteins that were not observed but that were expected. if the "missing" protein generates many predicted detectable peptides but none were observed, then this provides additional probabilistic evidence of absence of the protein – a very difficult hypothesis to demonstrate conclusively. the classifier allows researchers to distinguish between proteins that are not likely to be detected with the methodology versus proteins that were not expressed in the biological system. only by making this distinction is it possible to accurately interpret proteomics results and improve biological modeling.

