BACKGROUND
for biological systems on different levels of organization, the same broadly defined phenotype can usually be formed by more than one genotype. examples include rna, where many genotypes  share the same secondary structure phenotype  <cit> ; proteins, where multiple amino acid sequences form the same fold  <cit> ; regulatory circuits, where many genetically encoded circuit topologies can form the same expression pattern  <cit> ; and metabolism, where multiple metabolic genotypes, encoding different combinations of chemical reactions, can confer viability on the same spectrum of nutrients  <cit> . the number of genotypes with the same phenotype is usually astronomical. for example, it can exceed  <dig> for moderately long rna molecules of  <dig> nucleotides with the same secondary structure  <cit> ; it has been estimated at  <dig> for proteins that adopt a fold characteristic of the bacteriophage λ transcriptional repressor  <cit> , and at more than  <dig> for model regulatory circuits of  <dig> genes that form a given gene expression pattern  <cit> .

the many different genotypes that share one aspect of their phenotype may differ in other aspects, such as the thermodynamic stability of a given rna or protein fold, the resilience of a gene expression pattern to stochastic noise, or the robustness of a metabolism to deletion of genes that encode metabolic enzymes  <cit> . because such properties can be important for the biological function of any one system, the question whether they can be “fine-tuned” in evolution is important  <cit> . such fine-tuning may depend on whether one can start from any one genotype with a given phenotypic property and reach most other such genotypes through sequences of small genetic change.

whether such fine-tuning is possible can be studied in the framework of a space of possible genotypes, where two genotypes are adjacent if they differ by the smallest possible genetic change, such as a single amino acid change in two proteins. in this framework, the question becomes whether a set of genotypes with the same phenotype forms a single connected genotype network , or whether this network fragments into multiple isolated subnetworks or disconnected components <cit> .

whenever such fragmentation occurs, the constraint it imposes on genotypic change does not only affect the ability to modulate a phenotype. it also gives an important role to historical accidents in the evolutionary process: the genotype with a given phenotype that evolution happened to have “discovered” first can determine the number and identity of other genotypes reachable through gradual genetic change. and by restricting the number of accessible genotypes, fragmentation can also restrict the spectrum of novel phenotypes accessible as new adaptations. the reason is that this spectrum depends strongly on a genotype’s location in genotype space  <cit> . the further evolution can “walk away” from a given genotype, the more the spectrum of accessible phenotypes changes  <cit> . in sum, fragmentation of a genotype network can cause historical contingency and restrict a system’s potential for future evolutionary change.

existing work, based on computational models of phenotype formation, shows that fragmentation is system-dependent. for example, in rna secondary structure phenotypes, genotype networks are typically highly fragmented  <cit> , whereas for regulatory circuits, such fragmentation depends on the kind of circuit studied, its size, and how one defines its gene expression phenotypes  <cit> . because the question has thus far not been answered in metabolic systems, we here analyze the connectedness of a space of metabolisms.

a metabolism is a complex network of chemical reactions, catalyzed by enzymes and encoded by genes, whose most fundamental task is to synthesize multiple small molecule precursors for biomass, such as amino acids, nucleotides, and lipids  <cit> . an organism’s metabolic genotype is the part of a genome that encodes metabolic genes. it is thus fundamentally a string of dna, but can be represented more compactly as a binary vector of length n, where n is the number of metabolic reactions in a known “universe” of metabolic reactions . this universe comprises all enzyme-catalyzed reactions known to take place in some organism. the i-th entry of this vector corresponds to the i-th reaction in a list of such reactions, and for any one organism, the value of this entry is one if the organism can catalyze the i-th reaction, and zero otherwise. on evolutionary time scales, the reaction complement of a metabolism can change through processes such as horizontal transfer of enzyme-coding genes, gene deletions, as well as gene duplications followed by sequence divergence.

the known “universe” of metabolism currently comprises more than n =  <dig> reactions  <cit> . this means that there are more than  <dig> different metabolic genotypes, which constitute a vast space of possible metabolisms. for any one metabolism in this space and any one chemical environment, one can compute the spectrum of biomass precursors that it can synthesize using the constraint-based computational method of flux-balance analysis . we call any one metabolism viable in a specific chemical environment, if it can synthesize every single one in a spectrum of essential biomass precursors from nutrients in this environment  <cit>  . we will here consider minimal chemical environments that contain only one carbon source, such as glucose, as the sole carbon source.

because connectedness of a metabolic genotype network may depend on the number n of reactions in a metabolism, we distinguish in our analysis metabolisms of different sizes. if Ω is the set of all metabolisms with n biochemical reactions  and if v is the subset of all viable metabolisms, we are interested in whether v is connected. because the metabolisms of free-living heterotrophic metabolisms may have thousands of reactions, we need to study v for metabolisms this large. this is not an easy task, because the set of viable metabolisms is so enormous that exhaustive enumeration is impossible  <cit> . therefore, to sharpen our intuition and to illustrate key concepts, we first analyze a smaller metabolic genotype space whose viable metabolisms can be enumerated exhaustively. this is the space of metabolisms that can be formed by subsets of n =  <dig> reactions in central carbon metabolism  <cit>  . even though central carbon metabolism is highly conserved, its reaction complement varies in nature, for example through variants of glycolysis  <cit>  and the tricarboxylic acid cycle, where some organisms have an incomplete cycle  <cit> . we go beyond such naturally occurring variation and analyze metabolisms comprised of all possible subsets of all  <dig> reactions. even though this number of metabolisms is astronomical , we were able to determine viability for all of them, and thus analyze the connectivity of v for all n ≤ n . after that, we turn to larger, genome-scale metabolisms, where we study the connectivity of v through a sampling approach. as many of the metabolisms used in our analysis may not be realized in extant organisms, we also refer to them as potential metabolisms.

our observations show that for all but the simplest metabolisms, those that contain close to the minimal number of reactions necessary for viability, most viable potential metabolisms v lie on a single connected genotype network. where fragmentation into different components occurs, its biochemical cause are alternative biochemical pathways that occur in different components, that are essential for the synthesis of specific biomass precursors, that comprise more than one reaction, and that cannot be transformed into one another by changes in single reactions without destroying viability. because such pathways only occur in the smallest potential metabolisms, fragmentation and thus historical contingency do not strongly constrain the evolution of properties such as robustness, biomass synthesis rate, or the accessibility of novel metabolic phenotypes.

RESULTS
study system 1: central carbon metabolism
our first analysis focuses on potential metabolic genotypes that can be formed with subsets of n =  <dig> reactions in the central carbon metabolism of e. coli <cit>  . this metabolic core of e. coli includes reactions from glycolysis/gluconeogenesis, the tricarboxylic acid cycle, oxidative phosphorylation, pyruvate metabolism, the pentose phosphate shunt, as well as some reactions from glutamate metabolism . it produces  <dig> precursor molecules  that are required to synthesize all  <dig> small biomass molecules of e. coli, including nucleotides, amino acids, and lipids  <cit> . examples of these precursors include oxaloacetate, a metabolite participating in the tricarboxylic acid cycle, which is used in the synthesis of amino acids such as asparagine, aspartate, lysine, and threonine  <cit> . another example is ribose-5-phosphate, which participates in the pentose phosphate pathway, and is necessary for the synthesis of nucleotides and amino acids, such as histidine, phenylalanine, and tryptophan  <cit> . in our analysis, we consider a metabolism viable only if it can synthesize all  <dig> of these biomass precursors in a well-defined minimal environment containing a specific sole carbon source, such as glucose .

the fraction of viable genotypes is extremely small and decreases as metabolism size n decreases
for each n ≤ n =  <dig>  we here explore the space Ω of metabolisms  with a given number of n reactions. we represent each such metabolism as a binary vector of length n =  <dig>  whose i-th entry is equal to one if the i-th reaction is present and zero otherwise. the largest metabolism  is the one where all reactions are present. the space of all possible metabolisms that contain a subset of these  <dig> reactions has  <dig>  member genotypes, while for a given n, Ω contains n <dig> genotypes. we are especially interested in the subset v of Ω that consists only of viable metabolisms. because, Ω can be very large, determining v is no small undertaking. for example, for metabolisms with n =  <dig>  Ω contains more than  <dig>  ×  <dig> genotypes, and the viability of each of them cannot be determined by brute force. however, one can use some peculiarities of metabolism to render this computation feasible . for example, consider a metabolism  with n reactions and another metabolism  derived from it by deleting one reaction. if the parent is not viable then the child will not be viable either. by analyzing the viability of metabolisms with decreasing numbers of reactions n, and taking advantage of this relationship, we were able to reduce the computational cost of enumerating viable metabolisms by a factor ≈  <dig> to the evaluation of viability for only  <dig>  ×  <dig> metabolisms  <cit> .

figure 1a shows the number of viable metabolisms v , together with the number of all metabolisms  = n51) as a function of the number n of reactions. note the logarithmic vertical axis. the number of viable metabolisms has a maximum at n =  <dig> with a total of  <dig>  x  <dig> metabolisms, while the minimum size of a viable metabolism, i.e., the smallest n such that v >  <dig> is  <dig> . this means that at least  <dig> reactions are required to synthesize all  <dig> biomass precursors on glucose. there are three such smallest metabolisms, one of which is shown in additional file  <dig>  figure 1b expresses v as a fraction of the number of metabolisms Ω , and shows that this fraction decreases with decreasing n. this means that random sampling is much less likely to yield a viable metabolism for small than for large metabolisms. for the smallest n with viable metabolisms , the three viable potential metabolisms correspond to a fraction 10- <dig> of all metabolisms of size  <dig>  the largest viable metabolism contains all n =  <dig> reactions.

useful principles to determine the connectedness of genotype networks
the viable genotypes at any one size n can be represented as a genotype network, a graph whose nodes are genotypes, and where two genotypes are adjacent , if they share all but one reaction. for example, the two hypothetical genotypes g <dig> and g <dig>  where g <dig> consists of reactions {r <dig>  r <dig>  r3}, and g <dig> consists of reactions {r <dig>  r <dig>  r4}, are adjacent. this is because g <dig> and g <dig> share two out of the three reactions . one can reach g <dig> from g <dig> by adding reaction r <dig> and removing r <dig>  an event that we refer to as a reaction swap  <cit> . this definition of neighboring genotypes allows us to keep the number of reactions in a genotype network constant. we note that each reaction swap can be decomposed into the addition of a reaction followed by the deletion of a reaction, both of which preserve viability provided that the reaction swap does. in other words, genotype networks that are connected if adjacency is defined under reaction swaps will remain connected if adjacency is defined via a sequence of alternating reaction additions and reaction deletions.

our principal goal is to identify whether genotype networks at any one size n are connected. this first requires us to establish the adjacency of 2vn genotype pairs, followed by application of standard graph theory algorithms such as breadth-first search  <cit>  to compute whether genotypes decompose into two or more disconnected components, or whether they form a single connected network, i.e., whether a path through v exists connecting any two genotypes  <cit> . because v exceeds  <dig> genotypes at intermediate n , such conventional methods lead to large computational cost for all but the largest and smallest metabolisms . for genotype networks comprising metabolisms of intermediate size , we therefore took advantage of another relationship between “parent” and “child” metabolisms, namely that the connectivity of a genotype network at size n can be understood based on its connectivity at size n- <dig>  we explain this relationship next.

starting from a genotype g with n reactions, one can obtain a parent genotype g with  reactions by adding to it any one reaction among the n =  <dig> reactions that are not already part of g. because addition of a reaction does not eliminate viability, g will be viable, and thus be a member of v. for any one genotype g, there exist n-n reactions that are not part of this genotype. therefore, one can obtain exactly n-n genotypes of size n +  <dig> by adding a single reaction to a genotype g. and because each pair of these genotypes of size n +  <dig> shares all but one reaction , every parent genotype in this set is adjacent to every other parent genotype. in other words, these genotypes form a clique in v  <cit> .

we next point out that if two genotypes of size n are adjacent, then their corresponding genotypes of size  form two cliques linked by at least one genotype of size . the hypothetical example in figure  <dig> illustrates this fact. consider a “universe” of only n =  <dig> reactions - {r <dig>  r <dig>  r <dig>  r <dig>  r <dig>  r6}. the upper half of figure  <dig> shows two hypothetical genotypes  that are viable, adjacent, and contain two reactions each . genotype g <dig> comprises reactions {r <dig>  r2}, while the other genotype g <dig> comprises reactions {r <dig>  r3}. the lower part of the figure shows all genotypes containing three reactions each that can be obtained from adding one reaction to genotypes g <dig> and g <dig>  blue genotypes are parents of g <dig>  whereas red genotypes are parents of g <dig>  note that the red and blue genotypes form two cliques. among the  <dig> genotypes of size n +  <dig> that are parents of either g <dig> or g <dig>  one is special, because the two cliques share it. in our example, this is the genotype containing reactions {r <dig>  r <dig>  r3}. more generally, this shared genotype is the one genotype obtained from a pair of adjacent genotypes g <dig> and g <dig> in v by adding the reaction to g <dig> that it does not share with g <dig>  or vice versa. . we note that additional edges connect genotypes in both cliques . specifically, those edges connect the genotypes derived from adding the same reaction to g <dig> and g <dig>  there are exactly  such edges.

these observations have the following important corollary: if a genotype network containing genotypes of size n is connected, then all genotypes g obtained from genotypes of size n are also connected.

so far, our line of reasoning explains connectedness of genotypes that are parents of connected genotypes at a lower size. but some viable genotypes are not parents of any other genotype. these are exactly those genotypes in which elimination of any one reaction abolishes viability. we have called such genotypes minimal <cit> , and note that they do not necessarily correspond to the smallest metabolisms. for example, there are  <dig> metabolisms that are viable on glucose and that have  <dig> reactions, all of which are essential , but the smallest viable metabolisms on glucose have only  <dig> reactions. . as one increases the size of a metabolism, such “childless” metabolisms could in principle arise at any n. since our preceding argument about connectedness does not apply to them, they need to be identified, and their connectedness to the rest of a genotype network needs to be examined separately, as discussed in the next section.

v

the left-most column shows the number of reactions n in a potential metabolism, the second column from the left shows the number of disconnected components into which the genotype network of these viable metabolisms fragments, the third column shows the number of viable potential metabolisms for each n, and the fourth column shows the number of minimal metabolisms. note that the fraction of minimal metabolisms  decreases as metabolism size n increases.

we identified minimal metabolisms at each size n by deleting every single reaction from each genotype in v, and by examining whether the resulting genotype was viable, and thus identifying those genotypes in which no reaction can be deleted. table  <dig> shows the number of minimal metabolisms at each n, and demonstrates that their proportion among all viable metabolisms ) decreases dramatically with increasing metabolism size n. importantly for the next section, no minimal metabolisms viable on glucose exist above n =  <dig> 

in sum, we here observed that if a genotype network is connected at size n, the genotype network formed by the parents of its genotypes is also connected. because minimal metabolisms are not parents of any other metabolisms, they need to be analyzed separately.

metabolic genotype networks are connected for all but the smallest metabolisms
to determine connectedness of genotype networks for metabolisms v viable on glucose, we began by analyzing the smallest  and largest  potential metabolisms. we did so by computing, first, edge lists for each genotype network, and, second, the connectedness of the genotype network, using the graph analysis software igraph  <cit> . we found that viable metabolisms of size n =  <dig>  as well as n =  <dig> to n =  <dig> have only one connected component. in contrast, viable metabolisms of sizes n =  <dig>   <dig>   <dig>   <dig>  and  <dig> are fragmented. they form a genotype network with two components .

v

for each metabolism size, the table shows the number of viable potential metabolisms, the number of components, and the fraction of genotypes in the largest component. the genotype network comprising metabolisms of size  <dig> contains three metabolisms, of which two form one component and the other is isolated from them. for metabolisms of size  <dig>  the two components are almost of the same size, and the larger component contains  <dig>  percent of the viable genotypes. for larger metabolisms, the genotype network is largely connected, with more than  <dig> percent of genotypes belonging to the largest component.

fragmented genotype networks may decompose into components with different sizes, such that the majority of genotypes belong to the largest component. in this case, most viable genotypes can be reached from each other through a series of small genotypic changes that affect only single reactions each and that leave the phenotype constant. alternatively, fragmentation of a genotype network may result in components with similar size, which can impede accessibility of many genotypes. table  <dig> shows that this is not generally the case. the vertical axis denotes the fraction of genotypes belonging to the largest component of a genotype network, and it shows that the largest components of the genotype networks at size n = 25– <dig> encompass almost all  of the viable genotypes. at n =  <dig>  the genotype network has two components that consist of one and two metabolisms. at size n =  <dig> there are  <dig> viable genotypes,  <dig>  of which belong to the largest component.

we next turn to a more detailed analysis of genotype network fragmentation at the smallest sizes. figure  <dig> shows graph representations of genotype networks whose metabolisms have sizes n =  <dig>   <dig> and  <dig>  filled circles represent genotypes. adjacent genotypes are connected by an edge. the size of a circle corresponds to the number of neighbors of the corresponding genotype. minimal potential metabolisms are shown in red in all three panels. all three potential metabolisms of size  <dig> are minimal . two of them are adjacent metabolisms and form component a , whereas the remaining isolated metabolism forms component b . the green and orange circles of figure 3b show the result of adding one reaction from the remaining pool of  <dig> reactions  to each of the two genotypes in component a. such addition yields a connected component a’ of  <dig> metabolisms with  <dig> reactions . the component consists of two cliques connected to each other by a single connected genotype. analogous addition of reactions to the single genotype in component b of figure 3a yields a connected component b’ with  <dig> potential metabolisms  of size  <dig>  the total number of genotypes in component a’ and b’ is  <dig>  however, there are  <dig> viable metabolisms with size  <dig> . it turns out that the missing eight metabolisms are minimal  and cannot be derived using reaction addition to metabolisms at size  <dig>  three of them are connected to component a’ and five of them to component b’ . overall, the number of components at size  <dig> reflects the number of components at size  <dig>  because these components are derived from the smaller components at size  <dig>  this, however, is no longer true for the genotype network of metabolisms with  <dig> reactions in figure 3c. in this panel, genotypes shown in green  and orange  are parents of the green and orange genotypes in components a’ and b’ respectively. notice that these components are now connected, in contrast to their disconnectedness at size  <dig>  what connects them are some of the minimal metabolisms that arose anew at size  <dig> and  <dig>  there are  <dig> such child-less minimal genotypes at size  <dig> . four of them form a new component labeled c .

an analogous analysis of metabolisms up to size  <dig> can help understand why all larger metabolisms must be connected . there are two germane observations. first, at size n =  <dig>  there are approximately  <dig>  ×  <dig> metabolisms and all of them fall into a single connected component . second, no minimal metabolisms exist at size  <dig> and beyond . this means that all parent metabolisms at size  are derived from child metabolisms at sizes beyond n =  <dig>  by our argument in the preceding section, they must therefore form a single connected component .

in sum, we showed that genotype networks formed by different central carbon metabolism variants are connected in metabolic genotype space for all but the smallest viable metabolisms. with few exceptions, wherever fragmentation occurs, more than  <dig> percent of genotypes belong to the largest component. this high connectivity arises from the parent–child relationships we discussed, as well as from the relatively small number of minimal metabolisms that arise at each n .

essential pathways cause genotype network fragmentation
thus far, our analysis focused on broad patterns of genotype network fragmentation. we next discuss the possible mechanistic reasons for such fragmentation. they revolve around different biochemical pathways that are essential for viability among metabolisms in different components. essential reactions are those whose removal results in a loss of viability , and a reaction’s essentiality may depend on other reactions present in a metabolism. that is, a reaction can be essential in one potential metabolism, but nonessential in another potential metabolism, because of the presence of alternative metabolic routes  <cit> . the fraction of metabolisms of a given size in which a reaction is essential is a useful quantifier of the reaction’s essentiality, which we have called the reaction’s superessentiality index  <cit> . the concept of essentiality can be extended to entire metabolic pathways, groups of essential reactions that share substrates/products with each other and cannot be replaced without a loss of viability.

we next illustrate with an example how pathway  essentiality causes fragmentation of genotype networks, by demonstrating the existence of alternative essential pathways in different network components for metabolisms with  <dig> and  <dig> reactions. to identify such pathways, we first computed the superessentiality index of reactions in potential metabolisms of size  <dig> and  <dig> each, and did so for all genotypes in each of the two genotype network components  separately . we then examined which reactions differ in their superessentiality index between the two components. we found five such reactions, which can be subdivided into groups of two and three reactions, respectively. the first group comprises the reactions catalyzed by transketolase  <dig>  and transaldolase . they are essential in all metabolisms from network component a’ , but inessential in all metabolisms belonging to component b’ . the second group comprises the reactions catalyzed by the enzymes glucose-6-phosphate dehydrogenase , 6-phosphogluconolactonase , and phosphogluconate dehydrogenase . they are essential in all metabolisms of component b’, but inessential in any of the genotypes in component a’ . taken together, this means that tkt <dig> and tala form a small but essential pathway in the genotypes belonging to component a’, while g6pdh, pgl and gnd form another essential pathway in genotypes belonging to component b’.

these five reactions are part of the pentose phosphate pathway, as shown in figure  <dig>  the pentose phosphate pathway is required for the synthesis of two biomass precursors, ribose-5-phosphate  and erythrose-4-phosphate  . the reactions shown in black are essential in potential metabolisms belonging to both genotype network components . in contrast, the essentiality of reactions participating in the two alternative essential pathways , which contain the reactions discussed in the preceding paragraph, depends on which of the two components a potential metabolism belongs to. to understand why, we first note that the metabolites glucose-6-phosphate , fructose-6-phosphate , and glyceraldehyde-3-phosphate  are also synthesized by reactions in glycolysis, and thus constitute metabolic inputs to the pentose phosphate pathway for the synthesis of e4p and r5p. flux balance analysis can be used to show that reactions catalyzed by transketolase  <dig>  and transaldolase  are required to synthesize sufficient r5p for viability  upon removal of any one reaction from the orange pathway , thus rendering the reactions catalyzed by tkt <dig> and tala essential. conversely, removal of any one reaction from the green pathway  leads to a requirement for all reactions in the orange pathway to produce the pathway output. in sum, the genotypes of size  <dig> and  <dig> are disconnected because alternative essential pathways exist in them that consist of more than one essential reaction, and because no one reaction in one pathway can replace a reaction in the other pathway. put differently, loss of any one reaction in one pathway can only be compensated by addition of all reactions of the other pathway.

because metabolisms at size  <dig> are separated by three swaps, genotype space can be connected at size  <dig> , that is, after successive addition of two reactions.

in additional files  <dig> and  <dig>  we discuss another example, which illustrates that essential and alternative metabolic routes need not contribute to biosynthesis of the same precursors, and may arise in functionally different and unrelated parts of metabolism. these differences notwithstanding, the examples illustrate the mechanistic reason for genotype network fragmentation: it is not possible to interconvert two genotypes in different components by one reaction swap because such interconversion will inevitably create unviable genotypes in which two alternative essential pathways are incomplete.

as a corollary, the longer such essential alternative pathways are, the greater the number of reactions m that need to be added to non-adjacent viable genotypes g, such that viable genotypes g become connected.

metabolisms viable on multiple carbon sources are also mostly connected
many organisms are viable on multiple carbon sources, which may impose additional constraints on a metabolism. we wished to find out how severely these constraints affect genotype network connectivity in our analysis of central carbon metabolism. to this end, we analyzed metabolisms that are a subset of our n =  <dig> reactions and that are viable on a total of  <dig> common carbon sources when each of them is provided as the sole carbon source . because glucose is among these  <dig> carbon sources, metabolisms viable on all  <dig> carbon sources are also viable on glucose. in other words, the genotype network they form at any specific metabolism size n is a subset of the genotype network of metabolisms viable on glucose. we note that the metabolism comprising all n =  <dig> reactions is viable on all  <dig> different carbon sources.

we used an approach identical to that described above for glucose to identify potential metabolisms viable on all  <dig> carbon sources. their numbers are shown in figure 1a , which shows that, first, no metabolism with fewer than n =  <dig> reactions is viable on all  <dig> carbon sources, whereas the minimal size is much smaller  for metabolisms viable on glucose alone . second, the number of metabolisms viable on  <dig> carbon sources is much smaller than the number of metabolisms viable on glucose. it reaches a maximum at n =  <dig> with  <dig>  ×  <dig> metabolisms , many fewer than for viability on glucose . this difference is also highlighted in figure 1b whose vertical axis represents genotypes viable on glucose  and on all ten different carbon sources  as a fraction of all genotypes. at the minimal size of n =  <dig> reactions, genotypes viable on all  <dig> different carbon sources comprise approximately one 10-8th of those genotypes viable on glucose of the same size.

this strong constraint on metabolisms viable on multiple carbon sources raises the possibility of genotype network fragmentation. however, we found no evidence for such fragmentation. because the number of genotypes viable on  <dig> carbon sources is relatively small, we were able to use standard algorithms to determine their connectedness, which show that genotype networks of all sizes except for n =  <dig> and  <dig> reactions consist of only one connected component. at size n =  <dig> the genotype network fragments into three components. the largest of them contains  <dig>  percent of viable genotypes. at size n =  <dig>  the network fragments into two components, with the larger containing  <dig>  percent of genotypes. this implies that one can access any metabolic genotype viable on  <dig> carbon sources, regardless of its size, from most other viable genotypes through a series of individual reaction changes.

study system 2: genome-scale metabolisms
we have thus far studied connectedness for potential metabolisms drawn from the reduced reaction set of central carbon metabolism, which comprises a small subset of the more than  <dig> reactions in the typical metabolism of a free-living organism. in this section, we focus on the connectedness of larger, genome-scale potential metabolisms. their reactions come from the known “universe” of possible biochemical reactions, which comprises, at our present state of partial knowledge, already more than  <dig> reactions  <cit> . for any one such metabolism to be viable, we require that it is able to synthesize all  <dig> essential biomass precursors of e. coli <cit>  – most of which are molecules central to all life, such as nucleotides and amino acids  – in a minimal environment containing glucose as the sole carbon source.

using our binary representation of a metabolic genotype , the number of possible genome-scale metabolisms is greater than  <dig>  which renders exhaustive analysis of connectivity infeasible. random sampling of the space using markov chain monte carlo  methods can be very useful  <cit> , but it is not suitable for our purpose, because the mcmc approach samples genotypes from the same component of a genotype network.

we thus use a different sampling approach  <cit> , which starts from a “global” metabolism that comprises all reactions in the known universe . this metabolism has  <dig> reactions. its viable children would form a single connected component, but as one reduces their number of reactions further, the set of viable genotypes v might become disconnected. figure 5a illustrates this possibility schematically. it shows a funnel-like landscape whose width at a given number of reactions n  indicates the number of viable metabolisms at this n. the number of viable metabolisms approaches zero as n approaches the smallest possible size at which a metabolism can be viable. starting from the global metabolism, one can randomly select a sequence of reactions for deletion while requiring that each deletion retain viability. parts of three hypothetical deletion sequences are shown as three trajectories in the panel. two of them  lead into deep depressions in the funnel, which correspond to disconnected components of a genotype network. more precisely, a metabolism that resides in one such depression cannot be converted into another viable metabolism without changing its number of reactions , as doing so would require it to traverse the exterior of the funnel. the third trajectory  enters such a depression only at a much lower number of reactions. we wanted to know whether such funnels appear in the landscape at moderate n  or only at values of n close to the smallest number of reactions permitting viability .

to find out, we derived multiple viable metabolisms with a given size n as follows. starting from the global metabolism, we repeatedly deleted randomly chosen reactions from it, such that each deletion preserved viability, until we had arrived at a minimum metabolism, that is, a metabolism whose number of reactions cannot be reduced further. in doing so, we kept track of the deleted reactions, and the sequence in which they were deleted. each minimum metabolism created in this way had fewer than  <dig> reactions . we used these minimal metabolisms, as well as information about the sequence in which reactions were deleted, to create larger potential metabolisms of varying sizes n, each of which corresponds to a specific point in the deletion sequence. we repeated this procedure  <dig> times, which allowed us to create  <dig> minimal metabolisms, as well as  <dig> potential metabolisms of various intermediate sizes.

most viable genome-scale metabolisms reside in the same connected component
if genotype networks were highly fragmented at a given size n, then different random deletion sequences would yield potential metabolisms that reside in different components of a genotype network. in this case, it would not be possible to connect two metabolisms that reside in different components of a genotype network through a sequence of reaction swaps, each of which preserves viability. with these observations in mind, we attempted to connect metabolisms in our samples of viable metabolisms of a given size . specifically, for any sample of metabolisms , we attempted to connect gi and gi+ <dig>  through viability-preserving reaction swaps. we did this for  <dig> potential metabolisms of size  <dig> ,  <dig>   <dig>  and  <dig> . in this way, we were able to show that all  <dig> potential metabolisms are connected at each of these sizes. thus, down to a size of n =  <dig> reactions, the genotype network of metabolisms viable on glucose is not highly fragmented, and one component comprises the vast majority or all metabolisms.

because many free-living microorganisms are viable on multiple carbon sources, we generated  <dig> additional potential metabolisms through the reaction deletion process just described, but with the additional constraint that they remain viable on ten sole carbon sources . specifically, we created again potential metabolisms of size  <dig>   <dig>   <dig>   <dig> and  <dig> . we then repeated the procedure that attempts to connect genotypes gi and gi+ <dig> through viability-preserving reaction swaps. in this way, we were able to show that all  <dig> potential metabolisms are connected at each of these sizes. thus, down to a size of n =  <dig> reactions, the genotype network of most metabolisms viable on all  <dig> carbon sources consists of one connected component.

it is possible to make this point more quantitatively and establish a statistical bound on the fraction of potential metabolisms contained in the largest connected component of v. specifically, let us consider the null hypothesis that more than one percent of v resides outside this largest component. if this null hypothesis is correct, then the probability p that a randomly drawn viable genotype is not on this largest component is greater then p =  <dig> . moreover, the probability that some number m of genotypes drawn at random from v all fall on the largest connected component would be smaller than m. in our case, m =  <dig> and m <  <dig>  =  <dig> . in other words, the results of our sampling allow us to reject the above null hypothesis at a significance level smaller than  <dig> percent.

minimal metabolism size can help explain connectedness
in the sections on central carbon metabolism we showed that new components disconnected from the remainder of a genotype network can arise as one increases metabolism size, and that they originate from “childless” minimal metabolisms which appear at a given size n that is small compared to the total number of possible reactions. to examine their size for larger metabolic system, we studied the  <dig> minimal metabolisms that we derived from the sequential random deletion strategy described in the previous section . their size ranges from  <dig> to  <dig> reactions, with a mean of  <dig> reactions  . although we cannot absolutely exclude the possibility that minimal metabolisms exist with more than  <dig> reactions, the fact that all of the minimal metabolisms we found have fewer reactions suggests that the emergence of new genotype network components will be rare above  <dig> reactions. this observation further supports our assertion that most metabolisms with more than  <dig> reactions will be part of a single genotype network. it also means that essential alternative metabolic pathways of more than one reaction that are characteristic for a given connected component exist only for small metabolisms. alternative pathways for the synthesis of most biomass molecules undoubtedly exist, but most of them can be converted into one another through sequences of single reaction changes that preserve viability.

in a final analysis, we asked whether the minimal networks that our approach identified are isolated in metabolic genotype space Ω, or whether they might themselves form large components. to this end, we simply asked whether these networks have any viable neighbors in Ω, metabolisms that differ by a single reaction swap, which are also viable. the result  shows that even minimal metabolisms have typically hundreds of neighbors. specifically, an average minimal metabolism has  <dig>  viable neighbors . the maximum number of neighbors for a minimal metabolism is  <dig>  figure 6c shows that larger minimal metabolisms tend to have more neighbors than smaller ones . taken together, this means that minimal metabolisms themselves must form large components and are certainly not isolated. it mirrors the situation in central carbon metabolism, where newly emerging minimal metabolisms at a given size n also form connected components, albeit small ones .

discussion
to our knowledge, our analysis of all possible ≈  <dig> metabolisms comprising subsets of reactions in central carbon metabolism is the first exhaustive analysis of a metabolic space this large, even though smaller-scale analyses were carried out before with different goals  <cit> . our analysis focused on metabolisms viable on glucose, which are required to synthesize  <dig> products of central carbon metabolism that are biomass precursors. we found that viable metabolisms could have fewer than half  of the maximal number of  <dig> reactions in central carbon metabolism. moreover, for metabolisms covering  <dig> percent of the size of the viable range , all  or the vast majority of metabolisms of size n form a single connected component  in the space of metabolisms.

in genome-scale metabolisms, where exhaustive enumeration is no longer possible, and where we required the synthesis of  <dig> common biomass molecules for viability, we found viable potential metabolisms with as few as  <dig> reactions, and for  <dig>  percent of the size range of viable metabolisms  the vast majority of potential metabolisms form a single connected component of a genotype network. more specifically, with a probability of greater than  <dig> , more than  <dig> percent of all viable metabolisms exceeding  <dig> reactions are part of the same component. we note that it would have been sufficient to perform the sequential reaction deletion procedure needed to arrive at this conclusion for metabolisms of size n =  <dig>  and not also for metabolisms of size n = 400– <dig>  as we did. the reason is an elementary observation we made about metabolic genotype space: if a set of viable metabolisms v is connected for some number of reactions n, then v must be connected for all m > n, provided that no new minimal metabolisms appear at any value of m. the largest minimal metabolism we found has n =  <dig> reactions, and while we cannot exclude the existence of minimal metabolisms above n =  <dig> with certainty, such potential metabolisms would be increasingly rare at large n. they would create new genotype network components that would comprise a vanishing fraction of the rest of the connected genotype network .

figure 5b illustrates schematically the dependence of fragmentation on metabolism size n that we observed. depressions in the funnel-like landscape whose width reflects the number of viable potential metabolisms correspond to disconnected metabolic networks and appear only at small altitudes . that is, the hypothetical landscape of figure 5b reflects our observations, whereas that of figure 5a, where disconnected metabolisms appear at much higher reaction numbers does not.

 while we study only viability on a carbon source, other metabolic properties such as mutational robustness and access to novel phenotypes are also important  <cit>  and may differ in different components. in such cases, historical contingency may indeed play a role towards the fine-tuning of metabolic properties and would be relevant in a scenario depicted by figure 5a. however, as fragmentation occurs only at lower metabolism sizes, historical contingency may not constrain the overall evolution of metabolic systems sharply.

with possible exceptions in some marine bacteria  <cit>  metabolisms with sizes as small as n =  <dig> are not usually found in free-living organisms. they occur in symbionts  <cit>  and parasites  <cit> , which live in close association with a host organism and are provided nutrients and a constant environment which allows them to shed many enzyme-coding genes  <cit> . organisms that have lived inside a host for a long time experience less of the kinds of evolutionary change – especially horizontal gene transfer – that is powerful in endowing the genomes of free-living organisms with new evolutionary adaptations  <cit> . in other words, the fragmentation of genotype networks that we see for very small potential metabolisms, and that can constrain their evolution, is of little relevance for the evolution of free-living organisms. those organisms whose evolution it could constrain the most are already subject to little evolutionary change for ecological reasons.

our analysis of genotype network fragmentation provides a coarse, statistical view on the organization of genotype space. this view needs to be complemented by a mechanistic perspective that asks what distinguishes the metabolisms that exist in different components of a genotype network? what could prevent evolution from converting them into each other through a series of single viability-preserving reaction changes? the answer lies in alternative metabolic pathways that are essential for the biosynthesis of one or more biomass molecules. potential metabolisms in one genotype network component have one such pathway, and potential metabolisms in the other component have another such pathway.  at least one of these pathways must comprise more than one reaction, otherwise the two metabolisms could be converted into one another through a single reaction swap. we have provided two examples, one involving the biosynthesis of erythrose-4-phosphate and ribose-5-phosphate through variants of the pentose phosphate pathway, the other concerning the biosynthesis of phosphoenolpyruvate.

for two reasons, such alternative essential pathways are not likely to hamper the evolution of most metabolic systems. first, we observed fragmentation only for relatively small metabolisms, which means that in larger metabolisms, alternative essential pathways with more than one reaction do not exist. they can usually be converted into each other by single reaction changes that do not cause a loss of viability. second, our analysis required that we impose change through reaction swaps – a reaction addition paired with a deletion – that leave reaction numbers constant. however, this is not usually how evolutionary change in a metabolism’s reactions occurs. for example, horizontal gene transfer frequently adds more than one gene and thus more than one reaction to a metabolism  <cit> . in a metabolism that harbors one of two alternatives for an essential pathway, a horizontal gene transfer event may introduce the genes of the other pathway. after that, the two pathways may coexist, and the first pathway is free to deteriorate through loss of function mutations in its genes. a potential example of co-existing alternative pathways involves the two pathways responsible for synthesizing isopentenyl diphosphate , a molecule that is required for the synthesis of isoprenoids. some actinomycetes that harbor both pathways in their complete forms may have obtained the responsible genes through horizontal gene transfer  <cit> . in sum, common forms of genetic change can help bridge different components of a genotype network where such components exist.

the main limitation of our work comes from the enormous computational cost associated with evaluating the viability of many metabolisms. while our sampling approach for genome-scale metabolisms allowed us to circumvent this problem for any one carbon source, it is possible that viability on a broader range of carbon sources  might have led to greater genotype network fragmentation. this possibility is suggested by our analysis of central carbon metabolism, where metabolisms viable on  <dig> carbon sources must have at least  <dig> reactions, and fragmentation of genotype networks stops at  <dig> reactions. however, for genome-scale metabolisms, the metabolism sizes at which fragmentation would cease would increase only modestly with each additional carbon source on which viability is required. this is because previous work has shown that viability on every additional carbon source requires on average the addition of only two reactions to a metabolism  <cit> . for example, viability on ten additional carbon sources would increase the size of minimal metabolisms by only  <dig> reactions. because the number of minimal metabolisms that arise de novo with increasing metabolic complexity n is closely linked to the metabolism size at which fragmentation occurs, viable genotype networks v would still remain connected over the vast majority of the range of n. indeed, we found that genome-scale metabolisms viable on  <dig> carbon sources and comprising  <dig> reactions are connected in genotype space and belong to the same component. possible exceptions might involve metabolisms viable on hundreds of different carbon sources, but even environmental generalists are typically not viable on that many. .

another limitation of our work is that we only considered viability on carbon sources. we cannot exclude the possibility that viability on sources of different chemical elements may lead to different fragmentation patterns. however, it is unlikely that carbon sources are exceptional in this regard. for example, the minimal size of metabolisms viable on different sulfur sources comprises only  <dig> reactions, and is thus even smaller than that of metabolisms viable on carbon  <cit> . the reason is that fewer biomass molecules contain sulfur, an observation that also holds for the two other key elements nitrogen and phosphorus.

a further limitation is that we focus on evolutionary constraints caused by the presence or absence of biochemical reactions, rather than on differences in the regulation of existing enzymes or their encoding genes. such regulatory constraints can influence important metabolic properties such as biomass growth rate  <cit> . however, they can also be easily broken through regulatory evolution, even on the short time scales of laboratory evolution experiments  <cit> . reaction absence is thus a more fundamental constraint, but we note that the exploration of regulatory constraints remains an important task for future work. moreover, to understand connectedness as a function of reaction numbers, we had to preserve reaction numbers and analyze connectedness through reaction swaps. we note that a reaction swap can be considered as an addition of a reaction, which does not change viability and a reaction deletion that preserves viability. that is, every reaction swap can be broken down into two biologically relevant changes, and thus genotype network connectivity resulting from reaction swaps also holds for single reaction additions and deletions.

finally, we do not consider one potential cause of genotype network fragmentation: if one required for viability that biomass precursors need to be synthesized at a high rate, then genotype networks may fragment more often than we observe. however, fast biomass synthesis and its main consequence, rapid cell division, are not universally important outside the laboratory environment. for example, a survey of microbial growth rates shows that many microbes have very long generation times in the wild  <cit> . rapid growth thus may not be a biological sensible requirement for viability in many wild organisms.

CONCLUSIONS
in sum, our analysis has shown that over a broad range of metabolic complexity, historical contingency is not likely to strongly constrain the modulation of metabolic properties, or the accessibility of novel metabolic phenotypes. only the smallest metabolisms, which typically do not occur in free-living organisms, are likely to be subject to such constraints, which stem from genotype network fragmentation. additional factors that we did not consider explicitly are likely to further reduce such fragmentation. they include pervasive promiscuous enzymes, which are capable of catalyzing more than one biochemical reaction  <cit> , and horizontal gene transfer events that can add multi-reaction metabolic pathways to an existing metabolism, and thus bridge otherwise disconnected genotype network components.

