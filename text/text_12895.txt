BACKGROUND
the advancement of genomic technologies – including microarray, proteomic and metabolic approaches – have led to a rapid increase in the number, size and rate at which genomic datasets are generated. managing and extracting valuable information from such datasets requires the use of data management platforms and computational approaches. in contrast to genome sequencing projects, there is a need to store much more complex ancillary data than would be necessary for genome sequences. particularly the need to clearly describe an experiment and report the variables necessary for data analysis became a new challenge for the laboratories. furthermore, the vast quantity of data associated with a single experiment can become problematic at the point of publishing and disseminating results. fortunately, the communities have recognized and tackled the problem through the development of standards for the capturing and sharing of experimental data. the microarray community arranged to define the critical information necessary to effectively analyze a microarray experiment and defined the minimal information about a microarray experiment  standard  <cit> . subsequently, miame was adopted by scientific journals as a prerequisite for publications and several software platforms supporting miame were developed  <cit> .

the principles underlying miame have reasoned beyond the microarray community. the proteomics standards initiative   <cit>  aims to define standards for data representation in proteomics analogues to that of miame and developed the minimum information about a proteomics experiment  standard  <cit> . an implementation independent approach for defining the data structure of a proteomics experiment, the proteome experimental data repository   <cit>  was developed, and a psi compliant public repository was set up  <cit> . hence, given the defined standards and available public repositories, computational systems can now be developed to support proteomics laboratories and enhance data dissemination.

to meet the needs for high-throughput ms laboratories several tools and platforms covering various parts of the analytical pipeline were recently developed including the trans proteomics pipeline  <cit> , the global proteome machine  <cit> , vems  <cit> , cpas  <cit> , chomper  <cit> , prodb  <cit> , proteios  <cit> , gapp  <cit> , peptideatlas  <cit> , epir  <cit> , stem  <cit> , and topp  <cit>  . however, to the best of our knowledge there is currently no academic or commercial data management platform supporting miape and enabling proteomics identifications database  export. moreover, it became evident that several search engines should be used to validate proteomics results  <cit> . hence, a system enabling comparison of the results generated by the different search engines would be of great benefit. additionally, integration of algorithms for peptide validation, protein clustering and protein quantification into a single analytical pipeline would considerably facilitate analyses of the experimental data.

we have therefore developed the mass spectrometry analysis system , a web-based platform for management and analysis of proteomics liquid chromatography tandem mass spectrometry  data supporting miape. maspectras was developed using state-of-the-art software technology and enables data import from five common search engines. analytical modules are provided along with visualization tools and pride export as well as a module for distributing intensive calculations to a computing cluster.

implementation
the application is based on a three-tier architecture, which is separated into presentation-, middle-, and database layer. each tier can run on an individual machine without affecting the other tiers. this makes every component easily exchangeable. a relational database  forms the database layer. maspectras follows and extends the pedro database schema  <cit>   to suit the guidelines of psi  <cit> . the business layer consists of a java  <dig> enterprise edition  compliant application which is deployed to the open source application server jboss  <cit> . access to the data is provided by a user-friendly web-interface using java servlets and java server pages  <cit>  via the struts framework  <cit> . computational or disk space intensive tasks can be distributed to a separate server or to a computing cluster by using the in-house developed jclusterservice interface. this web service based programming interface uses the simple object access protocol   <cit>  to transfer data for the task execution between calculation server and maspectras server. the tasks can be executed on dedicated computation nodes and therefore do not slow down the maspectras web interface. this remote process execution system is used as a backend for the protein grouping analysis, for the mass quantification and for the management of the sequence databases and their sequence retrieval during import.

the current implementation of maspectras allows the comparison of search results from sequest  <cit> , mascot  <cit> , spectrum mill  <cit> , x! tandem  <cit> , and omssa  <cit> . the following file formats are supported: sequest: zip-compressed file of the *.dta, *.out and sequest.params files; mascot: *.dat; spectrum mill: zip-compressed file of the results folder including all subfolders; x! tandem: the generated *.xml; omssa: the generated *.xml with included spectra and search params; raw data: xcalibur raw format  version  <dig> , mzxml  <cit>  and mzdata  <cit>  format. the data can be imported into maspectras database asynchronously in batch mode, without interfering with the analysis of already uploaded data. the spectrum viewer applet and the diagrams are implemented with the aid of jfreechart  <cit>  and cewolf  <cit>  graphics programming frameworks. the whole system is secured by a user management system which has the ability to manage the access rights for projects and offers data sharing and multiple user access roles in a multi-user environment  <cit> .

RESULTS
analysis pipeline
maspectras extends the pedro relational database schema and follows the guidelines of the psi. it accepts the native file formats from sequest  <cit> , mascot  <cit> , spectrum mill  <cit> , x!tandem  <cit> , and omssa  <cit> . the core of maspectras is formed by the maspectras analysis platform . the platform encompasses modules for the import and parsing data generated by the above mentioned search engines, peptide validation, protein clustering, protein quantification, and a set of visualization tools for post-processing and verification of the data, as well as pride export.

import and parsing data from search engines
there are several commercial and academic search engines for proteomics data. based on known protein sequences stored in a database, these search engines perform in silico protein digestion to calculate theoretical spectra for the resulting peptides and compare them to the obtained ones. based on the similarity of the two spectra, a probability score is assigned. the results  are stored in a single or in multiple files, and often only an identification string for the protein is stored whereas the original sequence is discarded. however, the search engines are storing different identification strings for the proteins . moreover, several databases are not using common identifiers : gi|6323680; mass spectrometry protein sequence database   <cit> : s39004). in order to compare the search results from different search engines additional information from the corresponding sequence databases is needed. the format of the accession string has to be known to retrieve the protein sequence and additional required information from the sequence database, like protein description, or the organism the protein belongs to. the only common basis within the different databases used by the search algorithms is the amino acid sequence of the proteins. in order to make results of different algorithms comparable and to find the corresponding proteins in the different result files the sequence information is taken as unique identification criterion.

we have developed parsers for the widely used search engines sequest, mascot, spectrum mill, x!tandem, and omssa. maspectras manages the sequence databases used while searching with different modules internally. any database available in fasta format  <cit>  can be uploaded to maspectras. parsing rules are user definable and therefore easily adaptable to different types of sequence databases. when results of a search engine are imported into maspectras, the system first tries to determine whether the same accession string for the same database version exists. if that is not the case, the original sequence information is retrieved from the corresponding sequence database. subsequently the system tries to match the sequence against the sequences already stored in the database. if an entry with the same sequence information but a different accession string is found, the new accession string is associated with the unique identifier of the already stored sequence. otherwise a new unique identifier is created and the sequence is stored with the appropriate accession strings.

peptide validation
maspectras calculates a probability score for sequest and mascot which is based on the algorithm of peptideprophet  <cit> . data re-scoring adds a further layer, which improves the specificity of the highly sensitive sequest and mascot database searches. this procedure could be applied to other database search algorithms as well and can additionally offer a remap of the results from different database search algorithms onto one single probability scale. the statistical model incorporates a linear discriminant score based on the database search scores  as well as the tryptic termini and missed cleavages  <cit> . after scoring the data has to pass a user definable filter, which uses the search programs specific score to discard the most unlikely data.

protein clustering
in peptide fragmentation fingerprinting  peptides are identified by search engines, which have to be mapped to proteins. a single peptide often corresponds to a group of proteins. therefore, pff identifies protein groups, each protein sharing similar peptides. a grouped protein view represents the result more concisely and proteins with a small number of identified peptides can be recognized easier in complex samples. the protein grouping implemented in maspectras is based on markov clustering  <cit>  using basic local alignment search tool  and multiple alignments  <cit> . a file in fasta format is assembled containing all sequences to be clustered. each sequence is then compared against each other. the all-against-all sequence similarities generated by this analysis are parsed and stored in an upper triangular matrix. this matrix represents sequence similarities as a connection graph. nodes of the graph represent proteins, and edges represent sequence similarity that connects such proteins. a weight is assigned to each edge by taking the average pair wise -log <dig> of the blast e-value. these weights are transformed into probabilities associated with a transition from one protein to another within this graph. this matrix is passed through iterative rounds of matrix multiplication and inflation until there is little or no net change in the matrix  <cit> . the final matrix is then interpreted as the protein clustering and the number of the corresponding cluster is stored for every protein hit. the proteins within a group are aligned by clustal w  <cit>  and visualized by the integrated jalview alignment editor  <cit> . for proteins with the same sequence from different searches the corresponding protein groups are combined at the time the searches are compared.

protein quantification
for quantification of peptides the asapratio algorithm described in  <cit>  has been integrated and applied. to determine peak area a single ion chromatogram is reconstructed for a given m/z range by summation of ion intensities. this chromatogram is then smoothed tenfold by repeated application of the savitzky – golay smooth filtering method  <cit> . for each isotopic peak center and width are determined. the peak width is primarily calculated by using the standard asapratio algorithm and for further peak evaluation a new algorithm for recognizing peaks with saddlepoints has been implemented. with this algorithm a valley  is recognized to be part of the peak and added to the area. the calculated peak area is determined as the average of the smoothed and the unsmoothed peak. from this value background noise is subtracted, which is estimated from the average signal amplitude of the peak's neighborhood . the peak error is estimated as the difference of the smoothed and the unsmoothed peak. a calculated peak area is accepted in case the calculated peak area is bigger than the estimated error and the peak value is at least twice the estimated background noise, otherwise the peak area is set to zero. the acceptance process is applied in automated peak area determination only. in case of interactive peak determination this process is replaced by the operator's decision. in order to demonstrate the quantification capabilities of maspectras two samples where mixed at different ratios and quantified with msquant  <cit> , pepquan , and maspectras. the results are described in the section "quantitative analysis", the experiment in the section "experimental procedures".

visualization tools
maspectras allows the storage and comparison of search results from the search engines sequest, mascot, spectrum mill, x! tandem, and omssa matched to different sequence databases merged in a single user-definable view . maspectras provides customizable  protein, peptide, spectrum, and chromatogram views, as well as a view for the quantitative comparison.

the clustered protein view displays one representative for each protein cluster. in the peptide centric view the peptides with the same modifications are combined together and only the representative with the highest score is displayed. the spectrum viewer of maspectras enables manual inspection of the data by providing customizable zooming and printing features . the chromatogram viewer allows manual definition of the peak areas . the chromatograms of all charge states of the identified peptide are displayed. the quantitative comparison view offers the possibility to compare peptides with two different post translational modifications  or with one ptm and an unmodified version. the calculated peaks are displayed graphically together with a regression line.

pride export
maspectras has been designed to comply with the miape requirements and provide researchers export possibilities to other file formats . additionally, the export to the pride xml format is possible directly from the protein and peptide views and the resulting file can be submitted to pride repository  <cit> .

analysis of large proteomics data set
to demonstrate the utility of the maspectras we used data from a large-scale study recently published by kislinger et al.  <cit> . we analyzed the data from the heart cytosol compartment which comprised  <dig> sequest searches performed against a database obtained from the authors  containing the same amount of "decoy" proteins presented in inverted amino acid orientation. the files were imported, parsed, the data analyzed and the results exported in pride format. in the study of kislinger et al. a protein was accepted with a minimum of two high scoring spectra with a likelihood value >95% , which resulted in  <dig> protein identifications in the cytosol compartment. applying the same filter criteria and using the peptideprophet algorithm implemented in maspectras resulted in  <dig> protein identifications . the results of this analysis are shown in additional file  <dig> and the data can be downloaded at the maspectras application .

quantitative analysis
to evaluate the performance of the quantification tool we initiated a controlled experiment using mixture of icpl-labeled  proteins . icpl-labeled probes were mixed at  <dig> different ratios in triplicates . to demonstrate the capabilities of maspectras, the quantitative analysis was performed with msquant  <cit> , pepquan , and asapratio as implemented in maspectras. due to the fact that msquant lacks the ability to quantify samples in centroid mode, the automatic quantification of msquant and maspectras has been performed on profile mode data. additionally we compared the automatic quantification of maspectras in centroid mode and observed no significant deviation .

since in the centroid mode the data amount is smaller  the manual review and correction of the automatically calculated results has been conducted with centroid mode data. the reasons for the manual correction are:  there are additional peaks in a chromatogram in the m/z neighborhood;  the found peptides are not in the main peak but in a neighboring smaller peak. a ratio between each found light and heavily labeled peptide has been calculated, and from those ratios the mean value, the standard deviation, the relative error, and a regression line has been calculated as well . a filter for outlier removal has been applied to the automatically calculated ratios. for the manual evaluation, these automatically removed peptides were checked manually and the misquantifications due to the above mentioned reasons could be corrected. therefore the number of manually accepted peptides could be higher than the automatically accepted ones. the performance of the quantification with asapratio integrated in maspectras was superior compared to both msquant and pepquan. furthermore, for all ratios the relative error calculated was considerably lower than the relative error obtained with msquant and pepquan .

a filter for outlier removal has been applied to the automatically calculated ratios in maspectras. for the manual evaluation, these automatically removed peptides were checked manually and the misquantification due to wrong peak detection could be corrected. therefore the amount of manually accepted peptides could be higher than the automatically accepted ones. the quantification with asapratio integrated in maspectras performed superior compared to both, msquant and pepquan. furthermore, for all ratios the relative error calculated was considerably lower than the relative error obtained with msquant and pepquan.

discussion
we have developed an integrated platform for the analysis and management of proteomics lc-ms/ms data using state-of-the-art software technology. the uniqueness of the platform lies in the miape compliance, pride export, and the scalability of the system for computationally intensive tasks, in combination of common features for data import from common search engines, integration of peptide validation, protein grouping and quantification tools.

miape compliance and pride export are necessary to disseminate data and effectively analyze a proteomics experiment. as more and more researchers are adopting the standards, public repositories will not only enhance data sharing but will also enable data mining within and across experiments. surprisingly, although standards for data representation have been widely accepted, the necessary software tools are still missing. this can be partly explained by the volume and complexity of the generated data and by the heterogeneity of the used technologies. we have therefore positioned the beginning of the analytical pipeline of maspectras at the point at which the laboratory workflows converge, i.e. analysis of the data generated by the search engines.

the capability to import and parse data from five search engines makes the platform universal and independent of the workflow performed by the proteomics research group. the system is not confined to a specific manufacturer and can therefore be used in labs equipped with different instruments. moreover, maspectras is a system that provides the basis for consensus scoring between ms/ms search algorithms. it was recently suggested that the interpretation of the results from proteomics studies should be based on the analysis of the data using several search engines  <cit> . importing and parsing the results from search engines and side-by-side graphical representation of the results is a prerequisite for this type of analysis and would enhance correct identification of peptides. the results of the validation of our system using large proteomics data sets further support this observation. the differences in the results of the analyses are due to the different algorithms used for the likelihood calculation. in our system peptideprophet  <cit>  was used whereas in the study by kislinger et al.  <cit>  statquest  <cit>  was applied. we have selected peptideprophet algorithm based on the results of a benchmark study  <cit>  in which peptideprophet was ranked first with respect to the number of correctly identified peptide spectra. this study by kapp et al.  <cit>  showed also that the concordance between ms/ms search algorithms can vary up to 55% . important considerations when carrying out ms/ms database searches are not only the choice of the search engine, but also the selection of search parameters, the search strategy, and the chosen protein sequence database. evaluation of the performance of the used algorithms was beyond the scope of this study. further work need to be carried out to determine the number of independent scoring functions necessary to allow automated validation of peptide identifications. it should be noted that inclusion of additional validation algorithms in maspectras is straightforward due to the flexibility of the platform and the use of standard software technology.

the integration of peptide validation, protein grouping and quantification algorithms in conjunction with visualization tools is important for the usability and acceptability of the system. particularly the inclusion of a quantification algorithm in the pipeline is of interest since more and more quantitative studies are initiated. we have selected the asapratio algorithm for automated statistical analysis of protein abundance ratios  <cit>  and integrated it into our platform. the results of our validation experiment showed that the performance of asapratio was superior to msquant and pepquan. again, the modularity of the platform allows future integration of other quantification algorithms. moreover, the use of three-tier software architecture in which the presentation, the calculation and the database part are separated enables not only easier maintenance but also future changes like inclusion of additional algorithms as well as distribution of the computing load to several servers. we made use of the flexibility of this concept and developed a module for distributing the load to a computing cluster . tests with the asapratio algorithm showed that the computing time decreases linearly with the number of used processors.

CONCLUSIONS
in summary, a comprehensive platform has been developed for the management of proteomics data in a miape compliant manner. maspectras  provides the amenities needed for analysis,  features an automated analysis pipeline and unique analysis tools,  provides an easy export functionality for the submission of the data to public repositories, and is capable of managing the growing amount of mass spectrometry data in a scalable manner using parallel computing. given the unique features and the flexibility due to the use of standard software technology, our platform represents significant advance and could be of great interest to the proteomics community.

experimental procedures
materials
proteins were purchased from sigma as lyophylized, dry powder. solvents  and chemicals  were purchased from sigma, tfa  was from pierce. the icpl  chemicals kit was from serva electrophoresis this kit contained reduction solution with tcep  phosphine hydrochloride), cysteine blocking solution with iaa , stop solutions i and ii and the labeling reagent nicotinic acid n-hydroxysuccinimide ester as light  and heavy  form as solutions. trypsin was purchased from sigma at proteomics grade.

icpl labeling of proteins
proteins bovine serum albumin , human apotransferrin  and rabbit phosphorylase b  were dissolved with teab  buffer  in three vials to a final concentration of  <dig> mg/ml each. a  <dig> μl aliquot was used for reduction of disulfide bonds between cysteine side-chains and blocking of free cysteines. for reduction of disulfide bonds  <dig> μl of reduction solution were added to the aliquot and the reaction was carried out for  <dig> min at 60°c. after cooling samples to room temperature,  <dig> μl of cysteine blocking solution were added and the samples were sat in a dark cupboard for  <dig> min. to remove excess of blocking reagent  <dig> μl of stop solution i were added and samples were put on a shaker for  <dig> minutes. protein aliquots were split to two samples which contained  <dig> μl each. first row of samples was labeled with the 12c isotope by adding  <dig> μl of the nicotinic acid solution which contained the light reagent. second row was labeled with the heavy reagent and labeling reaction was carried out for  <dig> h and  <dig> min while shaking at room temperature.

proteolytic digest of proteins
protein solutions were diluted using  <dig> mm nh4hco <dig> solution to a final volume of  <dig> μl.  <dig> μl of a fresh prepared trypsin solution  were added and the proteolysis was carried out at 37°c over night in an incubator. the reaction was stopped by adding 10μl of 10% tfa. the peptide solutions were diluted with  <dig>  % tfa to give  <dig> nm final concentration. from these stock solutions samples for ms/ms analysis which contained defined ratios of heavy and light were made up by mixing the solutions of light and heavy labeled peptides.

hplc and mass spectrometry
to separate peptide mixtures prior to ms analysis, nano reverse phase high-performance liquid chromatography  was applied on the ultimate  <dig> dual gradient hplc system ,  <dig> % tfa, buffer b: 80% acn,  <dig> % tfa) on a pepmap separation column .  <dig> fm of each mixture was separated three times using the same trapping and separation column to reduce the quantification error which comes from hplc and mass spectrometry. a gradient from 0% b to 50% b in  <dig> min was applied for the separation; peptides were detected at  <dig> and  <dig> nm in the uv detector. the exit of the hplc was online coupled to the electrospray source of the ltq mass spectrometer . samples were analyzed in centroid mode first to test digest and labeling quality. for the quantitative analysis the ltq was operated in enhanced profile mode for survey scans to gain higher mass accuracy. samples were mass spectrometrically analyzed using a top one method, in which the most abundant signal of the ms survey scan was fragmented in the subsequent ms/ms event in the ion trap. although with this method a lower number of ms/ms spectra were acquired, the increased number of ms scans leads to a better determination of the eluting peaks and therefore provides improved quantification of peptides.

data analysis was done with the mascot daemon  <cit>  , bioworks  <dig>   <cit>   software packages using an in house database. to demonstrate the merging of results from all of the mentioned search engines the icpl labeled probes at an ratio of 1: <dig> were searched with spectrum mill a. <dig>    <cit> , x! tandem  <cit>   version  <dig> . <dig>  and omssa  <dig> . <dig>  <cit>  . the results were uploaded to maspectras and quantified automatically.

availability and requirements
• project name: maspectras

• stable instance of maspectras:  

• project home page: 

• operating system: solaris, linux, windows; the jclusterservice requires a unix/linux system

• programming language: java

• other requirements: java jdk  <dig> .x, oracle™ 9i or postgresql™  <dig> .x or mysql™  <dig> .xx/ <dig> .xx, server with at least  <dig> gb of main memory 

• license: igb-tug software license

• any restrictions to use by non-academics: igb-tug software license needed

installation: step-by-step instructions are provided at the projects web site together with files and scripts necessary.

the jboss instance housing the web-interface for the stable instance of maspectras is currently running on a dual opteron™ system  under centos-linux  <dig>  accessing an oracle™ 9i database instance on a sun™ v <dig> running under solaris™  <dig> as database management system. additionally the application server is attached to a storage area network  with a capacity of  <dig>  terabytes. regarding the high-performance computing infrastructure, maspectras accesses a  <dig> cpu computing cluster running under rocks/centos-linux  <dig>  and submitting the calculation tasks via sun grid engine  to the intel xeon based cluster nodes.

authors' contributions
jh designed the current version of maspectras. he was responsible for the implementation of the database, the development the data presentation and many parts of the business logic. gs, as <dig>  trb and ek implemented most of the parts of the analysis pipeline. gs developed the jclusterservice and the services provided for maspectras. trb integrated peptideprophet, as <dig> the protein clustering pipeline, and ek the peptide quantification and the chromatogram viewer. rr implemented the pride data export. as <dig> and km conducted the proteomics experiments. jh and as <dig> analyzed the biological data. km and ggt contributed to conception and design. zt was responsible for the overall conception and project coordination. all authors gave final approval of the version to be published.

supplementary material
additional file 1
comparison of maspectras to other proteomics tools. in this table the features of maspectras and other proteomics tools are listed next to one another.

click here for file

 additional file 2
maspectras database schema. the database schema of the maspectras application.

click here for file

 additional file 3
evaluation of the heart cytosol data of the study by kislinger. the data shows the found proteins by the study from kislinger and the ones by maspectras. for both of them only proteins with at least  <dig> first hit high-scoring spectra are accepted. to identify a high-scoring spectrum in the study of kislinger a likelihood p value <  <dig>  of the statquest score has been used, while in maspectras a peptideprophet score >  <dig>  has been applied.

click here for file

 additional file 4
quantification results and comparison with msquant and pepquan. this zipped folder contains the comparison of the quantification results from maspectras, msquant, and pepquan , the detailed quantification results of msquant , pepquan , the automatic quantification with maspectras , and the manual evaluation using centroid mode data with maspectras . furthermore the calculated regression lines of maspectras are included . the original data files used for the quantification are downloadable directly at the maspectras application .

click here for file

 acknowledgements
the authors thank the staff of the protein chemistry facility at the research institute of molecular pathology vienna, sandra morandell and stefan ascher, biocenter medical university innsbruck, manfred kollroser, institute of forensic medicine, medical university of graz, gerald rechberger, institute of molecular biosciences, university of graz, andreas scheucher, and thomas fuchs for valuable comments and contributions. we want to thank andrew emili and vincent fong from the donnelly centre for cellular and biomolecular research , university of toronto for providing the data for our study. this work is supported by the austrian federal ministry of education, science and culture gen-au projects "bioinformatics integration network ii"  and "austrian proteomics platform ii" . jürgen hartler was supported by a grant of the austrian academy of sciences .
