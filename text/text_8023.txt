BACKGROUND
pleiotropy and epistasis lie at the heart of much of evolutionary theory. together they give rise to the complex mapping between genotype and phenotype, and they can generate constraints on adaptation. pleiotropy is a major cause of genetic correlations, which can hinder the response to selection on one trait owing to its association with another  <cit> . pleiotropy can thus prevent traits from being independently optimized. however, even where pleiotropy does not present an absolute constraint , it can still prolong an approach to the optimum and lead to temporarily maladapted states  <cit> .

epistasis can also constrain evolutionary outcomes by pushing evolution along some paths and away from others  <cit> . in particular, reciprocal sign-epistasis for fitness is necessary  to generate rugged adaptive landscapes, with the potential to trap populations on local fitness peaks that are globally suboptimal  <cit> . despite the conceptual appeal of envisioning adaptation as a process that unfolds on rugged adaptive landscapes, it is generally difficult to observe that process  <cit> . even when there is evidence that populations have reached alternative peaks  <cit> , it can be difficult to determine key attributes of the adaptive landscape. for example, hybrids of low fitness could indicate an intervening valley, but whether the evolutionary trajectory actually traversed the valley is typically unknown. an alternative possibility is that the populations diverged around a ridge, such that the true adaptive landscape is shaped like the cone of a volcano rather than comprised of two peaks with an unavoidable valley between them  <cit> . thus, understanding the process of evolution on adaptive landscapes requires detailed knowledge of both the trajectory of the evolving populations and the fitness effects of the contributing mutations, but acquiring these data is not feasible in most systems.

avida is a software platform for performing experimental studies on evolving systems in a computational setting. in avida, self-replicating computer programs mutate, compete, and evolve in an open-ended manner  <cit> . several features of avida make it well suited for addressing questions in the realm of evolutionary genetics. first, the speed of the computational process makes it feasible to examine both short- and long-term evolutionary dynamics. second, individuals or entire populations can be saved and restored at a later time, permitting direct comparisons of evolved and ancestral genotypes. third, it is possible to describe the exact trajectory of all evolving populations and to determine the fitness effects of all mutations along the line of descent leading from the ancestor of an experiment to an evolved organism or population. fourth, a powerful set of genetic tools and tests are available, including one that generates the complete one-step  mutational neighborhood of any genotype of interest. fifth, with  <dig> different instructions possible at any site, and genome sizes ranging from tens to thousands of instructions, the number of possible genotypes in the system is vast, easily exceeding the number of atoms in the universe. it is thus possible to study evolution in genetically diverse populations that are potentially far removed from a state of equilibrium. sixth, perhaps the most important attribute of avida is the complex, nonlinear mapping between genotype and phenotype, a property that leads to the emergence of pleiotropy and epistasis. these last two qualities differentiate digital evolution from many other models or simulations of the evolutionary process. because of extensive pleiotropy and epistasis, evolution in avida potentially involves limitations and constraints on adaptation that are, at least conceptually, the same as those that limit biological evolution.

in this paper, we describe a set of experiments to examine the evolutionary response of genetically coupled functional traits in digital organisms. when multiple traits share an underlying genetic basis, they may not evolve independently, resulting in constraints on adaptation or even maladaptation  <cit> . artificial selection experiments can be useful for examining constraints  <cit> , and some studies have shown that genetically correlated traits can be uncoupled through artificial selection  <cit> . nevertheless, little is known about how genetically coupled traits influence long-term outcomes  <cit> . for example, theory suggests that genetic correlations are unlikely to constrain evolution permanently in an environment with only a single optimum  <cit> . however, genetic correlations can be important in directing evolution toward a particular adaptive peak in a multi-peaked environment, and thus for directing evolutionary outcomes over longer times scales  <cit> .

in digital organisms, the relevant traits are logic functions, i.e., computations that these organisms may evolve the ability to perform using numbers they input from their environment. computation of logic functions provides the organisms with additional energy, which they can use to reproduce. the specific computations that we examine here were identified in a previous study in which replicate populations evolved in an environment where only a single computation, the logic function equ, was directly selected  <cit> . a major result of that work was that selection to increase outputs of the equ computation often led to a correlated increase in the outputs of other, unselected computations. moreover, the reason for the correlated increases became apparent when we examined the way in which different computations were encoded in the genome. specifically, functions prone to correlated increases exhibited high degrees of genetic overlap with the selected equ function . this result indicated that pleiotropy—in the sense that the same portions of the genome determined the expression of multiple logic functions—was the cause of their correlated evolution. however, because only one trait was under selection, it was impossible to say whether the independent evolution of the logic functions would be constrained in any way by their genetic association.figure  <dig> genotype-phenotype maps for the ancestral organisms used in this study. each row represents one instruction, starting from the first instruction in the organism’s genome  to the final instruction . each column represents one of the logic functions performed by the ancestor. the color of each cell indicates what happens to the performance of a function when the instruction in that row is knocked out . white: knocking out the instruction does not affect performance of the function. gray: knocking out the instruction causes the function to be lost.  map for ancestor <dig>  note that every instruction that knocks out or also knocks out equ, but the reciprocal is not true.  map for ancestor <dig>  note that every instruction that knocks out either and or or also knocks out equ.



here we examine whether these functions are capable of evolving independently in a variety of environments that differ in the extent and direction of selection on each function. for each pair of functions, we examined their evolution in two types of environment; in the first case only one function was selected to increase , whereas in the second case one function was selected to increase while the other was selected to decrease. we show that correlated responses, while often asymmetric, could usually be broken when selection was applied in opposing directions on the two traits. in an interesting exception, two traits evolved coordinately despite selection in opposing directions, such that one trait evolved counter to its phenotypic optimum. we take advantage of the transparency of the avida system to explore this result, and we examine how the ruggedness of the adaptive landscape influences the evolution of these two traits.

methods
the avida system
avida is a research platform wherein computer programs—called digital organisms—self-replicate, mutate, compete, and evolve  <cit> . each digital organism consists of a genome  and its associated virtual hardware, including stacks and registers used for storing and manipulating numbers, respectively. the genome of a digital organism contains information for copying itself, such that execution of the instructions contained in the genome by a virtual cpu results in the production of an offspring program. the copy process is subject to random mutations, which provide the variation required for natural selection to occur. mutations can be substitutions, whereby an instruction in the parent genome is randomly replaced with a different one in the offspring. alternatively, they can be insertions or deletions, whereby extra instructions are added or lost, respectively. as in natural systems, some of these mutations are neutral, in that they do not affect the organism’s fitness. most other mutations are deleterious or lethal, because they either reduce the speed with which an organism produces copies of itself or destroy that ability altogether. a reduction in speed can take many forms, such as a reduced ability to acquire resources, a less efficient copying algorithm, or an increase in the amount of genetic material to be copied. occasionally, though, mutations are beneficial and result in higher rates of reproduction, and those mutants will tend to increase in frequency in the population over time.

digital organisms use virtual cpus to execute the instructions in their genomes and thereby replicate. cpu cycles are thus akin to energy—those organisms that acquire more cpu cycles from the environment process their genomes faster than those with fewer cpu cycles. all else being equal, faster processing should result in a higher rate of reproduction. selection can also favor organisms that use cpu cycles more efficiently, for example, by reducing the number of cpu cycles required to produce an offspring. alternatively, organisms can use cpu cycles to perform computations, which can, in turn, provide them with additional cpu cycles. these computations are logic functions that the organisms perform on binary numbers  input from their environment as a form of digital metabolism. the logic functions are as follows: not, nand, and, or, or_n, and_n, nor, xor, equ. they are described in greater detail elsewhere  <cit> . for the purposes of the current study, rewarded functions yield additional cpu cycles to those organisms that perform them, whereas punished functions cause cpu cycles to be taken away.

genomes may contain instructions that dynamically alter the position in the genome currently being expressed. for example, digital organisms typically use a loop to copy their genomes instruction by instruction, exiting the loop when the copy is complete. they can also perform logic functions using loops and may even incorporate logic functions into their copy loops, which can generate correlations between genome length and the number of times a logic function is performed. digital organisms often use the result of one computation as an input  for another computation; this re-use helps explain the genetic overlap among different functions and the tendency for the performance of one function to be correlated with that of another . this genetic integration is not required – the organisms can calculate these functions separately, although it may be less efficient to do so. moreover, there are multiple ways to build complex functions, such as equ, out of simpler functions. thus, the identity of the simpler functions that are integrated into the equ function will often depend, in part, on which of the simpler functions evolved first.

experimental design
in a previous study, we examined how non-selected functions were lost when generalist organisms evolved to specialize on a single function, equ, and we evaluated the relative roles of antagonistic pleiotropy versus mutation accumulation in causing these losses of function  <cit> . in the first stage of those experiments, we evolved a number of generalists that could perform a variety of logic operations, including equ. these generalist organisms then served as ancestors in the second part of the experiment, where replicate populations evolved to specialize on the equ function. here we focus on two of these generalist ancestors, called ancestor <dig> and ancestor <dig> for simplicity in the present study , because the replicate populations that evolved from these ancestors in the equ-only environment always maintained the or function, despite losing most other unrewarded functions. not only did the organisms that evolved from these ancestors fail to lose the or function, but their performance of or often increased in a correlated fashion with increased performance of equ, as measured across replicate populations   <cit> . organisms evolved from ancestor <dig> in an equ-only environment also showed correlated increases in their performance of the and function , in addition to or. for this reason, we also examined the relationship between these two functions and equ in populations evolved from ancestor <dig> table  <dig> 
number of times that nine different logic functions were performed during a digital organism’s lifetime



pop.
not
nand
and
orn
or
andn
nor
xor
equ
91
361
1
1
1
3
101
101
32
62
1
2
1
2
1
1
1
1
44
130
numbers are for the dominant genotypes from  <dig> replicate populations derived from ancestor <dig> in the +equ environment, where selection was for the equ trait only. the correlation coefficient, r, between or and equ is  <dig> . data from  <cit> .
number of times nine different logic functions were performed during a digital organism’s lifetime



pop.
not
nand
and
orn
or
andn
nor
xor
equ
118
118
118
100
100
298
141
141
141
77
77
152
104
104
104
165
165
322
208
208
208
185
185
369
124
124
124
109
109
325
numbers are for the dominant genotypes from  <dig> replicate populations derived from ancestor <dig> in the +equ environment, where selection was for the equ trait only. the correlation coefficient, r, between and and equ and between or and equ is  <dig>  in both cases. data from  <cit> .



each experiment tested the relationship between two functions that the ancestor was able to perform. specifically, we evolved replicate populations founded with either ancestor <dig> or ancestor <dig> in each of four environments. in two environments, we rewarded the performance of only one of the functions, while neither punishing nor rewarding the other. in the other two environments, we still rewarded one function but actively punished the performance of the other function by reducing an organism’s cpu cycles. to name each environment, we use + or - to indicate whether a function was rewarded or punished, respectively. for example, in the case of equ and or, we evolved replicate populations in the following four environments: +equ , +equ/-or , +or , and +or/-equ .

we replicated each evolution experiment  <dig> times, for a total of  <dig> runs . we ran all experiments for a period of  <dig>  updates, which was equal to an average of  <dig>  generations for ancestor <dig> and  <dig>  generations for ancestor <dig>  the difference in average number of generations reflects evolved differences in gestation time, with the populations that evolved from ancestor <dig> having longer generations because they spend more time performing logic functions. the genomic mutation rate for all experiments was set to  <dig>  mutations per genome per generation, which included point, insertion, and deletion mutations at rates of  <dig> ,  <dig> , and  <dig> , respectively. in addition to these explicitly defined mutations, digital organisms may also occasionally undergo implicit mutations that result in the deletion or duplication of multiple instructions. an implicit mutation typically follows an explicit mutation that causes the asymmetrical division of a copied genome, where one of the asymmetric copies can then faithfully and successfully self-replicate  <cit> . population sizes were fixed at  <dig> organisms, and each new offspring replaced a random organism in the population.

the number of cpu cycles that an organism receives per unit time  is determined by a value called merit. an organism’s base merit is proportional to its genome length, such that there is no inherent selection for the genomes to shrink or grow in length . rewards and penalties for performing the various logic functions increase or decrease this value, respectively. the magnitude of the rewards and penalties were based on the function’s complexity  <cit>  and the number of times it was performed per reproductive cycle. the functions were weighted as follows: equ at  <dig>  or at  <dig>  and and at  <dig>  these weights were multiplied by the number of times an organism performed the function to determine a penalty or reward. for example, if an organism performed equ three times in an environment where equ was rewarded, it received  <dig> times as many cpu cycles as an otherwise equivalent organism that did not perform equ. the multiplier could be positive or negative, however, depending on whether the function was rewarded or punished, respectively. thus, if the same organism also performed the and function three times, and if the environment penalized and while rewarding equ, then its net multiplier would be only  <dig>  relative to an organism that performed neither equ nor and.

at the end of each experimental run, we isolated the numerically dominant genotype from each population and measured its performance of the various logic functions. for focal populations of interest, we also determined the line of descent—that is, the sequence of all genotypes from the ancestor to this final organism. we examined the line of descent to identify the mutations that led to the loss of a particular function, and we determined the fitness effect of each of these mutations in the environment in which they arose as well as other environments. to quantify the fitness effects, we placed each genotype on the line of descent in a test cpu and assayed its ability to self-replicate, the number of instructions that it executed to produce an offspring , and the number of times that it performed each logic function. in a few rare cases, the test cpu failed to assign a fitness value to a genotype, which can occur when organisms have extremely long gestation times that exceed the time limit of the test cpu. by comparing the fitness of a given genotype to that of its immediate predecessor on the line of descent, we could examine how varying the magnitude and direction of selection on particular functions altered the topology of the adaptive landscape and thereby influenced the trajectory of evolution.

RESULTS
direct and correlated responses to selection on functions or and equ in ancestor1
figure  <dig> shows the results of experiments to examine the evolutionary association between or and equ in ancestor <dig>  at the start of the experiment, the ancestor could perform each of these functions only once. each point represents the average number of times a given function was performed by  <dig> independently evolved organisms, as a function of the environment in which they evolved. starting on the left side of the figure, the data show that the performance of or was higher in the two environments where it was rewarded, +or and +or/-equ, than in the two environments where it was either not rewarded or punished . this result indicates that or responded positively to direct selection. of the environments in which it was rewarded, the performance of or was higher when equ was punished than when it was not , although this difference was marginally non-significant . focusing on the lower left part of the figure, the performance of or also increased above the ancestral level of  <dig> as a correlated response to selection on equ . however, when or was punished, it was invariably lost . this result indicates that, despite the correlated response of or to selection for equ, the association between these functions could be broken when selection acted on them in opposing directions.figure  <dig> average performance of functions or and equ by organisms evolved from ancestor <dig>  ancestor <dig> performed each function only once per reproductive cycle. the y-axis shows the number of times a given logic function is output per reproductive cycle. each point represents the mean value, based on  <dig> replicate populations in each environment, based on the most common genotype at the end of the experiment. the environment is shown next to each point, and lines connect measurements made on the same set of populations. error bars indicate one standard error. all  <dig> populations lost or in the +equ/-or environment, and all  <dig> populations lost equ in both the +or/-equ and +or environments.



the response of equ to these same environments is shown on the right in figure  <dig>  its performance, like that of or, evolved to higher levels in the environments where it was directly selected . the performance of equ did not differ significantly depending on whether or was being punished or not , although equ tended to be performed more often when or was not punished. equ, again like or, was always lost when its performance was punished . however, equ was also invariably lost when only or was rewarded. these results thus reveal an asymmetry in the correlated responses: selection for equ  resulted in a correlated increase in the performance of or, but selection for or  led to the complete loss of equ.

this asymmetry is not surprising in light of the genotype-phenotype map for ancestor <dig> . this map shows that all the genomic instructions that, when deleted, knock out the or function also knock out the equ function. however, the reverse is not true: some instructions can be deleted that knock out equ without affecting the performance of or. put another way, the instructions encoding or are a subset of those encoding equ. the observed asymmetry in the correlated responses thus reflects the underlying asymmetry in the mapping between genotype and phenotype for these two traits.

direct and correlated responses to selection on functions or and equ in ancestor2
qualitatively similar patterns arose when we examined the correlation between or and equ in populations evolved from ancestor <dig> . this ancestor also performed or and equ only once. selection for equ  led to a correlated increase in or , but selection for or  led to the complete loss of equ . once again, the direct response to selection was stronger than the correlated response to selection, with the performance of or higher in the +or and +or/-equ treatments than in the +equ or +equ/-or environments . similarly, the performance of equ was higher in the +equ and +equ/-or treatments than in the +or and +or/-equ environments . in both cases, punishing performance of the alternative function had little effect on the evolution of the rewarded function; thus, the performance of or did not differ appreciably between the +or and +or/-equ treatments , and the performance of equ was indistinguishable in the +equ/-or and +equ treatments .figure  <dig> average performance of functions or, and, and equ by organisms evolved from ancestor <dig>  ancestor <dig> performed each function only once per reproductive cycle.  evolved performance of or and equ.  evolved performance of and and equ. see the legend to figure  <dig> for description of the points and error bars. all  <dig> populations lost or in the +equ/-or environment, and all  <dig> populations lost equ in both the +or/-equ and +or environments. also, all  <dig> populations lost equ in both the +and/-equ and the +and environments. however, only  <dig> populations lost and in the +equ/-and environment.



direct and correlated responses to selection on functions and and equ in ancestor2
at first glance, the pattern was similar when we examined the functions and and equ in populations that evolved from ancestor <dig> . selecting for the performance of equ resulted in a correlated increase in the performance of and from its ancestral level of  <dig> , but selecting for and caused equ to be invariably lost . this result was also expected from the genotype-phenotype map for this ancestor; all genomic instructions that, when deleted, knock out and also knock out equ, but the reverse is not true . in other words, the genome instructions encoding the and function are a subset of those encoding equ.

however, the outcomes of these experiments differed from the preceding ones in two important respects. first, the performance of and did not invariably decline to zero when it was selected against . in fact, only  <dig> of  <dig> populations that evolved in the +equ/-and environment lost the ability to perform that function . second, equ evolved to higher levels when and was punished than when it was not , and this difference was significant .table  <dig> 
effect of punishment on loss of other functions


selected and other functions:
other function was:

ancestor
selected
other
not punished
punished
in all experiments, the “selected” function was rewarded, whereas the “other” function was not. “not punished” and “punished” indicate the simultaneous direct selection, if any, on the other function. all experiments were replicated  <dig> times, and the numbers below indicate how often the other function was lost.



one possible explanation is that the higher performance of equ that evolved in the +equ/-and environment  did not translate into higher overall fitness. for example, it may have caused a correlated increase in replication rate, such that the two outcomes—although different—represented equally good evolutionary outcomes. to see if these organisms did indeed have equivalent fitness, we took the ones evolved in the +equ/-and environment and transplanted them to the +equ environment, where we assayed their fitness. surprisingly, we found that they were also significantly more fit in that environment than the organisms that had evolved there . a similar pattern, where a population reaches higher fitness in one environment through evolution in some alternative environment, has been observed in laboratory-evolved populations of bacteria  <cit>  – a phenomenon dubbed “roundabout selection”  <cit> . figure  <dig> demonstrates the occurrence of roundabout selection in exemplary populations. early in the runs , organisms evolving in the +equ/-and environment had much lower fitness in the +equ environment than those that were evolving in the +equ environment. however, by the end of the experiment , the same +equ/-and evolved population had achieved higher fitness in the +equ environment than the organisms that evolved in that environment.figure  <dig> snapshot of phenotypic variation present in two populations at two time points. each point represents an individual organism; the height of the point shows its fitness in the +equ environment, while the other two axes show the number of times it performs the equ and and functions. blue: organisms from a population evolving in the +equ environment. red: organisms from a population evolving in the +equ/-and environment. left: organisms that evolved in the +equ/-and environment  had lower fitness after  <dig>  updates, when they were measured in the +equ environment, compared to individuals that evolved in the +equ environment . right: by the end of the experiment , organisms that evolved in the +equ/-and environment  had attained higher fitness in the +equ environment than those that evolved in the +equ environment .



the finding that the +equ/-and populations, which started from the same ancestor but evolved in a different environment, had significantly higher fitness in the +equ environment than the populations that evolved there strongly suggests the existence of multiple adaptive peaks. more precisely, it demonstrates that higher fitness is possible in the +equ environment, and thus something must have prevented the +equ-evolved populations from reaching that higher fitness. nevertheless, although both equ performance and fitness differed on average between the populations evolved under the two treatments, there was substantial variation among populations within each treatment. thus, the results do not mean that populations in the +equ environment always failed to reach the higher fitness peak, but only that they did not reach it as often as the populations that evolved in the +equ/-and environment.

it is unclear what prevents the +equ-evolved populations from reaching higher fitness. we see two related possibilities. first, the punishment for performing the and function in the +equ/-and environment might alter the adaptive landscape in such a way that what was previously an adaptive valley becomes flat or even uphill from a now-sunken starting point . in this case, the +equ/-and populations could have moved into areas of genotypic space that would have been less accessible in the +equ environment owing to the intervening valley. when examined back in the +equ environment, these +equ/-and populations would occupy a higher peak . this process, whereby selection in a fluctuating environment permits populations to attain a higher fitness than would otherwise be possible, was described by wright as “mass selection under changing conditions”  <cit> .figure  <dig> two hypotheses about how ruggedness of the adaptive landscape might yield the observed results. schematic shows two hypotheses that could explain the counterintuitive result in which populations that evolved in the +equ/-and environment reached higher fitness in the +equ environment than did those that evolved in the +equ environment.  populations evolved to the lower fitness peak in the +equ environment  because an adaptive valley prevented them from finding the higher peak. however, that valley did not exist in the +equ/-and environment , allowing selection to drive the populations up the single peak. when organisms that evolved in the +equ/-and environment were assayed for their fitness in the +equ environment, they were on the higher peak.  the ancestor was between two adaptive peaks, either of which could be reached from that point. however, evolution in the +equ environment  predisposed populations toward the lower peak because its initial ascent was steeper or mutations were more likely to move the populations into its domain of attraction. by contrast, evolution in the +equ/-and environment  predisposed populations to evolve toward the higher peak.



a second possibility is that the ancestor sits at some distance from both peaks, and that either peak can potentially be reached from that starting point without crossing a valley . however, in the +equ environment, selection preferentially moves populations toward the lower peak, either because the initial ascent is steeper or because there are more paths leading to this peak than to the other. for example, progress toward the higher peak might require traversing a single narrow ridge, whereas there are many paths that lead to the lower peak. the key distinction between this hypothesis and the previous one is that there need not be an intervening adaptive valley that prevents the populations from finding the higher peak. rather, the evolutionary trajectory might depend on the likelihood of populations stumbling upon the rare genetic variants that permit them to travel along the narrow ridge to the higher peak. moreover, selection against and in the +equ/-and environment would favor the loss of and, perhaps increasing the likelihood of discovering the trajectory to this higher peak in the +equ/-and environment.

these hypotheses are not mutually exclusive; the correct explanation for the difference in the evolutionary trajectories might involve a mix of these and other processes. nevertheless, support for the first hypothesis would involve showing that the trajectories of populations in the +equ/-and environment involved genotypic intermediates that would have been deleterious had they arisen in the +equ environment, but which were neutral or even beneficial in the environment where they arose. evidence for the second hypothesis would require finding that evolution in the +equ/-and environment often involved the substitution of the same few mutations in the replicate populations, which would support the idea that there was a paucity of paths that lead to the higher peak. below, we present evidence that bears on these two possibilities.

fitness effects of mutations that resulted in the loss of and
the only difference between the +equ and +equ/-and environments was that performing and reduced fitness in the latter. thus, a good way to find mutations with differential fitness effects in the two environments would be to identify the mutations that caused the loss of and in the +equ/-and environment. forty-seven of the  <dig> populations that evolved in this environment lost and . this fact suggests that the adaptive-valley hypothesis is unlikely to explain fully the results, unless evolution in the +equ/-and environment reduced, but did not eliminate, the valley. otherwise, we would expect the loss of and in the +equ/-and environment to have occurred more often than it did or even invariably, as we saw in the five other cases we analyzed . in any case, we determined the fitness effects of the mutational steps that caused the loss of and in these  <dig> populations. in three populations, organisms along the line of descent lost and, regained it, and then lost it again. for these three cases, we count only the first loss. in one other population, the genotype that first lost the and function was not assigned a fitness by the test cpu , so we excluded this case from our analysis. in the remaining  <dig> populations, the mutations that caused the loss of and were universally beneficial in the +equ/-and environment where they arose. by contrast,  <dig> of these  <dig> mutational steps were deleterious when assayed in the +equ environment, a further nine were neutral, and only five were beneficial.  taken together, these data indicate that the and function was often retained in the +equ environment, at least in part, because its loss was usually caused by deleterious mutations. changing the environment by imposing selection against and thus opened up certain evolutionary paths that were not otherwise adaptive. this result provides clear support for our first hypothesis—that changing the environment altered the adaptive landscape in such a way that it allowed populations to evolve into regions that were otherwise inaccessible, enabling them to approach a peak of higher fitness.

the number of paths leading to the loss of and
our second hypothesis considered the relative likelihood of reaching one peak versus another owing to limitations on the production of relevant variation. to address it, we again focused on the mutations that caused the loss of the and function. we examined the line of descent in the  <dig> populations that lost and when it was selected against. in each case, we identified the particular genotype on this line that first lost the function. figure  <dig> shows the alignment of the genome sequences of these genotypes; the mutations that distinguish each of these genotypes from its immediate parent are highlighted.figure  <dig> genome alignment showing mutations associated with loss of the and function. aligned genome sequences of genotypes on the lines of descent in  <dig> populations, showing the mutations that were associated with the loss of the ability to perform the and function. the immediate parent of each genotype could perform and; thus, one or more of the mutations  caused the loss of that ability. each letter denotes a particular instruction; a red letter indicates a point mutation, whereas green letters and blue asterisks are insertion and deletion mutations, respectively. in three cases , the and function was lost and regained multiple times, and only the first loss is shown. several sequences have been trimmed owing to their length, and they show only the relevant portions of the genomes.



several patterns are immediately apparent. first, either one or two of the same four sites changed in  <dig> of the  <dig> replicate populations. in many instances, replicate populations even converged on the exact same substitution. second, and even more surprisingly, in  <dig>  cases, the loss of and was associated with a double mutation. given the fact that the genomic mutation rate was  <dig>  in these experiments, there should be, on average,  <dig>  mutations per genome per generation. because a genotype on the line of descent necessarily differs from its parent by at least one mutation, we calculated the probability that a particular genotype would differ from its parent genotype by two or more mutations. from the poisson distribution, only about  <dig> % of the genotypes with at least one mutation are expected to have two or more mutations. thus, the mutations that caused the loss of the and function involved double mutations almost  <dig> times more often than expected by chance. in fact, two pairs of sites were involved in  <dig> of the  <dig> double mutations . these results argue strongly that the number of ways of generating this beneficial phenotype – which required eliminating the and function while retaining the equ function and all other aspects of organismal performance – were very limited. importantly, the genotype-phenotype map  shows that there were many ways to knock out the and function; therefore, it must have been the pleiotropic effects of most such mutations on equ or other fitness components that placed such severe constraints on the mutations that could be substituted in the +equ/-and environment.

finally, the overrepresentation of double mutations among those genotypes that lost the and function is interesting its own right, because it implies that the component mutations were not beneficial when they arose individually in the +equ/-and environment. it supports the presence of an adaptive valley in a relevant part of the genotypic space in the +equ/-and environment, albeit a narrow valley that could be traversed by double mutations. this result may also explain why only some of the populations that evolved in this environment lost the and function, despite selection for that loss. although punishing the performance of and caused its loss far more often than when it was not punished , the mutations necessary to produce this loss while also retaining other critical functions were evidently so infrequent that many populations failed to lose it. thus, these results demonstrate that constraints on the types of variation available in these populations limited their ability to reach the alternative, higher adaptive peak.

discussion
we used self-replicating computer programs, or digital organisms, to study the evolution of pairs of traits, or functions, that are genetically integrated, such that selection on one function often led to correlated changes in the other function. we also used selection against the performance of the second function, or punishment, to investigate whether, and how easily, pairs of integrated functions could be disentangled. our results showed that correlated responses of genetically integrated functions were often highly asymmetric. these asymmetries were consistent with the ways in which these functions were encoded in the genome. in particular, the genomic sites that encoded one function were necessary for performing the other function, but the overlap was not complete. rather, the instructions encoding one function  were a subset of those required for the other function . this asymmetry in the encoding of these functions was reflected in the asymmetry of their correlated responses to selection.

this form of pleiotropy, where multiple traits have a shared underlying genetic basis, can potentially limit adaptation in both biological and digital organisms. moreover, the asymmetry of the correlated responses observed here – caused by the genes necessary for one trait being a subset of those required for another – is likely to be relevant to biological organisms as well, because that relationship arises whenever complex new functions are built on top of simpler ones  <cit> . asymmetric correlated responses to selection are commonly observed in selection experiments  <cit>  but, to our knowledge, asymmetries in the genetic encoding of the underlying traits has not been considered as a potential explanation. nevertheless, while pleiotropy is often discussed as a potential constraint on adaptation, it can also play a positive role. for example, pleiotropy can maintain functions in environments where they are not under selection and would thus be subject to destruction by mutation accumulation  <cit> . pleiotropy can also help maintain costly traits, such as cooperation, when the costly trait is functionally connected to another trait under strong positive selection  <cit> .

the functions that showed correlated increases in response to selection for performing equ were usually lost when they were selected against by punishing their performance. thus, even traits that are tightly coupled can often be uncoupled by strong selection that favors their disassociation. other studies that have examined selection on correlated traits have also shown that these associations can be modified by selection. for example, lenski  <cit>  showed that the fitness cost associated with a phage-resistance allele in escherichia coli could be reduced by substituting modifier alleles that compensated for pleiotropic effects. in experiments with the butterfly bicyclus anynana, beldade et al.  <cit>  showed that the relative size of anterior and posterior eyespots on their forewings could be uncoupled, albeit with some difficulty, while in that same species zijlstra et al.  <cit>  found that selection readily uncoupled the correlation between development time and eyespot size. delph et al.  <cit>  used artificial selection to try to break the correlation between flower size in males and females in the sexually dimorphic plant silene latifolia, with mixed success across replicate lines. the fact that strong genetic correlations can often be decoupled suggests that they might have been generated, in part, by previous selection favoring certain trait combinations, rather than resulting from evolutionarily inflexible internal constraints  <cit> . wright proposed a similar idea, suggesting that useless or even slightly deleterious traits might be retained for long periods of time owing to their genetic integration with other traits under selection for retention. he also emphasized, however, that these unused traits might be rapidly lost during times of “reorganization”  <cit> .

all of the otherwise positively correlated responses were completely reversed when one of the functions was punished, with one striking exception . in that case, over half of the  <dig> replicate populations that evolved in the +equ/−and environment, where performing equ was rewarded while and was punished, failed to lose the and function. even more surprising, populations in the +equ/-and environment evolved higher performance of equ than populations that evolved in the +equ environment, where performing and was not selected against. this difference also translated to higher overall fitness, such that populations that had evolved in the +equ/−and environment were significantly more fit in the +equ environment than those populations that evolved in that environment. this finding strongly suggested the existence of multiple adaptive peaks in the +equ environment, and it implied that the populations that evolved in the +equ environment were somehow prevented from reaching the higher peak.

we examined two hypotheses that might explain the failure of the +equ-evolved populations to reach the higher fitness peak achieved by the populations that evolved in the +equ/−and environment. the first hypothesis involved a difference in the adaptive landscape between the +equ/−and and the +equ environments, one that allowed populations in the +equ/−and environment to cross what was an adaptive valley in the +equ environment and thereby reach a peak of higher fitness. consistent with this hypothesis, mutations that caused the loss of and were usually beneficial in the +equ/−and environment where they arose, but the same mutations would have been deleterious had they arisen in the +equ environment. the finding that these mutations were deleterious in the +equ environment explains why so few populations in that environment lost the and function. that is, the evolutionary trajectories of populations in the +equ/−and environment often progressed through genotypic intermediates that would have been selected against – and hence inaccessible – in the +equ environment.

epistasis for fitness is required to generate rugged adaptive landscapes  <cit> . the work here and elsewhere indicates that such landscapes often emerge even in simple artificial-life systems  <cit> . although there is considerable evidence that rugged adaptive landscapes also exist in nature, wright’s shifting balance theory, which incorporates a particular set of evolutionary forces to explain adaptation that occurs by moving between fitness peaks, remains controversial  <cit> . part of the difficulty is that it is nearly impossible to determine in retrospect whether shifts between alternative adaptive peaks have occurred and, if so, by what mechanism. our results support the idea of rugged, multi-peaked adaptive landscapes. however, the shifts we observed were not caused by genetic drift that allowed populations to cross an adaptive valley. in fact, we saw quite the opposite:  <dig> of the  <dig> populations that evolved in the +equ environment never progressed toward the higher adaptive peak that involved the loss of the and function. only by changing the environment, such that movement toward the alternative peak became strongly beneficial, did we observe the peak shift. thus, our results do not support wright’s shifting balance theory; instead, they support his alternative hypothesis that mass selection in a changing environment can promote peak shifts. other studies using genetic algorithms have also shown that fluctuating environments can facilitate adaptation; not only can such fluctuations help populations avoid getting stuck on local fitness peaks, but they can sometimes lead to faster evolution  <cit> .

we also considered a second hypothesis for the failure of most populations that evolved in the +equ environment to find this alternative adaptive peak. the populations started at some distance from both peaks, and this hypothesis posits that the genetic coupling of the equ and and functions predisposed populations to evolve toward one or the other peak, depending on the environment. the importance of genetic correlations for movements on rugged adaptive landscapes was examined by price et al.  <cit> , who described how selection on a correlated trait could cause a population to shift between alternative adaptive peaks for some focal trait . similarly, schluter  <cit>  showed how genetic correlations could lead to evolution along “genetic lines of least resistance.” the broader importance of these models is that they illustrate how the structure of genetic variation can influence the trajectory of a population evolving on a rugged adaptive landscape.

CONCLUSIONS
pleiotropy and epistasis are widely hypothesized to constrain or channel evolutionary change. however, empirical studies of their effects are challenging, and even strictly theoretical analyses are often hampered by the complexity of adaptive landscapes, which limits the scope of such analyses to a few loci or requires other simplifying assumptions  <cit> . we used populations of digital organisms to examine how pleiotropy and epistasis together affected the potential for evolution to independently optimize pairs of genetically integrated traits. while some trait pairs could be readily disentangled by selection, we found one case where the two traits could not be easily disentangled, such that one trait evolved counter to its phenotypic optimum owing to stronger selection on the other trait. by taking advantage of the transparency of the evolutionary process in digital organisms, we demonstrated how the shape of the underlying adaptive landscape influenced the evolutionary trajectories of these populations, leading to either the maintenance or loss of the genetically integrated traits. our results thus shed new light on when and how pleiotropy and epistasis can constrain evolutionary outcomes, including their roles in promoting parallel or divergent evolutionary trajectories.

availability of supporting data
the datasets supporting the results presented in this article are available in the dryad digital repository https://datadryad.org/resource/doi: <dig> /dryad.hh <dig> 

competing interests

the authors declare that they have no competing interests.

authors’ contributions

eao, co, and rel conceived the study. eao performed the experiments and analyzed the data. eao, co, and rel wrote the manuscript. all authors read and approved the final manuscript.

we thank t. cooper for comments on an earlier version of this manuscript. c.o. and r.e.l. acknowledge support from the beacon center for the study of evolution in action  and previous nsf funding.
