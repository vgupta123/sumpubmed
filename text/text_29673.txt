BACKGROUND
one of the major unsolved questions in evolutionary biology is why the vast majority of species fails to adapt to conditions outside their present niche and, as a consequence, usually exhibit geographically confined range limits  <cit> . theoretical considerations suggest that local adaptation to conditions outside the current niche depends crucially on the geographic distribution of genetic and demographic characteristics across the species' range  <cit> .

one of the most influential framework on the distribution of genetic variation across species' ranges is the abundant-centre hypothesis   <cit> . it states that individuals of a species should become most abundant in areas where the conditions for reproduction and thus population growth are most favourable. in contrast, the number of populations and population density should decline towards areas with less advantageous environments until survival becomes impossible  <cit> . approaching the niche limits, populations should therefore become rarer; less populated and be subject to increased turn-over  <cit> . consequently, geographically marginal populations are expected to harbour less genetic variation and to be more strongly isolated from one another  <cit> , because the population size and its recurrent fluctuations determine the loss rate of genetic variation due to genetic drift.

asymmetrical gene-flow from larger sized, more abundant central populations to the range margins can counteract the previously described setting. such gene-flow may prevent local adaptation by constantly supplying 'maladapted' alleles from the core range into marginal populations  <cit> . under this scenario, the genetic variation in marginal populations should not differ much from the core area and population differentiation should be low.

a recent exhaustive review across different taxa showed that in about two out of three empirical studies genetic variability indeed decreased and population differentiation increased towards range margins, as expected under the ach  <cit> . however, most of these studies were based on rather small parts of the species range or a rather restricted number of populations. moreover, not only the geographic marginality of a population or its connectivity can influence the genetic variation present. only few studies so far tested possible alternative factors responsible for the observed patterns and none incorporated a historical perspective. we outline below other factors potentially influencing the distribution of genetic variability across species ranges. populations may not only be marginal with respect to their geographic position, but also with respect to their environmental habitat quality  <cit> . populations inhabiting low quality sites may be subject to increased population turn-over due to challenging environmental conditions and their variability, which may also negatively influence their genetic variability by increased drift  <cit> .

genetic variability across species ranges may also be influenced by local biotic interactions, in particular by competition with closely related, ecologically similar species or hybridisation with them in parapatric settings  <cit> . while the former process should result rather in a decrease of genetic variation due to increased population turnover, the latter is predicted to increase genetic diversity due to introgression of alleles in the hybrid zone  <cit> .

also contingent historic events like presence of geological dispersal barriers, population fragmentations and range expansions e.g. due to pleistocene glaciations in temperate regions may have exerted their lasting influence on the distribution of genetic variation within a species. here, the expectations on the distribution depend on the actual population history and may include decrease in genetic variation due to founder effects and population bottlenecks or an increase e.g. in secondary contact areas of previously isolated lineages  <cit> . table  <dig> summarises the factors expected to influence genetic variability across species ranges, their predicted influence on genetic variation and the population processes by which they act.

or
while most factors act on genetic variability in a one-way direction, the mating system both influences genetic variability and its prevalence can be driven by at least some of the above described factors. on the one hand, a mixed mating system decreases the effective population size. populations with a mixed mating system or purely selfing populations are therefore expected to experience increased drift  <cit> . local differences in the proportion of selfing versus outcrossing individuals can thus determine the distribution of genetic variability  <cit> . on the other hand, habitat stability  <cit> , population density and range expansions  <cit>  can influence the preference for selfing or outcrossing via mating system evolution or phenotypic plasticity.

the factors described above provide alternative, but not necessarily mutually exclusive explanations for the distribution of genetic variation. thus testing only a single factor at a time may lead to erroneous conclusions on the factors and processes governing the distribution of genetic variability over species' ranges  <cit> . empirical studies explicitly addressing these hypotheses comprehensively are therefore needed to understand these factors and processes more fully  <cit> .

in the present study, we tackled this issue using a pulmonate freshwater snail radix balthica as model organism. this species is one of several species in the morphologically cryptic species complex radix montfort  <dig>  <cit> . it is distributed throughout north-western europe from northern sweden to the south of france over a wide range of environmental conditions. as in many other pulmonate species  <cit> , r. balthica is suspected to have a mixed mating system  <cit> . without demanding a particular substrate or water quality, the species occurs in rather lentic water bodies like the shore zone of lowland lakes and ponds, oxbows, irrigation channels and fountains, but also in slow flowing rivers and streams  <cit> . like in most other non-flying freshwater organisms, active dispersal depends crucially on continuous habitat; however, water-fowl mediated passive transport is probably the major mechanism for dispersal among unconnected habitats  <cit> . with the mentioned characteristics, the species is typical in most regards for many freshwater molluscs and other freshwater invertebrates lacking active long range dispersal capacities.

since more than a single factor may contribute to the distribution of genetic variability, we analysed the population structure, mating system and simultaneously tested the influence of the various factors outlined above by assessing the geographic distribution of supposedly neutral nuclear and mitochondrial genetic variability across the species range of r. balthica using statistical modelling and model selection techniques.

RESULTS
sampling
we identified  <dig> individuals sampled from  <dig> sites as r. balthica with dna barcoding. together with previously identified r. balthica populations, this resulted in the first comprehensive molecularly confirmed estimate of the species range . in total, more than  <dig> sites with radix specimen were barcoded. for their spatial distribution and the distribution of other radix taxa, see additional file  <dig> 

including samples from previous studies, we genotyped  <dig> individuals from  <dig> sampling sites with eight microsatellite markers. for seven sites used for microsatellite analysis, less than ten individuals could be typed, leading to an unbalanced sampling. however, since omitting these sites from subsequent analyses did not change the results, we did not exclude them from the study. coi sequence data of more than  <dig> bp length was analysed from  <dig> individuals sampled at  <dig> sites .

population genetic structure
the average overall fst estimate was  <dig>  +/-  <dig>  . the bayesian cluster analysis indicated that the hypothesis of  <dig> clusters was most strongly supported by the data . the colour coded cluster memberships of each individual are depicted in figure  <dig>  there was no obvious geographical pattern; many sampling sites harboured individuals with a single majority cluster membership, but there were also sites with highly admixed individuals. also the distribution of the clusters followed no obvious pattern; sites with different clusters were found in close proximity while the same clusters were found hundreds of kilometres apart . the minimum population spanning tree revealed, that the most similar populations were, with few exceptions, arranged in southwest-northeast direction, however, regardless of geographic distance between them . this was also reflected in the plot of population pairwise fst s against the geographical distance . the null hypothesis of no influence of geographical distance on genetic similarity could not be rejected . it was thus not necessary to correct the following analyses for geographical distance among populations  <cit> .

genetic diversity and mating system estimates
the average expected heterozygosity over all loci  was  <dig>  +/-  <dig>   with an observed minimum of  <dig>   and maximum of  <dig>  . the average number of alleles per locus  was  <dig> , the overall rarefied value per sampling site and locus  <dig>  +/-  <dig> . the observed minimum value was  <dig>  , the maximum  <dig>  . the correlation between he and a was very high .

at least partial selfing was inferred for  <dig> out of  <dig> populations . the average population selfing rate was  <dig>  +/-  <dig> . the maximum value observed was a completely selfing population . the estimated degree of self-fertilisation was only poorly correlated to the genetic variability measures he and a .

a total of  <dig> mitochondrial haplotypes was identified over the species range. after rarefaction,  <dig>  +/-  <dig>  haplotypes per sampling site were observed, ranging from a single haplotype  up to  <dig>  different haplotypes .

all measures of diversity per sampling site and a graphical representation of their spatial distribution can be found in additional file  <dig> 

inference of population bottlenecks
it was possible to test the  <dig> non-selfing populations on signs of recent population bottlenecks. nine  of these showed a significant heterozygous excess. the populations with recent bottlenecks were widely distributed over the species range, but not in the recent expansion area .

effects of single predictors on genetic diversity and mating system
expected heterozygosity  was above the overall average in the sampling sites grouped by the predictor variables dispersal barrier , biotic interaction , lgm refugia , holocene expansion  and distance to range limit . by contrast, it was reduced relative to the mean in the expansion sampling sites  and environmentally marginal sites  this pattern was identical for the rarefied average number of alleles per locus .

the population selfing estimate  was on average lower than the overall average in sites grouped by the predictor variables bar, bio, ref, hol and size, while it was higher in exp, marg and lim. however, the variance was very high in each group .

the number of mitochondrial haplotypes  was increased at sites with presumed biotic interaction  and to a lesser extent in the holocene expansion sites . in all other groupings, the haplotype diversity was decreased with the strongest effect observed in the recent expansion sites .

as the difference in all diversity measures from the refugial area and the holocene expansion sites were not significantly different from zero, these categories were merged and contrasted against the effect of the recent expansion area in subsequent analyses.

selecting among models explaining the distribution of diversity
almost all models explained a portion of variance significantly larger than zero at the 5% error probability level or less. the models highlighted below were all highly significant .

the distribution of expected heterozygosity  was explained by the additive effect of four models with two or three variables. it was best supported by the additive effect of dispersal barriers  and expansion area  . in all models, exp explained by far most of the variability .

all possible predictor combinations were tested with generalised linear modelling and the support of all models by the data inferred by the akaike information criterion . akaike weights were calculated on the basis of all models tested. he = expected heterozygosity, a average number of rarefied alleles per locus, hmt number of rarefied mitochondrial haplotypes, s estimate of population selfing rate.

the rarefied number of alleles a was best explained by the additive effect of the factors biotic interaction  and exp , followed by bar, exp and environmental marginality  . also here, exp accounted for most of the explained variance .

variance in population selfing estimates was best explained by the additive effects of the four variables marg, exp, lim and size . however, only 49% of the total variance was explained by this model .

the haplotype variability was best explained by the additive effect of the model with three variables bar, exp and range limits  . the contribution of exp dominated the explained variance .

degree of differentiation among classes of populations
except for recent expansion , none of the other predictors yielded a significantly stronger or weaker structured grouping. in the recent expansion area, the average population pair-wise fst was  <dig>  units higher than in the remaining range. this difference proved to be significantly different from zero with an error probability of less than  <dig>  according to the randomisation test employed .

discussion
population structure is dominated by passive dispersal
like in most flightless freshwater taxa, dispersal of r. balthica between unconnected habitat patches depends on passive dispersal mechanisms  <cit> . in particular lentic habitats are ephemeral on an intermediate time-scale, thus selecting on populations with good dispersal capacities  <cit> . in r. balthica, this passive dispersal mechanism is presumably transportation by water fowl  <cit> . the minimum spanning tree  adds credibility to this assumption, as it clusters the respectively most similar populations mainly along the major bird migration route of the east atlantic flyway in southwest-northeast direction. the suggested connection pattern of the minimum spanning tree beard a striking resemblance to the inferred initial postglacial recolonisation dispersal pattern, where also bird migration routes were implicated  <cit> . this suggests that it either presents the remnant of this saltatory postglacial colonisation process or that recurrent dispersal follows the same routes. the connection lines of the respectively most similar populations appeared to be distance independent . this was also reflected in the spatial distribution of the inferred genotype clusters , where similar genotypes could be found hundreds of kilometres apart and/or in close proximity. both findings are substantiated by the complete lack of correlation between population differentiation and geographic distance . thus, distance independent passive transport seemed to be the primary process for gene-flow and/or colonisation of empty habitats along the southwest-northeast axis from virtually any part of the environmental gradient to any other. as a consequence of this unpredictable long range dispersal, colonisers originating from one part of the range must cope with very different environmental conditions upon arrival, arguing for a high phenotypic plasticity leading to the observed broad ecological tolerance.

despite the possibility for virtually unrestricted long range dispersal, only few populations were found to show admixture; most sites harboured primarily individuals that clearly belonged to the same inferred genotype cluster . this matched the observation that despite the large overall number of alleles per locus  and haplotypes , at single sites, only a very limited number of haplotypes was found . such a pattern is compatible with a scenario of site colonisation by one or few individuals, followed by a rapid increase of the population size, supported by the inferred mixed mating system in r. balthica. the widespread presence of selfing supplements thus the finding of a preferentially outcrossing system in a local flood-plain system of the rhône river by evanno et al.  <cit> .

indeed, the mating system, in particular the ability to reproduce uniparentally has long been considered to influence colonisation success  <cit> . selfing, like any form of uniparental reproduction, has the automatic advantage of increased gene-transmission to the next generation , thought to be balanced by the costs of inbreeding depression  <cit> . selfing can evolve as reproductive assurance strategy in the absence of mating partners, because it is always better to self-fertilise offspring whose fitness may suffer from inbreeding than to leave no offspring at all  <cit> . predominant selfing as mating system should therefore evolve mostly in cases where mating partners are rare or absent  <cit> , which is in particular the case for the first colonisers of a previously empty habitat. even darwin  <cit>  suggested that selfing or monoecious plants should expand their ranges more easily because already a single individual can found a reproducing population. indeed, the average proportion of selfing was slightly increased in the recent expansion area . such populations, made up of selfing and/or inbred individuals, would be relatively inert against the effect of subsequent gene-flow, as the establishment probability of immigrating alleles in a demographically large population is low  <cit> . another, not mutually exclusive explanation for the observed pattern would be short population persistence times, not allowing to accumulate genetic variation by gene-flow or mutation over time. other studies on freshwater snails have shown that high population turn-over and large size fluctuations are indeed typical for this taxon in general  <cit>  and for r. balthica in particular  <cit> . the bottleneck analysis with the non-selfing populations indicates that the population dynamics of the species is indeed high and not restricted to certain parts of the species range. nine out of  <dig> populations  tested showed signs of a population bottleneck within the last few generations .

the observed pattern could also point to a low incidence of successful dispersal events, resulting in low gene-flow rates. this is, however, difficult to evaluate, because direct estimates of passive dispersal rates are not available for freshwater snails.

current climate change left its mark in the distribution of genetic variability
the influence of the various predictors on all measures of genetic variability was remarkably similar in terms of direction of deviation from the overall mean . this confirmed that both nuclear and mitochondrial markers were subject to similar demographic forces, as might be expected in simultaneous hermaphroditic animals where e.g. sex biased dispersal or sex ratio bias are by definition impossible. the effects on the number of rarefied microsatellite alleles per locus a and expected heterozygosity hewere so similar  that we will discuss them together hereafter . even though selfing proved to be a substantial issue in r. balthica, the mating system population differences had a surprisingly low effect on the distribution of genetic variability, as shown by the low correlation between the degree of selfing and genetic variability measures heand a . this means that high selfing rates are not predominantly responsible for the loss of genetic variability. a low correlation further allowed investigating whether the factors considered influenced the mating system. the predominant factor in all models with substantial support was the recent, climate driven range expansion , which lowered the level of variability for all genetic markers considerably . this is not surprising, as an ongoing or recent expansion represents a non-equilibrium situation caused by repeated bottlenecks and founder events both of which decrease genetic variability  <cit> . in r. balthica, this effect might be enhanced by the possibility of self-fertilisation  <cit> , which facilitates the colonisation of newly emerging habitats by one or few individuals  <cit> . the factor exp was part of the best model to explain the distribution of selfing, showing that this trait may have played a role in the swift colonisation of newly emerging habitat in the course of a climate change. 'however, given enough time, one may predict that the effects of this non-recurrent, historic event at the current range limit will be transient and eventually assume a level of genetic variation either by immigration or mutation comparable to the remaining distribution area. in the past, this has obviously been the case for the expansion from the pleistocene refugia into the holocene expansion areas, where nowadays no appreciable difference in genetic variability was detectable .

biotic interactions had a positive effect on the intra-population variability of both nuclear and mitochondrial markers , however in the glm analysis only on a and hmt. according to eckert et al.  <cit> , such an increase may be explained by introgression from neighbouring, closely related species through inter-specific hybridisation. however, close inspection of the alleles and mitochondrial haplotypes found at the sampling sites in question revealed, with the exception of one private allele and one private haplotype in one population, respectively, solely alleles and haplotypes that also occurred in other r. balthica populations throughout the species' range. moreover, the allelic size range of the microsatellite loci in the potentially hybridising undescribed radix species is known  <cit>  and none of these alleles were found in the present data set. also the mitochondrial haplotypes found at these sites fit very well in the haplotype variability of r. balthica  <cit> . inter-specific hybridisation with neighbouring taxa is thus an unlikely explanation for the pattern reported here.

however, secondary contact of two more r. balthica lineages, e.g. from different refugial populations, could be the reason for the increase of genetic variability in these areas, as has been shown for other snail species  <cit> . several sites throughout the range show signs of increased nuclear admixture, in particular in southern sweden and around the lgm refugia . since most sites grouped in the variables bio are situated around the refugial area and overlap in these more than average variable populations with the predictor bar , an increased variability of nuclear and mitochondrial markers predicted by these variables may indeed be due to few admixed, secondary contact sites and not due to the biological process tested for.

population size, as rather crudely estimated from the size of the water body, had no detectable effect on the distribution of genetic variability . this may have two major reasons: first, population densities of more than  <dig> individuals per m <dig> were observed and thus population sizes of several thousand individuals even in small water bodies can be reached . thus, the effect of drift in small populations may be difficult to estimate from habitat size alone, but depend rather on the mating system or the founding history. second, freshwater snail populations are often subject to high population turnover or size fluctuations  <cit>  which lead to a discrepancy between the demographic and the effective population size and thus, potential loss of genetic variability. the high proportion of bottleneck populations detected, argue in that direction.

the size of a water body, however, did have an effect on the selfing rate . surprisingly, larger habitats were associated with more selfing. this is perhaps due to a dilution effect in larger habitats, which makes selfing as a reproductive assurance strategy more often necessary, because potential mates are less often encountered.

loss of variability by extinction-recolonisation dynamics was also substantiated by some of the models incorporating environmental marginality  that received substantial support in the data . sites facing more extreme environmental variation exhibited a slightly decreased level of genetic variability at nuclear markers . this is probably a result of extreme climatic events, like e.g. droughts too severe for the snails, flash-floods or too cold winters, in these areas. such events are expected to decrease genetic variation by decimating or extinguishing local populations and have been shown for r. balthica on a local scale  <cit> .

geographic marginality per se contributed little to the distribution of genetic variability in r. balthica . in nuclear marker loci, populations close to the inferred range limits even tended to harbour slightly more genetic variation than the total average . contrary to the majority of empirical studies reviewed by eckert et al.  <cit> , the distribution of genetic variability in r. balthica does not follow the predictions for the genetic extension of the ach. however, contrary to all previously discussed factors, the reliability of this inference depends crucially on the quality of the inference and sampling of the range and its margins. apart from the multitude of possible definitions for a species range  <cit> , its practical determination is inherently difficult, because it depends as well on the presence of unequivocally identified populations of the focal species in certain areas as on their absence in others. while the former often enough presents a practical problem due to unrecognised cryptic species <cit> , varying observation density and -quality  <cit> , it is virtually impossible to prove the absence of most species from an area. a species range and in particular its margin is therefore rather an effort-dependent estimate than a fact.

in the case of radix, unequivocal species determination is possible only with molecular methods and in particular r. balthica can be easily mistaken for other species  <cit> . therefore, range estimates of r. balthica based on morphology or even anatomy are prone to error and were not considered here. our estimate of the r. balthica range represents therefore the best currently available estimate. however, given the postglacial expansion history as inferred by phylogeography  <cit> , it cannot be excluded that the species also occurs in norway, ireland and scotland. on the other hand, the absence of r. balthica and the confirmed presence of other motus in the sites sampled in the south-west, south, south-east and east argues for a good coverage of the range limits in this area . for the south-east, the absence of r. balthica from the balkans is confirmed by another recent study  <cit> . in sweden, no radix snails were found further north than the populations reported here during our surveys. in total, we are confident that our sample represents i) the larger part of the present species range and ii) that with the possible exception of the north-west, also the range margins were adequately sampled.

however, the ach does not predict precisely, how variation should decrease towards range margins  <cit> . by testing the distance to the closest range margin, we assumed that the decline is steady and linear from the core range. if the decline is actually steep and starts only close to the margins, we would have missed it with our sample strategy, because we have probably missed the respectively most marginal populations. on the other hand, a range margin effect requires distance-dependent dispersal  <cit> , which we have shown to be absent in this species.

the factors evaluated here had also an impact on the variability in the mating system. the common quality of the factors identified to trigger changes in mating system towards more self-fertilisation seemed to be increased population turn-over . actually, self-fertilisation should be advantageous in any metapopulation system with high population turn-over rates  <cit> . however, even the best model  explained not even half of the variance in selfing, indicating that probably additional, untested factors significantly shaped the mating system.

CONCLUSIONS
the process mainly responsible for the population structure and distribution of genetic variability measured as nuclear and mitochondrial across the species range of r. balthica was found to be passive, probably bird-mediated, distance independent dispersal along a southwest to northeast axis. apart from the expected effects of a recent range expansion, other processes or factors suggested in the literature had only a minor effect on the geographic distribution of genetic variability. this dispersal mode led to high overall genetic variability, but locally impoverished populations. low local variability, along with high population turn-over  and range-wide dispersal dynamics argue against a high evolutionary potential  <cit> , this is because the increased local demographic drift acts on all parts of the genome, thus eroding not only the neutral variation but also standing genetic variation at coding or regulatory loci. it is thus likely that the observed population structure prevents local adaptation unless very strong selective forces counteract the strong drift  <cit> . a recent study could not detect local adaptation in r. balthica on a regional scale  <cit> . however, this supposition needs confirmation by ecological and physiological experiments for populations from the entire species range.

the particular population structure observed is thus probably the main explanation for the previously inferred intraspecific climatic niche conservatism from the lgm to the present day  <cit> . it is likely that the wide physiological tolerance to the array of conditions encountered in the current species range, finally also limits the distribution of r. balthica.

as in particular species inhabiting ephemeral habitats,  show similar population structures and dispersal dynamics  <cit> , the conclusions from the present study concerning expected niche conservatism may therefore also apply to many other taxa with similar characteristics.

