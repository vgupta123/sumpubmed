BACKGROUND
with the advance in technology for simultaneous acquisition of information on a number of genes' expression, the research area of bioinformatics is expanding into the reconstruction of a system composed of such genes. within a decade, the technology of cdna microarray experiments has been extensively developed, and its usage has exponentially increased. to improve the accuracy of microarray data, a number of techniques in post-processing microarray data were suggested from image analysis to statistical data processing. however, in spite of those efforts, the increase in accuracy of post-processing has a limit. after all, the improvement in wet-lab experiments, such as ensuring the conditions for sound spotting of cdna probes, is necessary to obtain reliable microarray data. most cdna microarray images contain spots in various shapes, including doughnut-shaped spots, which consist of pixels of high intensity at the perimeter and those of low intensity in the central area. such patterns of spot images are primarily due to the non-uniform distribution of cdna molecules while the cdna solution dries out during the microarray printing process.

spot morphology influences the measurement of gene expression levels. in particular, doughnut-shaped spots among them can often cause errors in measuring the signals. the inner hole can be either a blank or an area composed of pixels of lower signal than those in the perimeter . when calculating the measure of a spot signal, there is a large difference between the inclusion and exclusion of the hole in the spot area. if the hole is a complete blank, the area of the hole should be excluded from the spot area when the spot signal is measured. otherwise, it should not be excluded. to overcome this, several techniques have been developed for detecting the effective area of a spot  <cit> . they basically require some thresholds or parameters that are critical in determining the effective area. in a microarray image, each of the thousands of spots has a unique morphology and range of pixel intensity. therefore, it is not proper to use a single method to calculate gene expression levels from the spots in various shapes and characteristics.

since microarray became widely used for obtaining high-throughput gene expression data, several methods for simulating the microarray experiment have been suggested  <cit> . simulation is useful for designing and testing both the experiment and the analysis in real fields of study. this makes it possible to predict how the experiment will proceed or how well the analysis will work, before it is realized. in addition, it also provides synthetic data for analysis, when the realization is impossible due to a technical problem. previous methods focused on mimicking images generated by real cdna microarray experiments, and their parameters for determining the features of spots were based on certain probabilistic models. wierling et al. <cit>  classified spots into three categories: convex, crater-like, and cylindrical spots. balagurunathan et al. <cit>  simulated spots from simple circles and modified them by resizing radii, punching holes in the centre of spots, reshaping spots by removing chords, and enhancing intensities at the edge of spots. however, if it were not based on the investigation of physical and chemical nature, it would fail to correctly simulate and might confuse the experimenters with the results.

in this respect, it is important to study the formation of the variously shaped spots. the phenomenon of deposition of solute drop on the free surface has been studied  <cit> . deegan et al. explained the formation of a ring-shaped stain when a coffee drop evaporates as a result of "pinning" of the contact line. heim et al. <cit>  noticed the importance of study of the deposition of dna unspecifically bound on the microarray slide. however, microarray experiments are performed on slides specially manufactured for the purpose of increasing the sensitivity and the specificity of the results. a capping step to prevent non-specific adsorption on the support during hybridization and to decrease the background noise is often performed. to minimize the loss of cdna by hybridization or washing out, the surface of a glass slide is usually coated with substrates  <cit> . therefore, it is necessary to study the characteristics of cdna deposition by close investigation focused on the microarray experiment.

in this study, we generate a mathematical model of cdna deposition during the microarray spotting process using the contact printing technology by bringing parameters from cdna microarray experiments. this study analyzes cdna microarray spot formation and elucidates parameters which affect the spot morphology. the study of the origin of various patterns in spot morphology suggests how to manufacture good microarray spots.

RESULTS
cdna deposit model generation
we consider a drop of cdna solution on a glass slide coated with a chemical layer bearing ended function able to bind strongly with cdna. while the cdna solution is spotted on the slide, the strong adhesive forces of the chemical layer pull a drop of cdna solution reserved in the channel of the spotting pin, and the cdna molecules bind to the surface sites of the chemical layer so as to be immobilized. while the drop is dehydrated, the concentration of cdna changes in two ways simultaneously: 1) it increases due to the evaporation of water at the surface of the drop; 2) it also decreases due to the deposition of cdna molecules on the surface of the glass slide dried out from the rim of the drop. because water evaporates at an equal rate across the surface of the drop, the rate of change of the volume v is proportional to the surface area s, such that

 dvdt=−kes 

where ke is the evaporation constant reflecting the conditions of the experiment, such as temperature, humidity, and atmospheric pressure, etc.

when a drop of cdna solution is spotted on a glass slide, it has a hemispheric-like shape on the condition of the surface tension of the drop and the hydrophobicity of the original surface of the slide. if we consider the drop as a spherical cap, the volume and the surface area are proportional to the cube and the square of the contact radius r, such that v = kvr <dig> and s = ksr <dig>  kv and ks are the volume and the surface constants, respectively, such that

 kv=13πcsc⁡3θ2ks=2πcsc⁡2θ 

where θ is the contact angle of drop on the slide. because the drop undergoes morphological transition during evaporation, the contact angle is a function of time t, θ = θ , and the rate of change in volume is

 dvdt=3kvr2drdt+r3dkvdt. 

several studies have investigated the morphological transition of a drop during its evaporation  <cit> . at the beginning of evaporation, the contact line is pinned, i.e., while the contact radius remains constant, the drop diminishes in volume as the contact angle and the drop height decrease . when the contact angle and the drop height decrease to a certain level, the contact line is depinned, i.e., the contact radius starts to retract with the decrease of drop height and the contact angle becomes constant .

at state i, cdna molecules bind with the surface sites in the whole contact area of the drop in the chemical equilibrium state, as follows:

 cdnaρ+surfacesitex0−x⇄k−k+cdna⋅surfacesitexρ=xke−axfork=k+/k− 

where x <dig> is the surface site density on the support and a is the interaction factor for the non-ideal adsorption behaviour of macromolecules  <cit> . if a =  <dig>  the equation is the same as the langmuir adsorption equation, and otherwise, it describes the non-ideal adsorption behaviours, such as repulsion  and attraction  between molecules  <cit> . therefore, the equilibrium constant for the binding reaction is ke-ax, where k is the extrapolated equilibrium constant. the concentration of cdna, ρ, rises during evaporation without reduction of the radius of the drop, and, therefore, the quantity of cdna molecules, x, which bind with the surface sites in a unit area increases nonlinearly.

at state ii, as the contact line moves back, the cdna molecules start to deposit at the contact line. the recession of the contact line prevents cdna molecules from dissolving back into the drop. because the contact angle becomes constant, kv and ks do not vary with time, and, therefore, the second term on the right-hand side of the equation  can be omitted. then the rate of change in the contact radius can be also constant, as in

 drdt=−13keks/kv=−κ. 

let ρ represent the concentration of cdna at time t when the contact radius becomes r. if we assume that the density of the surface sites is constant in the contact area of a given drop, then

 ρ=initialquantity of cdna−depositedcdnainitialvolumeofdrop−evaporated water=ρv0−∫0t2πrxκdτv0−∫0tkesdτ 

where ρis the cdna concentration at the moment beginning deposition, and v <dig> is the initial volume of the drop. then, equation  can be simplified under the assumption that the contact angle is constant after the beginning of cdna deposition, such as

 ddtρ=3κr0−κtρ−2πκkv2x 

where r <dig> = r. from the temporal derivative of the concentration of the drop, we can derive its radial derivative, as in

 dρdr=−3ρr+2πkvxr <dig>  

the radial derivative of the deposit can be obtained from equation  and , as follows:

 dxdr=x2x0ρke−ax+ax <dig>  

the solution of equation  is the density of cdna deposit at the distance r from the centre, which can be solved by an ordinary differential equation solver with the four parameters, x <dig>  k, a, and kv.

spot simulation
from a real microarray image  <cit> , we identified the three types of spots . using the radial cdna deposit profile obtained from equation  with varying parameters, x <dig>  k, a, and kv, we obtained several types of radial cdna deposit profiles .

doughnut-shaped spot
the doughnut-shaped spot was defined as the spot having a thin rim of high density of deposited cdna and a large hole of very low density, approximated to zero . the diameters of the inner hole of the doughnut-shaped spots were measured by varying the parameters. histograms of the density of deposited cdna were bimodal, which had a peak at zero . if the inner hole is included in measuring the signal, then there will be a discrepancy between the measures and the true value. to verify which parameter can influence the morphology of the doughnut-shaped spot, we changed each parameter by  <dig> steps while the others were fixed. the inner hole was decreased by increasing a, and kv and decreasing x <dig> and k .

peak-shaped spot
the peak-shaped spot was defined as a spot having the highest density at the central region and a declining density at the region farther from the centre . because the peak-shaped spot can have an obscure boundary with the background, the edge of the spot can often be determined by the threshold. the histogram of the density of deposited cdna was skewed to the right . therefore, the mean density of deposited cdna is lower than the median value. furthermore, the measure can vary with how large an area of spot is included.

volcano-shaped spot
we defined the peak-shaped spot having a small hole in its peak as the volcano-shaped spot because its 3d image resembles a volcano . the volcanic-shaped spot has characteristics of both the doughnut-shaped spot and the peak-shaped spot .

simulated cdna deposit
using the radial profile of cdna deposits and the spot template images, we simulated the deposition of cdna in a virtual spot. in each spot template image, we set coordinates of pixels on the edge contour and centre of the spot area . using the distance from the centre to each pixel on the edge contour, we calculated cdna concentration at the moment when the contact radius becomes r, and the quantity of cdna molecules that bind with the surface sites in a unit area .

parameter estimation from real microarray images
the spot morphology varies with the size of the end of the spotting pin tip, the volume of sample delivered, the surface tension of the drop, the hydrophobicity of the surface of the slide, and so on. it has been proven that the increase in viscosity and contact angle of a micro-drop shrinks the initial size of the drop  <cit> . using the data and equation , we calculated the volume constants and the contact angles of the common micro-drops at the moment of being spotted on the glass slides, with the data of the spot diameters and the volumes of delivered sample provided by telechem international, inc.  <cit> . we found that the initial drop in state i has a wide variety in morphology, from a sphere-like shape with a small contact area  to a flat spherical cap shape with a large contact area .

we estimated the four parameters from the real microarray spot images. our model is one of the constrained nonlinear optimization  problems, so that the optimum values of the parameters of the ordinary differential equation were obtained by sequential quadratic programming   <cit> , with the least squares method, as follows:

 minimizem=∑i=1n) <dig> 

 subject to eq. 

where θ = , yi is the normalized pixel intensity of a real microarray spot at distance ri from the centre of the spot. sqp was performed on the spots of which outer rims are circular using their radial profiles . because the number of pixels in a spot is not enough to fit the model, we inserted  <dig> dummy data points between every pixel point on the radial profile by using cubic hermite spline interpolation  <cit> . from each image, five spots representing each type of spot shape were selected. the results of the study of the microarray scanning process indicated that the range of the concentration of mrna of thousands of genes in a sample is much wider than the dynamic range of microarray scanners  <cit> . if the microarray scanner reads the signal out of the linear dynamic range, the radial profile of the spot deposit would be distorted. to focus on the physical phenomenon of the deposition of cdna molecules, the fitting was performed on a limited number of spot images whose pixel intensities were proper to be within the linear dynamic range. the estimated values of x <dig> and k of the doughnut-shaped spots were about ten times as high as those of the peak-shaped spots, while a and kv of the former were lower than those of the latter . the macromolecular interaction factor, a, is usually a positive value because cdna molecules are usually negatively charged, and so there is a repulsive force between cdna molecules. however, their electrical characteristics can be changed, depending on the ph of the buffer solution. the estimated parameters of the volcano-shaped spots were highly variable. because the volcano-shaped spots contained the characteristics of both the doughnut-shaped spot and the peak-shaped spot, they have a wide variety in the morphology. table  <dig> and table  <dig> show that the value of x <dig> is also highly dependent on the slide.

* this image was obtained from stanford microarray database  <cit> : experiment id, 50150; experiment name, mmaf array batch on pll qc-1; category, quality control; subcategory, array batch qc; slide name, mmaf <dig> 

** standard deviation.

*** mean squared deviation, msd=1n∑i=1n <dig> 

† the spot shape was close to the doughnut-shape.

†† the spot shape was close to the peak-shape.

* this image was obtained from stanford microarray database  <cit> : experiment id, 50151; experiment name, mmaf array batch on pll qc-2; category, quality control; subcategory, array batch qc; slide name, mmaf <dig> 

** standard deviation.

*** mean squared deviation, msd=1n∑i=1n <dig> 

† the spot shape was close to the doughnut-shape.

†† the spot shape was close to the peak-shape.

discussion
unlike the ring-shaped stain formed during the evaporation of a coffee drop, cdna microarray images produce spots of various shapes, even in the same image. a solution to the coffee drop problem can partly explain the doughnut-shaped spot, which is one extreme of spot morphology in cdna microarray images. doughnut-shaped spots have frequently appeared in microarray images. in spite of the effort to prevent such spots from being generated, there is still an uneven density of signals in a single spot. in this study, we devised a generalized mathematical model that can manifest a wide spectrum of spot morphology.

the doughnut-shaped spot would be produced by experiment under the condition that a large quantity of cdna is deposited early on, and so the concentration of the drop solution is quickly lowered. such a situation can occur when the adsorption reaction is facilitated by a high surface site density, a large equilibrium constant of the binding reaction, and a low repulsion or attraction between cdna molecules, or when the initial drop has a flat spherical cap shape. unlike the doughnut-shaped spot, the peak-shaped spot would be produced under the condition that cdna is not likely deposited early on, and the concentration of the drop solution continually increases due to the accumulated cdna, and so the quantity of the deposited cdna can be the maximum at the centre. such a situation can occur when the adsorption reaction is impeded by a low surface site density, a small equilibrium constant of the binding reaction, and a high repulsion between cdna molecules, or when the initial drop has a sphere-like shape.

it is known that the composition of buffer solution changes the spot morphology  <cit> . the optimal composition of buffer solution has been investigated by including detergent or betaine to  <dig> × ssc or 50% dimethyl-sulfoxide . it is known that dmso decreases the surface tension of drop solution during evaporation, while both  <dig> × ssc and  <dig> × ssc with betaine increase the surface tension  <cit> . the decrease of surface tension is accompanied with a decrease in the contact angle and kv. moreover, dmso denatures dna to be bound well with surface sites  <cit> , which means the increases of the equilibrium constant for the binding reaction, ke-ax. putting them together, dmso would decrease kv and a, and increase k. figure  <dig> and  <dig> show that the doughnut shape is aggravated by increasing k and x <dig> and decreasing kv and a. as a result, dmso would aggravate the doughnut shape. in addition, there is a study that the length and the sequence arrangement of dna molecules would influence on the morphological organization of the deposit  <cit> . the macromolecular interaction factor, a, would reflect the length and sequence arrangement of dna molecules.

the extrapolated equilibrium constant for the binding reaction k also reflects the condition of the slide surface. while homemade poly-l-lysine-coated glass slides have been widely used, several commercial microarray slides are now preferred, such as the fmb cdna slide , arrayit superamine and superaldehyde slides . it is known that cmt-gaps™ slides  makes the spot morphology much more uniform by preventing doughnut shape formation  <cit> . it can be assumed that the slides are manufactured to have the optimal binding efficiency. the surface site density, x <dig>  affects the efficiency of cdna binding. the increase in x <dig> facilitates the forward reaction of equation  and vice versa.

the uneven density of cdna can cause errors in measuring the ratio of gene expression. let γ <dig> and γ <dig> be the concentration of mrna of the control  and experiment samples , respectively. the quantity of hybridized mrna with cdna in a unit area is determined in an equilibrium state, such as

 cy3γ3+cy5γ5+cdnax−x3−x5⇄kh−kh+cy3⋅cdnax3+cy5⋅cdnax5γ5γ3=1k2x5x3fork=kh+/kh− 

where x is the local density of cdna, and x <dig> and x <dig> represent the quantity of hybridized mrna of both samples in a unit area. in equation , the ratio of x <dig> to x <dig> can be linear to the ratio of mrna concentration only when the quantity of hybridized mrna can be approximated to be linear to the concentration of mrna in the solution. where the density of cdna is much lower, such as in the centre of the doughnut-shaped spot, the quantity of the hybridized mrna is saturated early in this region. because the concentration of mrna is uniform in the solution, the quantity of hybridized mrna cannot be linear to the concentration of mrna. then the ratio of the signal fails to reflect the original ratio of mrna expression. when we assume that x, the local density of cdna, is much larger than , equation  can be simplified, as follows:

 γ5γ3=1khx2x5x <dig>  

we have estimated parameters from real microarray images, but not all spot images were successful. it was practically impossible to fit our model equation to the doughnut-shaped spots, whose centre part has significantly high intensity. table  <dig> and table  <dig> show the mean squared deviation  between real and estimated data, as the goodness-of-fit measure. msds obtained from the doughnut-shaped spots were relatively larger than those of the other spots. we expect this problem originates from two major reasons: the effect of diffusion when the microarray slide passes through the hybridization process, and nonlinear transformation of spot signals to image intensity when the region out of dynamic range of the microarray scanner was used in converting spot signals. the effect of hybridization on the change in cdna density is still controversial. tran et al. <cit>  claimed that dna spotted on a glass slide diffuses during hybridization. however, this conflicts with the opinion of pappaert et al. <cit> , who claimed that the doughnut shape occurs not only from the uneven distribution of dna deposition but also from the hybridization process. we observed a few microarray images that have concentric circles in the spots. even though we did not include such phenomenon in this study, it is considered a result of the repetition of pinning and depinning of the contact line  <cit> , and should be investigated further.

CONCLUSIONS
we developed a governing equation that can explain the dynamics of cdna deposition during evaporation of a drop in the microarray spotting process. experimental conditions were parameterized and included in the governing equation. the parameters determining the spot morphology were brought from the physical and chemical factors. this explains how various spot shapes can exist and suggests which parameters are to be adjusted for obtaining a good spot. this system is able to explore the cdna microarray spotting process in a predictable, manageable and descriptive manner. we hope it provides a way to predict the incidents that can occur during a real cdna microarray experiment, and produce useful data for several research applications involving cdna microarrays.

