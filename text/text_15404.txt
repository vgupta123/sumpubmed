BACKGROUND
understanding the population-genetic forces behind the observed variation among human genome sequences is vital to deciphering the genetic causes of phenotypic variation among humans. the phenomena that influence the density of human snps include  variation-introducing events that are empirically observable, such as, point-mutations, recombinations, and activities of various transposable elements that may result from the counteraction of various dna damage and repair pathways , as well as  genealogy-affecting events that are historical and generally unobserved, such as population dynamics, population structure, and natural selection. a biological understanding of the observed genomic variation in snp density, by means of explicit population-genetic models of coalescence in the presence of recombination and mutation, must incorporate any interplay among the heterogeneities in the above phenomena. here we strive for an empirically sound understanding of the observed human snp density, as determined by a genome-wide alignment of two different consensus sequences, by accounting for the empirically observable mutational and recombinational heterogeneities under the simplest model of population history . the two sequences are the ncbi human genome sequence and the sequence produced by celera genomics  <cit> . our snp density data were obtained from first aligning the celera consensus sequence to the ncbi assembly and then counting the number of snps in bins of  <dig> kb , as was done in section  <dig> of the above study  <cit> . next, we build simple models for the distribution of snp density from random samples of size  <dig> from a locus that is  <dig> kb in length. our objective is to explain as much of this simple measure of diversity as possible, under empirically sound null hypotheses that include coarse-grained, genome-wide measurements of recombinational variation.

RESULTS
two approaches toward modeling are taken. the first approach is descriptive and employs hierarchical poisson models to obtain better fits than the homogeneous poisson distribution used earlier  <cit> . insights gained from the first approach inform the second approach. the second approach is non-descriptive and population-genetic with biologically interpretable parameters. it employs mixtures of snp densities simulated under the coalescent with different mutation and recombination rates to obtain a better fit to the observed snp density distribution. this approach introduces heterogeneity into the coalescent-based simulation of snp density that was shown to produce a poor fit under the assumptions of genome-wide homogeneity and equality of mutation and recombination rates  <cit> . the simple closed-form expressions used in the paper are elementary results in coalescent theory  <cit> .

descriptive hierarchical poisson models
let Λ and t be the parameters in the mass function of a poisson distribution given by pr = e-Λtx/x!. the random variables Λ and t are generally proxies for relative mutation rate and the sum of branch lengths of the coalescent trees for all the non-recombining segment of the  <dig> kb locus, respectively. in other words, t is a proxy for the sum of the branch lengths of the ancestral recombination graph  of our sample of size  <dig> at a locus that is  <dig> kb long. the random variable x represents the count of snps in contiguous  <dig> kb intervals from an alignment of two human genomes. in this hierarchical scheme, heterogeneities are modeled by the gamma and beta probability density functions , g and b , respectively, as described in methods. we chose the gamma distribution g to model t for the following reasons. when there is no recombination, the depth of the coalescent tree of two samples is exponentially distributed with rate parameter  <dig>  i.e., g. and when there are n sites with free recombination in between them, the sum of the n independent and exponentially distributed depths is g. thus, t is only a mathematically convenient proxy for the arg-size of our sample of size  <dig>  since t ~ g does not explicitly capture the distribution of arg-size for intermediate levels of intra-locus recombination among sites at our locus. we use the relatively flexible beta family on  <cit>  to model, Λ which is a proxy for relative mutation rate. the poisson distribution for snp density follows from the assumption of the infinitely-many-sites mutational model under selective neutrality, where mutations hit a site at most once according to the product of the total length of the site-specific coalescent tree and the site-specific relative mutation rate. therefore, such hierarchical poisson models are merely descriptive, as they are built via mathematically convenient beta and gamma distributed random variables Λ and t that act as proxies for the relative mutation rate and the arg-size, respectively.

the likelihood function for each of the following hierarchical poisson models was maximized with the newton's method from several random initial conditions. we use the akaike information criterion   <cit>  to make model comparisons. for a given model aic = - <dig> log + 2k, where ml is the maximum likelihood value and k is the number of parameters in the model. in the hierarchical poisson model a, we allow t ~ g, while Λ is fixed at  <dig>  the fit to the data  improved in comparison to the homogeneous poisson fit which completely ignores the underlying ancestral recombination process. thus, when the gamma distribution is used to approximate the distribution of the sum of all branch lengths of the ancestral recombination graph  of a locus, the observed variance is better explained. model a is mutationally homogeneous as Λ, the proxy for mutation rate, is fixed. in order to allow variation, a hierarchical poisson model a' that restricts t to a constant parameter λ while allowing Λ to be beta distributed ) was fit to the data. the fit was significantly better than that of model a. thus, modeling heterogeneity in mutation rates, via the beta distributed proxy Λ, across the different  <dig> kb loci gives better fits to the snp density distribution. when we allowed both Λ to be beta distributed and t to be gamma distributed, we get the hierarchical poisson model b. as shown in figure  <dig>  the fit is significantly better to the observed data when heterogeneities in both mutation and recombination are approximately accounted for through the proxies in model b. the results of the maximum likelihood  analysis of these four poisson models are summarized in table  <dig>  the first and second moments  under the maximum likelihood estimates are also shown for each model in the table. note that the means are almost the same but the variances vary considerably. if one wants a data-descriptive fit to the snp density distribution, then model b is a good candidate. with the arrival of more refined data  one could consider further generalizations of such hierarchical poisson models along the zero-inflated class  <cit> , for instance, to obtain better descriptive fits. unfortunately, the best-fitted parameters of such descriptive models lack any explicit biological interpretability, in terms of standard population-genetic models of reproduction. guided by insights from these descriptive hierarchical poisson models, we analyze the simplest population-genetic model of the neutral coalescent with an explicit accounting for heterogeneities in both mutation and recombination rates. we use a simulated maximum likelihood framework  <cit>  for parameter estimation.

 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf7oabgaqcaaaa@2e77@ =  <dig> , μ^
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf8oqbgaqcaaaa@2e79@ =  <dig> , σ2_
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqiaaqaaggaciab=n7annaabaaaleaacqaixaqmaeqaaagccaglcmaaaaa@3042@ =  <dig> , γ2_
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqiaaqaaggaciab=n7annaabaaaleaacqaiyagmaeqaaagccaglcmaaaaa@3044@ =  <dig> , μ^
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf7oabgaqcaaaa@2e77@ =  <dig> , β1_
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqiaaqaaggaciab=j7ainaabaaaleaacqaixaqmaeqaaagccaglcmaaaaa@303c@ =  <dig> , β2_
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf8oqbgaqcaaaa@2e79@ =  <dig> , σ2_
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqiaaqaaggaciab=n7annaabaaaleaacqaixaqmaeqaaagccaglcmaaaaa@3042@ =  <dig> , γ2_
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqiaaqaaggaciab=n7annaabaaaleaacqaiyagmaeqaaagccaglcmaaaaa@3044@ =  <dig> , β1_
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqiaaqaaggaciab=j7ainaabaaaleaacqaiyagmaeqaaagccaglcmaaaaa@303e@ =  <dig> , μ^
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf8oqbgaqcaaaa@2e79@ =  <dig> , σ2_
the last two columns give the maximum log likelihood values and the translated akaike information criterion, aic* = aic -  <dig> 

population-genetic coalescent mixture models
a panmictic, wright-fisher, neutral coalescent model with a constant effective population size of  <dig>  diploid individuals was assumed to simulate the distribution of the number of segregating sites at a locus of  <dig> kb evolving under an infinitely-many-sites mutation model using the c program ms  <cit> . the scaled product of the effective population size  and the mutation rate per locus per generation  is denoted by θ = 4neμ. the recombination rate r is the probability of cross-over per generation between the ends of the locus being simulated and its scaled product with ne is denoted by ρ = 4ner.

in the absence of recombination and with constant mutation rates, the distribution of snps is known to have an explicit form. the coalescent tree is identical for every nucleotide site in the locus in any given realization of the coalescent process of two samples. since the rescaled time to the coalescent event and the mutation event are exponentially distributed with rates  <dig> and θ, respectively, the probability of a mutation event before the coalescent event is θ/. thus, the probability of observing x mutations at our locus before the coalescent event is )x 1/. in other words, the probability of observing x snps at a locus when r =  <dig> is geometrically distributed with parameter 1/.

it is also known that as the recombination rate at our locus approaches infinity, the distribution of snps approaches a poisson distribution with parameter θ. this can be seen from the following argument. high levels of recombination assures that the coalescent tree at each site is independent of those at other sites. thus, for a locus with n sites, the probability of observing x snps is )x)n−x
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqadaqaauaabeqaceaaaeaacqwgubgbaeaacqwg4baeaaaacagloagaayzkaawaaewaaeaadawcgaqaamaalaaabaaccigae8hudehabagaemoba4gaaaqaamaabmaabagaegymaejaey4kasyaasaaaeaacqwf4oqcaeaacqwgubgbaaaacagloagaayzkaaaaaagaayjkaiaawmcaamaacaaaleqabagaemieaghaaowaaewaaeaadawcgaqaaiabigdaxaqaamaabmaabagaegymaejaey4kasyaasaaaeaacqwf4oqcaeaacqwgubgbaaaacagloagaayzkaaaaaagaayjkaiaawmcaamaacaaaleqabagaemoba4maeyoei0iaemieaghaaaaa@4b2a@. for large loci, this binomial mass function is known to approximate e-θθx/x!, the poisson mass function, as n → ∞ and nθn/→θ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgubgbdawcgaqaamaalaaabaaccigae8hudehabagaemoba4gaaaqaamaabmaabagaegymaejaey4kasyaasaaaeaacqwf4oqcaeaacqwgubgbaaaacagloagaayzkaaaaaiabgkziukab=h7axbaa@3b78@.

however, when the recombination rate is some intermediate value between the above two extremes no explicit forms are known for the snp density. we use empirical estimates of the snp density from a large number of simulations . figure  <dig> shows how the distribution of snp density under our assumptions morphs from the geometric distribution  towards the poisson distribution  as the scaled recombination rate ρ increases from  <dig> to  <dig> in decreasing shades of grey. this behavior is identical for any fixed value of θ except for a scale change.

the empirical estimates of the sex-averaged human recombination rates in  <dig> mbp intervals based on genethon  <cit> , marshfield  <cit>  and decode  <cit>  maps were downloaded from  <cit> . we intrapolated to obtain the estimates over  <dig> kb segments by assuming rate constancy over the  <dig> consecutive  <dig> kb segments that constitute the  <dig> mbp segment for which an empirical estimate of the recombination rate were available. the empirical distribution of the sex-averaged human recombination rate in  <dig> kb intervals, based on genethon map, as shown in figure  <dig>  is denoted by r_
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqiaaqaaiabdkfasbgaaypadaaaaa@2e9b@. the strategy described in methods was used to obtain a simulation-based empirical estimate of the snp density distribution for each scaled mutation rate
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg3bwddaqhaawcbaaccigae8hude3aasbaawqaaiabdmgapbqabaaaleaacqggoaakcqai2agncqgguaglcqai3awncqggsaalcqaixaqmcqai0aancqgguaglcqai5aqocqggpaqkaaaaaa@3ad6@, the maximum simulated likelihood estimate of the weights on θi ∈ Θ  for the coalescent mixture model.

 θi ∈ Θ = {θ <dig>  ⋯, θ304} = { <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig>   <dig>   <dig>   <dig>   <dig>  ⋯,  <dig>   <dig>  300}, 

when the recombination rate was assumed to be distributed according to r_
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqiaaqaaiabdkfasbgaaypadaaaaa@2e9b@. we denote this simulation-based estimate of the snp density distribution for each θi ∈ Θ by s^r^,θi
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgtbwugaqcamaabaaaleaacuwgsbgugaqcaiabcycasggaciab=h7axnaabaaameaacqwgpbqaaeqaaawcbeaaaaa@3384@. note that s^r^,θi→sr^,θi
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgtbwugaqcamaabaaaleaacuwgsbgugaqcaiabcycasggaciab=h7axnaabaaameaacqwgpbqaaeqaaawcbeaakiabgkziukabdofatnaabaaaleaacuwgsbgugaqcaiabcycasiab=h7axnaabaaameaacqwgpbqaaeqaaawcbeaaaaa@3c37@, the true snp density distribution, as the number of replicates  used to estimate it grows large. in practice, n was set at  <dig> . a discretized and rescaled beta density with parameters α and β was used to find the mixing weights for each θi ∈ Θ. thus, for every ordered pair , the shape of the beta density specified the mixing weights, as follows:

 wθi=∫i−1|Θ|i|Θ|ΓΓΓλα−1β−1dλ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg3bwddaqhaawcbaaccigae8hude3aasbaawqaaiabdmgapbqabaaaleaacqggoaakcqwfxoqycqggsaalcqwfyogycqggpaqkaagccqgh9aqpdawdxaqaamaalaaabagaeu4kdckaeiikagiae8xsdemaey4kasiae8nsdimaeiykakcabagaeu4kdckaeiikagiae8xsdemaeiykakiaeu4kdckaeiikagiae8nsdimaeiykakcaaawcbawaasaaaeaacqwgpbqacqghsislcqaixaqmaeaadaabdaqaaiabfi5arbgaay5bslaawia7aaaaaeaadawcaaqaaiabdmgapbqaamaaemaabagaeuimdefacaglhwuaayjcsdaaaaqdcqghrii8aogae83udw2aawbaasqabeaacqwfxoqycqghsislcqaixaqmaagccqggoaakcqaixaqmcqghsislcqwf7oabcqggpaqkdaahaawcbeqaaiab=j7aijabgkhitiabigdaxaaakiabdsgakjab=t7asbaa@6a87@ 

where, |Θ| =  <dig> is the cardinality or size of the set Θ. such -specified wθi
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg3bwddaqhaawcbaaccigae8hude3aasbaawqaaiabdmgapbqabaaaleaacqggoaakcqwfxoqycqggsaalcqwfyogycqggpaqkaaaaaa@3768@'s were used to weigh the corresponding s^r^,θi
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgtbwugaqcamaabaaaleaacuwgsbgugaqcaiabcycasggaciab=h7axnaabaaameaacqwgpbqaaeqaaawcbeaaaaa@3384@'s in order to obtain a finite mixture of the form ∑θi∈Θwθis^r^,θi
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaaeqaqaaiabdeha3naadaaaleaaiigacqwf4oqcdawgaaadbagaemyaakgabeaaasqaaiabcicaoiab=f7ahjabcycasiab=j7aijabcmcapaaaaeaacqwf4oqcdawgaaadbagaemyaakgabeaaliabgigiolabfi5arbqab0gaeyyeiuoakiqbdofatzaajawaasbaasqaaiqbdkfaszaajagaeiilawiae8hude3aasbaawqaaiabdmgapbqabaaaleqaaaaa@4655@. a simulated likelihood function of α and β was thus constructed for the given snp data x = , as follows,

 ∏j=0n∑θi∈Θwθis^r^,θi
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqewbqaamaaqafabagaem4dac3aa0baasqaaggaciab=h7axnaabaaameaacqwgpbqaaeqaaawcbagaeiikagiae8xsdemaeiilawiae8nsdimaeiykakcaaogafm4uamlbakaadawgaawcbagafmouailbakaacqggsaalcqwf4oqcdawgaaadbagaemyaakgabeaaasqabagccqggoaakcqwg4baedawgaawcbagaemoaaogabeaakiabcmcapawcbagae8hude3aasbaawqaaiabdmgapbqabawccqghiiizcqqhyoquaeqaniabgghildaaleaacqwgqbgacqgh9aqpcqaiwaamaeaacqwgubgba0gaey4diunaaaa@524f@ 

we used the newton's method to find the maximum simulated likelihood  estimates α^
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwfxoqygaqcaaaa@2e62@ =  <dig>  and β^
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwfyogygaqcaaaa@2e64@ =  <dig>  . we also did a least-squares fit of the observed to the predicted densities and found comparable estimates. empirical estimates of the sex-averaged recombination rates from decode, and marshfield maps were also used in a similar analysis. comparable estimates were obtained under a reasonably good fit  with the decode map whose empirical cdf resembles that of the genethon map. however, an analysis with the marshfield map yielded a poorer fit . figure  <dig> summarizes the fits to the observed snp data while figure  <dig> shows the marginal density of ρ from the genethon map and the marginal density of θ under the maximum simulated likelihood estimates  with mean, variance, and standard deviation given by  <dig> ,  <dig> , and  <dig> , respectively. among the three coarse-scaled maps of the empirical estimates of the sex-averaged human recombination rates, the genethon map gave the best fit to our observed snp density distribution data.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqiaaqaaiabdkfasbgaaypadaaaaa@2e9b@θi ~ wθi
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg3bwddaqhaawcbaaccigae8hude3aasbaawqaaiabdmgapbqabaaaleaacqggoaakcqai2agncqgguaglcqai3awncqggsaalcqaixaqmcqai0aancqgguaglcqai5aqocqggpaqkaaaaaa@3ad6@ and .

discussion
another study  <cit>  claimed to have achieved a good fit to single reads with  <dig>   <dig>   <dig>   <dig>  or  <dig> snps, by accounting for mutational heterogeneity and genealogical variability in a different manner. they partitioned the genome into  <dig> kb bins, and selected a single read from each bin. they calculated the observed gc content of the bin, and from a regression of gc content on nucleotide diversity across the whole genome, they calculated an expected diversity given the local gc content of each bin induced by the exponentially distributed coalescent time for samples of size  <dig> in the absence of recombination. however, when the full bin size of  <dig> kb were used  <cit> , the snp count ranged to more than  <dig> per bin. because many neighboring reads have shared genealogies, the magnitude of variability from bin to bin is much greater, and the power to detect this heterogeneity is far greater. thus, the latter study  <cit>  found that the coalescent in the presence of recombination fit the observed snp density better than the coalescent without recombination. the model employed in the former study  <cit>  fits without recombination only because the power is so low to detect a departure and because there are correspondingly fewer recombination events expected within single reads vs.  <dig> kb bins. using the data of snp counts in  <dig> kb bins in this study, we find that the coalescent with heterogeneities in recombination as well as mutation gives substantially better fits than the coalescent with a constant rate of recombination and mutation. we have shown that by invoking heterogeneities in mutation and recombination rates, one can better explain the observed variation in snp density across two randomly sampled  <dig> kb segments of human chromosomes. descriptive fits by means of hierarchical poisson models, as well as population-genetic fits by means of coalescent mixture models, significantly improved when heterogeneities in recombination as well as mutation rates were accounted for. the coalescent mixture model does not completely fit the data in the most interesting region, namely, the segments with the least snp density. this is partly due to the filtering strategy used to obtain the data. since there were considerable gaps in the alignments for several bins, there was an overestimation of bins with  <dig> snps. thus, these bins were ignored from the analysis. were low snp counts from such currently ignored bins made available from a high-resolution alignment, a similar analysis would reveal the poorer fits of the descriptive hierarchical poisson models employed here, unless they are further generalized to allow for a larger mass at  <dig> through the zero-inflated class  <cit> , for instance. if one's objective is to produce a descriptive fit to our observed snp density distribution, then the hierarchical model b is clearly preferable to all the models considered in this study due to its strikingly high likelihood value. however, if one wanted a population-genetic model with biologically interpretable parameters to fit the same data, then the best fitted coalescent mixture model with the genethon recombination map is preferable.

it is important to bear in mind that the distribution of t will be affected not only by recombination rate but also by population structure and demography. likewise, the distribution of Λ and t will be affected by the complex interaction between various dna damage and repair pathways that ultimately lead to various types of mutational and recombinational events . moreover, the action of selection will simultaneously affect both the distribution of t and Λ about the selected site. however, since only a small percentage of the genome is expected to be affected by recent selective sweeps, the overall snp density distribution should not be significantly affected by such selective events. thus, our msl estimate of the genomic variation in θ, based on the genethon map, is under the standard neutral coalescent that allows for recombinational and mutational rate heterogeneity across the genome. the true genomic variation in θ can also be affected by several other confounded historical factors including selection, population structure, and demography, besides genomic variation in mutation rate. all these confounded historical factors can be seen as alternative hypotheses to the null hypothesis of our coalescent mixture model for the snp density distribution, i.e., the standard neutral coalescent with genomic heterogeneity in recombination and mutation rates.

CONCLUSIONS
as high resolution data for larger samples become available at a genomic scale, one can use such simulated ml methods  to get the null distributions of various test statistics while accounting for heterogeneities in recombination rates  and mutation rates . such empirically observable phenomena should be incorporated into the null hypothesis when more complex models with unobserved historical phenomena, such as population dynamics, population structure, and/or natural selection are tested in humans at the genomic scale. current scans of the human genome tend to underestimate the costs of ignoring the empirically observable heterogeneities under the null hypothesis.

