BACKGROUND
one of the main topics in system biology is to uncover the complex network structures in a biological system  <cit> . in comparison with simple systems, nowadays the researchers always face larger and more complex dynamic interactive systems . traditional techniques, such as the cross-correlation and partial coherence analysis  <cit> , are inadequate to clearly and explicitly reveal the true network structures for such a complex system. these techniques neither take time dimension into consideration nor reveal the directional interactions, thus they cannot configure a dynamic interactive system with time. over the past few decades several advanced techniques such as dynamic bayesian networks  <cit>  and granger causality  <cit>  have been developed to identify network structures in dynamic systems. granger causality only reveals direct causality between pairwise units with linear interactions, thus conditional and partial granger causality  <cit>  and kernel granger causality  <cit>  have been proposed to deal with indirect causal interactions among multiple variables.

in multivariable  situations, one time series can be connected to another time series in a direct or an indirect manner, raising the important question of whether there exists a  causal influence between two time series when the influence of other time series are taken into account. in such cases, repeated bivariate analysis can be misleading. for example, one time series may falsely appear to cause another if they are both influenced by a third time series but with different time delays. the conditional granger causality  <cit>  aim to deal with the causal interactions among multiple variables. however, the applicability of the kernel granger causality or the conditional granger causality largely depends on the experimental ability to measure all relevant variables in the system, but it is usually not feasible in the biological recordings. environmental inputs, including exogenous inputs from external sources and unmeasured endogenous variables, cannot be all captured by experimental techniques, but such environmental inputs can confound the accuracy of causal influences and thus degrade the credibility of the uncovered network structure. for example, in our experimental data recorded from the inferotemporal  cortex of sheep, every measured neuron receives common exogenous inputs from the visual cortex and feedbacks from the prefrontal cortex  <cit> . even with advanced multielectrode array  techniques, it is only able to record a tiny subset of interacting neurons in a single area  <cit>  and there are bound to be endogenous variables. hence controlling environmental inputs is a critical issue when applying granger causality to experimental data. recently, partial granger causality  <cit>  is developed to eliminate the influences of exogenous inputs and latent variables, but a full elimination is only possible if all common inputs have a more or less identical influence on all measured variables. it is generally not realistic that all measured variables can receive an almost identical and common influence in experimental recordings. in fact, the common influence degrades due to spatial increment. in such cases, it is critical to identify which measured variables received environmental inputs, and what is the impact of the environmental inputs on configuring network structures?

we take a system biology approach to answer the questions above. most current techniques largely ignore the natural dynamical characteristics of the biological data, which usually exhibits highly rhythmic  oscillations, especially under periodic environmental influence, e.g. light-dark condition  <cit> . such natural periodic dynamics of experimental data can provide important information in model fitting and error estimation. to overcome the limitations of current causality techniques and make full use of harmonic oscillation characteristic of experimental data, we consider a harmonic oscillator, or a set of harmonic oscillators, to represent the environmental inputs. the harmonic oscillators can be mathematically formulated by the hidden periodic model  <cit> . we extend the current linear granger causality model  by inclusion of the typical harmonic oscillators embedded in the experimental recordings. if the inclusion of harmonic oscillators can significantly reduce the variance of the prediction error, then the environmental causal influence can be reduced or eliminated. the mathematical representation of a harmonic oscillator model is derived in method section and the application of the harmonic granger causality approach is elucidated in result section. although the techniques of granger causality are based on time series data, additional useful information can be revealed when the analysis is performed in the frequency domain  <cit> . investigating the causal interactions between different frequencies adds another dimension to the already complex identification of spatiotemporal and frequency-specific rhythmic oscillations. conventional cross-frequency interactions are characterized by the synchrony of phase, recognized as 'n:m phase synchrony'  <cit> . phase synchrony indicates amplitude-independent phase-locking of n cycles of one oscillation to m cycles of another oscillation, however, this method largely ignores the information carried by the amplitude and the coupling effects between phase and amplitude. importantly, phase information can be sensitive to random noise  <cit> , while in most experimental data the true signal is heavily masked by random noise. in this study, as a by-product, we also assess whether it is reliable to use the phase information between two  units to estimate the causality. our simulation results clearly demonstrate that it can be very insufficient and inaccurate to use only the phase information to characterize a causal interaction, but the approach developed in the current paper works. we first apply the harmonic oscillator idea to a toy model and validate it by comparing with the conventional granger causality. then we investigate the effect of multiple oscillators by employing a small sparsely connected network. finally we apply the harmonic granger causality to a real biological network of microarray data of the flowering genes of the model plant arabidopsis thaliana. we aim to identify which genes are directly affected by the presence of the sunlight, and uncover the causal interactions among genes. although tens of thousands of known genes within arabidopsis are collected with microarray, only those genes known to be involved in the flowering of the plant  are analyzed by our harmonic granger causality. the method successfully reveals the genes that most possibly receive environmental inputs. we finally compare our causal network with other candidate models in the literatures  <cit> . with this system biology approach, our causal network depicts all possible connections reported in the literatures  <cit> , and also reveals two more connections that do not exist in the known candidate models.

RESULTS
toy model & validation
in this simple toy-model example, we compare the performance of traditional granger causality and harmonic granger causality on four simple model configurations. we show that the traditional granger causality analysis is not sufficient to describe the influence of one time series upon another in the presence of an external driving force. the full simulated model under consideration is described as follows:   

within this model we consider four configurations, firstly where both node xt and yt experience an environmental input, secondly where xt experiences the environmental input and yt does not, thirdly where yt experiences the environmental input and xt does not, and lastly where neither xt or yt undergo the influence from the external driving oscillation. despite the external driving oscillation exerted on either x or y, there is a coupling frequency of  <dig> hz between x and y for all four configurations. in each of the simulations, fx and fy are equal to  <dig> hz, the input phases, ϕx and ϕy are set to zero, and the variances of inherent noises, εt and ηt, are set to  <dig> . in all the following simulations, the values of cx and cy are  <dig>  and  <dig> , respectively.

in the first case where both nodes experience the environmental inputs, fig. 1bi and 1ci shows that both x and y have components at the driving oscillation frequency of  <dig> hz. the causal link known to be present from x to y should mean that there is a spike in the causality spectra at the driving frequency. fig.  and  show that the normal granger ar method can only detect the causality spectra at the intrinsic coupling frequency around  <dig> hz, but the harmonic method is capable of detecting the causal influence at the external driving frequency at  <dig> hz. the reason is that the driving force from x to y comes from the factor  <dig> xt -  <dig> , which contains both intrinsic coupling frequency and external driving frequency. harmonic method can better fit and predict the data at external driving frequency such that it can detect the external driving frequency at  <dig> hz better than normal granger ar method.

the second case is where xt receives the driving input and yt does not. fig. 1bii shows that the peak in the spectra can be seen in the x-channel at  <dig> hz representing the external driving oscillation, and although there is no inherent  <dig> hz oscillation in the yt channel, the spectra of y   shows that there is an induced oscillation at this frequency, hence one would expect that the causality of fx→y will show a large component at the driving frequency. fig.  and 1eii show the causality, fx→y calculated using both ar and harmonic methods. the ar method shows little peak at the driving frequency, while the harmonic method produces a large spike in the causality at the frequency  <dig> hz. in third case where yt receives the external input, fig.  shows that the peak in the spectra can be seen in the y-channel at  <dig> hz representing the external driving oscillation. we would expect that in this case the causality shows no peak at the driving frequency as xt contains no driving oscillation: fig.  and  show the causality, fx→y calculated using ar  and harmonic methods . in this model configuration, both the ar and the harmonic methods produce similar results. however there is a drastic decrement in the spectra of the harmonic method at the driving frequency in the causality, qualitatively, this cannot be the case, so in this instance it is preferable to use the ar method to calculate the causality spectra as xt contains no driving oscillation. the causality decrement near the driving frequency may be caused by the inclusion of the harmonic term, which may extract the intrinsic power of the signal y at the driving frequency of  <dig> hz. the decrement means that signal y was mainly driven by the harmonic term at  <dig> hz and signal x did not contribute much at this frequency. for other frequency range, harmonic term did not influence signal y and the driving force mainly came from signal x. the final model configuration considered is where neither xt or yt has the driving input. fig.  and  show that in this case there is very little difference in the causality spectra obtained using the two methods.

through this simple toy model we have demonstrated that the normal granger causality in the frequency domain is not sufficient to detect interactions at all frequencies in the presence of an environmental input. furthermore we have demonstrated that the causal method with the additional harmonic term produces more consistent and accurate results than the traditional granger causality method at most instances. the harmonic causal method and the traditional granger causality method can be a good complement to each other when applying to the time series with or without oscillatory environmental influences.

investigating the effects of phase
it is a common scenario in physics to determine the driving relationship between two oscillators. the phases of the two oscillators can be interleaved throughout the time, thus phase may not be an accurate indication of the causal interactions between the two oscillators. one of the main motivations of introducing the harmonic term is to investigate the effects of phase and to determine whether it can be used as an indication of the amount of causal interactions between oscillatory signals. consider again the case where xt drives yt, eq.  <dig> shows that the influence of the time series xt upon yt is encapsulated in the oscillatory and noise terms. however, the amplitude of the resultant oscillation will depend on the phase difference of the two harmonic terms. this can be seen by considering the addition of the two oscillatory terms. let oy = cycos and the harmonic component from xt be , then in the case that the frequency of the oscillations are equal, fx = fy = f, the two oscillation terms can be combined as follows:   

where   

and   

it is able to analyze the effect of input phase upon the level of influence of one time series upon another. eq.  <dig> reveals that the magnitude of the resultant harmonic term is indeed a function of both  and ϕy. the oscillating term, , oscillates sinusoidally and can take values in the range .

the relative effect of this oscillation upon  depends on the values of cy and . the extremes of  are given by , and it can be shown that the maximum effect of the phase differences happens when cy =  and the minimal difference happens when either cy or  equals zero.

in order to demonstrate the effects of phase changes, the same model as eq.  <dig> is used. fig.  <dig> shows the enormous consequences of the magnitude of the resultant signal by simply varying the phase of the environmental input, ϕx and ϕy. fig. 2a shows that the configuration of the model with both nodes of the system receiving external environmental inputs and a causal link from x to y. fig. 2b shows two examples in the time domain traces obtained in the absence of environmental noise. the upper panel fig. 2b <dig> shows the time domain traces when the phase difference of the external inputs is zero  and the lower panel fig. 2b <dig> shows the scenario when ϕx - ϕy = π. in each of these diagrams the blue trace, which is the node xt, is unchanged, however the time series associated with yt change considerably. the difference of the maximum amplitudes of the two time series is denoted by Δ. the colourmap figure shown in fig. 2c plotted the value of Δ against the values of the input noise and the input phase differences. it can be seen that the effects of the phase differences is lessened by increasing the noise in the system. fig. 2d reveals the interdependence between noise and phase in this system. the upper panel fig. 2d <dig> shows the amplitude difference against the phase differences in the absence of noise. the reason why the peak does not happen at p is because cx and cy are different, and there is a phase difference. if cx = cy, then the peak would be exactly at p. the lower panel fig. 2d <dig> shows how a measure of the difference varies with increasing noise. the measure of the difference is defined as . as the noise increases the measure difference tends to zero, confirming that the noise levels can mask the phase effects.

we have shown that the phase of the external driving oscillation has an effect on the amplitudes of the resultant time series, then the real question is if this effect can be detected as a difference in the level of causality. recall that the actual level of causal interaction is not varying and the influence that xt exerts over yt does not alter throughout the simulations. the investigation into the effects of phase continued with a series of calculations determining the level of causality. fig.  <dig> shows the causality detected in the system obtained by four different methods. fig. 3a <dig> shows the time domain causality detected using the normal granger method, fig. 3b <dig> shows the time domain causality detected using the harmonic method, fig. 3a <dig> and 3b <dig> show the causality detected using the ar and harmonic methods in the frequency domain. for consistency we require that:   

where fx→y is the causality on the time domain and fx→y  is the causality at frequency ω. eq.  <dig> is the kolmogorov condition that indicates the equivalence of the causality in time and frequency domain.

comparing the ar and harmonic causality results, the amplitude differences influenced by the phase differences are represented in the ar method but not in the harmonic causality results, which imply that the harmonic approach must be used for a true indication of the level of causal interaction as it is robust in presence of the external driving oscillation.

comparison of fig.  and fig.  shows that the eq.  <dig> holds for the ar method and there is a high level of correspondence between the causality calculated in the time domain and frequency domain. similarly, comparison of fig.  and fig.  shows that to a large extent the harmonic method is consistent with the kolmogorov condition in eq.  <dig>  the causality calculated by harmonic method does not depend on the phase difference no matter it is in the time domain or frequency domain.

we further investigated the relationship between the phase difference of input and output signals, and the influence of noise level. the same configuration model presented in fig. 2a was used to demonstrate this interrelation. the phase difference between two input signals varied from  <dig> to 2p and the noise level  increased from  <dig> to  <dig> . the phase difference of signal x and y was plotted as a function against the phase difference of the input signals and the noise level. fig. 4a shows the colourmap of the interrelation. the color intensity represents the phase difference for the output signals. fig. 4b and fig. 4c show the averaged intensity along noise level and the input phase difference, respectively. it is clear that the phase difference of the output signals does not depend on the phase difference of the input signals and the noise level. the results indicate that the phase information cannot be used alone to accurately determine the causal relationship between any two signals. the interpretation of the causality based on phase should be cautious as the causality may not reflect the true relationship.

investigating effect of multiple oscillators
in experimental recordings, the measured variables are usually influenced by many environmental inputs, thus multiple oscillators have to be considered. in order to reveal the power and limitations associated with the additional oscillators, a simple system was considered and the errors of seven different connection schemes was compared. the schematic plot for seven connection schemes is displayed in fig. 5a, and the error terms corresponding to each schemes are described as follows:

i) Σnc: ar + harmonic oscillations, no causality

ii) Σc1: ar + harmonic oscillations, influence from causal node

iii) Σc2: ar + harmonic oscillations, influence from non-causal nodes

iv) Σnar: harmonic oscillations only

v) Σarnc: ar only

vi) Σarca1: ar, influence from causal node

vii) Σarca2: ar, influence from non-causal nodes

to investigate the effect of multiple oscillators on the goodness of fit, we consider a simple network consisting of five nodes in various random configurations. the variances are estimated for each of the connection scheme in fig. 5a, and the number of harmonic oscillators varies from  <dig> to  <dig>  the results of this simulation are shown in fig. 5b. inspection of fig. 5b reveals some of the issues involved in using the harmonic oscillators to provide a full description of the time domain evolution. firstly looking at those variance estimates with no harmonic oscillatory components , as expected in fig. 5b that these are constants for increasing numbers of oscillators . the estimates of Σarnc and Σarca <dig> are very similar, because the non-causal nodes do not provide useful information for fitting the target node. the causal estimate  is the best estimate when no harmonic oscillators are considered.

inspection of estimates in which oscillations are included reveals an important trend; one would expect that as the number of oscillators increases, the estimates become more and more accurate. theoretically speaking this should be the case, however realistically it is shown not to be the case as in fig. 5b. when the number of oscillators goes beyond seven, the estimated variances drastically increase. the reason for this situation is the overfitting problem. the total number of parameters needed to be estimated depends on the number of oscillators , and the known data cannot fit the model if the parameters go beyond the amount of data. as expected, the causal estimate  provides the best estimate for small number of oscillators . this simulation reveals that the number of oscillators does not exceed certain value  if we do indeed obtain a good estimate far surpassing the accuracy of the estimate using only ar. we have to perform goodness of fit test to determine the number of oscillators that can help to fit the data best.

gene data & network
having shown the necessity of applying the harmonic approach to identifying causality in data sets where it is known that an external environmental oscillation is driving the time series, it is necessary to apply this system approach to real experimental data. the microarray gene data pertaining to the flowering clock cycle of the arabidopsis is one such example where this methodology may prove enlightening. the plants  are grown in laboratory conditions, where they are subjected to  <dig> hours of artificial daylight followed by  <dig> hours of no light representing night time. gene microarray data is collected at regular intervals  throughout the experiment. inspection of the time series of this gene expression data reveals that there is a clear periodic oscillation which corresponds to day/night time periods, suggesting that the expression levels of the genes depend upon the amount of sunlight present .

we consider the time domain change of eight genes involved in the flowering system of the arabidopsis, namely cca <dig>  elf <dig>  gi, lhy, prr <dig>  prr <dig>  prr <dig> and toc <dig>  the time domain trace of the expression of these genes is shown in fig.  <dig> panel a. each of the genes with the exception of gi exhibits highly oscillatory behaviour with period of one day. this periodicity is attributed to the presence of incident sunlight during the day time and its absence during the night. some of the genes are directly affected by the light and are expressed to a greater or less extent during the day. the experimental data used for this analysis is over a period of  <dig> days with two measurements per day, hence data for each gene consists of  <dig> data points and there are  <dig> repetitions of each time point .

the task regarding this data set is twofold, firstly we wish to identify which of the genes are driven by the external oscillation. and secondly, we wish to determine how the genes are connected to form the causal network governing flowering of the plant. the method to determine environmental input and network connectivity is as follows. there are  <dig> pairwise combinations possible with eight genes; for each of these  <dig> gene pairs the parameters of four candidate models were calculated. these models are presented below:  

where m is the number of genes in the network, p is the number of lagged observations used in the model. p can be determined by a quantity called akaike information criteria   <cit> . the four candidate models are descriptions of an estimation of xg used to determine the effect of xh with or without the external driver. the variance of the errors associated with each of the models are: Σ <dig>  Σ <dig>  Σ <dig>  Σ <dig> respectively.

the errors  - associated with each model were estimated for each gene pair. using these errors we can infer both the presence of an external environmental driver and the possibility of a connection between the pair of genes.

comparison of Σ <dig> and Σ <dig> and comparison of Σ <dig> and Σ <dig> reveal that whether particular gene may have an external input as these estimates differ only by the presence of the oscillatory input. if the estimate is improved appreciably by the addition of the harmonic term, then it is possible that this gene receives an environmental input. therefore for each gene, a measure of the likelihood of input presence is obtained as follows: . fig. 6b shows the oscillation metric for each of the  <dig> genes in the network. this method merely states which of the genes is more likely than others to have an input, so a decision must be made as the value of the oscillation metric is the cut-off point. at a first estimate, the value of m =  <dig>  has been selected. figure 6b shows that selecting a cut-off value of  <dig>  for the oscillation metric leads to the following genes having an external oscillatory input; elf <dig>  prr <dig>  toc <dig>  lfy.

having calculated whether the genes have an external input, it is possible to obtain the causality of each pair of genes. consider the causality between gene x and y. if gene x has an external input, then the causal influence x exerting upon y is: . whereas there is no external input to gene x, then the causality will be given by: . the errors  - and hence the causality associated with each model were found for each pair of genes and then sorted in descending order. those with the highest level of causality deemed more likely to have a connection.

the table of errors  shown in fig.  <dig> is used to find the most likely connection in the gene network. one such candidate network is shown in fig. 8a.

to validate the gene network generated by harmonic granger causality, we compare it with other candidate network in the literature of circadian clock cycle by ueda  <cit> . the candidate network is reproduced in fig. 8b. the three loop model was first proposed by locke  <cit>  and then modified by ueda  <cit> . in ueda's model two hypothesized unnamed genes are omitted in our model and the genes lhy and cca <dig> are treated as one entity. our analysis reveals that four of the genes in this network receive external inputs: prr <dig>  cca <dig>  cca <dig> and elf <dig>  the first two of these agree with ueda's network. the ueda's network states that toc <dig> does not receive external influence but the hypothesized gene does. it is possible that this influence has been included in the time series of toc <dig>  the structure of the two networks also are very closely related, both showing a high level of connectivity. perhaps the biggest difference is that our method shows that there are connections between prr7/prr <dig> and toc <dig>  while ueda's model does not reveal such connections.

in addition to finding the likely connections between the genes, the frequency domain analysis allows us to investigate the frequencies at which one gene drives another. fig. 8c shows the causality spectra calculated for each of the  <dig> connections believed to exist in the gene network shown in figure  <dig>  fx→y  is shown on frequency domain between /day- <dig>  whether this is calculated using the harmonic or ar method depends upon whether gene x is thought to have a external input, i.e., those with an external input are calculated with the harmonic method, and those with no external input are calculated using the ar method. it is often the case that the two methods produce very different causality spectra, so selecting the correct method is essential, in many instances the ar method predicts a causal influence at the driving frequency, yet the harmonic method does not.

discussion
although harmonic causal method has greatly improved the performance of causal connection detection, there are several issues that harmonic causal method cannot answer or infer at this stage. first, the application of harmonic granger causality has a precondition that the signal is influenced by harmonic environmental inputs. most biological data exhibits harmonic oscillatory behavior, while there may also exist other form of nonlinear exogenous input other than harmonic form. the harmonic method cannot deal with such nonlinear interactions, and its application to nonlinear exerts would depend on specific problems. second, harmonic causal method is developed to detect the directional causal interactions between any two elements, but it has no ability to determine the influence is positive or negative. for example, one neuron can exert an excitatory or inhibitory effect on another neuron; or one gene can cause another gene's expression level up or down. it is not possible at this stage to figure out the positive or negative effect by only determining the directional causal interactions. third, one should take extra caution when applying multiple harmonic causal method as the overfitting problem can easily happen. excessive number of harmonic oscillator will generate inaccurate model estimations and predictions.

CONCLUSIONS
we have presented a system biology approach to study the impact of environmental inputs on recovering network structures. the harmonic modification of the granger causality is essential if we want to have the complete picture of causal interactions between elements in a system in the presence of a periodic environmental oscillation. the toy model example demonstrated that the conventional granger causality was not sufficient to reveal the level of causal influence in the presence of an oscillatory driver. furthermore, the toy model was able to validate the estimates used in the definition of the frequency domain harmonic causality. one of the motivations for the introduction of the driving oscillation was to investigate whether it is feasible to use phase differences between oscillatory signals to assess the causality. we also showed that the apparent level of influence on the conventional granger causality was tightly related to the phase difference and noise intensity, and this artefact was enough to render the estimation of the conventional granger causality. the harmonic granger causality was not sensitive to these phase effects and produces more accurate estimate of the true causality. we also applied the harmonic method to detect external drivers and causal connections in a gene network. we were able to predict which genes receive an environmental input from the sun and these results are in agreement with the experimental results to a large degree. furthermore, we were able to reproduce the network, which not only reveals known connections but also predicts new connections comparing with classical candidate models.

our approach clearly demonstrates that by including appropriate environmental  inputs in a conventional reverse-engineering approach could significantly improve its accuracy. obviously the same idea could be applied to other approaches such as the bayesian network inferences and information theory approach.

