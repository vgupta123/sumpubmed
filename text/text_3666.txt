BACKGROUND
advances in technology have increased the speed and reduced the cost of dna sequencing. this has resulted in a dramatic increase in the number of sequences contributed by both large sequencing centres and individual laboratories to sequence databases. public biological sequence databases are growing at an ever-increasing rate, with  <dig> million new sequences being added to genbank from august  <dig> to august  <dig> alone  <cit> . currently, the genbank database has almost  <dig> billion nucleotides from over  <dig> million sequences. the number of whole genome sequences of eukaryotes, prokaryotes and viruses is also increasing rapidly. accordingly, tools like ncbi blast, which search those databases for sequences similar to a given query sequence, return larger and larger sets of results.

sequence similarity searching is a powerful tool to help develop testable hypotheses in the quest to characterize genes and other dna sequences and infer structural, functional or evolutionary relationships. researchers interested in identifying new matches to query sequences, which may be a few genes or even whole genomes, must search through massive amounts of alignment data to retrieve new and interesting matches. in order to keep up with the growing databases, the researcher must submit the same queries periodically. however, the new results, no matter how significant, are often buried in a long list of results that were previously obtained on past searches.

rehab  is a new software package that was developed to address these problems. rehab performs psi-blast  <cit>  searches of a protein sequence database and keeps a database of all significant alignments  obtained; these searches are performed on a regular schedule against updated versions of the sequence database. it then compares the sequences in the new psi-blast result with the rehab hits database to identify new matches resulting from recently deposited sequences. the complete rehab hits database can then be queried by date using a simple gui to allow the researcher to easily identify new hits; these are highlighted, and pairwise or multiple alignments can be performed to assess the quality of the match. as well as filtering out results that have been found previously, the rehab browser can filter out hits against sequences that are identical to the sequences being submitted as queries .

rehab is designed to be a practical tool for searching ncbi database updates with large numbers of query sequences. for example, our laboratory uses it with all open reading frames  from fully sequenced poxvirus genomes . as the number of sequenced virus genomes continues to increase, the number of hypothetical orfs of unknown function also expands. this is particularly true for large viruses like poxviruses, baculoviruses, and herpesviruses that possess many virulence genes that are not part of the core set of genes that define a virus family  <cit> . there are also numerous core genes for which no known function has yet been identified; for example, of  <dig> completely conserved protein families in poxviruses, there are  <dig> with completely unknown function and at least  <dig> others with only poorly defined function.

other programs have been previously created to deal with this particular issue, including dbwatcher  <cit> , seals  <cit> , swiss-shop  <cit> , sequence alerting system  <cit>  and blast search updater  <cit> . however, www-based programs are not well suited to searching with large numbers of query sequences, and there may be concerns with a shut-down of service  or allowing proprietary data out of a secure network. other programs may be complicated to use, or require users to directly interact with unix operating systems. rehab is specifically designed for searching with large numbers of query sequences and can support a number of research groups; it also provides a user-friendly graphical interface. the client will run on most major operating systems including mac os x, windows, linux and solaris.

implementation
design rationale
rehab was implemented for the java platform to simplify the support of multiple operating systems including linux, microsoft windows, solaris, and mac os x. users initially access and launch the application  from a web page using java web start, which also automatically downloads updated versions as they become available. this ensures users are taking advantage of improvements or added features in the latest software version. furthermore, coding in java allows interoperability with existing applications developed in our laboratory, including base-by-base  <cit> . our choice was reinforced by past successes with the java platform and java web start for implementation and distribution of programs such as vocs  <cit> , vgo  <cit> , and base-by-base  <cit> .

components
rehab consists of four main components :  a mysql relational database that stores information about hits, including biological sequences, alignments between them, and other categorization and annotation data;  a java server that provides access to programs which cannot be run locally by the client on arbitrary user workstations, such as ncbi blast and emboss  <cit>  utilities;  a java swing graphical client, downloaded and launched on client machines using java web start;  and a back-end java program which runs alignment programs and compiles results in the database. each of these components is described in more detail below. although all components can be run on a single machine, it is envisioned that a single server will support a variety of users dispersed on an intranet or the internet; if required, it is simple to offload the batch database searching to a more powerful cluster or grid system.

hits database
there are four types of information stored in the rehab database:  biological sequences and their annotations, both those used as queries in blast searches and those which have been returned as hit subjects;  information on each query/subject pair , gathered from individual search results and alignment programs ;  organizing information, such as which query sequences belong to which organisms; and  other caching information, used to speed performance of server-side program functions. to reduce the amount of required storage space, actual alignments are not stored, but are regenerated for presentation when the user selects the specific query sequence or query-target pair to be viewed. query sequences, which are entered using a simple fasta-like format that includes additional annotation information in the identifying line, need only be submitted once to rehab since they are stored for future search cycles.

back-end processing
the work of running psi-blast searches is done in batch mode by the ncbi blastpgp program against a local copy of the ncbi non-redundant  protein database. psi-blast is performed for three iterations without filtering procedures . hits with an e-value less than  <dig>  are used to generate the scoring matrix for the subsequent cycle. to increase speed, searches with query sequences that result in no new hits are terminated after the first cycle. those with new hits scoring below the threshold continue to the third cycle. psi-blast was chosen because it is a more sensitive search method than blastp. the searches do not need to be performed on the same machine on which the database or server components are installed. xml output from blastpgp is parsed and relevant information about each hit is stored in the rehab database. in addition to scores and identifying information, target sequences are copied into the rehab database to ensure that they are available for analysis in the future, even if they are no longer available from ncbi. this is important because, although ncbi does not actually remove sequences from its database, it may change the identifier of a sequence if it is corrected, updated, or merged with another identical entry. any changes to a pre-existing entry are added to the database, but it is not registered as a new hit.

server
the server component consists of java rmi classes that provide remote access to local facilities, and a loading program that registers those classes with an rmi registry installed on the server from which the client will be downloaded. requirement for the server is a system that can support java  <dig> . <dig> and mysql  <dig> .

client gui
the java swing client component allows a user to browse the information collected in the database by the back-end program. when the client is downloaded and launched from a website, it connects to the server and database specified in its configuration file.

the client program visually presents summary information about hits added to the database, and allows the user to quickly locate new, relevant hits and the sequences involved. there are five main views available in the client:  the management console lists the available databases, and has options for creating new databases or adding files to existing databases,  the hits browser window lists the organisms for which query sequences have been added in the database, and allows users to select filtering and highlighting options,  a hits summary, which displays the results in a table with highlighting to mark new hits, and  an html output or  a hits manager that displays detailed information about retrieved sequences and alignments.

RESULTS
finding new hits
rehab is a tool that works with blast to identify new hits in updated versions of sequence databases. it allows the researcher to ask the question: "what new sequences match my sequences since the last time i searched?" in the example of our work, the query sequences are all the orfs of the fully sequenced poxvirus genomes . these sequences are used to query the nr ncbi protein database and a mysql database of all hits is generated and stored . databases of hits for other virus families maintained by the virus bioinformatics resource  will also be available in the near future. the hits database can then be accessed by double-clicking on the database name or by selecting "browse by organism" in the action menu. this opens a new window to present browsing, sorting, and highlighting options . the user can browse by organism name, such as "variola virus strain bangladesh-1975". to highlight recent hits, the "date option" is chosen to define the date after which the hits are considered new. the available dates are those on which the query sequences were searched against a then current nr ncbi database. the output can be sorted based on three criteria  by selecting the appropriate radio button. the results are presented in a new window, using colors to indicate new hits .

since all new hits are not necessarily significant, results are highlighted in different colors depending on the bit-score. the user can change the default threshold of the minimum bit-score, to show new hits scoring above this cut-off in red and new hits scoring below it in yellow. since all query sequences that have new hits are highlighted, any that remain unhighlighted do not have new hits. however, unhighlighted queries may have significant hits from previous searches. the "latest hit" column indicates this fact: query sequences showing hits only from previous searches show an older hit date, and a bit-score of "0" in the "new hit score" column. unhighlighted sequences with no information in the "latest hit" column do not have any hits in the database or they have been filtered out .

information about the hits can be viewed in two ways. selecting "html report" launches the user's default web browser and displays the "hit-list" in familiar blast-style . hits are displayed in descending order of bit-score, however, a key feature of this program is that new hits are highlighted in red or yellow. the pairwise alignment can be displayed rapidly by clicking on the score . in contrast to the usual blast output, which presents the local alignment found by blast, a global alignment produced by needle  <cit>  is shown. more information can be obtained about the target sequence by clicking on the link to the ncbi file for that entry. alternatively, a full list of hits can be viewed in the "hits manager" window . here, sequences can be sorted by highlight, and pairwise or multiple alignments can be performed. pairwise alignments are displayed by selecting a single target sequence and clicking the "global" button for global alignments produced by the emboss program needle or the "local" button for local alignments generated by the emboss program water  <cit> . multiple alignments are generated by selecting more than one target sequence and clicking the "base-by-base" button; the software automatically retrieves the appropriate sequences from the rehab hits database, performs a clustalw alignment and passes the resulting multiple alignment to base-by-base, which functions as an alignment viewer and editor  <cit> . finally, sequences in the hits manager can be viewed in fasta format by clicking the "show" button and can be copied from this window using standard keystrokes.

filtering out identical sequences
unless a sequence has not been deposited in the public database, a sequence similarity search will return results including the query sequence itself, as well as nearly identical sequences that are orthologs of the query. rehab can block the highlighting of hit sequences that are also present in the query database when the "don't show my own sequences" option is selected; such sequences will not be shown or highlighted in the hits results window. however, these sequences and their alignments with the query can still be visualized in the html report and hits manager windows, thus allowing the user to access all the available information. this feature becomes essential when new poxvirus genomes are added to the public database, since a large fraction of the queries will hit proteins in the new genome and signal a "new hit" report when there may be no other new hits in the database. although these are clearly high scoring matches, they are expected and therefore must be masked in the analysis if the full value of rehab is to be realized.

browsing by other criteria
in the browser window , the user can chose to browse by the annotation included in each sequence's information line. in the case of our poxvirus sequences, useful annotations are organism name and protein family . selecting an item from the "group by annotation" list loads the new category in the list on the left side of the window. this sorting allows the user to quickly find query sequences of particular interest. for example, one may be interested in looking at only sequences from the ankyrin family. results can then be viewed and analyzed as described above.

setting up rehab with user selected sequences
researchers can use rehab to search databases with their own set of query sequences. in the example of our research, it is most practical to organize the query sequences by organism and protein family. other researchers, however, may find other naming schemes to be more useful; no changes to the program or database are required. for example, a research group could organize query sequences and the hits results databases by laboratory name, and browsing of results could be by the researcher's name . individual laboratory members would add query sequences to the database including their name in the identifying information line. in this example, the laboratory name would replace virus family, and user names would replace organism names. all query sequences would be searched in the same batch process, and each individual could then browse their sequences of interest. users interested in establishing their own rehab database should contact the authors for assistance.

CONCLUSIONS
the goal of this project was to build a software package to aid in the identification of new results returned from sequence similarity searches. to this end, we developed rehab, a tool that highlights new hits by comparing results from previously run searches to those with a recently updated database. rehab allows researchers to query the nr protein database with large numbers of sequences and can highlight, sort, and analyze results in a user-friendly graphical interface. it can also be used to rapidly create multiple alignments with any set of sequences returned by a blast search. this enables researchers to recognize new significant sequence matches in the mass of results generated by high throughput database search protocols.

availability and requirements
project name: rehab

project home page: 

operating systems: all platforms supporting sun's jre version  <dig> . <dig> or compatible

programming languages: java, sql

other requirements: java  <dig>  or higher

license: gnu general public license

restrictions for non-academic use: contact corresponding author

authors' contributions
cu described and specified the features of and problems to be solved by rehab, tested the program and provided usage examples. jw implemented the software, both the java components and the database schemata used to store alignment results. dje tested the program and provided usage examples. all authors contributed to writing of the manuscript.

acknowledgments
this work was funded by niaid/darpa grant u <dig> ai48653- <dig> and canadian nserc strategic grant stpgp 269665- <dig>  we would like to thank angelika ehlers for systems administration and dr. rachel roper for helpful insights.

figures and tables
