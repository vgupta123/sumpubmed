BACKGROUND
alternative splicing  has been shown to be a key factor in cellular processes such as development and differentiation as well as in different pathologies, including cancer . as has been studied using exon arrays and, more recently, using rna-seq and junction arrays  <cit> .

the first array that made use of junction probes was based on agilent technology and included approximately  <dig>  junction probes, but lacked exon probes  <cit> . these were included in a later version of the array  <cit> . in  <dig>  oryzon genomics, in collaboration with our group, introduced an array based on agilent technology, covering  <dig>  genes with a total number of  <dig>  exon probes and  <dig>  junction probes  <cit> . this new array made use of a massive number of control probes  to ensure the proper normalization of the measurements.

in  <dig>  affymetrix presented the human junction array . it was their first experimental array with exon and junction probes  <cit> . this microarray included approximately  <dig> million probes, comprising ~ <dig>  exons and ~ <dig>  junctions. each exon and junction was interrogated by  <dig> different probes. the probes of this array were selected using refseq, exonwalk and ensembl annotations. two years earlier, exonhit introduced the splicearray, also using the affymetrix technology . however, the use of exonhit arrays is not as widespread as the use of standard ones from agilent or affymetrix.

in  <dig>  affymetrix, together with stanford university, designed the custom glue grant human transcriptome array   <cit> . and in  <dig>  affymetrix launched the genechip® human transcriptome array  <dig>  , a more up to date catalogue of the hjay and gg-h arrays. the hta  <dig>  array interrogates a total of  <dig> , <dig> exons or exon clusters with more than  <dig>  million probes  and more than  <dig>  exon-exon junctions with more than  <dig>  million probes .

in a previous work  <cit> , we developed an algorithm to detect as cassette events. it was applied to both the hjay and the oryzon arrays. hjay array clearly outperformed the other platform and had a validation rate for top-ranked events of nearly 100 %. the results proved that the affymetrix platform is a good option to detect as events. the main problem of this array is that it was unsupported upon their release.

only the transcriptome analysis console   <dig>  software offered by affymetrix and altanalyze  <cit>  are the available options to analyze hta  <dig>  and hjay arrays. firma  <cit> , using cdfs generated by brainarray  <cit> , can be applied to extract and summarize exon expression but the junction probes would be missing from this analysis pipeline.

the main drawback of the tac and firma approaches, is that neither of them combines the information provided by the junction probes with the corresponding exon probes in the event under study. for example, in the detection of a cassette event, it is not sufficient to detect the altered expression values of exon probes. in addition to that, the flanking junctions must behave coherently and the skipped junction must have a negative correlation. a similar argument can be made for other as events. on the other hand, altanalyze using the aspire algorithm  <cit>  combines the information of two probesets to get a figure of merit for each event. for example, in a cassette exon, altanalyze would provide three figures of merit: one corresponding to the probeset of the exon and the junction that skips it and two more combining the flanking junctions with the junction that skips the exon. even though, this approach is intrinsically better, it would be still desirable to have a single figure of merit per event. there is an algorithm  developed to exploit combined information from exons and junctions  <cit> . however, its development has been discontinued and it cannot be applied to the hta  <dig>  platform. furthermore, most of the algorithms developed to detect as events  are limited to the analysis of case–control studies. its extension to more complex experimental designs, such as case–control studies with paired samples or time-course studies, is non-trivial.

here, we present eventpointer, an algorithm to detect as events using the hta  <dig>  platform. it can be applied to any experiment using appropriately configured design and contrast matrices. eventpointer is based on the limma framework in bioconductor  <cit> .

RESULTS
implementation
since eventpointer is described in-depth in the methods section, here we briefly describe its main characteristics. using affymetrix junction arrays , after mapping the probes against the ensembl transcriptome   <cit> , the splicing graph for each gene is generated and eventpointer identifies and classifies the different as events that can be detected with these arrays. the different classes are alternative 3′, alternative 5′, alternative first exon, alternative last exon, cassette exon, retained intron, mutually exclusive exons and complex events . these steps are specific for the arrays and do not need to be repeated for each experiment. the output of this pipeline is a cdf file that groups the probes into probesets that reflect the splicing events. these different steps are depicted in figs.  <dig> and  <dig> fig.  <dig> overview of eventpointer. a using as input a reference transcriptome , the probes of the array are mapped against it, b the splicing graph is created. c using the splicing graph, eventpointer detects every possible event by defining common nodes and edges  and two alternative paths . d these events are classified into the canonical splicing categories. e finally, for a specific experiment and using the design matrix of the experiment and an auxiliary event matrix, the statistical significance of each gene is computed using the limma framework. steps  are specific of the array and thus, is only necessary to rerun them if the reference transcriptome is changed. step e) must be performed for each experiment

fig.  <dig> description of the detection of events from the splicing graph using eventpointer. the sg is extended  and corrected to force. the splicing graph is interrogated to find eventsand detected events are classified into one of the three possible groups . each of these groups are further subdivided into the different event types checking the length of the junctions



for each experiment, the output of the hybridization  must be summarized using any standard pipeline . following probeset summarization , eventpointer uses the provided design and contrast matrices to compute the statistical significance of as events. by construction, the as events can always be validated using standard pcr with at most three primers. we describe here the results of applying the eventpointer algorithm to the hta  <dig>  arrays on an experiment with  <dig> samples.

the r package eventpointer is available for download at github. it includes the cdf file needed for aroma.affymetrix pre-processing pipeline and the necessary functions to obtain the statistical results.

eventpointer also enables visualization using igv. eventpointer generates an output file that can be loaded to igv to display the events  as well as the location of the probes for each of the paths. figure  <dig> includes a screen capture of an event displayed in igv.fig.  <dig> visualization of eventpointer prediction in igv. image generated by eventpointer as displayed in igv



within the vignettes that accompany eventpointer we have included some secondary analyses  that illustrates the potential of the provided tools.

mapping annotations
the number of events that can be theoretically detected by eventpointer for the hta  <dig>  and hjay arrays are  <dig>  and  <dig> , respectively. figure  <dig> shows the number of events using the different canonical categories.fig.  <dig> number of detectable events by eventpointer. number of as events detected in each event type for hta  <dig>  and hjay arrays



as fig.  <dig> shows, hta  <dig>  includes more splicing events than hjay for all event types. the majority of detected event types correspond to complex events . as the transcriptome annotation improves, it also becomes more complex. previously we developed exonpointer, an algorithm to detect as cassette exon events  <cit> . eventpointer extends exonpointer more than ten-fold, taking the  <dig> cassette events in the hta  <dig>  array to more than  <dig>  splicing events of any type. in addition to that, eventpointer provides a more rigorous definition of a cassette event and can be run on the hta  <dig>  arrays. we will focus on the results with hta  <dig>  since it interrogates more exons and junctions than hjay and is a more recent and stable development of affymetrix.

transcriptome data
the performance of the developed algorithms was tested in an experiment where the splicing factor srsf <dig> was knocked down using sirna on the a <dig> lung adenocarcinoma cell line. this cell line was obtained from the american type culture collection . the experiment included three conditions: cells treated only with the vehicle of the transfection , cells treated with scramble sirna  and cells transfected with a sirna that targets srsf <dig>  each condition had three biological replicates that, in turn, were hybridized three times . the efficiency of this inhibition has been stated elsewhere  <cit> .

the splicing factor srsf <dig>  <cit>  has a pleiotropic effect: it regulates splicing , regulates nonsense-mediated mrna decay, has a role on rna metabolism , rna protein binding, has a potential oncogenic role in cancer, regulates the mitosis among other processes . we have performed a differential expression analysis of this experiment. we have included the main results in the additional file  <dig>  the categories of gene ontology enriched are concordant with the aforementioned functions .

determining differential splicing events
an as event is considered to be differentially spliced if the concentration of the isoforms mapped to either paths of the event  are differentially expressed in opposite directions . for this particular experiment, the contrast matrix compares the knock down samples using sirna with the samples of the cells transfected with scramble sirna. in the comparison of these two conditions , out of the theoretical  <dig> events,  <dig> showed a p-value < 10- <dig> .

each of the paths in an event  is annotated with the domains  included in the ensembl database. in some cases, the domain is disrupted in one of the paths compared with the other. we performed a statistical analysis of the enrichment of the domains that may affected by the as events. the statistics of this analysis are described in the methods section. in brief, we performed a wilcoxon test between the isoforms that contain a domain. the results of this analysis are summarized in table  <dig> table  <dig> enrichment of domains in the list of as events regulated by srsf1

the domains are sorted by its statistical significance. if several domains share similar properties, are grouped into a single row. the upper part of the table shows overexpressed domains. the second part of the table  shows underexpressed domains. the statistical significance was larger for overexpressed than for underexpressed domains



the enrichment analysis illustrates one of the potentials of this analysis. the laminins are proteins of the extracellular matrix. the modification of their domains is known to induce a pro-invasive phenotype  <cit> .

several of the motifs are related to rna binding: rna recognition motif . these results are coherent with the go enrichment analysis  in which several of the enriched categories are related with rna modification.

to our knowledge, the relation between srsf <dig> and the wd <dig> domain was unknown. the underlying common function of all wd40-repeat proteins is the coordination of multi-protein complex assemblies, where the repeating units serve as a rigid scaffold for protein interactions  <cit> . in addition to this, the rna domains are also targets of prpf <dig>  another splicing factor. ibr, as well as wd <dig>  domains are related to ubiquitin ligase complexes  <cit> .

we have included a few of the domains that were underexpressed after the knock-down of srsf <dig>  it is important to point out that the statistical significance is much smaller. an intriguing result is that the trna synthetases domains are overexpressed and underexpressed depending on their class.

validation of eventpointer
we used standard pcr to validate the five top-ranked as events within each of the eight different types of events . in total,  <dig> different events were tested. each event was validated on two different samples. the events were ranked according to their p-values. in turn, the p-value represents the “differential opposite expression” of each of the isoforms interrogated by an event. the statistical significance of the events  was very different across the different as types. all the five top-ranked “cassette” and “complex” events were within the overall top- <dig> ranked events. in contrast, only one out of the five top-ranked “alternative 3′ site” was found within the top- <dig> ranked events and the top ranked “mutually exclusive exons” was in position  <dig>  these results are summarized in table  <dig> table  <dig> top-ranked as events regulated by srsf <dig> and the result of their validation

the first column shows the ranking of the event in eventpointer according to the p-value. the last column states if the validation was positive: a  mark is shown if the validation is significant in pcr, a  mark is shown if differences in the pcr can be observed but the statistical significance is above  <dig> . a  mark is shown if the event was not validated either because there was no differential splicing, no alternative splicing or no expression at all



the  <dig> top ranked events appeared within the top- <dig> of any of the categories and were validated. in all of them the validation was positive although, in a few cases, the pcr-band analysis  did not pass statistical significance. in fig.  <dig> we show some of the pcr results. additional file  <dig> shows the results for all the events. primer sequences are also included in the additional material .fig.  <dig> pcr validation of three sample genes predicted by eventpointer. the figure shows the loci in the genome according to ensembl, the location of the primers, the results of the pcr, and the relative usage of the isoforms determined by a pseudo-quantification of the pcr images



comparison with other software
affymetrix transcriptome analysis console  and altanalyze are the only available software to detect alternative splicing events using hta  <dig> . the main features from each of them are briefly explained below and the comparison with eventpointer is discussed in the latter paragraphs.

tac  <dig> 
the software from affymetrix is publicly available for download and provides the user with different tools to go beyond simple differential gene expression analysis. some of the options are gene pathway networks, mirna and target gene interactions and alternative splicing events identification. it works only in windows operating system.

given the corresponding cel files, the software automatically runs the analysis based on the options provided by the user.

tac uses splicing index   <cit>  as a measure to detect alternative splicing events. briefly, the si of a probeset compares two ratios: si=probesetnsignalcond.1overallsignalofthegeneincond.1probesetnsignalcond.2overallsignalofthegeneincond. <dig> 

if the si is close to one, then the behavior of the probeset is coherent with the behavior of the gene. if it is much larger or much smaller than  <dig>  then the probeset signal may indicate the presence of alternative splicing.

tac applies several filters based on expression levels  prior to the calculation of the splicing index for any given psr  or junction. it also classifies  of the events according to the standard categories . and, for the ones that are classified, tac includes a “splicing score” . this value is based on “how well the data fits into pre-defined splicing patterns”. besides, both “psrs and their related junctions all contribute to an event score” that is bounded between  <dig> and  <dig> . no additional information is provided on how this score is computed or how the events are classified and can be considered as an experimental method. only around half of the events are given a ss. in our case, 23/ <dig>  of the validated events included the ss.

we sorted all the events found by tac according to the absolute value of the logarithm of the si . see additional file  <dig> with a list of top tac predicted events.

altanalyze
this is an open-source software developed in the nathan salomonis lab at cincinnati children’s hospital medical center and the university of cincinnati. this project began in the laboratory of bruce conklin at the gladstone institutes.. it can be downloaded from their webpage  and it can be run in different operating systems such as windows, mac os and ubuntu. as stated by the developers: “requires no advanced knowledge of bioinformatics programs or scripting”.

the software enables analysis of data produced by both conventional and splicing sensitive microarrays  as well as rna-seq data and the pipeline enables a complete analysis that includes identification of alternative splicing events and differential expression as well as different functional annotations of the genomic regions identified as alternatively spliced.

for the detection of alternative splicing events, altaanalyze uses two different algorithms to measure splicing events: splicing index  and analysis of splicing by isoform reprocity . see additional file  <dig> with a list of top altanalyze predicted events. altanalyze provides the user the option to set different threholds to filter genes and as events depending on the expression levels.

the aspire algorithm is used when two probesets  measure the exclusion and inclusion of an exon respectively. it provides a score similar to a fold change, bounded between - <dig> and  <dig>  where negative values indicate that the expression in the probeset  in experimental group is higher than the control group. a single splicing event can have  several inclusion indexes per event. each of them correspond to the pairwise comparisons between the probesets that include and exclude the event respectively.

in order to identify an event as statistically significant, altanalyze relies on three different values: ratio of inclusion, ratio of exclusion and δi. the first ratios measure the proportion of the inclusion or exclusion of an exon with the mean expression of the whole gene. both ratios must be in opposite directions to continue the analysis. the δi value measures the difference between both the inclusion and exclusion ratios. as a default value, any event must have a δi above  <dig> . a detailed explanation of the algorithm can be found in the altanalyze user manual. eventpointer takes into account all the exons and junctions involved in the alternative splicing event to give its statistical significance. the results for eventpointer are normalized using the probeset in the reference path and using the whole gene for altanalyze and tac. on the other side, tac  and altanalyze  provide up to  <dig> statistical values for each event . both altanalyze and tac are focused on case–control studies. eventpointer can be applied to any experimental design that can be described with a design and a contrast matrix.

using the “granges” r package  <cit> , we matched the events expressed and detected by the three algorithms . as explained before, an event detected by eventpointer can be matched to more than one element of either tac or analyze, as a result we kept the unique events that where matched in order to create the venn diagram depicted in fig.  <dig>  this diagram shows the expressed events for all of them. these events do not necessarily show differential usage of the variants.fig.  <dig> venn diagram of common events identified by eventpointer, altanalyze and tac the diagram displays the total number of events detected by each algorithm  and the corresponding values for the intersections



as already mentioned, tac provides a different si for each of the probesets that interrogate an event. we summarized these values taking the most significant si for each event. table  <dig> provides the ranking of the top ten events detected by eventpointer in both altanalyze and tac.table  <dig> ranking of the top-ranked events according to eventpointer and their ranking positions in the other algorithms 



some comparison examples of top-ranked events
the events that can be clustered into three groups: events with high ranking in the three algorithms, events with high ranking in eventpointer and low ranking in altanalyze and tac and, finally, events low ranked to eventpointer and high ranked in the other two algorithms. the compared events, displayed in tac, are shown in fig.  <dig> fig.  <dig> tac view of six of the compared events. in each of the panels, there are three representations of the splicing graph for each gene. the first one represents the measured expression for each probeset  in samples treated with srsf <dig>  the second one represents the expression in the samples treated with scramble sirna  and the third one represents the splicing index for each probeset 



within the first group, kif <dig> was ranked 2nd, 11th and 3rd in eventpointer, altanalyze and tac, respectively. the corresponding statistical values in each algorithm are:  <dig> e- <dig> ,  <dig>   and  <dig>  . the three methods identify this event as high-ranked. figure 7a shows the tac window at the particular region for this event.

hmbox <dig> is also an event identified as high-ranked by the three algorithms. the corresponding rankings are 7th, 6th and 98th in eventpointer, altanalyze and tac, respectively. even though the ranking in tac is not as low as in the other two methods, the pcr validation confirms the alternative splicing event. figure 7b shows the tac window for this event.

in the second group, ncor <dig> was ranked 9th in eventpointer while altanalyze and tac rank the event in positions  <dig> and  <dig>  respectively. this event shows either the highest si or δi value when compared to the other events found for the same gene. the event was validated by pcr and shows a significant pvalue  in eventpointer. figure 7c shows the event in tac.

acad <dig> is ranked as the 8th event in eventpointer while altanalyze and tac rank the event in positions  <dig> and  <dig>  respectively. it shows a similar behavior as ncor <dig>  figure 7d displays tac window for this event.

naa <dig> was ranked 10926th,6th and 148th in eventpointer, tac and altanalyze, respectively. the reason is that this event is backed up by only one junction probeset. since eventpointer finds no coherence with the other paths of the event, the ranking is low . this event was validated using pcr. the pcr results are included in the supplementary material . for this event, the ranking of the event using tac  <dig>  and eventpointer are very different. the reason is the difference on the underlying statistical tests: eventpointer imposes that both isoforms  must change in opposite directions. in this case, the weak isoform changes its expression . however, the most expressed isoform does not change its expression at all and therefore, its statistical significance is low using the eventpointer test. the reason to implement this restriction is that this type of changes  has a debatable biological implication. nevertheless, the eventpointer test can also be changed to detect this type of events. if this is done, for this particular case the p.value is smaller than 1e– <dig> and therefore strongly significant.

dnm <dig>  is a mutually exclusive exon event. even though the ranking is not good in eventpointer, it was validated by pcr . tac shows that, although the change in expression between both isoforms is not large, each of the paths has different signs in the corresponding si .

discussion
we have presented a complete pipeline to detect as events using hjay and hta  <dig>  arrays. the main advantages of this method over the splicing index or aspire are that: 1) it can be applied to any experimental design  and not only to case–control studies, 2) it exploits the redundancy of all the junction probes involved in an alternative splicing event and 3) it labels all the events according to the different categories. all the suggested events can be validated using standard pcr by construction.

eventpointer is event-focused instead of transcript-focused  <cit> . it estimates the statistical significance of as events without estimating the concentration of the underlying transcripts. for each event, eventpointer identifies the type of event  and provides its statistical significance according to the design and contrast matrices given by the user. eventpointer also generates a graphical output using igv  <cit>  to make the identification and validation of the events easier.

there are, however, some events that cannot be identified with eventpointer. for example, a couple of isoforms with different transcription start sites in which one of them is included in the other. these types of events are also very difficult to detect using rnaseq or pcr since there is no a specific sequence in the second isoform to design a primer.

in this work, we consider that there is a differential splicing event if the isoforms in the associated paths change their expression in opposite directions. although this statistical test can miss some as events, the selected events have a clear change on their expression. these changes, usually, have more biological relevance than other subtler cases in which only one isoform – usually weakly expressed- changes its expression across the conditions.

once the affymetrix cel files are analyzed , the statistical analysis to detect the as events is very fast by using the limma package. using a standard intel i <dig> processor, the analysis requires about 10 s. the hardware requirements are modest . the whole enrichment analysis takes only fractions of a second. this is an advantage compared to the requirements on storage, computational power and memory of rna-seq analysis. in addition to that, the proposed methodology is very reliable: only one false positive was found within the top- <dig> tested events.

the validation rate is quite high. our thought is that the reasons for this are on the one hand eventpointer gets a single statistics that combines the information within all the probesets interrogating the event and, on the other hand, uses a proper reference region for each event: most of the methods select a number of probesets  that are used for all the events in the gene. however, in our case, this reference is different for each event.

one of the key parts of the analysis of alternative splicing is to provide a biological interpretation of the splicing events, i.e. what is the difference between the isoforms expressed in a condition specific manner.. eventpointer provides the protein family domains that are affected on each of the splicing events. it also performs an enrichment analysis  to identify which are the domains that are significantly over or underused in the condition under study. even though in its present form, eventpointer only provides information on the pfam domains we are actively developing it and we have some alpha versions of the software that provide annotation for other domain databases such us pirsf, superfamily, smart, prosite, or interpro. in addition to protein domains, there are other interesting biological data that could be inferred. for example in  <cit> , ray et al. identify the binding motifs of several hundreds of rna binding proteins and the potential binding sites in the human genome. using this information is possible to predict which are the splicing factors that are driving the differential usage of isoforms. another potential improvement would be to identify mirna binding sites and check if the splicing pattern causes skipping these binding sites and therefore, the corresponding mirnas may be no longer regulating the expressed isoforms. this functionality is already offered by altanalyze and we expect to include it in the near future. finally, in its present form, eventpointer works for the hjay and the hta <dig> arrays. we are actively developing the annotation to apply eventpointer to mouse and rat junction arrays .

eventpointer could be extended to rna-seq by building up the corresponding splicing graph and, in fact, we are currently working on this extension. altanalyze can also be applied to rnaseq and has been used for example in  <cit> . in order to apply eventpointer to rnaseq data, the splicing graph must be constructed based on the sequencing reads and/or the annotation . the statistics to perform the analysis must also be changed: instead of using a linear model on the log of the data signal, other methods such as voom  <cit> , or edger  <cit>  should be used to take into account the discrete nature of the reads.

there is one potential advantage of eventpointer when extending it to rnaseq experiments. in microarrays, the affinities of the probes are difficult to predict and, usually, they are considered to be unknown. any algorithm  get results by implicitly estimating the affinities given the data. the role of affinities in rnaseq is played by the length of the regions that originated the reads . eventpointer can be adapted to use the length of these regions to perform the statistics or leave them as unknown and guess them . this second approach does not require the general assumption of considering uniform coverage of the reads .

CONCLUSIONS
we have developed eventpointer software to detect as events using affymetrix arrays. it has a high validation rate and shows its effectiveness to detect as events using affymetrix splicing-sensitive arrays. in addition to that, its connection with igv makes it very convenient to validate the results using pcr.

this technique can be used on its own, but also to cross-validate rna-seq experiments. in addition to that, it provides a statistical analysis of the usage of protein domains and provides a single statistic per event that, to our knowledge, is a novel development for analysis at the transcript/event level.

