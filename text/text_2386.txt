BACKGROUND
an early event in the t cell mediated immune response is the recognition of pathogenic peptides contained in major histocompatibility complex  molecules. the capability of the vertebrate immune system to distinguish between a vast variety of pathogenic- and self-peptides is achieved by a tremendous population of different t cell variants , which differ from each other in the t cell receptor  . such a diversity results from the combination of two membrane anchored tcr chains , which are encoded by gene segments joined in a process known as vj recombination  <cit> . as depicted in fig.  <dig>  each chain consists of two immunoglobulin-like domains, the variable domain  and the constant domain. the vj combination process occurs during the t cell maturation in the thymus, where variable  and joining  gene segments are combined while nucleotides are randomly introduced within the variable domains . in the case of the vβ domain, an additional short segment is inserted in between the v and j segments, further increasing the tcr diversity . the binding interface of the tcr to the peptide-mhc molecule complex  is formed by loops named as complementary determining regions , and each chain of tcr contains three cdrs. while the primary structure of cdr <dig> and cdr <dig> loops evolved together with the mhc molecules  <cit> , the sequence of cdr <dig> loops is determined by the vj recombination and thus exhibits a higher diversity  <cit> .fig.  <dig> representation of the tcrpmhc complex . the mhc class i molecule is depicted in green . the β-microglobulin is colored in cyan and the peptide bound to mhc in magenta. the two chains of tcr, α and β, are represented in blue and red colors, respectively. in the present application, the domains shown as transparent are removed from the structure, and only the two variable domains of tcr , the α <dig> and α <dig> chains of mhc as well as the peptide are modeled. in addition, the two centers of rotations corβ and corμ, are respectively represented by an orange and a black colored ball




the number of resolved bound and unbound tcr structures has drastically increased to  <dig> in the protein data bank  <cit>  during the past few years. nevertheless, considering the vast variety of tcrs and the high polymorphism of the mhc molecules, the development of reliable structural methods is of crucial importance in order to complement time consuming experimental structural techniques  <cit> . such modeling approaches can help in the field of rational tcr design/optimization   <cit> , in the context of vaccine design  <cit> , and in the development of a consistent theory for t cell signal transduction, which is still not fully understood  <cit> .

over the past two decades, many theoretical methodologies have been developed and applied to model and predict tcrpmhc interactions.

the main focus in the area has been on the prediction of the mhc/peptide interaction without explicit consideration of the t-cell receptor as the experimental study of mhc-peptide binding has been a very active field since the mid-90s whereas the systematic investigation of the t cell response started about a decade later. in addition, mhc-peptide binding is a necessary prerequisite for the t cell response and thus has by itself already a highly predictive value. therefore various sequence and structure based prediction tools have been developed of mhc-peptide binding in the past decades  <cit> . next to mhc-peptide specific structure-based prediction methods such as epidock, predep, pdock, dynapred, or docktope , also general molecular docking approaches were applied  <cit> .

the first atomistic model of a tcrpmhc complex was built in  <dig> by almagro et al. using homology modeling and molecular dynamics techniques  <cit> , before the first x-ray structures of a tcr  and of a tcrpmhc complex  were solved in  <dig>  later, michielin et al. realized a homology model of the t <dig> tcr structure bound to the photoreactive pbsc peptide and to the murin kd mhc class i molecule, using the 1ao <dig> crystal structure of the tcrpmhc complex as a template  <cit> . the authors applied a methodology combining the modeller program with simulated annealing techniques  <cit> , and suggested a rational homology model, which was refined based on previous mutation studies  <cit> . further developments of the approach led to the tcrep 3d method  <cit> , which was recently applied in the context of rational tcr design  <cit> . in addition, haidar et al. enhanced the affinity of the a <dig> tcr to tax:hla-a <dig> for about 100-fold using a structure-based model  <cit> . more recently, pierce et al.  <cit>  developed an approach based on their scoring function zaffi and on the rosetta interface mutagenesis tool  <cit>  to identify relevant point mutations that could increase the affinity of a tcr to a pmhc complex in the field of therapeutic immunology. the method allowed to optimize the dmf <dig> tcr to bind the elagigiltv:hla-a <dig> complex with a remarkable ~400-fold higher affinity. the same group also developed tcrflexdock, a method to model a pmhc ligand onto a tcr that takes advantage of the monte carlo-based rosettadock protocol  <cit> . for a benchmark test set of twenty structures  <cit> , the prediction of near native models was reached in 80% of the cases. the tcrflexdock method was recently applied to predict models of tcrs bound to mhc like ligands such as cd <dig> and mr <dig>  <cit> . in that work, the authors showed that the use of multiple docking starting positions significantly improves the performance of the prediction.

in order to achieve an accurate molecular model of tcrpmhc complexes, it is necessary to consider several topological aspects of this sophisticated system. first, a precise description on an atomistic level is required, since small alterations in the tcr’s or in the ligand’s sequence can drastically affect the transduced signal  <cit> . as it was shown in other studies, mutations in the receptor or in the ligand can modify the binding affinity and thus the relative placement of the two units of the complex .

a second aspect to consider is the variation of the vα/vβ inter-domain angle within the tcr, as this is a system specific feature, and as it can adapt upon binding of the pmhc. the analysis of the inter-domain angle between the vα and vβ tcr domains as well as its influence on the binding of pmhc was analyzed in several computational studies, which compared broad sets of tcr structures. notably, by applying the pseudo-dyad method, mcbeth et al. suggested that the resulting observed differences between the free and the mhc bound forms of tcrs constitute a feature of the receptor to adapt to different ligands, thus allowing cross reactivity  <cit> . dunbar et al. analyzed a non-redundant set of tcrs with the abangle methodology  <cit> , which describes both the vα- and the vβ-orientation in an absolute manner, by considering a torsion angle, four bend angles and one distance as descriptors  <cit> . in the context of rational tcr-like antibody design, the authors found that antibodies adopt angles comprised in a different range than the one observed for tcrs. in our previous work  <cit> , we analyzed the relative vα- and vβ-orientation by reducing the variable domains to cuboids, which served as basis for a distance based clustering. we observed that tcrs belonging to the same clonotype associate in the same angular cluster. furthermore, we identified a center of rotation  and determined its location in the middle of a conserved interaction between two glutamine residues, one in the vα and one in the vβ domain. the various inter-domain angles in the evaluation set could be obtained through a rotation around this center. recent studies, including ours, further emphasized the large range of values that the tcr vα/vβ inter-domain angle can adopt  <cit>  and thus its influence on the positioning of the ligand binding cdr loops. these results suggest that next to the orientation of the pmhc ligand with respect to the tcr  <cit> , also the vα/vβ inter-domain angle should be explicitly taken in account to assess an accurate homology modeling of tcrpmhc complexes. this last comment is in agreement with recent observations about the dynamics of the tcrpmhc system and the influence of the tcr on the pmhc structure  <cit> . in addition, it was shown for antibodies that the consideration of the vh/vl angles for homology modeling can increase the accuracy considerably  <cit> . in this context, dunbar et al. identified key structural parameters, which provide a comprehensive description of the movement of the vh and vl domains with respect to each other  <cit> . based on these features and on their respective values in the available antibody structures, bujotzek et al. trained a predictor for the association of the two domains  <cit> . the authors further concluded that the consideration of the association angles is crucial for the prediction of highly accurate homology models of antibodies  <cit> .

along the course of the present study, we pointed out a third topological aspect that can have an impact on the success of tcrpmhc complexes modeling. the vα/vβ orientation directly depends on the proper interaction of two specific glutamine residues. during protein structure elucidation by x-ray crystallography, the ambiguous electron densities of nitrogen and oxygen atoms can hamper the correct assignment of these two elements. in the case of asparagine and glutamine residues, this often leads to misassigned atoms in the carboxamide group of the side chain. the detailed investigation of high-resolution structures shows that approximately 20% of these residues are assigned in a wrong flip state, leading to a non-optimal hydrogen bond network . the respective orientation of asparagine and glutamine residues has a dramatic impact on most of molecular modeling techniques  <cit> , and should be corrected by considering their direct environment. due to this significance, several approaches have been developed in order to address this issue. among those, the most popular ones are hbplus   <cit> , network   <cit> , reduce   <cit> , nq flipper  <cit> , the independent cluster decomposition algorithm   <cit> , protonate 3d  <cit> , protoss  <cit> , and the computational titration method  <cit> .

despite the great improvements in tcrpmhc complex modeling achieved during the past decades, some of the critical aspects described above are still not taken into account. to the best of our knowledge, none of the currently available methodologies explicitly include the adaption of the vα/vβ inter-domain angles, although these have a direct impact on the disposition of the cdr loops, and as a consequence, on the contact between the tcr and the pmhc ligand.

in what follows, we present a new method, dynadom, for the prediction of tcr vα/vβ inter-domain and tcr/pmhc association angles. we implemented our approach into the dynacell suite  <cit> , a general force-field-based molecular modeling program developed in our group. our new method uses an extendable multidimensional rigid body optimization approach based on the work by mirzaei et al.  <cit> . the implementation is specifically designed in a way that allows for an arbitrary definition of rigid bodies and for the inclusion of local flexibility on different levels  into the modeling pipeline . as a first application, we evaluate here the dynadom method for the remodeling of a large set of tcr and tcrpmhc complexes. this evaluation intends to determine the general capability of a rotation-based algorithm and the relevance of our cor-concept  <cit>  for the successful prediction of association angles. notably, we demonstrate here that it is possible to distinguish between correct and wrong models by solely using the force-field-based interaction energy computed between the different units of the complex. this is indeed very promising for future blind homology modeling of tcrpmhc complexes and others, especially if a sufficient amount of experimental data is not available for the training of an application-specific, knowledge–based scoring function.fig.  <dig> tcr and tcrpmhc complexes modeling pipeline. center column: standard pipeline  for the remodeling of the tcr vα/vβ association angles and for the pmhc positioning with respect to the tcr. blue highlighted steps are performed in both modeling pipelines: only vβ and combined vβ/pmhc placement. green highlighted steps are performed only if the pmhc is included in the remodeling process. the left and the right columns illustrate the individual steps of the pipeline. steps with numbers circled in black: tcr vα/vβ association angle modeling pipeline, steps with numbers circled in green: combined vβ/pmhc modeling pipeline. steps  <dig> to  <dig> are performed for each of the  <dig> starting conformations. the protein domains represented in blue, red, and green color correspond to the vα, vβ, and pmhc units, respectively. in step  <dig> , the different protein domains are described by unified cuboids and assembled. the illustration of steps  <dig> and  <dig> show the q-flip correction/optimization. at step  <dig>  each glutamine residue is optimized with respect to its direct environment only . whereas in step  <dig>  the two glutamine residues are optimized simultaneously, thus accounting for the whole tcr environment. in step  <dig> , the pmhc unit is pre-placed, translated away from the tcr and optimized with respect to the fixed tcr variable domains. at step  <dig> , the position of all cuboids as well as the orientation of the glutamine residues are optimized concurrently. the latter illustrations show the structure before and after optimization, with the target crystal structure depicted in gray





methods
the new dynadom prediction method presented here is based on the concepts developed for our previous analysis of the structural features of tcrpmhc complexes  <cit>  and uses the same theoretical framework as defined therein. in ref.  <cit> , we performed a comprehensive and systematic analysis of the vα/vβ inter-domain angles in a set of  <dig> structures, by representing each domain as a unified cuboid . the main results of that former work can be summarized as follows: i) we showed that the tcr complexes of the analysis set can be grouped into six structural clusters, by solely using the vα/vβ inter-domain angle as a descriptor; ii) we identified a conserved center of rotation that determines the orientation of the vβ domain with respect to vα ; iii) we pointed out that this center of rotation  is characterized by the interaction of two highly conserved glutamine residues , forming a stable hydrogen bond linkage between vα and vβ.

in the present work, we intend to translate this structural knowledge gained in ref.  <cit>  into a computational pipeline to model tcr and tcrpmhc complexes. we hereafter detail our strategy by first describing the general concepts of dynadom and the extension of the center of rotation concept to the case of tcrpmhc complexes. then, we describe the theoretical framework of our rigid body optimization algorithm and give a detailed description of the overall prediction pipeline. finally, we define the particular data set used in the present test application of dynadom for the remodeling of tcr and tcrpmhc complexes.

general concepts of dynadom
the dynadom modeling approach is based on the unified cuboid description of a given molecular assembly by assigning one cuboid to each structural domain, as applied to the tcr vα and vβ domains in ref.  <cit> . in the case of tcrpmhc complexes the vα, vβ, and pmhc units are represented by three independent cuboids. to further reduce the dimensionality of the problem, we use the vα domain as internal, fixed coordinate frame . in this frame, the placement of the vβ and pmhc units can be simply described by a series of translation and rotation operations around a given point of the cuboid. for the placement of vβ with respect to vα, we here chose this point as the previously identified center of rotation, corβ . in a similar manner, we define here a center of rotation for the placement of pmhc units, which we shall refer to as corμ.

the binding of the pmhc ligands onto tcrs has been suggested to occur in a generally diagonal mode  <cit> , based on the analysis of the early structures of this complex  <cit> . more recently, rudolph et al. introduced a general unified method to measure the binding angle of tcrs with respect to their ligands and determined the angular range of  <dig> complexes  <cit> . the latter method, based on a general rotational axis, is however too general to describe all the transformations of a pmhc complex in a three-dimensional space. we thus adapted our previously introduced cuboid method  <cit>  and measured the three euler angle components of the tcr/pmhc orientation. equivalently to the determination of corβ , we define here a center of rotation for the orientation of the pmhc cuboid relative to the vα domain . unlike corβ, corμ does not correspond any conserved residue and lies at the center of the peptide binding groove of the pmhc complex. as corβ and corμ are solely defined by the vβ and pmhc coordinates, we further use their location as rotational centers for the rigid body optimization. these locations will be named as corβ- and corμ-based rotational centers, respectively.

our strategy for the modeling of tcrpmhc complexes intuitively resembles the plausible biological process: i.e., first the association of the two tcr variable domains, then the approach of the pmhc complex towards the tcr cdr loops . we thus assume here that the general orientation of the tcr variable domains is determined prior to the binding of the pmhc ligand, and then further adjusts upon binding. as a consequence, comprehensive sampling of possible vα/vβ orientations is crucial and can determine the success of the modeling attempt. based on our former analysis  <cit> , we define here  <dig> starting orientations for the association of the two tcr variable domains. such number of different initial conditions is intended to cover the large range of vα/vβ inter-domain angles and to avoid artificial local minima. it also increases the probability that at least one of the obtained vα:vβ complexes is close enough to the final bound conformation such that it can effectively bind the pmhc ligand .

to determine the starting orientation of the pmhc cuboid, we analyzed the vα/pmhc angles associated with all structures considered in our set . the crystal structure 3e3q  <cit>  showed the lowest angular deviation with respect to the others and was chosen as reference structure. based on the normal vector to the plane defined by the mhc β-sheet backbone atoms of 3e3q we derived a translation axis for the pmhc.

the  <dig> starting structures for the tcrpmhc modeling pipeline are obtained such that for each of the  <dig> starting vα/vβ orientations, the pmhc ligand is placed in a general position  and afterwards translated away from the tcr along the 3e3q-based translation axis. for each of these structures one cuboid is defined around each domain, i.e. vα, vβ, and pmhc.

the relative position of these cuboids is then optimized iteratively along a succession of operations defined by our pipeline algorithm, for each of the  <dig> starting conformations of a given complex . our pipeline is built in a modular manner, such that beside the interaction between the different subunits, it is possible to explicitly model the flexibility of some relevant parts of the molecular system. as we detailed in the introduction, the center of rotation between vα and vβ  is characterized by the specific interaction of two glutamine residues . however, because of the ambiguous character of the q side chain, the assignment of the atoms  in crystal structures often happens to be wrong. furthermore, the central location of these two residues in the complex makes them particularly sensitive to variations in the vα/vβ inter-domain angles. for these reasons, our pipeline also includes a q-flip correction/optimization module, which is applied alongside with the general optimization of the whole complex.

for the modeling of one tcrpmhc complex, our pipeline algorithm thus results in a total of  <dig> structures, each of them originating from the corresponding starting orientation of the tcr variable domains. these structures are optimized and finally ranked according to their interaction energy.

rigid body optimization
we implemented our method within the dynacell suite of programs  <cit>  using a rigid body energy minimization approach based on the work by mirzaei et al.  <cit>  together with the broyden-fletcher-goldfarb-shanno  algorithm as implemented in the gnu scientific library   <cit> . details about the applied settings of the algorithm and a discussion about its convergence are presented in additional file 1: text s1c. mirzaei et al. introduced the original algorithm focusing on the rbem problem for molecular docking  <cit> . the approach is specifically designed for an efficient rotation of the rigid bodies around a center of rotation and is particularly well suited for our application. however, the original method only allows for a simultaneous optimization of the relative position of only two rigid bodies. we therefore extended it such that the simultaneous optimization of the orientation of an arbitrary number of rigid bodies is possible.

we implemented the method in a generalized, modular way, allowing for the individual design of application specific optimization pipelines, based on a given combination of the different functions during runtime. each pipeline step consists in the assembly of sub-process operators , which evaluate an objective function and the corresponding gradient to further perform the resulting coordinates transformations. each so manipulates the coordinates of a subset of atoms and calculates the value of the objective function within a given environment . so far, we implemented three different families of sos. we shall briefly describe them below, while a more detailed presentation can be found as supporting information .

the first family of sos consists of the basic operators for the rigid body rotation and translation. the objective function of these operators is computed from the non-bonded interactions between the rigid bodies of interest . the operators modify the three parameters for the rotation and one for the translation of the rigid body, either simultaneously or independently.

next to these general operators, we implemented a specific carboxamide group rotation operator. this operator is valid for both asparagine and glutamine residues. it only modifies one parameter, namely the dihedral angle that defines the orientation of the side chain’s carboxamide group. the rotation axis is set along the carbon-carbon bond next to this functional group . the objective function accounts for all bonded energy terms within the corresponding side chain and non-bonded energies within the system . this sub-process operator can be used within our prediction pipeline algorithm or independently, and we shall refer to as q-flip correction tool in the following.

finally, we implemented a rigid body position restraint operator to prevent unrealistically large translational motions and hence to avoid irrelevant conformations. the objective function in this case consists of a harmonic potential applied on the distance between a given reference and a mobile point. the harmonic penalty is applied if the distance is greater than the defined threshold. for the present modeling of tcrpmhc complexes, corβ and corμ are used to restrain the positions of the vβ and pmhc cuboids, respectively. the threshold values are set to  <dig>  Å for vβ and to  <dig>  Å for pmhc.

tcrpmhc prediction pipeline
the standard modeling pipeline for the prediction of the vβ orientation in vα/vβ complexes of tcrs as well as the orientation of both vβ and pmhc in tcrpmhc complexes is summarized in the central panel of fig.  <dig>  the illustration of the steps  applied during the modeling of the tcr alone are shown in black circles, while the steps used for the modeling of the tcrpmhc complexes are circled in green color. in addition, an animation of the modeling process is available as supporting information . we hereafter provide a detailed description of this pipeline for the modeling of one given tcrpmhc complex, based on the steps depicted in fig.  <dig> 


additional file 3: movie s <dig>  example for the prediction pipeline: remodeling of the structure with the pdb-id 1ao <dig>  




a modeling attempt starts with the representation of each subunit  as a cuboid and their placement in the reference coordinate frame .

after this initial assembly, the q-flip state of the central glutamine residues located at the corβ is corrected independently in each of the two tcr variable domains, by accounting only for the interactions within the corresponding domain, vα or vβ . at that stage, we only intend to correct the possibly wrong assignment of the q-flip state in the crystal structure. the interaction with the q in the opposite domain is not yet considered, as the correct q-q assembly is crucially dependent on the final vα/vβ association angle, which is still unknown at this stage of modeling. as a consequence, only two orientations are considered, the original one and a rotation of 180°. the orientation presenting the lowest energy is selected and further refined by performing  <dig> steps of bfgs energy minimization. as here only one parameter needs to be optimized, the optimization process is straightforward and  <dig> steps are sufficient to reach convergence .

based on these two preparation steps,  <dig> starting orientations of the tcr variable domains are constructed  and the pmhc ligand is placed in a general position and translated away from the tcr . details about this step are discussed in the “general concepts of dynadom” sub-section and in the additional file 1: text s1a/b. the position of the pmhc is pre-optimized with respect to the fixed vα and vβ domains, for a maximum of  <dig> bfgs steps. this step intends to mimic an approach of the pmhc from far towards an already formed tcr assembly. as the position of only one rigid body is optimized here, most of the optimizations converge in less than  <dig> steps. for the few optimizations that do not meet the bfgs convergence criteria, the energy still drops in few steps and reaches a stable plateau . as this step constitutes a preparation for the main optimization , these structures are considered as converged and the modeling pipeline proceeds.

next, the orientation of the central q residues is explicitly sampled in the context of the whole tcr assembly  with a fine step of 18°, leading to  <dig> different orientations . the orientation with the lowest energy is then selected and further minimized for a maximum of  <dig> steps and used in the next step. this ensures a proper orientation of the q residues with respect to each other for the current vα/vβ orientation. here again, considering the straightforward parameter space to be optimized and the explicit sampling performed ahead with a fine angle increment,  <dig> steps are sufficient to reach convergence.

the core step of the dynadom algorithm takes place after these preparation steps. at this stage, the position of vβ and pmhc as well as the orientation of the two glutamine residues are concurrently optimized . the minimization is first conduced for a preliminary  <dig> steps. then step  <dig> is repeated to ensure optimal q-q placement and interaction at the center of rotation corβ with respect to the adjusted global conformation of the complex. step  <dig> is finally repeated for a maximum of  <dig> steps. here again, most of the minimizations converge in a few hundred steps. the rare cases in which the bfgs algorithm did not converge were systematically analyzed, showing that in each case, the energy strongly decreases in a few steps and oscillates around a minimum value . therefore, these rare cases were also considered as converged in the present work.

finally, the quality of the current model  is evaluated by computing the complex binding energy  as:


e
i,bind = e
i, complex − ,

where e
i, complex is the total energy of the complex and e
α, e
β, and e
μ are the energy terms of the individual complex components vα, vβ, and pmhc . the energy is evaluated using the opls-aa force field  <cit> . as the current application is a remodeling attempt, we additionally computed the all-atom positional root mean square deviation  with respect to the crystal structure for each of the  <dig> final models.

the ranking of the  <dig> final models is performed according to their binding energy. for the current remodeling application, we define an energy criterion to assess the success of the remodeling attempt as ce. the energy criterion is fulfilled if the model having the best binding energy also bears an rmsd lower than 2 Å with respect to the original crystal structure. to gain more insight into the performance of our dynadom method, we define a second success criterion based on the rmsd, cr, which allows us to evaluate the performance of the structural modeling by assessing the structural deviation of the model from the corresponding experimental structure. this structural criterion is fulfilled if at least one of the  <dig> final models has an rmsd lower than 2 Å with respect to the original crystal structure.

structural data sets
we selected  <dig> biological units  originating from  <dig> different crystal structures contained in the set that we previously analyzed in ref.  <cit> .

in that study, we observed that the different bus within a given crystal structure can slightly differ from each other , especially in the exact location of side chain atoms. this is presumably due to the relatively high intrinsic flexibility of the complexes or the limited resolution in some of the structures . to evaluate the robustness of our method and its capability to tackle such inaccuracies, we included all bus in our two main datasets. the inclusion of all bus also results in a larger data set and, as no training of a scoring function is performed , introduces no bias to the method itself. in addition, the current datasets only contain structures in which all atoms that are involved in the modeling process were experimentally resolved. although these atoms or residues could be easily modeled, this would potentially introduce a bias in the set, which we prefer to avoid here. as summarized in table  <dig>  the tcrpmhc crystal structures selected for this work belong to two different species  and  <dig> different tcr clono-types . the coordinates of each structure were aligned with respect to the conserved residues of the vα domain, as described in ref.  <cit>  and in the previous subsections. the tcr constant domains, the mhc α <dig> domain, and the β-microglobulin were systematically removed from the structures as well as all non-protein atoms . hydrogen atoms were added and topologies were created for the opls-aa force field  <cit>  using the pdb2gmx tool   <cit> .table  <dig> description of the structural dataset dst and the subset dsc


a) t: structure only in dataset dst. t/c: structure in both datasets, dst and dsc


b) species : h human, m mouse

c) ligand type : mhc class i or ii. see additional file 4: table s <dig> of the supporting information for details about the mhc alleles and the different peptides

d) references




we further derived three different data sets. first, to evaluate the performance of our method for the remodeling of the association angle of the tcr vα and vβ domains, we removed the pmhc ligand in each structure. this resulted in a set of  <dig> vα/vβ complexes, which we shall refer to as dst in the following. in addition, we created a second data set, in which only the first bu in the pdb file of the corresponding structure was included . then, to perform the remodeling of tcrpmhc complexes, we selected among the  <dig> bus only the structures containing an mhc class i molecule. the resulting third data set, named as dsc, contains a total of  <dig> tcrpmhc complexes. we disregarded mhc class ii molecules in the dsc set to ensure a proper comparison between the samples. a third set could have been dedicated to mhc class ii molecules. however, we sustained from remodeling also that set as the results obtained for the mhc class i complexes already showed that further optimization of the pipeline, beyond this publication, is necessary for accurate pmhc placement. in addition, the size of the mhc class ii set  would have been very small for a robust analysis. further details about each data set are listed in table s <dig> of the supporting information .

RESULTS
the structural prediction of immunologically relevant molecular assemblies has focused the interest of a wide range of methodological developments over the past decades, especially in the field of antibody-antigen interactions  <cit> . compared to the effort made so far in antibody modeling, the number of predicted tcrpmhc structures is still relatively small, as we discussed in the background section. in the case of antibodies, it was recently shown by some of us, that statistical learning techniques can efficiently predict the vh/vl association angles  <cit> . such very appealing approaches are based on experimentally observed structural features and require a large amount of existing data. in the particular case of antibodies, over  <dig> crystal structures are already available, thus allowing the application of such knowledge-based methodologies. considering the relatively small amount of tcr structures referenced in the protein data bank , such a road can unfortunately not be envisaged for the prediction of association angles in tcr complexes. as a consequence, we developed here a solely force-field based optimization strategy for tcr and tcrpmhc complexes modeling. such a force-field based approach can potentially be applied to other similar systems, even if a sufficient amount of experimental data is not available for the training of a specific scoring function.

as we extensively described in the background and in the methods sections, this new algorithm, named as dynadom, is derived from our previous comprehensive analysis of the vα/vβ tcr variable domain association angles  <cit> . the main conclusions that arose from this former work can be summarized as follows: i) tcr complexes can be classified into structural clusters, differing significantly in their vα/vβ inter-domain angles, ii) the angular differences between the structural clusters can be described by a simple rotation around a center of rotation , and iii) the corβ is characterized by two highly conserved glutamine residues, which contribute to the interaction between the tcr vα and vβ domains via a stabilizing hydrogen bond network.

for the remodeling of tcrpmhc complexes, the dynadom method uses a unified cuboid description of the three different units of this complex . the optimization of the total system is performed by a rotation-based algorithm, which is based on our center of rotation concept . in our previous analysis study, we observed that the vα/vβ association angle spectrum is much larger in unbound tcrs than in structures bound to the pmhc  <cit> . pierce et al. further emphasized that for the prediction of tcrpmhc complexes from unbound units  <cit>  the side chains of the cdr loops must adapt to their environment in order to allow for a proper interaction between the different units of the complex. therefore, the inclusion of local side chain flexibility at the domain interface would most likely be a necessary extension for the prediction of tcrpmhc structures from unbound or homologous tcr and pmhc structures by homology modeling techniques. our generalized, modular implementation ensures that the additional inclusion of local flexibility is straightforward. however, the adaptation of the algorithm would require additional extensive evaluation efforts, which would go beyond the scope of the present work and will be part of future investigations. nevertheless, in the present work we already tested such a feature by the inclusion of local side chain flexibility for the two q-q residues at the corβ, which we found to be crucial for the prediction success as we shall discuss in the following subsections.

the current version of our pipeline algorithm, results from an extensive series of evaluations intended to assess the effect of the different parameters. hereafter, we present and discuss our main findings together with the actual evaluation of the method. we first discuss the optimization of the orientation of the glutamine residues  located at the interface between the two tcr variable domains , based on the original experimental structures. then, we analyze the effect of such a q-flip correction together with the use of restraints on the remodeling of vα/vβ tcr and tcrpmhc complexes. along this analysis, we compare the results obtained using either an energy or a structure based selection criterion . this comparison intends to state if an atomistic force field energy based criterion could be used for future blind homology modeling of tcrpmhc complexes. we finally suggest further possible routes of improvement for our methodology, based on the analysis of the few cases in which the remodeling process did not lead to a satisfactory structure.

glutamine orientation correction
the interface between the vα and vβ domains of tcrs is characterized by the interaction of two highly conserved glutamine  residues  <cit> . while this q-q interaction appears to be of critical importance, the flip state of these residues is often wrongly assigned in experimental crystal structures, due to the ambiguous character of the carboxamide group electron density . in the context of this work, we analyzed the flip state of the q residues among the crystal structures contained in our set of  <dig> vα/vβ complexes . only  <dig> % of the structures present a correct assignment of the q-flip state. the details of this analysis are listed in table s <dig> of the supporting information .

as discussed in the background section, many modeling tools exist to correct the orientation of glutamine and asparagine residues in a given crystal structure. among those, we tested reduce  <cit>  and protoss  <cit>  on our dst set. the application of the reduce and protoss programs leads to an improvement of the glutamine flip state in our set, reaching  <dig>  and  <dig> % of correctly assigned q-flip states, respectively. analysis of the failed cases showed that they featured an interaction of the q residues in an initial bifurcated orientation . manual inspection showed that in these cases the perpendicular orientation allowed for optimal interactions with the rest of the domains and should therefore be the most stable in the functional receptor . as the reduce and protoss programs only allow parallel orientations, these cannot successfully predict such particular interactions. because of this limitation and the below discussed observation that the q-flip state can change upon the association of the vα/vβ domains, we decided to implement an independent q-flip correction approach using our already implemented rigid body operators, such that it can directly be included into our pipeline. this represents a first probing of the modular character of our implementation, which we shall follow towards the future inclusion of local flexibility.

we evaluated the performance of our method for the q-flip correction in the crystal structure of the dst set. we present here the most relevant findings of our analysis, while a more detailed discussion can be found as supporting information , together with the entirety of our observations per structure . using the dynadom correction module,  <dig> % of the structures could be assigned in the good q-flip state. an example of a successful q-flip correction is depicted in fig. 3b for the 2f <dig> crystal structure. this higher performance obtained by our method with respect to the other programs comes from the optimization-based methodology that we implemented. while standard tools only consider two possible parallel conformations per residue , dynadom performs an explicit sampling of the carboxamide group using adjustable angular step sizes, followed by an energy minimization step during which the atomistic environment of the residue is taken into account. such a protocol allows the system to escape local minima in order to find the most favorable conformations of the q residues in their environment. for this reason, the dynadom approach can also lead to a proper paring in the case of the two systems that present a bifurcated q-q interaction.fig.  <dig> remodeling of the 2f <dig> structure. a superposition of the  <dig> vβ starting orientations with respect to the vα domain . the average conformation of vβ is shown in red color. b hydrogen bonds of the conserved q-q interaction at the corβ position. left: misassigned conformation in the experimental crystal structure. right: proper orientation of the q residues after application of the q-flip correction. the picture shows that the interaction between the two residues has been improved as well as the interaction of the residues with their respective environment. c modeling of the ternary tcrpmhc complex. the vα, vβ, and pmhc units are represented in blue, red, and green colors, respectively. the reference crystal structure is depicted in gray color. left: initial assembly of the complex. right: final model with an rmsd of  <dig>  Å with respect to the crystal structure. magnifications lenses: conformation of the conserved q-q interaction between the vα and the vβ domain




in a second step, we assessed the steps of our pipeline at which this correction should be performed. for this we applied our tool on the two tcr variable domains independently and compared the results with the same calculation performed in the vα/vβ complex environment . in this analysis, we observed different predicted q-flip states if the corrections were applied on the single domains or on the final complexes. this observation emphasizes the impact of the environment of the glutamine residues on their respective conformation. for this reason, our standard pipeline algorithm performs the q-flip state correction at two different steps. first, the glutamine residues are optimized accounting only for their respective domain environment . this allows for a proper orientation of the glutamine residue prior to the complex assembly, thus eliminating potential errors originating from the experimental structures. it is noteworthy that this feature will be particularly relevant if homology modeled structures are built. then, further optimizations are performed in the complete environment during the vα/vβ complex optimization to adapt the q residues to the final relative orientation of the vα and vβ tcr domains.

modeling of the tcr variable domain complexes without pmhc
we tested our dynadom methodology first for the remodeling of the vα/vβ association angles in the complete dst set. in particular, we performed a series of evaluations to assess the relevance of two criteria in our algorithm pipeline: the use of the q-flip correction and the application of a distance restraint between vα and vβ. furthermore, we analyzed the performance of our method according to two selection criteria. for a given remodeling experiment, dynadom produces  <dig> models, which are ranked by their rmsd or energy score . the remodeling experiment is then counted as successful if the rmsd of the selected model with respect to the original crystal structure is lower than 2 Å.

our results are summarized in table  <dig> and the different evaluation settings that we considered are generally labeled as mt plus a bit string, which encodes for the use or not of the q-flip correction and the restraint . the last mt
* <dig> test corresponds to the mt <dig> settings performed for the dst* data set, which contains only the first bu of each experimental structure.table  <dig> prediction accuracy for the vα/vβ association angles modeled without pmhc

esa
c
d
mt

aevaluation setting label


bvariants: q = glutamine carboxamide group orientation correction, r = rigid body position restraint


cabsolute and relative prediction rate according to the rmsd based criterion  in data set dst . in the particular case of mt
* <dig>  the prediction was performed on the dst
* set . for each prediction run, the  <dig> models are ranked by rmsd and a success is counted if the selected structure has an rmsd value lower than 2 Å


d same as c) using the energy criterion to rank the  <dig> structures and select the best. the prediction is considered as successful if the selected structure has an rmsd value lower than 2 Å




considering the cr criterion, the remodeling procedure already reaches a very high positive prediction rate of  <dig> %, even if no q-flip corrections or restraints are used . this rate further increases to  <dig> % if the q-flip correction is switched on , while no change is observed if the distance restraint is used alone . as a consequence, the final prediction rate, with both parameters switched on, also reaches the remarkable rate of  <dig> % . only three outliers are observed, originating from the 3dxa and from the 1mwa crystal structures. the relatively low resolution of the 3dxa structure  can partially explain this failure. furthermore, our modeling process only considers the vα and vβ domains of the tcr complex. it is possible that the two constant domains of the complex play an important role in these three outlier cases. regarding the additional experiment performed on the dst
* data set , the results in table  <dig> show that the differences in the achieved accuracies with respect to mt <dig> are only marginal. this confirms that the inclusion of the bus does not bias the overall results and demonstrates the robustness of our algorithm with respect to small variations in the structures, thus highlighting the suitability of the approach in a future homology modeling pipeline.

in the perspective of a blind homology modeling experiment of tcr complexes, no reference crystal structure would be available and only an energy-based criterion could be considered for structure selection . based on such a ce criterion, our remodeling attempt reaches a prediction rate of  <dig> % even if no q-flip corrections or restraints are applied . the prediction rate increases with both, the independent use of the q-flip correction and the distance restraint to  <dig>  and  <dig> % for mt <dig> and mt <dig>  respectively. if both parameters are used , the prediction reaches the remarkable rate of  <dig> % and even  <dig> % for the mt
* <dig> data set. this last result is very promising for the further applications of the dynadom method in a real structure prediction setting.

it appears that the use of the distance restraint has a stronger impact on the prediction rate obtained according to the ce criterion than it has for the cr criterion. this could be attributed to the observation that without distance restraint, the algorithm can yield structures in which the two tcr domains are placed in an unrealistic conformation, which nevertheless has a lower interaction energy . such unphysical associations are far from the original crystal structure and are intrinsically discriminated by an rmsd based selection criterion.

next to the analysis of the best conformations according to the ce and cr criteria we also analyzed the overall performance of the algorithm regarding the quality of all predicted conformations. in fig.  <dig>  we present the percentage of structures having an rmsd value lower than  <dig>   <dig> and 3 Å, depending on the algorithm settings  among all 75* <dig> models produced by our dynadom procedure. in this context we also further analyzed the impact of the q-flip correction by classifying the resulting models into two groups, with respect to their original q-flip state in the experimental structures as paired  and mispaired . notice that 4* <dig> structures lack the presence of q residues at corβ and were therefore not included in the respective analysis. the histograms  show that an overall percentage of about 80% of the models feature an rmsd lower than 2 Å and thus fulfill our success criterion. this demonstrates the robustness of the presented algorithm and thus its relevance as one step in a comprehensive structure prediction pipeline. by further analyzing the influence of the q-flip correction on the prediction rates, it can be observed that the overall prediction success is higher for structures in which the q-q orientation is already correct in the x-ray structure . for these structures 85% of the models have an rmsd value lower than 2 Å, whereas the rate drops to 75% for the mispaired structures. this might be due to the relatively smaller size of the latter data set, as an investigation of a possible correlation between the crystal structure resolution and the quality of the final models did not yield any significant outcome.fig.  <dig> percentage of structures among the 75* <dig> models with an rmsd value lower than  <dig>   <dig> and 1 Å. the total set of 75* <dig> structures is separated into structures for which the q residues were originally paired or mispaired within their corresponding crystal structure. each histogram box corresponds to a different setting of the modeling procedure, i.e. with only distance restraint , only q-flip correction , both , or none of them . the percentage of structures with an rmsd value lower than  <dig>   <dig> and 1 Å are presented on the left, middle, and right plots, respectively. the right plot shows that for the structures presenting an originally wrong orientation of the q residues, the q-flip correction significantly improves the quality of the resulting model 




regarding the percentage of structures having an rmsd value lower than  <dig> and 3 Å for both sets, paired and mispaired, the results are practically independent on the defined settings and only a slight trend towards an improved performance can be observed if the q-flip correction is applied. this low impact on the overall structures is most likely due to the large surface area of the total tcr domain interface and thus the high number of other interactions, which drive the overall optimization of the domains orientations. the use of the q-flip correction has, however, a remarkable effect on the quality of the resulting structures once the cutoff is lowered to 1 Å. the percentage of models featuring such a low rmsd indeed increases from  <dig> to 60% for the mispaired structure set, if the correction is switched on. these observations reveal the importance of a correct orientation of the conserved q residues at the center of rotation corβ for an accurate modeling of the tcr variable domain association and the need for their correction if they are wrongly assigned in the template structure.

overall, this series of remodeling essays highlights the quality of our methodology. it also further emphasizes the applicability of a force field interaction energy-based criterion, which is very promising in the perspective of a homology modeling setting, as it shows that high-quality structures can be identified by this means.

modeling of the pmhc position with simultaneous tcr variable domain placement
regarding the successful results obtained for the remodeling of tcr vα/vβ assemblies discussed in the previous subsection, we shall now assess the performance of the dynadom method to remodel tcrpmhc complexes. here, the calculations were performed on the smaller set of structures dsc, which contains a total of  <dig> biological units. our results are listed in table  <dig> and the labeling of the test settings follows the nomenclature introduced above .table  <dig> prediction accuracy for the combined prediction of the vα/vβ and tcr/pmhc association angles

esa
c
d

aevaluation setting label


bvariants: q = glutamine carboxamide group orientation correction, r = rigid body position restraint


cabsolute and relative prediction rate according to the rmsd based criterion  in data set dsc . for each prediction run, the  <dig> models are ranked by rmsd and a success is counted if the selected structure has an rmsd value lower than 2 Å


dsame as c) using the energy criterion to rank the  <dig> structures and select the best. the prediction is considered as successful if the selected structure has an rmsd value lower than 2 Å




an example of successfully predicted complex is depicted in fig. 3c for the structure 2f <dig>  in the figure, the vα, vβ, and mhc units are respectively colored in blue, red, and green. the two images represent the complex before and after optimization . the magnifying glass shows that the q-flip state is efficiently corrected and one can observe that the final model successfully fits the reference crystal structure .

regarding the prediction rates according to the cr and ce criteria in table  <dig>  the percentages obtained for the remodeling of tcrpmhc complexes reach a less striking prediction rate, though still relatively high . for the prediction based on the cr criterion, the success rate appears to be independent on the use of q-flip correction and distance restraints. a similar trend is observed with the ce criterion. in this case, the use of one or both of the parameters only marginally increases the prediction rate. as for the modeling of tcr variable domains alone, the use of an energy based criterion yields very satisfactory results compared to a structure based one. this point also confirms the robustness and thus the suitability of our method for a blind homology modeling of tcrpmhc complexes.

detailed performance analysis for the tcrpmhc prediction
regarding the overall, nearly equal, performances of the different settings in table  <dig>  it clearly appears that the drop of the prediction rate for the remodeling of tcrpmhc complexes with respect to the modeling of only the tcr variable domains is barely dependent on the use of q-flip correction and distance restraints. the former parameters only affect the relative orientation of the vα and vβ domains. this observation indicates that the lower performance observed for the remodeling of tcrpmhc complexes might originate from an incorrect placement of the mhc molecule. we thus performed additional analyses to gain more insights into the shortcomings of the current approach and to identify potential routes for future improvement of our algorithm. to further confirm that the issues encountered in the remodeling of tcrpmhc complexes are solely due to the prediction of the pmhc positions with respect to the tcr, we analyzed the impact of the initial placement of the pmhc ligand on the remodeling of tcrpmhc complexes. in this context, we shall only consider the models obtained according to the rmsd based criterion .

in the following series of test evaluations , we only consider the initial orientation of the tcr domains as found in their crystal structure . this was done to eliminate any potential biasing errors originating from the tcr domain modeling. next to that, we used the settings of the final modeling pipeline: i.e.,vβ optimization, q-flip correction, and position restraints were systematically applied during these tests. as we described in the methods section and depicted in fig.  <dig>  our modeling protocol includes a translation of the pmhc unit along a given axis to separate pmhc from the tcr, thus avoiding strong initial forces due to unphysical steric hindrance. this feature is one parameter that we shall analyze in the following tests . for each test setting, a rigid body optimization of the pmhc around its starting position was performed. finally, for the first two test evaluations , the mhc rigid body was initially placed in its crystal structure orientation, while for the last test , this unit was oriented according to the general zero conformation discussed in the method section . the results and details of each test evaluation are presented in table  <dig> table  <dig> prediction rates of the test evaluations

esa
d
t1
t2
t3
for each test the q-flip correction as well as the use of distance restraint are systematically applied. the tcr vβ domain is placed in its original crystal structure orientation and is optimized. the tests are performed for each of the  <dig> structures present in the dsc data set and the mhc rigid body position is optimized in each case


aevaluation setting label


bthe initial orientation of the mhc unit is chosen either according to the original crystal structure or using the general zero orientation as for the standard version of our pipeline 


cinitial translation of the mhc unit to avoid steric hindrance, necessary if the mhc rigid body is not placed according to the crystal structure orientation 


dabsolute and relative prediction rate according to the rmsd based criterion  in data set dsc . for each prediction run, a success is counted if the resulting model has an rmsd value lower than 2 Å with respect to the crystal structure




in the first test evaluation  in which the pmhc units are oriented according to their respective crystal structure orientation and no initial translation is performed, the prediction rate reaches  <dig> %. although such a result could be expected as we start from the experimental conformations, it proves that our algorithm does not lead to any conformational artifacts. the additional application of the initial translation step for the pmhc ligand  results in a drastic decrease of the prediction rate to  <dig> %, slightly lower than the result obtained using our standard protocol . for the final test , in which the translated pmhc was placed according to our standard protocol, the prediction rate of our algorithm dramatically drops to  <dig> %, which is significantly lower than for the final pipeline setting .

these results show that the translation procedure and the preplacement of the pmhc ligand in a single general starting position constitute the accuracy limiting steps of our pipeline. in addition, we confirm here that the use of various starting positions for the vβ domain clearly outperforms the case in which a single conformation is considered, even if the latter corresponds to the experimental crystal structure . at first glance this is a surprising result. however, it clearly appears that the simultaneous optimization of both the tcr domains and the pmhc molecule as performed for the mc <dig>  but not the t <dig> setting, is highly beneficial for the performance of the algorithm as it allows for an alternating adaption of the flexible units with respect to each other . this leads to a smoother optimization path, thus lowering the probability for being trapped in a local minimum. different starting positions further lower this probability as multiple paths are sampled.

consequently, one straightforward way to improve our results should be to use multiple starting conformations for the pmhc ligand, in accordance with the  <dig> vβ preplacement orientations. to evaluate this procedure, we chose one structure  for which the modeling process failed in the last t <dig> test settings. for this structure, the three euler angle components defining the pmhcs corμ-based rotational center were systematically varied by 5° and all  <dig> resulting starting poses were constructed. in accordance with the other test settings, the vβ domain was here again placed in its crystal structure orientation. the results for the  <dig> resulting models are listed in the supporting information . the results improved considerably as this time five structures were obtained with an rmsd lower than 2 Å, thus satisfying our success criterion. notably, these five models also show the lowest interaction energy among the  <dig> predicted structures. this last test clearly confirms the necessity of more advanced sampling protocol for the mhc molecule orientation in our modeling strategy to avoid the complex geometry to fall in an unfavorable local minimum. this is in agreement with the observations made by pierce et al.  <cit>  and demonstrates once again the importance of starting from multiple initial conformations. however, a straightforward combination of the  <dig> starting conformations of the tcr vβ domain together with the  <dig> initial orientations of the pmhc unit would lead to a total of  <dig> structures to optimize per tcrpmhc complex, thus resulting in a dramatic increase of the computational cost.

therefore, the presented algorithm provides excellent results and can readily be used for the optimization of the vα/vβ association angles. it also yields a fairly good prediction rate for the prediction of tcrpmhc complexes association. however, for the simultaneous optimization of both, the tcr domains and the placement of the pmhc in the latter case, further improvements and evaluations will be necessary prior to its practical use as one step in a real structure prediction pipeline. considering the general, modular character of our implementation, also different approaches could be combined with the current method to tackle this issue. among those, basin-hoping techniques  <cit>  have proven to provide good results for the rigid body optimization of tryptophan zippers  <cit> , and monte carlo-based rigid body sampling was recently applied by pierce et al. for the placement of mhc like ligands alone  <cit> . despite the numerous tests that would be required for the combination of such techniques, this route represents a promising strategy for the future of our methodology.

CONCLUSIONS
in this work we presented a new procedure, dynadom, for the optimization of protein domain-domain orientations, which was designed for and evaluated on the special case of remodeling t-cell-receptor-peptide-mhc complexes. the approach is based on several rigid body optimization and restraining routines, and uses atomistic force field-based energy calculations. the individual optimization functions are combined in an application-specific pipeline. the method yields remarkable results for the remodeling of tcr vα/vβ association angles with prediction rates of 89–96%  depending on the evaluation criterion.

the present study shows that it is possible to predict the tcr vα/vβ association angles on the basis of structural modeling only, without the need for a specially tailored experimental data dependent scoring function. it also demonstrates that the previously identified center of rotation concept  <cit>  can be readily used for the structural prediction of the association angles.

another striking result arising from this work is the observation that, by simply considering the best-energy conformation for each structure, high prediction rates of  <dig> % for the vα/vβ association angles could be obtained. this is only marginally lower than the prediction rates obtained for the models with the smallest rmsd. this shows that ranking the modeled structures solely by their force field-based interaction energy allows the identification of high quality structures and demonstrates not only the robustness of the method, but also its suitability as part of a general structure prediction pipeline for tcrpmhc structures.

in a second step, we applied the concept to the simultaneous optimization of the tcr vα/vβ association angles and the pmhc positions on the tcr. however, due to efficiency considerations we used a simplified placement method for the pmhc, which resulted in lower prediction rates of 72–74%. this result is still in the predictive range, but not as high as for the tcr domain optimization. additional preliminary investigations showed that the main reason lies indeed in the initial placement method of the pmhc ligand and that by simply using multiple initial conformations for the pmhc placement, already significant improvements in the placement accuracy are possible. however, a systematic optimization of the method for pmhc placement would require further significant evaluation studies, which would go beyond the scope of this manuscript and which will be the topic of future studies together with the application of dynadom to the blind homology modeling of tcrpmhc complexes. in general, the presented approach is very well suited to serve as basis for the development of such a method for the prediction of atomistic models of tcrs or tcrpmhc complexes taking inter-domain angles into account. due to the modular design of our program, a straightforward combination and concurrent optimization of multiple features is possible, as already demonstrated in this work by the concurrent optimization of the vβ orientation, the pmhc orientation, and the adaption of the glutamine residues connecting the two tcr chains. thus, the future implementation of partial or full flexibility of side chains or protein backbone regions, which then could be simultaneously optimized while the rigid body positions are adapted, should be straightforward. in addition, including other domains of the complex, such as the tcr constant domains would also be possible. this could help to study e.g. scissoring effects observed for the constant domains  <cit>  or to investigate tcr signaling, which was elsewhere discussed to be induced by conformational changes in the constant domains  <cit> .

finally, it is worth noting that the dynadom strategy is not limited to tcrpmhc assemblies. the combination of the different modules can indeed be easily modified to fit the requirement of other rigid body based predictions of a large variety of biomolecular assemblies.

additional files

additional file 1: 
text s <dig>  detailed discussion of important methodological aspects. 


additional file 2: 
text s <dig>  detailed description of the operators. 


additional file 4: table s <dig>  structural dataset dst and the subset dsc. 


additional file 5: table s <dig>  performance of the q-q interaction optimization. 


additional file 6: 
text s <dig>  glutamine correction and adaption . 


additional file 7: 
table s <dig>  per residue flip states using reduce, protoss and dynadom comparing single domains and tcr complexes. 


additional file  <dig> 
table s4: angular deviations with respect to the crystal structures after dynadom glutamine refinement. 


additional file  <dig> 
figure s1: discrimination of the models. 


additional file 10: 
figure s2: influence of the restraint operator. 


additional file 11: 
table s5: pmhc optimization for the structure 1oga with different pmhc start conformations. 




abbreviations
bfgsbroyden-fletcher-goldfarb-shanno

bubiological unit; crystallographically independent molecule in the asymmetric unit

cdrcomplementary determining region

ce, crranking criterion based on the energy or the rmsd, respectively

corβcorμ, center of rotation in repect to the tcr vβ and the pmhc, respectively

dscdata set tcrpmhc complex

dst*reduced dst containing only one bu per structure

dstdata set tcr

mhcmajor histocompatibility complex

mt, mcmodeling run for the tcr test set or the complex test set, respectively

pdbprotein data bank

pmhcpeptide presented in a major histocompatibility complex molecule

qglutamine

rmsdroot mean square deviation

sosub-process operator

t <dig>  t <dig>  and t3test evaluations with different conditions

tcrt cell receptor

vh, vlantibody variable domains of the heavy and the light chain, respectively

vα/vβvariable domain of the tcr α- and the β-chain, respectively

