BACKGROUND
annotation of protein functions is one of the challenging tasks in bioinformatics field when facing the mass of the protein sequence data in the post-genomic era  <cit> . it has been generally acknowledged that protein function annotation not only promotes progress of cell biology, but also benefits the development of pharmaceutical industry. however, the current situation is that there is a huge gap between large available protein sequence data and less identification of protein function. so there is an urgent desire to bridge this gap through developing accurate automated bioinformatics approaches since the wet-lab experiments are particularly laborious and expensive. in many cases, protein realizes its own specific function through interaction with other molecules or ligands in the living cell  <cit> . specifically, protein is activated by its amino acid residues interacting with other residues from other proteins or small molecules and thus forms the so-called interaction interfaces  <cit> . hence, in order to reveal the protein’s complex functions, the first critical thing is often to accurately identify these interacting residues from hundreds or even thousands of other residues. based on these important targets, we can then recognize the protein functions either through wet-lab analysis or other dry-lab experiments.

a lot of excellent works have been reported to distinguish interacting functional residues and analyze the characteristics of interaction interface  <cit> . the early approach is based on multiple orthologous protein sequence alignment, and then assigning the most highly conserved ones as interacting residues  <cit> . although the alignment based algorithm is demonstrated successful when a great number of protein sequence candidates is available and the aligned sequences from distinct species share similar functions  <cit> , it often yields high false positive rates in the cases except for the above situations. there is hence a high desire to develop more robust methods  <cit> . later on, analysis coupled with protein structural data has been demonstrated to be capable of improving the prediction performance than those obtained only by protein sequence features  <cit> , where the corresponding network is modeled by the 3d structural data of the corresponding protein molecule. there is an assumption that interacting residues should be easily recognized if they have distinguishing features  <cit> . based on this, many researchers begin to focus on analyzing unique sequential characteristics of interacting residues and the corresponding interaction geometry interfaces  <cit> . nooren et al.  <cit>  studied the composition of interacting residues and revealed existing different tendency between those residues from different type of protein complexes. it is suggested that amino acid physicochemical properties may also promote the prediction of binding residues  <cit> . furthermore, many structural characteristics related to identification of critical residues have been intensively investigated, such as the secondary structure information etc.  <cit> . david et al.  <cit>  has made a comprehensive characterization of protein interaction interfaces, and found that main-chain atoms contribute significantly to protein-protein interactions, where the type of interaction is highly dependent on the secondary structure type. the recently proposed dogsite method investigated the concept of subpockets and the difference of gaussian approach  is found to be able to improve the prediction rates of protein active sites  <cit> . except for the efforts to find the discriminative features of interaction sites and their local sequential or structural environment, some studies are aiming to develop much more robust machine learning algorithms. in the report by sankararaman et al.  <cit> , both sequence conservation features and the structure information are integrated into a logistic regression model for a rough prediction. and then the regularized maximum likelihood approach is further exploited in the process of estimating the related parameters for avoiding overfitting phenomenon. these results show that a proper post-processing framework is helpful for yielding better prediction performance.

in this paper, we focused on the specific protein-atp binding sites prediction, which will play essential role in reavling the mechanisms of protein-atp complex. atp is one kind of multifunctional nucleotides in nature composed of adenosine diphosphate  or adenosine monophosphate , acting as a coenzyme in transferring chemical energy between different cells and further supplying energy for metabolism and chemical synthesis within cells  <cit> . tremendous experimental studies have shown that atp converts itself into adp or amp when it releases energy previously carried, and on the contrary, adp or amp is transformed into atp after it absorbed the chemical energy  <cit> . so atp is constantly circulated in organisms and consumed as much as the weight of the human body each day. naturally, atp needs to interact with many proteins in the body to accomplish its tasks, which make it necessary to investigate atp-protein binding residues. of course, such knowledge can be obtained by conducting various wet-lab experiments, it can be very expensive and large time-consuming. consequently developing computational methods for protein-atp binding residues prediction has a great potential application. despite the importance of the relevant research, little work was reported in this regard. raghava et al. <cit>  has done some significant work on protein-atp binding sites prediction from the amino acid sequence. they firstly constructed benchmark dataset consisting of  <dig> non-redundant atp binding protein chains. subsequently they trained several models based on different feature groups respectively such as amino acid composition of protein sequence, protein evolutionary information in the form of position specific scoring matrix  profile, and seven physicochemical properties of amino acid. studies by raghava et.al revealed that evolutionary information was critical for distinguishing protein-atp binding residues from conventional residues of protein sequence. kurgan et.al developed a sequence based predictor called atpsite for predicting protein-atp binding sites and achieved very promising results  <cit> . in this paper, we followed these pioneer studies aiming to discover novel discriminative features around protein-atp interactions sites and further improve the prediction performance of protein-atp binding sites. considering the importance of protein structural features in predicting protein functional sites in other studies, other than only the amino acid sequential features, we investigated other sequence derived structural features, i.e., protein secondary structure, protein amino acid disorder information, as well as solvent accessibility of amino acids. furthermore, we also made use of the so-called bi-profile sampling method  <cit>  to process these multi-view features. our experimental results based on both the 5-fold and leave-one-out jackknife cross-validation tests show that a proper fusion of multi-view features is helpful for improving predictions of the protein-atp binding sites.

methods
benchmark dataset
in the present study, two benchmark datasets were adopted. firstly, we exploited the same dataset consisting of  <dig> protein sequences, denoted as atp <dig>  which was firstly organized by raghava et al.  <cit> . this dataset was selected from supersite encyclopedia  <cit>  and then further reduced sequence identity below 40%  <cit> . to further demonstrate the effectiveness of the proposed method, the second most recent dataset that contains  <dig> sequences constructed by kurgan et.al  <cit> , denoted as atp <dig>  was also exploited. the sequence identity of any two proteins is also less than 40% in atp <dig>  which is available at http://biomine.ece.ualberta.ca/atpsite/.

in following experiments, we performed both 5-fold and leave-one-out cross-validations  on the atp <dig> and atp <dig> datasets. taking atp <dig> as an example, in the case of loocv, each atp binding protein chain in the dataset was singled out in turn as the testing sample and the remaining  <dig> sequences constituting of the training dataset. this practice continued until all the protein chains in dataset were traversed over. binding and non-binding residues in the training dataset were regarded as positive and negative samples to input into the machine learning models for training and prediction purposes. it should be pointed out that when constructing the positive and negative training subsets, imbalance phenomena is observed since the number of non-binding residues is far more than the number of binding residues. our following experimental results based on selecting different ratios between positive and negative will show that the imbalance will affect the final performance of prediction model. at the beginning of the experiment design, we performed a random selection process from all non-binding residues to obtain a negative subset with the same scale as the positive dataset.

sequential feature extraction
the first sequential features we exploited is the position-specific scoring matrix  profile of each protein chain generated by psi-blast searching against non-redundant  database composed of hundreds of millions of protein sequences. pssm profile represents the probability of occurrence of each type of amino acid at the corresponding position that is inserted or deleted. pssm profile for each protein can be represented as a matrix of n ×  <dig> dimensions where n is the length of protein sequence and  <dig> dimensions mean a measure of residue conservation of  <dig> different standard amino acids. based on the original pssm scores, we further normalized each element in pssm matrix using the following logistic function:

  ns=11+e−s 

where s is the original element in pssm matrix and ns is the corresponding normalized element. our following experiments will show that this normalization process is important for improving the prediction success rates by reducing the bias and noise contained in the original scores.

in order to reflect the amino acid types of the interacting residues and their local environment, we also encoded the amino acid residue by a 20-d vector of binary values of either zero or one according to the type of amino acid in the alphabetic order, e.g. ala amino acid can be represented as , …, tyr is represented as , and so forth. it should be pointed out that in this encoding way, very sparse feature vector containing few one and much more zeros is obtained that needs to be further processed for avoiding over-fitting problem in the learning and prediction steps.

derived feature extraction
in order to make fully use of protein sequence and prior knowledge, we also considered several derived protein features including:  secondary structure,  disorder information, and  solvent accessibility. we extracted the protein secondary structure information which are predicted by the state-of-art algorithm of psipred  <cit> , whose output file provides the possibility profile of all the three secondary structure states  for each residue in a protein sequence. subsequently we constructed a series of n ×  <dig> matrix based on the output file where n represents the length of peptide chain and  <dig> indicates the number of secondary structure types. in addition, we acquired natively unstructured region of protein sequence by disopred <dig> server  <cit> . since it was recognized as one of best servers for disordered regions prediction in protein sequence and gave out the probability whether each residue was disordered or not. and we also acquired solvent accessibility by sspro program carried by the scratch package  <cit>  and the results obtained were in the form of the solvent accessibility status, that is, ‘exposed’ or ‘buried’ output for each residue in a protein sequence.

bi-profile bayes feature space
before we input the extracted multi-view information into the machine learning algorithms for prediction, it is important to project these features into a proper space so that the learning algorithms can make a more accurate classification. bi-profile sampling method was firstly introduced by shao et al.  <cit>  in predicting methylation sites in proteins. this approach assumes that peptide chains from positive dataset should exhibit some difference in the level of amino acid characteristics compared to the amino acid of peptide chains from negative dataset. consequently shao et al. have achieved success in the improvement of prediction performance and good accuracy was also attained by song et al.  <cit>  later in predicting cleavage sites of caspase substrate. in this study, we will apply bi-profile sampling method to encode the sparse feature vector of amino acid and some unbalanced features between different categories. those unbalanced features usually come from the uneven distribution of amino acid characteristics among different categories as well as the imbalance of the scale of positive dataset relative to negative dataset. the bi-profile sampling method can be briefly summarized as follows: given a peptide chain p with n residues without class label as p=a <dig> a <dig> a <dig> …,an, where aii= <dig> …,n indicates the ith amino acid. because in our study we are facing two categories classification task, i.e. identifying the real binding sites from those normal ones, we thus have extracted two classes of different peptide chains distinguished by their central amino acid. we further defined s+ as a set of peptide chains including only positive samples, and similarly we can obtained a negative dataset s–. for each element, that is, each single peptide chain in set s+ or s–, bi-profile sampling method means calculating a series of posterior probability related to obtained peptide chain set. finally, we can use a vector of vp=v <dig> v <dig> …,vn,vn+ <dig> …,v2n to represent a collective posterior probability for one peptide chain p, where the first n elements of v <dig> v <dig> …,vndenote the posterior probability of each amino acid at the corresponding position of the peptide chain p compared to the positive dataset s+, while vn+ <dig> vn+ <dig> …,v2n indicates the posterior probability of each amino acid at the corresponding position of the peptide chain p compared to the negative dataset s–.

we then use the above bi-profile approach to model the multi-view information. firstly, we estimated the posterior probability by calculating the frequency of the occurrence of each amino acid at each position in positive and negative dataset respectively. then we got the vector vaa=v <dig> v <dig> …,vn,vn+ <dig> …,v2n for each peptide chain and we called vaa the bi-profile sampled vector based on amino acid composition. we can further constructed bi-profile sampled vector based on protein secondary structure. specifically, we calculated the posterior probability of three different protein secondary structure respectively at the corresponding position of each peptide chain compared to the positive dataset s+ as well as negative dataset s–, then we also obtained vss=v <dig> v <dig> …,vn,vn+ <dig> …,v2n. similarly, we further extracted bi-profile sampled vector vdis based on residue disorder information as well as bi-profile sampled vector vsa based on solvent accessibility of amino acid. figure  <dig> shows an intuitive diagram of how to extract bi-profile feature vectors. table  <dig> illustrates the discrete features that adopted in this study.

support vector machines 
svm is a machine learning approach based on structural risk minimization principle of statistical learning theory, which has been successfully applied in various bioinformatics researches  <cit> . in this paper, we exploited the freely available software package libsvm- <dig>  developed by chang and lin and we also selected radial basis function  as the kernel function since rbf has been demonstrated to be an optimal kernel in many cases. then there are two parameters of capacity parameter c and kernel width g needing to optimize by a grid search approach  <cit> . for further theoretical details about svm, please refer to  <cit> .

evaluation criteria
the overall accuracy  is one of the most commonly used indexes for evaluating the performance of a classifier. this index provides a simple way of describing a classifier’s performance on a given data set. however, in the situation of imbalanced learning scenario, using overall accuracy index alone is no longer appropriate and can be deceiving for evaluating a classifier on imbalanced dataset. thus, in this study, the overall accuracy index together with several other indexes , are adopted to provide comprehensive assessments of the developed atp binding sites predictor.

  specificity=tntn+fp 

  sensitivity=tptp+fn 

  precision=tptp+fp 

  accuracy=tp+tntp+tn+fp+fn 

where tp, fp, tn, and fn are abbreviations of the number of true positive, false positive, true negative, and false negative samples respectively. we also exploit receiver operating characteristic  curve, which is a plot between true positive proportion  and false positive proportion . the area under the roc curve , which increases in direct proportion to the prediction performance, is also calculated.

another important issue should be addressed here is how to objectively report the evaluation indexes listed above, especially in the situation of imbalanced learning scenario. let’s commence by considering how a roc curve is calculated. for a soft-type classifier, i.e., classifier that output a continuous numeric value to represent the confidence of a sample belonging to the predicted class, gradually adjusting classification threshold will produce a series of confusion matrices  <cit> . from each confusion matrix, a roc point, the coordinate of which is , can then be computed. a series of roc points constitute the roc curve. in other words, different roc point corresponds to a different confusion matrix, from which the evaluation indexes, i.e., accuracy, specificity, sensitivity, and precision, can be computed. then, based on which roc point should we report the evaluation indexes of eqs.-?

considering the actual requirement of the protein-atp binding sites prediction problem, we expect that a classifier can provide high accuracy for the minority class  without severely jeopardizing the accuracy of the majority class . in light of this, we believe that it is more appropriate and objective to report evaluation results for both minority and majority classes in a balanced manner. more specifically, we would rather report evaluation results based on the roc point where the value of the false positive rate is the same as that of the false negative rate  <cit> . as shown in figure  <dig>  the roc point for reporting balanced evaluation results in this study is the intersection point  of the roc curve and the line l that passes through points  and .

RESULTS
analyzing the determinants of binding specificity
as stated earlier, we performed the prediction of native disorder information , residue three secondary structures , and amino acid solvent accessibility  respectively by the disopred <dig> server  <cit> , psipred  <cit> , as well as scratch package  <cit> . we extracted positive peptide subset in the form of peptide chains derived from a sliding window whose central residues are binding residues and the window length is  <dig> residues. figures  <dig>  and  <dig> show the statistical information on the positive subset for the three kinds of features on the atp <dig> dataset respectively. firstly, as the native disorder information shown in figure  <dig>  we can see that the percentage of disordered amino acids is much smaller than those of ordered residues around the binding sites; at the same time, it has also shown that the fraction reaches the lowest at the position of the middle of peptide chains . this indicates that the protein-atp bind regions prefer more to the structural states than the unstructural  <cit> . in figure  <dig>  we can see that the percentage of amino acids located in the margin is significantly different from those settled in the central region based on three types of secondary structure . it is interesting to find out that at the binding site , the percentage of helical residues and strand residues are almost equal; however, the fractions of helical residues keep going up on the right side, while the fractions of strand residues keep going down. this statistic data indicates that the binding residues could prefer to a conjoint point of two different secondary structural segments. figure  <dig> illustrates the predicted residue solvent accessibility statistics. as indicated in figure  <dig>  the protein-atp binding sites do not show significant exposed feature, on the contrary, they have higher buried propensities compared with the residues around. this finding is somewhat different from our previous knowledge that exposed residues are more easily for binding  <cit> . in order to re-demonstrate this finding, figure  <dig> illustrates the residue solvent accessibility statistics on atp <dig>  which is similar to that of figure  <dig> 

we also analyzed the distributions of different structural features on real binding sites and those normal ones in both atp <dig> and atp <dig> datasets, which are summarized in table  <dig>  results of table  <dig> reveal that statistics on both datasets of  <dig> and  <dig> sequences are consistent and structural features of real binding residues are significantly different from those non-binding residues. for example, atp interactions prefer to happen at ordered regions , and they in most cases are observed of buried status . the distributions on secondary structural types of real binding and non-binding residues also show differences. in atp <dig>  the coil , the helical  and the strand  in binding sites account for  <dig> %,  <dig> % and  <dig> %, respectively; while in atp <dig>  they account for  <dig> %,  <dig> % and  <dig> %, respectively.

a statistics on atp <dig> dataset.

b statistics on atp <dig> dataset.

feature normalization is helpful for improving performance
in our experiments, we generated position-specific scoring matrix  as evolutionary profile of each protein chain by psi-blast searching against non-redundant  database. by applying the sliding window with length of  <dig> on the original pssm profile in the form of n ×  <dig> matrix, we finally acquired a vector of  <dig> dimensions for each peptide chain from the training dataset. then we directly performed  <dig> fold cross-validation in this training dataset by svm algorithm and got average accuracies of  <dig> % and  <dig> % on atp <dig> and atp <dig> datasets respectively. subsequently we normalized the vector of  <dig> dimensional vector by the logistic function of eq. and again performed  <dig> fold cross-validation on the same training datasets with the same svm classifier. we acquired average accuracies of  <dig> % and  <dig> % on the two datasets . similar results have also been observed in the jackknife test . these improved results demonstrate that a proper normalization process is helpful for reducing the bias among different protein samples and thus can yield better accuracy.

a logisticpssm means pssm profile normalized by logistic function.

b all means the combination of four feature groups: bipro-aa, bipro-dis, bipro-sa, and bipro-ss.

a logisticpssm means pssm profile normalized by logistic function.

b all means the combination of four feature groups: bipro-aa, bipro-dis, bipro-sa, and bipro-ss.

performance by fusing multi-view derived features
the above results have demonstrated that evolutionary profile has relatively good discrimination ability between binding residues and non-binding residues, we then try to further improve the prediction performance by incorporating other multi-view features into the model. as bi-profile sampling method has been demonstrated successful in other studies  <cit> , we then applied this technique to encode the following features as discussed above:  binary value of amino acid composition,  predicted protein secondary structures,  predicted protein amino acid disorder information, and  predicted protein solvent accessibility. because the sliding window for extracting features is  <dig> and based on the flowchart shown in figure  <dig>  we then can use a 34-d vector to represent the above  <dig> features, abbreviated as bipro-aa, bipro-ss, bipro-dis, and bipro-sa respectively. table  <dig> summarizes all the feature information and their vector representation dimensions.

subsequently we will combine different feature groups and compare their discrimination ability in the corresponding trained models. for reference, we firstly list performance comparisons based on 5-fold cross-validation among combinations of different feature groups in table  <dig>  as shown in table  <dig>  more or less improvements can be observed by incorporating any of four feature groups into logistic pssm profile on both atp <dig> and atp <dig> datasets. taking atp <dig> as an example, when selecting logisticpssm profile coupled with predicted protein secondary structure information, the prediction accuracy performs best in all of compositions in different feature groups, which is  <dig> % accuracy. this probably means that protein secondary structure information has better discriminative ability for classifying binding sites from the non-binding sites, which is consistent to our analysis on the figure  <dig>  when plotting the receiver operating characteristic  curves for the corresponding models in table  <dig>  we find that the auc criterion have also been improved by fusing other information into the evolutionary features. for example, the auc is  <dig>  in logisticpssm and bipro-ss input case compared with  <dig>  in logisticpssm as the independent input feature. table  <dig> illustrates the results obtained from the leave-one-out  test, and all the criterion have been improved when considering multi-view features. these results show that different features have their own merits and shortcomings, and fusion process can make them be complementary to each other. similar results are also observed on atp <dig> dataset as shown in tables  <dig> and  <dig> 

it is notable from tables  <dig> and  <dig> that the incorporation of pssm profile and all of the other four kinds of bi-profile features does not lead to the best prediction performance. this phenomenon indicates that not all the features that can be calculated are useful. at the same time, when we simply serially combine these features together, such combination of features will simultaneously increase the information redundancy that could, in turn, deteriorate the final accuracy. considering of this, a proper feature fusion and selection approach should be discussed in the future in this regard to further improve the prediction performance.

imbalanced learning effects
since the number of non-binding residues is far more than the number of binding residues, we have performed a random selection process from all non-binding residues of each protein sequence so as to balance the negative dataset with the positive dataset in previous experiments. in order to further study the impact of the scale of negative dataset on prediction performance, we continue to randomly extract negative datasets of 2n, 3n,…, and 8n, where n is the scale of the positive dataset. the eight negative datasets plus the positive dataset from atp <dig> then constitute eight new training datasets with the ratio of 1: <dig>  1: <dig>  …, and 1: <dig> between positive and negative samples. we constructed feature vectors based on pssm profile and bi-profiled secondary structure on the  <dig> training datasets. after training the models, figure  <dig> plotted corresponding roc curves of these different size training datasets based on 5-fold cross-validation tests. the aucs are  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> , and  <dig>  respectively. these results indicate that results are indeed affected by the imbalanced training dataset.

performance affected by dataset size
the core of statistical learning algorithms is learning prediction rules from training samples. different sizes of the two datasets applied in this study make us capable of studying the prediction performances affected by the dataset scales. all the results listed in tables  <dig> and  <dig> demonstrate that performances are consistently better when classifiers are trained on the atp <dig> dataset compared with those on atp <dig> on both 5-fold and jackknife cross validation tests. the results are typically improved by 2%–3% under the same feature inputs. for example, the auc is  <dig>  when training model on atp <dig> with logisticpssm and bipro-ss as inputs in jackknife test, while this value increases to  <dig>  on atp <dig>  these results reveal that it is important to collect as many training samples as possible to make the learning rules more accurate. this is particularly important when studying the small-sample problems where experimentally derived knowledge is very limited in many cases.

comparison with other methods
we firstly compare our results with previous results obtained by raghava et al.  <cit>  on the same dataset of atp <dig>  in the previous study, the authors acquired an average accuracy of  <dig> % based on 5-fold cross-validation on atp <dig>  while we achieved an accuracy of  <dig> % by incorporating predicted protein secondary structure feature into pssm profile  also based on 5-fold cross-validation. in the leave-one-out cross-validation test,  <dig> % accuracy through combination of pssm profile and predicted protein secondary structures is achieved. after constructing the atp <dig> dataset by kurgan lab, a predictor called atpsite has been constructed by the same group  <cit> . an auc value of  <dig>  has been reported in atpsite on atp <dig> dataset. on the same dataset, the auc values are  <dig>  and  <dig>  in 5-fold and jackknife cross-validation tests respectively when incorporating logisticpssm and bipro-ss as the input features in this study. these results indicate that the performance of current study is superior to the state-of-the-art approaches, which can play important complementary roles with existing predictors. it is expected that prediction performance could be further enhanced when performing consensus predictions based on these multiple predictors.

CONCLUSIONS
in this paper, we developed a protocol for prediction of protein-atp binding residues. in order to reflect the multi-view characteristics of binding residues, multiple sequential and sequence derived structural features are exploited, which are further encoded by the bi-profile sampling approaches. our experimental results show that prediction performance can be improved by fusing multi-view features. furthermore, we show that increasing dataset size can also be helpful for enhancing the power of atp binding residue predictors. performances are found to be affected by the imbalances between positive and negative samples. current prediction protocol is expected to play an important complementary role to the existing approaches for large-scale atp binding protein function annotation.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
conception and design ynz, djy, yh, hbs; acquisition of data ynz, ssl, yxf; analysis of data ynz, djy, ssl, yxf, yh, hbs; writing and revising the manuscript: ynz, djy, yh, hbs. all authors read and approved the final manuscript.

