BACKGROUND
studying plant-insect interactions provides an opportunity to investigate the coevolution of species on a molecular, ecological, and evolutionary level. while ecologists are interested in the overall dynamics and interactions between plants and their insect herbivores, biochemical and molecular level studies focus on the genes and gene products that actually interact between these species groups  <cit> . ecological and evolutionary functional genomics  combines these approaches in an evolutionary framework, integrating the study of gene function and the fitness consequences of genetic variation  <cit> . a molecular population genetics understanding is central to eefg study, as it identifies genetic variation and its distribution within and among populations, reveals the demographic history of the populations studied, and can provide indirect insights into historical selection dynamics. here we use this approach to obtain conclusions regarding the demographic and selective dynamics acting upon a candidate gene involved in plant insect interactions. we then discuss how this understanding is critical to designing future studies of potential fitness consequences due to candidate gene variation.

our previous research identified a novel gene used by butterflies to detoxify their otherwise toxic host plants, called nitrile-specifier protein   <cit> . macroevolutionary study indicates that the evolution of nsp was a coevolutionary key innovation in plant insect interactions  <cit> . in order to extend these insights down to a microevolutionary level where we can eventually directly examine ongoing selection dynamics, here we present the results of a molecular population genetic study of nsp in pieris rapae  butterflies  which feed upon flowering host plants in the angiosperm order brassicales.

brassicales plants present a formidable anti-herbivore defense system, where the enzyme myrosinase upon tissue damage catalyzes the hydrolysis of its glucosinolate substrates to toxic end products  <cit> . thorough studies of brassicales plants, most notably on the model species arabidopsis thaliana and relatives, have identified a complex array of molecules involved in this activated chemical defense system  <cit> . a diversity of myrosinases exist in some brassicales plants  <cit> , which can be accompanied by a variety of cofactors and coenzymes, resulting in the hydrolysis of glucosinolates to variable end products which can influence feeding behavior  <cit> . additionally, myrosinase concentration in a given plant tissue has been shown to affect herbivore feeding  <cit> . glucosinolate diversity is also an important factor driving adaptive evolution. methylthioalkylmalate synthases , encoded by the mam gene cluster, control an early step in the synthesis of glucosinolates and are responsible for a major part of the glucosinolate diversity in the brassicaceae family by controlling side chain elongation  <cit> . within the mam gene family, gene duplication, neofunctionalization and positive selection drive biochemical diversification  <cit> . recent study documents the increase in glucosinolate complexity along the brassicales phylogeny, suggesting that chemical defense complexity increased over time  <cit>  

while our understanding of the plant side of this plant-insect interaction is well developed, we lack a similar depth of knowledge on the insect side. however, the identification of the nsp gene that enables pieridae butterfly larvae to circumvent the activated chemical defense of brassicales plants has begun to provide important insights  <cit> . nsp is expressed in the midgut of the caterpillars and promotes the formation of nitriles rather than toxic isothiocyanates upon the hydrolysis of glucosinolates. nsp is a unique detoxifying gene that shows no homology to any known detoxifying enzyme  <cit> . macroevolutionary studies identified nsp as a key biochemical innovation in the pieridae family, with a single evolutionary origin likely <  <dig> million years after the appearance of the brassicales plants  which corresponds to a significantly increased speciation rate of pieridae lineages which feed upon brassicales  <cit> .

nsp has a distinct three-domain structure  and its enzyme activity is only found in brassicales feeding pieridae species  <cit> . it belongs to an insect specific gene family designated the nsp-like gene family, with members having varying numbers of domain structure repeats  <cit> . recent research has found the nsp-like gene family to have complex birth-death dynamics, with nsp paralogs differing in their biochemical activity, genomic location, and copy number within and among species. additionally, of  <dig> pierinae genera surveyed,  <dig> independent gene duplications of nsp-like genes have been identified. when nsp duplication is placed within the temporal context of increasing glucosinolate complexity of the brassicales, nsp diversification appears to be an important component of the evolution of this detoxification gene family.

thus, although previous macroevolutionary study indicates that the first appearance of nsp was a key event in the host shift of pierid butterfly ancestors from fabaceae to brassicales feeding  <cit> , and that nsp continued to evolve along with glucosinolate complexity , we know nothing about the modern day, population level dynamics of nsp with respect to the highly variable and complex activated plant defense system of the brassicales. here, we begin to address microevolutionary questions by conducting a molecular population genetic study in p. rapae, from which we originally identified the nsp gene.

p. rapae is a highly abundant species native to europe with up to four generations per year in temperate zones. a high dispersal ability coupled with feeding on common agricultural plants  has enabled it to spread rapidly and successfully colonize australia, new zealand and north america within the last  <dig> years  <cit> . p. rapae caterpillars have over  <dig> reported host plants within the brassicales, and in particular brassicacaeae, and thus encounter a high diversity of glucosinolate-myrosinase systems which vary in all the previously discussed components.

several hypotheses emerge when considering the possible microevolutionary dynamics and patterns of diversity at the nsp gene. for comparative purposes, nsp and a set of reference genes  were sequenced from the same individuals: four nuclear coding enzymes, as well as a mitochondrial gene, from ten individuals from each of four populations . additionally, the divergence between p. rapae and p. brassicae  among  <dig> randomly chosen genes was compared with the divergence at nsp. these datasets allow us assess patterns of genetic diversity at nsp, the demographic history of these populations, and the relative support for alternative hypotheses of historical selection at the p. rapae nsp locus .

our alternative hypotheses of selection begin with a working null hypothesis that assumes no historical selective differences among nsp variants, with current patterns of genetic variation at nsp solely reflecting demographic effects such as population structure or historical population expansion . hypothesis one  expects the p. rapae nsp locus to be involved in local host plant adaptation, showing unique alleles in each population with greater variation among than within populations. hypothesis two  proposes a high diversity of the p. rapae nsp locus across all populations due to p. rapae being a highly dispersive generalist, encountering a diverse spectrum of host plants across its range. this hypothesis thus predicts a greater diversity within populations than among them. a further hypothesis  assumes low diversity in the p. rapae nsp locus both within and across populations, due to strong purifying selection on the p. rapae nsp locus coupled with selective sweeps since diverging from a recent ancestor.

methods
biological material
ten p. rapae adults were collected in the wild at each of three different locations in europe in the summer of  <dig>  in germany  samples were taken  <dig> km north of jena, in france  from  <dig> km northeast from lyon, and in italy  from  <dig> km south of modena. an additional ten p. rapae adults were collected in ithaca, new york, usa  in the summer of  <dig>  thus, a total of  <dig> butterflies were kept at -20°c until their dna was isolated.

dna extraction and pcr
abdomens of the adult butterflies were homogenized with a tissuelyser  in the buffer system provided by the genomic dna extraction kit , and the genomic dna isolated using genomic tip 20/g columns and the genomic dna extraction kit following the manufacturer's protocol . the eppendorf master mix  was used for the amplification of the desired gene. the pcr products were extracted using a dna purification kit following the manufacturer's protocol . pcr amplicons were cloned into the pcr ii topo vector  with six clones picked per individual and sequenced for all genes with the exception of arginine kinase and wingless, where the pcr amplicons were directly sequenced.

amplified genes
the study species p. rapae only posseses one nsp locus, designated as pra nsp. two segments of the pra nsp gene located adjacent to each other were amplified from genomic dna, here referred to pra nsp-d <dig> and pra nsp-d <dig> . the five reference gene regions studied did not contain introns: isocitrate dehydrogenase , glyceraldehyde dehydrogenase , cytochrome oxidase i , wingless  and arginine kinase .

primer sequences were as follows in 5' -3' direction: pransp-d2for: tcggctagtcctgctttcaa, pransp-d2rev: tgtgttgtcaagggtgtcca, pransp-d3for: tggacacccttgacaacaca, pransp-d3rev: gtaaagggcaggcacgaagg, praga3pdhfor: aaaagggagccaaggttgtt, praga3pdhrev: acgccacaattttcctgaag, praidhfor: tgctaccatcacaccagatga, praidhrev: accaaattcctgcaccttca, prawingl for: acctgttggatgcggctacc, prawingl rev: gcaccgttccactacgaaca, praargk for: taactgargcycagtacaagga, praargk rev: gttggtggggcagaaggt

sequencing
plasmid minipreparation from bacterial colonies grown in  <dig> deep-well plates was performed using the  <dig> robot plasmid isolation kit  on a tecan evo freedom  <dig> robotic platform . each plasmid prep was sequenced in both directions, for a minimum of  <dig> reads for each clone, of which there were  <dig> per individual, for  <dig> individuals, for the two nsp gene regions. this required  <dig> sequencing reactions for the nsp gene and all reference genes; with the exception of argk and wingless, for which the amplicons were directly sequenced in both directions without cloning.

single-pass sequencing of the 5' termini of cdna libraries was carried out on an abi  <dig> xl automatic dna sequencer . sequences have been deposited in genbank under the following accession numbers .

data analysis
vector clipping, quality trimming and sequence assembly were done using the lasergene software package . the obtained contig assemblies were aligned using the clustal w  <cit>  program as implemented in the freeware bioedit program and corrected by eye. standard measures of dna polymorphism, demographic analysis and selection, as well as the g-test, were calculated using dnasp version  <dig> . <dig>  <cit>  including nucleotide diversity   <cit> , nonsysnonymous and silent site substitutions ns/nn  <cit>  within p. rapae as well as across species   <cit> , number of segregating sites , theta per site from s   <cit> , tajima's d  <cit> , the mcdonald-kreitman  test  <cit>  as well as fay and wu's h  <cit>  and fu and li's d with and without outgroup  <cit> . for outgroup analysis pieris brassicae sequence information was used. p-values were determined using coalescent simulations  of a standard neutral model as implemented in dnasp. finally, multilocus tests of selection used the maximum-likelihood-ratio hudson-kreitman-aguadé test   <cit> . simulations found that  <dig>  chains were sufficient for convergence and the starting value of divergence time for the markov chain  was obtained using a standard hka test for the reference genes, implemented in dnasp.

for the following calculations the arlequin software package was used  <cit> . population genetic structure in p. rapae populations was examined using an analysis of molecular variance   <cit> , with samples classified by populations and groups  and molecular variation was tested within populations, among populations and between groups. significance was determined by  <dig>  permutations. population pairwise fst was estimated by the amova  <cit> . the significance of the estimated fst was determined via markov chain analysis  <cit>  using  <dig>  permutations. for fst estimation, population samples were compared in all pairwise combinations with a sequential bonferroni adjustment applied to control for type i errors  <cit> . migration rate   <cit> , and from m the absolute number of migrants exchanged between two populations , were computed. an exact test for population differentiation was also computed and is equivalent to the fisher's exact test, which tests the null hypothesis of identical allelic distribution across all populations. significance was determined via markov chain analysis with  <dig>  steps and  <dig>  dememorization steps, again applying bonferroni adjustment when screening for significant values.

demographic history analysis
approximate bayesian computation  analysis  <cit>  was used to infer the demographic parameters of a simple population expansion model for p. rapae as implemented in the software package abcreg  <cit> . given a set of prior demographic parameters used in a coalescence simulation program  to generate population datasets from which summary statistics are calculated, this method uses a linear regression to estimate the posterior distribution of these parameters based upon their similarity to a set of summary statistics obtained from observed data. our model has three parameters, modern theta , the time of the beginning of expansion from refugia , and growth rate of the expansion . we used a two step approach, beginning with a broad range of prior conditions, which was followed by a more focused range of prior conditions based on the outcome of the first analysis. for both runs, posterior parameter determination was conditional upon θ, π, and r <dig> from our pooled reference gene dataset , which had a minimum of  <dig> chromosomes sampled. r <dig> is a statistic that is very sensitive to population expansion  <cit>  and robust to recombination effects  <cit> . recombination effects are very important considerations in our dataset. for although other methods for detecting demographic change, such as fu's fs and mismatch distributions, are highly significant for our genes and show distributions of pairwise differences consistent with population expansions, these are highly sensitive to recombination effects. although recombination rates in our reference genes are low, we cannot accurately estimate their upper limits, which then brings these latter results into question. thus, we have chosen the abc method to model our demographic changes using summary statistics robust to recombination effects as a conservative approach. argkinase was excluded from this analysis as it harbors very little genetic variation and appears to be an outlier given its significantly negative tajima's d values. pleistocene and post-pleistocene population size assumptions are based on the likely population size to persist through the pleistocene and an expansion size that is an order of magnitude larger ).

tests for diversifying selection
a comparison between the nonsynonymous  and synonymous  substitutions rates across a gene sample can be used to assess the historical action of positive or negative selection, with dn < ds indicative of purifying selection and dn > ds suggestive of diversifying selection. given the recent controversy over which methods perform better in detecting negative  and positive  selection at the codon level  <cit> , we implemented a counting method , a random effect likelihood  method, a fixed effects likelihood  method  <cit> , as well as a fixed effects likelihood analysis that only tests for selection along internal  branches of the sample phylogeny and is recommended for detecting older selection events in the history of the sample  <cit> . for population level samples such as the ones we are analyzing here, recombination must be accounted for and incorporated into analyses  <cit> . we used a genetic algorithm for recombination detection  method, which shows excellent performance compared to other recombination detection methods  <cit> , and used the resulting inferred, non-recombinant partitions for all analyses. all  <dig> methods are able to utilize these data partitions, as well as dna substitution models calculated for a given dataset, which we estimated using the model selection option on the datamonkey webserver  <cit> . we used this approach of determining optimal dna substitution model, testing for recombination, and using the resulting dna substitution model and partitioned dataset  as inputs for the four codon based tests of selection.

p. rapae vs. p. brassicae est comparison
random sequencing of cdna libraries made from p. rapae and p. brassicae gut tissue and the pbr nsp sequence of p. brassicae have been described elsewhere  <cit> .  <dig> unique est contigs were identified for p. rapae from  <dig> sequencing reads, while only  <dig> were found among  <dig> reads of p. brassicae. the reciprocal best blast hits between each of these two cdna libraries to the predicted genes of bombyx mori was used to identify homologous genes in both pieris est collections. a random sample of  <dig> such homologous pairs was chosen for further analysis. identified sequences were aligned by clustal x  <cit>  and each visually inspected for regions of high quality sequence and alignment. end regions of alignments were trimmed such that reading frame  was identical for  <dig> consecutive codons. degenerate base pair calls were included. maximum likelihood estimates of the number of pairwise dn and ds substitutions were performed using codeml of the paml software package  <cit> , with the estimates of codon frequencies set as free parameters . statistical analyses of ds, dn, and dn/ds  distributions were performed with jmp  <dig>  . non-normal distributions were -log transformed to achieve normality for subsequent determination of significance, but all confidence intervals are reported for the untransformed distributions to keep values in a relevant scale for comparison.

RESULTS
molecular variation
we examined variation in two segments of the pra nsp gene , covering nsp domains  <dig> and  <dig>  as well as the exons of five reference genes: isocitrate dehydrogenase , glyceraldehyde dehydrogenase , arginine kinase , wingless and a portion of the mitochondrially-encoded cytochrome oxidase i  gene. all genes in all populations harbored genetic variation. nucleotide diversity  was roughly  <dig> to  <dig> times higher in pra nsp-d <dig> compared to the reference genes with the exception of wingless which showed a similar nucleotide diversity to pra nsp-d <dig>  pra nsp- d <dig> π was nearly double the reference genes again with the exception of wingess which exceeds the nucleotide diversity of pra nsp-d <dig> . θw showed similar patterns of diversity as π. synonymous diversity  is the highest in wingless, followed by nsp-d <dig> and cox, which have about 50% higher diversity than the rest of the nuclear genes. nonsynonymous diversity  is highest in pra nsp-d <dig>  followed by pra nsp-d <dig>  followed by the reference genes which have much lower levels of amino acid variation . pra nsp-d <dig> and pra nsp-d <dig> have a πns/πss that is over twice that of idh and more than  <dig> times that of ga3pdh and wingless . in total we identified  <dig> different haplotypes for pra nsp-d <dig> and pra nsp-d <dig> and  <dig> different haplotypes for cox and idh in all four populations. for ga3pdh we could identify  <dig> different haplotypes in all populations. wingless and arg kinase were sequenced directly, therefore we could not distinguish between different haplotypes between individuals for these two loci.

shown are the number of sequences , the number of base pairs , the average pairwise differences , the pairwise differences for synonymous and nonsynonymous sites , θw, the number of segregating sites  and the rate of nonsynonymous to synonymous substitutions for the coding part of the genes. if introns are included in the sequence, the number of base pairs, the average pairwise differences and θw is given separately for the whole gene and the non coding part.

the location of amino acid polymorphisms varied across the sequenced domains of pra nsp. each domain is composed of three exons, with codon lengths of  <dig>   <dig> and  <dig> and  <dig> respectively   <cit> . the  <dig> amino acid polymorphisms in pra nsp domain  <dig> are only found in its terminal exon , while  <dig> of the  <dig> amino acid polymorphism in pra nsp domain  <dig> are also found in its terminal exon; the other three are in the first exon of the domain  <dig> . the distribution of nonsynonymous polymorphisms across these domains significantly departs from a random distribution based on the size of the exons, with a paucity of amino acid polymorphism observed in the first and second exons, and an excess in the terminal exons, of both domains . analyses of synonymous variation does not show such an uneven distribution . the distribution of synonymous polymorphisms does not show this trend . there was also variation among genes in the number of time a haplotype appeared in a population and in the distribution of haplotypes across populations . populations contained both distinct haplotypes as well as some haplotypes that were shared across populations .

population genetic structure
we used amova to partition genetic variance among different levels of population structure for the coding region of all seven gene fragments. results indicated significant sources of variation within populations for both nsp domains as well as idh and ga3pdh, and among populations within continents for the latter two genes . overall, populations contained the highest percentage of variation compared to variation within and between continents . fst values show an overall low differentiation between populations , as most of the variation is located within them . after bonferroni correction of the fst pvalues we detected significant differences between populations only for comparisons of pra nsp-d <dig> between germany and both france and the usa and in ga3pdh between france and the german, italien and usa populations. coi shows germany and the usa to be differentiated . similarly, across all genes and many population comparisons, the migration rate is high and in many cases indicative of unrestricted gene flow.

shown is the percentage of variation for each gene at each level of analysis and whether these levels showed significant levels of genetic variation. comparisons are made within each population and within and between two groups, europe and the usa.

fst values, p-values for the exact test and the estimated absolute number of migrants between two populations m as determined in the arlequin program are given for every population comparison for every sequenced gene. for easier comprehension high migration values  are in bold. analysis always includes the whole sequenced fragments, thus both exons and intron in pra nsp-d <dig> and -d <dig>  for both the fst and exact tests, p-values significant after bonferroni corrections  within gene are marked with an asterisk. if the p-value is <  <dig>   two asterisks are used.

exact tests for population differentiation reveal roughly the same low level population structure observed in the fst analysis . first, analysis of nsp-d <dig> finds the same pairwise comparisons significant as in the fst analysis. this is also observed at ga3pdh, although only the largest of the three significant fst comparisons is significant in the exact tests. second, breaking with this pattern is nsp-d <dig>  where only the extact test finds differences between france and both germany and the usa. while fst analyses use the number of genetic differences between haplotypes to assess structure, the exact test uses the haplotype identities themselves and is thus more sensitive to recombinant haplotypes. thus these observations likely derive from differences in the distribution of recombinant haplotypes and thus indicate population structure at a much finer scale than detected in the fst analysis. third, it is important to note that there is little if any population structure found across all of the reference loci .

abc analysis of demography
our investigation of the demographic history of these samples began with determining the posterior distribution of demographic parameters for a broad set of prior conditions. given the quaternary history of europe and the phylogeographic structure of many species  <cit> , we estimate the mid-pleistocene ne of p. rapae to be  <dig>  which expanded to a modern size of  <dig> . in our first run we tested this hypothesis by drawing prior conditions from a wide uniform distribution where the onset of population expansion, tb, was between  <dig> and  <dig>  years ago. population growth rate, g, assuming an expansion to a modern n <dig> of  <dig>  from a size of  <dig>  is  <dig> . with this in mind, we drew priors from a broad uniform distribution around this ideal, with g ranging from  <dig> to  <dig>  a liberal tolerance for acceptance  was used to screen through  <dig> , <dig> prior simulations, with acceptance contingent upon similarity to a set of summary statistics  from our reference gene dataset . this first run returned a mean g of  <dig>   and tb of  <dig>  generations before present . our second run used a more narrow acceptance criteria  and a more focused range of prior values based upon  <dig> times above and below the observed means from the first run . second run results returned posterior estimates of mean g being  <dig>   and tb being  <dig>  generations before present .

tests for selection
we employed molecular tests of selection based on the null hypothesis of the standard neutral model. tajima's d is not significant for any of the tested gene regions with the exception of the german population sample of argkinase . the most positive values of tajima's d are found in pra nsp-d <dig> while all the other genes have negative values or are close to zero . tajima's d for nsp-d <dig> and -d <dig> combined was - <dig> . fu and li's d also found no significant genes other than argkinase in the german population , either with or without p. brassicae as an outgroup . analysis of the relationship of non-synonymous vs. synonymous polymorphism within species to non-synonymous vs. synonymous divergence between species used the mcdonald-kreitman  test with p. brassicae as an outgroup . results for all genes are not significant, although the number of nonsynonymous fixed substitutions was highest in pra nsp . this is more than an order of magnitude higher than the next highest reference gene , while coi had the highest number of synonymous substitutions  followed by nsp . removing low frequency haplotypes in the nsp datasets, with an occurrence of two or less, also results in non-significant mk tests . the multilocus hka tests on either of the pra nsp regions , tested individually against the reference genes and in combination, showed no significant divergence from the neutral expectations. analyses conducted on pooled population samples also found no significant departures from neutral expectations .

we also implemented molecular tests of selection that were focused on detecting diversifying selection at the codon level, in the presence of recombination, while making no assumptions about the demographic history of the underlying sample.

genetic algorithm analysis detected a recombination breakpoint  at bp  <dig> in the pra nsp-d <dig> gene dataset, but not in other datasets. therefore a partitioned dataset of the pra nsp-d <dig> dataset was used in all subsequent analyses . previous simulation study of the type i and type ii error rates of the slac, fel, and rel methods recommends using a p-value cutoff of  <dig>  for the first two methods and a focus upon sites that are identified as under selection by more than one method  <cit> . focusing upon sites that have a p-value less than  <dig>  and are shared by at least two of these three different methods, we found one positively selected site in both nsp domain  <dig> and  <dig>  as well as many negatively selected sites in both domains . of these three methods , slac returned the least significant p-values while the posterior probabilities of the rel method are usually very significant. the ifel method identified several sites that have changed in selection pressures over evolutionary time, identifying negatively selected sites in both domains , as well as the positively selected site in nsp domain  <dig> . no similar evidence for positive selection was found in the other genes. however, all genes showed evidence for negatively selected sites , ranging from  <dig> in arginine kinase to  <dig> in cytochrome oxidase i .

note. - for every method, first value is scaled dn - ds and number in parentheses shows p value, except for the rel method, where first value is bayes factor value followed by p value based on the bayes factor posterior probability). significant values  shown in bold and when  <dig> of the four methods are significant, the selection column indicates "n" for negative or "p" for positive selection. codon numbering is relative to start codon of the signal peptide.

interspecific divergence and dn/ds
p. rapae and its congener p. brassicae diverged approximately  <dig>  myr ago, based on temporal calibration of sequence divergence in the ef-1α gene as previously applied to pieridae  <cit> . to compare the pattern of divergence at nsp with a random genomic sample of genes,  <dig> homologous gene pairs were identified in est collections of these two species. these ranged from a length of  <dig> to  <dig> bp, with a mean of  <dig>  bps  and 75% of sequences being >  <dig> bp long. this translates into a mean of  <dig> synonymous and  <dig> nonsynonymous sites per gene pair respectively . there was a range of between  <dig> to  <dig> bp differences between sequence pairs, with a mean of  <dig>  bp .

maximum-likelihood analysis of ds and dn divergence between these pieris species across these  <dig> genes finds substantial divergence, with the average ds =  <dig>   and dn =  <dig>  . however, these genes are, as expected, experiencing a fair amount of purifying selection with a mean dn/ds  =  <dig>  , with a range from  <dig> to  <dig> .

the divergence and ω values at nsp between these species are significantly greater than the 95% confidence interval of the observed genomic mean estimate from the  <dig> randomly chosen genes. the mean ds and dn across nsp domains  <dig> &  <dig> is ds =  <dig>   and dn =  <dig>  . their range  is greater than the 95% confidence intervals for the ds and dn values of the random genes . the combined nsp domains  <dig> &  <dig> have a mean ω =  <dig>  and the full range of their pairwise values  is significantly greater than the 95% confidence interval of ω for the  <dig> homologous genes .

discussion
our interest in the nsp gene originates from its central role in hostplant detoxification and the macroevolutionary consequences of this function  <cit> . like many evolutionary ecology studies that have identified a candidate gene with ecologically relevant function, we wish to know more about the microevolutionary dynamics of its genetic variation. by focusing at the population level within one species, we have conducted a battery of analyses to help discriminate among alternative adaptive hypotheses and uncover the segregating genetic variation upon which future ecological studies should focus .

four alternative hypotheses were developed to assess the microevolutionary dynamics at pra nsp in the sampled p. rapae populations . two of these can be soundly rejected based on our results. first, h <dig> posits that local adaptation causes a greater level of genetic diversity among than within populations. this hypothesis is rejected by the high diversity of pra nsp amino acid alleles in all populations and with many alleles shared among populations . formally, the pra nsp loci have low fst values and high migration rates , non-significant tajima's d and related tests , and amova results that indicated greater variation within than among populations . while the exact tests of population differentiation in both pra nsp-d <dig> and d <dig> do give some hint at population structure , this test is sensitive to the unique recombinant haplotypes found in populations that are at low frequency . thus, h1-local adaptation is rejected. second, h <dig> posited directional selection or strong purifying selection upon an optimal genotype, both of which would result in little variation within and among populations. the high levels of within population amino acid polymorphism at pra nsp , as well as the non-significant mk tests , argue conclusively against h <dig> 

the results for the two remaining hypotheses, h0-demography and h2-diversifying/balancing selection, are more complicated. much of the last decade has been focused upon developing methods to tease apart the effects of selection from demography on the patterns of dna within populations . while in some cases this is possible in model genomic species, for non-model species with limited genomic insight, teasing these relative effects apart is very difficult. this is especially true for the case of potential diversifying/balancing selection where molecular tests of selection have very low power  <cit> . while the amova results are consistent with h2-diversifying selection, where pra nsp diversity is expected to be higher within than among populations , these patterns are also seen at two of our reference genes , the latter of which also shows significant exact test and fst results in pairwise population comparisons. this suggests that much if not all of our genetic variation is influenced by the recent demographic history of p. rapae.

our null hypothesis, h0-demography, expected genetic variation within and among samples at the reference genes to solely reflect demographic history. young p. rapae females are known to migrate long distances before egg laying  <cit>  and this natural dispersal ability is likely augmented and scrambled due to the long-distance transport of crop plants bearing eggs and larvae  <cit> . in accordance with the high dispersal of p. rapae we find a general pattern of greater genetic diversity within vs. among populations in all genes . in addition, the north american sample shows no clear distinction from the european populations, which may be indicative of recent and ongoing movement of p. rapae into the americas instead of one historical introduction. modeling of the demographic history based solely upon our reference genes indicates a population expansion  <dig>  generations before present. the mean to lower range of our estimates  are consistent with the demographic history of most species in europe  <cit>  and the known expansion of this species  <cit> . thus, the patterns of molecular variation at pra nsp suggest that h0-demography cannot be rejected; nsp genetic variation is strongly influenced by recent population expansion.

one means of circumventing the confounding effects of demography and selection on the site frequency spectrum is to use analyses that are robust to demographic history. we implemented two such tests. first, we used the mk test and found no significant results . this is entirely consistent with the absence of directional selection within our populations . in the context of h2- diversifying/balancing selection, the mk test is not an appropriate test. hughes  <cit>  has argued that tests of neutrality, and the mk test in particular, only provide an appropriate test for very specific types of selection. stated another way, no single test is a general test for all types of selection. thus, what the mk test results tell us is that there does not appear to be an excess of repeated selective sweeps at different codons in any of our genes, since p. rapae diverged from their common ancestor with p. brassicae .

our second test was a codon based test of selection that looked for both positive  and negative  selection while making no assumptions regarding demographic history and incorporating recombination effects  <cit> . such tests have recently been the focus of a vigorous debate in the literature regarding their assumptions and relative performance  <cit> , and whether such methods are fundamentally flawed  <cit> . thus, rather than picking among these methods we cautiously employed several codon based tests of selection which covered the range of fundamental methodological assumptions, presented a full disclosure of their findings, and identified only codons which found some support across these methods . this approach avoids the possible false positives inherent in any one method, but does not get around the multiple testing issues and other problems inherent to these methods  <cit> .

this approach does find evidence in the pr nsp domains for both negative  selection and positive  selection . while a discussion of the fundamentally different assumptions employed by these methods is beyond the scope of this paper, they are known to differ in their sensitivity and false positive rate  <cit> . while there is certainly purifying selection acting on certain regions of the nsp gene, the findings of positive selection should be viewed with caution and are not conclusive enough to warrant rejection of h0-demography in favor of h2-diversifying/balancing selection. ultimately, determination of the evolutionary consequence of any of the observed amino acid variation necessitates functional assessment.

our final consideration focuses upon the amount and distribution of amino acid diversity within pra nsp, which cannot solely be accounted for by demographic effects alone. the observed number of amino acid polymorphisms in prap nsp are greater than the well studied pgi gene in colias butterflies, which may be the most diverse gene known from insecta in having  <dig> segregating amino acid sites spread across  <dig> codons  <cit> . combining the information we have for pra nsp domains  <dig> and  <dig>  we have identified  <dig> segregating amino acid polymorphisms across  <dig> codons . considering that we have not even surveyed the first domain of pra nsp, it is very likely that the pra nsp gene could harbor over  <dig> amino acid polymorphisms within populations across its  <dig> codons . in sum, nsp appears to be one of the most polymorphic coding genes known in insecta. higher polymorphic levels can be found in the sex-determination gene, complementary sex determination, of honey bees that exhibits trans specific balancing selection  <cit> .

some of the increased amino acid diversity is certainly due to relaxation of purifying selection at specific regions of the enzyme. there is a well documented gradient of increasing amino acid diversity and divergence with greater solvent exposure of codons in enzyme structures . this arises due to strong functional constraints on the folding of the enzyme, which is relaxed in enzyme surface regions. comparing the dn/ds value of p. rapae nsp vs p. brassicae nsp with an average of  <dig> randomly chosen genes between those two species shows that nsp has a significantly higher dn/ds ratio and more divergence. given that we were only using a consensus sequence derived from a small number of individuals, we have likely inflated our estimations of divergence with polymorphic differences. such inflation makes our comparison with nsp divergence more conservative. however, this set of  <dig> genes, given their shared identification from separate est libraries, is likely to be enriched for genes having a moderate to high level of expression even though the libraries were normalized. as such, this set of genes likely represents a biased set of genes having housekeeping functions and experiencing moderate to strong purifying selection. thus, the observation of nsp having a higher dn/ds ratio than these genes only tells us that nsp is under less constraint compared to  <dig> random housekeeping genes. importantly, this reduced constraint is not large as nsp only shows a  <dig>  higher dn/ds ratio than the gene average, indicating ongoing purifying selection for the gene function. however these values are gene averages, therefore a more detailed assessment is needed.

detailed examination of the distribution of amino acid variation across the sequenced domain regions shows functional constraint acting on specific regions of the enzyme coupled with an unexpectedly high amount of amino acid polymorphism concentrated in specific domain regions . although further study is necessary to fully document this observation, as data from the first domain and all of the second domain are needed; such patterns indicate substantial variation in functional constraint across the gene. these results suggest that greater knowledge of the structure-function relationships of the nsp protein will be necessary in order to understand the observed excess amino acid variation. in sum, while regions of relaxed constraint certainly harbor more variation, this does not mean such variation is neutral. indeed, much of the known amino acid variation affecting the kinetics of metabolic enzymes is located upon the surface of enzymes .

CONCLUSIONS
the microevolutionary dynamics at the nsp gene appear to be a mixture of demographic effects  coupled with variation in functional constraint across the gene. patterns of nucleotide diversity and indirect molecular tests for historical selection reject strong local adaptation, as well as directional and strong purifying selection. rather than taking the absence of clear signatures of historical selection upon the nsp gene as conclusive evidence for no fitness variation among alleles, we recognize the limitation of such indirect approaches and remain curious as to the functional effects of the extremely high amount of amino acid diversity. thus, this study provides a foundation for the design and insightful use of molecular markers for genetic variants whose ecological performance and fitness can be characterized in the field .

we now know that there is an exceptional amount of amino acid variation within nearly every population of p. rapae. if this allelic variation has functional consequences, the effects are likely to be environmentally dependent and potentially small. as such, future studies will need very large sample sizes for many families across a range of potentially relevant conditions. families can be sampled from the field as ovipositing females and will contain sufficient diversity for study. in addition, individuals will need to be sampled during larval stages in order to provide access to the cdna of the nsp gene, as the entire coding sequence must be sequenced for no single polymorphic site will suffice to characterize nsp allelic variation. only with functional study of the identified genetic variation can we begin to conclusively assess the extent to which the observed variation at nsp plays an ongoing role in the microevolutionary dynamics of p. rapae and its interaction with the highly variable chemical defense system of their brassicales hostplants.

authors' contributions
hh-f carried out the molecular laboratory work, with the help of hv. hh-f and cw analyzed the raw data and performed the statistical analyses, cw conducted the abc analysis. hh-f and cw designed the study and wrote the manuscript. hv and dh participated in its design and helped draft the manuscript. all authors participated in the writing and approved the final version.

supplementary material
additional file 1
additional figures and tables. figure s1: comparison of synonymous and nonsynonymous site changes in the nsp domains; table s1: summary statistics for molecular tests of selection; table s2: summary statistics for mk test; tree file from gard output; pieris species cdna comparison datatable for dn/ds analysis.

click here for file

 acknowledgements
we thank d. schnabelrauch and h. ringys-beckstein for providing essential technical assistance. we thank andrew heidel for his help in the data analysis. we thank robert raguso for catching p. rapae adults in north america for us. this work was supported by the max-planck-gesellschaft, the national science foundation grant ibn- <dig>  and the academy of finland .
