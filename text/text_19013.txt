BACKGROUND
proteins are composed of domains, i.e. amino acid segments which have a specific function and/or a structure, fold independently from the rest of the protein and are evolutionary well conserved  <cit> . domains are units of evolution, they influence the function of a protein, and can be selected for as a whole  <cit> . the number of known domains is relatively small: currently around  <dig>  domains are listed in the pfam database  <cit> . about 65-70% of the known proteins contain at least one known domain  <cit> . however, the number of known arrangements, the combination of domains in a protein, is much higher and steadily and rapidly increasing with more genomes being sequenced  <cit> . these arrangements evolve over time as domains can be lost, new ones gained and domains are reordered, mostly by gene fusion and terminal domain losses. typically, rearrangements occur at a rate of tens to hundreds over a span of one million years  <cit> . accordingly, rearrangements are more frequent than loss and gain of whole genes, but substantially rarer than changes at the level of amino acids.

several studies have shown the importance of changes in domain arrangements during evolution. new arrangements can be produced by shuffling of existing domains. these new arrangements played, for example, an important role during the evolution of vertebrates where they are involved in vertebrate specific structures like the cartilage  <cit> . in addition, it has been proposed that the usage of domains may facilitate convergent evolution. for example it has been shown that netrin and secreted frizzled-related proteins have several independent evolutionary origins  <cit> . furthermore, it was proposed that a repository of reusable domains allows for a faster adaptation in plants  <cit> , since a high number of new domains and arrangements in plants are involved in stress and adaption related functions. changes in domain arrangements are less likely to occur than changes at the amino acid level and are therefore suitable traits for the reconstruction of phylogenies. accordingly, domain occurrence has been used to calculate large scale phylogenetic trees  <cit> . besides these large scale approaches it can be useful to investigate domain arrangements of a single protein family. it has been shown, for example, that the domain arrangements in virulence genes in plasmodium falciparum are probably the result of a trade-off between optimizing within-host fitness and minimizing between-host immune selection pressure  <cit> . also, the evolution of cry toxins is strongly affected by reordering the arrangement of their constituting domains and these rearrangements are important for the virulence of several bacteria  <cit> .

the best currently available methods to study domain arrangements are classical multiple sequence alignment  methods, for example t-coffee  <cit>  or clustal omega  <cit> . however, these alignment methods usually do not explicitely take domain arrangements into account and therefore do not incorporate any restriction concerning their alignment. exceptions are dialign-pfam  <cit>  and cobalt  <cit>  that use domain information to restrict the sequence alignments. still, none of the existing methods produce a real multiple domain alignment . an mda aligns multiple domain arrangements to find the best arrangement of domains using an objective function, similar to the traditional msa that arranges amino acids and nucleotides.

there are several advantages in using mdas instead of msas. due to the much shorter arrangement length compared to the primary sequence, an mda can be calculated faster and with lower memory requirements, which is especially an advantage with large datasets. another advantage is that a domain arrangement is more conserved than the underlying amino acid sequence. it is therefore possible to produce meaningful mdas when the amino acid sequences are already too divergent to be compared. furthermore, it is easier to visually examine the resulting alignments, due to the smaller number of characters.

since domain arrangement similarity and differences can provide insights into functional similarity and changes between proteins  we present an algorithm which helps to compute an mda and facilitate the analysis of domain arrangements of different proteins. in this paper, we present mdat , a program that takes multiple domain arrangements and aligns them. it uses a domain similarity matrix reflecting the similarity between all pairs of domains in the pfam database. using a combination of the rads  <cit>  algorithm and the msa consistency approach described in t-coffee  <cit>  an mda is calculated. the main goal of rads is to compare and evaluate domain arrangements and to weight differences between domain arrangements. in addition, the resulting mda can then serve as a backbone structure for the construction of an msa.

RESULTS
domain similarity matrix
the pfam database provides some rough information on domain homology  based on a range of various information evaluated manually  <cit> . unfortunately, this information cannot be used in an alignment program as clan information is binary only. therefore, one cannot use clan information reliably to distinguish which domains to match if several possibilities to align a set of domains exits. another drawback of using clans is that currently only about one third of the almost  <dig>  domains in pfam are associated to a clan. to avoid these drawbacks, we decided to calculate the domain similarity matrix. figure  <dig> displays the distribution of match probabilities for each domain pair and how this value relates to being in the same clan or not.domain similarity score distribution. the scores were calculated by hhsearch, for all pairwise alignment scores of pfam-a domains . the values have been divided into two groups depending on whether the two domains belonging to the same clan or not . values of self alignments are not included.



as expected, most domain pairs have a low probability of being a true positive match. it is interesting to note that a high number of domain pairs coming from the same clan have a very low probability of being a true match and that at least some domain pairs from different clans or without clan assignment have a high probability of being a true match.

mda
we use the balibase <dig>  <cit>  benchmark, which was originally developed for evaluating msas, to evaluate the mdat algorithm. on average 95% of the domain pairs found in the balibase <dig> benchmark  are also found in the test alignments produced by mdat. furthermore, the mdat algorithm is the fastest of all compared methods, even when including the additional step of calculating an msa from the mda . an actual example of an mda is shown in figure  <dig>  the  <dig> sequences from the ipr <dig> family  have been aligned using mdat after pfam domain annotation.  <dig> different domain arrangements based on  <dig> different domains have been identified. the resulting alignment contains  <dig> different architectures showing conserved domains, repeat events as well as rare domains in this family.example mda: the ipr <dig> family, consisting of  <dig> sequences is shown. all segments contain the dscam domain. the pfam_scan script has been used to perform the domain annotation. the first column depicts the reference arrangement id, and the second the number of times this arrangement has been encountered.
results of running  <dig> different methods on the balibase <dig> benchmarks


set
mda
mda 
mafft
clustal omega
sp denotes the sum of pairs score, tc the column score. the running times of mdat includes time for constructing the mda but not the time for running the domain annotation. the mdat row shows the time for constructing the mda only, while mdat  shows the time for calculating the mda with subsequent msa construction.



mda2msa
an example for the advantage of using domains in the construction of alignments can be seen in figure  <dig>  the upper alignment was constructed using mdat, the lower one using the mafft program. due to the benefits of domain information, mdat was able to align all five fer <dig> domains together, while mafft only aligned  <dig> of them. moreover, these domains are not kept as unit but split up into parts that are stretched along the whole alignment. another example can be viewed in additional file  <dig> example of an mda based sequence alignment: an msa of seven sequences from the balibase <dig> benchmark with annotated domains is shown. the upper alignment has been generated using mdat, the bottom one using mafft. due to the incorporation of domain information mdat is able to align all  <dig> occurring fer <dig> domains correctly together, mafft only aligns  <dig> of the domains and stretches them very widely.



the use of domains as anchor-points can strongly reduce the memory usage and running time. table  <dig> shows the results of running mafft, clustal omega and mdat algorithms on balibase <dig>  mdat is three times faster than mafft and about  <dig> times faster when calculating only the mda. the increased speed comes at the cost of accuracy. a combination of different reasons can explain the loss in accuracy. domain annotations are not perfect and wrongly annotated domains or discrepancies in the boundaries may influence the resulting alignment. furthermore, an error in the mda can have a large influence on the resulting msa as whole regions can no longer be aligned, a problem that all anchor based methods have in common. additionally, we use a simple implementation of the gotoh algorithm  <cit>  to perform the sequence alignment; more complex techniques, such as hmms as used for example in clustal omega  <cit> , might provide better results.

CONCLUSIONS
we show that using mdas themselves has its merits. mdas can be used to visualize in a simple way the similarity between domain arrangements. just like any alignment program, mdat is not able to handle inversions. however, due to the low number of domains in a protein, inversions can be easily detected in a graphical view, which in not possible at the amino acid level. furthermore, we demonstrate that an mda is a good starting point for a multiple sequence alignment. it is particularly useful as guidance for the msa, because it strongly increases the speed with which a multiple sequence alignment is calculated. currently, the resulting msas from mdat are not as accurate as traditional sequence alignments, however, due to the short calculation time, we are able to handle larger data sets. for many analyses, such as genome projects, the detection of domains is an essential part of the standard annotation procedure. therefore, domain annotation is often readily available.

