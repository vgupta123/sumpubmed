BACKGROUND
metabolic and genetic time series have arisen as important sources of information about biological processes. however, the quantitative characterization of these processes from their temporal responses is not a trivial problem due to the complexity of typical biological networks and the multi-fold interdependencies among their components. any effective method for this task needs to be able to filter out all possible quantitative information from observed time series and convert it into mathematical features that reliably characterize the true topology of the network, as well as its regulation. biochemical system theory   <cit>  has been shown to provide a consistent mathematical framework for representing and analyzing biological systems. the s-system variant of bst represents the biological network as a set of differential equations in the general format

 x˙i=αi∏j=1mxjgij−βi∏j=1mxjhij,i= <dig> ,⋯,m. 

here, xi represents the concentration of metabolite i, αi and βi are non-negative rate constants, and gij and hij are real-valued kinetic orders for the production and degradation term, respectively. a considerable amount of information about s-systems can be found in  <cit> . a major advantage of this representation is that it uniquely maps dynamical and topological information onto its parameters; an illustration is given in figure  <dig> 

several numerical techniques have been proposed in the literature to tackle the inverse problem of s-system parameterization from time series; most of them use computationally expensive meta-heuristics such as genetic algorithms   <cit> , simulated annealing   <cit> , artificial neural networks  <cit> , function approximation  <cit> , or global optimization methods  <cit> . collectively, these studies have shown that any direct parameter estimations typically face grave problems. major improvements in efficiency are found when the derivatives at a series of time points are replaced with estimated slopes  <cit>  and  <cit> . this step at once replaces the differential equations with sets of algebraic equations and decouples these sets so that the parameters for each metabolite can be computed separately.

differing from expensive direct estimation methodologies, alternating regression   <cit>  was proposed as a fast deterministic method for s-system parameter estimation with low computational cost . its superb efficiency is due to the reduction of the nonlinear estimation problem into iterative steps of linear regression. apparently its only disadvantage is the observation that the method does not converge for some systems, and that necessary and sufficient criteria for convergence are not known. thus, given a new system and new data, it is a priori difficult to predict whether ar will or will not converge. if it converges, it converges very fast.

in this report, we propose a new method, inspired by ar and based on multiple linear regression and sequential quadratic programming  optimization, to address the s-system parameter identification problem when no information about the network topology is known. the algorithm accounts for the often observed quasi-redundancy among s-system parameters, where errors in kinetic orders can largely be compensated by adjustments in other kinetic orders and rate constants. in contrast to ar, the proposed method operates initially only on one term , whose constant rate  and kinetic orders  are optimized completely before the complementary term is estimated. in many cases, the method provides alternative candidate models that fit the time series both in the decoupled and the fully integrated forms.

RESULTS
synthetic time series
the proposed method was tested on synthetic time series generated by reference test models  <cit>  of  <dig>   <dig>  and  <dig> state variables . each system was simulated with different initial concentrations of its variables in order to imitate different biological stimulus-response experiments as described in  <cit> . all specifications of the simulations with different initial conditions can be found in additional file  <dig> 

in all three case studies, no knowledge about the pathway was assumed and all parameters were considered freely variable. even so, the correct network topology was extracted in all cases, with a mean error magnitude of 10- <dig> for each numerically integrated state variable.

the 2-dimensional system

 x˙1=3x2−2−x <dig> x2x˙2=x <dig> x2−x <dig>  

exhibits oscillatory behavior that is challenging for estimation purposes, leading to difficulties of standard algorithms in finding good solutions. the reason is that even small shifts in the oscillation phase between the dynamics of the estimated system and the true target system result in significant cumulative errors. by contrast, the 4-dimensional system

 x˙1=12x3− <dig> −10x <dig> x˙2=8x <dig> −3x <dig> x˙3=3x <dig> −5x <dig> x <dig> x˙4=2x <dig> −6x <dig>  

 is relatively well behaved and will be used to identify problems that are likely to emerge even for the inference of less complicated dynamic models. the third system  describes an artificial genetic network and has been used as a benchmark  <cit>  for s-system inference algorithms.

 x˙1=5x3x5−1−10x12x˙2=10x12−10x22x˙3=10x2−1−10x2−1x32x˙4=8x32x5−1−10x42x˙5=10x42−10x <dig> 

the results of the algorithm on the  <dig>   <dig> and 5-dimensional systems, presented in additional file  <dig>  demonstrate that the proposed method retrieves the correct parameter values for noise-free time series. three different data sets were created for each test systems  using different initial conditions in the system's numerical integration . these three data sets allowed us to assess the ability of the algorithm to deal with different time series dynamics. using each data set, we performed  <dig> trials for each system's variables . the runs differed in the random initial guess for β  which was chosen from the range . the search space for kinetic orders was limited to a reasonable range of , which is consistent with collective experience in the field . as an example result, the experiment with the 5-dimensional system performed on the first data set illustrates the success rate of the algorithm: the exact parameter values were found for all variables in all trails except for variable x <dig> in one of the trials. the procedure is computationally efficient, requiring  <dig> minutes to perform  <dig> optimizations for the 4-dimensional system , on a personal computer with a  <dig>  ghz processor and  <dig> gb ram. thanks to the numerical decoupling, the complexity of the algorithm is of the order o where m is the number of state variables and n is the number of data points used in the optimization. all experiments were performed with  <dig> data points. for the 5-dimensional system the proposed algorithm found the correct parameter set, overcoming the problematic identification of the kinetic orders g <dig> and h <dig> of the state variable x <dig> presented by most algorithms in the literature. if a stop criterion is defined as a value of 1e- <dig> for the sum of the squared errors between the slopes of the optimized system and the true slopes, the time required to identify the system parameters for the 5-dimensional system was  <dig> sec on the machine described above. an experiment with a 10-dimensional system was also performed and the total time consumed was  <dig> sec .

similar results were achieved with the optimization of the 2-dimensional system. importantly, the correct parameter set was found, although not with the same regularity as in the 4- and 5-dimensional system optimizations. issues encountered in finding the correct solutions appeared to be caused by a combination of different features of the system, such as the position of the optimal point within the feasible parameter space, which in the 5-variable case is situated right on the border of the infeasible region within the parameter space , multiple local minima, as well as the particular choice of initial parameter guesses. these peculiarities of the algorithm and the problem itself lead to different parameter values, although the errors of the decoupled and integrated system are still small .

the proposed algorithm calculates the initial guesses for the kinetic orders as close to zero as possible, given an initial β value . however, in this specific case study, near-zero values of the kinetic orders h <dig> and h <dig> for the constant rate β <dig> =  <dig> fall into the infeasible parameter region, which complicates the parameter optimization. for instance, the smallest feasible value for h <dig> is  <dig> . the proposed algorithm overcomes this initial problem by adjusting itself and subsequently returns correct solutions when the system is rescaled in time  <cit> . this is most easily achieved by multiplying the alphas  and betas  with a positive factor , which increases the feasible parameter space. this step is, in fact, equivalent to multiplying the slope vector by a positive number. thanks to the modularity of the decoupled system, this scaling can be performed separately for each state variable without affecting the kinetic order values. only the values of the rate constants are changed, but they are easily recovered by dividing them by the positive number used for scaling. it was observed that this strategy often, but not always, enhances the algorithmic performance. it appears to improve performance most if the rate constants have small values.

initially, all experiments were performed with noise-free time series, but in a second set of experiments, we added noise. because the proposed algorithm uses the decoupled, algebraic form, a signal extraction procedure was employed for the noisy data to provide smooth time series and slopes  <cit> . the results show that combining the two strategies  generate accurate dynamical responses for the case studies used in this report .

error surfaces of decoupled s-systems
to explore the results of the proposed algorithm visually and to investigate patterns of convergence, we performed a grid search on the parameters of the 2-dimensional system . specifically, we searched a  <dig> ×  <dig> grid where each point represented the kinetic orders h <dig> and h <dig> over the range . correspondingly,  <dig> time points for x <dig> and x <dig> and its correspondent slopes s <dig> and s <dig> were generated by numerical integration of the 2-dimensional system  with x <dig> =  <dig> and x <dig> =  <dig> as initial conditions. methods described in a later section were used on time series of x <dig> and x <dig> to calculate the regression matrix l, and for each given initial value of the rate constant β <dig>  and for each point of the grid, the error surface for the variable x <dig> was constructed. the algorithm started with the degradation term dt1=β1x1h11x2h <dig> for the first grid point using a given value for β <dig> and the time series points for x <dig> and x <dig>  subsequently, the production vector  g <dig> g12]) was obtained from the slope vector s <dig>  the regression matrix l, and the degradation term dt <dig> in equations –. once all parameter values for variable x <dig> in the production and degradation vectors were determined, the estimated slopes were calculated  and the logarithm of the sum of the squared errors between these slopes and the target solutions was computed as error=log⁡2). this process was repeated for all points on the grid such that an error surface resulted for each β <dig> value. in this manner, ten surfaces were constructed using different β values; they are shown superimposed in figure  <dig> 

the first observation is that most of the search region is not feasible , even though there is a priori no hint that solutions in the open range should not converge. it turns out in retrospect that these are regions where the argument of the logarithm on right side of equation  <dig> is negative, due to negative slope values. also worth noting is that for each β a similarly shaped surface  was found, but that not all surfaces have the same minimal point . this information will be of critical importance in the discussion of the convergence profile of the proposed method.

the same strategy was applied to noisy time series resulting in a new set of surfaces . gaussian noise with 15% variance was added to the x <dig> and x <dig> time series and a refined whitaker's filter  <cit>  was used to smooth the data and estimate slopes.

the error surfaces obtained using noisy data  present the same shapes as seen for the noise-free data except that the error average is higher and points to a different global minimum, which however is essentially indistinguishable in value from the local optima .

convergence problems
it would be unreasonable to assume that the algorithm converges to the global optimum under all imaginable conditions and initial settings: no estimation algorithm for nonlinear systems can – or should be expected to – measure up to such high a standard. for instance, if the ranges of initial guesses are changed or if the number of initial guesses is reduced, the algorithm may converge to an acceptable local minimum which, however, is not global. this is not surprising, given the complicated nature of the error surface of realistic systems and the fact that nonlinear systems often exhibit almost flat, banana-shaped or ellipsoid valleys in which the minimum is centered  <cit> . at this point, a comprehensive picture of potential obstacles to convergence is not available. one prominent reason for lacking or faulty convergence is that some problems are ill-posed, for instance, because of collinearity between columns of the regression matrix l. this situation occurs when two or more metabolites have similar dynamics  <cit>  or when at least one variable is essentially constant and is therefore collinear with the first column of the l matrix. in these and some other cases, the regression matrix l has a high condition number, which the proposed procedure flags. it might be possible to remedy some of these ill-posed problems with a regularization algorithm for multiple linear regression and through redesigning the algorithm with the regularized solution. it seems advisable in any event to remove model redundancies, for instance by pooling or eliminating collinear variables or merging essentially constant variables with the rate constants of the term.

parameter estimation of constrained networks
the proposed method was extended to address the parameter identification for systems with topological constraints. this extension allows the algorithm to account for precursor-product relationships problems, which mandate that the degradation term of the precursor is equivalent to the production term of the product  <cit> . thus, instead of optimizing the parameters for each metabolite separately, a set of terms is optimized simultaneously, consisting of one of the parameter vectors  of each metabolite. as an illustrative, simple example, consider a linear pathway with feedback, where we have to account for constraints between the production and degradation terms of subsequent metabolites . specifically in the example system, the efflux from x <dig> is identical to the influx into x <dig>  and the efflux from x <dig> is identical to the influx into x <dig>  consequently, the degradation term of x <dig> is exactly the same as the production term of x <dig>  and the degradation term of x <dig> must be the same as the production term of x <dig>  the amendment of the proposed method toward simultaneous estimation readily satisfies these types of constraints.

the extended algorithm was applied to the 3-dimensional linear pathway system in figure  <dig>  and some of the results are shown in additional file  <dig>  the algorithm found the correct parameter set, and all  <dig> optimizations, in which the algorithm now performs a single, combined optimization for all variables simultaneously, thereby accounting for constraints, were completed in  <dig> sec on a  <dig>  ghz processor with  <dig> gb ram.

graphical user interface
an open source matlab toolbox and a stand-alone compiled graphical user interface  application were developed as an exploratory tool . the application was developed as a modular extension of our previous work and constitutes a critical component within our long-term effort of advancing a data processing pipeline for s-system estimation from metabolomic time series  <cit> . a snapshot of the gui is shown in figure  <dig>  all computational results and graphics described in this report can be reproduced using this application.

discussion
there are many reasons why it may be desirable to reverse engineer a biological network without making assumptions about the underlying processes. the most obvious reason is that no reliable information may be available about the processes. another situation occurs when several network topologies are a priori possible and the reverse approach is employed to prioritize alternative hypotheses. the algorithm proposed here is an extension of alternating regression  that in many cases shows improved convergence behavior.

the proposed algorithm was exhaustively tested on diverse time series . in all of these tests, the convergence followed the same pattern: the error slowly decreased during the first few iterations and then suddenly dropped to a significant lower plateau, from where it gradually decreased again. this pattern repeated until one of the stop conditions  was reached. the error drop points matched with significant changes in the beta gradient and appear to correspond to transitions to a "bowl" with a lower error surface . as shown in figures 3b and  <dig>  most "bowls" have different minimal points, corresponding to good, yet local minima. because the proposed algorithm is computationally very efficient, it allows the exploration of the parameter space in a reasonable amount of time . such an exploration with new initial β values is recommended, if very precise solutions or alternative parameter sets are needed. because alternative parameter combinations may correspond to different topological and regulatory structures  <cit> , estimations with different initial values in fact constitute explorations of the structure and functionality of the biological space in which the pathway operates.

CONCLUSIONS
s-systems present a unique balance between proven biological relevance and validity on one hand, and mathematical convenience and tractability on the other. for this reason, the recent years have seen numerous methods for matching s-system models to measured biological time series data. in the relatively simpler scenario of this type, the topology and regulatory structure of the biological system is known, and the extraction of information from the data constitutes a parameter estimation task. in the more difficult situation, at least some of the structure is unknown, and in the extreme situation no information about the topology of the interactions between variables is available. in this article we propose a new algorithm that efficaciously identifies the correct topology of a system from time series. the only true assumptions made are that all important variables are accounted for and that the s-system model is capable of modeling the data. the first assumption is presently unavoidable, at least in the generality presented above. the second assumption has been found to be true in very many cases, as a rich body of publications on s-systems demonstrates. the proposed algorithm was conceived as a critical piece of an emerging data processing "pipeline" that will eventually accept time series and other data characterizing biological pathways and more or less automatically propose topological and regulatory structures that are consistent with the input data. this algorithm will be a valuable tool for analysis and hypothesis generation in systems biology.

