BACKGROUND
in humans, plants and livestock, data on genome-wide snp markers and complex trait phenotypes have been used for  <dig> purposes: to identify snp associated with the trait, to study the genetic architecture of the trait, and to predict the genetic value or future phenotype of individuals. although different statistical methods are commonly used for these three purposes, the bayesian “genomic selection” or “genomic prediction” approach of meuwissen et al  <cit>  can be effectively used for all  <dig> purposes in a single analysis  <cit> . this bayesian approach fits the effects of all snp simultaneously in the statistical model assuming that they are random effects drawn from a distribution. erbe et al  <cit>  modified the approach of  <cit> , proposing a mixture of normal distributions to model the snp effects. their model allows many effects to be zero but some effects to be relatively large and is flexible enough to cover a range of distributions that might apply to different traits. they called the method bayesr. in both human and livestock data, bayesr has been demonstrated to be equal or superior to linear mixed model methods, such as gblup , for genomic prediction and qtl mapping  <cit> .

to date, methods such as bayesr, gblup and traditional gwas  assume that each variant is equally likely to affect the trait: that is, no prior biological knowledge is included in the model. instead, the available biological knowledge is often applied post-analysis, in a somewhat arbitrary and potentially biased manner to confirm candidate genes and mutations. when analysing dense snp array genotypes it is reasonable to assume a model in which each marker may equally affect the trait. however, this assumption is less sensible when analysing whole-genome sequence variants, some of which may be known to cause non-synonymous coding changes or affect regulatory regions of candidate genes. in humans, as well as some livestock it is now possible to impute sequence variants for many thousands of individuals, so there is a need to develop methods that objectively include independent biological information in the analytical model.

here, we propose a modification to the bayesr method that incorporates prior biological knowledge about which sites in the genome are more likely to affect the trait, using a flexible and practical approach. for instance, the biological knowledge can include lists of genes that are known to be important for trait expression, or specific genome sites that are likely to have functional consequences if mutated, such as non-synonymous coding sites. a priori we allocate all genotyped variants into classes, where each class of variants is believed to potentially differ in the probability that they contain causal variants for the trait. for example, one class could contain all non-synonymous coding variants within previously reported candidate genes such that this class may be enriched for causal variants compared to a random selection of variants. we call the method bayesrc. previously brondum et al.  <cit>  proposed a modified bayesr approach  where prior estimates of the proportion of variance from different chromosome segments were used to weight the bayesian priors for each segment. our proposal differs because our prior is uniform across all variant classes such that the biological information will only influence the analysis if there is support for this in the data being analysed. the prior information is therefore more straightforward to incorporate in the model.

we evaluated our new method using data from dairy cattle where individuals had imputed genotypes for approximately two million variants in or near genome-wide coding regions as well as real or imputed high density snp array genotypes. due to the characteristically high ld  within dairy cattle breeds, we combined data from different geographical regions and breeds with the aim of reducing the longer distance ld to improve the precision of qtl  discovery and prediction. we compare the accuracy of genomic prediction in validation individuals that are not closely related to the training individuals to more effectively determine the precision of qtl effect estimates.

using simulated phenotypes as well as real milk production phenotypes, our results demonstrate several important advances:including imputed sequence variants from coding and regulatory regions increased the accuracy of genomic prediction compared to hd  snp array genotypes only, and enabled qtl detection among rare variants.

our bayesrc method improved the power and precision of qtl discovery compared to bayesr.

bayesrc increased the accuracy of genomic predictions compared with the standard bayesr approach. the observed improvement was most apparent with increasing genetic distance between training and validation populations.



methods
genomic prediction analysis was based on an imputed subset of sequence variants in dairy cattle with either simulated phenotypes or real milk production phenotypes. we generated three training  data sets to test the new bayesrc method and compared these results with the bayesr method.

training and validation sets
the three training sets described below, are referred to as danz, aus and aus-sim . we employed several validation sets to represent different levels of relatedness to the training sets :table  <dig> composition of three different mixed breed training  sets, and several validation sets chosen to represent different levels of relatedness to the training sets

“danz” bulls of dutch, aust & n. zealand origin with real genotypes and real phenotypesa
 <dig> jersey
“aus” australian bulls & cows with real genotypes and real phenotypesa
 <dig> bulls,  <dig> cows.
 <dig> jersey:
 <dig>   <dig> holstein bulls & cows
 <dig>   <dig> red holstein bulls

aphenotypes were milk, protein and fat yield: in the case of bulls these are daughter averages from progeny test and all phenotypes were corrected for known fixed effects

“danz” – the training set included  <dig> dutch, australian and new zealand dairy bulls of pure-bred holstein , jersey and australian red breeds. the first validation set was made up of red holstein bulls. all sons or sires of this group were excluded from the training population. the second more genetically distant validation set was a group of australian red cows.

“aus” - the training set included  <dig>  holstein and jersey pure-bred bulls and cows of australian origin . the validation sets were the same as for the danz analysis .

“aus-sim” - the training set comprised the oldest  <dig>  holstein and jersey animals from the aus set  based on a year of birth cut off. the youngest holstein bull and cows were assigned to two validation sets: the first was  <dig> bulls that were very closely related to the training set, while the second included these bulls as well as  <dig> cows representing more genetic diversity than the bull only set. the third less related validation was the red holstein bulls as used for danz and aus. finally, the fourth most genetically distant validation was australian red breed cows and bulls.



genotypes and biological priors
all aus individuals and some of the danz bulls were directly genotyped for the illumina bovinesnp <dig> chip  <cit> . the remaining danz bulls were imputed from ~  <dig>  snp to the bovinesnp <dig> chip. all individuals were then either directly genotyped or had imputed genotypes for the illumina 800 k bovinehd beadchip. further details of danz genotyping are published in  <cit>  and details for aus are published in  <cit> . in addition to hd 800 k snp genotypes, we identified approximately two million sequence variants  in gene coding regions and including variants 5000 bp up- and down-stream of these genes . the discovery of sequence variants across these regions was carried out in run  <dig>  of the  <dig> bull genomes project  <cit> . beagle version  <dig>  <cit>  was used to impute these sequence variants in all animals. the reference sequences used for imputation were  <dig> holstein and  <dig> jersey bulls combined from the  <dig> bull genomes project . the combined hd snp and imputed sequence variants brought the total number of genotypes per animal to  <dig> , <dig> 

all  <dig>  m variants were then defined as belonging to one of three broad categories based on annotation of the reference genome umd <dig>  . the first category, comprised variants predicted to cause a non-synonymous coding change, referred to as “nsc”. the majority were missense variants, but this nsc category also included variants such as splice site, inframe indels, frame shift and stop gained/lost mutations. the second category included variants in regions that were predicted to have potential regulatory roles: loosely referred to as “reg”. the reg variants were mainly those within a 5000 bp region upstream and downstream of genes, or in three/five prime untranslated genic regions or were non-coding exon variants. all other variants were from the illumina hd 800 k snp array and were allocated to the third category, referred to here as “chip”: these were mainly intergenic, but included some intronic and synonymous coding variants.

we then combined all the aus holstein and jersey genotypes and used this data set to pre-select a subset of the most informative sequence variants. first we excluded those with minor allele frequency  <  <dig>  using plink software  <cit> . we then excluded any one of a pair of variants in complete ld  across groups of  <dig> adjacent variants in sliding windows of  <dig> variants . ld pruning was carried out first independently within each variant group  and then any reg or chip variant in complete ld with an nsc variant was removed. last, all chip variants in perfect ld with a reg variant were removed. the remaining  <dig>  variants, henceforth referred to as “seq”, were used for the analysis and included  <dig>  nsc variants,  <dig>  reg variants and  <dig>  chip variants.

we also generated a standard set of snp chip genotypes for each animal based on the illumina hd 800 k snp array that were in common with the full set of imputed  <dig>  m sequence variants . this provided a comparison of the accuracy of genomic prediction using a standard 800 k genotype array or the seq genotypes. in total there were  <dig>  snp genotypes in this hd snp array set, henceforth referred to as the “800 k” genotypes.

phenotypes
aus
these phenotypes have previously been described by kemper at al  <cit> . briefly, the aus bull phenotypes were daughter trait deviations  extracted from the adhis  database. dtd are generated from nationwide progeny test data collected on many bull daughters, and have been corrected for known fixed effects such as herd, year and season. the aus cows phenotypes were td  based on their own lactation records  and corrected for known fixed effects. traits analysed were milk, fat and protein yield. a limited number of analyses were also carried out for protein and fat percent derived from the yield phenotypes as described by kemper at al  <cit> .

danz
these phenotypes are a subset of those described in  <cit>  . briefly, the majority of holstein and jersey danz bulls had international mace  breeding values that were converted to de-regressed proofs  on the australian scale. a total of  <dig> training bulls as well as the australian red bulls and cows did not have international mace breeding values, and their dtd or td were used instead . the variance of drp phenotypes was scaled to match the within breed dtd variance using records from bulls with both drp and dtd. additionally, data type by breed was included as a fixed effect in the analytical model. traits analysed were milk, fat and protein yield. there was an overlap of  <dig> aus bulls that were included in the danz set of  <dig> bulls.

aus-sim
phenotypes were simulated for each animal as a complex trait with  <dig> additive qtl effects that were simulated onto real genotypes chosen from seq variants. qtl were simulated by sampling  <dig>   <dig> and  <dig> effects from each of three normal distributions, with a zero mean and variances;  <dig> σ2 
g,  <dig> σ2 
g and  <dig> σ2 
g, respectively, where σ2 
g is the additive genetic variance. the genetic value of the jth animal was calculated as: geneticvaluej=∑i=14000xijαi 

where αi is the ith qtl effect and xij represents the ith genotype  of animal j. an environmental effect for each animal was sampled from a normal distribution and was added to the genetic value to produce phenotypes with heritability  =  <dig> . this relatively high h <dig> was chosen to mimic the highly accurate progeny test phenotypes of dairy bulls. additionally a breed effect sampled from n was added to the phenotypic value of all holstein animals.

three traits were simulated to provide a range of genetic architectures, where the  <dig> qtl effects were simulated on different sets of seq variants that were chosen as follows:qtl were randomly selected variants in or within  <dig> kb of  <dig> “lactation” genes including:  <dig> nsc,  <dig> reg and  <dig> chip variants. the lactation genes were candidate genes for milk production because they showed differential expression in association with experiments that altered milk yield .

qtl randomly simulated on  <dig> nsc and  <dig> reg variants in and around coding regions, and dispersed genome-wide.

qtl simulated on variants chosen uniformly at random genome-wide, including:  <dig> nsc,  <dig> reg and  <dig> chip variants.



pedigree information was obtained for all phenotyped animals, with data for overseas animals obtained from interbull and australian animals from adhis.

bayesr
bayesr analytical methodology was described by erbe et al  <cit>  with further detail and additions in kemper et al  <cit> . our implementation exactly followed that of kemper at al  <cit> . briefly, bayesr uses an mcmc approach to estimate variant effects which are modelled as a mixture distribution of four normal distributions including a null distribution, n, and three others: n, n, n, where σ2g is the additive genetic variance for the trait. the first distribution accommodates the likelihood that many variants have no effect on the trait, thus reducing the complexity of the model. the model fitted to the training datasets was:  <dig> y=xb+za+wv+e, 

where:y = vector of phenotypes for cows and/or bulls 

x = design matrix allocating phenotypes to fixed effects,

b = vector of fixed effect solutions, where fixed effects included overall mean, breed, and when appropriate, data type – drp, dtd, td – nested within breed,

z = design matrix allocating phenotypes to polygenic breeding values,

a = vector of polygenic breeding values: distributed n: a = numerator relationship matrix calculated from sire and dam pedigree records and σ2a = additive genetic variance not explained by the variants,

w = design matrix of variant genotypes, centred and standardized to have a unit variance following  <cit> ,

v = vector of variant effects, distributed as a mixture of the four distributions as listed above,

e = vector of residual errors, distributed n: with σ2e = error variance. e is a diagonal matrix constructed as diag, where wj is a weighting coefficient based on the number of records available for each animal as described in  <cit> , and following  <cit> . this accounts for the variable accuracy of trait phenotypes  which arises in dairy cattle because bull phenotypes were calculated from < <dig> to many thousands of daughter lactation records, and cow td were based on their own records .



variant effects were assumed to belong to one of four normal distributions: d <dig>  d <dig>  d <dig> and d <dig>  as in  <cit> , the prior distribution for the proportion of snp in each of these four distributions  was p ~ dirichlet  where α =  <cit> . each iteration this was updated by sampling: p~dirichletα+β, 

where β was a vector with the number of variants in each of the four distributions as currently estimated from the data. each iteration, p was used in updating the conditional posterior probability that variant i belongs distribution d .

variants with maf <  <dig>  in each training set were excluded from the analysis. for all bayesr models and traits we implemented five replicate chains of the gibbs sampler, each chain running for  <dig>  iterations with  <dig>  iterations discarded as burn-in. final parameter estimates were derived from the means of the sampled effects in the post burn-in iterations, obtained separately for each of the five chains. bayesr analyses were carried out with seq genotypes as well as with the 800 k snp chip genotypes.

bayesrc method
bayesrc used the same approach as bayesr except that a priori independent biological information was used to allocate each variant to a specific “class” c , where the purpose is to provide one or more classes that are enriched for qtl. for example, all variants in or close to candidate genes could be allocated to class i, while all other variants could be in class ii. as for bayesr, the variant effects for members of class i are assumed to belong to a mixture of four normal distributions with proportions  while the variant effects that are members of class ii belong to an independent mixture of the four distributions with proportions , etc. in bayesrc a small modification in the bayesr algorithm allows updating of the distribution of qtl effects within classes: an advantage if a particular class is enriched for qtl. within each class c, we used a uniform dirichlet prior  for the proportion of effects in each distribution: pc ~ dir, where αc 
=  <cit> . this was updated each iteration within each class: pc~dirαc+βc, 

where βc was the current number of variants in each of the four distributions within class c, as estimated from the data. thus, we used a relatively uninformative prior for all classes, but within a class the posterior proportion of variants in each distribution was informed by the data and could vary from one class to the next. if a class is found to be enriched for qtl this increases the probability that a true qtl effect in this class will be included in the model. the prior of αc 
= 
 <dig> can be argued to have little influence on the posterior distribution provided that there is a reasonably large number of variants per class. the updating of all other parameters was carried out as described for bayesr  <cit> .

we consider three versions of bayesrc  defined by how the prior allocated snp to one of three classes, as described in table  <dig>  in bayesrc seq the variant categories in seq genotypes  provided a simple biological prior, under the hypothesis that nsc should be most enriched for causal variants, reg somewhat enriched and chip least likely to contain causal variants. in bayesrc lact, the prior was based on a set of  <dig> candidate genes associated with milk production  that had been discovered in an independent microarray gene expression study  <cit>  . although the dgat <dig>  gene was not included in the original microarray experiment, we added it to the lact set because a causal mutation in this gene has been demonstrated to have a very large effect on fat, milk and protein yield  <cit> . in the third version, bayesrc rlact, we used the same prior as bayesrc lact except that we replaced the lact gene set with a randomly generated set of  <dig> genes to provide a null model.table  <dig> description of bayesrc models used to analyse the seq a genotype data

ii. reg 
 <dig> 
ii. all variants other than nsc that overlap lact gene regions 
 <dig> 
ii. variants other than nsc that overlap a random set of  <dig> genes 
 <dig> 

aseq = pruned set of  <dig>  genome-wide sequence variants from coding and regulatory regions as well as snp from a high density genotyping array. variants were allocated to one of three bayesrc classes as listed


blact refers to a set of  <dig> candidate genes shown in an independent study to be differentially expressed in association with altered milk production


cnumbers generally reduced slightly from those listed because variants with maf <  <dig>  in any given training population were also excluded from the analyses



genome-wide association analysis - gwas
an association study was conducted in the aus dataset using ‘snp snappy’  <cit> . this process fitted a model similar to eq.  <dig>  but replaced the term for all snp genotypes  with a single snp regression of phenotype on genotype, one snp at a time. that is, as well as the snp regression, the model included the overall mean, fixed effects, a polygenic term and phenotypes were weighted for heterogeneous error variance  <cit> .

gblup
a traditional gblup method was implemented for the simulated data as described in  <cit>  using asreml software  <cit>  and fitting the model described in eq.  <dig>  as for bayesr, all variants are fitted in the model simultaneously, but gblup linear mixed model assumes each variant has an effect sampled from the same normal distribution.

accuracy of genomic prediction
the accuracy of genomic prediction was estimated from the correlation between the predicted genetic value y^v=wv^ and the phenotypes  for all validation sets. for consistency, the residual polygenic value was not included in the prediction of genetic value because some validation sets were not connected through the pedigree with the training population. in the aus-sim data we used the same approach but the accuracy was measured by the correlation between the predicted genetic value  and the simulated true genetic value. in aus-sim we assessed the bias of the predictions using the regression coefficient of the true genetic value on the predicted genetic value. accuracies and regression coefficients were calculated within each of five mcmc chains and the reported value is the mean.

RESULTS
genotype ld and maf
the allele frequency spectrum of the  <dig>  imputed seq variants was similar for all three cattle breeds used in this study . a larger proportion of nsc and reg variants had maf <  <dig>   compared to chip variants  . the proportion of all polymorphic loci not segregating across both the holstein and jersey breeds was; 24 % for nsc, 19 % for reg and 4 % for chip variants. the ld among chip variants was on average higher than ld between nsc and chip variants .

simulated phenotypes – accuracy of genomic prediction
the aus-sim data  used real genotypes with three different simulated trait phenotypes . for each trait we analysed the data with gblup, bayesr and three versions of bayesrc  that differed in the biological priors used to allocate variants to one of three classes . the simulated traits were developed to test specific bayesrc priors:qtl simulated on variants in or close to the  <dig> lact genes. the bayesrc lact was the most appropriate model for this trait because qtl were allocated either to class i or ii. the qtl represented 13 % of all class i variants and 6 % of all class ii variants: that is there was enrichment for qtl, particularly in class i.

qtl simulated on  <dig> nsc and  <dig> reg variants, randomly chosen genome-wide. the bayesrc seq model was the most appropriate for this trait because all qtl were allocated to class i  and class ii . however, the qtl represented only 3 % of class i variants and  <dig>  % of all class ii variants: that is enrichment for qtl in these two classes was weak.

qtl simulated on random variants genome-wide, including nsc, reg and chip variants. this trait represents a null model with qtl randomly dispersed across all classes, therefore none of the bayesrc priors were biologically informative: that is there was no class enrichment for qtl.



figure  <dig> compares the accuracy of genomic prediction estimated as the correlation between predicted genetic values and true genetic values. in all comparisons the accuracy of gblup was lower than bayesr and bayesrc. for all traits, the accuracy of prediction decreased with decreasing relatedness between training and validation sets . however, this decrease was generally the more severe with gblup compared to bayesr or bayesrc. as expected, the accuracy of prediction generally increased using the seq genotypes, in which causal variants were present, compared to using 800 k variants . for bayesr, the relative gain from seq variants increased dramatically in the least related australian red validation , indicating improved precision of estimated qtl effects. smaller differences were observed for gblup because the gblup model fits a quasi-infinitesimal model with all effects estimated from a single normal distribution, resulting in the effect of a single qtl being spread across many variants in moderate ld with the qtl. bayesr on the other hand is better at predicting more precise effects, and can more accurately estimate the larger qtl effects because the qtl effects are modelled as a mixture distribution  <cit> .fig.  <dig> 
a, b and c accuracy of genomic prediction for real genotypes with simulated phenotypes  with a range of bayesr and bayesrc models . bayesr models used 800 k snp array genotypes or sequence data , while all bayesrc models used seq data . the results are shown for the three simulated traits: a qtl simulated on variants in or close to a set of  <dig> lact genes, b qtl simulated on nsc or reg variants only and c qtl simulated at random genome-wide on nsc, reg and chip variants



for trait  <dig>  accuracy was highest for the bayesrc lact model  where class i and ii were enriched for true qtl. importantly, the accuracy of the bayserc lact model persisted in the more genetically distant validation sets indicating that qtl effects were estimated more precisely. for example, in the australian red breed the bayesrc lact accuracy was 16 % higher than the bayesr seq model and was almost as high as accuracy in the red holsteins. we also tested models equivalent to the bayesrc lact, but with only two thirds or one half of the lact genes correctly identified, thus one third or one half of qtl were mis-allocated to class iii . although these latter models represented much less informative biological priors  they still conferred an advantage in accuracy for trait  <dig> compared to bayesr . again, this was most apparent for the australian red validation .

for trait  <dig>  although all qtl were contained in classes i and ii of the bayesrc seq model, this did not lead to an increase in accuracy, probably because the qtl represented only 3 % and  <dig>  % of all variants in the two classes respectively. that is, enrichment for qtl in these classes was too low. for the bayesrc rlact  and all bayesrc models tested on trait  <dig>  there was no difference in accuracy compared to the bayesr seq model . importantly, this indicates that there was no penalty for uninformative class specification.

simulated phenotypes – genetic architecture
the genetic architecture of the simulated traits was relatively accurately recovered in bayesr and bayesrc models with seq genotypes. for instance, in trait  <dig> the proportions of qtl in each of the four distributions within each class of the bayesrc lact model approximated the true proportions . although no causal variants were allocated to class iii, a small number of qtl were estimated to be present in this class probably because some variants just outside the lact gene regions were in high ld with lact gene variants. .table  <dig> average number of qtl estimated per distribution and per class of the bayesrc lact modela, compared with the true number of simulated qtl


a results are for trait  <dig>  where qtl were simulated in lact gene regions only



simulated phenotypes – qtl discovery
in the bayesian framework, the observed posterior probability of a variant having a non-zero effect should provide a direct measure of the relative likelihood that a variant is causal or is in very high ld with a real qtl. for all three simulated traits, the posterior probability generally reflected close to the true probability that a variant was a qtl . that is, if  <dig> variants with a posterior probability >  <dig>  were selected as potential causal variants, then at least  <dig> were real qtl. this confirms that the posterior probability statistic is generally well calibrated and could be used to make informed decisions on selecting variants for further study. the appropriate choice of posterior probability threshold for selection of variants would depend on the particular study objective. for studies designed to confirm causal mutations, it would be wise to choose a small number of variants with a high posterior probability and with consideration of other informative biological data. alternatively if the objective is to find a subset of informative seq variants to include on a custom array for genomic prediction, then the appropriate threshold would be considerably lower.fig.  <dig> the observed proportion of true qtl among variants with posterior probabilities falling in one of five bins  compared to the median posterior probability for variants in each bin . posterior probabilities are calculated as the proportion of iterations that a variant was estimated to have a real effect on the trait. results are from the aus-sim data  for three simulated traits with bayesr seq, bayesrc seq and bayesrc lact models 



the power to detect the  <dig> qtl from approximately  <dig>  variants was highest for trait  <dig> with the bayesrc lact model . for example, in bayesrc lact,  <dig> simulated qtl were recovered with a posterior probability >  <dig>  , while other analyses recovered less than  <dig>  qtl above this  <dig>   threshold. for trait  <dig>  bayesrc seq identified  <dig> qtl with posterior probability ≥  <dig>   compared to less than  <dig>  in other models. therefore, although the bayesrc seq did not improve prediction accuracy because class enrichment for qtl was weak, it did provide a small advantage for qtl discovery . for trait  <dig>  as expected, the number of qtl detected was similar across bayesr and all bayesrc models because no class was enriched for qtl .fig.  <dig> number of true qtl discovered  within groups of variants binned on posterior probabilities, for three simulated traits. the sum across all bins is the number of true qtl with posterior probability >  <dig>  out of a total of  <dig> simulated qtl. results are shown for the aus-sim data  applying a range of bayesr and bayesrc models . posterior probabilities are calculated as the proportion of iterations that a variant was estimated to have a real effect on the trait



real phenotypes – accuracy of genomic prediction
in the danz analysis, there was generally a consistent trend for accuracy of prediction to increase with variant density moving from 800 k to seq . overall, the accuracy of prediction in the australian red cow validation set was very low because cow phenotypes were less reliable as an indicator of true genetic value than bull phenotypes which were based on a progeny test. this is in contrast to the simulated data where bulls and cows had equally reliable data and also accuracy was measured as the correlation between the predicted genetic value and true genetic value.table  <dig> accuracya of the danz training predictions for fat, milk and protein yield in the red holstein bull and the australian red cow validation sets

analytical modelb

aestimated as the average correlation between the genomic prediction and corrected phenotypes. the highest accuracy is in bold font in each column. numbers in in brackets indicate relative convergence of  <dig> independent bayesian mcmc chains . note: the numbers in brackets should not be interpreted as a “standard error” because they are estimated from  <dig> bayesian mcmc chains run on the same data set


bbayesr models used either 800 k snp array  or  <dig>  sequence variants . the bayesrc model definitions are given in table 2




for the danz analysis, there was a trend for slightly increased accuracy with the bayesrc lact model compared to the bayesr seq model in both validation sets except in the australian red validation for fat yield. the lact genes were expected to be most highly associated with milk yield because of the experimental design used to identify these genes . however increased milk yield is often associated with an increase in protein and fat yield. overall, the accuracy of bayesrc rlact  were similar to bayesr seq and slightly lower than bayesrc lact accuracy.

in the aus data, the accuracy of genomic prediction showed similar trends to those in danz data: increased accuracy with bayesr seq compared bayesr 800 k and slightly higher accuracy with bayesrc lact for milk yield . in the australian red validation the accuracies for protein yield were very low indicating that these validation results are less reliable, so it is not surprising that these results did not follow a clear trend.table  <dig> accuracya of the aus training predictions for fat, milk and protein yield in the red holstein bull and australian red cow validation sets

analytical modelb

aestimated as the correlation between the predicted genomic values and corrected phenotypes. the highest accuracy is in bold font in each column. numbers in in brackets indicate relative convergence of  <dig> independent bayesian mcmc chains . note: the numbers in brackets should not be interpreted as a “standard error” because they are estimated from  <dig> bayesian mcmc chains run on the same data set


bbayesr models used either 800 k snp array  or  <dig>  sequence variants . the bayesrc model definitions are given in table 2




real phenotypes – genetic architecture
the average number of variant effects estimated per non-zero variance distribution  were similar for all models with seq data . the overall number of variants estimated per trait was higher than in our simulation with most in the smallest variance distribution.table  <dig> average number of variant effects per non-zero distribution  of bayesr seq and bayesrc lact modelsa



a results are for milk, fat and protein yield in both the danz and aus training sets



in the bayesrc lact analysis of milk yield, class i and ii variants appeared to be enriched for qtl effects . for instance, in the aus dataset,  <dig>  % of class i variants were sampled in the  <dig> σ2 
g distribution whereas in bayesr seq, only  <dig>  % of all variants were in this distribution. the highest fold enrichment was in class i for snp effect distributions with  <dig> σ2 
g and  <dig> σ2 
g variance .table  <dig> proportion of non-zero variant effects estimated per distribution, within each class of the bayesrc lact model for milk yield

 <dig> 
 <dig>  %
 <dig>  %
 <dig>  %
 <dig>  %
 <dig>  %
 <dig>  %
results are given for both aus and danz training sets, and are compared to the distribution of variant effects in the bayesr seq model 



to confirm that class i and ii variants in bayesrc lact were enriched for milk yield qtl we tested their ability to predict phenotype compared with the same number of randomly chosen variants. we derived a separate prediction equation for each class  using the variant effects estimated from bayesrc lact , for each of the five replicated mcmc chains. we then randomly selected  <dig> gene regions and allocated equivalent numbers of seq variants to class i, ii and iii as in bayesrc lact. prediction equations for these random variant sets were derived from the bayesr seq estimated variant effects. this was replicated  <dig> times by sampling a new set of  <dig> genes with replacement, giving a total of  <dig> replicates . the accuracy of all prediction equations for each class was estimated in the red holstein validation set and averaged across replicates. we repeated the same procedure for fat and protein yield.

for milk yield there was higher prediction accuracy from bayesrc lact class i and ii equations compared to those from the random gene classes i and ii, confirming enrichment of milk yield qtl in class i and ii . for protein yield the bayesrc lact accuracies confirmed some qtl enrichment in class i only. the accuracies for fat yield suggested a low level of qtl enrichment in class i and ii but somewhat less than observed for milk yield. enrichment for milk and protein yield qtl was further substantiated by the accuracy of class iii being lower for bayesrc lact than that of the random predictions  suggesting some depletion of qtl in class iii.fig.  <dig> accuracy of prediction  per variant class of the bayesrc lact model compared with bayesr predictions using a matching number of randomly selected variants . accuracy was estimated as the correlation between the predicted value and the red holstein phenotypes . the boxplot shows the median and range of values for all replicates 



real phenotypes – qtl discovery
use of seq compared to chip genotypes was expected to improve qtl discovery, particularly if a causal variant was rare and/or present in the seq data. we detected a number of strong qtl signals in the seq analyses in regions where no qtl were detected in the 800 k analyses . one such example was a rare reg variant  that lies 2777 bp upstream of the smek <dig>  gene coding region . a second example is a rare variant  4949 bp upstream of the csh <dig>  gene .

testing one snp at a time is the most common method of qtl analysis in genome wide association studies . therefore we compared the power and precision of qtl discovery using single snp regression , bayesr and bayesrc in several previously documented candidate gene regions. figure  <dig> compares qtl discovery with both gwas and the bayesrc lact model for protein and milk yield in and around the casein gene cluster . the gwas results showed many strong signals across the casein cluster, while the bayesrc lact model suggested there may potentially be two causal variants for protein yield: one associated with beta-casein gene  and the other with kappa-casein . this highlights the ability of the bayesian model to differentiate just one or two most probable variants compared to the gwas approach which finds many variants in an extended region with high –log10p-values. there were many variants in medium to strong ld with the top bayesrc variants at  <dig> , <dig> and  <dig> , <dig> . in the gwas analysis of protein yield it is unclear whether the high –log10p-values around the gc  gene arise due to ld with one or more causal variants in the nearby casein gene cluster. however, the bayesrc protein yield analysis indicates good evidence for an additional causal mutation near the gc gene because the most probable variant in this region is not in strong ld with the highest probability variant in the casein cluster . furthermore, the same candidate variant close to the gc gene  also had the highest bayesrc posterior probability in this region for milk yield . thus the bayes rc analysis suggests three causal variants in this region: two near the casein genes mainly affecting protein yield and one near the gc gene affecting milk and protein yield.fig.  <dig> qtl discovery with gwas  and bayesrc lact  for milk and protein yield around the casein gene cluster  and gc gene. the bayesrc variant with the top probability  is shown by a purple diamond in each plot . the strength of ld  between this top variant and all others is colour coded



a second comparison of gwas and bayesrc lact is given in fig.  <dig> for a region on chromosome  <dig> which again showed strong associations with milk and protein yield. in the gwas protein analysis it is difficult to determine the number of qtl, while in the bayesrc analysis the evidence is more compelling that there are at least two qtl regions. the high probability variant at  <dig>  mb lies just 1635 bp downstream of the myh <dig>  gene and affects both milk and protein yield. there is evidence of another qtl region around the ncf <dig>  and csf2rb  genes  affecting only milk yield. the bayesrc analysis shows several small peaks of posterior probabilities possibly indicating that, due to the very strong ld across this region, the analysis cannot determine which snp or gene is most likely to be causal.fig.  <dig> qtl discovery with gwas  and bayesrc lact  for milk and protein yield across a 1 mb region of chromosome  <dig>  the bayesrc variant with the top posterior probability in a given region  is shown by a purple diamond . the ld  between this variant and all others is colour coded



we also found evidence of improved power of qtl discovery in bayesrc lact compared to the bayesr seq model in a number of qtl regions. an example of this is provided by the paep gene  that was included in our lact gene set. this is an important milk whey protein and mutations in and close to this gene have previously been shown to be associated with milk protein traits . figure  <dig> compares the posterior probabilities of variants in this region for bayesr seq and bayesrc lact analysis and also shows ld between the highest posterior probability variant  and all other variants in the region. a single variant  stands out with a very high bayesrc posterior probability for protein yield  as well as one other adjacent variant at  <dig> , <dig> . in contrast, the bayesr posterior probability is lower and spread across several variants all in strong ld over a 50kb segment . also of note in fig. 7a is a small peak of higher posterior probability variants over a gene labelled as uncharacterised  that are not in ld with those around paep. this uncharacterised gene was not included in the lact gene set but is now annotated on the ncbi  “gene” repository  as a duplicated paep-like protein coding gene .fig.  <dig> 
a and b. qtl discovery: posterior probabilities of variants in the paep gene region for bayesrc lact  and bayesr seq analysis . the bayesrc lact variant with the top posterior probability  is shown by a purple diamond in each plot  and the ld  between this variant and all others is colour coded. the position of the seq variants fitted in the model is also shown above



table  <dig> provides a short list of candidate genes  identified by variants in or close to genes  that showed the strongest evidence for associations with one or several traits . all variants listed had a posterior probability >  <dig>  in the bayesrc lact analysis and there was additional evidence in support of the candidate genes listed: they were either validated in the danz analysis, were associated with more than one milk trait , were in the lact gene set and/or were positively differentially expressed in lactating mammary tissue compared to  <dig> other tissues of a lactating dairy cow  <cit> .table  <dig> candidate genes identified by listed variants in coding or regulatory regions with a posterior probability ≥  <dig>  for milk, protein or fat yield 

n
++
n
n
n
n
n
+
++++
++++
n
n
+
++
++++
++
n
n
+++
+++
+
++
+
n
+
n
+
n
+++
n
the relative direction of the variant effect on milk traits is shown as ‘+’ or ‘-‘. the direction of effects for fat and protein percent  are included if their posterior probability was >  <dig>   as further validation of the yield traits


athe strength of rnaseq differential gene expression in lactating mammary tissue compared to  <dig> other body tissues  <cit> . differential expression is indicated if log <dig> fold change  >  <dig>  and p-value <  <dig> e- <dig> and “n” indicates no differential expression. the strength of expression is indicated as + for a lfc value between  <dig> to  <dig>  ++ for  <dig> to  <dig>  +++ for  <dig> to <dig> and ++++ for above 10


bevidence for candidate genes included one or more of the following: a member of the lact gene set , associated with more than one milk trait , differentially expressed in mammary tissue , and/or validated in the danz analysis 




discussion
this study demonstrates that the bayesrc method can simultaneously be used to map causal variants, to study genetic architecture and to predict future phenotypes as did moser et al  <cit>  and kemper et al  <cit>  for bayesr. however, our new bayesrc method is potentially more powerful than bayesr because it enables flexible integration of a priori biological information. we provided evidence that bayesrc can increase the accuracy of genomic prediction and qtl discovery compared to bayesr and gblup with informative prior biological information. we also showed that using imputed sequence data in coding regions increased prediction accuracy and power to detect rare causal variants compared to dense snp array genotypes.

a desirable feature of bayes rc is that the prior knowledge is incorporated objectively. in the case of gwas for example, prior knowledge is only used post-analysis to confirm candidate genes. however, it is often possible to make a plausible case for many genes potentially affecting a trait. in bayes rc, classes of sequence variants expected to differ in the proportion of variants having an effect on the trait are defined a priori. this leads to an objective estimate of the enrichment of effects within a class of variants. this enrichment is then used by the analysis in estimating the probability that any individual variant in the class has a non-zero effect.

bayesrc is somewhat similar to bayesrs  <cit>  which uses prior knowledge of the variance explained by each segment of the genome, and then allocates a segment specific prior for the mixing proportions of variant effects expected in the four distributions. a key difference in bayesrc is that the prior is the same for the mixture proportions in all variant classes . thus the classes only differ in their estimated distribution of variant effects if this is supported by the data. also, in bayesrc, the classification of variants to classes is flexible and straightforward to apply, incorporating information from a range of independent sources ranging from very broad to specific . for example, in our bayesrc lact analysis of simulated trait  <dig>  most variants in classes i and ii were not qtl variants, but enrichment for qtl  in these classes resulted in more power and precision than bayesr and gblup. even when one third or one half of the  <dig> qtl for trait  <dig> were mis-assigned to class iii  the bayesrc model still showed the higher accuracy than bayesr . we used the lact gene model to simulate  <dig> qtl because previous studies have suggested that the number of loci affecting complex traits is at minimum several hundred up to several thousand . several studies have also provided strong evidence that within a qtl region, there are multiple alleles segregating that affect the trait . however, provided that there is good prior biological information available, the bayesrc model should provide an advantage independent of the exact distribution of qtl effects.

in real dairy cattle data the increase in accuracy of genomic prediction with bayesrc was only modest at best. this is probably because the class i and ii enrichment for non-zero effects was low  and most of the genetic variance was explained by class iii variants. for instance, for milk yield the proportion of variance explained by each class was approximately 6 % for class i, 13 % for class ii and 81 % for class iii. thus to increase the accuracy of prediction, we need better prior biological information about the genes and sites in the genome that are likely to affect a particular trait. in human genetics the encode annotations may well provide this  <cit> . also, we expected the most difference between methods to be apparent in the australian red validation  but the lower reliability of these cow phenotypes may have partially masked real differences.

another factor limiting prediction accuracy with bayes rc in the real data is imperfect imputation of sequence and/or missing causal variants. in addition to imperfect imputation, we did not attempt to analyse full genome sequence but concentrated on gene coding regions, so undoubtedly a proportion of causal variants are missed. however, the use of imputed sequence variants in coding regions did generally increase the accuracy of genomic prediction in simulated and real data compared to high density snp genotypes . in the real data it also enabled the discovery of a number of rare variants associated with milk traits that were not detected as qtl regions using only high density snp genotypes: we gave two examples close to smek <dig> and csh <dig> genes .

smek <dig> to our knowledge has not been documented by other research groups as affecting milk production in dairy cattle and was not in our lact gene set. however, it had a very high posterior probability and is a potential candidate gene because it is plays a regulatory role in the insulin/igf- <dig> signalling pathway  <cit>  and is known to be involved in mammalian hepatic gluconeogenesis  <cit> . the insulin/igf- <dig> pathway influences key physiological processes related to mammary gland development such as cell proliferation and apoptosis. it is of course possible that the rare reg variant with the highest posterior probability  may not be the actual causal mutation. a second reg variant, 1589 bp downstream from smek <dig>  was excluded from our analysis because it was in perfect ld with our candidate reg variant. also, both these reg variants are in very high ld  with an nsc variant in smek <dig> which is predicted to have a deleterious effect on the protein .

csh <dig> codes for a chorionic somatomammotropin hormone  which has been demonstrated to play a role in bovine mammogenesis and milk production  <cit>  possibly by directly influencing the proliferation of luminal mammary cells  <cit> . again, the variant identified in our study may not be the causal mutation, but could be in high ld with one regulating the expression of csh <dig> 

the candidate gc gene  in fig.  <dig> encodes the vitamin d binding protein  which is the main transporter of vitamin d in plasma. to our knowledge, no other independent studies have suggested this gene is associated with milk traits although it was included in our lact gene set. the gc gene appears to be actively involved in the transport of vitamin d3: first transporting the sterol vitamin d <dig> from skin to liver, then its 25d <dig> derivative from liver to kidney and finally the active form,  <dig> d <dig>  from kidney to the mammary gland and other tissues . in vitro studies indicate that vitamin d <dig> is involved in regulating growth and differentiation of mammary epithelial cells  and these cells play a key role in determining the level of milk production.

the candidate gene myh <dig>  codes for a cellular myosin and to our knowledge has not been previously published as a candidate gene affecting milk traits, but was in our lact gene list. it is known to play a role in the actin cytoskeleton and has been found to be highly expressed in terminal end buds of murine mammary tissue  <cit>  implying a key role in mammary gland development. it may also be involved in controlling milk secretion through involvement in tight junctions  <cit> . of the other two potential candidate genes for milk yield in fig.  <dig>  ncf <dig> was included in our lact gene set while csf2rb was not. however, csf2rb was found to be highly over-expressed in lactating mammary tissue compared to  <dig> other tissues  <cit> . csf2rb codes for the β subunit of cytokine receptors for the interleukin- <dig> family. the majority of cytokine receptors, in addition to playing a key role in immune signalling pathways, are involved in activation of the jak/stat pathway  <cit>  which is known to be important for regulating mammary gland development.

the two nsc variants identified with the highest bayesrc lact posterior probability in the paep  gene  are the “causal mutations” that distinguish the well-known a and b forms of the beta-lactoglobulin protein in milk whey  <cit> . a number of studies have consistently found that animals homozygous for the a form of beta-lactoglobulin have higher concentrations of protein in their milk compared to those homozygous for the b form . our results were in agreement with this: aa individuals having higher protein yields than the ab and bb individuals. although the genetic basis of this effect has not yet been discovered, it is possible that there is a regulatory variant in strong ld with these two nsc variants  which leads to increased transcription of the a form compared to the b form. the ld around the paep gene region is extremely high in our data, in keeping with the results of  <cit> , possibly as a result of selection for protein yield in dairy cattle. we excluded  <dig> variants in a 10kb region just upstream of paep from our analysis because they were in perfect ld with our highest probability variant. it is therefore possible that any one of these variants may be the causal mutation.

a number of the other candidate genes listed in table  <dig> confirm previously documented examples of genes associated with milk traits including: csn <dig> and csn <dig> , dgat <dig> and scd , mgst <dig>  ttc7b  and ghr  .

some other genes in table  <dig> that have not been previously documented as candidate genes for milk traits do fall in previously identified qtl regions. an example of this is krt <dig> in which a nsc variant showed a strong association with milk yield and was also in our lact gene set. this gene is one of a family of cytokeratins responsible for the structural integrity of epithelial cells and is one of a tight cluster of  <dig> keratin genes  all found to be highly over-expressed in lactating mammary tissue compared to  <dig> other tissues  <cit> . the krt <dig> gene is a very plausible candidate gene because it potentially affects the integrity of mammary tissue, thereby indirectly affecting milk production. some reg variants in table  <dig> lie closest to the gene listed, but may in fact be associated with regulation of a different gene in the same region that affects the trait.

caveats
in theory it is possible to use many more classes in bayesrc than the three used here. however, although the biological priors are relatively uninformative, it is likely that the dirichlet prior distribution may still have a moderately strong influence on the posteriors when the number of variants in one class is relatively low. when priors carry much uncertainty, such as our lact classes, we recommend maintaining reasonable class sizes  to ensure that the data has a strong influence on the posterior parameters. the main motivation for creating more than two classes should be the expectation that enrichment for qtl may differ between classes of variants.

a drawback of the bayesr and bayesrc methods is that they are computationally demanding, so it is important to develop faster bayesian analytical approaches  <cit> . for  <dig>  training individuals with ~ <dig>  seq variants and  <dig>  mcmc iterations, a multi-threaded c++ version of the program took ~300 h per thread with ~80gb memory . computation time increased approximately linearly with number of individuals and number of variants. speed and balding  <cit>  proposed a very computationally efficient “multiblup” method which differs from the standard gblup approach by allowing a mixture of normal distributions of snp effects to be fitted similar to bayesian approaches. the “biological priors” required for the multiblup method are estimates of genome segment variance which are then used to partition variants into groups representing different expected effect-size variances. the authors reported an increased accuracy of genomic prediction compared to standard gblup particularly where some causal variants with a large effect were segregating. the prior biological information required for multiblup is very similar to the requirements for bayesrs  <cit>  but the former is likely to be considerably more computationally efficient. however, it is unlikely that multiblup would show an advantage over standard gblup using our broad biological classifications because in one class there can be a wide range in the size of variant effects. also, for qtl discovery, multiblup would likely still show similar limitations as the standard gblup because the effect of a single true causal variant will tend to be spread over multiple snp within segments.

if ld is very high across extended regions of the genome, and qtl effects are many and small, there is likely to be little difference between bayesian and gblup genomic prediction when very dense markers are used  <cit> . we argue that for domestic species with small effective population sizes and resulting long-range ld, it is useful to combine data from more than one breed to reduce the strength of long-range ld. also, prior filtering of sequence data helps to reduce the likelihood of finding extended regions of dense variants in strong ld with a single causal variant. the accuracy of genomic prediction using sequence variants will then persist better in less related individuals because qtl effect estimates are more precise . notably, our results demonstrate that when training and validation sets are very highly related there will be little difference in the observed accuracy between methods. therefore, to expose the true precision of the qtl effect estimates, it is important to compare methods using validation sets which are not highly related to the training sets .

CONCLUSIONS
our new bayesrc method provides a flexible approach to improving the accuracy of genomic prediction and qtl discovery, by taking advantage of prior biological knowledge that is already available for a range of traits and species. the approach used in bayesrc to incorporate biological priors is appealing because it is straightforward to apply and is incorporated objectively based on evidence from the data being analysed. further research on discovering functional regions of the genome, as well as improving sequence and imputation accuracy of rare variant prediction are critical to realising the full potential of this and other similar methods.

data availability
the  <dig> bull genomes project  has published the sequences of  <dig> holstein and  <dig> jersey bulls  <cit>  that were used as our reference for sequence imputation. project accession code , srp <dig> and run accessions; srr <dig>  srr <dig>  srr <dig>  srr <dig>  srr <dig>  srr <dig> - srr <dig>  srr <dig>  srr <dig>  srr1262785- srr <dig>  srr <dig> – srr1262803). an additional  <dig> sequences were included in our reference  from run <dig>   <dig> bull genomes project. the list of  <dig>  million sequence variants used for the analysis are available on request. the list of “lactation” candidate genes are available in additional file  <dig>  bayesr code is available at: http://www.cnsgenomics.com/software/. the bayesrc compiled program is available on request for non-commercial research.

ethics statement
no experimental animal studies were conducted for the work detailed in this manuscript. references have been provided where animal data was used.

additional files
additional file 1: 
includes supplementary figures s <dig> to s <dig>  tables s <dig> to s <dig>  and a summary of the independent experiments used to identify the "lactation gene set". 

additional file 2: 
list of genes in the "lactation gene set" that were used as our independent biological prior for the bayesrc lact model. 



competing interests

the authors declare that they have no competing interests.

authors’ contributions

imm carried out the main statistical analyses, wrote the manuscript and participated in study design. pb processed data and wrote the bayesr and bayesrc software. cjvj carried out the data analysis to identify the ‘lactation’ candidate genes. mh-m processed the bull phenotypes and provided analytical advice. kek carried out the gwas analysis. ajc & cjvj carried out and analysed the differential gene expression work. cs processed crv bull genotypes and phenotypes. bjh participated in study design and carried out genotype imputation. meg developed the bayesrc methodology, participated in study design and helped draft the manuscript. all authors read and approved the final manuscript.

