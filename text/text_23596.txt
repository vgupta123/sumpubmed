BACKGROUND
the genetic diversity among bacteria mirrors their lifestyles and physiological versatilities and evolves from adaptation to their niches and growth conditions. many techniques have been used to obtain a picture of true microbial diversity. microarray-based comparative genome hybridization  is now a commonly used tool in comparative genomics. compared to sequencing and comparing whole genomes, acgh provides rapid genomotyping in bacteria  <cit> .

the majority of applications of acgh is in cancer-research, where copy-number abberations is the primary focus  <cit> . several methods have been suggested to analyze such data, e.g.  <cit> .

in microbial studies of genome diversity, usually one fully sequenced strain, called index strain, is compared to a set of unsequenced strains of the same or closely related bacterial species, called sample strains. in this setting it is of interest to characterize the sample strains with respect to the genes they have in common with the index strain, and those which are absent or highly divergent.

in theory, every given gene is either present or divergent in the sample strain. in this respect, a perfect measurement technology would provide a binary output. for many reasons, this is not the case in acgh. first, it is complicated to define relationships between sequence identity and hybridization signals. second, hybridization signals arise both from hybridization with similar genes, as well as from hybridization with homologs, paralogs, or genes with conserved domains. such non-specific hybridizations may lead to signals even from genes that are truly divergent. third, gene divergence is a slow evolutionary process such that based on nucleotide sequence similarity alone, in most cases a number of genes will be difficult difficult to classify as divergent or present. finally, the experimental features of acgh may complicate the interpretation of the hybridization patterns.

usually, the samples for microbial acgh are prepared as follows: genomic dna is extracted from the index and from the sample strain. the dna is then physically sheared or enzymatically digested, and the resulting fragments are labelled with different fluorescent dyes by random priming. the labelled samples are mixed and then hybridized onto the microarray. in contrast to gene expression experiments, the preparation of samples for hybridization by digestion or shearing, gives random fragments that may not match the gene targets on the array as well as cdna. the sheared/digested dna varies in length and the longer fragments may contain pieces of several genes.

the common analysis of acgh data focuses on the so-called log-ratio mi = log <dig> where si is the signal intensity of the sample strain and ii similar for the index strain, for gene i  <cit> . a small log-ratio indicates a weak sample strain signal, and hence the gene is most likely divergent. using a t-test statistics or a modified regularized t-test statistics as for example offered by the sam  <cit>  is no practicable alternative for this kind of experiments, as in practise there are mostly no replicate measures at all. hence, statistical analysis is limited to finding a high quality diagnostic score which can be used for a ranking of candidate divergent genes. this is the reason for focussing on scores which can be calculated from two signal intensities alone, the photomultiplier intensity readouts for the labels from index and sample strain respectively. a fixed cutoff on the log-ratio axis, separating divergent from present genes, is most likely sub-optimal due to the variation inherent in microarray experiments. as a consequence, it seems mostly impossible to learn an optimal fixed cutoff as classifier from a training data set even in the rare cases where such data set would be available. discriminant analysis approaches will therefore fail in the typical case. it seems more appropriate to determine such a cutoff dynamically from the data set in question for each analysis. to deal with this  <cit>  introduced a method for calculating a dynamical cutoff from the log-ratio distribution. considering the histogram in figure  <dig>  it is natural to assume that the heavy left tail of the distribution is due to divergent genes. based on this assumption  <cit> , suggested a calculation of the cutoff somewhere around the transition between the body and the left tail of the sample distribution. the data analysis tool developed from this approach is gack  <cit> .

we will in this paper extend and formalize the idea of  <cit> , to combine it with the data rotation approach by  <cit> . this allows us to use both the information inherent in the distribution of the log-ratios as well as that about the v-shaped patterns in the ma-plot, as observed by  <cit> . finally, from estimated probabilities for each gene to be absent or present in the sample strain, we calculate what we call the rotmix score for each gene. we use a set of simulated data sets as well as a set of experimental data sets from fully sequenced sample strains to validate the usefulness of the rotmix score for ranking and classification.

RESULTS
analyses of experimental data sets
in order to test and compare our approach to the conventional use of log-ratios as well as the rotation approach suggested by  <cit>  we performed experiments where sequences of both sample and index genomes were known a priori. in a normal experiment only the sequence of the index strain is known, but this design provides us with data where acgh analysis results can be validated by direct sequence comparisons.

a list of truly divergent genes is essential to validate the proposed method. for experimental data sets no such list exists with absolute certainty, even for fully sequenced genomes. however, from the sequence data it is evident that there exist two natural groups of genes, either as present or divergent in the sample strain. figure  <dig> shows a histogram of the identity indices from the blast searches in one data set. genes with identity index below  <dig> , or other cutoff if stated, are treated as divergent.

a classifying score's ability to discriminate divergent from present genes in a given data set can be summarized in a receiver operating characteristic  curve  <cit> . the trade-off between sensitivity and specificity is captured by the area under curve  statistic, where a large auc  indicates a good separation of the classes. table  <dig> summarizes auc-values, where we have compared the ranking using the rotmix-score to the ranking by log-ratio m or rotated log-ratio m* from equation  <dig> 

a roc curve deals with sensitivity and specificity, which are estimates of p and p, respectively, for a given data set. the area under the roc-curve indicates a variable's potential for classification, but the problem remains to actually pick a cutoff. figure  <dig> shows specific values for sensitivity and specificity for three different cutoffs. once a classification has been done, it will in most cases also be natural to consider p and p in addition to sensitivity and specificity. their corresponding estimates from a given data set we denote positive predictive value  and negative predictive value , and these are also included in figure  <dig> 

analyses of simulated data sets
a set of  <dig> simulated experiments for different random seeds was the basis for comparing the conventional, data-rotation and rotmix approaches. in the case of the conventional approach, increasing normalized m-values were used as score to rank genes as candidates for divergent genes, whereas for the data rotation approach increasing m* values were used , and for the rotmix analysis, ρ^
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwfbpgcgaqcaaaa@2e83@ values .

for each data set and each of the three analysis approaches; conventional, data rotation and rotmix approach, the ranking score for each gene was taken as a possible cutoff and rates of true positives, true negatives, false positives and false negatives recorded to construct roc-curves and auc-values .

discussion
array based cgh is a high-throughput biotechnology that is consolidating itself as a useful tool in microbial comparative genomics. despite many applications of this technology in analyzing genome-genome similarity, there is no real consensus on how to analyze the data and draw conclusions from the experiments. we have in this paper suggested an efficient method for ranking genes, and subsequently classifying them into two groups, present and divergent. essentially we calculate a diagnostic score as the average posterior probability of divergence from the mixture model in  when fitted to the data before and after the rotation. we have demonstrated its usefulness for simulated validation data as well as for four different hybridizations with only fully sequenced sample strains. results were compared to two other proposed analysis approaches.

log-ratio based ranking is by far the most common in papers dealing with microbial acgh data. in some microbial acgh analyses the cutoff log-ratio separating divergent and present genes is held constant at - <dig>    <cit> . others use a cutoff relative to the distribution of all data, e.g.  <cit> , who treated all genes with log-ratio more than  <dig> standard deviations below the overall mean as putative deletions. log-ratio based ranking is also the fundament for  <cit>  and the data analysis tool gack  <cit> . an alternative way of ranking was introduced by  <cit> , using the data rotation. from figure  <dig> as well as from table  <dig> it seems that the rotmix-score separates divergent from present better than the two other ways of ranking genes. in all cases, the auc-value for the rotmix-score is as good or better than the other two. the differences are, however, small, and based on only four independent experimental validation sets, the differences are not significant. the simulations, however, indicate a stable difference since every rotmix-result is better than all other results. the auc-values for the rotmix-score are comparatively high, ranging from around  <dig>  to well over  <dig>  depending on data set and identity threshold.

our experimental validation data are from experiments with fully sequenced strains, but still there is some degree of uncertainty regarding which genes are truly divergent. we have based our analysis on nucleotide sequence identity, since this is what a microarray can measure. using an identity threshold of  <dig>  gives 12–16% divergent genes, which is a likely number, compared with other acgh studies  <cit> . we have performed analyses with other choices of identity threshold , and the results are similar to those in table  <dig> .

when we interpret the classifying variable as a posterior probability of divergence  a natural cutoff for classifying divergent and present genes is 1/ <dig>  figure  <dig> illustrates the effects of different cutoffs. for the log-ratio based classifications  there is little effect of a varying cutoff within the range shown. this is because when fitting a two-component gaussian mixture to data like those in figure  <dig> the major peak will give a rather narrow density describing the present genes, i.e. almost all genes will have a posterior probability of divergence very close to  <dig> or  <dig>  from the lower panels of figure  <dig> we notice that the results of the rotmix-classification is sensitive to a varying cutoff. as expected, a gradually increased cutoff will produce higher ppv and specificity but lower sensitivity. this means that if a gene has a large rotmix-score it is also more likely to be divergent.

fixing the cutoff at 1/ <dig> gives a significant improvement of ppv for the rotmix case compared to the log-ratio classification in the upper panels . this translates to a relevant reduction in the false discovery proportion for the genes ranked first using the rotmix-score. thus, time and costs for subsequent proving low-throughput experiments are considerably lowered. for sensitivity and npv there is no significant difference, and for specificity rotmix gives a significant, but in practice not important, improvement.

using a score-based approach rather than an established statistics like for example a t-test or a regularized modification thereof  is necessary because of the usual absence of replicate measures in acgh screenings. moreover, a mixture model score is more robust against normalization problems. any t-test like statistic, using a null hypothesis of equal signals for index and sample genome, would classify all genes with significant deviation in signals as divergent. the mixture fit, however, searches for two distributions of signals, and there is no need to assume that present genes always produce equal signals in the sample and index strain.

ma-plots should always accompany any analysis using the rotmix-procedure. it is in this space the rotmix-procedure operates, as illustrated in figure  <dig>  it is of course essential that the ma-plot graph more or less has the v-shaped form. if not, the rotmix-score may give dubious results, but of all microbial acgh data sets we have seen, a majority has this characteristic pattern. as more and more bacterial strains are sequenced, we will see more multi-genome arrays in the future. from such arrays we can also detect genes that are present in the sample strain but not in the index strain. following the reasoning behind the data rotation of  <cit> , we expect such genes to be found around a line of slope + <dig> in the ma-plot. experiments on such arrays could also be analyzed by our procedure, with some natural adjustments, given that such data show a corresponding w-shaped pattern. we have seen some data confirming this, but more research should be done before we can be conclusive.

the current validation data indicate that the most severe problem faced is the rather low sensitivity,  when using a classification cutoff around 1/ <dig>  this is not surprising, since divergent genes are in general grossly outnumbered by present. future efforts should, however, probably focus on this. one approach could be to make better use of extra information sources. we are actually facing a classification problem, but with no training data available. a partial training of the classifier could however be done using genes known to be present, i.e. the core minimal genome genes  <cit> . experiments with cdna microarrays still lacks the repeatability needed to transfer actual parameter estimates from one experiment to another. to achieve this, highly specialized arrays are required  <cit> , at high costs and reduced versatility.

CONCLUSIONS
we have devised an efficient, sensitive and specific procedure for detecting divergent genes from microbial acgh experiments. a simple procedure based on gaussian mixture models and data rotation provides a score for each gene, which is an average of two posterior probabilities of divergence. when tested on simulated data as well as on four different experimental validation data sets with only fully sequenced strains, this rotmix-score seems to be an improvement of the standard log-ratios for ranking and classifying genes into divergent and present.

