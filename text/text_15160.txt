BACKGROUND
the transcriptome is the total set of transcripts in a given organism at a specific developmental stage or under external environmental condition. understanding the transcriptome is therefore essential to interpret the relationship between genome and organism function. transcriptomics can be used to gain considerable biological insight by cataloguing all species of transcripts, determining the transcriptional structure of genes, and quantifying the changing expression levels of each transcript under various conditions . rna-seq, a next-generation sequencing technique, quantifies the transcriptome at a given moment in time, allowing for a better understanding of genome structure, gene expression patterns and gene regulatory networks  <cit> . the organism can alter transcriptome levels and pattern responses to environmental changes  <cit> . rna-seq is a powerful tool used to identify specific genes associated with adaptive environments; such studies can assess genes involved in adaptation to environmental changes, particularly under different stresses or in various developmental stages. we hypothesized that, while an organism responds to growth conditions, particular environmental cues cause differential expression of its genes at a level that can be detected by rna-seq. by profiling transcriptional changes induced by environmental changes, it is possible to identify gene regions or pathways that are likely to be targets of selection. this information is important to enable researchers to assess variation across gene regions, on a landscape scale, to predict the capacity of organisms to adapt to different conditions. recently, rna-seq experiments have evaluated differential mrna processing events along the developmental gradient, as well as in different tissues, to account for the reaction norms of gene expression profiles . in addition, rna-seq has been used to assess the physiological response of organisms at different spatial scales and gain more insight into adaption mechanisms  <cit> .

to better understand responses of gene expression to growth conditions, cluster analysis has been used as a powerful computational tool to divide genes into groups according to their expression patterns. in biology, cluster analysis is implied by the basic assumption that a gene expression profile may have similar features within the group . despite their widespread use, traditional approaches, such as hierarchical clustering algorithms and k-means algorithms, are largely heuristic, lacking a stringent inference about the underlying biological mechanisms. on the other hand, a model-based clustering approach assumes that the data are generated by a mixture of the underlying probability distribution components, in which a different group or cluster represents a component . also, this approach is flexible in choosing the component distribution and obtaining density estimation for each cluster. nevertheless, most existing approaches for model-based cluster analysis have several limitations. first, the level of gene expression determined by rna-seq is represented by the abundance of short reads, mapped to the reference, which is defined as a set of exons  <cit> . in practice, model-based cluster analysis is computationally difficult, especially because some genes are expressed at a very high level. in general, to discover important biological changes in expression and eliminate calculative hardship, normalization continues to be an essential step in the analysis, but most normalization methods neglect data features  <cit> . as a type of count data, three discrete probability distributions: binomial, poisson and negative binomial , have been used to model rna-seq data .

second, a regular rna-seq experiment designed is to compare gene expression levels between test conditions. by comparing differential expression across treatments, one can characterize key genes that regulate the pattern of an organism’s response to rapid and stochastic environmental changes. joint clustering for expression amounts in different treatments has been developed  <cit> , but this strategy may not be sensitive to identify the differential response of genes to environmental changes, i.e., phenotypic plasticity  <cit> . the phenotypic plasticity of a gene can be expressed as the difference or ratio of expression amounts of the gene between two particular treatments. since the difference and ratio of two poisson variables requires totally different treatments of statistical modeling, we will, in this study, focus on model-based clustering for treatment-dependent differences to accommodate environmental impact.

although some attempt has been made to overcome the first limitation  <cit> , simultaneous treatment of the two limitations has not been explored in the literature. here, we developed a computational model that clusters the differences between two statistically independent random variables, each having a poisson distribution. since the difference of two poisson variables follows a skellam distribution  <cit> , skellam parameters were implemented within a mixture model framework in which each component is represented by a distinct pattern of expression differentiation. model parameters are estimated through the two-stage hierarchical expectation–maximization  algorithm. mean level of gene expression for a group is calculated for different environments, allowing us to compare the response level of gene expression to environmental changes. results from this skellam model will obtain diverse insight into the genetic basis underlying adaptation to environments. the skellam model was used to analyze an rna-seq dataset collected for early arabidopsis thaliana embryos derived from reciprocal crosses in the one-to-two-cell stage  <cit> . by comparing it with conventional k-means and self-organizing mapping approaches, we show that the new model is statistically more powerful for gene clustering.

methods
mixture model-based likelihood
the most common type of transcriptome study is carried out to measure the response of organisms to two treatments. this type of analysis is especially useful for comparison of expression in different organs, treated versus untreated conditions in the same tissue, or studying the difference between reciprocal crosses, etc. suppose we obtain a transcriptome dataset in which the organism is measured for reads of n genes with two treatments , and expression reads of gene i are denoted as xi and yi, respectively. in general, genes that are differentially expressed can be identified by determining differential expression between treatments. to assess gene expression changes across treatments, cluster analysis is a powerful tool for analyzing gene expression levels according to different patterns of gene expression. therefore, we can discern different groups of genes per their functional similarities and differences in their plastic responses to changes in environment.

for any gene i, it should arise from one of the j groups that are classified on the basis of two expression values with two treatments. the joint likelihood of the expression data zi =  of n genes is written as
  <dig>  

where θ represents a set of unknown parameters, πj represents the probability of group j in the total genes, and fj represents the density function of two expression difference values for gene i that belongs to group j with the two treatments.

we used a skellam distribution function to describe fj, which is specified by the mean values of gene expression with treatment  <dig> and  <dig>  let xi and yi denote two independent random poisson variables with mean θj <dig>  θj <dig> for group j, respectively. the two variables are expressed as one independent random variable: zi = xi - yi. a skellam distribution of zi for gene i is described by a probability density function, expressed as
  <dig>  

where θj <dig> and θj <dig> represent the mean expression values of all genes that belong to group j in treatment  <dig> and  <dig>  respectively, with the two parameters arrayed in Λj = . here, fj in the mixture model  is specified by fj.

estimation via the em algorithm
maximum-likelihood  estimation is more complicated since the likelihood involves the modified bessel function. if the true data xi and yi are observed, then the estimation is straightforward since their means would be the ml estimates for poisson parameters. here, an em-type algorithm is constructed based on the missing data representation of difference values z. unlike a general skellam model, the likelihood of zi is formulated within a mixture-model framework , whose estimation is based on implementation of the em algorithm. thus, we implemented a two-stage hierarchical em algorithm to estimate the parameters Λj of the likelihood .

in the e step, we calculate the conditional expectation of xi by
      <dig>  

where f* is the density of joint distribution of . meanwhile, we calculate the posterior probability of gene i that belongs to group j,
  <dig>  

in the m step, we obtained the estimates of parameters πj and Λj by using
  <dig>    <dig>    <dig>  

where e and m steps are iterated between equations  until the estimates of the unknown parameters converge to stable values. estimates obtained this way represent the maximum-likelihood estimates  of the parameters.

choosing an optimal number of groups
one important question in the implementation of model-based clustering analysis is to determine the actual number of clusters using a model selection criterion, such as bic. for a given number of clusters j, we calculate the likelihood l by  and the bic by - 2 log + j log, where n is the number of genes in the model. a low value of bic corresponds to an optimal number of clusters.

hypothesis tests
after an optimal number of gene clusters is determined, we tested whether genes are expressed differentially between treatments. three biologically meaningful tests were formulated as follows:
  <dig>  

 for a given group j, we want to know whether its genes are differently expressed between the two treatments. this can be tested using the following equation:

if the h <dig> is accepted, then the group of genes expressed between the two treatments is stable. otherwise, they exhibit differential expression across treatments, in which case, they can be used as a predictor of environmental-induced changes.
  <dig>  

 for a pair of groups j and l, we want to know whether they interact with each other to determine environmental-induced changes. this can be determined using the following equation:

if the h <dig> is rejected, then these two groups of genes have significant interaction effects on biological changes between treatments.
  <dig>  

 for a particular group j, we want to know whether changes in gene expression for a group are consistent with the extent of change of the environment. this can be determined using the following equation:

where c represents the difference between the environmental signals between treatments. if h <dig> is rejected, then the change in gene expression for the group is consistent with a change in the environment between treatments.

for each of the hypotheses , the likelihood ratio test statistics  between these two hypotheses h <dig> and h <dig> are calculated. since the h <dig> is nested within h <dig>  the lr value can be thought of being chi-square distributed, with the degree of freedom equaling the difference between the numbers of parameters to be estimated under the two hypotheses. the lr value is compared with a critical threshold to determine the acceptance or rejection of the null hypothesis. if these tests are incorporated by a particular environmental signal, e.g., temperature or nutritional level, we can better understand the relationship between gene expression and environmental change.

RESULTS
working example
the prevailing theory for the maternal-to-zygotic transition in plants proposes that most early embryonic mrnas are maternally derived, resulting either from maternal inheritance or from higher transcriptional activity of maternally derived genes until the globular stages. however, this theory is difficult to reconcile with reports of equivalent maternal and paternal expression of interrogated genes at the preglobular stage. recently, a study aimed to determine the origins of embryonic transcripts globally by reciprocally crossing polymorphic col- <dig> and cvi- <dig> arabidopsis thaliana accessions col-0 × cvi- <dig> and cvi-0 × col-0; the transcriptomes of embryos with one-to-two cells were then measured for two reciprocal crosses  <cit> , from which a total of  <dig>  differential expression genes were gained.

the skellam model was used to analyze this data, clustering  <dig> de genes into distinct groups. we used bic to determine an optimal number of gene groups. from the plot of bic value against the number of groups,  <dig> was found to be an optimal number of groups . for each group j, the mean values of gene expression  in reciprocal crosses were estimated, with reasonable good standard errors, by a resampling approach . in practical calculations, the estimate of θj is sensitive to the choice of initial values. to obtain a global maximum, multiple initial values have been selected and compared. figure  <dig> illustrates mean expression values of each group in two crosses;  <dig> groups not only display differential levels of gene expression, but also vary dramatically in terms of the difference of expression between reciprocal crosses. in figure  <dig>  we showed the pattern of how genes are differently expressed over different crosses. as can be seen,  <dig> groups of genes did not parallel, exhibiting significant gene–environment interactions under reciprocal cross conditions.figure  <dig> 
plot of bic values over the number of groups calculated from the transcriptomic data of early
arabidopsis thaliana
embryos in reciprocal crosses.



maximum likelihood estimates of mean expression values of genes  for  <dig> distinct groups in reciprocal crosses of early
arabidopsis thaliana
embryos


θ
j1
θ
j2
the mses  of the estimates are calculated from  <dig> bootstrapping samples.
differentiation patterns of genes from  <dig> distinct groups expressed in early
arabidopsis thaliana
embryos of reciprocal crosses. in each group, the mean expression curve is indicated by a thick line over expression curves of individual genes .
relative differences among gene expression curves of different groups expressed in early
arabidopsis thaliana
embryos of reciprocal crosses.


the hypothesis test  provided information regarding the significance of expression differences between treatments to determine the extent of the maternal and paternal contributions. of these  <dig> groups, gene expression levels from group  <dig>  tended to be stable between reciprocal crosses, although change in gene expression was statistically significant  . this indicates that most genes of maternal and paternal genomes contribute slightly differently to arabidopsis thaliana embryos at the one-to-two cell stage. approximately 6% of genes  and about 10%  were clearly down- or up-regulated from col-0 × cvi- <dig> to cvi-0 × col- <dig>  respectively, suggesting that they were preferentially inherited from one parent in one-to-two cell embryos. hypothesis test  was used to determine whether a particular pair of gene groups interacts with the environment. table  <dig> lists the significance test used for such gene–gene interactions. all pairs of gene groups exhibited significant gene–environment interactions . hypothesis test  was utilized to investigate whether gene expression was consistent with environmental change. except for group  <dig>  all groups conform to the extent of environmental change . all calculations and hypothesis tests done above took about 24 h in a 225-nodes computing cluster.table  <dig> 
hypothesis tests for gene–environment interactions between the two treatments in a group








the data were also analyzed by traditional approaches, k-means and self-organization mapping . k-means is a partitioning approach, whereas som is a method based on a machine learning algorithm that uses a competition and cooperation mechanism to achieve unsupervised learning, processed as implemented in the r package yasomi  <cit> . it was observed that k-means and the skellam model produce a similar result, different from that by som . since these three approaches have different underlying principles, they can be interpreted differently. k-means clustering tends to identify clusters of similar spatial extents, whereas som is typically used as an artificial neural network that is trained using unsupervised learning to produce a low-dimensional, discretized representation of the input space of the training samples. the skellam model identifies clusters based on their pattern of gene expression in response to treatment.figure  <dig> 
comparison of clustering results in  <dig> distinct groups using three methods .




computer simulation
simulation studies were conducted to test the statistical power of the skellam model. by assuming three up- or down-regulated expression patterns, we simulated  <dig> genes expressed in two treatments. the treatment-dependent means of groups and their probabilities were given in table  <dig> table  <dig> 
cluster parameter of the simulation study


group j
π
j
θ
j1
θ
j2


table  <dig> gives the maximum-likelihood estimates of θj <dig> and θj <dig>  in a comparison with their true values. in general, mean gene expression values in different treatments can be reasonably well estimated. the estimated curves of gene expression for each group were broadly consistent with the true curves , suggesting that our model was fully powered.table  <dig> 
results of parameter estimates from simulated data


θ
j1
θ
j2
the mle from the model are compared with the true values for each parameter. mses of the mles  are calculated from  <dig> simulation replicates.
comparison of estimated gene expression curves  with true curves  for three distinct groups from the simulated data.  absolute values of gene expression in two treatments.  relative differences between gene expression levels of two treatments.



we used k-means and som to analyze the same simulation data. overall, the skellam model performs better than som since the former correctly clusters all genes into their underlying groups whereas the latter provides incorrect clusters for about 20% of genes. like the skellam model, k-means can correctly discern three groups and clusters all genes into correct groups. the advantage of skellam over k-means lies in its capacity to provide biologically testable hypotheses  – , thus being of greater value from a biological perspective.

discussion
recently, rna-seq has become a highly popular technology for measurement of transcript levels in response to different environment conditions. here, we propose a statistical model to group rna-seq data in response to changing environmental conditions based on a skellam distribution. the skellam model is able to identify and cluster co-expression patterns of genes derived from different treatments. the same group of co-regulated genes responds to environmental change through a similar function; therefore, a set of model responses can be estimated and tested in a functional space. these can then be used to characterize the functional relationship between genes and the environment. the model has three features that differentiate it from traditional clustering methods. first, traditional methods cluster genes based on their expression at single points in time or their joint expression at multiple points in time  <cit> , ignoring the mechanism by which genes are differentially expressed in response to environmental conditions. by determining the differences in expression among treatments as the expression plasticity of a gene, the new model clusters genes into different groups based on their capacity to respond to environmental changes. this peculiarity makes the model particularly useful for understanding the changes in gene expression in response to different treatment conditions.

second, classical clustering approaches are based largely on continuous expression data measured by microarrays  <cit> , whereas gene reads measured by rna-seq are count data, which are believed to follow a poisson distribution  <cit> . our model has considered the poisson property of reads. third, the skellam model treats the co-expression of genes under different condition as a system and integrates their capacity to co-respond to environmental changes into clustering procedures. this treatment facilities our understanding of gene plasticity induced by environmental cues.

the skellam model has successfully clustered genes of early arabidopsis thaliana embryos into groups based on their response to different conditions. of the genes with a statistically significant change, group  <dig> is associated with adenosine triphosphate -involved atp synthase  <dig>  atp synthase subunit c family protein and atpase, f <dig> complex, alpha subunit protein  <cit> , and group  <dig> is related to arabinogalactan protein  <dig>  pathogenesis-related thaumatin-like protein, and ribonuclease  <dig>  <cit> . although both maternal and paternal genomes are active and contribute substantially to the embryonic transcriptome during the one-to-two-cell stage, some active gene sets are clearly derived from one parent.

we provided a general framework for gene clustering based on the poisson function. given a complex data with great variability in different treatments, i.e., overdispersion, the poisson distribution with one free parameter is too simple to allow for the variance to be adjusted independently of the mean for such a data. other more sophisticated distributions should be incorporated to provide a better flexibility of fit. these include negative binomial distribution as a natural extension of poisson distribution and generalized poisson distribution  <cit> . in general, clustering of genes with differential expression is not the final step of the analysis. other analyses, such as gene set testing, gene network construction and knowledge databases should follow. a comprehensive model of integrating gene clustering and these follow-up analyses should be derived, which would enable geneticists to extract biological insight from gene expression data.

we used the difference of gene expression as a measure of gene plasticity over different environments. this measure can characterize the amount of environment-induced response, but it cannot well discern the slope of differentiation expression, i.e., the sensitivity of a gene environmental change per its expression unit). such a slope can be described by the ratio of gene expression over different environments. in theory, the clustering model can be extended to cluster genes expressed under multiple conditions, and provides greater understanding of the mechanistic relationships between gene expression and environmental changes. the extended model allows for the classification of different trajectories of reaction norm in response to an environmental gradient. in addition, most studies of gene expression by rna-seq are performed in a static state, but the role of dynamic gene expression in constructing regulatory networks is being recognized  <cit> . to model dynamic changes in gene expression in response to environmental stimuli, more advanced statistical model such as longitudinal data analysis integrating the multivariate skellam distribution  <cit>  is required; this warrants further investigation.

CONCLUSIONS
as a deep-sequencing technique, rna-seq has proven to be powerful for precisely measuring levels of transcripts and their isoforms expressed under different conditions. we have developed a computational algorithm that clusters genes into distinct groups based on the differences of rna counts between different treatments. the algorithm is based on the poisson distribution of counts, making use of the skellam function that specifies the distribution of the differences between two independent poisson variables. a two-stage hierarchical em algorithm was implemented to estimate the optimal number of groups and mean expression levels of each group across two environments. in a comparison with traditional clustering approaches, such as k-means and self-organization mapping, the new skellam model has more biological relevance, equipped with a capacity to test whether a given group is responsive to environmental changes and how this plastic response is related with, or induced by, an environmental cue. the skellam model provides a useful tool for clustering gene expression data by rna-seq, thereby enhancing our understanding of gene functions and networks.

competing interests

the authors declare that they have no competing interests.

authors’ contributions

lj derived the model, performed simulation studies, conducted data analysis and wrote the manuscript. km interpreted results and participated in model derivation. rw conceived the model and wrote the manuscript. all authors read and approved the final manuscript.

this work is supported by special fund for forest scientific research in the public welfare , nsf/ios- <dig>  changjiang scholars award and “thousand-person plan” award.
