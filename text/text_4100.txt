BACKGROUND
chromatin immunoprecipitation  is widely used to discover in-vivo protein-bound or epigenetically modified dna regions, including binding sites for transcription factors  <cit>  and chromatin modification enzymes  <cit> . knowledge about these sites and interactions lays the foundation for investigating cellular processes in a variety of contexts, including processes that guide development and respond to stimuli. protocols for chip vary, but in general, after protein cross-linking and dna fragmentation, specific antibodies are used to selectively immunopurify protein-bound dna fragments, whose identity and abundance are then determined by quantitative pcr   <cit> , microarray hybridization  <cit>   or genome-wide sequencing  <cit>  .

chip-seq allows identification of bound dna sites anywhere in the genome and has thus become the method of choice for genome-wide profiling of protein binding sites. chip-seq is routinely used to screen for transcription factor  targets and binding sites, identifying tf targets that may be dysregulated by changes to tf expression and activity. despite its popularity, however, this method continues to pose unique data-analysis challenges, due to the significantly larger amount of generated data and technological bias. the assays used by this approach generally produce millions of dna fragment reads that were potentially bound to a protein of interest, as well as large amounts of background fragment reads that can contribute to false-positive target predictions. consequently, analysis methods find a balance between false-positive and false-negative error rates, where false-positive predictions need to be weeded out by additional assays and false-negatives may result in missed interactions that are informative about regulation in the screened cells.

typically, reads are first aligned to a reference genome, producing consensus regions with multiple matching fragment reads. these are used to produce genome occupancy histograms, whose peaks are then analyzed to evaluate their statistical significance, as the likelihood that they were produced by random chance events , based on relatively simple models for random fragment overlap, such as poisson processes. finally, the peak-calling process separates those dna regions that are likely to be bound by the specific protein, at a given statistical significance threshold, from those that are more likely to correspond to false positive events. a problem of most such approaches for null hypothesis evaluation is that they use global probabilistic models that may fail to fully account for both technical and biologically-motivated local fluctuations in binding probability.

peak-calling methods that compute false positive likelihood  by modeling chance dna fragment immunoprecipitation using a poisson process include macs  <cit> , useq  <cit> , quest  <cit> , and sissrs  <cit> . alternative null hypothesis evaluation methods have been proposed, including the use of a negative binomial distribution  <cit> , binomial distributions that are conditional on data from control experiments  <cit> , and hidden markov models  <cit> . all of these approaches adopt models that are uniformly computed across the genome, subsequently failing to identify many relevant binding regions  <cit> . peakfinder  <cit> , for instance, calculates peak significance using a genome-wide poisson distribution, thus discounting local bias.

to address some of these issues, macs  <cit> combines genome-wide and local models, by comparing candidate peaks to an a priori null-model background derived from genome-wide and local flanking regions, as well as from control experiments. in contrast to the approach taken by macs, we take advantage of control experiments, when available, to generate a fully unbiased, non-parametric model, where no peak magnitude distribution is assumed a priori. we then analyze whether such a model may be effective in identifying bona fide binding sites that are missed by peakfinder and macs, while maintaining high specificity.

the dip algorithm  evaluates candidate dna fragment consensus peaks using a nonparametric genome-wide approach, after conditioning on non-specific binding in control experiments. dip proceeds by first building a null distribution for non-specific immunoprecipitation based on control experiments to evaluate the statistical significance of candidate consensus peaks  based on the total number of dna fragments supporting their occupancy across both specific and non-specific  antibody assays . after partitioning the genome into overlapping same-length segments, dip first evaluates each segment relative to others with similar representation in the ip and control experiments, choosing a minimum magnitude for each amplitude ; note that the minimum magnitude is monotonically coupled with the desired fdr cutoff, i.e. choosing a higher minimum magnitude improves specificity at the expense of sensitivity, see methods for details. dip then joins neighboring segments with evidence for binding by the immunoprecipitated protein to produce contiguous target region predictions. we show that this intuitive scoring approach identifies sites that are missed by peakfinder and macs, without increasing false positive calls, thus comparing favorably with these algorithms both in terms of predictive power and cross-platform reproducibility. our results suggest that unbiased comparison against non-specific controls can help to significantly improve the accuracy of chip-seq analysis.

RESULTS
to evaluate dip's performance, we compared the binding sites inferred by dip, peakfinder, and macs using multiple chip-seq datasets. the performance assessment was done using multiple metrics, including enrichment of functional targets using silencing datasets, concordance of predictions obtained from other technologies and reproducibility/consistency in predictions using replicated datasets. for evaluation we used chip-seq data for notch <dig> in tall cells  <cit> , and nanog and sox <dig> in the germ-cell tumor cell line nt2/d <dig> <cit> , ets <dig> in jukart cells  <cit> and foxa <dig> in mcf <dig> cells  <cit> . to facilitate cross-platform comparison and functional validation, we restricted our analysis of gene-target predictions to sites within  <dig> kb from canonical transcription start sites.

predictions
we compared the number of predicted target genes for notch <dig>  nanog and sox <dig> chip-seq data according to dip, macs and peakfinder. for this comparison, we identified all the genes with predicted target regions within  <dig> kb of the tss. while dip and macs identified substantial number of target genes  for both nanog and sox <dig>  peakfinder identified very few target genes . also we found significant variability in number of identified targets by peakfinder, where the number of identified targets varied from under  <dig> to greater than  <dig> for notch <dig>  consequently, we removed peakfinder from further comparisons.

in general, dip predicted more target genes than macs and its predictions were assessed to be both more functionally relevant and reproducible across replicates and experimental technologies . namely, dip predicted more notch <dig>  nanog, sox <dig> and foxa <dig> targets, and its predicted targets were more likely to be down regulated  or no longer bound  after transcription factor  silencing. a comparison of predicted notch <dig>  nanog and sox <dig> target predictions using chip-chip and chip-seq suggests that dip predictions are more likely to be confirmed by chip-chip, and a comparison between ets <dig> chip-seq replicates suggests that dip prediction are more reproducible.

chip-seq peaks are enriched in silencing experiments
to check if dip- and macs-predicted target genes are indeed functionally regulated, we compared predictions from chip-seq  <cit>  with results from differential expression analysis following the rnai-mediated silencing of notch <dig>  nanog and sox <dig>  for these transcription factors, silencing experiments were performed using lentivirus-mediated shrna in tall and nt2/d <dig> cells followed by gene expression profiling. in addition, we compared dip- and macs-predicted foxa <dig> targets before and after sirna-mediated silencing of foxa <dig> in mcf <dig> cells  <cit> .

using a threshold of p-value ≤  <dig>   we identified genes that are differentially expressed upon silencing notch <dig>  nanog and sox <dig>  the overlap between these differentially expressed genes and target genes identified by dip was 34%, 26% and 16% of dip-predicted targets whereas overlap with macs-identified target genes was 30%, 17% and 13% of macs-predicted targets, respectively for notch <dig>  nanog, sox <dig>  suggesting higher sensitivity for dip-predicted target genes. this suggests that dip-predicted target genes are more likely to be functionally regulated by the three tfs.

we used macs and dip to infer foxa <dig> binding sites that are lost following its sirna-mediated silencing in mcf <dig> cells. dip predicted over  <dig>  targets in two replicate experiments and fewer than 30%  of these were retained after foxa <dig> silencing, while macs predicted fewer than  <dig>  targets and nearly 40% of them were retained after silencing ; see figure 2b. these results suggest that dip has greater sensitivity, as its predicted sites are consistently more dependent on foxa <dig> abundance.

concordance between chip-seq and chip-chip predictions
we studied the concordance between target genes predicated by chip-seq and chip-chip by considering how frequently chip-seq-predicted promoters were also predicted by chip-chip experiments. for this comparison we used notch <dig>  nanog, sox <dig> target promoters, predicted using × scores  <cit>  from chip-chip data with igg controls in both cases. we partitioned predictions from each method into two: those containing target genes uniquely predicted by each method and those containing common predictions. target genes identified by dip but not by macs  were more abundant and were in better concordance with chip-chip predicted target genes than targets identified by macs but not by dip , while common predictions outperformed predictions by individual methods for nanog, but not for sox2; see figure 2c. namely, dip-only included  <dig>   <dig> and  <dig> notch <dig>  nanog and sox <dig> targets, and 30%, 10% and 9% of its predictions were in concordance with chip-chip data; macs-only included  <dig>   <dig> and  <dig> targets for the three tfs, and only 27%, 6% and 6% of its predictions, respectively, were inferred from chip-chip data.

in order to evaluate the relative accuracy of dip and macs scoring methods, we ranked predicted target genes for both transcription factors using the highest scoring regions in their promoters. we then evaluated concordance with chip-chip predicted target genes by considering the overlap in top n predictions from chip-seq, where n is varied from  <dig> to all predictions. our results suggest that top n dip predicted-targets are in better agreement than top n macs predicted targets for notch <dig>  nanog and sox <dig>  when comparing both for the overlap with chip-chip; see figure 2d.

reproducibility across multiple replicates
to test the reproducibility of target genes identified by dip using replicate experiments, we used the ets <dig> chip-seq experiments  <cit>  containing  <dig> replicates of ips and  <dig> replicates of igg control assays. assessment of reproducibility was done using jaccard's similarity coefficient, which measures the ratio between sizes of the intersection and union of target promoters to compare predictions using the same ip and multiple iggs , or the same igg control for multiple ip assays . comparing predicted ets <dig> target promoters genes on  <dig> replicate ips and  <dig> replicate igg control assays, suggested that dip predictions are more consistent  across multiple replicates compared to macs predictions; jaccard's index was consistently at least 10% higher for dip predicted targets.

chip-seq peaks are enriched for canonical binding sites
to test if dip-predicted target regions for nanog and sox <dig> are more likely to contain canonical binding sites, we identified dna-binding position-specific scoring matrices for notch <dig>  nanog and sox <dig> from tranfac  <cit>  and jaspar  <cit> , as well as de novo motifs predicted by dme  <cit>  by using chip-seq data for nanog and sox <dig>  whose sites were enriched in peak regions predicted by macs. control regions, for each of both transcription factors, were chosen as those where igg binding was significantly high relative to the given ip according to macs; these are predicted to be binding-depleted regions.

the transfac motifs m <dig>  m <dig> and m <dig> were most enriched, according to a tenfold cross validation procedure, for macs-predicted notch <dig>  nanog and sox <dig> binding sites, respectively. to measure enrichment, we optimized the balanced error rate by maximizing the sum of the sensitivity and specificity of site prediction  <cit> . macs-predicted regions were enriched for motif sites even at the lowest ranks, and dip-predicted regions had the highest binding site frequency at top ranking regions. note that here, regions can be identified anywhere in the genome and are not restricted to promoters.

our results suggest that dip-predicted target regions for all three tfs are more likely to contain canonical binding sites . similarly, top scoring regions according to dip are more likely to contain canonical binding sites than low scoring regions. similar analysis using the most enriched ets <dig> motif  in the top  <dig> macs-predicted targets for ets <dig> dataset suggested comparable ets <dig> canonical binding site enrichment for both dip and macs target regions .

pcr validation of chip-seq predictions
we used chip, followed by pcr to test the occupancy of promoter regions that were predicted to bind to nanog and sox <dig> by dip and macs; see figure  <dig>  in total, we tested five and four promoters that were predicted to bind nanog and sox <dig>  respectively, by both dip and macs; six and seven promoters predicted to bind by dip but not macs, two and four promoters to bind by macs but not dip. as negative controls, we include results for the top scoring promoters by macs, two for each of nanog and sox <dig> binding, when controls were not used. in all cases, top predictions in each category were tested. we note that in each of the chip-seq experiments we studied, over one thousand promoters were predicted by macs to be targeted by each of nanog and sox <dig> only when controls were not used. we expect that the majority of these are false predictions.

the result of our assay shows that dip-predicted target-regions in promoters have high validation rates in nt2/d <dig> cells based on individual chip-pcr assays of  <dig> dip-predicted binding sites of the nanog and sox <dig> transcription factors, including  <dig> sites predicted by dip but not by macs. in addition, dip detected  <dig> of  <dig> and  <dig> out of  <dig> targets previously validated for nanog and sox <dig>  <cit> , respectively, while macs predictions included only  <dig> of  <dig> and  <dig> of  <dig> of these validated targets, respectively. taken together, dip and macs predicted  <dig> of  <dig>  and  <dig> of  <dig>  of the validated targets for nanog and sox <dig> reported by jagadish et. al.  <cit> , respectively.

CONCLUSIONS
we describe a non-parametric method for assigning significance to binding peaks identified from chip-seq data. its scoring approach is intuitive and fast: a single scan of the data is sufficient to identify genomic regions with potential for binding. then, these potential binding regions are used to score and annotate full region boundaries.

our tests suggest that dip identifies regions, and, consequently, target genes that are missed by macs, the leading peak caller for chip-seq. dip-predicted targets are more likely to have evidence for functional regulation as suggested by comparing chip-seq data with silencing experiments for notch <dig>  nanog and sox <dig>  and are in better agreement with both chip-chip and chip-pcr  predictions. moreover, dip-inferred tf-bound promoters are more enriched for canonical binding sites of the respective tfs. furthermore, dip-predicted ets <dig> binding sites are in better concordance with predictions derived from multiple replicate assays. interestingly, our results suggest that combining dip and macs predictions may identify regions with the strongest binding affinity . in total, dip predictions showed higher sensitivity, higher specificity, and higher reproducibility, based on replicate experiments, functional assays, and low-throughput validation.

the results of our assays support predictions by both dip and macs, but suggest that common dip- and macs-predicted promoters are more frequently bound by the two transcription factors tested, and that targets predicted by dip have stronger binding evidence than targets predicted by macs and not by dip. we believe that dip's main advantage is in the elimination of any reliance on parametric summaries of binding data. instead, dip adopts direct control, exclusively relying on experimental data to build its null distributions. in contrast, methods that rely on genome-wide summaries to make predictions are prawn to make both false-positive and false-negative calls in regions with greater and lower non-specific binding, respectively.

chip-seq is widely used as an initial screen to identify genes and pathways that are disrupted by changes in expression or activity of transcription factors. for this reason, it is important to reduce both false-positive and false-negative prediction rates. while high false-positive rates will make any technology more difficult to use, high-false negative rates can result in failure to identify key interactions. for example, dip, but not macs, predicted myc targeting by notch <dig> in tall cells; a regulatory interaction that is thought to play a key role in t cell acute lymphoblastic leukemia  <cit> . in fact, of  <dig> validated interactions presented in  <cit> , macs only predicted  <dig>  compared to dip's  <dig>  given the proliferation of chip-seq as a screening tool in both industry and academia, we believe that any improvement to its accuracy will help improve our understanding of cellular signaling in all contexts, including development and disease.

