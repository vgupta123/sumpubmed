BACKGROUND
toxicity screening is an essential step in drug development since safety concerns have been one of the main causes of bottlenecks before drug approval  <cit> . in vitro assays, such as high content screening  methods, have become an important tool for safety screening. hcs has been actively evaluated for use in drug discovery due to the advantages of being high-throughput and requiring less physical material for testing.

unlike conventional cytotoxicity assays, hcs offers the promise of understanding the biological functions underlying toxicity by simultaneously testing various cellular activities in live cells  <cit> . providing temporal and spatial measurements of relations within the cell, hcs has gained acceptance in the research community and it has been actively applied over the past decade for the assessment of drug toxicity and study of mechanisms  <cit> . this so-called systems cell biology has also generated positive effects in the drug discovery process  <cit> .

hcs has notable advantages over traditional cytotoxicity assays because it measures multiple cellular endpoints simultaneously so that it captures a more complete and dynamic picture of cellular response to an insult. we hypothesized that these endpoints together indicate the cell's condition under stress responding to a treatment in a probabilistic relationship. such a characteristic can not be accurately described by most of the common approaches such as clustering or pca and should be modeled with a bayesian relationship. unfortunately, most, if not all, post-experiment analysis often involves building discriminative models that use each read-out assay  as an independent feature. specifically, these data analyses treat individual endpoints as independent features rather than observing their interdependencies in a probabilistic relationship  <cit> . for example, o'brien et al. reported an hcs assay based on the hepg <dig> cell line and paired the hcs endpoints with the conventional in vitro cytotoxicity assay in a one-to-one comparison to assess the human hepatotoxicity of the tested drugs  <cit> . likewise, xu et al. generated eight cellular measurements in an hcs assay based on rat primary hepatocytes and employed a boolean logical or to indentify individual endpoints with high predictivity for clinical drug-induced liver injury  <cit> . as promising as these results are, this practice does not take full advantage of interdependencies among these cellular endpoints indicated by the systems biology of the cell.

in order to best use the multi-parameter measurements of live cells that hcs assays provide, a statistical analysis method must have the capability to extract hidden knowledge and relationships from these measurements. the best way to address this issue is to adapt a systems approach that would not only model relations between endpoints, but also link such a relationship to elucidate the cellular events leading to toxicity  <cit> . for this reason, we investigated a statistical model which attempts to both summarize cellular events reflected in the endpoints measured in a parallel fashion in hcs and establish a global understanding of their relations in the cell.

we used latent dirichlet allocation   <cit>  for topic modeling, which has primarily been applied to problems in text mining  <cit> , to analyze the data from the hcs assays. lda assumes that the expression of the hcs endpoints follow a probabilistic distribution and can be modeled by the mathematic expression of "topics" that consist of these endpoints. the topic model allows endpoints to be linked to multiple topics with different strength levels. similarly, it builds probabilistic associations between topics and drugs, which we treat as documents containing occurrences of endpoint measurements . thus, lda acts as more than a classification or clustering approach and instead aids in the interpretation of the topics.

in this work, we built a topic model using lda for rat primary hepatocyte-based hcs assays to investigate the relationship of the cellular level response to the drug treatment observed in this assay and the liver injury related necrosis observed in the whole animal  study. our study demonstrated the utility of topic modeling, including the innate properties of the assay, to interpret the hcs results and thus reach a better understanding of the toxic response. the results indicate that endpoints under significant topics corresponded to the cellular mechanisms involved in the progression of hepatocellular necrosis in vivo as well as recovery from liver injury. this proof-of-concept study demonstrates that topic modeling has the potential to model biological data beyond simply text documents to exploit the relationships of assay endpoints.

materials and methods
hcs assays
a set of compounds with a wide range of known mechanisms of action was chosen to test the range of detection of the mechanistic profiling assays applying the cellular systems biology  approach . eight endpoints, cell loss, nuclear size, dna damage, apoptosis, lysosomal mass, dna fragmentation, mitochondrial potential, and steatosis were measured simultaneously in populations of cultured rat primary hepatocytes at multiple time points to profile both the potency and specificity of the cellular toxicological responses  <cit> . briefly, rat primary hepatocytes were prepared using the method reported by berry et al.  <cit> . cell viability obtained from this method ranged from 85% to 95%. diluted test compound solutions were added to each well at identical final concentrations. the maximal concentration of treatment was  <dig> μm with 10-point titrations for each compound using a 2-fold dilution series and tested up to  <dig> hours. the final concentration of dmso in each well was 1% . for all assays, cells were analyzed using an arrayscan vti hcs reader in the high-resolution mode with a 10×/ <dig>  na objective and a  <dig>  × coupler.

in vivo data from animal experimental study
the necrosis data used in this study was obtained from the japanese toxicogenomics project . details regarding the animal study protocol are available elsewhere  <cit> . briefly, male sprague-dawley rats were purchased from charles river japan, inc. . the tgp selected a set of compounds to test. each group of animals was administered at low, middle and high doses with the concurrent control group. the maximum tolerated dose  of each compound was determined by one week dose range finding  study and set as the high dose. low and middle doses were 1/ <dig> and 1/ <dig> of high dose, respectively. animals were administered a single dose and then sacrificed at  <dig>   <dig>   <dig>  and  <dig> hours after dosing. liver samples were immediately collected from the left lateral lobe of the livers and processed through dehydration and embedded in paraffin block for slide preparation and observation of histopathology. histopathological changes were examined at four well recognized institutions in japan by certified pathologists. alterations of histology were described using the standard terminology unified by "the japan toxicology society of pathology" which can be found at .

data preprocessing
the hcs assays included  <dig> endpoints  that were observed for  <dig>   <dig>   <dig>  and  <dig> hours after treatment of  <dig> drugs . these endpoints were measured in two plates with dna damage, apoptosis, lysosome mass, and dna fragmentation at the first plate and mitochondrial potential and steatosis at the second plate, while cell loss and nuclear size were measured at both plates. in order to incorporate all the assay measurements into our model, we treated cell loss and nuclear size in the second plate as two different endpoints. this resulted in  <dig> endpoints in total. different dose levels were imposed which constituted a dose-response curve for each endpoint at the time of measure. we normalized each dose-response curve by its corresponding curve obtained through dimethyl sulfoxide  solvent . the normalization step was followed by quantifying these cellular responses where area under the dose-response curve  was calculated by using a numerical integration approach. subsequently, for each drug we produced a data table where every column represented a time point of an endpoint . including the replicated plates for cell loss and nuclear size,  <dig> auc values were obtained for each drug.

since the topic modeling approach assumes all the entries of data are generated by a multinomial distribution, continuous auc values were converted into integers  by a discretization method  <cit>  that uses a binning approach. entries from each column were divided into  <dig> bins and mapped to the corresponding integer. in this new numerical representation, each cell provided approximate information on the frequency of the corresponding column variable.

in order to observe the endpoint behavior over time, we changed the orientation of the data so that rows became the drug-hour combinations. therefore, number of columns shrank to number of endpoints which was  <dig> including the replicates. this perspective provided a temporal observation which could be exploited by topic modeling. in other words, each drug-hour stood for a document and values in the corresponding row quantified the number of occurrences of endpoints  in that document. the analogy we carried out here allowed us to use  <dig> endpoints as a vocabulary and construct different profiles  for every time step of each compound .

topic modeling
in this study, we used latent dirichlet allocation  as a topic modeling tool, which is an improved version of earlier models  <cit>  and allows multiple topic assignments  <cit> . lda assumes that every document is a mixture of different topics which govern the allocation of words across documents. the model formalizes this principle by posing a multinomial distribution of topics, z, over words, i.e., z~mult with parameter θ. to make the likelihood estimations computationally tractable, θ is assumed to follow a dirichlet distribution which is the conjugate prior of multinomial distribution. therefore a hyperparameter, α, is introduced and θ is sampled from dir. similarly, word distributions are also controlled by another multinomial distribution for given topics and parameters having dirichlet distribution which takes β as another hyperparameter. for a document which has n words, this generative process can be concisely presented as follows  <cit> :

 <dig>  choose θ ~ dir.

 <dig>  for each of the words wn where n∈{ <dig> …,n}

a. choose a topic zn ~ mult

b. choose a word wn from another multinomial distribution that is conditioned on the topic zn and a prior β. i.e., p

a distinguishing feature of lda is that it can assign an unseen document to discovered topics. furthermore, it provides interpretable conditional probability tables  for aforementioned associations such as document-topic ) and word-topic ). cpts not only give the mixture weights of topics for given documents, but also tell how likely it is that a word comes from a given topic.

diagnostic topic
cpts can be used to measure the document-topic associations. these probabilistic values can also be used to rank the most probable topics. however, there is a need to measure diagnostic topics  <cit>  for a class of documents instead of an individual treatment. griffiths and steyvers introduced this term to link a class of documents to their statistically significant topic or diagnostic  topic  <cit> . the methodology first requires calculation of the mean probabilities of each category for a given topic k. secondly, each class  mean for topic k, μck, is divided by the sum of all class means for topic k. if there are c categories, the following expression gives the significance score of topic k, for a class c.

  sck=μck∑c=1cμck 

finally, we have a cxk matrix in which rows are the scores for topics and we declare k* as the diagnostic topic for a group c if k*=argkmaxsck.

RESULTS
study design
one of the goals in toxicogenomics is to link in vitro findings with in vivo study in order to better understand the mechanisms underlying toxic insult. importantly, the concordance of the in vivo and in vitro results is a key indicator of potential to replace and reduce the animal uses in assessing risk of a broad range of medical and pharmaceutical products. implementation of the model on hcs data was followed by analyzing  <dig> compounds whose histopathological data and hca data available for this study, where the histopathological data was obtained from the tgp database while the hcs study was conducted by a commercial vendor . we split drugs into groups based on whether they caused necrosis at  <dig> or  <dig> hour after treatment. this split resulted in three groups:  <dig> drugs with no necrosis finding at either time point,  <dig> drugs showing necrosis at  <dig> hours, and  <dig> drugs showing necrosis at  <dig> hours . corresponding settings in table  <dig> were used to detect diagnostic topics, a concept which was originally developed for detecting topics that match with documents that share a commonality. similarly, we extend this notion to identifying topics to observe their agreement with necrosis vs. non-necrosis findings at either  <dig> or  <dig> hours. figure 1b illustrates how the settings below were incorporated with cpt ) of  <dig> common drugs.

in order to see whether the model can distinguish three groups , we set the number of topics equal to three for the vocabulary of  <dig> endpoints . next, using the implementation by blei et al.  <cit> , we developed the model for  <dig> drug-hour combinations . the resulting conditional probability tables  were used in three analyses: i) grouping and ranking endpoints within topics, ii) diagnostic topic identification, and iii) linking endpoints to cellular processes.

groupings and ranking of endpoints
the topics  not only grouped the endpoints based on their distribution across drugs, but also provided an importance measure with the probability scores of endpoints  for given topics, p. more specifically, p indicates which endpoints are more important for that particular topic. in table  <dig>  the endpoints for each topic are listed with the endpoints ordered based on the strength of the relation. notice that replicated endpoints are distinguished with indices in parentheses.

each topic contains a ranked list of  <dig> endpoints, but these can be separated into disjoint groups by comparing p values. namely, we compared three probabilities p, p, and p for each e and assigned it to the topic with the highest probability. in doing so, we identified groups of terms with the highest association to their topics and underlined them in table  <dig>  steatosis, dna fragmentation, mitochodrial potential, and lysosome mass were highly significant for topic  <dig>  similarly, dna damage and apoptosis were the most highly associated endpoint terms for topic  <dig>  the remaining terms, cell loss and nuclear size fell under topic  <dig> 

diagnostic topics for necrosis vs. non-necrosis
the identification of diagnostic topics requires at least binary class labels so that the score sck can be calculated. in this case, we used histopathological data for  <dig> drugs generated by the tgp database to establish the settings i, ii, and iii corresponding to temporal observation of necrosis and non-necrosis drugs. in each setting, necrosis observations determined two classes, i.e., necrosis vs. non-necrosis. plugging cpts ) generated by lda into eq.  <dig>  which also uses the class label, we obtained scores for each topic. in table  <dig>  we summarize all settings with their diagnostic topics. for instance, setting i consistently favors topic  <dig> because its score is always the greatest among the three topics. this implies that topic  <dig> is the diagnostic topic for drugs causing necrosis in rats at  <dig> hours. similarly, topic  <dig> appears to be the diagnostic topic for the drug group associated with necrosis at  <dig> hours in setting ii below. on the other hand, setting iii presents a clear cut design where the classes were defined for the drugs that were never involved in necrosis at  <dig> and  <dig> hours. for the 1st hour in the non-necrosis group, topic  <dig> gives the highest score. however, topic  <dig> becomes the diagnostic topic for these drugs, representing an agreement between in vivo and in vitro data for non-necrosis behavior at  <dig> and  <dig> hours. finally, topic  <dig> can be claimed as the representative topic for non-necrosis drugs.


in vitro


in vivo
6th hr. necrosis
24th hr. necrosis
non-necrosis drugs for 6th and 24th hrs
topics as bridging components
we assigned the endpoints to topics to form disjoint clusters and determined diagnostic topics to represent drug groups for different settings. in both analyses, we used topics as auxiliary variables. by means of topics, we further linked endpoint groups from hcs data to drug groups defined in the three necrosis conditions. we followed this process to demonstrate that topics could be also used to bridge in vitro hcs data and in vivo histopatholocal findings as illustrated in figure  <dig>  for instance, steatosis, dna fragmentation, mitochondrial potential, and lysosome mass are listed under topic  <dig>  which corresponds to 6th hour necrosis drugs from tgp. drugs with necrosis appearing in the 24th hour from the in vivo study are associated with topic  <dig>  which contains dna damage and apoptosis. lastly, topic  <dig> both indicates non-necrosis and consists of the remaining endpoints, cell loss and nuclear size. these links, finally, enable us to build transitive relationships between endpoints from the in vitro hcs data and necrosis findings in vivo.

discussion
hcs offers impressive throughput because of its parallel read outs for multiple endpoints. this approach has recently been favored as a new technology in cell systems biology  <cit>  and has been demonstrated in various applications. however, this approach can further benefit from an improved bioinformatics approach, considering the interdependencies of endpoints, which is an innate property of hcs. although methods like hca, pca, k-means, and som are commonly used to identify natural groupings of samples, topic modeling offers different aspect of results, which use conditional probabilities to highlight importance of any component we studied . furthermore, its probabilistic nature allows samples to be assigned to multiple clusters, even though we used these conditional probabilities to obtain mutually-exclusive endpoint clusters. a limitation of this methodology is the assumption that the data values are governed by a multinomial distribution which may not be fully appropriate for continuous data. since a continuous probability function in such a setting is not computationally tractable, biological data were often discretized in earlier studies  <cit> . similarly, we have demonstrated the application of latent dirichlet allocation  to hcs data.

as a proof-of-concept study, we introduced a methodology that is rooted in text mining, but by analogy could be efficiently carried out in the analysis of hcs data. similar to the fact that a text is a mixture of topics; the measurement of endpoints for a given drug can be considered as a consequence of multiple cellular interactions. thus, cellular responses to each compound at a particular time point were considered as a document for topic modeling. once we applied lda to the document-term representation for topic modeling, we obtained two probability measures in which topics played an intermediate role. that is to say, an ordered list of endpoints for given topics was generated along with topic probabilities of each drug.

in this study, topic-based probabilistic associations were interpreted in the context of necrosis findings observed by histopathological examinations from rats. in particular, necrosis was used as a criterion to determine the diagnostic topics, and drugs were categorized into those causing necrosis at  <dig> hours, causing necrosis at  <dig> hours, or not causing necrosis at either  <dig> or  <dig> hours. the purpose of this process was to match a group of cellular events caused by these groups of drugs to the progression of necrosis found in in vivo experiments. results demonstrated a one-to-one correspondence between diagnostic topics and groups of drugs with similar necrosis profiles.

acquisition of topics by lda has the advantage of associating each term  to multiple topics where they can be sorted based on probabilities. in other words, every topic consists of the same endpoints with different orders and endpoints are not forced to be assigned to a single cluster as it happens in k-means and hierarchical clustering methods. this is reasonable since none of the biological events occur independently rather in order by probabilistic significance. however, we split the endpoints into disjoint sets after showing their importance for given topics. for this reason, endpoints were assigned to their most probable topics regarding their rankings providing potentially important clues as to the cellular processes underlying a necrotic response to toxic agents. we illustrated how topics could link endpoints to a group of drugs in figure  <dig> where different cellular events might be related to histopathological observations. applying this methodology to the data here we observed the utility of the approach to interpreting hcs results.

topic  <dig> was assigned as the diagnostic topic for necrosis at  <dig> hours, and was associated with the endpoints steatosis, dna fragmentation, mitochondrial potential, and lysosome mass. changes in dna fragmentation are characteristic of necrotic cell death, where the presence of 5' overhangs are seen, and changes in lysosome mass and mitochondrial potential are consistent with the changes to cell ion permeability that eventually lead to cell rupture  <cit> . steatosis may either be evidence of the dysregulation of cellular transport or may itself be the cause of necrosis if large amounts of lipid distort the cell to the point of rupture  <cit> .

topic  <dig> was associated with dna damage and apoptosis, which were diagnostic for necrosis at  <dig> hours. the longer time after exposure reveals the difference between more and less rapid-acting compounds. these results are somewhat perplexing given the differing pathological mechanisms underlying necrosis and apoptosis, although they do share common features such as membrane potential dysregulation  <cit> . however, it may be possible that the initial round of necrosis leads to a round of apoptosis in the remaining cells due to changes in the extracellular environment or that the length of exposure necessary to initiate the apoptotic response in those conditions is longer than the six hour time point.

cell loss and nuclear size showed a highly significant connection with topic  <dig>  which was an indicator of non-necrosis drugs as shown in table  <dig>  this could be considered as a biological confirmation of less-toxic events and indication of hepatocyte regeneration. cell growth  and cell proliferation  are usually coordinated to ensure that cell size is properly maintained. hepatocytes are unique among differentiated parenchymal cells because they retain a stem cell-like ability to proliferate. this property remains in rat hepatocytes in primary culture and underlies the remarkable capacity of the liver to regenerate following acute injuries that diminish hepatic mass  <cit> . hepatocyte regeneration proceeds along a sequence of distinctive phases and requires priming of hepatocytes to achieve competence for proliferation, such as increasing synthesis of rna and proteins. thus, hepatocytes increase in size at the early stage of the cell cycle, and the change of nuclear size is proportional to the change of cellular size  <cit> . generally, the nucleus increases in size from the time of its formation  <cit> . in addition, it is reported that hypertrophy precedes proliferation in liver regeneration, suggesting that the first response to liver injury is an enlargement in hepatocyte size  <cit> .

all endpoints measured in the hcs assay here are essential for toxicity assessments. in that sense, besides an independent analysis or a pair-wise comparison, it is important to interpret how these events lead to toxicity. for this reason, we not only used lda to retrieve probabilistic associations of each endpoint to topics, but also incorporated a histopathological assessment of necrosis to test whether there is any biological meaning hidden behind these topics. for example, the drugs that caused necrosis in rats after  <dig> hours of treatment were also observed with significant changes of in vitro measurement in some pre-lethal endpoints including steatosis, dna fragmentation, mitochondrial potential and lysosome mass, while the drugs that caused necrosis after  <dig> hours were associated with the cellular events in dna damage and apoptosis. obviously, the former observation in the cellular assay seems to reveal more acute injury, while the latter one reflects the cell death that might correlate the necrosis in rats observed even after  <dig> hour treatment. in other words, our incorporation of in vivo histopathology data over time with data from hcs agreed with the conventional wisdom regarding the cause of toxic necrosis.

although they involve different practices and meanings, in vitro and in vivo data should be considered complements of each other. one of the goals here was to make use of these two data types to reveal biological facts. besides using a novel computational tool to analyze hcs, we provide an example of a way to efficiently bridge in vivo and in vitro data by means of topic. by using this intermediate variable, we were able to correlate histopathological findings with the results from the hcs assays. the ability of the model to discover patterns with an unsupervised nature indicates its potential to be an alternative approach for analyzing hcs data. hence, one direct application of this methodology for us is the early detection of drug-induced liver injury by interpreting the hcs content under probabilistic measures for drugs and endpoints. we intend to apply this method to predict the dili potential of drugs by not only considering a single endpoint, but relying on the full set of data generated by hcs.

CONCLUSIONS
we have presented here a systems approach that is capable of integration of multiple measurements from high content screening  by considering the interdependencies across endpoints. by analogy with text mining, endpoint distributions and proportions across topics were used to gain insight into the content of in vitro data. further, discovered relations were analyzed along with corresponding in vivo data. the results showed that latent dirichlet allocation  could improve the interpretation of hcs data for use in systems biology. the agreement we observed between in vitro and in vivo data through topics obtained by lda provide early evidence for the effectiveness of this strategy.

disclaimer
the findings and conclusions in this article have not been formally disseminated by the us food and drug administration  and should not be construed to represent the fda determination or policy.

competing interests
the authors declare that they have no competing interests.

authors' contributions
hb performed all calculations and data analysis, and wrote the first draft of the manuscript. wt and xx had the original idea, developed the methods, and guided the data analysis and presentation of results. mc, yw, rk, and hf contributed to the data analysis, verified the calculations, and assisted with writing the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
click here for file

 additional file 2
click here for file

 additional file 3
click here for file

 acknowledgements
hb is grateful to the national center for toxicological research  of u.s. food and drug administration  for post-doctoral support through the oak ridge institute for science and education .

declarations
publication costs of this article were funded by the us government.

this article has been published as part of bmc bioinformatics volume  <dig> supplement  <dig>  2013: proceedings of the tenth annual mcbios conference. discovery in a sea of data. the full contents of the supplement are available online at http://www.biomedcentral.com/bmcbioinformatics/supplements/14/s <dig> 
