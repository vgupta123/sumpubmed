BACKGROUND
systematic genome comparisons play an increasingly important role in genome analysis and annotation. there are mainly two kinds of approaches used for whole genome comparisons: whole proteome comparison studies and whole genomic sequence alignment studies. both approaches are powerful tools to study genome organization and evolution rules with different time scale considerations. these approaches have been employed with success in a recent study comparing the genome of yeast s. cerevisiae to three related yeast species genomes  <cit> . genomewide comparative analysis of the yeast chromosomes has considerably improved gene annotation and has permitted the prediction of new motifs conserved in intergenic regions that act potentially as regulatory elements of gene expression  <cit> .

whole genome-alignments tools have shown important developments in the last years. it is now possible to align rapidly two or more long genomic dna sequences with several tools like multipipmaker  <cit> , vista  <cit> , mummer  <cit>  and mga  <cit> . some of them include graphical interfaces to display and browse genome alignments  <cit> . other resources provide precomputed alignments for genome of related species, such as enterix or colibase for enterobacteria  <cit> .

here we focus on whole genomic sequence alignments in the particular case of strains of single bacterial species. since the publication of a second strain of helicobacter pylori in  <dig>  <cit> , sequence data on closely related bacterial genomes has rapidly accumulated in public databases. the availability of complete genome sequences for multiple strains of numerous species opens up new perspectives for studying short term evolutionary processes. for example pairwise alignment of the complete genomes of the enterohemorrhagic escherichia coli 0157:h <dig> strains  with the e. coli k- <dig> laboratory strain, allowed the definition of a  <dig>  mb sequence that was highly conserved between the two strains  <cit> . it was proposed that this common sequence corresponds to the conserved backbone of the e. coli chromosome, which is interrupted by numerous dna segments called strain-specific loops, distributed throughout the backbone  <cit> .

examination of "mosaic" structures of backbones and loops offers a potential approach to trace the dynamics of genome evolution at the bacterial species level. the backbone, conserved in all aligned genomes of the species, probably corresponds in large part to the common ancestral strain and is the part of the genome under vertical selective pressure. as such, the backbone is also likely to be the most adapted part of the genome, which could be relevant when studying essential functional elements of the cell . loops differ among strains. some may correspond to mobile elements, like prophage  <cit>  and insertion sequences  <cit> , and may be associated with strain-specific pathogenicity. however little is known about functional elements associated with small loops.

up to now, no systematic strategy for backbone/loop segmentation has been proposed for closely related bacterial genomes. the existing studies are either limited to pairwise comparisons or choose a reference genome which is compared to several related genomes. precomputed alignments are often limited to a subgroup of species and use different softwares and parameters, making results generally non-reproducible or non-comparable.

in this paper we address the problem of defining a strategy to obtain a backbone/loop segmentation of bacterial genomes at the intraspecies level. this approach is based on two recent genome aligners: mummer <dig>  <cit>  and mga  <cit> . using a validated benchmark dataset, we developed a simple treatment of alignment results which permits a robust definition of the mosaic structure. our approach does not take any genome as a reference and has no restriction for the number of genomes to align. we used our method to define this segmentation for  <dig> bacterial species. validated backbone/loop segmentation results are stored in the mosaic database and are freely accessible through a user friendly web interface. the backbone/loop segmentation determined using three e. coli genomes illustrates important properties of this structure, and indicates that intraspecies segmentation is a useful mean of enhancing bacterial genome annotation.

RESULTS
the global strategy of genome segmentation and database integration used in this study is outlined figure  <dig>  a reference set, consisting in a manually verified genome alignment, was used to set appropriate segmentation parameters. using this strategy, alignments and segmentations were performed systematically for  <dig> bacterial species, for which at least two genomes have been sequenced. loop and backbone coordinates were then integrated in the mosaic database together with ncbi genome annotations.

validation of segmentation parameters
the loop coordinates of the e. coli k- <dig> and o157:h <dig> sakai genomes validated by hayashi et al.  <cit>   were used as a basis to define an alignment strategy and to develop a treatment of alignment results adapted to bacterial backbone/loop segmentations. these strains are known to belong to distantly related e. coli lineages  <cit>  and their genomes are more distantly related between each other compared with genomes within other species  <cit> . parameters allowing a pertinent alignment of such different genomes were therefore expected to produce reliable results for more closely related strains. the k-12/sakai comparisons were performed using different parameters of the mga software, and those leading to the best results, as compared to coordinates obtained by hayashi et al., were chosen. this set was used to produce alignments for all species so that results may be compared.

mga software provides three types of results: matches , aligned gaps  and unaligned gaps. matches were computed using an iterative process on mem size: mem of at least  <dig> bp were used for the first mga step and mem of at least  <dig> bp were computed in the second recursive step. these two kinds of mem were included into the backbone of the segmented genomes. the gaps were then treated as follows : gaps longer than  <dig> bp  were considered as loops, and gaps shorter than  <dig> bp were aligned with clustalw. aligned gaps with more than  <dig> % identity were considered as backbone, others, as loops. minimal size of loops and backbone segments was set to  <dig> nucleotides each. this strategy generated a backbone/loop profile of the k-12/sakai alignment that differed by around  <dig> nt  from that validated by hayashi et al.  <cit> .

genome selection for the backbone/loop segmentation
in order to select a subset of genomes for which backbone/loop segmentation makes sense, an analysis using the mummer package was performed . three categories of results we obtained. the first category includes  <dig> genomes for which mga alignments and backbone/loop segmentations are feasible, as they have not been submitted to numerous and important rearrangements. the second category includes genomes that can be aligned after minor correction of their sequences . this second category concerns  <dig> genomes . the last category corresponds to  <dig> genomes belonging to  <dig> species: neisseria meningitis, prochlorococcus marinus, salmonella enterica, shigella flexneri, streptococcus pyogenes, tropheryma whipplei, xylella fastidiosa and yersinia pestis. these genomes were excluded because mummerplot results revealed rearrangements covering a large part of the genome.

genome alignments and backbone/loop segmentation
twenty four genome alignments were generated and treated for backbone/loop segmentation using mga and our defined set of parameters. these included two quadruple alignments , four triple alignments  and eigthteen pairwise alignments. for one species, buchnera aphidicola, segmentation results were not exploited due to too low coverage .

validated segmentation results including backbone size, loop size, loop number and genome coverage are described in table  <dig>  the coverage ranged from  <dig> % for e. coli quadruple alignment to  <dig> % for c. pneumoniae strains. species comparisons giving high coverage values may be a consequence of to the choice of closely related strains for sequencing, but may also indicate that overall horizontal transfer is less important in some species than in others.

the number of loops in a segmented genome appeared to be also highly variable among bacterial species, ranging from  <dig>  to  <dig> . results of table  <dig> revealed two extremes situations. some species have few very long loops, as agrobacterium tumefaciens . others  contain a large number of short loops . these differences will need to be further examined in details, in relation with genome annotations.

database integration and web interface
alignments were integrated into the mosaic database and are accessible through the web interface. access to the mosaic structure of genomes is made by species selection or gene name selection. for each segmented genome, a local view of the physical map of the segmented genome is available, using mugen software  <cit>  . this graphical visualization of loop and backbone structures is associated with genbank/ncbi genome annotations. in addition, an overall graphical view of backbone and loops structure is presented using emboss cirdna program. finally, lists of loop and backbone segments can also be inspected and downloaded according to different criteria like size, genome position or functional characterization.

in depth analysis of the backbone/loop structure of three e. coli genomes
a more precise analysis of the segmentation results from the comparison of e. coli strains k- <dig>  <cit> , o157:h <dig> sakai  <cit>   and cft <dig>  <cit>   was performed. a  <dig>  mb length backbone  and three sets of strain-specific loops  were identified. the k- <dig> genome included  <dig> k- <dig> loops , the sakai genome,  <dig> sakai loops  and the cft genome,  <dig> cft loops . the differences in total loop sizes are in keeping with the different total genome size of the three strains .

a large proportion of short loops in the e. coli genome
basic statistics concerning the size distribution of the three loop sets are described in table  <dig> and figure  <dig>  results of table  <dig> show a remarkable number of short loops for the three species: three quarters of the k- <dig> loops are shorter than  <dig> nucleotides . the histogram of loop size distribution for the three e. coli strains  reveals that the loop population is heterogeneous. interestingly it appears that the loop populations exhibit roughly the same profile in the three strains, which may comprise three sub-populations: numerous very short loops , medium-size loops  and a few very long loops . this may reflect a wide diversity of functional properties conferred by loops: the longer loops probably encode several genes . the shorter ones might have regulatory roles or affect gene expression.

functional elements associated with backbone and loops
the distribution of functional elements in the backbone/loop structure was analyzed. functions identified by classical annotations of bacterial genomes i.e. genes, trna, rrna, phages and insertion sequences  were first considered. as expected trna and rrna were mainly present in the backbone. one exception concerns a rather large proportion of trna present in the sakai loops  compared to k- <dig>  and cft  loops. the sakai strain contains  <dig> specific trnas not present in k- <dig>  <cit> , hayashi et al. observed that these trnas recognize codons which are used with an increased frequency in sakai loops. not surprisingly, we observed that phages and is are quasi-totally included in loops . the ten longest loops of k- <dig> correspond systematically to known phages, or phage remnants of the e. coli genome.

one hundred e. coli k- <dig> loops are associated with bime
to refine functional categorization of smaller loops we examined the correspondence between loops and bacterial interpersed mosaic element . bime are short palindromic repetitive dna elements found in the genomes of e. coli and other enterobacteria  <cit> , and are present exclusively in intergenic regions. bime are composed of three types of palindromic units . three sub-families of bime have been described: bime- <dig>  which are composed of one y and one z1; bime- <dig>  which contain two to twelve y and z2; and a third category , which refers to all other palindromic units associations. bime sizes range from  <dig> bp for bime- <dig> to several kb for bime- <dig> or atypical bime. bime are reported to have several functions: mrna stabilization, transcription termination, translational control and genomic rearrangements  <cit> . using the mosaic database we identified  <dig> loops associated with bime. bime coordinates were obtained from the "short repeated palindromes in enterobacteria" web site  <cit> . they are distributed as follows: in  <dig> cases, a bime was present within the loop. in  <dig> cases, the bime covered the entire loop region and extended into flanking backbone sequences. in  <dig> cases, the bime accounted for more than 50% of the loop length and extended over to one side of the backbone. results concerning bime distribution in backbone and loops on the k- <dig> genome  clearly indicate that loops are enriched in bime elements: in particular 2/ <dig> of the dna regions associated to bime are located on the loops. this tendency is particularly striking for bime- <dig>  for which  <dig> % of the cumulated length is associated with loops. interestingly, bime- <dig> are quasi equally distributed between backbone and loops. this result is a generalization to all k- <dig> bimes of a result observed in a previous work  <cit> . pcr analysis of  <dig> bime- <dig> and  <dig> bime- <dig> loci in  <dig> e. coli and shigella isolates showed that bime- <dig> are either present or absent among isolates whereas bime- <dig> are generally present in the same set of isolates but exhibit a high level of length polymorphism  <cit> . figure  <dig> illustrates two examples of loops associated with bime- <dig> and bime- <dig>  as visible with mugen through the mosaic web interface. this association of loops with bime is a first clue in characterizing the functionality of short loops in e. coli strains.

discussion
backbone/loop segmentation as a step towers analysis of genome evolution
studying backbone and loops of bacterial genomes is an efficient way to distinguish the two major modes of evolution acting on bacterial genomes. the backbone may be considered as the part of the genome susceptible to vertical long-term evolution. backbones are very similar for closely related strains and variability comes mainly from punctual mutations or insertions/deletions of oligonucleotides. the loop population  is more heterogeneous : the number of loops and the average loops length varies greatly from one species to another . loops can be viewed as elements issued from short-term evolution processes. one such process is horizontal transfer. for example acquisition/loss of distinct prophage sets seems to be a rapid process, which can be observed between closely related strains  <cit> . significantly, for some genomes, phages are the major contributors to loop length  <cit> . eleven loops of e. coli k- <dig> are associated with phages and constitute  <dig> % of the total e. coli k- <dig> loop length. a contrasting example is found in h. pylori: this species does not contain prophage, although it contains large loops that may be associated with pathogenicity islands  <cit> . our results indicate that medium-size loops  are constituted, at least in part, from known variable elements of bacterial genomes like insertion sequences. the relatively large number of short loops found in some species  is quite surprising. such small loops may be due to replication errors , which can generate small insertions or deletions  <cit>  or may correspond to highly polymorphic regions. as opposed to large or medium size loops it is likely that these shorter loops arose from non-horizontal transfer events.

consequences of segmentation from multiple alignments
alignments including more than two genomes generally yield a more robust but smaller backbone than pairwise alignments. this is due to the fact that a larger set of genome variations is taken into account. in the future, about ten or more genomes will be available for some species. one possible consequence is that the backbone length will shrink steadily with new strain genomes. in that case, the backbone may rather be redefined as, for example, the subset of chromosomal regions present in at least half of the strains. alternatively, the backbone size may decrease but rapidly reach a minimal size, which will be stable even when new strain genomes will be added for alignment.

as a consequence of multiple comparisons, loop populations are greater and more heterogeneous. they include for example elements present in only one genome , elements present in a subset of strains or elements present in all genomes but one . it will be important to systematically classify loops obtained from multiple comparisons in order to facilitate their identification through the mosaic interface.

to estimate the importance of loops corresponding to dna present in the common ancestor but lost in one of the compared strains a preliminary study was performed: all sequences present in the k- <dig> loops  were blasted against the salmonella typhimurium genome , and matching sequences present in the same genome environment were considered as "ancestral loops". ten loops, corresponding to a total length of  <dig> bp, matched this criterium. this suggests that only a minor subset of the loops correspond to deletions that occurred in either e. coli sakai or cft genomes.

backbone/loops segmentation for divergent or rearranged genomes
some genomes of species like buchnera aphidicola were too divergent to be segmented with our procedure. in fact, these genomes are clearly atypical in terms of evolutionary distance within a species: despite complete colinearity of their genomes, b. aphidicola sg and ap genomes display a high degree of divergence at the nucleotide level, making them as different as e. coli/s. typhimurium genomes  <cit> . comparison of sg and ap genomes is thus almost the same situation as comparing different species, but would be possible by adapting the alignment parameters. this raises the question of bacterial species definition: the evolutionary distances within a species and between species are very heterogeneous. for example, it has recently been confirmed that shigella is phylogenetically indistinguishable from e. coli  <cit> . our method will also be easily extended to bacterial species where numerous chromosomal rearrangements have occurred, using recently developed genome aligners such as mauve  <cit> . intra-species comparison of divergent and/or rearranged genomes will open the way to segmentation of genomes from different, but closely related species.

a new category of genome annotation
to our knowledge, this work is the first study allowing systematic mosaic genome segmentation of all available strains  in  <dig> bacterial species. examination of the backbone of a bacterial species should greatly facilitate refinement of gene annotation and prediction of conserved sites with potential regulatory roles. examination of the gene content in loops is important for identification of putative horizontally transferred genes. genes adapted to specific ecological environments or involved in pathogenicity of a specific strain should also be found in the strain-specific loops. indeed, the asap database   <cit>  recently added the features type 'island' and 'conserved_segments' in order to provide lists of regions that are specific or common to the two e. coli k- <dig> and o157:h <dig> genomes.

CONCLUSIONS
genome aligners were used to build a robust strategy for bacterial genome segmentation. backbone/loops structures were systematically determined for  <dig> bacterial genomes. the mosaic resource makes it easy to visualize, annotate, and analyse loops and backbone segments of these genomes. first analyses reveal a surprising diversity in the number of loops from one species to another. in addition some species accumulate a large number of short loops, unsuspected previously.

