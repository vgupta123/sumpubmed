BACKGROUND
alpha-helical transmembrane  proteins constitute roughly 30% of a typical genome and are involved in a wide variety of important biological processes including cell signaling, transport of membrane-impermeable molecules and cell recognition. however, due to the experimental difficulties involved in obtaining high quality crystals, this class of protein is severely under represented in structural databases, making up only  <dig> % of known structures in the pdb  <cit> . given the biological and pharmacological importance of tm proteins, an understanding of their topology – the total number of tm helices, their boundaries and in/out orientation relative to the membrane – is essential for structural and functional analysis, and directing further experimental work. in the absence of structural data, sequence-based prediction methods allow tm protein topology to be investigated.

early prediction methods, based on the physicochemical principle of a sliding window of hydrophobicity combined with the 'positive-inside' rule  <cit> , have been superseded by machine learning approaches which prevail due to their statistical formulation. these include hidden markov models , neural networks  and more recently, support vector machines . while nns and hmms are capable of producing multiple outputs, svms are predominantly binary classifiers therefore multiple svms must be employed to classify the numerous residue preferences before being combined into a probabilistic framework. like nns and hmms, svms are capable of learning complex relationships among the amino acids within a given window with which they are trained, particularly when provided with evolutionary information. however, they are considered more resilient to the problem of over-training compared to other machine learning methods.

one problem faced by modern topology predictors is the discrimination between tm helices and other features composed largely of hydrophobic residues. these include targeting motifs such as signal peptides and signal anchors, amphipathic helices, and re-entrant helices – membrane penetrating helices that enter and exit the membrane on the same side, common in many ion channel families. the high similarity between such features and the hydrophobic profile of a tm helix frequently leads to crosstalk between the different types of predictions. should these elements be predicted as tm helices, the ensuing topology prediction is likely to be corrupted. some prediction methods, such as signalp  <cit>  and targetp  <cit> , are effective in identifying signal peptides, and may be used as a pre-filter prior to analysis using a tm topology predictor. phobius  <cit>  uses a hmm to successfully address the problem of signal peptides in tm protein topology prediction, while polyphobius  <cit>  further increases accuracy by including homology information. other methods such as tmloop  <cit> , top-mod  <cit>  and octopus  <cit>  have attempted to identify re-entrant regions, the latter two in combination with a tm topology predictor, but there is significant room for improvement.

tm topology predictors also exist that are able to use experimentally derived information in order to guide topology prediction. with reliable experimental data, prediction accuracy is likely to benefit substantially. methods include hmm-tm  <cit> , hmmtop  <cit>  and tmhmmfix  <cit> . tools such as sosui  <cit>  and pred-class  <cit>  are designed to discriminate between globular and tm proteins, while others such as pred-tmbb  <cit>  specialise in the discrimination and prediction of beta-barrel tm proteins.

a key element when constructing any prediction method is the use of a high quality data set for both training and validation purposes. previously described tm data sets such as the möller set  <cit>  have contained relatively few sequences with structures available , but substantially more with tm region annotation based on varying types of biochemical characterisation . a number of experimental methods, including glycosylation analysis, insertion tags, antibody studies and fusion protein constructs, allow the topological location of a region to be identified. however, such studies are often conflicting  <cit>  and also risk upsetting the natural topology by altering the protein sequence. as a result, orientation and helix boundary errors in databases are not infrequent and add an element of noise. while such noise is often well tolerated by machine learning methods, the problem is more significant in smaller data sets. with a view to unifying, updating and verifying existing resources while minimising topological error, a new tm data set has been created containing protein sequences with topologies derived solely from crystal structures.

we thus present a new tm topology predictor trained and benchmarked with full cross-validation on a novel data set of  <dig> sequences with crystal structures. the method uses evolutionary information and four svms, combining the outputs using a dynamic programming algorithm, to return a list of predicted topologies ranked by overall likelihood, and incorporates signal peptide and re-entrant helix prediction. overall, the method predicted the correct topology and location of tm helices for 89% of the test set, a significant improvement on our previous nn-based method memsat <dig>  <cit> . an additional svm has been trained to discriminate between tm and globular proteins with zero false positives and a low false negative rate of  <dig> %, making this method highly suitable for whole genome analysis.

RESULTS
support vector machine performance
column 2: window size – the size of the sliding window in residues. column 3: kernel – svm kernel type. rbf = radial basis function. column 4: mcc – matthews correlation coefficient. * the inside loop/outside loop svm was trained using a third-order polynomial kernel.

the inside loop/outside loop svm was the only svm to perform optimally using a polynomial kernel, which justifies our use of multiple svms to classify each of the residue preferences rather than a single multiclass ranking svm. the highest mcc value we could achieve using a radial basis function  kernel for this svm was  <dig> , significantly lower than the value of  <dig>  achieved using a third-order polynomial kernel, therefore demonstrating that no single kernel function is capable of optimally separating all the data classes and suggesting the structure of loop data is strongly favoured by this kernel.

detection of re-entrant helices remains challenging compared to other regions, with lack of training data a significant issue. despite the addition of  <dig> proteins to the training set, all were homologous to one of the original  <dig> re-entrant helix-containing proteins and were therefore removed from the respective training files. their contribution was therefore reflected by a low false positive rate of  <dig> , but a low true positive rate of  <dig>  owing to the lack of positive training examples.

in contrast, the signal peptide/¬signal peptide and tm protein/globular protein svm performance was close to that of the tm helix/¬tm helix svm, aided by sufficient quantities of training data. while largely driven by hydrophobicity, the signal peptide/¬signal peptide svm must accurately discriminate between signal peptides, which contain a 7– <dig> residue long hydrophobic helix, and an equally hydrophobic but slightly longer tm helix. for all signal peptide-containing proteins, the residues ranked highest by the svm appear to be close to the c-terminal end of the signal peptide region, suggesting the svm is efficiently detecting the polar and uncharged 3– <dig> amino acid residue long c-region and the neutral residues that lie adjacent to the cleavage point  <cit> . similarly, the tm protein/globular protein svm must discriminate between hydrophobic residues that compose tm helices and those that form the core of globular proteins, a challenge reflected by the difference in mcc compared to the tm helix/¬tm helix svm.

overall topology prediction accuracy
column 1: method – prediction method. column 2: algorithm – underlying machine-learning algorithm. column 3: correct helix count – fraction of sequences with the correct number of tm helices predicted. column 4: correct helix locations – fraction of sequences with the correct number and locations of tm helices predicted. column 5: correct n-terminal – fraction of sequences with the correct n-terminal location predicted. column 6: fp helix – fraction of sequences with at least one over predicted tm helix. column 7: fn helix – fraction of sequences with at least one under predicted tm helix. column 8: correct sp topology: fraction of sequences that contain signal peptides that have correct overall topology predicted. column 9: correct re topology: fraction of sequences that contain re-entrant helices that have correct overall topology predicted. column 10: correct topology: fraction of sequences that have correct overall topology predicted, requiring the correct number and location of tm helices and correct location of the n-terminal. tm helices must overlap their defined positions by at least  <dig> residues.

to assess overall topology prediction accuracy, correct prediction of  <dig> components were required: the n-terminal location, number of tm helices and tm helix locations, based on an overlap of at least  <dig> residues with boundary definitions. correct signal peptide and re-entrant helix predictions were not required for a correct overall topology prediction, though failure to predict these features was likely to result in an incorrect topology. based on this definition, memsat-svm correctly predicts topology in 89%  of cases, a 10% improvement on octopus which predicted 79%  of cases correctly . using a more stringent criterion of a 10-residue helix overlap, the margin increases to 11% , suggesting good segment end point prediction. in terms of the  <dig> individual components, memsat-svm is consistently better than all other methods , and in particular performs well at predicting the correct number of tm helices . memsat-svm also had a balanced number of over- and under predictions  which is favourable to avoid bias towards either type of prediction, and suggests good sensitivity while avoiding over predicting helices. since this work was completed, an extension to the octopus method which incorporates signal peptide prediction, spoctopus  <cit> , has been released. this method achieved 87% accuracy on the test set, largely addressing the poor performance of octopus on sequences containing signal peptides .

signal peptide and re-entrant helix prediction
memsat-svm correctly predicts the topology of 93%  of proteins which contain signal peptides, a substantial improvement on the limited signal peptide prediction capability of our previous method memsat <dig>  in all  <dig> cases, signal peptides were also predicted. this accuracy is matched by phobius, the only other method that is specially trained to identify signal peptides in tm proteins. amongst proteins that did not contain signal peptides, no false positive signal peptides were predicted. proteins containing re-entrant helices proved much harder to predict, with only 64%  correctly predicted. this is matched by memsat <dig> and hmmtop, though is slightly lower than the 73%  accuracy achieved by octopus. however, this additional correct prediction could well be attributed to the overlap between the test and training sets, as, in the absence of cross-validation, memsat-svm is able to predict 82%  topologies correctly. in terms of predicting re-entrant helices, memsat-svm identifies 44%  with  <dig> false positive predictions, which compares favourably with octopus results of 22%  with  <dig> false positives. since the numbers of proteins containing re-entrant helices and signal peptides are relatively small , care should be taken when interpreting these results as a relatively large percentage difference in performance may only reflect the correct prediction of one additional sequence.

erroneous predictions
memsat-svm incorrectly predicts topologies in  <dig> cases. four of these correspond to proteins containing re-entrant helices that are erroneously predicted as tm helices – abc transporter btucd, proton glutamate symport protein, aquaporin z and clc chloride channel  – accounting for the majority of over predicted tm helices. the remaining over prediction is due to a highly hydrophobic n-terminal region within a chain from cytochrome bc <dig> .

in seven cases, incorrect topologies are a result of under predicted tm helices – photosystem i , steryl-sulfatase, light-harvesting complex ii, particulate methane monooxygenase and sodium/proton antiporter  <dig> . these under predictions fall into two categories; weakly predicted helices  or prediction of one helix rather than two shorter ones . of the weakly predicted helix errors, sequence analysis indicates low hydrophobicity for many of these helices, often due to a large fraction of charged residues. such helices are therefore extremely difficult to predict and suggest a novel membrane insertion mechanism. other helices appear sufficiently hydrophobic to be detected; errors are possibly the results of psi-blast alignment which reduce their detectability.

the remaining three incorrect predictions are all single tm helix proteins that are inverted – photosystem i, cytochrome bc <dig> and cytochrome b6f . in all three cases, the confidence of the prediction compared to the correct topology  is extremely small. with no clear signal to differentiate between either orientation, interplay with other chains from the same protein may influence the final conformation.

prediction accuracy using the möller and topdb data sets
we additionally tested prediction performance using a subset of  <dig> sequences from the möller set, described in  <cit> , composed of sequences annotated using both crystal structures and biochemical characterisation . the möller set consists of a significantly higher fraction of eukaryotic sequences compared to the data set described above. tm protein crystallisation techniques usually involve over expression hosts, such as escherichia coli, which to date have worked mainly for prokaryotic tm proteins since eukaryotic tm proteins are still very difficult to over express  <cit> . crystal structure-based sets, while providing more accurate tm helix boundary definitions, thus suffer from this bias towards prokaryotic sequences, so methods trained exclusively using such data sets run the risk of performing poorly when predicting the topologies of eukaryotic sequences. based on recent updates to swiss-prot annotations and under full cross-validation, memsat-svm achieved 78% accuracy and memsat <dig> achieved 77%. in the absence of cross-validation, spoctopus also achieved 77% accuracy, with octopus the next best method scoring 69%. this performance suggests memsat-svm offers robust prediction accuracy on proteins from both eukaryotic and prokaryotic domains.

column 1: prediction method. column 2: results using the möller data set. column 3: results using the topdb data set.

we then tested performance using the topdb  <cit>  data set, a comprehensive collection of tm protein containing experimentally derived topology information . it currently contains records for  <dig> alpha-helical tm proteins. using this data set, memsat-svm achieved 67% accuracy, memsat <dig> 66%, octopus 64% and phobius 62%. the data set also contains  <dig> sequences containing signal peptides. of these, memsat-svm correctly predicted the topologies for 77% of cases. this value was lower than that of phobius which achieved 85% accuracy. however, the memsat-svm false positive rate for signal peptide prediction is 7%, half the phobius value of 14%. these results show that on this data set, memsat-svm signal peptide performance is below that of phobius, though memsat-svm overall prediction accuracy is 5% higher due to the relatively poor performance of phobius on sequences that do not contain signal peptides  – 54% accuracy compared to 63% for memsat-svm. these results should again be treated with caution as they were not cross-validated.

these results are clearly lower than those attained using the crystal structure-based data set, and we believe this is likely due to errors in topdb. we analysed sequences from the original, uncorrected möller set that at the time did not have crystal structures.  <dig> of these sequences now have a homologous pdb structure , and of these only  <dig>  of the original möller topologies are correct based on current opm definitions . there is no reason to believe that the error rate in other data sets such as topdb, composed predominantly of sequences whose topologies were determined by biochemical means, should be significantly different. perfect prediction methods are therefore unlikely to be able to achieve results higher than this, while older methods trained on erroneous topologies have the potential to achieve higher scores but may in reality be poorer predictors, a fact likely to be highlighted when tested against a crystal structure-based set.

discriminating between globular and transmembrane proteins
using the combined set of  <dig> test cases, we assessed performance in discriminating between globular and tm proteins . as a discrimination threshold, a number of residues were required to be predicted as part of a tm helix by the svm in order to classify the protein as tm. this threshold was adjusted in order to minimise the margin between the false positive  and false negative  rates, therefore avoiding bias towards either type of prediction. a 0% fp rate and  <dig> % fn rate was achieved using only a single residue as the threshold, an improvement on the memsat <dig> neural network-based approach  and sosui . octopus matched the fp rate but achieved a higher fn rate, while phobius matched the fn rate but achieved a higher fp rate. these low error rates suggest that memsat-svm is extremely well suited to whole genome analysis.

application to a number of complete genomes
we then carried out full topology prediction on sequences predicted to be tm proteins and analysed these for the presence of re-entrant helices and signal peptides. in most species, re-entrant helices were detected in at least 2% of tm proteins, with more than 3% detected in takifugu rubripes which can be explained by the extensive channel heterogeneity discussed above. however, given the low true positive rate of 44%, this figure is likely to be an underestimate. a positive predictive value  of  <dig>  suggests a value in the range 3– <dig> % is more realistic. this range is close to one previous estimate of 5%  <cit>  but below another of 10%  <cit> , although the latter was based on a broader definition of re-entrant regions that did not necessarily contain helical secondary structure.

topology prediction results illustrate consistent trends across all species, with significant peaks at  <dig> tm helices representing gpcrs  and  <dig> tm helices representing transporters proteins . a slight preference for even-numbered topologies  can be explained by the formation of  <dig> helix hairpins as independent units during protein assembly, therefore favouring topologies with even numbers of tm helices  <cit> . in all species, the most dominant topology is a single tm helix. these results are consistent with previous studies  <cit> .

CONCLUSIONS
in this paper we have implemented a novel svm-based tm protein topology predictor, an area previously dominated by hmm and nn-based machine learning approaches, and have shown that it outperforms a selection of the best performing prediction methods when fully cross-validated on a novel high resolution data set of  <dig> protein sequences. this data set includes proteins containing both re-entrant helices and signal peptides, features that this method is also able to predict. the method has also been benchmarked on the möller data set, which contains a higher fraction of eukaryotic sequences, improving on the best current methods. and we have achieved extremely low false positive and false negative rates for tm/globular protein discrimination. using these tools, we have estimated the fraction of tm proteins, re-entrant helices and signal peptides in a number of complete genomes. overall, our results suggest that memsat-svm is ideally suited to whole genome annotation of alpha-helical tm proteins.

