BACKGROUND
liquid chromatography coupled with tandem mass spectrometry  has become one of the most used tools in mass spectrometry based proteomics  <cit> . in shotgun proteomics, peptides are separated using liquid chromatography and introduced into a mass spectrometer via an ionization interface. in tandem mass spectrometry, the peptide precursor ions are isolated and fragmented via collision-induced dissociation   <cit>  with inert gas, electron capture dissociation   <cit> , surface induced dissociation   <cit>  and/or electron transfer dissociation   <cit> . the resulting tandem ms spectra contain product ion signatures that relate back to the identity of the peptide precursor ions  <cit> .

various algorithms have since been developed to automate the process for modern high-throughput lc-ms/ms experiments. these algorithms fall under two categories: de novo sequence inference and database searching  <cit> . the first approach identifies peptide sequences directly from the tandem ms data  <cit> . this type of algorithm is usually computationally expensive and limited by the mass accuracy of the tandem ms data  <cit> . the database searching algorithms identify peptides by comparison with a protein sequence database  <cit> . in this approach, all potential peptides are created from the sequence database via digestion with proteases. theoretical spectra containing product ion series appropriate for the given fragmentation technique are created for the peptides. all tandem ms spectra in the data set are then compared with the theoretical spectra  <cit> . because of their relatively lower computation expense and higher compatibility with low mass accuracy spectra, database searching programs are more commonly used at this time  <cit> .

there are also various probability based post-search methods used to statistically curate search results from database search algorithms  <cit> . these methods estimate the accuracy of protein/peptide identifications and compare search results from different algorithms based on a common standard. however, many models involve empirical parameters such as score from correlative scoring algorithms. therefore they may possess biases as a result of parameter optimization or model training.

the key comparison between different algorithms lies in how each approach scores a potential match between experimental and theoretical spectra  <cit> . we recently developed a database searching program, massmatrix that uses a mass accuracy sensitive statistical model for scoring. this approach is separate and distinct from algorithms that filter matches based on mass accuracy. in the latter high mass accuracy can be used to filter spectra by only searching tandem mass spectra whose precursor ion falls within the stated mass tolerance, and filtering product ions by high mass accuracy can further reduce the likelihood of a random match  <cit> . however, a score sensitive model implicitly takes mass accuracy into account during scoring. the model is rigorously derived and sensitive to the searching tolerance determined by the accuracy of mass spectrometer. high accuracy improves the sensitivity and selectivity of searches. the statistical scores represent the probability that a match is a random occurrence. in addition, a novel statistically derived algorithm to rigorously calculate protein scores from the statistically based peptide scores has been developed. thus the protein scores reflect the significance of protein hits and can be used to differentiate true protein hits from random ones. herein we describe the statistical models.

RESULTS
multiple scoring algorithms
the peptide matching algorithm contains two independent scoring models, including a descriptive model and a statistical model. these models are used to calculate three distinct scores for a peptide match. each of the scores may be independently used to ascertain the quality of the match. because each score is distinct, the combination of scores is useful for validating each peptide match. the two models and the application to calculating peptide match scores are described in detail in the following.

descriptive peptide scoring model
descriptive scores do not strictly convey any statistical relevance and may be prone to bias due to the scoring parameters. however, they have proven to be useful and generally augment probability based scores  <cit> . the descriptive model used herein to calculate peptide match scores  is shown in eqn.  <dig> 

 s=100∑i=1nmatchiirmatch2max⁡lpep
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgtbwucqgh9aqpcqaixaqmcqaiwaamcqaiwaamdawcaaqaamaaqahabagaemysak0aasbaasqaaiabdmgapbqabaaabagaemyaakmaeyypa0jaegymaedabagaemoba42aasbaawqaaiabb2gatjabbggahjabbsha0jabbogajjabbigaobqabaaaniabgghildgccqwgybgcdaqhaawcbagaeeyba0maeeyyaemaeeidaqnaee4yammaeeiaaggabagaegomaidaaogagiyba0maeiyyaemaeiieagnaeiikagiaegimaajaeiilawyaasaaaeaacqwgubgbdawgaawcbagaeeyba0maeeyyaemaeeidaqnaee4yammaeeiaaggabeaakiabgkhitiabiodazaqaaiabd6gaunaabaaaleaacqqgtbqbcqqghbqycqqg0badcqqgjbwycqqgobaaaeqaaaaakiabcmcapaqaamaakaaabagaemitaw0aasbaasqaaiabbchawjabbwgaljabbchawbqabaaabeaaaaaaaa@6b56@ 

ii is defined as the standardized abundance of the ith product ion in the experimental spectrum , ∑i=1nmatchii
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaaewbqaaiabdmeajnaabaaaleaacqwgpbqaaeqaaaqaaiabdmgapjabg2da9iabigdaxaqaaiabd6gaunaabaaameaacqqgtbqbcqqghbqycqqg0badcqqgjbwycqqgobaaaeqaaaqdcqghris5aaaa@3d25@ is the total standardized abundance of matched product ions, nmatch is the number of matched product ions, rmatch is the ratio of standardized abundance of matched product ions to total standardized abundance of the experimental spectrum, and lpep is the length of the peptide in the number of amino acids. each of these factors contributes to the overall score as follows: ∑i=1nmatchii
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaaewbqaaiabdmeajnaabaaaleaacqwgpbqaaeqaaaqaaiabdmgapjabg2da9iabigdaxaqaaiabd6gaunaabaaameaacqqgtbqbcqqghbqycqqg0badcqqgjbwycqqgobaaaeqaaaqdcqghris5aaaa@3d25@ evaluates the quality of the match, rmatch2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgybgcdaqhaawcbagaeeyba0maeeyyaemaeeidaqnaee4yammaeeiaaggabagaegomaidaaaaa@35f5@ introduces a penalty for unmatched product ions, max⁡
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacyggtbqbcqgghbqycqgg4baecqggoaakcqaiwaamcqggsaaldawcaaqaaiabd6gaunaabaaaleaacqqgtbqbcqqghbqycqqg0badcqqgjbwycqqgobaaaeqaaogaeyoei0iaeg4mamdabagaemoba42aasbaasqaaiabb2gatjabbggahjabbsha0jabbogajjabbigaobqabaaaaogaeiykakcaaa@46f3@ is an arbitrary penalty for matches with poor fragmentation, lpep
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagcaaqaaiabdyeamnaabaaaleaacqqgwbaccqqglbqzcqqgwbacaeqaaaqabaaaaa@3228@ is an additional penalty for peptides with long sequences and the constant  <dig> is used arbitrarily to scale the scores. by default, scores for a spectrum with less than three matched product ions will be  <dig> due to the arbitrary penalty. however, the minimum number of matched ions may be changed to any value. reducing this number is especially valuable for the analysis of singly charged peptides that have characteristic c-terminal aspartic acid fragmentation  <cit> . the penalty for peptide length is included to normalize the scores. peptides with longer sequences have more fragment ions and higher empirical scores than shorter sequences. the penalty results in long and short sequences both have similar scores for matches of similar quality. the choices of incorporating squared and square root for the terms nmatch and lpep were empirically determined from the evaluation of tandem ms data sets collected from lcq and ltq-orbitrap mass spectrometers.

descriptive protein score
for "true" matches, we assume that the scores are normally distributed with a mean of  <dig> and a variance of  <dig>  this arbitrary distribution estimates the distributions observed from analysis of several datasets. the expected contribution of each match to the protein score will be s×∫0se−2/5052πdx
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgtbwucqghxdatdawdxaqaamaalaaabagaemyzau2aawbaasqabeaacqghsislcqggoaakcqwg4baecqghsislcqaiyagmcqaiwaamcqggpaqkdaahaaadbeqaaiabikdayaaaliabc+caviabiwda1iabicdawaaaaoqaaiabiwda1maakaaabagaegomaidccigae8hwdahaleqaaaaaaeaacqaiwaamaeaacqwgtbwua0gaey4kiipakiabdsgakjabdiha4baa@4740@. thus, the protein score from the descriptively scored matches is calculated from eqn.  <dig> 

 protein score=∑isi×∫0sie−2/5052πdx
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqqgwbaccqqgybgccqqgvbwbcqqg0badcqqglbqzcqqgpbqacqqgubgbcqqggaaicqqgzbwccqqgjbwycqqgvbwbcqqgybgccqqglbqzcqgh9aqpdaaeqbqaaiabdofatnaabaaaleaacqwgpbqaaeqaaogaey41aq7aa8qmaeaadawcaaqaaiabdwgalnaacaaaleqabagaeyoei0iaeiikagiaemieagnaeyoei0iaegomaijaegimaajaeiykakyaawbaawqabeaacqaiyagmaawccqggvawlcqai1aqncqaiwaamaaaakeaacqai1aqndagcaaqaaiabikdayiabec8awbwcbeaaaagccqwgkbazcqwg4baeasqaaiabicdawaqaaiabdofatnaabaaameaacqwgpbqaaeqaaaqdcqghrii8aawcbagaemyaakgabeqdcqghris5aaaa@6036@ 

probability based peptide scoring model
in addition to the empirical score, a mass accuracy sensitive probability based scoring model was derived to evaluate peptide matches. the model determines the likelihood that an experimental spectrum match to a theoretical spectrum is a random occurrence. consider a pair of spectra: one experimental and one theoretical. we and wt denote their precursor masses respectively. in addition, the experimental data contains information regarding the abundance of product ions ii for each precursor, we. the model ultimately tests the following two hypotheses: the null hypothesis, h <dig>  states that a match is random, i.e. the theoretical spectrum is independent of the experimental; and the alternative hypothesis, ha, states that the match is not random, i.e. the theoretical spectrum is related to the experimental one.

scoring the match is performed in two stages: 1) match we against wt within the specified precursor ion mass accuracy and 2) match all product ions in the experimental spectrum against the theoretical within the specified mass accuracy. both stages rely on calculating the probability that the occurrence of an ion within a fixed mass window could be a random occurrence .

to match the experimental precursor with that of theoretical peptide we first define the variable q:

 q={1we and wt match0otherwise
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgxbqccqgh9aqpdagabaqaauaabaqaciaaaeaacqaixaqmaeaacqwgxbwvdawgaawcbagaemyzaugabeaakiabbccagiabbggahjabb6gaujabbsgakjabbccagiabdefaxnaabaaaleaacqwg0badaeqaaogaeeiiaaiaeeyba0maeeyyaemaeeidaqnaee4yammaeeiaaggabagaegimaadabagaee4ba8maeeidaqnaeeiaagmaeeyzaumaeeocainaee4dacnaeeyaakmaee4camnaeeyzaugaaagaay5eaaaaaa@5142@ 

under h <dig>  the possibility that any precursor ion match  could be random is given in eqn.  <dig> 

 p1=2τpepΠ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbacdawgaawcbagaegymaedabeaakiabg2da9maalaaabagaegomaidccigae8hxdq3aasbaasqaaiabbchawjabbwgaljabbchawbqabaaakeaacqwfgoauaaaaaa@38dc@ 

in the above equation, τpep is the mass accuracy of the precursor ion and Π is the detection range for the precursor ion. for each precursor ion the mass window is defined as ± τpep . thus q has a bernoulli  distribution under h <dig>  if the precursor ion masses of the pair of spectra do not match  then the second stage is skipped. if q =  <dig> we proceed to stage  <dig> where we test the match of the experimental product ion spectrum against the theoretical spectrum.

the variable bi is defined for each product ion, i, in the experimental spectrum as follows:

 bi={1peak i matches0otherwise.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgibgydawgaawcbagaemyaakgabeaakiabg2da9maaceaabaqbaeaabigaaaqaaiabigdaxaqaaiabbchawjabbwgaljabbggahjabbugarjabbccagiabdmgapjabbccagiabb2gatjabbggahjabbsha0jabbogajjabbigaojabbwgaljabbohazbqaaiabicdawaqaaiabb+gavjabbsha0jabbigaojabbwgaljabbkhayjabbeha3jabbmgapjabbohazjabbwgalbaaaiaawuhaaiabc6cauaaa@52b0@ 

under h <dig>  all matched product ions are random and independent occurrences. the probability that a product ion randomly matches any of the product ions in the theoretical spectrum is:

 p2=ΠtheoΠ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbacdawgaawcbagaegomaidabeaakiabg2da9maalaaabaaccigae8hoda1aasbaasqaaiabbsha0jabbigaojabbwgaljabb+gavbqabaaakeaacqwfgoauaaaaaa@3901@ 

where Πtheo is the total coverage of the detection range for all product ions in the theoretical spectrum and Π is the ms/ms detection range. it is assumed that Π is the same as the precursor ion mass range. however, for instruments that have a dynamic detection range assuming a fixed value Π will result in more conservative scores. for each product ion in the theoretical spectrum, the mass window is ± τmsms . if we assume there is no overlap in the product ion mass windows, then Πtheo is calculated using the following equation

 Πtheo =  <dig> m × τmsms. 

the probability that any single matched product ion  could be random can be calculated using the eqn. 8

 p2=2m×τmsmsΠ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbacdawgaawcbagaegomaidabeaakiabg2da9maalaaabagaegomaijaemyba0maey41aqlccigae8hxdq3aasbaasqaaiabb2gatjabbohazjabb2gatjabbohazbqabaaakeaacqwfgoauaaaaaa@3dd5@ 

where τmsms is the product ion mass accuracy and m is the number of product ions within the detection range in the theoretical spectrum. because the theoretical spectrum is independent of the experimental under h <dig>  all bi  are assumed to have an identical and independent bernoulli  distribution under h <dig>  the model is then used to perform two distinct tests. each uses a different approach to evaluate the quality of a match: number of matched product ions x and total abundance of matched product ions y.

the pp score
the model is used to evaluate whether the number of matched product ions in an experimental spectrum could be a random occurrence. for all spectra whose precursor ion masses match, i.e. q =  <dig>  the variable x is defined as the number of product ions in the experimental spectrum that match the theoretical spectrum  where bi  is defined in eqn.  <dig> and n is the number of product ions in the experimental spectrum.

 x=∑i=1nbi
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg4baecqgh9aqpdaaewbqaaiabdkgainaabaaaleaacqwgpbqaaeqaaaqaaiabdmgapjabg2da9iabigdaxaqaaiabd6gaubqdcqghris5aaaa@38ec@ 

under h <dig>  all bi have an identical and independent bernoulli  distribution. therefore, x will have a binomial  distribution. consequently the probability mass function for x is:

 p=n!x!!p2xn−x
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbaccqggoaakcqwg4baecqggpaqkcqgh9aqpdawcaaqaaiabd6gaujabcgcahaqaaiabdiha4jabcgcahiabcicaoiabd6gaujabgkhitiabdiha4jabcmcapiabcgcahaaacqwgwbacdaqhaawcbagaegomaidabagaemieaghaaogaeiikagiaegymaejaeyoei0iaemicaa3aasbaasqaaiabikdayaqabagccqggpaqkdaahaawcbeqaaiabd6gaujabgkhitiabdiha4baaaaa@4b32@ 

where p <dig> is calculated from eqn.  <dig>  the p-value, α, is defined as the probability that the quality of a random match between a pair of spectra is greater than or equal to a match observed under h <dig>  the pp value, β, is defined as the negative common logarithm of the p-value:

 β = -log 

we use x to evaluate the quality of a match, such that the p-value is the probability that x for a random match between the pair of theoretical and experimental spectra is greater than or equal to that of the actual match, x = nmatch, under h <dig>  the p-value is:

 α=∑x=nmatchnp=∑x=nmatchnn!x!!p2xn−x
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfxoqycqgh9aqpdaaewbqaaiabdchawjabcicaoiabdiha4jabcmcapawcbagaemieagnaeyypa0jaemoba42aasbaawqaaiabb2gatjabbggahjabbsha0jabbogajjabbigaobqabaaaleaacqwgubgba0gaeyyeiuoakiabg2da9maaqahabawaasaaaeaacqwgubgbcqgghaqiaeaacqwg4baecqgghaqicqggoaakcqwgubgbcqghsislcqwg4baecqggpaqkcqgghaqiaaaaleaacqwg4baecqgh9aqpcqwgubgbdawgaaadbagaeeyba0maeeyyaemaeeidaqnaee4yammaeeiaaggabeaaasqaaiabd6gaubqdcqghris5aogaemicaa3aa0baasqaaiabikdayaqaaiabdiha4baakiabcicaoiabigdaxiabgkhitiabdchawnaabaaaleaacqaiyagmaeqaaogaeiykakyaawbaasqabeaacqwgubgbcqghsislcqwg4baeaaaaaa@6af2@ 

and the pp value is

 β=−log⁡=−log⁡!p2xn−x)
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfyogycqgh9aqpcqghsislcyggsbabcqggvbwbcqggnbwzcqggoaakcqwfxoqycqggpaqkcqgh9aqpcqghsislcyggsbabcqggvbwbcqggnbwzcqggoaakdaaewbqaamaalaaabagaemoba4maeiyiaecabagaemieagnaeiyiaeiaeiikagiaemoba4maeyoei0iaemieagnaeiykakiaeiyiaecaaawcbagaemieagnaeyypa0jaemoba42aasbaawqaaiabb2gatjabbggahjabbsha0jabbogajjabbigaobqabaaaleaacqwgubgba0gaeyyeiuoakiabdchawnaadaaaleaacqaiyagmaeaacqwg4baeaagccqggoaakcqaixaqmcqghsislcqwgwbacdawgaawcbagaegomaidabeaakiabcmcapmaacaaaleqabagaemoba4maeyoei0iaemieaghaaogaeiykakcaaa@66f4@ 

the pp <dig> score
the second approach evaluates whether the total abundance of matched product ions in the experimental spectrum could be a random occurrence. y is defined as the total abundance of experimental product ions that match product ions in a given theoretical spectrum:

 y=∑i=1niibi
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgzbqwcqgh9aqpdaaewbqaaiabdmeajnaabaaaleaacqwgpbqaaeqaaogaemoyai2aasbaasqaaiabdmgapbqabaaabagaemyaakmaeyypa0jaegymaedabagaemoba4ganiabgghildaaaa@3b5a@ 

where ii is the standardized abundance of the ith product ion in the experimental spectrum and bi is defined in eqn.  <dig>  for clarity we define yi = ii bi to give eqn.  <dig> 

 y=∑i=1nyi
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgzbqwcqgh9aqpdaaewbqaaiabdmha5naabaaaleaacqwgpbqaaeqaaaqaaiabdmgapjabg2da9iabigdaxaqaaiabd6gaubqdcqghris5aaaa@38dc@ 

however, to complete the test we must know the inherent distribution of y. this distribution is unknown and thus pp <dig> values can not be precisely calculated as were the pp values based on the total number of matched product ions. in order to estimate the pp <dig> value, three assumptions are needed:

 <dig>  ii is identically and independently distributed across product ions in the experimental spectrum,

 <dig>  bi is uncorrelated with ii in the experimental spectrum,

 <dig>  the number of product ions, n, in the experimental spectrum is large .

under assumption  <dig>  the mean μi and variance σi <dig> for the distribution of ii are estimated by:

 {μ^i=1n∑i=1niiσ^i2=1n−1∑i=1n2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagabaqaauaabaqaceaaaeaaiigacuwf8oqbgaqcamaabaaaleaacqwgjbqsaeqaaogaeyypa0zaasaaaeaacqaixaqmaeaacqwgubgbaawaaabcaeaacqwgjbqsdawgaawcbagaemyaakgabeaaaeaacqwgpbqacqgh9aqpcqaixaqmaeaacqwgubgba0gaeyyeiuoaaoqaaiqb=n8azzaajawaa0baasqaaiabdmeajbqaaiabikdayaaakiabg2da9maalaaabagaegymaedabagaemoba4maeyoei0iaegymaedaamaaqahabagaeiikagiaemysak0aasbaasqaaiabdmgapbqabagccqghsislcuwf8oqbgaqcamaabaaaleaacqwgjbqsaeqaaogaeiykakyaawbaasqabeaacqaiyagmaaaabagaemyaakmaeyypa0jaegymaedabagaemoba4ganiabgghildaaaagccagl7baaaaa@57c1@ 

since yi = ii bi, assumption  <dig> yields eqn.  <dig> under h <dig> 

 {μy=ey=ei)=ei=p2μiσy2=ey−ey2=ei)−2=p2μi2+p2σ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagabaqaauaabaqaceaaaeaaiigacqwf8oqbdawgaawcbagaemyeakhabeaakiabg2da9iabdweafnaabaaaleaacqwg5bqeaeqaaogaeiikagiaemyeak3aasbaasqaaiabdmgapbqabagccqggpaqkcqgh9aqpcqwgfbqrdawgaawcbagaemysakeabeaakiabcicaoiabdweafnaabaaaleaacqwg5bqecqgg8bafcqwgjbqsaeqaaogaeiikagiaemyeak3aasbaasqaaiabdmgapbqabagccqgg8bafcqwgjbqsdawgaawcbagaemyaakgabeaakiabcmcapiabcmcapiabg2da9iabdweafnaabaaaleaacqwgjbqsaeqaaogaeiikagiaemicaa3aasbaasqaaiabikdayaqabagccqwgjbqsdawgaawcbagaemyaakgabeaakiabcmcapiabg2da9iabdchawnaabaaaleaacqaiyagmaeqaaogae8hvd02aasbaasqaaiabdmeajbqabaaakeaacqwfdpwcdaqhaawcbagaemyeakhabagaegomaidaaogaeyypa0jaemyrau0aasbaasqaaiabdmha5bqabagccqggoaakcqwg5bqedaqhaawcbagaemyaakgabagaegomaidaaogaeiykakiaeyoei0iaemyrau0aasbaasqaaiabdmha5bqabagccqggoaakcqwg5bqedawgaawcbagaemyaakgabeaakiabcmcapmaacaaaleqabagaegomaidaaogaeyypa0jaemyrau0aasbaasqaaiabdmeajbqabagccqggoaakcqwgfbqrdawgaawcbagaemyeaknaeiifawnaemysakeabeaakiabcicaoiabdmha5naadaaaleaacqwgpbqaaeaacqaiyagmaagccqgg8bafcqwgjbqsdawgaawcbagaemyaakgabeaakiabcmcapiabcmcapiabgkhitiabcicaoiabdchawnaabaaaleaacqaiyagmaeqaaogae8hvd02aasbaasqaaiabdmeajbqabagccqggpaqkdaahaawcbeqaaiabikdayaaakiabg2da9iabdchawnaabaaaleaacqaiyagmaeqaaogaeiikagiaegymaejaeyoei0iaemicaa3aasbaasqaaiabikdayaqabagccqggpaqkcqwf8oqbdaqhaawcbagaemysakeabagaegomaidaaogaey4kasiaemicaa3aasbaasqaaiabikdayaqabagccqwfdpwcaaaacagl7baaaaa@a624@ 

thus, μy and σy <dig> can be estimated as:

 {μ^y=p2μ^iσ^y2=p2μ^i2+p2σ^i2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagabaqaauaabaqaceaaaeaaiigacuwf8oqbgaqcamaabaaaleaacqwg5bqeaeqaaogaeyypa0jaemicaa3aasbaasqaaiabikdayaqabagccuwf8oqbgaqcamaabaaaleaacqwgjbqsaeqaaagcbagaf83wdmnbakaadaqhaawcbagaemyeakhabagaegomaidaaogaeyypa0jaemicaa3aasbaasqaaiabikdayaqabagccqggoaakcqaixaqmcqghsislcqwgwbacdawgaawcbagaegomaidabeaakiabcmcapiqb=x7atzaajawaa0baasqaaiabdmeajbqaaiabikdayaaakiabgucariabdchawnaabaaaleaacqaiyagmaeqaaogaf83wdmnbakaadaqhaawcbagaemysakeabagaegomaidaaaaaaogaay5eaaaaaa@51ac@ 

according to the central limit theorem, y is approximately a normal distribution with the following parameters under assumption  <dig>  i.e. when n is large 

 {μy=nμyσy2=nσy2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagabaqaauaabaqaceaaaeaaiigacqwf8oqbdawgaawcbagaemywakfabeaakiabg2da9iabd6gaujab=x7atnaabaaaleaacqwg5bqeaeqaaagcbagae83wdm3aa0baasqaaiabdmfazbqaaiabikdayaaakiabg2da9iabd6gaujab=n8aznaadaaaleaacqwg5bqeaeaacqaiyagmaaaaaagccagl7baaaaa@41bc@ 

the resulting probability density function is given in eqn.  <dig> 

 fy=e−2/2πσy
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgmbgzdawgaawcbagaemywakfabeaakiabcicaoiabdmfazjabcmcapiabg2da9maalaaabagaemyzau2aawbaasqabeaacqghsislcqggoaakcqwgzbqwcqghsisliigacqwf8oqbdawgaaadbagaemywakfabeaaliabcmcapmaacaaameqabagaegomaidaasgaei4la8iaeiikagiaegomaijae83wdm3aa0baawqaaiabdmfazbqaaiabikdayaaaliabcmcapaaaaoqaamaakaaabagaegomaijae8hwdahaleqaaogae83wdm3aasbaasqaaiabdmfazbqabaaaaaaa@4bc3@ 

and μy and σy <dig> are estimated by eqn.  <dig> 

 {μ^y=n μ^y=n p2 μ^iσ^y2=n σ^y2=n {p2μ^i2+p2σ^i2}=n p2μ^i2+n p2σ^i2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadagabaqaauaabaqaceaaaeaaiigacuwf8oqbgaqcamaabaaaleaacqwgzbqwaeqaaogaeyypa0jaemoba4maeeiiaaiaf8hvd0mbakaadawgaawcbagaemyeakhabeaakiabg2da9iabd6gaujabbccagiabdchawnaabaaaleaacqaiyagmaeqaaogaeeiiaaiaf8hvd0mbakaadawgaawcbagaemysakeabeaaaoqaaiqb=n8azzaajawaa0baasqaaiabdmfazbqaaiabikdayaaakiabg2da9iabd6gaujabbccagiqb=n8azzaajawaa0baasqaaiabdmha5bqaaiabikdayaaakiabg2da9iabd6gaujabbccagiabcuha7jabdchawnaabaaaleaacqaiyagmaeqaaogaeiikagiaegymaejaeyoei0iaemicaa3aasbaasqaaiabikdayaqabagccqggpaqkcuwf8oqbgaqcamaadaaaleaacqwgjbqsaeaacqaiyagmaagccqghrawkcqwgwbacdawgaawcbagaegomaidabeaakiqb=n8azzaajawaa0baasqaaiabdmeajbqaaiabikdayaaakiabc2ha9jabg2da9iabd6gaujabbccagiabdchawnaabaaaleaacqaiyagmaeqaaogaeiikagiaegymaejaeyoei0iaemicaa3aasbaasqaaiabikdayaqabagccqggpaqkcuwf8oqbgaqcamaadaaaleaacqwgjbqsaeaacqaiyagmaagccqghrawkcqwgubgbcqqggaaicqwgwbacdawgaawcbagaegomaidabeaakiqb=n8azzaajawaa0baasqaaiabdmeajbqaaiabikdayaaaaaaakiaawuhaaaaa@812c@ 

the p-value, α, is the probability that y for a random match is greater than or equal to that of the actual match, imatch, under h <dig>  the p-value becomes:

 α=∫imatch+∞fydx=∫imatch+∞e−2/2πσydx
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfxoqycqgh9aqpdawdxaqaaiabdagamnaabaaaleaacqwgzbqwaeqaaogaeiikagiaemieagnaeiykakiaemizaqmaemieaghaleaacqwgjbqsdawgaaadbagaeeyba0maeeyyaemaeeidaqnaee4yammaeeiaaggabeaaasqaaiabgucariabg6hilcqdcqghrii8aogaeyypa0zaa8qmaeaadawcaaqaaiabdwgalnaacaaaleqabagaeyoei0iaeiikagiaemieagnaeyoei0iae8hvd02aasbaawqaaiabdmfazbqabawccqggpaqkdaahaaadbeqaaiabikdayaaaliabc+caviabcicaoiabikdayiab=n8aznaadaaameaacqwgzbqwaeaacqaiyagmaawccqggpaqkaaaakeaadagcaaqaaiabikdayiab=b8awbwcbeaakiab=n8aznaabaaaleaacqwgzbqwaeqaaaaakiabdsgakjabdiha4bwcbagaemysak0aasbaawqaaiabb2gatjabbggahjabbsha0jabbogajjabbigaobqabaaaleaacqghrawkcqgheispa0gaey4kiipaaaa@6d9f@ 

and is estimated by:

 α=∫imatch+∞e−2/2πσ^ydx
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfxoqycqgh9aqpdawdxaqaamaalaaabagaemyzau2aawbaasqabeaacqghsislcqggoaakcqwg4baecqghsislcuwf8oqbgaqcamaabaaameaacqwgzbqwaeqaasgaeiykakyaawbaawqabeaacqaiyagmaawccqggvawlcqggoaakcqaiyagmcuwfdpwcgaqcamaadaaameaacqwgzbqwaeaacqaiyagmaawccqggpaqkaaaakeaadagcaaqaaiabikdayiab=b8awbwcbeaakiqb=n8azzaajawaasbaasqaaiabdmfazbqabaaaaogaemizaqmaemieaghaleaacqwgjbqsdawgaaadbagaeeyba0maeeyyaemaeeidaqnaee4yammaeeiaaggabeaaasqaaiabgucariabg6hilcqdcqghrii8aaaa@5778@ 

resulting in the pp <dig> value, β, as follows:

 β=−log⁡=−log⁡2/2πσ^ydx)
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfyogycqgh9aqpcqghsislcyggsbabcqggvbwbcqggnbwzcqggoaakcqwfxoqycqggpaqkcqgh9aqpcqghsislcyggsbabcqggvbwbcqggnbwzcqggoaakdawdxaqaamaalaaabagaemyzau2aawbaasqabeaacqghsislcqggoaakcqwg4baecqghsislcuwf8oqbgaqcamaabaaameaacqwgzbqwaeqaasgaeiykakyaawbaawqabeaacqaiyagmaawccqggvawlcqggoaakcqaiyagmcuwfdpwcgaqcamaadaaameaacqwgzbqwaeaacqaiyagmaawccqggpaqkaaaakeaadagcaaqaaiabikdayiab=b8awbwcbeaakiqb=n8azzaajawaasbaasqaaiabdmfazbqabaaaaogaemizaqmaemieaghaleaacqwgjbqsdawgaaadbagaeeyba0maeeyyaemaeeidaqnaee4yammaeeiaaggabeaaasqaaiabgucariabg6hilcqdcqghrii8aogaeiykakcaaa@679e@ 

the pp <dig> value can be estimated by equation  <dig> very efficiently. however, the real distribution of y is more tailed to larger values than the normal distribution. therefore, pp <dig> values are overestimated when they are large.

distribution of pp value for random matches
when q =  <dig>  the algorithm always assigns pp value, β =  <dig> because the experimental and theoretical precursor ions do not match. the cumulative distribution function for pp value when q =  <dig> is shown in eqn.  <dig> 

 fβ|q=0={1β=00β>0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwggbgrdawgaawcbaaccigae8nsdimaeiifawnaemycaenaeyypa0jaegimaadabeaakiabcicaoiab=j7aijabcmcapiabg2da9maaceaabaqbaeqabigaaaqaaiabigdaxaqaaiab=j7aijabg2da9iabicdawaqaaiabicdawaqaaiab=j7aijabg6da+iabicdawaaaaiaawuhaaaaa@42fc@ 

in statistical hypothesis testing, a p-value for a null hypothesis h <dig> is always a uniform distribution on the interval  <cit> . therefore, the cumulative distribution function for p-value of a random match is continuously distributed as

 fα|q =  <dig> = α    

when q =  <dig>  according to the definition of pp value , the cumulative distribution function for pp value when q =  <dig> is

 fβ|q =  <dig> =  <dig> - 10-β    

and the probability density function is

 fβ|q=1=ddβfβ|q=1=ddβ=ln⁡10−β.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqabeqacaaabagaemozay2aasbaasqaaggaciab=j7aijabcyha8jabdghaxjabg2da9iabigdaxaqabagccqggoaakcqwfyogycqggpaqkcqgh9aqpdawcaaqaaiabdsgakbqaaiabdsgakjab=j7aibaacqwggbgrdawgaawcbagae8nsdimaeiifawnaemycaenaeyypa0jaegymaedabeaakiabcicaoiab=j7aijabcmcapiabg2da9maalaaabagaemizaqgabagaemizaqmae8nsdigaaiabcicaoiabigdaxiabgkhitiabigdaxiabicdawmaacaaaleqabagaeyoei0iae8nsdigaaogaeiykakiaeyypa0jagiibawmaeioba4maeiikagiaegymaejaegimaajaeiykakiaegymaejaegimaazaawbaasqabeaacqghsislcqwfyogyaaaakeaacqggoaakcqwfyogycqghljyscqaiwaamcqggpaqkaagaeiola4caaa@68e6@ 

matches with pp or pp <dig> values under a critical value βc >  <dig> are discarded, i.e. their pp values are assigned  <dig>  thus the distribution of pp value for random matches returned by the algorithm is

 fβ|q=1∗=∫0βcfβ|q=1dx=∫0βcln⁡10−xdx=1−10−βc
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwggbgrdaqhaawcbaaccigae8nsdimaeiifawnaemycaenaeyypa0jaegymaedabagaey4fiocaaogaeiikagiaegimaajaeiykakiaeyypa0zaa8qmaeaacqwgmbgzdawgaawcbagae8nsdimaeiifawnaemycaenaeyypa0jaegymaedabeaakiabcicaoiabdiha4jabcmcapiabdsgakjabdiha4bwcbagaegimaadabagae8nsdi2aasbaawqaaiabdogajbqabaaaniabguiiydgccqgh9aqpdawdxaqaaigbcygasjabc6gaujabcicaoiabigdaxiabicdawiabcmcapiabigdaxiabicdawmaacaaaleqabagaeyoei0iaemieaghaaaqaaiabicdawaqaaiab=j7ainaabaaameaacqwgjbwyaeqaaaqdcqghrii8aogaemizaqmaemieagnaeyypa0jaegymaejaeyoei0iaegymaejaegimaazaawbaasqabeaacqghsislcqwfyogydawgaaadbagaem4yamgabeaaaaaaaa@6b04@ 

and for β ≥ βc >  <dig> 

 fβ|q=1∗=fβ|q=1=1−10−β
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwggbgrdaqhaawcbaaccigae8nsdimaeiifawnaemycaenaeyypa0jaegymaedabagaey4fiocaaogaeiikagiae8nsdimaeiykakiaeyypa0jaemoray0aasbaasqaaiab=j7aijabcyha8jabdghaxjabg2da9iabigdaxaqabagccqggoaakcqwfyogycqggpaqkcqgh9aqpcqaixaqmcqghsislcqaixaqmcqaiwaamdaahaawcbeqaaiabgkhitiab=j7aibaaaaa@4c51@ 

thus when q = 1

 fβ|q=1∗={1−10−βcβ=01−10−ββ≥βc.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwggbgrdaqhaawcbaaccigae8nsdimaeiifawnaemycaenaeyypa0jaegymaedabagaey4fiocaaogaeiikagiae8nsdimaeiykakiaeyypa0zaaiqaaeaafaqaaegacaaabagaegymaejaeyoei0iaegymaejaegimaazaawbaasqabeaacqghsislcqwfyogydawgaaadbagaem4yamgabeaaaaaakeaacqwfyogycqgh9aqpcqaiwaamaeaacqaixaqmcqghsislcqaixaqmcqaiwaamdaahaawcbeqaaiabgkhitiab=j7aibaaaoqaaiab=j7aijabgwmizkab=j7ainaabaaaleaacqwgjbwyaeqaaaaaaogaay5eaagaeiola4caaa@5456@ 

likewise we can specify the unconditional distribution of pp values for random matches as follows. since q has a bernoulli  distribution, we have

 p={1−p1q=0p1q= <dig> 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaucqggoaakcqwgxbqccqggpaqkcqgh9aqpdagabaqaauaabaqaciaaaeaacqaixaqmcqghsislcqwgwbacdawgaawcbagaegymaedabeaaaoqaaiabdghaxjabg2da9iabicdawaqaaiabdchawnaabaaaleaacqaixaqmaeqaaagcbagaemycaenaeyypa0jaegymaedaaagaay5eaagaeiilawcaaa@41bc@ 

for β =  <dig> the cumulative distribution function becomes,

 fβ=fβ|q=0×pq+fβ|q=1∗×pq=1×+×p1=1−p110−βc
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqadegabaaabagaemoray0aasbaasqaaggaciab=j7aibqabagccqggoaakcqaiwaamcqggpaqkcqgh9aqpcqwggbgrdawgaawcbagae8nsdimaeiifawnaemycaenaeyypa0jaegimaadabeaakiabcicaoiabicdawiabcmcapiabgena0kabdcfaqnaabaaaleaacqwgxbqcaeqaaogaeiikagiaegimaajaeiykakiaey4kasiaemoray0aa0baasqaaiab=j7aijabcyha8jabdghaxjabg2da9iabigdaxaqaaiabgehiqaaakiabcicaoiabicdawiabcmcapiabgena0kabdcfaqnaabaaaleaacqwgxbqcaeqaaogaeiikagiaegymaejaeiykakcabagaeyypa0jaegymaejaey41aqraeiikagiaegymaejaeyoei0iaemicaa3aasbaasqaaiabigdaxaqabagccqggpaqkcqghrawkcqggoaakcqaixaqmcqghsislcqaixaqmcqaiwaamdaahaawcbeqaaiabgkhitiab=j7ainaabaaameaacqwgjbwyaeqaaaaakiabcmcapiabgena0kabdchawnaabaaaleaacqaixaqmaeqaaogaeyypa0jaegymaejaeyoei0iaemicaa3aasbaasqaaiabigdaxaqabagccqaixaqmcqaiwaamdaahaawcbeqaaiabgkhitiab=j7ainaabaaameaacqwgjbwyaeqaaaaaaaaaaa@7dd6@ 

and for β ≥ βc >  <dig>  it becomes,

 fβ=fβ|q=0×pq+fβ|q=1∗×pq=0×+×p1=1−p110−β
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqadegabaaabagaemoray0aasbaasqaaggaciab=j7aibqabagccqggoaakcqwfyogycqggpaqkcqgh9aqpcqwggbgrdawgaawcbagae8nsdimaeiifawnaemycaenaeyypa0jaegimaadabeaakiabcicaoiab=j7aijabcmcapiabgena0kabdcfaqnaabaaaleaacqwgxbqcaeqaaogaeiikagiaegimaajaeiykakiaey4kasiaemoray0aa0baasqaaiab=j7aijabcyha8jabdghaxjabg2da9iabigdaxaqaaiabgehiqaaakiabcicaoiab=j7aijabcmcapiabgena0kabdcfaqnaabaaaleaacqwgxbqcaeqaaogaeiikagiaegymaejaeiykakcabagaeyypa0jaegimaajaey41aqraeiikagiaegymaejaeyoei0iaemicaa3aasbaasqaaiabigdaxaqabagccqggpaqkcqghrawkcqggoaakcqaixaqmcqghsislcqaixaqmcqaiwaamdaahaawcbeqaaiabgkhitiab=j7aibaakiabcmcapiabgena0kabdchawnaabaaaleaacqaixaqmaeqaaogaeyypa0jaegymaejaeyoei0iaemicaa3aasbaasqaaiabigdaxaqabagccqaixaqmcqaiwaamdaahaawcbeqaaiabgkhitiab=j7aibaaaaaaaa@7ce6@ 

the combined cumulative distribution function is thus,

 fβ={1−p110−βcβ=01−p110−ββ≥βc
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwggbgrdawgaawcbaaccigae8nsdigabeaakiabcicaoiab=j7aijabcmcapiabg2da9maaceaabaqbaeaabigaaaqaaiabigdaxiabgkhitiabdchawnaabaaaleaacqaixaqmaeqaaogaegymaejaegimaazaawbaasqabeaacqghsislcqwfyogydawgaaadbagaem4yamgabeaaaaaakeaacqwfyogycqgh9aqpcqaiwaamaeaacqaixaqmcqghsislcqwgwbacdawgaawcbagaegymaedabeaakiabigdaxiabicdawmaacaaaleqabagaeyoei0iae8nsdigaaagcbagae8nsdimaeyyzimrae8nsdi2aasbaasqaaiabdogajbqabaaaaagccagl7baaaaa@52bf@ 

when β ≥ βc, fβ is continuous and the probability density function of pp value for random matches is

 fβ=ddβfβ=ddβ=p1ln⁡10−β
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqabeqacaaabagaemozay2aasbaasqaaggaciab=j7aibqabagccqggoaakcqwfyogycqggpaqkcqgh9aqpdawcaaqaaiabdsgakbqaaiabdsgakjab=j7aibaacqwggbgrdawgaawcbagae8nsdigabeaakiabcicaoiab=j7aijabcmcapiabg2da9maalaaabagaemizaqgabagaemizaqmae8nsdigaaiabcicaoiabigdaxiabgkhitiabdchawnaabaaaleaacqaixaqmaeqaaogaegymaejaegimaazaawbaasqabeaacqghsislcqwfyogyaagccqggpaqkcqgh9aqpcqwgwbacdawgaawcbagaegymaedabeaakigbcygasjabc6gaujabcicaoiabigdaxiabicdawiabcmcapiabigdaxiabicdawmaacaaaleqabagaeyoei0iae8nsdigaaagcbagaeiikagiae8nsdimaeyyzimrae8nsdi2aasbaasqaaiabdogajbqabagccqggpaqkaaaaaa@6591@ 

confidence level for pp and pp <dig> values
the confidence level can also be determined for both pp and pp <dig>  suppose there are r theoretical spectra within the protein sequence database. if we assume that all theoretical spectra are uncorrelated, eqn.  <dig> gives φ, the number of random matches that have a pp value greater than or equal to β under h <dig> for any given experimental spectrum.

 φ=r∫β+∞fβdx=r∫β+∞p1ln⁡10−xdx=rp110−β,
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfgpgzcqgh9aqpcqwgybgcdawdxaqaaiabdagamnaabaaaleaacqwfyogyaeqaaogaeiikagiaemieagnaeiykakiaemizaqmaemieaghaleaacqwfyogyaeaacqghrawkcqgheispa0gaey4kiipakiabg2da9iabdkhaynaapedabagaemicaa3aasbaasqaaiabigdaxaqabaaabagae8nsdigabagaey4kasiaeyohiukaniabguiiydgccyggsbabcqggubgbcqggoaakcqaixaqmcqaiwaamcqggpaqkcqaixaqmcqaiwaamdaahaawcbeqaaiabgkhitiabdiha4baakiabdsgakjabdiha4jabg2da9iabdkhayjabdchawnaabaaaleaacqaixaqmaeqaaogaegymaejaegimaazaawbaasqabeaacqghsislcqwfyogyaagccqggsaalaaa@6347@ 

the confidence level, ψ, is defined as

 ψ = -log = -log = β -log-log 

where β is either the pp or pp <dig> value, r is the number of theoretical spectra within the protein sequence database, and p <dig> is given in eqn.  <dig>  confidence levels calculated from pp value and pp <dig> value are referred as confidence level and confidence level <dig> respectively.

the confidence level is the negative common logarithm of the expected number of random matches with a pp value bigger than or equal to the one we observe for the corresponding experimental spectrum. therefore, if the confidence level is below  <dig>  more than one random match for the spectrum is expected and the corresponding match is highly suspect. from eqn.  <dig>  the pp value is directly related to the confidence value. the confidence level is dependent upon the size of the database and degrades as the number of peptide created from the database increases.

the protein pp score
the pp model is also used to calculate pp values for protein matches. let rprotein denote the total number of theoretical spectra created from a protein sequence and nspectra denote the total number of experimental spectra in the data set. the cross match of all experimental spectra with theoretical peptides for the protein sequence generates nmatch_protein = rprotein × nspctra potential matches. the sum of reported pp values of all matches for the protein is calculated from eqn.  <dig> 

 b=∑i=1nmatch_proteinβi
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgcbgqcqgh9aqpdaaewbqaaggaciab=j7ainaabaaaleaacqwgpbqaaeqaaaqaaiabdmgapjabg2da9iabigdaxaqaaiabd6gaunaabaaameaacqqgtbqbcqqghbqycqqg0badcqqgjbwycqqgobaacqqgfbwxcqqgwbaccqqgybgccqqgvbwbcqqg0badcqqglbqzcqqgpbqacqqgubgbaeqaaaqdcqghris5aaaa@4abd@ 

the statistical model is used to test the following hypotheses: h <dig> – all peptide matches for a given protein are random and ha – at least one peptide match for a given protein is not random. we assume that rspectra theoretical spectra created from the protein sequence are uncorrelated to each other and that nspectra experimental spectra from the data set are uncorrelated to each other. since nmatch_protein is normally very large, b is approximately a normal distribution with a mean of μb = nmatch_protein × μβ and a variance of σb <dig> = nmatch_protein × σβ <dig> according to the central limit theorem.

according to the distribution of the pp value for random matches described above, the mean and variances of a random match are given by the following equations:

 μβ=∫0+∞xfβdx=∫βc+∞xp1ln⁡10−xdx=+p1βc)10−βc
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwf8oqbdawgaawcbagae8nsdigabeaakiabg2da9maapedabagaemieagnaemozay2aasbaasqaaiab=j7aibqabagccqggoaakcqwg4baecqggpaqkcqwgkbazcqwg4baeasqaaiabicdawaqaaiabgucariabg6hilcqdcqghrii8aogaeyypa0zaa8qmaeaacqwg4baecqwgwbacdawgaawcbagaegymaedabeaakigbcygasjabc6gaujabcicaoiabigdaxiabicdawiabcmcapiabigdaxiabicdawmaacaaaleqabagaeyoei0iaemieaghaaogaemizaqmaemieaghaleaacqwfyogydawgaaadbagaem4yamgabeaaasqaaiabgucariabg6hilcqdcqghrii8aogaeyypa0jaeiikagyaasaaaeaacqwgwbacdawgaawcbagaegymaedabeaaaoqaaigbcygasjabc6gaujabcicaoiabigdaxiabicdawiabcmcapaaacqghrawkcqwgwbacdawgaawcbagaegymaedabeaakiab=j7ainaabaaaleaacqwgjbwyaeqaaogaeiykakiaegymaejaegimaazaawbaasqabeaacqghsislcqwfyogydawgaaadbagaem4yamgabeaaaaaaaa@73eb@ 

and

 σβ2=e−μβ2=∫0+∞x2fβdx−μβ2=∫βc+∞x2p1ln⁡10−xdx−μβ2=]2+2p1βcln⁡+p1βc 2)10−βc−2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamxvp5wqsxmqhnxajn0bkvguhdwzzbqegyvzyrwyufgarqqtubsr4rnchbgeagqia8vkikvafgielifelkfelk=iy=hhbbf9v8qqaqfr0xc9pk0xbba9q8wqffeay=bilkvclq=jhqvepeea0=as0db9vqpepesp0xe9fve9fve9gapdbaqaaegacagaaiaabeqaamqadiabaagcbaqbaewabiqaaaqaaggaciab=n8aznaadaaaleaacqwfyogyaeaacqaiyagmaagccqgh9aqpcqwgfbqrcqggoaakcqwfyogydaahaawcbeqaaiabikdayaaakiabcmcapiabgkhitiab=x7atnaadaaaleaacqwfyogyaeaacqaiyagmaagccqgh9aqpdawdxaqaaiabdiha4naacaaaleqabagaegomaidaaogaemozay2aasbaasqaaiab=j7aibqabagccqggoaakcqwg4baecqggpaqkcqwgkbazcqwg4baeasqaaiabicdawaqaaiabgucariabg6hilcqdcqghrii8aogaeyoei0iae8hvd02aa0baasqaaiab=j7aibqaaiabikdayaaakiabg2da9maapedabagaemieag3aawbaasqabeaacqaiyagmaagccqwgwbacdawgaawcbagaegymaedabeaakigbcygasjabc6gaujabcicaoiabigdaxiabicdawiabcmcapiabigdaxiabicdawmaacaaaleqabagaeyoei0iaemieaghaaogaemizaqmaemieaghaleaacqwfyogydawgaaadbagaem4yamgabeaaasqaaiabgucariabg6hilcqdcqghrii8aogaeyoei0iae8hvd02aa0baasqaaiab=j7aibqaaiabikdayaaaaoqaaiabg2da9iabcicaomaalaaabagaegomaijaemicaa3aasbaasqaaiabigdaxaqabaaakeaadawadaqaaigbcygasjabc6gaujabcicaoiabigdaxiabicdawiabcmcapagaay5waiaaw2faamaacaaaleqabagaegomaidaaaaakiabgucarmaalaaabagaegomaijaemicaa3aasbaasqaaiabigdaxaqabagccqwfyogydawgaawcbagaem4yamgabeaaaoqaaigbcygasjabc6gaujabcicaoiabigdaxiabicdawiabcmcapaaacqghrawkcqwgwbacdawgaawcbagaegymaedabeaakiab=j7ainaadaaaleaacqqgjbwyaeaacqqggaaicqqgyagmaagccqggpaqkcqaixaqmcqaiwaamdaahaawcbeqaaiabgkhitiab=j7ainaabaaameaacqwgjbwyaeqaaaaakiabgkhitmaadmaabagaeiikagyaasaaaeaacqwgwbacdawgaawcbagaegymaedabeaaaoqaaigbcygasjabc6gaujabcicaoiabigdaxiabicdawiabcmcapaaacqghrawkcqwgwbacdawgaawcbagaegymaedabeaakiabek7ainaabaaaleaacqwgjbwyaeqaaogaeiykakiaegymaejaegimaazaawbaasqabeaacqghsislcqwfyogydawgaaadbagaem4yamgabeaaaaaakiaawufacagldbaadaahaawcbeqaaiabikdayaaaaaaaaa@cd4c@ 

where p <dig> is given in eqn.  <dig> and βc is the pp value threshold. likewise for the sum of pp values for the protein, b, the mean and variance for the distribution under h <dig> are given in eqn. 42:

 {μb=nmatch_protein+p1βc)10−βcσb2=nmatch_protein{2+2p1βcln⁡+p1βc 2]10−βc−2}
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamxvp5wqsxmqhnxajn0bkvguhdwzzbqegyvzyrwyufgarqqtubsr4rnchbgeagqia8vkikvafgielifelkfelk=iy=hhbbf9v8qqaqfr0xc9pk0xbba9q8wqffeay=bilkvclq=jhqvepeea0=as0db9vqpepesp0xe9fve9fve9gapdbaqaaegacagaaiaabeqaamqadiabaagcbawaaiqaaeaafaqaaegabaaabaaccigae8hvd02aasbaasqaaiabdkeacbqabagccqgh9aqpcqwgubgbdawgaawcbagaeeyba0maeeyyaemaeeidaqnaee4yammaeeiaagmaee4xa8laeeicaanaeeocainaee4ba8maeeidaqnaeeyzaumaeeyaakmaeeoba4gabeaakiabcicaomaalaaabagaemicaa3aasbaasqaaiabigdaxaqabaaakeaacyggsbabcqggubgbcqggoaakcqaixaqmcqaiwaamcqggpaqkaagaey4kasiaemicaa3aasbaasqaaiabigdaxaqabagccqwfyogydawgaawcbagaem4yamgabeaakiabcmcapiabigdaxiabicdawmaacaaaleqabagaeyoei0iae8nsdi2aasbaawqaaiabdogajbqabaaaaagcbagae83wdm3aa0baasqaaiabdkeacbqaaiabikdayaaakiabg2da9iabd6gaunaabaaaleaacqqgtbqbcqqghbqycqqg0badcqqgjbwycqqgobaacqqgfbwxcqqgwbaccqqgybgccqqgvbwbcqqg0badcqqglbqzcqqgpbqacqqgubgbaeqaaowaaiwaaeaadawadaqaamaalaaabagaegomaijaemicaa3aasbaasqaaiabigdaxaqabaaakeaadawadaqaaigbcygasjabc6gaujabcicaoiabigdaxiabicdawiabcmcapagaay5waiaaw2faamaacaaaleqabagaegomaidaaaaakiabgucarmaalaaabagaegomaijaemicaa3aasbaasqaaiabigdaxaqabagccqwfyogydawgaawcbagaem4yamgabeaaaoqaaigbcygasjabc6gaujabcicaoiabigdaxiabicdawiabcmcapaaacqghrawkcqwgwbacdawgaawcbagaegymaedabeaakiab=j7ainaadaaaleaacqqgjbwyaeaacqqggaaicqqgyagmaaaakiaawufacagldbaacqaixaqmcqaiwaamdaahaawcbeqaaiabgkhitiab=j7ainaabaaameaacqwgjbwyaeqaaaaakiabgkhitmaadmaabagaeiikagyaasaaaeaacqwgwbacdawgaawcbagaegymaedabeaaaoqaaigbcygasjabc6gaujabcicaoiabigdaxiabicdawiabcmcapaaacqghrawkcqwgwbacdawgaawcbagaegymaedabeaakiab=j7ainaabaaaleaacqwgjbwyaeqaaogaeiykakiaegymaejaegimaazaawbaasqabeaacqghsislcqwfyogydawgaaadbagaem4yamgabeaaaaaakiaawufacagldbaadaahaawcbeqaaiabikdayaaaaogaay5eaiaaw2haaaaaaiaawuhaaaaa@cdcb@ 

the p-value for a protein, αprotein, is defined to be the probability that the protein hit can have a sum of pp values from all its peptide matches greater than or equal to b under h <dig>  thus αprotein is given by

 αprotein=∫b+∞fbdx=∫b+∞e−2/2πσbdx.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfxoqydawgaawcbagaeeicaanaeeocainaee4ba8maeeidaqnaeeyzaumaeeyaakmaeeoba4gabeaakiabg2da9maapedabagaemozay2aasbaasqaaiabdkeacbqabagccqggoaakcqwg4baecqggpaqkcqwgkbazcqwg4baeasqaaiabdkeacbqaaiabgucariabg6hilcqdcqghrii8aogaeyypa0zaa8qmaeaadawcaaqaaiabdwgalnaacaaaleqabagaeyoei0iaeiikagiaemieagnaeyoei0iae8hvd02aasbaawqaaiabdkeacbqabawccqggpaqkdaahaaadbeqaaiabikdayaaaliabc+caviabcicaoiabikdayiab=n8aznaadaaameaacqwgcbgqaeaacqaiyagmaawccqggpaqkaaaakeaadagcaaqaaiabikdayiab=b8awbwcbeaakiab=n8aznaabaaaleaacqwgcbgqaeqaaaaakiabdsgakjabdiha4bwcbagaemoqaieabagaey4kasiaeyohiukaniabguiiydgccqgguaglaaa@69b8@ 

and the protein pp value becomes

 protein pp value=−log⁡=−log⁡2/2πσbdx)
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqqgwbaccqqgybgccqqgvbwbcqqg0badcqqglbqzcqqgpbqacqqgubgbcqqggaaicqqgwbaccqqgwbaccqqggaaicqqg2bgdcqqghbqycqqgsbabcqqg1bqdcqqglbqzcqgh9aqpcqghsislcyggsbabcqggvbwbcqggnbwzcqggoaakiigacqwfxoqydawgaawcbagaeeicaanaeeocainaee4ba8maeeidaqnaeeyzaumaeeyaakmaeeoba4gabeaakiabcmcapiabg2da9iabgkhitigbcygasjabc+gavjabceganjabcicaomaapedabawaasaaaeaacqwglbqzdaahaawcbeqaaiabgkhitiabcicaoiabdiha4jabgkhitiab=x7atnaabaaameaacqwgcbgqaeqaasgaeiykakyaawbaawqabeaacqaiyagmaawccqggvawlcqggoaakcqaiyagmcqwfdpwcdaqhaaadbagaemoqaieabagaegomaidaasgaeiykakcaaagcbawaaoaaaeaacqaiyagmcqwfapacasqabagccqwfdpwcdawgaawcbagaemoqaieabeaaaagccqwgkbazcqwg4baeasqaaiabdkeacbqaaiabgucariabg6hilcqdcqghrii8aogaeiykakcaaa@7d1a@ 

discussion
effect of various spectral characteristics on scoring
five example spectra, shown in figure  <dig>  are used to illustrate the effect of various spectral characteristics on scoring. all spectra were collected on an ltq-orbitrap mass spectrometer   <cit> . precursor and product ions were mass analyzed by the orbitrap to achieve a mass accuracy of <  <dig>  ppm. the pp and pp <dig> values at different mass accuracies  were calculated and listed in table  <dig>  mass accuracy tolerances were specified as either relative or absolute for precursor ions but only as absolute tolerances for product ions. absolute mass accuracy tolerances for product ions are computationally cheaper and yield a reasonable compromise between computational expense and accuracy. good quality spectra  yielded high empirical and statistical scores as expected. these sequences in figure 1a &1b illustrate that peptide length has little effect on the scoring. this observation is consistent with the statistical model lack of peptide sequence bias and the peptide length penalty included in the empirical score . low quality data  can still yield good scores if the most abundant ions are dominated by signal . the most challenging spectra are those with few dominant signal peaks. examples are shown in 1d &1e. these figures show the spectra with one single dominant ion due to n-terminal fragmentation of an internal pro residue and the neutral loss of h2o at an n-terminal glu residue  <cit> . the empirical scores were poorer for these cases since only a single ion mainly contributes to score . however, the pp and pp <dig> values were not as severely affected and able to accurately discriminate these matches from false positives.

comparison between pp and pp <dig> values
the pp value is the primary discriminator for quality of matches. the pp <dig> value can provide a complementary assessment of quality when pp values are suspect. although the pp and pp <dig> value have the same statistical basis, there are several differences between them: the pp value is based on the number of matched product ions and the pp <dig> value is based on the total abundance of matched product ions. the pp value can be underestimated when noise is present in the experimental spectrum especially at low mass accuracy. because noise normally has lower abundance than product ions, the pp <dig> value, on the other hand, is generally unaffected. as shown in table  <dig>  pp value for the spectrum with low signal to noise ratio and majority of noise peaks  were affected negatively by the noise peaks and relative low compared with those for normal spectra at mass accuracy of  <dig>  da. however, pp <dig> value was not affected by the noise peaks.

while pp value can be precisely calculated, there are three assumptions needed to estimate the pp <dig> values. assumption  <dig> and  <dig> for the pp <dig> test are not plausible when the number of product ions in the experimental spectrum, n is small. therefore, pp <dig> value estimated by the central limit theorem cannot evaluate the quality of matches with a small number of product ions. furthermore the normal distribution under the central limit theorem is less tailed than the true distribution of y, pp <dig> value is normally overestimated when it is large  as shown in table  <dig> 

from the above discussion, the pp value is more reliable and accurate than the pp <dig> value under most circumstances, but it can be affected by noise. under these circumstances, the number of product ions in the spectrum is normally large and pp <dig> value can be well estimated and complementary to pp value. thus the combination of the two scores provides an excellent means to ascertain the quality of matches under conditions where one might fail.

effect of mass accuracy on pp values
in the pp model, the two most important parameters  are set in accordance with the predetermined mass accuracy of mass spectrometer. these parameters' values decrease as mass accuracy increases. this effect is shown in table  <dig>  a more thorough list of all parameters used in calculating the empirical and statistical scores is provided as supplementary material . the statistical model specifically takes each parameter into account when calculating the statistical scores. therefore, these two parameters have a substantial effect on the pp values for both random matches and true matches. consequently, pp and pp <dig> values are very sensitive to the accuracy of mass spectrometer.

as is shown in the figure  <dig>  the probability of random matches having high pp values is substantially reduced as we increase mass accuracy. increasing mass accuracy resulted in a shift of the pp value distribution for random matches to lower values. at the same time the pp value distribution for true matches moves to higher pp values. this effect is evident from the pp values in table  <dig>  as mass accuracy improved, the pp values improved for all peptide matches in figure  <dig>  thus higher mass accuracy improves sensitivity and selectivity for a search and help discriminate true matches from random matches.

CONCLUSIONS
a new statistically derived scoring algorithm was developed for characterization of peptides, proteins and their posttranslational modifications from tandem ms data. the probability based algorithm implicitly incorporates mass accuracy into scoring the potential peptide and protein matches. this approach is separate and distinct from algorithms that filter precursor and product ion matches based on mass accuracy. the statistical model involves no empirical parameters and its scores correlate to the probability that a match is a random occurrence. a novel statistically derived algorithm to rigorously calculate protein scores from the probability based peptide scores was also developed. thus the protein scores reflect the significance of protein matches and can be used to differentiate true protein matches from random matches. the algorithm is incorporated in an automated database search program massmatrix.

authors' contributions
hx designed and mathematically proved the statistical model and drafted the manuscript. maf was the principle investigator and provided overall guidance of the project, and also revised the manuscript critically. both authors read and approved the final manuscript.

