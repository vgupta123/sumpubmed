BACKGROUND
genome wide association studies  look for genetic markers linked to a phenotype of interest. typically, hundreds of thousands of single nucleotide polymorphisms  are studied for a limited number of individuals using high-density genotyping arrays. usually the association between each snp and the phenotype is tested using single-marker methods. multiple markers may also be considered, but these are typically selected using simple forward-selection methods. gwass are a powerful tool for investigating the genetic architecture of complex diseases and have been successful in identifying hundreds of variants. however, they have been able to explain only a small proportion of the phenotypic variations expected from classical family studies  <cit> . a number of explanations for this missing heritability have been put forward. for example, it has been suggested that shared environments among relatives are not adequately taken into account. another suggestion is that much larger numbers of variants with small effects remain to be identified. rare variants, which are difficult to find using existing genotyping arrays  <cit> , seem to be important causal factors, and so do structural variations. but complex diseases may also be caused, at least in part, by complex genetic structures with multiple interactions between markers . whereas in pedigree studies the genetic effect on phenotype is seen as part of the additive genetic variance, in gwass it is seen as an unmeasured interaction between genes  <cit> . for example, zuk et al. proposed a model that takes into account epistatic interaction in relation to crohn’s disease  <cit> . they found that 80% of the missing heritability could be due to genetic interactions.

in recent years a number of methods for studying epistasis have been proposed and reported in various reviews . they vary in terms of their data analysis  and their statistical methodology . most of them focus on single-locus interactions, but considering interactions at the gene level can have several advantages. first, given that genes are the functional unit of the genome, results may be more biologically interpretable. second, genetic effects are more easily detected when snp effects are aggregated together. third, gene-based analysis simplifies the multiple testing problem by reducing the number of variables. several gene-gene methods have been proposed. these are based on a summarizing step which is used to obtain information at the gene level. in more recent methods, filters or penalized models are used to make the method applicable to a large number of genes, while older methods are only applicable to two or a very limited number of genes. for the summarizing step, most methods resort to a principal components  approach, but each method has its specific characteristics. we describe some of these below.

chatterjee et al. harnessed tukey’s one-degree-of-freedom method to investigate interaction between two genes  <cit> . their method is based on the assumption that the snps included in each gene region act as surrogates for an underlying biological phenotype. the genotypic information for the gene region is extracted as a single component by a weighted sum of all snps. the weights are determined according to the snp’s correlation with the trait. the product of the two sums is then introduced as the gene-gene interaction term into a logistic model, where marginal effects are represented by the respective sums. building on this idea, wang et al. compared two different interaction tests  <cit> . on the one hand, they used principal component analysis  to summarize snp information within a gene, and on the other hand they used partial least squares  to extract components that summarize, first, the information among snps in a gene and, second, the correlation between snps and the outcome of interest. they then proposed an interaction test based on either the first pc or the first pls component for each gene, and were able to show that the pca and pls methods often outperformed tukey’s one-degree-of-freedom method. but it is worth noting that the main objective of these three methods was improving the detection of associations in the presence of gene-gene interactions, rather than identifying the interactions themselves. other approaches based on principal component analysis have since been proposed for epistasis detection. li et al. proposed selecting, as the gene representation, pcs that are able to explain at least 80% of the variation  <cit> .

genotypic data are characterized by the high correlation among markers resulting from so-called linkage disequilibrium . procedures that take ld information into account have been developed for epistasis detection. for example, he et al. proposed an approach using ld information to weight genotype scores which are then aggregated using principal components  <cit> . rajapakse et al. developed a gene-based test of interactions for case-control studies which compares ld patterns between cases and controls  <cit> . using the same idea, peng et al. used a canonical correlation-based u-statistic model  to detect co-association in case-control studies  <cit> . the idea is to test for two given genes the difference between canonical correlation coefficient computed by canonical correlation analysis  among cases and among controls. their work was subsequently extended to include kernel  <cit> .

however most of these methods can be applied only to a reduced number of genes. computational constraints mean that it is not feasible to model all gene-gene interactions directly. one way of overcoming this is to reduce the gene-gene search space by eliminating unimportant genes, and to this end two-step procedures have been developed that first filter out specific genes or snps through a genome-wide search before testing for interactions. one example of this is the model-based kernel machine method  proposed by li and cui, which first performs a search for gene pairs contributing to the overall phenotypic variations  <cit> . significant pairs are then tested for interaction effects. another attractive alternative is offered by penalized regression methods that select a subset of important predictors out of a large number of potential predictors. these methods operate by shrinking the size of the coefficients. the coefficients of predictors with little or no apparent effect are force to be set to zero, reducing the effective degrees of freedom and in many cases making model selection possible. a few approaches using penalized models have been proposed. d’angelo et al. combined principal component analysis and lasso penalized regression  <cit> . wang et al. used a principal component analysis combined with an l <dig> penalty, with adaptive weights based on gene size, pathway support and effect size  <cit> .

here we propose a group lasso approach  <cit>  that takes into account the group structure of each gene in order to detect epistasis. we introduce gene-gene eigen-epistasis  as a new approach for computing the gene-gene interaction part of the model, and we compare g-gee with two different interaction variable modeling approaches inspired by previous proposals in the literature, namely pca and pls. an adaptive ridge-cleaning approach  <cit>  is then used in order to compute p-values for each group.

in the next section, we detail each model and outline the design of the simulation studies performed to compare the performance of the different approaches. in the results section, the findings of the simulation studies are shown, and we illustrate our approach on three real datasets relating to ankylosing spondylitis, thyroid carcinomas and inflammatory bowel disease. the different approaches and the results are discussed in the last section.

methods
we consider n individuals where y=t denotes the vector of trait values. for each individual, genetic variants among g genes are considered. each gene is described by a given number of snps p
g where ∑gpg=p. the snp matrix x∈ℝn×p considers an additive coding scheme in which the genotype value of each snp j from individual i is denoted x
ij∈{ <dig> ,3}. x
i is a p-dimensional vector of covariates for observation i and for j∈{ <dig> …,p}. x
g denotes the submatrix of x whose columns are the p
g snps of gene g. a generalized linear model is generally assumed for gwas, where the phenotype is considered as a random variable y
i whose conditional expectation can be written as a function of the covariates x
i and their interactions z
i, 
 geyi|x=xitβ+zitγ,  where 
 β=β <dig> ,β <dig> ,…,β <dig> p1⏟gene <dig> …,βg, <dig> …,βg,pg⏟genegt,  and z
i is the ith line of the matrix of interactions and γ a parameter vector of appropriate dimension. when the phenotype is binary , it is usual to assume a logistic model where g() is the logit and y is assumed to follow a binomial distribution. below we will consider only quantitative phenotypes using a classical linear model. in this case g() is the identity and the residuals are assumed to be gaussian.

the main effect of each gene is modeled through the sum of the effects of all its snps. concerning interaction effects, we compute new variables representing interactions between two specific genes and define as a group all the interaction variables related to a given pair of genes. the matrix of interaction is thus structured into g/ <dig> submatrices: 
 z=z11⋯zrs⋯zg/ <dig>  where z
rs describes the interactions between the two genes r and s. the parameter vector γ is accordingly structured into sub-vectors γ
rs. we will now present and compare three different approaches for modeling gene-gene interactions.

modeling gene-gene interactions
let us consider two genes r and s described respectively by p
r and p
s snps. a possible interaction term describing the epistasis between the two genes is 
  <dig> zirstγrs=∑j=1pr∑k=1psγjkrsxijrxiks. 


we hereafter set wrs={xijrxiks}i=1⋯nj= <dig> ⋯,pr;k= <dig> ⋯,ps. in this case the submatrix of interactions is z
rs=w
rs and γrs={γjkrs} is a vector of size p
r
p
s. the number of parameters in such a model is obviously too large to be reliably estimated. for this reason a number of papers in the literature consider reducing the dimension of γ.

in this paper we will consider three different methods for reducing the dimension reduction, namely principal component analysis , partial least squares , and our proposed gene-gene eigen-epistasis approach that we have termed g-gee.

principal component analysis
principal component analysis  can reduce the number of variables describing each gene r from p
r to q
r<p
r. considering gene r described by p
r snps, we compute the matrix of the first q principal components 
 cr=xrur,  where u
r is the matrix of the first q
r principal axes. using c
r and c
s instead of x
r and x
s in the computation of the interaction allows the number of parameters relative to each interaction to be controlled. this control is achieved by choosing the number of principal components q. the pca model that we describe draws upon ideas in  <cit> . the interaction term takes the form 
 zirstγrs=∑j=1q∑k=1qγjkrscijrciks. 


relating this expression to the general form of the interaction term wirs described above, we can see that performing pca prior to computing the interactions is a means of constraining the linear interaction term of eq.  <dig> 

the submatrix of interactions is zrs={cijrciks}i=1⋯nj= <dig> ⋯,q;k= <dig> ⋯,q, and γrs={γjkrs} is a vector of size q
 <dig> describing the interaction between genes r and s. in particular, if a single principal component is chosen, there will be only one parameter to estimate per interaction.

partial least squares
wang et al. proposed an alternative method for integrating interactions using a pls approach  <cit> . let  be the genotypic matrix for the given pair of genes . their approach computes the components that maximize cov
 <dig>  with t= and  the weight vectors. the interaction of a couple of genes  is then represented by the first q components: 
 zirstγrs=∑j=1qγjrstijrs. 


in this approach phenotypic information is retained when the interaction variables are constructed.

gene-gene eigen-epistasis
we propose an original approach for modeling interactions. the general idea is to consider the interaction variable between the two genes r and s as a function f
u parameterized by u. one way to estimate u is to maximize the correlation between the interaction function and the phenotype: 
 u^=argmaxu,∥u∥=1cov2y,fuxr,xs. 


if we consider the function f to be linear, our problem becomes easily tractable and has only one solution. setting 
 zrs=fuxr,xs=wrsu,  where wrs={xijrxiks}i=1⋯nj=1⋯,pr;k= <dig> ⋯,ps and u∈ℝprps we obtain the following problem: 
  <dig> maxu,∥u∥=1cov^wrsu,y2=maxu,∥u∥=1utwrsty2=maxu,∥u∥=1utwrstyytwrsu. 


the solution u is the eigenvector corresponding to the largest eigenvalue of the matrix w
rs
t
y
y
t
w
rs, which is the vector w
rs
t
y. the complexity of computing u is therefore in o. we then use the projection of the matrix w
rs on u as the interaction variable. the resulting eigen-epistasis vector z is the linear combination of all the snp-snp interactions being the most correlated with the phenotype. in its construction, g-gee has similarities with pls. the main difference lies in the original design matrix. pls searches for components that maximize cov
 <dig>  whereas g-gee retains the component that maximizes cov
 <dig>  with w
rs the matrix of all pairwise interaction between the two genes r and s. like pls, g-gee takes phenotypic information into account in the construction of the interaction variables. other methods as such as ccu  <cit>  and the kernel versions of ccu  <cit>  that we referred to in the introduction also consider the phenotype in their construction, but these methods can be applied only to case-control problems.

estimation of coefficients
we propose a group lasso approach  <cit>  for estimating the parameters of linear or logistic  regression. a group comprises either the snps of a given gene, or interaction terms relative to a given gene-pair interaction. in the particular case of linear regression, the model parameters are estimated by: 
 θ^=β^,γ^=argminβ,γ∑iyi−xiβ−ziγ2+λ∑gpg∥βg∥2+∑rsprps∥γrs∥ <dig>   the parameter λ is selected by cross-validation.

in order to improve estimation accuracy and to obtain p-values for each of the selected groups, we use the adaptive ridge cleaning approach proposed by bécu et al.  <cit> . this screen and clean procedure is a two-stage method. the group lasso model is first fitted on half of the data. the coefficient of the candidate groups selected by the model are then introduced into a ridge regression model fitted on the second half of the data with a specific penalty that allows the group structure to be taken into account. for each group the significance of the regression coefficients is estimated using permutation tests.

simulation design
to evaluate the performance of the proposed approach, we conducted two simulation studies, the first using simulated data and the second using a real dataset relating to ankylosing spondylitis. in each case we compared the proposed g-gee model to the two other interaction variable modeling approaches. the first simulation corresponds to a simplified context where all parameters were controlled and external interference limited, while the second simulation corresponds to a realistic context with a realistic pattern of minor allele frequency  and ld.

design

genotypes our first  simulation study was adapted from the model used in  <cit>  with an extension to control the maf of each snp. the n lines of the genotype matrix are an i.i.d. sample from a multivariate random vector xi∼np. the correlation matrix Σ is block diagonal, each block corresponding to a gene. two variables belonging to the same gene are correlated at level ρ= <dig>  while all other correlations are null. each snp  is randomly assigned an maf p from a uniform distribution between  <dig>  and  <dig> . an maf value of  <dig>  is assigned to all causal snps. the genotype frequencies derived from the hardy-weinberg equation are then used to discretize x
ik values to  <dig>   <dig> or  <dig>  in practice, x
ik is set to  <dig> if xik<qp2;n, x
ik is set to  <dig> if xik<q2;n and x
ik is set to  <dig> otherwise.

in the second  simulation study using a real ankylosing spondylitis dataset, genes are randomly selected. the number of snps composing each genes varies according to the selection.


phenotypes for both simulation studies, we generated phenotype vectors using two different schemes. our first scheme corresponds to the model proposed by wang et al.  <cit>  : 
  <dig> yi=β0+∑gβg∑k∈cxikg+∑rsγrs∑∈c2xijrxiks+εi, 


where c and c <dig> are respectively the set of causal snps and causal interactions, and ε
i a random gaussian variable. for each causal gene g, we consider two causal snps and a coefficient β
g is assigned to the standardized sum of these causal snps. in the same way, for the interactions, all the causal snps from a causal pair  are pairwise multiplied and a coefficient γ
rs is assigned to the standardized sum of the product.

our second scheme for simulating phenotypes is based on the following model: 
  <dig> yi=β0+∑gβg∑k∈cxikg+∑rsγrs∑∈c2cijrciks+εi. 


the difference with the first model concerns the simulation of the interaction effect. in the second model the interaction effect for a causal couple  is defined as the product of the first pca component c.1r of gene r and the first pca component c.1s of gene s.

in both models, β
 <dig> is set to  <dig>  and ε
i are generated independently from a n, with σ
 <dig> determined from the coefficient of determination r
 <dig> that calibrates the strength of the association. both simulation models can be written as yi=xitβ+zitγ+εi where x the marginal effect genotype matrix and z the interaction effect matrix.

let us denote qϕ=βγ and 
 r2=∑qiϕ−y¯2∑qiϕ+εi−y¯2=∑qiϕ−y¯2∑qiϕ−y¯2+∑εi2+∑2εiqiϕ−y¯=∑qiϕ−y¯2∑qiϕ−y¯2+nvar^+2ncov^εi,qiϕ−y¯. 


we remark that: 
 2ncovεi,qiϕ−y¯=2ncovεi,qiϕ−∑jyjn=2ncovεi,qiϕ−∑j2nncovεi,yj=0−2covεi,εi=−2σ <dig> 


thus, replacing var^ by σ
 <dig>  and cov^ by −σ
2/n, we obtain r2≈∑2∑2+nσ2−2σ <dig>  this relation between r
 <dig> and σ
 <dig> gives us an expression for σ
 <dig> that depends on r
 <dig>  σ2=∑2r <dig> 

we looked at how much of the coefficient of determination r
 <dig> is explained by main effects, and how much is explained by interaction effects, in order to determine their respective roles in the model.

for a similar reason, when simulating phenotypes, wang et al.  <cit>  examined how much of partial r
 <dig> was due to interaction effects. they selected coefficient values so that 30% of the partial r
 <dig> was explained by interaction effects. li and cui  <cit>  did not use the r
 <dig> directly, but they simulated data assuming different proportions of interaction effects among the total genetic variance. in our study, once the phenotype y had been set for each simulated design matrix, we computed how much of the r
 <dig> could be attributed to interaction and main effects as pi=ri2rt <dig> and pm=rm2rt <dig> respectively, with ri <dig> the r-square value for the model containing only simulated interaction effects, rm <dig> the r-square value where there were only simulated main effects, and rt <dig> r-square value where there were both simulated main effects and simulated interaction effects.


scenarios in the first  simulation study, genotypes are simulated as described in the design. we considered six genes, each composed of six snps and for  <dig> subjects. we define one causal interaction between genes and two causal genes with main effects, and the simulation takes place using two alternative simulation settings: 
 one interaction and two main effects involving the same genes

 one interaction and two different main effects




for these two settings, different coefficients of determination, from  <dig>  to  <dig> , are considered and  <dig> iterations are performed.

in the second  simulation study, genotypes come from a real dataset comprising  <dig> individuals. at each iteration we randomly select six genes of various size  in the dataset. we consider the five following settings: 
 one interaction and two main effects involving the same genes

 one interaction and two different main effects

 one interaction effect only

 two main effects only

 no effects




for each setting, coefficients of determination, from  <dig>  to  <dig> , are considered and  <dig> iterations are performed.

for both simulation studies, main effects and interaction effects are weighted with the same coefficient values . for each interaction, the power is estimated as the proportion of detected interactions over the total number of simulations.

real data illustration
to illustrate our approach we applied the proposed method on three real datasets related to ankylosing spondylitis, thyroid carcinomas and inflammatory bowel disease.

the dataset regarding ankylosing spondylitis consists of the french subset of the large study of the international genetics of ankylosing spondylitis  study  <cit> . for this subset, unrelated cases were recruited through the rheumatology clinic of ambroise paré hospital  or through the national self-help patients’ association: "association française des spondylarthritiques". population-matched unrelated controls were obtained from the "centre d’etude du polymorphisme humain", or were recruited as healthy spouses of cases. the protocol was reviewed and approved by the ethics committee of the ambroise paré hospital. all participants gave their informed consent to the study. the application on thyroid carcinomas was carried out on a public dataset that came from the study of luzón-toro et al. on identification of epistatic interactions in two different types of thyroid carcinomas  <cit> . finally, we used the wellcome trust case-control consortium genome-wide association dataset to study inflammatory bowel disease.

RESULTS
simulation studies
in the following, we will refer to the different simulation settings by using letters as described in table  <dig> 



results from the simplified simulation study <dig> values. the last two columns show heatmap matrices reflecting the proportion of significant values for each variable and each method over the  <dig> simulations for different r
 <dig> values.
fig.  <dig> power and discoveries under a simplified context. the figures in the first column shows the power to detect interaction effects of the three methods depending on the r
 <dig>  the last two columns show the ratio of the number of times where each variable was significant to the total number of simulations for a given r
 <dig>  the panels a, b, c and d refer to the different simulation settings described in table 1





in the first setting , we consider genes  <dig> and  <dig>  both having main and interaction effects. when the phenotype is simulated using the wang pathway model, the g-gee and pls methods have a higher power to detect the interaction effect than pca method, which tends to identify only the two main effects of the two genes . whereas for pca and pls the power is nondecreasing with r
 <dig>  for g-gee we observe a u-shaped curve. for the smallest r
 <dig> values, which correspond to the most difficult cases, the power of g-gee to detect the interaction tends to decrease. when r
 <dig> values reach  <dig> , g-gee’s power to detect the interaction starts to increase. the situation is different for the main effects, since g-gee’s power to detect these increases continuously with r
 <dig> . for pls, the power to detect the interaction effect is continuously nondecreasing. note, however, that for this method one of the two main effects  is detected to the detriment of the second, regardless of the value of r
 <dig>  in the pca phenotype simulation model , g-gee has a higher power than the other methods to detect interaction effects while retaining a good specificity, whatever the value of r
 <dig>  the reasonably high power of the pca method can be explained by the similarity between the phenotype simulation model and the estimation model. it is worth noting that in this first setting, only a few variables are falsely significant, which reflects a good specificity for all methods .

in the second setting , genes  <dig> and  <dig> have only main effects, and genes  <dig> and  <dig> have only an interaction effect. when the phenotype is simulated using the wang pathway model, the interaction power of g-gee is uniformly higher than that of the other methods . for all values of r
 <dig>  pca tends to detect false main effects for genes  <dig> and  <dig>  but not to detect interaction effects. in the pca phenotype simulation , pca has a good power to detect interaction effects, but once again these good performances can be explained by the similarity between the simulation model and the estimation model. the interaction power for g-gee is lower, but still good. with this model, only g-gee tends to attribute a false main effect to genes  <dig> and  <dig>  in this second setting, whatever the phenotype simulation model, the power of the pls method is almost null. pls identifies only the first gene as having a main effect, while the effects of genes  <dig> and  <dig> are not detected, whether as main or as interaction effects. moreover, pls tends to attribute a false interaction effect between genes  <dig> and  <dig> 

to evaluate the performances of the different methods in a more complex context, we also consider a setting where we simulate  <dig> genes with four causal interactions between genes, and two genes with causal main effects. in these simulations, interaction genes are different from main effect genes, and we only consider the case where r
2= <dig> . the results of this setting reflect the good performance of the g-gee method over pca and pls in detecting interaction in a context where further interactions and different main effects are simulated .

results from the realistic simulation study
figures  <dig> and  <dig> show results for the first three settings. fig.  <dig> shows the power to detect gene interaction depending on the r
 <dig>  and fig.  <dig> shows heatmaps of significant effects when r
2= <dig> . in both figures, the upper row relates to phenotypes simulated using the wang pathway model, and the lower row to phenotypes simulated using the pca model.
fig.  <dig> power under a realistic context. the figures show the power to detect interaction effects of the three methods depending on r
 <dig>  the panels a, b, c, d, e and f refer to the different simulation settings described in table 1



fig.  <dig> discoveries under a realistic context. heatmaps of the ratio of the number of times where each variable was significant to the total number of simulations for r
2= <dig> . the panels a, b, c, d, e and f refer to the different simulation settings described in table 1





in the first setting , the same two genes  are simulated with main and interaction effects. in this setting g-gee has the best power to detect interaction effects for all r
 <dig> values. the interaction power of pls remains close to  <dig> . the power of pca depends on the phenotype simulation model. when the phenotype is simulated using the wang pathway model, the power is similar to pls. when it is simulated using pca it increases continuously, because of the similarity between the phenotype simulation model and the estimation model. looking at the heatmaps  we can see that only a few variables are falsely significant. we also observe that unlike g-gee, pca and pls can detect the two simulated main effects, with a preference for gene  <dig> in the case of pls. these results are obtained when r
2= <dig> , but other r
 <dig> values give similar results .

in the second setting , main effects are simulated for genes  <dig> and  <dig>  and one interaction is simulated between genes  <dig> and  <dig>  in this setting the power of pls to detect interaction effects is almost null, while the respective powers of pca and g-gee are different, according to which phenotype simulation model is used. both methods have a higher power when the phenotype is simulated using the pca model. regarding the detection of main effects, the results are similar to the first setting, with g-gee less successful than pca and pls . but unlike in the first setting, here some variables are falsely significant. false detections among interaction variables are more pronounced for g-gee and concern genes that have been simulated to have only main effects. false detections among main effects are more pronounced for pca and pls when the phenotype is simulated using the wang pathway model and concern genes that have been simulated to have an interaction effect. under the pca phenotype model, false detections among main effects are more pronounced for pls and g-gee when r
 <dig> values are higher .

in the third setting, where only one interaction is simulated between genes  <dig> and  <dig>  g-gee has a higher power to detect interaction than pls and pca when the phenotype is simulated using the wang pathway model . the power of pca is higher in the pca phenotype simulation model because of its similarity to the estimation model, whereas the power of pls is almost null . in the wang pathway phenotype simulation model, pca and pls both falsely detect main effects. in the pca phenotype simulation model, the false detections are made by pls and g-gee . in all cases these false detections concern genes that are simulated to have an interaction effect.
fig.  <dig> discoveries for the fifth and the sixth settings. heatmaps of the ratio of the number of times where each variable was significant to the total number of simulations for r
2= <dig>  when only main effects are simulated for gene  <dig> and gene  <dig> , and when no effects are simulated 




in all settings, estimating the coefficients with the group lasso is more computationally expensive than constructing the interaction variables. g-gee and pca are quite similar in terms of computation time, whereas in some settings pls has a slightly greater execution time than other methods. note that the time required by g-gee for constructing the interaction variables varies according to the number of snps that constitute each gene .

percentage of r <dig> attributable to interaction and main effects respectively
using each setting in both simulation studies, we determine the p
i and p
m average values that correspond to the proportion of the r
 <dig> attributed to interaction and main effects, respectively. for most settings, the p
i depends on the number of simulated effects. with one interaction and two main effects simulated the r
 <dig> part attributable to interaction effects is around 33% , table  <dig> ). for the setting with numerous effects , the average p
i is 67% because we consider four interaction effects for only two main effects. finally, as expected, when only interaction effects are simulated, the average p
i is 100% ) and 0% when only main effects are simulated ). however, the r
 <dig> distribution between main and interaction effects is not distinguishable in the setting where the phenotype is simulated using the wang pathway model with the same main and interaction effects. the p
i and p
m values are all above 90% , table  <dig> ). in the second simulation study, the r
 <dig> distribution is also not well divided between main and interaction effects when the phenotype is simulated under the pca model, though p
m is still higher than p
i ). <dig> attributable to interaction and main effects, by setting, in the first simulation study

r
r
r
r
r
r
r
r

p
i

p
m
 <dig> attributable to interaction and main effects, by setting, in the second simulation study


p
i

p
m



real data illustrations
ankylosing spondylitis
ankylosing spondylitis  is a common form of inflammatory arthritis predominantly affecting the spine and pelvis. it occurs with a prevalence of  <dig> % to  <dig> % depending on the considered population  <cit> . genetic factors account for more than 90% of the risk of susceptibility to as. human leukocyte antigen  class i molecule hla b <dig>  belonging to the major histocompatibility complex  region, was the first genetic risk factor identified as associated with ankylosing spondylitis in the 1970’s  <cit>  and remains the most important risk locus for this pathology. despite the strong association only a small portion of hla-b <dig> carriers develop the disease. furthermore, studies in families suggest that less than 50% of the overall genetic risk is due to hla-b <dig>  which suggests that other genetic factors are involved  <cit> . a number of updated reviews on as genetics, including genome-wide association study  results, identified new ankylosing spondylitis-susceptibility genes outside of the mhc region  <cit> .

we applied all the methods described above to the as dataset. the data contain  <dig> cases and  <dig> controls, and each individual was genotyped for  <dig>   <dig> snps with immunochip technology. for each snp we obtained detailed genetic information, such as gene affiliation, with the ncbi2r package  <cit>  which annotates lists of snps with current information from ncbi. we considered only snps located within a single gene in order to form gene groups without overlap. we focused our analysis on a list of  <dig> genes previously identified as having a main effect in gwas.

the three methods tested yield different results, and only the pls and g-gee methods identify interactions. pca detects only the main effect hla-b and identifies no interactions. pls detects the main effect hla-b, but also identifies one interaction effect between the genes eomes and bach <dig>  our method g-gee does not detect any main effects, but it shows two significant interactions, the first between the genes hla-b and sult1a <dig> and the second between il23r and erap <dig> 

thyroid carcinomas
thyroid cancers are thought to be related to a number of environmental and genetic predisposing factors and can be classified in various types and subtypes. most association studies have focused on main effects but only a limited number of genes were identified. recently, some papers focus on the detection of epistatic interactions  <cit> . we applied our proposed approach on the two data sets used in luzón-toro et al.  <cit>  regarding two rare tumours, sporadic medullary thyroid carcinoma  and juvenile papillary thyroid carcinoma . affymetrix genome-wide human snp  <dig>  arrays were used to hybridized dna. the data set related to smtc contains  <dig> cases and the jptc data set  <dig> cases. the same  <dig> healthy controls and  <dig>   <dig> snps were used for both studies. as for the ankylosing spondylitis dataset, we obtained gene affiliation for each snp with the ncbi2r package and considered only snps located within a single gene. we focused the analysis of the smtc data set on a list of  <dig> genes,  <dig> of these genes  were chosen following the conclusions of luzón-toro et al., the others because they contained markers that were susceptible to be associated with the disease from univariate analysis. the analysis of the jptc data set was realized on a list of  <dig> genes among them we can cite dio, rp11-648k <dig> , loxl <dig>  dmgdh, pax <dig> and stk17b from which epistatic interaction were already detected . the  <dig> others genes contained susceptible associated individual markers from univariate analysis. regarding the smtc study, g-gee identifies one interaction between genes nck <dig> and triqk. pca detects only one main effect for the gene triqk whereas none effects were identified with pls. concerning the jptc data set,  <dig> interactions were identified by g-gee . pls identifies  <dig> interactions  and pca detects only one main effect for the gene loc <dig>  we note that the effects detected with our approach concerned different genes that the ones identified in the presented previous studies . more analysese are needed to better understand these differences.

inflammatory bowel disease
although the etiology of inflammatory bowel disease  is not completely understood, previous studies have underlined the contribution of an important genetic susceptibility. recently, martinez-chamorro et al.  <cit>  detected an epistatic interaction between the genes nod <dig> and tlr <dig>  we applied our approach to the wellcome trust case-control consortium genome-wide association dataset for inflammatory bowel disease. the data contains  <dig> case for  <dig>  <dig> snps genotyped by affymetrix. the control group was constituted of  <dig> individuals from the wellcome trust case-control consortium genome-wide association dataset for hypertension. as for the two previous real data analysis, we obtained gene affiliation for each snp with the ncbi2r package and considered only snps located within a single gene. the analysis was realized on a list of  <dig> genes that contain snps that are suspected to be associated with ibd from an univariate analysis. the two genes nod <dig> and tlr <dig> were added to the list as they were previously detected as having an epistatic interaction. g-gee identifies one interaction between the genes loc <dig> and cacnb <dig> whereas pca detects  <dig> main effects  but none interaction. finally pls identifies  <dig> main effects for the genes il23r, podn and dnah <dig> as well as  <dig> interactions the first one between the genes podn and fcrla, the second one between pvt <dig> and nod <dig> 

discussion
the results obtained in both simulation studies point to a certain confusion between main and interaction effects. when simulated interaction and main effects involve different genes, the methods tend to detect as interaction effects the pairs of genes simulated to have main effects and, conversely, to detect as main effects the genes simulated to having interaction effects.

overall, g-gee tends to detect more false interactions than false main effect whereas pls and pca tend to detect more false main effects though pls tends to attribute a false interaction effect between genes  <dig> and  <dig>  this type of confusion may explain the u-shaped power curve for g-gee observed in the first simulation study . as the problem becomes harder, the genetic effects of both genes are preferentially assigned to the interaction effect, implying a better power to detect interaction where r
 <dig> values are small. finally, we remark that for g-gee false detections of main effects are more frequent when the pca phenotype simulation model is used, whereas for the pls and pca methods, where the number of false detections for main effects is higher when the wang pathway phenotype simulation model is used.

other observations regarding the power of the different methods can be made with these simulation results. pls has more trouble than pca and g-gee in detecting interaction effects, and has a tendency to detect the first main effect with a higher power than the second main effect when two main effects are simulated. for all methods, the power to detect interactions increases more slowly with respect to r
 <dig> when simulations are performed using real data genotypes than with fully simulated genotypes, but we observe that in the first setting the curve representing the interaction power of g-gee is detached from the others, reflecting the superior performance of g-gee over pls and pca. note that the power of g-gee to detect main effects is always less than that of pca and pls when r
2< <dig>  . in short, g-gee performs better when detecting interactions than when detecting main effects.

CONCLUSIONS
in this paper we compared different approaches for modelling gene-gene epistasis in a penalized regression framework. our primary concern was the detection of interaction effects, and for this purpose we defined a general model and tested different interaction terms. we focused our analysis at the gene scale and compared three ways to design the interaction term. some methods were inspired by previous proposed approaches based on dimensional reduction methods including principal component analysis  and partial least square analysis . we additionally proposed a new interaction modeling approach that we called gene-gene eigen-epistasis , where one interaction variable is built for each couple. the interaction variable was defined based on a criterion that maximizes the covariance between the phenotype and the pairwise snp product matrix of the two genes. the interaction components were then introduced in a group lasso penalized regression model that takes the gene structure into account and is capable of handling a large number of genes simultaneously.

a power study of the different methods based on two different simulation schemes  provided us with a rich body of information. across various papers in the literature we find comparisons of similar methods that use different phenotype simulation settings. in the present work we compared two simulation models. our first model was from a previous study  <cit>  that simulated the interaction component of each couple in an snp pairwise product fashion. our second model defined the interaction component as a pairwise product of representative variables of each gene. overall the g-gee method performed well in detecting interactions in all the settings that were tested, although it was not always able to do so in the settings where main and interaction effects involved different genes. the power of the pca method is highly dependent on the phenotype simulation model, because of the similarity between the second phenotype simulation model and the estimation model of the pca method. the pls method is characterized by a lack of power in detecting interactions. pls performs well only when the related main effects are also present. when the simulated main and interaction effects do not concern the same genes, the detection capability of the pls approach collapses dramatically.

for all methods we observed a confusion phenomenon when active genes are not simulated with both main and interaction effects. false detections of interactions concern genes that were simulated to have main effects, and false detections of main effects concern genes simulated to have interaction effects. this phenomenon reveals the difficulty that all methods encounter in clearly distinguishing the different types of effects. there are more false main detections when using methods such as pca and pls that are better at detecting main effects . as for interaction effects, the g-gee methods make more false interaction detections than pca and pls.

when genotypes are fully simulated in the simplified simulation study, the g-gee and pca approaches performed better when the pca phenotype simulation model was used, whereas the pls method was not very sensitive to the choice of phenotype simulation model. unlike pca and pls, g-gee is better at detecting interaction effects than at detecting main effects when simulations use a real data set. since the simulation study using realistic data is meant to mimic real genotype data structure, we conclude that in a real context g-gee will be better at detecting interaction effects than main effects.

in comparison to snp-snp interaction approaches, the gene-scale dimension of our proposed method means that considerably fewer interaction variables need to be considered within a genetic region. this reduction in problem size allows larger problems to be handled. moreover, a penalized regression method allows a true multivariate approach over a larger number of genes. it also extends other proposed gene-scale approaches, such as that presented by wang et al.  <cit> . the ability to handle a relatively large number of genes simultaneously makes the detection of interactions between different genetic regions possible. this might be useful as an initial step, prior to using snp-snp interaction methods that may provide more accurate information.

as the g-gee method is not able yet to consider all human genes at the same time, it is necessary to specify a list of genes to be explored for potential interactions. given that its power to detect main effects is low, for the detection of main effects it will be safer to use previously acquired knowledge of the genetic effects, or to use a pre-processing method. another limitation of the method is gene size. computing the gene eigen-epistasis vector for two genes of size p
r and p
s requires an n× matrix to be computed.

prospects are improving the g-gee method’s performance by optimizing the computational cost and exploring new interaction functions to be plugged into the g-gee criterion.

additional files

additional file  <dig> 
figure s <dig>  comparison of power to detect main effects in the simplified simulation study. power under a simplified context. the figures show the power to detect main effects of the three methods depending on r
 <dig>  





additional file  <dig> 
figure s <dig>  simulation on  <dig> genes with fully simulated data and various simulated effects. discoveries for the setting with numerous effects. heatmap of the ratio of the number of times where each variable was significant to the total number of simulations for r
2= <dig>  using the wang pathway model for the phenotype simulation with fully simulated data. we consider  <dig> genes with two main effects for genes  <dig> and  <dig>  and four interaction effects between genes  <dig> and  <dig>  genes  <dig> and  <dig>  genes  <dig> and  <dig>  and genes  <dig> and  <dig>  





additional file  <dig> 
figure s <dig>  discoveries in the realistic simulation study with r
2= <dig> . discoveries under a realistic context. heatmaps of the ratio of the number of times where each variable was significant to the total number of simulations for r
2= <dig> . 





additional file  <dig> 
figure s <dig>  comparison of execution time required to model interaction and to fit group lasso for the five first settings of the realistic simulation study. execution time. median of the execution time to model interaction and to fit group lasso for the five first settings of the realistic simulation study. 





additional file  <dig> 
figure s <dig>  comparison of power to detect main effects in the realistic simulation study. power under a realistic context. the figures show the power to detect main effects of the three methods depending on r
 <dig>  




abbreviations
3g-spamodel-based kernel machine method

asankylosing spondylitis

ccacanonical correlation analysis

ccucanonical correlation-based u-statistic model

ggeegene-gene eigen-epistasis

gwasgenome-wide association studies

hlahuman leukocyte antigen

ldlinkage disequilibrium

mafminor allele frequency

mhcmajor histocompatibility complex

pcprincipal components

pcaprincipal component analysis

plspartial least squares

snpsingle-nucleotide polymorphism

