BACKGROUND
systems-based approaches coupled with experimental data have facilitated greater understanding of large-scale biological systems  <cit> . for example, optimization procedures have recently been used to characterize systemic properties in biology, including phenotypic properties like growth rates and effects of gene knockouts  <cit> . one quantitative measure of a biological phenotype is the set of fluxes through all reactions within a biochemical network  <cit> . specifically, flux balance analysis  is a constraints-based approach that calculates steady-state flux distributions  <cit> .

fba has traditionally been based on the premise that prokaryotes such as escherichia coli have maximized their growth performance as a response to selective pressure  <cit> . consequently, a common objective function in fba of metabolic networks is the maximization of the rate of synthesis of biomass, a unit of measurement of cellular growth. however, as other types of networks and higher-order systems are interrogated, other objectives may be more accurate in predicting phenotypes. for example, other objective functions that have been previously considered in fba include optimization of energy production or consumption  <cit>  and byproduct synthesis  <cit> . by inferring objective functions of biological systems, cellular design principles may be studied and systems may be exploited for engineering of metabolic byproducts of commercial or medical value  <cit> .

in silico frameworks for determining a most-likely objective function have previously been proposed. one such tool, named objfind, attempts to identify weightings, termed coefficients of importance , on reaction fluxes within a network while minimizing the difference between the resultant flux distribution and known experimental fluxes  <cit> . in the objfind framework, a high coi indicates a reaction that is more likely a component of the cellular objective function, given available experimental fluxes. however, objfind is unable to a priori define objectives, since in fba the objective function is defined as a single reaction within the system  and not a weighting on multiple reactions . for example, if the true objective reaction has not been experimentally characterized and is not included within the network reconstruction, objfind is unable to assign the highest coi to it and instead chooses an alternate  reaction or set of reactions as constituting the objective function. two recent efforts have further attempted to identify the most probable objective of a metabolic system from a set of possible objectives, in one case via a bayesian-based probability ranking  <cit>  and in the other case using an euclidean metric  <cit> . however, like objfind, each of these methods requires that the stoichiometric network reconstruction include the true objective function as an existing reaction in order to yield meaningful predictions.

we present a novel framework, biological objective solution search , for identifying objective functions of biological systems based on the stoichiometry of the underlying biochemical network and known experimental flux data. in this framework, the biological objective function is a de novo reaction  that is added to the matrix s representing the stoichiometry of the underlying system. subsequently, the flux through this particular objective reaction is optimized  as the objective function using the standard fba approach. notably, the objective reaction is not confined to be one of a subset of existing reactions, but rather is allowed to take on any form  as specified by an optimization procedure. it is, however, confined to be one linear stoichiometric reaction whose coefficients are determined by the framework.

to illustrate this novelty of boss over existing methods , consider the simple system drawn in figure  <dig>  this system is comprised of three components and five reactions. the objective reaction is denoted as robj. assume that a network reconstruction based on available literature includes all three components and four of the five reactions but excludes the actual system objective, robj, governing the resultant flux distribution. as shown in figure  <dig>  analyzing the network with an approach like objfind generates a rank-ordered list of the reactions that best describe the objective function. however, since robj is unknown, the calculated objective will be some combination of weightings on r <dig> through r <dig>  and the approach will fundamentally fail to capture the actual objective of the system robj. however, as shown in figure  <dig>  by generating a de novo stoichiometric reaction as its objective function, boss would in theory be able to recapitulate the actual system objective.

we applied boss to the previously reconstructed s. cerevisiae central metabolic network  <cit>   to evaluate which objective reaction it infers for that system given a set of isotopomer flux data  <cit> . we compared the boss-derived objective reaction to the hypothesized system objective of precursor biomass synthesis. we considered two cases, one in which the hypothesized objective reaction  was excluded from the system and another in which it was included within the set of known stoichiometric reactions. we further assessed how boss handles noise in experimental flux distributions. finally, we compared our results to a negative control in which flux distributions comprised of randomly generated values were inputted into boss. ultimately, we illustrate how boss extends existing objective function identification tools by inferring the objective reaction of a biochemical network de novo from internal state measurements, and how this tool therefore facilitates future study of cellular design principles and cellular engineering approaches.

methods
the framework that we present for identifying a putative objective function for a given biological system constitutes a single-level optimization problem. specifically, boss integrates network stoichiometry, physico-chemical constraints such as reaction bounds, and experimental flux data to generate a novel stoichiometric reaction corresponding to the most likely objective function of the system. the framework and implementation strategies are described here.

flux balance analysis 
a key feature in the application of fba is the optimization of an objective function subject to fundamental constraints on cellular function  <cit> . fba requires a stoichiometric network reconstruction, usually represented as a stoichiometric matrix, s, in which components are delineated as rows, component interactions as columns, and stoichiometric relationships as coefficients . this reconstruction, coupled with reaction fluxes, comprises the principal constraint in fba, i.e., at steady-state, for each component, the sum of the stoichiometric coefficients multiplied by the corresponding reaction fluxes must equal zero to ensure that mass is balanced within the system.

commonly used objective functions  in fba of metabolic networks include biomass production  <cit> , energy production or consumption  <cit> , and byproduct production  <cit> . the objective function used in fba is assumed to be linear by a first-order approximation, since this form simplifies computation and reduces the number of parameters to be defined in the objective experimentally. changes in a linear objective under varying growth conditions have been observed  <cit> .

fba-predicted flux distributions have displayed agreement with experimentally-measured flux data in some cases  <cit> . furthermore, fba has yielded insights into optimal targets for metabolic engineering  <cit>  and adaptive evolution of e. coli strains  <cit> , among other applications  <cit> . additionally, fba has successfully predicted metabolic phenotypes of cellular systems by hypothesizing biomass production as the objective function  <cit> . however, other objectives may be equally successful at predicting phenotypes for particular conditions  <cit> . furthermore, a metabolic objective may change at different stages of an organism's life cycle  <cit> . some studies suggest a greater role for environmental factors in determining cellular objectives than is assumed when fba is employed with a biomass production objective  <cit> . ultimately, as additional network reconstructions are completed and experimental flux data are obtained, there is increasing interest in determining realistic objective functions to explain systemic behavior  <cit> .

formulation of the objective function-finding algorithm boss
the boss framework initially takes the form of a bi-level optimization problem that minimizes the sum-squared error between experimentally-measured  fluxes and framework-computed  fluxes  , line 1), subject to the condition that a cellular objective is simultaneously maximized  . the inner problem takes the canonical form of a fba problem, wherein an objective reaction introduced to the network is maximized  subject to thermodynamic , mass balance , and uptake  constraints. the coefficients of the objective reaction are unknown and part of the solution space.

in order to make this bi-level optimization problem computationally tractable, we reformulated it as a single-level optimization problem via the duality theorem of lp, as previously described  <cit>  ). specifically, the revised form is comprised of an objective that aims to minimize the sum-squared error between experimentally-measured and framework-computed fluxes  subject to a set of primal  and dual constraints . the objective in line  <dig> is equivalent to the outer objective of the bi-level optimization problem , line 1), and the primal constraints in lines  <dig> through  <dig> are equivalent to the constraints in the original bi-level optimization problem , lines  <dig> through 5). two additional constraints are included in the single-level optimization framework. specifically, the value of the primal and dual problems are set equivalent to one another , and the flux distribution corresponding to the new objective reaction is normalized to a specific value . as described in the caption for figure  <dig>  the decision variables in this optimization are:  the stoichiometric coefficients of the objective reaction, si, objective where i ∈ n, or the set of metabolites, and "objective" denotes the new objective reaction;  the framework-computed fluxes vexperimental;  the dual variable g associated with the uptake constraint; and  the dual variables u indicating shadow prices on the mass balance constraints for each metabolite in the system.

due to the large number of decision variables, large solution space, existence of multiple local optima, and inherent non-convexity of the problem, we instituted a multiple restart approach, wherein the optimization is run multiple times, each time with different randomly-selected starting values for the decision variables  , item 3). the output of this approach is a series of putative objective reactions, one for each restart. objective reactions that yield a poor value in the outer optimization  are removed from the solution set. the remaining putative objective reactions are then clustered into groups based on similarity, and the most populous cluster is chosen as the consensus objective reaction , item  <dig>  as well as additional file 2). this last step seeks to eliminate solutions to the outer problem that constitute suboptimal local minima. it is assumed that the global minimum to the outer problem  will draw from a larger portion of the initial state space than any local minimum, and thus will gather the greatest proportion of the restarts when solutions are clustered.

this single-level optimization with multiple restarts, followed by clustering and subsequent averaging of the most populous cluster, ultimately yields a stoichiometrically-weighted reaction for which the metabolic network is optimized. this reaction represents a best hypothesis for the network objective function based on available data about the system. determination of the objective reaction in this manner offers a means to gain insight about network and sub-network objectives and behavior.

biological system evaluated: the s. cerevisiae central metabolic network
the previously reconstructed s. cerevisiae central metabolic network  <cit>  was used to assess the boss framework . this network is a subset of the genome-scale s. cerevisiae metabolic reconstruction  <cit>  and comprises the major carbohydrate metabolism pathways of glycolysis, pentose phosphate, and the citrate cycle, the principal energy metabolism pathway of oxidative phosphorylation, and a precursor biomass synthesis reaction. the network is comprised of  <dig> metabolites participating in  <dig> reactions, including six exchange reactions,  <dig> intracellular reactions, and one precursor biomass synthesis reaction.

a flux distribution for the central metabolic network was previously characterized experimentally  <cit> . this distribution was obtained by gc-ms tracing of 13c-labeled isotopomers, and corresponds to yeast cells cultivated in batch culture with glucose as the limiting substrate and at a maximum specific growth rate, μmax, of  <dig>  h- <dig>   the boss framework was applied to this data set.

in addition, the precursor biomass synthesis reaction, which balances the major metabolites from central metabolism that contribute to biomass, was hypothesized to be the "true" objective function of the system for testing the boss framework. this hypothesis was based on the underlying premise described previously that organisms have maximized their growth performance through natural selection  <cit> . the precursor biomass synthesis reaction was previously characterized experimentally  <cit> . it is important to note that boss does not require an assumption of an objective function, and we demonstrate below the success of boss at generating a hypothesized objective function de novo.

implementation details
the general implementation scheme for boss is illustrated in figure  <dig>  specifically, we inputted the stoichiometric network reconstruction and isotopomer flux data for the s. cerevisiae central metabolic network into boss ) and assessed the objective reaction that it derived ). we evaluated two conditions, one in which the hypothesized objective function of precursor biomass synthesis was included in the network reconstruction inputted into boss and another in which it was excluded. in the second case, boss yielded a zero-vector for the objective reaction, suggesting that the true objective was already a part of the network reconstruction. therefore, we altered boss slightly to identify which of the reactions was the likely objective: we removed, one by one, each reaction flux from the set of experimental flux data , and identified in each case the sum-squared error between the boss-derived objective reaction and the reaction corresponding to the removed flux. the reaction that exhibited the smallest sum-squared error through this method was identified as the objective function. this approach was utilized to ensure that, if the actual system objective is already in the stoichiometric network reconstruction, the outer optimization problem of boss does not force flux to go through that reaction and rather allows the flux corresponding to the new objective function column to be maximized as part of boss.

we considered one additional in silico experiment to evaluate how well our framework handles the kind of variability that is characteristic of actual flux measurements. specifically, we assessed how a varying amount of noise introduced to the set of experimental flux data affects the objective function derived by boss.  to perform this test, additional steps were performed during data preparation , item 2). first, each experimental flux for the s. cerevisiae metabolic network was varied randomly via a normal distribution, with standard deviation equal to a set percent of the initial value of the flux. different percent variances, ranging from five percent to  <dig> percent in increments of five percent, were considered. fluxes with an initial value of zero were varied with a standard deviation equal to that of the smallest nonzero flux in the system. boss was fed these varied fluxes as "experimental" fluxes. to avoid biasing results toward one particular variant of the "experimental" fluxes, we repeated multiple times this process of randomly varying the experimental flux distribution. in other words, for any given percent variance, we tested multiple noisy flux data sets . consequently, when considering the results of any boss run on noisy flux data, we evaluated the coefficients of the objective reaction for each noisy flux data set independently.

assessing the results of boss
to assess the accuracy and efficacy of our boss-derived results, we considered two statistical measures. first, we computed the sum-squared error between the coefficients of the boss-derived objective reaction and the coefficients of the hypothesized objective reaction , normalized to the magnitude of the hypothesized objective reaction column vector. this term is abbreviated sses throughout the manuscript. second, we computed the sum-squared error between the reaction fluxes outputted by boss and the experimental fluxes inputted to the framework and specified as constraints. this term, which is equivalent to the function being minimized in the boss outer optimization problem, is abbreviated ssev throughout the manuscript. ideally, smaller values of ssev should correspond to smaller values of sses, as smaller values of sses imply more accurate objective reactions.

technical implementation
simulations of boss were run with gams v. <dig>  on microsoft windows xp professional and linux  machines. the minos <dig> nlp  solver was utilized. results were analyzed using code written in matlab v. <dig>  , with clustering functionality provided by the matlab statistics toolbox .

RESULTS
the s. cerevisiae central metabolic network was used as an experimental system to evaluate the ability of boss to identify objective functions of biological systems. additionally, the network was used to evaluate how well the framework handles noise in flux distributions, which is a characteristic of actual experimental measurements. these results were contrasted with randomly-generated flux data for the s. cerevisiae central metabolic network as a further validation of the boss framework. we summarize the results here.

validation of objective function identification
in inferring the objective function for the s. cerevisiae metabolic network with boss, two conditions were evaluated. in the first one, the hypothesized objective reaction  was excluded from the stoichiometric network reconstruction. boss identified coefficients approximately equal to that of the precursor biomass synthesis reaction ). the sum-squared error between the boss-computed objective reaction and the experimentally-derived precursor biomass synthesis reaction, normalized to the magnitude of the precursor biomass synthesis reaction , was  <dig>  × 10- <dig>  the magnitude of this sses suggests that boss derives an objective reaction equivalent to the precursor biomass synthesis reaction, well within the limits of numerical tolerance.

we also implemented boss on the complete s. cerevisiae central metabolic network, i.e., without removing the precursor biomass synthesis reaction. when the precursor biomass synthesis reaction was thus included in the set of stoichiometric reactions, boss yielded a zero-vector for the objective reaction , suggesting that the actual system objective was already a part of the stoichiometric network reconstruction ). subsequently, we individually removed each of the reaction fluxes from the pool of experimental fluxes defined in the outer optimization problem of boss ) and observed the resultant stoichiometric coefficients that boss derived for the objective function. sses values between the reaction whose flux was removed from vexperimental and the boss-derived objective reaction given removal of that flux were compared for each reaction in the system ). the reaction with the smallest sses  was the hypothesized system objective of precursor biomass synthesis . this result further validated the ability of boss to identify objective reactions with previously known as well as unknown stoichiometry  and 4). interestingly, the reaction with the next smallest sses  was the atp maintenance reaction, a reaction that has also been evaluated as an objective of metabolic networks under some conditions  <cit> . all other reactions in the network had sses values that were at least an order of magnitude higher. this key result is also a direct validation of the hypothesis that biomass production is a reasonable objective function for many metabolic networks; with the experimentally-generated flux data, boss derived an objective function highly correlated with biomass production although there was no such assumption a priori.

it is important to note that application of fba to the s. cerevisiae metabolic network does not yield the experimental flux distribution measured by  <cit> . because fba problems have large convex solution spaces, many different flux distributions yield equally optimal results. therefore, it is significant that boss is able to infer the correct coefficients for the precursor biomass synthesis reaction in spite of this difference. furthermore, although maximization of biomass synthesis is hypothesized as the objective of a metabolic network, the experimental flux data are calculated based on isotopomer measurements and the underlying system stoichiometry but is not biased toward this objective. thus, the characterization of biomass as the system objective by boss is a novel validation of this theoretical assumption.

accounting for limitations in experimental measurements: noisy flux data
to account for current limitations in experimental  technologies for measuring reaction fluxes, the s. cerevisiae central metabolic network was evaluated by boss when different levels of noise were introduced into the experimental flux data. different percentages of deviation for the flux data were evaluated to determine how quickly the accuracy of the boss-computed objective reaction degrades with noisy data.

the results for the s. cerevisiae network when varying levels of noise are introduced into the individual flux values are illustrated in figure  <dig>  for the purposes of this evaluation, based on the results described above, the hypothesized objective reaction of precursor biomass synthesis was included as part of the underlying network stoichiometry inputted into boss, and the set of experimental fluxes consisted of all fluxes except for the flux corresponding to this reaction. figure  <dig> illustrates the normalized sum-squared error between the boss-derived objective reaction and the hypothesized objective function of precursor biomass synthesis  for different percent variances in experimental flux data, ranging from five percent to  <dig> percent in increments of five percent.  illustrates the mean sses across these  <dig> distributions, as well as the associated standard deviation within sses across these  <dig> distributions.) up to about  <dig> percent variance in the flux data, sses <  <dig>  i.e., boss is able to generate reconstructions of the hypothesized objective reaction orders of magnitude more accurately than when random flux data are inputted into boss . as expected, with increasing noise, the results of boss exhibit increasing mean sses values and the variability of sses across different initial flux sets is higher. these data support the utility of our framework in identifying objective functions for biological systems given the current state of experimental flux measurements.

to further highlight boss's performance on noisy flux data, snapshots of the objective reactions that it generated at different flux variances are illustrated. specifically, figures  <dig>   <dig>  and  <dig> correspond to the coefficients identified by boss  overlaid on the precursor biomass synthesis reaction  for flux variances of  <dig>   <dig>  and  <dig> percent, respectively.  for smaller flux variances, the pattern of the coefficients identified by boss follows that of the hypothesized network objective of precursor biomass synthesis that was used to generate the noisy flux data ). as expected, the more noisy the flux data, the less precise the objective reaction identified by the framework ).

it is important to note that this analysis involves artificially adding noise to an experimental flux distribution. although the original experimental fluxes are based on a steady-state metabolic model of yeast central metabolism, it is likely that there is some degree of noise already within the data set as part of the experimental protocol. consequently, the studies with noise presented here include even higher degrees of noise than the five to  <dig> percent spectrum evaluated. nevertheless, the results suggest that boss performs well, to an extent, with noisy experimental data.

control case: random flux data
to place these results in context, randomly-generated flux values coupled with the underlying network stoichiometry for the s. cerevisiae central metabolic network were inputted into the boss framework as a negative control. these fluxes were generated by specifying a normal distribution statistically similar to the characteristics of the experimental flux distribution. specifically, the randomly-generated fluxes were centered at a mean of  <dig>  mmol/g·h with a standard deviation of  <dig>  mmol/g·h, identical to the mean and standard deviation of the experimental fluxes reported in  <cit> . for this test of random flux data, no reaction was removed from the stoichiometric network reconstruction inputted into boss to avoid biasing results in any way toward a particular objective. however, to ensure that flux was driven through the objective reaction, thus minimizing ssev ,  <dig>  and 4), the flux for the precursor biomass synthesis objective reaction was not included in the pool of experimental flux data inputted into boss, as described earlier. a total of  <dig> randomly-generated flux distributions, each with mean and standard deviation consistent with the experimental flux data, were evaluated, and the sses between the hypothesized objective reaction of precursor biomass synthesis and the boss-derived objective reaction was  <dig>  ×  <dig>  in addition, the ssev was  <dig> . these results are orders of magnitude higher than when actual experimental flux data, or even noisy experimental data, are specified , thus further confirming the utility of boss in inferring objective functions of biological systems with internal state measurements.

CONCLUSIONS
we present a novel framework called biological objective solution search  that integrates network stoichiometry and experimental flux data to determine the most likely objective function for a given biological system. we illustrate the utility of boss on a model of s. cerevisiae central metabolism with a variety of input conditions, including experimental  flux data, varied experimental flux data meant to mimic noise in experimental measurements, and randomly-generated fluxes. when the underlying network stoichiometry and all reaction fluxes are specified, boss identifies an objective reaction with a normalized sum-squared error between the computed objective and the hypothesized objective   of  <dig>  × 10- <dig>  additionally, when noise is introduced into the flux data to simulate the types of error observed in experimental flux measurements, boss identifies the objective reaction with a sses of less than  <dig> for up to  <dig> percent experimental flux noise. thus, we show how boss can integrate network stoichiometry and internal state measurements, including in the case of noisy data, to predict the objective function of a biological system.

interestingly, researchers have theorized that, through evolution, metabolic systems have optimized for biomass production  <cit> . here we illustrate that our framework derives this hypothesized objective reaction, precursor biomass synthesis, based on the underlying network stoichiometry and a set of experimentally-measured flux data. this observation validates the boss framework and it further confirms the precursor biomass synthesis reaction as an objective of yeast central metabolism.

current challenges remain in the implementation of the boss algorithm. the transformation of a bi-level to a single-level optimization via the strong duality theorem  introduces a high degree of nonlinearity into the problem and non-convexity into the solution space, rendering the boss algorithm difficult for nonlinear solvers to tackle. further, the structure of the inner and outer problems suggests that the solution space for a boss problem is not smooth, but rather likely contains discontinuous rifts in the value of the optimization parameter  as one moves smoothly through the state space. these factors complicate the ability of boss to determine a global optimum with a small number of restarts, resulting in several hours to days of simulation time depending on the system and input conditions. perhaps stronger nonlinear solvers, more powerful dedicated computers, and more run-time would yield better predictions of objective functions. these challenges will need to be addressed as boss is scaled up to genome-scale applications.

another hurdle to the meaningful application of boss is the paucity of large-scale experimentally-derived flux sets in literature. isotopomer studies, as well as 13c-constrained fluxomics studies, tend to use simplified models of central metabolism that lump reactions together and thus fail to define a distinct flux for each reaction in the system  <cit> . these simplifications have been necessary due to experimental and computational hurdles, but they limit the degree to which experimental flux data can be used by boss. as more powerful fluxomics techniques are developed, more complete flux distribution maps will become available for analysis by boss  <cit> .

boss is distinguished from preexisting objective-searching algorithms in its ability to define an objective reaction absent previous knowledge of the stoichiometric structure of the objective function  <cit> . this attribute could prove useful in analyzing signaling and transcriptional regulatory networks, as their objectives are likely to be more loosely defined and poorly understood than those of metabolic networks  <cit> . likewise, studying objectives of multiple metabolically-interacting species or compartmentalized metabolic processes  offers fruitful challenges that cannot be described as simply biomass production. such analyses could lead to a greater appreciation of the driving evolutionary forces that govern these cellular processes, and could help explain how the whole-cell objective originates. a framework that predicts objectives of a biological system based on known properties of the system  thus has the potential to address many critical and timely questions in biology.

authors' contributions
eg and mo conceived of the study and participated in its design and implementation. jp conceived of the study and participated in its design and coordination. ab and cm helped with key analyses of the data. all authors read and approved of the final manuscript.

supplementary material
additional file 1
saccharomyces cerevisiae metabolism. a description of the s. cerevisiae central metabolic network from  <cit> , including reaction and metabolite listing, is provided.

click here for file

 additional file 2
clustering in boss. the clustering component of the boss framework, as implemented in matlab, is described.

click here for file

 additional file 3
evaluating data integration in boss. boss is applied to a prototypic system designed to illustrate the ability of the framework to infer an objective function by synthesizing information from multiple experimental conditions.

click here for file

 acknowledgements
we thank dr. kyongbum lee and ryan p. nolan for kindly sharing code with us, as well as dr. jong min lee, dr. kenneth crowther, arvind chavali, drake guenther, and michael ellis for insightful comments and feedback. additionally, we thank the national institutes of health  , the national science foundation , and the whitaker foundation for support.
