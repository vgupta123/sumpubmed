BACKGROUND
in the cellular immune system, peptide binding to mhc  is the most selective step in recognition of pathogens. in humans, there are three types of mhc molecules and their recognizing, binding, transporting and functioning mechanism are distinct. taking the mhc-i for example. proteins in the cytosol are first degraded by the proteasome, and then peptides are internalized by tap  channel in the endoplasmic reticulum, where mhc-i molecules freshly are synthesized. complexes of mhc-i binding to peptide enter golgi apparatus and finally externalize on the cell membrane to interact with t lymphocytes. correctly and precisely predicting the t cell epitope has realistic meaningfulness, especially important for the vaccine design. many experiments on analyzing the binding complexes of peptide and mhc indicate that the binding sites have the binding specificity. this specificity is usually determined by the molecular weight, the electric charge, the ph value and other attributes. in the past decades, many prediction methods have been proposed to predict the epitope. they could be categorized into the following types. the first one is the motif matching based methods. from the binding complex fragments of peptide and mhc, rudensky  <cit>  purified and detected the amino acid sequences, from which they proposed three binding motifs i-as, i-ab, and i-eb. according to these three motifs, cole  <cit>  successfully predicted mhc epitopes in the sendai virus m protein. analogous methods by checking whether peptides have the anchor sites matching with binding sites in the mhc molecules include works  <cit> . this kind of methods is simple and easy to understand but the prediction accuracy is not high. the second one is the scoring matrix based method. it could be viewed as the generalisation of the motif matching based method. for each type of mhc molecules, the existing peptide-mhc binding data are statistically analysed to generate a coefficient matrix, in which the element represents the degree of amino acid contributing to the binding when appearing in a certain position. parker  <cit>  used  <dig> synthetic peptides to get the molecule hla-a <dig> scoring matrix; kubo  <cit>  got the hla-a <dig>  hla-a <dig> and hla-a <dig> scoring matrix and udaka  <cit>  got h2-kb, db and lb scoring matrix respectively. other similar methods to build up mhc i class and class ii molecules' scoring matrix include propred  <cit> , arb  <cit> , smm  <cit> . given the scoring matrix of one mhc molecule, the strength of any peptide binding to it could be calculated in an addition or a multiple way. in comparison with the first type method, they usually have higher accuracy, but there still exist some shortcomings like that they assume each amino acid residue to independently affect the binding and ignore the interactions among the amino acid residues. in order to further improve the prediction accuracy, some methods try to consider the whole peptide sequence and establish more complex models to reflect the real situation. this category of methods includes the bayesian method   <cit> , hmm   <cit> , svm   <cit> , ann   <cit>  and so on  <cit> . before the prediction, the training process is essential for the prediction model. according to the different types of training data used, previous stated methods also could be categorized into the sequence-based methods and the structure-based methods. they have their own advantages and limitations. on one side, the sequence-based methods always adopt machine-learning approaches that need large amount of training data. when the training data is sufficient, they could get good prediction accuracy. in fact, hla-i is extremely polymorphic. for example, in the database imgt/hla   <cit>  the number of registered hla-i  molecules has exceeded  <dig> and that for hla-ii is over  <dig>  unfortunately, for most of hla molecules with different alleles, there are few or even no experimentally obtained binding complex data to facilitate analysing their binding characteristics. even for those hlas that have experimental data, by  <dig>  imgt/hla has deposited  <dig> allele sequences of the hla-a loci and  <dig> allele sequences of the hla-b loci, which implies the wide existence of polymorphism. based on one frequently used dataset composed of  <dig> hla-i molecules, the binding prediction accuracy of the hla-i and peptide is reported to reach average  <dig>  auc , but this dataset is too special and only accounts for a small part of the known hla-i molecules. those hlas with slightly different amino acid sequences may have their own binding specificity to different sets of peptides. thus, these sequence-based methods are biased towards the known alleles if they use special training data and may have the over-fitting prediction problem. on the other hand, structure-based methods could jump over the obstacles of sequence polymorphism and directly take advantage of the mhc molecule complex's 3d structures and use their empirical force fields as the binding specificity to estimate the binding affinity. however, the available 3d structure dataset is insufficient. now there are only tens of hla-i molecules' 3d structures resolved, so the accuracy of structure-based methods is restricted by the inadequate number of 3d structures and is usually lower than sequence-based methods.

in order to overcome the existing problems and achieve better prediction accuracy, we still take machine-learning strategy based on the sequencing data. as mentioned above, hla-i has more polymorphism than hla-ii. so here we focus on the hla-i and a method based on the artificial neural network is proposed to predict on hla-i with unknown alleles where there are limited or even no prior experimentally obtained dataset. different from other sequence-based methods using ann, our method not only considers peptide sequence information but also hlas' amino acid residues and the energy of contact residues. with information integration, our method is expected to predict the binding of peptide and hla-i with high accuracy.

the rest sections of this paper will be organized as followed. in the method part, a method based on artificial neural network will be introduced, in which the hlas interaction residues extraction and contact energy computation will be described. the experiments on two datasets will be implemented in the results and discussion part. on dataset is on the benchmark dataset and the other one is on the super-type dataset. the performance of our method will be evaluated under these two conditions by comparing with other methods. the last part is the conclusion.

methods
there're lots of classifiers could be used for prediction. choosing a proper classifier relies on the application contexts. here, we use ann  classifier to predict the peptide and hla-i binding. the reasons for utilizing the ann model are their advantages of self-learning, self-adaptive and modelling non-linear relationship. some works  <cit>  have proved that ann is suitable for the epitope prediction. besides the classifier, how to select the classification features is another important step. not all of hla's amino acids take action in the binding process. therefore, we will first find out which amino acid residues really function and then compute their contact energy. these prominent features will be properly encoded and finally used to predict. the figure  <dig> gives the framework of our method.

interacting residues of hla and peptide
the crystal structures of peptide-hla binding complexes show that although hla molecules from the same gene locus have different alleles, the complexes have similar spatial structure. madden  <cit>  have resolved the 3d structures of five complexes where different peptides binding to the same hla-a* <dig> molecule. the results show they have similar structure and hlas' amino acid residue binding sites. inspired by madden's work, one approach to overcome the influence of coding genes' polymorphism is to find out the major common interacting sites of hlas from the same gene locus. we collect, calculate and finally get the frequent function residues of hla from the existing structure data of peptide-hla binding complexes. all raw peptide and hla structure data come from the database pdb . in total, there're  <dig> peptide-hla-a binding complexes and  <dig> peptide-hla-b binding complexes used. when the distance of residues of the hla and peptide is less than  <dig> Ȧ, we think that they interact. the results show that for hlas from the same gene locus, their amino acid residue interacting sites are similar, which is consistent with the result of madden. we discard those residues of hlas that interact with peptides less than  <dig> times. the putative sites are shown in the figure  <dig> and figure  <dig> respectively for hla-a and hla-b.

contact energy of amino acid residues
in fact, as the participants of binding interaction, amino acid residues of hla and peptide don't independently contribute to the binding. therefore, it's necessary to take into account the interaction among the amino acid residues. the structure of a peptide-hla complex is decided by several forces such as the interaction between amino acids and water molecules, the interaction between amino acids and so on. although there are several forces, the interaction between amino acids plays a major role. generally, the protein structure could be estimated by the amino acid sequence and the interaction strength could be calculated by the classical electromagnetic theory. if the attracting strength between two amino acid residues is great, their position will have more chance to be near. therefore, if there are sufficient protein structure data, the mutual attracting strength could be computed. in the structure biology, miyazawa and jernigan  <cit>  matrix has been widely used for computing the protein sequence energy in different structure templates. but there's a limitation that miyazawa and jernigan matrix takes the solvent as the reference status and is usually accurate for nonpolar molecules interaction. but it couldn't ignore the interaction between amino acids and water molecules. thus, we use the b matrix  <cit> , which is based on miyazawa and jernigan matrix but refers to the threonine, to get the contact energy of amino acid residues.

encode the peptide and hla
for the existing prediction methods based on the artificial neural network, there are three approaches to encode the peptide. the first one is the parse matrix, in which each amino acid is represented by  <dig> zeros and  <dig> one. the second one is blosum matrix and the third one is to select some attributes from the physical and chemical properties of amino acids. among them, blosum matrix usually has the best prediction accuracy and good ability of distinguishing the amino acids. in this paper, the blosum matrix will encode peptides and the b matrix of the contact energy of amino acid residues will encode hla sequence. therefore, the encoding length for the hla-a and peptide binding is  <dig> dimensions, in which  <dig> dimensions are for the peptide encoded by blosum matrix and  <dig> dimensions are for hla-a amino acid residues interacting with the peptides encoded by the b matrix. the encoding length for the hla-b and peptide is  <dig> dimensions, in which  <dig> dimensions are for peptide encoded by blosum matrix and  <dig> dimensions are for hla-b amino acid residues interacting with the peptides encoded by the b matrix. in order to better measure the difference of affinity and facilitate the artificial neural network training. the affinity will be transformed to the logarithm format varying from  <dig> to  <dig> like  <cit> .

  affinity=1-logic50log <dig> 

build and train annbm
there're several subtypes in the ann. in this paper we use the error back propagation feed-forward neural network. because hla features are encoded by b matrix, our ann predictor is also specially named as annbm. theoretical analysis proves that ann with one single hidden layer can map almost continuous relationship function. therefore we establish the annbm consisting of three layers including an input layer, a hidden layer and an output layer. neural network's input layer has  <dig> nodes for predicting peptide-hla-a binding, while neural network's input layer has  <dig> nodes for predicting peptide-hla-b binding. the output layer has only one node. it is the logarithmic value of binding affinity between hla and peptide.

when constructing the annbm, there is no golden criterion to determine the number of nodes in the hidden layer. with less hidden nodes, the ability of learning from samples is poor and unable to reflect the relationship perfectly; with excessive hidden nodes, it may remember the noise in the samples leading to the over learning problem and reduce the generalization ability. in principle, the number of hidden nodes depends on the training sample scale, the sample noise and the complexity of the relationship. a common way to set the number is called trail-and-error, so we test the hidden nodes varying from  <dig> to  <dig>  the hidden layer with  <dig> nodes has gotten the minimum mean square error.

in annbm, the activation function still used the sigmoid function. for sigmoid function when the input of variables is very big, its slope trends to  <dig> 

  fx=11+e-x 

because of this characteristic, for some learning algorithms like the steepest descent algorithm, as the weights and thresholds are far from its best, the gradient is very small and leads to weights and the thresholds correction is very small, so we use the rprop method to do network weights adjustment. rprop takes into account only the sign of the partial derivative over all patterns but not the magnitude, and acts independently on each weight. for each weight, if there is a sign change of the partial derivative of the total error function compared to the last iteration, the update value for that weight is multiplied by a factor η−, where η− is less than  <dig>  if the last iteration produces the same sign, the update value is multiplied by a factor of η+, where η+ is greater than  <dig>  the update values are calculated for each weight in the manner described as above, and finally each weight is changed by its own update value, in the opposite direction of that weight's partial derivative, so as to minimise the total error function. the parameter η+ is empirically set to  <dig>  and η− to  <dig> .

RESULTS
experiment on the benchmark dataset
bjoern peters  <cit>  collect peptide-mhc-i binding datasets and builds a benchmark dataset. this benchmark dataset comes from two research groups' works. they are alessandro sette in the la jolla gene and immunology institutes and søren buus in the copenhagen university. although their experiment systems have several differences in binding the judging index, detecting targets, the preparation of mhc molecules and the purity of peptides, the format of their experiment output is the same. for each peptide, the ic50/ec <dig> value is assigned to measure its binding affinity. in order to evaluate the consistency of experiment results from these two groups, bjoern peters makes the cross validation and results show good consistency. the benchmark finally contains  <dig>  <dig> binding data on  <dig> hla-i molecules. in this paper, we pick up hla-i with the length  <dig> to validate our method.

from the table  <dig>  we could see our annbm get the best performance. and the prediction is independent with the scale of dataset, which could be observed in the figure  <dig>  more interesting, the whole prediction accuracy of annbm is nearly similar with the second perfect result from the netmhc and they both belong to the ann model. apparently, here the neural networks appear its non-linear mapping advantage that could learn the high order relationship from the training process. therefore ann based methods get higher accuracy than smm and arb. besides the model selection, the differences in selecting and encoding of the features also determinate the classification accuracy. smm and arb are based on the scoring matrix. netmhc combines the sparse, blosum matrix and hidden markov to encode peptides.

remarkable, for the small peptide dataset such as b* <dig>  b* <dig>  b* <dig> and b* <dig> molecules, annbm outperforms the netmhc and other methods. the four peptides' numbers are respectively  <dig>   <dig>   <dig> and  <dig>  annbm method in the four molecules gets the auc, respectively,  <dig> ,  <dig> ,  <dig>  and  <dig> , and netmhc method in the four molecules gets the auc, respectively,  <dig> ,  <dig> ,  <dig>  and  <dig> . we believe that the annbm benefits from taking in account the interaction information of hla and peptides, whereas netmhc just encodes the peptides information that is insufficient for ann to learn the high order relationship under the small datasets situations. figure  <dig> shows that when there're enough training dataset the prediction of these methods have no obvious difference just like hla-a* <dig>  but under the small dataset situation showed in the figure  <dig> annbm proves integrating sequence information and energy of contact residues really could improve the prediction accuracy. it isn't hard to understand when training data is sufficient, ordinary classifiers could learn the relationship by large amount of training. the outperformance of annbm in the small dataset proves annbm effectively catches the key factors for the prediction.

prediction on unknown alleles dataset
if there is no prior binding dataset for a hla molecule, we could make use of the sette and sidney work  <cit>  to indirectly solve this obstacle. sette and sidney discover that hla-i class molecules could be divided into several super classes according to their binding specificity. hla molecules belonging to the same super class have similar binding site structure. sette and sidney divide the hla-a into  <dig> super classes: a1、 a2、 a3、 a <dig> and a <dig> and divide the hla-b into  <dig> super classes: b7、 b8、 b27、 b39、 b44、 b <dig> and b <dig>  in this part, we will validate annbm prediction performance when there is no exact binding data for the hla molecules. besides the bjoern peters' dataset, another  <dig> hla molecules are added in from the iedb  <cit> . we use the leave-one-out method to do validation. because the ann methods have shown better prediction than the other methods on the benchmark dataset, here we only do comparison among three analogous ann methods. methods netmhc and netmhcpan come from the works  <cit> . netmhc is the one that has the closest prediction accuracy in the benchmark testing. here we check whether it could keep performing well. the netmhcpan is another method designed to predict peptide-hla binding with unknown alleles. the author of netmhcpan is an experienced researcher focusing on the mhc epitope prediction. his methods are widely used as the golden standard to evaluate other ones. finally we get the result shown in table  <dig>  in which the first column is the name of allele, the second column is the super class that the hla molecule belongs to, columns from third to fifth columns are the auc value of annbm, netmhc and netmhcpan and the last column is the number of peptides binding to the corresponding hla molecule.

from table. <dig>  we can see that annbm method obtains the higher average auc value than netmhcpan and netmhc methods by  <dig>  and  <dig> . netmhc encoding method doesn't take into account the hla molecules information. although the training data comes from the same super-type and acquires perfect results on the allele specific benchmark dataset, the hla differences in the same super class are not reflected, so it is not difficult to understand the netmhc prediction accuracy decreases and lower than those of annbm and netmhcpan that encode hla molecules information. comparing the encoding method of the hla molecules between annbm and netmhcpan, annbm uses the b matrix and each amino acid that could interact with peptide is denoted by a numerical value, while netmhcpan uses the blosum matrix and a  <dig> dimensions vector to denote each amino acid. obviously, annbm has higher efficiency in the storage and computation. the average auc of annbm is greater than that of netmhcpan, especially on the a* <dig> and b* <dig>  whose roc curves are showed in figure  <dig> and  <dig> 

CONCLUSIONS
we have developed an annbm method that can well predict peptides binding to hlas for which have limited or even no prior exact experimentally obtained data. our method takes both peptide sequence information and contact energy of amino acid residues into account, and could give the quantitative binding affinity. allele-specific benchmark and super-type experimental datasets successfully validate this method. annbm is stably better than other methods, especially for the hla molecules with the small  sets of peptides.

competing interests
the authors declare that they have no competing interests.

authors' contributions
all authors participated in designing and coding the method. feiluo drafted the manuscript and all authors read and approved the final version of the manuscript.

funding
this work is supported by the grant from the doctoral fund of ministry of education of china , central university scientific research fund , the grants from the national science foundation of china , the program for new century excellent talents in universities , the ph.d. programs foundation of ministry of education of china  and the fundamental research funds for the central universities .

