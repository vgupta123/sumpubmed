BACKGROUND
molecular profiling of cells sampled from healthy patients and patients suffering from diseases led to the discovery of signatures of deregulated genes, i.e., distinctive expression patterns of genes that are differentially regulated and thus change expression between these two populations of cells. such deregulated genes facilitate classification into different tumors  <cit> , define new cancer subtypes and can serve as predictors of tumor differentiation stages and patient survival  <cit> .

in recent years, the focus of research has moved from analyzing differentially expressed genes to analyzing differential regulatory networks  <cit> . these approaches are based on the observation that cellular adaptation to different environments and stimuli  <cit> , to changes induced by diseases  <cit>  or gene mutations  <cit> , as well as to developmental processes  <cit>  results in gains or losses of interactions in the molecular networks of the cell  <cit> . for example, workman et al.  <cit>  showed extensive re-wiring of gene regulatory networks in yeast cells undergoing dna damage by using genome-wide measurements of gene expression upon transcription factor  perturbations, as well as tf binding to dna.

computational and statistical analysis of changes in network structure between two cell populations has become a rapidly expanding field of research  <cit> . many methods have been developed to infer differential interactions from gene expression data, either based on linear measures of correlation  <cit>  and regression  <cit>  or non-linear information theoretic criteria  <cit> . additional to methods comparing two cellular populations, there are dynamic approaches to infer re-wiring over time  <cit> .

however, these extant approaches to analyze deregulation between two different cell populations do mostly not take into account available knowledge about cellular signaling pathways nor their transcriptional targets, which may also differ between the cell populations. for example, mani et al.  <cit>  and taylor et al.  <cit>  take as input a static interactome, which is not specific for the two cell populations, to discover loss or gain of expression correlation between its nodes. the advanced approach of workman et al.  <cit>  could be further improved by incorporating prior information about the signaling pathways that are differentially activated upstream of the re-wired gene regulatory network, and the complementarity between the tf dna-binding and the tf perturbation data.

here, we present a novel approach to assess re-wiring in two cell populations that combines two key ideas:  we analyze the effects of pathway-targeted experimental single-gene perturbations and  we explicitly include knowledge of pathway topologies and their downstream targets. in this way, our approach facilitates research in a particular context of the biological system under study, implementing the concept of data analysis that gains power from incorporation of knowledge  <cit> . our knowledge-based approach is designed for quantifying deregulation, i.e., changes in gene regulatory network between two different populations of cells. it performs joint analysis of perturbation data from the two cell populations, and is referred to as joint deregulation analysis  throughout the text. the cell populations may correspond to healthy and diseased cells, or diseased cells in two different stages, or, more generally, cells exposed to two different external stimuli, with different cellular signaling and downstream transcriptional targets.

joda analyzes high-throughput perturbation experiments, where genome-wide expression is measured upon single-gene knock-outs or knock-downs. it is assumed that the set of perturbed genes is composed of regulators, i.e., genes active in signaling or gene regulation systems of the analyzed cells. the perturbations need to be performed on the same set of regulators in both cell populations.

the first kind of knowledge given as input to joda is the information about the topology of the signaling pathways active in the two cell populations. the pathway topologies are graphs, which represent regulators with nodes and the known signaling relations between the regulators with edges. internally, based on the given pathway topologies, joda builds two binary matrix models . the models are used by the algorithm to determine which perturbation experiments affect which regulators in the pathways. second, joda takes as input the known regulator-target gene relations downstream of the pathways. those relations, when available, are given for those regulators, which are also tfs, and their known target genes. since both the signaling and regulatory relations may differ between the two cell populations, they need to be provided for both of them separately.

the output of joda are deregulation scores that quantify deregulation using the difference in perturbation effects in the two cell populations. an up-regulation effect indicates  inhibition, and down-regulation indicates activation by the perturbed regulator. the most extreme deregulation scores are assigned to those genes which switch regulatory mechanism between the cell populations and show a different perturbation effect in the one cell population than in the other. we show that joda performs better than investigating gene regulation in each cell population separately: with the deregulation scores, joda prioritizes genes that are more enriched in those gene ontology  terms which are important for the switch between the compared cell populations. similarly, functionally important genes can be missed when deregulation is analyzed without incorporation of prior knowledge, but based only on differences in expression correlation, adapting the ideas of mani et al.  <cit>  and taylor et al.  <cit> . an r package 'joda', implementing the joda algorithm, is released by bioconductor  <cit> . a short summary of the package functionality and its demo are available at http://joda.molgen.mpg.de/.

in application to analysis of deregulation driven by dna damage in human cells, joda reveals broad changes of gene regulatory network downstream of the atm signaling pathway. the analysis integrates expression data from perturbation experiments in the healthy cells and in cells undergoing dna damage  <cit>  , the knowledge about atm signaling down to rela and p <dig> , together with the known targets of rela and p <dig> in both cell populations. the damaged cells are obtained by exposure to neocarzinostatin , an antibiotic that induces dna double strand breaks and activates the atm pathway  <cit> . original data analysis  <cit>  rigorously but exclusively focused on a small set of  <dig> genes responding to ncs treatment, which showed perturbation effects that correctly reconstructed the known atm pathway interactions. here, based on the deregulation scores, we cluster  <dig> genes into thirteen functional clusters, reflecting the rich spectrum of biological activities in the dna damage response program. we review genes in the functional clusters in terms of the known impact of ncs on its gene targets. analyzing enrichment in canonical pathways and known gene-regulatory and protein-protein interactions, we elucidate the connectivity within those functional clusters. we list genes with the most extreme deregulation scores reporting their involvement in dna damage response. our results validate that genes with dominant deregulation scores are directed by the atm pathway and are functionally involved in the switch between the healthy and damaged cells induced by ncs. in the final section we show that the approach can also lead to testable hypotheses: we investigate the indirect regulatory impact of each atm, rela and p <dig> on the deregulated genes, and build a hypothetical hierarchy of direct regulation.

RESULTS
a method for quantifying deregulation
joda reveals deregulation between two different populations of cells. we distinguish two sets of genes: regulators, and all remaining genes . the regulators are components of a signaling pathway, which is important for the switch between the cell populations, and which may have a different topology in one cell population than in the other. we require that each regulator is perturbed in both cell populations. the remaining genes show effects of the perturbations in their expression. we are interested in regulatory relations connecting regulators to the remaining genes and how these relations change between the cell populations.

in addition to perturbation data, for each cell population, joda takes as input two kinds of qualitative knowledge. the first kind of knowledge are two pathway topologies, which describe the signaling relations between all regulators within the pathway in the two cell populations. the set of regulators involved in the two topologies is assumed to be the same, but the signaling relations can be different. the signaling relations describe 'who signals to whom' in both populations and may be derived from multiple sources: the researcher's expertise, literature findings, external experimental data or application of a reverse engineering method of choice. this knowledge is given to the input of joda in a form of two directed graphs . the nodes in the graphs correspond to the regulators . there is an edge between two nodes in a given pathway topology whenever it is known that the pathway component corresponding to one node activates the component corresponding to the other node. the graphs may be cyclic and may have several connected components. examples of two given atm pathway topologies, one in the healthy cells  and second in cells undergoing dna damage , are illustrated in figure 1a.

internally, based on the given pathway topologies, joda builds two binary matrix models. the pathway models are used by the algorithm to determine which perturbation experiments affect which regulators in the pathways. for a given pathway topology graph, joda first adds an edge going from each node to itself, which corresponds to the trivial fact that a perturbation of a given regulator influences this regulator. next, joda computes a transitive closure of the graph, which corresponds to predicting how the effects of the perturbation experiments propagate in the pathway. the pathway model is given by a matrix representation of the resulting graph. it contains an entry  <dig> whenever a perturbation of a regulator corresponding to the row affects the regulator corresponding to the column . for each regulator, the model defines a set of perturbation experiments which affect this regulator's activity. see methods for a formal introduction of the model. example pathway models for the atm pathway in the healthy and in the damaged cells are shown in figure 1b.

the second kind of knowledge are regulator-gene relations, given for some regulators, which are also tfs, and for some remaining genes. this knowledge, similarly as pathway topologies, is cell-population specific and thus is given separately for each population. it originates either from the individual tf targets established in the literature, or from high-throughput tf dna-binding data. the known tf targets are expected to show an effect to the perturbation experiments, and serve as examples of genes that are differentially expressed upon their tf perturbation. this kind of knowledge is rarely certain and in our approach is given as a belief about the tf-target relationships, rather than a fixed statement.

joda processes given data and knowledge in three steps . in the first step, we analyze the input data from each perturbation experiment to estimate the effect of the perturbation on the genes. to this end, we apply our belief-based differential expression analysis method , implemented in the r package 'bgmm'  <cit> . the method assigns each gene a probability that it was differentially expressed in the experiment. in this step, the knowledge about the known tf targets is used. to improve the estimation, the known targets of the perturbed regulator are given a high prior of differential expression in the perturbation experiment. we multiply each returned probability by + <dig> or - <dig> to indicate whether the effect of the perturbation was up- or down-regulation, respectively. thus, each signed probability lies in the  interval. for a given perturbation of regulator v in cell population t, the vector of signed differential expression probabilities of the genes in this experiment is denoted .

in the second step, for each regulator v and cell population t, we obtain a vector  of regulation scores that quantify the effect of v on the genes in t. in this step, the knowledge about the pathway topologies is used. for a given cell population and regulator, regulation scores are computed as an average over the signed probabilities of differential expression in all perturbation experiments that affect this regulator in this cell population. using the pathway model, the affecting experiments are defined as both the perturbation of the regulator itself, and perturbations of its upstream activators in the pathway . for example, in figure 1b the regulation scores  for rela in the damaged cells are an average of signed probabilities for the perturbations of rela and of its upstream activator atm. in the healthy cells, only its own perturbation affects rela, and its regulation scores  are the same as its signed probabilities . assuming that the model is correct, the experiments affecting a given regulator should have a common effect on this regulator's target genes. in other words, each target gene is expected to have either high or low signed probabilities of differential expression that are consistent between all affecting experiments. thus, taking an average yields either high or low regulation scores for the true targets, and rules out those genes which respond to the perturbation experiments in a model-independent manner. a negative regulation score indicates  activation of a gene, and a positive score indicates inhibition. this rule, counter-intuitive at first sight, is motivated by the fact that genes with positive regulation scores have mostly positive probabilities of differential expression, i.e., tend to be up-regulated in those perturbation experiments that affect their regulator. the genes with negative scores have mostly negative probabilities, i.e., are down-regulated. accordingly, we define genes more activated in a given cell population , as having lower regulation score in this cell population than in the other . for example, in figure 1g <dig> is up-regulated upon the rela perturbation  in h and is down-regulated  in d. g <dig> is up-regulated upon the perturbation in h and shows no effect in d. thus, genes g <dig> and g <dig> are more activated in d.

in the third step, to quantify deregulation of genes by a given regulator v, we define a vector dv of deregulation scores as the difference between the regulation scores for v in the two cell populations. in this way, each deregulation score lies in the  interval. for example, in figure  <dig> genes g <dig> and g <dig> are deregulated between the healthy and damaged cells, while gene g <dig> stays regulated the same way, and g <dig> is not dependent on the pathway. accordingly, g <dig> and g <dig> have dominant deregulation scores, which are well discriminated from the scores of g <dig> and g <dig> . note that in the case when regulation scores for cell population h are subtracted from scores for cell population d, genes more activated in d  obtain negative deregulation scores, whereas genes more activated in h obtain positive scores.

deregulated genes identified by joda group into biologically relevant functional clusters
joda was applied to identify genes deregulated in response to dna damage induced by ncs, a drug known to cause double strand breaks in the dna  <cit> . we analyzed transcriptional effects of silencing the regulators atm, rela and p <dig>  performed by elkon et al.  <cit>  on the healthy and the damaged cells . the data for each perturbation experiment are log expression ratios of a regulator knockdown versus control in a given cell population. see methods for data processing. additionally, we provided two kinds of knowledge. first, the atm pathway topologies in the damaged and in the healthy cells. as presented in figure 1a, in the damaged cells ncs triggers a cellular pathway, where the central kinase atm signals down to tfs rela and p <dig>  <cit> . this pathway is inactive in the healthy cells. second, we provided known targets of rela and p <dig> in the two cell populations .

application of our approach resulted in three lists of deregulation scores , one for each of the regulators atm, rela and p <dig>  we sorted the deregulation lists decreasingly, so that the one extreme of each list contains genes more activated in the healthy cells, and the other contains genes more activated in the damaged cells. we performed gene set enrichment analysis  to identify gene sets significantly overrepresented on the extremes of the lists. we focused the analysis first on the enrichment of go terms .

eleven clusters of go terms are found for the genes more activated in the damaged cells and only two in the healthy cells, even though the distributions of the deregulation scores have the median of zero and are not biased in number towards the negative values . the eleven clusters more activated in the damaged cells are shortly referred to as damage-activated, and the two more activated in the healthy cells are called healthy-activated throughout the text. strikingly, the regulators agree on the functional processes they activate: no go term overrepresented in the genes more activated in the damaged cells is also overrepresented in the genes more activated in the healthy cells. this shows the tightly coordinated way in which the atm pathway governs the downstream response to the damaging agent. from the functional clusters of go terms we identified clusters of deregulated genes, which reside on the extremes of the deregulation lists, and are annotated with those terms . as a result,  <dig> genes are separated into thirteen functional gene clusters of different sizes . the number of clusters was chosen to maximize the ratio of the number of clusters over the number of genes shared between the clusters. this choice is a tradeoff between maximizing the diversity of functions in the clustering and minimizing the overlap between the clusters . the main general function of each gene cluster is captured by its label. to annotate clusters with additional, secondary functions we used the ingenuity pathway analysis software . additional file  <dig> lists all ingenuity functions that are significantly overrepresented in each of the five largest clusters. importantly, enrichment analysis of the dna repair, transcription regulation and chromatin organization clusters revealed that they also contribute to cell death, cell cycle, as well as cellular growth and dna replication, recombination, and repair. these three clusters are also significantly enriched in cancer-related genes. all three have strong enrichment for tumorigenesis processes, leukemia-related genes, as well as other cancer types , which agrees with the known connection between dna damage and cancer  <cit> . to address the quality of the deregulation scores, we review the genes in the deregulated functional clusters in terms of knowledge about the impact of ncs treatment on the genes in the treated cell. using ingenuity, we collected a set of  <dig> genes which are directly or indirectly influenced by ncs.

additional file  <dig>  figure s <dig> presents what is known about the type of action of ncs on the targeted genes, as well as what is known about the ncs not acting on the genes. in majority of cases, this knowledge is consistent with the presence or absence of genes in the functional clusters. there is a significant overlap between the ncs-targeted genes and the deregulated functional clusters . these results confirm that our findings are consistent with the current knowledge about the action of ncs and expand it to the level of transcriptional and regulatory switch between the two analyzed cell populations.

the deregulated functional clusters and pathways cannot be found without prior knowledge or in separate analysis
the power of joda becomes apparent when comparing it to two simpler methods. first, an analysis without incorporation of prior knowledge, which is based only on taking differences of correlation  of expression between the regulators and the remaining genes. second, to a separate analysis of the two cell populations, which is based on inferring regulation in the two compared populations of cells separately, and only then finding the differences. the grounds for the comparison of joda to the two simpler methods is the significance of scores assigned to genes with key functions that are expected to be deregulated between the two compared populations.

to analyze decorrelation, for each analyzed gene and each regulator  we computed pearson correlation first between the expression profiles of the regulator and the gene measured in the healthy cells, and second between the profiles of the regulator and the gene in the damaged cells. strong positive correlation in a given cell population can be interpreted as an activation of the gene by the regulator in this cell population, whereas strong negative correlation can be interpreted as inhibition. to obtain the decorrelation scores for each regulator, we subtracted the correlation values for all genes in the damaged cells from the correlations in the healthy cells. in this way, the decorrelation scores, belonging to the interval , can be read similarly as the deregulation scores: strongly negative decorrelation scores indicate more activation in the damaged cells, and strongly positive indicate more activation in the healthy cells. the decorrelation scores are a simple implementation of the ideas applied by taylor et al.  <cit>  and mani et al.  <cit> . taylor et al.  <cit>  used pearson correlation of interactome hubs to their interaction partners to verify whether these interactions are context-specific. mani et al.  <cit>  investigated gain and loss of correlation between cell populations using a mutual information-based approach. although interpreted in the same way, the decorrelation scores differ from the deregulation scores in two important ways. first, they do not incorporate given prior knowledge about the known cell population-specific pathway topology nor target genes downstream of the pathway. second, they measure the activity of the regulators  by their expression levels, ignoring the fact that it is modulated on post-translational level. to perform the separate analysis, we analyze the regulation scores. regulation scores are returned from the second step of joda , separately for each cell population. thus, in contrast to the decorrelation scores, they are obtained using both types of knowledge given as input to the algorithm. recall that in a given cell population, extreme regulation scores are given to those genes which according to the perturbation data and knowledge are directly or indirectly controlled by the regulators.

joda outperforms the analysis performed with the decorrelation scores. figure  <dig> shows that the genes in functional clusters have deregulation scores that stand out significantly from the background of deregulation scores for all analyzed genes. using the decorrelation scores, the same two clusters can be identified as healthy-activated and eleven as damage-activated, but they are less significant than when deregulation scores are used. similarly, several clusters, although performing functions important for the switch between the healthy and damaged cells, are likely to be missed when analyzing the cell populations separately. for example, based on the regulation scores in the damaged cells only, the genes in the dna repair cluster cannot be significantly differentiated from all genes .

to further compare the joint approach to the separate analysis, we applied gsea to perform go term enrichment analysis in the sorted lists of regulation scores. such a list contains on the one end the genes which are up-regulated by the regulator perturbation  and on the other the genes that are down-regulated by the perturbation . additional file  <dig>  figure s <dig> compares go terms or pathways overrepresented on the extremes of deregulation lists with the terms/pathways overrepresented on the extremes of sorted lists of regulation scores. first, the separate analysis misses gene sets that are only slightly down-regulated in one cell population and slightly up-regulated in the other. deregulation scores, being a difference of the small but opposing effects, amplify them, making detection of such gene sets possible. for example, significant enrichment of the go term regulation of transcription is only found by our approach and not by the separate analysis . second, the separate analysis identifies also go terms or pathways annotating genes that show the same effect to perturbation in both cell populations, e.g. the glycolysis pathway, which is up-regulated upon knockdown of rela and atm both in the healthy and in the damaged cells . importantly, such effects do not characterize the difference between the two cell populations and in our analysis automatically cancel out when computing the deregulation scores. taken together, deregulation scores are more sensitive to and oriented on differences between the cell populations .

deregulated pathways and complexes elucidate cooperation within the functional clusters
since the genes in each cluster share the same functionality, they may directly interact in a common cellular pathway or complex. to determine these interactions we first identified pathways and complexes that are overrepresented on the extremes of the deregulation lists. next, we checked their overlap with the functional clusters. the enrichment in pathways, similarly as for go terms, was assessed using gsea. the identified pathways are stored in the msigdb database as sets of genes, but their signaling relations are well described in the literature. eleven msigdb pathways that are overrepresented on the extremes of the deregulation lists significantly overlap with our functional clusters . for example, the apoptosis pathway contains genes from the dna repair and transcription regulation clusters. moreover, we found the exon junction complex and several spliceosome complexes  significantly overrepresented in the genes more activated in the damaged cells . interestingly, these complexes overlap  with the mrna processing cluster. similarly as pathway interactions, membership in complexes explains the way the genes in the clusters are interconnected and collaborate to exhibit the common function.

finally, we focused on the dna repair cluster, which is of pivotal interest in the context of the switch between the healthy and the damaged cells. we investigated physical relations among genes within this cluster. the cluster is strongly enriched in eight pathways involved in response to dna damage . spike is a database and an analysis tool, storing manually curated pathways, which play key roles in response to damage. the table in figure 5a lists  <dig> genes from the dna repair cluster, which belong to those canonical pathways stored in spike as well as three additional pathways, described in a comprehensive review on dna damage response by wood et al.  <cit> . the significantly enriched pathways include non-homologous end-joining and homologous recombination, which are typical pathways responsive to dna double strand breaks  <cit> . the position of the listed genes in the well known damage response pathways describes their role in the response, as well as their interaction partners in the cluster. to further infer the cooperation between the remaining genes in the dna repair cluster we collected their interactions using spike and ingenuity . the analysis revealed a number of complexes that join subsets of genes together, e.g. the origin of replication complex  containing five dna repair genes. grouping the complexes by common functionality, we selected functional sub-parts of the network. for example, we identified a sub-network of genes belonging to the rfc, dna polimerase epsilon, and the orc complexes, which are involved in the dna replication process .

genes most activated in damaged cells function in the atm pathway-induced damage response
functional clusters contain deregulated genes that accumulate within the extremes of the deregulation lists, but not on the strict top or bottom. we investigated the composition of three sets of one hundred genes that are most activated in the damaged cells by each regulator rela, atm and p <dig> . all three sets are significantly enriched in genes involved in transcription, with five common genes active in this process: chd <dig>  rbm <dig>  rcan <dig>  smad <dig>  and ubn <dig>  interestingly, some of the genes most activated by rela are interaction partners  of the genes most activated by p <dig> . apart from transcription, the set most activated by atm is also enriched in cell death, cell cycle, and growth-related genes. moreover, both sets of genes most activated by atm and p <dig> are enriched in cancer-related genes .

the stability of deregulation scores for the genes most activated by any of the three regulators  was assessed based on p-values for a permutation test. deregulation scores measure the relative change of probability that a gene is up- or down-regulated. the permutation test was used to verify a hypothesis that for a given gene its deregulation score is significantly different than zero. to perform the test, the signed probabilities of differential expression for all genes and regulators were permuted at random  <dig> times. the p-value for the permutation test was calculated as a probability that the observed deregulation score is closer to zero than the deregulation scores calculated for the permuted differential expression probabilities. there are two benefits of permuting the differential expression probabilities  instead of the input expression dataset. first, we directly test the effect of the pathway models on the deregulation scores . second, we avoid fitting gaussian mixtures to the data based on beliefs with random observations. additional file  <dig>  figure s <dig> presents the distribution of p-values for the most activated genes versus all other genes. all genes most activated by rela and p <dig> have p-values lower than  <dig> . genes most activated by atm have less significant scores.

next, we reviewed the individual examples out of three shorter lists of twenty genes that are most activated in the damaged cells by rela, atm and p <dig>  those shorter lists contain together  <dig> unique genes . figure 6a presents a network interconnecting  <dig> of the  <dig> genes, for which regulatory interconnections are known. both p <dig> and rela, with seven and five regulatory targets, respectively, are major regulators for the genes in this network. moreover,  <dig> out of the  <dig> genes in the network are transcription regulators themselves. from all  <dig> most activated genes there are  <dig> transcription regulators,  <dig> genes involved in apoptosis,  <dig> in proliferation and  <dig> in cell cycle progression.

additional file  <dig>  figure s <dig> a visualizes expression profiles of the most activated genes. expression data explains the deregulation p-values showing that those genes tend to be repressed in the healthy, and activated in the damaged cells.

rela and p <dig> are the key deregulators of genes in functional clusters
deregulation is inferred from perturbation effects, and as such can be due to an indirect impact of the regulators on the genes. here, we summarize these possibly indirect effects on functional clusters of the deregulated genes identified by joda.

deregulation can be explained by a hierarchy of direct tf-dna binding events
finally, we investigate the hierarchy of direct regulatory relations, which could explain the effect of the atm pathway on the deregulated target genes. the first possible scenario would involve regulation by direct binding of the regulators in the pathway to the gene promoters. alternatively, the most parsimonious hierarchy would connect the regulators to the genes via a single tf. to investigate these hypotheses, we follow a two step procedure. in the first step we computationally predict the tfs directly binding to the promoters of the genes. in the second step we verify whether the tfs are the regulators themselves, or whether they are controlled by the regulators.

to implement the first step, we applied transfind  <cit>  to predict tfs binding to the promoters of the genes in each functional cluster . among the identified tfs, creb has binding sites significantly enriched in the promoters of genes in the dna repair cluster. neither rela nor p <dig> were predicted to bind directly to the promoters of the genes in the functional clusters. thus, in the second step we consider the hypothesis of the parsimonious hierarchy. here, we focus on creb, leaving other predicted tfs as candidates for future investigation. the hypothesis consists of a deregulatory connection from the atm pathway to creb, implemented by rela or p <dig> directly binding to creb promoter in the damaged cells and not binding in the healthy cells.

to complete the picture, based on several different criteria we collected nine most likely direct target genes of creb, which are also deregulated in our system . exo <dig>  ppp1r15a, nap1l <dig>  orc5l, brca <dig>  mcm <dig> and ube2b belong to the dna repair cluster and have a high affinity binding of creb to their promoters conserved in mouse. additionally, we report two genes outside of the cluster, pwp <dig> and nolc <dig>  both are deregulated and have yeast homologs, which were identified by workman et al.  <cit>  to be deletion-buffered by sko <dig>  an yeast homolog of creb. that means, both their homologs change expression in wild-type cells in response to methyl-methanesulfonate  and do not change when sko <dig> is perturbed. moreover, the promoters of pwp <dig> and nolc <dig> yeast homologs are not bound by sko <dig> in the healthy yeast cells, and are bound by sko <dig> in the cells damaged by mms. the data of zhang et al.  <cit>  supports that the promoters of all nine target genes but nolc <dig> are bound by creb in hek293t cells.

discussion
in our approach, the information about the pathway topologies in the two analyzed cell populations is formalized in two simple models. note that neither the pathway topologies nor the pathway models are intended to capture the dynamics and full spectrum of molecular interactions in signaling pathways. instead, they are static and limited only to activatory signaling relations. each model in a simplified way represents the knowledge of how the perturbations interrupt the flow of activations in the modeled pathway topology. the perturbations are required to turn the targeted regulator down . to relax these constraints the approach could be adapted to incorporate logical models , formalizing a broad range of signaling relations and allowing all possible perturbation experiments. such extension would require distinguishing the experiments affecting a given regulator into two classes: one of experiments which down-regulate, and one of experiments which up-regulate the target genes of this regulator.

unlike numerous approaches inferring gene regulation from expression data  <cit> , here we do not measure the activity of the regulators from their expression levels. concluding activity from expression has several drawbacks. first, tfs are often expressed on low mrna levels and thus detection of their activity profile based on expression measurements may fail due to noise in the data. second, regulator activity is modulated in many ways on post-translational level of signaling, by phosphorylation, ligand binding, degradation, etc. thus, we follow gat-viks and shamir  <cit>  and szczurek et al.  <cit>  and derive the regulator activity from a given model of signaling pathway. the regulators are treated as proteins, and their activity in a given perturbation experiment depends on the perturbation and on signaling relations which exist on post-translational level. thus, assuming the input pathway topologies are correct, the pathway models should encompass all means of influencing the regulators present in the two cell populations, such as phosphorylation or ligand binding.

this dependence on the pathway models implies that the correctness of the models is critical for the correctness of our results. joda may fail when the input pathway topologies are insufficient. to assure high quality of the pathway models, they should first be confronted with available data and corrected using refinement procedures . moreover, the remaining genes  are measured from their expression levels, and their regulation is judged based on their transcriptional response to the perturbations of the regulators. the current view of regulation of gene expression in molecular biology  <cit>  is more complex and includes, for example, post-transcriptional degradation by micrornas. ideally, our approach should integrate evidence of all means of gene regulation. we hope such integrative methods will be developed in the future. importantly, our analysis can still be performed without any input knowledge. this option is valuable particularly in non-model organisms or under unusual experimental circumstances, where not much more is available other than newly generated expression data. in case when signaling relations between the regulators are not known, the input topologies given to joda should be fully disconnected graphs. this corresponds to inferring regulator-target gene relations for each regulator independently, only based on the perturbation data for this regulator. in case when no regulator-target gene relations are given, joda evaluates probabilities of differential expression  using unsupervised, instead of partially supervised mixture modeling  <cit> . however, as we show, incorporation of knowledge greatly improves the quality of deregulation analysis. therefore, even if only partial information is available either about the signaling pathways, or about the target genes, it is still beneficial to provide it as input to joda.

CONCLUSIONS
reprogramming of cellular character manifests itself in different cellular signaling, and, in a consequence, re-wiring of the downstream transcriptional network. joda combines cell population-specific data and prior information from these interconnected levels. moreover, deregulation is quantified in one score, merging effects from the two cell populations. our results show advantage of joda over investigating each cell population separately or without incorporation of prior knowledge.

joda keeps the deregulation analysis in the strict biological context of pathway-induced gene regulation in the cell populations under study. to our knowledge, it is the first deregulation approach to take advantage of prior information about signaling pathway topology that differs between the compared populations of cells. the analyzed perturbations target common components of this signaling pathway in both cell populations. the known gene regulatory targets downstream of this pathway, specific for each cell population, are utilized as examples of differentially expressed genes.

in our analysis we focused on the deregulation between healthy cells and damaged cells treated with ncs. the obtained deregulation scores were further analyzed, first validating their congruence with the existing biological knowledge and next bringing new results. by finding functional clusters of the deregulated genes, we showed that the method assigns dominant deregulation scores to the genes playing important roles in the program of general response to dna damage, in particular double strand breaks induced by ncs. additionally, we investigated cooperativity between these deregulated genes, identifying known pathways and complexes in which the genes participate. we reviewed the dna-damage related functionality of the genes with most extreme deregulation scores. finally, we analyzed the indirect regulatory impact of the regulators in the atm pathway on the genes in the functional clusters. an important advantage of our methodology is that it leads to testable mechanistic hypotheses. here, we proposed a hierarchy of direct regulatory interactions by connecting the pathway to the deregulated dna repair genes via the transcription factor creb. taken together, joda is a step forward to a systems level, mechanistic understanding of changes in gene regulation between different cellular environments.

