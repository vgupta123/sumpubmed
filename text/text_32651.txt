BACKGROUND
oilseed rape  is one of the most important oil crops in the world, which provides not only edible oil but also raw materials for bio-energy applications. b. napus is an allotetraploid that was generated from the natural hybridization of its two progenitor diploids of brassica rapa  and brassica oleracea  about  <dig>  years ago  <cit> . b. rapa and b. oleracea were produced by extensive triploidization of their ancestral species at the genomic level  <cit> . the b. napus two subgenomes an and cn are largely collinear  to the corresponding diploid ar  and co  genomes  <cit> . the three species are believed to share a common ancestor with arabidopsis thaliana  <cit> . thus, on average, one ortholog arabidopsis gene can find about four homologous copies in the b. napus genome  <cit> . most orthologous gene pairs in b. rapa and b. oleracea remain as homoeologous pairs in b. napus an and cn subgenomes   <cit> .

single nucleotide polymorphism  markers have a wide range of applications in the construction of genetic maps, mapping and cloning of quantitative trait locus , linkage analysis, molecular marker-assisted selection , and molecular breeding of crops  <cit> . edwards et al. and hayward et al. estimated that there was a snp in every 600 bp of the b. napus genome, for a total of approximately  <dig>  million snps  <cit> . westermeier at al. and durstewitz et al. identified  <dig> and  <dig> snps in b. napus using an amplicon sequencing method, respectively  <cit> . recently, trick et al. identified  <dig>  and  <dig>  snps in the two cultivars, ningyou <dig> and tapidor using solexa transcriptome sequencing  <cit> . bus et al. identified more than  <dig>  snps in  <dig> b. napus inbred lines using a next-generation restriction-site associated dna  sequencing method  <cit> . a total of  <dig>  genic snps were selected from publically available information for illumina infinium genotyping by delourme et al.  <cit> , and a ultrahigh-density snp bin map containing  <dig>  snps was constructed using a modified ddradseq technique for two b. napus inbred lines and their  <dig> doubled haploid  progenies  <cit> . several methods have been used to successfully genotype b. napus with snp markers, including mini-sequencing  <cit> , illumina goldengate genotyping  <cit> , snapshot  <cit> , invader®  <cit>  assays and snap primer amplification  <cit> . recently, high-throughput 6k and 60k snp arrays for b. napus based on the illumina infinium hd assay have been developed, and used for qtl mapping  <cit> , genome-wide association study  <cit> , and genome structure analysis  <cit> .

compared with diploid species, such as rice  <cit> , maize  <cit> , tomato  <cit> , chickpea  <cit> , sorghum  <cit> , and apple  <cit> , the large-scale identification of snps and genotyping in b. napus faces more challenges due to the species’ complex genome structure  <cit> . for instance, snp identification by transcriptome sequencing or using known est sequence data showed that approximately 90% of identified snp loci correspond to hemi-snps  <cit> , resulting in a large number of heterozygous signals in genotyping analyses with snp arrays  <cit> . because the generation of heterozygous signals is due mainly to the binding of the snp probe to two or more different genomic sequences , the detected signal may not represent the genotype corresponding to the snp probe itself. two traditional solutions to this problem are  either to remove the snps with the heterozygous signals from further analysis, or  to code signals with the same p <dig> value as the a genotype, those with the same p <dig> value as the b, and those with a non-parental value, as missing values  in a segregating population  <cit> . the first method will result in a low usage of the snp array data, while the premise of the second method is the uniqueness of the binding site for the snp probe in the genome. however, it is difficult for a considerable number of probes to meet this requirement in the b. napus genome  <cit> , which leads to improper utilization of snp data in many cases.

different parameters have been proposed for quality evaluation of snp arrays in diploid species . for instance, the cluster separation score  is often used to select high-quality snp probes . however, the css is not always suitable for the determination of snp loci  <cit> , as it only describes the degree of separation between two homozygous versus heterozygous clusters, rather than the separation between two homozygous clusters  <cit> . for the populations consisting of pure individuals, such as dh lines and recombinant inbreeding lines , probes with a high heterozygous proportion  and low minor allele frequencies  may be filtered out, and materials/lines with high missing data  or low call rate  may be discarded from further analysis  <cit> .

due to the high frequency of multi-loci snps  in polyploid species, such as b. napus, it is not suitable to simply apply the parameters and criterions developed in the diploid species to evaluating the quality of snp array probes in polyploid species. therefore, there is a need for development of effective procedures to assess the quality of the snp array probes and to make full use of snp genotyping data in polyploid species.

in this study, a 6k snp array   <cit>  for b. napus was applied to genotyping a dh population and its parents  <cit> . a procedure, called bi-filtering analysis was developed to improve the efficiency and accuracy of snp array data analysis. the procedure firstly calculates the percentage of non-parental genotypes , based on monomorphic loci, in a segregating population. subsequently, the difference in pnpg of single-locus snps  and multi-loci snps  was compared to filter multi-loci snps among the snp loci and unauthentic lines in the dh population. such a bi-directional filtering can optimize the population and eliminate multi-loci snp interference, thus improving the quality of genetic map and accuracy of qtl mapping in polyploid b. napus.

methods
plant materials, field trails and trait evaluation
the hj dh population was produced from microspore culture of f <dig> buds of the cross between huashuang  <dig> , a semi-winter type b. napus variety, and j <dig>  a winter-type b. napus pure line. the two parents were purified by microspore culture before hybridization. detailed information about this population was described in wu et al.  <cit>  and cai et al.  <cit> .

the dh lines, together with their parental lines, f <dig> and rf <dig> hybrids were grown in a semi-winter rapeseed crop area, wuhan in 2009– <dig>  2010– <dig>  huanggang in 2010– <dig>  and a spring rapeseed crop area gansu in  <dig>  respectively. the field experiment followed a randomized complete block design with three replications. each line was planted in two rows and 10– <dig> plants were maintained in each row, with a distance of 17 cm between plants within each row and 30 cm between rows. the parental line hua <dig> was grown in every  <dig> lines as a control. the field management followed essentially regular breeding practice.

molecular marker and snp array genotyping
primer sequences for the ssr markers used for genetic mapping were described by fan et al.  <cit>  and the sequence information of all ssr markers is provided by cai at al.  <cit> .

the genotyping of snps was performed using a 6k illumina infinium hd assay snp array of b. napus  developed by the university of queensland. the snp genotyping was conducted following the instructions from infinium hd assay ultra protocol guide . all the snp array data were clustered and visualized for further analysis using the illumina genomestudio software . each snp was re-checked manually to determine if any error was observed during the clustering analysis. detailed information about snp array genotyping and data processing was described in cai et al.  <cit> .

construction of linkage map and qtl mapping
the method for genetic linkage map construction was described by cai et al.  <cit> . qtls were detected using the composite interval mapping  procedure with the software qtl cartographer v <dig>   <cit> . a significance threshold for qtl at the level p = <dig>  was determined through permutation analysis using  <dig> repetitions. the other parameters and methods for qtl mapping were as described by feng et al.  <cit> .

RESULTS
majority of polymorphic snp loci exhibited heterozygous signals in b. napus
previously, the hj-dh population and its parental lines were genotyped with ssr markers and the 6k snp arrays for b. napus  <cit>  and the call rate of all  <dig>  snp loci on the array for all  <dig> samples was > <dig>   <cit> . there were  <dig> probes  that were detected in less than 80% of samples and thus not included in further analysis. the remaining  <dig>  snps were used for cluster analysis using genomestudio software  <cit> . among the  <dig>  snps,  <dig>  had a css < <dig>  . as doubled haploids, all the dh lines should have only their parental genotypes with two expected homozygous clusters . however, other types of genotyping data were observed after clustering, including snps with css < <dig>  but with clear clusters , snps with one of the parental genotype being heterozygous  or not detected , and snps with a high frequency of non-parental genotype  in the progeny population . there were  <dig> polymorphic snps out of the  <dig> snps with css < <dig> , most of which had clear clusters . after a check of all the calls manually, the snps between two clusters were rescored as missing data .figure  <dig> different types of single nucleotide polymorphism  probes as clustered by genomestudio software in the hj-dh population.  distribution of the cluster separation score  for all  <dig> snps; - scoring of snp genotyping data from different types of snp probes. the three highlighted clusters denote the areas where the three different genotypes of homozygous allele aa , heterozygous ab  and homozygous allele bb  are called. allele calls that are ambiguously located in the lighter colored areas between or below these areas are scored as “no call” . ellipses are used to mark the positions of the cluster calling areas. the dots with black circles are calls that needed to be manually re-checked and re-scored to missing data .  typical score from probe bna <dig> with two expected homozygous clusters ;  the score from the snp bna <dig> with css < <dig>  but with two clear parental genotype clusters;  the score from the snp bna <dig> with one parent being heterozygous ;  the score from the snp bna <dig> with one parent being nc;  the score from the snp bna <dig> with obvious  <dig> clusters  in which the non-parental genotype of ab cannot be re-clustered to any homozygous cluster manually.



among the  <dig>  polymorphic loci out of the  <dig> probes   <cit> ,  <dig>   were detected as heterozygous signals in one parent . there were also  <dig>  snps  that had three clear clusters with at least  <dig> dh lines per cluster in the dh population . those two types  calls in snp arrays for diploid species would frequently be discarded  <cit> . if a similar treatment was followed in this study, there would be only  <dig> polymorphic snp loci with non-heterozygous calls and two clearly parental clusters in the population left for further genotyping analysis , only accounting for  <dig> % snps on the array. such a choice will significantly compromise the high-throughput property of snp arrays.table  <dig> 
types and numbers of the polymorphism combinations in two parental lines



homologous signals
homologous/heterozygous signals

hua5
j7005
n
a
hua5
j7005
n

total
 <dig> 
 <dig> 

athe number of the snp loci. the number in the bracket designates the snp locus number that exhibits segregation of three clear clusters  in the dh population.



above results revealed that near 40% snps were polymorphic between two parental lines, consistent with findings in maize and other crops  <cit> . however, data from monomorphic loci accounting for a large portion of the snp array were directly discarded in previous studies  <cit> , resulting in a potential loss of information from both the array and genotyped samples.

monomorphic snp loci can be used to genotype the mapping population and assess snp detection errors
because the genotype of a given locus in each dh line can be inferred according to their parental genotypes in theory, we hypothesized that the monomorphic snp loci could be used to evaluate the authenticity of each dh line, as well as the stability and error in the snp array detection. for that purpose, a two-dimensional matrix was established to genotype the individual lines of the dh population . this matrix listed the genotypes of each snp locus in all dh lines horizontally and the genotypes of each dh line in all snp loci vertically. in such a matrix, the occurrence of a npg might be due to an error in the snp detection system or due to the dh line itself . the quantification of the percentage of non-parental genotypes  in these snps for each dh line in the vertical direction can accurately identify the authenticity of each dh line in the population. after removing the potentially unauthentic dh lines, the remaining differences can be used to assess the reliability and stability of snp detection in the array.figure  <dig> schematic diagram of a two-dimensional matrix for analyzing monomorphic single nucleotide polymorphisms  in the hj-dh population. the matrix lists the genotypes of each snp locus in all doubled haploid  lines horizontally and the genotypes of each dh line in all snp loci vertically. the blank and black squares represent the parental genotype and non-parental genotype in the population, respectively. the pnpg_snp and pnpg_dh are calculated by the formulas as described in the results and discussion section.




for the dh lines listed in the vertical direction, the pnpg of dh lines  can be calculated with the following formula: pnpg_dh=1−pgjmj 

where pnpg_dh represents the percentage of npgs in all detected snp loci of the jth dh line, pgj represents the number of parental genotypes  in all snp loci of the jth line, and mj represents the number of detected snp loci of the jth line.

for a true dh line, the pnpg value should theoretically be zero. however, many factors such as genetic mutations, the stability of the snp detection system, and the mechanical or biological contamination of the samples, can affect genotyping results. however, the probability that all of these factors will have a significant impact on the genotyping results is small. based on the above considerations, in the subsequent analysis, pnpg = <dig>  was set as a threshold value to determine the authenticity of a given dh line.

the pnpg values were calculated for each dh line based on  <dig> monomorphic snp loci, including the snps that had more than 20% of missing data . the average pnpg for the population was  <dig> , with a pnpg < <dig>  in  <dig> lines and > <dig>  in  <dig> lines . after removing these  <dig> lines, the average pnpg for the dh population decreased to  <dig> . the remaining  <dig> dh lines were considered to be the true genetic offspring of the two parents and used for the subsequent analysis. we also checked the genotypes of these  <dig> unauthentic dh lines based on the  <dig> polymorphic ssr loci, and could not find the abnormity and error. one might consider a similar examination with monomorphic ssr markers. however, it seems only feasible to apply monomorphic snps for such a purpose, since monomorphic ssr markers normally are no longer used for genotyping of a segregation population in a regular ssr genotyping experiment, and the throughput of ssr genotyping is obviously much lower than that of snp. in this regard, the high-throughput snps are more powerful in evaluating the authenticity of the dh population offspring than other regular markers. the above results showed that the pnpg value of a dh line could be used in the evaluation of the structure of the population and the authenticity of the offspring. after excluding the unauthentic dh lines from the population, the stability and error of the snp array detection system could be further assessed.figure  <dig> frequency of the percentage of non-parental genotype  measured by monomorphic single nucleotide polymorphisms  in the hj-dh population. the pnpg of each doubled haploid  line is calculated by the formula as described in the results and discussion section.




due to the existence of a large number of inter-homoeologues in the a and c subgenomes of b. napus  <cit> , it is difficult to ensure that a snp probe only bind to a particular genomic sequence/region when designing snp probes. such a lack of specificity could result in a large number of heterozygous signals in snp detection in b. napus. in this study, 62% of the detected snps were loci with heterozygous signals in one of the parents , although both the parental lines were homozygous . such a non-specific binding of snp probes and the consequent heterozygous signals in the array analysis could result in the appearance of the npgs in the dh population. to test the hypothesis and to understand the cause of the heterozygous signals in the snp array, we took a similar procedure as described by trick et al.  <cit> , in which an unambiguous allelic snp was termed “simple snp” and the allelic polymorphisms due to the presence of homoeologous sequences “hemi-snp”  <cit> . in such a way, we classified snps into simple snp, hemi-snp, and pseudo-simple snp according to the allelic snp types, availability of inter-homoeologue, and consequently the locus numbers a probe can bind to. the simple snp refers to a typical allelic snp, which can be only targeted by its specific probe . such a detection generates aa/bb/nc but no ab signal in both the parental lines and their offspring dh lines. the hemi-snp refers to the incomplete allelic polymorphisms due to the presence of homoeologous sequences in the b. napus genome. the pseudo-simple snp refers to an allelic snp derived from two homoeologues that possess inter-homoeologous polymorphisms in two parental lines. in a hemi-snp locus, the existence of mismatch bases would result in a difference in probe binding capacity  <cit> . for instance, if the p <dig> can bind two loci as shown in figure  <dig> , p1_locus <dig> is of the genotype a that has a 100% binding capacity to the snp probe, whereas p1_locus <dig> is of genotype b that would have a decreased binding capacity with as few as three mismatch sites in a 50 bp-long probe  <cit> . such a binding difference would result in a heterozygous ab signal . on the other hand, if the probe failed to bind locus <dig> due to the competition with locus <dig>  there would be an incorrect classification of aa . to analyze the possibility of the occurrence of such an error, we set out to assess the stability and error of the snp detection system by calculating the pnpg in snp loci. in the two-dimensional matrix described above, the pnpg of the horizontal snp loci  can be calculated with the following formula:figure  <dig> possible genotypes derived from inter-homoeologues targeted by a given snp probe and their frequency in the hj-dh population. considering the two inter-homoeologous sequences yy and rr in p <dig> and their alleles yy and rr in p <dig> as two independent loci in the genome, the dh population will expect four genotypes of yyrr, yyrr, yyrr, and yyrr with a frequency of 1/ <dig> for each . fluorescence signals of the parental lines are assigned as aa , bb  and ab , respectively. in the case of a null locus, the miss signal is assigned as nc . in pseudo-simple snp type , only a same set of signals as simple snp are detected in the parental lines but there will be non-parental genotypes  segregation in the dh population in group 1- <dig>  in shemi-snp type, there will be ab  signal detected due to presence of hemi-snp but there will no npg in the dh population . in mhemi-snp type, the signal values are similar to shemi-snp in parental lines but there will be npg signals detected in the dh populations due to multiple mismatched nucleotides within the inter-homoeologous sequences . the color bars can be used for calculation of signal values in the dh population . “*” marks the npgs occurred in the dh population. n is the number of the polymorphic snps in indicated group. the numbers of each signal for corresponding snp group in the  <dig> dh lines are listed in the column of aa:ab:bb:nc. the number in the bracket refers to the ratio for each signal .

 pnpg_snp=1−pgimi 

where pnpg_snp represents the percentage of npgs in the ith snp loci of all dh lines, pgi represents the number of pgs in the ith snp loci of all dh lines, and mi represents the number of detected dh lines in the ith snp loci. after excluding the unauthentic dh lines, if the genotypes of both parents are aa at a snp locus, the genotype of all dh lines is theoretically aa at this snp locus. if a different genotype  is detected, it is very likely to be the result of a detection error. in this case, a pnpg value of  <dig>  was still considered as the threshold to determine the reliability of call for a snp locus.

next, the pnpgs for  <dig>  monomorphic snps in the horizontal direction were analyzed. a pnpg ≥ <dig>  was found at  <dig>  snp loci, indicating that the detection of most of the snp loci was reliable. when excluding these  <dig> snp loci, the average pnpg for the remaining snp loci was  <dig> e- <dig> . the analysis of the remaining  <dig>  snp loci showed that if the genotypes of both parents were homozygous , the ratio of detecting a npg in the population was < <dig> ; if the genotypes of both parents were heterozygous , the ratio of detecting a homozygous genotype in the population was < <dig> ; and if both parents were detected as “no call” , the pnpg was even lower . these results suggest that if the pnpg is > <dig>  at a snp locus of a b. napus snp array, it is most likely caused by inter-homoeologue polymorphism or signal superposition of multiple snp loci. the generation of these heterozygous signals  is due to the complexity of the genome of allotetraploid b. napus.table  <dig> 
the proportion of each theoretically possible genotype in the monomorphic snp loci



genotype
probe
percentage of parental and non-parental genotype
a
pnpg
c
aa
ab
bb
nc

aa
1317
 <dig> 
b

ab
16
 <dig> 

bb
1441
 <dig> 

nc
574
 <dig> 

total
3348
 <dig> e-03

apercentages of parental and non-parental genotype are calculated as: number of each detected genotype/.


bpercentages of parental genotypes were bolted.


cpercentage of non-parental genotype.



the above analysis showed that, using a two-dimensional matrix constructed with the genotypes of the monomorphic snps in the dh population and pnpg analysis, unauthentic dh lines could be excluded , and the error and stability of the system could be estimated . these analyses can improve the quality and utilization efficiency of snp array data.

bi-filtering analysis can reduce the interference of mhemi-snp and pseudo-simple snp loci
previously, the assignment of polymorphic snp loci was conducted using two methods. the first method is to simply remove the loci that exhibit heterozygous signals in one of the parents, and the other method is to mark signals in the segregating population that have the same p <dig> value as genotype a, signals that have the same value of p <dig> as b, and non-parental signal values with missing values   <cit> . the premise of the second method is the specific binding of a snp probe to a locus in the genome. due to the existence of a large number of inter-homoeologues in the genome of b. napus, a considerable number of the snp probes cannot meet this requirement. to reduce the impact of multi-loci snps on the subsequent genetic linkage analysis, we further divided hemi-snps into two sub-groups, shemi-snps and mhemi-snps, according to whether the npg can be identified in the dh population. a so-called shemi-snp refers to the probe call that generates heterozygous signal  in one of the two parental lines and the parental genotypes can be detected but no npg will be produce detected in their offspring dh lines. as illustrated in figure  <dig> , a shemi-snp may include two of three possible signals  in parental lines, and for each group of parental genotype, their offspring dh lines can only produce parental genotypes. furthermore, such a segregation of two different parental genotypes fits into the expected frequency. in contrast, the mhemi-snp produces an extra non-parental signal in the offspring dh lines in addition to parent-type signals  due to more mismatched bases available in the inter-homoeologue , which may result in no hybridization signal and consequently a null detection for one of the inter-homoeologous sequence. obviously, the genotypes of mhemi-snps and pseudo-simple snps are a superposition of the signals from multiple snp loci, which cannot represent the corresponding genotype of the probe itself . therefore, the mhemi-snps and pseudo-simple snps should be removed to avoid any impact on the calculation of the linkage between these loci.

to identify the difference between mhemi-snp and pseudo-simple snp and the other two types of snps , a method similar to the one above used for the analysis of monomorphic snps was applied to analyze the pnpg values of polymorphic snp loci.

if the genotype of the parents was ab/bb of the two types of snp: shemi-snp and mhemi-snp, the pnpg values in the dh population were different . considering the two inter-homoeologous sequences yy and rr in p <dig> and their alleles yy and rr in p <dig> as two independent loci in the genome, the dh population will expect four genotypes of yyrr, yyrr, yyrr, and yyrr with the fixed frequency of 1/ <dig> for each through the haploid production . in pseudo-simple snp type , only a same set of signals as simple snp  are detected in the parental lines but there will be npgs segregation in the dh population in the first five groups . in shemi-snp type, there will be ab  signal detected due to the presence of hemi-snp but will no npg in the dh population . in the mhemi-snp type, the signal values are similar to shemi-snp in parental lines but there will be npg signals detected in the dh populations due to multiple mismatched nucleotides within the inter-homoeologous sequences . furthermore, assuming that locus <dig> and locus <dig> have no linkage relationship, the expected frequencies of signal values  in the dh population could be deduced according to parental signals .

once we have the expected frequencies for all possible four genotypes in the dh population, we can easily distinguish different types of snps listed in figure  <dig>  since we can calculate the expected frequencies of pgs and npgs in each group, we introduced a statistics of chi-squared test  as the probability of npgs appearance  in the dh population. we used pnpg = <dig>  as the threshold to judge the presence of npg or not.

there was an exception in the type of pseudo-simple snp for above analysis, where the two polymorphic genotypes of aa/nc and bb/nc  cannot be distinguished from a typical simple snp through the pnpg values. however, the frequencies of the two parental signal values in the dh population of the simple snps of aa/nc and bb/nc were  <dig>  and  <dig> , respectively, while the frequencies of aa/nc and bb/nc in the pseudo-simple snps  were  <dig>  and  <dig> , respectively . therefore, the frequencies of these two polymorphic genotypes of aa/nc and bb/nc can be used to distinguish whether the snp was simple snp  or pseudo-simple snps . it was noted that two parents with ab signals also generated three clear clusters of aa, ab, and bb signals .

based on the pnpg values of the snp loci, the genotype data for several other polymorphic genotypes were identified from the single-locus shemi-snps . there were  <dig>  snp loci for the two polymorphic genotypes of aa/nc and bb/nc, including  <dig> loci with pnpg values > <dig> ; the remaining  <dig> loci  can be separated into  <dig> simple snps  and  <dig> pseudo-simple snps  by χ <dig> test.

based on the above analysis, the snp loci with pnpg values > <dig>  can be considered as multi-loci snps , whereas the snp loci with pnpg values < <dig>  were considered as single-locus snps . based on this standard,  <dig>  snp loci  were screened from  <dig>  polymorphic snp loci for the subsequent analysis. using the pnpg value and χ <dig> test to extract single-locus snps  from the snp array data can maximize the utilization of the total snp loci and remove the multi-loci snps , which were difficult to identify in previous studies.

it is worth to point out that homoeologous recombination between the a and c genomes might result in non-parental phenotype. there are two consequences if such recombination events happen. first, if a given snp locus is located within the homoeologous recombination fragment, its genotype will be identified as a regular locus, no matter where the fragment is distributed in the b. napus genome. in this case, the locus cannot be assigned as a npg count. second, if such a snp locus is located right at the breakpoint of the homoeologous recombination fragments, the locus will not be identified, thus resulting in a false npg count. it is now known that the homoeologous recombination between the a and c genomes occurred in a relatively low frequency at the level of large fragments  <cit> . the probability that a given snp locus is exactly located the breakpoint is rare. therefore, it is reasonable to consider such a recombination event neglectable.

the signal values of the  <dig>  valid snp loci were converted to genotype values. genotypes that were the same as that of parent p <dig> were recorded as “a”, genotypes that were the same as that of parent p <dig> were recorded as “b”, and non-parental genotypes were treated as missing . we named this method of filtering out unauthentic lines and mhemi-snp loci in snp array data using the pnpg values as bi-filtering analysis. in brief, the bi-filtering method could be summarized as follows. first, we used the monomorphic snps to calculate the pnpg value of a given dh line  to filter out the unauthentic lines ; second, we used the polymorphic snps to calculate the pnpg value of a given snp locus  to filter the mhemi-snps and pseudo-simple snp . the bi-filtering method not only makes use of the monomorphic snps to identify unauthentic lines and to assess possible errors in snp array detection, but also uses the polymorphic snps more accurately. the method thus can improve the efficiency and accuracy of the snp array data with a large portion of heterozygous signals, which is common in the analysis of high-throughput genotyping in polyploid species  <cit> . the bi-filtering method was also suitable for analyzing the genotyping data by re-sequencing of the population and parents. a flow diagram was constructed for analyzing of the high-throughput genotyping data  of the bi-parental populations . however, more specific work will be needed to verify the effect of the bi-filtering method for analyzing re-sequencing data.

the bi-filtering analysis improves the quality of genetic linkage map
previously, we constructed a genetic map  with  <dig> dh lines and  <dig>  polymorphic markers   <cit>  by means of the conventional method that uses simple substitution of genotypes based on the signal value of the parents  <cit> . linkage analysis mapped  <dig>  markers in  <dig> linkage groups  on the map c, which was  <dig> .4 cm in length with an average spacing of  <dig>  cm between the markers  <cit> . to assess the effect of the snp array data processed with bi-filtering analysis on the quality of genetic map, we constructed a new version of the genetic map with processed data  and compared such a map with the map c. after a bi-filtering analysis of both mapping population and snp markers as described above,  <dig> dh lines and  <dig>  polymorphic loci  were used to produce a genetic map. linkage analysis finally placed  <dig>  loci onto  <dig> lgs  and resulted in a new version of the genetic map  with total length of  <dig> .3 cm and an average spacing of  <dig>  cm .figure  <dig> comparison of the map b and map c with the hj-dh population. the left and right vertical bar of each panel represents the linkage groups  of the map b and map c, respectively. each lg and markers are represented with a vertical bar and transverse line, respectively. the same markers between the lg of the map b and map c are connected with black lines. the simple sequence repeat , single nucleotide polymorphism , mhemi-snp and pseudo-simple snp, and the marker that can only be assigned on the map b are shown with the black, red, blue and yellow transverse line, respectively. the data of the map c comes from cai et al.  <cit> .



compared with the map c, the map b now had an increased marker density after bi-filtering analysis of both unauthentic dh lines  in mapping population, and mhemi-snp and pseudo-simple snp markers in snp arrays . there were  <dig> markers  that could not be located on the genetic map previously, while the ratio was reduced to  <dig> %  on the map b . interestingly, all filtered  <dig>  snps were all mapped on the map b. there were  <dig> of the mhemi-snp and pseudo-simple snp markers included in the map c, which were excluded by the map b .

on the lgs with fewer mhemi-snps and pseudo-simple snps, such as lgs a <dig>  a <dig>  a <dig>  c <dig> and c <dig>  the two maps showed good consistency . however, other lgs exhibited obvious inconsistent, especially in the regions harboring mhemi-snps and pseudo-simple snps, suggesting that mhemi-snps, pseudo-simple snps, and unauthentic dh lines affected the mapping quality. first, the unauthentic dh lines may cause the exchange of the marker positions. for instance, several regions on lgs a <dig> , a <dig> , c <dig>  and c <dig>  or their neighboring regions contained few mhemi-snps and pseudo-simple snps in the map c , but there were obvious marker rearrangements and inversions in the regions . the positions and orders of the markers in these regions became consistent with the map b after removal of the  <dig> unauthentic dh lines . second, the mhemi-snps and pseudo-simple snps could result in lower marker density of the map c. there were obvious marker rearrangements and inversions in the regions of lgs a <dig> , a <dig> , c <dig>  of the map c due to the existence of mhemi-snps and pseudo-simple snps . however, the positions and orders of the markers in these regions became consistent between the two maps when the mhemi-snps and pseudo-simple snps in these regions were removed . third, mhemi-snps, pseudo-simple snps, and the unauthentic dh lines may impose influences jointly. for instance, in the regions of lgs a <dig> , c <dig> , c <dig>  and c <dig>  of the map c that contained more mhemi-snps and pseudo-simple snps, two maps of these regions showed obvious inconformity . it was found that mhemi-snps and pseudo-simple snps could cause a pseudo genetic linkage relationship between mhemi-snp and pseudo-simple snp and other markers. in total,  <dig> mhemi-snps and pseudo-simple snps were located on lgs a <dig>  a <dig>  a <dig>  c <dig>  c <dig>  c <dig> and c <dig> of map c, respectively, which resulted in excess fragments or markers on the map c . other mhemi-snps and pseudo-simple snps were dispersed in the map c and thus resulted in a decrease in the mapping density. due to such interferences, there were  <dig> simple snps that could not be mapped on the genetic map, while all of these simple snps were linked to the genetic map after bi-filtering analysis .

since the linear relationship of the ssr marker loci on each of the lgs in both the map b and c have been proved in different maps  <cit> , a framework map of ssrs could thus serve as a reference to evaluate the linear relationships of snp loci. to further compare the difference between the two maps, the graphical genotype of each dh line was constructed with the genotyping data from ssr markers and snp markers processed with bi-filtering and conventional method, respectively. the graphical genotype of each dh line exhibited good collinearity between the framework map of ssrs and the map b . however, the graphical genotypes based on the map c showed pseudo exchange fragments  in some dh lines, especially in the lgs with more mhemi-snps and pseudo-simple snps .

based on the above analysis, we concluded that a screening of mhemi-snps, pseudo-simple snps, and the unauthentic dh lines for the construction of genetic maps was important. the bi-filtering analysis can remove mhemi-snps, pseudo-simple snps, and unauthentic dh lines, thus improving the quality of a genetic map as observed in the map b. with more loci included in future higher density snp arrays, such as 60 k snp arrays  <cit> , more mhemi-snps and pseudo-simple snps were expected to be filtered and the mapping quality would be further improved.

the bi-filtering analysis increase the accuracy of qtl mapping
next, we analyzed if the mhemi-snp and pseudo-simple snp loci could have any adverse effects on qtl mapping. results of qtl mapping of  <dig> agronomic traits in four environments were compared between the two maps. on the whole,  <dig> and  <dig> qtls of  <dig> traits were identified by the map b and map c, respectively. there were  <dig> qtls located on the excess fragments of lgs a <dig>  a <dig>  c <dig>  c <dig> and c <dig> in the map c, which can explain the contribution of phenotype   <dig> - <dig> % , with logarithm of odds  score  <dig> - <dig>  . however, these qtls could not be identified in the map b, because the pseudo fragments have been filtered and the pseudo-qtls resulted from the mhemi-snps and pseudo-simple snps eliminated. moreover, the mhemi-snps and pseudo-simple snps dispersed along the different lgs of the map c also affected the qtl identification. there were  <dig> qtls that could be identified in the map b but not in the map c. above data thus illustrated that the mapping accuracy of qtls can be affected to a significant extent by mhemi-snps and pseudo-simple snps.

in order to more clearly illustrate this effect, we focused on the qtls on the lgs a <dig> and c <dig> . in map c, each of these two lgs contained  <dig> and  <dig> mhemi-snps and pseudo-simple snps respectively , which caused an inversion in the upper portion and an extra fragment with a length of approximately 82 cm in the lower portion of the lg c <dig>  in this region, a major qtl of seed protein content  with a lod score of  <dig>  and a contribution to the phenotype of up to  <dig> % was detected. however, this qtl was no longer detectable in lg c <dig> in the map b, in which these mhemi-snps and pseudo-simple snps were eliminated. such a difference suggested that these mhemi-snps and pseudo-simple snps could cause the erroneous detection of qtls. similarly, for the lg a <dig>  the presence of  <dig> mhemi-snps and pseudo-simple snps led to disorder in the linkage relationship for the markers on a <dig> . similarly, there were  <dig> pseudo qtls identified in this region on map c. of which a qtl for silique density  with a lod score of  <dig>  and a phenotypic contribution of up to  <dig> % was mapped, but no qtl was detectable in the map b. taken together, these results indicate that the mhemi-snps and pseudo-simple snps could interfere with the establishment of the linkage relationship between the markers and subsequently affect the subsequent qtl mapping, as well as candidate gene analysis, although they only accounted for  <dig> % of the total number of markers in the map c. therefore, the removal of the unauthentic lines, mhemi-snps, and pseudo-simple snps from the population using the bi-filtering method could improve the accuracy of a genetic map that is crucial for subsequent analyses.figure  <dig> comparison of genetic map construction and quantitative trait locus  mapping on the linkage groups  a <dig> and c <dig> of the hj-dh population with the map b and map c. only a sub-set of molecular markers are presented for each genetic lg. the single nucleotide polymorphism  markers with underlined  are the mhemi-snps and pseudo-simple snps. the detailed information about the lgs of the map b is described in additional file 3: table s <dig>  and the data of the map c comes from cai et al.  <cit> . the sub-set same molecular markers between the two lgs depicted are aligned with black lines. pc: protein content; sd: silique density. significance thresholds for qtls at the level p =  <dig>  are estimated based on  <dig> permutation.



CONCLUSIONS
we have developed a novel bi-filtering method to effectively identify unauthentic dh lines as well as mhemi-snp and pseudo-simple snp loci resulted from the superposition of the multiple snp loci signals in snp arrays. such a bi-filtering analysis of the snp array data can maximize the use of the snp array data more accurately in polyploid species, to which many important crops belong. the power of the method would be more obvious in higher density arrays where manual filtering analysis will become difficult.

additional files
additional file 1: table s <dig>  detailed information of pnpg of the dh population, monomorphic snp loci and the two-dimensional matrix of the monomorphic snp loci genotypes in the hj-dh population.

additional file 2: figure s <dig>  clusters of different types snps in the dh population without  <dig> unauthentic dh lines. the snp classification and group number for each cluster are the same to that of figure  <dig> 

additional file 3: figure s <dig>  a flow diagram for analysis the high-throughput genotyping data  of the bi-parental populations.

additional file 4: table s <dig>  parameters of two genetic maps constructed by the bi-filtering analysis method  and the conventional method . the data of the map c comes from cai et al.  <cit> .

additional file 5: table s <dig>  detailed information of the genetic linkage maps of the hj-dh population constructed by the bi-filtering analysis method , the homoeologous loci and homoeologous collinear fragments identified in b. rapa and b. oleracea.

additional file 6: figure s <dig>  effects of unauthentic dh lines on the localization of the snp markers on linkage groups  a <dig>  a <dig>  c <dig>  and c <dig>  the left, middle and right vertical bars of each panel represents the lgs constructed with the data from the map c without the  <dig> unauthentic dh lines, the map b, and the map c with  <dig> unauthentic dh lines, respectively. each lg and markers are represented with a vertical bar and transverse line, respectively. the same markers between the lg of these three maps are connected with black lines. the simple sequence repeat , single nucleotide polymorphism , mhemi-snp and pseudo-simple snp, and the marker that can only be assigned on the map b are shown with the black, red, blue and yellow transverse line, respectively. the data of the map c were adopted from cai et al.  <cit> .

additional file 7: figure s <dig>  effects of mhemi-snps and pseudo-simple snps on the localization of the snp markers on linkage groups  a <dig>  a <dig>  and c <dig>  the left, middle and right vertical bars of each panel represents the lgs that are constructed with the data from the map c without the mhemi-snps and pseudo-simple snps in  <dig> dh lines, the map b, and the map c with the mhemi-snps and pseudo-simple snps in  <dig> dh lines, respectively. each lg and markers are represented with a vertical bar and transverse line, respectively. the same markers between the lg of these three maps are connected with black lines. the simple sequence repeat , single nucleotide polymorphism , mhemi-snp and pseudo-simple snp, and the marker that can only be assigned on the map b are shown with the black, red, blue and yellow transverse line, respectively. the data of the map c were adopted from cai et al.  <cit> .

additional file 8: figure s <dig>  the graphical genotypes of three dh lines  on lgs a <dig>  c <dig> and c <dig> constructed by the ssr, bi-filtering and conventional method, respectively. in each panel, the left, middle and right lg constructed by the ssr, bi-filtering and conventional method, respectively. the data of the map c comes from cai et al.  <cit> . in each lg, the horizontal bars represent molecular markers, the red, blue and black color represents p <dig>  p <dig> and missing genotype, respectively. arrows indicates the pseudo fragments in the genetic map constructed by the conventional method, which did not exist in the maps constructed by the ssr and bi-filtering methods.



abbreviations
csscluster separation score

mafminor allele frequency

pgparental genotype

npgnon-parental genotype

pnpgpercentage of non-parental genotype

shemi-snphemi-snp from a single locus

mhemi-snphemi-snp from multi-loci

pcprotein content

sdsilique density

guangqin cai and qingyong yang contributed equally to this work.

competing interests

the authors declare that they have no competing interests.

authors’ contributions

yz and gc conceived the research. gc and qy performed the snp array data analysis and comparative mapping. jb and de designed and developed the snp array. by carried out the snp genotyping. gc, cf, and cz performed the genetic map construction, graphic genotype analysis and qtl mapping. gc, yz, jb, and de wrote the paper. all the authors have commented, read and approved the final manuscript.

