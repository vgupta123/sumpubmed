BACKGROUND
the last decade has witnessed an increased effort at bringing together methods and ideas from evolutionary and developmental biology  to explore the genetic basis of morphological diversity  <cit> . understanding the genetic bases of phenotypic variation is a fundamental challenge for evo-devo and for contemporary biology in general  <cit> . the color patterns on butterfly wings are a spectacular example of morphological variation, and have been established as an important system in the study of evolution and development  <cit> . these patterns, which vary both across and within species, are ecologically relevant and often have a known adaptive value, including amazing examples of mimicry  <cit>  and adaptive phenotypic plasticity  <cit> . they have also been the object of developmental studies at different levels, including the genetic pathways involved in pattern formation, the physiological basis of pattern plasticity, and the biochemical pathways leading to pigment production .

bicyclus anynana has been established as a butterfly laboratory model which is well suited to address important questions in ecological, evolutionary and developmental genetics  <cit> . the study of b. anynana wing patterns has already made important contributions to evo-devo . the patterns of phenotypic and genotypic variation in different eyespot traits have been explored within and across species  <cit> , and a number of developmental pathways known from d. melanogaster wing development have been implicated in butterfly color pattern formation  <cit> . more recently, we have shown that candidate genes within these pathways can contribute to between-individual variation in wing pattern in b. anynana butterflies  <cit> .

knowledge from d. melanogaster wing development studies has undoubtedly greatly advanced our understanding of butterfly wing pattern formation. yet, despite the power of this approach, it is limited in that it does not generate candidate genes outside known drosophila wing genes. lepidoptera  and diptera are highly diverged and butterfly and dipteran wings are quite different . it thus seems unlikely that all the genes involved in butterfly wing pattern formation will be genes known from drosophila wing development  <cit> . clearly, a more unbiased search for pattern variation candidate genes is necessary to understand fully butterfly wing color evolution and development. unfortunately, genomic resources in lepidoptera are scarce, even though this order of holometabolous insects encompasses over  <dig>  species, including many of economical importance . most available information concerns the silkworm, bombyx mori  <cit> , with recently published expression sequence tag  <cit>  and whole-genome shotgun  <cit>  projects. other moths  are not nearly as well studied and genomic resources for butterflies are scarcer still, despite ongoing expansion of gene collections for heliconius  <cit> . developing such resources is a fundamental step towards a detailed analysis of the genetic bases and consequences of some unusual biological properties of lepidopterans , as well as those that distinguish butterflies from moths .

important recent advances for b. anynana genomic resources include an ongoing project to build and analyze bacterial artificial chromosome libraries, the development of germline transformation techniques to enable functional analysis of candidate genetic regions  <cit> , and the characterization of  <dig> polymorphic microsatellites including a female-specific marker  <cit> . until now, however, only twelve either partial or full-length coding sequences from b. anynana had been deposited in genbank. as a way to identify a large number of genes for this species quickly and efficiently, we carried out an expression sequence tag  project. est projects are a cost-effective and powerful way to identify a large number of expressed genes in any species  <cit> , especially those without a genome project, and have been used in many different systems . furthermore, many "downstream" applications stem from est projects, including genome annotation, and the development of both high-density expression arrays, and gene-based genetic markers  <cit> .

here, we describe a b. anynana est project in which we identify over  <dig>  unique genes  expressed in developing butterfly wings, together with dna sequence polymorphisms in many of the more highly expressed transcripts. our project was designed to maximize the likelihood of characterizing genes important in wing pattern formation and simultaneously identify polymorphisms in a fraction of these genes. the results described here characterize the most extensive est/gene resource publicly available for any butterfly species. this collection will be the basis to build a gene-based linkage map and gene expression arrays for b. anynana butterflies, and will be of great utility in comparative genomics in the lepidoptera.

RESULTS
est statistics
we processed and assembled a total of  <dig>  ests from five different wing libraries . these included  <dig>  of length shorter than  <dig> bp and  <dig>  which assembled into  <dig> unigenes of low complexity  and were excluded from further analysis . the other  <dig>  est sequences assembled into  <dig>  unigenes, of which  <dig>   were estimated to have coding potential using estscan . our library subtraction procedure, based on removing ests observed to be at a high frequency in an initial sample of ~ <dig>  pcr-amplified inserts , enabled us to obtain as many unigenes with ~ <dig>  sequence reads as would have been obtained from ~ <dig>  clones without subtraction. figure  <dig> illustrates est redundancy in our project. about 70%  of the unigenes we identified were singletons , and  <dig>  resulted from aligning four or more ests. the maximum alignment depth observed was  <dig> ests in one contig. multifasta files with the alignments for all multimember unigenes are available from  <cit>  as a single compressed file. table s <dig>  lists all individual ests of length greater than  <dig> bp and related information, including the actual sequence , sequence length, ratio of low quality nucleotides to total length, and the contig into which they were assembled. table s <dig>  lists all contigs and all description and annotation information discussed in this report.

a see methods for a full description of each library; b total number of ests submitted to ncbi estdb and, in parentheses, the number of these which were excluded from the analysis .

gene identification
annotation of the b. anynana wing unigenes was achieved through blast analyses against a number of different genomic collections. a total of  <dig>  unigenes  had a significant blast hit against at least one of the collections used in our analysis . the venn diagram of figure 2a illustrates unigene annotation based on available genomic collections that are most relevant to this project: the model dipteran d. melanogaster and the silkworm b. mori , and diverse and dispersed collections of lepidopteran nucleotides and invertebrate proteins.

a the threshold maximum e-value was set to 1e- <dig>  b total number of contigs with significant e-value. c number of contigs having the lowest e-value for each specified blast field. when the lowest and second lowest e-values were the same for a particular contig it counted as  <dig>  for each of the hit fields. d number of contigs having significant blast hits exclusively for one of the fields. some blast fields were combined to give the counts in figure 2:  <dig> dmel,  <dig> bmori,  <dig> invlep,  <dig> protein databases,  <dig> non-nuclear genes . all collections used in our blast analysis were downloaded from public databases  in june-august of  <dig> .

even though all of the contigs included in figure 2a showed a significant blast result against one of the invertebrate collections we defined , the best blast hit was not always to one of these . fourteen unigenes had best blast hits to non-nuclear or non-animal gene collections, and for six of these the ratio between e-values for the overall best blast hit and for the best hit to one of the invertebrate-specific genes  was greater than  <dig>  these included three contigs that appeared to be either non-nuclear genes  or non-coding rnas , and three others likely corresponding to material from bacteria  or plants . both contigs referred to above as "organel.nuc" actually correspond to chloroplast trna and thus add to the probable contaminants resulting from plant dna incorporated in our libraries. this list of probable contaminants is likely to be an under-estimate of the genes that are not nuclear genes from butterfly wings. our lepidopteran collection, for example, is an amalgam from many different independent studies deposited on embl in association to a lepidopteran species and does contain a number of organelle genes, non-coding rnas, and potentially even bacteria and plant contaminants.

functional annotation
in order to assign putative functional roles to the identified unigenes, we used the gene ontology  annotations of d. melanogaster genes. based on blast analysis against the d. melanogaster collections, we identified  <dig>  d. melanogaster genes orthologous to at least one of our b. anynana transcripts. in addition, our blast analyses against the b. mori est collections, in concert with our own annotation of the bombyx mori collection via d. melanogaster, led to the identification of  <dig> additional d. melanogaster orthologs not identified by direct comparisons between b. anynana and d. melanogaster . the list of  <dig>  b. anynana unigenes with d. melanogaster orthologs, and the complete collection of  <dig>  drosophila genes retrieved from flybase were used with gominer  <cit>  to assign go terms to each b. anynana unigene with a d. melanogaster ortholog and to look for go categories enriched in our unigene collection  . go annotations based on blast hits to the interpro database are available in our web-accessible database in opensputnik  <cit> .

# is the number of b. anynana gene annotations obtained via blast analysis d. melanogaster and b. mori  that belong to the listed go categories. % refers to the proportion of d. melanogaster genes  found in b. anynana for each go category. the categories specified in this list are a limited subset of all go categories found to be represented . a chi-square test was performed for the null hypothesis that the fraction of b. anynana unigenes in each go category relative to the total number of b. anynana unigenes with an assigned category is equivalent to the fraction of d. melanogaster genes in that category relative to all d. melanogaster genes with a go assignment. for the cases where chi-square p >  <dig> , p-values are provided. all other cases are p <  <dig> .

dna sequence polymorphisms and microsatellite repeats
we identified a total of  <dig>  snps  in  <dig>  of our  <dig>  non-singleton unigenes . we also counted the number of "double-hit" snps . these snps are much less likely to be errors generated during library construction than "single-hit" snps but they can only be identified from alignments with a depth of at least four ests. we observed a total of  <dig>  double hit snps. of our  <dig> unigenes of alignment depth four or greater  <dig>  had at least one "double-hit" snp and, of these,  <dig>  had a significant blast hit to at least one of the fields in table  <dig>  that is, unigenes with double-hit snps are somewhat highly expressed and as a result are likely to have some associated annotation.

we identified  <dig> di-, tri-, tetra- and penta-nucleotide repeat microsatellites in our unigenes  with minimum repeat thresholds described in the methods. of the identified microsatellites,  <dig>  were associated with sequence alignments greater than one, and of these, ten  were polymorphic in our sample, having up to seven segregating alleles. details about the microsatellites identified are provided in table s <dig>  and include the repeat sequence, the number of times it is repeated, and its location within the host contig sequence.

a microsatellites whose repeat unit is not composed exclusively of the nucleotides a and t, b total numberof microsatellites occurring in a region where the alignment depth is greater than one, c total numberof microsatellites for which we observed more than one allele in our est collection. details in table s <dig> .

b. anynana est database
apart from all ests being deposited in genbank  and, from there, downloaded into butterflybase  <cit> , our b. anynana est database is available in two complementary formats. a large flat file  suitable for importation into a local database program and a web-accessible opensputnik version  <cit> . the opensputnik version contains a great deal of information for every est and every contig and is of the greatest utility for obtaining much information about a few sequences. the downloadable flat file, on the other hand, is useful for typical simple queries of many contigs of special interest. the fields in the flat file include, for each contig: the consensus sequence and sequence length the predicted protein, the total number and a list of all constituent ests, the best blast hit with e-value lower than 1e- <dig>  over several gene collections of interest . in the case of blast against the b. mori whole genome collections, we also provide information about the gene location . the flat file also includes "hot links" to the alignments for every non-singleton contig. the opensputnik database, on the other hand, has extra information available, including the ests flagged as low quality and excluded from the analysis in this report, a number of supplementary blast fields, and unigene functional annotations based on mappings of swissport and interpro to go  <cit> .

discussion
we carried out an est project designed to identify a large number of novel b. anynana genes and additionally identify snps in a fraction of those genes. we biased gene discovery towards genes expressed in wing tissue during the developmental stages when patterns on the wings of butterflies are known to be determined . sequencing of ~ <dig>  pcr-amplified clone inserts was carried out in two rounds, so that highly redundant ests identified during the first round could be used in a library-subtraction scheme aimed at minimizing total est redundancy. assembly of  <dig>  ests allowed us to identify  <dig>  b. anynana wing disc unigenes, of which  <dig>  were annotated based on blast analyses against gene collections available for other organisms . our alignments of different natural alleles allowed us to identify snps in many multi-member unigene contigs . finally, we identified  <dig> potential microsatellites markers in expressed sequences, with about 23% located in alignments of depth two or greater, and 14% of these being polymorphic. overall, our project has generated genomic resources that will be invaluable for exploring the potential of b. anynana as a model in ecological, evolutionary, and developmental genetics.

sequence ests from 3' end to facilitate combined gene and snp discovery
using a modified 3' adaptor and modified 3' primer , we introduced "point mutations" in the polya tail of the cdna clones to facilitate sequencing through this repetitive region. a 3' sequencing effort results mostly in information about the 3' untranslated regions  of genes, which despite their role in mrna processing  <cit> , are often not highly conserved and thus do not blast 3' utrs of other organisms. however, for genes which have a relatively short 3' utr, part of the est sequence is coding region, allowing for gene identification in many instances. the average size of 3' utrs in invertebrates is estimated to be ~ <dig> bp  <cit> , which is shorter than the average size of our unigenes , but there is much variation around this length. in our project, 48% of the assembled unigenes did not have a predicted peptide  suggesting a 3' utr longer than the sequence read.

despite the difficulties of gene annotation associated with 3' utr reads, the advantages are many-fold. the likelihood of overestimating the number of unigenes is higher in 5' projects relative to 3' projects, as cdna clones are often not full length and 5' sequencing can result in the identification of non-overlapping parts of the same gene. in contrast, except for cases of alternative 3' utrs or polyadenylation sites  <cit> , all est sequences for a given unigene in a 3' project share a common poly-a tail and generally align. the resulting alignment depths, which are greater than those typically seen in 5' projects, together with our deliberate use of outbred individuals for building the cdna libraries , enabled us to identify snps in many of our unigenes . finally, the 3' ends of genes are better features for expression arrays, since probe labeling for gene expression profiling is typically 3' biased and cross-hybridization amongst gene family members is minimized as 3' utrs are generally less conserved than coding regions.

identifying genes expressed in developing butterfly wings
our library subtraction protocol enabled us to reduce the redundancy typical of est projects so as to maximize the number of new genes identified and still have alignments deep enough for polymorphism identification. we have identified  <dig>  b. anynana wing unigenes of which  <dig>   had a blast hit against at least one of the genomic collections in our analysis .

although it is possible that the  <dig>  genes with no blast hits to any of the collections in table  <dig> are unique to butterflies , it seems more likely that these unigenes have read lengths shorter than the length of the 3' utr  and that the utr is not conserved to b. mori  or to any sequence in the lepidopteran collection . about 74%  of the unigenes with no significant blast hit in our analysis had no corresponding predicted protein. conversely, only 15% of the unigenes with predicted proteins failed to have significant blast hits. a collection of 5' reads for our unigenes and the growing gene collections available for butterflies will likely help in identifying additional orthologs.

the closest organism to b. anynana with extensive genomic collections is the moth b. mori, but moths and butterflies have diverged more than  <dig> million years ago  <cit>  and it is conceivable that even coding regions might not be conserved over such evolutionary distances . furthermore, the sometimes spectacular differences between butterflies and moths in morphology  and behavior  also argue for the possibility of there being genes in each group with no obvious homolog in the other. in fact, of the  <dig>  peptides predicted from our b. anynana contigs,  <dig>  with predicted peptides longer than  <dig> amino acids had no significant blast hit to any database. whereas these peptides may represent artifacts from alignment and peptide prediction algorithms, it is also possible that they correspond to new or highly diverged proteins in butterflies. it will be interesting in future work to determine whether these genes have expression patterns suggestive of a role in wing color patterning and if they are seen in other butterflies.

heliconius butterflies are phylogenetically closer to b. anynana  than b. mori, and have rapidly growing gene collections. all heliconius genes deposited in the standard databases at the time of analysis were included in our lepidopteran and invertebrate collections  for gene identification based on sequence homology , but not singled-out for a separate blast analysis. both heliconius and b. anynana collections are incomplete in terms of unigene number ) and their length  and thus a separate analysis is of limited value for gene identification. the comparison between these nymphalid collections will become much more valuable as both get larger 

gene annotation via homology with d. melanogaster
d. melanogaster is the insect with the largest mass of available information on genome sequence and its functional characterization. using these resources can be of great value for gene identification and characterization of new insect genomic collections . we were able to attempt a functional annotation of our b. anynana contigs that blast drosophila either directly or indirectly via bombyx. three of the classes of genes annotated based on go classifications for drosophila deserve special reference.

the first class is that of the so-called house-keeping genes which included  <dig> structural constituents of ribosomes , and  <dig> tubulin genes , as well as many other genes characteristically expressed at high levels in many cell types. given that such genes are likely to be discovered in essentially all est projects, they may turn out to be a valuable resource for comparative studies. sequence comparisons across lepidopteran species can provide insight into the molecular evolution of particular gene families, and might be useful to build a time-calibrated phylogeny for higher lepidopteran taxa  <cit> . furthermore, if genes belonging to these classes are added to genetic maps for several lepidopteran species, we will be able to further analyze and hopefully confirm the patterns of synteny in this group . comparing gene order using traditional linkage mapping-based approaches is likely to remain the preferred method of synteny inference in lepidopterans for some time, as lepidopteran genomes are large by insect standards  and whole genome shotgun sequencing projects  <cit>  have thus far been difficult to assemble into scaffolds large enough for chromosome assignment or even small-scale synteny analysis.

the second class of genes worth highlighting includes those known to be involved in fly wing development, which are a priori candidates for contributing to wing pattern formation and variation . table  <dig> lists a number of genetic developmental pathways in this category, including  <dig> genes from fly wing disc development,  <dig> from tracheal system development, and genes from different signaling pathways involved in wing development . the availability of sequences for such genes will enable segregation tests to assess their involvement in pattern development and contribution to pattern variation within and between species .

finally, a third and exciting class of genes we identified includes those not characteristically expressed in drosophila wing imaginal discs, which seem to have been recruited to function during butterfly wing development. our b. anynana wing ests include  <dig> genes  known to be involved in eye pigmentation in d. melanogaster , which likely have been recruited to produce butterfly wing pigmentation  <cit> . this discovery illustrates a limitation of generating butterfly wing candidate genes based solely on d. melanogaster wing development. furthermore, it provides yet another exciting example of the possible co-option of insect-wide developmental pathways to produce butterfly-specific traits. wings covered with colorful scales are a morphological novelty in the lepidoptera whose development has been shown to involve a number of genetic pathways known from d. melanogaster: formation of particular wing pattern elements relies on pathways involved in overall wing formation in drosophila  <cit> , and wing scale production recruits a pathway from drosophila bristle development  <cit> . our results illustrate a third potential example of genetic co-option on butterfly wings, with known pigment genes used in the drosophila eye also used to color wings .

sequence polymorphisms in b. anynana wing genes
sequence quality is of fundamental importance for accurate snp identification. historically, dna sequences associated with est projects have not included quality scores. we used lowercase letters for bases with phred scores  <cit>  lower than  <dig>  and ignored "low quality" bases for snp analysis. figure  <dig> shows that we have identified a large number of snps . in fact, all unigene clusters with an alignment of depth of six or greater have at least one snp. different explanations can be put forward to explain this high number. first, there were several steps where errors could have been introduced during library construction and amplification, such as the use of reverse transcriptase during first strand synthesis, or the 22-cycle exponential amplification of the reverse-transcribed products carried out prior to cloning . such errors would not necessarily result in low quality bases and could potentially be identified as snps. secondly, assembly and alignment algorithms can both over-assemble and misalign, especially when the sequences being studied are known to harbor snps. incorrect alignments, combined with possible instances of pseudogenes or gene duplications in our est collection will falsely increase estimates of polymorphism level. finally, it is possible that our outbred source population did have polymorphism levels approaching those observed. the levels we observed are only approximately twice as high as those generally seen in well-studied populations of d. melanogaster , and not inconsistent with the only previous snp survey in b. anynana  <cit> .

as discussed above, it seems likely that a substantial fraction of the over  <dig> thousand snps identified in  <dig>  of our non-singleton unigenes  might not be actual segregating polymorphisms. a conservative estimate of the number of "reliable" snps can be made by only considering "double-hit" snps  which are far less likely to be associated with the unreplicable random errors arising from library construction and clone amplification. a total of  <dig>  "double-hit" snps were identified in  <dig> of our  <dig> unigenes with an alignment depth of four or greater. although many of the  <dig>  snps with a minor allele count equal to one may be true snps, this class is undoubtedly enriched for erroneously identified sequence polymorphisms. furthermore, even if real, snps with an observed minor allele count of one are of questionable utility, as population genetics theory predicts their expected population frequency to be much lower than 1/d, where d is the depth of the alignment  <cit> .

developing genomic resources for b. anynana
the genes and snps we identified will be the basis for the development of important genomic tools for b. anynana, which will be invaluable in the effort to understand the genetic basis of variation in butterfly wing patterns and the evolutionary and developmental processes shaping that variation.

the dna sequence polymorphisms identified in our study will be used to build a high-density linkage map in which the markers are snps in genes expressed in developing wings. such a map will have added value relative to a map constructed entirely of anonymous markers, as i) mapping qtls to individual genes is often only possible by testing candidate genes in the interval to which a qtl is mapped , ii) testing polymorphic markers in candidate genes for co-segregation with a character of interest is an efficient way to be able to exclude those genes as contributing to variation in the character, and iii) it is possible that synteny among lepidopterans  can be used to suggest candidate genes for any qtl mapped to an interval between two gene-based markers in maps of different species. although we have identified "reliable" snps in only a subset of our unigenes , we now have gene sequence tags for many developmental candidate genes in which we can develop markers and determine the relative position on a linkage map for the  <dig> chromosomes of b. anynana . we have also identified  <dig> microsatellite repeats  which can be tested for polymorphism levels in outbred b. anynana, and hopefully add to the  <dig> polymorphic microsatellite loci already characterized in this species  <cit> . microsatellites markers have been difficult to develop in lepidopterans based on traditional methods of screening gdna libraries  <cit>  . modest repeat number microsatellites potentially located within coding regions, such as those we identified, are likely to be somewhat less polymorphic than gdna-based microsatellites. however, markers associated to expressed sequences are more likely to be useful in other species and in the context of comparative mapping.

pcr amplicons corresponding to our unigene set can be used to generate high-density gene arrays to monitor changes in gene expression levels associated with different types of changes in wing pattern phenotype   <cit> . targeting 3' utr sequences has important benefits in relation to creating high-density arrays and future gene expression experiments. untranslated regions diverge very quickly, even within gene families, and thus cross-hybridization among features on the gene arrays is less of an issue than when features correspond to protein coding regions. moreover, as most current methods of labeling polya rna for gene expression analysis show a marked drop off in efficiency with distance from the polya tail, array features corresponding to 3' utrs are more likely to show above background signals after hybridization with labeled rna.

genomic resources for lepidoptera
the est resource described here represents the most extensive collection available for any butterfly species. butterflies and moths comprise the order of lepidoptera which is a very species-rich order of holometabolous insects and includes many organisms of great economical  and educational  value. however, genomic resources for lepidoptera are scarce relative their biological and societal importance. the vast majority of gene sequence information available for this group come from recent releases of the silkmoth est  <cit>  and genome projects  <cit> . just prior to submission of our ests to genbank , this reference database had about  <dig>  ests from b. mori and the rest of all lepidopterans represented by only about  <dig>  ests. of these, a little over  <dig>  were from papilionoidea  and mostly came from species of the genus heliconius whose collection is still growing. on-going projects to develop genomic resources in these and other butterfly species, together with the organized effort of inventorying such resources in a dedicated database  will enable exciting comparative analysis and progress in making the most of this group of organisms as study targets in various areas of biological research. est projects, such as the one described here are, in the short term, likely to remain the best approach to genomic analysis in butterflies whose relatively large genome size  renders genome projects expensive and difficult to assemble.

CONCLUSIONS
color patterns on butterfly wings have already made key contributions to the effort of integrating evolutionary and developmental biology in the study of adaptive morphological evolution. wings patterns are highly diverse, yet structurally relatively simple , ecologically relevant, and suited for many levels of genetic and developmental dissection. scarcity of genomic resources in this group of organisms has slowed the deepening of our detailed understanding of the genetic and developmental mechanisms that underlie the production of diversity in wing patterns. by targeting cdna from developing wings at the stages when pattern is specified, the est project described here biased gene discovery towards genes potentially involved in pattern formation. assembly of  <dig>  ests from a subtracted library allowed us to identify  <dig>  putative gene objects including  <dig>  with homologs in publicly available gene collections, and over  <dig> potentially representing novel or highly diverged butterfly genes. analysis of putative gene function through gene ontology databases identified different classes of genes, including "housekeeping" genes recurrent in est projects, classical wing development genes and also new candidate genes which are typically not associated with wing development in the genetic model d. melanogaster. by targeting cdna from a large number of outbred butterflies  and sequencing ests from the 3' end , our project combined gene discovery with identification of putative markers  in expressed genes.

the genetic resources stemming from the est project described here can be used to pursue a detailed understanding of the genetic basis of phenotypic variation, as well as address fundamental questions in evolutionary biology. identified ests will aid in the identification of the specific genes, gene regions, and possibly nucleotides underlying phenotypic variation of adaptive traits. the color patterns on b. anynana wings are well suited for an analysis of different modes of phenotypic variation, enabling the comparison between the basis of variation within and across species, between standing quantitative variation and mutants of large effect, and of variation generated by developmental plasticity in relation to environmental cues  <cit> . this variation can, furthermore, be explored at different levels of biological organization, ranging from the genetic pathways involved in trait formation  <cit>  to the ecological relevance of pattern variants  <cit> . this system provides an excellent opportunity to address other key issues in evolutionary-developmental biology, including the evolution of morphological innovations  and the co-option of existing developmental pathways to produce such new phenotypes.

