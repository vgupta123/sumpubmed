BACKGROUND
local sequence alignment plays a major role in the analysis of dna and protein sequences  <cit> . it is the basic step of many other applications like detecting homology, finding protein structure and function, deciphering evolutionary relationships, etc. there exist several local sequence alignment programs that use well-known algorithms  <cit>  or their heuristic versions  <cit> . database search is a special case of pairwise local sequence alignment where the second sequence is a database in itself consisting of many sequences. recently, there have been many enhancements in alignment program features  <cit>  using difference blocks and multiple scoring matrices, in an attempt to incorporate more biological features in the alignment algorithm.

why statistical significance?
the local sequence alignment programs report alignment scores for the alignments constructed, and related  sequences will have higher alignment scores. but the definition of high depends strongly on the alignment score distribution, which gives importance to the concept of statistical significance. an alignment score is considered statistically significant if it has a low probability of occurring by chance. since the alignment score distribution depends on various factors like alignment program, scoring scheme, sequence lengths, sequence compositions  <cit> , it implies that it is possible to have two alignments of different sequence pairs with scores x and y with x <y, but x more significant than y. therefore, instead of using the alignment score for detecting homology, the statistical significance of an alignment score is more widely accepted as a metric to comment on the relatedness of the two sequences being aligned. of course, it is important to emphasize here that although statistical significance is a good preliminary indicator of biological significance, it does not necessarily imply biological significance  <cit> .

accurate statistical theory for the ungapped alignment score distribution is available  <cit> . however, no precise statistical theory currently exists for the gapped alignment score distribution and for score distributions from alignment programs using additional features. accurate estimation of statistical significance of gapped sequence alignment scores has attracted a lot of attention in the recent years  <cit> .

although there exists some understanding of the statistics of gapped alignment score distributions for simple scoring schemes  <cit> , but a complete mathematical description of the optimal score distribution remains far from reach  <cit> . there exist some excellent reviews on statistical significance in sequence comparison in the literature  <cit> .

database statistical significance versus pairwise statistical significance
recently, a study of pairwise statistical significance and its comparison with database statistical significance  <cit>  was conducted. in summary, the database statistical significance reported by most database search programs like ssearch, fasta, psi-blast is database-dependent, and hence, the same alignment of two sequences with the same alignment score can be evaluated as having different significance values in database searches with different databases, and even with the same database at different times, as the database size can be variable. on the other hand, pairwise statistical significance is specific to the sequence pair being aligned, and is database-independent. in  <cit> , various approaches to estimate pairwise statistical significance were compared to find that maximum likelihood fitting with censoring left of peak is the most accurate method for estimating pairwise statistical significance. further, this method was compared with database statistical significance in a homology detection experiment to find that pairwise statistical significance performs comparably to and sometimes significantly better than database statistical significance.

accurate statistical significance estimates for pairwise alignments can be very useful to comment on the relatedness of a pair of sequences aligned by an alignment program independent of any database. and thus, it can also be used to compare different combination of alignment parameters – like the alignment program itself, substitution matrices, gap costs. a comparison of different gap opening penalties for four commonly used blosum matrices using pairwise statistical significance was presented in  <cit> . in addition to the standard local alignment algorithms  <cit> , some recent algorithms have been developed  <cit>  that take into account other desirable biological features in addition to gaps – like difference blocks or the use of multiple parameter sets . these features of the alignment programs enhance the sequence alignment of real sequences by better suiting to different conservation rates at different spatial locations of the sequences. as pointed out earlier, accurate statistical theory for alignment score distribution is available only for ungapped alignment, and not even for its simplest extension, i.e., alignment with gaps. accurate statistics of the alignment score distribution from newer and more sophisticated alignment programs therefore is not expected to be straightforward. for comparing the performance of newer alignment programs, accurate estimates of pairwise statistical significance can be very useful. further, quick and accurate estimates of pairwise statistical significance can also be helpful for applications like multiple sequence alignment and phylogenetic tree construction which are based on pairwise sequence alignment to select most related pairs of sequences, for example, in a progressive multiple sequence alignment.

the extreme value distribution for ungapped and gapped alignments
just as the distribution of the sum of a large number of independent identically distributed  random variables tends to a normal distribution , the distribution of the maximum of a large number of i.i.d. random variables tends to an extreme value distribution   <cit> . this is an important and useful fact, because in principle it allows us to fit an evd to the score distribution from any local alignment program and use it for estimating statistical significance of scores from that program. the distribution of smith-waterman local alignment score between random, unrelated sequences is approximately a gumbel-type evd  <cit> . in the limit of sufficiently large sequence lengths m and n, the statistics of hsp  scores are characterized by two parameters, k and λ. the probability  that the optimal local alignment score s exceeds x is estimated by:

 pr ~ <dig> - e-e, 

where e is the e-value and is given by

 e = kmne-λx. 

for e-values less than  <dig> , both e-value and p-values are very close to each other. the above formulae are valid for ungapped alignments  <cit> , and the parameters k and λ can be computed analytically from the substitution scores and sequence compositions. for gapped alignments, no perfect statistical theory has yet been developed, although there exist some good starting points for the problem as mentioned before  <cit> . recently, researchers have also looked closely at the low probability tail distribution, and the work in  <cit>  applied a rare-event sampling technique earlier used in  <cit>  and suggested a gaussian correction to the gumbel distribution to better describe the rare event tail, resulting in a considerable change in the reported significance values. however, for most practical purposes, the original gumbel distribution has been widely used to describe gapped alignment score distribution  <cit> . from an empirically generated score distribution, we can directly observe the e-value e for a particular score x, by counting the number of times a score x or higher was attained. since this number would be different for different number of random shuffles n , a normalized e-value is defined as

 enormalized=en 

in theory, this normalized e-value is same as the p-value .

contributions
in this paper, we extend the existing work on pairwise statistical significance  <cit>  to incorporate in it the use of multiple parameter sets, and evaluate it on an important knowledge discovery application-homology detection. we conducted similar experiments as reported in  <cit> , and later in  <cit>  on a subset of the cath  <dig>  database to compare pairwise statistical significance with single and multiple parameter sets. this benchmark database was earlier created in  <cit>  to evaluate seven protein structure comparison methods and two sequence comparison programs: ssearch and psi-blast. ssearch uses the original smith-waterman algorithm  <cit> , and is considered the most sensitive algorithm in terms of retrieval accuracy, better than the heuristic versions like blast and fasta  <cit> . psi-blast is a modification to the blast program, where position specific scoring matrices are constructed over multiple iterations of blast algorithm. comparison of pairwise statistical significance results using multiple parameter sets with pairwise statistical significance using a single parameter set shows that at least for some error levels, using multiple parameter sets is significantly better than using a single parameter set. this is because sequences can have different conservation rates at different spatial locations, which can be better aligned using multiple parameter sets . comparison with database statistical significance results show that pairwise statistical significance with multiple parameter sets gives significantly better performance than the statistical significance estimates reported by blast and psi-blast, and comparable and at times significantly better performance than the ssearch program. further, the results also give concrete evidence that for the practical application of homology detection, the score distribution from alignment program using multiple parameter sets can also be assumed to follow an extreme value distribution. this is an important and useful finding since it is in general difficult to accurately determine statistics of alignment scores from enhanced alignment programs. finally, experiments with different values of parameter set change penalties indicate that it is indeed important to use a non-zero parameter set change penalty while performing alignment using multiple parameter sets.

methods
pairwise statistical significance estimation
consider the pairwise statistical significance described in  <cit>  to be obtainable by the following function: pairwisestatsig where seq <dig> is the first sequence, seq <dig> is the second sequence, sc is the scoring scheme , and n is the number of shuffles. the function pairwisestatsig, therefore generates a score distribution by aligning seq <dig> with n shuffled versions of seq <dig>  fits the distribution to an extreme value distribution using censored maximum likelihood fitting to obtain the statistical parameters k and λ, and returns the pairwise statistical significance estimate of the pairwise alignment score between seq <dig> and seq <dig> using the parameters k and λ in the p-value formula. more details on pairwise statistical significance can be found in  <cit> . in this paper, we dynamically use multiple parameter sets instead of a single scoring scheme sc for estimation of pairwise statistical significance.

dynamic use of multiple parameter sets in sequence alignment
usually, pairwise sequence alignment is done with a single parameter set . but to suit the different levels of conservation between sequences, there exists an algorithm  <cit>  which can dynamically use multiple parameter sets and generate a single optimal alignment with possibly different parameter sets used in different regions of the alignment. the algorithm is implemented in a program named gap <dig>  the algorithm uses a dynamic programming approach as explained in  <cit> . consider alignment of two sequences a = a <dig>  a <dig> ..., am and b = b <dig>  b <dig> ... bn using p parameter sets p <dig>  p <dig> ..., pp. let ai and bj be the subsequences a <dig>  a <dig> ... ai and b <dig>  b <dig> ..., bj respectively. for each alignment position  and each parameter set pk, the algorithm keeps track of the optimal alignment score of the subsequences ai and bj where the last component  is scored using pk. dynamic programming is used to get optimal alignment for progressive alignment positions, until i becomes m and j becomes n. appropriate modification of the algorithm also allows it to calculate the optimal local alignment. more details about using multiple parameter sets for pairwise sequence alignment can be found in  <cit> .

evaluation methodology
to evaluate the performance of pairwise statistical significance using multiple parameter sets, we used a non-redundant subset of the cath  <dig>  database  provided by  <cit>  and available at . this database was selected in  <cit>  to evaluate seven structure comparison programs and two sequence comparison programs. as described in  <cit> , this dataset consists of  <dig> domain sequences and includes  <dig> selected test query sequences. this domain set is considered as a valid benchmark for testing protein comparison algorithms  <cit> .

we used this database and query set for experimenting with pairwise statistical significance using multiple parameter sets. for each of the  <dig> ×  <dig> comparisons, we used the maximum likelihood method with censoring left of peak with  <dig> shuffles to fit the score distribution from the gap <dig> program with substitution matrices blosum <dig>  blosum <dig>  blosum <dig>  blosum <dig>  and their all possible combinations . all matrices were used in 1/ <dig> bit scale. the gap opening penalties for each of these matrices was set to the values empirically determined to be the best for this database in  <cit> . these are listed in table  <dig>  the gap extension penalties were set to  <dig> for all the four matrices. following  <cit> , error per query  versus coverage plots were used to present the results. to create these plots, the list of pairwise comparisons was sorted based on decreasing statistical significance . going down the list, the coverage count is increased by one if the two sequences of the pair are homologs, and the error count is increased by one if they are not. at a given point in the list, errors per query  is the total number of errors incurred so far, divided by the number of queries; and coverage is the fraction of total homolog pairs so far detected. in the ideal case, the curve would go from 0% to 100% coverage, without incurring any errors, which would correspond to a straight line on the x-axis. therefore, the more the curve is towards the right, the better the curve is.

just as gap opening and gap extension penalties are dynamically charged during the alignment process whenever a gap is inserted and extended respectively, the gap <dig>  <cit>  program allows the use of a parameter set change penalty, which is dynamically charged whenever the parameter set mapping is changed during the alignment process. to see the effect of parameter set change penalty on the coverage performance, we conducted a series of homology detection experiments with one of the substitution matrix combinations  with different parameter set change penalties. coverage vs. parameter set change penalty curves were plotted at different error levels to find the usefulness of the parameter set change penalty, as reported in the next section.

RESULTS
comparison with pairwise statistical significance using single parameter set
out of the  <dig> substitution matrix combinations,  <dig> are using single parameter sets,  <dig> are using two parameter sets,  <dig> are using three parameter sets, and  <dig> is using all four parameter sets. the epq vs. coverage curves using pairwise statistical significance with two, three, and four parameter sets are presented in figures  <dig>   <dig>  and  <dig> respectively. for comparison purposes, the epq vs. coverage curves using corresponding single parameter sets are also presented in the same figures. the y-axis  in all these graphs is in log-scale, and hence there is more information in the upper part of the graphs. these figures suggest that pairwise statistical significance using multiple parameter sets performs comparably to and sometimes significantly better than pairwise statistical significance using a single parameter set for most instances of using a single parameter set, and at most error levels.

comparison with database statistical significance
since the epq vs. coverage curves on the complete dataset can be distorted due to poor performance by one or two queries   <cit> , to compare the performance of pairwise statistical significance using multiple parameter sets with database statistical significance, we examined the performance of the methods with individual queries, following the work in  <cit> . the coverage of each of the  <dig> queries at the 1st, 3rd, 10th, 30th, and 100th error was recorded, and the median coverage for each error level across the  <dig> queries was plotted to obtain epq vs. coverage curves for the sequence comparison method to be evaluated. figure  <dig> shows the median coverage level at the 1st, 3rd, 10th, 30th, and 100th false positive for homologs . the curve for ssearch in figure  <dig> is derived from the figure 2a in  <cit> . the curves for blast and psi-blast were obtained by experimentation. it is clear that the proposed pairwise statistical significance using multiple parameter sets performs significantly better than blast and psi-blast at all error levels, comparable to ssearch at low error levels, and significantly better than ssearch at higher error levels.

empirical justification of parameter set change penalty
the coverage vs. parameter set change penalty plot for the substitution matrix combination of blosum <dig> and blosum <dig> is illustrated in figure  <dig>  the curve shows a poor coverage performance for the case when the parameter set change penalty is not charged, i.e., when the alignment algorithm is freely allowed to change the parameter set during alignment without charging any penalty. this can be explained by the fact that the algorithm would try to mathematically maximize the alignment score by changing the parameter set as frequently as possible, which may produce more biologically irrelevant alignments. a similar phenomenon is also observed when very low gap penalty is used  <cit> . the coverage performance clearly improves for non-zero values of parameter set change penalty, which provides its empirical justification.

discussion
as pointed out earlier, ssearch employs the original smith-waterman algorithm for alignment, and is considered more sensitive than its heuristic implementations like blast and fasta. psi-blast uses an iterative approach with query-specific substitution matrices, and its performance mainly depends on the quality of position-specific scoring matrices  constructed iteratively. the results show that psi-blast gave poorer performance than pairwise statistical significance using multiple parameter sets, even with pssms constructed against the benchmark cath database used in our experiments. however, using pssms derived against blast non-redundant protein database has been shown to give better results  <cit>  as it uses much more information than just a pair of sequences. comparable and at times significantly better results than ssearch using pairwise statistical significance with multiple parameter sets implies that statistical significance estimates at least as good as database statistical significance can be obtained by pairwise statistical significance using multiple parameter sets without having to do a time-consuming database search. this can be very useful to estimate accurate pairwise statistical significance of two  sequences, which is a common scenario in many pairwise alignment based applications like phylogenetic tree construction, progressive multiple sequence alignment.

it is important to note that the proposed method is not a database search method but statistical significance estimation method for pairwise local alignment, and the comparison with database search programs like blast, ssearch, and psi-blast is of their statistical significance estimation strategies. the proposed method, as of now is not scalable to a database search, but can be used to refine the results from a fast database search program like blast.

since pairwise alignment using multiple parameter sets takes more computational time than using a single parameter set, pairwise statistical significance estimation using multiple parameter sets also takes more time than pairwise statistical significance estimation using a single parameter set. in general, using k parameter sets increases the computation time by a factor little more than k. therefore, faster methods for significance estimation can be very helpful.

CONCLUSIONS
this paper extends the work on pairwise statistical significance by incorporating in it the use of multiple parameter sets , and compares it with database statistical significance for the knowledge discovery application of homology detection. the results show that pairwise statistical significance using multiple parameter sets performs better than pairwise statistical significance using a single parameter set. it also performs significantly better than database statistical significance using blast and psi-blast, and comparable and at times significantly better than database statistical significance using ssearch. further, an empirical justification of the use of parameter set change penalty is provided.

since psi-blast results can be improved by using better quality pssms derived from larger protein databases, we believe that the performance of pairwise statistical significance can also be improved using sequence-specific/position-specific substitution matrices, which is a significant part of our future work. another important contribution can be to estimate the pairwise statistical significance accurately in less time, since using multiple parameter sets increases the significance estimation time. faster methods for determining pairwise statistical significance would be very useful.

competing interests
the authors declare that they have no competing interests.

authors' contributions
aa conceived the study based on the initial idea given by xh. both aa and xh did the programming, aa carried out the experiments and analysis, and drafted the initial manuscript. both aa and xh read and approved the final version of the manuscript.

