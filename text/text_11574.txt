BACKGROUND
an epigenome consists of chemical modifications and variations to histones, dna methylation and other proteins that package the genome  <cit> . these epigenetic modifications crucially contribute to epigenetic maintenance of chromatin structures and gene expression regulation  <cit> . there are various interactions among these modifications, which act combinatorially to orchestrate gene expression in different cell types  <cit> . when heritable from one cell generation to the next, the epigenetic information can bring about lasting changes in gene expression  <cit> .

embryonic development is a complex process that requires precise gene regulation to govern developmental decisions during cellular differentiation  <cit> . however, how gene expression is regulated and maintained along developmental transitions remains to be understood. currently, it is well accepted that transcription factors binding to cis-regulatory sequences coordinately regulate gene expression in response to various environmental cues  <cit> . on the contrary, the regulatory functions of epigenetic modifications that accompany embryogenesis are largely unexplored. to fully investigate the mechanisms of epigenetic regulation in the cellular differentiation process, extensive research efforts provide genome-wide maps of epigenetic modifications at multiple developmental time points. human embryonic stem cells were differentiated into a variety of precursor cell types  <cit> , including mesendoderm  <cit> , trophoblast-like cells  <cit> , mesenchymal stem cells  <cit>  and neural progenitor cells  <cit> . mouse embryonic stem cells were also differentiated into mesendoderm cells  <cit> . the availability of these temporal epigenomic data provides a unique opportunity for characterizing fundamental properties of epigenome dynamics and revealing regulatory roles of epigenetic modifications.

to establish combinatorial patterns of epigenetic modification, previous computational methods primarily utilize spatial information of epigenetic marks. for example, chromasig was designed to study histone modification patterns using correlations of histone signals  <cit> . cosbi also used the correlations within 5kbp genomic segments to exhaustively searched for histone code  <cit> . chromhmm applied a hmm model to annotate genomic sequences by co-occurrence of multiple epigenetic marks  <cit> . rfecs was developed based on random forests  <cit> . awnfr explored epigenomic landscapes using the wavelet transforms  <cit> . although these methods successfully identify the combinatorial epigenetic mode based on spatial epigenomic information, there is still an urgent need to exploit newly produced temporal information to study the dynamic patterns and functions of epigenetic modifications.

in this study, we developed a spatial temporal clustering approach that exploits the temporal variation information of epigenomes along the differentiation process, aiming to characterize dynamic properties of epigenetic modifications. this approach identifies significant spatial temporal patterns of epigenetic modifications during embryogenesis and cluster regulatory sequences by their spatial temporal epigenetic patterns. the results might shed a light on how epigenetic modifications evolve temporally and how the spatial temporal patterns of epigenetic modifications regulate gene expression during the process of cellular differentiation.

methods
datasets
in mammals, studying the epigenetic mechanisms of early embryonic development often requires access to embryonic cell types. in recent studies, to analyze early human developmental decisions, human embryonic stem cells  were differentiated into trophoblast-like cells, mesendoderm, mesenchymal stem cells, and neural progenitor cells  <cit> . the first three states represent developmental events that mirror critical developmental decisions in the embryo. mesenchymal stem cells are fibroblastoid cells that are capable of expansion and multi-lineage differentiation to bone, cartilage, adipose, muscle, and connective tissues. in these cell types, genome-wide maps of main epigenetic marks have been generated using chip-seq  <cit> . in detail, the investigated epigenetic modifications were profiled, including h3k4me1/2/ <dig>  h3k36me <dig>  h3k9me <dig>  h3k27me <dig>  h3k79me <dig>  h2ak5ac, h2bk120ac, h2bk5ac, h3k18ac, h3k23ac, h3k27ac, h3k4ac, h3k9ac and h4k8ac. rna expression profiles of these five cell types were also generated using affymetrix genechip-arrays. here, we downloaded these datasets from the website of nih roadmap epigenome project   <cit> .

methods
general scheme of the stcluster algorithm
the stcluster algorithm analyzes genome-wide maps of epigenetic modifications to characterize dynamic epigenetic signatures during embryonic stem cell differentiation. there are four major steps in the stcluster algorithm:  chip-seq data transformation,  construct the co-occurrence graph for each cell type,  mine the co-occurrence graphs to identify spatial clusters of genomic segments with coherent epigenetic patterns, and  mine the resulted spatial clusters of each cell type to identify spatial temporal clusters and discover conserved epigenetic signatures during the differentiation process. figure  <dig> illustrates the scheme of the stcluster algorithm. in the following, we elaborate the process of epigenetic mode analysis step by step.
fig.  <dig> the overview of stcluster algorithm. a step  <dig>  chip-seq data transformation. b step  <dig>  construct the co-occurrence graph for each cell type. c step  <dig>  mine the co-occurrence graphs to identify spatial clusters with coherent epigenomic modification patterns. d step  <dig>  identify spatial-temporal clusters during the differentiation process




step  <dig>  data transformation
the whole human genome were divided into non-overlapping 200bp bins. for each epigenetic modification map, we first computed the summary tag count of every bin. then, in each cell type, raw sequence read counts of each epigenetic modification were normalized by the total number of reads followed by arcsine transformation  <cit> , to remove noises resulting from spurious tag counts in the chip-seq experiments. further, we divided the whole genome into 5kbp genomic regions. in this way, for each cell type, the profiles of these epigenetic modifications are represented as a matrix r
i, where i is the index of the genomic regions ranging from  <dig> to n , as shown in fig. 1
a. in each region, the number of columns is denoted as b and the number of epigenetic modifications is denoted as k. the column vectors correspond to combinatorial epigenetic modification tag counts within individual genomic bins and the row vectors correspond to the contiguous genomic landscape of individual epigenetic modifications.

step  <dig>  construct co-occurrence graph for each cell type
in this step, we computed the correlation coefficients of epigenetic modification pairs in each region, and then we constructed the corresponding co-occurrence graph for each cell type. given the processed and organized epigenetic modification data of each cell type, correlation coefficients of any two histone modifications at every region were calculated to obtain a coefficient matrix. if the coefficients are higher than a given threshold, the two epigenetic modifications are regarded as coherent in this region. subsequently, this region was added to the corresponding region set. based on the coefficient matrix, we further constructed the co-occurrence graph, which is modeled as an undirected graph g = , where v is the set of all histone modifications. for any two epigenetic modification types h
i and h
j , if they are correlated at any region, there exists an edge eâˆˆe between vertices h
i and h
j. in addition, each edge in the co-occurrence graph is associated with the region set. figure 1
b shows an example of co-occurrence graph. here, we set the correlation coefficient threshold as  <dig>  to achieve a high quality of spatial clusters.

step  <dig>  mine spatial clusters from co-occurrence graph
the co-occurrence graph represents in a compact way all the correlated epigenetic modifications in different regions. it can be used to mine potential spatial clusters corresponding to each developmental stage, and filter out most of the unrelated data. the stcluster algorithm applies a depth first search  strategy on the co-occurrence graph to mine all the spatial clusters. a typical spatial cluster represents a group of genomic regions that share spatial epigenetic patterns. to gain the significant epigenetic states, we set the minimum number of histone modifications as  <dig> and the minimum percent of regions as  <dig> %. for each cell type, we identified a set of spatial clusters, as shown in fig. 1
c.

step  <dig>  identify spatial-temporal clusters from spatial clusters
on obtaining the maximal spatial cluster set for all cell types, we utilized them to mine the maximal spatial-temporal clusters. this is accomplished by enumerating the subsets of the time points , using a process similar to the spatial cluster clique mining. the regions in each spatial temporal clusters exhibit similar changes of epigenetic modifications during the cellular differentiation process. spatial-temporal clusters indicate specific conserved chromatin signatures that are shared by multiple time points along the embryonic stem cell differentiation.

RESULTS
identifying combinatorial epigenetic states during differentiation
to investigate combinatorial epigenetic states during the differentiation of embryonic stem cells, we applied stcluster to the genome-wide epigenetic modification maps of five cell types, including h <dig>  mesendoderm, trophoblast-like cells, mesenchymal stem cells and neuronal progenitor cells. stcluster first grouped genomic regions based on spatial patterns of epigenetic modifications to identify spatial clusters. for each cell type, we set the minimum number of histone modifications as  <dig> and the minimum percent of regions as  <dig> %, which allow us to capture patterns that involve at least five epigenetic modifications and re-occur across at least  <dig> % of the human genome. with this parameter setting, we respectively identified  <dig>   <dig>   <dig>   <dig>   <dig> spatial clusters in h <dig>  mesendoderm, trophoblast-like cells, mesenchymal stem cells and neuronal progenitor cells.

next, we evaluated the occurrence frequencies of all investigated epigenetic modifications in the identified spatial clusters. specifically, the occurrence frequency of an epigenetic modification is computed as the ratio of the occurrence in these spatial clusters and the total number of 5kbp non-overlapping regions in the genome. their occurrence frequencies are depicted in fig.  <dig>  we found that epigenetic modification h3k18ac has a high frequency in all cell types, which indicates that these regions share the variation pattern of this epigenetic modification. epigenetic modifications  seldom occur in the spatial clusters of h <dig>  whereas epigenetic modification  frequently occur in the spatial clusters of cell types except h <dig>  in the spatial clusters of neuronal progenitor cells, most epigenetic modifications have median occurrence frequencies.
fig.  <dig> the occurrence frequencies of all investigated epigenetic modifications in the identified spatial clusters




expanding this research, we studied co-occurred epigenetic modifications at each developmental stage of the differentiation process. for each cell type, we ranked the identified spatial clusters according to the number of regions co-occupied by epigenetic modification set. we discovered groups of epigenetic modifications that frequently co-occur in each cell type. table  <dig> summarizes the top  <dig> frequently co-occurred epigenetic modifications. overall, the clustering results show that different cell types exhibit diverse cell type specific patterns of epigenetic modifications. the overlaps of epigenetic modifications among these cell types are small. however, we found that epigenetic marks <h3k4me <dig>  h3k4me <dig> > and <h3k4me <dig>  h3k4ac > frequently co-occur in the spatial clusters of different cell types. part of these cell types, such as h <dig> cell line and mesendoderm, mesenchymal stem cells and neuronal progenitor cells, share more epigenetic patterns than other groups of cell types.



identifying conserved epigenetic states during the differentiation of es cells
there are large differences among the investigated epigenetic modifications regarding their temporal variations. to identify conserved epigenetic states and explore the temporal patterns of these epigenetic modifications, we applied stcluster to further group genomic regions based on the spatial clusters. the identified spatial temporal clusters are represented as triples . each cluster lists the genomic regions with the co-occupied epigenetic modifications, which exhibit little variation at different cell types during the differentiation process. taking a typical spatial temporal cluster as an example, fig.  <dig> displays the profiles of co-occurred epigenetic modifications in different regions during the differentiation process. in this cluster, eight epigenetic modifications  co-occur the clustered regions in five different cell types. for each region, these epigenetic marks display conserved modification patterns at all these five stages.
fig.  <dig> profiles of co-occurred epigenetic modifications display an overall conserved pattern at five different stages during the differentiation process




the detailed information of all identified spatial temporal clusters are listed in additional file  <dig>  the results indicate that there exist conserved epigenetic states during the differentiation process. we observed a high co-occurrence and stable patterns of h3k4me <dig> with h3k23ac, h3k18ac, h3k27ac and h3k9ac at five different stages along the differentiation process. our observation is consistent with the previous finding that h3k4me <dig> is one of the backbone epigenetic modifications along with h3k27ac and h3k9ac  <cit> . on the contrary, some epigenetic modification patterns are only coherent in certain cell types. for example, the variation pattern of epigenetic modifications <h3k27me <dig>  h3k9me <dig>  h3k79me <dig>  h3k4ac, h3k9ac > is shared in four cell types except mesendoderm. <h3k4me <dig>  h3k23ac, h3k27ac, h3kk27me <dig>  h3k79me <dig>  h3k18ac > are only shared in h <dig>  mesendoderm, and trophoblast-like cells except mesenchymal stem cells and neuronal progenitor cells. notably, the identified spatial temporal clusters reveal more details of the differentiation process.

analyzing the regulatory roles of epigenetic modifications during differentiation
as epigenetic marks were thought to be predictive of gene expression levels in a context-independent manner  <cit> , we further analyzed the rna expression levels of the identified spatial temporal clusters to see if this theory holds during embryonic stem cell differentiation. specifically, we extracted the rna expression data of the genomic regions included in the spatial temporal clusters, and compared the expression level in the corresponding cell types. consistent with previous study, some epigenetic marks, such as h3k27ac and h3k36me <dig>  are correlated with rna expression level of different genomic regions at different developmental stages. however, several epigenetic modifications show cell type specific regulation on mrna expression. as shown in fig.  <dig>  the variations of temporal epigenetic modifications are not correlated with gene expression changes in several spatial-temporal clusters, which are primarily located in promoter regions. these results imply that epigenetic patterns mediate gene regulation during cell differentiation in a complex way, rather than in a linear manner.
fig.  <dig> the rna expression levels of the identified spatial temporal clusters




CONCLUSIONS
identifying epigenomic dynamics is important to understand mechanisms for gene regulation. our knowledge about the temporal patterns of epigenetic modifications and the consequence of them are still limited. there is a urgent need to develop new computational approach that exploits the complex epigenomic landscapes and discovers significant signatures out of them. in this study, we developed a spatial temporal clustering algorithm to explore the epigenomic landscapes of five cell types during embryonic stem cell differentiation. using this approach, we identified spatial temporal patterns of epigenetic modifications in early embryogenesis. different from previous computational methods, our approach is designed to investigate the dynamic epigenetic landscapes as well as the combinational epigenetic modes. the experimental results demonstrate that the proposed stcluster algorithm could successfully capture dynamic epigenetic modification patterns associated with specific cell types. in addition, stcluster allows straightforward identification of epigenetic conservation at multiple developmental stages during cell differentiation process.

additional file

additional file  <dig> the detailed information of identified spatial temporal clusters. details for the spatial temporal clusters, represented as triples . each cluster lists the genomic regions with the co-occupied epigenetic modifications, which exhibit little variation at different cell types during the differentiation process. 




from the 27th international conference on genome informatics shanghai, china. 3- <dig> october 2016

