BACKGROUND
since the first successful genome-wide association studies  in  <dig>  over  <dig> gwas have been reported  <cit> . due in large part to rapid advances in genotyping technology and standardized guidelines for reporting statistical evidence, the multitude of comparisons made in a gwas will result in both false positive  and, if the correction for multiple comparisons is overly conservative or power is inadequate, false negative  results.

the probability of a type i error  is generally controlled by setting the significance level, α, for a test, but the probability of making at least one type i error in a study,

 p=1−n, 

is a function of n, the number of independent comparisons made, as well as α. the direct application to a gwas is that, with a significance level typical to small studies and candidate gene studies , the probability of not committing a gwas-wide type i error is very small.

the standard for evidence of significance in gwas to securely identify a genotypephenotype association in european americans is generally considered to be p <  <dig> × 10- <dig> or p <  <dig> × 10- <dig>  for α =  <dig>  and  <dig> , respectively  <cit> . this standard is based on a bonferroni correction for an assumed million independent variants in the human genome. as a consequence, the avoidance of type  <dig> errors may inflate type  <dig> errors. this is especially true for analyses with low power, such as rare diseases where patient numbers are limited, low frequency alleles, or genetic factors with small effect sizes. this conundrum can be resolved with extremely large study sizes, but in practice this is not always cost efficient or practical. these issues should be major considerations both for designing gwas and interpreting gwas results.

several methods are commonly used to control the gwas-wide type i error rate: p-value adjustments for multiple comparisons have long been used when making multiple comparisons  <cit> ; the use of q-values, a measure of the false discovery rate, has been proposed as a way to indirectly measure and control the type i error rate  <cit> ; a two-stage analysis of the data can be used not only to decrease the type i error rate  <cit> , but also to decrease the genotyping costs incurred  <cit> ; genotype imputation can result in a net increase in statistical power  <cit> .

a bonferroni adjustment fits our problem particularly well because many comparisons are made and a gwas is considered agnostic, with no prior hypotheses  <cit> . several studies have estimated the number of statistical comparisons made in a gwas  <cit> , but the universal application of a one-size-fits-all significance level to gwas studies is inappropriate. power to detect associations is determined, in large part, by allele frequencies and their effect sizes; since these variables are constants, only sample size can be adjusted. as the sample size increases, the power to detect low frequency and/or small effect size genetic variants also increases. newer snp arrays, designed to more fully capture the range of snps in diverse human populations and to include rare snps hypothesized to be more likely to have larger effect sizes, will increase the number of independent statistical comparisons  <cit> . additionally, the dependent nature of genetic data, where snps in linkage disequilibrium  are correlated to some degree, may lead to over-correction when using bonferroni adjustments. one of the key assumptions of a bonferroni adjustment is that all comparisons are independent. neighboring snps on a chromosome tend to be inherited together in blocks and are not independent  <cit> , making a strict bonferroni adjustment overly conservative.

one relevant question is then not how many snps are being tested, but how many independent statistical comparisons are being made. in the context of a principal components analysis  of the genotype data, the number of independent comparisons can be defined as the number of principal components accounting for a large portion  of the variance in the data  <cit> . the set of informative snps represented by these components could be used to infer the remainder of the data set with a high degree of fidelity, and can be used to make a bonferroni adjustment with the desired gwas-wide significance level:

 αgwas=αninformative. 

what is not clear, however is which snps fall into the informative set, so all snps are tested. the assumption is then made that the test statistics are distributed similarly to the test statistics from an analysis including only the informative snps. based on the simulations done by gao et. al. this seems to be a reasonable assumption  <cit> .

another relevant question is how to adjust the p-values directly, rather than relying on a significance threshold  <cit> . these corrected p-values, measuring significance on the genome-wide scale, have the added benefit of easier interpretation. for example, comparing two uncorrected p-values,  <dig>  × 10- <dig> and  <dig>  × 10- <dig>  becomes much more tractable after a genome-wide correction, resulting in corrected p-values of  <dig>  and  <dig> , respectively.

there have been a number of studies attempting to provide an accurate picture of how snps, and/or statistical tests of snps, are correlated in genome-wide studies. these fall into three general categories: variations and alternatives to permutation testing  <cit> , principal components analysis  <cit> , and analysis of the underlying ld structure in the genome  <cit> .

we have recently genotyped  <dig> european americans for  <dig>  snps using the affymetrix  <dig>  platform in a gwas to search for aids restriction genes. here we compare traditional bonferroni significance thresholds with methods from each of these statistical correction strategies to identify an appropriate measure of significance in our gwas: 1) presto, an optimized permutation algorithm  <cit>  verified by permory  <cit> ; 2) the sliding-window method for locally inter-correlated markers with asymptotic distribution errors corrected  program, an alternative to permutation testing, developed to correct p-values in a gwas using a multivariate normal distribution-based correction  <cit> ; 3) the simpleℳ method, specifically developed to calculate the number of informative snps being tested in a gwas using a principal components analysis  <cit> ; 4) the number of ld blocks found by the gabriel, solid spine of ld, and 4-gamete algorithms, as implemented in haploview  <cit> .

our aim is to identify the most appropriate method for obtaining accurate gwas-wide significance thresholds and/or corrected p-values among  <dig>  linked snps, the best method being one that results in an accurate estimate of the number of comparisons and has reasonable computational requirements.

methods
gwas data
after filtering for a 90% sample call rate,  <dig>  european americans were successfully genotyped on the affymetrix  <dig>  platform. these subjects consisted of  <dig>  hiv- infected and  <dig> hiv-negative individuals at risk of hiv infection; clinical categories were distributed randomly across plates and batch effects were monitored. we chose  <dig>  snps, after filtering each snp for >95% call rate, hardy-weinberg equilibrium, mendel errors, and a minor allele frequency below 1%. after re-clustering and filtering bad snps, all sample call rates were >95% with an average call rate of  <dig> %. individuals were unrelated, with the exception of  <dig> ceph trios used to check for mendel errors in the genetic data. a principal components analysis of the genetic data using eigensoft was used to identify population structure. no significant outliers were identified, however, since there is some stratification in european american populations, snps that contributed significantly to population structure were tagged in subsequent analyses  <cit> . association statistics were not used for the purposes of this paper, except where indicated in the multiple comparisons methods below.

to address the concern that an excess number of cases to controls would lead to less generalizable results, we analyzed a random sample of  <dig> cases with all  <dig> controls. other than the changes in case/control ratio and sample size, all other variables were left unchanged.

variations and alternatives to permutation testing
presto: the software package, presto, was used to permute case/control status  <dig>  times, and the minimum mantel trend test p-value for all snps in the genome, comparing cases with controls, was recorded for each permuted data set  <cit> . these minimum p-values were then used to estimate the uncorrected distribution of p-values under the null hypothesis of no true associations in the study. each p-value was then corrected by finding the corresponding percentile of the distribution of uncorrected p-values, and a significance threshold for a study-wide significance level of α was be obtained by finding the αth percentile of the uncorrected distribution. this distribution was used as the standard by which each method's accuracy is gauged, and corresponding significance levels for all other methods were estimated using this distribution. results from presto were compared with the results from permory, another optimized permutation testing software package that was recently released  <cit> .

slide: the slide software package was used to implement a multivariate normal distribution-based approximation to a permutation test, using the quantitative trait option, with  <dig>  iterations  <cit> . for comparisons with the other methods considered, slide corrected p-values were used to estimate the gwas-wide significance threshold by finding a corrected p-value equal to the desired study-wide significance. level, α.

principal components analysis
simpleℳ: the simpleℳ method  <cit> , based on a principal components analysis of the data, was implemented in r, version  <dig> . <dig>  <cit> , following the example code provided by gao et al. https://dsgweb.wustl.edu/rgao/simplem_ex.zip. this measure of the number of informative snps was then used in a bonferroni adjustment to estimate the gwas-wide significance threshold. each chromosome was broken into regions of approximately  <dig>  snps due to computational constraints. to choose appropriate regions, with as little ld between adjacent regions as possible, we chose cut points between ld blocks identified by haploview. a second analysis using the largest regions possible, given the memory available, was also explored to see if results were dependent on the region size.

analysis of underlying ld
ld blocks were inferred in our gwas data using the three methods available in haploview  <cit> . the number of ld blocks across the human genome, including interblock snps , was used in a bonferroni adjustment to estimate gwas-wide significance thresholds  <cit> . entire chromosomes could not be analyzed, due to memory constraints, so smaller regions were analyzed. all snps from the last full ld block of the previous region were included in the analysis of the next region to ensure complete ld blocks.

the gabriel protocol, the default method for haploview, was used with an upper d' confidence interval bound of  <dig> , a lower d' confidence interval bound of  <dig> , and with 5% of informative markers required to be in strong ld  <cit> . the solid spine of ld algorithm  <cit>  was used with minimum d' value of  <dig> , as suggested by duggal et al.  <cit> . the 4-gamete test was run setting the cutoff for frequency of the fourth pairwise haplotype at 1%  <cit> .

RESULTS
variations and alternatives to permutation testing
presto: the permutation based significance threshold from presto was  <dig>  × 10- <dig> . by comparison, the presto analysis of the smaller sample had a significance threshold of  <dig>  × 10- <dig> ; this corresponds to an α level of  <dig>  when compared to the analysis of the full data set. these results were consistent with an analysis using permory on the same subset and probably reflect the decrease in statistical power associated with the smaller sample size. permutation tests are the gold standard for identifying appropriate significance thresholds, and are computationally efficient when optimized solutions exist for a particular statistical test. as we see in table  <dig>  these results are very specific to each study. one drawback of permutation testing is the computational burden that arises when no optimized solutions exist . in such a case, permutation testing can be impractical and one of the other methods considered here would be more appropriate.

the significance threshold for each method is shown , as well as the corresponding genome-wide α level when compared with the presto method. a strict bonferroni significance threshold is also given.

the difference in significance threshold is given, comparing an analysis of the full data set to a subset of the data with an equal number of cases and controls .

bonferroni: the standard bonferroni correction, simply using the total number of snps tested in the genome-wide significance level calculation, was  <dig>  × 10- <dig>  which corresponded to a genome-wide significance level of α ≈  <dig>  when compared with presto . while a permutation test may not result in a large improvement in the corresponding genome-wide significance level when compared with a standard bonferroni correction in this snp set, other, denser snp sets will result in greater disparities in significance levels.

slide: the significance threshold identified by slide was  <dig>  × 10- <dig>  which corresponded to a genome-wide significance level of α =  <dig>  when compared with presto . the significance threshold found in the analysis of the smaller sample was remarkably similar, differing only by  <dig> × 10- <dig> . over all, these results indicate that slide is an excellent alternative to permutation testing. additionally, the corrected p-values provide increased ease in interpretation of gwas results.

principal components analysis
simpleℳ: the significance threshold based on the number of effective snps identified by the simpleℳ algorithm was  <dig>  × 10- <dig>  corresponding to a genome-wide significance level of α ≈  <dig>  when compared with the presto results. as with slide, the analysis of the smaller sample was remarkably similar, differing only by  <dig> × 10- <dig>  these results indicate that simpleℳ is also an excellent alternative to a full permutation test. however, because of the concern of how variations in region size would affect the accuracy of the simpleℳ analysis, regions with as many snps as we had computational resources to analyze  were compared to the results in table  <dig>  the corresponding thresholds differed by less than  <dig> × 10- <dig>  it is important to note, however, that since this is an o problem, the memory and serial time required to analyze these larger regions increases rapidly with the size of the regions analyzed. regions containing more than a few thousand snps, however, seem to result in very similar significance thresholds in this data set, and the computational resources required are reasonable for regions of a few thousand snps .

the simpleℳ method is currently the fastest way to calculate the effective number of independent tests in a gwas  <cit> , but due to the o nature of this algorithm the genome needs to be broken up into small regions to maintain this computational speed. this adds complexity to the analysis and requires a significant amount of pre-analysis. considering the many examples of long range ld across the genome, simpleℳ could also lead to a slightly more conservative estimate in some studies  <cit> .

analysis of underlying ld
the three ld-based methods using haploview are the least conservative, with significance thresholds between  <dig>  × 10- <dig> and  <dig>  × 10- <dig>  corresponding to α levels between  <dig>  and  <dig>  as compared to permutation testing using presto . thus, it appears that the use of ld blocks to construct bonferroni significance thresholds is anti-conservative in this data set. we also explored alternate parameters but did not observe a sufficient improvement in the corresponding significance level when severely restricting the definition of haplotypes .

significance thresholds with corresponding α levels are given for each haplotype calling method with the standard parameters and a set of more restricted parameters. d'u and d'l represent the, upper and lower confidence limits of d', respectively.

nicodemus et al.  <cit>  noted that estimates may be more or less conservative under varying levels of ld. an alternate ld algorithm or parameter constraints could be found that would result in a more accurate estimate  <cit> , but this would vary significantly depending on the sample size, the set of snps, and the underlying level of ld structure in the population. this is further illustrated in the large differences found using the gabriel and solid spine of ld algorithms on a subset of the individuals in this study . while ld blocks do provide key information on patterns of ld and how snps are correlated, providing invaluable information for interpreting gwas results and for the planning of follow-up studies, we find the use of significance thresholds derived from ld blocks to be too variable for general application to gwas data.

CONCLUSIONS
a one-size-fits-all bonferroni correction, although conservative, may not result in a large type ii error rate with a sample size in the tens of thousands, but as the sample size drops, so does statistical power. in studies where gathering large numbers of cases is prohibitive , a bonferroni correction becomes overly conservative by detrimentally inflating the type ii error rate. the methods considered here can ameliorate this loss of power and make interpretation of study results less enigmatic.

the results from the presto, slide and simpleℳ methods appear to be equally good in population data genotyped on the affymetrix  <dig>  platform in european americans , and each presents a modest gain in power over the strict bonferroni thresholds advocated by some  <cit> . the slide and simpleℳ methods may be less dependent on the number of individuals in the study, and will be particularly useful when using a statistical test that is not supported by optimized permutation packages  and when the snps being tested are sufficiently dense. slide not only has much nicer computational properties when compared to simpleℳ, but the corrected p-values measuring significance on the genome-wide scale are easier to interpret. while the idea of an even standard across studies is appealing, the traditional standard of presenting p-values in the context of the study more accurately represents the data.

authors' contributions
rcj conceived and carried out the analysis. gwn, caw, and sjo contributed to the study design. jlt, jal, bdk, rcj, caw, gwn, and sjo contributed to the gwas data. rcj wrote the manuscript with contributions from gwn, caw, jal, and sjo. all authors read and approved the final manuscript.

