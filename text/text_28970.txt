BACKGROUND
recent popularity of multiplex immunofluorescence  imaging is generating massive amounts of digital image data. in consequence, the demand for development of robust analytical methods for quantitative analysis of the image data is on the rise. realistic synthetic data could provide an objective way of validating and comparing such methods. building accurate protein expression models requires taking into account their spatial distributions since the subcellular location of a protein is so critical to its function that the same protein can have different functions at different locations  <cit> . the virtual cell project  <cit>  enables the formulation of both compartmental and spatial partial differential equation models. similarly, monte carlo cell  and smoldyn  <cit>  use agent-based methods which simulate each molecule individually and evaluate their diffusion and probability of interactions on a per-particle basis for each time step. although computationally extremely expensive, these methods have high spatial resolution and are successful at modelling interactions of small numbers of heterogeneously distributed molecules.

while the above methods can be useful for studying the dynamics of protein interaction, they do little to model the microscopic level cell structure, which is necessary for validation of image analysis methods such as cell-compartment classification methods . to address this issue, zhao and murphy  <cit>  presented a machine learning method to generate realistic cells with labelled nuclei, membranes and a protein expressed in a cell organelle. parameters for these models were learned from real images of cells in culture. however, these generative models are restricted to individual cells in culture and only one protein of interest at a time. hence, they do not capture the dynamic interplay between important proteins localised in certain cell compartments in anatomically intact tissue as opposed to freely moving cells in culture.

other frameworks for generating synthetic if data include the simcep simulator, which can simulate large 2d cell populations with realistically looking cytoplasm, nuclei and cell organelle  <cit> . svoboda et al.  <cit>  generated a model to fully simulate 3d image data of cell nuclei, with realistic distribution  <cit> , and later of healthy colon tissue  <cit> . however, these models only include cell nuclei. in addition, the shape of the nuclei in the colon tissue model of  <cit>  is not very realistic due to the presence of sharp corners generated from voronoi diagrams and does not reflect the variety of cell phenotypes found in real tissue. heterogeneous cell populations expressing different protein markers can be simulated using the simucell toolbox  <cit> . the first method for simulating bright-field microscopy was proposed for synthesising cervical smears  <cit> . however, tissue microenvironment was not taken into account in that work. more recently, a model has been proposed for simulating the microenvironment of healthy and cancerous colon tissue  <cit> . this model has a number of user-defined parameters that allow control over the tissue appearance and is capable of simulating microscopy images for cancers of various differentiation grade.

healthy colon tissue microenvironment is composed of a single layer of epithelium forming glandular structures, called crypts . the crypts consist mostly of three types of cells: epithelial  cells, goblet cells, and stem cells , and extend down to sit on the muscularis mucosae. stroma fills the space between the crypts and contains several types of cells, such as lymphocytes, plasma cells and fibroblasts. as the colorectal adenocarcinoma  develops from normal tissue, the epithelium exhibits increased dysplasia  and there are fewer mucus-containing goblet cells, reflecting a lack of normal cellular differentiation. cra is a heterogeneous group of diseases which have distinctive genetic and epigenetic basis  <cit> . it arises following one of the three pathways: microsatellite instability , chromosomal instability  or cpg island methylator phenotype  pathways. the cin pathway is the most common and is characterised by widespread imbalances in chromosome number and loss of heterozygosity . it can result from accumulation of mutations in specific tumour suppressor genes and oncogenes that activate pathways critical for cra such as chromosomal segregation, telomere stability, and the dna damage response  <cit> . on the other hand, epigenetic instability is now believed to be implicated in the pathogenesis of almost one third of colorectal cancers  <cit> . cras with cimp are characterised by epigenetic loss of function of tumour suppressor genes without mutations  <cit> . the msi pathway is discussed in more detail below.
fig.  <dig> a hematoxilyn and eosin  image depicting the structure of healthy colon tissue




microsatellites are simple repeat sequences of  <dig> to  <dig> base pairs  and are particularly prone to replication errors. defects in one of the four dna mismatch repair  genes  cause small changes in the number of repeats of microsatellites throughout the genome, consequently resulting in the development of the msi. mismatch repair is a complex process that depends on the mmr proteins and multiple proteins that interact directly with the dna  <cit> . the msh <dig> and msh <dig> proteins exist as a heterodimer, which forms a sliding clamp on the dna strand. when msh <dig> recognises a dna base pair mismatch, it recruits the mlh1-pms <dig> heterodimer. repairing the mismatch requires coordinated activity of dna repair proteins and the precise mechanisms are still under investigation  <cit> .

around  <dig> % of cras are characterised by a high degree of msi   <cit> , and of these, about  <dig> in  <dig>  are due to lynch syndrome , previously known as hereditary nonpolyposis colorectal cancer . ls is the most common inherited cra syndrome and it predisposes the patient to cancers of multiple organ systems, including the gastrointestinal tract. it is important to identify patients with ls as it allows for increased surveillance of the affected individual and of potentially affected family members. hence, preliminary screening is often done using ihc to detect msi. most msi-high cras are caused by epigenetic silencing of the mlh <dig> gene  or the msh <dig> gene   <cit> . mutations in msh <dig> and pms <dig> occur only in about  <dig> % of ls patients  <cit> . in addition, samowitz et al.  <cit>  considered the relationship between p <dig> mutations and msi in cras. the study considered mutation in the p <dig> gene to be indicated by over-expression  of the protein in immunohistochemistry  data. they found that p <dig> over-expression occurred in  <dig> % of microsatellite stable tumours and only  <dig> % of unstable tumours.

in this work, we propose models for subcellular expression of proteins associated with msi, namely mlh <dig>  msh <dig>  msh <dig> and pms <dig>  and tumour suppressor proteins, such as p <dig> and pten. these proteins were selected as a case study to illustrate how a variety of proteins can be included within the framework to enable the generation of synthetic multiplex fluorescence image data of both healthy and cancerous tissue samples. the models have been integrated within a model of the tumour microenvironment of colorectal cancer  <cit> , and take into account the cell phenotypes present in the tissue as well as the presence of relevant gene mutations. we have also developed models for a number of subcellular organelles, which were learned from real high-resolution confocal microscopy images. we have validated the models by comparing the distributions of morphological features of the cell organelles, by performing combinatorial molecular phenotype analysis, and by constructing the cell-level protein co-localisation networks. the analysis has demonstrated that the model generates realistic image data which could be used to validate and compare various image analysis methods such as cell-compartment classification methods, frameworks for studying protein co-localisation or protein expression grading.

to the best of our knowledge, this is the first model for expression of multiple proteins in anatomically intact tissue, rather than within cells in culture.

methods
it is important to study tumour heterogeneity and the msi, as they could guide treatment and help diagnose lynch syndrome. we have considered the four mmr proteins . mutations in genes producing these proteins are the cause for msi. in addition, we consider p <dig> which has been found to be also associated with the condition  <cit>  and pten which is an important cra biomarker. these proteins have varied subcellular expression patterns  and provide an interesting case study demonstrating how several different protein expressions could be included within the proposed model.



in order to model the expression of proteins, we first need to have models for the cell organelles where the proteins of interest are expressed. these are detailed in table  <dig>  we use real confocal if data from the human protein atlas   <cit>  to learn features of the organelles that can then be incorporated into the model. the if images of cultured cells are utilised instead of the ihc images of cra since the latter do not provide high enough resolution to consider the subcellular protein expression patterns. once we have realistic models for the cell organelles, we then develop models for the proteins based on where they are expressed and under what conditions. details of this process are given below.

learning from the real data
we have utilised high resolution if images of cultured cells from the hpa  <cit>  for learning parameters for our model. in order to model the proteins of interest, we need to develop models for the nucleoli, golgi apparatus and the vesicles. for each organelle, we have used proteins known to be highly specific to that organelle. to obtain sufficient data, we have used  <dig> or  <dig> proteins for each cell organelle, as detailed in table  <dig>  for each cell organelle, we consider a total of  <dig> images split nearly evenly between the proteins, with the number of images used for each protein depending on how many good quality images are available.



in order to learn from the real if data, we first need to segment the individual cells, nuclei and cell organelles. cell and nuclear segmentation was performed using the seeded watershed segmentation method proposed in  <cit> . the procedure involves thresholding the dapi image with the threshold being determined as the intensity of the most common pixel. next, the binary nuclear image is eroded and small objects and objects touching the boundary of the image are removed. this way we could ensure that the seeds generated were not as a result of noise in the image. nuclei with diameter outside the range of  <cit>  μm are considered erroneous seeds and are also removed. for cell segmentation, the endoplasmic reticulum  channel was used to determine background seeds from large areas of pixels with zero intensity. the seed locations and the inverted er image are then used in a seeded watershed algorithm, which is a segmentation algorithm identifying “catchment basins” and “watershed ridge lines” in an image by treating it as a surface where light pixels are high and dark pixels are low. for nuclear segmentation, the nuclear  channel was used to determine both foreground and background seeds. examples of the results are shown in fig.  <dig> 
fig.  <dig> examples of cell and nuclear segmentation. a and c show the original er and nuclear channels. b and d show the segmentation borders in red




for the purpose of segmenting the cell nucleoli, a single channel showing a relevant antibody was thresholded to remove background noise and used to obtain both background and foreground seeds. the same segmentation as above was then followed. similarly to above, nucleoli with diameter outside the range of  μm are removed. the results are shown in fig.  <dig> 
fig.  <dig> examples of nucleoli segmentation. a and c show the original channels for mlh <dig> and rrp1b images, respectively. b shows segmentation results from the seeded watershed segmentation method with borders shown in red. d shows segmentation results from the adaptive thresholding method




when segmenting the vesicles and golgi apparatus, the above method didn’t perform satisfactorily due to the small size of the objects and the high level of noise in the images . for this reason, we have instead used an adaptive mean filter to highlight image features and then otsu threshold to segment the image . objects containing less than  <dig> pixels were considered noise and were discarded. thresholding is unable to separate touching organelles. however, this issue would persist even with more sophisticated algorithms as it is due to the fact that the pixel resolution is not high enough to enable one to see whether a large object is a single large organelle or if it consists of two closely located vesicles. we can see that the method performs very well even at high levels of noise . on the other hand, this method tends to over-segment the nucleoli and produces many false positives . the segmentation procedure resulted in  <dig> nucleoli from  <dig> cells,  <dig> golgi objects from  <dig> cells and  <dig>  vesicles from  <dig> cells being identified.
fig.  <dig> examples of golgi segmentation. a shows the original channel for a golga <dig> image. b shows segmentation results from the adaptive thresholding method with borders shown in red. c shows segmentation results from the seeded watershed segmentation method


fig.  <dig> examples of vesicles segmentation. a shows the original channel for an abcd <dig> image. b and e show enlarged sections of the original channels for abcd <dig> and psap images, respectively. c and f show segmentation results from the adaptive thresholding method with borders shown in red. d shows segmentation results from the seeded watershed segmentation method




once we have all the objects segmented, we can extract morphological features representing the cell organelles to be incorporated into the model. we extract several features describing the organelles and their distribution within the cell. for each of them, we use maximum likelihood estimation to estimate a probability distribution function  which is incorporated into the model. firstly, we obtain the numbers of organelles within each segmented cell. these are modelled using a gamma pdf, as this distribution provided the best fit, and the results are shown in fig.  <dig> . we then consider the size and shape of the organelles. since the real data available is for different types of cultured cells, instead of estimating the size of the cell organelles directly, we consider the ratio between the minor axes of the cell organelle and that of the corresponding nucleus. we assume that the shape of the cell nucleus is approximately the same in tissue and in cell culture. the distributions of this ratio and the estimated gamma pdfs for each cell organelle are shown in fig.  <dig> . this ratio generalises better to cells in a tissue and at different magnifications. to estimate the shape of the organelles, we consider the ratio between the minor and major axes of the segmented objects. the distributions of this feature and the estimated gamma pdfs for each cell organelle are shown in fig.  <dig> .
fig.  <dig> estimated probability distribution functions for the number  and position  of the a, b nucleoli, c, d golgi and e, f vesicles


fig.  <dig> estimated probability distribution functions for the ratios between the minor axes of the organelles and the nucleus of the corresponding cell  and between the minor and major axes of the organelles. figures show the ratios for a, b nucleoli, c, d golgi and e, f vesicles




the last feature considered is the relative position of the organelle within the cell. we considered the line from the centre of the cell nucleus going through the centre of the organelle of interest. let the distance between the centre of the nucleus and the point where the line crosses the nuclear membrane be given by n. let the distance between the centres of the nucleus and the organelle be given by o, and the distance between the points where the line crosses the nuclear and plasma membranes be given by c . then, the distance feature is given by 
  <dig> d=1−n−on+c. 
fig.  <dig> diagram for calculating the position feature. the star marks the position of the organelle of interest




consequently, the minimum value of d=1−n/ means the organelle is located at the centre of the nucleus and as d→ <dig> the cell compartment is located closer to the nuclear membrane but within the nuclear boundary. a value of d> <dig> describes an organelle that is outside the nuclear boundary and the distance from it is given proportionate to the distance between the centre of the nucleus and the cell membrane. the distributions of this feature and the estimated pdfs for each cell organelle are shown in fig.  <dig> . the distribution of the nucleoli position was well estimated by a gamma pdf. on the other hand, most of the vesicles and golgi objects were found close to the nuclear membrane and so a t location-scale distribution gave a better fit.

modelling cell organelles
for modelling the different cell compartments, we use the deformed circle model used in kovacheva et al.  <cit> . when we are generating cell organelles of a particular type, we draw model parameter values from the relevant pdfs as described above. however, we also impose certain restrictions on the parameter values based on the size of the cell in consideration. for each cell, first we choose the number of organelles to be created. we only place a new cell organelle if that type of organelles are not taking up more than  <dig> or  <dig> % of the cell area for golgi and vesicles, respectively, and  <dig> % of the nuclear area for nucleoli. these constraints were set up to address the fact that other parameter values are drawn independently and so may result in unrealistic examples where a large number of organelles with relatively great size are generated. the values were set based on observations from the real data where golgi and vesicles took up to  <dig> and  <dig> % of the cell area, and the nucleoli took up to  <dig>  % of the nucleus. the first two values were scaled up as the cytoplasm of cells in a tissue has more compact shape and so the 2d projection of it would give a much smaller area. on the other hand, we don’t expect the nucleus to significantly change shape and so the threshold was held nearly the same. for each cell organelle to be placed, we choose the length of the minor axis by drawing a value for the ratio between the nuclear minor axis and that of the organelle. a minimum length of  <dig> pixel is set. to determine the length of the major axis, we draw a value from the pdf estimated for the ratio between the minor and major organelle axes. finally, we need to estimate the position of the organelle. for this, we draw a value from the pdf of the distance feature and select the direction from the nuclear centre at random. using , we can then estimate the distance from the nuclear centre. the resulting organelles are shown in fig.  <dig> 
fig.  <dig> examples of generated cell organelles. in all images the cytoplasm is shown in red, nuclei in blue and the green channel shows a, b the nucleoli, c, d the golgi and e, f the vesicles. b, d, f show close-up sections of a, c, e, respectively, with the section identified by the green square




modelling protein expression
with a view to include an if channel per protein marker into the model, three user-defined parameters were introduced per protein. these define whether or not the protein has been imaged, whether there is a mutation in the gene, and what fraction of the epithelial cells express the protein. six proteins were included in the model, namely mlh <dig>  pms <dig>  msh <dig>  msh <dig>  p <dig> and pten. the protein expression within each organelle is generated using a well-known procedural model  <cit>  for texture synthesis. details of each are given below. in addition, the user could choose to produce samples that are representative of the population. in that case, the model would include an mmr protein mutation with a  <dig> % probability. if a mutation occurs, it has a probability of  <dig> % of being in the mlh <dig> gene,  <dig> % in msh <dig>   <dig> % in msh <dig>  and  <dig> % in pms <dig>  <cit> . in cases without mutation, p <dig> has  <dig> % probability of being overexpressed in epithelial cells, whereas in msi cases it is overexpressed in only  <dig> % of the cases  <cit> .

the subcellular expression for mlh <dig> was modelled as described in table  <dig> and shown from confocal fluorescence images of cultured cells in fig. 10
a, namely the protein has a strong expression in the nucleoli and weak expression in the rest of the nucleus. we can see that this also agrees with what is observed when the cells are in a tissue . if the user specifies a mutation in the mlh <dig> gene, the protein is not expressed in the epithelial cells. otherwise, the user can specify what fraction of the epithelial cells are expressing the protein. it is worth noting that, in practice, even if only a small fraction of epithelial cells express the mmr proteins, the sample is graded as positively stained. most stromal cells would always express the mmr proteins and, in the clinic, this serves the pathologists as a positive control that the tissue has been stained. within the model, all stromal cells would always express mlh <dig>  examples of if protein marker images generated are shown in fig. 10
c, d.
fig.  <dig> modelling mlh <dig>  a subcellular location of mlh <dig> in cultured cells imaged using a confocal fluorescence microscope, b mlh <dig> expression in a histology image of cra; images a, b are from the hpa. c, d synthetic images for mlh <dig> with d a scaled up sections from . images are from the same sample as shown in fig.  <dig>  in this simulation all cells are expressing the protein




the real confocal fluorescence images from hpa showed strong expression of pms <dig> in the nucleus excluding the nucleoli and weak expression in the cytoplasm . we can see that this also agrees with hat is observed when the cells are in a tissue . if the user specifies a mutation in the pms <dig> gene, the protein is not expressed in the epithelial cells. in addition, the same limited expression would occur if there is a mutation in the mlh <dig> gene as the two are binding partners . otherwise, the user can specify what fraction of the epithelial cells are expressing the protein and these are taken to be a subset of the epithelial cells expressing mlh <dig>  as above, all stromal cell would always express pms <dig>  example of synthesised mlh <dig> protein images are shown in fig. 11
c, d.
fig.  <dig> modelling pms <dig>  a subcellular location of pms <dig> in cultured cells imaged using a confocal fluorescence microscope, b pms <dig> expression in a histology image of cra; images a, b are from the hpa. c, d synthetic images for pms <dig> with d a scaled up sections from . images are from the same sample as shown in fig. 9






the subcellular expression for msh <dig> was modelled as described in table  <dig> and seen in confocal if images of cultured cells from hpa as shown in fig. 12
a, namely the protein has a strong expression in the nucleus and weak expression in the nucleoli. the same expression pattern is observed when the cells are in tissue . to generate a realistic texture for this protein we use the chromatin texture used for the nuclear channel of the thecot model  <cit> . if the user specifies a mutation in the msh <dig> gene, the protein is not expressed in the epithelial cells. otherwise, the user can specify the fraction of the epithelial cells expressing the protein. all stromal cells would always express the molecule. example of synthetic msh <dig> protein images are shown in fig. 12
c, d.
fig.  <dig> modelling msh <dig>  a subcellular location of msh <dig> in cultured cells imaged using a confocal fluorescence microscope, b msh <dig> expression in a histology image of cra; a, b are from the hpa. c, d synthetic images for msh <dig> with  a scaled up sections from . images are from the same sample as shown in fig. 9





both in vivo and in vitro cells have strong expression of msh <dig> in the nucleus excluding the nucleoli, the vesicles and golgi apparatus, and weak expression in the cytoplasm . if the user specifies a mutation in the msh <dig> or msh <dig> genes, the protein is not expressed in the epithelial cells . otherwise, the user can specify what fraction of the epithelial cells are expressing the protein and these are taken to be a subset of the epithelial cells expressing msh <dig>  as above, all stromal cells would always express msh <dig>  example of synthetic msh <dig> protein images are shown in fig. 13
c, d.
fig.  <dig> modelling msh <dig>  a subcellular location of msh <dig> in cultured cells imaged using a confocal fluorescence microscope, b msh <dig> expression in a histology image of cra; images a, b are from the hpa. c, d synthetic images for msh <dig> with  a scaled up sections from . images are from the same sample as shown in fig. 9





p <dig> has a strong expression in the nucleus excluding the nucleoli . unlike the mmr genes, p <dig> is not expressed in the stromal cells. hence, to avoid a blank image in the stack, the model assumes that there is some expression of the protein in the epithelial cells. the user can specify what fractions of the epithelial cells are expressing the protein. example of synthetic p <dig> protein images are shown in fig. 14
c, d.
fig.  <dig> modelling p <dig>  a subcellular location of p <dig> in cultured cells imaged using a confocal fluorescence microscope, b p <dig> expression in a histology image of cra; a, b are from the hpa. c, d synthetic images for p <dig> with  a scaled up sections from . images are from the same sample as shown in fig. 9





similarly, pten expression is modelled within the nucleus but not the nucleoli or in the cytoplasm as shown in fig. 14
d. unlike p <dig>  pten is expressed in some stromal cells. the fraction of stromal cells expressing it is chosen at random to be between  <dig> and  <dig> %, based on observations from the real data, an example of which is shown in fig. 15
b. a sample image showing expression pattern of this protein marker is shown in fig.  <dig> 
fig.  <dig> modelling pten. a subcellular location of pten in cultured cells imaged using a confocal fluorescence microscope, b pten expression in a histology image of cra; a, b are from the hpa. c, d synthetic images for pten with  a scaled up sections from . images are from the same sample as shown in fig. 9





RESULTS
we have focussed on six proteins associated with msi in colorectal cancer. these are commonly screened for in clinical practice and developing the protein expression models could aid the development of frameworks for automatic grading. the user could choose to have a sample that is generated with the probability of mutation representative of the general population. in this case, they also need to specify which of the six proteins they wish to be included in the resulting images. alternatively, they can specify where the mutation occurs. the model takes into account dependencies of binding pairs of the mmr proteins, and hence, if a mutation occurs in mlh <dig> or msh <dig>  its binding partner would also have inhibited expression in epithelial cells. each protein subcellular expression pattern mimics the behaviour observed in real high-resolution if data. in this way, we can capture protein co-localisation patterns. in addition, developing realistic protein expression models could potentially aid the discovery of yet unknown protein interactions.

subcellular organelle features
in order to assess the quality of the spatial protein expression models, we assess how well the cell organelles have been modelled. we consider how accurately organelle features that have been used as input to the model have been generated within the synthesised data. in order to perform the comparison, we generated  <dig> well-differentiated samples with the same magnification and image resolution as the real images. this resulted in the generation of  <dig>  vesicles,  <dig>  golgi and  <dig> nucleoli. comparison of the histograms has been been performed using the kullback-leibler divergence between the real and synthetic distributions. the results are shown in table  <dig>  the distributions of the numbers of organelles per cell and their position are shown in fig.  <dig>  we can see that the distributions of the numbers of organelles are reasonably good approximations of the real pdfs. for the number of golgi, we can see that there are a small number of cells with a very high number of golgi organelles. however, a similar, although smaller peak in the histogram can be observed in the real data . on the other hand, we can see a wider distributions for the position parameter of the synthesised golgi and vesicles. this is due to the fact that when the position of these organelles is being calculated, the method assumes that the nucleus is in the centre of the cell, rather than displaced towards the base of the cell. hence, the problem does not occur in stromal cells and high-grade cancer samples. on the other hand, the distributions for the ratio between the minor axes of the synthesised organelles and the nucleus of the corresponding cell as shown in fig.  <dig>  and between the minor and major axes of the synthesised organelles in fig.  <dig>  show very good agreement with the pdfs estimated from the real data. we have also considered features that have not been explicitly learned from the real data. figure  <dig> shows the distributions of the solidity for real and synthesised organelles and we can observe very good agreement between the two. in fig.  <dig> we consider the area taken up by the organelles. figure 19
a, b shows the fraction of the nucleus taken by the nucleoli. figure 19
c–d illustrates the fraction of the total area of the cell taken by the golgi and vesicles. although the area of the organelles is not specified explicitly within the model, we observe good agreement between the real and synthesised distributions.
fig.  <dig> probability distributions for the synthesised number  and position  of the a, b nucleoli, c, d golgi and e, f vesicles. the probability distribution functions shown are the ones estimated for the real data, shown in fig. 6



fig.  <dig> probability distributions for the ratios between the minor axes of the synthesised organelles and the nucleus of the corresponding cell  and between the minor and major axes of the synthesised organelles . figures show the ratios for a, b nucleoli, c, d golgi and e, f vesicles. the probability distribution functions shown are the ones estimated for the real data, shown in fig. 7



fig.  <dig> probability distributions for the real  and synthesised  solidity of the a, b nucleoli, c, d golgi and e, f vesicles. the probability distribution functions shown are the ones estimated for the real data


fig.  <dig> probability distributions for the cell area fraction taken up by the real  and synthesised  organelles. a, b show the fraction of nuclear area taken up by the nucleoli. the fraction of cytoplasmic area taken up by  golgi and  vesicles is also considered. the probability distribution functions shown are the ones estimated for the real data





combinatorial molecular phenotypes
one imaging technique allowing acquisition of multiplex if images is the toponome imaging system   <cit> . one way of analysing such data is to threshold all the channels, obtaining at each pixel a  <dig> where the protein is absent and  <dig> where it is present. then, the protein expression signals can be expressed as a binary code called combinatorial molecular phenotype   <cit> . we have performed this analysis to compare the cmps found in a healthy sample and a moderately differentiated sample with a mutation in the mlh <dig> protein. the healthy sample contained a total of  <dig> cells, whereas the cancerous sample contained  <dig> cells. the results are shown in fig.  <dig>  we can see that the stromal cells have been split into two phenotypes present in both samples. the phenotypes determined by the expression of pten , with cells expressing the protein shown in orange and those lacking the protein shown in light blue. each phenotype is formed of two cmps, one located in the cell cytoplasm and one localised to the nucleus and vesicles. the two cmps are differentiated by expression of msh <dig>  the lack of a purely nuclear marker in the stromal cells means that the cmp analysis of these cells is unable to segment the nuclei. on the other hand, p <dig> has allowed identification of nuclei in the healthy epithelial cells expressing the protein  resulting in a unique cmp shown in dark red in fig. 20
a. in the epithelial cancer cells, the mutation of mlh <dig> has resulted in unique cmps being identified . similar to the healthy epithelial cells, the expression of p <dig>  divides the cells into two phenotypes.
fig.  <dig> combinatorial molecular phenotype analysis. a and b show the cmps obtained for healthy and cancerous samples, respectively. c and d show expression of p <dig> in healthy and cancerous samples, respectively. e shows the expression of pten in a healthy sample. f shows expression of mlh <dig> in a cancer sample




it is clear that this kind of analysis can allow for the identification of different cell phenotypes and subcellular compartments that may shed new light on tumour heterogeneity. in the experiment above, cmp analysis was unable to identify the nucleoli and golgi apparatus. this is because the proteins expressed in the nucleoli are also expressed in the nuclei. similarly, the only protein expressed in the golgi is also expressed weakly in the cytoplasm. if one was interested in identifying these regions, a higher threshold could be set to ignore weak expression. however, great care would need to be taken as the texture of the protein expression may result in holes in the cytoplasmic or nuclear regions.

protein network analysis
kovacheva et al.  <cit>  introduced the diswop framework for analysing multiplex if data, such as the one simulated by the model described above. the approach analyses cell phenotypes in normal and cancerous colon tissue imaged using the tis microscope  <cit> . it involves segmenting the image into cells and determining the cell phenotypes according to their protein-protein dependence profile. calculating the diswop measure enables identification of protein pairs which have significantly higher/lower co-expression levels in cancerous tissue samples when compared to normal colon tissue. we apply the diswop framework to a set of simulated images. for this purpose, we generated  <dig> healthy and  <dig> moderately differentiated cancerous samples at  <dig> × magnification. from the  <dig> cancerous samples,  <dig> had no mutation,  <dig> had a mutation in the mlh <dig> gene and  <dig> had a mutation in the msh <dig> gene. the same dataset was also simulated at  <dig> × magnification to investigate the dependence of the diswop measure on the magnification scale. this experiment was conducted considering only proteins directly linked to msi, i.e. without simulating the expression of pten.

for each of the cells, we calculate the protein-protein dependence profile  using the maximal information coefficient   <cit> . the protein pairs are shown in table  <dig>  the cells are phenotyped using affinity propagation  <cit>  according to their ppdp. distribution of the phenotypes within the cancerous samples simulated at  <dig> × magnification is shown in fig.  <dig>  we can see that phenotypes  <dig> and  <dig> are found only in samples with mlh <dig> mutation. their ppdps are highlighted in red in fig.  <dig>  from fig.  <dig>  we can see that phenotype  <dig> exhibits non-zero dependence only between msh <dig> and msh <dig>  whereas phenotype  <dig> also has non-zero dependencies between these two proteins and p <dig>  this can also be observed from the real data. we can see in fig.  <dig> that the two phenotypes include all of the epithelial cells, with phenotype  <dig> including all epithelial cells expressing p <dig>  on the other hand, phenotypes  <dig>   <dig>   <dig> and  <dig> are found only in samples with msh <dig> mutation. phenotypes  <dig>  and  <dig>  show non-zero dependencies between mlh <dig>  pms <dig> and p <dig>  splitting the epithelial cells expressing p <dig> in two phenotypes. these are shown in fig.  <dig>  this demonstrates that the clustering is able to detect meaningful cell phenotypes, although the real phenotypes could be split into two or more phenotypes found by the algorithm.
fig.  <dig> distribution of phenotypes within cancer samples simulated at  <dig> × magnification. phenotypes are shown along the x-axis and the fraction of the phenotype that is found within each type of cancer samples is shown along the y-axis. cancer samples without mutation are shown in blue, samples with mlh <dig> mutation are shown in teal and yellow shows the samples with msh <dig> mutation


fig.  <dig> average protein-protein dependence profiles  for the phenotypes found within healthy and cancerous samples simulated at  <dig> × magnification. phenotypes found only in samples with mlh <dig> mutation are highlighted in red. similarly, phenotypes found only in samples with msh <dig> mutation are highlighted in blue. numbering of the phenotypes is the same as in fig.  <dig>  numbering of the protein pairs is shown in table  <dig>  black indicates ppd value of  <dig>  and white shows a ppd value of 1


fig.  <dig> simulated protein expression in cell phenotypes found only in mlh <dig> mutated samples. the images show the expression for a msh <dig>  b msh <dig> and c, d p <dig>  the red outlines indicate the cells belonging to phenotypes   <dig> and  8


fig.  <dig> simulated protein expression in cell phenotypes found only in msh <dig> mutated samples. the images show the expression for a mlh <dig>  b pms <dig> and c, d p <dig>  the red outlines indicate the cells belonging to phenotypes   <dig> and  16





once we have obtained the phenotypes, we calculate the diswop measure. we consider the top  <dig> protein pairs in each phenotype due to their relative significance. the diswop results for the simulated samples at  <dig> × and  <dig> × magnification are shown in fig.  <dig>  we can see that nearly the same results are obtained, demonstrating that the measure is independent of the magnification scale and size of the cells. figure  <dig> also shows that diswop is able to detect that the dependences between mlh <dig>  pms <dig> and msh <dig> are stronger in the healthy samples, suggesting that they are broken in at least some of the cancer samples. however, it is difficult to interpret the results further as within the cancer samples there are a number of non-msi samples and cells that have the same protein expressions as the healthy samples. to further analyse the simulated data, we considered dividing the cancer samples into three sets depending on the presence of a mutation. we re-run the analysis framework when considering non-msi samples versus msi samples with both mutations , and versus each mutation separately . when samples with both mutations are considered, the results are very similar to those seen in fig.  <dig>  this is due to the fact that the mutations cause all of the protein pair interactions to be broken down in some of the samples. however, the negative values again clearly indicate the lack of co-localisation of the mmr proteins. on the other hand, if we consider non-msi samples versus samples with mlh <dig> mutation , we can see that, as expected, the interactions of mlh <dig> and pms <dig> are weaker in the msi sample while msh <dig> shows stronger interactions with msh <dig>  p <dig> and mlh <dig>  the latter interaction is likely to occur only in the stromal cells which express all proteins. lastly, we compared non-msi and msh <dig> mutated samples . as would be expected, we observe stronger interactions of msh <dig> with other proteins in the non-msi samples. the mutated samples are characterised by increased co-localisation of p <dig> and pms <dig> 
fig.  <dig> diswop results for the simulated samples at   <dig> × and   <dig> × magnification. each node represents a protein and each edge colour shows a protein pair with different level of co-expression in the normal and cancer samples. here, a large positive value  indicates that the protein pair is more co-dependent in cancer samples, whereas a large negative value  means that the protein pair is more active in normal tissue


fig.  <dig> diswop results for comparing msi and non-msi sets of the simulated cancer samples at  <dig> × magnification. different results are shown when comparing non-msi samples to  both mutations,  mlh <dig> mutation only, and  msh <dig> mutation only. each node represents a protein and each edge colour shows a protein pair with different level of co-expression in the normal and cancer samples. here, a large positive value  indicates that the protein pair is more co-dependent in the mutated samples, whereas a large negative value  means that the protein pair is more active in non-msi tissue




with this set of proteins, it would be easier to simply consider the raw protein expression values. this is because there is no evidence to suggest that the expression patterns of these proteins within the cells change as a result of cancer and this has been reflected in the model. hence, this experiment aims to demonstrate only how the diswop framework could be used to analyse the synthesised data. however, diswop would provide a significantly greater advantage if the simulated proteins changed their subcellular expression patterns  <cit> . proteins that exhibit such changes in localisation could be easily modelled using the framework presented above. these could be proteins with known response to cancer or one could generate random changes in localisation in order to test hypotheses.

CONCLUSIONS
we presented protein expression models to simulate multiplexed if data of both healthy and cancerous colorectal samples. we investigate how to realisticly simulate the expression of six proteins associated with msi or tumour suppression, namely mlh <dig>  pms <dig>  msh <dig>  msh <dig>  p <dig> and pten. following the same method, further proteins of interest could be easily added to the model to increase its usability and study differential co-localisation of proteins. in order to simulate the subcellular location of the proteins, we have developed models for the cell nucleoli, golgi and vesicles, using parameters obtained from real fluorescence data of cells in culture. comparison between the distribution of various features obtained from the real and synthetic organelles has shown very good agreement. this has included both features that have been used as part of the model input and ones that have not been explicitly considered. the addition of further proteins of interest may require more of the cell organelles to be modelled, such as the cytoskeleton and the endoplasmic reticulum. it would be difficult to represent these using the deformed circle model, so a different approach may need to be developed. we have analysed simulated data using the combinatorial molecular phenotype analysis and have demonstrated that this approach is capable of identifying the different cell phenotypes and subcellular structures in the tissue. finally, we presented a study of how the diswop framework could be used to analyse the synthetic data. using the framework to compare the protein co-localisation in msi versus non-msi samples was able to detect the presence of mutations. this kind of analysis would be invaluable in detecting changes in subcellular expression patterns resulting from the development of cancer. proteins that exhibit such changes in localisation could be easily modelled using the framework presented in order to test various hypotheses.

to the best of our knowledge, this is the first model for subcellular expression of multiple proteins in anatomically intact tissue, as opposed to existing models for protein expression within cells in culture. the synthetic data generated using this model could provide an objective way of validating and comparing image analysis methods such as cell-compartment classification methods, frameworks for studying protein co-localisation or protein expression grading.

abbreviations
cmpcombinatorial molecular phenotype

cracolorectal adenocarcinoma

hpahuman protein atlas

ifimmunofluorescence

ihcimmunohistochemistry

mmrmismatch repair

msimicrosatellite instability

pdfprobability distribution function

tistoponome imaging system

none

funding
v. k.’s research was funded by the bbsrc and university of warwick institute of advanced study. this work was partly funded by the qnrf grant nprp 5-1345-1- <dig> 

availability of supporting data
the data set and source code supporting the results of this article are available at http://www.warwick.ac.uk/bialab/software/msimodel.

authors’ contributions
nmr conceived the study. vk conducted all the experiments. both authors contributed to writing the manuscript. both authors read and approved the final manuscript.

competing interests
the authors declare that they have no competing interests.

consent for publication
not applicable.

ethics approval and consent to participate
not applicable.
