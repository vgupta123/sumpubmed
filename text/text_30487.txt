BACKGROUND
hiv is one of the fastest evolving viruses ever known. its high evolutionary rate is the main reason for rapid acquisition of drug resistance and the difficulty of vaccine development. however, the fast rate can also be utilized in evolutionary analysis, enabling us to trace the evolutionary process of hiv in real time by analyzing virus samples serially collected from infected individuals.

many previous studies have examined hiv population dynamics, and revealed many unique and important features of viral evolution within an infected individual  <cit> . numerous viral variants coexist in the same host which arises from the rapid genomic evolution powered by the high mutation rate during viral replication. some of these studies described the viral population by using the concept of "quasispecies", a dynamic distribution of non-identical but closely related mutants, which acts as a unit of selection  <cit> . therefore, in viral evolution, the target of selection is not the individual mutant sequence. when the patient is under highly active antiretroviral therapy , which has been executed on aids patients since the early 1990s, the greater selective pressure on the viral population is probably the anti-hiv drugs. the multiple viral groups with different drug-resistant mutations coexisting within a single patient will have different potentials to respond to the internal and external selective pressures. moreover, whenever the haart regime is changed, new mutations on the targeted genes emerge rapidly at sites related to drug resistance, enabling the virus to escape from drug attacks, while most sites of the viral gene remain almost entirely unchanged over a relatively short period. understanding this complex process is crucial for elucidating the possible mechanisms of the anti-hiv drug resistance acquisition, which has become a major challenge in anti-hiv therapy.

in contrast to the rapid accumulation of viral data, few powerful methods for inferring the within-patient viral evolution are available. one reason appears to be the difficulty to deal with serial virus samples  <cit> . traditional phylogenetic methods such as neighbor-joining   <cit>  and maximum likelihood   <cit>  are designed for contemporaneous molecular data and do not take into account sampling times. drummond and rodrigo  <cit>  proposed the supgma method, which extends conventional upgma to serially sampled data. like other methods for serial data  <cit> , supgma considers all viral variants as the end points of evolution and ignores the fact that in serial samples, viral variants survive or leave descendents to the next time point. the same problem exists in the bayesian method of drummond et al.  <cit> . a further difficulty is that the viral sequences from the same patient are extremely similar and thus uninformative about their phylogenetic relationships, so that phylogeny-based methods suffer from uncertainties in the reconstructed phylogenies. recently, buendia and narasimhan  <cit>  developed the sliding minpd method, which reconstructs the evolutionary networks of serial viral sequences by combining minimum pairwise distances with automated recombination detection based on a sliding window approach. this method overcomes some of the limitations of traditional phylogenetic tree reconstruction and is able to detect recombination events, which may occur frequently during hiv replication. the method is not widely used and its performance is not well-understood. furthermore, beerenwinkel and drton  <cit>  developed a mutagenetic tree model to describe the order of occurrences of amino acid changes that are associated with resistance to a particular drug. the method assumes that we know which amino acid mutations are important to drug resistance.

we propose a new method, vspa , for analyzing within-patient hiv evolution. we calculate the genetic distances between virus samples, and use pearson correlation coefficient to classify viral variants at the same sampling time into different clusters. we further identify the evolutionary pathways between viral clusters across the sampling times. a permutation test at the codon level is used to determine the threshold correlation coefficient for the clustering. we applied the vspa method to four large data sets of hiv- <dig> protease  and reverse transcriptase  genes serially collected from two japanese aids patients, and compared the results with those from traditional tree-building methods and sliding minpd.

RESULTS
viral clusters and evolutionary pathways inferred by vspa
the vspa method was applied to four large data sets of pr and rt genes serially collected from patients  <dig> and  <dig>  below, we refer to these data sets as p1pr, p1rt, p2pr and p2rt, respectively.

mutually exclusive mutations observed in p1pr
the results of the permutation test for p1pr are shown in additional file  <dig> and the distributions of correlation coefficients for the randomly generated data differed considerately from those for real hiv- <dig> data.

the clusters and their evolutionary dynamics inference for the  <dig> p1pr sequences are shown in figure 1a. viral diversity fluctuated over the observation period. at time points a and b, many clusters existed, but very few clusters were constructed for time points c-i. only one cluster was estimated for time points g and i. however, the virus diversified again from time point h. the diversity changes corresponded to the change in the protease inhibitors  administered to patient  <dig> .

from the amino acid mutations that each cluster possessed , it appeared most likely that two subpopulations existed with different frequencies during different periods. one is a subpopulation possessing d30n drug-resistant mutation, which we refer to as p1pr-sp30n, and the other a subpopulation possessing l <dig> m drug-resistant mutation, which we refer to as p1pr-sp <dig> m. the p1pr-sp30n was observed from time point d to h and was a main subpopulation until time point g. however, it declined in frequency at time point h and disappeared at time point i. the emergence and extinction of this subpopulation apparently corresponded with the administration of the nelfinavir , to which the d30n is a major drug-resistance mutation. in contrast, the p1pr-sp <dig> m emerged at time point c and existed over all later time points. it had been a minor subpopulation until time point g and became major from time point h--that is,  <dig> days after nfv was switched to ritonavir  and saquinavir . the l <dig> m is a well-known drug-resistant mutation for multiple pis. the above result was consistent with the experimental finding that the d30n and l <dig> m drug-resistant mutations were mutually exclusive  <cit> .

m184v had the greatest impact on p1rt evolution
the evolutionary dynamics of p1rt is depicted in figure 1b. two subpopulations, p1rt-sp184v and p1rt-sp <dig> m, probably existed in the earlier and latter periods, respectively. the mutation m184v has a strong drug resistance to lamivudine  and p1rt-sp184v was the major subpopulation from time points a to i, but was replaced completely by the subpopulation having the wild-type  <dig> m at time point j about  <dig> months after the switch from 3tc to dinanosine . this result agrees with the experimental observation that m184v occurs in a small proportion of patients but does not occur in patients receiving ddi with zidovudine  or stavudine   <cit> .

possible convergent evolution in p2pr
the result obtained from analyzing the  <dig> samples of p2pr are shown in figure 3a. the diversity pattern was different from that of patient  <dig>  for time point b to e, only one or two clusters were constructed. as shown in figure  <dig>  the pis had been administered before the sampling and a multiple drug-resistant mutation, l <dig> m, was observed since time point a. this subpopulation, however, could not survive longer, and another subpopulation emerged after time point c instead. because both subpopulations possessed the mutation l <dig> m, we called them p2pr-sp <dig> m <dig> and p2pr-sp <dig> m <dig>  by comparing clusters b <dig> with c <dig> and d <dig> at the codon level , we observed more common codons in clusters c <dig> and d <dig>  thus it is most likely that the  <dig> m mutation occurred by convergent evolution in two subpopulations. however, a common codon  was observed at site  <dig> in clusters b <dig> and d <dig> but not in cluster c <dig> , raising a possibility that cluster d <dig> might be recombinant between clusters b <dig> and c <dig> as well.

identical codons in any two clusters are shown in bold. identical amino acids at different codon levels are shown in bold italics.

co-evolution observed in p2rt
the results for  <dig> samples of p2rt are shown in figure 3b. we focused on two evolutionary events, t <dig> insertion and m184vi mutation. they are two major drug-resistant mutations to d4t and ddi and to 3tc, respectively. we further classified the viral clusters into  <dig> subpopulations for the period of high diversity from time point e: sp69ins- <dig> m <dig>  sp69ins- <dig> m <dig>  sp69ins+ <dig> m <dig>  sp69ins+ <dig> m <dig> and sp69ins-184i. note that ins- means absence of the t <dig> insertion and ins+ presence.

the t <dig> insertion was observed at time point a. the presence of this insertion is probably related to its resistance to several nucleoside rt inhibitors  that had been administered to patient  <dig> before the sampling started. the m184vi mutation occurred between time points b and e. the five subpopulations were mainly observed from time point f, before which no sample was taken for more than three years. briefly, the two subpopulations with t <dig> insertion and back mutation at site  <dig>  were observed, but they were not dominant except at time point e. the sp69ins-184i had been dominant for only a short period as well. in contrast, the sp69ins- <dig> m <dig>  which lost t <dig> insertion and acquired back mutation at site  <dig> in the same period, diversified and had been a major subpopulation for a long period. this observation raises a possibility that there might be interaction between the lost t <dig> insertion and the back mutation at site  <dig> 

the sp69ins- <dig> m <dig> subpopulation included only one sequence k <dig> and had neither t <dig> insertion nor m184v mutation, but it was linked with a very early cluster b <dig>  we investigated the difference between the clusters of time point k and found that only sequence k <dig> possessed the m230l mutation, a drug-resistant mutation to enfuvirtide . also, another mutation, k103r, was observed in the k <dig> alone. it is likely that sequence k <dig> was a memory variant having resistant mutations to efv, given that this drug had not been administered for more than one year.

all mutations existing at the first time point and newly acquired on the pathways can be found in additional file  <dig> 

comparison with phylogenetic reconstruction methods and minpd
we applied two representative methods, neighbor-joining   <cit>  and maximum likelihood   <cit> , to the same data sets to reconstruct phylogenetic trees, using mega <dig>  <cit>  and phyml  <cit> , respectively. the k <dig> + g model  <cit>  was used as for vspa. bootstrap analysis with  <dig> replicates was performed on the reconstructed phylogenetic trees.

the nj and ml methods produced very similar trees . first, the bootstrap values were very low at almost all internal nodes on all trees. second, as the sampling times were not taken into account in either nj or ml, the inferred trees showed unreasonable structures for evolutionary relationships, with virus samples obtained at later time points to be descendents of variants obtained earlier.

the same data sets were also analyzed using the sliding minpd method  <cit> . considering the different lengths of the two genes, we set the window size to be  <dig> bp for pr and  <dig> bp for rt. the default offset  was used in all analyses. the results for the p1pr dataset are shown in additional file  <dig>  while those for the three other datasets are not shown because of their large file sizes. many recombination events were inferred by sliding minpd for the p1pr, p1rt, and p2rt datasets, making it very difficult to find evolutionary pathways from these networks.

discussion
in this study, we developed a new method for analyzing serial virus samples and applied it to the large data sets of pr and rt genes of hiv- <dig> obtained from two aids patients undergoing haart. here we discuss some strengths and weaknesses of the vspa method, in comparison with conventional tree-reconstruction methods and the sliding minpd method.

traditional tree-building methods were found to be unsuitable for the analysis of serial virus samples. not only did they confuse ancestor-descendant relationships due to their failure to account for sampling times but the reconstructed tree topologies also had poor accuracy due to the high similarities of viral sequences. similarly, the networks constructed by the sliding minpd method might not be useful to reveal evolutionary relationships among viral variants, as the method appeared to detect too many recombination events.

in contrast, the vspa method has several advantages for analyzing serial virus samples with high similarity. first, the ancestor-descendent relationships among viral sequences are accommodated by the method, as different sampling times are taken into account. our method also accounts for latent viral variants as we searched for ancestors over all previous time points during pathway construction. vspa infers viral ancestral relationships at the cluster level and appeared to be more useful for interpreting the evolutionary relationships among viral sequences than methods that attempt to infer relationships at the individual sequence level. second, viral variants inferred to be in the same cluster not only have high sequence similarities but also share important evolutionary features such as drug-resistant mutations. our results suggest that multiple viral groups with different mutations usually coexist within the same patient during different periods and their frequencies fluctuate in response to changes in drug combinations. while fluctuation of viral mutations in within-host evolution is noted before  <cit> , the vspa method analyzes this process quantitatively.

third, vspa traces the acquisition, frequency change, and loss of important drug-resistant mutations over time , and classifies the viral subpopulations according to these amino acid changes. in this regard, it has advantages over other cluster methods. for example, paq , developed by baccam et al. , clusters viral variants based on their genetic diversity, but requires the user to specify a radius value for clustering. for the data analyzed in this paper, the genetic similarities are so high that it is difficult to select a sensible radius value. in contrast, vspa uses a permutation test to determine the threshold correlation coefficient automatically. our permutation test is conducted at the codon level to test interactions among different codons of the hiv genome - such interactions may be important for the pr and rt genes, which are the targets of the main anti-hiv drugs at present.

a number of amino acid changes were inferred in both genes for both patients, although only a few examples were discussed due to limited space. we note that many of the amino acid changes identified by vspa were already known to be responsible for resistance to anti-hiv drugs. our analysis also identified some previously unknown amino acid changes, which may provide interesting hypothesis for experimental verification.

the vspa method has weaknesses as well. it does not automatically detect recombination although it is possible to infer recombination events by confirming those common amino acid changes in some clusters . one strategy may be to use standard recombination-detection methods  to detect recombination on the viral clusters inferred by vspa. a problem with almost all recombination detection methods is that they ignore natural selection and are known to generate excessive false positives when the gene is under strong selection. the pr and rt genes analyzed in this study are collected from the aids patients under anti-hiv therapy and they are main targets of anti-hiv drugs. no doubt they are under strong positive selection which drives drug-resistant mutations to fixation. as a result, we lack reliable estimates of recombination rates for those data. analytical methods that deal with recombination and selection simultaneously are still in their infancy  <cit> . we believe that recombination should have less impact on our method, which is based on pairwise distance calculation, than on phylogeny-based methods. nevertheless, the effect of recombination on vspa remains unknown and merits further research.

CONCLUSIONS
since many new anti-hiv drugs will be available in the near future and more complex drug-resistant mutations will emerge, vspa may be useful for analyzing viral responses to those drugs and for providing valuable information to experimental researchers quickly. we hope that our study will motivate the development of computational methods suitable for viral quasispecies that take into account major features of the data, such as different sampling times, and dramatic changes in selective pressure due to changing drug combinations.

