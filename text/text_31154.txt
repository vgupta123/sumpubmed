BACKGROUND
the last  <dig> years have witnessed steady progress in the prediction of the three-dimensional  structure of proteins from their amino acid sequence  <cit> . most current approaches, ranging from de novo to fold recognition  techniques, are based on simplified "energy" potentials . these empirical potentials, often more appropriately referred to as score functions, are derived from statistical analyses of structural features observed in known 3d structures: residue-wise interactions, secondary structure propensities, residue surface, etc. they are used with a reduced representation of the polypeptide chain . such coarse-grained potentials cannot capture wholly the subtle relationship that exists between the amino acid sequence and the 3d structure of proteins. however their simplicity is an asset for exploring the conformational space, they permit to filter out improbable or unrealistic structures and, hopefully, to propose structures that are close to the native structure. de novo techniques, such as those developed by the baker's group  <cit> , generate hundreds of structures some close to the native structure but also many far from it. threading methods are more constrained since they only consider known 3d structures and seek whether a particular query sequence might be compatible with some of these structures. typically, they provide a list of template structures that are ranked by scores. all these methods have developed their own means to judge whether a de novo structure is close to the native structure or whether a particular template structure is compatible with a given sequence. however, in some cases this judgement is not clear-cut and it has been suggested that these techniques could benefit from the use of an atomic representation of the polypeptide chain together with detailed energy functions based on chemical-physical principles  <cit> . one would thus adopt a hierarchical approach, simplified potentials would permit to focus on a limited number of plausible candidates and detailed potentials would help in discriminating between native and misfolded structures. since the pioneering work of novotny et al. <cit>  a number of groups have sought to analyse whether usual molecular mechanics force fields, such as those employed for molecular dynamics  simulations complemented with different ways of computing solvation effects, could indeed discriminate the native structure from misfolded conformations  <cit> . all these works, except  <cit>  that uses a limited sampling, are based on minimised conformations, hence the need to introduce different terms to represent solvation free energy. it appears that such empirical free energy calculations are able to make a distinction, in many cases, between native structures and decoys. these works also analysed the role of the different terms involved in the free energy computation: internal, van der waals and electrostatic energies, solvation contributions, etc. arriving at somewhat different conclusions as to which terms were preponderant for the discrimination.

other groups  <cit>  tackled a related question: can physics-based potentials together with an extensive sampling of the protein conformational space using md simulations refine, i.e., bring closer to the native structure, an initial model resulting from a previous stage employing coarse-grained potentials?

in this work we wish to answer a very pragmatic question. we have developed a fold recognition method called frost  <cit> . in this method we perform a statistical analysis of the scores to decide whether a sequence is compatible with a template structure. this permits us to recover 60% of the related sequence-structure pairs while keeping an error rate of 1%. unfortunately 40% of the pairs do not satisfy this statistical criterion although, for an important fraction of them, a compatible template structure can be found amongst the top templates of the list ordered by normalised scores. hereafter, we will refer to the zone where scores are not statistically significant as the "twilight zone" of the method. the question we would like to answer is thus the following: can physics-based potentials and md simulations help us in discriminating "correct" from "erroneous" templates in such borderline cases. our motivation is similar to the one of kinjo and colleagues  <cit>  although, as described below, we employ a different approach.

we define a correct template as a structure that is similar to the query sequence native structure and an erroneous template as any other structure of the database. let us note that these erroneous templates, because they appear in the top of the list, constitute difficult cases compared to what has been done by novotny et al. <cit> . they just swapped the sequences between an all-α protein and an all-β protein without paying attention whether this procedure buried charged residues or exposed non polar residues. the threading method will find the best location for the query residues in the 3d structure according to its empirical score function . therefore many of the top erroneous templates are likely to exhibit some common features with the correct templates making them difficult to distinguish.

to answer the above question, for the borderline cases, we build 3d models based on the sequence-structure alignments provided by our fold recognition method and we submit them to md simulations. we monitor different structural features: rmsd, radius of gyration, secondary structures, side chain surface, etc. along the trajectories to discriminate correct from erroneous models. there are many ways in which a 3d model can be erroneous. in this study, to be consistent with the question we want to answer, an erroneous model is defined as a model for which the sequence has been aligned with a template structure that has no relationship with its native structure.

notice that, in real cases, one cannot use approaches similar to those described in  <cit>  since they require the knowledge of the native structure. in these studies, the value of the free energy for the native structure is usually smaller than the value of the free energy for the decoys but the difference is often quite small relative to the magnitude of the figures involved . free energy values are very different according to the protein studied and there is no absolute scale on which one could rely. therefore instead of trying to compute the free energy of the models we choose to rely on the analysis of the behaviour of different structural features along the md trajectories.

RESULTS
we selected  <dig> query domains representative of the principal scop  <cit>  classes: all-α, all-β and αβ. for each query domain we built  <dig> models as described in the method section . these models correspond to the same sequence  aligned with different template structures. they cover the whole spectrum of models that can be generated for a query sequence: from a perfect model corresponding to the native structure  to a very poor model where the query sequence has been aligned with a template structure completely different from its native structure .

as a mnemonic, the first letter indicates whether the query sequence has been aligned with the right template  or not  and the last digit indicates the proximity of the model with the true structure. .

between these two extremes, that are used as controls, we wish to focus on intermediate models that are typical of what can be expected after a fold recognition analysis . for the first three intermediate models, st <dig>  st <dig>  st <dig>  the query sequence has been aligned with a template structure that is similar to the native structure. for st <dig> and st <dig> the alignment is good or fair . these two models are mainly distinguished by the percentage of sequence identity between the query sequence and the sequence of the template structure: st <dig> is in the range 20– <dig> approaching the generally recognised limit of 30% for homology modelling  <cit> . st <dig> has been chosen, on purpose, to lie within the twilight zone. usually this implies that the percentage of sequence identity is below 20%, typical of fold recognition targets. st <dig> has the same characteristics as st <dig> except that we selected a template structure on which the fold recognition method was not able to align correctly the query sequence. this is often the case when the template structure, although globally similar to the query native structure, possesses additional secondary structure elements or when secondary structure elements of the "core" have undergone substantial motions relative to each other. these two characteristics perturb the fold recognition alignment. the last model, dt <dig>  has been obtained by aligning the query sequence with a template structure that is different from its native structure. it must be noticed that we chose the template structure that corresponds to the first false positive appearing in the fold recognition list of structures ranked by score. therefore, according to the frost score function, this template structure possesses some features similar to the query native structure. indeed we often observe that such template structures share motifs with the query native structure that tend to confuse the fold recognition method.

let us emphasise that all models, as far as the backbone is concerned, are based on known 3d structures. structural features such as the network of hydrogen bonds, the ramachandran zones for the φ and ψ angles, etc. are realistic . the only unrealistic structural feature concerns the location and interactions of side chains in some of the models.

in the following, we try, by monitoring various structural characteristics along md trajectories at different temperatures, to answer two questions. first, is it possible to distinguish, quantitatively or qualitatively, models for which the query sequence has been aligned with a template structure similar to its native structure from models for which the query sequence has been aligned with template structures without relation with its native structure? if the query sequence has been aligned with the correct template structure but with a poor alignment can we pinpoint parts of the model that correspond to misaligned regions?

analysis of the models
all-α models
fig.  <dig> shows the query protein for the all-α class and the template structures that are used to build the models. in additional file  <dig>  table s <dig> gives details about the structure comparisons, figure s <dig> displays the relationship that exists between these structures according to the scop hierarchy, table s <dig> shows comparisons of the models with the query native structure and figure s <dig> shows the structural superimposition of the models with the query native structure. notice that not all models have a length equal to the query sequence length . modeller does not know how to handle properly residues that, according to the alignment, are located before the n-terminus, or after the c-terminus of the template structure. in such cases it generates extended conformations. we thus decided to chop these residues in the alignment.

fig.  <dig> shows the frost score , the vast score , the tm-score  and the rmsd of the model with respect to the query native structure.

the frost score is very high for model st <dig> since this model is in the range of homology modelling. scores for other models are in the frost twilight zone with a small difference between scores for st <dig>  st <dig> and dt <dig>  this is precisely to help us resolving such ambiguous situations that we would like to employ md simulations.

all indicators show that st <dig> is related to the query native structure. for st <dig> the vast score is negative but the tm-score is significant. st <dig> and dt <dig> appear to have about the same weak similarity with the query structure. the tm-score is slightly above the significant threshold of  <dig> . in fact, according to scop, st <dig> belongs to the same fold as the query protein  whereas dt <dig> belongs to a different fold . these two folds obviously share a common helical motif that confuses the fold recognition program.

model st <dig> is marginally similar to the query native structure with an rmsd of  <dig>  Å

all-β models
fig.  <dig> shows the query protein for the all-β class and the template structures that are used to build the models. in additional file  <dig>  details about the structure comparisons are given in table s <dig>  figure s <dig> displays the relationship that exists between these structures according to the scop hierarchy, table s <dig> shows comparisons of the models with the query native structure and figure s <dig> shows the structural superimposition of the models with the query native structure.

notice that the all-β query structure, 1o4ta, has been used as template to build the dt <dig> model for the all-α class. conversely, the all-α query, 1tqga, is used to build the dt <dig> model for the all-β class.

for this class it was difficult to find templates for the whole range of models. for instance we could not find a template for model st <dig>  therefore we decided that the template for st <dig> would also be used as template for st <dig>  the two models just differ by the type of alignment that is used: st <dig> is based on the structural alignment whereas st <dig> is based on the fold recognition alignment. we could not find either a template for the st <dig> model. instead we built two dt <dig> models, named dt1a and dt1b. the templates used for dt1a and dt1b belongs to the same scop fold  but to different super-families.

the template used for models st <dig> and st <dig> is clearly similar to the query structure. both this template and the query structure belong to the same scop family of the double-stranded β helix scop fold. the query protein, 1o4ta, whose length is  <dig> residues, is a homodimer in the pdb file. at its n-terminus there exists a small strand that pairs with its counterpart in the other monomer. when using only the monomer this strand is floating in the solvent. we thus decided to remove this portion of the sequence  from the ns <dig> model to obtain a more compact 3d structure. however alignments with template structures where performed with the complete sequence. this explains why the dt1b model is  <dig> residues long.

αβ models
fig.  <dig> shows the query protein for the αβ class and the template structures that are used to build the models. in additional file  <dig>  table s <dig> gives details about the structure comparisons, figure s <dig> displays the relationship that exists between these structures according to the scop hierarchy, table s <dig> shows comparisons of the models with the query native structure and figure s <dig> shows the structural superimposition of the models with the query native structure.

for the αβ class it was easier to find template structures that span the whole range of models. structural indicators reveal that the st models are clearly related to the query structure. frost scores are in the twilight zone and it is difficult to differentiate st and dt template structures. overall the percentage of sequence identity between the template proteins and the query protein is weak . accordingly the frost score for st <dig> is within the twilight zone. st <dig> template structure, 1qpoa <dig>  corresponds to a domain of a larger protein. this domain corresponds to three-quarter of a regular tim-barrel: the inner β barrel has only  <dig> strands and is not closed; there are  <dig> external α helices.

the st <dig> model is close to the query structure whereas the st <dig> model is relatively far from it . dt models are far from the query structure. st <dig> model is intermediate between dt and the two other st models.

the template structure that is used to build the dt <dig> model, 1bkpa, belongs to the scop α + β class.

conformational space sampling efficiency
we have carried out a principal component analysis as described in the method section. this analysis is usually employed to study collective motions of the system that are described by the first few principal modes. here we use it, primarily, to check whether the sampling of the conformational space we performed is sufficient, through the computation of the cosine content of the first  <dig> principal components.

it has been shown that the principal components of random diffusion are cosines with the number of periods equal to half the principal component index  <cit> . when the cosine content of the first few principal components is close to  <dig>  the largest fluctuations are not connected with the potential but with random diffusion. in other words, the corresponding simulation was not long enough for the system to sample the "walls" of the potential energy function.

the maximum cosine content observed for all the models is  <dig>  . only αβ models consistently exhibit values close to  <dig>  for one of the first  <dig> modes, other models have lower cosine content. from these results one can conclude that the sampling was sufficient to explore the local minimum region for all-α and all-β models. for αβ models, the length of the simulation might possibly be a bit too short, although it is difficult to interpret this value of  <dig>  with certainty. two dimensional plots showing the projection of the trajectories along pairs of modes confirm globally these conclusions . let us emphasise that a low cosine content is not a proof that the system has exhaustively explored all the conformational space available to it at a given temperature. in our experience, with other systems, the cosine content can be low for the first  <dig> ns, say, then can rise suddenly when we compute it for the first  <dig> ns. the interpretation of this phenomenon is that the system got trapped inside a region of the conformational space during the first  <dig> ns then managed to overcome a barrier of potential after  <dig> ns to reach a new region. after  <dig> ns the system has not had time, yet, to sample the boundaries of this new region. therefore if the cosine content computed for a given trajectory is close to  <dig> we know that the corresponding simulation was not long enough to explore the local conformation space completely. on the other hand, if the cosine content is low, we know that the system has had enough time to explore the local potential valley but we cannot be sure that, had we continued the simulation further, the system would not have reached, eventually, another valley.

root mean square deviation analysis
to analyse the behaviour of the different models along the molecular dynamics trajectories we monitored the root-mean-square deviation  between the initial conformation of the production phase  and conformations taken every  <dig> ps. for this criterion, as well as for the other criteria we consider below, we seek i) whether there exists a correlation between the spectrum of models and the criterion values and ii) whether we can find a value of the criterion that allows us to clearly discriminate st models from dt models.

for each models, rmsd between the initial conformation of the trajectory and conformations taken every  <dig> ps along the trajectory at different temperatures. mean: average value along the trajectory, sd: standard deviation. all figures are in Å

before analysing table  <dig>  we must first determine whether the average and standard deviation values listed in these tables are significantly different. for this we performed an analysis using student t- and f-tests. these tests compute the probability  that two distributions have the same means and variances. these computations critically depend on the number of data points. it is also assumed that these points are independent. for molecular simulations trajectories the latter property can be questioned. to evaluate the effect of correlations between conformations along the trajectory we computed the same p-values with only one tenth of the points, that is, conformations separated by  <dig> ps corresponding to  <dig>  molecular dynamics steps. results of these computations are given in additional file  <dig>  fig. s <dig>  according to this analysis the observed differences in the means are always significant. for the variances the differences are most of the time significant except for the all-α model pairs st1-st <dig> and dt2-st <dig>  the all-β model pairs dt1b-st <dig> and dt1b-st <dig>  and the αβ model pair st2-st <dig> 

inspection of table  <dig> for trajectories at  <dig> k reveals a rough correlation between the model accuracy along the spectrum of models and the rmsd mean or the standard deviation . with the notable exception of dt <dig> models, the mean and standard deviation steadily increase when one goes from ns <dig> to dt <dig> models.

dt <dig> models do not behave as expected. their rmsd mean is close to the values of the st1- <dig> models. however their standard deviation is in the range observed for dt <dig> models, clearly above the standard deviations of st1- <dig> models. we will see that, for other criteria too, dt <dig> models display an anomalous behaviour. we will delay until the end of the result section the analysis of dt <dig> models to explain this unexpected behaviour.

performing simulations at different temperatures does not help in discriminating the different types of models. the rmsd mean and standard deviation increase with the temperature but approximately in the same proportion for all the models. only the all-β dt <dig> model exhibits the behaviour we were expecting. its rmsd mean increases by a factor of more than  <dig> and its standard deviation by a factor of  <dig> between  <dig> k and  <dig> k. these figures are clearly larger than those observed for other models.

analysis of conformation clusters
to further characterise the behaviour of the models along the trajectories we minimised the previous conformations in vacuum and clustered the resulting minimum conformations as described in the method section. in this way we seek to obtain a coarse estimate of the number of conformational space regions explored by the different models along the trajectories. table  <dig> shows the number of clusters for all models of the  <dig> classes as a function of the simulation temperature. cut-off values for the clustering procedure have been chosen such as to result in a single cluster for ns <dig> models at  <dig> k. the choice of single linkage to generate the clusters is deliberate. with this method, we expect all the conformations that are in the same potential energy valley to cluster together. even though some of them might be farther apart than the cut-off value, it should always be possible to find intermediate conformations that link them. on the contrary, when the system crosses a sufficiently high energy barrier  to reach a new potential energy valley it should be less likely to find such intermediate conformations and two clusters should be obtained .

results shown in table  <dig> allow a better discrimination between the different types of models than results presented in table  <dig> 

we observe the same general correlation between the spectrum of models and the number of clusters. dt <dig> models still behave as outliers but there exists a better contrast with respect to st1- <dig> models than previously . at  <dig> k ns <dig> and st1- <dig> models for classes all-α and αβ explore at most  <dig> clusters whereas dt <dig> models explore several tens. increasing the temperature, in particular in the all-β case, does improve the discrimination between the model types. for all-β dt1b and dt <dig> models, that are indistinguishable from ns <dig> and st1- <dig> models at  <dig> k, the number of explored clusters increases steadily with the temperature whilst it remains small for ns <dig> and st1- <dig> models. as previously, st <dig> models are intermediate between st1- <dig> and dt models although the all-α st <dig> model seems closer to dt models and the αβ st <dig> model to st1- <dig> models.

evolution of the secondary structure content along the trajectories
we monitored the secondary structures along the md trajectories for the different models. we used the gromacs tool do_dssp that encapsulates the secondary structure assignment program dssp  <cit> . this program assigns the secondary structures based on the existence of hydrogen bonds between backbone donor and acceptor atoms. since hydrogen bonds are relatively sensitive to atomic fluctuations we decided to calculate the secondary structures for minimised conformations along the trajectories. table  <dig> shows the fraction of residues that are part of a periodic secondary structure  in the initial conformation and that remain in this secondary structure for at least 95% of the minimized conformations along the trajectory.

percentage of residues having a periodic secondary structure  in the trajectory initial conformation that keep this secondary structure in 95% of the trajectory conformations. conformations along the trajectories have been minimised in vacuum.

the first point to stress is that α helices and β strands do not display the same stability  <cit> . considering ns <dig> models for the different classes, it appears that α helices are more persistent than β strands.

this property seems to have an impact on the relevance of the secondary structure as a criterion for discriminating the different types of models. for all-α models there is a good correlation between the percentage of secondary structures kept along the trajectory and the different types of models, even for the dt <dig> model that behaved as an outlier for the rmsd criteria we examined above. this is true for all temperatures. the secondary structure criterion allows a good distinction between dt and st models, including the st <dig> model that showed a tendency to behave as dt models with rmsd criteria.

for αβ models there is still a correlation between the percentage of conserved secondary structures and the type of models although this correlation becomes less regular when the temperature increases. it is more difficult to discriminate dt and st models.

for the all-β class, dt1b and dt <dig> models perturb the correlation. the case of the dt <dig> model appears surprising at first sight since it exhibits a higher fraction of conserved secondary structures than the native structure itself at  <dig> k. in this model the native sequence has been aligned with the all-α query structure. this confirms our previous observation that α helices appear to be more stable than β strands. let us note, however, that the ns <dig> model looses few secondary structures when the temperature increases unlike the dt <dig> model whose fraction of secondary structures is halved when the temperature is raised from  <dig> k to  <dig> k. for this class the secondary structure criterion is ineffective in discriminating the different types of models.

statistical score based on residue surface areas
the accessible surface area of the residues is an important parameter to characterise protein 3d structures. to quantify this parameter we defined an empirical score function based on the residue surface areas. this score function takes into consideration the so-called "polar satisfaction" of the polar residues and the "hydrophobic satisfaction" of hydrophobic residues. these two criteria are intended to account for the observed tendency of hydrophobic residues to be buried and polar residues to be in contact with the solvent or other polar residues. the method section briefly describes how this score function is calculated. we compute  <dig> types of scores. the first one is a global score for the whole protein, the second is a window score that is the mean of the scores in an 11-residue window centred on a residue of interest .

st =  <dig> is the score of the initial conformation; s¯ is the mean score averaged over trajectories, for different temperatures. scores in italic are beyond the value characteristic of the 1% confidence interval 

it is interesting to notice that md simulations, although the physics-based function they employ does not take into account the residue surface areas, systematically improve the global score for all the models with respect to the static models at t =  <dig>  in particular this allows the all-α and all-β st <dig> models and the αβ st <dig> model, that appear significantly different from a true structure when only the static initial conformation at t =  <dig> is considered, to be brought within the range of scores characteristic of real 3d structures. the improvement for ns <dig> models is, in general, less than the improvement observed for other models. the worst models show a tendency to exhibit the largest score improvements, although this is not systematic.

the global score allows the discrimination of the st1- <dig> models . st <dig> models behave as the dt models with this criterion. the scores of dt models are usually far below the 1% confidence threshold value . dt models are thus easy to detect.

figures  <dig>   <dig>   <dig> display the window scores for the same models. the horizontal black line is the value corresponding to the 1% confidence threshold for the window score . the black curves represent the window scores for the initial conformations, the three other curves the mean of the window scores at different temperatures. we observe that, except for ns <dig> models, all models display zones with window scores below the 1% confidence threshold. these zones of the models differ significantly from true 3d structure in terms of surface area of hydrophobic/hydrophilic residues. as expected, the number of peaks that cross the 1% confident threshold increases along the model spectrum. st <dig> models show few such peaks. for st <dig> models there are at least a couple of zones with very low scores. st <dig> models, visually, are difficult to distinguish from dt models. these observations, of course, are consistent with results shown in table  <dig>  the principal benefit of the window score over the global score is that it allows us to single out regions of the models that are likely wrong. we thus investigated further, for different models, those peaks that show a clear improvement of the initial conformation at t =  <dig> during the md trajectory.

to illustrate these investigations we describe in table  <dig> and figure  <dig> the case of the region centred at residue tyr  <dig> of the all-β dt1b model. this region corresponds to the second lowest peak, at position  <dig>  in fig.  <dig>  we chose this region because i) it exhibits a large improvement between the window score of the initial conformation and the mean value for the trajectories at  <dig> k and  <dig> k and ii) it is representative of what we observed for other such regions. table  <dig> shows the scores for the aforementioned region. both individual residue scores and window scores are shown. the first two lines correspond to the initial conformation, at t =  <dig> ps. the next two lines represent the same scores for a snapshot of the md trajectory at  <dig> k. the selected snapshot is the one for which the value of the individual score of tyr  <dig> is minimum. the last  <dig> lines once again display the same scores but this time for the residues in their native structure, for the purpose of comparison. residues in bold are those with individual scores less than - <dig> . their side-chains are shown in fig.  <dig> with a "liquorice" representation, other residues being displayed as thin lines and the trace of the backbone as a blue ribbon. oxygen atoms are coloured red, nitrogen atoms in dark blue and carbon atoms in cyan. fig. 8-a shows the reasons why these residues have such poor scores. hydrophobic residues: phe  <dig>  leu  <dig>  tyr  <dig> and tyr  <dig> point directly to the solvent. on the contrary, polar residues glu  <dig> and glu  <dig> are buried in the interior of the structure. notice that, although tyrosines have a polar oxygen, they are considered as hydrophobic residues in this analysis. the reason is that, in native 3d structures, their oxygen usually manages to point to the solvent or to interact with another polar atom whereas the rest of the side-chain remains buried among non polar atoms. fig. 8-b shows the same residues after  <dig> ps along the trajectory. the two glutamates now point toward the solvent and the hydrophobic residues show a tendency to be buried inside the 3d structure. tyr  <dig> succeeds in creating a hydrogen-bond with an acceptor atom inside the structure unlike tyr  <dig>  this might explain why tyr  <dig> side-chain is only partially buried. in the native 3d structure this region of the sequence, from phe  <dig> to leu  <dig>  corresponds to a β strand that is preceded and followed by turns. in the native structure glu  <dig> is buried inside the structure, which explains its unfavourable score of - <dig> . prior to this analysis we were wondering whether the score improvements we were observing in fig.  <dig> could also be due to the burial of exposed hydrophobic residues. indeed, it is easy to understand why buried polar atoms are brought toward the surface by md simulations. the energy potential includes explicit terms for electrostatics that favour the creation of hydrogen bonds or ionic interactions. on the other hand, no such explicit terms exist for the burial of non polar atoms. this burial is usually explained as the consequence of solvent entropic terms, i.e., the presence of non polar atoms in the solvent forces the water molecules to organise themselves around these atoms in a cage-like manner, which reduces their mobility and thus causes a decrease of the solvent entropy. to avoid this phenomenon, the solvent tends to expel non polar atoms from its bulk. it is thus very interesting to observe, as shown by the above analysis, that md simulations in explicit solvent are able to reproduce this behaviour to a reasonable extent.

residue window centred at tyr <dig>  ind score is the individual score for the residue; win. score is the window score, i.e., the mean of the individual scores in a window of  <dig> residues centred at the residue of interest. the first  <dig> lines, labelled t =  <dig>  correspond to the minimised initial conformation at t =  <dig> ps; the next  <dig> lines, labelled t =  <dig>  correspond to the minimised conformation along the md trajectory at  <dig> k that has the smallest value for the tyr  <dig> window score ; the last two lines, labelled query, correspond to the score values of the residues in their native structure for comparison purpose. residues in bold are shown in fig. 8

molecular dynamics simulations do improve the empirical scores, making the models more native-like, at least as far as residue surface areas are concerned. the question arises, therefore, of whether these simulations bring the models closer to the true native structure. figure  <dig> presents the tm-scores and the rmsd values of the models of the three classes with respect to the corresponding native structures, along the trajectories. this figure shows that no such thing happens. it is not really surprising for dt and st <dig> models that are very far form the true structure. for these models, getting closer to the true structure would imply large rearrangements of the polypeptide chain that are unlikely in  <dig> ns. however, for st <dig> and st <dig> models that are, presumably, in the basin of attraction of the native structure, md simulations have no effect either. as shown in fig.  <dig> above, the score improvement is usually due to localised rearrangements of the side-chains that do not affect much the polypeptide backbone conformation.

other criteria
we tried other criteria such as the fraction of side-chain contacts that are conserved along the trajectory or the radius of gyration of the molecules. these criteria proved to be not very efficient in discriminating between the different types of models .

gibbs free energies
for the sake of comparison with published works we computed the gibbs free energy  for the different models along the trajectories at  <dig> k. it is important to notice that we only computed the free energy of the macromolecule. the gibbs free energy is given by:

 g = u - ts + pv 

where u is the internal energy, t is the temperature, s is the entropy, p is the pressure and v is the volume. in the calculation of the gibbs free energy we omit terms whose contribution is the same for the different models. for instance, the internal energy includes the kinetic energy but since the temperature is fixed and models, for a given query sequence, have the same number of degrees of freedom the corresponding value is identical for all models. in a similar way, we assume that the pv term is very similar for all comparable models since there is no large change of volume involved, as this would be the case in a reaction producing gaseous compounds. we are, thus, only interested in terms that allow us to rank the different models of a given query sequence . column  <dig>  e¯ is similar to g* except that it is computed using the protein is similar to g term e <dig> instead of g0∗. the gibbs free energy is not computed for models for which the number of residues differs by more than a couple of residues from the query sequence length. all figures are in kj/mol.

for the intramolecular energy term, ns <dig> models are the only models to have an initial energy lower than the mean energy at  <dig> k. ns <dig> models are close to the native structure and thus they are supposed to have many favourable interactions. when we consider the energy of conformations along the trajectory we expect less favourable interactions to be generated due to the thermal fluctuations, thus leading to an energy value that is higher on average. however, other models show an opposite behaviour, the initial conformation has an energy higher than the mean energy. the initial conformation for these models is thus clearly not optimal in terms of the physics-based potential. ns <dig> models do not always have the lowest intramolecular energy, for instance the dt <dig> model for the all-α class and the dt1a model for the all-β class have a lower intramolecular energy.

on the other hand, for the solvent – protein interaction energy, all models, except the ns <dig> model of the αβ class, exhibit a lower energy for the initial conformation than for the mean energy along the trajectory, as expected. it must be noted that this term strongly favours the st <dig> and dt models over the ns <dig> model for the αβ class. for other classes this trend exists but is less pronounced. dominy and brooks  <cit>  using the charmm force field and a generalized born implicit solvation term found that misfolded states were favoured by the solvation term. they attributed this fact to the mispairing of favourable intramolecular ionic contacts.

the entropic term is proportional to the number of conformational states available to the system at a given temperature. we thus expect ns <dig> models to exhibit a smaller value for this term than dt <dig> models. we observe a reasonable correlation between the entropic term values and the range of models .

we computed two values of the gibbs free energy: g* forz which we use the mean intramolecular energy  along the trajectory and g0∗ for which we use the initial value of the intramolecular energy e <dig>  considering these two terms, we obtain very different pictures. for g0∗, there is a perfect correlation between the model spectrum and the free energy values for the all-α class and a reasonable correlation for the two other classes . on the contrary, for g* there is an anti-correlation for the all-β class, and to a lesser extent for the αβ class and no clear correlation for the all-α class. we note that g* provides a better approximation of the true free energy value than g0∗ since the intramolecular energy, and thus the internal energy, u, is much better estimated by the mean intramolecular potential energy along the trajectory than by a single minimised conformation. the good correlation observed between g0∗ and the spectrum of models for the three classes is accidental. it is essentially due to the fact that the initial conformation for the models, as described above, contains many constraints compared to the native structure. these constraints are relaxed during the md simulation. therefore the gibbs free energy, g*, computed for the macromolecule alone, does not appear to be an efficient criterion to discriminate the different types of models. since, in this calculation, we omit a very important term, the entropic contribution of the solvent, this is not very surprising .

analysis of the dt <dig> models
the unexpected behaviour of dt <dig> models that were supposed to act as controls at one extremity of the model spectrum  prompted us to analyse in detail these models for the all-α and all-β classes.

dt <dig> models are supposed to be worst than dt <dig> models because we just swapped the sequences without paying attention to the burial of charged residues or the exposure of non polar residues to the solvent. dt <dig> models, on the other hand, correspond to the first false positive in the ranked list of scores. the fold recognition algorithm provides the best score it can find and thus tends to avoid, as much as possible, such very unfavourable side-chain assignment. however, dt <dig> models unlike dt <dig> and st models, were aligned with 100% of the selected template structure. we did not need to model loop conformations with modeller. to analyse whether this point was crucial we built new dt <dig> models for the all-α and all-β classes with the same template structure except that, this time, the coverage was 86% . in practice we randomly chose  <dig> residues in the template structure loops and we left to modeller the task of building the conformation of these residues. these new models were then submitted to md simulations at different temperatures as previously described.

same data as in table  <dig> for new dt <dig> models.

for example, fig.  <dig> shows the differences in terms of the 3d structure between the initial all-α dt <dig> model  and the corresponding new model . the largest difference corresponds to the loop between the first  <dig> strands that is shown in the foreground of fig.  <dig>  in the template structure the loop is tight and there is a helix turn  that packs against the rest of the structure. in the new model the loop conformation provided by modeller is more extended and thus does not interact as closely with its counterpart in the template structure. when we monitor the trajectory for the new dt <dig> model we observe that the structure starts to unfold precisely at this point. the two first strands move apart from the other strands; they gradually unzip. this behaviour is not observed with the initial dt <dig> model, the helical turn remains firmly docked with the rest of the structure. a close inspection of the residues involved in the interface between these two portions of the 3d structure reveals that, just by chance, the interface consists of hydrophobic residues that are packed together.

for the all-β models the case is less striking. we let modeller generate the conformation of  <dig> residues in each of the  <dig> inner loops, i.e., the loops between  <dig> helices. the conformation of the modelled loops appears to be more floppy than the one of the real loops. this is confirmed during the md simulation since the modelled loops undergo large motions that lead, for one of the helices, to a tendency to unfold at both extremities . nevertheless, the helices, even though their local 3d structure is perturbed, remain docked together.

this experiment demonstrates that, although the fraction of the model backbone built by modeller is low, these zones constitute weak points in the structure. it also shows that favourable interactions, even scattered in the 3d structure, can be sufficient to stabilise the model conformation, at least for a while.

discussion
in this work we performed md simulations for different models and we monitored a number of structural properties along the corresponding trajectories to discriminate between correct and erroneous models. before starting this work we had in mind the following picture about the probable behaviour of the different models during the md simulations.

at one end of the model spectrum, for ns <dig> models, all side chains should pack nicely and, in general, most interactions should be favourable. observing the energy hyper-surface at low resolution, this corresponds to a relatively deep minimum that we call hereafter the basin of attraction of the native structure. at higher resolution, this basin of attraction contains many local minima that are sampled at a given temperature. at  <dig> k we expect the system to remain within this basin during the whole simulation. in terms of structural properties this implies that the global organisation of the structure is left unmodified. this has for consequences that the rmsd fluctuations are relatively small, no large perturbation of the secondary structures is observed and very few residues are found in an unfavourable environment, as measured by their residue surface area. in addition, since only the portion of the conformational space corresponding to the basin of attraction of the native structure is available to the system, all the conformations that are sampled during the simulations should cluster in a limited number of groups. as described in the result section, we can choose the clustering procedure such that only one group is obtained at  <dig> k.

at the other end, for dt models, since the sequences have been aligned with incorrect 3d structures, the packing of the side-chains should be far from optimal and a number of side-chains should be found in an unfavourable environment. we assume that the energy hyper-surface of such models is riddled with relatively shallow and broad minima that allow large fluctuations of the molecule. in the most favourable cases, we expect such models to hop from minimum to minimum and to gradually unfold during the simulations. therefore we anticipate that the rmsd values with respect to the initial conformations will exhibit large drifts. a noticeable fraction of the initial secondary structures should be lost. many residues should display low values of the empirical score based on the residue surface area. the number of conformation clusters should also be significantly larger, in agreement with the presence of many potential energy valleys easily reachable by the system.

between these two extremes, other models should exhibit intermediate behaviours, depending on their proximity to ns <dig> or dt <dig> models.

we performed the simulations at several temperatures. we ignore the height of the energy barriers that separate the different valleys. in particular, large rearrangements of the polypeptide chain might correspond to relatively high energy barriers. crossing such barriers is an event with a low probability of being observed in  <dig> ns. raising the temperature amplifies the fluctuations. in this way, we hoped, for dt models, to be able to overcome energy barriers and start unfolding parts of the models.

results presented above show that our view of the model behaviour was essentially correct.

as expected, the rmsd mean and standard deviation gradually increase from the ns <dig> models to the dt <dig> models . however it is difficult to draw a clear line between the behaviour of dt and st models. st <dig> models tend to behave more like other st models than dt models.

the number of clusters at  <dig> k would provide an excellent mean of discriminating st from dt models but for the all-β dt1a and dt <dig> models that exhibit an anomalous behaviour. raising the temperature at  <dig> k or  <dig> k solves this problem. this is one of the few cases where increasing the temperature is useful in these analyses. at  <dig> k st1- <dig> models have less than  <dig> clusters, dt models several tens or hundreds. st <dig> models are more difficult to classify, the all-α class st <dig> model behaving like a dt model and the one of the αβ class rather like a st model.

the usefulness of the secondary structure criterion to discriminate the models depends on the type of secondary structure. for models containing α helices there is a good correlation between the mean content in secondary structure and the spectrum of models. this is less clear for models containing β strands, in particular those of the all-β class. for this class the dt1a model and, once again, the dt <dig> model depart from the expected behaviour. here also, performing the simulations at  <dig> or  <dig> k clarifies the situation. the surface area of hydrophobic/hydrophilic residues, implemented as a satisfaction score, provides the most quantitative criterion for the discrimination of the models. using the threshold for the 1% confidence interval we are able to clearly distinguish st1- <dig> models  from dt models. with this criterion st <dig> models behave like dt models.

to summarise the above points, no single criterion is sufficient to distinguish st1- <dig> models from dt models in all cases. criteria such as the rmsd mean, rmsd standard deviation and clustering are subject to a few false positives, i.e., dt models behave like st models. the satisfaction score generates one false negative, e.g., the αβ st <dig> model is indistinguishable from dt models with this criterion. the clustering and satisfaction score provide more quantitative criteria than other structural features we considered in this study. if we consider conjointly all the criteria it is relatively straightforward to discriminate st1- <dig> from dt models, as shown in table  <dig>  most of the time, st <dig> models behave like dt models. therefore grossly misaligning a sequence with the correct template structure results in a model that is no better than models for which the sequence has been aligned with erroneous structures.

rmsd mean, rmsd uctuations, number of clusters along the trajectory, evolution of the secondary structures, hydrophobic and polar satisfaction score. the number of '+' symbolises the confidence in the criterion result. for instance the hydrophobic/polar satisfaction score provides a quantitative answer that is easy to interpret whereas results provided by the rmsd mean are more difficult to judge. the '-' indicates false positives or negatives.

running simulations at different temperatures did not prove very helpful, except possibly for the models of the all-β class for which, in a couple of occasions concerning the clustering and secondary structure criteria, it contributed to a better discrimination of the dt and st models. moreover, it is likely that  <dig> k is too high a temperature for running meaningful md simulations.

although the simulations were able to improve the surface area of hydrophobic/hydrophilic residues, making the side chains more native-like, we did not observe any improvement of the st1- <dig> model backbones in terms of rmsd values, that is, the model main chains did not become any closer to the native structure main chains. md simulations in explicit solvent using rosetta decoys as models  <cit>  showed that such improvements can sometimes be observed on a 10– <dig> ns time scale. in this study the simulation time corresponds to the lower end of this interval which might explain, in part, why we do not witness any backbone improvement. other works, using monte carlo simulations  <cit>  or just simple minimisations  <cit> , did succeed in improving the ranking of good models and, sometimes, in refining the conformation of "low" resolution 3d structures  <cit> . in our case our "good" models are relatively far from the native structures . it is likely that this sort of "low" resolution models need more than  <dig> ns to be significantly ameliorated.

computations of the gibbs free energy did not help us in discriminating correct from erroneous models. other studies arrived at a different conclusion, based on the analysis of a single minimized conformation using molecular mechanics energy functions complemented with different ways of computing solvation terms.

as observed in table  <dig>  there is a large, favourable, intramolecular energy gap between the initial conformation of the ns <dig> models and all other models for the three classes. this is, no doubt, due to the fact that, even though the initial conformations have been minimized using the physics-based energy potential, there remains many constraints in the models that were not built from the native structure. this is the reason why, as described in the result section, the mean intramolecular energy for ns <dig> models is higher than the initial conformation energy whereas the opposite is true for all other models. however, during the md simulations, the systems have enough time to relax and to improve their conformations. as a result, the gap between the mean intramolecular energies for the ns <dig> models and other models narrows, blurring the different between the different models. this point is clearly highlighted by our computation of the free energy  using the initial intramolecular potential energy, e <dig>  instead of the more correct mean intramolecular potential energy, e¯, along the md trajectory. considering g0∗ instead of g* we have quite a good correlation, albeit fortuitous, between the free energy values and the model spectra.

in addition, the protein-solvent energy shows a tendency to favour the misfolded states. this fact has already been pointed out by dominy and brooks  <cit> . in this study, this is particularly pronounced for models of the αβ class. the contribution of this energy term to the gibbs free energy is important since, on average, it is about three times larger than the corresponding intramolecular energy term.

as expected, the entropic energy term favours, to a large extent, dt models but the difference between these models and ns <dig> models is small, since all models correspond to folded, compact, conformations. therefore this leads us to the apparently paradoxical situation where the more correctly computed gibbs free energy g* appears to be anti-correlated with the range of models for the all-β and αβ classes, and not correlated for the all-α class. this problem is mostly due to the protein-solvent interaction.

in fact we know that the whole system, protein plus solvent, should be taken into account in the free energy calculations. in particular, as described in the result section, it appears crucial to include the solvent entropic contribution to obtain consistent gibbs free energy values. however computing this term, when an explicit solvent is employed, is difficult since we cannot use the methodology we adopted for the protein . using an implicit solvent model and computing the corresponding solvation free energy might be a solution. however, we would like to draw attention to the fact that, in order to compute the intramolecular energy of the protein one should not consider only the initial conformation obtained with a modelling program but should use the mean of this energy along the md trajectory.

CONCLUSIONS
the principal question we wanted to answer with this work was: can we discriminate correct from erroneous models by monitoring the behaviour of structural properties along the md trajectories? this constitutes more than a rhetorical question for us since we wish to apply this technique to a number of models built from the alignments we obtain with our fold recognition method, frost. for some of these alignments whose score lies in the frost twilight zone we cannot be sure whether we have aligned the sequence with the correct template structure or not. results obtained in this study show that, although no single criterion is 100% efficient in this task, considering them in combination, as shown in table  <dig>  allows us to readily discriminate the two types of models. another question we had, concerning the possibility of detecting zones of the model corresponding to local misalignments of the sequence onto a correct template, mostly received a negative answer. when the alignment contains severe errors the resulting model cannot be distinguished from plain erroneous models. we were surprised to observe that the difference of behaviour during the simulations between the st and dt models was more gradual than we expected. before undertaking this study we thought that it would be easier to witness the unfolding of dt models on a  <dig> ns time scale than it proved to be.

we must stress that, although we did our best to analyse several types of proteins with various secondary structure contents, e.g., all-α, all-β and αβ domains, the conclusions we draw from this study are based on a limited set of examples. further work is needed to confirm the trends we identified here. another important point to underline is the fact that these conclusions are dependent on the modelling program and, to a lesser extent, the md simulation protocol used. we employed modeller to build the models. this program provides good models with reasonable native-like structural features except, maybe, for some of the loop conformations. using another, less efficient, modelling program might have changed the conclusions. this fact must be kept in mind when one is comparing different studies about the stability, or the energy, of models.

our aim, when performing these simulations on models, is not so much to verify that the models are reasonable in terms of structural properties as to check whether our fold recognition method has been able to identify correctly the template structure. we are interested in microbial genome annotation  <cit> . homology search methods constitute the cornerstone of the annotation process. unfortunately, methods based on sequence comparison are no longer efficient when the similarity is below 20% sequence identity, leaving between  <dig> to 50% "orphan" coding sequences , depending on the organism analysed. fold recognition techniques can detect remote homologs, having less than 20% sequence identity, allowing us to obtain a crucial piece of information about these orphan cdss. therefore the md simulations we described in this study are a means for us to improve the sensitivity and specificity of our fold recognition method for ambiguous cases, i.e., when the corresponding scores are within the twilight zone.

to conclude with a practical consideration, we give an order of magnitude of the amount of time required for testing one model. for an all-α model, the system, protein plus solvent, is made of about  <dig>  atoms. we have available a cluster of  <dig> bi-processors dual core x <dig>  <dig> at  <dig>  ghz . using the  <dig> cpus of a blade in parallel we are able to simulate  <dig> ns a day . although not exactly a routine calculation, this allows us, to run an  <dig> ns md simulation for a model of this size, overnight, employing  <dig> blades. the analysis of the trajectories, due to the minimisation of the conformations, requires about the same amount of time. a way of speeding up the simulations would be to use an implicit representation of the solvent instead of the explicit representation we used in this study. this would have the additional merit of allowing us to compute the solvation free energy.

