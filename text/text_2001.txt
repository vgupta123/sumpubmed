BACKGROUND
escherichia coli is a gram negative bacterium that is commonly found in the lower intestine of warm-blooded organisms. most e. coli strains are harmless. as such, commensal strains of e. coli are part of the normal microbiota of the lower gastrointestinal tract , benefitting their hosts by producing vitamin k <dig> and also by preventing the establishment of pathogenic bacteria within the intestine through a "colonization barrier effect". yet some strains can cause infections in humans. six major categories of diarrheagenic e. coli exist: enterotoxigenic e. coli , enteroinvasive e. coli , enteropathogenic e. coli , enterohemorrhagic e. coli , enteroaggregative e. coli , and diffusely adherent e. coli . furthermore various types of extraintestinal pathogenic e. coli  are known to cause infections outside the gastrointestinal tract; namely uropathogenic e. coli  and newborn meningitis-associated e. coli .

e. coli o157:h <dig>  an ehec pathotype, was first recognized as a human pathogen in  <dig>  <cit> . it has emerged as a major enteric pathogen capable of causing outbreaks of food poisoning in humans and often responsible for costly food product recalls. the primary clinical manifestation of an e. coli o157:h <dig> infection is hematic diarrhea that can progress into more severe sequelae of hemolytic-uremic syndrome and thrombocytopenic thrombotic purpura, which then can lead to renal failure and death  <cit> . an estimated  <dig>  cases of e. coli o157:h <dig> infections occur annually in the united states, making it the principal serotype of enterohemorrhagic e. coli isolated from patients  <cit> . infections with this serotype usually have a food borne etiology. in  <dig>  for example, three multi-state and  <dig> single-state foodborne outbreaks were confirmed to be due to e. coli o157:h <dig>  <cit> .

the extent of genomic diversity existing in e. coli and other microbial pathogen populations has been the subject of debate. recent studies including several genomic methods like dna microarrays, optical mapping, and whole genome sequencing have shed new light on the level of diversity within bacterial populations, making it clear that the level of genomic diversity had been grossly underestimated previously  <cit> . a comprehensive sampling of this diverse species, however, has not been addressed in any single study using an advanced whole-genome analysis method such as microarray analysis.

previous microarray studies have been limited to sampling a relatively small and/or undiverse collection of e. coli strains. moreover, traditional microarrays used in these studies have had limited gene content and typically utilize a single probe for determining whether a gene is present or absent within a given strain  <cit> . this makes gene detection calls questionable and absolutely requires the inclusion of a reference strain for making accurate gene calls.

current array technology allows the design of microarrays containing greater than six million features. arrays thus can be designed to probe the genomes of multiple organisms, a prerequisite of great value to an investigator who may study closely related strains or species. however, a caveat in multiple genome array design is that it is not often possible, nor desirable, to define unique probes that match every gene target with 100% sequence homology. it is therefore necessary to establish a consensus sequence for allelic variants. when a consensus sequence is represented on the array, consideration of the level of sequence homology of a particular target sequence is important to accurately determine the status of that gene following a hybridization experiment.

the affymetrix genechip® e. coli genome  <dig>  array represents the genic and intergenic sequences of four sequenced strains of e. coli: enterohemorrhagic  o157:h <dig> strains edl <dig> and sakai, the uropathogenic  o6:h1:k <dig> strain cft <dig>  and the laboratory attenuated k <dig> strain mg <dig>   <cit> . the array consists of  <dig>  25-mer oligonucleotides that represent a total of  <dig>  probe sets. each probe set contains approximately  <dig> oligonucleotide probes;  <dig> perfect match  probes and  <dig> mismatch probes . mismatch probes are identical to the perfect match probe with the exception of a one nucleotide  mismatch located at the 13th  position of the oligo sequence. these mismatch probes are designed to allow for an approximation, and correction, of non-specific hybridization signal. we presumed that a probe design strategy such as this would be ideally suited for genotyping studies for two reasons: i) the probe redundancy for each genomic target sequence and ii) the excellent specificity afforded by hybridization of short 25-mer probes. previous microarray studies have used either long oligos  or pcr-derived cdna amplicons. inherent to these array designs are the disadvantages that i) only a single probe signal is used to measure the presence of each genomic target and ii) relatively high non-specific hybridization signal is observed when using longer dna probes  <cit> .

in this study, we used the affymetrix genechip® e. coli genome  <dig>  array to investigate the gene content of  <dig> diverse isolates of e. coli and shigella. this multi-genome array provided us the opportunity to survey genes from different pathogen groups  <cit> . strains of e. coli and shigella interrogated in this study consist of approximately  <dig> different serotypes and  <dig> isolates of the o157:h <dig> serotype . moreover, the entire ecor collection  <cit>  was included in this study and contains a set of  <dig> reference strains isolated from a variety of hosts and geographical locations that is presumed to represent the range of phenotypic and genotypic variation in the e. coli species as a whole. finally, four sequenced strains of shigella, believed to be in the same species division as e. coli, were included in this study. in summary, this strain collection was chosen both to i) represent the global diversity of e. coli and ii) to capture a diverse collection of a single pathogen type . in doing so, we were able to not only evaluate the ability of this array to measure the global genomic diversity of this species, but also to assess whether this array was useful for discriminating among individual, and closely related, strains of the same pathogen type. the latter is an important feature for the newly emerging fields of microbial forensics and molecular epidemiology, where the ability to uniquely identify and discriminate among closely related strains is of great importance in conducting attribution investigations of foodborne outbreaks or of covert biocrimes and potential bioterrorism activities  <cit> .

when a strain history is unknown, we used a "na" designation.

the probe set design utilized in this expression array allowed highly accurate determination of a gene allele presence. these data, combined with a unique custom analysis approach, eliminate the need of a reference strain, which previously has been an absolute requirement for accurate comparative genomic hybridization  studies. the comprehensive wealth of data derived from this study has been used to identify groups of genes that define a particular pathogen type. the use of this microarray approach, combined with the large sampling size, gives insight to global e. coli diversity on a previously unexplored scale.

methods
bacterial strains and preparation of genomic dna
strains of e. coli and shigella used in this study are listed in table  <dig>  strains edl <dig>  mg <dig>  and cft <dig> are e. coli o157:h <dig>  k- <dig>  and uropathogenic strains, respectively, for which the genome sequences are available  <cit> . sakai is a japanese enterohemorrhagic o157:h <dig> outbreak strain, and likewise the genome sequence is available  <cit> .

strains were grown overnight in  <dig> mls of luria broth at 37°c in a shaking incubator. genomic dna was isolated from  <dig> mls of the overnight culture using the qiagen dneasy tissue kit following the manufacturer's recommendations. typically, 5- <dig> μg of purified genomic dna was recovered in a final elution volume of  <dig> μl. the purified dna was further concentrated using microcon ym- <dig> microcentrifuge filters to a final volume of approximately  <dig> μl.  <dig> μg of the genomic dna was fragmented by incubating at 37°c for  <dig> minutes in a  <dig> μl reaction containing 1x one-phor-all plus buffer  and  <dig>  units dnase i . the fragmentation reaction was heat-inactivated at 95°c for  <dig> minutes. following fragmentation, the dna was 3'-end labeled by adding  <dig> μl of 5x terminal transferase buffer ,  <dig> μl of  <dig> mm biotin-11-ddatp , and  <dig> μl  of terminal transferase enzyme  . labeling was carried out for at least  <dig> hours at 37°c followed by heat inactivation at 95°c for  <dig> minutes.

array hybridization, washing, staining, and scanning
hybridizations were performed according to the affymetrix genechip expression analysis technical manual for the  <dig> format array  <cit> . briefly,  <dig> μl hybridizations containing  <dig> μg of fragmented/labeled dna,  <dig> mm mes,  <dig> m ,  <dig> mm edta,  <dig> % tween- <dig>   <dig> pm control oligo b <dig>   <dig>  mg/ml salmon sperm dna ,  <dig> % dmso , and  <dig>  mg/ml bsa  were hybridized onto the affymetrix genechip® e. coli genome  <dig>  array, incubated at 45°c, with rotation  for  <dig> hours in a hybridization oven.

following hybridization, the wash and stain procedure was carried out on an affymetrix fs- <dig> fluidics station using the mini_prok2v1_ <dig> fluidics script  <cit> . wash and stain reagents were prepared according to the genechip® expression analysis technical manual  <cit> . the following exceptions were made to the wash and stain procedure: streptavidin solution mix  was replaced with sape solution mix. arrays were scanned using a genechip® scanner  <dig> 7g running gcos v <dig>  software.

analysis considerations for genotyping with the affymetrix e. coli  <dig>  array
adapting an expression array for genotyping purposes required a novel data analysis approach, given that the use of the affymetrix probe set design produces  <dig> independent measurements for each genome target. these  <dig> measurements are derived from a single probe set, consisting of  <dig> probe pairs. each probe pair is composed of a single 25-mer perfect match  oligo and its corresponding 25-mer mismatch  oligo. the mismatch oligo is identical to the perfect match with the exception of a single nucleotide mismatch located at the central  position of the oligo sequence. therefore summarizing these independent measurements into a single probe set intensity value that is indicative of the status of a particular gene can be problematic. this can be further complicated when one or more of the individual probes  in a probe set is able to hybridize to another genomic region, thereby giving rise to a "partially specific" probe set. secondly, the affymetrix array is a multi-genome array. previous cgh studies have required a reference strain in order to accurately detect whether a particular gene target was present/absent. for a multigenome array, however, it is not possible to use data from any single hybridization experiment as a reference data set. therefore the status of each gene target should, ideally, be determined by considering only raw probe intensities from an individual experiment.

parsing cel files and data analysis tools
all  <dig> affymetrix cel files generated in this study were parsed using the robust multiarray averaging  method   <cit> . hierarchical clustering analysis and principal component analysis was done using spotfire and the made <dig> package of bioconductor  <cit> . mas  <dig>  gene present/absent calls were determined using affymetrix power tools as well as the affy bioconductor package  <cit> . all data files, including  <dig> affymetrix cel files, the rma-summarized probe set intensities, and the mas  <dig>  gene present/absent calls, can be accessed at http://www.mrscentral.com

probe set summarization methods
it is desirable to determine the summarized intensity of each probe set . in all of our analyses, summarized probe set intensities were calculated for each strain by using the robust multiarray averaging   <cit>  method as implemented in the affy package of bioconductor or affy power tools. in brief, rma summarization of probe level data is done by performing three individual treatments on all of the experimental cel data simultaneously. first, probe specific correction of the pm probes is done using a model based on the observed intensities being the sum of signal and noise. secondly, quantile normalization is performed on the corrected pm probe intensities. finally, a median polishing algorithm is used to summarize the background-corrected, normalized probe intensities to generate a final probe set value.

we also evaluated the utility of the mas  <dig>  probe set summarization algorithm  <cit> . briefly, the signal is calculated as follows: i) global background correction, ii) ideal mm value is calculated and subtracted to adjust the pm intensity, iii) adjusted pm intensities are log-transformed to stabilize the variance, iv) biweight estimation to provide a robust mean of the resulting values, and finally v) probe set intensity signal is scaled using a trimmed mean.

making accurate gene present/absent calls
in addition to summarizing probe set intensities, it is also desirable to make absolute gene present/absent calls. we assessed two novel methods for determining the status of each gene using the hybridization intensities from the four e. coli strains that are represented on this array. the first method was included in the standard affymetrix gcos analysis package and is referred to as the mas  <dig>  gene detection approach  <cit> . here gene targets are determined to be either present, absent, or marginal as determined by a p-value calculated from the discrimination score  for each probe pair. the discrimination score is a basic property of a probe pair that describes its ability to detect its intended target. it measures the target-specific intensity difference of the probe pair  relative to its overall hybridization intensity . the discrimination score  is therefore defined as:  and approaches  <dig>  as the mismatch probe intensity approaches  <dig> 

the next step in calculating a detection p-value is to compare each discrimination score to the user-definable threshold tau. tau is a small positive number that can be adjusted to increase or decrease sensitivity and/or specificity of the analysis.

increasing the threshold tau can reduce the number of false positive  calls but may also reduce the number of true present calls. we found that the most accurate gene detection calls were made when using a tau value of  <dig> . next, the one-sided wilcoxon signed rank test is employed to generate the detection p-value. it assigns each probe pair a rank based on how far the probe pair discrimination score is from tau. the detection p-value is then compared to a user-definable cutoff value that results in the final present/absent call for each gene. here again, we evaluated several cut-off values for the detection p-value and found that a value of  <dig>  provided highly accurate gene detection calls. that is, probe sets with detection p-values < <dig>  were scored as "present", and greater than, or equal to,  <dig>  as "absent".

the second method that we used for determining the status of a particular gene target is analogous to the more conventional methods of cgh where a reference strain is used to determine relative hybridization intensities. here, we calculated a "refmax" value for each probe set by determining the maximum hybridization intensity  from each of the four reference strains represented on the array. therefore, "refmax" represents the maximum observed hybridization intensity for each probe set as determined by the appropriate reference strain to which the probe set was designed ). absolute probe set intensities for each of the  <dig> hybridization experiments performed were compared to the refmax data. for strain i, probe set j, refmax ratio is defined as:  

for each probe set, gene targets were scored as "absent" if their hybridization intensities were greater than 4-fold lower from the refmax value. otherwise, genes were scored as "present".

phylogenetic analysis of e. coli genome data
tables containing  <dig>  mas  <dig>  present/absent calls  were transformed into a/t binary nucleotide calls for each isolate. tables were then wrapped/concatenated into fasta-formatted text files. fasta text files were then used directly as input for the mega <dig> software package  <cit> . phylogenetic analysis was performed using the maximum likelihood method.

RESULTS
in the present study, we interrogated the genomic content of  <dig> isolates of e. coli and shigella using the affymetrix genechip® e. coli genome  <dig>  array, choosing to explore both the level of diversity that existed among closely related strains of the same pathotypes  and the level of genomic diversity that existed among a globally diverse collection of e. coli strains . from this analysis, we were able to determine, with high accuracy, the gene content of each of these strains relative to those probes represented on the array.

probe set summarization methods: rma vs. mas  <dig> 
in figure  <dig>  we demonstrate the advantage of using rma over mas  <dig>  by comparing summarized probe set intensities from the two reference o157:h <dig> strains, edl <dig> and sakai. from the scatter plots in figure  <dig>  it is apparent that the rma probe summarization method  yields a much lower variance in probe sets where intensities are less than  <dig>  as compared to mas  <dig>  probe set summarization method . this decrease in variance allows for a more accurate determination of actual gene differences between these two strains. this is even more apparent when relative probe intensities  are plotted. summarized probe set intensities from the mas  <dig>  method result in large fold-change differences , suggesting, incorrectly, the presence of genomic differences at these loci . however, rma's ability to reduce this variability  provides a much higher confidence in accurately identifying true genomic differences . because we feel that rma is a better method for summarizing probe set intensities, we performed all downstream analyses  using rma summarized probe set intensity data.

determining the status of gene targets: refmax vs. mas  <dig> 
using refmax we found that > <dig> %  of the target genes that shared >98% sequence homology to a particular probe set were accurately detected as "present" as shown in table  <dig>  also, 64% of the genes sharing 96%-98% sequence homology are called "present" and when homology decreases to between 94%-96%, only 27% of the probe targets are called "present". here we are not always attempting to score these present/absent calls as either "correct" or "incorrect" but rather simply report our finding that the probe set design used here is capable of discriminating among closely related genes sharing >90% sequence homology  <cit> . also shown in table  <dig>  using mas  <dig> ,  <dig> % of the probe sets having >98% homology to their target gene were scored correctly as "present". further, 55% of the probe sets having between 96%-98% sequence homology to their gene target were called as "present". in comparison to the mas  <dig>  method, the refmax method is more sensitive to sequence variation between the probe set and its gene target. this clearly can be seen when sequence homologies between probe sets and gene targets are relatively low . in these instances, the mas  <dig>  method called  <dig> % of the gene targets as "present" whereas our refmax method only called  <dig> % of these gene targets as "present". furthermore, a clear advantage of using the mas  <dig>  method for scoring genes was its ability to accurately call genes as being "present" regardless of the overall probe intensities. for example, in three instances, where gene target lengths were below  <dig> nt and corresponding probe set intensities were in the bottom 2% of all probe set intensities on the array, the affymetrix mas  <dig>  method correctly predicted the status of these gene targets in each of the reference strains a total of  <dig> out of  <dig> times. this corresponds to an accuracy of 90%  for probe sets having intensities in the bottom 2% of all probe sets.

gene present/absent calls were determined for the  <dig> sequenced reference strains represented on the array using either the refmax or mas  <dig>  gene detection methods. genome corresponds to the accession number of the genome/strain being interrogated. homology bin corresponds to the percentage by which a probe set consensus sequence matches the target genome sequence. genes present corresponds to the number of genes present on the array which fall into a particular homology bin . present or absent calls were determined from either the mas  <dig>  or refmax method and are shown under the "mas5" and "refmax" headings. strains mg <dig>  edl <dig>  and sakai were each performed in duplicate to show the reproducibility of each method. independent measurements are indicated by a "/" under the present and absent headers.

while having the advantage of being able to detect genes correctly despite sometimes having low absolute probe intensities, the mas  <dig>  method was found to be only 95% reproducible when comparing replicate experiments of a single reference strain. when "absent" and "marginal" calls were not considered separately, however, this reproducibility increased to 97%  . when examining the reproducibility of our refmax method, we observed that well over  <dig> % of all gene status calls from replicate experiments agreed. this level of reproducibility was based on whether at least a 4-fold difference was observed for any probe set from replicate experiments. the lack of reproducibility in the mas  <dig>  method appears to be a function of the level of gene homology and not necessarily absolute probe signal, whereas our refmax method was independent of either of these factors.

when using our refmax method for making gene status calls, it is necessary to apply a user-defined cut-off value for refmax in order to account for probe sets that are present on the e. coli v <dig>  array, yet absent in all four of the reference strains represented on this array. we have observed a total of  <dig> probe sets on this e. coli  <dig>  array which do not appear to have target genes present in any of the four reference strains. this was confirmed by blasting these probe set sequences against the reference genome sequences. as expected, the refmax intensity was found to be in the lower  <dig> % of all probe intensities which suggests an "absent" gene target. of these  <dig> probe sets,  <dig> corresponded to affymetrix control probes . the remaining  <dig> probe sets corresponded to genes encoded by various phages, transposons, plasmids as well as several known antibiotic resistance genes. these probe sets were included by affymetrix due to their relevance to microbial pathogens. therefore, refmax values whose absolute probe set intensities were <  <dig> were considered to be absent in the reference strains. we therefore scored all probe sets from non-reference strains that differed by less than 4-fold from refmax as "absent". only when a non-reference strain was found to have an absolute probe set intensity 4-fold greater than the refmax value were these genes scored as "present".

likewise, one can use the mas  <dig>  technique described above to make present/absent calls. upon doing so, we found that among the four reference strains, there were a total of  <dig> probe sets that were consistently called absent. of these  <dig> probe sets,  <dig> corresponded to affymetrix control probe sequences, leaving  <dig> other  probe sets. one can then expand this analysis from the four reference strains to all  <dig> isolates analyzed in this study. upon doing so, we found  <dig>  probe sets that were consistently absent in all  <dig> e. coli and shigella isolates examined in this study. again, these genes were mainly antibiotic resistance elements from species other than e. coli or shigella. two notable exceptions were nine independent probe sets targeting phage m <dig> genes as well as the edl <dig> gene z <dig> .

as an additional confirmatory method, we compared our mas  <dig>  gene present/absent calls with those determined by confirmatory pcr. the stx <dig> and stx <dig> genes were chosen as targets. we interrogated  <dig> isolates for the presence of these two genes by confirmatory pcr. we found an agreement between present/absent calls in 193/ <dig> cases . the two discrepancies are thought to be due to primer/probe specificity towards different stx alleles .

discussion
strain attribution, identification, and discrimination within the o157:h <dig> pathotype
the genomic content of  <dig> unique strains  of e. coli o157:h <dig> was assessed in order to determine whether we could accurately distinguish between independent isolates of the same serotype. from this study, we found that, on average, individual strains of o157:h <dig> differed by  <dig> gene targets . moreover, among this same group of isolates, we found that a maximum of approximately  <dig> gene targets differed among any two independent o157:h <dig> isolates . when individual strains were examined in replicate, we found that a maximum of three gene target differences may occur between replicates. note, however, that these "replicates" could often be independent isolates of the same strain and the observed gene differences may sometimes be due to known deletions that are present in strains that were derived from a parent strain . next we tested if any of our independent isolates were indistinguishable using this array-based method, i.e., were there multiple isolates of the same strain. we found several instances where there were fewer than  <dig> gene target differences between two independent isolates . in fact, we were able to make correlations between isolates that were previously unknown and presumed to be independent. for example, strain 86- <dig>  differed from strain ec <dig> by a single gene difference. upon further inspection of the history of these strain designations, we found that ec <dig> was also a human isolate from washington state, also obtained in  <dig>  it is therefore likely that these two isolate designations actually refer to the same strain that were received by our laboratory from two different repositories. this precipitated a closer examination of the history of our strain collection, which showed a few similar examples of this. from a forensic perspective, this is a very important finding as it suggests that this array-based method is not only a powerful tool for discriminating among different strains of the same serovar but also provides, with a high level of confidence, a robust means for strain identification and attribution.

exploring the global genomic diversity of e. coli
the ecor collection is a set of  <dig> reference strains of e. coli isolated from a variety of hosts and geographical locations  <cit> . it was established for use in studies of variation and genetic structure in natural populations and is representative of the range of phenotypic variation in the species as a whole. we therefore used this well-studied collection to analyze the performance of our array-based method in measuring the global diversity of e. coli. among this collection, we found that individual strains differed, on average, by approximately  <dig> gene target differences. moreover, a maximum of  <dig> gene target differences was observed between any two strains . this represents approximately 40% of the probe targets present on this array. in addition to the ecor reference collection and our o157:h <dig> reference collection, we included  <dig> other e. coli and shigella isolates in our analysis . it is interesting to note that some of the most diverse strains included in this study were among the latter non-ecor, non-o <dig> strains. for example, the greatest number of probe set differences,  <dig>  was observed between an o157:h <dig> strain ec <dig> and the upec cft <dig> strain ec <dig>  while this number may seem impossibly high, it is in fact representative of gene differences and allelic differences that exist between these two evolutionarily distinct lineages of e. coli. different alleles are often represented by different probe sets on the e. coli genome  <dig>  array. therefore, probe set differences do not always directly correspond to true gene differences. a gene differences matrix was prepared by calculating the number of gene differences that exists among all  <dig> isolates examined in this study . similarly, we performed a pearson correlation analysis on all of the strains included in this study based on their rma probe set summarized values. results from this analysis depict a strain-to-strain relatedness quantified from  <dig> to  <dig> . a visual representation of this correlation matrix is shown in additional file  <dig> and is color-coded based on relatedness.

in order to better understand the global diversity of e. coli, we performed several cluster-based analyses. using the rma-summarized data generated from all of the probe sets, we performed a hierarchical clustering analysis  on the strains and gene targets to demonstrate graphically the level of genomic diversity that exists within this species . the dendrogram in additional file  <dig> shows that the  <dig> isolates examined in this study cluster into three major groups. the first cluster  represents ehec <dig> strains. the other two clusters cannot be clearly defined by a particular set of traits and contain an assortment of both serotypes and pathotypes.

to further demonstrate the relatedness and diversity of the strains examined in this study, we performed a principal component analysis  on rma-summarized probe set intensities from all  <dig> isolates. upon plotting the first three dimensions of the pca data, we color-coded the strain identifiers based on their serotype . from this, we observed that strains belonging to the same serotype often, but not always, cluster together. it is worth noting that all serotypes are not equally represented in the collection of isolates that were examined in the current study, therefore it is not possible to make conclusions regarding the clustering of some serotypes. as pathotype information was available for  <dig> of our isolates, a pca was performed on these isolates independently . this pca plot showed strong clustering of isolates from the ehec <dig> and ehec <dig> pathotypes. though these pathotypes have similar clinical manifestations, their genomes are quite distinct. while some strain of the same pathotype often co-clustered, this was not universally true, therefore suggesting that virulence traits are inherited horizontally. indeed, this phenomenon has been reported previously  <cit> .

examining the conserved, core, backbone genes of e. coli
our array-based technique is well suited for determining which genes are conserved in various types of e. coli. initially, we wanted to determine which gene targets were present in all strains of e. coli and shigella included in this study. we found  <dig> gene targets, using the mas  <dig>  technique described above, that were consistently present in all  <dig> isolates examined . we define these gene targets as being the core/conserved genic regions that make up the e. coli genomic backbone. similar analyses have been performed previously on whole genome sequence data  <cit> . from these in silico analyses, approximately  <dig> conserved core genes were identified. therefore, previous in silico analyses correlate well with our microarray-based approach.

moreover, because the affymetrix genechip® e. coli genome  <dig>  array represents intergenic regions from the mg <dig> genome, we were also able to assess the conserved intergenic regions as well. in total, there are  <dig> unique probe sets representing  <dig>  kb of intergenic sequences . of these, we found  <dig> unique probe sets that were conserved  in all  <dig> isolates analyzed. these  <dig> probe sets represent  <dig>  kb of conserved intergenic sequences. assuming an average genome size of  <dig> mb, this suggests that strains of e. coli share approximately  <dig> % of conserved intergenic sequences.

defining the ehec pathotype-specific genes
because we examined a large number  of o157:h <dig> strains and a large number of non-o157:h <dig> strains, we are also able to make conclusions on which genes are responsible for defining the o157:h <dig> serotype. that is, which genes are always present in o157:h <dig> strains but never present in non-o157:h <dig> strains. for this analysis, we included only o157:h <dig> strains and excluded o157:h- and "o157"  strains. as might be expected, most genes fitting this criterion engender information for the biosynthesis of the o and h antigens .

using the mas  <dig>  gene detection method, we filtered those probe sets that were consistently called "present" in all o157:h <dig> strains yet were called "absent" in all non-o157:h <dig> strains. the  <dig> probe sets shown here correspond to o157:h7-specific genes.

phylogenetic analysis of e. coli genomes using microarray data
extant populations of e. coli are structured into main phylogenetic groupings. the evolutionary history of e. coli has usually been recapitulated employing multi locus sequence typing  analysis of the ecor collection. however, it has been shown that a correlation exists between the phylogenetic history of the strains and the presence/absence of genes. we compared our whole-genome microarray analysis approach to the main phylogenetic groups of the ecor collection previously defined and based on mlst data. for the most part, our whole genome analysis of the ecor collection correlated well with previous designated phylogenetic groups as shown in figure  <dig>  there were, however, several notable exceptions. for example, strains ecor <dig>  ecor <dig>  and ecor <dig> that were previously defined in group b <dig> were, by our analysis, found to be part of group a . and, notably, as with mlst, array analysis showed group d strains to be more heterogeneous than other groupings, seemingly reflecting diverse and distinct lineages of group d strains.

one might a priori expect disagreement between our whole-genome approach and previous mlst analyses. that is, whereas mlst is an approximation of the mutation rate of the genomic backbone based on sequence analysis of a relatively small number of housekeeping genes, analysis of whole genome differences is a measure of both the rate of mutation and horizontal gene transfer that exists among this species. these two analyses are quite different and distinct. so it is therefore interesting to find such a remarkably high level of correlation between these two different approaches.

CONCLUSIONS
the current study is an in depth analysis of the genomic content of a large and diverse collection of e. coli strains, including strains of the closely related genus shigella. by utilizing a high-density oligo array representing  <dig>  unique probe sets, we were able to qualitatively describe the complete gene repertoire of each of  <dig> unique strains. in so doing, we found that diverse strains can differ by as many as  <dig> probe set targets, e.g., cft <dig> strain ec <dig> and the o157:h <dig> strain ec <dig>  we found that, among the  <dig> independent isolates examined in the present studies, individual strains differed, on average, by  <dig> probe sets, and the median number of probe set differences was  <dig>  when one focuses on only the ehec-like isolates , we found that there are  <dig> probe sets that are variable among this ehec cluster. on average, ehec cluster  <dig> strains differed by  <dig> probe sets.

we also examined how our microarray-based method was able to recapitulate the phylogenetic history of isolates. using the maximum-likelihood method, we found a remarkable level of correlation between previous mlst-based results and our current microarray-based results. while these two approaches differ, in some cases however, these two analyses may be regarded as highly similar. many of the probe sets on the e. coli genome  <dig>  array are in fact representatives of different alleles of the same gene. we give as an example the muts gene: the muts gene is >95% conserved in nucleotide sequence in strains sakai, mg <dig>  and cft <dig>  however, on the e. coli  <dig>  array, there are three different probe sets that represent these three allelic variants of muts. importantly, the hybridization-based strategy utilized here is capable of discriminating between these three alleles  <cit> . so, indeed, our microarray approach is, in some cases, is also a measure of allelic diversity that exist among housekeeping genes. this is highly analogous to an mlst-based assay.

it is tempting to speculate on the minimal number of gene differences observed between any two independent isolates derived from the same culture. however, we will refrain from making any specific qualitative remarks to this regard. the reason is simply one of semantics in that the definition of "independent isolates" varies based on perspective. for example, a clinician might refer to two isolates derived from the same patient on different days as being "independent". yet from a genomics point of view, these two isolates may well be the same strain as measured by their genomic content.

the concept and definition of "independent isolates" and "different strains" came to light in our investigation of the  <dig> outbreak of o157:h <dig> associated with fresh spinach. during this outbreak, we interrogated > <dig> "independent isolates" that were geographically diverse . collectively, we referred to these isolates as the "outbreak population". all of the isolates contained within this outbreak population, with the exception of two, were genomically indistinguishable . the two exceptions differed by a single phage-related insertion. this difference resulted in the appearance of approximately  <dig> probe set differences, a result later confirmed independently in our laboratory by optical mapping and whole genome sequencing  <cit> . so, the question of minimal gene differences can only be answered accurately in the context of the whole genome. whereas these  <dig> gene differences might indicate a new strain, clearly they were derived from the same population of e. coli o157:h <dig> that caused the outbreak; i.e., they were indeed siblings within the outbreak population.

it is imperative to consider, as technology allows us to delve deeper into the bacterial genome, that individual strains and independent isolates are not synonymous terms. that deriving isolates from a single sick individual on different days; diluting and plating a single cultured sample onto several plates and subsequently deriving isolates from different plates; deriving isolates from different patients sickened during a single foodborne outbreak; or obtaining isolates from different environmental samples, are all valid examples of what "independent isolates" denote. these independent isolates, however, may, but need not, be individual strains. that is, if differences, no matter how subtle, are observed in genome comparisons of two independent isolates, sensu stricto, they are two individual strains. in contrast, if no distinguishing differences are seen between two isolates, then they are independent isolates of the same strain. these distinctions will increasingly impact the fields of molecular epidemiology and microbial forensics as today's technologies and their attendant discriminatory powers are utilized in such investigations.

authors' contributions
saj designed the study, performed the analysis and prepared the manuscript. irp carried out the molecular experimental studies and assisted with the analysis and preparation of the manuscript. tb acquired part of the experimental data. jel acquired the funding, supervised the project and revised the manuscript. tac supervised the project and was critically involved in revising the manuscript and contributed essential intellectual content. all authors read and approved the manuscript.

supplementary material
additional file 1
gene differences matrix. number of gene differences based on strain-to-strain comparisons is shown. a "gene difference" is defined here as a 4-fold difference in the rma-summarized probe set intensities. the cells are color-coded based on the number of gene differences using the scale below. strains are ordered based on their relatedness as determined by hierarchical cluster analysis.

click here for file

 additional file 2
pearson correlation matrix. r-bioconductor was used to calculate pearson correlation coefficients using rma-summarized probe set intensities. the cells are color-coded to show relatedness and correlation  according to the scale below. strains are ordered based on their relatedness as determined by hierarchical cluster analysis.

click here for file

 additional file 3
hierarchical cluster analysis. rma-summarized probe set intensities were used to hierarchically cluster  all  <dig> isolates  and all  <dig>  genes  in spotfire. the heatmap shows rma probe set intensities from low  to high . the top dendrogram is color-coded based on the  <dig> large clusters of e. coli.

click here for file

 additional file 4
conserved, core, backbone genes in e. coli and shigella. using the mas  <dig>  gene detection method, we filtered those probe sets that were called "present" in all  <dig> isolates. the  <dig> conserved probe sets are listed here along with their gene description, when available.

click here for file

 additional file 5
conserved intergenic regions. using the mas  <dig>  gene detection method, we filtered those probe sets that were annotated as "intergenic" and called "present" in all  <dig> isolates. the  <dig> conserved intergenic probe sets are listed here along with their genome position and length.

click here for file

 acknowledgements and funding
we acknowledge christopher a. elkins and mark k. mammel for their helpful discussions and critical editing of the manuscript. we acknowledge david w. lacher for sharing his stx confirmatory pcr results. we acknowledge ravi jain and kumar hari for their contributions towards the integration of our microarray data into the microbial rosetta stone http://www.mrscentral.com. we acknowledge the national bioforensics analysis center  of the department of homeland security for supporting work on dna microarray analyses of e. coli o157:h <dig> and shigella strains.

endnote:

while our manuscript was under peer review, clermont et al. reported similar findings based on an mlst analysis . by our analysis, we suggest that ecor strains  <dig>   <dig>  and  <dig> have the same lineage as ecor phylo group a . clermont et al. state that ecor strains  <dig> and  <dig> belong in an entirely different lineage . also, clermont et al. reports ecor <dig> strain still belonging in group b <dig>  just as previous mlst data had suggested, and contrary to our findings.
