BACKGROUND
structural variation is a class of genetic variation that includes insertions, inversions, translocations, deletions, and duplications of segments of dna. tandem duplications are serially repeated segments of the human genome which may have repeat units several hundred kilobases in size. many studies have implicated tandem duplications in a variety of diseases. in one such study  <cit> , it was shown that a subset of ovarian cancers share a marked tandem duplication phenotype with triple-negative breast cancers. an internal tandem duplication of the flt <dig> gene  is recurrent in acute myeloid leukemia  and myelodysplastic syndrome  with frequencies of  <dig> and 3-15%, respectively  <cit> . additionally, 5% to 10% of patients with aml possess the rearrangement of the mixed-lineage leukemia  gene as the result of a partial tandem duplication   <cit> . germline tandem duplications have also been associated with human disease. in one recent study  <cit> , it was shown that a patient and his half-sister with extensive polysyndactyly of the hands and feet, and craniofacial abnormalities carried identical 900-kb tandem duplications of the indian hedgehog  locus. another study  <cit>  reported a father and daughter, both with a history of compulsive over-eating in childhood, carrying a small tandem duplication within exon  <dig> of the snurf/snrpn gene on chromosome  <dig>  these studies underscore the need for computational methods for identifying tandem duplications.

next-generation sequencing  technology was first used to detect structural variations by korbel et al. <cit> . in that study, the paired-end sequences of two samples' genomes were generated and the read pairs with discordant paired-end orientation and mapped distance were used to find basic structural variations. subsequently,  <cit>  used ngs to discover genome rearrangements in tumor dna. the first genome that was wholly sequenced by a ngs platform was presented in  <cit> , which reported several structural variations.

ngs data provides several sources of information from which methods may detect structural variation, including read depth, paired-end orientation, distance between mapped ends, and pairs where one end is “split” mapped or “one-end anchored” . pemer  <cit> , breakdancer  <cit> , variationhunter  <cit> , gasv  <cit> , and gasvpro  <cit>  use the orientation and the mapped distance between the read pairs to detect insertions, deletions, inversions, and/or translocations. crest  <cit>  is another method that utilizes split mapped reads as well as paired-end read orientation. the problem of finding novel insertions was also addressed using one-end anchored read pairs in another recent study  <cit> . in addition, ewt  <cit>  and segseq  <cit>  were developed for detecting the genomic regions that differ in copy number between individuals using the depth of single reads in sequence data. currently, the most well-known methods for detecting the tandem duplications  using just the paired-end ngs data include svdetect  <cit> , cnver  <cit> , spanner  <cit> , ingap-sv  <cit> , breakdancer  <cit> , gasv  <cit>  and crest  <cit> .

for methods that use paired-end reads, an important factor is fragment length, since the two sequenced ends of each fragment will be separated by this length. however, the length of each fragment is not known precisely. although many of the existing methods assume that fragment length is within a certain range for all fragments , they do not make use of important information contained in the distribution of these lengths when prioritizing among the predicted breakpoints of the structural variations. if the length of each fragment were known, one could use this information to precisely detect the boundaries of duplications. while precise lengths are not generally available, their general distribution can be derived empirically from concordantly mapped reads. here a read pair is said to be concordantly mapped to the reference genome when the end with a lower mapping coordinate is aligned to the forward strand, the end with the higher mapping coordinate is aligned to the reverse strand  and the distance between the mapped ends is within an expected range.

motivated by this insight, here we propose a method distribution based detection of duplication boundaries  that characterizes the distribution of fragment length empirically and utilizes this empirical fragment length distribution to predict the breakpoints of the tandem duplications at a very high resolution with high accuracy and low false positive rate. to the best of our knowledge, none of the existing methods developed for detecting any kind of structural variations utilizes this valuable information for predicting the breakpoints of detected variations. although we focus on tandem duplications in this manuscript, the proposed framework can easily be extended to detect the boundaries of other structural variations as well.

the general framework implemented by db <dig> is summarized in figure  <dig> . briefly, db <dig> uses the binary alignment/map  files obtained by mapping the paired-end read sequences to the human reference genome using bwa  <cit>  . the resulting bam files include orientation information as well as the mapping coordinates for each read pair. concordant read pairs map in the expected fr orientation, and are thought to correspond to regions that do not differ from the reference genome , whereas pairs with an “everted” rf orientation are indicative of tandem duplications  <cit> .figure  <dig> 
a flowchart summarizing the framework implemented by db
2
. since the distances between the aligned ends of the concordantly mapped read pairs can be considered as representatives of the real fragment lengths, we first extract the concordant read pairs from the bam files and obtain the empirical fragment length distribution using them. the everted  read pairs, which are also extracted, are indicative of tandem duplications. we use each of the rf pairs along with the empirical fragment length distribution to represent the feasible breakpoints of the tandem duplication that induced this rf pair. next, db <dig> clusters the read pairs that may be induced by the same tandem duplication, and hence finds distinct tandem duplications along with their potential breakpoints. it scores each potential breakpoint by utilizing the empirical length distribution and obtains the breakpoint with the highest score as the putative breakpoint of each tandem duplication. after the conflict resolution step eliminates the likely false positives, the final set of tandem duplications are reported to the user.



db <dig> uses the read pairs that are reported to be concordant by the alignment tool to deduce the empirical fragment length distribution, and the rf read pairs for discovering the tandem duplications along with their putative genomic breakpoint coordinates. to identify the tandem duplications, db <dig> adopts the geometric representation of the putative breakpoints of a tandem duplication that induces a discordant read pair, which was first proposed in the design of gasv  <cit> . our method then groups the rf read pairs that are likely to be induced by the same tandem duplication and uses the information extracted out of multiple read pairs along with the empirical fragment length distribution to precisely infer the putative breakpoints of the tandem duplications.

as a final step, we resolve the conflicts among the tandem duplications, which are caused by multiple distinct tandem duplications having overlapping boundaries, by applying an algorithm that relies on the maximum parsimony principle. after the most likely false positive tandem duplications are eliminated in this step, the set of conflict-free duplications are reported to the user. as we show via systematic computational experiments in the results section, incorporation of fragment length distribution greatly improves our method's ability in fine tuning the breakpoints of identified duplications.

RESULTS
simulation procedure
for simulation testing, we have implemented an artificial paired-end read generator using the february  <dig> assembly  of the human reference genome. our simulator generates paired-end read sequences that are similar to those of the illumina/solexa platform . to evaluate the performance of the proposed method, for each experiment, we inserted  <dig> tandem duplications whose lengths  were drawn from a normal distribution, with a default standard deviation of 100 bp and default mean of  <dig> kbp, into the reference genome. for the experimental evaluation of our algorithm, we used four criteria; precision, recall, f1-score and mean breakpoint mismatch. precision is defined as the fraction of the number of true tandem duplications  among all tandem duplications identified by our algorithm . in order for a predicted  tandem duplication to be considered as a true positive, we required at least 50% mutual overlap of the real and the predicted tandem duplications. recall is defined as the fraction of true positives among all tandem duplications in the donor genome . f1-score is a commonly used aggregate metric in information retrieval that considers both precision and recall. it is defined as the harmonic mean of precision and recall. mean breakpoint mismatch is defined as the average of total distances  between the predicted and the real start and end positions of the inserted tandem duplications.

other methods used for comparison
we compared the performance of our algorithm with that of five other software packages designed to detect structural variations from paired-end ngs data: svdetect  <cit> , cnver  <cit> , breakdancer  <cit> , gasv  <cit>  and crest  <cit> . note that the more recent version of gasv, gasvpro, is not included in the compared methods because it does not support the identification of the tandem duplications. although spanner  <cit>  and ingap-sv  <cit>  are also able to detect tandem duplications, both of these methods were excluded from the experimental evaluation since spanner was not publicly available and ingap-sv was significantly outperformed by the other methods. for all the methods, we aligned the generated read pair sequences with bwa using the default parameters. the default parameters for cnver, breakdancer, crest and gasv were used, whereas the default values of window_size and step_length parameters had to be slightly modified in svdetect to obtain the best performance with the simulation data. we set these two parameters to  <dig> and  <dig>  respectively.

several factors can affect any method’s ability to detect a tandem duplication: the average depth coverage of the experiment, the base call error rate, characteristics of the tandem duplications in the donor genome , properties of the read library , and read length. for this reason, we tested the algorithms across various values of six parameters as discussed in the following sections.

effect of base calling error rate on performance
to evaluate the effect of base call errors, we simulated different error rates using our synthetic data generator by changing each base with a probability that is defined with the base call error rate. as shown in figure 2a, the precision of our method, breakdancer and gasv is steady at 99-100% for all base calling error rates. on the other hand, the precision of cnver decreases dramatically as error rate increases whereas crest first has a decreasing and then increasing precision performance. somewhat surprisingly, svdetect has an increasingly better performance as the base calling error increases. we observed that it can reach at most 97% at the highest level of noise induced in our simulations, which is still lower than db2’s performance. the positive impact of error rate on precision is likely because the alignment tool will drop spurious mappings as error rate goes up.figure  <dig> 
performance as a function of error rate.  precision,  recall and  f1-score performances of the methods at different base calling error rates are presented. here the average depth coverage is fixed at 40x.



the recall of our method and svdetect are almost identical , whereas cnver, gasv, breakdancer and crest have drastically declining performances with increasing error rate. the decrease in the sensitivities of all methods can be explained by the fact that the alignment tool fails to align increasingly noisy rf reads. thus, as the error rate goes up, the effective coverage goes down, and the evidence for the duplications gets weaker, which results in fewer predictions and hence fewer true positives. to validate this claim, we computed the mean number of the read pairs supporting each tandem duplication as the base calling error increases . as shown in this figure, the support for each tandem duplication significantly decreases due to lower effective coverage as we increase the noise in the data. to assess the overall accuracy of the methods, we present the f1-score performance in figure 2c. as mentioned before, f1-score evaluates the precision and recall performance of each method by aggregating them into a single value for each error rate level. as seen in figure 2c, our method outperforms all the presented methods in terms of f1-score at each error rate.

as seen in figure  <dig>  our algorithm outperforms svdetect and cnver in terms of finding the breakpoints of the tandem duplications but crest is able to identify the exact location of the tandem duplication. although breakdancer can attain a mean breakpoint mismatch performance similar to that of our method for low error rates, db <dig> outperforms it by maintaining a robust performance even for very high base calling error rates.figure  <dig> 
mean breakpoint mismatch at different base calling error rates. breakpoint mismatch is calculated as the average number of bases between the real and predicted breakpoints. average depth coverage is fixed at 40x.



overall, db <dig> provides the best f1-score, which represents the aggregate of precision and recall, along with a very good mean breakpoint mismatch that is tolerable as the noise in the data increases.

effect of depth coverage on performance
breakdancer, gasv and db <dig> outperform the other three methods in terms of precision across a wide range of coverages. as seen in figure 4a, those methods’ precision stabilizes around 99-100%, whereas precision declines with increasing coverage for svdetect  and crest. cnver has a rather stable performance around  <dig> % as a function of depth coverage. on the other hand, recall for db <dig> and svdetect stabilizes at around 99% as the coverage increases, whereas gasv, crest, cnver and breakdancer peak at 92%, 85%, 90% and 89%, respectively . in terms of f1-score, db <dig> performs much better than all the other methods having a stable score around  <dig> % whereas our closest competitor, svdetect, stabilizes at around  <dig> % . this shows our method’s ability to maintain very high precision and recall performances with changing depth of coverage levels.figure  <dig> 
performance as a function of depth coverage.  precision,  recall and  f1-score performances at different average depth coverage levels are shown. here the base call error rate is fixed at  <dig> .



for varying levels of coverage, crest again attains nucleotide-level accuracy with regard to mean breakpoint mismatch for true tandem duplications whereas our algorithm has a slightly lower performance than that of crest. on the other hand, db <dig> consistently and substantially outperforms cnver and svdetect in terms of this metric . indeed, db <dig> is able to accurately localize breakpoints to within  <dig> bases or fewer even at low coverage values. this observation suggests that the use of fragment length distribution indeed improves accuracy in fine-tuning of the breakpoints, as it gives more importance to breakpoints consistent with a higher frequency fragment length . on the other hand, breakdancer and gasv slightly perform worse for low coverage levels but then their performances catch up with the performance of db <dig> for higher coverage values.figure  <dig> 
mean breakpoint mismatch at different depth coverage levels. the base call error rate is fixed at  <dig> .



varying levels of coverage directly impact the amount of data available to each method. as shown in the above analysis, db <dig> consistently achieves the best f1-score and recall performance, but has slightly worse mean breakpoint mismatch performance than that of crest, even when the data availability is low . considering the crest's much lower recall and precision performances, db2's average mismatch of  <dig> base pairs when identifying the boundaries of a tandem duplication is quite tolerable.

effect of duplication size on performance
for this set of experiments, we increased the size of the tandem duplications starting from  <dig> kbp up to  <dig> kbp in  <dig> kbp increments for each experiment setting. almost all of the methods have a stable performance in terms of all metrics as we increase the size of each duplication inserted into the donor genome . this is an expected result for db <dig>  since as long as the fusion point of a tandem duplication is straddled by a read pair, db <dig> will use this information to identify its breakpoints regardless of duplication size.

effect of changing properties of the read library on performance
there are multiple important factors during the read library preparation phase of any ngs experiment that can affect the performance of a structural variation identification method. these include  the distribution of the lengths of the fragments, and the read length.

in order to see the effects of these factors, we conducted a series of experiments by changing the values of read length and fragment length mean/standard deviation during the simulation data preparation. with the exception of crest, we observe no significant effect on any method’s recall, precision and f1-score performance . crest performs poorly in terms of recall for a read length of 50 bp, but then improves for larger read lengths . in contrast, the precision performance of crest first deteriorates as we enlarge the reads, and then stabilizes around 70%.

increasing the mean value of the fragment lengths dramatically decreases the mean boundary mismatch performance of gasv, cnver, and svdetect, whereas db <dig>  crest, and breakdancer are unaffected . the decrease in gasv's performance can be explained by the method’s conceptual use of trapezoids, determined by discordantly mapped read pairs, to define the possible boundaries of the tandem duplication. gasv finds the intersection of the trapezoids  to predict the location of the tandem duplication. however, as the fragment length increases, so does the area covered by each trapezoid, causing gasv to report a larger interval for candidate start and end sites for the tandem duplication. db <dig> solves this problem by ranking the predicted start and end sites by assigning probability values to each of them using the fragment length distribution , and as a result does not have a deteriorating performance as the mean value of the fragment lengths increases. for similar reasons, we also observe a slight decrease in the mean boundary mismatch performance for gasv as the standard deviation of the fragment lengths increases. all other methods except svdetect have stable mean boundary mismatch performances .figure  <dig> 
mean breakpoint mismatch for various levels of  mean value of fragment lengths,  standard deviation of fragment lengths, and  read length. here the base call error rate, depth of coverage, duplication size are fixed at  <dig> , 40x and  <dig> kbp, respectively. for  and , the read length is fixed at 75 bp. for  and , standard deviation of the fragment lengths is fixed at 10 bp. for , mean of the fragment lengths is 200 bp and for , this value is fixed at 400 bp.



lastly, we observe a poor performance for gasv in terms of mean boundary mismatch for small reads , whereas db2's performance is very stable for all read lengths . indeed, as the read length decreases, the area of each trapezoid induced by a discordantly aligned read pair increases. again, we overcome this difficulty by calculating a probability value for each predicted loci pair using the empirical fragment length distribution and reporting the one with highest probability. as seen in the results of these experiments, our method is very resilient to negative effects of changing properties of the read library in terms of all metrics.

run-time and memory consumption comparison
for each method, we computed the average time needed to produce its results, as well as its peak memory consumption on a pc that has  <dig> gigabytes of memory and eight intel xeon e5- <dig> cpus each with a clock speed of  <dig>  ghz and . although db <dig> consumes the largest memory among all the methods, it is still tolerable when we take its superior run-time into account. it should also be taken into consideration that even today's low-end desktop computers are equipped with 8 gb of memory, which makes the memory requirement of db <dig> feasible for a high-end computer cluster used for scientific computation.table  <dig> 
average run-time and memory consumption for compared methods


2

run time 

peak memory usage 


tandem duplications identified in two ovarian cancer genomes
to investigate whether our algorithm can identify tandem duplications in real data setting, we applied db <dig> to the paired-end read data obtained from two ovarian cancer genomes from the cancer genome atlas . the samples that we analyzed are tcga-13- <dig> and tcga-24- <dig>  we identified a total of  <dig> tandem duplications in these genomes using our approach, which we provide in the additional file 7: table s <dig>  a recent study  <cit>  analyzing the same set of samples reported three tandem duplications – one in tcga-13- <dig> and two in tcga-24- <dig>  db <dig> was able to identify these tandem duplications. in table  <dig>  we present the start and end sites of these duplications reported by  <cit>  and identified by db <dig> table  <dig> 
previously-reported tandem duplications identified by our method 




tandem duplications identified in a melanoma genome
we also applied our method to the paired-end read data obtained from the cell line colo- <dig>  immortalized from a 43-year-old male with metastasis of a malignant melanoma. illumina gaii genome analyzers were used to obtain more than 40-fold average haploid genome coverage  <cit> . we applied our pipeline  to the bam files obtained by mapping the fastq-formatted paired-end read data obtained from colo- <dig> cell line to the human reference genome using bwa  <cit> . table  <dig> describes four tandem duplications  found in this genome by db <dig>  the two novel discoveries were validated with pcr  and sanger sequencing .table  <dig> 
colo- <dig> tandem duplications identified by our method and pcr/sanger -validated or previously reported  coordinates


*in the study that first sequenced this sample  <cit> . the two that were not previously reported are pcr  and sanger sequencing  validated.
pcr results for previously unreported tandem duplications. the top panel shows the band for the pcr product generated from primers within the duplicated regions , present in both colo- <dig> and the na <dig> control sample . in the bottom panel, the second and fourth lanes show the presence, in the colo- <dig> cell line, of the third and fourth, respectively, tandem duplications given in table  <dig>  lanes three and five correspond to na <dig>  here forward primers were designed left of the fusion points and reverse primers were designed right of the fusion point, creating an amplicon of about 150 bp straddling the fusion point of the duplication. see additional file 8: table s <dig> for primer sequences.



CONCLUSIONS
tandem duplications are an important class of structural variation whose identification requires specialized algorithms. the algorithm that we propose here can identify tandem duplications with a very low false positive rate and a very low mean breakpoint mismatch , even in very noisy ngs datasets, without compromising sensitivity. as shown by systematic computational experiments on simulated data, db <dig> achieves a precision of  <dig> % and a recall of 77% even for an unusually noisy data . these results indicate that our method is not very susceptible to the effects of base calling errors in terms of making false tandem duplication predictions and false boundary detections. one other important aspect of our algorithm is that its performance is stable even when the properties of the sequencing library or the size of tandem duplications in the target genome change. this shows the suitability of our method across ngs experiments with different characteristics.

the key to the success of db <dig> in accurate breakpoint localization is the utilization of the empirical fragment length to predict the most feasible breakpoint for a tandem duplication. as shown in additional file 10: figure s <dig>  the distribution of the fragment lengths is generally not uniform in ngs experiments. thus, given an everted  read pair as the evidence for a tandem duplication, breakpoints of this duplication that indicate a higher frequency fragment length  for this rf read pair, should have a higher probability than the others to be the real breakpoints. db <dig> uses this novel idea to precisely determine the breakpoints of the tandem duplications. note that neither gasv, nor its extended version gasvpro employs empirical fragment length distribution to probabilistically score the potential breakpoints of structural variations. they instead assume that the lengths of all fragments are within a predefined range, and based on this assumption estimate a  range of equally likely breakpoints for identified duplications. in contrast, we use the empirical length distribution obtained from the concordantly aligned reads to assign a probability score to each feasible breakpoint, thereby enabling ranking of candidate breakpoints in terms of their likelihood of being the correct breakpoint. as detailed in the results and discussion, the use of the fragment length distribution gives our method the stability for accurate boundary prediction performance.

our method also achieves a very high precision and recall performance, substantially outperforming the svdetect and cnver in terms of these two measures. although breakdancer and gasv achieve the best precision performance among all the methods, they perform at most only 1% better than db <dig>  and are substantially outperformed in terms of recall. in terms of f1-score, our method outperforms all the other methods with increasing error rate and data coverage, showing the superiority of our method in identifying the largest set of true positive tandem duplications with the least number of false positives. finally, the duplications identified in the two tcga ovarian cancer samples and the colo- <dig> cell line confirm the applicability of db <dig> to real datasets.

db <dig> is freely available at http://mendel.gene.cwru.edu/laframboiselab/software.php. efforts are underway to extend the methodology to detecting non-tandem duplications, deletions and inversions.

