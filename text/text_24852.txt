BACKGROUND
the red queen from lewis carroll’s tale ‘through the looking glass’ is commonly used as a metaphor for selection-induced rapid evolution  <cit> . it is based on the observation that persistence in an environment with changing selective constraints requires ongoing adaptations to the encountered challenges  <cit> . host-parasite coevolution with antagonistic and inter-dependent interactions represents one of the role models for such rapid evolutionary change  <cit> . for instance, an increase in host resistance reduces parasite fitness, thus immediately favoring parasite varieties with altered virulence and/or immune-evasion mechanisms. in turn, a novel parasite attack mechanism decreases host fitness, thus favoring host varieties with new counter-defenses. if the interaction persists, then it will lead to continuous parasite adaptations and host counter-adaptations. the rapid evolutionary dynamics associated with these interactions is very well documented in the literature, ranging from field studies on rabbits and their myxoma viruses  <cit> , snails and their trematode parasites  <cit> , daphnia magna waterfleas and their bacterial parasites  <cit>  to laboratory-based coevolution experiments between bacteria and their phages  <cit> , the nematode caenorhabditis elegans and bacterial parasites  <cit> , or the red flour beetle tribolium castaneum and its microsporidian parasite  <cit> .

it is thus widely accepted that these interactions evolve fast and continuously. yet, to date, the exact underlying selection dynamics are not always well understood. these dynamics can generally be influenced by metapopulation structure and environmental variation  <cit> . within a particular population and specific environmental context, two main alternatives are thought to be of prime importance: recurrent selective sweeps and negative frequency-dependent selection  <cit> . both alternatives are consistent with the above original definition of the red queen hypothesis by van valen  <cit> , whereas, curiously, only the second alternative is referred to as red queen dynamics  <cit> . the two alternatives are closely related because both assume a selective advantage of a rare genotype, for example a novel host resistance variant. however, they differ fundamentally in the way in which the new variant originates and spreads within the population. the concept of recurrent selective sweeps  consists of two steps: the de novo appearance of a beneficial allele  and its subsequent spread through the population to fixation . these sweeps occur repeatedly in host and parasite populations, usually each time with a new beneficial allele. they may only lead to fast changes in absolute time if at least one of the following factors applies: new alleles arise frequently, new alleles become immediately visible and thus selectable at the phenotypic level, the new alleles provide a high selective advantage, and/or the organisms have short generation times. this situation is best met in bacteria-phage interactions, which are usually characterized by large population sizes , short generation times, and haploid genomes   <cit>  .

in contrast, the dynamics for multicellular host systems are traditionally viewed to be determined by negative frequency-dependent selection leading to sustained oscillations of the same alleles , but not to the fixation of single alleles. in this case, standing genetic variation is required, because the population sizes for these hosts are usually comparatively small, their generation times comparatively long, and their genomes diploid. as a consequence, recurrent selective sweeps are commonly thought to be rather slow in these systems. instead, if standing genetic variation is available, then negative frequency-dependent selection can produce fast and continuous allele frequency changes even in these host systems. such negative frequency-dependent dynamics seem to be present in some multicellular host systems, including the freshwater snail potamopyrgus antipodarum <cit>  and the waterflea daphnia magna <cit> .

numerous theoretical models have been developed to study the underlying selection dynamics. interestingly, the current models typically focus on evolutionary change . these approaches have thus largely neglected ecological dynamics, which can have a huge impact on the evolutionary process. population size fluctuations deserve particular attention in this context, because they are induced by reciprocal selection among the antagonists and, therefore, represent an inherent property of host-parasite coevolution - irrespective of additional environmental variation  <cit> . since selection is reciprocal, population size fluctuations should be coupled between the antagonists, and generally follow lotka-volterra dynamics  <cit> . such demographic variations have the potential to affect the dynamics of host-parasite allele frequency changes by introducing two important effects. firstly, the rising and falling population sizes produce bottlenecks where selection favours a particular allele. the favored allele may thus reach comparatively high frequencies during the bottleneck, possibly enhancing its spread in the subsequently expanding population. secondly, the elevated stochasticity during the bottleneck may lead to a further increase and thus spread of the favored allele.

in this manuscript, we aim at understanding in how far lotka-volterra population size fluctuations and the associated stochastic effects influence the dynamics of allele frequency changes during host-parasite coevolution. while several previous theoretical models have applied the lotka-volterra dynamics to host-parasite coevolution , their influence on the evolutionary dynamics has not yet been systematically explored by comparison with a model with constant population size. similarly, stochastic effects during host-parasite coevolution have only been considered in a few theoretical studies , yet, to our knowledge, with a single exception  <cit>  under constant population size and not in combination with lotka-volterra dynamics. hence, while the previous studies have independently utilised stochastic effects or lotka-volterra dynamics, a systematic analysis of the consequences of each of these factors, either alone or in combination, is as yet missing - in spite of their potential importance. the novelty of our study lies in bringing together these two aspects and comparing their influence to the traditional model, in which lotka-volterra dynamics and stochastic effects are excluded. more specifically, we here use the standard matching-alleles host-parasite interaction model to assess allele frequency dynamics in the presence versus absence of lotka-volterra oscillations for a stochastic versus an analogous deterministic model.

methods
based on the lotka-volterra equations  <cit> , we address the population dynamics of interacting hosts and parasites. the host corresponds to the prey in the original model, and the parasite to the predator. the host consumes a  food supply f and reproduces at rate c <dig>  parasites infect hosts at rate c <dig>  leading to elimination of a host and generation of an additional parasite. parasites die at rate c <dig>  the number of host and parasite individuals are given by h and p. in a stochastic system these interactions can be defined by the following reactions  <cit> , 

  f+h→c1h+hh+p→c2p+pp→c <dig>  

usage of these specific reactions facilitates tracking of each unit of the interacting antagonists and, thus, it allows a more precise characterization of the resulting dynamics. these reactions can also be used directly for exact stochastic simulations based on the gillespie algorithm. they further provide a microscopic dynamics from which the deterministic lotka-volterra equations emerge in the limit of infinite population size  <cit> , 

  h˙=c1fh−c2hpp˙=c2hp−c3p. 

host-parasite coevolution is modeled using the standard matching alleles model  <cit> . for this, we define two host and two parasite types, h <dig> and h <dig> for the host and p <dig> and p <dig> for the parasite. this is equivalent to a haploid system with two antagonists, each of which possesses two alleles at a single locus. the interaction according to the matching alleles model is described with the following six reactions, 

  h1→ãh1+h1h2→ãh2+h2h1+p1→b~p1+p1h2+p2→b~p2+p2p1→c~0p2→c~ <dig>  

in the matching alleles model, the interactions between alternate hosts and parasites  are without consequence and thus do not appear here. while the absence of these interactions is the standard assumption in the matching alleles model, allowing a small amount of these interactions does not change our results qualitatively . in the limit of infinite population size  <cit> , we obtain a set of four coupled nonlinear differential equations, 

  h1˙=h1h2˙=h2p1˙=p1p2˙=p <dig>  

where the frequencies of hi and pi are given by hi and pi. the above equations consider interdependence of host and parasite demographies, allowing population sizes to vary in response to the interaction with the antagonist, consistent with the lotka-volterra model. the precise nature of the resulting oscillations in population size is determined by the parameters, most importantly by b.

as we are interested in the effects of population size variation induced by the lotka-volterra equations, we have to compare this to a scenario in which the population size is constant. such constant population size models are common, e.g. the wright-fisher model or the moran process. however, microscopically these models are distinct from the lotka-volterra equations considered above. therefore, we used the above approach and enforced constant population size by resetting host and parasite population sizes to their initial values after every generation , while relative allele frequencies were maintained. the dynamics were subsequently assessed for different average population sizes. to ensure comparability of allele frequency fluctuations across population sizes and evolutionary models, we rescaled the interaction parameters with navg for the deterministic analogues of the considered stochastic scenarios .

RESULTS
host-parasite coevolutionary dynamics are analyzed in the presence and absence of lotka-volterra dynamics. figure  <dig> illustrates an exemplary result. all models initially produce oscillatory allele frequency changes, but only with lotka-volterra dynamics are these accompanied by changes of population size. as a consequence, changes in allele numbers are also more pronounced . as the deterministic model allows for arbitrary small frequencies of each type, it formally never leads to allele fixation and thus produces continuous oscillations. in contrast, the corresponding stochastic models have absorbing states, making fixation possible. interestingly, allele fixation appears to be substantially faster in the stochastic model that includes lotka-volterra fluctuations . as such, it seems that these conditions favor rapid termination of the red queen oscillations.

we next analyze the impact of the average population size on this pattern. in the following, we focus on the time until one of the alleles from either of the antagonists has reached fixation in order to compare evolutionary rates across population sizes and models. in general, lotka-volterra dynamics cause a substantial increase in allele fixation rate . interestingly, in this case, allele fixation rates depend only weakly on average population size. figure  <dig> suggests that this is because allele frequencies can become very small during the lotka-volterra demographic fluctuations. in contrast, average population size has a much stronger effect when it is artificially kept constant. here, the time until allele fixation increases exponentially with increasing population size .

the results also highlight that the dynamics are usually determined by fixation of one of the host alleles . note that the simulations are stopped as soon as either one of the host or one of the parasite alleles reaches fixation and, thus, the fixation probabilities of both host as well as both parasite alleles sum up to one. in our case, fixation of the host allele is more likely than fixation of the parasite allele because for our parameter combination and initial condition, it is usually the host that first experiences a lotka-volterra bottleneck and consequentially a drop in the frequency of one of the alleles . nevertheless, if both the parasite and corresponding host allele are common, then it is the parasite allele that has a high probability of fixation .

the overall pattern looks different in the absence of lotka-volterra fluctuations . host allele fixation probability increases with its own high initial frequency and, at the same time, low initial abundance of the corresponding parasite allele . parasite allele fixation is enhanced when both parasite and corresponding host alleles are initially common . under these conditions, fixation probabilities of both host and parasite alleles are almost identical at initially intermediate frequencies, most likely due to negative frequency dependent selection, as illustrated in figure  <dig> 

discussion
population size fluctuations represent an inherent property of host-parasite interactions. unequivocal evidence for such interaction-dependent demographic variations was obtained from controlled host-parasite mesocosm experiments, for example with e. coli and its phage  <cit> , hydra hosts and its hydramoeba parasite  <cit> , house fly and its parasitic wasps  <cit> , or azuki bean weevil callosobruchus chinensis and its parasitoid heteropilus prosopidis <cit> . similar observations were made under field conditions, for example for rabbits and their myxoma viruses  <cit> , or red grouse and its nematode parasite  <cit> . additional examples are summarized by  <cit>  and  <cit> . as population size fluctuations produce regular bottlenecks, random genetic drift is likely to influence allele frequencies. previous theoretical models, developed in a different context, strongly suggest that even large populations are influenced by such stochastic processes  <cit> . more generally, under natural conditions in a finite population, it is difficult to imagine that changes in population size do not affect evolutionary dynamics. consequently, an in-depth understanding of the evolution of host-parasite interactions should take account of the associated ecological processes based on lotka-volterra fluctuations.

very few previous theoretical models on host-parasite interactions have considered lotka-volterra fluctuations  <cit> . these studies usually used a deterministic approach and thus excluded stochastic effects, which are most prominent during bottlenecks. similarly, only few theoretical studies considered stochastic effects in this context  <cit> , yet under constant population size, but not in combination with lotka-volterra dynamics. we are aware of only one study that looked at host-parasite coevolution in consideration of lotka-volterra interactions and stochasticity  <cit> . however, this study had a different focus, and thus, it did not include a systematic comparison to models without lotka-volterra cycles or without stochasticity. consequently, the interaction of these two aspects for host-parasite coevolution is so far unexplored. at the same time, their relevance was demonstrated for evolution of only one of the antagonists, namely the parasite. for example, the probability of fixation of a beneficial mutation in a bacterial population was shown to be enhanced by periodical bottlenecks  <cit> . similar results were obtained in a model that explored the effect of bottlenecks during pathogen transmission  <cit> . our study explicitly evaluates the influence of both lotka-volterra fluctuations and stochastic effects on the dynamics of host-parasite interactions using a comparison to a model with constant population size and/or absence of stochasticity. as the demographic variations are an inherent property of such antagonistic interactions, their influence should apply across a wide range of environmental conditions and thus be of general relevance for our understanding of host-parasite coevolution.

based on our approach, we obtained evidence that both lotka-volterra fluctuations and associated stochastic effects significantly affect the course and pace of coevolutionary adaptations. in particular, both factors facilitate selective sweeps . most impressively, this effect appears to be independent of average population size  and occur at a substantially faster rate . moreover, allele frequency changes are not exclusively due to drift, which should favor fixation of initially frequent alleles and loss of initially rare alleles. in contrast, our results indicate that initially rare host alleles can spread to fixation across a relatively wide range of conditions . rare parasite alleles may not necessarily go extinct, but have a certain likelihood of spreading contingent on the frequency of the corresponding host allele . based on these results we propose that selective sweeps rather than oscillatory negative frequency-dependent selection may represent the main driving force during host-parasite coevolution.

recurrent selective sweeps have been repeatedly suggested to determine coevolutionary dynamics for parasite or host systems with large population sizes such as bacterial hosts or microbial parasites, where novel mutations are frequent and often directly exposed to selection because of a haploid genetic system. if these selective dynamics also apply to multicellular host and parasite systems, then two contrasting effects may be expected on the coevolutionary process. on the one hand, these systems usually have much smaller population sizes, facilitating spread of alleles in spite of the often diploid genetic system. on the other hand, continuous coevolution may become difficult because it is usually assumed that small population size results in a reduced likelihood of the occurrence of advantageous novel mutations  <cit> . however, the latter assumption may not always be true. it is possible that new alleles become available for example by frequent immigration or a high rate of gene duplication. these processes may further favor the formation of novel genotypes if they act in combination with recombination and/or mutation. interestingly, the possible impact of gene duplications is usually not addressed in theoretical work on host-parasite coevolution, even though such duplications are known to be common in almost all organisms  <cit>  and often affect genes of relevance for the interaction such as virulence genes in parasites  <cit>  or immunity genes in animal hosts  <cit> .

several additional factors may favor ongoing coevolution. one of these is founded on a more complex genetic architecture underlying host-parasite co-adaptation that consists of several interacting loci across the genome . in this case, allele fixation at one locus may still permit maintenance of variation at other loci, which could then mediate evolutionary responses to the antagonist. yet another possibility may depend on metapopulation structure, consisting of coevolutionary hot and cold spots and migration among demes, as evidenced for flax and its parasitic rust fungus  <cit>  or the above mentioned snail-trematode interaction  <cit> . such an interconnected network could then maintain allelic diversity across the entire metapopulation, even if alleles become temporarily fixed within single demes. moreover, environmental gradients or perturbations are known to influence host-parasite coevolutionary dynamics  <cit> . they could similarly prevent loss of alleles, even if the coevolutionary interaction itself would specifically favour only one of the alleles. obviously, the above processes act in combination with each other in natural systems. therefore, it is indeed conceivable that recurrent selective sweeps shape long-lasting coevolutionary dynamics even in multicellular host systems.

CONCLUSIONS
in conclusion, decades of empirical efforts have tried to demonstrate the presence of red queen dynamics during host-parasite coevolution. this has led to most ingenious experiments which repeatedly and independently confirmed negative frequency dependence as a driving force  <cit>  and such a trend continues to date  <cit> . these studies yielded impressive evidence that parasite abundance typically increases first and, once the host evolves a defense mechanism, it decreases again. however, sustained allele frequency oscillations of a particular allele, as predicted by numerous theoretical models assuming constant population size in the absence of any stochastic effects, have not been reported. we here propose that lotka-volterra population size fluctuations and the associated stochastic effects represent an inherent property of host-parasite interactions that can lead to rapid fixation of alleles, even those initially rare, thus preventing sustained oscillations. consequently, lotka-volterra population size fluctuations have the potential to stop the red queen - unless novel variants are introduced into the population and/or additional selective constraints maintain allelic diversity. in retrospect, our findings may not be entirely unexpected. however, to date, they have not yet been directly demonstrated using a systematic analysis approach, as implemented here. more importantly, they are generally neglected in the numerous current empirical studies on the topic, in spite of their potential importance. they clearly deserve specific attention in future theoretical and empirical work aimed at an improved understanding of host-parasite coevolutionary dynamics.

appendix
relating stochastic and deterministic dynamics
stochastic models are often developed starting from deterministic formulations  <cit> . since the same deterministic formulation can be the limiting case of many individual based models, this procedure may be problematic. instead, beginning from a stochastic, individual based description and then calculating the deterministic analogue will provide only a single direct link between the two approaches and allows for their direct comparison.

we consider a haploid system involving two antagonistic pairs, two alleles in hosts and parasites each. firstly, all possible changes are written in the form of simple chemical reactions. in our particular case we have eight such possible reactions. we denote the two hosts and the two parasites by h <dig> and h <dig> and p <dig> and p <dig> respectively. thus we have, 

  h1→μ~h1+h1h2→μ~h2+h2h1+p1→b~p1+p1h2+p2→b~p2+p2p1→c~0p2→c~ <dig>  

for instance, a parasite  <dig> individual dies with the rate c~. from these rate reactions, we obtain the transition rates of the system. depending on the number of individuals of the different types namely n={nh <dig> nh <dig> np <dig> np2}, we write the rates as, 

  t=μ~nh1navgt=μ~nh2navgt=2b~nh1navgnp1navgt=2b~nh2navgnp2navgt=c~np1navgt=c~np2navg 

where the reaction rates, have been corrected by each reactions combinatorial possibility  <cit>  and navg is the average population size which we consider to be the same for the hosts as well as the parasites . using these rates, we can write down deterministic differential equations for the change in the average number of a certain type, e.g. 

  d〈nh1〉dt=μ~nh1navg−2b~nh1navgnp1navg. 

introducing rescaled reaction rates, μ=μ~navg, b=2b~navg and c=c~navg, we obtain 

  d〈nh1〉dtnavg=μnh1navg−bnh1navgnp1navg. 

in the limit of a large population size we recover the mean field approximation or the population level model  <cit> , 

  h1˙=h <dig> 

where h1˙=d〈nh1〉dtnavg and the frequencies of hi and pi are given by hi and pi. in the same way, we can derive deterministic differential equations for the frequencies of the other types, 

  h1˙=h <dig> 

  h2˙=h <dig> 

  p1˙=p <dig> 

  p2˙=p <dig> 

stochastic simulations
the gillespie algorithm gives an exact numerical solution of the master equation of the system  <cit> . our stochastic simulations are implementations of this algorithm with the transition rates as defined in eqs.  <dig>  since the population size is not constrained, this simulation method includes a stochastic analogue of the lotka-volterra cycles.

we computationally remove the lotka-volterra cycles by culling the population of each species after navg transitions have taken place. during the navg transitions the types within a species can evolve to different frequencies. but in the end they are reset to sum up to navg while maintaining the relative abundances. the gillespie method is discrete in the number of individuals but continuous in time. the unit of time is the same as in the deterministic system.

alternatively we can consider a small amount ε of interactions between the otherwise independent lotka-volterra interactions. this is then represented by the following set of differential equations, 

  h1˙=h <dig> 

  h2˙=h <dig> 

  p1˙=p <dig> 

  p2˙=p <dig>  

even for this case, including lotka-volterra interactions causes a faster extinction of the red queen cycles involving all four types. as an example we provide simulation results where in addition to similar parameters as in figure  <dig> we add a ε= <dig> b . although the fixation time is elevated as compared to the case with no interactions , they are still not comparable to the extremely high fixations times observed when lotka-volterra dynamics is excluded.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
hs and ap conceived the project. csg and at developed the model and performed simulations. all authors analysed the results and wrote the manuscript. all authors read and approved the final manuscript.

