BACKGROUND
cancer is a dynamic disease featured by various genetic alterations that accumulate during the procedure of tumor development. the theory of clonal evolution  <cit>  states that once a single precursor cell is initiated, the proceeding of neoplastic proliferation can to some extent be considered as a natural selection process – sequential selection by an evolutionary process. over time, both similar and divergent genetic alterations beneficial for tumor persistence and growth are acquired by different tumor cells through clonal expansions. this results in the emergence of variant cell populations in tumors with each cell population containing a distinct complement of genetic alterations, which is known as the intra-tumor heterogeneity . these genetic alterations consist of clonal aberrations, which derive from the precursor cell and exist in all tumor cells, and subclonal aberrations acquired during clonal expansions. specifically, copy number alteration  has emerged as one of the main categories of genetic structural variations that plays an important role in tumor progression  <cit> .

deciphering the intra-tumor heterogeneity is imperative for identifying clonal and subclonal cnas and further discovering cancer-causing genes. associated studies  have benefited from continuous advances in experimental technologies  that are used for high-throughput profiling of cancer genomes. the recent next-generation sequencing  platforms, such as whole-genome sequencing  and whole-exome sequencing , allows an unprecedented view of cancer genomes with nucleotide resolution. with the improvement in reliability and decrease in costs, wes has been considered as an effective alternative to wgs for cna detection in tumors  <cit> . however, such analysis is usually complicated by several critical issues encountered in interpretation of tumor wes data. first, the variable efficiency of exome capture results in non-uniform read depth between exome regions, and the read depth is simultaneously affected by the gc-content and length of individual exon  <cit> . these biases along with the discrete nature of the capture make wes unsuitable for whole-genome cna detection methods. second, tumor sample is usually contaminated by normal stroma and thus a mixture of tumor and non-tumor cells  <cit> . here we use tumor purity to denote the proportion of cancerous cells in the tumor sample. normal cell contamination will inevitably attenuate sequencing-derived copy number signals of aberrant exome regions. this sometimes makes it intractable to distinguish aberrant exome regions from normal regions, and eventually extract the aberration information from miscellaneous signals. third, various numerical and structural chromosomal aberrations result in aneuploidy of tumor genomes, and the actual tumor ploidy is usually unknown . another critical issue comes from the fact that the tumor cell population may be heterogeneous, resulting from ongoing subclonal evolution  <cit> , and the underlying number of distinct cell populations is unknown. traditional cna detection methods that make assumption of tumor homogeneity, i.e. mixture of normal and one tumor population, may omit cnas that are present in only minor cell populations.

critically, some of the aforementioned issues are strongly intertwined and cannot be solved separately, which may significantly complicate interpretation of wes data if they arise in the same tumor sample. for example, a gain of two copies of a chromosomal region in a tumor sample with 50 % normal cells could also be explained as a gain of one copy in a 100 % tumor sample. cna detection methods from wes analyze target-normalized read counts or  ratio of read counts in exon, and detect deviations in copy number profiles along the exome to identify cnas. although several state-of-the-art computational methods  have greatly improved accuracy of the detected cnas, their performance may still be limited by the aforementioned critical issues. for example, exomecnv  <cit>  uses circular binary segmentation  method  <cit>  to subdivide the exome and identify cnas with correction for normal cell contamination, and excavator  <cit>  adopts a heterogeneous shifting level model   <cit>  to segment the exome and uses a classification method to identify cnas, but tumor aneuploidy and intra-tumor heterogeneity are not explicitly modeled in these approaches. control-freec  <cit>  first infers the copy numbers of genomic segments, then uses gaussian mixture model  to identify tumor genotypes with correction for both normal cell contamination and tumor aneuploidy. however, it does not take into account the issue of intra-tumor heterogeneity. theta  <cit>  infers cancer subclones and detects subclonal cnas in heterogeneous tumors using a delicate statistical model, but the number of underlying tumor clones is not automatically determined  <cit>  and an integrated pipeline is not provided for segmentation analysis  <cit> . taken together, there is great demand for developing sophisticated methods for cna detection from tumor wes data by addressing all of the aforementioned challenges.

in this study, we introduce clonecna, an efficient bioinformatics tool for automatically detecting clonal and subclonal somatic cnas using wes data of heterogeneous tumor samples. clonecna fully explores the log read counts ratio  between paired tumor-normal samples and tumor b allele frequency  of germline heterozygous snp positions, then employs efficient statistical models to quantitatively represent copy numbers of tumor containing multiple clones. we adopt a factorial hidden markov model  for jointly delineating aberration events and clonal clusters, and implement a model selection module based on bayesian information criterion  to automatically determine the number of distinct clonal clusters. we compare clonecna with four state-of-the-art methods on simulated heterogeneous and real tumor samples, and the results demonstrate that clonecna has high power to detect both high and low cellularity cna events.

methods
the statistical model in clonecna
to depict tumors containing multiple subclones, we assume that the observed copy number profiles result from contributions of underlying three distinct cell populations: normal  cells, cancerous cells with normal genotype, and cancerous cells harboring the aberration event. thus, all cells can be further divided into two parts by a somatic aberration event at each locus: one with normal genotype and another containing the somatic aberration. we further assume multiple co-occurring events at different genomic loci share same cellularity, and can be designated to one of k clonal clusters. here, a clone is defined as a cell population that is uniquely identified by a complement of aberration events, and the cellularity of an aberration is defined as the proportion of cells harboring the aberration. in addition, we use β1:k to denote the cellularity of the k clonal clusters.

the workflow is illustrated in fig. 1a. the inputs to the model include exon-level read counts of paired tumor-normal samples, tumor allelic read depths of germline heterozygous snp positions, and gc-content of all exon regions. all the inputs are obtained by using an in-house tool. reads aligned to each exon are counted and sample-normalized for tumor and normal samples respectively, and the read counts ratio  is calculated for each exon, which eliminate the inherent biases induced by difference in exon size and efficiency of exome capture. we assume that the paired tumor-normal samples are processed in the same way, i.e. samples are sequenced in same platform, and reads are processed under same configuration. following our previous study  <cit> , we adopt a non-parametric approach to normalize the cr for gc-content by using the following formula:fig.  <dig> overview of the clonecna probabilistic framework. a clonecna analysis workflow. three inputs are required: 1) exon-level read counts of paired tumor-normal samples; 2) tumor allelic read depths of germline heterozygous snp positions; 3) gc-content of all exon regions. the lcr and maf data is modeled using a factorial hmm. the number of clonal clusters is determined using bic. b hmm adopted in clonecna. two markov chains are adopted to delineate copy number aberrations and clonal clusters

  <dig> r˜i=ri⋅m/mx where r̃i is the normalized cr and ri is the original cr of the ith exon, m denotes the median cr of all exons and mx represents the median cr of the exons that have the same gc-content as the ith exon. the logarithm of the normalized cr  is then calculated to represent copy number measurements, and denoted as l1:n for n exons. in addition, germline heterozygous snp positions are extracted from normal genome by using samtools  <cit> . baf of each snp position is represented by the ratio between the b allelic and total read depths derived from tumor genome, and for each exon, we evaluate the median value of major allele frequency :  <dig> mi=medianjmaxbij,1−bij where bij denotes the baf value of the jth snp within the ith exon.

we use an integrated hmm to jointly analyze lcr and maf signals , and determine the number of underlying clonal clusters based on bic.

hidden markov model
we introduce a state list to depict copy number aberration states of tumor genomes . given a copy number aberration state c, the mean values of total and major allele copy number associated with the kth clonal cluster are defined as follows:table  <dig> copy number aberration states defined in clonecna

aberration types include homozygous deletion , hemizygous deletion , copy neutral heterozygosity , copy neutral loh , amplified heterozygosity  and amplified loh 

  <dig> yck=ns1−βk+ncβk   <dig> zck=nsμs1−βk+ncμcβk where ns is the copy number of normal genomes, nc is the tumor copy number associated with state c, μs represents the expected maf of normal genomes, and μc denotes the expected maf of tumor genotypes in state c. the mean values of lcr and maf signals are then formulated with:  <dig> μckl=log2yck/2+o   <dig> μckm=zck/yck 

the parameter o is introduced to account for the baseline shift of lcr signals and varies with respect to the change of tumor ploidy. the parameters μlck and μmck are thus the functions of β1:k and therefore reflect the joint-effect on lcr and maf signals from three types of cell populations, respectively. we assume l1:n are student’s t-distributed with the conditional probability density function defined as follows:  <dig> fli|c,k,σl,νl,o=Γνl+1/2Γνl/2πνlσl1+1νlli−μcklσl2−νl+ <dig> where νl is the number of degrees of freedom, σl is the scale parameter, and Γ represents the gamma function. similarly, we also assume m1:n are student’s t-distributed:  <dig> fmi|c,k,σm,νm=Γνm+1/2Γνm/2πνmσm1+1νmmi−μckmσm2−νm+ <dig> 

the conditional probability densities of lcr and maf signals depend on two latent variables, namely copy number aberration state c and clonal cluster k, therefore we implement clonecna as a hmm with c × k hidden states . here, c is the number of copy number aberration states defined in table  <dig> and k is the number of clonal clusters. the hmm is thus equivalent to a factorial hmm with  <dig> underlying markov chains with one chain depicting aberrations and another delineating clonal clusters . for a given value of k, expectation maximization  algorithm  <cit>  is employed to estimate the model parameters θ = , where π represents initial state probability distribution, and a denotes state transition matrix. in the expectation step of the em algorithm, the expectations of the partial log-likelihood functions of lcr and maf are formulated as:  <dig> elll=∑i=1n∑c=1c∑k=1kγicklogfli|c,k,σl,νl,o   <dig> ellm=∑i=1n∑c=1c∑k=1kγicklogfmi|c,k,σm,νm 

we use forward-backward algorithm  <cit>  to calculate the posterior probability γick that the ith exon is in state c and clonal cluster k. in the maximization step, newton–raphson method  <cit>  is used to iteratively update model parameters.

the parameter updating procedure is stopped when the em algorithm converges. the copy number aberration state and clonal cluster of each exon are determined by the hidden state associated with the maximum posterior probability. segmentation of the exons is then performed to output copy numbers and cellularity of all segments. moreover, for each segment, a reliability score is calculated based on observed probability densities to evaluate the reliability of clonecna results . we also adopt a grid search of θ to find the optimal solution that give the maximum log-likelihood value of lcr and maf data.

model selection
the hidden state space of the hmm in clonecna is expanded as a function of the number of clonal clusters k, which is determined under the bic in the clonecna framework. we aim to find an optimal value of k that leads to the model associated with the lowest value of bic. starting with the initial assumption of tumor homogeneity , clonecna iteratively increases the number of clonal clusters by one until the bic of the model no longer decreases or the allowed maximum number of clonal clusters  is reached. we provide a detailed description of the model selection procedure in the additional file  <dig> 

real wes data of tumor samples
wes data from  <dig> paired primary triple negative breast cancer  samples  <cit>  is used in this study. reads are sequenced to approximately 30× coverage on illumina genome analyzer iix platform and mapped to the reference genome ncbi36/hg <dig> using bwa  <cit> . we download the data from european genome-phenome archive  under accession number egas <dig> 

simulated heterogeneous tumor samples
four test tumor genomes  are generated to simulate multiple tumor clonal populations by mixing different combinations of genomes at predefined proportions. we use the wes data of a real normal sample to generate sequencing data of the test genomes . each test genome is constructed by following four steps: 1) divide the reference genome into a series of segments, each segment is then assigned with a specific genomic aberration defined by total copy number and major allele copy number, 2) randomly sample reads from the normal genome according to the copy number of each segment of the test genome, 3) further process the sampled reads to match the baf of snps within each segment, and 4) merge and process the modified reads using samtools  <cit>  to generate bam. in addition, a normal genome  is also constructed by following the same procedure to simulate normal cell contamination in tumor samples. the detailed aberration information of each genome is provided in . for each combination of samples, reads are sampled at known proportion from bam files to generate the mixture. by this way, we totally generate  <dig> heterogeneous tumor samples, of which each mixture is derived from a specific combination of the normal and four tumor genomes . with these simulated samples, we perform a comprehensive evaluation of clonecna in terms of detecting clonal and subclonal somatic cnas.

competitive methods
in evaluating performance of clonecna, four state-of-the-art methods for cna detection using wes data, i.e. exomecnv  <cit> , control-freec  <cit> , excavator  <cit> , and theta  <cit> , are adopted to make comparison between cna calling methods. the detailed description of performance evaluation strategy and investigated methods is provided in additional file  <dig> 

RESULTS
gc-content correction of lcr data
we first investigate the effect of gc-content on the lcr signals, and assess the capability of gc-content correction procedure. the lcr values and gc-content of exons with copy number ranging from  <dig> to  <dig> are analyzed respectively, and the results are shown in . our analysis indicate that the lcr signals demonstrate a significant correlation with gc-content , and require a normalization procedure before being used to identify aberrant exome regions. based on our previous study  <cit> , we then implement a normalization procedure for the removal of gc-content bias . after normalization , the gc-content effect is significantly eliminated .

results on simulated data
we first investigate the lcr and baf distributions associated with different types of aberrations to analyze the influence of normal cell contamination for wes data and the results are shown in additional file 2: figure s <dig>  when tumor purity decreases, it is observed that for each aberration both the lcr and baf signals gradually approach close to the expected values of normal genotype . these results imply that normal cell contamination will inevitably diminish aberrant signals and needs to be corrected for accurately inferring genomic aberrations.

we apply clonecna to  <dig> simulated samples to examine its ability of predicting cellularity of distinct clonal clusters and detecting cnas. an example of the results on a simulated sample is shown in fig.  <dig>  four tumor genomes  and the simulated normal genome  are mixed to generate the simulated sample with corresponding proportion of  <dig> ,  <dig> ,  <dig> ,  <dig>  and  <dig>  respectively. this results in the emergence of four clonal clusters with different cellularity of  <dig> ,  <dig> ,  <dig>  and  <dig>  . the results show that clonecna correctly estimates the number of clonal clusters and infers their cellularity , meanwhile cnas represented in each clonal cluster are well identified. clonecna exhibits similar performance on other simulated tumor samples .fig.  <dig> cna detection and cellularity estimation results of clonecna on a simulated sample. the cnas predicted by clonecna are significantly consistent with the underlying ground truth. at the same time, clonecna correctly estimates the number of clonal clusters and their cellularity with  <dig> ,  <dig> ,  <dig>  and  <dig> 



to assess the abilities of different methods in detecting clonal cnas, we first apply the five methods to homogeneous tumor samples. the tumor purity of these samples ranges from  <dig>  to  <dig> . the cna states of all exons are used as the golden standard to evaluate different computational methods, and two metrics, sensitivity and specificity, are measured for each sample and method . the results of five methods, exomecnv, control-freec, excavator, theta and clonecna, are shown in additional file 2: figure s <dig>  exomecnv, control-freec and excavator present good specificity across all samples, and meanwhile exomecnv and control-freec shows a generally higher sensitivity than other existing methods. in addition, all the four methods show excellent performance for detecting cnas when tumor purity is greater than  <dig> . by comparison, clonecna demonstrates strong robustness to tumor purity and keeps high sensitivity  with tumor purity greater than  <dig> . it also maintains comparable high specificity .

next, we proceed to evaluate the performance of each method for detecting clonal and subclonal cna events in samples containing multiple tumor subclones. for this purpose, we simulate  <dig> samples containing two, three or four clonal populations . the sensitivity and specificity of each method are shown in fig.  <dig>  similar to the case observed for homogeneous tumor samples, exomecnv, control-freec and excavator consistently achieve high specificity  nearly in all samples. on the other hand, exomecnv and theta perform similarly in identifying cnas with a median sensitivity of  <dig>  and  <dig>  respectively, control-freec achieves a higher median sensitivity of  <dig> . in comparison, clonecna keeps consistent high sensitivity  for detecting either clonal or subclonal cnas, and shows remarkable advantage when compared with other methods. it also gets comparable high specificity  across all samples. these results indicate that clonecna can provide accurate identifications for clonal and subclonal cnas.fig.  <dig> cna detection performance of exomecnv, control-freec, excavator, theta and clonecna on simulated heterogeneous samples. sensitivity and specificity are calculated for each sample based on the results of each investigated method. a results for samples containing two clonal populations. for the sample with tumor purity of  <dig> , excavator reports a running error, therefore the performance of excavator and theta on this sample is not evaluated. b results for samples containing three clonal populations. c results for samples containing four clonal populations



we further assess the performance of copy number prediction of investigated methods, and the results are shown in additional file 2: figure s <dig>  the copy number states of all exons are used to make comparison. among existing methods, exomecnv and control-freec generally perform better than other methods, and achieve median accuracies of  <dig>  and  <dig> , respectively, while excavator and theta have median accuracies of  <dig>  and  <dig> . by comparison, clonecna demonstrates high accuracy for predicting copy numbers with median accuracy of  <dig> .

to evaluate the accuracy of cellularity predictions of clonecna, we make a comparison between the estimated cellularity and the underlying ground truth cellularity for each simulated sample. for each simulated sample, the underlying cellularity is computed by using contribution from each tumor genome making up the mixture . clonecna accurately estimates the cellularity with highly significant positive correlation  with the ground truth cellularity across all mixed samples , indicating clonecna can precisely reproduce clonal components. the number and cellularity of underlying clonal clusters for all mixtures are provided in . moreover, we evaluate the accuracy of tumor purity estimations of clonecna, and the results show statistically significant correlation for the all simulated mixtures  relative to the underlying tumor purity .

results on real data
having demonstrated the validity of clonecna on simulated data, we proceed to examine the performance of clonecna on  <dig> tnbc paired tumor-normal samples. the tnbc samples are also assayed by affymetrix snp <dig>  genotyping arrays. we use results from ascat  <cit>  software based on the snp array data as a baseline for comparison between different methods. details on investigated tools and performance evaluation strategy are described in additional file  <dig> 

we first evaluate the tumor purities of the tnbc samples using four algorithms – control-freec, theta, clonecna and ascat, and the results are summarized in table  <dig>  the tumor purities estimated by ascat are used as the ground truth to make a comparison between other algorithms. we find clonecna is more accurate with mean absolute error  of  <dig>  when compared with control-freec  and theta . the good concordance with the ground truth underscores the ability of clonecna in reliably inferring the tumor purity from wes of complicated tumor samples.table  <dig> tumor purity estimated by control-freec, theta, clonecna and ascat for tnbc samples



next, we evaluate the cna detection performance of exomecnv, control-freec, excavator, theta and clonecna on the tnbc samples . for all samples, clonecna compares favorably to other methods and presents higher sensitivity in most of the samples, with specificity comparable to those of the other methods. the median values of accuracy of exomecnv, control-freec, excavator and theta are  <dig> ,  <dig> ,  <dig>  and  <dig>  respectively. in comparison, clonecna achieves superior accuracy with median value of  <dig> .fig.  <dig> cna detection performance of exomecnv, control-freec, excavator, theta and clonecna on tnbc samples. cnas detected by ascat from affymetrix snp <dig>  arrays are used as ground truth for comparing different methods. sensitivity, specificity and accuracy of all methods on each sample are measured



then, we proceed to investigate whether there exists multiple tumor subclones in the tnbc samples. from the results of ascat on sample sa <dig>  we find a distinct mismatching between the mean of observed baf signals and the expected baf value for regions of homozygous and hemizygous deletions on chromosomes  <dig> and  <dig> , which indicates that there may be tumor subpopulations in the sample. interestingly, in the clonecna analysis of the sample sa <dig>  we find there are multiple clonal clusters. the log-likelihoods and bic difference of the models associated with different number of clonal clusters are shown in additional file 2: figure s <dig>  when the number of clonal clusters increases to  <dig>  the bic difference changes to positive, therefore clonecna finally infers k =  <dig> as the optimal number of clonal clusters. the cellularity of clonal clusters are  <dig> ,  <dig> ,  <dig> ,  <dig>  and  <dig>  respectively . clonecna identifies board hemizygous deletions on chromosome 1p, 2q,  <dig>  7q,  <dig>   <dig> and 18q. these hemizygous deletions are represented in subclonal clusters. the difference of the baf and lcr signals in hemizygous deletion regions represented in clonal and subclonal clusters is shown in additional file 2: figure s <dig>  moreover, ascat infers a homozygous deletion on chromosome  <dig>  while clonecna predicts it as clonal hemizygous deletion, and the hemizygous deletions identified by ascat are almost represented in subclonal clusters from the results of clonecna .fig.  <dig> cna detection and cellularity estimation results of clonecna on real sample sa <dig>  clonecna identifies five clonal clusters with corresponding cellularity of  <dig> ,  <dig> ,  <dig> ,  <dig>  and  <dig>  respectively



finally, we extract the mutations of tnbc samples that are validated in a previous study  <cit> , and make mappings between the mutations and copy number detections of the cna-calling methods . we separately count the number of mutations predicted to be in copy deleted, neutral and amplified regions by multiple methods, and the results are shown in additional file 2: figure s <dig>  our analysis show that for cna regions simultaneously inferred by all methods, there are  <dig> copy amplified mutations, of which  <dig> mutations derive from sample sa <dig> . for two mutations, clonecna predicts similar clonality of  <dig>  and  <dig>  respectively when compared with the clonality  inferred from mutation level.

discussion
clonecna is a novel algorithm for detecting clonal and subclonal somatic cnas from whole-exome sequencing data of heterogeneous tumor samples. it fully explores the log ratio of depth-of-coverage between paired tumor-normal samples and tumor allelic read depths of germline heterozygous snp positions. a hmm is integrated in the framework of clonecna to depict copy number aberrations of tumors containing multiple clonal populations. moreover, the underlying number of clonal clusters is determined under the bic in the clonecna framework. upon these specific features, clonecna presents advantages in several aspects. first, the appropriate deconvolution of miscellaneous signals of sequencing reads enables improved performance for detecting cnas. second, clonecna is much more sensitive to low cellularity clonal and subclonal cna events when compared to existing methods, demonstrated by intra-tumor heterogeneity simulation experiment. third, the algorithm provides accurate estimation of tumor purity. in summary, by benchmarking the performance of our algorithm on both simulated and real whole-exome sequencing data, we demonstrate that proper representation of the tumor wes data by considering intra-tumor heterogeneity can lead to more sensitive cna detection power, and clonecna outperforms existing methods in detecting either high or low cellularity clonal and subclonal cnas.

despite the advantages mentioned above, clonecna has several limitations in analysis of tumor wes data due to its adopted modelling assumptions. first, clonecna simply assumes that, at each aberrant locus, there exists only one tumor genotype. this assumption will not hold if more than one aberrant genotypes exist at the same locus and represented in distinct tumor populations. however, it is much challenging to distinguish among multiple tumor clones that have variable aberrated genotypes. the statistical models for representation of lcr and maf signals in clonecna need to be improved to account for multiple tumor genotypes, and the analysis of data may be confounded by multiple similar solutions. second, clonecna is unable to identify the coexistence of distinct clones that are present at the same or similar cellularity within the sample. this is a common problem for most mixture separation methods. third, one of the potential improvement of clonecna is to integrate somatic snvs, we plan to further extend clonecna in this direction to provide more comprehensive “fingerprint” of a clonal expansion.

CONCLUSIONS
efficiently addressing critical issues such as normal cell contamination, tumor aneuploidy, and intra-tumor heterogeneity, is necessary for accurately identify somatic cnas from heterogeneous tumor samples. in this study, we demonstrate that clonecna statistical framework represents a remarkable advance in detecting somatic cnas for tumor whole-exome sequencing data. we expect that clonecna will promote cancer-focused studies for investigating the role of clonal evolution and elucidating critical events benefiting tumor tumourigenesis and progression.

additional files
additional file 1: this file provides detailed description of clonecna statistical framework, performance evaluation strategy, simulation experiment, and details of the investigated methods. 

additional file 2: presentations of supplementary figures. 

additional file 3: detailed aberration information of each simulated genome. 

additional file 4: simulated mixtures with combinations of four genomes. 

additional file 5: the number and cellularity of underlying clonal clusters for all simulated mixtures. 

additional file 6: mappings between mutations and copy number detections of the cna-calling methods. 

additional file 7: four amplified mutations in sample sa <dig>  



abbreviations
cnacopy number alteration

snpsingle nucleotide polymorphism

ngsnext-generation sequencing

wgswhole-genome sequencing

weswhole-exome sequencing

hmmhidden markov model

bicbayesian information criterion

lcrlog read counts ratio

bafb allele frequency

tnbctriple negative breast cancer

egaeuropean genome-phenome archive

emexpectation maximization

