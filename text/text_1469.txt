BACKGROUND
population genetic data can be useful for comparing alternative representations of demographic history and for estimating parameter values under potentially complex models. the declining costs associated with next-generation sequencing, along with recent developments allowing multiple individual genomes to be simultaneously sequenced  <cit> , have led to increases in the number of researchers generating genomic-scale datasets that include population-level samples of individuals. these datasets have the potential to provide unprecedented insight into the demographic history of populations and the evolutionary history of divergence among species  <cit> . analyses based on the allele frequency spectrum  have become increasingly popular when considering population genomic datasets, in part due to the development of analytical software packages that consider the joint afs between two or more populations  <cit> .

the afs is a p-dimensional array, where p is the number of populations considered, that gives the number of single nucleotide polymorphism  loci with derived alleles present at a given joint frequency in the sampled populations. each dimension contains 2ni +  <dig> elements, where ni is the number of diploid individuals sampled from population i. these elements are ordered  along each dimension, and each value in the body of the array is the number of derived variants across the sample that are present at a given joint frequency. for instance, considering two populations, each snp locus contributes one unit to the value in the afs located at , where xi is the number of derived allele copies  in samples from population i. the joint afs is based on these data, summed across the set of snps genotyped in two or more populations.

for datasets composed of biallelic, unlinked snps, the afs is a complete summary of the data  <cit> , and many commonly used statistics, such as the number of segregating sites, fst, and tajima’s d  <cit> , can be calculated directly from the frequency spectrum. additionally, patterns in the afs can be indicative of demographic and/or selective events in the evolutionary history of the population or populations under consideration. for instance, gene flow between populations increases the correlation in allele frequencies, increasing the proportion of variable sites that fall along the diagonal of the afs . the afs is therefore well suited for the analysis of population genomic data, which are increasingly feasible to collect due to the rapid pace of development in sequencing technologies. estimates of historical demography from the afs can also be used to provide a baseline against which tests for the signatures of selection can be carried out  <cit> . however, the utility of parameter estimates obtained from analysis of the afs will depend on their accuracy and precision, as well as the power of the analytical framework for model selection.figure  <dig> 
information in the allele frequency spectrum. a comparison between two spectra of similar size  that differ in the rate of migration between populations. migration between populations increases the correlation in allele frequencies, thus increasing the density of snps falling along the diagonal of the afs.



several related computer programs have recently been introduced to analyze joint frequency spectra from two or more populations  <cit> . these programs differ in the specifics of their approach to modeling the afs, using either diffusion approximation  <cit>  or coalescent simulations  <cit>  to model the density of snps in cells of the afs. for comparisons between models and observed data, all of these methods employ composite likelihoods, which estimate the overall likelihood using combinations of likelihoods calculated from independent subsets of the data. for instance, in the context of the afs, the composite likelihood is the product of the likelihoods calculated for individual cells of the spectrum. the similarities between software packages have resulted in similar performance of the different analytical methods in cases where they are directly compared  <cit> , although some minor differences have also been noted  <cit> . of these alternatives, δaδi  <cit>  has been most widely applied, with applications to genomic data collected from humans  <cit> , cattle  <cit> , rice  <cit> , and bees  <cit> , among others.

here, we use a simulation study to investigate the influences of sample size on the power for model selection and the accuracy of parameter estimates obtained from δaδi  <cit> . because we employ an information-theoretic model selection approach, our use of the term power does not follow the standard statistical definition . instead we define power as the probability of selecting the true  model from a set of competing candidates. given the similarities between the afs-based software packages discussed above, we expect that the results from our simulations will apply broadly to afs-based methods for demographic inference. several previous studies have investigated the accuracy of afs-based parameter estimates and the power to detect historical demographic events using simulated data  <cit> . however, our analysis is differentiated from these assessments in that previous studies typically have not specifically explored the influences of the number of individuals sampled on the accuracy of estimates  <cit> , or have simulated substantially smaller datasets  <cit> . our analysis considers a broad range of one- and two-population models, and we investigate the influences of sample size on both the power for model selection and the accuracy of parameter estimates obtained from analysis of the afs. we focus on the importance of the number of sampled individuals rather than the number of snps, as the former can be directly controlled during experimental design, while the latter is the result of a combination of the underlying history of the population under consideration, the size of the genome, and the sequencing effort expended. in the following, we therefore use the term sample size to refer to the number of individuals genotyped, rather than the size of the genomic region surveyed. our results show that i) model selection and parameter estimation improve with larger sample sizes and ii) consistent with previous work  <cit> , recent demographic events are more challenging and require substantially larger sample sizes for accurate inference.

RESULTS
our simulation study was designed to assess the influence of sample size  on the power for model selection and the accuracy of parameter estimates obtained using diffusion approximations of the afs for one-  and two-population models . we were also interested in the power of approaches based on the afs to detect particular events or ongoing demographic processes. thus, the candidate models included evolutionary processes or events that might be of interest in empirical studies . we devised two parameterizations for each configuration, one where we expected the afs to contain adequate information for likelihood evaluations  and another that was designed to be more difficult for parameter estimation and model comparison . we simulated  <dig> replicate datasets per sample size under each model considered, for each of these two parameterizations . the akaike information criterion   <cit> , which includes a penalty for more highly parameterized models, and akaike weights  <cit>  were used to compare the relative fit of all candidate models to the simulated data . to assess the influences of sample size on the accuracy and precision of parameter estimates, we calculated the root mean squared error  for each parameter in each model and examined estimates of uncertainty in individual parameter estimates obtained from the hessian matrix . we discuss our results for one- and two-population settings separately below, and conclude with sampling recommendations for future empirical studies and a consideration of the limitations of our simulation-based assessment of statistical power for demographic inference from the afs.figure  <dig> 
single-population demographic models. simulated models included a constant size model , a model of population growth , a model of population decline , and a model involving a bottleneck followed by exponential growth . time moves from left  to right .
two-population demographic models. simulated models included a model of no divergence , a model of divergence in isolation , and a model of divergence with gene flow . the width of the bar is proportional to population size through time, with time moving from the bottom  to the top  of the plot.
parameter values used in single-population model simulations



parameter
constant
bottleneck
growth
decline

θ
a

η
d

η
g

t
values are given for both a  and b  parameterizations. parameters are ancestral θ, the magnitude of population decline  and growth , and the time of the demographic event .


a:set to produce roughly equal numbers of snps across models for a given sample size under the a parameterization .
parameter values used in two-population model simulations



parameter
no divergence
isolation
im

θ
a

s

η

t

m
12

m
21
values are given for both a  and b  parameterizations. parameters are ancestral θ, the proportion of the ancestral population founding population  <dig> , the ratio of current to ancestral size in each population , the time of the population split , and migration rates into population  <dig> from population  <dig> and vice versa .


a:set to produce roughly equal numbers of snps across models for a given sample size .



one-population models
model selection
for simulations of a single population, akaike weights, which give the proportional support for each of the candidate models , favoring the true  model increased with increasing sample size across most models and parameterizations considered, with some exceptions . these exceptions included the constant size model , the positive growth model  with ancient growth, and the bottleneck model  with ancient growth. in these cases, median akaike weights in favor of the simulated model were consistently high regardless of sample size . interestingly, for the bottleneck  model with recent growth , the true model typically was not strongly supported with sample sizes smaller than  <dig> diploid individuals. at these smaller sample sizes, the snm model  or the negg model  often received more support. however, there was very little separation in the log-likelihoods of the candidate models. in fact, the mean log-likelihood value of the bg model was the highest  of the candidate set across all simulated sample sizes. thus, much of the support for the simpler models  at smaller sample sizes resulted from the penalty imposed by aic on the more complex bg model.figure  <dig> 
confidence in model selection for single-population models. the distributions of akaike weights in favor of the true model are shown as boxplots versus sample size. both ancient  and recent  parameterizations are shown. the circle represents the median akaike weight, the box extends from the 25th percentile of the distribution to 75th percentile, lines include the range of values observed , and outliers  are plotted as asterisks.



the improvement associated with increases in sample size was realized at smaller numbers of individuals for models with ancient demographic events. for instance, data simulated under the negg model were easily identified across sample sizes and parameterizations . both recent and ancient declines were confidently identified  in the largest sample sizes considered . however, no replicate datasets with  <dig> or more individuals sampled had wnegg <  <dig>  in the ancient population decline model, compared to  <dig> replicates  with a more recent population decline. this illustrates the challenge posed for accurate model selection when considering recent demographic events.

our results were encouraging for model selection based on the afs, even for small samples in terms of the number of individuals genotyped. however, if demographic changes are very recent, the power for model selection is reduced, and large samples, in terms of both the number of individuals and the number of snps, may be required to confidently choose among competing demographic models  <cit> . additionally, with extremely small sample sizes, the log-likelihood values calculated from the afs are relatively small in magnitude . our results raise caution for application of penalized aic in these cases, as the penalty imposed on more complex models may be sufficient to obscure substantial support from spectra with few total cells.

parameter estimation
median parameter estimates from δaδi  <cit>  converged to their true values  as sample size increased, indicating that the parameter estimates were unbiased . across simulated models and sample sizes, the parameter estimates for most models, when fit to their simulated datasets, converged by our criterion  in fewer than  <dig> iterations. however, the more parameter-rich bg model with recent population growth and large samples  required an average of more than  <dig> fits to converge. interestingly, fits of the “wrong” models  also required additional iterations for convergence.

we used the root mean squared error  to assess the accuracy and precision of parameter estimates for the simulated datasets. parameter estimates for single-population models generally improved  with larger samples across the models and sample sizes simulated . as expected, rmse for parameters in simulations with recent demographic events were often larger than for data simulated under the same model with more ancient demographic events . overall, the gain in precision and accuracy associated with sampling more individuals was subject to diminishing returns with the rmse tending to level off above n =  <dig> to  <dig> for ancient events and above n =  <dig> to  <dig> for more recent demographic events . nonetheless, some improvement in parameter estimates  could be seen as sample size increased to  <dig> diploid individuals under the more complex models . in most cases, our results suggest that samples of  <dig> to  <dig> diploid individuals may be sufficient for afs-based demographic analysis of single-population genomic datasets. however, substantially larger sample sizes may lead to additional improvements in the accuracy and precision of parameter estimates from the afs .figure  <dig> 
accuracy of parameter estimates for single-population models. plots show rmse versus sample size for each of the four single-population models. both ancient  and recent  parameterizations are shown.



as a second way to quantify parameter estimation performance, we used the hessian matrix, which is the matrix of second-order partial derivatives of a function with respect to its parameters, to construct 95% confidence intervals  around the maximum-likelihood point estimates for the parameters of our models. in agreement with trends in the rmse, analyses of the hessian matrix demonstrated that uncertainty declined  for larger sample sizes, with the improvement in ci widths subject to diminishing returns as sample size increased . for ancient demographic events, much of the improvement in the width of 95% ci was seen in samples as small as n =  <dig>  in contrast, hessian uncertainties for parameters of models with recent events declined up to the largest population sizes simulated , suggesting that further increases in sample size might lead to additional improvements in the widths of 95% ci.

we further quantified the accuracy of inferences drawn from the afs by examining the coverage property of ci calculated from our parameter estimates and their associated uncertainties. coverage often increased with sample size, with three of the four models showing adequate coverage for all parameters at the largest sample sizes simulated . however, there were some cases of poor performance of confidence intervals. for instance, coverage of 95% ci for θ in the bg model with an ancient bottleneck was lowest at the largest sample size simulated . with more ancient events and excluding the bg model, 95% ci performed well, containing the true parameter value for all model parameters in more than 90% of replicates for datasets composed of  <dig> or more diploid individuals . for the bg model, both recent and ancient bottlenecks led to poor performance, and 95% ci contained the simulated value in far fewer replicates than expected. the poor performance of the ci for the bg model parameters may be the result of a combination of estimated ci that were too narrow and imprecision in parameter estimates that was exacerbated with more recent demographic events. all statistics associated with parameter estimates obtained for single-population models  are given in additional file 1: table s <dig> 

two-population models
model selection
similar to the pattern observed for simulations of single-population models, akaike weights in favor of the true model generally increased with increasing sample sizes across the simulated two-population models . an exception to this trend was seen for the iso model with recent divergence, which had median akaike weights >  <dig>  across all sample sizes considered. for both the iso and im models, akaike weights in favor of the true model at any given sample size were typically higher for models with ancient population divergence than for those with recent divergence. for example, under the im model, the median akaike weight reached  <dig>   at a sample size of n =  <dig> per population for models with more ancient divergence. similar performance was not realized for recent divergence until sample sizes of n =  <dig> per population . furthermore, the distribution of akaike weights under the more recent models of divergence  indicated that there was substantial support in favor of alternative models, even at relatively large sample sizes . for example, the interquartile range  of akaike weights for the iso model with recent divergence included values less than  <dig>  with n =  <dig> per population . the very recent nature of divergence in the b parameterizations was likely responsible for this trend, as models with moderate gene flow and strict isolation may not be identifiable at recent divergence. more generally, the ability to differentiate between divergence models with and without gene flow will decrease as the divergence time  and/or the migration rate  go to zero. due to problems achieving convergence of ml estimates for the im and iso models fit to some simulated datasets under our criterion , our assessment of model selection performance was limited to a slightly smaller number of total replicate datasets to which all models were successfully fit .figure  <dig> 
confidence in model selection for two-population models. the distributions of akaike weights in favor of the true model are shown as boxplots versus sample size. both ancient  and recent  parameterizations are shown. boxplots are constructed as in figure  <dig> 



parameter estimation
as in the single-population simulations, the accuracy and precision of parameter estimates improved with larger sample sizes, for both recent and ancient population divergence models . two-population models also converged more slowly to their maximum likelihood estimates when fit to data simulated under alternative models. for instance, fitting the im model to data simulated under the iso model with ancient divergence required, on average, more than  <dig> iterations for samples of  <dig> diploid individuals per population. parameter estimates were largely unbiased for the parameters and models considered and, in most cases, they converged to their simulated values in the larger sample sizes .figure  <dig> 
accuracy of parameter estimates for two-population models. plots show rmse versus sample size for each of the three two-population models. both ancient  and recent  parameterizations are shown.



one exception was seen in the estimates of parameters associated with population size changes during divergence  in datasets simulated under the iso model with recent divergence. in these cases, s was subject to a downward bias for all but the largest sample sizes, while η <dig> and η <dig> were biased high and low, respectively . these biases are likely related to the starting points used for optimization, the perturbation settings for the s parameter, and a flat likelihood surface. more specifically, the combination of the starting point for s  and the perturbation setting  caused the optimizer to only be initialized with s between  <dig>  and  <dig> . moreover, the optimizer was not driven to explore larger values of s because the likelihood surface is very flat with respect to s for data simulated under very recent divergence. we refit these data using a starting point of s =  <dig>  and allowing perturbation within 2-fold around this point. these revised settings eliminated the downward bias originally seen in s estimates for these datasets . median estimates of s were between  <dig>  and  <dig>  for all sample sizes. in practice, we suggest that perturbation settings be chosen to ensure that the starting points for optimization of model parameters extend beyond the range of values that the data constrain the model to. for empirical datasets, if optimization end points result in very similar likelihood values, even with very different parameter estimates, the likelihood surface may be flat over the region explored during optimization. in these cases, a broader range of starting points may help to correct potential biases in optimized parameter estimates.

for datasets with small sample sizes and thus large parameter uncertainties, inferred values of s, η <dig>  and η <dig> were correlated, suggesting that an acceptable “ridge” of parameter space exists, along which the parameter estimates associated with the proportion of the ancestral population that founded a derived population and the magnitude of expansion in that new population were correlated. for example, there were strong correlations in opposite directions between the estimated values of s and both η <dig>  and η <dig>  for datasets with  <dig> diploid individuals per population. this pattern is consistent with a range of possible divergence/growth scenarios that are each able to fit the data approximately equally well. this issue is not unique to δaδi  <cit> , as previous authors have noted problems distinguishing alternative demographic histories with data from the afs  <cit> . an additional  bias was noted for estimates of m <dig> for the largest datasets simulated  under the im model with recent population divergence . aside from these instances, median estimated parameter values approached their true values for sample sizes as small as n =  <dig> per population .

rmse for parameter estimates under models with recent divergence indicated that substantially larger sample sizes were needed for accurate parameter estimation in cases of recent isolation . for instance, for models that included ancient population divergence, much of the gain in accuracy and precision was achieved at relatively small sample sizes . however, with recent divergence rmse values for some parameters declined steadily across the sample sizes simulated . thus, it seems likely that parameter estimation for recent divergence models would continue to improve beyond the largest sample sizes simulated in our study.

in the im model with recent divergence , we included asymmetric migration between populations, which is known to result in bias when employing approaches that assume symmetry in migration rates  <cit> . interestingly, the direction of gene flow asymmetry  was recovered in more than 80% of the replicates across simulated sample sizes. given no useful information for estimation of these parameters, we would expect that approximately 50% of replicates would have estimated m <dig> larger than m <dig>  thus, it would seem that even when the parameter estimates and model likelihoods were largely unreliable , useful inference could still be gained for the direction of gene flow asymmetry. nonetheless, the ci for the two migration parameters overlapped in almost all instances for smaller sample sizes, indicating that the power of the method to confidently infer asymmetric migration was limited, particularly with recent divergence and small samples. by contrast, with n =  <dig> or  <dig> per population, confidence intervals for these two parameters often did not overlap, and the direction of asymmetry could be confidently inferred .

hessian estimates of uncertainty declined precipitously with increasing sample size across models for two-population simulations with ancient divergence . as was the case for rmse, much of the improvement in the uncertainty occurred as sample size reached three to five individuals per population. the more parameter-rich im model tended to have larger uncertainty estimates for a given parameter at each sample size than did the iso model , as might be expected given the difference in the number of parameters estimated from the data for these two models . as seen for the single-population models, coverage rates of 95% ci, based on hessian estimates of uncertainty, were often lower for parameterizations involving recent population divergence than for those with ancient divergence . for models involving older divergence, 95% ci performed relatively well, with true parameter values covered by ci at least 84% of the time for sample sizes of two diploid individuals or more per population. similar performance was noted for data simulated under recent divergence models, for at least some parameters , while 95% ci for others  displayed markedly lower coverage rates, resulting from a combination of parameter estimation bias  and underestimation of the width of ci. all statistics associated with parameter estimates obtained for two-population models  are given in additional file 1: table s <dig> 

extreme cases
in order to more fully explore the influence of sample size and the timing of demographic events on inferences drawn from the afs, we conduced three sets of additional simulations with parameter values and sample sizes more extreme than those considered in our full simulation study. for the single-population models explored, we included simulations under the a model parameterization but with substantially older demographic events . we expected that these datasets would be more difficult for parameter estimation and model selection, due to the substantially more ancient timing of the simulated events. we also further explored the influence of sample size in single-population models by simulating samples of  <dig> diploid individuals, as in the joint afs analyzed by  <cit> . finally, we tested the performance of afs-based inference for two-population models with extremely recent divergence . parameters for these additional simulations closely followed the a parameterization , but θ was altered to produce similar numbers of snps .

to verify that the afs from the diffusion approximation implemented in δaδi matched expectations, we compared the afs from δaδi with those obtained using the coalescent simulator ms  <cit>  for the extreme cases we considered. for the single-population models, the afs simulated in δaδi matched that from ms  <cit>  quite closely across the range of frequency categories for both ancient growth with moderate sample size  and more recent growth with extremely large sample size . furthermore, anscombe poisson residuals indicated no systematic bias across entries in the afs for  <dig> individuals . for the simulations involving large sample size, δaδi overestimates the number of snps in low frequency categories . as a post hoc assessment of the influence of this overestimation on parameter estimates from δaδi, we generated  <dig> replicate frequency spectra in ms  <cit>  under the same model , parameter values, and sample size . each replicate dataset simulated in ms was generated by combining  <dig> simulated loci  with θ =  <dig> . these datasets were then analyzed in δaδi to obtain maximum likelihood estimates for the parameters of the growth model. similar to the overall pattern observed for single-population spectra, simulated frequency spectra for a model of very recent population divergence  with a moderate sample size  agreed closely between ms and δaδi , but with slight overestimation of the number of rare variants falling along the diagonal of the joint afs and the opposite pattern for rare alleles with more divergent frequencies.

our simulations of older demographic events resulted in strong support in favor of the simulated model for three of the four models compared . median akaike weights from these datasets agree with previous results in that the bottleneck and growth models show substantial overlap in akaike weights. in fact, data simulated under the bottleneck model often showed more support for the exponential growth model . parameter estimates for the posg model in these cases suggest that a much older and larger expansion could produce similar patterns in the afs. median parameter estimates for the posg model fit to these datasets were t =  <dig>  and ηg =  <dig>  much larger than the simulated values of  <dig>  and  <dig>  respectively. parameter estimates obtained for fits of the correct model show substantially larger rmse for some parameters than similarly sized datasets with more recent divergence . thus, as expected, the quality of inferences obtained from the afs is reduced as demographic events become much older.

datasets simulated with larger sample sizes showed that, while our original simulations exhibited a pattern of diminishing returns with increasing sample sizes, there is still substantial room for improvement for all models if very large samples are collected. for the larger sample sizes , median akaike weights in favor of the true  model were higher in each case than for the competing candidate models . some overlap was evident in weights for the posg and bg models, when fit to data simulated under a model of exponential growth . in these cases, parameter estimates for the bg model closely matched those for the posg model, with ηd estimated near  <dig>  . notably, the posg model is a special case of the bg model where ηd =  <dig>  thus the good fit of the bg model in this case is not unexpected. rmse values for parameter estimates, given these large datasets, show improvement over those from the second largest datasets simulated in all but two cases , and in no cases were rmse values substantially larger than in previous simulations .

the overestimation of snp densities in rare frequency categories noted in the comparisons of simulated spectra does not appear to bias results from δaδi. median parameter estimates for ms-generated datasets were very close to the simulated values in all cases  and parameter rmse was only slightly elevated above that for datasets simulated in δaδi . thus, the minor discrepancies between ms and δaδi did not seriously impact the estimation of parameters for ms-generated datasets, suggesting that parameter estimates obtained for empirical datasets should be unbiased.

finally, we also simulated datasets with much more recent divergence between two populations  under the largest sample sizes considered in our previous simulations . given the reduced performance of our simulations as t declined from  <dig>  to  <dig> , we expected that these additional simulations would show more uncertainty in model selection and larger rmse for parameter estimates. model selection results showed that, even at such recent divergence, the snm and iso models could be confidently identified . however, the data simulated under the im model often gave more support to the iso model, probably as a result of the penalty imposed by aic on the im model . in  <dig> of the  <dig> simulated datasets, raw likelihood values were greater for the im model, by an average of just over one log-likelihood unit. parameter estimates were also more accurate and precise for the simpler models, with no evidence of severe biases for parameters of the snm and iso models. by contrast, in the im model, median estimates of parameters associated with population expansion  and migration  deviated substantially from their simulated values . parameter rmse calculated for the simpler models were generally comparable to those for recent  divergence models in similarly sized datasets . the time of divergence between populations  was accurately estimated for both the im and iso models; estimates for this parameter ranged from  <dig>  to  <dig>  across the  <dig> simulated datasets. thus, while the recent nature of divergence led to inaccuracy in estimates of several parameters, the performance of δaδi was better than expected for these datasets. given the results presented above for single-population datasets, it seems likely that larger sample sizes  would also improve parameter estimates in cases of very recent divergence.

sampling recommendations
our results show that optimal sampling strategies for afs-based inference are very much dependent on whether the underlying, and inherently unknown, evolutionary history involves recent or ancient demographic events. for instance, for projects examining patterns of divergence between populations or species with a long history of separation relative to their expected effective population sizes , large numbers of individuals may not be required. however, if interest lies primarily in estimating migration rates among populations recolonized since the last glacial maximum, substantially larger sample sizes may be necessary. based on our results, for demographic events occurring on the order of  <dig> na generations ago, samples of n =  <dig> for single-population datasets, and n =  <dig> per population for two-population datasets , would appear to be sufficient for accurate model selection and parameter estimation. on the other hand, if the sampled population has been subject to very recent or very ancient demographic events, larger samples will be necessary for confidence in model selection and parameter estimation. the influence of timing seen here is in agreement with previous work  <cit> . for instance, thousands of individuals may be required to detect the history of recent, explosive growth in the global human population  <cit> .

despite the importance of event timing on the performance of afs-based analyses, reasonable results could be obtained, even for the recent events simulated here, given moderate sample sizes. for single-population models with recent demographic events , samples of  <dig> or more diploid individuals resulted in the best performance for parameter estimation and model selection . similarly, parameters of the two-population iso and im models were most accurately estimated  at the largest sample size simulated . the im model did show lower coverage of confidence intervals, but rmse for all shared parameters was comparable between the im and iso models with recent divergence at the largest sample sizes . furthermore, simulated datasets with t =  <dig>  produced remarkably accurate estimates of t, despite bias in estimates of migration and expansion parameters. thus, our study shows that useful inferences can be gained through analysis of the afs, even for very recent demographic events and moderate demographic changes, given population-level samples of individuals.

caveats
the results presented above may be somewhat conservative for the ability of the afs to distinguish between alternative models. for instance, by setting the upper bound for optimization of the parameter ηd at  <dig>  for the bg model, our analysis allows the bg model to fit data simulated under the posg model . similarly, iso and im models with very recent times of divergence should provide good fits to data simulated under the snm model . in other words, there are inherent model overlaps and identifiability dynamics that may allow researchers to obtain useful parameter estimates even if one selects the wrong model. furthermore, it is likely that akaike weights would improve if the bounds for parameter optimization were more tightly constrained for key parameters. limiting the estimation of the bottleneck severity parameter  in the bg model to smaller values would likely serve to increase the akaike weight in favor of the posg model, when comparisons are made in data simulated under the latter history. with this limitation, the bg model would be forced to include a substantial bottleneck, rather than allowing the population to maintain near constant size before the initiation of exponential growth.

the use of composite likelihoods in afs-based inference assumes that snp loci in the sample are independent and unlinked. strictly speaking, this is an unrealistic assumption, as physical linkage between sites, particularly those located on the same genomic fragment , is a certainty. however, composite likelihoods have been shown to be consistent estimators across a range of population models  <cit> . while the expectation of the afs is accurately recovered using composite likelihoods, ignoring linkage among sites results in underestimating the variance of the afs  <cit> . therefore, parameter estimates should be unbiased, but associated confidence intervals are not reliably calibrated  <cit>  and the support for the best model may be overestimated in model comparisons based on composite likelihoods  <cit> . this bias should not affect our results, as our simulated data meet the key assumption of snp independence. for empirical datasets collected from natural populations, bootstrap replicates can be used to approximate confidence intervals around parameter estimates  <cit> , and modifications to aic can help correct for biases in model selection  <cit> .

our simulations ignored the influences of selection on model selection and parameter estimation from the afs. in empirical datasets, the inclusion of snp loci under selection could bias results in a variety of ways, depending on the nature of selection acting on the loci. for instance, selective sweeps would remove variation from the population and leave similar patterns to those expected after expansion from a bottleneck. in practice, the underlying demography can be estimated from a putatively neutral subset of the afs , assuming that hitchhiking via linkage to selected regions has not affected snp frequencies of the subset. then, demographic parameter estimates from this analysis can be used to set critical values for selection scans to identify snp loci that deviate from expectations  <cit> . however, if the primary goal of the analysis is to estimate population demography, ignoring the influences of selection could result in biased estimates for demographic parameters. this may be more of a concern with widespread purifying selection in the genome than for selective sweeps at a limited number of loci, as the latter would likely result in less overall bias.

our recent parameterizations were designed to pose substantial difficulty to inference from the afs. as such, the recent parameterizations for single-population models included more relaxed population size changes, but the same θ values used for models with more ancient demographic events. thus, the influence of the timing of events on model selection and parameter estimation is confounded with the severity of the demographic changes modeled and the number of snps in the sample . it is likely that the power for model selection would increase given more severe bottlenecks or greater population growth, even in models with very recent demographic events.

it is important to note that the quality and reliability of demographic parameter estimates from the afs are inherently linked to the quality of the genotype calls resulting from the sequencing technology employed. in particular, low-coverage genomic data may pose problems for inference from the afs. in these datasets, sufficient coverage may not be available to confidently identify variable sites and exclude sequencing errors. if not properly accounted for, these errors can lead to inaccurate genotype calls and biased allele frequency estimates, reducing the reliability of demographic inferences drawn from these data  <cit> . for instance, simulated datasets  showed a bias toward more recent population growth in the afs from low-coverage  genomic data  <cit> . nonetheless, methods have recently been developed to directly infer the afs, without the need for snp or genotype calling, from next-generation sequence data  <cit> . such methods may provide a more robust estimate of the afs for low-coverage genomic sequencing datasets and eliminate potential biases in demographic inferences from these data.

in general, simulation studies are blunt instruments for the assessment of statistical methods  <cit> . thus the applicability of the results from our simulation study is fundamentally limited by our range of demographic models and sample sizes simulated. furthermore, our analysis is based on a limited number of replicates per model and parameter combination , making our estimate of performance a monte carlo approximation given finite computational resources. our requirement that three parameter optimizations produced model likelihoods within five log-likelihood units of the maximum likelihood  greatly increased the computational burden associated with parameter optimization. when fitting the bg model to datasets simulated with a recent bottleneck and  <dig> individuals sampled, this requirement led to an average of more than  <dig> optimizations per dataset . the number of parameter optimizations necessary to achieve convergence under this criterion became even larger in other cases. for the bg model fit to data simulated under an ancient exponential population decline  with n =  <dig>  convergence required an average of more than  <dig> optimizations per replicate . generally, long convergence times may indicate a poor fit of the model to the data, as  convergence for the simulated model was typically faster. other approaches, which coarsen the afs  <cit>  by combining entries, may converge more reliably, but such coarsening may also reduce statistical power.

CONCLUSIONS
previous studies have found that large sample sizes are required for confidence in model selection and parameter estimation given recent population growth  <cit> . however, the influence of sample size was model-dependent. for instance, increasing sample size above  <dig> diploid individuals per population did not substantially affect demographic parameter inference in a model of population divergence in isolation  <cit> . the results from our simulation study agreed with previous work focusing on the impacts of sample size and/or the timing of demographic events on the accuracy of inferences drawn from analysis of the afs  <cit> , in that more ancient demographic events  typically allowed for increased confidence in model selection and parameter estimation. however, very old demographic events  also posed difficulty for inference based on the afs, as the signal of a past demographic event is lost as populations approach mutation-drift equilibrium. generally, improvements in both model selection and parameter estimation analyses were subject to diminishing returns as sample size increased, but much larger sample sizes still led to more accurate parameter estimates and model selection. thus, when large sample sizes are attainable, more complex models involving much more recent demographic events may still be successfully analyzed using the afs. while our simulation study is inherently limited by the range of models and sample sizes considered, our results illustrate the promise of afs-based methods like δaδi  <cit> , jaatha  <cit> , multipop  <cit> , and fastsimcoal <dig>  <cit>  for demographic inference and highlight the importance of collecting large population-level genomic samples for analyses of the afs, particularly when interest lies in estimating parameter values associated with recent demographic changes.

