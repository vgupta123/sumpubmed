BACKGROUND
biological systems are naturally multiscale and to understand their behaviour fully we must understand the interaction of a number of processes that may occur on diverse temporal and spatial scales. to gain insight into such multiprocess and multiscale systems, there is a range of modelling frameworks that could potentially be employed. different modelling approaches serve to highlight certain aspects of a biological system, and which modelling approach is most appropriate depends on the biological questions that are being addressed, as well as on the available data that could be used to calibrate or validate a given model. in this paper, we present several modelling approaches and show how these can be used to gain understanding of a realistic multiscale systems biology problem. we compare the different modelling approaches to each other and discuss their applicability.

to compare the modelling approaches, we focus on a particular case study: the transport of the hormone auxin through a file of plant cells. auxin plays a major role in many aspects of plant growth and development  <cit> . it moves through the plant in a polar manner due to non-uniform spatial distributions of active influx and efflux carriers on the cell membranes  <cit> , and the resulting auxin distributions influence a wide range of processes, including organ initiation  <cit> , vein formation  <cit>  and gravitropism  <cit> . modelling auxin transport is thus an active research area in plant systems biology. the models are inherently multiscale, as cell-scale processes lead to tissue-scale phenomena. to date, the majority of modelling in this area computes solutions by simulating large systems of deterministic ordinary differential equations  <cit> , and there are relatively few examples of alternative modelling techniques  <cit> . this paper complements such previous work by highlighting the benefits of using multiple modelling techniques to gain a more comprehensive understanding of a biological system, in this case auxin transport in plant tissue.

mathematical modelling is routinely used to study biological phenomena quantitatively, often by describing the dominant physical processes using systems of coupled differential equations and solving these governing equations using analytical and numerical methods; such techniques have been used to study a diverse range of biological processes, including population dynamics, pattern formation, neuron firing and physiological flows . mathematical models have denotational semantics in that they represent relationships between quantities as systems of equations. in contrast, computational, or executable, models have operational semantics, and define rules that describe how the modelled system moves from one state to the next  <cit> . computational models are executed in the sense that, starting from an initial state, a procedure  determines the next reaction to apply. this reaction is then applied, giving a new system state, which is then used by the simulation algorithm to determine the next rule to apply, in an iterative procedure. stochastic processes, unlike their deterministic counterparts, involve an indeterminancy in the evolution of the state of the system. for large numbers of molecules, this stochasticity may be averaged out, giving what appears to be a deterministic process; however, when a small number of molecules is involved, stochastic effects become evident, and in such cases the system may behave in a markedly different way. the inherent noise present in all biological systems is explicitly modelled in discrete stochastic models and can have profound effects on system dynamics, producing behaviour, even for large numbers of molecules, which is markedly different from that predicted by continuous deterministic models; see, for example,  <cit> .

after summarising the biological abstraction which forms a common basis for the models presented in this paper, we describe a stochastic computational model based around a p system framework. here the number of auxin molecules in each compartment evolves according to rules that move molecules from one compartment to the next. we then describe a deterministic mathematical model in which the auxin concentrations are described by a system of coupled ordinary differential equations. in the deterministic case, we produce two solutions: i) analytical solutions, derived using multiscale asymptotic approaches, and ii) numerical solutions, as is typical in current auxin-transport modelling.

methods
biological abstraction
to investigate the benefits of deterministic and stochastic modelling approaches, we focus on a model of auxin transport. specifically, we model a standard experiment that is used to determine auxin velocities: radio-labelled auxin is added to a source agar block at one end of a segment of stem tissue, auxin then travels through the stem segment, and experimentalists measure the amount of auxin collected in a final agar block at the other end of the stem segment .

as shown in figure  <dig>  we model the stem segment as a single two-dimensional line of n cells, where each cell contains a cytoplasm , and there is a layer of apoplast between neighbouring cytoplasms . hence the total length of the stem segment is l = nl + λ. the model assumes that the auxin concentration within each compartment is uniform, which is a reasonable assumption given the small size of the compartments and the rapidity of auxin diffusion.

we suppose that the two agar blocks are rectangular, with length ls and width w. we denote the number of auxin molecules in the source agar block by sn and the number in the collecting agar block by fn, where the superscript n emphasises that these quantities are numbers of molecules; the concentrations  in the two agar blocks are then given by s = sn/ and f = fn/, respectively. we suppose that auxin diffuses within the agar blocks with diffusion coefficient d. auxin in the source agar block diffuses into the adjacent root apoplast region; it then travels through the line of n cells and diffuses from the final apoplast region into the collecting agar block. we denote the number of molecules in the cytoplasm by  for i =  <dig>   <dig>  ..., n, and the number in the adjacent apoplast by  for j =  <dig>   <dig>   <dig>  ... n, with the corresponding auxin concentrations given by ci = / and ai = / .

auxin exists in planta in either an anionic or a protonated form. following previous auxin-transport models, we assume that auxin molecules rapidly associate or dissociate, so that the proportion of these two forms are in equilibrium and are determined by the ph of the region in which it is located and by the auxin dissociation constant, pk. using the subscripts c and a to refer to the cytoplasm and apoplast respectively, the fractions of protonated and anionic auxin are given by  <cit>    

in the line of cells, auxin moves between the apoplast and cytoplasms by crossing the cell membrane. the flux of protonated auxin across the membrane, jdiff, is passive, whereas the flux of anionic auxin is mediated by pin efflux carriers that are present on the downstream face of each cell membrane ; following  <cit> , we model the anionic flux across the cell membrane, jpin, using goldman-hodgkin-katz theory . thus, the components of the flux from the cytoplasm ci to the apoplast ai are given by   

where   

and pdiff is the membrane permeability of protonated auxin, ppin is the membrane permeability of anionic auxin, and the dimensionless constant ϕ ≡ -fdv/rt where fd is the faraday constant, v is the membrane potential, r is the gas constant, and t is the temperature.

at time t =  <dig>  all the auxin molecules are in the source agar block; we prescribe sn = c, and let  =  = fn =  <dig> for i =  <dig>   <dig>  ... n and j =  <dig>   <dig>   <dig>  ... n. we model a closed system, that is, we assume that, during the subsequent auxin movement, no auxin molecules enter or leave the system. table  <dig> summarises estimates of the model parameters based on values reported in the biological literature; these are discussed further in the "biological parameter estimates" section of additional file  <dig> 

parameters used for both the stochastic and deterministic models.

stochastic computational model
to obtain stochastic solutions, we use a multi-compartment stochastic p system framework  <cit> . individual molecules of auxin are modelled as objects which move between compartments according to a set of rules associated with each compartment. compartments of the same type have the same set of rules associated with them, and each rule has an associated stochastic reaction constant k which determines the rate at which the rule transports molecules . we define rules for auxin diffusion between source/collecting blocks and the apoplast, membrane diffusion from apoplast to cytoplasm, and carrier-mediated efflux from cytoplasm to apoplast. these reaction constants are related to the parameters given in table  <dig> via   

molecules a of auxin are transported from compartment i to a neighbouring compartment at rates k which depend on the type of transport process. for apoplasts, rules r <dig> and r <dig> are assigned to apoplasts bordered on both sides by cytoplasms. rule r <dig> replaces rule r <dig> for the first apoplast, and r <dig> replaces r <dig> for the final apoplast, which are bordered by the source and collecting agar block respectively.

. we note that in this framework we set the small parameter  to zero to enable efficient execution. the computational model is executed using a novel multi-compartment monte carlo stochastic algorithm using the mcss simulator, which is part of the infobiotics workbench, a freely available software suite for designing, simulating and analysing multiscale executable systems and synthetic biology models  <cit> . stochastic algorithms and software supporting multiple compartments have been developed by several research groups  <cit> . a key difference between these algorithms and our software suite is that our tools support the rapid prototyping of models by facilitating the abstraction of commonly occurring motifs  with model templates and modules. this, coupled with the facility to explicitly specify a tissue geometry, permits the seamless exploration of "what if " scenarios during model building. for example, to reproduce the behaviour of a mutant which does not produce a particular protein, all that needs to be done is to set the rate constant of the reaction producing the protein to zero. or, for example, to remove a particular regulatory mechanism, we can simply remove the module representing this regulatory mechanism from the list of modules employed by a particular compartment. the reader is referred to  <cit>  for an in-depth description of the stochastic simulation algorithm we employ, which we briefly summarise here. essentially, the simulation algorithm determines, within each of the simulated compartments, which rule to apply next and when to apply it. this highlights the key difference between mathematical and computational  models - mathematical equations describe the change in the values of variable as a system moves from one state to the next, while computational models expose how and why this state change occurs  <cit> . each run of the simulation gives one possible trajectory of the model through state space. hence, as well as using individual runs to examine the reasons for state changes, we can execute the model a number of times to estimate the average system behaviour, analyse the system's variability, and identify potential extreme behaviours.

additionally, the computational model enables model checking, the formal verification of model behaviour, which allows the identification of general biological principles which underlie the observed behaviour of the model  <cit> . using algorithms such as those presented in  <cit> , the computational model also facilitates model parameter and structural optimisation, allowing incomplete biological information regarding, for example, model parameter settings and structure, to be established automatically.

deterministic mathematical model
in the deterministic framework, the auxin concentration in each region is governed by the following system of equations   

for i =  <dig>   <dig>  ..., n and j =  <dig>   <dig>  ..., n -  <dig>  the dynamics described by  are analogous to the reactions in , as shown in the "model derivations" section of additional file  <dig>  we assume that initially all the auxin molecules are in the source agar block, therefore s = c/lsw, ci = aj = f =  <dig> at t =  <dig> for i =  <dig>   <dig>  ... n and j =  <dig>   <dig>   <dig>  ... n.

we now use asymptotic methods to derive an analytical solution for these governing equations, : these explicitly contain at least two distinct length scales, namely the cell length scale, l, and the  tissue length scale, l = nl + λ, - it is this multiscale aspect that we exploit in deriving a continuum formulation. for comparison, we also solve the deterministic governing equations numerically using matlab's ordinary differential equation solver, ode <dig>  to obtain an analytical solution, we consider the dynamics on the time scale of active transport the length of the tissue, l/ppin, and nondimensionalise using   

the model then depends on the dimensionless parameters   

to make analytical progress, we construct an asymptotic solution in the biologically appropriate limit in which ϵ is small, i.e. the length scale l of the tissue is much larger than that of a single cell, l + λ, expanding the concentrations as standard perturbation series. based on the biologically relevant parameter estimates in table  <dig>  we assume that the relative length of the agar blocks,  = o as ϵ → 0+, and rescale the small parameters   

where  and  are o as ϵ → 0+. in the stem segment, the result is a continuum limit. letting x measure the length along the tissue, such that x = ϵi, we consider ci = c, ai = a, where x =  <dig> corresponds to the upper face of cytoplasm i =  <dig> 

based on these assumptions, we can derive formulae for the leading-order auxin concentration in each compartment . we identify two time scales. on the transport time scale,  = o, the source-agar-block concentration does not deplete significantly,  ≈  <dig>  and auxin travels through the stem segment with a defined front according to a wave equation, with effective velocity   

the sink-agar-block concentration is small, and given by   

on a longer time scale, , the cytoplasm concentrations in the stem segment are uniform, and the agar-block concentrations are given by   

therefore, diffusion within the agar blocks determines the rates at which the source-agar-block concentration depletes and the sink-agar-block concentration increases.

RESULTS
auxin concentrations
for both the deterministic and stochastic frameworks, the relative auxin concentrations in the source agar block, collecting agar block, cytoplasm and apoplast regions are shown in figure  <dig>  for the stochastic model, we show both the mean concentrations and the 95% confidence intervals . to compare quantitatively the solutions of the deterministic and stochastic models, we compute the time taken for the agar-block concentrations to reach half their steady-state levels. these results, given in table  <dig> and figure  <dig>  demonstrate excellent agreement between the three modelling approaches.

time taken to reach half the steady-state concentrations for the deterministic and stochastic models. 95% confidence intervals are also given for the stochastic model.

computational models, because of their algorithmic specification, are amenable to model checking. model checking allows formal verification that a model satisfies a prescribed property. properties are propositions about the state of the model, for example, the amount of species a that reaches a level x. for the computational model, we used the infobiotics workbench to perform probabilistic model checking and formally determine the probability of the agar-block concentrations reaching half their steady-state levels. due to computational constraints, we check a reduced version of the computational model . figure  <dig> shows that, with 95% confidence, after  <dig> minutes both the agar-block concentrations will have reached half their steady state, and that the source-agar-block will reach its steady-state concentration slightly before the collecting agar block. to characterise when the deterministic and stochastic models agree and differ, we subtract the concentration predicted by the analytical deterministic model from the mean concentration predicted by the stochastic model and divide this value by the standard error given by the stochastic model; the predicted concentrations are then considered to differ significantly if the absolute value of the result is greater than two, that is, if the difference between the two predicted concentrations is greater than two standard errors. figure  <dig> shows that there is no significant difference between the source concentrations predicted by the deterministic and stochastic models. in contrast, in the collecting agar block there is a significant difference for the initial  <dig> seconds, with a maximum difference of six standard errors. the deterministic approach takes the concentrations to be continuous while the stochastic model considers individual molecules. as a result, for the first  <dig> seconds, the stochastic model typically predicts a zero concentration, whereas the deterministic model predicts a small positive concentration. as shown in figure  <dig>  for the remaining time, although not significantly different, the stochastic model consistently predicts larger concentrations than the deterministic one.

to assess how the initial source concentration affects the variability of the auxin concentrations, we performed  <dig>  runs of the stochastic computational model with initial concentrations of  <dig>  nm and  <dig> nm . the mean variability and its standard deviation in all compartment types decreases by around 69% as the initial concentration is increased from  <dig>  nm to  <dig> nm. theoretically, the amount of noise in a stochastic simulation is of the order of , where n is the number of molecules  <cit> . since  ≈  <dig> , we would theoretically expect a 69% decrease in noise, in agreement with the simulation results.

variability of concentrations observed in the stochastic computational model for different initial concentrations. each column gives the mean and standard deviation of the standard deviation of auxin concentrations observed.

model applicability
selecting the appropriate modelling approach for a given problem involves a number of factors including a researcher's judgement of the time available for model development and the computational resources available. a key factor is the understanding they wish to obtain, for example, arriving at the best possible model for a given system , or generating alternative plausible models representing competing experimental hypothesis . although difficult to give all-encompassing guidelines, in this section we briefly discuss general practical considerations arising from our case study that are involved in determining an appropriate modelling approach.

the stochastic computational model needs to be executed many times to assess the average behaviour of the system for a given set of parameter values, and therefore the computational cost of solving the stochastic model will generally be greater than that of the deterministic model. the execution time of the computational model depends on the values assigned to the reaction constants and the initial numbers of molecules present in the system . table  <dig> summarises the time taken to execute the computational model for several initial concentrations, and compares these execution times with the time taken to solve the deterministic numerical model. tests were performed on a single processor  - using multiple processors would reduce these execution times. as shown in table  <dig>  as expected, the execution time of the stochastic model increases as the initial number of molecules increases. for initial auxin concentration above  <dig> nm, the stochastic model will take a considerable amount of time, and therefore in this case it would be advisable to use a deterministic approach. in contrast, the asymptotic solution of the mathematical model does not involve any computational cost . however, the computational execution time does not reflect the true time taken to obtain the solution, as deriving the asymptotic formulae may take longer than producing the numerical or stochastic models.

for the stochastic model, the execution time is the time required to perform  <dig>  runs and depends on the total number of molecules present .

when considering the time costs of different modelling approaches, a key consideration is the number of different parameter choices one wishes to investigate. the formulae from the analytical approach clearly show how the parameter estimates affect the predicted concentrations and transport speeds provided the scaling, , holds. however, we would need to derive a new asymptotic solution if we wanted to consider different parameter regimes. in addition, the asymptotic method presented here is can only be applied if we can consider the tissue to be a continuum, which is only appropriate if the rate of transport between the cells is not too small  <cit> . using the numerical deterministic and stochastic approaches, one can use any parameter values in the simulations by making simple changes to the numerical code without changes to the underlying model. however, using these methods, we would need to execute many simulations to thoroughly understand how the dynamics are affected by the parameter values, which needs to be balanced with the increased execution time for the stochastic model for certain parameter regimes.

in summary, the asymptotic model is applicable only to the specific parameter regime for which it was derived, but allows rapid evaluation of the behaviour of the model within these bounds. however, to explore model behaviour outside of the given parameter regime, the asymptotic solution will need to be derived anew. the stochastic computational model allows any parameter regime or spatial scaling to be explored without further reformulation of the model and formally captures the mechanisms involved in producing a given phenotype. for some regimes the execution time of the model will be considerable, although this time can be ameliorated through the application of more computational resources or parallel computation.

auxin-transport speed
auxin-transport experiments aim to investigate the movement of auxin through plant tissue. we have modelled an experimental protocol, as described in  <cit> , that has been used to consider both the distance moved by auxin molecules per unit time  and the amount of auxin passing through the tissue per unit time . in the deterministic model, auxin from the source agar block moves through the tissue with a defined front, and the asymptotic solutions provide a simple formula for the speed of transport . however, in practice there will be stochasticity in the auxin movement. the stochastic model predicts when the first auxin molecule appears in the collecting agar block, and the transport speed can be calculated by dividing the total length of the stem segment, l, by the average time taken for the first molecule of auxin to appear in the collecting agar block .

the results, summarised in table  <dig>  show that the stochastic approach predicts a greater auxin-transport speed  than the asymptotic deterministic solution . we note that this discrepancy is in agreement with the discussions in "auxin concentrations" section above where we showed that the different modelling frameworks predicted significantly different concentrations in the collecting agar block at early times.

auxin-transport speeds for the deterministic  and stochastic models. 95% confidence intervals are also given for the stochastic model.

auxin velocities are generally thought to be around  <dig> cm·h- <dig>  which is fairly close to our predictions, given that the velocity depends on the parameter estimate for ppin and this value is not well characterised. one reason for the difference between the experimental auxin velocity and the model predictions may be differences in auxin detection sensitivity between the wet experiments and models. the stochastic model enables us to predict the time at which the first molecule of auxin enters the collecting agar block. however, in the wet experiments, a certain amount of auxin must accrue in this agar block before detection is possible. we can estimate the amount of auxin present in the collecting block from our models. if we consider an experiment with  <dig>   <dig> molecules of auxin and assume that, in line with experimental results, the auxin-transport speed is  <dig> cm·h- <dig>  then the time taken for auxin to travel the length of the stem segment is  <dig>  s . the deterministic model gives the number of molecules in the collecting agar block at this time to be  <dig> and  <dig> from the numerical and asymptotic solutions respectively . the mean number of auxin molecules at this time in the collecting agar block calculated over  <dig>  runs of the stochastic model is  <dig>  ±  <dig> . thus, to determine accurately the presence of auxin in the collecting agar block, the experimental apparatus used must have a sensitivity of  <dig>  pm for an agar block of the same size as we simulated, and a finer resolution for larger agar blocks.

as discussed in  <cit> , the majority of auxin-transport measurements report the flux of auxin transport rather than the auxin velocity and so consider the amount of auxin that has moved through a specified distance of tissue in a constant amount of time. however, the asymptotic solutions of the deterministic model demonstrate that diffusion within the agar blocks may significantly affect the auxin concentration within the collecting agar block, and therefore the auxin fluxes measured. the analysis presented in the "derivation of asymptotic solution" section of additional file  <dig> shows that there are two disparate time scales: on a short time scale, auxin is transported through the stem segment, whereas over longer ones, the auxin concentrations are almost uniform throughout the stem segment, and the dynamics are dominated by diffusion within the agar. it is clearly important to be aware of these two processes when interpreting experimental results. if an auxin-transport experiment were carried out over several hours, the auxin concentration in the collecting agar block would be determined predominantly by the diffusion rate. we emphasise that these conclusions are based on the assumption that the agar-block length is comparable to the stem-segment length - the effect of diffusion within the agar blocks will be less significant with smaller agar blocks.

CONCLUSIONS
in systems biology, models are typically deterministic and a biological problem is translated into large systems of ordinary differential equations that are solved numerically. however, this is not the only option, and in this paper we have demonstrated three different modelling approaches:  deterministic numerical;  deterministic asymptotic; and  stochastic computational. as expected, particularly given that the dynamics can be described by a system of linear governing equations, there is excellent agreement between the three methods.

we have focussed our case study on auxin transport, as this is inherently multiscale with cell-scale dynamics creating the tissue-scale phenomena of interest. the numerical, deterministic method focusses on computing the cell-scale dynamics, whereas the asymptotic method makes use of the multiscale nature of the system: in the asymptotic results, we consider the auxin concentrations on the cell scale, and exploit the relatively small dimensions of the cells to determine how the cell-scale dynamics lead to effective tissue-scale behaviour. the stochastic computational model simulates the interaction of auxin at a molecular scale and, by analysing the gross movement of auxin from one compartment to the next, allows us to determine auxin dynamics at the tissue scale based on the mechanistic interactions of auxin at the molecular scale.

the model results enable us to highlight the advantages of each approach. we solved the stochastic version of the model using a p system framework: the model is written in terms of numbers of molecules and we prescribe the probability of a molecule moving between compartments. p systems are highly intuitive, and an excellent way of engaging with a biological audience. the stochastic model generates in particular both the mean and the standard deviation of the auxin concentrations, which enables us to characterise the expected variability. we also solved the model by deriving deterministic ordinary differential equations and using asymptotic methods to obtain formulae for the auxin concentrations and transport speeds. this method requires careful analysis to determine the dominant processes on each time scale, and the resulting expressions show clearly how the model parameters affect the predicted auxin concentrations and speeds. although numerically solving the deterministic version of the model is often the quickest method of producing a solution, stochastic p system models and asymptotic analysis can provide additional insight and information that can complement, or be an alternative, to a deterministic numerical solution. the results also highlight how the experimental set up may lead to potential discrepancies between the measured auxin velocities, and, in particular, how the measured velocities will be affected by diffusion within the agar block. auxin speeds are generally assessed by measuring the number of auxin molecules in the collecting agar block; however, we showed that on long time scales the auxin concentration in the agar block depends on the agar-block length, and the formulae for the auxin velocity and collecting-block concentration  are clearly not related. we could gain further understanding of the biological implications of this result by extending the model to incorporate a more accurate representation of the stem segment, for example by modelling multiple cell files with tissue-specific active transport.

authors' contributions
jt and lrb conceived and designed the models and experiments, performed the experiments, analysed the results, and drafted the manuscript. jt wrote the software to simulate the stochastic model and produced the stochastic solutions, whereas lrb produced the deterministic solutions. nk and jrk contributed to the conception and design of the models and experiments, and analysis of the results, and nk, jrk and mjb helped draft the manuscript and attracted funds for carrying out this work. all authors read and approved the final manuscript.

supplementary material
additional file 1
further model details. this document  provides supporting information for the main text, and gives further details on the biological parameter estimates used in the model; the derivation of the stochastic reaction constants and the related equations that governing the deterministic model; the model checking of the stochastic computational model; and the asymptotic solution.

click here for file

 acknowledgements
we would like to thank jonathan blakes, alain delbarre, eric kramer, and francisco romero-campero for their help during the preparation of this manuscript. this work was conducted in the centre for plant integrative biology, university of nottingham, u.k., which is jointly funded by the bbsrc/epsrc  as part of their systems biology initiative. nk would also like to acknowledge funding from epsrc ep/e017215/ <dig> and bbsrc bb/f01855x/ <dig>  and jrk from the royal society and wolfson foundation.
