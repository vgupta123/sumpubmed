BACKGROUND
in microarray data analysis, hypotheses relating to differential expression of many genes across the experimental conditions are tested simultaneously. typical research questions examine the effects of disease status and drug response on the expression of each gene. an extremely large number of e.g. >40k genes can be currently represented on a microarray, so that its statistical results must be carefully analyzed taking a false positive error rate and multiple comparison issues into account. in order to control such a false-positive rate, traditional statistical methods often control the family-wise error rate , the probability of incorrectly accepting at least one false-positive hypothesis  among all hypotheses; for example, the commonly-used bonferroni correction divides the type i error α by the total number of hypotheses for the test of each gene's differential expression, assuming the hypotheses under consideration are independent  <cit> . however, this independence assumption is unlikely to be true in microarray data, as functions of many genes are interrelated in varying degrees. moreover, the methods controlling fwer are frequently found to be too conservative to identify many important genes in biological applications  <cit> . several authors  have developed step-down procedures that apply the severe bonferroni correction only to the most extreme value of the test statistic, and step down the correction with the value of the test statistic. however, these methods still result in high false-negative error, likely missing many genes that are truly differentially expressed.

benjamini and hochberg   <cit>  suggested that controlling false discovery rate , the expected proportion of false positives among all positive  hypotheses, is more appropriate for large screening problems. benjamini and yekutieli   <cit>  proposed a new fdr procedure considering a certain dependency structure among the test statistics. however, both the bh and by procedures may still be too conservative when applied to real microarray data analysis  <cit> . this is mainly due to the fact that the independence or the artificial dependency assumptions made in these approaches may not be supported in real microarray data applications. furthermore, microarray experiments are often conducted with a small number of replicates due to limited availability of rna samples and/or budgetary constraints  <cit> .

one of the key issues in estimating fdr is the assumption regarding the underlying null distribution. the significance analysis of microarrays  method  <cit>  uses a full permutation strategy, sampling across all genes and conditions to generate such a null distribution . however, this strategy breaks many intrinsic correlation structures and does not generate a realistic or biologically-relevant null distribution for microarray data . chip-by-chip permutation strategies  <cit> , which randomly shuffle all the columns  and preserve gene structure, are not applicable when the sample size is small because the number of independent permutations is too small to generate a null distribution with enough granularity to support desired significance calculations. in order to provide more stable estimation of such fdr values, a method based on the spacings loess histogram  was also proposed based on a certain assumption about the p-value distribution  <cit> .

in order to overcome these restrictions, we propose a rank-invariant resampling  approach to fdr estimation, especially for microarray data with a small number of replicates. in particular, we use the local pooled error  test  <cit> , which has high statistical power in analyzing low-replicate microarray data, as a tool for discovery of differential expression. in brief, the lpe approach is based on a model for variance as a function of mean expression intensity, shrinking observed within-gene error estimates by pooling error information of other genes in local intensity ranges and characterizing the variance function by a non-parametric smoother in order to improve the accuracy of error estimation in small sample microarray data analysis. consequently, the lpe approach provides a dramatically higher statistical power than other within-gene test methods, such as sam and two-sample tests, for identifying differentially expressed genes in microarray data with limited replication. we compare the performance of our approach with that of four other approaches – bh, by, mix-all, and splosh, using both simulated and real microarray data sets.

RESULTS
simulation study
we first investigate whether the proposed resampling method provides a realistic null distribution. we generate a set of null data from a real array data set by the proposed resampling method and the mix-all method. figure  <dig> displays array-by-array scatter plots of null data from both methods in the from of the so-called a  versus m  transformation. first, the scatter plots  and  by our rir algorithm show heterogeneous error variances on different intensity ranges assimilating those in the original microarray data quite well. on the other hand, the plots  and  show much bigger, yet homogeneous error variances regardless of the intensity levels, which are considerably different from those in the real data. for comparing the fdr estimation methods, we generate simulated data as follows. instead of certain  distributional assumptions about microarray data, we use real microarray data to obtain such data. that is, let x <dig> and x <dig> be log2-transformed and normalized data from the replicated chips on the same experimental condition of a microarray study. we first compute m  and a /2), and then divide the intensity range of a into  <dig> intervals. let  be the maximum of  m in each interval and Ã is the corresponding a. then, for equivalently expressed genes, we use means and variances under two different experimental conditions at each interval for our generation of null data. for each of differentially expressed genes, we derive its two means  under two different conditions using equations: / <dig> = Ã and  = δ, where δ is a factor determining the degree of differential expression. in this paper, we use it δ =  <dig> ; more discussion about this selection can be found in the discussion section below. the corresponding variances are obtained from lpe baseline variance estimates. for our simulation study, we generate expression intensities of triplicate arrays with  <dig>  genes under each of two conditions with 5%, 10%, 20%, or 50% differentially expressed genes. for example, the bland-altman plot  of a simulated data set with 10% differentially expressed genes is displayed in figure  <dig>  in which differentially expressed genes are shown in the upper or lower boundaries as points marked with red x's. the above non-parametric, adaptive generation of simulated data has been found to provide the most realistic microarray data and differential expression pattern of many data generation methods and settings tried . note that since our simulated data were randomly generated with the same dynamic ranges and the same underlying resampling distribution, a normalization step was not additionally performed for these simulated data. however, iqr  or non-parametric regression-based normalization  is recommended prior to the application of the rir algorithm in practice as in dudoit et al. .

we then apply lpe to the simulated data sets and estimate fdr by our rir method, as well as bh, by, mix-all, and splosh. in brief, using the variance estimates  and  the lpe z-statistic is derived as , where  and  are the medians under two conditions and n <dig> and n <dig> are numbers of replicates in the two experimental conditions being compared; in our simulation study n <dig> = n <dig> =  <dig>  next, the fdr levels are estimated with the three fdr evaluation methods. the fdr levels of  <dig>  or smaller have been examined because only such levels of fdr would be useful in practice. figure  <dig> shows that bh and by provide very conservative results while the mix-all approach gives somewhat liberal results, especially when a small  percentage of genes are differentially expressed. splosh is conservative at very small fdrs, and then rapidly becomes very liberal. our rir method provides the most accurate fdr estimates compared to the others, especially in the cases with a small percentage of differentially expressed genes .

application to the mouse immune response data
the microarray data of the immune response study is used to show performance with real data  <cit> . this study was performed with triplicate microarrays under each of naive and  <dig> hour-activated cells, using affymetrix mg-u74av <dig> chips of  <dig> probe sets. table  <dig> displays the numbers of the selected differentially expressed genes at fdr  <dig> ,  <dig> ,  <dig> , or  <dig> . the results again show that bh and by are more conservative than others, whereas the splosh and mix-all methods are more liberal than the others. table  <dig> shows the minimum fdr  estimates for the five well-known genes that were reported and confirmed in the original study  <cit> . the q-value estimates of several genes among them were greater than  <dig>  by conservative bh and by. one or more genes' q-value estimates were greater than  <dig>  by splosh and mix-all, whereas rir identified all of these genes with q-value <  <dig> .

discussion and 
CONCLUSIONS
in this study we have demonstrated that our rir-based fdr estimation method significantly outperforms the other popular approaches and provides very accurate fdr estimates, especially when a small percentage of genes are differentially expressed. among the other fdr evaluation methods compared, the bh and by methods were found to provide quite conservative results and failed to identify a number of truly differentially expressed genes in real microarray data, whereas the full-permutation  approach appeared to yield false positives as significant genes.

in this study we found that one of the most critical steps in fdr evaluation is the generation of biologically-relevant null data. this step has failed and/or is difficult to assimilate in other theoretical and computational fdr estimation approaches. we believe that our heuristic, resampling-based approach provides a significant improvement on fdr estimation and a realistic and intuitive framework for understanding fdr in practice. other approaches in use are based on quite restrictive mathematical assumptions and/or computational constraints, which result in a biologically unrealistic framework for statistical estimation and discovery. in particular, the simple, full permutation strategy produces both an inflated pooled variance and an inflated difference between the gene intensities, but results in a liberal testing framework because the inflation in the numerator of the test statistics  is larger than that in the denominator  in such a null distribution. on the other hand, the shuffling strategies across all conditions can not be applied to microarray data with a small sample size, as the number of independent permutations is too small to provide any meaningful results.

in many microarray studies under controlled experimental conditions, one may expect less than 10% of the genes to be differentially regulated, and thus removal of the top 10% genes from each local interval can be effective in generating a null-distribution excluding most of the differentially expressed genes. our simulations show that removal of the top 5%, 10%, 20%, or even 50% genes does not affect the null distribution , but we admit that these are yet subjective choices and may require a more extensive investigation. our simulation studies have shown that removing the top 10% of genes produces results close to the true fdr among the four cases with 5% to 50% of differentially expressed genes. in figure  <dig>  we showed the comparison among the fdr evaluation methods for the simulated data with the proportions of differentially expressed genes varying between 5% and 50%. in many microarray studies, the proportion of differentially expressed genes would be lower than this. thus, as somewhat expected, the mix-all approach, which is not sensitive to variability across different intensity ranges in microarray data, performs quite well if the proportion of differentially expressed genes is high and a large number of genes do not follow the baseline error distribution. overall, the bigger such a proportion, the better the mix-all approach would perform. note that with 5% and 10% of differentially expressed genes, the mix-all method performed poorer, with more liberal, underestimated fdr estimates, than our rir approach. as pounds and cheng  <cit>  reported, the fdr estimates of the mix-all approach are found to be somewhat unstable for low fdr, which may be a critical region in real data applications.

it has often been found that the results from simulation studies may be considerably affected by certain predefined parameters and settings, for example, δ for the differential expression magnitude and q for the estimation of null-gene proportion in our current study. as such we examined sensitivity of our results to these settings. first, we found that our results were not much different for different choices of q between  <dig>  –  <dig>  . also, although a more reasonable cross-validated approach is yet to be developed for choosing the δ value, our current parameter value was empirically chosen from an actual microarray data analysis. we then consistently used this value in our simulation study with varying proportion of differentially expressed genes up to 50% and found little effect of this setting on the resulting null distribution.

we note that our rir-based fdr estimation is derived for each threshold value c of lpe z-score and that the ratio of v and r is then calculated only when r >  <dig>  so that this effectively provides an estimate of pfdr, the q-value. thus, the rir-based fdr evaluation can be considered as a carefully designed resampling-based q-value estimation  <cit> . note also that our rir-based approach can be applied to microarray data analysis independent of different preprocessing methods.

in table  <dig>  several known genes' fdr estimates from the splosh and mix-all approaches were larger than those of rir. this is somewhat contrary with the observation that the splosh and mix-all approaches were more liberal than the rir as seen in fig.  <dig> and table  <dig>  this may be due to the fact that these genes have relatively low variability, i.e., in high intensity regions, so that their significance is higher by considering such heterogeneous variability by rir, but not by the others.

