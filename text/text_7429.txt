BACKGROUND
with many wild atlantic cod  stocks declining dramatically over the last few decades  <cit> , aquaculture has become increasingly important as a means of maintaining a market supply for this species. cod aquaculture is currently being developed in several countries  <cit> , but has not yet reached a sustainable commercial scale  <cit> . applying genomics tools in the selection of elite broodstock has the potential to enhance the productivity and value of commercial production for this species  <cit> .

genetic marker discovery is a necessary first step in the application of genomics to improve broodstock as these markers can be used for the creation of linkage maps and subsequent qtl identification. marker assisted selection  can then be employed by selecting broodstock based on genotypes at qtl that are relevant to economically important traits such as rapid growth, disease resistance and the control of early maturation. currently, a limited collection of genetic markers is available for atlantic cod, including restriction fragment length polymorphisms , microsatellites and single nucleotide polymorphisms   <cit> . many of the studies using genetic markers to analyse population structure in atlantic cod have employed microsatellite markers  <cit> , and microsatellites have been used extensively in cod aquaculture  <cit> . in total,  <dig> microsatellites have been published to date for this species, including a large, new collection of expressed sequence tag  derived microsatellites  <cit> . however, snps are the most abundant type of dna sequence polymorphism, are suitable for high-throughput genotyping, and provide enhanced possibilities for genetic and breeding applications, linkage map development, assessment of genetic variability and marker assisted breeding. as a result, snp discovery pipelines have been recently developed for many species including fishes  <cit> . to date, a collection of  <dig> snps has been identified for atlantic cod using  <dig>  ests generated from a north-east atlantic cod population, and these snps have been tested on several additional norwegian cod populations  <cit> . in total,  <dig> of these snps, together with  <dig> microsatellites, have been used to generate a genetic linkage map for atlantic cod. this map comprises  <dig> linkage groups with an overall length of  <dig> cm, and represents the first reported linkage map for this species  <cit> .

the cod genomics and broodstock development project  recently produced  <dig>  expressed sequence tags   <cit>  using a large number of individuals and a variety of cdna libraries, including several blood, embryonic and larval normalized cdna libraries. in the present study, we used this collection of sequences to identify snps. our est set was designed to provide an excellent resource for snp marker discovery, since it is generated from several cdna libraries representing different tissues, with three to  <dig> individuals contributing to each library  <cit> . a pilot study has already been carried out to determine the quality of snps detected in the cgp est collection resulting in the validation of  <dig> snps in two canadian cod populations  <cit> . many of the snps developed were identified from sequence data with functional annotation potentially allowing the identification of genes contributing directly to a phenotype.

putative snps identified in this study were subsequently validated for polymorphism across a number of geographically diverse atlantic cod populations, ranging from canada to the north-east atlantic . these snps were also tested for mendelian segregation in two families, and used to create a high-density genetic linkage map that can be applied in qtl analysis to facilitate cod broodstock selection.

RESULTS
selection of ests and contig assembly
ests from the cgp collection were generated using several individuals per library to ensure that a significant proportion of the genetic diversity present in two atlantic cod populations was captured. these populations originated from cape sable  and from bay bulls, newfoundland, and individuals from these collections had been used as parents in breeding programs based in new brunswick and newfoundland respectively. two main methods were used for library generation; normalization of cdna followed by directional cloning  <cit> , with sequencing carried out from either the 3' or the 5' end, and suppressive subtractive hybridisation  followed by non-directional cloning  <cit> . the sequences chosen for automated snp discovery originated exclusively from 3'end sequencing of the normalized libraries, as we expected to have fewer splicing events on average, and more opportunity for snp discovery, in the non-coding 3' untranslated region. the ssh sequences were not used in automated snp discovery due to the limited genetic diversity within these libraries as each was constructed using fish from a single family  <cit> .

the software package paracel transcript assembler  was used to cluster the est set. this software groups similar sequences together into clusters, and then attempts to assemble sequences within a cluster  <cit> . thus clusters comprise two or more sequences, and can be any combination of 1) one or more contigs 2) two or more singlets or 3) one or more contigs and one or more singlets. clustering of the  <dig> 3' ests produced  <dig> clusters, containing a total of  <dig> contigs, and  <dig> singlets and singletons, with singlets being defined as single sequences associated with clusters and singletons corresponding to sequences that are unique within this est set. the contigs were used for snp discovery. the average number of ests that assembled to form a contig ranged from  <dig> to  <dig>  with an average of  <dig>  contributing sequences. a total of  <dig> contigs contained  <dig> or more reads.

snp detection
searching  <dig> contigs using an automated pipeline based on polyphred yielded a total of  <dig> predicted snps . to attempt to improve the quality of the snps selected for further analysis, selection criteria  > 25%) were applied to this initial snp set to ensure that the minor allele for all snps called was represented by at least  <dig> independent sequences. these criteria were used to reduce selection of false snps caused by sequence miscalling or polymerase errors, and to favour the selection of snps occurring frequently within the populations under study. applying our initial selection criteria to all polyphred snps yielded  <dig> snps identified from a total of  <dig> contigs. the average frequency for this set of predicted good quality snps within the contigs used for selection was one per  <dig> bp.

validation of putative snps on panel
out of the pool of  <dig> predicted good quality snps,  <dig> snps satisfied the criteria for the illumina golden gate platform in that they appeared to be bi-allelic, with  <dig> bp of flanking sequence and more than  <dig> bp from a selected neighbouring snp , and these snps were scored for primer design. two golden gate panels , each comprising  <dig> snps , were created from the best-scoring snps and these were tested against a large number of atlantic cod sampled from a number of sites . parents and progeny from two reference families selected from the cgp breeding program in new brunswick were also genotyped to test for non-mendelian segregation and for the creation of a genetic linkage map .

the success rate for snp assays was 75% for the two panels tested, with a total of  <dig> assays that failed to give good quality genotypes . from the  <dig> successful assays,  <dig> snps  were monomorphic  in all individuals from four canadian populations that were tested , and therefore are either incorrectly identified as snps, or are rare snps within the populations analysed. the majority of these have a minor allele represented by two sequences in the contigs from which they were identified, the minimum allowed by our selection criteria; only a small number of monomorphic snps have more than  <dig> reads representing the minor allele. in total,  <dig> snp assays identified both snp variants, with at least one individual tested carrying the predicted minor allele. however,  <dig> of these snps showed a high proportion of heterozygotes in all individuals tested , indicating that they might represent sequence variation between duplicated genes, or members of closely related gene families, rather than different alleles from the same gene; the total number of snps predicted as corresponding to bi-allelic loci was  <dig> . for the purpose of this study, we define validated snps as those having a value for observed heterozygosity greater than zero but lower than  <dig> . therefore this study has identified  <dig> polymorphic snps, with  <dig> of these being validated snps as we predict they correspond to a base change at a single position in the genome. the average observed heterozygosity for these validated snps was  <dig>   and ranged from  <dig>  to  <dig> . the mean maf among the validated snps was  <dig>   and ranged from  <dig>  to  <dig> . the number of snps observed for different maf ranges is shown in figure 4; the results presented represent the combined results for the four canadian populations enrolled in the cgp breeding program, with the european populations excluded from this analysis. the number of snps in different maf ranges from  <dig>  to  <dig>  is relatively consistent for these fish, with  <dig> validated snps having a maf lower than  <dig> , and  <dig> snps with a maf from  <dig>  to  <dig>  for example.

snps for cgp panel  <dig>  were chosen such that only one snp per contig was included. the second panel selection consisted of various categories of snps chosen based on a prioritized strategy. initially, snps from remaining contigs not represented on the first panel were selected. the panel was then completed by selecting snps that are neighbours on the same contig to snps that failed, or were monomorphic, on panel  <dig>  and also snps that were neighbours to successful snps on panel  <dig>  but having a different haplotype. a few snps were selected manually based on contig annotations, with some of these identified on ssh est contigs. thus the final set of validated snps  was selected from  <dig> contigs, with several contigs having multiple validated snps. these can be identified in the snp set as they have an identical number, but a different suffix, as in cgpgmo-s177a and s177b for example.

snps neighbouring failed panel  <dig> snps had slightly lower success rate  when compared to other snp categories, which ranged from  <dig> to 79%. analysis of the polymorphism of successful panel  <dig> snps showed that snps neighbouring panel  <dig> failures have a higher number of polymorphic snps  when compared to the "unique snps/contig" category . two categories showing the smallest number of polymorphic loci are the manually picked snps  and the neighbours of monomorphic panel  <dig> snps . some of the manually picked snps were selected from ssh libraries which had each been generated from a single family, and thus this subset may contain a greater proportion of snps which are rare within the population as a whole.

functional annotation of snps
the snps in the cgp collection are particularly valuable as they are linked to expressed sequences. however, because a large fraction of the 3' sequence in which the snps were detected is likely to originate from the 3' utr of each transcript, most snps were expected to fall in non-coding regions. this resulted in a relatively low percentage of sequences for which a function could be inferred based on sequence similarity. of the  <dig> contigs from which at least one validated snp was selected,  <dig>  had a significant blast hit  in the ncbi non-redundant  dataset. in total,  <dig> snps  were associated with sequences having significant similarity to an entry in the ncbi nr database .

after analysis based on sequence homology, a subset of the snps identified was found to fall within coding regions; these snps were analysed to determine if substitutions encoded by the two allelic variants would result in an amino acid change, i.e, if the substitutions are non-synonymous or synonymous. only 9% of validated snps occur on a known reading frame within coding regions . of these  <dig> snps,  <dig>  were predicted to generate synonymous substitutions, while  <dig>  were non-synonymous. for non-synonymous snps, the resulting amino acid changes are shown in additional file  <dig> 

population comparison
we present here a description of snp characteristics in several populations of atlantic cod . the investigation of cod population structure using these snps in these and additional populations will be described in detail elsewhere . from our analysis, the number of monomorphic loci varied greatly between the canadian populations and more distant populations such as ireland and norway. a large number of loci  are polymorphic in all populations. as anticipated, the greatest number of monomorphic loci from this snp set is seen in the east atlantic populations . this is likely to be due to ascertainment bias rather than a real underlying difference in variability between west and east atlantic populations, as snps were selected based on their frequent occurrence in cape sable and bay bulls fish. a number of snps  have been identified as putative diagnostic snps as they have the potential for use in distinguishing between western and eastern atlantic cod populations, being monomorphic in fish tested from the eastern atlantic cod populations  but polymorphic in western atlantic cod populations .

a few of the polymorphic snps were not in hardy weinberg equilibrium  in one or more of the four canadian populations tested . we determined that  <dig> of the polymorphic snps significantly deviate from hwe in all four populations , and the vast majority of these  were screened out from the set of validated snps as they had values for observed heterozygosity greater than  <dig>  and were not included in further analyses. an additional  <dig> snps show significant deviations from hwe in one population only, and this is also true for  <dig> snps in two of the four populations and two snps in three of the four populations tested, however these did not exceed the numbers of hwe deviating snps expected by chance.

mendelian inheritance and informativeness of snps for linkage mapping
segregation patterns of snps  were tested by genotyping the parents and progeny from  <dig> cgp families, to ensure that snps can be used reliably for linkage analysis. in each case, patterns of segregation were assessed in the  <dig> progeny genotyped for each family. different, overlapping sets of snps could be assessed for segregation in each of the two families. in family b <dig> it was possible to examine the inheritance for  <dig> snps, whereas  <dig> snps were informative in family b <dig> . the  <dig> snps that were predicted to represent differences between genes  were removed prior to analysis of segregation patterns. additional snps also showing non-mendelian inheritance were screened out prior to generating the linkage groups used for map generation; ten snps for b <dig> and  <dig> snps for b <dig> were excluded at this stage.

of the  <dig> snps that deviated from hwe in one, two or three canadian populations, two failed the test for mendalian segregation in both families used for mapping , with a further three snps showing departure from mendelian segregation in family b <dig> but segregating correctly  in b <dig> . however, the majority of the snps in this second category could be successfully placed on the linkage map.

generation of a preliminary genetic linkage map for atlantic cod
the generation of genomics resources within the cgp program is tightly integrated with family-based selective breeding programs based in new brunswick and newfoundland. as part of these programs, individual crosses are generated with known parental contribution, with the progeny from these crosses reared in separate tanks until they reach a suitable size for surgical implantation of a passive integrated transponder tag. parents and  <dig> progeny from each of two independent crosses, families b <dig> and b <dig>  were genotyped using the two illumina goldengate panels described in this study  with the aim of generating a snp-based genetic linkage map.

after removal of the loci with highly skewed segregation ratios  described earlier, joinmap速 <dig>  <cit>  was used to generate linkage groups of associated loci for each family independently, and to order loci within linkage groups to create a preliminary map. for both families,  <dig> major linkage groups were generated using a logarithm  of odds  threshold value of  <dig> , which is in good agreement with the haploid chromosome number of  <dig> usually reported for atlantic cod  <cit> . a small number of snps that failed to be assigned to these  <dig> linkage groups, as well as a few additional linkage groups generated by joinmap速 <dig> containing 2- <dig> loci, were not incorporated in further analyses. marker content of linkage groups, and marker order within those groups, was in good agreement when the maps for the two families were compared. therefore, the family maps were combined to generate a consensus map using the merge function of joinmap速 <dig>  marker order in the final map was confirmed by analysing the mapping parents for potential double recombinants. the consensus map produced is shown in figures  <dig>   <dig> and  <dig>  and contains  <dig> loci on  <dig> linkage groups, ranging from to  <dig> to  <dig>  cm in length, and a total map length of  <dig>  cm. the number of markers per linkage group ranges from  <dig> to  <dig>  with an average of  <dig> .

discussion
our goal was to develop a large collection of snp markers from contigs produced by the cgp. after screening  <dig> contigs generated from  <dig> ests, we identified  <dig> snps using the criteria of  <dig> reads minimum and a maf > 25%. assays have been developed for  <dig> snps using  <dig> fish, which were genotyped using a golden gate assay. the success rate for this set of snp assays was 75%. the snps were assessed for polymorphism by testing against canadian and european populations and it was determined that 26% of snps were monomorphic. a large majority  of the validated polymorphic snps described here are novel. however, on analysis,  <dig> snps in our collection were found to be identical to snps identified independently in a previous study  <cit> . these snps are listed in additional file  <dig>  with the original names given by moen and co-authors  <cit>  together with alternative names used in this study.

the frequency of our set of selected snps in atlantic cod is 1/ <dig> bp, which is similar to the frequency reported in atlantic salmon of 1/ <dig> bp  <cit> . it is somewhat lower than the frequency observed in oncorhynchus keta  or in oncorhynchus tshawytscha   <cit> . snp identification strategy is likely to play a large role in the predicted frequency of snps within the genome, but it also might reflect the fact that, in the cases of atlantic cod and atlantic salmon, snps have been identified from fish originating from a more limited number of populations.

to maximize the detection of real snps that were frequently variable in fish enrolled in the cgp breeding programs, stringent criteria were used to reduce the likelihood of selection of false or rare snps. by selecting snps where the minor allele was represented by at least two reads, we hoped to generate a set of markers that would prove useful for gene mapping and parental assignment. as a consequence, our snp collection has been selected to prioritise snps that are frequently polymorphic in the populations being used for selective breeding in atlantic canada, and in related populations from atlantic canadian waters. therefore, our set of snps may prove to be less informative for the analysis of populations with different geographical distribution, such as populations originating in north-east atlantic. the fact that we found  <dig> snps that are polymorphic in canadian populations but monomorphic in north-east atlantic populations  is a clear indication that, due to the ascertainment bias intrinsic within our selection procedure, our collection of snps may be less informative in characterizing the genetic structure of european populations. we also anticipate that our snp collection contains few rare snps because of the selection criteria employed. these rare alleles can be useful for the analysis of certain populations since they may prove to be specific to, and thus diagnostic for, these populations.

the snps developed in the present study add significantly to the total number of validated snps for atlantic cod. in a previous study, moen and colleagues identified and validated  <dig> snps  <cit> , however only  <dig> snps were common between the two studies . the snps described in both analyses have been detected from est assemblies and thus are associated with transcripts. one third of the snps were detected on annotated sequences in our analysis as the ests on which they were detected have a high proportion of non-coding sequence, whereas in the norwegian study 87% of the snps had a significant blast hit. validation success was similar in both studies, with the percentage of failed assays at 29% for moen et al.  <cit>  and 25% for our study. the number of polymorphic snps as a percentage of all putative snps tested was found to be 54% by moen et al.  <cit>  and 55% in our study . the number of monomorphic loci was slightly higher in our study than found by moen et al.  <cit> . the majority  of predicted snps that were found to be monomorphic in the present study have their minor allele represented by  <dig> reads only. we anticipate that these fall into two categories; 1) snps that are rare within the populations tested, and therefore polymorphism at these loci exists but was not observed in the sample set tested, and 2) incorrect snp predictions. this emphasizes the need for stringent selection criteria and also that validation of snps is a necessary step to establish the accuracy of markers.

the libraries from which the sequences used in the assembly were generated, and thus from which snps were identified, were created using tissue from fish originating from collections from nova scotia  and newfoundland , canada. by testing these snps against more eastern populations such as ireland, iceland and norway, we have shown that they are also informative as markers across more geographic distant populations. some snps  were found to be polymorphic only in all canadian populations, and therefore have the potential for use as traceability markers.

by genotyping two reference families, snps were checked for mendelian segregation. the  <dig> snps that were removed from the validated set showed a significant departure from mendelian segregation; they are more likely to occur on paralogous genes than to represent alleles since both parents and progeny were heterozygous. this is not uncommon when identifying snps in fish. in most studies around 2-4% of validated snps are assumed to be duplication snps  <cit>  except for salmon where 14% of snps were scored as heterozygotes in all individuals tested  <cit> . however, in addition to the set of snps predicted to occur on duplicated genome segments, several additional snps show non-mendelian segregation patterns in the two families tested. also, four snps, two in family b <dig> and two in b <dig>  appear to be duplicates in one family, but segregate in the other family, which could be indicative of either selective forces acting differently upon those families or, more likely, complex patterns of gene duplication and divergence.

most of the snps described here are predicted to fall within non-coding sequence. this is expected in our dataset as all of the ests used in snp identification were sequenced from the 3' direction, and thus the majority of each sequence is likely to represent the 3'untranslated region. nevertheless, a minority of the snps identified here are predicted to occur in coding regions. the remaining snps are either in non-coding sequence, or on contigs with no significant sequence similarity. for the snps found in coding regions, only a subset of the polymorphism will result in a variation in the amino acid sequence of the encoded protein . snp studies have reported a higher number of synonymous snps  when compared to non-synonymous snps ; the variation at non-synonymous sites has the potential to be associated with deleterious mutations. a higher number of ssnps is usually observed, and this is likely to be the result of evolutionary constraints preferentially eliminating variation at non-synonymous sites. for example, 80% of snps identified in coding regions in chicken  <cit>  are synonymous compared to 71% for schistosoma mansoni  <cit> , 68% for anopheles funestus  <cit> , 60% for zebrafish  <cit> , and 55% for rat  <cit> . an even higher frequency of ssnps has been detected in salmo salar   <cit> . we found that the frequency of ssnp in atlantic cod  is intermediate to that reported for other species.

a preliminary linkage map has been constructed using the snps presented here. this map has been generated using the cross-pollination  parameter set of joinmap4速  <cit> , which is applicable to crosses generated from wild individuals taken from an outbred population, and has also been used to generate maps from a small number of crosses in other species  <cit> . independent maps were created from the two families b <dig> and b <dig>  which gave the same number of major linkage groups  and a similar overall marker order. maps generated from these two families were merged to give the consensus map shown in figures  <dig>   <dig> and  <dig>  preliminary analysis of additional families on a second-generation snp panel  gives additional support to this consensus map.

prior to this analysis, moen and colleagues  <cit>  described an integrated genetic linkage map for atlantic cod. this map was constructed using both snps and microsatellites, and comprises  <dig> linkage groups with  <dig> mapped markers in total. unfortunately, it is not currently possible to cross-reference the linkage groups presented in this report with the groups generated in the present study, as too few markers are common between the different maps. we are currently in the process of map refinement, with the aim of adding further families and incorporating a large number of the published microsatellite markers available for atlantic cod, which should allow integration of these two mapping efforts.

we can generate separate male and female maps for most of the genome of atlantic cod using the two families genotyped on the two snp panels described here. the majority of the linkage groups in the consensus map could be identified in sex-specific maps, however these maps are less dense and, due to their bi-allelic nature, only a few informative snps are common between maps created with a single individual, making the merging of maps problematic. however, although there appears to be a significant difference in the recombination rates between male and female atlantic cod  <cit> , this has not prevented construction of an integrated map both here and in the previous study  <cit> .

this large collection of snps for atlantic cod should prove of great utility for both the aquaculture industry, and for the management of wild fisheries. as improved automated genotyping systems have been developed, snps have become important markers for commercial diagnostics and parental genotyping applications. due to lower individual information content, a higher number of snps is required for parental assignment  <cit>  when compared to the microsatellite marker approach that is the current industry standard. in pigs, comparable parental exclusion probabilities have been achieved when using a panel of  <dig> snps or a  <dig> microsatellite marker panel, but the snp panel was more sensitive for individual identification  <cit> . in cattle, panels of  <dig> and  <dig> highly informative snps were powerful enough to distinguish progeny from multibreed composite populations  <cit> . to develop a powerful snp panel for cod parental assignment, snps selected for inclusion in that panel should have a high maf within the families subject to analysis  <cit> . in total,  <dig> snp markers developed by the cgp have a maf higher than  <dig>  . we have selected a subset of these snps to develop a snp panel for use in relatedness analysis, parental assignment and product traceability applications within the cod aquaculture industry. it should also be possible to apply this large marker set to increase the resolution of population structuring within wild populations of atlantic cod, and to better monitor the genetic diversity within populations that are being actively fished.

the snp collection presented here has been completed in parallel with the development of a  <dig> feature, oligonucleotide microarray. in the cgp microarray,  <dig> features have a validated snp marker, which will lead to the association of features showing interesting transcriptional responses with qtl intervals, potentially providing useful tools for mas. for example, cgpgmo-s <dig> is located in the sequence coding for 3-oxo-5-beta-steroid 4-dehydrogenase . this gene belongs to the aldo-keto reductase family  <dig>  member d <dig> and catalyzes the reduction of progesterone, androstenedione, 17-alpha-hydroxyprogesterone and testosterone to 5-beta-reduced metabolites, as well as playing a role in bile acid biosynthesis  <cit> . this gene is of great interest for its role in sexual maturation, and mas for selected variants can potentially be developed using the associated snp.

the snps described here have been derived from ests, and thus can provide anchor points for more extensive comparative genomic analyses. a second generation snp array  has now been created by selecting snps from these two initial panels  to produce a third golden gate panel comprising validated, polymorphic snps . this is currently being used for qtl detection.

CONCLUSIONS
we present an extensive resource of snp markers for atlantic cod, gadus morhua. the snps have been validated across a panel comprising several populations of wild cod, and using two family crosses. this large collection of snps will be valuable for developing diagnostic assays to distinguish between cod populations, as well as producing tools useful for the aquaculture industry. a dense genetic linkage map has been constructed using these snp markers and will provide a valuable resource for qtl discovery and mas.

