BACKGROUND
recent advances in various high-throughput technologies including genome sequencing, transcriptomics, genome-wide snp analysis, proteomics, glycomics, and metabolomics have opened up new opportunities for developing prognostic and predictive markers for better treatment of diverse diseases. indeed, many researchers have reported promising results for improved patient treatment by providing more accurate prognostic and predictive information for decision making  <cit> . among various high-throughput technologies, microarray gene expression profiling has been widely used for prognostic and predictive marker development for its rich information. the use of gene expression profiling has particularly been widespread in cancer research and now a few products are already in market for clinical use and there are also a few large scale clinical trials to determine the effectiveness of gene expression profiling as a prognostic marker for cancer patients  <cit> .

while many researchers have shown promising results on the possibility of gene expression profiling as a prognostic marker, there are also concerns on the hasty use of the technology in the clinic because many issues remain unresolved and some promising research results were presented in an over-optimistic and flawed manner  <cit> . unresolved issues include the instability of identified prognostic gene signatures, few overlap between independently developed prognostic gene signatures, and poor inter-study applicability of gene signatures  <cit> . here, the instability represents a phenomenon in which prognostic signatures strongly depend on the selection of patients in random sampling processes  <cit> . genes repeatedly selected during random sampling are defined as robust here.

among the above-listed problems, the instability and few overlap of already reported prognostic signatures have received great attention. at first, the few overlap between independently developed gene signatures was attributed to the differences in patients, microarray platforms, or applied statistical analyses. however, ein-dor et al. showed that many equally efficient but non-overlapping prognostic gene signatures can be identified from a single data set because gene expression data contains numerous informative genes  <cit> . michiels et al. showed that only a few genes are consistently selected from a given data set when they applied random sampling approach in their analysis  <cit> . to understand the nature of the instability of prognostic gene signatures, ein-dor et al. developed a new mathematical model and concluded that at least thousands of samples are needed to develop a stable gene signature  <cit> .

currently, most gene expression profiling studies have been performed with some tens to hundreds of samples. meta-analysis, by combining the results of several studies, makes it possible to overcome the limits of many small sample-sized studies. in this work, we pooled eight large-scale gene expression studies to attain a data set with more than  <dig>  samples. specifically, we only used data sets produced using a single microarray platform, affymetrix u133a, in pooling different data sets to exclude data loss and confounding factors arising from the combination of different microarray platforms. using more than  <dig>  samples, we performed several analyses to understand the various aspects of prognostic gene signatures.

RESULTS
construction of a single data set by pooling eight data sets
to understand the effects of a sample size on the classifier performances, we first constructed a single data set by pooling eight publicly available breast cancer data sets . several methods including simple mean-centering  <cit> , distance weighted discrimination  <cit> , and empirical bayes methods  <cit>  are available for adjusting batch effects when combining multiple gene expression data sets. one recent study showed that simple mean-centering can effectively remove many data set specific biases allowing effective integration of multiple data sets  <cit> . thus, we applied a simple mean-centering method to the eight data sets and performed clustering analysis to see if any data set specific batch effects are observed in the pooled data set. no distinct batch effects were found in the pooled data set , suggesting that simple mean-centering was able to remove most, if not all, batch-specific biases. principal component analysis  of the pooled samples again confirmed that batch effects were rarely found in the pooled data set . the pool data set was used in the subsequent analyses.

increased sample size increases overlap between gene sets
we first calculated the degree of overlap between different prognostic gene signatures as the sample size was varied. an overlap between different prognostic gene signatures increased according to the increased sample size . for example, the average overlap between data sets with  <dig> samples was  <dig> %, but it was increased to  <dig> % with  <dig> samples. this number is in good agreement with ein-dor et al.  <cit> 's prediction which suggested that approximately five to eight hundred samples are needed to attain an overlap of 20% in breast cancer data sets.

increased sample size decreases the error rate of class prediction
we then tested the effects of a sample size on the error rate of class prediction which is the most important measure of prognostic classifier performance in clinical decision making  <cit> . for class prediction, each patient was divided into good  or poor  prognosis groups. relapse or metastasis free patients followed up less than five years were excluded from the analysis.

we applied random sampling approach in our evaluation of error rate of class prediction by randomly selecting n training samples  from the pooled data set, constructing a prognostic classifier from the training samples, and evaluating its performance on the  <dig> randomly selected testing samples  <cit> . we used three well-established machine learning algorithms – diagonal linear discriminant analysis , support vector machine , and random forest  – in our analysis  <cit> . while svm and rf algorithms need fine tuning of several parameters to attain the lowest error rate of prediction, we just applied default parameters given in the r packages  because we had to perform numerous class predictions on several hundred data sets prepared by re-sampling at each sample size.

the error rate of class prediction was decreased as the number of training samples used for constructing prognostic gene signatures increased  with all the three algorithms producing similar results. the best average error rate was  <dig> % obtained from the training sample size of  <dig> with support vector machine algorithm.

concordance between predicted outcomes increases with an increasing training sample size
recently, fan et al. emphasized that concordance in the predicted outcomes between different prognostic gene signatures is the more relevant measure than the mere overlap between them in evaluating the similarity between different gene signatures  <cit> . we thus investigated the effects of different training sample sizes on the concordance in the predicted outcomes. for each sample size,  <dig> samples were first left out as testing samples, and n samples were randomly selected from the remaining samples to produce a prognostic gene signature. the random sampling process was repeated  <dig> times to produce  <dig> independent prognostic gene signatures. for each of the  <dig> independently prepared prognostic gene signature, outcomes were predicted on the  <dig> initially left-out testing samples and concordance in the predicted outcomes among the  <dig> gene signatures were measured. as expected, the concordance in the predicted outcomes increased as the training sample size was increased . for example, the mean concordance was  <dig> % at a training sample size of  <dig>  but it was increased to  <dig> % with  <dig> training samples, and further increased to  <dig> % with  <dig> training samples. similar patterns were found with svm and rf algorithms.

sub-type specific gene signature decreases the prediction error rate
recent studies have shown that breast cancer is a heterogeneous disease consisting of three to six different molecular subtypes  <cit> . the estrogen receptor  status is one of the important molecular phenotypes in classifying breast cancers into different subtypes  <cit> . until now, to increase the total sample size, we didn't divide samples into different er groups . to see if sub-type specific analysis could improve the performance of prognostic gene signatures, we first divided samples into er-positive and er-negative groups and performed analysis using only the er-positive samples. er-negative sample specific analysis was not performed due to the small number of er-negative samples .

with er-positive samples, the number of training sample was varied from  <dig> to  <dig> with an increment of  <dig>  as expected, analysis using only er-positive samples always produced lower error rates of prediction that the analysis using both er-positive and er-negative samples did . for example, using dlda algorithm, an average prediction error rate of  <dig> % was achieved by  <dig> samples in er-positive specific analysis in comparison to an average error rate of  <dig> % in an analysis using both er-positive and er-negative samples .

discussion
using more than  <dig>  samples prepared by pooling eight independent data sets, we explored the effects of a sample size on three metrics: the degree of overlap between independently developed gene signatures, the accuracy of outcome prediction, and the degree of concordance in outcome prediction between independently developed gene signatures. we also tested if the accuracy of outcome prediction could be further improved by sub-type specific analysis. we found that all the three metrics were improved by the increased sample size, but in different degrees.

the degree of an overlap between independently developed gene signatures increased in proportion to the number of training samples. with a sample size of  <dig>  a mean of  <dig> % overlap was observed , which is in good agreement with the results of ein-dor et al. who showed that 500– <dig> samples are needed for 20% overlap and approximately 2000– <dig> samples are needed for 50% overlap  <cit> . thus, ein-dor et al.'s prediction is well supported by a real gene expression data set in our analysis. the same conclusion was obtained by vliet et al.  <cit>  who showed that small sample size problem is the most relevant explanation for the poor overlap between small-sized data sets. the increased sample size will typically increase overlap between independently developed gene signatures by reducing variability between classifiers from random sampling.

however, when we turned our focus on the concordance in outcome prediction between different gene signatures, we found that 200– <dig> samples were enough to achieve reasonably good performance. for examples, with dlda algorithm,  <dig> % and  <dig> % concordant outcome predictions were achieved with  <dig> and  <dig> samples , and similar results were obtained with rf and svm algorithms . the discrepancy between the degree of overlap and the degree of concordance in outcome prediction improved by increased sample size suggests that the two measures of the performance of prognostic gene signatures may be unrelated to each other  <cit> . dobbin et al. recently emphasized that the identification of a gene signature with optimal prediction accuracy should be distinguished from the identification of a robust gene signature and that thousands of samples may not be needed to produce a good classifier  <cit> . in another study, fan et al. showed that the lack of overlap between different gene signatures may not be as serious a problem as originally thought if different gene signatures are concordant in their outcome prediction and represent similar biological processes and pathways  <cit> . that ein-dor et al. could develop as many as eight independent, but equally prognostic gene signatures from a single data set gives another support for the view of putting little importance on the overlap between different signatures  <cit> . because high-throughput gene expression data contain enormous amounts of information and many genes are co-regulated, it is comprehensible that many equally efficient gene signatures can be developed from a single data set  <cit> .

many morphologically similar tumors are heterogeneous at the molecular level. for example, recent gene expression profiling studies have established that breast cancer can be divided into three to six molecular subtypes by the pattern of gene expression  <cit> . the er status is the most important molecular character to classify breast cancers into sub-types and many studies have shown that er-positive breast cancer is fundamentally different from er-negative one and should be treated differently  <cit> . for this reason, we tested if developing prognostic gene signatures in a sub-type specific manner could further improve the prediction accuracy of a gene signature. results showed that about 3–5% improvement in prediction accuracy is obtained by developing er+ specific gene signatures. many recent works report the development of er+ or er- specific gene signatures with much improved performance  <cit> .

we acknowledge that our work has several points for improvement. first, survival information, which was arbitrarily dichotomized into binary outcomes for a class prediction problem, may be used as a continuous variable for its full use. second, while we used only the er-status variable in our sub-type specific analysis of breast cancer data sets, other clinical attributes such as node status, grade, age, or treatment status should be considered as confounding factors in the analysis.

CONCLUSIONS
increasing sample sizes generated a gene signature with better stability, better concordance in outcome prediction, and better prediction accuracy. however, the degree of performance improvement by the increased sample size was different between the degree of overlap and the degree of concordance in outcome prediction. thus, while thousands of samples might be needed to achieve 50% or more overlap, 200– <dig> samples were enough to achieve between  <dig> and 95% concordance in outcome prediction. finally, sub-type specific analysis produced better results suggesting that developing prognostic gene signatures for specific patient sub-groups  may be a better strategy for heterogeneous diseases such as breast cancer.

