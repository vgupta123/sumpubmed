BACKGROUND
high quality metabolic reconstructions are available for many organisms and provide a rich scaffold for interpreting data from high-throughput biological experiments. the topology of a metabolic network, defined by connections between enzymes and metabolites, can be used to predict genetic interactions, transcriptional correlations and disease co-morbidity  <cit> .

previous studies have used the topology of the metabolic network to predict co-expression of transcripts for yeast metabolic enzymes  <cit> . this study first removed high-degree metabolites from the bipartite metabolic network, generated an enzyme-only network by connecting enzymes that shared at least  <dig> remaining metabolite, and calculated the shortest-path distance between all pairs of enzymes. shorter distances were correlated with stronger co-expression. similar procedures, also excluding high-degree metabolites from consideration, were used recently in a study linking diseases to metabolic enzymes  <cit> .

methods that involve calculation of optimal fluxes subject to constraints, such as flux coupling  <cit> , have performed better than local topological metrics based on shared neighbours in predicting transcript co-expression. flux coupling methods are much more computationally expensive than topological analysis, however. furthermore, flux coupling methods suffer from the disadvantage that reactions with small flux values  are typically removed from the network. this is a problem if an enzyme of interest is removed from the network based on low reaction flux.

our goal is to provide improved topological measures for enzyme functional associations from metabolic networks without the need for expensive calculations of optimal fluxes or sampling over feasible flux space. the motivation of our approach is that methods that count shared metabolites, or methods that generate a p-value for shared metabolites based on a hypergeometric distribution, essentially assume a flat degree distribution for metabolites. high-degree metabolites violate the assumption of a flat degree distribution, and the hypergeometric distribution is inappropriate for calculating p-values for metabolite sharing. randomization methods based on rewiring, which maintain the observed degree distribution, are robust to high-degree metabolites but unfortunately are computationally expensive.

in this work, we provide a series of scores that are the bayesian equivalent of the hypergeometric distribution, but adjusted for the known metabolite degree distributions. these scores are fast to calculate, essentially no more expensive than a hypergeometric p-value, and much faster than any methods that require rewiring permutations, flux sampling, or flux optimization. results from applying these methods to metabolic networks in yeast demonstrate performance better than previous methods based on local connectedness. the results also reveal functional associations that are not captured by conventional metabolic pathway definitions, but which are inherent in the network structure.

RESULTS
overview
metabolic networks can be represented as bipartite graphs with edges between enzymes and metabolites. an enzyme can use a metabolite in multiple unique reactions involving distinct subsets of other metabolites, and the number of unique reactions defines an integer-valued edge weight.

a graphical overview shows how metabolic network information is incorporated to yield increasingly sophisticated models . the models discussed here are all designed to rank pairs of enzymes for functional association. methods termed "local" are capable only of producing rankings for enzymes directly connected by at least one metabolite. the raw number of shared metabolites  <cit>  and the hypergeometric distribution that corrects the shared count for the enzyme degree  are both local methods.

in this work, we introduce a more sophisticated local method that also corrects for metabolite degree, discounting the contribution of highly connected metabolites like water, protons, and atp . our new local methods are motivated by bayesian model selection using the log-likelihood ratio of a null model  to an alternative model. the number of shared metabolites is modelled as a poisson distribution for both the null and alternative models. for the alternative model, the poisson parameter is the maximum likelihood estimate for the observed network, which is the observed number of shared metabolites. for the null model, the poisson parameter is estimated from a random network model . we present results for an improved poisson model that uses knowledge of the observed metabolite degree distribution.

methods termed "global" are capable of generating rankings for enzymes that are not directly connected by metabolites by using the full network topology. examples are shortest paths and the more robust graph diffusion kernel  . gdks are non-local in that they sample over all paths between two enzymes, rather than just the shortest paths defined by shared metabolites. gdks have been successfully applied to functional inference in metabolic networks  <cit> . recently parity-specific kernels been used to analyze genetic interaction networks  <cit> . we also used a method based on the pearson correlation of the weighted metabolite-enzyme edge connectivity structure between two enzymes.

yet more elaborate flux balance analysis methods sample flux states that are feasible under steady-state constraints. flux correlations can then be used to rank enzyme pairs for functional associations . other flux balance methods have generated functional associations by predicting synergistic or buffering epistatic interactions for deleting pairs of enzymes from the network.

performance of local methods
performance is assessed primarily by the ability to predict synthetic lethal genetic interactions between metabolic enzymes, and secondarily by the ability to identify classes of enzymes with similar gene ontology  annotations. the synthetic lethal interactions provide a direct link to testable experiments. the database annotations are not necessarily testable, but instead show whether inference from computational models is consistent with known biology.

we generated rank ordered lists of enzyme pairs based on the local methods. performance was assessed from the receiver operating characteristic  curve using the area under the curve , and from the precision-recall  curve using the maximum f-score, the harmonic mean of precision and recall. known positives were taken from experimentally reported synthetic lethal/growth defect interactions recorded in the biogrid database. there were  <dig> growth defect/lethal interactions in which both genes involved were part of the metabolic network model. known negatives were defined as gene pairs where each gene has at least one synthetic lethal interaction, and one of the two has at least  <dig> synthetic lethal interactions as a query in a high-throughput screen, to exclude pairs that might not have been tested experimentally.

performance metrics for the local methods in predicting synthetic lethal genetic interactions are the auc and f-score . raw counts of shared metabolites perform the worst. thresholding the network to remove high-degree metabolites introduces changes in the performance only slightly, and results remain inferior to global methods described below . the methods that account for the degree of an enzyme, but assume a flat metabolite degree distribution, improve on the raw counts. the new method, which accounts for the metabolite degree as well, performs at least as well as previous methods, and the precision degrades the most slowly of all methods at higher recall.

performance of global topology methods
we then compared the performance of the best local method  with methods that use global topology and incorporate local edge weights . global topology is incorporated using a graph diffusion kernel that sums paths of all lengths between enzyme pairs, rather than just the number of shortest paths involving shared metabolites. local weights for enzyme-metabolite edges are taken from the integer number of unique reactions involving each enzyme-metabolite pair; these weighted edges were then used to construct a graph diffusion kernel.

overall, incorporating global information through the graph diffusion kernel improves the performance in identifying synthetic lethal pairs. adding edge weights to the graph diffusion kernel does not appear to improve performance. further comparisons with the graph diffusion kernel use the unweighted model only, as it is simpler.

global topology with metabolic constraints
we next considered possible improvements that use the knowledge that the network edges represent a flux balance model for metabolism. while others have investigated models that investigate the robustness of metabolism to pairwise gene deletions  <cit> , correlations of fluxes through enzymes provide improved predictions of genetic interactions  <cit> . we therefore used the flux sampling approach to calculate enzyme correlations, whose absolute values were used to rank enzyme pairs. the flux sampling excludes reactions with negligible flux, which reduces the model to  <dig> metabolites,  <dig> reactions and  <dig> enzymes and reduces the known positive pairs to  <dig> genetic interactions.

comparison of the flux sampling method to the best local and global topology methods considers only the enzymes present in the reduced model . the flux sampling method has the best precision in the high-recall region. enzyme pairs that are used in exactly the same reactions, or which are coupled in an obligate serial pathway, have a flux correlation of  <dig>  these pairs are all ranked identically by the flux sampling method, but may be ranked in a definite order by the local and global topology methods. in the low-recall region, consequently, the local and global methods appear to provide improved precision over the flux sampling approach.

the epistatic estimates, obtained from previous work  <cit> , do not perform as well in predicting synthetic lethality.

compartmentalized metabolism
reactions in the metabolic network are localized to specific compartments . of the total  <dig> metabolic reactions in the model, 47% are entirely contained in the cytosol, roughly 10% are either mitochondrial or extracellular, and 24% couple metabolites from different compartments . if one metabolite appears in two different compartments, it is represented as two unique metabolites; enzymes in different compartments that process this metabolite are not scored as sharing it, reducing the ability to detect functional associations for enzymes in different compartments. on the other hand, functional association as measured by synthetic lethality is roughly 3× higher for enzyme pairs that share at least one compartment , and removing compartment information neglects this information.

reactions which have metabolites localized to more than one compartment are counted only once and contribute to the total in "associated with  <dig> or more compartments".

the category "share" comprises enzyme pairs that have at least one shared compartment based on metabolite localizations . the category "do not share" contains all other pairs.

to test these competing possibilities, we applied the local and global methods to a network in which compartment information was removed. the yeast metabolic network we used in this study specifies compartments for enzymes and metabolites  <cit> . we reasoned that identical reactions occurring in different compartments can functionally compensate for each other due to diffusion or transport of metabolites across compartment boundaries. we therefore generated a simplified network that ignores the cellular compartments of the metabolites. removing the compartments reduced the number of metabolites from  <dig> to  <dig> 

the general result for both the local method  and the global method  is that removing compartments improves the precision at high recall at the expense of worse precision at low recall .

assessment based on database annotations
we used published methods to assess the ability of different ranking methods to identify enzyme pairs with similar database annotations  <cit> . this assessment tests the significance of the hypothesis that the average coupling score between all pairs of genes associated with a go term is higher than between pairs of genes associated with different go terms. all  <dig> go terms mapping to at least  <dig> and less than  <dig> enzymes in the network were considered, comprising  <dig> biological process ,  <dig> molecular function , and  <dig> cellular compartment . if the null is rejected by the benjamini-hochberg procedure at a starting p-value of  <dig> /  <cit> , then the go term is termed consistent. the fraction of consistent go terms was computed by this procedure for each method. the assessment was performed for the complete compartment-based network, the reduced compartment-based network with enzymes with negligible fluxes removed, and the network with compartments removed. the category size of 5- <dig> matches the original publication. assessment with category sizes of 2- <dig> and 2- <dig> yield similar results, but with more categories overall .

of all the methods, the graph diffusion kernel clearly performs best overall in producing consistent go annotations . the performance of the methods generally tracks the assessment based on synthetic lethal interaction prediction. of the local methods, the raw count of shared metabolites performs worst; better are the improved methods that account for enzyme degree; and best of all is the new method that accounts for metabolite degree as well. the graph diffusion method also out-performs the flux sampling method.

shared mets
hypergeometric
shared mets.
hypergeometric
poisson score
graph diffusion
graph diffusion kernel score
the best performance in each category is highlighted in bold.

we investigated whether the models with or without compartments perform better using a binomial test under the null hypothesis that each of the two models has equal probability of performing better for a particular method. tests were performed separately for auc/roc, pr/f-score, and the three go categories, and separately for the full and reduced network. in all cases except go/cellular compartment, two-tailed tests showed no significant deviations from the null hypothesis at p =  <dig> . the test for cellular compartment is significant , with improved consistency for models that include compartment information.

flux correlation performs best in the biological process category. a surprising result here is that overall flux correlation performs worse than gdk and poisson  with only 70% consistent go terms. it is possible the flux correlation method could be improved with longer runs that reduce the statistical noise in the correlations, although the flux calculations already require over 100× more computer time than any of the other methods .

the different methods generate a similar set of consistent go term, and terms missed by the graph diffusion kernel are almost always missed by the other methods as well . for cellular compartment, most annotation terms  are consistent by all three methods. in the case of biological process and molecular function only 50% and 71% of all the annotations are captured by all the three methods.

discussion
performance of local, global, and flux-based methods
we have investigated the performance of three classes of methods for predicting functional associations in metabolic networks:  local methods, based primarily on the metabolites shared by two metabolic enzymes;  global methods, based on the probability that a random walk started at one enzyme will visit a second enzyme;  flux-based methods that use flux balance to identify enzymes with correlated fluxes. the local and global methods are fast and generally applicable to other types of networks, whereas the flux-based methods are computationally expensive and dedicated to metabolism . in terms of performance in predicting functional associations, however, the dedicated flux-based methods have typically been superior. developing fast methods with performance similar to expensive flux-based methods has been a challenge.

previous local and global methods have had difficulties with high-degree metabolites. for local methods, metabolites such as water and atp are often shared by enzymes with very different functions. for global methods, these metabolites introduce many short paths through the network. often, high-degree metabolites are removed from a network prior to analysis. this approach is undesirable because it introduces an ad hoc tuning parameter, which can lead to over-fitting, and it excludes potentially interesting metabolites from the analysis.

the hypothesis motivating this work is that the difficulties from high-degree metabolites arise from an implicit assumption of a narrow metabolite degree distribution, as opposed to the known long-tailed degree distribution. the hypergeometric distribution for shared metabolites corrects for enzyme degree, but not for metabolite degree. consequently a high-degree metabolite such as water is given the same weight as a low-degree metabolite when counting shared metabolites. intuitively, high-degree metabolites should be down-weighted. our improved local method uses the known enzyme and metabolite degrees to generate a degree-corrected score with excellent performance.

the global method we examine, a graph diffusion kernel on the bipartite enzyme-metabolite network, also includes a degree normalization that down-weights the contribution of high-degree metabolites . this method is somewhat more expensive than the local methods, requiring a full matrix inverse rather than sparse matrix multiplication.

the graph diffusion kernel explores the topology of the metabolic network using random walks that visit metabolites and enzymes. enzyme-metabolite edges are treated as undirected, permitting random walkers to traverse both directions even for a unidirectional reaction. there are no constraints on the flux of random walkers through any enzyme, and the stoichiometry of a metabolite as a reactant or product is ignored.

flux-balance methods go beyond graph diffusion by adding constraints specific to metabolic networks. enzyme fluxes are coupled by mass balance and reaction stoichiometry, and correlations between enzyme fluxes can propagate through the network. these additional constraints capture more of the biological reality of metabolism than either shared metabolites or graph diffusion. predictive performance is also better, presumably because of the biological constraints. a curious point is that flux sampling, with a uniform sample over the feasible space, performs better than calculations of epistatic effects based on reductions to an optimized fitness objective function. this may indicate errors in the assumed objective function for cellular fitness. the main drawback of flux-balance methods is the high computational cost.

in summary, graph diffusion methods have become a method of choice for analyzing many types of networks. while the degree-corrected local methods provide a substantial improvement over previous local methods, the graph diffusion kernel using the entire network topology performs somewhat better. dedicated flux-sampling methods are slightly better for predicting genetic interactions, but take over 100× longer to calculate and are much more difficult to implement.

disagreement between network-based predictions and database annotations
as the graph diffusion kernel  method provides a good trade-off between performance  and computational efficiency, it is likely to be a method of choice. the average semantic similarity for gene pairs highly ranked by the gdk provides an additional assessment of performance . gdk scores of  <dig> and more have an average semantic similarity of  <dig> or greater, corresponding to no more than  <dig> genes annotated to the parent category. thus, on average, a high gdk score indicates a similar database annotation.

these average results, however, do not always hold for individual gene pairs. a cross-tabulation of semantic similarity vs. gdk score demonstrates that many gene pairs with high gdk scores nevertheless have essentially no semantic similarity . these gdk predictions of functional association would essentially be scored as false-positive predictions based on the lack of similarity in database annotations. because of the overall good performance of the gdk method, we systematically investigated the most extreme cases in an attempt to suggest a reason for the disagreement.

we therefore selected examples with high gdk scores and low semantic similarity. a gdk threshold of score ≥ <dig> focused attention on the top-ranked gdk pairs, where on average the semantic similarity corresponds to only  <dig> genes annotated to the parent category of a pair. we then set a threshold of semantic similarity ≤ <dig>  this value is substantially below the semantic similarity of gene pairs selected at random, and was chosen to yield a number of example that was feasible for case-by-case analysis, a data set of  <dig> pairs denoted putative false positives .

manual inspection suggests that these cases can be classified into  <dig> main categories: unannotated, transport-synthesis, pathway-boundary, and secondary activity . the unannotated category comprises 10% of the cases and indicates that a gene lacks database annotations for biological process, cellular component, and metabolic function, despite being included in a metabolic reconstruction. the secondary activity category, with only  <dig> cases, is a related discrepancy in which the secondary metabolic activity of an enzyme is present in the metabolic reconstruction but not noted in go.

the transport-synthesis category is the largest, with about 65% of the cases. in these examples, the gdk predicts an association between enzymes responsible for synthesis and transport  of the same metabolite. thus, both enzymes are fulfilling the same role of increasing the intracellular concentration of a metabolite. the structure of the go annotations does not reflect this close functional association, however. examples include transport of choline/ethanolime , allantoate , sterols , and uridine .

the final category, pathway-boundary, arises when the boundary between two well-accepted pathways cuts through a metabolite. enzymes that connect to this metabolite are then annotated to very different pathways, despite a close network-level association. these cases are responsible for 20% of the total. examples include associations between enzymes in the tca cycle and those using tca metabolites for amino acid synthesis, enzymes with different roles in glycoprotein synthesis, and enzymes responsible for quinone metabolism .

CONCLUSIONS
in analyzing large networks, it has become common to delete high-degree vertices. this practice is questionable. it depends on an arbitrary high-degree cutoff, usually without any clear break in a vertex degree distribution. it can remove vertices that are of interest, and it can introduce unknown biases into the analysis.

here we have introduced methods that are readily applied to networks with high-degree hubs. local methods use known degree distributions to correct for high-degree enzymes and metabolites, and global methods use graph diffusion kernels to rank the association between pairs of enzymes. we show that these methods outperform previous methods that eliminate high-degree vertices from the networks. the context is cellular metabolism, where high-degree metabolites like water and atp are shared by many enzymes. our methods are able to infer functional associations between enzymes, without being misled by sharing of these high-degree metabolites.

in several cases, enzymes predicted by network analysis to have high functional association have very little similarity in database annotations. some of these cases are due to a discrepancy between the metabolic reconstruction, which records a reaction for an enzyme, and the annotation database, which lacks information or omits a secondary activity. two additional patterns were observed, however, which relate to the structure of gene ontology hierarchies. first, enzymes that are responsible for synthesis and transport of the same metabolite often have little annotation similarity. second, conventional pathway definitions may place two enzymes with strong network-level associations on opposite sides of a pathway boundary.

the methods developed here should be applicable in general to other bipartite networks, particularly those with high-degree hubs.

