BACKGROUND
the majority of recent theories on prebiotic evolution agree that even the most primitive forms of life must have been cellular, and that the first autonomous protocells must have included at least three interacting subsystems: metabolism, genetic system and membrane  <cit> . though we know that these three components are all indispensable for a recent cell to be viable, the assembly of the first complete protocell including all the three subsystems is very unlikely to have abruptly happened from scratch. it is much more probable that the components had been co-opted one by one into a lineage of "pre-protocells" during prebiotic evolution. however, the historical order of the subsystems' appearance and integration is a debated topic among students of prebiotic evolution. according to luisi  <cit>  and segré et al.  <cit>  the container/boundary subsystem  may have been the basis of protocell evolution, and the other two components were built into primitive membrane vesicles later. the vesicles are assumed to be composed of amphipathic molecules with weak to moderate catalytic activities of different specificities. the vesicles could grow at a rate dependent on their actual lipid composition by incorporating new lipid molecules. the better the lipid composition , the faster it grows and divides, i.e., the higher its fitness  <cit> . the snag is with the heredity and thus with the evolvability of these assemblies: neither the lipid building blocks nor the assemblies as a whole do template-copy themselves, which leaves wide open how far they can be units  of darwinian evolution.

the second, maybe more plausible, hypothesis is the "metabolism first" scenario in which small molecules  play the main role. according to the hypothesis a random set of small organic molecules were the first to appear in the atmosphere and in the prebiotic oceans, and these were then self-organized to form specific reaction networks  <cit>  of a primitive, autocatalytic metabolism. several classical experiments  <cit>  suggest that the spontaneous genesis of organic compounds must have happened on the primordial earth, but whether the reactions could be spontaneously channelled into a real metabolic system in the absence of specific catalysts is a serious question. the catalytic role of mineral surfaces  has been invoked  <cit>  as a possible solution, but the problem of probably insufficient catalytic specificity on such surfaces is still a serious argument against the "metabolism first" hypothesis. this is where the third prebiotic story – that of the "rna world" may help.

the "rna world"  can roughly be classified as a "genetics first" scenario, even though the rna-like enzyme  actors in this play are assumed to have a catalytic function as well, besides their obvious genetic role  <cit> . it is exactly this dual nature of rna replicators that render them the best candidates for the role of booting up life: they are evolvable genetic units, but they also feature metabolic phenotypes that are dependent on their actual genetic information content.

elementary combinatorics suggests that there can be three so-called infrabiological' systems  <cit>  consisting of any two of the three aforementioned systems. qualitatively different, coupled autocatalytic systems are the exciting terrain of the emerging field of 'systems chemistry'  <cit> . the present study investigates an example of the metabolism-template  doublet. interestingly, a similar doublet was originally considered by gánti  <cit>  to be the minimal chemical supersystem for life: the boundary was added later to the model  <cit> .

the most serious difficulty with the ribozyme world scenario is ecological in nature: different replicators occupying the same habitat and replicating with different rates will compete for the  resources of their replication. ultimately the fastest one will exclude all the others, which means a dramatic decrease of genetic diversity within the population of replicators, for two reasons: first, because all but the winner's information is eliminated from the system; second, because the winner is the one that replicates fastest, and the fastest replicator is most probably a very short polymer, with a limited information content  <cit> . in the prebiotic evolutionary context, all these mean the loss of most of the genetic information carried by any diverse replicator population. however, a working protocell had to maintain a reasonably high amount of genetic information to accomplish many phenotypic tasks . that amount of information also had to be reliably passed on to their offspring to maintain their functionality through many generations.

the problem of maintaining genetic information under prebiotic conditions can only be solved on the basis of some higher-level control of the – otherwise inevitable – competitive exclusion process. the first steps in this direction were taken by eigen  <cit> ; see also eigen and schuster,  <cit> . their hypercycle model assumes that a set of self-replicating ribozymes provide each other with heterocatalytic help in a circular topology . the hypercyclic coupling of the replicators automatically maintains coexistence even if the replication rates of the hypercycle members are different – as long as no mutations pop up in the system. however, the hypercycle model has been proven to be vulnerable against parasitic mutant replicators: both "selfish"  and "short circuit"  parasites ruin hypercyclic coexistence and lead to the ultimate exclusion of all but a single replicator  <cit> . the only way the hypercycle can be saved is by compartmentalization: the system has to be wrapped into membrane vesicles, and selection on the level of the vesicles can maintain the coexistence of hypercyclically coupled replicators  <cit> . although it has been proposed that hypercycles may 'jump to life' when their constituents are absorbed to mineral surfaces  <cit>  by virtue of the infolding mesoscopic  patterns, which make them resistant to parasites; this model has been shown to be unstable under the assumption of a 'patchy environment' in two dimensions  <cit> .

our approach is different from the hypercycle model in that we assume a set of ribozyme replicators catalysing a network of chemical reactions , which in turn produces monomers for the replication of the ribozymes themselves. that is, the ribozymes contribute the production of the common resource  by their specific catalytic activity, and metabolism aspecifically contributes to ribozyme replication by providing monomers. we confirm that this system is viable  without a membrane envelope, it keeps the abundance of parasitic mutants low, and that the coexistent parasites of the system can serve as pre-adaptations for subsequent evolution into ribozymes of potentially great utility for the metabolic system as a whole. specifically, in this study we explore the novel case of parasite evolution towards a replicase function, but we also sketch a few different routes of possible further adaptations. thus our present work bridges the gap between the metabolic model of czárán & szathmáry  <cit>  that had no replicase in it and the replicase model of szabó et al.  <cit>  that had no metabolism.

method
the model
 <dig>  the metabolic model without replicase
czárán and szathmáry  <cit>  consider a number of relatively short replicator macromolecules, each of which is capable of catalysing one  essential reaction of a metabolic reaction network m. metabolism is specified neither in stoichiometric nor in topological terms; it is assumed that mproduces the monomers for the replication of the macromolecules themselves, and that the catalytic help of the replicators is essential for monomer production. in other words: metabolism aspecifically supports the replicators by providing them with monomers, and the replicators specifically support metabolism by catalysing certain reactions of it . the extinction of any one of the replicators iiresults in the collapse of metabolism and thus the demise of the whole replicator system. the simplest mathematical model for the temporal dynamics of a nonspatial system with these properties is

  dxidt=xi, 

where xi is the concentration, ki is the growth rate of replicator i. m expresses the effect of metabolism on the replication rate. it is a common multiplicative function of the replicator concentrations x, so that each replicator type needs the presence of all the others to be able to replicate, but the metabolic help received is aspecific. φ is an outflow function acting as a concentration dependent selection constraint, keeping the total concentration of the replicators constant. although all replicators must be present for m to be positive, we know that this does not preclude competitive exclusion of all other types by the fittest  replicator  <cit> . since m is the same in all equations of , even very small positive concentrations of the competitively inferior types maintain the advantage of the dominant in terms of the speed of replication. therefore the replicator of largest ki will always multiply the fastest of all, excluding the slower  ones, and with the excluded type missing from the metabolic network the system ultimately collapses with all replicator types going extinct. that is, the metabolic model is not capable of maintaining the community of replicators – at least not in a well-mixed medium.

czárán and szathmáry  <cit>  show that the very same metabolic system is robustly persistent and coexistent in a spatially explicit cellular automaton model even if the replication rates of the replicators are different . the crucial assumption of the spatial model is that any replicator type needs the presence of all the other types within a small section of space  around itself for being able to replicate, because local monomer supply depends on local synthesis – diffusion cannot deliver monomers at sufficient concentrations to longer distances. thus the somewhat surprising result of stable coexistence in the cellular automaton is due to the effect of higher-level selection for metabolically complete replication neighbourhoods within small sections of space. rare replicators are at a relative advantage compared to common ones, because they have more chance to be complemented by all the common types within a small metabolic neighbourhood – more common replicators have less chance to find at least one rare type molecule nearby and thus to get copied.

besides its persistence and coexistence in itself, the spatial metabolic model has been shown to resist parasites. a parasitic replicator of the metabolic system is one that uses the monomers provided by metabolism for its own replication, but does not itself contribute to monomer production at all . such parasites are unable to kill off the spatial metabolic system even if their replication rate kp is much larger than those of the cooperating replicators. the simple reason for this is that wherever the parasite becomes abundant, the metabolic system breaks down locally, therefore any further parasite replication becomes impossible, while neighbourhoods devoid of parasites still produce the cooperating replicator types. the overall effect of this spatial regulation is that the parasite coexists with the metabolic system, albeit at a relatively low frequency. in a considerably large part of the parameter space of the model the parasites are definitely not able to ruin the metabolic system  <cit> .

 <dig>  the metabolic model with an evolving replicase
due to the specific enzymatic roles they play, metabolically cooperating replicators are rather strictly constrained in changing their spatial structure and thus also their monomer sequence. this does not apply to parasites lacking any catalytic function, however. once the parasites are around, neither doing real harm to the metabolic system as a whole, nor going extinct, they are free to mutate. mutants may be even more harmful than the original parasite they are derived from, they may be neutral compared to their "parents", or they may obtain traits that are of help for the survival of the metabolic system – we shall discuss the latter possibility in more detail in discussion. for now it is sufficient to note that harmful mutants are quickly eliminated from the system by the very same mechanism that keeps the original parasite rare: they kill off nearby metabolic replicators, themselves committing suicide this way. therefore, harmful mutants have no chance to disperse – they behave like hyper-virulent virus strains killing their host before it could reproduce and spread them. what we shall explore in more detail is the case when the parasite evolves to a beneficial function for the metabolic system by gaining replicase activity .

template replication and catalytic activity are antagonistic in the sense that replication is fastest on unfolded, short and linear templates whereas catalytic activity requires that the polymer be long and folded into relatively compact and stable spatial  structures. this means that a good template is unlikely to be a good catalyst at the same time. to take this plausible inverse relation of replication rate and catalytic activity into account in a metabolic system infested with mutable parasites we have extended the czárán-szathmáry model  <cit>  , as follows:

mutations
parasites replicate and decay exactly the same way as metabolically cooperating replicators do. the difference between cooperators and parasites is that a) the parasites are not needed for the replication of any other template , b) they can mutate whenever they replicate, and c) the mutants may occasionally obtain some replicase activity. specifically, mutation affects two crucial traits of parasites: their replication rate kp and their aspecific replicase activity rp. these traits are in a trade-off relation one with the other: if a mutation happens to increase the replication rate of a parasite, it will decrease its replicase activity, and vice versa.

the algorithm of the mutation process is the following: if a parasite is chosen for replication from a replication neighbourhood , we draw a random number  from a gaussian distribution of mean  <dig> and standard deviation σk. dk determines the mutated replication parameter k'p of the „daughter”-parasite according to the

  kp'=kp 

equation, in which kp is the replication parameter of the „mother” and kmax is the arbitrary upper limit for the replication parameter. to avoid mutations producing nonsense  replication parameters,  scales the actual value of k'p into the  range for any reasonable  value of dk . our choice of this specific mutation algorithm is justified not only by practical considerations . the phenotypic effect of a mutation is likely to depend on the actual trait value: it is realistic to assume that the quantitative effect of the same mutation may be smaller close to the limit of the trait range. this assumption is built into eq. <dig> as well.

once the mutation change dk for the replication parameter is specified, the trade-off relation

  de = -a·dk 

determines the expected value of the mutation change in replicase activity, de. a is the trade-off parameter – the larger it is, the more severe the trade-off between replicase activity and reproduction rate. to allow for some „wobbling” in the trade-off relation, we add a gaussian noise term ξ of  <dig> mean and σr standard deviation to the de value, to obtain the actual replicase activity parameter dr:

  dr = de + ξ 

σr specifies the plasticity of the trade-off relation – the larger σr the softer the trade-off, i.e., the more the relation of the two parameters can deviate from the trade-off line . r'p, the actual replicase activity of the mutant „offspring” is determined using dr, rp and rmax by rescaling in a way completely analogous to . figure  <dig> illustrates how dk and dr are calculated using the trade-off function. we have applied the reflective boundary condition on the margins of the trait range.

the „daughter-copy” of the parasite is the mutant, whereas the „mother-copy” keeps its original phenotype .

replicase support
a parasitic replicator r either provides help for the replication of neighbouring template molecules or it hampers template replication, depending on its actual replicase activity rr. if rr exceeds  <dig>  , then r acts as a real replicase, i.e., it helps replication, but a parasite with rr <  <dig>  acts as a „poison” for surface catalysis: it binds the template and does not even let the mineral surface help the replication process. replicase r that supports  template s is selected at random from the catalytic neighbourhood of s .

if there is no replicase around then reproduction takes place at the basic rate  provided by the  surface itself. of course a parasite  molecule cannot help its own replication; it needs another replicase in its catalytic neighbourhood for that.

updating and diffusion
the cellular automaton is updated one randomly chosen site at a time. if the site chosen is occupied by a replicator, it becomes empty with a probability pd. if it is empty, then all the replicators  in its replication neighbourhood  compete for occupying the empty site with a copy of themselves, according to the stochastic rules  in appendix. one generation consists of a number of such updates equal to the number of sites  in the lattice, so that each site is updated on average once per generation.

the diffusive movement of replicators is modelled by the algorithm of toffoli and margolus  <cit> , which preserves particle number and frequency distribution within the grid. the intensity of diffusive mixing depends on the number of diffusive steps per generation  taken by a replicator on the surface.

RESULTS
 <dig>  coexistence and parasite resistance
with σk =  <dig> , i.e., with parasite mutation banned, the model is identical to that of czárán and szathmáry  <cit> . the main conclusions of the non-mutable cellular automaton model are that

a) the surface-bound metabolic system remains persistent in a large part of its parameter space, even if the replicators have different replication rates;

b) diffusion does not ruin persistence – to the contrary, mixing is a necessary component of coexistence, because large monotypical patches of the same replicator type are doomed to extinction;

c) parasites are kept in check by the cooperating replicators, through their inevitable need for monomers which can be supplied to the parasites only by the cooperators, therefore even parasites of high replication rates are suppressed to a low frequency in the system.

a more detailed treatment of the results obtained from the non-mutable model is given in appendix.

 <dig>  replicase evolution: direct and indirect selection
by allowing for mutation changes in the parasite according to trade-off relations , evolution either towards higher replication rates alone, or to both higher replication rates and a subsequent increase in replicase activity, occurs . which of the two comes about depends on the strength and the plasticity of the trade-off between replication speed and replicase activity. too strong and too hard a trade-off – i.e., large a in  and small σr in  – means that a small increase in replication rate causes a large decrease in replicase activity. since higher replication rates have a direct positive effect on fitness, the system evolves towards increasingly efficient parasites, but steep slope and the small wobbling of the trade-off relation do not give a chance for replicase activity to catch up even when replication rate has reached its maximum .

in contrast, smaller a and/or higher σr parameters  result in a fast increase in replication rate first, followed by a slower increase in replicase activity later . the pattern and the timing of these evolutionary changes can be explained in terms of direct and indirect selection forces acting on the parasites of the metabolic system.

the more obvious case is direct selection acting in favour of faster reproduction: a larger replication rate is clearly of a direct fitness increasing effect – this is the cause of the steep increase in average replication rate among parasites. however, replicase activity itself has no direct effect on the fitness of the parasite, because parasite molecules with a higher replicase activity cannot help their own replication, only that of their neighbours. in spite of this we find slower, yet steady evolution towards increased replicase activity r. the reason for this is indirect selection: better replicase molecules increase the fitness of their neighbours. the beneficiary neighbours are either metabolic replicators or parasites. with limited spatial dispersion of the offspring, neighbouring parasites are with a good chance „relatives” of the one that gives catalytic help: what we see is a typical case of kin selection at work. this in itself results in a fitness increase for parasites with a higher replicase activity in a poorly mixed system, but there is also another indirect beneficial fitness effect which does not require limited spatial mixing. metabolic neighbours reciprocate the catalytic help they get from the replicase, by providing monomers for reproduction of the latter. an efficient replicase has more chance to be surrounded by a complete set of metabolic replicators  simply because the local density of replicators around it is higher than around less efficient ones. this indirect positive selection effect does not depend on spatial mixing , and even if so, it definitely does not require slow  diffusion.

as for the real influence of diffusion rate d on replicase evolution, we have performed simulations with different diffusion intensities  and found no qualitative difference compared to lower rates of diffusion . a slight improvement in the overall performance of the system is observed in the course of replicase evolution: the total number of replicators increases at the expense of empty sites. as the parasite converts into a "replicase" and starts working for the common good, it becomes released from the check by metabolic cooperators and can reach high abundance in the system .

discussion
 <dig>  weak altruism and group selection in the metabolic replicator model
it is important to consider our model from the point of view of models of group selection. first, we are dealing with an mls <dig>  in which the only focal units are the replicators. in contrast, the stochastic corrector model is of the mls <dig> type since both the replicators and the groups are focal units in the process. second, the previous metabolic model  <cit>  and the replicase evolution model behaved entirely differently when the rate of diffusion was increased: the former survived and the latter collapsed. why is this so? the answer is, we propose, that replicators better aiding metabolism are weak altruists, whereas better replicase replicators are strong altruists, as can be checked by the mutation test of nunney  <cit> . for both types of altruist it holds that within the same group the altruist has smaller fitness than the selfish variant. the mutation test compares different groups in that it asks: would a selfish unit when mutated into an altruist in a group have an absolute loss in fitness? for weak altruists such a drop is not realized because by contributing to the benefit of the group there is a net gain in absolute fitness for the altruist, even though within the same group it has smaller fitness relative to the selfish types. replicators aiding metabolism can 'see themselves', or 'scratch their own back' as it were, hence they can qualify as weak altruists. in contrast, as mentioned before, replicase replicators cannot see themselves: another copy is needed for helping the focal individual, thus they are strong altruists. it is known that weak altruism can spread by random group assortment whereas the spread of strong altruists need positive assortment . this is the reason why the metabolic model failed to collapse under increasing diffusion: it just converged to a trait group model with random assortment of the kind analyzed by szathmáry  <cit> . in contrast, limited diffusion was mandatory for survival of the replicase model, which created positive association.

if all this holds, why do we find then that in our combined model the replicase evolved despite increasing diffusion rate? the answer has been given above by the term 'indirect selection': through the effect on metabolic replicators, even one replicase can 'see itself' . this shows that systems chemistry will be an exciting field for evolutionary theory as well.

 <dig>  metabolic parasites as preadaptations
as briefly mentioned in part  <dig> of the results section, metabolic parasites can mutate to different functions. some of the mutants might be even more harmful than just a non-cooperating parasite, directly damaging the metabolic system – but these mutants are doomed to fast extinction, because they kill their „hosts”  before they could enjoy the benefits of having them around, and thus they die out themselves too. most mutants will be neutral, i.e., just as parasitic as their ancestors, doing no more and no less harm to the system than just tapping the metabolism for monomers and using them for their own replication. neutral mutants will diversify and thus "scan" the sequence space, and they will all coexist with the hosting system just as their ancestors do. this means that many neutral mutants of different sequences accumulate within the metabolic system as new mutations occur. finally, some of the many neutral mutants might mutate to something that potentially carries some utility for the metabolic system itself – and that something might be many different things.

we have explored the case when mutants can show a little better replicase activity than the very basic catalytic help to replication given by the mineral surface harbouring the metabolic system . this has been shown to indirectly benefit the mutant itself, and obviously it is positively selected at the level of the whole metabolic system too, because it increases the replication rates of all the replicators present. thus, the replicase will spread, and the relative fitness of the mutant system, compared to one with a weaker replicase activity of the „converted” parasite, increases.

some other mutants may be useful in the metabolic reaction network, possibly catalyzing one or another reaction better than the previous replicator, or even opening new and useful reaction routes. in any case the new, more efficient mutant spreads, and the metabolic system itself also benefits .

still other mutants may open yet another metabolic route by converting some of the intermediate metabolites or waste compounds to small amphipathic molecules. these may become the first building blocks of a primitive membrane structure wrapping the metabolic system into small vesicles. such a mutant would be of high selective value to the whole replicator community, because it would result in the encapsulation of the – thus far surface-bound – metabolic system, providing it with a more efficient method for group selection: the stochastic corrector mechanism  <cit>  .

all in all, the metabolic parasites of the surface-bound metabolic system may represent preadaptations to virtually any possible catalytic function in a future protocell, including better metabolic enzyme functions, membrane production, and replicase activity. membrane production would ultimately lead to the „prebiotic takeoff” of the metabolic system, by detaching it from the surface allowing it to enter a new environment and a more efficient selection regime in a proto-cellular structure . all these benefits depend critically on the continuous input of mutations of metabolic parasites on a hosting surface – and these circumstances seem inevitably to be present in the spatial metabolic system anyway. we have explored in some detail the case when mutants gain replicase activity, but both the adoption of some mutants as new metabolic replicators by the metabolic system and the hypothetical case of 'abstriction' require detailed modelling for more theoretical support.

our approach is similar to the proposed scenario of ma et al.  <cit>  who were interested in the de novo appearance of a single type of nucleotide synthetase on a surface, following the spirit of the model of szabó et al.  <cit>  for the appearance of replicases. they envisaged the subsequent appearance of a ribozyme synthesizing membrane components, and the appearance of a replicase only after membrane compartmentation. we have shown here that the emergence of a replicase within a ribozyme-catalyzed surface-bound pre-existing metabolic system is more likely than the appearance of a synthetase just by itself as in  <cit> : this is due to the favourable indirect selection for better replicases by feedback through the metabolic system. emergence of the replicase by itself requires very limited diffusion; the system presented here is free of that constraint, but of course the metabolites must stay in a limited neighbourhood of their production, as also assumed in  <cit> .

CONCLUSIONS
in this paper we concentrated on dynamical coexistence of useful replicators with passive population structure. while resistance against parasites can be provided by couplings different from those in our model , we are convinced that focusing on metabolism is especially important because it points in the direction of interesting complexification leading towards the origin of cells with templates, membrane and metabolism.

appendix
the non-mutable metabolic replicator system
the basic metabolic machinery is the same cellular automaton as the one described in czárán and szathmáry  <cit> : it consists of a  <dig> ×  <dig> square grid of sites with a toroidal topology to avoid edge effects. each site of the grid can contain at most one replicator molecule, which may be either one of the metabolic „enzymes”  or a parasite .

replication and decay
besides catalysing specific reactions of metabolism, metabolic replicators can do two things: replicate, or decay. for a replication event of any template s into a neighbouring empty site to occur, s must be complemented by all the metabolically active types present in its metabolic neighbourhood of a certain size . note that the parasite requires all the n metabolic types around for its replication, but the metabolic replicators do not need the presence of the parasite in their metabolic neighbourhood for their reproduction.

the claim of template s to replicate into an adjacent empty site is:

  c = rs · ks · ms, 

where rs is the replicase support , ks is the reproduction rate and ms is the metabolic support for replicator s.

  ms=1/n, 

in which f is the copy number of metabolic replicator type i within the metabolic neighbourhood of s. n is system size . observe that the parasite, which is type n +  <dig>  is not counted here. notice also that ms is proportional to the geometric mean of within-neighbourhood metabolic replicator frequencies – if any one of the n metabolic replicator types is missing from the metabolic neighbourhood, then ms, and thus also c, is zero. the chance of s to replicate into the empty site is:

  ps=cce+∑lc 

where l are the four orthogonal nearest neighbours  of the empty site, and ce is the claim of the empty site to remain empty. thus the probability that the empty site remains empty is:

  pe=cece+∑lc 

decay is aspecific, defined as a constant probability pd for any occupied site to become empty in time t +  <dig>  irrespective of what type of replicator it harboured in time t.

results of the non-mutable metabolic replicator model
the most important result with this setting is that the cellular automaton is capable of producing coexistence in a large part of its parameter space. no conspicuous mesoscopic patterns like monotypical patches or spiral waves  <cit>  arise in any simulation, since a relatively homogeneous spatial distribution of the metabolic replicator types is necessary for many neighbourhoods to contain a metabolically sufficient set of macromolecules and thus for the replicators to survive. that is, a persistent system cannot show an aggregated pattern.

from the viewpoint of template coexistence, the most relevant parameters of the model are diffusion rate  neighbourhood size  and system size . figure  <dig> illustrates the effects of these parameters on the ecology of the metabolic system without parasites and mutation.

diffusion
increased diffusion rate promotes coexistence in any case of sufficient replicator density. however, very sparse systems are killed by fast diffusion, because potentially cooperating replicators are dispersed apart in space and thus they have little chance to be metabolically complemented. diffusion helps parasites in spreading, but they cannot drive the metabolic system extinct even at very high diffusion rates: the spatial regulation mechanism works well also with fast diffusion.

metabolic neighbourhood size
for a fixed system size, there is an optimum neighbourhood size, below which the chance that it contains a metabolically complete set of replicators is too small or even zero  and above which replicators start to "feel" the overall population density, and the results are similar to those of the nonspatial model . note that metabolic neighbourhood size corresponds to the distance within which metabolite concentrations do not shrink too low, i.e., indirectly it depends on metabolite diffusion rates.

system size
for any fixed combination of neighbourhood size and diffusion rate, increasing system size ultimately leads to the collapse of the system for the reason discussed above in relation to neighbourhood size reduction: neighbourhood size is the absolute upper limit of system size. however, this is partly due to an artificial effect of coarse spatial resolution: assuming more sites within a metabolic neighbourhood of the same physical size, the system size effect could be weaker.

decreasing system size makes coexistence more likely in any parameter setting, but it is to be noted that we do not consider the absolute efficiency of metabolism to be a function of system size in this model. this would be reasonable to assume, however, since more replicators might catalyse a more efficient metabolism, giving more chance of survival for the larger system. that is, we apply a worst-case assumption here.

parasites
parasite molecules benefit from the presence of metabolic cooperators which drive metabolism , but they do not themselves contribute to monomer production at all. as in czárán and szathmáry  <cit> , we found that a coexistent metabolic system cannot be killed off by such a parasite, even if its replication rate exceeds that of the fastest cooperating macromolecule type. extremely efficient parasites can reduce the concentration of the metabolically active replicators by simply occupying most of the surface available, but even then local neighbourhoods containing fewer or no copies of the parasite will be at an advantage and thus increase the relative frequency of cooperators. the result is a persistent metabolic system which is coexistent with its parasite. at whichever parameter set the system is persistent without the parasite, it is also persistent with it in most cases. a system that collapses would do so without the parasite as well.

authors' contributions
the model was a common idea of kb, tc and esz, kb and ct have designed and implemented the metabolic system in the cellular automaton framework. all authors contributed to writing the manuscript and drawing the figures and approved the final version.

