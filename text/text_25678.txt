BACKGROUND
gene set analysis  has proven to be a useful approach to microarray analysis. the underlying principle of gsa is that aggregate scores are assigned to each gene set based on all the individual gene scores within that set. there have been several different methods proposed to assign scores to gene sets  <cit> . of the approaches published to date, gene set enrichment analysis   <cit>  <cit>  seems to have become the most commonly used. of issue though is the fact that gsea is based on a modified kolmogorov-smirnov test. this test can exhibit a lack of sensitivity; is difficult to employ in practical use, and requires at least  <dig> permutations to be run. however, it has recently been found  <cit>  that a one-sample z-test can be very effective with gene sets for detecting shifts from the mean . unfortunately, this will not identify gene sets that have a balance of both up and down regulated genes as there will not be the requisite shift from the mean but in statistical terms is rather a change in scale. however, a chi-squared test can be used to good effect to detect such changes in scale and thus find gene sets that exhibit a mixture of up and down regulation  <cit> . furthermore, irizarry et al.  <cit>  have shown that the use of a combination of the computationally simple and rapid z-test and chi-squared methods outperform gsea. dinu et al.  <cit> have extended the significance analysis of microarrays to gene set analysis . of further interest is the method described by efron and tibshirani  <cit> which uses a max-mean statistic to target gene sets with only a fraction of the genes differentially expressed and the approach of falcon and gentleman  <cit> which takes into account the fact that overlap exists between different gene sets. a good review of the various statistical approaches has been written by goeman and bühlmann  <cit> .

gene set generation
given the discussion above it is clear that considerable effort has been made to apply different statistical methods to gsa, however all of the methods are highly dependent on the very first step: the predefinition of the sets of genes to be analysed. the theoretical combinatorial space for gene sets is quite large and is defined by the binomial distribution of the number of genes in the genome and the size of the desired set:

 ≡genes!setsize!genes−setsize! 

thus, if one wanted to create all of the possible unique sets with  <dig> members for the ~ <dig> genes present in the yeast genome, there would be  =  <dig>  ×  <dig> sets. this is clearly an unfeasible number of sets to generate, much less evaluate. instead, methods to date have used extant biological knowledge to generate relatively small numbers of sets to be evaluated. one of the common approaches taken for set generation is to simply place the genes involved in a specific pathway into a set. this approach suffers from the fact that pathways are merely human abstractions that are useful for visualisation and interpretation, as they can serve as mnemonic devices for areas of metabolism. however, in isolation, single pathway sets do not reflect the continuously connected nature of biological networks. the metabolic network of saccharomyces cerevisiae  can be seen in figure  <dig>  it is clear that this is a complex, interconnected network and, as such, any attempt to use simple pathway representations of it will inevitably be an incomplete representation of the underlying network. we therefore propose that many “pathway sets” are, by definition, rather arbitrary and incomplete, and gene expression patterns may therefore be potentially missed due to improper/incomplete set generation. we suggest that a method that semi-exhaustively partitions the network into overlapping sets would be a better approach to set generation. in order to achieve this we have devised two algorithms that use the principal component analysis of a laplacian matrix of a metabolic network to do gene set generation. we have also devised a hypergeomtric test to determine which of the genes in the sets identified by gene set analysis are likely to be driving set selection. we have used the resulting gene sets to analyse a publicly available microarray dataset and compare the results obtained from our algorithms  to each other as well as to results obtained with traditional pathway sets.

it is important to note that our intent in this paper is not to compare gsa methods to standard parametric statistical approaches  as there is ample literature on gsa to show its usefulness in difficult datasets . rather, our intent is to select a relatively simple dataset with which to make the point that the existing state-of-the-art gsa methods that use isolated pathways are very prone to miss significant amounts of the signal  and to report insignificant genes as they are simply associated with a set that is deemed to be collectively significant. as such, both the false negative and false positive  rates of gsa are high when using isolated pathways. we believe that we have shown that we can address these issues with our method. to demonstrate this we have chosen a straightforward, publicly available dataset with a simple perturbation for which this can easily be demonstrated. we have used this dataset to simply highlight the differences in the results generated by our method rather than to do a full-blown biological interpretation of the microarray results.

methods
affymetrix probeset to yeast genome mapping
the sequences for each of the individual probes of the affymetrix yeast  <dig>  genechip were mapped to the yeast genome by the use of blastn  <cit> . a perl program was written to perform the following tasks: 1) extract 100% identity matches  from the blastn results; 2) assemble the probes into probesets and  <dig> ) model the resultant probeset-to-gene relationships as an affymetrix-probeset-to-genome graph.

single pathway set creation
in order to compare our method to how gsa of pathways has been done in the past it was necessary to create single pathway-specific sets. a perl program was written to parse the xml files downloaded on june  <dig>   <dig> from kegg  <cit>  and the genes listed in each pathway file were used to create a simple set for each pathway. this is analogous to how pathway sets have been created for gsa previously.

metabolic network and laplacian matrix creation
a perl program was written to parse the xml files downloaded on june  <dig>   <dig> from kegg  <cit> . nodes were created for compounds, reactions and genes, and edges created between genes and the reactions they are involved in as well as between compounds and the reactions they are substrates for or products of. the result of this process can be seen in figure  <dig> as visualised by cytoscape  <cit> . the resulting metabolic network was used for all subsequent set generation. a reference structure within the perl program which reflected the nodes and edges in the graph was used to identify adjacency and degree parameters for each node and thus generate the corresponding laplacian matrix.

principal component analysis
principal component analysis of the laplacian matrix was done in r with the prcomp function. qlucore v <dig>   was also used for pca model creation and visualisation of principle components during the exploratory phase of algorithm development.

set theoretic analysis
set theoretic analysis  of the gene sets and pathway results sets was done in perl with the use of the set::scalar library v  <dig>   <cit> .

graph theoretic analysis
graph theoretic analysis was done in perl with the use of the graph library v.  <dig>   <cit> .

threshold-based set creation algorithm
as became clear from examining the pca score plots, as well as plots of scores across all components, a gene or group of genes may have different scores in different principal components. as such, we decided to create sets at a number of different thresholds to investigate whether this approach would give more or less sensitivity in gene set analysis. thus for each principal component the positive scores were compared against a series of integer thresholds  and if the score at a principal component was greater than the threshold it was added to a set created for that principal component. a similar procedure was followed for the negative scores at each principal component with the score required to be less than the negation of the integer threshold. genes in these sets were then mapped to affymetrix probeset ids with the use of the aforementioned affymetrix-probeset-to-genome graph , and the matched probes substituted for the genes in the set. sets that contained more than, or equal to, five probeset ids were kept for further analysis. the resulting sets were subsequently printed out in the .gmt set format used by efron and tibshiran   <cit> . this algorithm was implemented in perl.

step-function-based set creation algorithm
in a separate effort to determine the effects of groups of genes clustering at distinct score ranges within each component on gene set creation and performance an algorithm for set creation was created as follows. an initial empty score-range set was created as an array and held in memory. scores at each component were sorted in numerical rank order. for positive scores greater than one, neighbouring rank order scores were subtracted from one another and if the difference was <  <dig> they were added to the existing score-range set, if the difference was >  <dig> the a existing score-range set was closed and a new one  was created and the new gene added to it. this process was repeated across all of the scores in each principle component. a similar procedure was used for the negative scores less than negative one. this algorithm was implemented in perl.

gene set analysis with newly generated sets
we used the sets created by the laplacian pca method described above for the max-mean method by efron and tibshiran   <cit> . in order to test the new sets on a data set that would likely have a limited number of subtle changes on metabolism, we selected a data set that examined the effect of an o-glycosylation inhibitor, ogt <dig>  on gene expression deposited by javier arroyo. they used the saccharomyces cerevisiae strain sey <dig> and analysed the global transcriptome in the absence of the ogt <dig>  and in the presence of  <dig>  μm of ogt <dig>  they report that “yeast cells exposed to ogt <dig> in ypd growth medium show a significant inhibition of mating, filamentation and induction of cell wall compensatory mechanism.” the resulting microarray data was downloaded from the gene expression omnibus   <cit> . specifically, the microarrays used were those for the dmso control  vs. the cells treated with  <dig>  μm of ogt <dig> . the microarray data was normalised in r with the rma method  <cit>  and the resulting log <dig> transformed data used for gsa. gsa was performed on this data with the following settings: resp. type = "two class unpaired", nperms =  <dig>  minsize =  <dig> and fdr cut =  <dig> . the gsa analysis for the largest number of sets  ran in  <dig>  minutes on a single cpu intel xeon e <dig>  <dig>  ghz cpu. the genes found in the sets created at pca score thresholds  <dig> through  <dig> which were determined to be differentially expressed by gsa were tested with the hypergeometric test described above. the genes selected by this test were then used to create genes-only and compounds-containing pathway-centric graphs as described below. these graphs were visualised in cytoscape. fold change values were calculated as the ratio of the average expression values for the samples containing  <dig>  μm of ogt <dig> to the dmso controls, and used as node attributes to colour the gene nodes in cytoscape. the negative reciprocal was taken of ratios less than  <dig> 

hypergeometric enrichment test to determine genes most responsible for set selection
in order to determine which genes identified by gsa on our newly derived sets are drivers we implemented a hypergeometric test. the probability  of obtaining any such set of values is given by the hypergeometric distribution:

 p=a+bac+dcna+c 

where nk is the binomial distribution, a = number of times the gene is found in significant sets; b = number of times all other genes are found in significant sets; c = number of times the gene is found in non-significant sets; d = number of times all other genes are found in non-significant sets, and n = a + b + c + d. a perl program was written to parse each of the gene set analysis results as well as the original sets used for the analysis after thresholding, and from these two sources calculate a, b, c, d and n. the two tailed fisher module of the text::nsp perl package  <cit>  was used to test for significance using these values and multiple hypothesis testing corrected for with the holm-bonferroni method  <cit> . genes with a q-value less than or equal to  <dig>  were reported as significantly enriched  and included in a pathway-centric network reconstruction for visualisation and interpretation.

pathway-centric network reconstruction for visualisation and interpretation
as was mentioned in the introduction, pathways are really human abstractions of subgraphs of a metabolic network that are particularly useful as mnemonic devices for contextual visualisation. unfortunately, visualizing the network with all of the reaction, compound gene and pathway nodes present is overwhelming and as such difficult to interpret. if a biologist can see that the genes selected are part of a well-known pathway it helps them to interpret what part of the metabolic network they are examining. by evaluating the results in this linked metabolic context, one is able to see relationships between areas of metabolism that simply would not be apparent by looking at lists of genes or lists of pathways. thus, we have created two types of visualisations in order to better show the metabolic context of the results. the first visualisation just contains the significant genes and the pathways that they are associated with. this is a useful and relatively simple way to visualize the results. however, there are cases where related pathways are affected but do not show up as connected without the compounds being included in the network. inclusion of all of the compounds leads to a very complex figure so we have chosen to simply create a single edge between pathways if they share one or more compounds.

raw kegg xml files actually pre-group all genes, reactions and compounds into these contextualised pathways. in order to provide these sorts of visualisation cues a pathway-centric view of the metabolic network was therefore constructed as follows:

a perl program was written to parse the kegg xml files such that a node was created for each pathway as defined in kegg. an edge was created between the pathway node and each gene or compound that is associated with that pathway. a gene determined to be significant by gsa and the subsequent hypergeometric test was used as a seed for a breadth first search of the pathway-centric graph with a radius of one. this was done iteratively for each gene and the union taken of the resulting subgraphs . a similar procedure was followed for the compound-linked-pathways view with the additional step of the creation of a single edge between pathways that shared one or more compound.

genes-only and compounds-containing graphs
two different graphs were then created, one with and one without compounds. for the genes-only graph, compounds and their associated edges were simply removed from the graph. the compounds-containing graph was constructed by removing all compounds with a degree less than two, such that compounds only served to link pathway nodes together. the genes-only view of the graph is easier to visualise and interpret whereas the graph containing pathway-linking compounds was useful in showing the connectedness  of the subgraphs containing differentially expressed genes.

gene ontology and funcat enrichment analysis
genes that were found by the threshold  <dig> method but not by the pathway gsa were checked for go enrichment by goeast  <cit>  and funcat enrichment at mips  <cit> .

RESULTS
graph representation of a metabolic network
mathematically, a metabolic network can be represented as a graph, g = , where v is a set of n nodes and e a set of e edges  between nodes. let a = a be the adjacency matrix of g such that each element aij is assigned a value of one if the corresponding nodes are adjacent and zero if they are not. the graph can be further described by a laplacian transform of the adjacency matrix. the laplacian matrix lnxnis defined as:

 li,j:=deg)ifi=j−lifi≠jandviisadjacenttov0otherwise 

where deg) denotes the degree of v, i.e. the number of edges incident to . thus, the laplacian matrix is the difference between the diagonal degree matrix  and the adjacency matrix .

l = d - a

a number of graph theoretic properties of a graph can be derived from its laplacian matrix and the eigenvector and eigenvalues thereof, including the number of connected components in the graph; its algebraic connectivity ; its spectral gap, etc. in fact, the pca of a graph and spectral graph clustering have been linked previously by saerens et al.  <cit> .

principle component analysis
given a matrix, one can use multivariate statistical methods such a principal component analysis  to try and find correlative relationships amongst the vectors. pca is a bilinear modelling method which gives a visually interpretable overview of the most salient information in large, multidimensional datasets. by plotting the principal components it is possible to view statistical relationships between different variables in complex datasets and detect and interpret object groupings, similarities or differences, as well as the relationships between the different variables  <cit> . as described in the methods section a graph was created from the kegg database  <cit>  and a laplacian matrix derived from said graph. the laplacian matrix produced, while not a typical object-variable data matrix, may still be analysed with multivariate methods. it was hypothesised that a principal component model would enumerate groups of nodes within the graph with similar topological structure, with the thought that similar columns within the laplacian matrix would explain a certain amount of ‘variance’ in the matrix. accordingly, we then performed pca on the laplacian matrix with the hopes of finding an exhaustive set of structures within the graph that could be used for gene set generation.

gene set generation with score thresholds and step-functions
it was observed that the scores for each principal component often generated discontinuous clusters of objects. two algorithms for set generation were therefore developed: one based on a step function that took the score discontinuities into account; and another that specified several predetermined thresholds. the sensitivity levels of both these methods were subsequently compared. these algorithms were used to generate gene sets from the genes found in each of the  <dig> principal components .

gene set analysis with new gene sets
we used the sets created by the laplacian pca method described in the methods section to perform the max-mean method of gsa  <cit> . in order to test the new sets on a dataset that would likely have a limited number of subtle changes on metabolism, we selected a data set that examined the effect of an o-glycosylation inhibitor. the analysis was done as described in the methods section and the results described below.

hypergeometric enrichment test to determine genes most responsible for set selection
one of the difficulties faced in gene set analysis is that it is unclear which of the genes within a set found to be significantly and collectively different are most responsible for that difference. this means that each significant gene set likely has a subset of genes that really account for the difference that is detected ; and a separate subset of genes that do not significantly contribute to the greater set’s difference . fortunately, due to the semi-exhaustive nature of our set creation algorithm we have the ability to test for the likelihood of set members being drivers or passengers. if a gene is found in a number of significant sets at a considerably higher frequency than one would expect to see at random then it is more likely that the gene in question is a driver. in order to determine which genes identified by gsa using our newly derived sets are drivers we implemented a hypergeometric test as described in the methods section. those genes considered to be drivers were included in a pathway-centric network reconstruction for visualisation and interpretation  as seen in figures  <dig>   <dig>   <dig> 

high numbers of components are required to model a metabolic laplacian matrix
first, we noticed upon examining the laplacian pca model that it needed  <dig> principal components to explain all of the variance in the matrix . this is unusual as pca models are normally quite efficient at reducing the dimensionality of a data set. in this case we believe that it suggests that the model is likely semi-exhaustively explaining local structures in the graph. additional file 1: figure s <dig> is a plot of the percentage of variance explained by each principle component. it is easy to see from this plot that the variance being modelled is spread out quite broadly over the  <dig> components with almost all of the components individually explaining less than  <dig> % of the variance.

individual components model local areas of the graph
in order to test this hypothesis visually we extracted nodes from each principle component and examined their locations in the metabolic network. figure  <dig> is an overview of the metabolic network with the significant nodes found in the first three principal components , identified in green and their adjacent edges identified in red. it is clear that the first three principal components are identifying distinct, localised structures in the graph. with the hypothesis that genes that are closely related to one another in the metabolic network are likely to be co-regulated we believe that each principal component in the model is a candidate for one or more sets of genes to be tested by gsa. to examine this further we looked at the graph structures being located by many of the principal components. we found that the principal components are finding graph structures with highly connected sets of genes that will likely be good candidates for gsa. we continued this analysis through many higher components of the model to confirm that this was indeed occurring throughout a broad range of components. to confirm this observation the distance between all genes in each set was determined and the average distance within each set calculated to be  <dig> . given that there is a distance of one between a gene and the reaction it is associated with and a distance of two  between reactions, this means that in each set, on average, each gene is being associated with genes involved the first, second or third neighboring reactions. the distances between all genes in the metabolic network have been calculated and their sorted distribution is shown in additional file 2: figure s <dig>  the red arrow indicates the average intra-set gene distance. as such, the sets contain only about 20% of the possible gene pair distances. thus, it appears that sets are modelling relatively local topologies in the network.

semi-exhaustive nature of pca-graph gene set creation
we examined the distribution of pca scores for each gene in the model across all of the principal components. almost all genes participate in multiple principal components. this indicates that sets generated from the principal components from the pca of the metabolic laplacian matrix will be topologically exhaustive, that is to say covering the combinatorial space as constrained by the graph in an overlapping fashion. to confirm this we examined the number of times that each gene was found in sets created by a principal component score threshold of one. additional file 3: figure s <dig> shows the rank order distribution of the number of sets each gene is a member of. only two genes belong to only one set and some genes belong to as many as  <dig> different sets. as such, it is clear that in gsa almost every gene would be tested in combination with many other groups of genes, which gives our method a higher likelihood of finding co-regulated sets of genes. we checked the location of the  <dig> genes that belong to the fewest gene sets and found that they typically are either located in the extreme leaf nodes of the large network or in the small disconnected subgraphs. intuitively, this makes sense as members of the outer extremities of the large network and the disconnected subgraphs will be part of fewer graph structure variants and therefore occur in fewer principal components, and thus belong to fewer sets derived from the principal component scores.

degree of overlap amongst sets
in order to determine the level of overlap between the sets generated by this approach an all-against-all comparison of the sets was done by way of set theoretic intersects. for the  <dig> sets generated at a score threshold of one, an all-against-all comparison is comprised of  <dig> , <dig> set intersects. the number of sets intersecting with each individual set was calculated and plotted . as can be seen from additional file 4: figure s4a many of the sets do have intersects with one another ranging from as few as  <dig> to as many as  <dig>  in order to achieve a semi-exhaustive coverage of the graph’s local topology this sort of overlap is desirable, as long as the degree of overlap is not so high that the sets become effectively redundant. in order to determine the degree of the overlap amongst sets the size of each intersection was calculated, followed by the number of set intersections of each respective size . of the  <dig> , <dig> set intersects performed,  <dig> , <dig> showed no shared genes at all,  <dig> , <dig> shared one gene, and  <dig>  shared  <dig> genes. as can be seen in additional file 4: figure s4b the number of set intersections with higher degrees of overlap drops very quickly. this would appear to be a very desirable result as it appears that the laplacian pca is yielding sets that thoroughly cover local topological structures in the graph without introducing an excessive level of overlap, i.e. redundancy, in the sets. as such the set intersection space is actually quite sparse as 80% of the potential set intersections show no overlap at all. this again emphasizes that local topological structures in the graph are being modelled by pca, as one would not expect there to be overlaps of subgraphs  that are topologically separated from one another.

set size
the sizes of the sets vary at each principal component depending both on the region of the graph being modelled by that component and the magnitude of the score threshold employed. additional file 5: figure s <dig> shows the distribution of set sizes when a score threshold of +/−  <dig>   <dig> or  <dig> is used. the set sizes range from  <dig> to  <dig> members with an average set size of  <dig> genes.

hypergeometric test
the hypergeometric test resulted in a ten-fold reduction in the number of genes from the threshold  <dig> sets up to a forty-nine-fold reduction from the threshold  <dig> sets, thus simplifying the resulting network that needed to be visualised and analysed.

results from sets derived from different pca score thresholds
sets created at different pca thresholds naturally have different set sizes and composition and as such may have slightly different sensitivities in finding differential changes in some portions of the metabolic network. the threshold-based set generation algorithm produced  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig> and  <dig> sets for threshold  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  and  <dig> respectively for a total of  <dig>  sets.

in order to evaluate the efficacy of sets created at different thresholds, a set theoretic approach was used to determine the effects of these thresholds employed during set generation on the pathways identified by gsa. lists  of pathways with significant differences were generated from the results of gsa performed with sets generated with pca score thresholds  <dig> through  <dig> . thresholds  <dig> through  <dig> yielded no results after the application of the hypergeometric test. this is likely due to the relatively small number of genes and sets generated at the higher threshold levels. as such, there are insufficient differences in global and individual set frequencies for the hypergeometric test to discriminate between driver and passenger genes . the set theoretic difference was then determined between the pathway sets resulting from pca scores thresholds  <dig> through  <dig> as compared to the pathway set found using a pca scores threshold of  <dig> 

all but one of the pathways found at thresholds  <dig> through  <dig> were also found with a threshold of  <dig>  the one exception being one gene in aminoacyl-trna biosynthesis found at threshold  <dig>  as expected, the threshold  <dig> results contained many pathways not found at the other thresholds, specifically:  <dig>   <dig>   <dig> and  <dig> more pathways were found with threshold  <dig> than with thresholds  <dig>   <dig>   <dig> or  <dig> respectively. however, as the different thresholds contain subsets of the pathways and genes found in threshold  <dig> they can be used as a ‘zoom-in, zoom-out’ method to view focused portions of the differentially changed network. figure  <dig> contains the results of sets generated with a pca scores threshold of  <dig>  figure  <dig> is a slightly different view of the results, containing edges between pathways that share one or more compounds. although somewhat more complex, it clearly shows the linkages between genes in the result sets. of note is the connections between the pathways seen at the top of the figure that show the connections between n-glycan biosynthesis, the phosphatidylinositol signaling system, inositol phosphate metabolism, glycerophospholipid metabolism, glycerolipid metabolism and glycosylphosphatidylinositol-anchor biosynthesis  which can be seen in more detail in figure  <dig> 

comparison of threshold-based sets to step-function-based sets
the step-function-based algorithm generated  <dig> gene sets. the lower number of sets generated is likely due to the fact that the step-function identified many groupings with less than five members which did not qualify as a set for gsa purposes. the gsa results from sets generated by the use of a step-function on pca scores was compared to the results generated at a score threshold of  <dig>  similar to the threshold comparisons the step-function identified three pathways  not found by the threshold  <dig> method. the threshold  <dig> method also found  <dig> pathways that were not found by the step-function method. this likely means that the entire positive or negative branch of a principle component is accurately modelling a topological structure and that subgraphs within that topology are not generally needed to increase the sensitivity of gene sets to be used for gsa.

comparison of threshold  <dig> sets to single pathway sets
as has been discussed above, threshold  <dig> sets, with very few exceptions, give the most complete view of differential changes occurring in the metabolic network. in order to compare this new set generation method to previous approaches we created single pathway sets  which are the type of sets that have traditionally been used in the past. we ran gsa on the  <dig> single pathway sets described above and compared the results to those generated by the use of threshold  <dig> sets. the results of the single pathway results can be seen in figure  <dig>  the single pathway sets only identified  <dig> pathways as opposed to the  <dig> identified by the threshold  <dig> method. additionally, because there is comparatively little overlap in the single pathway sets it is not possible to use a hypergeometric test to determine which of the genes are drivers of the set statistic and which are simply passengers. furthermore, with single pathway sets it is much harder to determine how the sets are related to each other within the metabolic network. it is clear that the results from threshold  <dig> as presented in figures  <dig>   <dig>   <dig> are much more comprehensive that those from single pathway sets as presented in figure  <dig> 

single pathway sets found  <dig>  of the  <dig> genes found to be differentially expressed by the threshold  <dig> method, thus it missed  <dig> genes  found by the threshold  <dig> method. furthermore, it included  <dig> apparent passenger genes  that were present presumably because the pathway set containing them was found to be significant and not because they contributed to the signal.

the results of the threshold  <dig> analysis could certainly be presented as lists of genes or as lists of different pathways. however, we are attempting to point out the limitations of precisely this isolated pathway mode of thinking, the effects of which have been noted elsewhere in the literature:

“the classical method of metabolic engineering, identifying a rate-determining step in a pathway and alleviating the bottleneck by enzyme overexpression, has motivated much research but has enjoyed only limited practical success. intervention of other limiting steps, of counter-balancing regulation, and of unknown coupled pathways often confounds this direct approach  <cit> .”

thus, it would appear that there have been many attempts at metabolic engineering in which researchers have not taken into account the fact that pathways don’t exist in isolation but are rather all interconnected. as such, many attempts at metabolic engineering fail as they are based on an overly simplistic model. therefore, we contend that seeing the genes in the context of the metabolic network is a more accurate way to portray and understand what is really occurring in metabolism. pathway names are very useful mnemonic devices to remind one what area of metabolism is involved, but should not be used to artificially isolate gene functions from one another.

our method finds differentially expressed genes involved in n-glycan biosynthesis, the phosphatidylinositol signalling system, inositol phosphate metabolism, glycerophospholipid metabolism and glycerolipid metabolism that were missed by the single-pathway method. furthermore, it provides the visual context for how these pathways are interlinked and how they are linked to glycosylphosphatidylinositol-anchor biosynthesis . these findings and the relationship between them would seem to be an important aspect of the biology that was missed by the single-pathway approach.

in addition, in order to determine the central biological themes that our method found but were overlooked by the single pathway gsa method, all of the genes that were found by our method and not found with single pathway gsa were subjected to go enrichment analysis and funcat enrichment analysis as described in the methods section. although it is beyond the scope of this paper to do a full biological interpretation of these genes, we have discussed them briefly below and included the full go and funcat enrichment results as supplementary material.

funcat enrichment
the general categories of the functions that our method finds that would have been missed previously include, as identified by funcat enrichment: amino acid metabolism, nitrogen, sulphur and selenium metabolism, carbohydrate metabolism, lipid, fatty acid and isoprenoid metabolism, secondary metabolism, glycolysis and gluconeogenesis, tricarboxylic-acid pathway , metabolism of energy reserves , complex cofactor/co-substrate/vitamin binding and protein modification  .

gene ontology enrichment
simply looking at the go enrichment diagrams gives one a good sense of how much pertinent biology was found with our method that was missed by pathway gsa. it is clear that we are finding core biological themes in n-linked protein glycosylation, which itself is interesting given that it was o-linked glycosylation that was inhibited. in addition, lipid, phospholipid and glycerophospholipid biosynthesis are affected which links nicely with the enrichment for gpi anchor biosynthesis. there are further indications that branched chain and aromatic acid metabolism is affected as well as the tca cycle and redox metabolism. furthermore, it is clear that there is an effect on a number of genes involved in the cell wall, er and plasma membranes, as one would expect to see with the inhibition of protein glycosylation, which would be likely to affect a number of integral membrane proteins .

differentially expressed genes
a list of the differentially expressed genes found by our method, including their systematic and gene names as well as their descriptions have been included as supplementary material .

gene sets and software availability
the gene sets  generated by threshold  <dig> are included as supplementary material . software used for the analysis is available upon request to the first author.

CONCLUSIONS
to our knowledge there is no report in the literature of the use of principal component analysis of the laplacian matrix of a metabolic graph for any purpose, including set generation for gene set analysis. as such, it appears that this is a novel method with which to find local topological structures in metabolic networks. we have shown that sets generated from the metabolic networks are semi-exhaustive in that there are many partial set overlaps, but the degree of overlap is relatively low. the fact that each gene is a member of many sets allowed us to devise a hypergeometric enrichment test to determine which genes were likely to be driving the set statistic and which were likely to simply be passengers, and could thus be pruned away from the results set. we have further shown that the structure represented by each signed half of each principal component  is adequate for set generation. further stratification of each principal component, whether by threshold or step-function methods did not significantly increase sensitivity. however, the thresholding method did prove to be useful as a ‘zoom-in, zoom-out’ function for biological interpretation of the results. when compared to traditional pathway sets this method appears to be much more sensitive as it is a better representation of the underlying complexity of a metabolic network. furthermore, the method applied here allows one to see the full context of the genes likely to be driving the set statistics rather than as simply lists of pathways each containing an unknown number of driver and passenger genes.

competing interests
the authors declare that they have no competing interests.

authors' contributions
dj conceived of the study, created the graph and laplacean matrix used in this paper, wrote the r code to perform the pca and the perl code for set generation, set analysis, and hypergeometric testing, wrote the r script to perform the gsa analysis, did the subsequent interpretation of both the pca and gsa results, created the figures and wrote the manuscript. ge performed the initial pca of a laplacian matrix in matlab and provided the pca scores that dj used to develop the initial prototype, participated in discussions about the potential applications of this approach and edited the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1: figure s1
percentage variance explained by each principal component.

click here for file

 additional file 2: figure s2
gene to gene distance distribution.

click here for file

 additional file 3: figure s3
rank order distribution of the number of sets that each gene is contained in.

click here for file

 additional file 4: figure s4
a) number of other gene sets that intersect with each gene set. b) number of occurrences of gene overlaps between sets as found by set intersections.

click here for file

 additional file 5: figure s5
set sizes generated at each positive and negative arm of each principal component at thresholds  <dig>   <dig> and  <dig> 

click here for file

 additional file 6
funcat enrichment of the false negatives from traditional gsa pathway sets.

click here for file

 additional file 7
go enrichment  of the false negatives from traditional gsa pathway sets.

click here for file

 additional file 8
go enrichment  of the false negatives from traditional gsa pathway sets.

click here for file

 additional file 9
go enrichment  of the false negatives from traditional gsa pathway sets.

click here for file

 additional file 10
gene id, name and description of metabolic genes found to be differentially expressed by gsa-pca.

click here for file

 additional file 11
the gene sets generated with pca score threshold  <dig> 

click here for file

 acknowledgements
we would like to thank the members of the computational biology group and the students and staff in general at the iwbt for support and discussion. we would particularly like to thank piet jones for useful discussions about the hypergeometric test. we would like to gratefully acknowledge the funding provided by winetech, thrip, and the south african national research foundation bioinformatics & functional genomics programme.
