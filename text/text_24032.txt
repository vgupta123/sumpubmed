BACKGROUND
liquid chromatography  coupled electrospray ionization -tandem mass spectrometry   <cit>  has been one of the essential proteomics enabling technologies  <cit> . while technological improvements are continually being made in chromatography  <cit> , mass spectrometry  <cit>  and mass spectra interpretation algorithms  <cit> , the detection of lower abundance proteins or proteolytic peptides in complex mixtures remains an obstacle in most proteomics experiments  <cit> . these dynamic range limitations arise in lc-ms/ms experiments, in part, as a result of the inability to completely resolve all peptide ions by liquid chromatography. the use of multidimensional liquid chromatography, where peptides are resolved using two or more separation principles, can improve the dynamic range of detection  <cit> . nevertheless, in complex proteomic samples, multiple peptides are still likely to co-elute.

in order to acquire tandem mass spectra for as many peptide ions as possible, the vast majority of tandem mass spectrometers are able to perform data-dependent acquisition . data-dependent acquisition of lc-ms/ms data has been the principal method for collecting peptide fragmentation data for both protein identification and quantification. during this process, a preliminary survey ms scan is acquired to identify the peptide ions that elute into the ion source at any point in time. this is followed by one or a series of ms/ms scans to isolate and dissociate each peptide ion in turn, typically in decreasing order of their ion signal abundance. exclusion lists can be used to prevent repeated sequencing of highly abundant ions that may limit the chance of sample peptide ions from being sequenced. lists containing m/z values of solvent cluster ions, buffer or other known protein contaminants such as keratin may be also used. nevertheless, dda may still overlook low abundance ions.

a second disadvantage of dda is its inability to accurately quantitate peptides in proteomics mixtures. quantitative information is derived from the selected ion chromatograms  generated for each of the peptides from the survey ms scans. as the number of peptides ions subjected to tandem mass spectrometry increases per survey ms scan, there will be fewer ms scans from which to quantitate ions during the course of an lc-ms/ms experiment. ultimately, this will affect the reliability of comparative protein quantification using isotopic labelling  <cit>  or label-free methods  <cit> .

to overcome limitations of dda-based experiments, the concept of concurrent peptide fragmentation data acquisition  has been shown to be both feasible  <cit>  and provides excellent reproducibility and peptide coverage  <cit> . during cda, each survey ms scan is followed by a ms/ms-like scan in which all peptide ions are concurrently dissociated either within the ion source  <cit>  or the dissociation cell  <cit> . cda has been variably termed shotgun cid  <cit> , parallel cid  <cit>  and mse  <cit> . the advantage of cda is that in theory all peptide ions will be fragmented regardless of their signal intensity. furthermore, since cda acquires survey ms data every alternate scan, quantitative information can be obtained more reliably in comparison to dda data.

despite the advantages of cda over dda, the method has not been widely adopted. the major reason for this is that, with the exception of a platform specific software package  <cit> , there are no publicly available algorithms designed specifically to process or interpret cda data acquired on any mass spectrometer. to enable automated analysis, an algorithm termed elution time ion sequencing  has been designed for processing any cda data. using lc elution profiles of precursor and product ions, etiseq automatically reconstructs ms/ms-like spectra for peptides which have been concurrently fragmented. in doing so it converts the cda data into a dda-like lc-ms/ms dataset . this manuscript describes the design and development of the algorithm. the performance of the algorithm is demonstrated using real cda data from protein samples with increasing numbers of proteolytic peptides. the output results are compared with dda data recorded for the same samples.

RESULTS
description and basis of the etiseq algorithm
the etiseq algorithm will be described stepwise as outlined in figure  <dig> from steps a to g.

input file format 
etiseq has been designed to process cda data. for the purpose for this algorithm, cda data is defined as an lc-ms experiment where, throughout the duration of the experiment, survey ms scans are alternated with ms/ms-like scans. these scans will be typically odd and even numbered respectively. to maximize the compatibility of the algorithm with mass spectrometers, etiseq accepts cda data in mzxml format.

generation of an ion exclusion list 
since all ions are fragmented during cda, it is useful to exclude precursor and product ions that are known to be contaminants  <cit> . etiseq has been designed to be able to search for ions that are present in more than 25% of scans. ions which appear in more than 25% of scans are considered unlikely to be of peptide ions since their detection would be independent of chromatographic separation. known common lc-ms/ms contaminants  <cit>  can also be manually added to an exclusion list. ions on the exclusion list will not be considered for all subsequent steps in the algorithm.

ion selection from survey and ms/ms-like scans 
ion selection from survey and ms/ms-like scans is an important component of the etiseq algorithm since it predetermines the number and quality of reconstructed ms/ms-like spectra. a selected number  of ions for which a ms/ms spectrum is reconstructed can be defined for each scan. selected precursor ions can then be excluded from further selection of a given number  of subsequent scans. the advantage of excluding previously sampled peptide ions is that it allows the reconstruction of ms/ms-like spectra for lower abundance ions while avoiding the generation of redundant ms/ms-like spectra. selection of ions from ms/ms-like scans is based on a noise threshold . for both survey and ms/ms-like scans, the etiseq algorithm automatically excludes all but the most abundant ion of an isotopic cluster of peaks.

computation of sic for selected peaks 
sics enable the elution time and profiles of precursor and product ions to be correlated. these are computed for all selected peaks from the survey and ms/ms-like scans. sics are computed over a selected time range . time defined sic will ensure that related precursor and product ions are correlated accurately since a precursor ion and its product ion will have identical elution times and profiles while other ions of similar or identical m/z may exist but will elute at different points in time. generating time defined sic also improves the speed of the algorithm as it limits the number of data points that need to be compared.

correlation of sics of ions from survey and ms/ms-like scans 
the lineage of product ions to the precursor ions are predicted based on the correlation of their sics. this is referred to as precursor-product ion association. there are two components which determine whether two sics are significantly correlated. first, each peptide is expected to have a distinct elution time. the elution profile  is also expected to be unique to each peptide. figure  <dig> shows a number of sics for different ions in the ms/ms-like spectrum.

to compare the elution time of ions, fast fourier transform  cross-correlation is used to rapidly determine whether two ions eluted at the same time based on their sics. the calculation of the cross-correlation function using fft is a well-known method for measuring correlation and time delay/lag between 1d and 2d signals in signal processing  <cit> . in proteomics, fft cross-correlation has been used in a variety of applications, including tandem mass spectra database searching, as in the sequest algorithm  <cit> , and for the alignment of chromatograms and mass spectra  <cit> . fft cross-correlation has the attractive property of being computationally efficient for finding the maximal correlation between two data sets where one signal may be shifted relative to another. fft cross-correlation is superior to comparing peak maxima since the elution profile is taken into consideration and therefore the comparison is more resilient to noise.

for the comparison of the actual shape of the elution profile, the pearson's correlation coefficient  <cit>  is used to indicate the strength of a linear relationship between two sics. pearson's correlation coefficient ranges from + <dig> to - <dig>  a correlation value of + <dig> indicates identical positive relationship between two sics,  <dig> indicates that two sics are unrelated and - <dig> indicates a negative relationship between two sics. based on the tested datasets, it was found that an absolute lag of  <dig> scan and a correlation coefficient of greater than  <dig>  was most effective for the correlation of precursor and product ions .

where multiple product ions are correlated to more than one precursor ions, the product ions are assigned to all correlating precursor ions. when a product ion does not match any precursor ion, it is assigned to all precursor ions. for the datasets used for testing etiseq, such product ions are typically of low abundance and therefore results in the generation of sics that contain significant machine noise .

reconstruction of ms and ms/ms-like spectra 
survey ms scans from cda data are identical to survey ms scans from dda data. for each selected precursor ion evident in a survey ms scan, a ms/ms spectrum is reconstructed by elution time correlation of precursor and product ions. product ions that do not significantly correlate with any precursor ion are included in all corresponding reconstructed ms/ms-like spectra. an example of a reconstructed ms/ms-like spectra generated from an in-source cid spectrum of two peptides is shown in figure  <dig> 

generation of output dda-like lc-ms/ms data 
steps c to f, described above, are repeated for each pair of survey ms and ms/ms-like scans. once all scans have been processed, etiseq uses all reconstructed spectra to generate dda-like lc-ms/ms data in mzxml file format.

implementation of the etiseq algorithm
the etiseq algorithm was implemented using c++ and is compatible with windows xp/vista, linux and mac os × operating systems. the standalone executable and a web interface for etiseq can be accessed at the following url address: . the time taken for etiseq to run will depend on the parameters, but in general the time required does not exceed  <dig> minutes. mzxml viewers and inter-conversion tools can be found at the nhlbi proteomics center at the institute for systems biology  <cit> .

testing
optimization of etiseq parameters
the key parameters which determine the reconstruction of ms/ms-like spectra are the maximum number of selected precursor ions from the survey ms scans  and the number of scans  in which the selected ions are excluded. to optimise the parameters, a range of values were used in combination, and the optimal values were determined based on the number of identified unique peptides for the bsa proteolytic sample. from figure  <dig>  it can be seen that between  <dig> and  <dig> unique peptides could be identified from the reconstructed ms/ms-like spectra. as n increases, the number of identified unique peptides generally plateaus above a maximum of  <dig> ions per selected scan. increasing x from  <dig> to  <dig> was found to increase the number of identified unique peptides. the optimal value in this case was to select a maximum of  <dig> ions per scan and exclude the selected ions for the next  <dig> scans . the choice of parameters is likely to vary depending on the chromatography conditions and the complexity of the sample analysed and can be easily adjusted by the user through the etiseq web-interface.

other parameters that that can be adjusted by the user include the addition of the option to exclude contaminants. furthermore, to increase the speed of the etiseq algorithm and to reduce the number of reconstructed ms/ms-like spectra of non-peptide origin, it was found that it is beneficial to predefine the range of scans over which ms/ms reconstruction is performed. this range can usually be estimated by visualization of the cda data to determine the elution times where the peptide ions are first and last detected.

all remaining parameters described in the previous section such as the sic time range and correlation coefficient cut-off were found to require less optimisation and are therefore not direct user adjustable through the web-interface. nevertheless, these can be adjusted in the standalone version of etiseq which can be requested from the authors.

etiseq performance validation
in order to demonstrate the utility of the described algorithm, the numbers of peptides identified for tryptic protein digests of hen egg lysozyme and bsa, as well as a tryptic digest of whole influenza virus were compared using dda data and cda data with etiseq processing. the parameters used for etiseq were  <dig> selected precursor ions per spectra  and these were excluded for  <dig> subsequent scans  as previously determined to be optimal. dda-like lc-ms/ms data were also generated from cda data without precursor-product ion correlation processing. this was necessary to demonstrate the benefit of ion correlation on automated ms/ms spectra interpretation.

^ for lysozyme and bsa, the respective sequence coverage is shown in brackets. the data are generated by data dependent lc-ms/ms and cda with and without etiseq processing.  for protein/peptide list.

^the sequence coverage of each protein is shown in square brackets. the data are acquired by dda and cda with etiseq processing. note that the virus was cultured in 10– <dig> day old embryonic hen eggs  and therefore chicken proteins are expected.

the distribution of the relative abundance of precursor ions that were correctly identified was also examined. for all three samples analysed it was found that, in comparison to dda, cda resulted in the identification of precursor ions with a broader range of relative intensities as well as lower median and minimum relative intensities .

discussion
the results demonstrate that cda generated data can be readily used for protein identification when processed using the described algorithm. while proteins can still be identified from cda data without correlation processing of precursor and product ion lineage, the results show that it is advantageous to do so . this is expected as the presence of unrelated product ions in ms/ms spectra will lead to erroneous identifications by ms/ms spectra interpretation algorithms  <cit> . the peptide identification results for etiseq generated dda-like lc-ms/ms data are broadly comparable to dda data . for the whole influenza virus digest, there were a number of identified peptides that were unique to cda data despite the fact that less unique peptides were identified for the reconstructed lc-ms/ms data in comparison to dda data . this is expected as, unlike dda, cda experiments will sample peptides independent of its abundance and generate peptide fragment data of all peptides. indeed, figure  <dig> shows that the distribution of cda data sampled was more tailed with a lower median compared to dda data, indicating that more low abundance ions were sequenced in cda experiments.

for the virus digest . it should be noted that peptides unique to cda were in all cases a subsequence of the tryptic peptides detected in dda. this may be due to the generation of in-source fragments during precursor ions scans resulting from incomplete evacuation of the cooling gas following a product ion scan. the acquisition of cda data by true ms/ms should alleviate this problem. nevertheless, the ability of etiseq to generate ms/ms spectra for such ions demonstrates the utility of the software.

in part, the difference in the identified peptides may be explained by the differing product ions that are generated during cda and single peptide ms/ms data. in the experiments described, concurrent peptide fragmentation was achieved in the ion source where ions are accelerated across the source under atmospheric pressure. for dda data, the dissociation of peptide ions occurs within a collision cell or chamber. while both methods generally yield b- and y- type product ions  <cit> , in-source cid produces product ions under a different environment in the presence of residual solvent and other atmospheric gases. cda can be performed on single mass analyser instruments . furthermore, the detection efficiency for fragment and precursor ions can be enhanced since both have shorter paths to the detector. it is important to realise that in the case of cda experiments, the possibility of performing true tandem experiment is not excluded. this may be achieved by adjustment of ion focusing to allow for the transmission of all precursor ions  into a collision cell  <cit> . in this instance, and in in-source cid experiments, different multiply charged ions of a common peptide are collectively fragmented thereby increasing the overall product ion intensities and improving the signal-to-noise ratio.

it is anticipated that cda along with etiseq processing, will be most advantageous for quantitative experiments that make use of affinity enrichment and isotope labelling such as isotope-coded affinity tags  <cit> . in comparison to dda it can be expected that cda will produce more sic data points for peptide ions since survey ms scans are always performed every alternate scan. in contrast to cda, it is common in dda that survey ms scans are only acquired every 3– <dig> scans. the same quantitative advantage can be expected for label-free ms-based experiments that make use of sics  <cit> .

CONCLUSIONS
the etiseq algorithm enables automated processing of cda data for protein identification. the algorithm has the ability to discover precursor-product ion lineages in order to reconstruct ms/ms-like spectra. it enables the conversion of cda data to dda-like lc-ms/ms data. the etiseq algorithm has been designed to input and output the data in mzxml file format to ensure maximum compatibility with data from different ms instruments and downstream ms/ms analysis platforms.

a comparison of database search results from dda and etiseq processed cda data for tryptic digest of two standard proteins and whole virus demonstrate that results from both strategies are comparable in their performance. importantly, the use of the etiseq algorithm on cda data significantly increased the number of unique peptides identified. it was also found that cda samples a wide abundance of peptide ions in comparison to dda. with further optimization of the cda peptide fragmentation process, it can be anticipated that etiseq will be of great value to enable cda where quantification is required.

