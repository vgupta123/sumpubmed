BACKGROUND
neuronal synapses are specialized contacts through which neurons communicate with each other or with other cells and are thus fundamental for our understanding of nervous system function. the assembly, function, plasticity and maintenance of synapses require the coordinated expression of a yet undetermined set of genes, which for simplicity we call here “synaptic genes”. hundreds of synaptic genes have been identified, but there is a broad consensus that these are only a fraction of the total number  and diverse approaches should be tested to advance in this direction. the basic framework of synapse organization was completed early in metazoan evolution . a high degree of conservation among synaptic genes have been found, suggesting relatively little diversification among proteins important for synaptic transmission and demonstrating that knowledge obtained from studies in model organisms is also relevant for other species, including humans  <cit> .

the traditional method to assign a function to a gene involves extensive genetic and biochemical analyses. the generation of catalogues composed of genes with a high probability of having the function of interest narrows this search, thus saving time and resources. new methods for the prediction of gene function have become available with the completion of genome projects and the boom of microarray experiments and predicting gene function is one of the main goals in systems biology and functional genomics . as overwhelming volumes of information begun to be stored in large-scale datasets, automatic learning methods emerged as a good strategy to predict gene function. the analysis of microarray expression data through automatic learning methods showed that genes with similar function frequently display similar expression patterns. this suggests a functional relationship among genes whose expression fluctuates in parallel . this correlation between biological function and expression pattern suggests that machine learning algorithms could be successfully applied to predict function from expression data .

automatic learning methods can be divided into unsupervised and supervised learning. a supervised method “learns” the distinctive features of a given biological function from a training set of genes, in which some of them are known to have the function of interest and others are supposed not to have it. the learned definition is called a “classifier”, and is then used to decide whether or not a gene still not associated with that biological function may have it. importantly, the predictive quality of the classifier can be objectively estimated in several ways  <cit> .

there is no universally best learning algorithm since even those with the best average performance in a variety of studies perform poorly on other problems or metrics  <cit> . ensemble techniques, in which a set of different predictive models is constructed and then their predictions are combined in different ways, have been shown to improve the classification performance  <cit> . here we reached very good results applying a very simple ensemble technique by intersecting the classifications of three methods, k- nearest neighbors  <cit> , random forest  <cit>  and support vector machine  <cit> , that are widely used and are among those with the best average performance when applied to biological data  <cit> . the predictive quality of a classification task also depends strongly on the training set. we carefully selected the positive samples among those drosophila genes for which a synaptic function was already well demonstrated by independent methods, and the negative samples using clear biological criteria .

the fly drosophila melanogaster is one of the model organisms that have contributed the most to our understanding of synapses, for which many synapse genes are already identified through experimental studies  <cit>  and has one of the best annotated genomes  <cit> . it has an additional advantage for the aim of this study: along its life cycle there are two periods of massive synapse formation  <cit> . regarding the quality of the input data, next-generation sequencing technologies  have overcome some important limitations of microarray technologies, as for example their relatively high rates of false positives and their low accuracy in measurements of transcripts present in low abundance  <cit> . as input data we used the developmental transcriptome of drosophila published by the modencode project  <cit> . this data set, was generated with ngst and has been successfully used for several investigations . it appears to be the best available for our objective because it comprises samples corresponding to a period in which there are no synapses, samples corresponding to the two phases of massive and intense synapse formation and samples corresponding to a phase of massive synapse disassembly  <cit> .

a final issue to consider in this type of studies is the estimated number of genes predicted to have the biological function under scrutiny. a synaptic function has been assigned to many drosophila genes by means of genetic screens  and other experimental approaches . the proteomic analysis of cellular fractions enriched in synapses has also resulted in catalogues of proteins with a strong probability of being necessary for the synapse. technical difficulties have so far hampered this option in the fly, but the development of a method adapted to drosophila synaptosomes  <cit>  indicates that this approach will soon lead to the discovery of new synaptic genes. catalogues of synaptic genes including annotations based on proteomic studies of synaptic components, sequence homology across animal species, protein domains and other bioinformatic approaches such as gene ontology  <cit> , syndb  <cit>  and synaptomedb  <cit>  range from a few hundreds to a few thousands genes. by may  <dig>  synaptomedb  <cit>  listed a total of  <dig> genes for human synapses and syndb  <cit>  listed  <dig> genes for drosophila synapses and  <dig> genes for human synapses. at the beginning of this study,  <dig> genes were associated with some degree of experimental support to at least one synapse-related gene ontology biological process  in drosophila. thus, according to a conservative view of the available data, the expected number of synaptic genes in drosophila could be set around  <dig> for the purpose of the approach tested here.

the aim of this study was to test whether catalogues enriched in genes with a certain biological function can be generated solely from transcription data with a group of supervised learning algorithms. our objective was to obtain a catalogue of drosophila genes with high probability of having a synaptic function. the approach was fruitful and we present a catalogue that according to several biological criteria appears to be greatly enriched in new synaptic genes.

RESULTS
pre-processing of the original dataset
we used the developmental transcriptome of drosophila melanogaster published by the modencode project  <cit> , but we considered only the  <dig>  genes that showed transcript levels above zero at least in one of the  <dig> samples corresponding to the embryo, the larva and the pupa . the absolute and the normalized transcription profiles of these  <dig>  genes are shown in fig. 1a and b respectively. we then used  <dig> of these genes to train our algorithms and classify the remaining  <dig>  genes into either “synaptic genes” or “non synaptic genes”.fig.  <dig> transcription profiles of the drosophila genes to be classified and of the training set. a–b temporal expression profiles of the  <dig>  drosophila genes that show transcription level above zero in at least one sample during embryonic, larval or pupal stages. graphs were constructed with absolute values  and with the same values after normalization between  <dig> and  <dig> . c transcription profiles of the  <dig> “synaptic genes” of the training set after normalization of the original values between  <dig> and  <dig>  a clear correspondence is observed between what is expected for the mean transcription profile of drosophila synaptic genes and the actual expression profiles of the genes of our training set. along the life cycle of drosophila a first wave of massive synaptogenesis takes place during the second half of embryonic life , and a second wave occurs in the pupa , when the synapses of the adult brain are being formed. between these two waves of synaptogenesis a period of massive synapse disassembly takes place. the yellow line corresponds to the mean expression levels of the  <dig> synaptic genes and matches these three features. d transcription profiles of the  <dig> “non-synaptic genes” of the training set, after normalization of the original values between  <dig> and  <dig>  the green line corresponds to the mean expression levels of the  <dig> non-synaptic genes. 



construction of the training set
to train our classifiers we defined the labels “synaptic genes” and “non-synaptic genes”. the  <dig> genes that we labeled as “synaptic genes”  and the corresponding bibliographic references are presented in additional file  <dig>  the corresponding normalized transcription profiles are shown in fig. 1c. the  <dig> genes that fulfill at least one of the two biological criteria defined to label a gene as “non-synaptic”  are shown in additional file  <dig> and fig. 1d shows their normalized transcription profiles.

model adjustment
the mean error and dispersion for the three adjusted models after 10-fold cross validation over the training set are shown in fig.  <dig>  the three classifiers reached error rates below 5 %. for the details on the adjustment of each model see methods. the area under the roc curve of each classifier reached values above  <dig>  in the three cases .fig.  <dig> misclassification error rates of the three adjusted models after 10-fold cross validation. box plots of misclassification error rates of the three adjusted models: random forest , support vector machine  and k-nearest neighbors , estimated by 10-fold cross validation as described in the text. in each box plot the black horizontal line represents the median value and the points outside the box correspond to values over or lower to  <dig>  times interquartile range than the third or first quartile respectively



initial classification of the three models
after adjusting the three models we classified our dataset and obtained three initial catalogues of putative synaptic genes . the three classifications display a high degree of coincidence, with k-nn, the model that produces the more divergent catalogue of genes, showing more than 83 % of coincidence with the other two models. the genes classified as synaptic by the three models represent a consensus catalogue of  <dig> genes. this initial consensus catalogue is much bigger than what is expected for a catalogue of synaptic genes, as discussed in the background section.fig.  <dig> number of genes classified as synaptic by each method as the classification threshold increases. each column corresponds to the threshold that a gene’s estimated probability of being synaptic must exceed to be labeled as synaptic. each row corresponds to one of the adjusted models or to one of their combinations. the last row shows the number of genes classified as synaptic by the three models. in the bottom panel the color areas of the venn diagrams are proportional to the number of genes that they represent. the  <dig>  genes to be classified are represented by the black circles and the number of genes classified as synaptic by each model, or combinations thereof, are represented in agreement with the color code shown to the left



sequential increase of the classification threshold
to reduce the size of the initial consensus catalogue, as well as to improve its statistical strength, we sequentially increased the classification threshold, excluding those genes whose classifications have higher probabilities of being false positives . this procedure generates a series of catalogues of gradually decreasing size for which a biological characterization done a posteriori can provide additional support. the number of genes classified as synaptic by each model as the threshold increases, as well as the degree of coincidence between the classifications are shown in columns  <dig> to  <dig> of fig.  <dig>  the increment of the classification threshold was associated with an increment of the global error rate .

functional enrichment analysis
we evaluated the functional enrichment of our catalogues in synapse-related go bp terms. all our catalogues were enriched in several of these terms, and the degree of enrichment increased with the increase of the classification threshold. this direct relationship between threshold and enrichment is illustrated in fig.  <dig>  which shows the enrichment in a representative selection of synapse-related go bp terms found in the series of catalogues produced by each of the three learning algorithms as well as in the corresponding consensus catalogues.fig.  <dig> enrichment in selected synapse-related bp go terms as the classification threshold increases. a–d show the enrichment of the catalogues generated by each classifier, in a representative selection of go terms of relevance for the biological function “synapse”. for all classifiers, elevation of the threshold resulted in increased enrichment. this increase in functional enrichment is accentuated in the consensus catalogues, showing how the combined methods improved the three individual classifiers. a k-nn catalogues, b random forest catalogues, c svm catalogues, d catalogues of genes classified as synaptic by the three classifiers. all enrichment values have an associated p-value lower than 10− <dig> and a fdr q-value lower than 10−3




genes with tissue-specific differential expression 
among the  <dig>  genes committed to the classifiers, there are  <dig> that have tissue-specific differential expression . the percentage of gtsdes we found in each tissue is roughly 24 % for the central nervous system , 4 % for the salivary glands, 12 % for the fat body, 37 % for the digestive system and 23 % for the carcass. since the overwhelming majority of synapses are formed by neurons inside the cns, a catalogue of synaptic genes is expected to have an over-representation of gtsdes in this tissue. on the other hand, we expect the gtsdes in the salivary glands or fat body  to be under-represented in our catalogues. the results of this test are shown in fig.  <dig>  in all the catalogues there is a great over-representation of gtsdes in the cns. this enrichment increases with higher threshold. at the same time, the enrichment in gtsdes in those tissues without synapses  or in tissues with much fewer synapses  decreases.fig.  <dig> relation between percentages of genes with tissue-specific differential expression by tissue and classification thresholds. a–d show the relationship between tissue-specific differential expression, classification methods, and classification thresholds. regardless of the classification method, all catalogues are enriched in genes expressed in the cns at much higher levels than in tissues with fewer or none synapses. notice that increasing the threshold did not result in an increment of the proportion of genes differentially expressed in tissues other than the cns. a k-nn catalogues, b random forest catalogues, c svm catalogues, d consensus catalogues. the threshold values are shown in the horizontal axis, with  <dig> corresponding to the initial set of genes to be classified. each colored line corresponds to one of the five analyzed tissues according to the color code shown at the bottom



final catalogue of  <dig> putative drosophila synaptic genes
our consensus catalogue corresponding to a classification threshold of  <dig>  comprises  <dig> drosophila genes that, according to the three adjusted algorithms, have a probability above 90 % of being involved in synapse assembly and function. among all the catalogues obtained in this study, this is the one showing the highest enrichment in synapse-related go bp terms, as well as the highest proportion of gtsde in the cns. the functional enrichment of this catalogue is explained by the presence of  <dig> genes that were already annotated as relevant for synapse assembly or function in the go database by july  <dig>  excluding these genes, we obtain our final catalogue of  <dig> putative synaptic genes. this catalogue is provided as additional file  <dig>  additional file  <dig> contains the predicted probability of being synaptic for all the genes in the data set and additional file  <dig> shows the transcription profiles of the genes classified as synaptic at each threshold.

genes of our final catalogue have human homologues already described as synaptic genes
we found that  <dig> genes of the  <dig> in our final catalogue have at least one homologue in homo sapiens  <cit> . of these  <dig> drosophila genes, 11 %  have a human homologue with a synapse related annotation  <cit> . this is relevant because these human synaptic genes are homologues of drosophila genes belonging to a catalogue from which any gene already annotated as synaptic was selectively excluded. the flybase ids and the symbols of these  <dig> genes, as well as their human homologues with their corresponding synapse-related go annotations are shown in table  <dig> table  <dig> putative synaptic genes with no synapse-related annotation in drosophila and homologues annotated as synaptic in homo sapiens


the table shows the list of drosophila genes belonging to our final catalogue of putative synaptic genes that don’t have any synapse related go term annotation but have at least  <dig> homologue in homo sapiens already annotated with some synapse related go term. the first  <dig> columns show the annotation symbol as well as the symbol of these  <dig> drosophila genes. the third column shows the mean between the classification probabilities given by the three learning algorithms to each gene. the following columns show the symbol and gene identifier of the corresponding human homologue  that is already annotated with at least  <dig> synapse related go term in humans, an annotation that is shown in the last column of the table



as a way to estimate the statistical relevance of this result, one should construct a list of  <dig> drosophila genes randomly selected from the initial set of genes to be classified, and then determine , how many genes have at least one human homologue with any synapse related annotation. after repeating this procedure three different times, we obtained a much lower number of genes . this result reinforces the conclusion that our final catalogue is enriched in genes of importance to the synapse in both species.

comparison with a list of rat synaptic proteins
in a recently published paper  <cit> , wilhelm and collaborators selected a set of rat proteins for which localization in the synapse had been well established. as their aim was to obtain a three-dimensional reconstruction of the synapse, the list includes not only the kind of proteins that we have defined as “synaptic” in our study, but also more ubiquitous proteins. as an additional way to evaluate our results, we “translated”  <cit>  wilhelm’s list of rat proteins into a list of drosophila “synaptic genes”. after excluding those genes not fulfilling our definition of synaptic genes  or without homologues in drosophila, we obtained a list of  <dig> drosophila genes, whose rat homologues have a well established synaptic function.

we found that  <dig> of these  <dig> genes had been included in our training set and  <dig> of the remaining genes were already annotated with at least one synapse related go term in drosophila . there are then  <dig> genes in wilhelm’s list that are neither in our training set nor already annotated as synaptic genes in drosophila. if there is good conservation between mammals and drosophila synaptic proteins one could expect our classifiers to label as synaptic genes at least some of these  <dig> genes. this turned to be the case, as  <dig> of these  <dig> genes belong to our initial consensus catalogue and  <dig> belong to our final catalogue of putative synaptic genes. we believe these results  reinforce the reliability of our approach.table  <dig> genes in wilhelm et al.  <cit>  list that are neither in our training set nor annotated as synaptic in drosophila


the first column shows the names of the rat proteins whose drosophila homologues are neither in our training set nor already annotated as synaptic genes in the fly. the second column shows the name of the corresponding drosophila homologue. the third column indicates whether these drosophila genes were classified as synaptic with a probability higher than  <dig>  by the  <dig> algorithms. the fourth column indicates if the genes were also classified as synaptic by the  <dig> algorithms with a probability above  <dig> 



discussion
one of the main goals of functional genomics is to make predictions on the biological function of genes from the information stored in large-scale datasets, maximizing the utility of available information and making predictions of function with verifiable performance  <cit> . here we show that it is possible to obtain gene catalogues enriched in genes of importance for the neuronal synapse, analizing a genome-wide full-body developmental transcriptome with a combination of supervised learning algorithms and a bioinformatic approach tested here for the first time.

some 25 years ago, a functional relationship between genes displaying similar expression patterns was suggested by the first studies analyzing expression data with automatic learning methods. clustering of yeast genes on the basis of their similarities in expression patterns resulted in groups of genes sharing important functional similarities  <cit> . a correlation between expression profile and biological function was also demonstrated in drosophila  and humans, although in this last case somewhat obscured by a less complete functional annotation of the genome  <cit> . on the other side, a clear mapping of functional gene groups to expression profiles was demonstrated in rats  <cit> . since then, the use of automatic learning methods to assign putative functions to genes, based not only on their expression profiles but also on protein—protein interactions and on structural similarities, has led to a broad diversity of strategies and to a profuse bibliography .

the most direct antecedent to our study is, we believe, that of yan and collaborators  <cit> . in that work, function-specific classifiers based on random forest were trained to predict go terms for drosophila melanogaster genes using features from protein-protein interaction networks, gene expression profiles, genetic interactions, conserved protein domains and cross-species sequences similarities. regarding synapse assembly and function, go terms including the words “synapse”, “synaptic” or “neurotransmitter” were predicted for only  <dig> genes  <cit> .

our study differs from this and other previous studies in several important issues. as far as we know it is the first to apply automatic learning algorithms to predict gene function using developmental transcriptome data obtained through ngst. the developmental transcriptome used here has several advantages over other available drosophila rnaseq data sets. since the formation of the brain in the fly embryo is such a rapid process and the transcription profiles show good temporal correlations with the sequence of biological processes  <cit> , this sample set offers a clear advantage for the definition of putative synaptic genes. the key feature that made this data set the best available for our study is that it spans over several stages of the life cycle relevant for the classification. these include a stage in which there are no synapses in the organism, two stages when massive, intense synapse formation occurs, and a stage of massive synapse disassembly, all of which improves the potential of the algorithms to distinguish between synaptic and non-synaptic genes. this ability to discern synaptic genes produced a catalogue not only of the sought size, but whose functional enrichment in synapse related go terms is higher and more diverse than the enrichment found in a list of genes with cns-specific differential expression .

another novelty of our study is that the training set was constructed to be substantially different from the set of genes that are already annotated in the go database with some synapse-related go term. this strategy avoids any circularity problem in evaluating the resulting catalogues by analyzing their functional enrichment in synapse-related go terms. since the drosophila genome is one of the best annotated  <cit> , this represents a great advantage over studies in which the performance of the classifiers is evaluated only by cross-validation over the training set or by literature examination of the top scoring predictions. it is important to notice here that our training set of synaptic genes only includes genes for which their importance for the formation and function of synaptic active sites had been demonstrated with independent methods. we did not include genes with more general annotations  to render our analysis more neutral to potential differences related to variation among organisms in the morphology of their dendrites and axon terminals.

another important feature of our study is that we followed a procedure that improves the classification performance  <cit> , training different learning algorithms and taking a vote over their predictions. the advantage of this approach is illustrated by the fact that for a given threshold, the functional enrichment in synapse-related go terms of the consensus catalogue is bigger than that of the catalogues corresponding to each algorithm. this procedure has the additional advantage of reducing the probability of including false positives in our final catalogue. since our aim was not the generation of an exhaustive catalogue of synaptic genes, but a catalogue of genes with high probability of being synaptic, a decrease in the number of false positives is preferable, although this leads to an increase in the number of false negatives. it is worth noting the very low error rates reached by the three algorithms in their initial classifications and the excellent quality of their performance, estimated through calculation of the area under the roc curve.

finally, we wish to emphasize the fact that 11 % of the drosophila genes in our final catalogue of  <dig> genes are already known to be of importance for the synapse in humans, although still not in the fly. on the other hand,  <dig> out of  <dig> genes already known as being important for synaptic function in rats  <cit>  but not yet in drosophila, were classified as synaptic by our method. we think that these coincidences are explained by the high degree of functional conservation among homologous genes between these species, which makes undoubtedly a very strong argument in favour of the convenience of our approach and of the quality of our final catalogue.

CONCLUSIONS
the strong correlation between classification threshold, functional enrichment and proportion of gtsde in the cns, together with the observation that 11 % of the drosophila genes in our final catalogue have human homologues already annotated as synaptic genes in h. sapiens, strongly suggest that our final catalogue is highly enriched in genes of relevance for drosophila synapse assembly and function but still not recognized as such.

the utility of our approach is that it reduces the number of genes to be tested through hypothesis-driven experimentation. thus, we make available the list of  <dig> putative synaptic genes to the scientific community, firmly believing that this will facilitate their investigation, by means of gene silencing, mutant analysis, behavioral assays and other traditional protocols. this will most likely lead to the identification of new genes of great relevance for the normal function of the nervous system.

