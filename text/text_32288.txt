BACKGROUND
the need of an intrinsic understanding of the interplay between complexity and robustness of biological processes and their corresponding design principles is well-documented, see for instance  <cit> . the concept of robustness can be described as “a property that allows a system to maintain its functions against internal and external perturbations”  <cit> . when referring to mathematical models of complex biological processes, one of the mathematical tools to describe the robustness of a system to perturbations is sensitivity analysis which attempts to determine which parameter directions  are the most/least sensitive to perturbations and uncertainty, or to errors resulting from experimental parameter estimation. recently there has been significant progress in developing sensitivity analysis tools for low-dimensional stochastic processes, modeling well-mixed chemical reactions and biological networks. some of the mathematical tools included log-likelihood methods and girsanov transformations  <cit> , polynomial chaos  <cit> , finite difference methods and their variants  <cit>  and pathwise sensitivity methods  <cit> . however, existing sensitivity analysis approaches can have an overwhelming computational cost, either due to high variance in the gradient estimators, or in models with a high-dimensional parameter space,  <cit> .

the aforementioned methods focus on the sensitivity of stochastic trajectories and corresponding averages. however, it is often the case that we are interested in the sensitivity of probability density functions , which are typically non-gaussian in nonlinear and/or discrete systems. in that latter direction, there is a broad recent literature relying on information theory tools, and where sensitivity is estimated by using the relative entropy and the fisher information matrix between pdfs, providing a quantification of information loss along different parameter perturbations. we refer to  <cit>  for the case when the parametric pdf is explicitly known. for instance, in  <cit>  the parametric pdf’s structure is known as it is obtained through an entropy maximization subject to constraints. knowing the form of the pdf allows to carry out calculations such as estimating the relative entropy and identifying the most sensitive parameter combinations. furthermore, the pathwise pdfs are also known in reaction networks when a linear noise approximation  is employed and for this case the relative entropy can be explicitly computed allowing thus to carry out parametric sensitivity analysis,  <cit> . however, for complex stochastic dynamics of large reaction networks, spatial kinetic monte carlo algorithms and molecular dynamics, such explicit formulas for the pdfs are not available in general.

in  <cit> , we address such challenges by introducing a new methodology for complex stochastic dynamics based on the relative entropy rate  which provides a measure of the sensitivity of the entire time-series distribution. typically, the space of all such time-series is referred in probability theory as the “path space”. rer measures the loss of information per unit time in path space after an arbitrary perturbation of parameter combinations. rer and the corresponding fisher information matrix  become computationally feasible as they admit explicit formulas which depend only on the propensity functions  and , respectively). in fact, we showed in  <cit>  that the proposed pathwise approach to sensitivity analysis has the following features: first, it is rigorously valid for the sensitivity of long-time, stationary dynamics in path space, including for example bistable, periodic and pulse-like dynamics. second, it is a gradient-free sensitivity analysis method suitable for high-dimensional parameter spaces as the ones typically arising in complex biochemical networks. third, the rer method does not require the explicit knowledge of the equilibrium pdfs, relying only on information for local dynamics and thus making it suitable for non-equilibrium steady state systems. in  <cit> , we demonstrated these features by focusing on two classes of problems: langevin particle systems with either reversible  or non-reversible  forcing, highlighting the ability of the method to carry out sensitivity analysis in non-equilibrium systems; and spatially extended kinetic monte carlo models, showing that the method can handle high-dimensional problems.

in this paper, we extend and apply the pathwise sensitivity analysis method in  <cit>  to biochemical reaction networks, and demonstrate the intrinsic sensitivity structure of the network. such systems are typically modeled as jump markov processes and they are simulated using either exact algorithms such as the stochastic simulation algorithm ,  <cit>  and the next-reaction method  <cit> , or by employing approximations such as mean field odes, tau-leap  <cit>  and stochastic langevin methods  <cit> .

we show that the proposed pathwise method allows us to discover the intrinsic sensitivities of the reaction network by decomposing the fim into diagonal blocks. the block-diagonal structure of the proposed fim reveals, in a straightforward way, the sensitivity interdependencies between the system parameters. for instance, if each propensity function depends only on one parameter –usually the reaction constant– then the fim is a diagonal matrix ). the sparse representation of the fim can be essential in optimal experimental design as well as in parameter identifiability and robustness where each subset of the parameters defined by a block of the fim can be treated separately. moreover, our earlier rigorous analysis  <cit>  for the stationary regime suggests suitable extensions in the transient case which are here tested and validated. finally, we present strategies for efficiently and reliably implementing the proposed method for high-dimensional, complex stochastic systems using an array of existing accelerated versions of the ssa algorithm such as mean field, stochastic langevin, τ-leap approximations and their variants,  <cit> .

we test the proposed set of methods and computational strategies in three examples of biochemical networks. first, we consider a prototypical protein production/degradation model, i.e, a single-species birth/death model, with explicitly known formulas for the stationary and the time-dependent distribution. this model serves as a benchmark where the differences between the proposed pathwise fim and the stationary fim are highlighted. second, we study the parameter sensitivities of a p <dig> gene model for cell cycle regulation and response to dna damage, that incorporates the feedback between the tumor suppressor p <dig> gene and the oncogene mdm <dig>  <cit> . this is a reaction network that exhibits random oscillations in its steady state, and for which continuum approximations of the ssa such as lna break down due to persistent oscillations between high and low populations. using the proposed method, we also study a far more complex network, the epidermal growth factor receptor  model, describing signaling processes between mammalian cells  <cit> . this is a high-dimensional system both in the number of variables and parameters, including  <dig> species and  <dig> reactions. having a gradient-free method for this example with parameter space of dimension  <dig> provides a significant advantage over gradient methods such as finite differencing, where the computation of a very high number of partial derivatives and/or directional derivatives is needed and with possibly significant variance that scales with the dimension,  <cit> . by contrast, the eigenvalue/eigenvector analysis of the proposed fim identifies the order from least to most sensitive directions  by the corresponding eigenvalues.

in methods, we present the derivation of the relative entropy rate and its corresponding fisher information matrix for continuous-time jump markov processes as well as we reveal the block-diagonal structure of the fim for commonly encountered reaction networks, continued by the presentation of both unbiased and biased –but accelerated– statistical estimators for rer and fim. then, in the results, we apply and validate the proposed pathwise sensitivity analysis methodology in three complex biological reaction networks.

methods
we consider a well-mixed reaction network with n species, s = {s <dig>  …, sn}, and m reactions, r = {r <dig>  …, rm}. the state of the system at any time t ≥  <dig> is denoted by an n-dimensional vector x = t where xi is the number of molecules of species si at time t. let the n-dimensional vector νj correspond to the stoichiometry vector of j-th reaction such that νi,j is the stoichiometric coefficient of species si in reaction rj. given that the reaction network at time t is in state x = x, the propensity function, aj, is defined so that the infinitesimal quantity ajdt gives the transition probability of the j-th reaction to occur in the time interval . propensities are typically dependent on the state of the system and the reaction conditions  of the network such as temperature, pressure, etc. mathematically, {x}t∈r+ is a continuous-time, time-homogeneous, jump markov process with countable state space e⊂nn. the transition rates of the markov process are the propensity functions aj, j =  <dig>  …, m. the transition rates determine the clock of the updates  from a current state x to a new  state x′ through the total rate a0:=∑j=1maj while the transition probabilities of the process are determined by the ratio aja <dig>  we refer to algorithm  <dig> for the details of the stochastic simulation.


relative entropy
assume that two probability distributions   and p~ have corresponding probability densities p = p and p~=p~. then, the relative entropy or kullback-leibler divergence of  with respect to p~ is defined as  <cit> 

  rp|p~:=∫plogpp~dx. 

in a more general setting, relative entropy is defined as rp|p~:=∫logdpdp~dp where dpdp~ is a function known as radon-nikodym derivative while the integration is performed with respect to the probability measure ,  <cit> . a necessary condition for the relative entropy to be well-defined is that the radon-nikodym derivative exists which is satisfied when  is absolutely continuous with respect to p~. relative entropy has been utilized in a diverse range of scientific fields from statistical mechanics  <cit>  to coding in telecommunications   <cit>  and finance  <cit> , and it possesses the following three fundamental properties: 

 it is always non-negative,

 it equals to zero if and only if p=p~p-almost everywhere, and,

 

 rp|p~<∞ 

if and only if  and p~ are absolutely continuous with respect to each other.

from an information theory perspective, relative entropy quantifies the loss of information when p~ is utilized instead of ,  <cit> . in other words, relative entropy quantifies the inefficiency of assuming an incorrect or perturbed distribution p~ instead of employing the true distribution . therefore, even though not a metric, relative entropy has been used as a suitable quantity for the assessment of parametric sensitivities since the higher the relative entropy  in some perturbed direction, the larger the sensitivity should be in this direction.

pathwise relative entropy and relative entropy rate
proceeding to the pathwise formulation of the relative entropy, we assume that the propensities depend on a parameter vector θ∈rk ≡ajθ) while the continuous-time jump markov process xt∈r+ lies in the stationary regime. we denote by μθ the steady state  distribution of the stochastic process x. the stationary path distribution of the process in the interval  is denoted by qθ. notice that path distributions  are high-dimensional complex objects; for instance, if we consider the simpler discrete-time markov chain, {zn}n∈z+, defined by the transition probability density p, then, utilizing repeatedly the markov property, the stationary path distribution of the time-series  is given by

 q=prob=μp…p. 

proceeding, we consider another continuous-time jump markov process {x~}t∈r+ defined by perturbing the propensity functions by a small vector ε∈rk. the corresponding steady state and path distributions of {x~}t∈r+ are denoted by μθ+ε and qθ+ε, respectively. let the two path distributions qθ and qθ+ε be absolutely continuous with respect to each other which is satisfied when ajθ= <dig> if and only if ajθ+ε= <dig> holds for all x ∈ e and j =  <dig>  …, m. then, the relative entropy of the path distribution qθ with respect to qθ+ε is defined similarly to  as

  rqθ|qθ+ε:=∫logdqθdqθ+εdqθ, 

where dqθdqθ+ε is the radon-nikodym derivative of qθ with respect to qθ+ε. in fact, using the girsanov’s formula, we can obtain an explicit expression for the radon-nikodym derivative in terms of the propensities,  <cit> . in the context of sensitivity analysis, the pathwise relative entropy rqθ|qθ+ε is a measure of information loss due to an ε-perturbation of the model parameters, and consequently it is a natural measure of parametric sensitivity.

moreover, in the stationary regime, relative entropy increases linearly in time, hence the relative entropy rate  which is the time average of the relative entropy,

  hqθ|qθ+ε:=limt→∞1trqθ|qθ+ε, 

is a well-defined quantity,  <cit> . as first proposed in  <cit> , hqθ|qθ+ε is a suitable time-independent measure of sensitivity: it measures the rate of the loss of information due to an ε-perturbation of the model parameters, in the long-time, stationary dynamics regime of the stochastic process. furthermore, rer admits an explicit formula given by 

  hqθ|qθ+ε=eμθ∑j=1majθlogajθajθ+ε−−a0θ+ε). 

thus, from a practical point of view, rer is an observable of the stochastic process which can be computed numerically as an ergodic average, requiring only the knowledge of the propensity functions and the stoichiometric matrix i,j. nevertheless, in order to carry out the sensitivity analysis in the parameter vector θ, the computation of rer for different ε’s is necessary which can be computationally challenging for high-dimensional parameter spaces. thus, a sensitivity analysis methodology which does not depend on ε’s –such methods are called “gradient-free”– is desirable and is developed next.

pathwise fisher information matrix
even though not directly evident from , a taylor series expansion of rer in terms of ε reveals that rer is locally a quadratic function of the parameter vector ε∈rk. indeed, rer is non-negative when ε ≠  <dig> and equals to zero when ε =  <dig> thus the linear term in the taylor expansion is zero. therefore, rer is written –under smoothness assumptions on the propensity functions with respect to the parameter vector θ– as  <cit> ,

  hqθ|qθ+ε=12εtfhε+o, 

where fh is a k × k matrix that can be considered as a pathwise analogue for the steady state fisher information matrix . similarly to the steady state fim for parametrized distributions  <cit> , fh is the hessian of the rer which geometrically corresponds to the curvature around the minimum value of the relative entropy rate. the pathwise fim contains up to third order accuracy all the sensitivity information for the path distribution at point θ for any perturbation direction ε, therefore, the computation of the fim is sufficient up to third order for the evaluation of all the local sensitivities of the path distribution around the parameter vector θ. moreover, an explicit formula for the pathwise fim is given by 

  fh:=eμθ∑j=1majθ∇θlogajθ∇θlogajθt. 

the implications of this explicit formula are twofold. first, it reveals that for many typical reaction networks the fim has a special block-diagonal structure which reflects the parameter interdependencies and it is discussed in detail below. second, the fim is based on the propensity functions as well as on their derivatives which are known – actually, they define the process– thus the fim, similarly to rer, is numerically computable as an observable of the process. subsequent sections present various strategies to numerically estimate both the rer and the fim in an efficient fashion.

furthermore, the pathwise fim, fh, can be used not only for the estimation/approximation of rer via  but also to infer intrinsic knowledge for the system’s sensitivities  <cit> . in general, the spectral analysis of the fim reveals the  comparatively most/least sensitive directions of the system around θ. indeed, by ordering the eigenvalues of the fim as

 λ1θ≥…≥λkθ≥ <dig>  

 it can be inferred that the most sensitive direction corresponds to the eigenvector with eigenvalue λ1θ while the least sensitive direction corresponds to the eigenvector with eigenvalue λkθ. additionally, the fim is one of the most useful tools for optimal experimental design. many of the optimality criteria such as d-optimality where the determinant of the fim is maximized or a-optimality where the trace of the inverse of the fim is minimized are based on fim,  <cit> .

in the same direction, robustness of the system to parameter perturbations or errors as well as parameter identifiability can be studied utilizing spectral analysis of the fim. for instance, parameter identifiability is satisfied when all the eigenvalues of the fim are above a given threshold,  <cit> .

sensitivity analysis at the logarithmic scale
in many biochemical reaction networks, the model parameters differ by orders of magnitude and a reasonable option for carrying out sensitivity analysis is to perform perturbations which are proportional to the parameter magnitude. this can be carried out by perturbing the logarithm of the model parameters instead of the parameters itself. using the chain rule ∇logθf = ∇θf.∇logθθ = θ.∇θf where ‘. ’ is defined as the element by element multiplication k = akbk, k =  <dig>  …, k), we obtain the logarithmically-scaled fim:

  fhk,l=θkθlfhk,l,k,l= <dig> …,k, 

where fh is given by . similarly, the logarithmic perturbation for the rer is carried out using the perturbation vector θ.ε instead of ε. notice that  continues to be valid for the logarithmic scale, i.e.,

  hqθ|qθ+θ.ε=12εtfhε+o. 

linking relative entropy and observables
as we discussed in the previous sections, relative entropy provides a mathematically elegant and computationally tractable methodology for the parameter sensitivity analysis of complex, stochastic dynamical systems. such results focus on the sensitivity of the entire probability distribution, either at equilibrium or at the path-space level, i.e., for the entire stationary time-series. however, in many situations of chemical and biological networks, the interest is focused on observables such as mean populations, population correlations, population variance as well as path-space observables such as time autocorrelations and extinction times. therefore, it is plausible to attempt to connect the parameter sensitivities of observables to the relative entropy methods proposed here. indeed, relative entropy can provide an upper bound for a large family of observable functions through the pinsker  inequality,  <cit> .

more precisely, for any bounded observable function f, the pinsker inequality states that

  |eqθ−eqθ+ε|≤||f||∞2rqθ|qθ+ε, 

where ||·||∞ denotes the supremum  of f. an obvious outcome of this inequality is that if the distance between two distributions defined by rqθ|qθ+ε is controlled, then the error between the two distributions is also controlled for any bounded observable. in the context of sensitivity analysis, inequality  states that if the relative entropy is small, i.e., insensitive in a particular parameter direction, then, any bounded observable f is also expected to be insensitive towards the same direction. in this sense,  can be viewed as a “conservative” –but not necessarily sharp– bound for the parametric sensitivity analysis of observables, including path-dependent observables such as long-time averages and autocorrelations.

from a practical perspective,  can be used as an indicator that suggests –even in the presence of a very high-dimensional parameter space– which are the insensitive parameter directions for observables of stochastic dynamical systems. the least-sensitive directions can be verified computationally and we present in the sequel two examples of this practical strategy in the p <dig> and the egfr models. more generally, determining insensitive directions in parameter space can by particularly useful in multi-parameter models in systems biology characterized by “sloppiness”, i.e., when most model parameters allow for a vast range of perturbations without affecting the dynamics,  <cit> . as we concretely show in the egfr example, our methodology can easily demonstrate and quantify such properties in stochastic dynamics through the use of the spectral analysis of the pathwise fim, even if the models include a very large number of parameters.

remark 1
we note that in order to carry out such an analysis in a mathematically rigorous manner which includes both sensitive and insensitive parameters, we need to require that the norm ||·||∞ in  is controlled. for instance, typical observables in biochemical reaction networks are the number of molecules for each species, hence f = x. thus, for reaction networks where the population size is large, the pinsker inequality  will provide a bound that may not be sharp. in fact, it was recently shown that there are alternative bounds which are expected to be practically more useful than  in the sense that they provide sharp upper bounds for observables in terms of the relative entropy,  <cit> . these sharp bounds rely on the variational representation of the relative entropy and the existence of an explicit minimizer for the upper bound. furthermore,  <cit>  combined with our work on rer and pathwise fim suggests new mathematical questions towards pursuing practical sharp upper bounds involving rer and pathwise fim. in view of these comments, we conclude that ,  constitutes a theoretical indicator that relative entropy is a reliable tool for sensitivity analysis and more generally for uncertainty quantification;  from a practical perspective, it is capable to rule out insensitive directions in parameter space, which in turn provides a significant advantage in the study of “sloppy” multi-parameter models.

block-diagonal structure of the pathwise fim
in chemical reaction networks, reactions typically depend only on a small subset of the parameter vector. mathematically, this is described as

  ajθ=aj, 

where k <dig> …,klj∈{ <dig> …,k} while lj ≪ k is the number of involved parameters in reaction rj. using , it can be shown that this parametric dependence of the propensities is directly reflected on the pathwise fim. indeed, after grouping the reactions into subsets in such a way that each subset contains the minimum number of reactions having common parameters, the pathwise fim – upon rearrangement of the parameter vector– becomes a block-diagonal matrix. the pathwise fim is then written as

  fh=a1θ0⋱0aiθ 

where a1θ,…,aiθ are block matrices. the block matrices which are defined by the reaction subsets with the same parametric dependence are easily obtained by creating a graph whose nodes are the reactions and the parameters while the edges are their dependences. then, the parameter nodes contained in a connected subgraph define a parameter subset which in turn corresponds to a block of the fim. an illustration of this procedure is shown in figure  <dig> where a reaction network with m =  <dig> reactions and k =  <dig> parameters is plotted. the parametric dependencies of the reactions are shown in the left panel where  <dig> subgroups of parameters are defined based on the graph connectivity. the resulting block-diagonal structure of the fim is shown on the right panel of figure  <dig> 

before proceeding with the theoretical computation of the fim for various well-known classes of biochemical reaction networks, we list some of the implications of this simplified structure of the fim in sensitivity analysis and elsewhere. 

 the sparsity of the fim is proportional to the parametric decoupling between the reactions. knowing a priori the zero elements of the fim, there is no need to numerically compute them. it is clear that the computation cost for each sample drops from o to o where l is the largest dimension of the block matrices.

 the inverse of the fim is also block-diagonal and each block of the inverse fim is the inverse of the respective block. this fact allows us in the parameter estimation problem to easily evaluate the lower bound of the variance, at least for the complete-data case  <cit> , i.e., obtain cramer-rao bounds,  <cit>  which are given by the diagonal elements of the inverse of the fim.

 relation  implies that that optimality criteria in optimal experiment design,  <cit> , are significantly simplified. for example, the determinant employed in the d-optimality test is given by the relation det=∏i=1idet, while the trace of the inverse of the fim utilized in the a-optimality reduces to tr=∑i=1itr.

 given that parametric identifiability is characterized by the magnitude of the eigenvalues of the fim, e.g. a zero eigenvalue corresponds to a non-identifiable direction in parameter space,  <cit> , then the block-diagonal structure  can provide additional insights in parameter identification. for instance, the identifiability of the parameters of the group that corresponds to the i-th block, ai, will be increased if the smaller eigenvalues of the i-th block can be increased. on the other hand, if the determinant of the i-th block equals to zero then at least one of its eigenvalues is zero and thus the corresponding linear combinations of parameters are non-identifiable. similarly, the robustness of the system to perturbations of the parameters of the i-th group will be increased if there is a way to decrease the larger eigenvalues of the i-th block.

overall, we note that extracting useful information regarding model parameters can be performed for each block of the pathwise fim independently. next, we discuss two specific examples of biochemical reaction networks where the explicit calculation of the block-diagonal fim is demonstrated.

reactions with independent reaction constants 
an important class of well-mixed reaction networks take the general form “αjaj+βjbj→θj…” where aj and bj are the reactant species while αj and βj are the respective number of molecules needed for the reaction. the reaction constant, θj, is the parameter of the j-th reaction. the propensity function for the j-th reaction is given as the product between a rate constant and a function of the current state x:

  aj=θjgj,j= <dig> …,m. 

typically, gj=xajαjxbjβj which stems from the law of mass action, however, it can take different forms depending on the modeling of the physical process. this reaction network has k = m parameters, while each propensity depends only on one parameter, i.e., lj =  <dig> in  for j =  <dig>  …, m. the -th element of the fim in the logarithmic scale is explicitlyl given by

  fhk,l=θkθl×eμθ∑j=1majθ∂θklogajθ∂θllogajθt, 

where μθ is the stationary distribution of the stochastic process. furthermore, it holds that ∂θklogajθ=1θkδk where δ is the dirac function, therefore the pathwise fim is a diagonal matrix with elements given by

  fhk,l=eμθakθ,l=k <dig> l≠k. 

this result demonstrates that the sensitivity of a reaction constant is proportional to the equilibrium average of the respective propensity function. moreover, due to the diagonal form of the fim, it is straightforward to carry out the eigenvalue analysis and infer the most/least sensitive directions of the reaction network: the eigenvalues of the fim are its diagonal elements while the eigenvectors are the standard basis vectors of rk. hence, the most  sensitive parameter is obtained from the largest  diagonal element of the fim. furthermore,  demonstrates that the  robustness of the reaction network to a specific parameter is inversely proportional to the mean propensity of the corresponding reaction. another observation stemming from the diagonal structure of the pathwise fim is that each rate constant can be estimated from time-series data independently from the other rate constants. this observation has been already pointed out and discussed in the context of maximum likelihood estimation for the complete-data case .

additionally, the mean firing rate of a reaction is equal to the mean propensity. hence, it can be stated that the parameters that correspond to the faster reactions, i.e., to reactions with larger mean firing rate, are more sensitive in a pathwise entropy sense. it should be noted, however, that not all observables are sensitive to the parameters that correspond to the faster reactions and there are examples  where steady state observables such as the equilibrium distribution remain insensitive to specific perturbation directions even though their mean propensity may be increased. finally, we would like to remark that even though eμθakθ=θkeμθgkθ trivially holds true, the diagonal elements of the fim are not linear functions of the corresponding reaction constants since the steady state distribution μθ, depends also on the parameter vector θ. in fact, high reaction constants do not necessarily imply large mean propensities and hence a more sensitive parametric dependence. this is specifically due to the mean value in  and as an illustrative example we refer to the simple protein production-degradation model  and ).

michaelis-menten kinetics
another class of reaction networks is the michaelis-menten kinetics. in its simplest form , this chemical network contains a reaction between species a and b  with propensity function given by

 akθ=θkxaθk′+xa. 

this reaction sub-network which is derived under a quasi-steady-state assumption is one of the best-known models of enzyme kinetics in biochemistry  <cit> . the parameter θk  represents the maximum rate achieved by the system, at maximum  substrate concentrations while the michaelis constant θk′  is the substrate concentration at which the reaction rate is half the maximum value. the propensities of this michaelis-menten sub-network depend on two parameters ) thus the corresponding fim block is a 2 ×  <dig> matrix. the elements of the fim matrix are given by

  fhk,l=eμθakθ,l=k−θk′eμθakθθk′+xa,l=k′ <dig> l≠k,k′ 

for the k-th row while the k′-th row is given by

  fhk′,l=θk′2eμθakθ <dig> l=k′−θk′eμθakθθk′+xa,l=k <dig> l≠k′,k. 

in general, biochemical reaction networks may have significantly more complex propensities, nevertheless, the computation of the fim follows exactly the same calculation lines for any propensity function.

strategies for the statistical estimation of rer and fim
previous sections introduced and justified rer and fim as appropriate observables for measuring the sensitivity analysis of the reaction network’s parameters in long-time dynamics. this section presents strategies on how to efficiently estimate these quantities as ergodic averages of the underlying stochastic process.

unbiased statistical estimators
since the stationary distribution, μθ, is usually not known, both fim and rer should be estimated numerically as ergodic averages. indeed, the statistical ergodic estimator for rer is given by

  h¯=1t∑i=0n−1Δti∑j=1majθlogajθajθ+ε−a0θ−a0θ+ε 

where Δti is an exponential random variable with parameter given by the total rate, a0θ, while t=∑i=1nΔti is the total simulation time. the sequence {xi}i=0n is the embedded markov chain with transition probabilities from state xi to state xi+ <dig> is given by the ratio ajθa0θ. the weight Δti, which is the waiting time at state xi, is necessary for the unbiased estimation of the observable,  <cit> . similarly, the unbiased estimator for the fim is

  f¯h=1t∑i=0n−1Δti∑j=1majθ∇θlogajθ∇θlogajθt. 

noticing that the computation of the local propensity functions ajθ for all j =  <dig>  …, m is needed for the simulation of the jump markov process when monte carlo methods such as ssa  <cit>  is utilized, the computation of the perturbed transition rates is the only additional computational cost for the numerical rer while the additional cost for the estimation of the fim is the computation of the derivatives of the propensities. algorithm  <dig> summarizes the numerical computation of rer and fim, employing the ssa for the simulation of the jump markov process.

accelerated statistical estimators
a typical feature of biochemical systems is that the modeled reaction network is large with hundreds or thousands of reactions and different time scales stemming from the orders of magnitude difference between the reaction rates and/or between the species concentrations, making the ssa extremely slow. a large number of multi-scale approximations of the original ssa have been developed in order to handle such issues resulting to accelerated simulation algorithms. for example, mean-field approximation ignores the fluctuations of the stochastic process and yields a deterministic system of ordinary differential equations  for the mean population of the species  <cit> . stochastic corrections to the mean-field model such as stochastic langevin  <cit>  and linear noise approximation  <cit>  can be applied in order to improve the accuracy of the simulation. an alternative approximation of the jump markov process is the tau-leap method proposed by gillespie  <cit>  where a batch of events occurs at each time-increment, τ. several improvements of the basic tau-leap algorithm on how to select adaptively the τ <cit>  or avoiding negative populations  <cit>  have been proposed, however, their performance is heavily model-dependent.

algorithm  <dig> ssa-based numerical computation of rer and fim
in this subsection, we propose such approximations in order to efficiently compute the fim and/or rer observables, while maintaining controlled bias in the statistical estimators. as an illustration, we present the well-known mean-field approximation. the popularity of the mean-field modeling stems from their computational efficiency. to proceed, the stochastic process can be written as

  x=x+ηξ 

where x is the deterministic part  of the process, ξ is the stochastic zero-mean part while η is the amplitude of the stochastic term. the amplitude of the stochastic term is proportional to the inverse square root of the reactant populations  <cit> . thus, for large populations, the fluctuations of the time-evolving species populations become vanishingly small compared to the deterministic contributions. consequently, the dominant part of the process is the deterministic term whose dynamics are governed by the ode system

  x˙i=∑j=1mνj,iajθ),i= <dig> …,n. 

this ode system is also known as reaction rate equations  <cit> . restricted for simplicity to the special case with independent rate constants for each reaction, the diagonal elements of the fim are approximated using  as

  fhk,k=eμθakθ≈1t∑i=1nΔtiakθ)=1t∑i=1nΔtiakθx+ηξ=1t∑i=1nΔtiakθ)+o 

typically, such ode system is solved using an adaptive time-step numerical integrator up to final time t=∑i=0nΔti. thus, for large species populations , the following numerical estimator for the fim’s diagonal elements is obtained:

  f¯¯hk,k=1t∑i=1nΔtiakθ),k= <dig> …,k 

relation  suggests an algorithm similar to algorithm  <dig> for the numerical computation of the fim where instead of ssa, an ode solver is employed.

remark 2
multi-scale approximations are usually valid for large populations and relatively simple systems which do not exhibit complex dynamics such as bistability or intermittency. indeed, large deviation arguments  <cit>  or even explicitly available formulas for escape times  <cit>  demonstrate that stochastic approximations cannot always capture correctly exit times, rare events, strong intermittency, etc. even in relatively simple systems. however, in order to simulate large biochemical systems there is often no other alternative than such approximate models, which nevertheless need to be employed with the necessary caution.

remark 3
in biochemical systems, we are interested not only in the steady state, i.e., the stationary distribution or time-series, but also in the transient regime, e.g. signaling phenomena. the extension of the proposed sensitivity analysis method to the transient regime is justified by the fact that the time-normalized relative entropy can be also decomposed as a sum of simple integrals  <cit>  which results to the fact that the statistical estimators  and  remain valid. in a subsequent section we present an example of a biochemical system  which exhibits transient behavior, and where the proposed sensitivity analysis tools are tested and validated. the rigorous mathematical derivation of the relative entropy rate for the transient regime is out of the scope of this publication and a dedicated mathematical article on the time-dependent relative entropy rate will follow.

RESULTS
a simple protein production/degradation model
we first consider an elementary stochastic model for protein production and degradation,  <cit> , which is also a component of more complex models for gene regulatory networks,  <cit> . in this simplified model, the protein is produced at a constant rate k <dig>  while it is degraded with rate k <dig>  corresponding to the reactions

  ∅⇄k1k2x. 

accordingly, the corresponding propensity functions for the current state x = x are:

  a1=k1anda2=k2x. 

we consider this simple stochastic model due to the available analytic representations of the steady state  distribution, time-dependent moments and autocorrelations, . consequently, we can both illustrate the proposed pathwise sensitivity analysis, as well as compare it to the standard equilibrium fim, revealing concretely differences between the two approaches.

the equilibrium distribution, μθ, of this simple network is a poisson distribution with parameter k1k <dig>  therefore, the equilibrium fim for the parameter vector θ = t is given in logarithmic scale by

  fr=k1k21−1− <dig>  

on the other hand, the pathwise fim is computed via :

  fh=k <dig>  

where we used that

  eμθ=eμθ=k <dig>  

the complete calculations can be found in the additional file  <dig>  some of the implications of the differences between these two fims are discussed next.

first, we observe that the equilibrium fim, , is singular, i.e., one of the eigenvalues is zero. we readily see that in the parameter direction defined by the corresponding eigenvector, i.e., when the parameter ratio, k1k <dig>  remains constant, the system is expected to be insensitive, at least with respect to the equilibrium distribution. clearly, this is a fact verified directly from the poisson equilibrium distribution μθ which depends only on the ratio. on the other hand, the pathwise fim, , is not singular and all the directions are equally sensitive. this fact suggests that observables for dynamic quantities may be sensitive not only to parameter ratio perturbations but also to other parameter perturbations. indeed, one such example is the stationary autocorrelation function, which in the case of the simple protein production/degradation model is explicitly given by ,

  xt,x0s=k1k2e−k2t, 

where < ·, · >s denotes stationary averaging. based on this formula, it is obvious that the autocorrelation function is also sensitive to k <dig>  in addiction to the ratio k1k <dig>  this example demonstrates that in contrast to the pathwise fim, the equilibrium fim is inadequate to fully capture the dynamic properties of the process. moreover, the pathwise fim depends linearly only on k <dig>  which shows that the reaction rate constants and propensity functions in  alone, can be misleading in the assessment of parametric sensitivity. contrary, the mathematically correct equilibrium averaging of the propensities, i.e.,  can lead to a completely different outcome, as can be readily seen when we compare  and .

in terms of parameter identifiability, the fact that one of the eigenvalues of  is zero implies that that the two-dimensional parameter vector of the system is non-identifiable. indeed, the asymptotic normality of the maximum likelihood estimators,  <cit> , states that their variance , which determines parameter identifiability of k <dig> and k <dig>  is the reciprocal of the eigenvalues of . a straightforward calculation involving the eigenvectors of  shows that the only identifiable parameter is the ratio of the reaction constants appearing in . therefore parametric inference for both parameters from equilibrium data is not possible. on the other hand, the pathwise fim  is not singular, which readily implies that both parameters can be identified through  time-series data, provided that k <dig> ≠  <dig>  summarizing, this birth/death model is an example where equilibrium sampling is not enough for the identifiability of all the parameters, however, if dynamics data are available and are taken into account then all the parameters become identifiable as pathwise fim asserts.

the p <dig> gene model
the p <dig> gene plays a crucial role for effective tumor suppression in humans as its universal inactivation in cancer cells suggests  <cit> . the p <dig> gene is activated in response to dna damage and gives rise to a negative feedback loop with the oncogene protein mdm <dig>  models of negative feedback are capable of oscillatory behavior with a phase shift between the gene concentrations. here, we perform sensitivity analysis to a simplified reaction network between three species, p <dig>  mdm2-precursor and mdm <dig> introduced in  <cit> . the model consists of five reactions and seven parameters provided in table  <dig>  the nonlinear feedback regulator of p <dig> through mdm <dig> takes place in the second reaction while the remaining four reactions fall in the special class where each reaction depends on one parameter. due to these mechanisms a nontrivial steady state regime exists and can be characterized by random oscillations, see for instance figure  <dig>  the proposed sensitivity methodology is directly applicable, and the corresponding pathwise fim, see  and figure  <dig>  consists of  <dig> diagonal blocks with respective size 1 ×  <dig>  3 ×  <dig>  1 ×  <dig>  1 ×  <dig>  1 ×  <dig>  furthermore, the sensitivity analysis of this model has been performed earlier in  <cit>  based on a linear noise approximation. here, we present a detailed comparison between the two sensitivity analysis methodologies, since the one proposed here does not involve any approximation of the stochastic network dynamics.
x 
 corresponding to p <dig> 
y

 <dig> 
to mdm2-precursor while 
y 
corresponds to mdm2

the state of the reaction model is defined as x = t while the parameter vector is defined as θ = t.

figure  <dig> shows the time-series of the species for the parameter values in table  <dig>  evidently, oscillatory behavior is observed at this parameter regime, where persistent random oscillations occur, ranging between high and low populations. on the other hand, the frequency of the oscillations is less variable as it has been already reported both experimentally and numerically  <cit> . another interesting observation is that the concentration of p <dig> species usually attains the lower bound of its admissible value  which results in stochastic effects far away from gaussianity, as can be readily seen also in figure  <dig> 

b


x

a


x

a


k

k
b


y

a

0
a


y

proceeding, we denote by θ = t the parameter vector. the numerical estimator for rer as well as for the pathwise fim in the logarithmic scale are computed utilizing algorithm  <dig>  logarithmic sensitivity analysis is preferred because the range of the parameters values varies by orders of magnitude as can be seen in table  <dig>  the upper plot in figure  <dig> shows the rer as a function of time for various perturbations. viewing rer as an observable, it is striking the speed of relaxation of the estimator. within two or three oscillation periods, rer has been converged to its value even though the three species have significant oscillations and stochasticity, as figure  <dig> shows. a primary reason for the fast relaxation is the numerical estimator of rer where the summation is over all reactions even though only one reaction takes places at each jump ). having the important property of fast convergence, global sensitivity analysis, where not only a point of the parameter regime but also large subsets of the parameter space, can be efficiently performed,  <cit> . the lower panel of figure  <dig> shows the rer when only one of the parameters are perturbed by +10% or by -10%. additionally, the rer computed from the fim, utilizing , is also provided. the fim approximation of rer is a second order approximation in terms of |ε|, hence the computation of fim is typically enough to fully resolve the local sensitivities of a model. evidently, the most sensitive parameters here are bx and ak while the least sensitive parameters are ax and k.

comparison to the lna-based sensitivity approach
in  <cit> , the authors suggested a linear noise approximation  for the stochastic evolution around the nonlinear mean-field equation, and based on this approximation a system of odes is derived for the mean and the covariance matrix of the approximation process. since the noise of lna is gaussian, the mean and the covariance matrix contains all necessary information regarding the approximate stochastic model. then, the associated fim is derived and based on it, the sensitivities for each parameter are computed. although there are regimes where this approximation is applicable , for systems with nontrivial long-time dynamics, e.g. metastable, it is not correct as large deviation arguments  <cit>  and explicit formulas for escape times  <cit>  show. similar issues with non-gaussianity in the long-time dynamics arise in stochastic systems with strongly intermittent  or random oscillatory behavior  <cit> . in the p <dig> model considered in  <cit>  which had the same parameter values as here, figure  <dig> reveals that the time-series of the p <dig> populations persistently fluctuate between high and low values, thus the lna approximation may not be accurate at least when the concentration of the species is very low.

at first pass, when the parameters are grouped into two classes depending on their sensitivities, the two sensitivity approaches produce qualitatively similar results. indeed, by visual inspecting the lower plot of figure  <dig> in the current publication and figure three in  <cit> , the  sensitive parameters in both methods are bx, by, ak, a <dig>  ay while the practically insensitive parameters are ax, k. however, upon closer inspection, the two methods produce different results. figure  <dig> shows the proposed fim  based on the exact  pathwise relative entropy theory, as well the fim proposed in  <cit>  which is derived from the lna of the reaction system. the results are completely different and the proposed pathwise fim is sparse as expected. a striking difference between the two sensitivity approaches is that the sensitivity of parameter bx in our proposed method is relatively high compared to the other parameters while the sensitivity of bx in the lna-based method is at least one order lower compared to the other parameters, see figure  <dig>  and also compare figure  <dig> of this publication and figure three in  <cit> .

as a means of comparison between the methods, we perturb bx as well as by by the same amount and observe the power spectral density , i.e., the square of the absolute value of the fourier transform of each species’ time-series. given the sustained random oscillations observed in the p <dig> model, see figure  <dig>  the psd is a suitable observable since it identifies the dominant periodicities and corresponding amplitudes in stationary time-series,  <cit> . using the pinsker inequality  as a guideline, we expect that the observable will not be sensitive to the least sensitive directions of the fim, therefore, we focus on the most sensitive directions of the fim identified in figure  <dig>  figure  <dig> shows the averaged psd for the three species of the model for the unperturbed case , the perturbation of bx only  as well as the perturbation of by only . one hundred realizations were used for the averaging procedure while the perturbation strength was +20%. the l1-norm, i.e., the integral of the absolute difference, between the unperturbed psd and the bx-perturbation is  <dig>  ·  <dig> while the l1-norm between the unperturbed psd and and the by-perturbation is  <dig>  ·  <dig> which is about the half value. hence, the averaged psd –primarily the amplitude of the oscillations– is more sensitive to perturbations of bx rather than to perturbations of by as our sensitivity analysis method predicted while the lna-based method suggested the reverse order of sensitivity. we note that the choice of the l <dig> norm for the psds is justified since it describes the total energy  of the time-series, when viewed as a signal,  <cit> . an explanation of the performance of the lna-based sensitivity analysis stems from the fact that the p <dig> species does not have gaussian noise when the population is close to zero, and which can indeed occur frequently, see figure  <dig> . additionally, notice that both bx and by affect the concentration of p <dig> explicitly or implicitly through the associated reactions thus their sensitivities are heavily biased due to the wrong statistical approximation of the p <dig> species. moreover, we note that other observables, e.g., the arg max  of the psd, can be sensitive to perturbations of by, see figure  <dig>  this observation is not contradictory to the findings of the proposed sensitivity methodology for two reasons: first, even though the pinsker inequality  points towards the right direction regarding sensitive parameters for observables, it is only an upper  bound. second, even though bx is more sensitive in absolute value than by in terms of the proposed pathwise fim, both bx and by sensitivities have the same order of magnitude  therefore there should exist observables which are also sensitive to by perturbations. finally, for the sake of completeness, we report the observable values for the insensitive parameters. the l1-norm between the unperturbed psd and the ax-perturbation is  <dig>  ·  <dig> which is approximately two orders of magnitude less than the l1-norm for the sensitive parameters. similar results hold for the other insensitive parameter, k. thus, the outcome of the pinkser inequality , i.e., that small rer values imply relatively insensitive parameters for the observables, is also numerically verified.

epidermal growth factor receptor model
the egfr model is a well-studied system describing signaling phenomena of  cells  <cit> . as its name suggests, egfr regulates cell growth, survival, proliferation and differentiation and plays a complex and crucial role during embryonic development and in tumor progression  <cit> . in this paper, we study the reaction network model for the dynamics of egfr developed by schoeberl et al.  <cit>  which consists of  <dig> species and  <dig> reactions. figure  <dig> presents the egfr reaction network in an abstract level. initially, the extracellular binding of egf with the egf receptors induce receptor dimerization. then, two principal pathways, shc-dependent and sch-independend, are initiated leading to activation of ras-gtp. subsequently phosphorylation of mek kinase through the activation of raf kinase occurs leading to the phosphorylation of erk kinase which regulates several proteins and nuclear transcription factors inside the cell. the detailed graphical description of the reaction network can be found in the figures one & two of supplementary information in  <cit> . for completeness, all the reactions along with their rates are provided in the additional file  <dig> of this publication.

the propensity functions for the reactions r <dig>  …, r <dig>  r <dig>  …, r <dig> of the egfr network are written in the general form

  aj=kjxajαjxbjβj,j= <dig> …, <dig> ,…, <dig> 

with the exception of reaction pair r <dig>  r <dig> where their propensity functions are governed by the michaelis-menten kinetics

  aj=vmaxxaj/,j= <dig>  

where x is the current state of the reaction system while aj corresponds to the reacting species. the parameter vector contains all the reaction constants,

 θ=t, 

 with all values provided in the additional file  <dig>  due to the specific values of the reaction constants as well as the initial population of the species , the firing rates between reactions differ by many orders of magnitude giving rise to a highly stiff network. therefore, even though there are some stochastic implementations,  <cit> , here for the purposes of rer and fim calculations, we adopt the mean-field approximation discussed in the accelerated estimators subsection. we solve the derived system of odes with matlab’s routine ode15s and compute the fim at the steady state regime which corresponds to the time interval  <cit> . the completion of the internalization process needs about  <dig> seconds. it should be noted here that even though the simulation of the egfr is performed utilizing a deterministic approximation model, the computed pathwise fim has been derived from the stochastic network, i.e., . this approximation is expected to be valid in the sense of  due to the large populations considered here. overall, the computed fim is a sparse matrix and measures efficiently the sensitivities of the stochastic model in a gradient-free manner.

the upper plot of figure  <dig> shows the diagonal elements of the fim in descending order computed at the steady state regime. we report our results in the format of figure  <dig> in order to be able to accommodate the large number of parameters in the model. the k-th diagonal element of the fim corresponds to rer where the perturbation takes place only to the k-th parameter ). figure  <dig>  in conjunction with table s <dig> of the additional file  <dig> fully describe the  sensitivities of the reaction network. table s <dig> in additional file  <dig> presents the reaction constants ordered from the most sensitive to the least sensitive parameter. moreover, the fim is diagonal –except a small 2× <dig> block associated with the michaelis-menten reactions– therefore the diagonal elements correspond to the eigenvalues of the fim. the sensitivity analysis depicted in figure  <dig>  demonstrates that most model parameters allow for a vast range of perturbations without affecting the dynamics. furthermore, this robustness to variations in most parameters was also reported in the original, fully deterministic egfr model in  <cit> . this is a feature shared by many multi-parameter models in systems biology and which is known as “sloppiness”,  <cit> . our methodology can easily demonstrate such properties in stochastic dynamics, as we can readily see in figure  <dig>  even if the models include a large number of parameters.

the previous discussion refers to the analysis of the egfr model to the steady state regime. on the other hand, egfr is a signaling model whose transient regime, in addition to the steady state, is of great interest. as discussed in remark  <dig>  we can justify the application of the rer and fim sensitivity analysis in the transient regime. therefore, we compute the proposed fim at the time interval  <cit> , using . the lower plot of figure  <dig> shows the diagonal elements of the pathwise fim in the transient regime while keeping the ordering of the parameters unchanged from the upper, steady state plot. the parameter sensitivity ordering is completely different meaning that the sensitivities are time-dependent in the transient regime. for instance, the most sensitive parameters in the stationary regime correspond to the final products of the reaction network, however, in the time interval  <cit>  these species have not been produced yet resulting to insensitive reaction constants. in terms of parameter identification and estimation, the time-dependent sensitivities imply that in order to extract the maximum information content from the experimental data, we have to estimate the parameters drawing samples from different time intervals. these time intervals should be defined based on the respective sensitivity indices and selected in order to maximize the identifiability for each set of parameters.

finally, the pinsker inequality  suggests that insensitive parameters can be perturbed, even significantly, without affecting species concentrations or other observable. as an illustration of this fact, we present in figure  <dig> the concentrations of various critical species of the egfr model when the 140-th  most sensitive parameter is perturbed . the rate constant k <dig> corresponds to a reaction of the shc-dependent pathway module. solid blue lines correspond to the unperturbed parameter case while the dashed red lines correspond to the perturbed case where the perturbation is a multiplication by a factor of ten of k <dig>  we present the total number of  <dig> binding species without sch*  and with sch*  as well as ras-gtp , total activated raf or total raf* , doubly phosphorated mek or mek-pp  and doubly phosphorated erk or erk-pp. these species are important for the understanding of the system since the different modules of the egfr reaction network communicate through them . it is evident from figure  <dig> that the various species concentrations remain unchanged to perturbations of the insensitive parameter k <dig> as it was expected from . moreover, we notice that although the average populations become large, which implies that the maximum norm in  is also large, we still obtained robust results regarding k65’s parameter sensitivity.

CONCLUSIONS
in this paper, we applied and extended a recently proposed parametric sensitivity analysis methodology to complex stochastic reaction networks. this sensitivity analysis approach is based on the quantification of information loss along different parameter perturbations between time-series distributions. this is achieved by employing the relative entropy rate, which is directly computable from the propensity functions. a key aspect of the method is that we can derive rigorously an associated fisher information matrix on path-space, which in turn constitutes a gradient-free approach for parametric sensitivity analysis; as such it provides a significant advantage in stochastic systems with a large number of parameters. we demonstrated that the structure of the pathwise fim revealed hidden parameter interdependencies between the reactions. the block-diagonal structure of the fim highlighted the sparsity of the matrix which resulted in further improvements in the computational efficiency of the proposed method. therefore, parametric sensitivity analysis for high-dimensional stochastic reaction systems becomes tractable since it is well-known that in high dimensional stochastic systems sensitivity analysis techniques can involve estimators of very high variance, e.g. in finite difference methods and their recently proposed variants, which can present an overwhelming computational cost. additionally, we proposed the use of multiscale numerical approximations of stochastic reaction networks in order to derive efficient statistical estimators for the fim and implemented one such approximation  in a high-dimensional system.

the proposed pathwise sensitivity analysis method is tested and validated on three biological systems:  a simple protein production/degradation model where explicit solutions are available,  the p <dig> reaction network where quasi-steady stochastic oscillations of the concentrations are observed and where multiscale stochastic approximations break down due to the persistent oscillations between low and high populations, and  a stochastic egfr model which is an example of a high-dimensional reaction network with more than  <dig> reactions and a corresponding number of parameters. in the egfr reaction network, we combined the proposed pathwise fim which has been derived from the stochastic network and the mean-field approximation which is used for the efficient estimation of the pathwise fim. moreover, our earlier rigorous analysis for the steady state regime  <cit>  suggests suitable extensions in the transient regime which were tested and validated for the egfr model. we will present the full rigorous theory in an upcoming publication.

finally, we note that the relation between rer and various observables is not straightforward. however, we note that the path distribution contains all information regarding the process including the steady state and all time-dependent observables: practically, our proposed sensitivity analysis represents a “conservative” sensitivity estimate in the sense that insensitive directions for the relative entropy on path-space will yield insensitive directions for every observable. this latter statement can be justified mathematically through the pinsker inequality  which was tested in the examples considered here. based on these observations, the proposed sensitivity analysis methods can be deployed in complementary fashion with existing sensitivity analysis tools, as it can be used to narrow down the most sensitive directions in a system.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
mak and yp conceived the proposed sensitivity analysis methodology. yp conducted the numerical experiments. mak and dgv designed and supervised the conducted research. all authors contributed to the preparation of the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
the detailed derivation of relative entropy rate and the associated fisher information matrix.

click here for file

 additional file 2
the calculation of equilibrium and pathwise fims for the protein production/degradation model.

click here for file

 additional file 3
this file contains in plain text the reactions and the reaction constants of the egfr model.

click here for file

 additional file 4
the ordering of the parameter sensitivities for the egfr model.

click here for file

 acknowledgements
the work of mak and yp was supported in part by the office of advanced scientific computing research, u.s. department of energy under contract no. de-sc <dig> and de-sc <dig>  the work of dgv was supported in part by the office of advanced scientific computing research, u.s. department of energy under contract no. de-fg02-05er <dig> and de-sc <dig>  the work of mak was also supported in part by the european union  and greece , under the thales program, grant amosicss.
