BACKGROUND
the availability of high-throughput sequencing methods has led to the discovery of thousands to millions of single nucleotide polymorphisms  in diverse organisms, particularly humans, model experimental organisms, and agriculturally important plants and animals. combined with high-throughput genotyping platforms, snp markers are having substantial impacts on human medicine as well as plant and animal breeding  <cit> . they are also being used to provide detailed insights into the population genetics of natural populations, and are likely to help elucidate the functional basis of simply inherited traits. in addition, they are frequently cited as the solution for understanding the explicit genetic basis of quantitative traits  <cit> , although prospects for the latter remain uncertain  <cit> .

our main goal was to develop and test a large number of snp markers for douglas-fir  franco) that could be used to enhance and accelerate douglas-fir breeding via genomic selection. tree breeders typically make breeding decisions based on an individual’s breeding value, which is the average performance of an individual’s offspring. currently, breeding values are estimated from measurements made in progeny tests containing thousands to tens of thousands of trees. genomic selection, or whole-genome marker-assisted selection  <cit> , could revolutionize tree breeding by allowing breeders to dramatically reduce the generation interval and extent of progeny testing. genomic selection has been widely adopted in livestock breeding  <cit> , where empirical studies suggest that accuracies of genomic selection are often 70% or more, compared to accuracies of  <dig> to 40% for breeding values estimated from parental performance, and accuracies of about 85% for breeding values estimated from progeny testing, which is both time-consuming and costly  <cit> . however, these encouraging results required snp resources consisting of thousands to tens of thousands of snps—numbers that far exceed what is available for douglas-fir. in addition to genomic selection, snp markers are expected to replace simple sequence repeats  for routine, automated uses of markers for other breeding program applications. the high variability of ssr markers makes them ideal for many applications, but automated marker scoring is often challenging. in seed orchards, genetic markers  are routinely used to confirm the identity of seed orchard trees, measure pollen contamination, assess the effectiveness of pollen management techniques, measure and manage inbreeding and genetic diversity, determine parental contributions to open-pollinated seedlots , and verify seedlot integrity  <cit> . highly informative genetic markers may also allow breeders to combine simple, cost-effective mating designs  with parental analysis to reduce breeding costs, speed breeding progress, and increase genetic gains  <cit> .

douglas-fir is one of the most ecologically and economically important tree species in the world. it occupies diverse habitats from central british columbia to mexico, and from the pacific ocean to the eastern slopes of the rocky mountains. in the pacific northwest, coastal douglas-fir  forms ancient forests that serve as key habitats for endangered species, and are widely grown in plantations that form the foundation of a multi-billion dollar forest products industry. in the rocky mountains, the interior or rocky mountain variety  franco) occupies mostly drier and colder sites, and has a more varied impact on the ecology and economy of the region. in mexico, douglas-fir exists as widely dispersed ‘sky-island’ populations that are typically considered extensions of var. glauca, but may deserve their own varietal status  <cit> . overall, douglas-fir is ecologically, physiologically, and genetically diverse, within and among varieties . because of its economic importance, douglas-fir has one of the largest tree breeding programs in the world. the northwest tree improvement cooperative program for coastal douglas-fir has nearly  <dig> million tested trees, including more than  <dig>  first-generation parents tested on  <dig>  progeny test sites, and  <dig>  second-cycle crosses tested on  <dig> sites  <cit>  . smaller breeding programs exist for interior douglas-fir in the united states and canada . in coastal douglas-fir, breeding focuses on improving growth, stem form, and wood properties while maintaining climatic adaptability.

our primary goal was to greatly expand the snp resources for douglas-fir beyond the 200– <dig> validated snps that were currently available  <cit> . therefore, we combined two high-throughput sequencing technologies  to sequence the transcriptomes of diverse tissues and douglas-fir genotypes. our objectives were to  develop a reference transcriptome for coastal douglas-fir by combining existing sanger sequences with new  <dig> sequences,  annotate and evaluate the quality of the reference transcriptome,  map  <dig> and illumina short-read sequences to the reference and identify snps, and  construct and test a high-density infinium genotyping array. in addition to the snp markers we developed, our reference transcriptome will facilitate studies of gene expression and function, and will aid efforts to assemble and annotate reference genome sequences of douglas-fir and other conifers .

RESULTS
pre-assembly sequence processing for the reference transcriptome
we used long reads from three datasets as the basis for de novo assembly of a reference transcriptome for coastal douglas-fir. prior to the final assembly, we cleaned and filtered these datasets as shown in figure  <dig> . these datasets included  <dig> sequences from a single genotype  and sequences from two multi-genotype pools produced using  <dig> pyrosequencing  and sanger sequencing . our initial pool of  <dig>  ×  <dig> reads was reduced to  <dig>  ×  <dig> reads after filtering using the snowhite pipeline . the percentage of filtered sequences was substantially smaller for the normalized than for the non-normalized  <dig> dataset , and this effect was most pronounced for the rrna and retrotransposon-like sequences . after removing additional fungal and bacterial sequences, and excluding reads shorter than  <dig> nt,  <dig>  ×  <dig> sequences were available to assemble the reference transcriptome .

* for each dataset, the numbers of reads filtered using the snowhite pipeline  are shown by sequence type.

† gs-flx titanium is the roche  <dig> sequencing platform.

* the input number of reads is less than the total in table  <dig>  because reads shorter than  <dig> nt were excluded. statistics were calculated using the sequences actually used in the assembly after applying a default minimum length of  <dig> for reads trimmed by newbler.

† includes reads that assembled as complete reads or as partial reads.

§ isotigs ≥  <dig> nt were deposited at ddbj/embl/genbank under accession gaek <dig> 

‡ statistics for the im isogroups were calculated using the longest isotig in each isogroup.

assembly of the reference transcriptome
in this section, we describe the preliminary and final assemblies of the reference transcriptome , and analyses we used to infer the orientation of the resulting isotigs and singletons. different assembly parameters resulted in few differences in the number of resulting isogroups . in particular, there was almost no increase in the total number of isogroups when the overlap identity was increased from 82% to 90%, and only a slight increase from 90% to 98%. the final de novo assembly was constructed using a minimum overlap length of  <dig> nt, minimum overlap identity of 96%, and an alignment difference score of − <dig>  however, before conducting the final assembly, we assembled the  <dig> datasets  separately, and then used blastn to compare the resulting isotigs and singletons to a series of databases to identify and remove sequences from contaminating fungal and bacterial organisms . after the final assembly, we used vmatch to eliminate redundant sequences from  <dig>  assembled isotigs, resulting in  <dig>  non-redundant isotigs with an average length of  <dig>  nt and n <dig> of  <dig>  nt . the resulting reference transcriptome consisted of  <dig>  isogroups  and  <dig>  singletons. of these  <dig>  isogroups,  <dig>  were represented by a single isotig , and are inferred to correspond to a single transcript. these isogroups and isotigs are referred to as the ‘i1’  subset in the following analyses. the remaining  <dig>  isogroups were represented by multiple isotigs, which suggests they represent alternatively spliced transcripts from the same gene. these isogroups and isotigs are subsequently referred to as the ‘im’  subset. the reference transcriptome  has been deposited at ddbj/embl/genbank under accession gaek <dig>  the characteristics of the transcriptome isotigs and singletons are described in additional files  <dig> and  <dig> 

mapping of strand-oriented reads from the cbil and ykil libraries allowed us to infer the orientations of  <dig> % of the isotigs and  <dig> % of the singletons . the orientations of the remaining isotigs and singletons were ambiguous because the binomial test was non-significant or no data were available . other assembly characteristics are reported in table  <dig> 

comparison to white spruce and loblolly pine
to evaluate our assembled isotigs, we compared them to a well characterized set of white spruce unigenes . isotigs with clear interpretable relationships to these unigenes were assigned high confidence scores, and were preferentially included on the snp array. we categorized the isotigs into confidence classes  based on their relationships to the white spruce unigenes described by rigault et al.  <cit>  . lower numbers represent simpler relationships and  greater confidence that the assembly is correct. although the percentages of unmatched isotigs  were roughly equal for the two subsets , the other classes differed dramatically between the i <dig> and im subsets . this reflects the more complex relationships that are possible for isogroups with multiple isotigs , and shows how this leads to generally lower confidence scores for this group.

*douglas-fir  isotigs were categorized into seven classes  and three levels of confidence based on their relationships to white spruce  contigs using the scarf program  <cit> .

†number of white spruce contigs that matched the douglas-fir query.

§‘yes’ indicates that at least one non-query isotig also matched the same white spruce contig.

‡‘yes’ indicates that the query and at least one non-query isotig matched the same region of the white spruce contig .

#subjective level of confidence in the isotig assembly based on the information presented in columns 2– <dig> 

@cross-hatched bars represent white spruce contigs, black bars represent query douglas-fir isotigs, and white bars represent non-query douglas-fir isotigs.

when we conducted the same scarf analysis using  <dig>  loblolly pine contigs, the results were nearly identical to those of white spruce . for example, the correlation between the numbers of isotigs in each confidence class was  <dig>  between spruce and pine . in addition, 67% of the no-hit isotigs found using spruce as the reference  were also no-hits using pine as the reference . conversely, 80% of the no-hit isotigs found using pine as the reference  were also no-hits using spruce .

annotation
we annotated the isotigs and singletons , and then used this information to select snps for the snp array. for all three protein databases, the percentages of sequences with matches were highest for the i <dig> subset, moderate for the im subset, and lowest for the singletons  . the annot8r annotation tool creates subsets of selected uniprot databases that only include protein sequences with go, ec, or kegg annotations. therefore, in contrast to the results from annot8r, many of the proteins in the uniref <dig> database, and some of the proteins in the tair <dig> database have unknown functions. thus, the results from annot8r provide the percentages of douglas-fir sequences that can be annotated by function . we subsequently used these annotations to target snps associated with growth, phenological traits, stress resistance, or adaptation to temperature or drought. in contrast, the distribution of matches among taxonomic groups did not differ substantially among subsets i <dig>  im, and s . small percentages  of assembled douglas-fir sequences matched fungal, bacterial, and viral sequences at an e-value < 10- <dig>  which is greater than the much more stringent 10- <dig> e-value we used to identify contaminating isotigs and singletons during the filtering that preceded our final assembly.

*matches were recorded for isogroups and singletons at a tblastx e-value < 10- <dig> 

†isogroups are newbler v <dig>  isogroups. for the isogroups with more than  <dig> isotig , a hit was counted only if all isotigs matched the same protein in the database.

§singletons are  <dig> reads that did not assemble with any other reads.

*matches are grouped by taxonomic affiliation and percentages are relative to the total number of matches . numbers of input douglas-fir sequences are in parentheses.

†isogroups are newbler v <dig>  isogroups. for the isogroups with more than  <dig> isotig , a hit was counted only if all isotigs matched the same protein in the database.

§singletons are  <dig> reads that did not assemble with any other reads.

the differences in the distributions of go slim classifications among the three types of douglas-fir sequences  were small . compared to douglas-fir, many more arabidopsis sequences fell into the “unknown cellular components” and “unknown molecular functions” classes. this indicates that douglas-fir sequences were less likely to match these classes of arabidopsis sequences than others, suggesting that they tend to exhibit species-specific characteristics . presumably, many of the unmatched douglas-fir genes would fall into these go slim classes had we used a less stringent e-value.

snp detection
two criteria are important for selecting snps for an infinium genotyping array. first, the target snp should have a high probability  of being a true variant. second, the target snp should have no variants in its flanking sequences where the genotyping primers must hybridize. therefore, the p-values for flanking variants  should also be considered. a high snp conversion rate is expected when a very high p-value  is used for flanking variants, and a very low p-value  is used for target snps. however, this approach will dramatically reduce the number of snps that can be detected and assayed. in this section, we describe how we filtered all potential target snps based on ps, pf, and other criteria .

we used a permissive probability threshold  to detect potential snps and indels in the flanking regions of target snps . these positions were then excluded  from consideration when the genotyping primers were designed. out of a total assembly of  <dig>  ×  <dig> nucleotides, we masked  <dig>  snps and  <dig>  indel positions. in the subsequent filtering step to identify target snps, we identified bi-allelic snps that were not near high-quality indels , had a mapping quality score >  <dig> in at least one dataset, and target snp probabilities  of < 10- <dig>  10- <dig>  or 10- <dig> in at least one dataset . for the most stringent  level of probability, these criteria resulted in  <dig>  potential snps ,  <dig>  of which were detected in more than one dataset . many snps were detected in both the coastal and interior datasets— <dig>  shared snps in  <dig>  isogroups. on average, these shared snps represented 74% of all coastal snps and 67% of all interior snps. not surprisingly, more snps were detected in the larger datasets .

*the number of unique snps and the number of snps shared in other datasets of the coastal, yakima, and interior seed sources are presented for all isogroups  and for the  <dig> isotig per isogroup subset  . the total number of unique snps detected in all datasets was  <dig> .

†snp totals are not the sums of the values in the same row because snps are double-counted. for example, we detected  <dig>  snps in the cbil dataset,  <dig>  of which were detected in the ykil dataset and  <dig>  of which were detected in the intil dataset.

snp array
in this section, we describe other criteria, including infinium design scores, which were used to select the final set of snps to test on the genotyping array. design scores are values generated by the infinium assay design tool that are associated with the performance of snp assays. design scores could be generated for only 34%  of the target snps submitted to illumina , primarily because of the permissive probability threshold  used for calling variants in the flanking sequences. that is, assays were not possible for 66% of the target snps because of flanking snps and indels in the assay design region . we then selected  <dig> snps to test using an infinium genotyping array   <cit> . selection criteria included differential expression, annotations, target snp probabilities, minor allele frequencies , illumina design scores, and snp array capacity. of the  <dig> attempted snps, only  <dig>  were assayed because of the normal loss of bead types that occurs during array manufacture . of these,  <dig> snps had call frequencies ≥ 85%, and  <dig> of these were polymorphic in a sample of  <dig> trees . of the  <dig> successful snps,  <dig>  had significant deviations from hardy-weinberg equilibrium . the characteristics of the successfully called and polymorphic snps are described in additional file  <dig> and summarized in table  <dig> 

*the number of snps in each category is expressed as a percentage of the total number of snps attempted  and number of snps successfully assayed on the array .

†successful calls are those with a gencall score ≥  <dig>   <cit> .

*successful snps are those with a call frequency >  <dig>  and maf >  <dig> based on an analysis of  <dig> trees.

† successful calls are those with a gencall score ≥  <dig>   <cit> .

§ tested using an exact test of hwe and a probability level of  <dig>  × 10- <dig> .

using logistic regression, we identified eight bioinformatic characteristics significantly related to the ability to distinguish the  <dig> successful snps from the remaining  <dig> snps that were assayed . the order in which the variables entered the model reflects their relative importance:  number of datasets in which the snp was detected,  mean number of reads across datasets,  number of contigs per isotig,  minimum snp probability across datasets,  isotig length,  isotig type ,  mean snp probability across datasets, and  confidence group . the four variables that did not enter the model were the mean minor allele frequency across datasets, number of isotigs per isogroup, snp iupac code, and illumina design score.

discussion
we developed a reference transcriptome and large snp database for douglas-fir that will serve as a resource for a variety of research and breeding applications. we detected snps by aligning  <dig> and illumina short-read sequences to a reference transcriptome, and then identifying snp and indel polymorphisms. during this process, we incorporated steps specifically designed to sequence transcripts from diverse genotypes, tissues, and environmental conditions; identify highly-likely snp positions; and maximize the number of snps that can be reliably assayed using an illumina infinium ii snp array. a thorough evaluation of the reference transcriptome provides information on the sequences from which the snps were derived, including annotations. a set of  <dig>  snps were deposited in the dbsnp database with submitted snp id numbers  ranging from  <dig> , <dig> to  <dig> , <dig> 

assembly of the reference transcriptome
we used newbler v <dig>   to assemble a reference transcriptome from  <dig> and sanger sequences. as for most other non-model organisms  <cit> , we chose pyrosequencing because longer reads are better for de novo assembly, and during the sequencing phase of the project,  <dig> read lengths offered a clear advantage  <cit> . sequences were removed from the input dataset by first filtering short and low-quality reads, and reads closely related to adaptor, vector, chloroplast, mitochondrial, rrna, or retrotransposon sequences . for all classes of sequences, the normalized  <dig> dataset  had smaller numbers of filtered sequences than did the non-normalized dataset . across all datasets , rrna-like sequences represented the largest percentages of filtered reads , with retrotransposon-like sequences being second . we used procedures similar to those described by parchman et al.  <cit>  to identify the retrotransposon sequences at the read-level. in lodgepole pine, parchman et al.  <cit>  found that  <dig> % of their normalized  <dig> reads had characteristics of retrotransposons, but our values were  <dig> % and  <dig> % for the non-normalized and normalized datasets, respectively . even lower numbers of transposon-like sequences  were reported for other conifer est datasets  <cit> . although these sequences could represent transcriptionally active retrotransposons, genomic contaminants are also likely to occur in the cdna library, particularly when random primers are used for cdna synthesis  <cit> .

newbler produces three kinds of output: unique gene models , presumed transcript variants , and singletons. prior to the final assembly, we conducted preliminary assemblies using combinations of newbler parameters, and evaluated the results based on the number of isogroups represented by a single isotig , number of isogroups represented by multiple isotigs , and total number of isogroups. we found subtle changes in the resulting assemblies, and ultimately decided to use a minimum overlap length of  <dig> nt, alignment difference score of − <dig>  and a minimum overlap identity of 96%. for snp detection, we concluded that these parameters would result in an assembly that balances the detection of false positive snps among gene family members that are treated as a single locus versus false negative snps that are missed because alleles are treated as separate loci.

we used isotigs and singletons derived from preliminary assemblies to identify and filter reads believed to result from contamination by fungi and bacteria, and to compare levels of contamination between the two  <dig> datasets. the single-genotype  dataset was derived from tissues harvested from the aerial portion of the plant, whereas the multi-genotype  dataset also included washed roots. these analyses suggest that bacterial and fungal contamination was not a serious problem in either dataset , but the true number of contaminating reads is unknown because 26% of the isogroups and 75% of the singletons remained unannotated .

in the multi-genotype dataset , the most highly represented bacterial and fungal sequences seemed to be associated with the roots included in this sample. for example, species of pseudomonas are common in soils, where they are associated with plant disease and plant growth promotion  <cit> . furthermore, there is a close association between pseudomonas fluorescens and the symbiotic laccaria ectomycorrhizae that infect douglas-fir roots  <cit> . other sequences that were common in the multi-genotype dataset included those related to botrytis cinera , a soil fungus that causes grey mold disease in douglas-fir seedlings  <cit> , fusarium circinatum , which can cause pitch canker disease on douglas-fir  <cit> , and sclerotinia, which is interesting because this plant pathogen has never been reported as a pathogen of douglas-fir . none of these sequences were common in the single-genotype dataset , which did not include roots. instead, the most highly represented sequences in the single-genotype dataset  belong to genera that include wood-rot fungi which may have been associated with the cambial tissues that were specifically included in this sample. nonetheless, this sample did contain some reads that are related to inonotus, which is primarily considered a root pathogen .

reference transcriptome
our first major objective was to assemble a reference transcriptome which could then be used to map reads and identify snps in both varieties of douglas-fir. our reference transcriptome consists of  <dig>  isogroups ,  <dig>  isotigs ,  <dig>  singletons, and more than  <dig>  million  <dig> reads .

of our  <dig>  isogroups,  <dig>  are represented by a single isotig  and are inferred to correspond to a single transcript. the remaining  <dig> isogroups are represented by multiple isotigs, which suggests they represent alternatively spliced transcripts from the same gene. the mean length of isotigs was  <dig> nt and the n <dig> was  <dig>  this n <dig> indicates that 50% of the assembled nucleotides occur in isotigs that are shorter than  <dig> nt. these isotigs are about as long as those derived from other recent assemblies of tree transcriptomes. for example, lorenz et al.  <cit> , assembled  <dig> reads from  <dig> conifers using three assemblers. based on assemblies of  <dig>  to  <dig>  million reads , the average number of contigs  was  <dig> ,  <dig> , and  <dig>  using the miraest, ngen, and newbler assemblers, with mean contig lengths of  <dig>   <dig>  and  <dig> nt. newbler consistently yielded many fewer and longer contigs than did miraest and ngen. using newbler, the largest dataset of  <dig>  million reads , yielded  <dig>  isotigs with a mean length of  <dig> nt. in lodgepole pine, ngen was used to assemble a transcriptome from  <dig>  million  <dig> reads, yielding  <dig>  contigs with a mean length of  <dig> nt  <cit> . not surprisingly, earlier de novo assemblies of transcriptomes of other non-model plants generally used fewer and shorter  <dig> reads, yielding fewer and shorter contigs  <cit> .

comparison to white spruce
the number of genes in douglas-fir is unknown, but white spruce, another conifer in the pinaceae, is estimated to have as many as  <dig>  transcribed genes covering as much as  <dig>  mb  <cit> . this estimate, which is based on sanger sequencing , next-generation transcriptome sequencing , and genomic sequencing , provides a good basis on which to judge the extent of our reference transcriptome. considering only the longest isotig in each isogroup, our assembly covers  <dig>  mb in isogroups. therefore, assuming that the white spruce estimates are accurate, and the transcriptomes of douglas-fir and white spruce are about the same size, our isogroups could represent 76% of the genes and total transcriptome length of douglas-fir. the total length of singletons was another  <dig>  mb, suggesting that only a modest proportion of these sequences represent unique douglas-fir transcripts . given the estimated size of the white spruce transcriptome, many of these sequences are probably highly redundant with the assembled isotigs or each other, or represent contaminating sequences from genomic dna or other organisms.

we compared our isotigs to a white spruce gene catalog of  <dig>  unigenes assembled from the  <dig>  sanger sequences described above  <cit> . each douglas-fir isotig was classified into one of seven classes designed to reflect the relative likelihood that reads were assembled correctly into a single locus . for example, isotigs having one-to-one matches with white spruce unigenes  were classified into the ‘highest’ confidence class , and isotigs that matched multiple white spruce isotigs and other douglas-fir isotigs were classified into the ‘lowest’ class . isotigs that matched no white spruce unigene were classified into the ‘unknown’ confidence class .

for the i <dig> isotigs , the two largest classes were the ‘unknown’ and the ‘highest’ confidence classes, each of which contained ~28% of the  <dig>  i <dig> isotigs. for the im isotigs , the largest classes were the ‘lowest’ and the ‘medium’ confidence classes, each of which contained ~35% of the  <dig>  im isotigs. overall, these rankings reflect our assumption that overlapping isotigs might be more common among sequences that are incorrectly assembled. these confidence classes were used to prioritize snps for the genotyping array, and could also be used to prioritize isotigs for other uses. we subsequently conducted an identical analysis using  <dig>  loblolly pine contigs as the reference, and found nearly the same distribution of isotigs among the confidence classes. across both analyses, we found a total of  <dig> no-hit isotigs—that is, isotigs that did not match any spruce or pine contig. this compares to a total of  <dig> no-hit isotigs for the spruce analysis, and  <dig> no-hit isotigs for pine. these  <dig> isotigs deserve attention because they probably represent unique douglas-fir genes or mis-assembled sequences.

annotations
our second major objective was to annotate the reference transcriptome. we did this by comparing the isotigs and singletons to the uniref <dig> and tair <dig> protein databases at an e-value of 10- <dig> . for the i <dig> isotigs, tair <dig> and uniref <dig> matches were found for  <dig> % and  <dig> % of the isotigs, respectively. the percentages of matches for the im isotigs were considerably lower , mostly because we only counted matches when the best hit was identical for all isotigs in an isogroup. together, these analyses yielded matches for  <dig>   to  <dig>   isogroups. the matches for the singletons were much lower . this is expected because these sequences are much shorter and may contain a higher proportion of sequences derived from untranslated transcript regions  or contaminating genomic dna. based on the uniref <dig> analyses, most of the isogroup matches had best-hits to plant proteins . the modest number of isogroups with hits to conifers  compared to other plants  probably reflects the much smaller number of available conifer sequences. among the matched sequences, only  <dig> % of the isogroups and  <dig> % of the singletons had best hits corresponding to fungal, bacterial, or viral proteins. these could represent contaminating sequences that were not filtered prior to transcriptome assembly.

because the functions of some of the sequences in the uniref <dig> and tair <dig> databases are unknown, we also used the annot8r annotation tool to identify douglas-fir sequences that could be assigned a putative function. specifically, we used annot8r to query only those sequences in the embl uniprot database that are tagged with go  annotations  <cit> . these analyses found that  <dig>  isogroups could be assigned a putative function . if we assume that douglas-fir has about the same number of genes as white spruce , we have putative functional annotations for almost half of the douglas-fir genes . the go-annotations were distributed across a wide range of go slim categories, with no substantial differences among the different categories of isotigs or singletons . compared to douglas-fir, many more arabidopsis sequences fell into the “unknown cellular components” and “unknown molecular functions” classes, suggesting that these go slim classes contain arabidopsis genes that are more likely to be absent from douglas-fir or highly diverged . overall, our annotation results suggest that our reference transcriptome  represent a broad array of genes covering a substantial proportion of the douglas-fir transcriptome.

snp success
our final two objectives were to identify potential snps, and then test a subset of these using an infinium genotyping array. across both varieties of douglas-fir, we identified  <dig>  potential snps distributed across  <dig>  isogroups. we submitted  <dig> of these snps to illumina for construction of an infinium genotyping array. because bead types are normally lost during the manufacturing process, it was only possible to assay  <dig> snps  on the completed array . based on results from  <dig> douglas-fir trees, we identified  <dig> reliably scored polymorphic markers, resulting in a conversion rate of  <dig> % based on the snps submitted to illumina, and  <dig> % based on the number of successful snp assays . using slightly more liberal criteria , eckert et al.  <cit>  reported an overall infinium conversion rate of ~55% in loblolly pine using a combination of polyphred, polybayes, and a machine learning approach to detect snps from sanger resequencing data. however, using their best snp detection approach , the conversion rate was  <dig> %, which is the same as for our submitted snps, but lower than the conversion rate for the snps we actually assayed . these conversion rates are comparable to those reported for other tree species using the illumina goldengate genotyping platform, which ranged from  <dig> % to  <dig> % in white spruce, black spruce, loblolly pine, and apple  <cit> . in douglas-fir, the conversion rate for a 384-snp goldengate array was 59%  <cit> . however, higher conversion rates were reported in sunflower using the infinium platform [ <dig> %;  <cit> , and in barley, soybean, wheat, and maize, using the goldengate platform [~80-95%;  <cit> . compared to trees and other outcrossing species, inbred crops may have higher conversion rates because of lower genetic diversity  <cit> , resulting in fewer assay failures caused by variation in the primer target sequences.

our  <dig> successful snps had a median gc <dig> score of  <dig>  and a median call frequency of  <dig>  . because we filtered snps based on snp probabilities and other metrics that are positively associated with maf, our successful snps had high mafs  and heterozygosities . therefore, their polymorphic information content is probably much higher than that of randomly selected snps. selection of snps with high mafs also resulted in a very flat frequency distribution  and a moderately flat distribution for observed heterozygosity .

we also identified  <dig> snps  that deviated significantly from hwe based on a bonferroni-corrected p-value of  <dig> . in general, hwe deviations may result from genotyping errors, non-random mating, selection, mutation, gene flow/admixture, or relatedness among samples. however, for the snps with observed heterozygosities much greater than  <dig>  , we may also be detecting polymorphisms among nearly identical paralogs  <cit> . although deviations from hwe are often used to filter snps used in association studies, no consensus has emerged on the appropriate p-value to use  <cit> . however, probabilities of 10- <dig> to 10- <dig> are typically used to filter snps in genome-wide association studies  <cit> . we used the bonferroni correction because this approach was previously used to filter snps in association studies of douglas-fir and loblolly pine  <cit> , and because the unadjusted threshold of  <dig>  × 10- <dig> is consistent with other common practices  <cit> . if these  <dig> snps are not used in association genetic studies or other analyses, the number of non-filtered snps would be reduced to  <dig>  in loblolly pine,  <dig> %  snps deviated significantly from hwe using the infinium platform  <cit> .

we subsequently used logistic regression to test whether successful snps could be predicted from bioinformatic characteristics. although eight variables entered the prediction model, the model had little predictive power. this is not surprising because most of the assayed snps were highly selected based on these same variables, so the independent variables had little variation. compared to random selection from our pool of  <dig> snps, the prediction model only increased the probability of selecting successful snps from  <dig> % to  <dig> %. these results suggest that we could have relaxed our snp selection criteria with little effect on snp success―i.e., many more successful snps would have been identified had we developed and tested a much larger genotyping array.

we also used multiple linear regression to determine whether any of the five snp characteristics listed in table  <dig>  could be predicted from the across-dataset variables used for snp filtering. these predictor variables included  <dig> continuous and categorical variables reflecting snp frequencies, snp probabilities, numbers of covering reads, snp repeatabilities across datasets, illumina assay design scores, isotig characteristics, types of snp , and snp confidence classes. although all models were highly significant, the r <dig> values were all below 4%, except for maf and observed heterozygosity. for maf, ~20% of the variation was explained by three variables—mean snp frequency, mean snp probability, and isotig length. for observed heterozygosity, ~16% of the variation was explained by these three variables plus the mean number of covering reads.

a snp resource for genomic selection
one of our key long-term goals is to test whether genomic selection can be used to enhance douglas-fir breeding. genomic selection, or whole genome selection, is a type of marker-assisted selection that uses dense marker coverage to track alleles for most or all quantitative trait loci  in the genome  <cit> . if very large numbers of markers are used, most or all qtl will be in linkage disequilibrium with at least one marker, particularly in small populations. genomic selection involves two steps  <cit> . first, a genomic prediction model is developed using phenotypes and marker genotypes measured on a test or ‘training’ population. second, individuals are selected from a related population of selection candidates based on breeding values predicted from the marker genotypes alone.

the number of markers needed for accurate genomic selection varies widely, depending on the genome length , effective size of the breeding population , number of qtls, heritability, number of generations without model retraining, and other factors  <cit> . for example, a 50k snp chip has been used by dairy cattle breeders since  <dig>  and a 777k snp chip is now available that may be useful for making selections across-breeds  <cit> . in contrast, it may be possible to use many fewer markers in forest trees because small breeding populations can be used to increase linkage disequilibrium   <cit> . in a simulation study of genomic selection in forest trees, ~ <dig> markers per cm were sufficient to achieve the same accuracy as blup-based phenotypic selection when ne was ≤  <dig>  but as many as  <dig> markers per cm might be needed for an ne of  <dig>  <cit> . iwata et al.  <cit>  came to a similar conclusion in a simulation study of a generic conifer breeding program. they concluded that efficient genomic selection would be achieved in a small breeding population  using one marker per cm, and that accuracies could be increased by using greater marker densities. assuming a genome length of ~ <dig> cm for douglas-fir  <cit> , these values  are equivalent to about  <dig>  to  <dig>  snps. empirical results support the results of these simulation studies. in two small populations of eucalyptus , the accuracy of genomic selection equaled that of blup-based phenotypic selection using >  <dig> dart markers  <cit> . similar results were also observed in a loblolly pine population  using  <dig> snp markers  <cit> .

what is the size of our snp resource? if we multiply the number of potential snps by our snp conversion rate , we obtain an estimate of  <dig>  true snps. however, if we had tested all  <dig>  snps on the genotyping array , the snp conversion rate may be lower. in contrast, the number of potential snps would have been much larger had we used a snp probability threshold of 10- <dig>  or even 10- <dig> , but the snp conversion rate may have been lower as well. balancing these factors, a reasonable estimate for the number of true snps is ~ <dig> . second, what is the number of snps that can be genotyped using an infinium ii assay? this can be judged by the number of acceptable design scores. for example, using a snp probability of 10- <dig>  and a probability of flanking variants  of 10- <dig>  we obtained  <dig>  snps with design scores ≥  <dig> . again, assuming a  <dig> % conversion rate, the number of successfully genotyped snps is estimated to be  <dig> . we also tested the effects of using the same snp probability , but with lower flanking probabilities . using a pf value of 10- <dig>  for example, the number of snps with an acceptable design score was  <dig>  , and the number of successfully genotyped snps is estimated to be  <dig> . although snp conversion rates may differ among these scenarios, our snp resource seems more than sufficient to pursue genomic selection in douglas-fir.

although we identified  <dig>  potential snps, they are not distributed uniformly across the genome, which would be optimal for genomic selection. therefore, it would be better to use the number of isogroups with snps  to judge the effectiveness of our snp resource for genomic selection. however, the large number of snps we detected means that it should be possible to genotype nearly all of these loci. furthermore, if much of the genetic variance of interest is explained by variants in or near transcribed genes, then these markers may be more efficient than randomly distributed markers. approaches for increasing the number of loci with snps could involve mapping more reads to our reference transcriptome , increasing the coverage of our reference transcriptome , and relying on genomic sequencing to develop additional markers in non-transcribed regions.

CONCLUSIONS
we conclude that our current dataset of  <dig>  potential snps will translate into as many as ~ <dig>  true snps, and as many as ~ <dig>  snps that could be genotyped at ~ <dig>  gene loci using an infinium ii array. furthermore, we already have enough validated snp markers  to conduct realistic tests of genomic selection on small breeding populations of douglas-fir. assuming a density of  <dig>  markers per cm , we should be able to practice effective genomic selection in populations up to ~ <dig> ne <cit> . however, because current breeding populations now average about  <dig> ne , we will either need more markers to practice genomic selection, or genomic selection will need to focus on smaller populations . ultimately, our reference transcriptome and snp resource will enhance douglas-fir breeding and allow us to better understand landscape-scale patterns of genetic variation and potential responses to climate change.

