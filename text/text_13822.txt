BACKGROUND
the success of obligate endosymbiotic organisms depends on their ability to invade, establish and persist in their host. wolbachia pipientis, a well-studied endosymbiont, is a species of maternally inherited bacteria in the order rickettsiales, and infections are estimated to occur in more than half of all insect species  <cit> . prior studies have demonstrated the ability of wolbachia to manipulate the reproduction of its host  <cit> ; several phenotypes have been described, including male-killing  <cit> , feminization  <cit> , parthenogenesis  <cit> , and cytoplasmic incompatibility   <cit> . ci affects a broad range of insect taxa and causes a reduction in egg hatch when wolbachia-uninfected females and wolbachia-infected males mate .

prior models highlight three wolbachia-specific parameters that affect the probability of wolbachia invasion and establishment: the maternal inheritance rate, which is the proportion of infected offspring produced by an infected female; the level of ci, which is the proportion of embryos that fail to develop as a result of incompatible crosses  <cit> ; and the fitness cost to females for carrying a wolbachia infection, defined as a decrease in overall fecundity  <cit> .

previous studies predict that the successful invasion of wolbachia into an uninfected host population requires low fecundity costs, high maternal inheritance rates, and high levels of ci  <cit> . wolbachia infections that impose a 10% relative fecundity cost to adult females experience reductions in their invasion success  <cit> . similarly, low maternal inheritance reduces the probability of wolbachia invasion  <cit> . higher initial wolbachia infection frequencies are predicted to increase the probability of population replacement, which can offset the above costs  <cit> . models have also addressed population structure at the adult stage, impacts on adult survival, stochastic effects, and overlapping generations  <cit> .

the relative importance of wolbachia effects on immature life stages has not been assessed theoretically. this is despite multiple examples demonstrating an effect of wolbachia on immature hosts. in the stored product pest liposcelis tricolor , wolbachia infections can decrease development periods and increase survivorship in some immature life stages  <cit> . other studies demonstrate negative impacts of wolbachia infections on larval survival and development time  <cit> . recent studies have determined that when intraspecific competition is intense, wolbachia-infected mosquito larvae experience reduced survival  <cit> .

to better understand population replacement by ci-inducing wolbachia, we have evaluated both wolbachia infection dynamics and host population dynamics using a model that includes deterministic immature and adult male lifestages and a stochastic adult female lifestage. since wolbachia are transmitted maternally, the sex and infection status of hosts are explicit, and adult females are tracked individually. the focus of this modeling approach was to investigate changes in the probability of population replacement resulting from varying the relative larval viability , expressed as relative survival of infected to uninfected larvae. the results are presented in context with traditional parameters: the rate of ci, maternal inheritance , the relative fecundity of infected females , and the initial wolbachia infection frequency , on the probability of population replacement.

methods
the model simulates a panmictic population that is closed to immigrants and emigrants. consistent with previous studies, the model assumes mating is random and that wolbachia infection has no effect on mating success. females in the model mate once immediately upon reaching maturity. adult survival is density-independent, but larval survival is density-dependent. the model presented here combines a stochastic adult female stage with deterministic adult male and immature stages. by implementing a deterministic immature stage, additional information regarding population dynamics is incorporated without developing a completely stochastic model, which would be considerably more computationally-intensive. the model incorporates overlapping generations  <cit>  while tracking major life stages and considers females and males separately. development time and survival during immature stages are addressed explicitly by the model. the model was designed assuming the host is a holometabolous insect, and the model was parameterized based upon estimates of mosquitoes in the genus aedes as a case study.

brief description of equations
the following is a brief overview of all equations and parameters implemented in the model presented here. additional development details, initial parameter values, and sensitivity analysis are provided in additional file  <dig> 

  r=Δte-qb+hΔts 

larval development rate r : j is the maximum development rate , h is the asymptotic minimum development rate , Δt is the time step , q is the density-dependent development coefficient -1), b is the total larval biomass  and s is the total number of developmental stages. derived from gavotte et al.  <cit>  and comparable to previously published data  <cit> .

  sl=e-Δt 

larval survival, sl: μ is the baseline mortality rate of mosquito larvae in the absence of competition -1). α is the coefficient controlling density dependent mortality -1). b is the total larval biomass , β is the exponent controlling density dependent mortality , γ is the coefficient that decreases mortality as development stage increases -1), d is the developmental stage index, ε is the exponent that decreases mortality as development stage increases , and Δt which is the time step . based on dye  <cit>  and similar to previously published studies  <cit> .

  m=mxek1+1-ccto-tto 

mosquito body mass, m : mx  is the theoretical maximum mass of a given mosquito at time t. mx is linked to c , which is the percent of mx that is attainable. k  is the growth coefficient; t <dig>  is the development time at which mass at pupation is mx/ <dig> days, and t  is development time. d  represents the total number of development stages completed by the larval cohort. derived from previously published data  <cit> .

  fs=e-ga 

female survivorship, fs: g is the per capita mortality rate of adult females -1) and a is the current age of the female . taken from trpis and hausermann  <cit> .

  e=uΔtevz 

egg production, e: u is the egg production rate; Δt is the time step ; v is the female mass coefficient -1); mf is the body mass of the ovipositing female ; w is the female mass intercept , and z is the female mass exponent . derived by combining two previously published functions  <cit> .

immature life stages
to simulate variation in egg hatch, the model assumes that some eggs  hatch on day three while the remaining eggs  hatch on day four   <cit> . eggs are separated into two cohorts based on infection status. larvae are distributed into four categories for each of the possible combinations of sex and infection status.

larvae develop through discrete developmental stages, where the development rate is affected by density dependence, and larval survival is subject to both stage-dependent mortality and density-dependence . the term "stage" is defined here as a measure of progress through larval development. the number of these discrete developmental stages is chosen to allow for variation in development time and is otherwise arbitrary . the number of larval developmental stages, s, can be varied, but was set to s =  <dig> for this study. larval development rate, r, is the number of developmental stages through which a cohort of larvae will pass within  <dig> hours . the number of larvae surviving to the next day is the product of the number of larvae in the preceding time period and the larval survival rate . when the number of developmental stages within a day is not an integer, the larval cohort is distributed into two adjacent developmental stages in proportions that preserve the average development rate. the latter also introduces variation into the development rates of larval cohorts . density-dependence is based on the total mass of larvae . male and female cohorts are considered separately to observe sex-specific patterns during development. for example, female mosquitoes require longer development time to become adults relative to males, and studies demonstrate that males and females respond to competition intensities differently  <cit> .

uninfected larval cohorts progress through development subject to stage-dependent mortality and density dependent effects only. infected larval cohorts are subject also to a reduction in viability associated with wolbachia infection. the relative larval viability  for infected larvae is a proportion that indicates the relative survival of infected to uninfected larvae.

in all subsequent model runs, each value remains constant while one key parameter is varied. 

following the completion of larval development stages, individuals become non-feeding pupae, which have a daily survival that is independent of population density . after completing pupal development, emerging male adults are tracked separately as either infected or uninfected cohorts. emerging female adults are tracked as individuals.

adult life stages
six variables are tracked over time and determine the state of individual females: the blood meal state , age , wolbachia infection status , the wolbachia infection status of her mate , size , and reproductive state .

the probability that a female obtains a blood meal is determined by the frequency of potential blood meals per unit area, and each blood meal is associated with an additional mortality risk, regardless of mosquito age . in the panmictic population simulated here, the availability of potential blood meals is assumed to be constant, but the model will allow downstream population structuring and geographic variation of bloodmeal availability.

adult female daily survivorship fs is age-dependent and probabilistic   <cit> . a female that is wolbachia uninfected and mated with an infected male will lay eggs, but a proportion of the eggs will not hatch, depending on the level of ci . infected females produce viable offspring regardless of their mate's infection status but are subject to a decrease in relative fecundity . the number of eggs laid by an individual female is determined by her mass , and larval development influences female body mass. specifically, intense competition delays development and reduces the mass of adult females.

adult males, which are dead end hosts for wolbachia, are not tracked individually but are tracked as infected and uninfected cohorts. the male mortality rate is assumed to be age-independent and constant . the proportion of wolbachia infected males in the population determines the probability of an incompatible mating for uninfected females.

simulations
the model was written in matlab  <dig> . a single simulation of the model produced population dynamics that are tracked over time . a series of simulations  were used to assess the impact of incremental parameter changes on the probability of population replacement. the parameters emphasized were cytoplasmic incompatibility ; maternal inheritance ; the relative fecundity of adult females ; the initial wolbachia infection frequency, expressed as a proportion of the total number of adults , and the relative larval viability . a population replacement event is defined as having occurred when the proportion of infected adults stabilizes above or equal to the mi value. during each series of simulations, individual parameters were varied singly, while the remaining parameter values were held constant as defined in table  <dig>  each parameter was uniformly varied at one one-hundredth intervals from zero to one. at each interval,  <dig> simulations were conducted, and the number of successful invasions was recorded to determine the probability of population replacement at that specific parameter value. the uniform sensitivity analysis was implemented for direct comparisons between all parameters across all intervals. furthermore, previous analyses have not established minimum values for the spread of wolbachia. additional simulations tested two-way interactions between each of the emphasized parameters by varying two parameters simultaneously and evaluating the probability of population replacement. in the aforementioned simulations, parameters were varied uniformly. one parameter would be held constant while the other parameter varied as described above. the first parameter would then be incremented and the process above would be repeated. the probabilities resulting from two-way interactions were approximately the product of the two parameters and are not discussed further.

RESULTS
due to the stochastic nature of the model, the number of individuals within each lifestage fluctuates considerably over time . to examine for temporal patterns in the fluctuations that might correspond to periodic signals such as stage durations or generation time, we performed a spectral analysis on the time series data for both total adult and larval populations via fast fourier transformation  <cit> . the analysis can identify temporal patterns that exist in what appear to be chaotic time series. no pattern was detected by the spectral analysis. since no period was found, stochasticity appears to be the sole driver of population fluctuations.

five parameters associated with wolbachia infection were evaluated for their affect on the probability of population replacement. the value of each parameter was varied at one one-hundredth increments, from zero to one, while additional parameters were held constant as defined in table  <dig>  for each parameter value, the probability of population replacement was determined by the number of successful replacement events occurring in  <dig> simulations, for a total of  <dig>  simulations per parameter.

maternal inheritance , the relative fecundity of adult females , and relative larval viability , exhibit strong threshold behavior with population replacement occurring only at parameter values exceeding  <dig>  . specifically, realistic probabilities of population replacement  require the magnitude of mi to be greater than  <dig> . similarly, rf must exceed  <dig>  before realistic probabilities of population replacement are attained. the probability of population replacement is most sensitive to rlv, which requires a value of greater than  <dig>  before population replacement can occur. furthermore, realistic probabilities of population replacement only occur at high rlv , despite high maternal inheritance and ci .

a different functional relationship is observed with the level of incompatibility  and initial wolbachia infection frequency , each of which results in response curves that increase asymptotically . assuming the parameters within table  <dig>  the model predicts that ci is not necessary for wolbachia to spread . realistic probabilities of population replacement occur when ci approaches  <dig> . despite perfect ci , population replacement did not occur in 10% of simulations . additional simulations confirmed that a 90% probability of population replacement is an absolute maximum given the conditions defined here . however, as the magnitude of if increases, the probability of population replacement rapidly approaches one, with realistic probabilities of population replacement occurring when the frequency of infected females approaches 20% .

the results obtained from the model here were compared to a previously published stochastic model  <cit> . table  <dig> compares the fixation probabilities calculated by the model presented here and those from jansen et al.  <cit>  using the conditions defined in the prior report, which includes the introduction of a single infected female into a population size of  <dig> and perfect ci. to allow direct comparison, the relative larval viability in our model was set to one.  <dig>  simulations were performed for each combination of parameter values used in the prior publication. both models predict the probability of population replacement decreases when mi and rf values are less than one . generally, our model predicted lower probabilities of population replacement than the previously published model. however, when either mi or rf was 80%, the model presented here reported higher probabilities . jansen et al.  <cit>  predicted that wolbachia infections with imperfect maternal inheritance and low adult fitness costs  will still invade and establish in a population, but our model predicted no population replacement events . the predictions of our model were also compared to those of jansen et al.  <cit>  assuming larger initial frequencies of wolbachia infected individuals . both models predict an asymptotic increase in the probability of population replacement with increasing magnitude of if, but our model predicts lower probabilities of population replacement .

the probability of population replacement for given parameter values, assuming perfect ci and the release of a single infected adult female into an uninfected population with a size of  <dig>  the fixation probabilities from our model are generally lower than the values predicted by jansen et al. <cit> , except when maternal inheritance and the relative fecundity of infected adults is  <dig> . the model presented here predicted population replacement would not occur when both maternal inheritance and the relative fecundity of infected adult females were  <dig> . all probabilities generated from the model presented here reflect the proportion of population replacement events that occurred per  <dig>  simulations of the model. comparable values were estimated from figure  <dig> in jansen et al.  <cit> .

discussion
the model presented here examines the probabilities of wolbachia invasion into an isolated uninfected population. the model is unique in its individual-based representation of variation in key traits among adult females and in the resolution of larval dynamics within the host population. the model presented here predicts, as in previous modeling studies, that maternal inheritance  and the relative fecundity of adult females  are key parameters that determine the potential for population replacement. specifically, population replacement occurs only at high mi or rf. in contrast, population replacement can occur at low ci or low if. the simulation of adult females as individuals demonstrates that mi requires higher parameter values than rf for successful population replacement. the new parameter, relative larval viability , like mi and rf, requires high parameter values before population replacement can occur.

the relative larval viability between wolbachia infected and uninfected individuals  is the most important determinant of population replacement, requiring the highest parameter values for invasion. the model predicts that reductions in infected larval survival can substantially reduce the probability of population replacement . while a majority of prior studies have examined for an effect in adults, recent studies have determined that, at high levels of intraspecific competition, wolbachia infected larvae experience reduced survival  <cit> . however, few theoretical studies have examined the impact of immature lifestages on the invasion of wolbachia. here, we demonstrate that reductions in rlv will inhibit wolbachia invasion into an uninfected host population.

recent work has highlighted the prevalence of wolbachia, and its ability to invade populations  <cit> . studies have suggested that wolbachia infection affects larval survival and development only when intraspecific competition is high  <cit> . given the predictions from our model, wolbachia can only invade a population when rlv is very high. therefore, the density of conspecifics in larval habitats is predicted to have significant impacts on the probability of population replacement. similarly, the abundance and variety of larval habitats may have significant impact on the invasion of wolbachia. the distribution, utilization and variety of larval habitats is well known for some insects, particularly mosquitoes  <cit> . theoretical studies considering the effect of metapopulation structure and larval rearing conditions may elucidate the mechanism by which wolbachia can invade natural populations given low initial infection frequencies.

the level of ci in insects varies widely  <cit> . our model shows that the intensity of ci has relatively little effect on the probability of population replacement when the rate of ci exceeds 60%. furthermore, when ci =  <dig>  the model presented here predicts population replacement can occur at low probabilities . some wolbachia infections do not cause ci, but are found at high frequencies in natural populations  <cit> . previous theoretical studies indicate that ci or a sex-ratio distorter is not required for population replacement when endosymbionts can alter female traits  <cit> . however, results presented here suggest that non-ci inducing wolbachia infections can establish and persist in a population without increasing or altering host fitness, given high mi, rf, and rlv. since the population considered by the model presented here is relatively small , genetic drift could perhaps influence the probability of population replacement  <cit> . to investigate the importance of genetic drift, the population size in the model was increased. in model simulations where the total adult population size is greater than approximately  <dig>  population replacement does not occur when there is no effect of ci . however, when population size is increased, the general response patterns in figure  <dig> are not altered.

high maternal inheritance rates have been observed consistently in natural populations  <cit> . furthermore, theoretical studies predict the probability of population replacement declines as maternal inheritance decreases  <cit> . similar to previous studies, results presented here suggest that maternal inheritance  must be high for a wolbachia infection to invade an uninfected population and persist. specifically, mi must be higher than 90% to attain a realistic probability of population replacement.

the effect of wolbachia infections on adult female fitness has been well documented empirically and theoretically  <cit> . here, as in previous theoretical studies, the model predicts that the relative fecundity of adult females  must be high to facilitate population replacement.

for all parameters, the probability of population replacement approached an absolute maximum of 90% given the conditions defined in table  <dig>  here, the initially examined if value is relatively high , analogous to artificial introductions examined in prior theoretical work  <cit> . subsequently, lower if values have been simulated , including the introduction of a single, infected female . the model predicts that wolbachia invasion can occur at the lowest if values and demonstrates an increasing probability of invasion with the higher introduction levels, with the probability of population replacement approaching 100%. additional simulations determined that when if is held constant and the total adult population size is increased, the probability of population replacement approaches one given the conditions defined in table  <dig>  this result suggests genetic drift can affect the probability of population replacement in small populations and may facilitate or hinder the spread of wolbachia from low initial frequencies  <cit> .

the model presented here predicted lower population replacement probabilities than those predicted by previous stochastic models   <cit> . rasgon and scott  <cit>  noted a similar behavior where implementing population age-structure and overlapping generations increased deterministic thresholds. the inclusion of additional life stages and stage-structure in this stochastic model may explain the reduced probabilities of population replacement. however, the model presented here predicted marginally higher probabilities of population replacement when either maternal inheritance or the relative fecundity of infected females had a magnitude of  <dig> . the increased probability of population replacement predicted by the model presented here is likely a result of the individual-based representation of the adult female life stage that includes stochastic survival.

the model here addresses a single, panmictic, isolated population but could be expanded to include metapopulation structure. if introduction events can be assumed to occur randomly, then the surrounding subpopulations should generally tend to inhibit population replacement, because migration between subpopulations would dilute the proportion of infected individuals. however, as demonstrated here, genetic drift may influence the invasion of wolbachia in smaller subpopulations. the spatial spread of wolbachia has been assessed analytically by others and defines the conditions needed for wolbachia to spread through space  <cit> .

the majority of models that address the invasion of wolbachia into uninfected populations have examined populations without lifestage subdivisions, suggesting that additional empirical studies focused on understanding larval dynamics are needed  <cit> . many of the parameters defined here may be difficult to determine in natural populations  <cit> , but our results demonstrate the importance of understanding the role of life history parameters and their interactions, despite the difficulties. furthermore, the sensitivity analysis of the model presented here demonstrates that the magnitudes of particular parameters strongly influence the potential for spread and establishment of wolbachia; these  should be the focus of future empirical and theoretical studies. future theoretical studies could further address parameter sensitivity by hyper-cube sampling, but this would require information about the distribution of parameters to investigated  <cit> .

CONCLUSIONS
wolbachia is currently being utilized as the basis for a gene drive strategy in open field releases of aedes aegypti  <cit> ; however, the predictions of the model presented here suggest that minute reductions in rlv can inhibit population replacement. research needs to focus on understanding the effects of novel wolbachia infections on immature lifestages. xi et al.  <cit>  demonstrated that novel wolbachia infections can establish in a new host species and replace an uninfected population, but the initial frequency of wolbachia infected individuals needed to replace the population was higher than predicted. the authors suggested that differences in survival of immature lifestages could explain their results. results presented here indicate that even reductions in rlv that are difficult to detect empirically will substantially reduce the probability of population replacement.

the rapid decline in the probability of population replacement associated with reduced larval viability indicates that empirical studies directed toward quantifying the effects of endosymbionts on immature insects are important for understanding and predicting wolbachia invasion events. recent empirical studies also suggest that a more complete understanding of the effects of wolbachia on the immature life stages is generally needed through additional empirical and theoretical studies  <cit> .

authors' contributions
the original model was conceptualized by prc, jwm and es in a class taught by phc. the model was revised by yh, phc, and sld. jwm and es parameterized equations, which were derived by phc. prc coded the model and simulations in matlab, which was later optimized by prc, phc, and yh. the manuscript was written by prc, phc, and sld. all authors have read and approved the final manuscript.

supplementary material
additional file 1
model parameters, detailed equation appendix and sensitivity analysis. portable document file  containing all parameters, initial parameter values, and equations utilized by the model. model development is discussed, and includes references from which each equation was developed/parameterized. also includes the sensitivity analysis of all population dynamic parameters and discussion about the robustness of model predictions

click here for file

 acknowledgements
the authors would like to thank michael turelli and peter hammerstein for comments and suggestions on this project. this research was supported by grants from the national institutes of health  and the bill and melinda gates foundation . this is publication 11-08- <dig> of the university of kentucky agricultural experiment station.
