BACKGROUND
one of the most important problems in systematic biology is phylogenetic tree reconstruction. the use of phylogenetic trees is a fundamental step in many biological problems, such as the inference of evolutionary relationships among genes, genomes and organisms, protein structure and function prediction, and drug design  <cit> .

because of the importance of phylogeny reconstruction, many different reconstruction techniques have been developed. one of the most popular and widely used techniques is maximum parsimony  <cit> . the basic idea behind maximum parsimony is to find a most parsimonious phylogenetic tree; that is, a tree that requires the fewest mutations to explain the observed sequences. one drawback of maximum parsimony is its computational complexity. finding a most parsimonious tree is an np-hard problem  <cit> , which means that it is unlikely any algorithm can find a most parsimonious tree quickly for all possible input sequences. one of the best implementations of maximum parsimony is that of  <cit>  which can handle roughly  <dig> taxa.

evaluating how well maximum parsimony or any other technique reconstructs phylogenies is a difficult problem. several different evaluation methodologies have been proposed  <cit>  including computer simulation  <cit>  and experiments with organisms with known phylogenies  <cit> . unfortunately, each of these techniques is handicapped by at least one of the following drawbacks. the true phylogeny is not known. the simulated taxa have no meaning and do not contain genes. the simulated taxa have been generated by simplifying the evolutionary processes to ignore important mechanisms such as natural selection. there is limited data from which to draw statistically robust conclusions about the relative performance of algorithms. the result is that existing evaluation methodologies have left us incapable of answering several fundamental questions about phylogeny reconstruction. what is the effect of natural selection on the performance of a phylogeny reconstruction technique such as maximum parsimony? what is the effect of using the wrong character substitution model on the performance of a phylogeny reconstruction technique such as maximum parsimony? what is the effect of using the wrong mutation location model on the performance of a phylogeny reconstruction model such as maximum parsimony?

for example, consider the evaluation method of generating synthetic data using computer simulation techniques  <cit> . this method has many advantages including that the true phylogeny is known and large amounts of data can be generated rapidly. to generate synthetic data using a computer simulated evolutionary process, the researcher typically specifies four model components: a tree topology, a character substitution model, a mutation location model, and a probability distribution for the ancestral root sequence. a specific ancestral sequence is generated from the probability distribution, and the simulation mutates the sequence down the given tree topology according to the given substitution and mutation location models until a sequence has been generated for each leaf of the tree. two programs commonly used to generate sequences according to a given tree and substitution model are seq-gen and pseq-gen  <cit> . the character substitution model is used to simulate varying probabilities of accepted mutations. in natural sequences, the probability of mutating from one character to another and having this mutation be accepted depends on the specific characters involved. several different amino acid and nucleotide substitution models have been developed to partially account for the effects of biochemistry and natural selection  <cit> . the mutation location model is used to simulate among site rate variation . in natural sequences, different sites undergo substitutions at different rates; that is, the mutation location model is not uniform. for example, portions of the genome that correspond to binding or catalytic sites of protein sequences will experience fewer mutations than the non-coding portions of the genome. asrv affects estimation of distances between sequences, transition rate bias and phylogeny reconstruction. several different asrv models have been proposed  <cit> . usually a mathematical distribution, such as a gamma distribution, is used to model asrv.

the key drawback of computer simulations is that despite the use of sophisticated models, the taxa are not collected from a natural evolutionary process. instead, the taxa are simply random sequences of characters that have no meaning and do not include actual genes or functional components. thus, no sequence can be "more fit" than another sequence, and the taxa are determined solely by mutation and drift but not natural selection. therefore, computer simulation techniques cannot be used to assess the effect of natural selection on the performance of maximum parsimony.

working with natural data with known phylogenies partially overcomes the limitations of computer simulation  <cit> . however, even these data suffer from important limitations. first and foremost, the number of known phylogenies is relatively small. furthermore, in experimental phylogenies, the mutation rates typically are manipulated to increase divergence with the potential side effect of overemphasizing genetic drift as compared to natural selection. finally, while the major phylogenetic relationships will be known, there is a limit to the amount of data available to the researcher. in computer simulations, for example, all mutation events can be recorded at a level of detail impossible with real biological organisms. thus, we are still incapable of answering many questions about the effect of natural selection on reconstruction accuracy.

in this work, we study exactly this question. what is the effect of natural selection on the performance of a reconstruction technique such as maximum parsimony? does it improve or hinder reconstruction accuracy? furthermore, assuming that natural selection does influence reconstruction accuracy, how does it affect reconstruction accuracy? more specifically, we know that natural selection creates both asrv and non-uniform character substitution. what is the relative importance of asrv and non-uniform character substitution on reconstruction accuracy?

the avida digital evolution research platform
we study these questions using the avida digital evolution research platform  <cit>  to generate a collection of sequences that experience true darwinian evolution from which we can attempt to reconstruct a phylogeny. in avida, each sequence represents a self-replicating computer program. like computer simulations, all information including the phylogeny of the sequences can be perfectly recorded. however, the avida populations do not simulate evolution; they evolve subject to mutation, drift, and selection. we describe below how mutation and selection arise.

when a digital organism replicates, it copies its genome, one instruction at a time, into empty memory. mutations arise due to a faulty copy command. when an instruction is copied, there is a small probability that it will be copied incorrectly. this probability or mutation rate is an experimental parameter set by the researcher. typically, when a mutation occurs, an incorrect instruction is chosen uniformly at random from the remaining instructions, though we do consider other probability distributions as well.

space is limited in an avida population and death occurs when organisms are removed  to make room for new offspring. the fitness of an organism is essentially its replication speed. one way for an organism to increase its fitness is for it to replicate using fewer instructions. an alternative is to perform specific boolean logic tasks  that are specified in the researcher-defined digital environment that give the organism extra energy that allows the organism to execute instructions more rapidly. for example, if nor is a rewarded task, organisms can obtain extra energy by reading in two vectors of binary digits, performing nor on each corresponding pair of bits in the two inputs, and outputting the resulting bit vector. there are many different ways to perform nor and rarely, if ever, will evolution find identical solutions in replicate runs.

the avida system and natural selection
a concern that we are faced with in using avida as a data source for phylogeny reconstruction studies is the same credibility gap that computer simulation studies face. specifically, how similar is data from avida experiments to data found in the natural world?

we first emphasize that avida is a widely used platform for studying evolution. several dozen peer reviewed papers have been published based on avida experimental data including several in nature, science, and the proceedings of the national academy of sciences  <cit> .

biological communities have accepted avida experimental data because populations of digital organisms undergo true darwinian evolution where individuals have genomes that are expressed into phenotypes. avida experiments do not simulate any specific biological process or system. instead, avida organisms are computer programs with actual meanings and fitness values. thus, avida organisms do evolve subject to natural selection.

for example, avida organisms are highly contingent on previous events. ofria and others have shown that complex traits can evolve in avida  <cit>  if simpler traits are rewarded by using the genetic code that performs the simpler traits as building blocks. on the other hand, sometimes the use of a particular gene in one way will constrain further evolution in other directions. a specific case of this is that the replication of an organism's genome can become over-optimized relying on that genome to be a specific length, thereby constraining all other genes to exist within a fixed number of instructions and thus limiting their evolution. wagenaar and adami showed that chance events are required to open gateways that allow further adaptation  <cit> . thus, avida experiments show wide variation in the paths taken by evolution with replicate runs rarely finding the same solution. epistasis also occurs in avida  <cit>  and the dynamics were essentially identical to those found in long term e. coli experiments  <cit> .

it is true that avida data does have some limitations. the genome length of an avida organism in our experiments is  <dig> . this implies that the genome of a typical avida organism is less complex than that of most biological organisms, but is certainly comparable to that of short genes. thus, avida phylogenies can most easily be compared to gene phylogenies of biological organisms. while we could increase the length of the avida organisms, it is not clear this increase would be meaningful. the information density of the longer organisms would be less than that of the length  <dig> organisms if both organisms perform the same set of tasks.

another potential limitation is that avida's basic life chemistry is distinct from that of natural organisms. however, while the specific chemistry may be different, we can still compare phylogeny reconstruction with and without natural selection to derive general principles about natural selection's effect on phylogeny reconstruction that should apply to any evolving system. any such general principles should be robust across most biological systems.

we have previously used avida to analyze the effect of natural selection on the performance of maximum parsimony and neighbor joining  <cit> . in  <cit> , we demonstrated that maximum parsimony and neighbor joining could reconstruct  <dig> taxa phylogenies surprisingly well when all branches are extremely long and no significant functionality is being acquired through evolution. in  <cit> , we tested a wider range of branch lengths for  <dig> taxa tree topologies and showed that both maximum parsimony and neighbor joining can reconstruct data sets generated with natural selection more accurately than datasets generated without natural selection, particularly when the internal branch is long enough to allow the acquisition of a significant phenotypic trait. we also showed that incorporating a simplistic asrv model significantly enhanced the quality of the computer simulation data.

in this paper, we perform a more detailed analysis to determine how natural selection impacts the performance of maximum parsimony. we isolate specific conditions where the presence of natural selection significantly improves the reconstruction accuracy of maximum parsimony. we then illustrate how selective pressures cause changes in both asrv and instruction frequency . our results show that asrv and non-uniform character substitutions are not sufficient to capture the effects of natural selection on the performance of maximum parsimony. however, the computer simulation data produced by accurately simulating asrv is more similar to real, experimental data than the computer simulation data produced by accurately simulating character substitution probabilities. finally, we corroborate these results using pseq-gen data.

RESULTS
our experimental methodology consists of two components that are described more completely in our methods section. in brief, we generate symmetric  <dig> taxa topologies to be reconstructed as depicted in figure  <dig>  the internal branch length of this  <dig> taxa topology is the number of unique genotypes in the phylogeny from the intermediate ancestor y to the intermediate ancestor z, one of which is the ultimate ancestor x. the external branch length is the number of unique genotypes from either intermediate ancestor y or z to any of the  <dig> descendant children a, b, c, or d.

we generate sequences that evolve subject to natural selection using avida. we generate sequences that evolve without natural selection by using computer simulation techniques. within avida, we utilize different reward structures to vary the selective pressure. in a given reward structure, some set of tasks is rewarded along a given branch in the tree topology. the set of tasks rewarded might change from one branch to another.

conditions where natural selection improves reconstruction accuracy
we first determine if natural selection has any impact on the accuracy of maximum parsimony. our initial results show that there are conditions where natural selection can significantly improve the accuracy of maximum parsimony, corroborating results from our earlier papers  <cit> . for example, consider the data from figure  <dig>  mp's reconstruction accuracy is significantly higher given the avida data rather than the control data from computer simulation. in fact, mp can reconstruct  <dig> taxa trees with surprisingly large branch lengths.

we now isolate what conditions lead to natural selection improving mp's reconstruction accuracy. our first test is to vary the internal branch length of the tree. our results shown in figure  <dig> demonstrate that natural selection's impact increases as we increase the internal branch length. for example, when the internal branch length is only  <dig>  there is little difference between mp's accuracy on the two data sets. when the internal branch length increases to  <dig>  mp's superiority on avida data is even larger than when the internal branch length is  <dig>  the explanation is that there must be enough time for significant adaptation to occur.

we next experiment with selection strength to determine its impact on mp's reconstruction accuracy. our results shown in figure  <dig> demonstrate that natural selection's impact increases as we increase selection strength. for example, mp's reconstruction accuracy on data generated with a bonus for performing rewarded tasks that is 1/100th of the default bonus is essentially identical to mp's accuracy on computer simulation data. as we increase the bonus, mp's accuracy improves.

we next experiment by varying the reward structure. in our default overlapping reward structure, new tasks are rewarded in each branch of the tree topology. we test the importance of changing selective pressures on mp's performance by assessing mp's reconstruction accuracy on avida data generated where the same tasks are rewarded on all branches of the tree topology. our results shown in figure  <dig> demonstrate that changing selective pressures is critical; in particular, it is important that the intermediate ancestor incorporates a significant adaptation. when the same tasks are rewarded in all branches, most of the tasks are acquired by the original ancestor and thus no significant adaptations are incorporated into the intermediate ancestors.

we finally experiment by comparing the overlapping reward structure where some tasks are rewarded in consecutive branches in the tree topology with the non-overlapping reward structure where no task is rewarded in consecutive branches in the tree topology. our results shown in figure  <dig> demonstrate that mp's performance on both avida data sets is significantly better than mp's performance on the control data generated using computer simulation. it is interesting to note that mp performs better on the avida overlapping data set than the avida non-overlapping data set. we believe this improved performance is due to the selective pressure to maintain critical pieces of code that are rewarded in consecutive environments  as well as . that is, a significant adaptation that is acquired in an intermediate ancestor may be lost if the associated task is no longer rewarded in the final environment e <dig>  this is less likely to occur in the overlapping reward structure than the non-overlapping reward structure.

the effect of selective pressure on among site rate variation  and instruction frequency
our results clearly demonstrate that there are situations where natural selection improves mp's reconstruction accuracy. to help determine which factor, asrv or non-uniform accepted substitution probabilities, is the more influential byproduct of natural selection on the performance of maximum parsimony, we plot the asrv and instruction frequencies that result from a variety of selective pressures. we use instruction frequency as a proxy for accepted substitution percentage because instruction frequencies are easier to interpret given the  <dig> instructions in the avida instruction set. if we were to compare substitution percentages directly, that would require comparing  <dig> =  <dig> numbers while comparing instruction frequencies requires only  <dig> comparisons. our results indicate a stronger relationship between asrv and reward structure than between instruction frequencies and reward structures. this implies that asrv may be a more important factor than non-uniform character substitution. however, our results also indicate that asrv and non-uniform character substitutions cannot account for the entire effect of natural selection on the performance of maximum parsimony.

to assess the relationship between asrv and natural selection, we compare how the mutations are distributed by genomic position for  <dig> different selective pressures: avida with the overlapping reward structure, avida with the non-overlapping reward structure, avida with the no-task reward structure, and the control data set generated by computer simulation. for each selective pressure, we collect data from our experiments with internal branch length  <dig> and external branch length 600; we have  <dig> replicates for each selective pressure. for each data set, we compute the number of mutations that occur in each of the  <dig> positions from an intermediate ancestor  to a leaf taxa . since we have a total of  <dig> replicates with  <dig> lines of descent for each replicate and  <dig> genomic positions for each line of descent, there are a total of  <dig>  unique positions. due to the external branch length of  <dig>  the average number of mutations that each position will experience will be approximately 6; it is slightly higher because there is a small chance that more than one mutation may occur between a parent and a child. the mutation distribution data for our  <dig> data sets is depicted in figure  <dig> 

we see that for the control data set with no selective pressure, the plot of the number of positions that experience a given number of mutations is, as expected, a normal distribution centered close to  <dig>  likewise for the no-task reward structure data set, once the positions with  <dig> mutations are deleted, the plot of the number of positions that experience a given number of mutations is also normally distributed with the center close to  <dig>  this occurs because the main selective pressure in the no-task reward structure setting is to maintain the replication cycle. the instructions responsible for replication are the ones in positions with  <dig> mutations. on the other hand, in the non-overlapping and overlapping structure data sets, the plot of the number of positions that experience a given number of mutations is not a normal distribution but rather is close to uniform in the range from  <dig> mutation to  <dig> mutations with a significant tail for higher numbers of mutations. thus, significant changes in asrv do correlate with significant changes in mp's reconstruction accuracy. however, there is not a sharp difference in the mutation distribution plots for the overlapping and non-overlapping data sets. this suggests that asrv alone is not sufficient to explain the improved performance of maximum parsimony on the data generated in the overlapping reward structure compared to the data generated in the non-overlapping reward structure.

to assess the relationship between instruction frequency and selective pressure, we compare the instruction frequencies of the terminal taxa for the same set of  <dig> selective pressures. we use the same settings we did for the asrv data: internal branch length  <dig> and external branch length  <dig>  similar to the asrv data set, we have a total of  <dig>  instructions in the  <dig> terminal taxa for each of the  <dig> replicates. given that the instruction set size is  <dig>  the average instruction frequency should be  <dig> %. the instruction frequencies for the  <dig> data sets are plotted in figure  <dig> 

we see that for the control data set with no selective pressure, the instruction frequency distribution is essentially uniform at  <dig> %. however, the instruction frequencies for the three avida data sets that experience natural selection are clearly not uniform. the frequencies for instructions critical to replication such as h-copy, nop-a, nop-b, and nop-c are significantly above  <dig> % in all three avida data sets. the instruction frequencies for nand and io, both of which are critical for performing boolean logic tasks, are also significantly above  <dig> % in the overlapping and non-overlapping reward structure data sets where there is a selective pressure to perform boolean logic tasks.

when comparing the instruction frequencies, we see very little difference between the two from the overlapping and non-overlapping reward structures despite the significant difference in mp's reconstruction accuracy. furthermore, there is a significant difference between the no-task reward structure instruction frequencies and the control data instruction frequencies while mp reconstructs both data sets with essentially the same accuracy. this data suggests that while non-uniform instruction frequencies and non-uniform character substitutions are a significant result of natural selection, they may not explain why natural selection improves the performance of phylogeny reconstruction algorithms such as maximum parsimony in some cases.

the effect of among site rate variation  and non-uniform character substitutions on the performance of maximum parsimony
the previous data implied that asrv is more likely to have an effect on maximum parsimony's performance than non-uniform character substitutions. in order to study this question more carefully, we augment our computer simulation program in order to perfectly mimic either the location of mutations that occurred in an avida experiment or the substitutions that occurred in an avida experiment. when the computer simulation program mimics the locations of mutations, we define this as location simulation. when the computer simulation model mimics the substitutions that occur, we define this as substitution simulation. when using location simulation, the character substitutions are chosen at random. when using substitution simulation, the mutation location is chosen uniformly at random among available locations. note that in normal computer simulation, both mutation location and character substitution are chosen uniformly at random. we describe this in more detail in our methods section.

furthermore, in order to exaggerate the influence of the character substitution process, we augment the default avida character substitution process that is uniform with two new character substitution processes, f and l, in which some substitutions are more likely to occur than others. note this effect is distinct from that of natural selection in which case some mutations are more likely to be accepted than others. we provide more details on the f and l character substitution processes in our methods. as the data depicted in figure  <dig> shows, using these biased character substitution processes does lead to instruction frequencies that are more divergent from uniform.

as figure  <dig> shows, mp's performance on the substitution simulation data is essentially identical to its performance on the control data and is much worse than its performance on the avida data. this is true even when we use the biased f and l character substitution processes. these results suggest that even though natural selection has a significant impact on character substitution probabilities, non-uniform character substitutions do not explain how natural selection improves maximum parsimony's improved reconstruction accuracy in some cases.

as figure  <dig> shows, mp's performance on the location simulation data is very similar to its performance on the avida data, even when the avida data is generated using the biased f and l character substitution processes. these results suggest that one reason natural selection improves the performance of maximum parsimony in some cases is its introduction of asrv.

an observation that is perhaps surprising is that mp actually performs better on the location simulation data than on the avida data. this can be explained by the fact that homoplasy is less likely with a uniform character substitution model than a non-uniform character substitution model. thus, in the genomic positions that experience high rates of change, more homoplasies are likely to occur in the actual avida sequences than in the location simulation model sequences.

to further test the impact of asrv and character substitution models on the performance of maximum parsimony, we performed comparable experiments using data from pseq-gen. for each of the four character substitution models , we generated  <dig> replicates using both α =  <dig>  which corresponds to significant asrv, and α =  <dig>  which corresponds to essentially no asrv. for each data set, we computed mp's performance.

as figures  <dig>   <dig>  and  <dig> show, none of the three character substitution models implemented in pseq-gen  has a significant effect on mp's reconstruction accuracy. more specifically, for either α value, mp's reconstruction accuracy is essentially identical using all four substitution models, including uniform. on the other hand, the α value and thus asrv has a significant effect on mp's reconstruction accuracy regardless of the substitution model used. these results validate our findings with avida data.

CONCLUSIONS
maximum parsimony may perform significantly better on actual biological data than is currently suggested by computer simulation studies due to the effects of natural selection. in sequences that evolve subject to natural selection and which experience a geographic separation, specific sites in the genome that perform critical functions become resistant to accepted mutations. as there are typically many distinct ways to perform a function, the solution derived by one population is likely to be different than the solution derived by the second population. the sites associated with these different solutions provide a signal that aids in the reconstruction of phylogenies. as this phenomenon is more strongly associated with locations rather than the specific substitutions that occur, asrv appears to have a stronger impact on phylogeny reconstruction than character substitution probabilities.

it is important to note, however, that natural selection led to improved reconstruction accuracy for maximum parsimony only when there were changes in rewarded tasks that led to intermediate ancestors acquiring significant adaptations. this would suggest that natural selection will only help in reconstructing phylogenies from taxa that diverged due to new selective pressures. the prevalence of this phenomenon in the natural history of our world will determine to some extent the significance of this finding.

it is also important to note that we performed all our experiments using symmetric tree topologies. maximum parsimony is known to perform poorly when the topologies are not symmetric  <cit> . it is a natural question to ask how the effects of natural selection interact with the issue of long branch attraction.

in future work, we plan to test whether our results and conclusions still hold when applied to larger phylogenies, to smaller character sets, or when our techniques are applied to tree reconstruction algorithms other than maximum parsimony. furthermore, we plan to evaluate how well maximum parsimony performs on asymmetric tree topologies.

