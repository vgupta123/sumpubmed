BACKGROUND
protein residue-residue contact prediction is a long standing and largely unsolved problem in structural bioinformatics with some of the earliest methods being developed nearly  <dig> years ago  <cit> . since then, the relevance and importance of the problem has grown due to the usefulness of predicted contact information. to date demonstrated uses of predicted protein residue-residue contact information include rational drug design  <cit> , protein model ranking and quality assessment  <cit>  and protein tertiary structure prediction  <cit> .

historically, the prediction of protein residue-residue contacts has been tied to the challenging problem of protein tertiary structure prediction. the use of residue-residue contacts allows the protein modelling problem to be reformulated as a classification task. in this reformulated setting, it is only necessary to determine which residues are in contact and then use the contacting residue pairs to generate protein structures from inferred distance restraints. in practice, however, it has proven difficult to generate protein structures from predicted contacts due to the relatively low accuracy of most residue-residue contact prediction methods. accuracies for the top, long range predicted residue-residue contacts are often in the range of 25-35%  <cit> . residue-residue contact predictions of this quality are too noisy for current reconstruction tools  <cit> .

a majority of the sequence based contact prediction approaches developed make use of machine learning. these methods attempt to learn a mathematical function which maps extracted features to a real valued number representing the predicted class . the features used as input to the function are values representing different characterizations of the protein's sequence which are believed to be relevant for the classification task at hand. a number of particular machine learning approaches have been used including neural networks  <cit> , support vector machine  <cit> , deep learning  <cit>  and random forest  <cit> .

some of the first methods developed attempted to identify residue-residue contacts using evolutionary information contained in multiple sequence alignments . this was done by locating residue-residue pairs which coevolved  <cit> . while fast and conceptually attractive, these methods typically did not perform very well due to difficulties in distinguishing true, coevolving residue pairs from transient relationships  and  are in contact and coevolve, it would appear that residues i and k also coevolved). newer techniques such as those used by evfold  <cit> and psicov  <cit>  are better able to distinguish true residue-residue contacts and generate rather accurate predictions provided that a large, diverse multiple sequence alignment can be formed for a query protein. these approaches have lead to a breakthrough in performance and reached levels were reconstruction from predicted contacts is possible. the drawback, however, is often these approaches are not applicable. this is because they require the construction of a large and diverse multiple sequence alignment which is not always possible, particularly in the case of hard protein modelling targets.

hard protein modelling targets are targets for which structural information  does not exist or is not detectable by a sequence based search. these types of targets are the most difficult to model and evaluate and are precisely the types of targets which could most benefit from residue-residue contact data. as a result, a residue-residue contact predictor is typically evaluated based on its performance on hard, or free modelling , targets. unfortunately, the reported performance of predicted residue-residue contacts on these types of hard targets is typically low, making it difficult to understand how predictions of this quality can be of practical use. thus, there is a need to further analyze the quality and value of predicted residue-residue contacts for hard targets and the methods used.

here we present a broad analysis of residue-residue contact predictors which participated in the tenth round of the critical assessment of protein structure predictions . in the analysis, we used both standard evaluation metrics such as those used by the casp assessors as well novel, non standard metrics . the additional evaluation metrics we use show a strong contact signal present in residue-residue contact predictions and help clarify a seeming contradiction between the usefulness of contact predictions and reported accuracies.

our method, dncon, performed well under all of the evaluation metrics employed and in particular, dncon was among the best contact predictors in terms of accuracy, accuracy in a neighbourhood and cluster count. given its performance in casp <dig>  we also present a study of the underlying architecture and features used in dncon. we found that dncon is particularly robust with respect to the number of layers used and number of nodes per layer in its underlying boosted, deep network architecture.

methods
every two years the current state-of-the-art in protein structure prediction methods is evaluated in the casp experiment. over a period of several months, protein sequences which do not have known experimentally determined structures are sent out for prediction. each participant in the residue-residue contact prediction category had approximately three days to score residue-residue pairs for contact and send their predictions back to the prediction center. the prediction center collects the results for each participant and makes them available to the public after the prediction season. in this assessment, the primary source of residue-residue contact predictions for the methods considered was the official casp <dig> website  <cit> .

in total more than  <dig> methods registered in the protein residue-residue prediction category. we limited our evaluation to those methods which made predictions for a vast majority of the casp <dig> targets and were, to the best of our knowledge, ab-initio in nature . these methods were chosen since results obtained would generalize to the hard  modelling targets as they do not directly make use of template information. the methods selected included two approaches based on random forests , an approach using a support vector machine , an approach using recursive neural networks , an approach using deep learning  and our approach dncon . descriptions for these methods as well as all of the methods that participated in casp <dig> can be found in the abstracts on the official casp <dig> website  <cit> .

dncon is a sequence based, ab-initio residue-residue contact predictor built upon a combination of boosting and deep networks . conceptually, each dn in the boosted ensemble is similar to a standard two layer neural network but has many more layer and trained in a step wise, semi-supervised fashion. the input features to each deep network stem primarily from two fixed width windows centred on the residue-residue pair to be classified. from the residues contained in these windows a number of features are encoded such as predicted secondary structure and solvent accessibility, primary sequence, sequence profile from a position specific scoring matrix  and various statistical characterizations of the residues . some global information about the protein such as sequence length and content was also used. more specifically, secondary structure and solvent accessibility values were predicted using sspro and accpro from the scratch suite  <cit> . to obtain the values for the pssm, psi-blast  <cit>  was run for three iterations against a non-redundant version of the nr sequence database filtered at 90%. for full details on feature generation and the construction and training of dncon, see eickholt and cheng  <cit> .

the primary dataset used in this benchmark is the casp <dig> dataset. it consists of  <dig> protein targets used in casp <dig> whose experimentally determined structures were available on the official casp website  <cit>  at the time of this study. we also considered a subset of these  <dig> proteins which we term the hard casp <dig> targets. these are  <dig> protein targets which contained at least one protein domain which was preliminarily classified as free modelling or free modelling/template based modelling according to the casp <dig> website  <cit> . for the additional analysis we performed on dncon with respect to architecture and feature selection, we used  <dig> valid protein targets from casp <dig> as the evaluation dataset. protein sequences and target structures were obtained from the official casp <dig> website  <cit> . training was performed using the dncon_train dataset, a collection of  <dig> proteins used to train dncon  <cit> .

two amino acid residues are said to be in contact if the distance between their respective cβ atoms  is less than  <dig> angstrom. this is a standard definition of protein residue-residue contact and has been used in a number of previous studies and official casp assessments  <cit> . residue-residue contacts are further classified as short, medium or long range contacts based on their separation in the protein sequence. short range contacts are defined as residue-residue contacts with a sequence separation of  <dig> to  <dig> residues, medium range contacts have a sequence separation from  <dig> to  <dig> residues and long range residue-residue contacts are those separated by  <dig> or more residues in sequence. this additional differentiation of residue-residue contacts is useful as the shorter range contacts tend to be easier to predict and less useful while longer range contacts present more of a challenge and contain more information about the overall conformation of a protein.

given the difficulty in predicting protein residue-residue contacts, methods are often evaluated by considering the accuracy of the top l/n predicted contacts where l is the length of evaluation target and n is a small integer . in this setting accuracy is defined as the percent of residue-residue pairs considered that are true residue-residue contacts divided by the number of predictions considered . estimates for the standard error  were obtained using the sample mean and sample variance of the per target accuracies over the dataset considered.

along with the standard evaluation metric of residue-residue accuracy, we also used a number of additional evaluation metrics including two novel metrics which we developed. the first additional metric we term accuracy in a neighbourhood and it calculates the accuracy of predictions when allowing for less than residue level precision. in this setting, a residue-residue pair is counted as correct if there is a true contacting pair within +/- δ, for small values of δ . the second and third additional evaluation metrics combine a neighbourhood evaluation with clustering. here the selected contact predictions  are first filtered using a greedy clustering approach . the clusters can then be checked for accuracy and separation . the rationale behind these metrics is to study the distribution of the predicted residue-residue pairs among the top scoring predictions and ensure that the predictions are not clustered around a few interactions.

finally, we mention that the evaluation unit in this study is the full protein and we evaluate performance irrespective of any underlying domain architecture. this is different from the approach used by the official casp assessors which typically evaluate predictions on a per domain basis. our assessment over the full protein and our development and use of additional evaluation metrics  is meant to complement the evaluation provided by official casp assessors. the evaluation provided by the casp assessors is finer in nature and at the residue level . our evaluation is at a courser level of resolution and characterizes how well predicted residue contacts describe areas of interaction in the protein chain. a summary of the official casp <dig> residue-residue contact prediction results is available at: http://www.predictioncenter.org/casp10/rr_summary_results.cgi.

RESULTS
performance in casp10
protein residue-residue contact predictors are best evaluated on hard protein modelling targets as these are the types of targets for which predicted contact information could be of most use. table  <dig> reports the accuracy of dncon's top l/ <dig>  l/ <dig> and l medium and long range predictions along with several other sequence based predictors on  <dig> hard casp <dig> targets using standard evaluation metrics. the results of this evaluation indicate that the methods can be grouped into three sets when considering the top l/ <dig> long range predictions. the best set of methods achieves accuracies in the range of  <dig> - <dig> followed by sets with accuracies in the ranges of  <dig> - <dig> and  <dig> - <dig> . the distinction between these three groups is visible as well when considering the top l/ <dig> long range contacts but breaks down when considering the top l long range or any set of medium range contact predictions. for both medium and long range contact predictions on these targets, dncon is consistently among the best predictors.

accuracies for the top l/ <dig>  l/ <dig> and l medium and long range contact predictions for  <dig> hard targets. l is the length of the protein. estimates for standard error are provided in parenthesises.

the drawback to evaluating residue-residue contact predictors on hard targets is that the evaluation sets are often small. this is due to the fact that most hard modelling targets are proteins related to new folds and experimentally determined structures for new folds are not as common. to improve the robustness of our assessment, we extended our evaluation to  <dig> casp <dig> targets. since the methods considered in our benchmark do not make use of template information in the prediction process, this is still a fair assessment and no method has an undue advantage. the results of this extended evaluation are presented in table  <dig>  as before, the methods can be roughly divided into three sets. the top performing set has accuracies for the top l/ <dig> long range predictions in the range of  <dig> - <dig>  followed by two methods which achieved accuracies of  <dig> - <dig> and another method with an accuracy of  <dig> . here again, dncon performed well and among the best methods for both long and medium range contact predictions.

accuracies for the top l/ <dig>  l/ <dig> and l medium and long range contact predictions for  <dig> casp <dig> targets. l is the length of the protein. estimates for standard error are provided in parenthesises.

in this work we also wanted to further examine what is seemingly a contradiction between the usefulness of predicted protein residue-residue contacts and the accuracies achieved by state-of-the-art predictors. the literature contains many documented uses of predicted contacts but this is difficult to understand given the relatively low accuracies, particularly for hard targets. thus, we evaluated the contact predictions using a neighbourhood as described in the methods section. this type of evaluation scheme allows for less than residue level precision and counts a predicted contact correct if it is within one or two residues of a true residue-residue contact. conceptually, predictions of this level of resolution would still be useful for tasks such as model quality assessment and searching the conformational search space as they describe areas of interaction along the protein chain. tables  <dig> and  <dig> show the performance of several predictors using this relaxed evaluation scheme on hard targets and all targets. as shown in tables  <dig> and  <dig>  accuracies for the top l/ <dig> long range contacts approach  <dig>  and near or surpass  <dig>  for the top l/ <dig> medium range contacts. thus, there is a much stronger contact signal present in the contact predictions than the results from the residue level assessment would indicate and this gives credence to the usability of predicted contact information.

accuracies for the top l/ <dig> and l/ <dig> medium and long range contact predictions for  <dig> hard targets. l is the length of the protein. estimates for standard error are provided in parenthesises. δ is the size of the neighbourhood.

accuracies for the top l/ <dig> and l/ <dig> medium and long range contact predictions for 96casp <dig> targets. l is the length of the protein. estimates for standard error are provided in parenthesises. δ is the size of the neighbourhood.

in order to ensure that the methods were not clustering predicted contacts around a few areas of interaction, we also wanted to consider the distribution or coverage of predicted contacts in the list of the top l/ <dig> or l/ <dig> contacts. this is to say that we wanted to determine how many areas of interactions the contact predictors were identifying. to do this, we first cluster the top l/ <dig> or l/ <dig> contacts for a target in a greedy fashion. for each predicted residue-residue pair considered, we added it to a list of cluster representatives if there was not a residue-residue pair within  <dig> residues. more specifically, we added residue pair  only if |x-xi| >  <dig> or |y-yi| > <dig> for all residue pairs  already in the list of cluster representatives. the list of represented contacts was then counted and evaluated using a neighbourhood of δ =  <dig>  table  <dig> presents the results of this study. the cluster count is the number of cluster representatives considered by a method . in this evaluation, dncon not only outperforms other methods in terms of the accuracy of the cluster representatives but also in the number of clusters identified. thus, not only are dncon's predictions more accurate, they also identify and recover more areas of interaction along the protein chain.

accuracies for the top l/ <dig>  l/ <dig> and l medium and long range contact predictions for  <dig> casp <dig> targets. l is the length of the protein. estimates for standard error are provided in parenthesises. δ is the size of the neighbourhood. cluster count is the number of clusters identified by the method.

the final assessment we performed on the six residue-residue contact prediction methods was an analysis of the roc curve on the casp <dig> benchmark. figures  <dig> and figure  <dig> show the roc curve for the methods on top l and l/ <dig> predictions respectively. this was accomplished by collecting the top l  ranked predictions for each protein target and then calculating the true positive rate and false positive rate of these contact predictions at a variety of decision thresholds. tables  <dig> and  <dig> show the calculated area under the curve  for each roc curve and this value characterizes the overall classification performance of a method across a number of decision thresholds. as figures  <dig> and figure  <dig> indicate, the deep learning method from group  <dig>  performs better across a variety of decision thresholds, particularly when considering the top l <dig> predictions.

area under the curve  for roc curve calculated using the top l per protein predictions over  <dig> casp <dig> targets. l is the length the protein.

area under the curve  for roc curve calculated using the top l/ <dig> per protein predictions over  <dig> casp <dig> targets. l is the length the protein.

analysis of dn architecture and feature selection
given the positive performance of dncon on the casp <dig> benchmark, we decided to extend our analysis of our boosted, deep network architecture to its robustness with respect to the features used and underlying network topology. to assess the sensitivity of the underlying dns used, we trained and evaluated a number of small, boosted ensembles. first, we studied the effect of the number of layers and nodes per layer. table  <dig> shows the performance of  <dig> different architectures evaluated on the casp <dig> dataset. for each architecture considered, a boosted ensemble of  <dig> dns was trained using the dncon_train dataset and the standard learning procedure outlined in eickholt and cheng  <cit> . the accuracies of the various architectures are very comparable and do not show wide variation even though the number of parameters in the underlying models varies by a wide margin. thus, in this particular application, the boosted ensemble of dns is rather robust with respect to the dn's architecture.

to analyze the effect of features used, we divided the input features into five groups based on the type of information they represented or contained. the five groups were residue type , atchley factors , sequence separation between the residue-residue pair considered , global information consisting of contact potentials, relative positions in sequence and percentage of ss or sa content  and profile information . table  <dig> lists and describes the feature groups.

given the time required to train a full, boosted ensemble , it was not possible to evaluate all possible combinations of the features groups and therefore we chose to start with only those features directly related to the sequence and then add groups. it is generally accepted that a sequence profile contains more information than the sequence itself and that using a sequence profile often leads to better performance. the drawback is that calculating a sequence profile can be computationally intensive. thus, the rationale was to see how well a boosted ensemble could perform without profile information and with limited amounts of sequence data. we also evaluated the performance of an ensemble trained on all the feature sets and on a combination of profile information and atchley factors. note that all feature groups are used for the ensembles in dncon.

discussion
one outcome of this study is need for broader evaluation metrics for predicted residue-residue contacts. as demonstrated by the strong performance of contact predictors when allowing for less than residue level precision , there is quite a strong contact signal present in the residue-residue contact predictions. conceptually, this looser definition makes more sense as proteins are dynamic macromolecules. the information we have in experimentally determined structures is simply snapshots of the protein's conformation but minor changes in a protein's shape can and do occur. the noise introduced by such shifts may not make it possible to learn and predict specific residue level contacts from experimentally determined structures. we can, however, learn and predict a number of coarse interactions within the protein chain. this finding explains how predicted residue-residue contacts have been useful in tertiary structure modelling and model quality assessment even though the reported residue-residue accuracies are in the range of 25-35%. part of the problem has been in properly characterizing the performance. when using a neighbourhood of size  <dig> , contact accuracies are in the range of 65-75%. given that we are able to predict at this level what areas of the protein's chain are in contact, it is not surprising that this information does indeed characterize portions of a protein's conformation.

from a historical perspective, it was quite logical to predict and evaluate contacts at the residue level. these types of predictions naturally translated into inputs that could be used with existing protein reconstruction or modelling pipelines. given, however, that the contact predictions of state-of-the-art contact predictors are fairly accurate but less precise, what is needed is the development of additional protein reconstruction or modelling pipelines that recognize and exploit this fact. one example of such an approach would be a model evaluation scheme we developed in an earlier work. it allows and considers some slight deviations between predicted contacts and those present in a predicted model  <cit> .

moving forward, we believe that both residue level  and courser level  evaluations are important and should be used in assessing the performance of contact predictors. as mentioned, from a historical perspective most attempts to use predicted contact information do so at the residue level and there are undoubtedly situations when residue level accuracy is required. hence, assessing performance at this level is important but it is also important to better characterize the overall quality and possible value of contact predictions. knowing that current state-of-the-art contact prediction methods can accurately predict a number of areas of interaction can spur the development of new protein structure prediction techniques that can leverage this information, particularly for the hard modelling targets where additional information is often scarce.

with respect to our residue-residue contact predictor, dncon, it has shown itself to be rather robust and state-of-the-art approach. in our comparison with other sequence based approaches from casp <dig>  dncon consistently performed well and placed in the upper echelon of methods in terms of performance regardless of the evaluation metric used . the difference between dncon and other methods was even more pronounced when evaluating hard targets with less than residue level precision. here, dncon achieved an accuracy of  <dig>  for the top l/ <dig> long range predictions while other approaches reached accuracies in the range of  <dig>  to  <dig> . in addition to higher accuracy, dncon's predictions are more dispersed and hence contain more information about the overall conformation of a protein. this is evident by examining the cluster counts in table  <dig>  dncon has more clusters present in the top l/ <dig>  l/ <dig> and l long range predictions. the interactions represented in these clustered predictions are also more accurately predicted.

the underlying ensembles employed by dncon showed themselves to be rather robust to the effects of the number of layers or nodes per layer in the dn. this can be seen in table  <dig> as the top l/ <dig> medium and long range predictions have accuracies in the ranges of  <dig> - <dig>  and  <dig> - <dig> , respectively. while adding additional nodes and layers to the dns does not appear to increase performance, it also does not negatively affect it, as can often be the case in applications of machine learning.

in analyzing the value of the features sets used, it is clear that the information contained in the pssm  is of great value and significantly contributes to increased performance. for the top l/ <dig> medium and long range contact predictions, it is possible to only use the pssm and atchely factors and achieve performances comparable to that of using all features. this is not surprising and the value of profile information in sequence based machine learning methods has been known and used for some time  <cit> . the drawback to using profile information is that it often comes at a significant computational cost  and thus makes applications on a genomic scale more difficult. given the performance of ensembles of dns which do not use profile information, it is clear that there is a need for further development in this area. in the future, we plan on further investigating and improving the performance of methods which do not require profile information or look for ways in which similar information can be achieved.

CONCLUSIONS
we have presented a study and broad benchmark of dncon, a method to predict protein residue-residue contacts using deep networks, on the casp <dig> dataset. in a comparison with several other sequence based predictors on hard protein modelling targets, dncon achieved state-of-the-art performance under a variety of evaluation metrics. we also developed and used novel evaluation metrics which characterize a methods performance when allowing for less than residue level precision. in particular, our study shows that state-of-the-art residue-residue contact predictions such as those produced by dncon do exhibit a strong and distributed contact signal and capable of identifying several areas of interaction in a protein chain. this finding explains how predicted residue-residue contacts have been useful in tertiary structure modelling and model quality assessment even though the reported residue-residue accuracies are in the range of 25-35%. furthermore, we have demonstrated that the underlying ensembles of dns used by dncon are rather robust with respect to architecture and make use of all the features used. dncon is available as a webservice at http://iris.rnet.missouri.edu/dncon/.

competing interests
the authors declare that they have no competing interests.

authors' contributions
je implemented the algorithms and carried out the experiments. je and jc analyzed the data, wrote and edited the manuscript and approved it.

