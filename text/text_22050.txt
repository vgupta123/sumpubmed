BACKGROUND
epitope-based vaccines  make use of short, antigen-derived peptides  that are administered to trigger a protective humoral  and/or cellular  immune response. t-cell epitopes are presented to t-cells in association with major histocompatibility complex  proteins. while cytotoxic t-cells recognize intracellular peptides displayed by mhc class i molecules , t helper cells recognize peptides that are taken up from the extracellular space and displayed by mhc class ii molecules . the peptide:mhc complex  interacts with the t-cell receptor, leading to its activation and subsequent induction of a cellular immune response. evs offer several potential benefits over traditional vaccines, including the precise control over the immune response activation, the ability to focus on the most relevant antigen regions , as well as production and biosafety advantages due to their chemically simple and well-characterized composition. cd4+ t-cell epitopes play a key role in ev design  <cit> , as the cognate help provided by these cells is essential for the generation of vigorous humoral and cytotoxic cd8+ t-cell responses  <cit> . because experimental screening of large sets of peptides is time-consuming and costly, in silico methods that facilitate cd4+ t-cell epitope mapping on protein antigens are paramount for ev development.

human mhc class ii  proteins are made up of two transmembrane chains: α-chain  and β-chain , which together shape the peptide-binding groove. this region defines five pockets that mostly interact with individual residues of the peptide  <cit> . the hla genes are the most polymorphic in the human genome. currently, the imgt/hla database  <cit>  lists  <dig> hla class ii alleles associated with three classical loci , corresponding to  <dig> distinct hla class ii dr protein variants , and this number continues to grow at a rate of  <dig> alleles per year  <cit> . this huge diversity poses serious problems for vaccine design, as different alleles are expressed at dramatically different frequencies in different ethnicities. individuals display different sets of alleles that likely respond to a different set of peptides from a given pathogen.

the mhc class ii binding groove is open at both ends, allowing peptides  to project out of the groove, causing ambiguity in their positional alignment and making the alignment a fundamental step in predicting binding. two classes of methods for cd4+ t-cell epitope prediction have emerged. the first category  relies on peptide sequence comparisons to identify binding motifs, and includes the pioneer method syfpeithi  <cit>  and matrix-based approaches such as position-specific binding profiles . tepitope  <cit>  and tepitopepan  <cit>  are based on the so-called “pocket profiles” and multirta  <cit>  is based on thermodynamic principles. another group of data-driven approaches involves machine learning, which has been proposed to capture subtle mhc class ii-binding patterns . the second category involves structure-based methods. these methods perform molecular modeling calculations on pmhcs in order to estimate the binding energies, thus offering independence from experimental binding data. a recent analysis showed them to be better than random, but inferior to state-of-the-art data-driven approaches  <cit> .

the few methods able to cope with the extent of hla class ii polymorphism are collectively referred to as pan-specific approaches  <cit> . although these methods  are potentially suitable for ev design, they do not fully account for the entire allotypic diversity of human ethnic populations and they do not take into consideration immunodominance. our new tool predivac described in this paper implements a different pan-specific approach based on the concept of specificity-determining residues . this methodology has been previously described by our group for the prediction of substrate specificity of protein kinases  <cit> . while the binding interface of a protein can be extensive, only a small group of sdrs is responsible for specific interactions. the sdrs have been mainly studied in peptide recognition domains  of proteins with roles in signalling pathways  <cit> . identifying mutations that alter specificity may require a large amount of experimental work; therefore, a number of computational approaches have been developed to predict sdrs. most of these methods are based on multiple sequence alignments and the use of statistical analysis and evolutionary information to identify sdrs  <cit> . other approaches combine multiple sequence alignments with structural information of the binding site  <cit>  or physical properties  <cit> . like other bioinformatics methods for cd4+ t-cell epitope prediction, predivac focuses on predicting pmhc complex formation. the method assumes that t cells with the required specificity will be present in the t-cell repertoire. however, despite improvements in the performance of methods predicting mhc class ii peptide binding, a recent study showed that state-of-the-art methods are still unsuccessful in predicting cd4+ t-cell epitopes  <cit> , highlighting the need to develop new approaches that cope better with epitope discovery. a significant source of complexity in ev design comes from the fact that most of the response is mounted against a few so-called immunodominant epitopes, despite the presence of many potential epitopes within an immunogen. this restricted antigenic specificity of t cells poses a serious challenge for ev design, as vaccine formulations built on epitopes that do not dominate the immune response will not induce effective protection in the vaccinated organism. recent evidence suggests that the pmhc kinetic stability plays a central role in controlling mhc class ii peptide immunogenicity  <cit> . in concordance with this model, a strong correlation has been observed between high affinity hla class ii peptide binding, immunodominance and promiscuous cd4+ t-cell recognition  <cit> . several studies support this correlation both for mhc class i  <cit>  and class ii proteins  <cit> . predivac was consequently developed using high-affinity binding data, on the assumption that it is the positive bias toward capturing underlying peptide features that correlates with promiscuity and immunodominance, two properties that are fundamental for ev design  <cit> .

in this study, we introduce the pan-specific method predivac for cd4+ t-cell epitope prediction, which is based on the sdr concept previously applied to protein phosphorylation site prediction. we assessed the performance of predivac by cross-validation and compared the predictive performance against several state-of-the-art methods in terms of hla class ii peptide binding and cd4+ t-cell epitope prediction. the comparisons showed that predivac performed comparable to ten competing methods in high-affinity binding prediction, but delivered the highest specificity in cd4+ t-cell epitope identification, with a particularly strong performance in immunodominant epitope identification, compared to three other pan-specific approaches.

methods
software implementation
predivac is written in perl . its main component is a purpose-built database  constructed using berkeley db. the web implementation available to the research community is written in python/cgi. the server operates on gnu/linux  <dig>  and runs apache  <dig> . <dig>  the software performs three major tasks: i) sdr identification; ii) binding data retrieval  and iii) peptide binding prediction.

sdr identification
hla class ii amino acids involved in peptide ligand recognition were identified using a dataset of  <dig> peptide:hla class ii complex structures, accounting for  <dig> different alleles . for each binding position, residues within a van der waals radius of  <dig> Å from the peptide amino acid were considered as contacting positions . structural alignments of pmhcs were performed with vmd  <cit> . sequence variability of hla molecules at the binding interface was mapped onto the drb1* <dig> allele structure  using the protein variability server   <cit> . sdr identification was also aided by a previous quantum chemistry-based analysis of peptide:hla class ii interaction  <cit> , where the variation of electrostatic properties associated with each of the residues involved in peptide binding was assessed and amino acids inducing a global variation of electrostatic properties in the binding groove  and those involved in specific electrostatic variations  were identified.

the binding cores of the peptide ligands are highlighted in bold. underlined pdb ids represent the structures that were employed for structural alignment.

predivacdb database
a key part of the method is predivacdb, a purpose-built database of nonameric high-affinity binding peptides and sdrs. the data in predivacdb was gathered from three online repositories  the immune epitope data base   <cit> ;  mhcbn  <cit>  and  epimhc  <cit> . the collected peptides were additionally filtered by eliminating:  sequences with length <  <dig> residues;  non-natural peptides and sequences having ala percentage >50%;  sequences containing a non-natural atom or group; and  peptides whose binding affinity was determined only through whole-cell based assays. the easygibbs method  <cit> , based on the gibbs sampler approach, was employed to identify nonameric binding cores, as it is a well-validated tool for motif retrieval in mhc class ii ligands. for each set of peptides, the retrieved scoring matrix was employed to identify the binding regions in the peptides. for datasets with small numbers of peptides, binding motifs were obtained using the mhc motif viewer  <cit> . predivacdb was built using the identified nonameric regions and contains  <dig> high-affinity sequences accounting for  <dig> hla class ii alleles .

peptide binding prediction
predivac predicts peptide binding by establishing a correlation between the sdrs in the hla query protein and the sdrs associated with hla proteins of known specificity. the process involves the following steps:  sdrs for each of the five binding positions are identified in the query hla protein sequence;  predivacdb is queried and amino acid frequencies and weights are calculated  for peptide sequences associated with allotypes sharing similar sdrs as the query protein at each binding position; and  a position-weight matrix  is built based on the binding data, consisting of  <dig> columns  ×  <dig> rows .

  wi,j=logpa,i/pa 

where pa,i is the probability of observing amino acid a at position i of the peptide , and pa is the probability of observing amino acid a in the background model. the frequency of a residue at position i in the peptide  is estimated using pseudocounts by adding n/ <dig> to the raw frequency fa,i and dividing by n+n, were n is the number of sequences used to calculate the frequency. sdrs are considered similar if substitution using the blosum <dig> matrix gives a positive score.

finally, t-cell epitope mapping is carried out by parsing query protein sequences into overlapping nonameric segments , each of which is assigned a binding score using the pwm . raw scores are normalized to a 1- <dig> range using a linear transformation, considering the minimal and maximal theoretical peptide scores that can be obtained from the pwm. a sensible cutoff to discriminate peptides that bind from those that do not is  <dig> 

RESULTS
specificity-determining residues
structural alignments of the binding groove  were performed with  <dig> distinct pmhcs out of  <dig> structures analyzed , accounting for  <dig> different dr alleles. in cases where a particular complex is represented by more than one structure, the highest resolution one was selected. the root-mean-square-distance of the residues constituting the binding groove was  <dig>  Å, considering cα atoms of both domains, reflecting the high level of structural conservation of residues dictating specificity. this is a condition required for the sdr method to be applicable. as shown in figure  <dig>  the β-domain accounts for the specificity of the hla class ii proteins, given that 99% of polymorphisms are present exclusively in this domain  <cit> . on the other hand, there are significantly less polymorphic positions in alleles belonging to the dp and dq loci, and these are distributed both through the α- and β-domains of the binding groove  <cit> . the application of the method for these alleles must be assessed further, as the specificity seems to be determined by a larger number of residues than in the case of dr alleles. in addition, limited binding data is available for hla dp and dq molecules.

fifteen contacting positions on the polymorphic β-domain were finally considered as sdrs, providing they exerted an influence on peptide binding, they were structurally conserved, they were polymorphic and they were identified previously  <cit>  to have an influence on the electrostatic properties of the binding groove . these key positions allow the relative weight of the effect of all amino acids on each binding site to be determined, and predicting whether a peptide is a likely ligand for a given hla class ii protein. it is worth noting that, whereas in predivac the weights are calculated from binding data , the popular method tepitope does this using experimentally determined binding affinities .

performance assessment and cross-validation
predivac was assessed both in terms of hla class ii binding prediction and cd4+ t-cell epitope prediction, including using a sub-set consisting exclusively of immunodominant epitopes. the accuracy of the predictions was measured in terms of the area under the roc curve , which represents the probability that the classifier will assign a higher score to a positive example compared to a negative example.

for consistency with previous studies  <cit> , predivac’s accuracy on hla class ii alleles from predivacdb was assessed using a modification of the leave-one-out cross-validation methodology, whose objective is to minimize the similarity between the training and test datasets. this testing procedure, called leave-one--out cross-validation, involves the exclusion of a single allele from the database and then assessing the performance using the binding data associated with that particular excluded allele. balanced datasets were constructed for auc calculation, to have equal number of high-affinity binders  and non-binders . the calculation was repeated ten times using different non-binder datasets chosen randomly from the ligand source.

for every tested allele, both for peptide binding and cd4+ t-cell epitope prediction, positive datasets were constructed using the whole set of epitopes restricted by it. the negative datasets were constructed by splitting the protein sequences into overlapping peptides of the same length as the particular epitope and all peptides except the annotated peptide were taken as negatives. this is an established validation strategy, based on the stringent assumption that the misclassification of a few potential peptides  can only lead to a slight decrease in the overall predictive performance of the prediction. redundancy in predivacdb was removed by excluding all nonameric peptides equal or containing any of the sequences present in the cd4+ t-cell epitope datasets.

hla class ii peptide binding prediction
predivac implements a method to predict cd4+ t-cell epitopes that allows coverage of  <dig> out of  <dig> hla class ii dr locus proteins, i.e., 95% of human protein diversity. other pan-specific approaches account for  <dig> ,  <dig>  and  <dig>  hla class ii allotypes . additional file 1: figure s <dig> illustrates the performance of predivac on the prediction of peptide binding to hla class ii alleles different from those contained in predivacdb. the performance of the method was evaluated for  <dig> alleles with binding data for at least  <dig> peptides each. the average auc was  <dig> . in addition, the performance of predivac was tested and compared with nine state-of-the-art methods implemented as web-servers using the dfrmli dataset  <cit> , which has been previously employed for benchmarking purposes  <cit> . it represents the binding affinity distribution in full-length protein antigens, comprising  <dig> mhc class ii peptides  derived from four protein antigens. the binding data are highly standardized, accounting for seven hla-dr molecules . in this study, binding peptides were defined as those with ic <dig> ≤  <dig> nm. for drb1* <dig>  the threshold was set at  <dig> nm, while drb1* <dig> was left out because it does not contain high-affinity binders. additional file 1: table s <dig> lists the methods compared. predivac performed comparably to state-of-the-art methods. the highest average auc was delivered by smm-align , with  <dig>  for predivac .

cd4+ t-cell epitope identification
the capability of predivac to identify cd4+ t-cell epitopes was assessed using a dataset gathered from iedb, consisting of  <dig> of mhc class ii-restricted t-cell epitopes that account for  <dig> hla class ii alleles . only the pan-specific approaches predivac, netmhciipan- <dig> , tepitopepan and multirta were considered for performance comparison, as they afford prediction for the whole set of alleles restricting those epitopes . as shown in figure  <dig>  the resulting aucs were   <dig>  ,  <dig>  ,  <dig>   and  <dig>  . predivac roc curve showed a slight dominance over the high-specificity region , which means that the method delivers the highest performance in identifying immunodominant epitopes correctly. this ability is particularly relevant given the skewed distribution of the dataset, where only one peptide per protein is positive  and all the remaining peptides are negatives. when the performance was evaluated for each individual allele , average aucs of  <dig>  ,  <dig>  ,  <dig>   and  <dig>   are obtained. these average aucs differ slightly from those previously published values using the same dataset  <cit> , which is a consequence of differences in the calculation methodology. in our study, auc values were calculated using one dataset per allele or per method, containing simultaneously all positive  and negative examples , while in the referred study the auc values were individually calculated for each protein and subsequently averaged to obtain an allele’s performance  and a method’s performance . our approach to calculate unique auc values over the entire dataset offers potentially a better representation of the overall performances. this is further supported by the unbalance in the dataset, which means that certain alleles that are considerably underrepresented  will have the same weight as drb1* <dig>  if using the averages. in particular, predivac’s average is significantly affected by its poor performance on two alleles, drb1* <dig> and drb1* <dig>  having  <dig> and  <dig> epitopes, respectively. figure  <dig> shows the predictive performance of predivac for every tested allele in relation to the average performance of all the pan-specific methods. the low standard errors demonstrate a degree of association among the predictive performances over each particular allele, likely reflecting limitations in the ability of predicting cd4+ t-cell epitopes common to all algorithms. the large gap between the performance of the methods in predicting high-affinity peptide binding  and cd4+ t-cell epitopes  also supports the hypothesis that binding affinity is not the only factor governing cd4+ t-cell epitopes presentation. abundant evidence points to the influence of local structural properties of the antigen in the processing and presentation of the epitopes  <cit> .

an additional benchmarking dataset, based on influenza virus-specific cd4+ t-cell epitopes from five major influenza virus proteins in mice expressing a distinct set of class ii molecules, was obtained from a recently published study  <cit> . for dr1-restricted epitopes , both predivac and netmhciipan- <dig>  reached a comparable accuracy , although predivac delivered the highest specificity. for dr4-restricted epitopes , predivac outperformed the rest of the methods with an auc of  <dig> , followed by netmhciipan- <dig>  , tepitopepan  and multirta .

high-affinity binding and immunodominance
available evidence suggests that cd4+ t-cell immunodominance correlates best with the dissociation rate constant koff <cit> , and dominant epitopes have been associated with half-lives  ≥  <dig> h  <cit> . a strong correlation has been established between pmhc class ii high-affinity binding, immunodominance and promiscuity, with half-maximal inhibitory concentration  values typically fluctuating around a few nm  <cit> , justifying our affinity threshold of  <dig> nm for peptide selection in predivacdb. we set this threshold in order to drive the specificity prediction exclusively by high-affinity binding data and thus potentially favour the identification of immunodominant cd4+ t-cell epitopes.

the dissociation rate constant  plays a crucial role in ligand-receptor interactions, as it varies over many orders of magnitude, while the association rate constant  is often controlled by the rate of diffusion  <cit> . this observation is supported by the on-rates for pmhc class ii complexes in the antijen database  <cit>  , and the kinetics of twenty different peptides binding to the mhc class ii protein, showing diffusion-limited kon values of 104- <dig> m-1s- <dig> and koff values spanning a range >104-fold  <cit> . a half-life  of  <dig> h is equivalent to a koff value of  <dig>  × 10- <dig> s- <dig> ; thus, the dissociation constant  would be between ~ <dig>  nm  and ~ <dig>  nm  for the high-affinity interaction range usually associated with cd4+ t-cell immunodominance.

immunodominant epitope prediction
immunodominant and promiscuous epitopes are the best candidates for ev design; therefore, we benchmarked predivac in terms of its ability to identify immunodominant epitopes in full-length proteins. immunodominance is an allele-restricted property that in the context of one individual refers to those epitopes that elicit the largest immune response. however, because many immunodominant cd4+ t-cell epitopes have the ability to bind with high-affinity and to be permissively presented in the context of multiple dr molecules  <cit> , this study focused on cd4+ t-cell epitopes whose response has been examined in the context of many individuals expressing diverse haplotypes. in this case, immunodominant epitopes are those that elicit the most common response, which may or may not be immunodominant within the hierarchy of responses of particular individuals.

a dataset containing  <dig> immunodominant cd4+ t-cell epitopes with known allele restriction  was gathered from the literature , using a previously published dataset  <cit>  as a basis. the dataset contains nonameric epitopes known as “universal epitopes”, as they bind in an apparently indiscriminate manner to most dr alleles, such as those contained in the bacterial tetanus toxoid protein  and in the hemagglutinin influenza virus protein . it has been suggested that these peptides bind the mhc molecule in the same register but with interactions driving t-cell recognition variably influenced by the regions flanking the core  <cit> . moreover, longer epitopes are often clusters of dense antigenic regions , such as the immunodominant epitope spanning residues  <dig> to  <dig> of the circumsporozoite protein sequence , which can bind with several overlapping 9-mer registers within its 20-mer sequence.

only minimal immunogenic regions  with lengths ≤  <dig> amino acids were considered in the dataset, corresponding to the shortest fragment able to elicit a significant proliferative cd4+ t-cell response. drb1* <dig> was kept as a reference allele for all promiscuous epitopes sharing this restriction. auc values were obtained for each allele and for the full dataset. in addition, for the dataset of immunodominant epitopes, the ranking corresponding to the epitope score in a sorted list of all the scores of same-length peptides in the source protein was recorded as a percentage . the ranking position corresponds to the highest position of a predicted binding core/epitope  where a full-length match occurs with the actual immunodominant epitope . for methods hosted at the iedb website , which retrieve binding predictions over 15-mer sequences, only the nonameric core associated with the optimal 15-mer sequence was considered.

overall, predivac outperformed other pan-specific methods, with accuracy slightly higher than netmhciipan ,  <dig>  ,  <dig>   and  <dig>  ) . predivac’s roc curve for immunodominant cd4+ t-cell epitopes was superior paticularly over the high-specificity region . fractional auc values for the curves over the high-specificity region  were  <dig>  ,  <dig>  ,  <dig>   and  <dig>  . auc values are within the same range  as the values obtained for high-affinity binding prediction , supporting the hypothesis that the pmhc complex stability is key in dictating cd4+ t-cell immunodominance, perhaps overpowering other factors, such as local structural properties, that would play a role in subdominant epitopes. the average rankings associated with the immunodominant epitopes in their source proteins were  <dig>  ±  <dig>  ,  <dig>  ±  <dig>  ,  <dig>  ±  <dig>   and  <dig>  ±  <dig>  . figure  <dig> presents the distribution of these rankings, showing that predivac outperformed other approaches by identifying 45% of immunodominant epitopes within the top 1%, and 75% of the epitopes within the top 3% of the scores . this result is in agreement with the high specificity demonstrated by predivac in the auc analysis. the second-top performance was delivered by tepitopepan, in agreement with the fact that this method is a pan-specific extension of the original high-quality experimental binding data driving the tepitope method . tepitope has been able to identify more than 75% of immunodominant hla class ii endogenous ligands for 1–6% top-scoring peptides  <cit> , which is consistent with the range for our dataset of exogenous immunodominant epitopes. it is expected that tepitopepan inherited these features. both netmhciipan- <dig>  and multirta are trained on datasets containing both high and moderate peptide binders , which could explain to some extent the slightly lower performance on immunodominant epitopes.

it is worth noting that cd4+ t-cell epitope predictions for predivac, netmhciipan- <dig>  and multirta are likely to present some bias for those alleles present both in the training datasets and the test sets. only tepitopepan does not depend on experimental binding data. even by removing peptide redundancy in predivacdb, it is to be expected that the remaining similar peptides contribute to improving predivac’s predictive performance on these alleles. however, the primary objective of this exercise was benchmarking the pan-specific approaches under equivalent conditions, therefore; despite this bias the analysis remains informative.

CONCLUSIONS
the predivac method introduced in this paper implements a pan-specific approach for hla class ii binding predictions based on the sdr concept. it displays a wider coverage yet performs comparable to other available methods. for cd4+ t-cell epitope prediction, predivac delivered the highest specificity, which is valuable in epitope discovery, given the need to correctly identify a few cd4+ t-cell epitopes among a large number of non-epitopes. furthermore, an association with individual allotypes was observed among the auc values for all methods, which possibly highlights a barrier imposed by biological variables not accounted for by the models. all methods performed better when they were assessed on immunodominant cd4+ t-cell epitopes, reaching similar accuracy levels to those obtained for high-affinity peptide-binding prediction. for the immunodominant cd4+ t-cell epitope dataset, predivac outperformed competing methods , particularly standing out in terms of its high specificity, which allowed identification of 75% of immunodominant epitopes within the top 3% scoring peptides. this outcome supports our thesis that driving the prediction with high-affinity binding data can impose an advantageous bias toward capturing underlying peptide features that correlate with stable peptide-mhc binding, and subsequently increases the probability of identifying immunodominant cd4+ t-cell epitopes.

predivac users need to be aware of the limitations imposed by the approach predivac is based on. the method assumes that interactions between the protein and the peptide are independent for each peptide position, and the prediction of cd4+ t-cell epitopes focuses solely on peptide binding to the mhc molecule as the most discriminative determinant of immune response. these limitations will be addressed in future work.

predivac provides cd4+ t-cell epitope predictions over 95% of hla class ii dr allotypes, making it a valuable tool to aid ev design in the context of an ethnically heterogeneous population. ultimately, by enabling highly specific immunodominant epitope identification, we expect our tool to be helpful in the vaccination strategy of targeting simultaneously multiple dominant and subdominant epitopes from one or several pathogen proteins, overcoming the propensity of the immune system to focus on a very limited set of epitopes. we are currently extending the tool to better facilitate ev design by considering allele frequency data and population coverage.

abbreviations
auc: area under the roc curve; dfrmli: dana-farber repository for machine learning in immunology; ev: epitope-based vaccine; hla: human leukocyte antigen; iedb: immune epitope data base; loo-cv: leave-one-out cross-validation; mhc: major histocompatibility complex; pwm: position weight matrix; roc: receiver-operator characteristic; sdr: specificity-determining residue.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
designed research: po, jje, bk; performed research: po, jje; analyzed data and wrote the paper: all authors. all authors read and approved the final manuscript.

supplementary material
additional file 1
supplementary tables and figures. this pdf file contains tables s1-s <dig> and figures s1-s <dig> 

click here for file

 additional file 2
immunodominant epitope dataset. this text file contains the immunodominant cd4+ t-cell epitope dataset, including their associated allele restrictions and source protein sequences. this dataset was employed to assess the performance of predivac, netmhciipan, tepitopepan and multirta in identification of these epitopes.

click here for file

 acknowledgements
bk is a national health and medical research council research fellow.
