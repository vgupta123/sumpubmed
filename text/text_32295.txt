BACKGROUND
the binding affinities of transcription factors  to short dna sequences play a major role in the gene regulation and thus in the proper functioning of the cell machinery. understanding the mechanisms of tf binding specificity has become an important goal for theoreticians and experimentalists. with the development of novel experimental techniques like chip-chip and chip-seq, covering tf binding over the whole genome, the need of unbiased theoretical methods recovering the binding event has grown immensely. along with the classical approaches like molecular dynamics  <cit>   and monte carlo  <cit>   that place high demands on computer resources several knowledge-based potentials  <cit>  have been developed for calculation of protein-dna binding energies. simulations in the course of md and mc are dependent on the quality of the input protein and dna structures, which are often taken from the protein data bank   <cit> . another complication is the high flexibility of the dna-binding domain and sometimes also the ligand itself. an alternative approach that most often does not consider the molecular flexibility is docking. the scoring functions applied in docking methods basically contain electrostatic and van der waals components  <cit>  but could be extended to complicated free energy models that also take into account solvation effects and hydrogen bond direction  <cit> .

however, for a given dna sequence of length n, there are altogether 4n variants the tf could bind, which for moderately long motifs containing 18- <dig> bases grow to computationally infeasible number. in the last years, much effort has been devoted to the development of knowledge-based potentials  <cit>  that take into account 3d crystal structures of known tf-dna complexes for estimation of parameters of such potentials. using such potentials one can predict binding energy of a given tf to new unknown target dna sequence. on the other hand, traditionally, prediction of tf binding sites in dna sequences is often done with the help of so called position weight matrices , that represent a simple model of tf-dna binding in a form of a  <dig> × n matrix  <cit> . a similarity score can be computed for any dna sequence of length n according to a pwm. a specific threshold for the score is defined, to classify sequence segments as binding sites for corresponding transcription factor. compilations of such pwms for many transcription factors are represented in databases, such as transfac  <cit>  and jaspar  <cit> . normally, the pwms collected there are constructed from alignments of known, experimentally proven tf binding sites obtained by gel-shift analysis, selex, plasmid construction assays and other experimental techniques. a possible bias and inaccuracy of such pwms could result from predominant inclusion of strong and relatively strong binding sites as most experiments could not detect lower-affinity sites. knowledge-based potential can help to improve detection of such low-affinity sites through the use of information about the contact frequencies between different residues or atoms in known crystal structures to predict the interaction energy. here we present a new method for constructing pwms using a knowledge-based potential. for a tf of interest, our method performs computational estimation of the relative contribution of each nucleotide of the dna sequence to the free energy of binding.

in the present work a statistical knowledge-based potential  <cit>  was adopted for studying the free binding energies to dna of several tfs from different classes. we chose this potential as it outperformed other knowledge-based potentials in discriminating the native structure from other near-native decoys. as we investigated not only crystal structures of protein-dna complexes but also had to apply homology modeling in order to obtain complexes for which crystallographic structures had not been resolved, this turned out to be a major reason for the choice of this potential. for most of the tfs studied here we found in the literature experimental data on their binding affinity to various dna target sequences. especially the tumour suppressor p <dig> and its interaction with dna has been extensively studied. its role in cell cycle arrest or apoptosis and affinity for specific dna binding sites make it a suitable candidate for theoretical and experimental studies. as its resolved crystal structure contains four monomers bound to the dna chain, it is computationally difficult to derive the corresponding pwm using molecular dynamics methods. moreover, many proteins are commonly found in their homodimeric form in the bound state. another typical problem is the availability of protein-dna crystal complexes. for example, crystal structures of p <dig> and p <dig> in a complex with dna have not been resolved, but solution structures of their dna-binding domains  are known. both p <dig> and p <dig> reach 63% amino acid similarity to p <dig> in the dbd, suggesting that their pwms could be slightly different from the p <dig> pwm. as in transfac there are no specifically constructed pwms for each of these p <dig> family members, adequate pwms could be derived using homology modeling combined with a statistical potential taking into account atomistic details.

we compared the tetramer p <dig> pwm presented here to available experimental data and other theoretical approaches and the good agreement encouraged us to calculate pwms of proteins from different tf classes that have been experimentally studied, such as the nf-κb family, gabp and erα. finally, we evaluated the performance of the newly computed pwms of p53- and nf-κb-family members in detecting binding sites in known target dna sequences derived through chip experiments.

methods
statistical potential
for the estimation of the protein-dna interaction energy we used the all-atom statistical potential developed by robertson and varani  <cit>  that was successfully applied in discrimination of near-native structures from docking decoys. this distant-dependent potential was constructed using crystallographic data from native protein-dna complexes. briefly, the free energy of the complexes was mimicked by a thermodynamical potential function that took into account the protein-dna interface contact distances and the chemical atom types. the protein and nucleic acid heavy atom types were considered in a residue-specific manner. the probability of an interatomic contact was expressed in terms of the likelihood of observing a particular distance between a protein and a dna atom in a native-like, 'correct' complex. the logarithm of this probability of correctness p of the interatomic distances described the gibbs free energy of the complex and was negative for native-like complexes:   

in the formula, d is the set of atomic distances dij between the interface atoms, ti and tj correspond to the chemical types of the atoms, np and nd represent the number of protein and dna atoms in the complex. the probability of an individual atomic contact is modeled as the likelihood of observation of a separation dij between atoms ti and tj in a native-like protein-dna complex:   

where p is the likelihood function, p  the marginal probability, and p the bayesian prior representing the probability of observing a native-like protein-dna complex. due to difficulties in determination of the value of p, it was set to one in  <cit> . finally, the likelihood of observation a native-like interatomic distance dij was expressed with the formula:   

where nobs is the number of contacts observed between two atoms of type ti and tj separated by distance dij. this statistical function maps the continuous value dij to a set of discrete distance bins, the atoms separated by distances greater than or equal to dij are not counted. in the present work the 3/10/ <dig> range of the potential was used, where the scoring function considers all interface protein and dna atoms separated by less than 10Å, and groups these contacts into eight bins beginning with a 3Å bin, followed by seven 1Å bins. it has been shown  <cit>  that a larger distance cutoff would not improve significantly the results, under certain circumstances it could rather lead to false positives, hence in the present study the 3/10/ <dig> parameters were used.

computation of the pwms
for the estimation of protein-dna free binding energies structures of the transcription factors cocrystallized with dna were used. the crystal structure of entry 2ac <dig> from the pdb databank  <cit>  was used for the calculation of the p <dig> tetramer pwm, for the homodimer the complex with entry 2geq was selected. we calculated also the pwms of three members of the nf-κb family: the p <dig> homodimer , p50relb , and the p50p <dig> heterodimer . finally, the heterodimeric complex of gabp  and the homodimeric erα cocrystallized with dna  were used as input for the calculations of the corresponding pwms. in the cases where more than one crystal structure of the tf complexed with dna was available, as in the case of 1vkx, a custom script was used to estimate the van der waals energy arising from the tf and dna interatomic contacts. the lower van der waals repulsion energy, as in the case of the 1vkx structure, guarantees that the number of 'bad', unnatural tf-dna atomic contacts occurring in the particular crystal structure is smaller than in the complexes showing higher van der waals energy. consecutively, complexes with the most native tf-dna interatomic distances will provide the most correct tf-dna free binding energies in the scoring procedure.

the crystal structures of the dna chains taken from the corresponding tf-dna complexes were mutated using the mmtsb   <cit>  script mutatena.pl by fixing the chain backbone and substituting one base pair at each step. sterical inaccuracies were avoided as the script used a library of torsion parameters for the correct residue rotations. for example, the calculated root mean square deviation  between a  <dig> bp crystal dna fragment and its completely mutated version was as small as  <dig> Å when superimposing the c <dig> atoms.

the workflow of structure-based pwm calculation developed in this study is schematically presented in figure  <dig> and proceeds as follows: a 3d structure of a transcription factor bound to its target dna sequence is retrieved from the pdb databank. for each dna sequence of length n as found in the corresponding crystal structure we generate 4n +x random sequence fragments of the same length, where x could range between  <dig> and some large number, for computational efficacy we constrained this parameter to maximally  <dig>  <dig> random sequences. typically, 4n independent parameters are enough for the solution of the same number linear equations, however, in this case the use of a very small set of x additional sequences or no such at all results in slightly different weights w  and resulting pwm coefficients, respectively. these small discrepancies  arise from the residue rotations while substituting nucleotides in the crystal dna structure before scoring the protein-dna contacts. in order to test the effect of adding these additional sequences, we generated also  <dig>  <dig> random sequences and scored their binding free energy to p <dig>  we found that already a small number of additional dna sequences, x between  <dig> and  <dig>  was fairly enough for accurate estimation of the particular energy contribution from each nucleotide. further, for each of the 4n+x random sequences we compute the free energy of binding to the tf using the statistical potential described above.

the task is now to estimate all weights w in the pwm , so, that the binding energy predicted by the pwm would maximally correlate with the energy computed with the statistical potential. we chose to estimate the weights w by solving the linear equation:   

where x is a vector of 4n dimensions of the estimated weights, so the components of the vector x contain all weights of the respective pwm in the following consequent manner:   

and a is a binary matrix of dimensions , which contains information on all random dna sequences whose free binding energy was computed. each line of the matrix a corresponds to one dna sequence. it contains  <dig> if the respective nucleotide is found in the corresponding position of the sequence and  <dig> otherwise. the free binding energy vector b consists of 4n +x values obtained with the protein-dna scoring procedure described above. eq. <dig> is solved by least squares optimization in the octave statistical package  <cit> .

we set the bayesian prior p in eq. <dig> to one according to ref.  <cit> . respectively, the energy weights computed here were rescaled to reproduce the tf-dna binding energy in the units of kj/mol, using experimentally obtained binding affinities for each factor from the literature. finally, nucleotide probabilities  were calculated from the corresponding energy coefficients  using the boltzmann formula:   

where  is the energy contribution from a particular nucleotide α, β = 1/rt is the inverse energy  and γ = {a, c, g, t}. the calculation of  <dig>  <dig> tf-dna complexes using a standard pentium cpu takes a couple of hours depending on the dna fragment length. all pwms used in this work, both calculated from structure and collected from previous studies, are available in additional file  <dig> 

the performance of the newly computed pwms of the members of the p <dig> and nfkb families was tested on upstream sequences of human genes known to be regulated by those factors. all upstream dna sequences used here were extracted from the transpro®  <cit>  database taking various promoter windows for thorough analysis. the match™ algorithm included in transfac version  <dig>  was used for promoter scan. all transfac matrices used in the present study were extracted from the same version.

RESULTS
p <dig> tetramer
the tumor protein  <dig> is one of the experimentally and theoretically most extensively studied transcription factors, which makes it a very suitable system for validation of new methods for binding mode prediction. here, the pwms of its dimeric and tetrameric forms were calculated. the p <dig> tetramer response elements have two half-site palindromes with consensus sequence rrrcwwgyyy summing up to a  <dig> bp dna sequence. sequence logos of some of the p <dig> tetramer pwms published in the last years together with the one reported here are shown in figure  <dig>  the third logo from the top was obtained using the ddna <dig> server  <cit>  that estimates the protein-dna binding energy adopting a newly published version of the dfire potential  <cit> . in order to compare these five pwms we estimated their relative entropies using the following formula:   

where pi, j is the probability of observing element i at position j in the pwm. not surprisingly, both experimental pwms have very similar relative entropies . from the theoretically predicted ones, the pwm reported here has relative entropy of  <dig>  that lies closer to the experiment than the one calculated with the modified dfire potential . the p <dig> transfac matrix has been compiled from  <dig> selex binding sites and has a corresponding lower entropy  than the other two experimental ones.

there are few experimental studies that focused extensively on measuring the p53-dna binding affinity and from these we selected the two largest independent data sets, published in ref.  <cit>  and ref.  <cit> . we calculated the tf-dna binding energy scores of the altogether  <dig> oligonucleotide sequences published in ref.  <cit>  taking as a reference sequence number  <dig> in table one from the corresponding work. figure  <dig> shows the tf-dna energy scores calculated by us plotted against the experimental lnkd shifts of the particular oligonucleotides with respect to the consensus sequence. there is a linear correlation between the experimental affinities and the calculated free binding energies , the small deviations from the regression line observed in the upper right part of the figure are most probably related to larger experimental errors observed at weaker tf-dna binding. another experimental work  <cit>  investigated the binding of p <dig> to mouse ddb <dig> genes. having taken the consensus sequences and corresponding dissociation constants provided in their paper we found a good agreement between experiment and theory, as suggested by the p value of the fit  and the regression coefficient r <dig> equal to  <dig> . the oligonucleotide sequences, experimental lnkd shifts and the calculated by us binding energy scores for these two experimental sets can be found in additional file  <dig> 

p <dig>  p <dig> and p <dig> dimers
the p <dig> and p <dig> tumor proteins belong to the p <dig> transcription factor family, reaching 63% sequence identity to p <dig> in the dna binding domain. correspondingly, p <dig>  p <dig> and p <dig> have overlapping and distinct functions - p <dig> regulates the stress response to suppress tumors; p <dig> is essential for ectoderm development; and p <dig> might regulate both stress response and development.

to the best of our knowledge, crystallographic structures of the dbds of p <dig> and p <dig> complexed with dna have not been resolved yet, however, solution structures of the c-terminal domains containing the corresponding dbds are available ). as these three proteins belong to the same family and show high dbd sequence similarity, we used homology modeling in order to reconstruct the complete p <dig> and p <dig> dbds using the p <dig> dbd as a template. we compared the performance of the web servers esypred3d  <cit> , geno3d  <cit> , 3d-jigsaw  <cit> , phyre  <cit> , and swissmodel  <cit>  in reconstructing the p <dig> and p <dig> dbds using the p <dig> dbd. further, considering the high sequence similarity of p <dig> and p <dig> to p <dig> and possibly the same binding mode in most of the cases, we aligned the modeled structures of p <dig> and p <dig> to the crystallographic structure of the p <dig> dna binding domain in its homodimeric form . both p <dig> and p <dig> dbds were modeled using as a template the p <dig> structure with pdb accession number 1gzh whose chain a had 55% sequence similarity to both p <dig> and p <dig>  although chain d from a p53-dna complex  showed higher similarity to p <dig> , it included a smaller number of residues, therefore the former template was preferred.

the p <dig> and p <dig> dbds were iteratively aligned to the p <dig> domain using the pymol software package  <cit> . we chose the p <dig> and p <dig> dbd structures modeled with the swissmodel  <cit>  server as they showed the smallest rmsd from the p <dig> domain - the alignment of the common cα atoms of p <dig> to those in the corresponding p <dig> domain showed an average rmsd of  <dig> Å, for p <dig> it was about  <dig> Å. the other web servers  allowed also for modeling of chain flexibility in the protein structures using rotamer libraries, which led to very large rmsd values  superposing the new dbds to the p <dig> dbd. however, these servers provided structures that could be effectively used in protocols sensitive to chain flexibility, such as molecular dynamics studies and docking.

finally, the aligned complexes were locally relaxed with ambertools  <cit>  in order to remove possible sterical clashes. the homodimeric p <dig>  p <dig>  and p <dig> pwms were calculated using the scoring scheme presented above. the corresponding sequence logos of the three pwms are shown in figure  <dig> together with the logo obtained from the transfac matrix with entry v$p53_ <dig>  for comparison we calculated also the pwms of the possible tetrameric complexes . in those calculations the p <dig> tetramer structure with pdb entry 2ac <dig> was used as a template, the results were well comparable to those obtained with the dimer complexes.

transcriptional targets of the p <dig> family
in order to quantify how similar were the newly computed homodimeric p <dig>  p <dig>  and p <dig> pwms we decided to evaluate their performance on upstream sequences of genes known to be regulated by these factors. in transfac there are only few annotated p <dig> response elements mapped to promoters, which was not enough for comprehensive statistics. hence, we selected a set of  <dig> genes which are known to be upregulated by p <dig> and/or p <dig>  all promoters of a given gene were included in the scan with match . we used three promoter windows of different length in accordance to the genomic coordinates provided in transpro. the smallest promoter window spanned  bp from the transcription start site , the other two had coordinates of  bp and  bp relative to the tss. there were no overlapping promoters in the promoter window  bp,  <dig> partially overlapping promoters were found in the  bp window, and  <dig> in the largest  bp promoter window. however, we do not how the potential binding sites are distributed in the promoters and how many they could be, therefore we assumed that each promoter contained at least one site and scanned the whole length of all promoters.

matrix cutoffs were calibrated to give an empirical prediction rate of   <dig> site in  <dig> k residues . in order to take properties of real promoter sequences, such as repeats, tfbss, or cpg-rich regions, into account, we randomly sampled a set of  <dig> human promoter sequences and selected a score threshold that satisfied the desired site frequency based on match predictions. this procedure was repeated several times which lead to insignificant changes in the matrix cutoffs. then the promoter sequences were scanned with match using the matrix cutoffs calibrated on the background sets. figure  <dig> shows the fraction of promoters in which only potential p53-responsive elements have been predicted with match, those with p <dig> and p <dig> hits, with p <dig> and p <dig> hits, and with hits of all three pwms, respectively. in contrast, p63- or p73-only promoters seem to be relatively rare as match returned only five promoters with p <dig> and p <dig> but no p <dig> hits in the promoter window  bp . in those five promoters  the two p <dig> and p <dig> binding sites reported in dhs <dig> overlapped, two out of four hits overlapped in fen <dig>  from the altogether five hits in jag <dig> only two overlapped, and the two p <dig> and p <dig> hits in serpina did not overlap. trim <dig> was reported as a p63-only promoter  at matrix cutoff corresponding to p value of  <dig> e- <dig> 

restricting the promoter window to  bp in respect to the gene tss produced many p53-only hits  but also many non p53-hits in particular promoter sequences. p63-only sites were reported in altogether eight promoters belonging to eight genes . the p <dig> sites lay  <dig> bp,  <dig> bp,  <dig> bp,  <dig> bp,  <dig> bp,  <dig> bp,  <dig> bp, and  <dig> bp before the particular tss, respectively. for these particular  <dig> promoters, it means that the p <dig> sites lie closer to the tss , but potential p53-binding sites were not found in this small promoter window. here, from the  <dig> p63-only promoters found in the  bp window, only two  did not contain potential p <dig> hits when extending the promoter window to  bp. at the small promoter window  bp match returned p <dig> and p <dig> hits in altogether  <dig> promoter sequences belonging to the cdc42rp <dig>  dhrs <dig>  fen <dig>  grk <dig>  jag <dig>  p53aip <dig>  and tp <dig> genes. the reported p <dig> and p <dig> sites overlapped completely in the cdc42rp <dig>  dhrs <dig>  grk <dig>  and tp <dig> promoters and partially in the other three promoters. in one of the jag <dig> promoters the p <dig> site lay  <dig> bp away from the p <dig> site, in fen <dig> and p53aip <dig> the separation amounted to  <dig> bp and  <dig> bp, respectively. on the other hand, in the third jag <dig> promoter the suggested p <dig> and p <dig> sites lay next to each other. in some of the cases the reported p <dig> and p <dig> sites overlapped, however, several p63-only promoters were detected. none of the p <dig> hits returned by match overlapped with p <dig> or p <dig> ones.

in summary, the results obtained with match suggest that the three new structure-based matrices return unique hits. particular p <dig> sites reported in promoters of the camlg, col5a <dig>  ppl, and syne <dig> genes lay about  <dig> bp or less from the proposed p <dig> binding sites. similar to these results, the p <dig> sites reported in promoters of the gdf <dig>  fxr <dig>  and tspan <dig> genes lay between  <dig> and  <dig> bp away from p <dig> sites.

concluding this section, the results obtained with the three newly computed pwms suggest that the p <dig> transcriptional activity could be regulated by the other two family members. the promoter sequences used here are available in additional file  <dig> together with the corresponding list of tss genomic coordinates .

nf-κb
the good correlation between experimental affinity data and predicted tf-dna free binding energies shown in figure  <dig> and additional file  <dig> encouraged us to calculate pwms of transcription factors from other structural classes. we further chose the nf-κb family for which experimentally measured dissociation constants are available to which we compared the binding energy scores computed here. we calculated pwms for three members of the nf-κb family: the p <dig> homodimer, the p50relb and the p50p <dig> heterodimers. sequence logos of these three pwms together with a general logo from the corresponding transfac entry v$nfkappab_ <dig> are shown in figure  <dig>  the relative entropies of these members of the nf-κb family calculated with eq. <dig> are as follows:  <dig>  for p50p <dig>   <dig>  for p50p <dig>   <dig>  for p50relb, and  <dig>  for the corresponding transfac pwm. the three newly computed matrices presented here differ slightly from each other, but in general they are in a good qualitative and quantitative agreement with the general sequence logo from transfac. comparing the matrices on the basis of relative entropy we would suggest that the p50p <dig> pwm computed from structure is the one closest to the experimental one. the left parts of the p50relb and p50p <dig> pwms are somehow similar to each other, as guanine is preferred at the fourth position in the corresponding sequence logos, which is not the case for the p <dig> homodimer and the transfac pwm. on the other hand, the first two logos show similar ccc probabilities in their right parts. we also recalculated the p50p <dig> pwms using the ddna <dig> server, its pwm  had higher relative entropy  comparing to the experimental pwm  and the other nf-κb matrices we obtained.

we also addressed the quality of the structure-based matrices by scanning human promoters containing known, experimentally verified nf-κb binding sites. we selected  <dig> human genes for which it is known that they are regulated by nf-κb. the full sequences  of the altogether  <dig> promoters belonging to these genes were extracted from transpro and are available in additional file  <dig>  experimentally confirmed nf-κb binding sites are found in only  <dig> out of the  <dig> promoter sequences belonging to  <dig> genes. all relevant experimentally verified sites  in these  <dig> promoters are listed in additional file  <dig>   <dig> of them are nf-κb response elements. as transfac provided no matrix compiled particularly for the relb protein we excluded the newly computed p50relb pwm from the scan. consequently, we compared the performance of the new p <dig> homodimer and the p50p <dig> heterodimer pwms to two of the newest matrices of the transfac library, v$p50p50_q <dig> and v$p50relap65_q5_ <dig>  which were built from homodimeric and heterodimeric response elements, respectively. score cutoffs were calibrated on randomly sampled background promoter sequences in the same way as for the p <dig> family members. we worked again with matrix precision corresponding to a p value of  <dig> e- <dig>  we assumed that each promoter contained at least one site and scanned the whole promoter length.

a matrix scan with match was performed on  <dig> promoter sequences containing  <dig> experimentally confirmed binding sites. here, the alternative promoters of four genes  partially overlapped. the newly computed p50p <dig> and p50p <dig> pwms detected  <dig> and  <dig> sites, respectively. the transfac p50p <dig> pwm recovered  <dig> sites, whereas  <dig> response elements were reported by the transfac p50p <dig> pwm. binding site locations of the p50p <dig> motifs differed in  <dig> sites, of which three sites were only recovered by the transfac p50p <dig> pwm. in the comparison of p50p <dig> motifs, the structure-based matrix reported  <dig> sites missed by the transfac pwm, however  <dig> matches of the transfac matrix were not detected by our pwm. comparing the two groups, the newly computed p50p <dig> pwm discovered  <dig> sites that the p50p <dig> pwm did not find, but missed  <dig> which were covered by the p50p <dig> pwm. the p50p <dig> transfac pwm discovered  <dig> sites different from those reported by the transfac p50p <dig> pwm, but missed  <dig> sites detected by the latter pwm.

in summary, the pwms computed from crystal structures performed better than the transfac ones recovering altogether  <dig> sites, while both transfac pwms yielded  <dig> hits. however, there are two factors that influence these results - for many of the experimental binding sites it is not known with which nf-κb-family member  they interact. here, we focused on two very specific cases, namely p <dig> homodimer and p50p <dig> heterodimer, and omitted p <dig> and relb. second, we did not compare the pwms presented here to all  <dig> other nf-κb-related matrices annotated in transfac that could probably cover all  <dig> response elements found in the  <dig> promoters. the comparison shown here aimed at evaluating the quality of the matrices presented in this work.

gabp and erα
as representatives from other structural tf classes we chose the gabp heterodimer and the erα nuclear hormone receptor whose family members are widely expressed in various eukaryotic genomes. the helix-turn-helix ga-binding protein  is unique among the ets-family transcription factors as it functions as a heterodimer composed of an α and a β subunit. the α subunit, encoded by the gabpa gene, contains the ets dna-binding domain, while the β subunit, encoded by an unrelated gene, gabpb <dig>  contains the transcriptional activation domain as well as four ankyrin repeats necessary for dimerization with the dna-binding subunit. for the gabp matrix computation we used its heterodimeric complex, while for erα its homodimer complexed with dna was used. figure  <dig> shows the newly obtained gabp matrix logo together with the corresponding logo from transfac . the intensities of the first three nucleotides in the newly computed pwm compare well to those found in the corresponding transfac logo although the intensive guanine signal seen in the latter pwm vanishes in the atomistically modeled matrix. nevertheless, the gg-repeat as well as adenine at the seventh position in the new matrix are also quantitatively well captured comparing to the corresponding pwm from transfac.

the erα estrogen receptor belongs to the family of cys <dig> zinc finger proteins. figure  <dig> shows the sequence logo of the homodimer and a half-site  logo from transfac entry v$er_q6_ <dig>  the gg-signal seems to be well reproduced by the statistical potential used here, and the aggtca consensus suggested by transfac is better reproduced in the right part of the pwm computed in this work. thymine seems to compete with guanine in the fifth position of the structure-based matrix, while the transfac logo exhibits thymine dominance at that position. the all-atom matrix computation used here allows for discrepancies between two homodimeric binding sites as shown in figure  <dig>  experimentally, it is more difficult to capture such structural details as most of the experiments use half-sites in the binding affinity measurements  <cit>  and the pwms derived from such size also have to be symmetric. probably the strongest advantage of the method presented here over the experimental ones is the opportunity to compute pwms from complicated tf structures like homo- and heterodimers, or tetramers, as in the experiment this is often difficult to account for.

discussion
p <dig>  p <dig>  and p <dig> - similar but different
the computation of the p <dig>  p <dig>  and p <dig> pwms raises the question if the matrices of the three transcription factors could report unique response elements. a recent chip-chip study  <cit>  discovered about  <dig> target sites for p <dig> across the human genome. it was suggested that p <dig> may regulate its own expression as well as crossregulate expression of p <dig> and p <dig> as it bound all members of the p <dig> gene family. interestingly, a strong overlap between p <dig> and p <dig> sites was found  <cit> , as nearly 80% of the altogether  <dig> p <dig> sites overlapped with p <dig> ones detected under the same experimental conditions. the authors identified also  <dig> high-confidence binding sites for p <dig>   <dig> of them overlapping with p <dig> sites. according to our results obtained with match at least  <dig> % of the p <dig> and p <dig> hits overlap. on the other hand, most of the reported p <dig> sites did not overlap with those of p <dig> and p <dig>  the fact that many of the best-scoring p <dig> and p <dig> binding sites lay at least  <dig> kb before the transcription start sites suggests that indirect regulation of p <dig> by p <dig> or p <dig> is possible.

the nf-κb family - comparison to other studies
experimental tf-dna binding energy data for p <dig> and p <dig> provided in the pronit  <cit>  database were not sufficient for an extensive comparison with our results. after having discarded repeating binding dna sequences we obtained only five independent binding energies Δg that provided a linear fit to our results . the gel electrophoresis study by matthews and coworkers  <cit>  on the p <dig> homodimer provided altogether nine different sequences and relative molarities m at 50% binding. the experimental results correlated well with the calculated binding energies, giving a regression coefficient of  <dig>  and a p value of  <dig> e- <dig> . we also found a good agreement between calculated energies and experimental binding affinities derived from microarray data as presented by wang et al.  <cit> . this group investigated the binding affinities of the p <dig> homodimer to the wild type and single-nucleotide mutant ig-κb sites with a dsdna microarray produced with a novel scheme. the binding energy scores we calculated for the altogether thirty-one  <dig> bp target sequences plotted against the measured fluorescence intensities  provided a good qualitative agreement .

estimation of true and false positives
in order to quantify the performance of the pwms in distinguishing true positive from false positive hits we prepared corresponding positive and negative sets, the positive sets are available in additional file  <dig>  as a comprehensive collection of p53-bound sequences we used the chip-pet data presented in ref.  <cit>  assuming that each fragment contains a p <dig> response element. after discarding the largest fragments  we had a set of  <dig> positive fragments that we extended to  <dig> bp each in order to avoid biases arising from different fragment lengths. for creation of negative sets we randomly sampled nonoverlapping human promoters and took for each of them a promoter window of , so that the fragment length was equal to  <dig> bp. all negative sets had same number of fragments of the same lengths as compiled in the corresponding positive set, where for each pwm group to be compared, p <dig>  nf-κb, gabp, and erα, different background sets were generated. in this way, altogether  <dig> different negative sets for a group were prepared. regarding the evaluation of the nf-κb pwms we were not successful in finding a comprehensive chip-chip set and used the  <dig> promoter sequences studied above assuming that each of them contains at least one nf-κb binding site. for gabp and erα we used chip-seq data from ref.  <cit>  and  <cit> . from each of the two chip-seq sets we selected  <dig> fragments that were extended to  <dig> bp length. the receiver-operator characteristic  was analyzed by iterating over all pwm scores  and calculating proportions of recognized  <dig> kbp-sequences in positive and negative sets, we sampled the average area under the curve  over the ten negative sets.

the sensitivity of the nf-κb pwms is obviously lower in comparison to the performance of the p <dig> tetramer matrices, which could be also connected to the fact that the length of the nf-κb response element amounts half of the p <dig> tetramer one. within some small deviations all nf-κb pwms performed comparably well in distinguishing true from false binding sites. the auc calculation revealed that the nf-κb transfac pwms performed minimally better than the theoretically calculated ones, p50p <dig> from transfac yielding auc of  <dig>  ±  <dig> , p50p <dig> from the same source had auc of  <dig>  ±  <dig> . the auc values of the theoretically derived pwms were as follows:  <dig>  ±  <dig>  for the p50p <dig> pwm and  <dig>  ±  <dig>  for p50p <dig> pwm computed here,  <dig>  ±  <dig>  for the p50p <dig> pwm and  <dig>  ±  <dig>  for the p50p <dig> pwm recalculated with the ddna <dig> server.

we also evaluated the performance of the structure-based p50p <dig> and p50p <dig> pwms and their transfac homologs using  <dig> sequences of experimentally verified response elements that did not overlap with the  <dig> binding sites found in the  <dig> nf-κb-regulated promoters discussed above. the dna fragments used in selex and gel-shift experiments are typically very short , therefore we had to generate random dna sequences of the same length instead of extracting such pieces from promoters, as the latter contain binding sites and repeats that could bias the statistics. we sampled auc over  <dig> background sets, the roc plot is shown in additional file  <dig>  in this case, both p50p <dig> pwms showed better performance than the p50p <dig> ones, the p50p <dig> pwm computed here having auc of  <dig>  ±  <dig> , the p50p <dig> from transfac having auc of  <dig>  ±  <dig> , while the p50p <dig> pwm from this work and the corresponding transfac one had smaller aucs .

further, both gabp pwms performed comparably well, the transfac matrix slightly outperforming the newly developed one . analyzing the sequence logo in figure  <dig> one finds that adenine in position  <dig> in the newly computed matrix is not so dominant as in the transfac one, certainly the quality of the crystal structures influences the sensitivity of the corresponding pwms.

finally, we compared the performance of the homodimeric erα pwm computed here and a monomeric one  using the right side of the sequence logo shown in figure  <dig>  while a corresponding transfac matrix is available only for a half-site of the response element. to our surprise, none of these three pwms performed really well comparing to the p <dig> and nf-κb results. the homodimeric pwm computed here delivered an auc of  <dig>  ±  <dig> , the half-site pwm had an auc of  <dig>  ±  <dig> , the transfac half-site pwm performed slightly better producing an auc of  <dig>  ±  <dig> .

in summary, our pwms were not as good as the best matrices compared in this study on the basis of their ability to distinguish true positive from false positive sites. as the p <dig> pwm from ref  <cit>  was computed from affinity measurements, the pwm from ref  <cit>  compiled from  <dig> response elements, and the transfac matrix from  <dig> selex fragments, it is clear that these matrices rely mostly on strong binding sites, which is not the case with the pwms computed in the present work. nevertheless, the performance of the newly computed p <dig> pwm was comparable to that of the experimentally derived pwms, while its computation was highly effective regarding time and costs.

all nf-κb pwms presented here showed similar performance regarding the positive set consisting of  <dig> promoters. the scan on the smaller set containing  <dig> response elements showed that both p50p <dig> pwms performed better than the p50p <dig> ones. interestingly, although both p50p <dig> pwms had similar auc values, the p50p <dig> matrix computed from structure recovered  <dig> out of the  <dig> nf-κb binding sites found in the  <dig> promoters, while the transfac one detected  <dig> sites.

while the p <dig> and nf-κb matrices performed well in distinguishing true positive from false positive sites, the gabp and especially the erα pwms discovered also many false positives. one possible reason could be the use of fragments computed from chip-seq experiment as positive sets, as it is known that not all detected peaks contain binding consensus of the factor  <cit> .

limitations and advantages of the model
quality of the crystal structures
as discussed in ref.  <cit> , the greatest weakness of the used potential is the lack of local structural detail such as presence of hydrogen atoms in the scoring function. another and larger source of errors are the crystal structures we used to assess the effect of base pair mutations and subsequent calculations of the binding energies. the quality and reliability of the computed free binding energies are strongly dependent on the resolution of the crystal structures. one possible improvement could be the introduction of a term accounting for the number of formed hydrogen bonds as well as their directions, as the present potential does not consider them. another area of improvement could be considering the heavy atom types as protein class-specific, for example one set of atom types for leucine zipper proteins, other types for helix-turn-helix proteins, etc. in this way, more precise and also protein class-specific pwms could be constructed.

interdependent positions in the binding sites
pwms are calculated under the assumption that residues in different positions in the matrix contribute independently from each other to the total binding strength. if the binding sites contain interdependent positions, a richer model than a pwm is required to adequately capture the dependencies, which typically requires more training data. just at this point lies a potential strength of the structure-based approach, as different base pair combinations can be tested fast and cheaply in-silico. hence, application of our approach to more sophisticated models for transcription factor binding sites presents an important direction for further research  <cit> . a nice example of palindromic sequence coupling has been studied in ref.  <cit>  on the basis of base inversion correlations. the molecular dynamics techniques could be also a suitable choice in this case, as one could insert double or triple mutations simultaneously in the dna chain, then compute the free binding energy with a custom function.

deformed dna structures in the complexes
when the protein and/or dna structure deforms significantly upon binding, the potential used in this study will most probably perform poorly, as it has been calibrated against crystallographic data containing native interatomic coordinates. the mutation scripts we used work with b-dna as they use precompiled rotamer libraries that are needed in order to reproduce the native geometry  upon residue mutation. if the dna chain is deformed, one possible solution of this problem is the use of docking allowing for chain flexibility. such approach is used by the haddock server  <cit>  that utilizes information from identified or predicted protein interfaces in ambiguous interaction restraints to drive the docking process. once a reasonable protein-dna configuration has been identified, one could proceed to the pwm computational procedure using the potential applied here. alternatively, a short initial optimization  of the protein-dna complex could be performed using a software like ambertools, which would remove atomic contacts of strongly deviating length.

CONCLUSIONS
in the present work a statistical potential was applied for pwm calculations using a novel scoring scheme for estimation of protein-dna free binding energy. in contrast to the computationally intensive molecular dynamics techniques the model presented here combines efficiency and accuracy by modeling both transcription factor and dna chain atomistically. the computational workflow aims to cover all  possible nucleotide combinations. our first goal was to check the efficacy of the potential against well studied tfs like p <dig>  for which sufficient experimental data for comparison is available. the p <dig> tetramer pwm computed here correlated very well with a newly published one  <cit>  compiled from  <dig> response elements.

the pwms of p <dig> and p <dig> were computed using homology modeling and a structure of the dna-binding domain of the p <dig> dimer as a template. having performed a promoter scan on  <dig> p53/p73-regulated human genes we found that about half of the p <dig> and p <dig> hits reported by the match algorithm lay more than  <dig> kb upstream of the corresponding transcription start sites. in most of the cases the best-scoring p <dig> and p <dig> binding sites did not overlap with the p <dig> ones, which suggests that p <dig> and p <dig> could regulate the p <dig> transcriptional activity.

the structure-based pwms of the nf-κb family members p50p <dig> and p50p <dig> performed comparably to the corresponding transfac ones in distinguishing true positive from false positive sites. performing a match scan on experimentally verified nf-κb response elements we found that the newly computed p50p <dig> pwm recovered  <dig> more experimental binding sites than the corresponding transfac matrix.

while the general idea of deriving position weight matrices from known protein-dna structures has been explored before  <cit> , this work, besides providing a new method for pwm calculation from 3d structures, is the first that systematically compared structure-based matrices with those derived through traditional approaches. the proposed computational scheme used in combination with homology modeling can be successfully applied in pwm computations where crystallographic structures of the protein-dna complexes are not available, which is the case for many transcription factors. taking as an example the p <dig> family, when the binding mode is known and a crystallographic structure of a member of the family complexed with dna is available, nmr structures of the particular protein dna-binding domains can be used as templates for homology modeling and pwm computations. in this way, pwms of new or little-known transcription factors can be accurately determined avoiding time and resource consumming affinity measurements.

authors' contributions
da and ps designed the algorithm, da conducted the calculations and wrote the manuscript. ak performed the promoter scan and helped to draft the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
all pwms used in this work, both computed and from literature. all matrices.

click here for file

 additional file 2
oligonucleotide sequences from literature, their experimental binding affinity values and calculated affinity scores. binding affinities.

click here for file

 additional file 3
the promoter sequences of the p53-regulated genes used in this work. included are promoter windows of  bp,  bp, and  bp in respect to the promoter tss.

click here for file

 additional file 4
 <dig> nf-κb-regulated promoter sequences used for validation of the pwm model. the promoter windows span over  bp in respect to the tss, the length of each promoter sequence is  <dig> kb. the genomic coordinates of the particular tss are listed in additional file  <dig> 

click here for file

 additional file 5
a list of experimentally verified tf binding sites for the  <dig> nf-κb-regulated promoters. output from explain  <dig> . gene names are presented in the first column of the table, the 5' most promoters are marked with '_1' in the second column, tss starts are listed in the 3rd column. the promoter coordinates of the response elements are provided in the 5th column, the name legend in the 4th column. coordinates are provided starting from one in respect to the promoter window . the distances provided in the 4thcolumn are calculated in respect to virtual tsss and are not relevant for comparison.

click here for file

 additional file 6
all positive sequence sets used for calculation of the true positive/false positive rates as presented in figure  <dig>  chip chip sequences.

click here for file

 additional file 7
true positive/false positive rates estimated for the homo- and heterodimeric nf-κb pwms using sequences of  <dig> experimentally verified response elements. nfkb exp fp fn.

click here for file

 acknowledgements
this work was partially supported by eu grants: eurodia , net2drug  and bmbf grant globcell . the authors thank t.a. robertson and g. varani for providing the statistical potential used in the present work. d.a is grateful to e. wingender and to r. gabdoulline for helpful suggestions and comments.
