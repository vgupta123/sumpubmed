BACKGROUND
due to its speed and simplicity, one of the most common methods used in phylogenetics is maximum parsimony  <cit>  . mp is based on the principle of the occam’s razor, which means the simplest explanation for any phenomenon is the most probable. under this principle parsimony makes the claim of using few if any assumptions, and while this has been disputed, mp’s model is much more simple with far fewer parameters than many other phylogenetic methods. three major problems have been cited with mp, stemming from this assumption of simplicity. many authors have argued that parsimony has under parameterized the problem, then the claim was made that it over parameterizes the problem  <cit> . the third problem is that of long-branch attraction .

lba is the foundation for many of the arguments against the use of mp in phylogenetics. one foundational study showed that mp can be positively misleading when two non-sister taxa have long branches compared to the rest of the tree  <cit> . this bias has then been reiterated in a number of other simulated and empirical studies . the crux of the problem is that long branches, whether sister taxa or not, are claded or grouped together, creating scenarios where the mp method will consistently be incorrect. this has the potential to occur often, when given enough evolutionary time because multiple sites will differentiate from each other. since there is a finite set of characters,  the two sequences will have many sites with matching characters. as more evolutionary time passes, fewer of these sites will be due to a common ancestor or homology, and more of them will be due to the random use of the same nucleotide. this non-homologous yet similar sequence of characters adds noise to the phylogenetic signal. this problem is not unique to parsimony but parsimony suffers from it more extensively than maximum likelihood   <cit> .

lba has been found in many real world examples, one review found  <dig> examples in a search on the web of science  <cit> . this illustrates the need for a method that can accurately evaluate if a phylogenetic analysis is suffering from lba. some methods have been designed in an attempt to fill this gap including: “methodological disconcordance, rasa, separate partition analysis, parametric simulation, random outgroup sequences, long-branch extraction, split decomposition and spectral analysis.”  <cit>  many of these current methods have been shown to be ineffective or reliant on morphological data. reliance on morphological data is effective but creates problems due to the difficulty in gathering and sampling this kind of data, so many researchers rely exclusively on molecular data. long branch extraction , also referred to as long branch abstraction, was developed by siddall, whiting, and pol as a method to detect lba. lbe relies on the assumption that if there are two long sequences, removing one of them should move the other to its correct place in the tree, and if this location is different than its original location, the dataset suffers from from lba  <cit> . in  <cit>  bergsten proposes a six step method to detect lba based on the lbe method. these steps are:

 <dig>  if, after completing a full parsimony search you obtain a tree with a questionable grouping of a certain taxa that appears basal and makes the formal classification polyphyletic, suspect lba.

 <dig>  exclude the outgroup and re-run the analysis: does the questionable taxa form a monophyletic clade of the formal classification?

 <dig>  return the outgroup and remove the questionable taxa and re-run the analysis: does this root the tree differently then in step  <dig> ?

 <dig>  return the questionable taxa and reanalyze the data set by separating the gene information from the morphological data: does the morphological data form a monophyletic group of the formal classification while the gene data place the questionable taxa basal in the tree?

 <dig>  analyze the gene data using a method that takes into account branch lengths, : does this method form a monophyletic group of the formal classification?

 <dig>  using the same analysis of step 5: are the branch lengths of the questionable taxa and the outgroup some of the longest in the tree?

if you can answer yes to all the previous questions, lba is the least refuted hypothesis. we have chosen to automate this technique with a few modifications and evaluate it on a series of synthetic data with six taxa under a variety of branch lengths with verified lba.

the six taxa synthetic data sets were used for two main reasons. six taxa data sets are small enough to be calculated in reasonable time but large enough for the lbe method to work. this gave us an a priori knowledge as to which trees were suffering from long branch attraction.

methods
synthetic data sets
to evaluate long branch extraction, datasets that allow for extraction of long branches and differentiation of topological location are necessary. we chose to perform the analysis using six taxa in a star shape for consistency and comparability to the more prevalent studies using four taxa cases of the felsenstein and farris  zone topologies  <cit>  . these scenarios present problems to phylogenetic methods because of the challenge to some assumptions they make. for example, parsimony assumes similar characters to be derived from a common ancestor, but with long non-sister branches there is a great probability that the two sequences are really analogous, meaning they have converged to the same character independently. parsimony generally puts longer branches together in a four taxa case and here the same or similar problems have been preserved.

to produce these data sets we used the program dawg  <cit>  under a general time reversible   <cit>  model of evolution. we used similar parameters as those found in the examples included with the program and explored a range of branch lengths. the lambda value of  <dig>  was used for the indel evolution rate and can be interpreted as one indel for every ten substitutions. the sequence length was set to  <dig> as this gives a reasonably sized sequence to allow for the expected value of any simulation to be seen. the nucleotide frequencies for the simulation were set to  <dig> ,  <dig> ,  <dig> , and  <dig>  for a, c, t, and g respectively with substitution parameters set to  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> , and  <dig>  for ac, ag, at, cg, ct, gt respectively. these settings were chosen based on examples given with the dawg program.

dawg generated data sets for trees under both topologies where the α and β branch lengths were varied from a branch length of  <dig>  to  <dig> , incremented by  <dig> . a branch length of one is interpreted to mean that each site is expected to have one substitution from the internal node under the gtr definition of branch length. for each permutation of α and β branch lengths we ran  <dig> replicates to get a percentage of matches between the two methods. this created a total of  <dig>  data sets for each topology.

evaluation of lba area
each data set was then analyzed by comparing the best parsimony tree from an exhaustive search. with six taxa this means scoring all  <dig> possible trees to find the best one. this best tree was then compared to the parsimony tree and the percentage of the trials out of  <dig> that the two matched was recorded. then for each of the permutations of α and β we generated a new set of  <dig> data sets and performed a heuristic tbr parsimony search. all scoring and searching was done with paup*  <cit> . the tree that mp returned from the heuristic search was then analyzed using lbe.

steps of lbe
to perform lbe, the target tree, in our case the resultant heuristically derived parsimony tree, and data set are given as parameters along with a list of outgroup taxa and questionable taxa to our java version of lbe. of the two β branches, one was selected as the questionable taxa while the other was selected as the outgroup.

the first step of lbe is to remove the outgroup from the tree and the data set and rerun a parsimony search. the second step is to add the outgroup back and remove the questionable taxa. to increase the sensitivity, according to the recommendations of bergsten  we included a third step where the original data set was evaluated under a branch length estimator method. we used maximum likelihood, and the resultant tree was compared to the original parsimony tree. if at any step the tree found by the re-ran search is the same as the original tree, minus the removed taxa in the first two steps, then lba is no longer suspected and the search is terminated. if instead it passed through all of the steps, the branch lengths of the outgroup and the questionable taxa were compared to the rest of the branch lengths. if they were in the top quartile they were considered long branches. having passed through each step or test, the least disputed hypotheses based on molecular data would be lba.

RESULTS
areas under lba
to detect the areas most effected by lba, we ran an analysis of the six taxa data sets  over a range of branch lengths and with two scenarios for the position of the long branches . figure  <dig> shows where the location of lba, as the black region when the β branches are long and the α branches are shorter under the felsenstein-like topology. as a control, the farris-like topology shows how the parsimony bias can be perceived as increased accuracy under the same permutations of branch length. in these figures, the darker the color means the less amount of time the mp analysis and the correct topology were in accordance. in other words, the yellow areas are regions where mp always returned the correct topology  and the black areas are where mp never returned the correct topology. the gradient obviously then covers the percentage of time at intermediate levels of accuracy. what is also interesting to note is the extreme cut off between the areas of correct prediction and those that are incorrect, especially when examining the felsenstein-like topology of figure  <dig>  this very black region essentially shows the felsenstein zone or the conditions under which parsimony suffers from lba. figure  <dig> shows the results for parsimony under the farris topology.

one problem with most phylogenetic algorithms is the loss of detectable signal with extremely long trees. the length of the tree is the sum of all the branch lengths it has and those with an extreme length or long trees are difficult to decipher. this problem is clearly visible when examining the upper right of the figures under both topologies. we hypothesis that as the branch lengths get longer the percentage correct will converge to  <dig> % as this is a random guess out of the  <dig> possible topologies.

this analysis served as a search space basis for where lba should be detected. by comparing the differences between the felsenstein-like and farris-like topologies it is clearly visible which areas should be detected. when analyzed with ml these regions do not appear but the loss of signal is still present . the comparison of both the topologies and the ml method adds further descriptive details and confidence to the search space we are examining.

lbe is not functioning as theory predicts
for a method to accurately detect lba, it needs to discern between these two types of topologies and find the area of lba. the region found by searching the branch length space should be the same predicted by lbe. surprisingly this was not the case.

as is seen in figures  <dig> and  <dig>  lbe seems to completely miss the area it is intended to detect . for a more in depth investigation we analyzed the data by examining specific scenarios that should show extreme lba. in the majority of cases examined, the parsimony trees outputted in the lba zone really did suffer from lba as predicted, but the method failed to recognize it and the short sister taxa of the removed taxa was incorrectly grouped with the other long branch.

further, lbe predicted lba under the farris-like topology, where we know a priori that the data set does not suffer from lba. a few inconsistent categorizations would be understandable because no method is perfect. but this situation, where similar branch lengths give similar conservative predictions under both topologies, calls into question what the method is actually predicting.

it is consistently classifying the wrong area of the felsenstein-like topology as lba and the same area of the farris-like topology. in reality, this is an area suffering from loss of signal. but even in other areas of loss of signal, i.e. the lower right corner of figure  <dig>  it is classifying it as not having any lba. even though this is technically correct the loss of signal should produce a random-like result in the prediction of lba, not an extremely confident vote that it is not suffering from lba. keeping in mind the method is detecting lba as the least refuted hypothesis, it seems odd that the only area detected as having lba is not actually suffering from it and those areas that are suffering from lba have inconsistent results.

what is more bothersome is that the lbe does not seem to consistently categorize based on specific examples of branch length. under the full method of lbe with the branch length step included , the method only categorizes a maximum of 25% of any permutation of α and β as suffering from lba. when the steps that use branch length estimation  are removed, the lbe method categorizes more areas with a greater percentage of lba,  but looses its conservative nature with respect to areas that have lost signal. in this case, it inaccurately predicts a large area that had previously been defined as having lose of signal as having lba be the least refuted hypothesis.

why it may not work
siddall and whiting make the claim that, “... if each of the two branches individually group in precisely the same place as the other when they are allowed to stand alone in an analysis, one can hardly argue that they are attracted to this placement by the absent branch.  <cit> ” while this seems logical, one needs to remember that a common way to avoid lba in the first place is to add additional taxa to break up long branches  <cit> . one possible reason that extracting taxa doesn’t work to detect lba is that parsimony is sensitive to the removal of taxa, creating artificial long branches in the reran analysis. in the case of our analysis, removing a taxa would still be classified as not lba because it created an artificially long branch consisting of a full α branch along with a half α branch. this then would attract either the original long branch taxa and it would look the same as the original lba tree and then be rejected as lba. in other words the extraction creates a problem with sampling, not splitting up longer branches by adding taxa, a typical pitfall when dealing with lba. the long branch is not being attracted by the excluded long branch but it is being attracted to the extended branch caused by not breaking it up. this creates a double error and deceives the procedure into thinking it is not a case of lba

we can thus split the branch length search space into three major areas: the area masked by the ml step , the area misled by the artificially long branch , and the area that is correct until it reaches a point of loss of signal , as seen in figure  <dig>  area i can be seen by comparing figure  <dig> and figure  <dig>  the deciding factor when the branch lengths are α ≥ β is the final step that estimates the percentile of the outgroup and questionable taxa are among the top 25%. but we know, based on the design of our experiment, that this will not be the case in this area and so the detection or confusion that it is lba is masked artificially. this mask is removed when we remove this final step from the analysis, as is seen in figure  <dig> and the area looks like a continuation of a loss of signal area.

area ii is much more hypothetical but seems to fit the data reasonably well. when examining figures  <dig> and  <dig> there is a noticeable but rough line at about y = – <dig> * x +  <dig>  we hypothesis that the shape of this line is a function of the branch lengths. this area is obviously crucial as seen in figure  <dig> because it is the area suffering from lba. in other words, the predictive power of lbe is being masked by this artificial long branch in the exact area needed for accurate prediction of lba. this triangle directly corresponds to the areas under lba, thus making the technique inadvisable.

finally, area iii is where the lbe method is actually mostly correct or the area not suffering from some other artifact. unfortunately, this area is not suffering from lba but eventually it losses phylogenetic signal. it is the most clearly seen in figure  <dig> where ml can determine to a greater extent the phylogenetic signal. at approximately the same point lbe makes incorrect predictions because of the loss of signal. this area is not under a lba bias for mp and so is correctly labeled as not having lba but this is not informative. this really does not add a lot of strength to the procedure because it is already unambiguous.

long branch shortening
due to the problems associated with long branch extraction, an alternate approach could be used. rather than removing the suspected long branch that would cause changes in the overall phylogeny, a series of iterative steps are taken to shorten the branch to diminish the phylogenetic signal being sent from the questionable branch and then see if that changes the phylogeny. if the phylogeny changes, long branch attraction is suspected.

assuming the questionable taxon  falls basal in the mp analysis and is suspect , lbs performs the following three step test:

 <dig>  rather than sampling from all the other taxa, construct the ancestral sequence to all taxa excluding the outgroup and qtaxa. with this sequence, you have the combined signal of all the other taxa, or a summary of that clade.

 <dig>  using the constructed sequence and the questionable taxa, hybridize the two in a random fashion. we are not implying crossing over, albeit that should be tested as well, but using a binomial distribution, characters are exchanged between the sampled ancestor and the suspected long branch ataxa. this causes the branch to be shortened by reducing the differences between the taxon and its hypothetical ancestor. however, since this ancestor is unknown, the characters for the questionable taxon are modified by sampling from the hypothetical ancestor. in figures  <dig>   <dig>   <dig>   <dig>  different sampling frequencies were used. a sampling frequency of 30% means that a random 30% of the target taxon characters are modified.

 <dig>  re-run the analysis with the hybridized sequence included in place of the qtaxa. if the taxa moves after reducing its own signal and adding some signal from the monophyletic clade you have some evidence of lba the parameter or probability of switching in the binomial distribution is increased and steps  <dig> and  <dig> are repeated until either the probability reaches  <dig> or consistently  shows the hybridized qtaxa clading with the hypothetical clade.

one of the weaknesses of such an approach is the lack of an absolute answer. you don’t get a final answer of yes or no  but added evidence that there is a problem. this evidence comes in the form of a probability or percentage of the branch that needs to be shortened to form the monophyletic clade. if the probability comes out high,  <dig>  to  <dig> , you can be fairly sure that lba is not occurring that that there is strong phylogenetic signal supporting the current position in the phylogeny. if it is very low, then long branch attraction has occurred and is causing an incorrect tree to be inferred. this evidence can help the researcher to understand if the questionable taxa  is sending a strong signal to be in the current location or a weak one. a weak signal implies that the location is inferred only because of analogous evolution and not homology. this implication can then be interpreted as the determination or detection of lba.

in figures  <dig>   <dig>   <dig>   <dig>  dark black indicates regions where long branch shortening fails to predict whether long branch attraction is occurring. gray areas indicate regions where lbs successfully determined whether or not long branch attraction was present in the resulting phylogeny. with a 0% sampling frequency , the target taxon is not modified at all and thus the phylogeny does not change. lbs then reports that no lba exists anywhere. in this case, the felsenstein zone  is clear and lbs is unable to detect long branch attraction. as the sampling frequency increases, the target taxon becomes more like the clade and lbs is more able to detect long branch attraction in the felsenstein zone. however, this comes at a price. the region where there is no long branch attraction is now reported incorrectly . this is due to the fact that the target taxon has become so much more like the other taxa that at 90% sampling , long branch attraction is always reported because the target taxon always moves; resulting in a different phylogeny.

maximum parsimony and maximum likelihood
lastly, as this paper addresses algorithms to detect regions where maximum parsimony would report the incorrect tree, it is important to compare maximum parsimony and maximum likelihood in terms of the best scoring tree versus the true phylogeny. figures  <dig> and  <dig> address this question. in the figures, dark areas indicate topologies where maximum likelihood and maximum parsimony generated the same phylogeny. in the gray regions, maximum likelihood generated the correct phylogeny while maximum parsimony failed and in the white regions, maximum parsimony generated the correct phylogeny and maximum likelihood failed. this shows that in the region where there is not much phylogenetic signal  both methods are equally likely to generate the correct tree. in the region near the felzenstein zone, maximum likelihood is able to generate the correct phylogeny but only for a small additional part of the region. much of the felsenstein zone is still unable to be determined in both the  <dig> and  <dig> taxa cases by either parsimony or likelihood.

CONCLUSIONS
long branch extraction and long branch shortening are not reliable methods for detecting long branch attraction and should not be used in phylogenetic inquiries about lba. under a variety of branch lengths for six taxa synthetic data sets lbe incorrectly and inconsistently predicts lba because of its inability to distinguish between artificially created long branches and the correct tree topology. the artificial long branch is created by the removal of the outgroup or questionable taxa branch creating a sister taxa that is artificially long, having removed the taxa that would break up its long branch. an additional problem is that the ml step masks a large area of the branch length space not giving the method the specificity that is needed to be effective. this was shown by an in depth search over two topologies, the felsenstein-like topology that is easily susceptible to lba and the farris-like topology in which the long branches are correctly grouped together. the results support our conclusion that lbe is ineffective in detecting lba.

lbs is not effective because it incorrectly estimates the sequence present at the ancestral node. statistical sampling of the other sequences artificially causes the target taxon to appear like all the taxa rather than shortening its branch. this results in a loss of accuracy in the detection of lba.

both lbe and lbs suffer from a secondary effect. when a branch is extracted from the phylogeny or shortened, other branches are free to become the longest branch and will potentially draw other similarly long branches away from their correct locations. both maximum likelihood and maximum parsimony are subject to lba in felsenstein topologies and likelihood provides superior results in only a small part of the felsenstein zone.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
all authors designed, analyzed, implemented and tested the proposed algorithm. each author contributed equally in writing the paper. all authors read and approved the final manuscript.

