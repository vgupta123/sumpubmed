BACKGROUND
the most widely used series of substitution matrices, blosum  <cit>  and pam  <cit>  were developed using the same mathematical model which dictates that in a system where amino acids occur randomly, a matrix can be built in the log-odds form. while pam matrices are based on an underlying evolutionary model, blosum are not. however, it has been shown that matrices similar to blosum can also be constructed using an improved theoretical model of amino acid substitution frequencies  <cit> . while pam and blosum matrices used different approaches to derive amino acid target frequencies, both were constructed to implicitly represent substitutions between proteins of average amino acid composition. due to this implicit amino acid background, it has been demonstrated that such matrices are not optimal for comparing proteins with strongly biased amino acid distributions  <cit> . in fact, in these cases, the use of the blosum <dig> matrix for blast searches can result in deviations from the expected extreme value distribution  <cit> .

several works have been carried out into developing matrices which more accurately reflect amino acid substitution frequencies between proteins with a compositional bias. asymmetrical substitution matrices were constructed by yu et al.  <cit>  and bastien et al.  <cit>  in order to reflect the amino acid composition of both query and subject proteins in local alignments. in yu et al., the blosum <dig> matrix is adjusted for each pair of proteins to be aligned using the target amino acid frequencies of both query and subject proteins. with this adjustment, alignment of proteins with non-standard amino acid compositions showed closer agreement with predicted secondary structures and yielded higher bit scores when compared with alignments using unadjusted blosum <dig>  <cit> . bastien et al.  <cit>  used a different approach on a comparison between proteins from an unbiased genome  and those from a biased one . they introduced a method from information theory which allowed them to derive asymmetrical matrices iteratively from multiple alignments which included biased proteins.

the development of symmetrical substitution matrices has also been shown to be useful where proteins with similar bias are to be aligned. in ng et al.  <cit> , the phat matrices were constructed from carefully selected multiple alignments of hydrophobic and transmembrane regions, and were shown to be effective in improving local alignments of such regions. more recently, it was shown that by adjusting existing substitution matrices to compensate for the compositional bias in query proteins, better alignments of yeast glycoprotein low-complexity domains could be achieved  <cit> . although these methods all address different aspects of the problem of compositional bias, the case of aligning related proteins with a similar extreme bias has yet to be extensively studied.

in this work we present a novel approach to generate a series of symmetrical matrices starting from a set of multiple alignments whose sequences reflect the compositional bias of proteins to be aligned. we focus on the proteins of two species of the genus plasmodium. these protozoan parasites are the causal agents of malaria, for which the human forms result in over one million deaths annually  <cit> . in recent years a great effort has been undertaken to generate genomic sequence data for members of this genus, resulting in two complete genomes   <cit>  and many others with high sequence coverage . analyses of complete genomes showed that p. falciparum and p. yoelii genomes are both characterized by an unusually high content of a+t nucleotides  <cit> . this results in a large proportion of proteins with a biased amino acid composition and a peculiar frequency of low-complexity domains  <cit> .

in this work, we firstly show that the amino acid bias of p. falciparum and p. yoelii proteins is a proteome-wide phenomenon, not limited to low-complexity domains or to species specific proteins. beginning from selected biased multiple alignments of the blocks database  <cit> , and applying a novel procedure to cluster sequences at different percentages of identity, we generate log-odds matrices with an intrinsic amino acid bias representative of the parasite proteins. two series of matrices were constructed  according to criteria used to select multiple alignments in blocks. the performances of cbm, ccf and blosum matrices were assessed by means of blast database searches and it was observed that an improvement in the specificity and positive predictive values was obtained when cbm and ccf matrices were used. in particular, we show that the use of cbm and ccf matrices increases alignment scores for related proteins, and helps to filter out false positive hits. we then illustrate how our biased matrices may be used to improve ortholog detection within plasmodia species and to distinguish members of p. falciparum multi gene families more clearly between sub-families.

RESULTS
scoring blocks database
first of all, we analysed the compositional bias in p. falciparum and p. yoelii proteins to establish criteria with which to select blocks from the blocks database  <cit> . for each organism, we selected those proteins for which an annotated ortholog was identified outside of the plasmodia , and proteins classified as hypothetical without orthologs in other non-plasmodia . the proteins of each dataset were filtered to eliminate low complexity sequences, then the amino acid content of these regions was calculated. we then assessed the deviation of each amino acid frequency from the blosum <dig> compositional background . this allowed us to establish which amino acids were relatively over and under- represented in plasmodium proteins, irrespective of their absolute abundance. for instance, leucine and asparagine are both frequently found in plasmodium proteins , however, only asparagine deviates strongly from the blosum <dig> background. results in figure  <dig> show that the compositional bias in p. falciparum and p. yoelii proteins are not solely a result of low-complexity regions  <cit> , rather, that this feature is shared by complex sequences in both proteomes. furthermore, while the compositional bias is more pronounced in those proteins currently annotated as parasite specific , significant deviations from the blosum <dig> baseline also are seen in proteins with orthologs in other species . it is possible that the more pronounced bias for the pfh and pyh proteins is a consequence of current comparative methods not being optimised to assign orthologs to strongly biased proteins. irrespectively, the bias observed in the high complexity domains of all parasite proteins validates the necessity to develop specific substitution matrices.

amino acids that contributed most to the bias were identified as those which deviated by more than 20% from the baseline in at least one of the two datasets  both in p. falciparum and in p. yoelii . starting from the deviation distributions of these amino acids from the blosum <dig> compositional background, we developed a scoring method to select those multiple alignments in blocks data base whose sequences share the compositional bias of plasmodium proteins. this approach assumes that those sequences and all plasmodium proteins have similar background distributions and that the amino acid substitution frequencies observed in the alignments follow similar evolutionary rules and reflect those between plasmodium proteins.

a vector  was constructed in which amino acids were represented as + <dig> or - <dig> values according to the direction of deviation. similar vectors  were generated for each block in blocks and then compared with the template by means of a scalar product . three different parameters were introduced: s increases by  <dig> with each similar amino acid deviation shared between the template and the block; stringency was controlled by allowing up to  <dig> amino acids to be absent from a block  and since tryptophan rarely occurs both in plasmodium and blocks sequences a third parameter  was introduced that allows this amino acid to be absent. results of this scoring procedure are reported in table  <dig>  where the numbers of blocks selected for each choice of s, z and w are also shown.

a second scoring method calculates linear correlation coefficients  between the deviation distributions of plasmodium proteins and those of sequences in each block of multiple alignments. according to this first method we selected three series of blocks; r >  <dig>  , r >  <dig>  , r >  <dig>   .

s = required number of amino acids with expected deviation from blosum <dig> values; z = number of s amino acids allowed to be absent; w = value of one means tryptophan was allowed to be absent in addition to z others; r = correlation coefficient lower limit; b = number of resultant blocks.

clustering procedure
for constructing the blosum series of matrices, hierarchical clustering was used to group sequences of a given percentage identity before counting amino acid substitutions. this procedure reduces the contribution of closely related sequences to amino acid substitution counts as they are represented as a single cluster. a consequence of this is a loss of information, in fact, amino acid substitutions between sequences in the same cluster are not counted even if they do not share a level of similarity above the given threshold  <cit> .

for these reasons, we decided to develop a non-hierarchical fuzzy clustering procedure that permits a sequence to be in more than one cluster and ensures that this sequence shares a given level of identity with all the other members in the same cluster, thus ensuring that all amino acid substitutions members are correctly counted. fuzzy clustering algorithms have previously been used to represent the complex relationships between biological entities including amino acid sequences  <cit> .

in order to study the effect of the two clustering procedures on matrix construction, we analysed the relationship between clustering percentage used to group sequences and the entropy associated with the resulting matrix. we selected a subset of  <dig> biased multiple alignments from the blocks database and generated substitution matrices using both hierarchical and our non-hierarchical clustering algorithm . substitution matrices were constructed by clustering sequences from 100% to 10% identity and for each matrix, the corresponding entropy was calculated  in methods). matrices with identical entropies are generated when sequences are clustered at 100% , however while matrices constructed using hierarchical clustering have entropies which proportionally decrease with clustering percentage , matrices generated using our method show a different trend. their entropies  first increase to a maximum at 70% and then decrease while always maintaining higher values than the corresponding matrices obtained by hierarchical clustering. this shows that non-hierarchical clustering is particularly suited to those cases in which the retention of information is crucial. the construction of matrices from compositionally biased sequences is one such case, due to the reduced number of blocks and the reduced substitution diversity within blocks. this is demonstrated by direct inspection of matrices. in fact, hierarchical clustering results in matrices with a peculiar pattern of high scores along the principal diagonal and mostly zero scores in the other cells while this is not observed in matrices obtained by means of our clustering method .

for these reasons, our fuzzy clustering method was adopted to group sequences in compositionally biased selected multiple alignments and hence to generate novel series of compositionally biased matrices. we constructed  <dig> matrices grouped into  <dig> series  and for each of them we analysed the relationship of entropy to clustering percentage. the entropy trends observed for these matrices reflect those obtained from the previous analysis , apart from that obtained by using the cbm/ <dig> matrices which are characterized by very low entropies resulting from the low number of blocks used to generate them . in addition, we observed that a weak relaxation of selection criteria  does not imply a change in entropy values . rather, when selection criteria are strongly relaxed  entropies of the matrices increase  and reach maxima at 70% for cbm/ <dig> and cbm/ <dig>  we established that this was due to the fact that few large multiple alignments contribute greatly to the counts of amino acid substitutions. a weak relaxation of selection criteria results in the addition of more, but shorter blocks that lead to slightly modified matrices.

as an example, in figure  <dig> scores for blosum <dig>  and ccf <dig> clustered at 62%  are reported. as expected the scores along the principal diagonal remain similar between the two matrices. on the other hand, we observed that for certain amino acids which are strongly under-represented  or over-represented  in plasmodium proteins, ccf <dig> substitution scores are far more negative and more positive respectively.

performance of matrices assessed by blast local alignments
in order to assess the performance of novel matrices, we compared results of blast database searches obtained by using cbm/09-2- <dig>  cbm/10-2- <dig>  cbm/11-2- <dig>  ccf <dig> at 62% clustering, cbm/11-2- <dig> and ccf <dig> at 70% clustering  and blosum <dig> matrices . in order to negate the effect of entropy on matrix performance we constrained the entropy of each matrix to that of the blosum <dig> matrix .

a unique database of all p. falciparum and p. yoelii proteins with an assigned gene ontology was then constructed, and all p. falciparum vs all p. yoelii blast searches were performed. hits  for each blast search were pooled and ranked by bit score, then go identifiers of every pair of query and subject sequences were compared. only hits between proteins sharing gene ontologies were considered as true positives , while all other hits were considered false positives . the numbers of false positives and true positives were reported as rocn curves, and for every curve we calculated the area below . this is an indicator of the matrix performance. here, n was chosen to be  <dig> as this is the maximum number of false positives which are present in all searches that implied that not all hits for every database search were considered in this phase of assessment.

in general, the best performances  are obtained by using ccf <dig> matrices , cbm/10-2- <dig>  and the adjusted blosum <dig> . in more detail, all roc <dig> curves in figure  <dig> are very alike in the initial regions, showing, as expected, that all examined matrices perform similarly when aligning highly similar proteins. in fact, the first part of the curves correspond to hits at the top of the ranked list and hence to pairs of sequences with high bit scores. however, in the latter region , roc <dig> curves diverge from each other. the number of false positive hits increases steeply for cbm/09-2- <dig> and blosum <dig> while the other matrices show a less dramatic increase and thus better performance, in particular the matrix which works better in this region is cbm/10-2- <dig> as shown by the highest number of identified true positive hits.

these results were confirmed when we considered all hits for each database search and calculated other indicators of matrix performance, namely the positive predictive value  and the false discovery rate ) reported in table  <dig>  the best performing matrices by these criteria are cbm/10-2- <dig>  and ccf53_ <dig>  while results obtained by using the other novel matrices are comparable to those obtained by adjusted blosum <dig> 

%id = percentage clustering of selected blocks; ppv = tp/ positive predictive value; fdr = fp/fp+tp false discovery rate.

our results confirm that the usage of compositionally modified matrices improve the identification of pairs of homologous proteins reducing the number of false positive hits. in addition we demonstrated that matrices constructed by us using the novel clustering procedure show a better performance even when compared with the compositional adjusted blosum <dig> 

biased matrices improve ortholog detection for hypothetical plasmodium proteins
in a recent paper by chen and colleagues  <cit> , the performance of different methods of ortholog detection was assessed and it was shown that for homology based detection methods by blast the choice of e-value threshold has a strong effect on ortholog prediction error rates. as we have seen, our biased matrices result in better performance at an e-value of  <dig> × 10- <dig>  however, we now wished to demonstrate the effects of the choice of e-value on homology detection. blast evalues can be considered accurate when proteins to be aligned have amino acid compositions which are not too dissimilar. we have previously shown that this is the case for examined plasmodium proteins .

we considered proteins of p. falciparum and p. yoelii that are annotated as "hypothetical" . such proteins constitute 60% of each proteome. using blast, we aligned all  <dig> p. falciparum hypothetical proteins with all  <dig> p. yoelii hypothetical proteins and counted hits at two different e-value cutoffs. at the higher cut-off , we found that the use of cbm/10_2_ <dig>  identified  <dig> protein pairs while blosum <dig> identified  <dig> . following from the observations that the usage of our matrices improves sensitivity of a blast database search , we consider the extra  <dig> hits found only by blosum <dig> to be predominantly false positives. a case in point is that of mal13p <dig> . twelve p. yoelii protein hits are identified using blosum <dig>  while using cbm/10-2- <dig>  only the alignment with the candidate ortholog py <dig>  assessed from genomic synteny mappings clears the threshold.

at the lower e-value cut-off , we found  <dig> protein pairs using blosum <dig> and  <dig> using cbm/10-2- <dig> . this represents a reduction in the number of hits by  <dig> % and  <dig> % respectively, when compared to hits obtained at the  <dig> × 10- <dig> cut-off. this means that the choice of e-value cutoff has a less pronounced effect when using cbm/10-2- <dig> instead of blosum <dig>  coupled with the increased specificity already demonstrated in the previous section, this suggests that novel matrices can help to improve ortholog detection by rendering it less sensitive to cutoff changes and more accurate at high cutoffs.

interestingly, there are five protein pairs which were detected only by cbm/10-2- <dig> at a cutoff of  <dig> × 10- <dig>  of these, three pairs are candidate homologs, as evidenced by genomic synteny, while the other two proteins pairs cannot be evaluated due to lack of a detailed annotation. at a cutoff of  <dig> × 10- <dig> a single further specific hit was found between pf14_ <dig> and py <dig> whose genes are in a syntenic region.

improving annotation of rifin/stevor proteins in p. falciparum
rifin/stevor genes are members of the most numerous multigene family in p. falciparum genome. the family numbers more than  <dig> genes that are almost exclusively found in sub-telomeric regions of chromosomes, organized in repeated tandem arrays  <cit> . recent experimental data have shown that rifin and stevor products have different sub-cellular localization and are expressed in different stages of the parasite life cycle suggesting diverse but still unknown functions for these proteins  <cit> . categorisation of members of this multigene family is a difficult task, as is highlighted by the presence of several proteins still annotated as "putative", by the changing annotations of several family members  and by the shared interpro domain .

to assess the benefits of the use of compositionally adjusted matrices, we used both blosum <dig> and our matrices to classify family members.  <dig> proteins annotated as rifin/stevor were downloaded from plasmodb  <cit>  and all vs. all needleman-wunsch pairwise alignments  <cit>  were performed using ccf <dig> and blosum matrices at 62% clustering. a distance matrix was then built from similarity scores between each pair of proteins and this matrix was used as an input for classical multidimensional scaling   <cit> . this well known statistical method creates a two-dimensional space in which euclidean distances between points approximately reproduce those between sequences and thus allowed us to easily investigate similarity relationships between them.

for mds  using both blosum <dig>  and ccf <dig> , sequences  are grouped into three main clusters; one corresponds to the stevor sub-family while the others correspond to the rifin subfamilies, rif_a and rif_b  <cit> . interestingly, however, when blosum <dig> is used, clusters are not clearly defined making it difficult to assign sequences to a specific family. when ccf <dig> was used, clusters are more compact and definable and distances between clusters increase. thus, the usage of novel matrices allowed us to distinguish clearly between subfamilies and clarify the classification of several borderline proteins .

discussion
it is well recognised that dissimilar amino acid composition can affect alignments between proteins and as a consequence, can affect the accuracy of sequence similarity searches  <cit> . it thus holds, that in the case of compositionally biased proteomes, specific techniques should be adopted to maximise the protein annotation efficiency. this is particularly true for p. falciparum as it has been shown in several previous studies that the proteome is strongly biased towards certain amino acids  <cit> . in pizzi et al.  <cit>  it was shown that a large part of this bias is accounted for by frequent peculiar low-complexity sequences, characterised by a redundant usage of few amino acids. by assessing the compositional bias only on low-complexity filtered sequences, we carried out an analysis on proteins of both p. falciparum and p. yoelii and observed that, as expected, the compositional bias is strongly maintained in globular regions of these proteomes.

while many methods have been developed to date to deal with the issue of comparing proteins with a compositional bias, they have all been based on heuristic approaches  <cit>  or on very specific protein sub-domains  <cit> . in this work, we wished to explore the possibility of empirically generating a series of substitution matrices which accurately represent substitution patterns between similarly biased proteins. to do this, we adjusted the method used for the generation of the blosum substitution matrices. this empirical procedure is based on the amino acid substitution frequencies between sequences in multiple alignments  in blocks data base. the crucial steps in the matrix generation are the choice of the subset of blocks and the clustering method used to remove redundant sequences within those blocks.

the first adjustment to the procedure was to use only those blocks with a compositional bias similar to the selected proteomes, making the assumption that the amino acid substitution rules are conserved throughout evolution. this eliminated between 96% and  <dig> % of the blocks database, depending on the selection criteria, but allowed us to count substitution frequencies only in those protein domains with the desired bias.

the second adjustment was to develop a sequence clustering method which allowed us to maintain a complete representation of substitution frequencies while removing bias due to highly similar sequences. classical procedures such as hierarchical and single-linkage clustering  are not able to provide a complete representation of the complex network of sequence relationships. the main limitation resides in the requirement for a sequence to be member of a single cluster. pyramidal clustering  <cit>  is an example of how to effectively overcome this problem, permitting a sequence to be in up to two clusters. in the case of our algorithm we followed a similar approach, however our clustering procedure allows sequences to belong to multiple clusters , and ensures that all members of a cluster share a given similarity. we showed that this fuzzy clustering was important in the case of biased matrices as it allowed us to maintain sufficient substitution information to construct matrices solely from biased blocks.

in the absence of a bone fide test dataset of similarly biased proteins, the use of go allowed us to assess the accuracy of protein alignments. for this reason, we first considered all p. falciparum and p. yoelii proteins for which gene ontology  annotations are available. a possible flaw in this assessment criteria is that go annotations are sometimes assigned solely as a result of sequence similarity between proteins. as this is only done when there is a very high level of homology incorrect go assignments should be minimal. we aligned by blast, all selected p. falciparum proteins with all selected p. yoelii proteins using our matrices, blosum <dig>  and a heuristic blast method published recently based on a compositional adjustment of blosum <dig>  <cit> . comparison with this heuristic blosum adjustment serves as a reference since it was already shown to improve alignments of biased proteins. we obtained the best results by using matrices ccf <dig> and cbm/10-2- <dig>  these outperformed both blosum <dig> and adjusted blosum <dig> in blast searches. the use of all of our matrices resulted in a dramatic reduction in false positive  alignments with respect to blosum <dig>  and in all cases yielded a similar improvement to that achieved using the compositional adjustment blast heuristic. furthermore, higher bit scores and e-values, and lower lengths for true positive hits were found by using ccf/cbm instead of blosum matrices. to explain these results, we must consider the way in which the smith-waterman algorithm works. in the scoring matrix constructed by dynamic programming, local similarities are identified as continuous diagonals flanked by cells with zero values. starting from the highest scoring similar regions, substitution scores in blosum <dig> facilitate the elongation of diagonals, thereby extending the alignments and often decreasing the global bit-scores. on the other hand, lower substitution scores in ccf/cbm matrices impede the elongation process, and in case of low similarity between sequences do not allow extension of diagonals which may correspond to unreliable alignments.

having established the better performance of our matrices with respect blosum series, we investigated the possibility of using them to improve annotation of plasmodium proteins for which orthologs in other organisms are not known and hence are potentially specific for the parasites. we used cbm/10-2- <dig> to identify homologs between p. falciparum and p. yoelii proteins that are annotated as "hypothetical". since these and more frequent low-complexity sequences we would expect that number of possible false positive hits to increase greatly and hence, make the identification of homologs particularly difficult. our matrices identify far less putative homologs than blosum <dig>  and also yield a more consistent result set at an e-value of  <dig> × 10- <dig> .

as the e-value accuracy has been shown to be an important criterion for ortholog annotation  <cit> , the increased alignment confidence at low e-values using our matrices will improve the initial step of the orthomcl algorithm  <cit>  on which the current ortholog mappings for plasmodia are based.

we finally showed a non-blast based application of our method. the accurate annotation of proteins belonging to rifin/stevor family represents a difficult task because of the sequence variability between members. although more than  <dig> proteins are assigned to this family, evidence is emerging that they have many and diverse sub-cellular localization, differential expression patterns and hence probable diverse functions  <cit> . furthermore it was established that stevors constitute a small distant subset of proteins while rifins can be divided into two subgroups of proteins  <cit> . global alignments using the needleman-wunsch algorithm were performed between all proteins annotated as rifin/stevor using both ccf <dig> and blosum <dig> matrices. the derived global similarity percentages were thus used to construct distance matrices. in order to explore relationships among members of the family, we performed multidimensional scaling that provides a simple visualisation of sequences as points in a two dimensional space.

when we used ccf <dig>  instead of blosum <dig>  distances between sub-families  are much larger and thus a clear classification of the proteins into distinct families was obtained, especially in the case of rif_a and rif_b. interestingly, by this method we can also identify the more likely evolutionary links between these gene families as those proteins which remain near the periphery of clusters.

CONCLUSIONS
in this work, we illustrated the role played by amino acid distributions in the accuracy of protein alignments between two related species which have similarly skewed background amino acid compositions. we showed that a novel series of compositionally adjusted matrices are better suited to compare diverse classes of plasmodium proteins. when cbm/ccf matrices are used a reduction in the number of false positive hits is observed, more consistent results in the identification of homologs between plasmodium species are obtained and a clearer classification for members of a multigene families is achieved.

the use of these matrices will increase confidence in the annotation of the proteins from these organisms and from others which share a similar amino acid compositional bias. this will further permit a refined analysis of polymorphisms at the amino acid level which will be of considerable interest given the imminent sequencing of a large number of plasmodium genomes, including p. falciparum field isolates.

