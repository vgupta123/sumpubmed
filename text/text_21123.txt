BACKGROUND
morphological symmetry results from the repetition of parts in different orientations or positions and is widespread in the body plans of most organisms. for example, the human body is bilaterally symmetric in external appearance because the same anatomical parts are repeated on the left and right sides. likewise, many flowers are radially symmetric because sets of petals and other organs are repeated in circular patterns. the evolution of morphological symmetry is of interest in its own right  <cit>  and variation among repeated parts, such as fluctuating asymmetry, has been widely used for research in evolutionary biology  <cit> . for instance, fluctuating asymmetry can be viewed as a measure of developmental instability  <cit>  and has been related to measures of environmental stress  <cit> , hybridization  <cit> , or fitness  <cit> . in a different context, fluctuating asymmetry can also be used to investigate the developmental origin of morphological integration  <cit> .

because bilateral symmetry is the most widespread and simplest type of symmetry, it has been the most studied in various contexts  <cit> . the symmetry and asymmetry of shape have been studied with the methods of geometric morphometrics  <cit> . bookstein  <cit>  and auffray et al.  <cit>  briefly outlined a procedure for the shape analysis of symmetric structures that are bilaterally symmetric as a whole . mardia et al.  <cit>  and kent and mardia  <cit>  established the mathematical basis and computational procedure for this method, and klingenberg et al.  <cit>  integrated it with the existing methods for the study of biological symmetry and asymmetry.

whereas bilateral symmetry has been the focus of most studies, it is not the only kind of symmetry in living organisms . a range of different types of symmetry occur both in plants and animals  <cit> . so far, there is no general method for the morphometric analysis of all these types of symmetry, although some methods have been proposed for specific types  <cit>  and an application of the present methodology to one type of symmetry has been published  <cit> . in other contexts, however, related approaches have been developed: for instance, in chemistry and computer vision a general method for quantifying how close a single configuration of points is to a symmetric shape, for any type of symmetry  <cit> , and in engineering a method to incorporate symmetry in computations of the mechanical loading of structures  <cit> . no general framework exists, however, that extends the existing concepts and methods for studying morphometric variation of symmetric structures and biological asymmetry to all types of symmetry.

in this paper, we generalize the approach of mardia et al.  <cit> , which is restricted to bilateral symmetry, for the shape analysis of structures with any type of symmetry. our generalization is based on the theory of symmetry groups  <cit> , which is long established in mathematics, but so far has not been used in the context of morphometric shape analysis. we focus on symmetric structures that possess anatomical landmarks, and thus exclude smooth symmetric structures such as circles, spheres, or ellipsoids because landmarks cannot be located on them. our method can separate a component of symmetric variation among individuals from one or more asymmetry components, depending on the specific type of complex symmetry.

this paper first reviews the mathematical definition of symmetry and the theory of symmetry groups  <cit> , which may not be familiar to evolutionary biologists. we show that the approach of mardia et al.  <cit>  for bilateral symmetry is a special case of a more general framework based on symmetry groups. we explain how the concepts of fluctuating and directional asymmetry can be extended to all types of symmetry. we also generalize procrustes anova, a method for quantifying symmetric and asymmetric components of shape variation  <cit> , to complex types of symmetry. finally, we illustrate this new approach with an example using landmark data collected from skeletal structures of a colonial coral. because the symmetry of these structures is ambiguous, we are able to demonstrate analyses with different types of symmetry for this data set.

RESULTS
mathematical definition of symmetry
many types of symmetry exist in nature besides the familiar bilateral symmetry. some organisms, such as the green alga micrasterias  have two perpendicular axes  of reflection symmetry . others exhibit rotational symmetry  where parts are arranged around a central point  so that each part is rotated from the neighbouring ones by a certain angle . many organisms show translational symmetry, better known as serial homology, in which the body is divided into a suite of parts that are repeated along the body axis . many mollusc shells  show scale symmetry : rotational symmetry is combined with translational symmetry and dilation, so that the object gradually expands from one whorl to the next . these basic types of symmetry can be combined to produce a large diversity of symmetry patterns. unfortunately, this biological conception of symmetry is not suitable for a rigorous quantitative study of symmetry.

instead, we use a definition of symmetry that was developed in a mathematical context  <cit> . to derive the definition, we consider the changes that an object undergoes when a geometric transformation is applied to it. a transformation is a geometric change that maintains a one-to-one correspondence among all points of the object in the plane   <cit> . in other words, a transformation maps every point of the object in the plane  onto another point in the same plane  and is reversible . d'arcy thompson's  <cit>  transformation grids are a visualization of transformations in two dimensions, which are familiar to most morphometricians. in the context of symmetry, some particular transformations are of special interest. the simplest of these transformations is the identity that maps every point of the plane onto itself. other transformations important for the study of symmetry are translation , rotation, reflection, stretch , and their combinations  <cit> . usually, applying a transformation to an object changes the object so that at least some of its points are in different positions before and after the transformation.

in geometry, symmetry is defined as invariance of an object to a particular transformation that can be applied to it, such that the object is the same before and after transformation  <cit> . the object remains unchanged after the transformation precisely if it is symmetric with respect to that transformation. for instance, the human face is symmetric because it is invariant to reflection about the median plane. this transformation brings the left side of the face onto the right side and vice-versa, but because the two sides are mirror images of each other, the face as a whole is left unchanged . objects can have several symmetries if they are invariant to several transformations. for instance, the equilateral triangle is invariant to rotation by 120°, rotation by 240° and to reflection about three axes . in addition, every object is symmetric with respect to the transformation that does not change the object, which is called the identity . the transformations that leave an object unchanged are called the symmetry transformations for that object. which transformations are symmetry transformations depends on the object: there are many objects that have no symmetry at all and therefore have no symmetry transformations , whereas other objects may have several.

the symmetry transformations of an object jointly characterize its symmetry. for instance, bilateral symmetry is defined by two symmetry transformations: reflection and the identity. the set of symmetry transformations of an object forms a special kind of set called a symmetry group . the symmetry group has four special properties, as follows.  if any two symmetry transformations are combined, the result is another transformation that is contained in the symmetry group .  the symmetry group contains the identity as one of its elements.  for every symmetry transformation, there is a transformation in the symmetry group that undoes the change produced by the first transformation . the inverse may be the symmetry transformation itself . finally,  for combinations of any three symmetry transformations a, b and c, the equality c = a holds . due to these properties, the powerful mathematical tools of group theory can be used for studying symmetry . for bilateral symmetry, the symmetry group contains just two transformations: the identity and the reflection about the axis or plane of symmetry for the object. for the symmetry of the equilateral triangle, the symmetry group contains six elements combining rotations  and a reflection .

the order of a group is the number of distinct elements in the group. some symmetry groups are of finite order, because the repeated application of the same transformation eventually maps the object onto itself and thus produces only a finite number of different transformations . these are called finite symmetry groups. all finite symmetry groups in two and three dimensions consist of rotations and reflections   <cit> . in contrast, any symmetry groups that contain translations are not finite, because for any transformation that consists of applying a translation n times, the symmetry group must also contain the transformation that consists in applying the translation n +  <dig> times, and so on. similarly, if a transformation changes the scale of the object, repeated application of this transformation makes the object either larger and larger or smaller and smaller without end. therefore, translational symmetry  and spiral symmetry  are associated with infinite symmetry groups.

matching symmetry and object symmetry
in their paper on shape analysis of bilateral symmetry, mardia et al.  <cit>  distinguished matching symmetry, where there are pairs of separate structures on the left and right sides, from object symmetry, where a single structure is internally symmetric. matching symmetry concerns pairs of structures that are present as physically separated mirror images on the left and right sides . the analysis uses the separate landmark configurations for the left and right structures of each individual in the sample, applies a reflection to the configurations from one side, and then a procrustes fit to the combined sample  <cit> . matching symmetry can be extended to other types of symmetry in a straightforward manner: instead of pairs of structures on the left and right sides, there is simply a different arrangement of multiple corresponding parts that reflects the symmetry in question. examples of matching symmetry are found in the petals of radially symmetric flowers  or the vertebrae that make up the translational symmetry of the vertebral column . analyses of matching symmetry focus on the landmark configurations for the repeated parts, rather than on the composite structure as a whole. a first step in the analysis is therefore to divide a structure into parts , and corresponding landmarks are then recorded on each of the parts. because this decomposition into parts is possible regardless of the structure or order of the symmetry group, analysis of matching symmetry is possible for any type of symmetry.

object symmetry concerns structures that are symmetric as a whole  <cit> . for instance, the vertebrate skull has object symmetry because a plane of bilateral symmetry passes through the middle of the skull, and the skull as a whole is invariant under reflections about this plane. structures with other types of symmetry can also be invariant as a whole under the symmetry transformations of their respective symmetry group. for instance, the algal cell in figure 1a is invariant under reflections about the horizontal and vertical axes  and the flower in figure 1b is invariant as a whole under five rotations. as for the case of bilateral symmetry, the axes or planes of reflection symmetry pass through the configuration of landmarks and the centre or one or more axes of rotation are situated inside the configuration.

because object symmetry requires the entire object to be invariant under the transformations in the symmetry groups, some limitations are imposed on the types of symmetry for which object symmetry is possible. for instance, an object cannot be invariant to transformations involving a change of scale. likewise, a finite object cannot be invariant to transformations involving translations because at least the ends of the object would not be invariant. moreover, for objects with distinct landmarks , rotations are limited to those by an angle of 360°/n  and multiples thereof. as a consequence of these limitations, object symmetry applies only to those types of symmetry that are associated with finite symmetry groups. these symmetry groups consist of rotations, reflection, or a combination of rotations and reflections . for types of symmetry associated with infinite symmetry groups, such as translational or spiral symmetry , shape analysis must use matching symmetry by focusing on the repeated parts, rather than the structure as a whole.

shape analysis of matching symmetry
bilateral symmetry
for studies of structures with matching symmetry, the analysis starts with a pair of separate landmark configurations from the left and right sides of each individual in the sample. first, the landmark configurations from one side are reflected. then, a generalized procrustes fit superimposes all configurations and produces an overall mean shape . the procrustes fit, by definition, automatically adjusts for rotations and translations of the configurations to bring all of them into a standard position and orientation .

the variation around the consensus is decomposed into a component of variation among individuals and a component of left-right asymmetry. the variation among individuals is computed from the average shapes of the left and right sides for each individual in the sample. asymmetry is quantified from the shape differences between the left and right sides for each individual. the average asymmetry is interpreted as directional asymmetry and the individual variation in asymmetry as fluctuating asymmetry .

to quantify the different effects, we can use the decomposition of the sum of squared procrustes distances of the configurations from the overall mean shape  <cit> :

  ∑i=1n∑s=l,rd2xis,x¯=2∑i=1nd2x¯i⋅,x¯+n∑s=l,rd2x¯⋅s,x¯+∑i=1n∑s=l,rd2xis,x¯i⋅+x¯⋅s-x¯ 

in this equation, the expression d <dig> denotes the squared procrustes  distance between two landmark configurations a and b . the landmark configuration xis is the configuration for side s of the i-th individual . the overall mean configuration is x¯, the consensus of the i-th individual is x¯i⋅ and x¯⋅s stands for the mean for side s across individuals . the first sum on the right-hand side of the equation stands for the shape variation among individuals, the second sum stands for directional asymmetry, and the third sum stands for fluctuating asymmetry. this decomposition of the total sum of squares corresponds to the two-factor anova design of leamy  <cit>  and palmer and strobeck  <cit> , and it is the basis for the procrustes anova  <cit> .

note that the decomposition of the sum of squared procrustes distances and procrustes anova usually are only preliminary steps to quantify the relative amounts of variation at the different levels. in particular, reducing shape variation to a scalar distance measure ignores the patterning of variation in the multidimensional space. to extract information from those patterns, the preliminary assessments based on procrustes distances are usually followed by multivariate analyses of individual variation and asymmetry that can address a wide range of biological questions  <cit> . depending on the particular questions of interest, methods used in these analyses can include principal component analysis  <cit> , partial least squares  <cit> , matrix correlation  <cit> , or tests of modularity  <cit> .

other types of symmetry
matching symmetry can be generalized directly from bilateral symmetry to any type of symmetry. the main difference is the number and arrangement of the parts that are considered for each individual in the sample, which also results in different components of asymmetry. instead of a pair of parts on the left and right sides, there may be more than two parts, which can be arranged in many different ways. for example, the flower of figure 1b has five petals, which can be included in the analysis as five separate configurations of landmarks. depending on the arrangement of parts, reflection may need to be used to match corresponding landmarks for all configurations. finally, a procrustes fit is used to superimpose all configurations simultaneously and components of variation around the consensus shape can be extracted.

the partitioning of the components of variation extends the type of analysis used for bilateral symmetry. a component of variation among individuals is computed from the averages of the landmark configurations of parts for each individual. directional asymmetry can be visualised by comparing the mean shape for each of the repeated parts to the grand mean across all parts. fluctuating asymmetry is the individual variation of the deviations of each repeated part from the individual average of all parts.

the decomposition of the sum of squared procrustes distances of the shapes of the landmark configurations from the overall mean shape is also a direct extension of the formula for bilateral symmetry :

  ∑i=1n∑s=1pd2xis,x¯=p∑i=1nd2x¯i⋅,x¯+n∑s=1pd2x¯⋅s,x¯+∑i=1n∑s=1pd2xis,x¯i⋅+x¯⋅s-x¯ 

in this equation, the summation over the parts for each individual is not limited to the left and right sides, but can accommodate any number of repeated parts, p, for each individual . otherwise, the decomposition is identical to equation  and it also yields three separate sums of squared procrustes distances that correspond to the variation among individuals, directional and fluctuating asymmetry.

the decomposition in equation  is a "minimal" version in which the asymmetry, the variation among parts of each individual, is included as a single component . for example, an analysis of variation in a sample of radially symmetric flowers can use the variation among petal shapes to extract a component of directional asymmetry  and a component of fluctuating asymmetry .

depending on the number and arrangement of parts, however, it may be possible to decompose asymmetry further into multiple components. such a more complex decomposition is possible for the example of the alga in figure 1a, because its symmetry results from a reflection about the horizontal axis and a rotation by 180°   <cit> . accordingly, two separate components of asymmetry can be distinguished: asymmetry in the vertical and horizontal directions  and an "interaction" effect that indicates how much each of the four "quadrants" differs from the combined effects of the two main asymmetries. this partitioning applies both to the mean asymmetries  and to the individual variation of asymmetries . depending on the arrangement of repeated parts, the information gained from the analysis of symmetry and asymmetry therefore may be substantially more intricate than for bilateral symmetry.

as in the case of bilateral symmetry, a variety of multivariate analyses can be used to investigate the patterns of variation in the differences or averages among repeated parts. this is a potentially rich, but so far unexplored area for morphometric studies.

parts with object symmetry
for many structures that have matching symmetry overall, the repeated parts themselves show bilateral object symmetry. this applies to the vertebrae in a vertebral column  or the chambers in a nautilus shell , as well as for the petals of many flowers . in this case, the object symmetry of the parts can be combined with the data structure that reflects the overall matching symmetry. for instance, an analysis of the vertebral column may include the anterior-posterior sequence of vertebrae and the bilateral object symmetry of each vertebra  <cit> . such an analysis would include the original and reflected and relabelled copies of each measured vertebra in the vertebral column to take into account the object symmetry of each vertebra. an analysis of anterior-posterior differences among vertebrae would use the left-right symmetric component computed from the averages of the original and reflected copies of each vertebra. analyses of asymmetry might be conducted separately for each vertebra, or they might be done in combination to examine changes in asymmetry along the vertebral column .

shape analysis of object symmetry
bilateral symmetry
because the shape analysis for object symmetry is somewhat more complex than for matching symmetry, we review the established method for analyzing bilateral object symmetry  <cit>  and provide a new explanation from the perspective of symmetry groups, which we then use as the starting point for the generalization to any type of symmetry. the analysis of left-right variation with object symmetry is based on a single configuration of landmarks that includes both sides of the structure. there are two types of landmarks in the original configuration: paired and unpaired landmarks  <cit> . the paired landmarks occur on each side of the structure outside the middle plane or axis , whereas unpaired landmarks are located in the middle plane or axis .

for each specimen, a reflected copy of the original configuration of landmarks is produced . because the reflection brings the landmarks from the right side onto the left side and vice versa, the paired landmarks are relabelled by exchanging the labels between left and right paired landmarks of the reflected copy to make them compatible with the paired landmarks of the original configuration. finally, a procrustes fit superimposes both the original configurations of landmarks and their reflected and relabelled copies  <cit> .

the resulting consensus configuration is symmetric under reflection  <cit> . because a reflected and an unchanged copy of the original configuration are used for each individual, applying reflection and relabelling to all configurations will yield the same pair of configurations , and the procrustes fit will produce the same average shape. therefore, the pair of configurations used for each specimen and the resulting average shape are invariant under reflection and relabelling, and thus the average shape is symmetric .

the variation around the consensus is decomposed into a component of symmetric variation and a component of asymmetry  <cit> . the symmetric component is computed from the average of the original configuration and reflected and relabelled copy of each individual. symmetric variation is the variation of these averages among the individuals in the data. asymmetry is calculated from the differences between the original configurations and reflected and relabelled copies. directional asymmetry is the average asymmetry, whereas fluctuating asymmetry is the variation of the individual asymmetries  <cit> .

mardia et al.  provided a decomposition of the sum of squared procrustes distances between the original configurations and the corresponding reflected and relabelled copies. we can expand this slightly, in line with equations  and , by providing the complete decomposition of the sum of squared procrustes distances of each configuration from the overall consensus:

  ∑i=1n∑s=o,rd2xis,x¯=2∑i=1nd2x¯i⋅,x¯+n∑s=o,rd2x¯⋅s,x¯+∑i=1n∑s=o,rd2xis,x¯i⋅+x¯⋅s-x¯ 

note that this expression is identical to the one for bilateral matching symmetry  except for the subscript s, which now takes the values o and r for the original and reflected copy, respectively.

the patterns of covariation in the symmetric and symmetric components of variation can be further explored in multivariate analyses to answer a wide range of questions. such analyses can use principal component analysis  <cit> , partial least squares  <cit> , matrix correlation  <cit> , multivariate regression  <cit> , or modularity tests  <cit> .

it is useful at this point to reconsider this established method from the new perspective of symmetry groups. for bilateral symmetry, the symmetry group consists of just two symmetry transformations: the identity and a reflection. the unchanged and reflected copies of each configuration that are included in the procrustes fit can therefore be interpreted as a set of copies of each original configuration to which the whole set of symmetry transformations has been applied. the relabelling serves to map each landmark to the corresponding one after the transformation: for the reflection, each paired landmark is mapped to its equivalent on the opposite side and each median landmark is mapped to itself .

this reasoning can also be used to understand why the procrustes average of the unchanged copy and the copy that has been reflected and relabelled must be symmetric. the pair of unchanged and reflected copies of each configuration is invariant under reflection because the two transformations that were applied to the original configuration  constitute the entire symmetry group. if we combine any given symmetry transformation with each of the transformations in the symmetry group, the resulting transformations must also be elements of the symmetry group. therefore, the set of all the resulting transformations is the same as the original symmetry group. as a consequence, the procrustes average of the complete set of copies must be the same before and after the transformation, and therefore is symmetric.

these explanations from the perspective of symmetry groups may seem an overly complicated manner of describing the procedure and of justifying why the consensus is symmetric, but this new reasoning has the advantage of offering a direct way to generalize the analysis to more complex types of symmetry.

generalization to other types of symmetry
using the reasoning based on symmetry groups, it is possible to extend the method for analyzing object symmetry to any type of symmetry that is associated with a finite symmetry group. all finite symmetry groups can be generated by reflection, rotation or a combination of both. for configurations in two dimensions, a symmetry group can contain only a single rotation about a central point. this rotation can have different orders, the number of repeated steps it takes to cover a full circle . overall, therefore, reflection, rotation of different orders, and their combinations are the only kinds of object symmetry in two-dimensional data. in three dimensions, however, there can be rotations about a single axis, about two perpendicular axes, or the more complex arrangement of axes in the symmetries of the platonic solids . in total, there are  <dig> types of finite symmetry groups in three-dimensional space  <cit> , which are listed in table  <dig>  of these, the first two symmetry groups, consisting of rotations about a single axis with or without reflection, are by far the most frequent in biological structures, whereas most other types are rarely found .

bilateral symmetry can be viewed as a special case of cnv or cnh with a rotation of order  <dig> 

the idea for shape analysis with object symmetry of any type is to assemble a data set containing copies of each original landmark configuration to which all the transformations in the symmetry group have been applied with the appropriate relabelling, and then to perform a generalized procrustes fit on this data set. as for bilateral symmetry, the resulting consensus shape is symmetric and it is possible to extract components of symmetric and asymmetric variation by computing the appropriate averages or differences between landmark configurations after the procrustes fit.

because all finite symmetry groups consist of rotations and reflections, it is sufficient to consider the steps to produce the transformed and relabelled copies for reflection and rotation. for reflection, there are paired and unpaired landmarks. the reflection itself can be carried out by changing the sign of one coordinate for all landmarks . the relabelling maps each paired landmark to the corresponding landmark of the opposite side and each unpaired landmark to itself. for rotations, there are two types of landmarks: landmarks on the centre or axis of rotation, and the remaining landmarks, which are repeated in each of the sectors defined by the rotation. to prepare rotated copies of the original configuration for the combined dataset, only the relabelling is necessary, because the procrustes fit will automatically perform the appropriate rotations to fit the relabelled landmark configurations to each other. a separate relabelled copy is produced for rotation by one step, two steps, and so on up to the order of the rotation . it does not matter whether the rotations are done clockwise or counter-clockwise, because all possible steps are included in either way. if the symmetry group contains reflection and rotation or more than one rotation, all possible combinations need to be included in the combined dataset. for instance, if an object has rotational symmetry of order three and reflection symmetry , six copies of each original landmark configuration will be included in the combined data set.

the generalized procrustes fit of the combined data set produces a consensus shape that is invariant under all the transformations in the symmetry group, that is, a completely symmetric shape. because the set of transformations used to produce the combined dataset is the complete symmetry group, applying any of the symmetry transformations leaves the set unchanged as a whole, and therefore does not alter the average shape resulting from the procrustes fit. therefore, the consensus shape is invariant under all the symmetry transformations, and is thus perfectly symmetric. this is true both for the consensus shapes for individual specimens  and for the combined procrustes fit of all specimens jointly .

the final alignment of landmark configurations in the generalized procrustes fit is obtained by an ordinary procrustes fit of each configuration to the consensus shape  <cit> . because the consensus shape is perfectly symmetric under all transformations in the symmetry group, the alignments of the transformed and relabelled copies of each configuration all share the same centroid and differ exactly by the symmetry transformations. for instance, the six transformed copies of the triangle in figure  <dig> differ from each other by rotations of exactly 120° or 240°, by a reflection about the vertical axis, or a combination of both .

because of the symmetry of the consensus configuration, the procrustes distance between it and every transformed and relabelled copy must be the same for each specimen included in the analysis. this applies both for the consensus configuration for each particular specimen and for the grand mean across all copies of all specimens included in an analysis . these regularities have direct consequences for the structure of variation in the shape tangent space. recall that usually the mean shape is chosen as the tangent point  <cit> , the point where the tangent space touches kendall's shape space and which also serves as the origin for the coordinate system in the tangent space; in the present context, this is the completely symmetric consensus. because all copies of each specimen have the same procrustes distance from that specimen's consensus and all copies have the same distance from the overall consensus, these copies are located on a hypersphere in shape tangent space . moreover, copies differing by a rotation of a given angle about the same centre or axis are separated by equal procrustes distances .

it is possible to extract and quantify components of symmetric and asymmetric variation by averaging the transformed and relabelled copies or by computing differences between them. the decomposition of the total sum of squared procrustes distances in a sample into these components of symmetric and asymmetric variation is a direct extension of the decomposition for bilateral symmetry :

  ∑i=1n∑s=1od2xis,x¯=o∑i=1nd2x¯i⋅,x¯+n∑s=1od2x¯⋅s,x¯+∑i=1n∑s=1od2xis,x¯i⋅+x¯⋅s-x¯ 

the difference to equation  for bilateral symmetry is that any symmetry group can be accommodated. accordingly, the subscript s, which stands for the symmetry transformation, now runs from one to o, the order of the symmetry group . the sums over all transformation in the symmetry group may have more than two summands . as for bilateral symmetry, this decomposition provides separate sums of squares for the symmetric component of variation and for directional and fluctuating asymmetry.

a component of symmetric variation among individuals can be computed from the variation among the average shapes for the complete set of copies for each specimen. directional asymmetry can be obtained as the difference of the average shape of all original configurations from the overall procrustes consensus of the original and transformed copies. fluctuating asymmetry can be computed from the variation of the individual asymmetries. these computations are direct extensions of those for bilateral object symmetry  <cit> . the difference is that there may be more than one component of asymmetry, depending on the transformations included in the symmetry group. in this case, some of these components of asymmetry will be partially symmetric . for instance, for the symmetry group of rotations of order  <dig>  there is an asymmetry component that is symmetric under rotations of order  <dig> but asymmetric under rotations of order  <dig>  in addition to a component asymmetric under rotations of any order.

the symmetric and asymmetric components of variation occupy mutually orthogonal subspaces of the shape tangent space, again extending the situation found for bilateral symmetry  <cit> . these subspaces can be characterized and their dimensionality can be obtained by enumerating the degrees of freedom  <cit> . because the subspaces differ among symmetry groups, this must be done separately for each type of symmetry. for this purpose, it is helpful to consider the orbifold  <cit>  for the symmetry group of interest, the portion of the configuration that is repeated by the symmetry transformations, and the landmarks contained in it and on its borders .

here, we only work out the dimensionalities of these subspaces for symmetry groups containing a single rotation with or without reflection. together with bilateral symmetry, these are all the possible types of complex object symmetry for two-dimensional data . for three-dimensional data, however, these two types do not cover all possibilities for complex object symmetry , but they are by far the most widespread types of complex symmetry in the shapes of organisms and their parts .

for the types of symmetry involving a single rotation, the configuration of landmarks can be divided into sectors, which are the repeated units . to compute the symmetry and asymmetry components of the shape space, it is useful to distinguish the landmarks in the centre of rotation  from the landmarks in each sector . if the order of rotation is denoted o, there are o sectors, each with k landmarks, and there are c landmarks on the centre or axis of rotation , so that the total number of landmarks is ko + c.

for symmetry involving rotation only, shape variation has a symmetric and an asymmetric component . for the symmetric component, the positions of landmarks in one sector can vary freely, which completely determines the landmark shifts in all other sectors; the central landmarks can shift only for 3d data, in the direction of the axis of rotation; and there are global constraints due to size and orientation and, for 3d data, due to position along the axis of rotation. for the asymmetric component, the landmarks of all sectors but one can move freely; the central landmarks can vary ; and there are constraints due to overall position and, for 3d data, due to orientation . for rotations of order three or greater, the dimensionality of the asymmetric component is therefore substantially greater than that of the symmetric component. these degrees of freedom sum up to the total dimensionality of the shape tangent space, and the different components of variation occupy complementary subspaces in shape tangent space.

3p+b+m+c-2
if o is odd:
3p+b+m+c-2
if o is odd:
notation: for rotational symmetry of order o, the complete landmark configuration can be subdivided into o different sectors . each sector contains k landmarks. in addition, there are c landmarks on the centre or axis of rotation . the sample consists of n individuals , and each specimen has been digitized r times.

if the symmetry group includes both rotation and reflection , there is a totally symmetric component of variation and the asymmetric component can be subdivided into a component symmetric under reflection only, a component symmetric under rotation only, and a component that is symmetric under neither rotation nor reflection . for this type of symmetry, each sector of the landmark configuration is bilaterally symmetric and it is possible to distinguish three kinds of landmarks in each sector : there are b landmarks on each of the boundaries between sectors, m on the midline or mid-plane of each sector, and p pairs of corresponding landmarks on either side of the midline . for working out the degrees of freedom of each component , the focus is on sectors for the rotational aspects of symmetry  or on the paired and unpaired landmarks for aspects concerning reflection . for 3d data, it is necessary to distinguish cases with even and odd order of rotation because the plane of symmetry runs through two sector boundaries if the order of rotation is even and through a boundary and a mid-plane if the order of rotation is odd . for all these cases, the degrees of freedom for the different components of variation sum up to the dimensionality of the shape tangent space and the components of variation define complementary subspaces.

for types of symmetry groups where the asymmetric component of shape variation can be subdivided into multiple complementary subspaces , this separation applies both to directional and fluctuating asymmetry. these components can be studied separately and may provide insight into the structure of morphological variation.

because the symmetric and asymmetric components of shape variation are orthogonal subspaces of shape tangent space, they can also be identified and characterized through a principal component analysis  of the procrustes-superimposed data in the combined sample of the original and transformed copies of landmark configurations. this approach can be used for any type of symmetry. it is a direct extension of the method for bilateral symmetry, where it can be shown that the symmetric and asymmetric components of variation in the combined sample do not covary  <cit> . accordingly, the pcs are each unambiguously associated with a single component of the shape space, and the shape change associated with each pc shows the corresponding type of symmetry or asymmetry. the exception are analyses involving rotations of order  <dig> or greater, in which some pairs of pcs have equal eigenvalues, so that the direction of those pcs in the plane that they span together is not defined; accordingly, they can be rotated arbitrarily in that plane and the symmetry may not be visible in the pattern of shape changes associated with either of the pcs of the pair. an alternative procedure, which avoids this specific problem, is to perform pca of the covariance matrices from the decomposition of variation by a procrustes anova.

procrustes anova for complex symmetry
to quantify the different components of variation, we offer an extension to the procrustes anova for bilateral symmetry  <cit> . for bilateral symmetry, procrustes anova follows the design of the two-factor anova proposed by leamy  <cit>  and palmer and strobeck  <cit>  for linear measurements, which includes sides and individuals as main effects and their interaction. the main effect of individuals  represents individual variation, the main effect of sides  represents directional asymmetry, and the individual-by-side interaction  represents fluctuating asymmetry  <cit> . this reasoning was adapted directly for shape analyses in the context of matching symmetry  <cit> , whereas the reflection and relabelling was substituted for the factor of side in analyses of object symmetry  <cit> . the same design can be modified for more complex types of symmetry by replacing the factor of sides or reflection with the appropriate components of symmetry. additional components of variation, such as replicate measurements to quantify measurement error, can easily be added  <cit> .

procrustes anova for complex matching symmetry
for procrustes anovas of complex symmetries in the framework of matching symmetry, the units of analysis are the repeated parts  on which landmarks are recorded. landmark configurations for all parts of all individuals are included in the analysis. the simplest structure for the procrustes anova is then to include individuals and repeated parts as factors, and the main difference to the corresponding analysis for bilateral symmetry is that the factor of repeated parts may have more than two levels .

the interpretation of effects in the procrustes anova, in this case, closely follows that for bilateral symmetry. the main effect of individuals represents individual variation; because it is computed from averaging of all repeated parts in each individual, this component of variation is "symmetrized". the main effect of repeated parts represents directional asymmetry, the average asymmetry in the sample. because of the complex symmetry, directional asymmetry is not just the difference between left and right averages, as for bilateral symmetry, but it represents the variation among the means of the different parts, averaged over all individuals. for the example of a flower with five petals, this means that directional asymmetry is represented by the shape differences of the five mean shapes of the petals from the overall mean shape. finally, the individual × repeated-part effect represents fluctuating asymmetry, the individual variation in the differences among the repeated parts . overall, therefore, the procrustes anova for bilateral symmetry can be extended to complex matching symmetry in a quite direct manner.

if there is a more complex structure in the arrangement of repeated parts, however, this can be accommodated by dividing the factor for repeated parts into multiple factors that capture aspects of the differences between repeated parts. we call these collectively "asymmetry factors". for instance, if four parts are arranged as quadrants  and a dorsalventral axis can be distinguished from a left-right axis, then it is possible to include two asymmetry factors, one for each of the two axes, with two levels each. this is just a redistribution of levels from a single factor for repeated parts to two factors . similar designs are also possible for matching symmetry of structures involving translational symmetry .

the interpretation of the effects in the procrustes anova is somewhat more intricate in this case because there are additional effects to be considered. as before, the main effect for individuals represents the variation among individuals and is symmetrized completely. the main effects of the asymmetry factors  represent directional asymmetry in each particular aspect, symmetrized with respect to the other aspects . this means that each of the aspects of symmetry is associated with a component of directional asymmetry that isolates this particular aspect and "averages out" other asymmetries. an additional component of directional asymmetry comes from the interaction between asymmetry factors, such as the interaction between the dorsal-ventral and the left-right effect. this component of directional asymmetry represents deviations of each part from the asymmetry expected from adding together the separate components of asymmetry . overall, directional asymmetry is divided into three components . the interaction effects between the factor for individuals and the asymmetry factors represent components of fluctuating asymmetry. again, there are several of these components: the two-way interactions between individuals and each of the asymmetry factors represent fluctuating asymmetry in just that aspect of asymmetry  and the three-way interaction between individuals and both asymmetry factors represents fluctuating asymmetry of each individual part as deviations from the added effects of the two asymmetry factors . in summary, directional and fluctuating asymmetry are divided into components that represent particular aspects of asymmetry and can be used to address specific biological questions about the organisms under study.

statistical testing in the context of procrustes anova for complex matching symmetries is similar to procrustes anova for bilateral matching symmetry  <cit> . statistical inference can either be based on goodall's f test  <cit>  or a manova approach  <cit> . because all effects of the procrustes anova concern the same shape space, that of the entire landmark configuration of the repeated part, application of these statistical tests is fairly straightforward.

procrustes anova for complex object symmetry
as for matching symmetry, the procrustes anova for object symmetry with complex types of symmetry provides a similar decomposition of the variation into symmetric variation and one or more components of asymmetry. for any type of symmetry, it is possible to conduct procrustes anova with a single asymmetry factor that includes all transformations in the symmetry group as its levels. this follows the decomposition of the sum of squared procrustes distances .

depending on the type of symmetry of the objects under study, it may be possible to use two or more transformations in the symmetry group as separate asymmetry factors in the anova model. specifically, the transformations used as asymmetry factors in the procrustes anova must be a set of generators of the symmetry group . because some symmetry groups have multiple sets of generators, there may be an element of choice for the investigator. for instance, for the algal cell in figure 1a, one set of generator consists of two reflections, one each about the horizontal and the vertical axis and the other set comprises a reflection  and a rotation by 180°  <cit> . although different choices of generator sets are equivalent in characterizing the symmetry group, some choices may have more obvious and intuitive biological interpretations than others .

as in the procrustes anova for matching symmetry, the main effect of individuals represents among-individual variation; shape changes associated with this effect are completely symmetric because it is averaged over all transformed and relabelled copies of each individual configuration. the main effects of the asymmetry factors represent the respective components of directional asymmetry , each symmetrized with regard to the effects of all other asymmetry factors. the interaction effects between asymmetry factors characterize the components of directional asymmetry . the interaction effects between the factor for individuals and the asymmetry factors represent the different components of fluctuating asymmetry .

whether multiple asymmetry factors can be used in the procrustes anova depends on the type of symmetry. we only illustrate this in more detail for symmetries consisting of a rotation with or without reflection, which cover the vast majority of biological structures with complex symmetry. the components of variation of the effects of individuals, the one or more asymmetry factors and their interaction effects occupy different subspaces of the shape tangent space. the dimensionality of those subspaces  is important for computing the degrees of freedom for the procrustes anova.

if the symmetry group includes only a rotation around a single point or axis, the procrustes anova contains this rotation as the only asymmetry factor . variation among individuals is computed from the averages of all the rotated and relabelled copies of each configuration, and this component of variation is therefore symmetric under rotation. because rotation is the only asymmetry factor, directional and fluctuating asymmetry consist of a single component each, which both occupy the subspace of shape tangent space that is asymmetric under rotation. the main effect of rotation corresponds to directional asymmetry: the average of the differences among the sectors . fluctuating asymmetry is the individual variation of the rotational asymmetries, and therefore corresponds to the rotation × individual interaction. if each specimen has been digitized more than once, it is also possible to assess measurement error, which affects the entire shape space .

notation: for rotational symmetry of order o, the complete landmark configuration can be subdivided into o different sectors . each sector contains k landmarks. in addition, there are c landmarks on the centre or axis of rotation . the sample consists of n individuals , and each specimen has been digitized r times.

if the symmetry group includes rotation and reflection, the procrustes anova includes both of them as asymmetry factors, which leads to a more complex decomposition of the total variation . the main effect of individuals, as above, represents the variation among specimens and is completely symmetric because it is computed from averages of all transformed and relabelled copies of each configuration. the main effects of rotation and of reflection and the rotation × reflection interaction represent different components of directional asymmetry . the rotation × individual, reflection × individual and rotation × reflection × individual interactions are the corresponding components of fluctuating asymmetry. the components of directional and of fluctuating asymmetry occupy three separate subspaces of shape space : the main effects of rotation and the rotation × individual interaction occupy the subspace that is symmetric under reflection only, the main effect of reflection and the reflection × individual interaction occupy the subspace that is symmetric under rotation only, and the rotation × reflection and rotation × reflection × individual interactions occupy the completely asymmetric subspace. again, measurement error concerns the entire shape space .

3p+b+m+c-2
if o is odd:
3p+b+m+c-2
if o is odd:
n-1×3p+b+m+c-2
if o is odd:
n-1×3p+b+m+c-2
if o is odd:
notation: for rotational symmetry of order o and reflection, the complete landmark configuration can be subdivided into o different sectors. because of the reflection symmetry, each sector must be symmetric under reflection. therefore, the k landmarks contained in each sector can be subdivided into b landmarks on the boundary between sectors, m landmarks on the midline of the sector , and p pairs of corresponding landmarks on either side of the midline of the sector, so that k = 2p + b + m. the difference between boundaries and midlines of the sectors is important if the order of the rotation is even: in this case, the plane of reflection symmetry is assumed to pass through two boundaries between sectors . in addition, there are c landmarks on the centre or axis of rotation . the sample consists of n individuals , and each specimen has been digitized r times.

testing in the framework of procrustes anova for complex symmetries is similar to procrustes anova for bilateral symmetry  <cit> , and can be based either on an extension of goodall's f test  <cit>  to the more complex anova model or use a manova approach  <cit> . the computations of the procrustes sums of squares follow the same principles as for bilateral object symmetry, but care should be taken because there may be multiple asymmetry effects, each associated with a different subspace of the total shape space. in particular, this aggravates the problem how one should choose the error term for testing the effect of individuals  when the interaction effects are localized in different  subspaces  <cit> . following the argument that the symmetric variation among individuals should be assessed against the fluctuating asymmetry within individuals  <cit> , it is possible to add the procrustes sums of squares and degrees of freedom for all the fluctuating asymmetry components  to compute a pooled estimate of fluctuating asymmetry.

finally, a note of caution about terminology may be useful. to count as symmetric under rotation for the procrustes anova, a shape change must be symmetric under rotation of the full order. but these may not be the only components of variation that are rotationally symmetric if the order of rotation is not a prime number. for instance, analyses involving rotation of order  <dig> may include shape features that are symmetric under rotations of order  <dig> or 3; these will be counted as shape changes that are asymmetric under rotation, because they are not symmetric under rotation of order  <dig>  likewise, reflections are defined in relation to a particular axis or plane of reflection; shape changes that are symmetric under reflection about a different axis or plane will therefore not be considered as symmetric under reflection for the purposes of the procrustes anova. because these partial symmetries concern one or more of the components of fluctuating asymmetry, a pca of the covariance matrices for the respective effects can reveal this additional structure in the data. the order of rotation and axis or plane of reflection should be chosen to relate to the anatomical features and the biological question under investigation. all these considerations are best illustrated by an example.

case study: shape analysis of symmetry and asymmetry in a colonial coral
our case study concerns the symmetry and asymmetry of corallites in a colonial coral . in this coral, the corallites do not abut directly, but are separated from each other by a small distance. corallites possess radially projecting partitions called septa, which are prominent in the apical view of each corallite . the arrangement of septa is consistent with several types of symmetry: rotational symmetry of order  <dig>   <dig>  or  <dig>  either with or without reflection symmetry. because of this ambiguous type of symmetry, corallites are a somewhat unusual and particularly suitable example that allows us to demonstrate different types of symmetry in a single structure. we consider the corallites as structures that are symmetric as a whole, and therefore apply the method for analyzing structures with object symmetry and different symmetry groups. we illustrate our approach by analyzing three different types of symmetry:  reflection symmetry combined with rotational symmetry of order  <dig> ,  rotational symmetry of order  <dig>  and  reflection symmetry combined with rotational symmetry of order  <dig> 

we characterize the shape of  <dig> corallites from a single colony by a configuration of  <dig> landmarks , so that the shape tangent space has  <dig> dimensions . none of the landmarks is in the centre of rotation, so that c =  <dig>  and there are  <dig> or  <dig> landmarks per sector for analyses with rotations of order  <dig> and  <dig>  respectively . two images of each corallite were taken and each image was digitized twice.

in all analyses, we use a full procrustes fit of all transformed and relabelled copies of the landmark configurations and the data are projected into the tangent space by orthogonal projection  <cit> . for each of these analyses, we conduct a procrustes anova with the appropriate design . because the main aim of these analyses is to illustrate how different types of symmetry partition the total variation into components of symmetric and asymmetric variation, only the method of goodall's f  <cit>  is used for statistical testing.

in addition, principal component analysis  is also used to separate different components of symmetric and asymmetric shape variation and to display the corresponding shape changes  <cit> . this approach differs from procrustes anova in that it considers the total variation around the completely symmetric mean shape without distinguishing sources of variation for each subspace . we use pca to separate the various components of shape variation in our different example analyses. the symmetric and asymmetric components of shape variation that can be extracted from the pca depend on the symmetry transformations included in the dataset. when rotations of order  <dig> or greater are included in the symmetry group , the pca yields a series of pairs of pcs with equal eigenvalues. for each of these pairs, the pcs are not uniquely defined, and any pair of perpendicular directions in the corresponding plane can be chosen as the pcs. we therefore rotate the pcs of these pairs so that the deviation of the mean score of all unrotated copies from the overall mean is aligned with the first of the pcs in the pair. as a result, the shape changes associated with the pcs fall into recognizable types. in each analysis, we describe one pc for each category of shape variation as an example.

analysis 1: reflection and rotation of order 2
the first analysis uses the type of symmetry with two perpendicular axes of reflection symmetry, also known as biradial symmetry or disymmetry . the symmetry group contains four symmetry transformations: the identity, a reflection about the vertical axis, rotation by 180° , and a combination between reflection and rotation by 180° .

the shape tangent space consists of four subspaces: a component that is symmetric under both rotation and reflection , a component symmetric under rotation by 180° , a component symmetric under reflection about the vertical axis and, finally, a component that is not symmetric under either rotation or reflection about the vertical axis . each of these subspaces has  <dig> dimensions .

the procrustes anova includes individuals, rotation by 180° and reflection about the vertical axis as the factors . a comparison of the mean squares  indicates that the reflection effect appears to be the largest of the components of directional asymmetry and reflection × individual the largest component of fluctuating asymmetry . both concern the deviations from bilateral symmetry about the vertical axis that are symmetric under rotation by 180°, such as compression or stretching in an oblique direction.

the main effect of individuals is tested against the mean square for the total fluctuating asymmetry . this total asymmetry is not used otherwise in the analysis.

in accordance with the structure of the shape space, the pca produces pcs associated with four types of shape changes that differ in their symmetries. the pc <dig> is symmetric under rotations of order  <dig>  but not under reflection . the shape change is an expansion and compression in oblique directions, so that the corallites change from the roughly circular cross-section in the consensus to an elliptic shape with the long axis oriented either from upper-left to lower right  or from lower-left to upper-right . the shape change of the pc <dig> is completely symmetric  and primarily shows variation in the relative expansion and contraction along the horizontal and vertical axes. the pc <dig> is symmetric under reflection about the horizontal axis  and includes a deformation of the overall contour of the corallite into a more triangular shape pointing either to the left or right side . finally, the pc <dig> represents a fourth type of shape change, which is symmetric under reflection about the vertical axis, as there are mirror-image changes on the left and right sides .

because each pc can be unambiguously allocated to one of the components of shape space, it is possible to count the dimensions in the respective subspaces and to add up the corresponding eigenvalues to quantify the amount of total variance for each type of symmetry . the  <dig> pcs that are symmetric under rotation by 180° account for nearly half the total shape variation . the  <dig> completely symmetric pcs account for  <dig> % of the total variance,  <dig> % of the total variance are apportioned to the  <dig> pcs that are symmetric under reflection about the horizontal axis , and  <dig> % of the total variance are allocated to the  <dig> pcs that are symmetric with respect to reflection about the vertical axis. these numbers of pcs correspond to the numbers of dimensions in the respective subspaces.

analysis 2: rotation of order 6
for the analysis of symmetry under rotation of order  <dig>  the symmetry group contains six symmetry transformations: rotations by 60°, 120°, 180°, 240°, 300°, and 360° .

the analysis partitions the shape tangent space into a 14-dimensional symmetric component and a 78-dimensional component that is not symmetric under rotations of order  <dig>  in the procrustes anova, the main effect of rotation and the rotation × individual interaction dominate both the sums of squares and mean squares . this indicates that most of the variation is not symmetric under rotation of order  <dig> 

the  <dig> pcs are divided into four types of shape changes. the first category includes the pc <dig>  which is symmetric under rotations of order  <dig> . the corresponding shape change consists of a combination of a deformation of the overall contour of the corallite and relative shifts of the septa similar to that seen in the previous analysis . the pc <dig> represents the second type of shape changes, which is symmetric under rotation of order  <dig> . this shape change combines rotational shifts of the septa and variation between a more circular and a more triangular cross-section of the corallite. the third type is symmetric under rotation of order  <dig>  and therefore constitutes the symmetric component of variation. this type of shape change includes the pc <dig> , which consists of landmark shifts in almost precisely radial directions . finally, the pc <dig> represents the last type of shape change, which is totally asymmetric and shows irregular shifts of all landmarks .

in total,  <dig> pcs are symmetric under rotation of order  <dig> and account for most of the variance ,  <dig> are symmetric under rotation of order  <dig> ,  <dig> are symmetric under rotation of order  <dig>  and represent  <dig> % of the total variance, and  <dig> are completely asymmetric . above all, it is notable that the pca further subdivides the  <dig> dimensions of the asymmetric component of variation of the procrustes anova.

analysis 3: reflection and rotation of order 6
for the analysis of symmetry under reflection and rotation of order  <dig>  the symmetry group includes twelve symmetry transformations: each of the six rotations of the preceding analysis is now included with or without reflection.

there are four subspaces: a 7-dimensional subspace of completely symmetric shape changes, a 7-dimensional subspace of shape changes that are symmetric under rotations of order  <dig> but not under reflection, a 39-dimensional subspace of shape changes that are symmetric under reflection about the vertical axis but not under rotation of order  <dig>  and a 39-dimensional shape space of completely asymmetric shape changes. the procrustes anova shows that, for both the sums of squares and mean squares , the bulk of the variation is associated with effects involving rotation , both for directional asymmetry  and for fluctuating asymmetry .

the main effect of individuals is tested against the mean square for the total fluctuating asymmetry . this total asymmetry is not used otherwise in the analysis.

the pcs fall into eight distinct categories of shape changes . the pc <dig> represents the first type of shape change, which is symmetric under reflection and rotation of order  <dig> . the pc <dig> stands for the second group of shape changes, which is symmetric under rotation of order  <dig> but not under reflection . the shape variation associated with pc <dig> is symmetric under rotation of order  <dig> and reflection about the vertical axis . the shape change of pc <dig> is also symmetric under rotation of order  <dig>  but its reflection symmetry is about the horizontal and not the vertical axis . the pc <dig> features a shape change that is totally symmetric under reflection and rotations of order  <dig> . the pc <dig> represents shape variation that is symmetric under reflection about the vertical axis . the shape change associated with pc <dig> is symmetric under reflection about the horizontal axis . the last type of shape changes, which is symmetric under rotations of order  <dig>  includes the pc <dig> .

overall, patterns of shape variation symmetric under rotations of order  <dig> dominate the variation:  <dig> pcs are symmetric under rotation of order  <dig> and account for  <dig> % of the total variance and  <dig> pcs are symmetric under both reflection and rotations of order  <dig> and account for a further  <dig> % of the total variance. in addition, there are  <dig> pcs that are symmetric under reflection about the vertical axis and account for  <dig> % of the total variance, and another  <dig> pcs are symmetric under reflection about the horizontal axis and also account for  <dig> % of the total variance. there are  <dig> pcs that are symmetric under rotation of order  <dig> and reflection about the vertical axis and take up  <dig> % of the total variance, whereas  <dig> pcs are symmetric under rotation of order  <dig> and reflection about the horizontal axis and account for  <dig> % of the total variance. finally,  <dig> pcs are completely symmetric and comprise  <dig> % of the total variance, whereas  <dig> pcs are symmetric under rotation of order  <dig> and make up the remaining  <dig> % of the total variance.

discussion
in this paper, we have introduced a new and general framework for shape analysis of symmetric and asymmetric variation in a configuration of landmarks with any type of symmetry. we have presented methods that implement this framework and extend the methods widely used for analyzing shapes with bilateral symmetry  <cit> . we have illustrated the new framework with a small case study on the shape variation of corallites in a coral colony.

in our case study, the procrustes anovas and pcas for the three analyses produce different decompositions of the shape variation into components of symmetric and asymmetric shape variation. a common feature, however, is that the majority of the shape variation is contained in the asymmetric component. in the first analysis, with symmetry under reflection and rotation of order  <dig>  the pca indicates that asymmetric variation accounts for  <dig> % of the total variance. in the two other analyses, which include rotation of order  <dig>  the components of asymmetric variation take up more than 96% of the total variance in the pca. the large proportion of shape variation that is taken up by the asymmetric component of variation is in striking contrast to most studies of shape variation in structures with bilateral symmetry . this difference may relate to the fact that our analysis considers variation of sessile organisms that have grown in a heterogeneous environment. corals are known to have a considerable degree of phenotypic plasticity  <cit> . the large proportion of asymmetric shape variation in all our analyses may therefore relate to the effects of directed environmental factors such as light and water movement, which have been shown to influence coral growth  <cit> . effects of crowding by neighbouring corallites might add further asymmetric variation.

the pcas reveal much more shape variation that is structured according to biradial symmetry  than there is variation with hexagonal symmetry . the components that are symmetric under rotation by 180° are consistently among the dominant pcs and account for about 40% of the total variance of shape . moreover, in the analyses including reflection, shape changes symmetric under reflection and rotation by 180° also take up a large share of the total shape variation . the procrustes anovas suggest that these patterns apply to both directional and fluctuating asymmetry . these results reflect the fact that the cross-sections of most corallites in the sample are more or less oval or elliptic and not circular or hexagonal . accordingly, variation in the relative lengths and the orientation of the major and minor axes is a dominant feature of shape variation. depending on the type of symmetry considered in a specific analysis, these shape changes appear as part of the overall component of symmetry or asymmetry. in contrast, only a small proportion of the variation is symmetric under rotation of order  <dig>  which might be expected to predominate if corallite organization were to reflect the theoretical optimum of hexagonal packing of polyps on the colony surface. in galaxea, unlike some other colonial corals, corallites are set apart from each other by a small distance, so that the dense packing of corallites may not be a primary factor determining patterns of variation.

for our example analyses, only a fairly small proportion of shape variation is symmetric. some patterns of symmetric variation among corallites might be due to differences in septal growth. the septa develop from the mural structure of the corallite towards the centre and also towards the outside of the corallite  <cit> . the septa are arranged in four complete cycles, but only the first three are fully visible: six septa appear throughout the first, six septa develop during the second cycle and twelve septa grow during the third cycle . changes in the relative development of the three first cycles have been captured by the completely symmetric pcs in the analyses including rotation of order  <dig> . in the pc <dig> of both analyses, the shape changes correspond to radial shifts of landmarks along the septa that are identical for all septa that belong to the same developmental cycle. such biological interpretations, however, should be made with caution because this study is based on a fairly small number of corallites from a single colony and because the development of corallites is complex and incompletely known .

although the procrustes anovas and the pcas both produce broadly similar results, these analyses differ substantially in how they partition the total variation into components. the procrustes anova allocates shape variation to various components that reflect the study design and data collection, such as directional and fluctuating asymmetry or imaging and digitizing error, even if several of these components are located in the same subspace. the components extracted by the procrustes anova, however, may be somewhat heterogeneous in their symmetries . in contrast, the pca separates components according to the structure of the shape tangent space, and can therefore identify more classes of shape changes according to their symmetries. the pca, however, does not consider other aspects of the data structure--importantly, it provides only a total characterization of asymmetry that does not distinguish between directional and fluctuating asymmetry. the pca considers asymmetry as the total of the deviations from complete symmetry. pca does not distinguish whether variation stems from consistent differences between repeated parts that are shared among individuals and are therefore directional asymmetry, or whether variation reflects individual differences in the deviations from symmetry and is therefore fluctuating asymmetry. overall, therefore, procrustes anova and pca give somewhat different perspectives on the variation in the data, which is most important for the interpretation of asymmetry.

the three analyses, based on different symmetry groups, produce different estimates of the consensus shape and different partitions of the observed shape variation into components with distinct types of symmetry. the number of these components is influenced primarily by the number of symmetry transformations for the type of symmetry considered and, accordingly, by the number of transformed copies of each landmark configuration that are included in the dataset. in the first analysis, only four transformed copies are included in the dataset, whereas six transformed copies are considered in the second analysis, and twelve transformed copies are included in the third analysis. more complex types of symmetry are associated with symmetry groups that consist of greater numbers of transformations, and thus produce more types of pcs.

these differences between analyses of the same data raise the question how the most appropriate type of symmetry should be chosen. the coral example was included specifically because of its ambiguous symmetry, so that several types of symmetry can be demonstrated with the same data, and this analysis should therefore not be viewed as a model for studies of complex symmetries in general . normally, the type of symmetry should be chosen according to criteria that are relevant to the biological context of a particular study, and will most often consider anatomical and developmental criteria. for most analyses, the choice will be much more straightforward than for the example in this study, because the number and arrangement of repeated parts is unambiguous . also, for the coral example, there is biological information that clearly favours some types of symmetry over others. in corals, skeletal structures may have hexagonal, biradial or bilateral symmetry depending on the taxonomic group, but soft parts tend to have either biradial or bilateral symmetry . developmental studies in the sea anemone nematostella vectensis have shown that many genes involved in the organization of the adult body plan are expressed in bilaterally symmetric patterns . overall, therefore, these biological considerations suggest that biradial or bilateral symmetry is more appropriate for studying corals than the types of symmetry involving a rotation of order  <dig>  with a choice of symmetry group that is appropriate for the organisms under study, methods introduced and demonstrated in this paper can be used to extract biologically interesting features from the different components of symmetric and asymmetric variation  <cit> .

alternative approaches
a few different morphometric methods for the analysis of complex symmetries have been suggested in recent years  <cit> . frey et al.  <cit>  proposed an approach for the analysis of rotational symmetry. if a landmark configuration is rotationally symmetric, then each set of corresponding landmarks forms a perfect polygon. the method uses linear measurements and angles among landmarks to characterize the polygon formed by the actual landmarks and computes a measure of its deviation from a perfect polygon. frey et al.  <cit>  used this method to examine how well the tips of the petals of flowers with five petals corresponded to perfect pentagons and found that the method performed well in ranking more or less symmetric flowers. the drawback of this framework is that it is limited to the study of rotational symmetry and to only a single landmark per repeated sector. our approach is more general because it is not limited to a specific number of landmarks per sector or to a type of symmetry.

potapova and hamilton  <cit>  extended the method for analyzing bilateral object symmetry for the analysis of diatoms that are symmetric with respect to two perpendicular axes of symmetry . they used an original configuration of landmarks for each entire diatom, generated three copies to which they applied reflections about the two axes of symmetry, and appropriately relabelled the landmarks of each transformed copy. although potapova and hamilton  <cit>  did not describe it in these terms, their analysis applied the four symmetry transformations that define the full symmetry group for biradial symmetry. therefore, potapova and hamilton's approach is identical to the method used here for that type of symmetry , and it is a special case of the more general framework we presented in this study. savriama et al.  <cit>  applied the current framework for analyzing biradial symmetry in algal cells of micrasterias rotata to extract symmetric and asymmetric components of variation and related them to the processes of cellular growth.

finally, the approach of zabrodsky et al.  <cit>  is particularly intriguing because of its relationships with the current methodology. their work was developed in the context of chemistry and computer vision, independently from similar work in morphometrics and statistical shape analysis. zabrodsky et al.  <cit>  defined a symmetry distance that quantifies how much a set of points deviates from a corresponding, perfectly symmetric shape. like the procrustes approach, this method is based on minimizing the sum of squared distances between corresponding points. up to a scaling factor, the symmetry distance is identical to the squared procrustes distance between the original landmark configuration and the completely symmetric consensus of our approach. the approach is suitable for object symmetry of any type, that is, for any finite symmetry group. the main difference is that the approach of zabrodsky et al.  <cit>  is for assessing how symmetric a single shape is, and that it therefore is not equipped to analyze the variation among several configurations in symmetric aspects of shape or in asymmetries. graham et al.  <cit>  point out that, in the absence of directional asymmetry, the symmetry distance can be used as a measure of fluctuating asymmetry; this is equivalent to the use of procrustes distance  <cit>  . because the procrustes approach can estimate and correct for directional asymmetry, it has the advantage that it can be used as a measure of fluctuating asymmetry even if directional asymmetry is present  <cit> .

CONCLUSIONS
the approach we have introduced in this paper provides powerful morphometric tools for biologists to analyze symmetry and asymmetry in landmark data. the method generalizes the approach previously used for bilateral symmetry for studies of landmark configurations with any possible type of symmetry and provides a unified perspective on biological symmetry. previous insights about the structure of the shape tangent space for bilateral symmetry  <cit>  also can be extended in this much more general setting. similarly, we have extended the procrustes anova for quantifying the different components of shape variation  <cit>  for any type of symmetry. other morphometric tools can be used in this new context as well.

the use of complex asymmetries, where more than two repeated parts can be compared, avoids some of the problems of fluctuating asymmetry in organisms with bilateral symmetry  <cit> . for instance, analyses of radially symmetric flowers can measure the lengths of multiple petals  <cit>  or the arrangement of all the petal tips  <cit> . because the approach outlined in this paper considers multiple landmarks per iterated part, it makes more information available for such studies and is therefore likely to provide greater power and sensitivity. this applies both to studies that use fluctuating asymmetry as a measure of developmental instability and to those using it in analyses of morphological integration. because the complex symmetry of a structure often relates to its development and growth, for instance through the arrangements of septae of corallites  or the structure of algal cells  <cit> , the patterns for different components of symmetric and asymmetric variation may provide a more detailed and multifaceted picture than it is possible for bilateral symmetry. for these reasons, we think that our framework for the analysis of complex symmetries is a useful tool for studies of the evolution and development of the shapes of biological structures  <cit> .

