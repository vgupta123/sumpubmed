BACKGROUND
tomato  is the second most popular vegetable crop in the world  <cit> . in addition, tomato is being developed as a model organism and is more closely related to important crops like lettuce and coffee than other models such as arabidopsis, poplar or rice  <cit> . tomato also has an interesting natural history, which includes a single domesticated species and a number of wild relatives that have wide morphological variability and are adapted to very diverse environments  <cit> . the comparative study of tomato wild species can help us identify key genetic factors involved in domestication and will benefit breeding programs.

despite the advent of high throughput genomic techniques and bioinformatics, comprehensive genome-wide information remains unavailable for most species, including tomato. since the tomato genome sequence is currently incomplete and the microarray platforms for this species do not feature most of the loci predicted to exist  <cit> , genetic studies have focused on the analysis of particular loci and segregating populations. these studies led to in-depth information on a few loci and uncovered the potential usefulness of the natural variation existing in related species  <cit> . a major goal for tomato geneticists is the acquisition of comprehensive genome-wide information that can be used in the improvement of resistance, quality, aspect, flavor and growth in cultivated varieties  <cit> .

a large amount of genetic and molecular information is available for tomato, most of which has been deposited at the sgn http://sgn.cornell.edu. in this database there are more than  <dig>  ests from several tomato species. this abundant sequence repository has been used to develop polymerase chain reaction-based  molecular markers to build on the original, time consuming and cost ineffective restriction fragment length polymorphisms   <cit> 

recently, bioinformatic surveys of genome sequences have revealed the importance of snps in shaping evolution and also in serving as molecular markers  <cit> . in tomato, initial genomic work on snp discovery involved de novo sequencing of est libraries and comparison to the existing databases  <cit> , or faster and less expensive computer-aided mining of the available sequences  <cit> . in these analyses only the information from the plain sequence was used. as a consequence there were high numbers of both false positives created by sequencing errors, and false negatives resulting from data that did not meet the conditions set by the researchers, such as minimum number of sequences or sequence similarity surrounding a snp. furthermore, low rates of validation were often obtained, in part because of lack of information on sequence quality and on intron position. for example, if a predicted marker spans an intron it will be difficult to detect by pcr.

there is now an increasing wealth of resources in the tomato databases and similar repositories such as sequence qualities, unigene assemblies, open reading frame  predictions, sequence similarity with other plant species and localization to genetic maps  <cit> . the use of this metadata allows for more sophisticated experimental designs that increase the quality of snp prediction and information on the snp's effects. for example, by comparing tomato and arabidopsis thaliana databases a set of markers was developed that targeted loci conserved throughout evolution both in sequence and copy number  <cit> . this conserved orthologous set  has been proven an invaluable resource for comparative and evolutionary studies among plants  <cit> . similarly, a recent publication used intron positions conserved between tomato and arabidopsis thaliana to detect intraspecific snps in noncoding regions, demonstrating the possibilities of bioinformatics predictions  <cit> .

despite the availability of sequence-associated metadata and the need for functional genomic studies in tomato, there is surprisingly little information about the relevance and levels of variation found in coding regions. previous snp mining efforts are either based on noncoding regions or have no information about the effect of the polymorphisms on protein sequence. moreover, most snps mined from est sequences have little probability of being functionally important, since the majority are expected to fall in the un-translated regions , where the polymorphism rate increases more than five fold in comparison with coding regions,  <cit> . information about the number, localization and type of non-synonymous polymorphisms will help unravel useful information about the evolution of genes that may have adaptive significance  <cit> , serving as a primer for more profound studies on natural variation of interesting traits.

to perform reliable evolutionary and phylogenetic analyses sufficient polymorphism data can be obtained from the sequences of the wild species already available. however, most studies have focused on finding intraspecific molecular markers between cultivated tomato cultivars. the few attempts to infer rates of polymorphism and selection on tomato genes among its wild relatives are reduced to small sets of genes likely providing biased estimations  <cit> .

to fill the gap in knowledge about sequence similarities and differences among cultivated and wild tomato species, we mined the est and unigene tomato database from sgn in search for substitutions and insertions/deletions between and within the three species with highest representation: s. lycopersicum, s. habrochaites and s. pennellii. we used additional metadata from the database to effectively predict snps and infer levels of polymorphism in coding versus noncoding regions and in gene families. we surveyed this dataset for signatures of sequence evolution, selection and/or adaptation using the mcdonald-kreitman test  <cit>  and codon-based maximum likelihood analyses  <cit> . based on the polymorphisms detected we also developed a set of specific molecular markers and a website to make these available to the community at http://www.plb.ucdavis.edu/labs/maloof/tomatosnp/index.html.

RESULTS
est assembly
the unigene database version  <dig> build  <dig> from sgn consists of  <dig>  ests grouped into  <dig>  unigenes, each one containing between  <dig> and  <dig> ests, with an average of  <dig>  ests per unigene . unigenes can be formed by est sequences from any tomato race or species, although most unigenes  contain sequences from a single species .

we mined sequence assemblies of s. lycopersicum  ests for intraspecific polymorphisms and assemblies containing sequences from both s. lycopersicum and s. habrochaites  or s. lycopersicum and s. pennellii  for interspecific snps. to reduce the complexity of each analysis we reassembled the unigenes using only ests from the species relevant to the analysis. the consensus sequence for each reassembled contig was then aligned to the original unigene sequence and, when available , to the predicted coding sequence . in the cases where a predicted cds was available, each nucleotide in the assembly was annotated as 5' utr, cds or 3' utr. we assigned quality scores to each position in the assemblies by calculating separately for each species the sum of the qualities of all nucleotides at that particular position.

several filters were applied to diminish the number of false positive snps predicted in our analyses. assembly regions that did not align with unigene sequences were removed. we also discarded positions where only a single sequence was found and, in the interspecific analyses, assembly regions where sequences from only one of the species assayed were detected. using the remaining portions of the assemblies we determined an optimum quality threshold for each analysis at which the average sequence quality was maximized . assembly positions that did not pass the quality threshold were removed, leaving for snp mining a total of  <dig>  unigenes spanning  <dig>  kb of interspecific assemblies and  <dig>  unigenes including  <dig>  kb of intraspecific s. lycopersicum data .

only nonconsecutive snps are displayed. na- gene region is not available for unigenes in which a cds could not be predicted. snp rates are calculated as the number of snps per  <dig> bp.

in every analysis the majority of nucleotides assembled were located in predicted coding regions. between  <dig>  and  <dig> % of the positions could not be assigned to a gene region due to the lack of predicted cds . the average quality of the nucleotides considered in the assemblies was always highest in the 5' regions and lowest in the 3' regions . this could be explained by the bias towards sequencing the ests from the 5', as an average of  <dig> % of the sequences from each library were readings from the top strand . interestingly, assemblies from unigenes for which there is no predicted cds had overall average qualities similar to the 5' region . this raises the possibility that those unigenes contain mostly 5' utr sequence, in turn explaining why estscan  <cit>  was not able to predict a cds.

snp mining
we mined the resulting sequence assemblies for nonconsecutive snps taking into account the position of the snp with respect to the predicted gene regions. in total  <dig>  substitutions and  <dig>  insertions/deletions  were detected . several observations confirm the performance of our snp detection algorithms. as shown in table  <dig>  indels appear between  <dig>  and  <dig>  times more frequently in utrs than in the cds. insertion and deletion of nucleotides are likely to produce changes in the open reading frames disrupting correct translation, therefore selection against them is expected in coding regions. similarly, predicted noncoding regions yielded between  <dig>  and  <dig>  times more snps per kilobase analyzed than coding regions , as reported in previous tomato analyses  <cit> . we next used the estimated cds for each unigene to calculate the codon position for each snp. in translated regions the majority of the mutations are located in the third position of the codon . this result was expected since selective pressure in coding regions reduces the number of non-synonymous substitutions and the redundancy of the genetic code is mainly in the third base of the codons. we then calculated hypothetical codons in the utrs by extending the orf from the origin of transcription in the predicted cds. the third position bias disappeared in these hypothetical noncoding regions  suggesting that on average the snp, cds, and codon position predictions are accurate. in addition, when looking at all snps in coding regions together, the percentage of non-synonymous snps is  <dig> %, similar to genome-wide analyses in arabidopsis   <cit>  and humans   <cit> .

regarding the differences between intra and interspecific analyses, we found only  <dig> % of the analyzed loci to be polymorphic when mining a single species versus the  <dig> % when analyzing pairs . for interspecific analysis the snp rates were comparable to those published before between s. pennellii and s. lycopersicum  making no distinction between coding and non coding regions  <cit> . the same holds true for s. lycopersicum intraspecific analyses, where reported snp rates range between  <dig>  and  <dig>  snps/ <dig> bp on all est sequences analyzed regardless of their location in the gene  <cit> .

snp representation in gene ontology classes
we reasoned that certain gene families might be more variable among tomato cultivars and species than others. for example, since tomato species are adapted to diverse environments, genes involved in environmental response might accumulate a higher number of non-synonymous snps due to selection. we used gene ontology  categories  <cit> , which group genes into functionally related classes, to assess the differential polymorphic rates of unigenes encoding specific classes of proteins. we assigned go categories to each nucleotide position in the assemblies based on the closest arabidopsis thaliana homolog, and looked for categories with over- or under-representation of non-synonymous snps. to achieve higher power we grouped together the data from the interspecific analyses. the larger number of sequences available in the intraspecific analysis allowed greater statistical power, although the most over- and underrepresented gene classes are in agreement in both analyses . as expected, go categories related to environment interaction, such as responses to stress and abiotic stimulus, had an over-representation of non-synonymous polymorphisms both between and within species . on the other hand, categories involved in basic biological processes and transcription regulation showed a relative lack of polymorphisms, as had been found in arabidopsis thaliana accessions  <cit> . surprisingly, genes encoding ribosomal proteins also presented more snps that expected, perhaps due to the challenge of distinguishing homologs from paralogs in this gene family, which shows complex patterns of copy number variants in arabidopsis  <cit> .

mcdonald-kreitman test
the neutral evolution theory holds that most within species polymorphisms and between species differences have little fitness consequence  <cit> . as a result, the ratio of non-synonymous to synonymous substitutions should be similar for a particular gene both within and between species. deviations from this can be a sign of non-neutral evolution  <cit> . to examine this prediction, we constructed alignments of the wild and cultivated consensus sequences containing only the good quality positions and the snps predicted by our algorithms, and surveyed each alignment for signatures of positive selection using the mcdonald-kreitman test  <cit> . with this method we tested  <dig> unigenes from the s. lycopersicum and s. habrochaites analysis and  <dig> unigenes from the s. lycopersicum and s. pennellii analysis. before correction for multiple testing we found significant excess of non-synonymous mutations  in  <dig> unigenes in the lxh analysis and  <dig> unigenes in the lxp analysis . however, none of those unigenes survived the benjamini and hochberg correction for multiple testing  <cit> .

maximum likelihood codon-substitution models
the mcdonald-kreitman test compares variation between and within two species. an alternative approach is to simultaneously analyze all the sequences in a phylogenetic tree  <cit> . following this method, we surveyed the unigenes for signals of positive selection using maximum likelihood estimates from codon-substitution models  <cit> . we reasoned that genes important for domestication might show a higher rate of non-synonymous to synonymous substitutions specifically in the s. lycopersicum lineage. to test this idea, we fit two different models for each unigene using alignments of the coding regions from cultivated tomato, arabidopsis thaliana and s. habrochaites or s. pennellii. one of the models used assumed similar non-synonymous/synonymous rates  in every branch of the evolutionary tree . the second model allowed for different dn/ds estimates in the branch leading to s. lycopersicum relative to the rest of the tree . for each gene we used a likelihood ratio test to ask if the two-branch model fit significantly better than the one-branch model. support for two-branch rates is suggestive of directional selection on the branch leading to domesticated tomato, therefore raising the possibility of identifying genes important for domestication  <cit> . alternatively, s. lycopersicum-specific dn/ds ratios could occur due to natural selection acting after the s. lycopersicum lineage split from s. pennellii or s. habrochaites but before domestication. we were able to test  <dig> unigenes from the s. lycopersicum and s. habrochaites analysis and  <dig> unigenes from the s. lycopersicum and s. pennellii analysis. from those,  <dig> and  <dig> unigenes respectively presented evidence of elevated non-synonymous substitution rates on the branch leading to s. lycopersicum after correction for multiple testing , suggesting these genes as possible targets of selection during domestication. we cannot discard, however, the possibility that some or all of these genes have an excess of fixed polymorphisms in the cultivated tomato lineage due to a population bottleneck during domestication  <cit> , or because of the effect of natural selection due to differing environments. among these genes we found that the three go categories most represented were responses to abiotic and biotic stimulus, responses to stress and protein metabolism. this finding is in concordance with our analysis of snp over-representation in gene families.

lxp – s. lycopersicum and s. pennellii analysis, lxh – s. lycopersicum and s. habrochaites analysis. 1annotation – based on the annotation from the best blast hit in arabidopsis thaliana.  <dig> p-value – multiple testing corrected p-values for the differences in the maximum likelihood estimates of the two models fit.  <dig> sites – number of codons analyzed,  <dig> dn/ds – dn/ds for the model where one dn/ds ratio is estimated for the entire evolutionary tree.  <dig> dn/ds  <dig> – dn/ds for the non s. lycopersicum lineages in the model where a different dn/ds ratio is estimated for the branch leading to s. lycopersicum.  <dig> dn/ds  <dig> – dn/ds for the s. lycopersicum lineage in the model with two dn/ds ratios. the very high dn/ds ratios observed for some genes are a consequence of relatively little diversity between wild and domesticated tomato and are likely to be an overestimate of the true rate.  <dig> lnl – likelihood estimate for the model with one dn/ds ratio.  <dig> lnl <dig> – likelihood estimate for the model with two dn/ds ratios.

molecular marker design
using the information gathered from the assemblies we developed a set of molecular markers for detecting the predicted snps. successful design of pcr based molecular markers from est sequences requires the ability to avoid amplifying introns. since many arabidopsis intron positions are conserved in tomato  <cit> , we used this information  to inform the design of molecular markers for the polymorphisms identified in the interspecific analyses. first, we tested our intron predictions by designing three primer pairs surrounding predicted introns. one of those produced a band  <dig> bp greater than expected without introns and the other two did not amplify, suggesting the existence of introns where predicted . we did not carry out similar analysis for the intraspecific snps due to the lack of information within sgn regarding the s. lycopersicum accessions used. although it is well known that s. lycopersicum ests in sgn come from several cultivars, the information for each individual est library is not available. for each high-quality, interspecific snp we developed a database containing suggested primers to amplify the snp region, restriction enzymes to detect the polymorphism, and predicted fragment sizes before and after digestion of each allele. this information can be accessed at http://www.plb.ucdavis.edu/labs/maloof/tomatosnp/index.html.

we validated a subset of markers by using  <dig> primer pairs designed to amplify fragments from s. lycopersicum and from s. pennellii, s. habrochaites, or both. we calculated the size differences between the amplified products cut with the appropriate restriction enzymes when needed or uncut in the case of indels. from the  <dig> primer pairs,  <dig> pairs amplified fragments that were smaller than expected and were discarded. another  <dig> pairs failed to amplify fragments in at least one species, leaving us with  <dig> primer pairs that would test  <dig> polymorphisms between s. lycopersicum and s. habrochaites and  <dig> polymorphisms between s. lycopersicum and s. pennellii. among these,  <dig> primers pairs yielded bands that were bigger than expected, probably due to the existence of non-conserved introns, nevertheless  <dig> of these were polymorphic as expected after restriction enzyme digestion. for the remaining amplifications we found 87%  of the molecular markers to work as predicted. it is worth noting that 10% of the successful markers showed bands corresponding to both alleles in at least one of the species tested, suggesting heterozygosity in the lines used or the amplification of fragments from a family of genes sharing that sequence. markers that failed could be due to undetected snps in the sequence that modify the predicted restriction sites, or errors in snp prediction. all tested markers are available in the additional file  <dig> 

CONCLUSIONS
we report in this work more than forty-nine thousand inter and intraspecific polymorphisms mined from the est databases of the cultivated and two wild species of tomato. by taking advantage of the additional information linked to each sequence we were able to more accurately estimate the quality and the position of each snp with respect to the coding region, which allowed us to distinguish those polymorphisms more likely to have phenotypic effects. comparison of the sequences to homologs from better characterized species also allowed us to functionally classify the predicted unigenes and perform gene evolution analysis and tests for positive selection. we were able to suggest candidate genes and gene families that may be related to domestication of the cultivated tomato and/or environmental adaptation of wild species, providing hypotheses for more involved evolutionary studies. the information obtained was also used to design a set of markers that we make available to the community via a website. to our knowledge this is the first time that substantial meta-information including quality values, open reading frame predictions and homology to genes in arabidopsis thaliana, has been used on tomato sequences to perform a pre-genomic analysis of gene variability and evolution.

