BACKGROUND
high-density oligonucleotide arrays are currently the most widely used high-throughput technology for whole-genome gene expression studies. array technology also makes it possible to genotype thousands of nucleotide polymorphisms  efficiently  <cit> , and detected nps are called single feature polymorphisms   <cit> . in addition to their utility in measuring gene expression levels, whole-genome dna hybridization to expression arrays has various applications in small genome species; mutant mapping in yeast  and arabidopsis  by bulk segregant analysis  <cit> ; quantitative trait loci extreme array mapping in arabidopsis  <cit> ; and comparative genomics in yeast  <cit> , arabidopsis  <cit> , malaria mosquitoes   <cit> , in the human malarial parasite   <cit> , and in mycobacterium tuberculosis   <cit> . however, in large genome species, such as barley   <cit> , xenopus   <cit> , and maize   <cit> , whole-genome dna hybridization to expression arrays has not worked out well because of cross-hybridization. although applications of oligonucleotide expression arrays were limited in large genome species, complementary rna  from their transcripts was used to detect sfps in barley  <cit> , maize  <cit> , wheat   <cit> , and cowpea   <cit> .

rice is important as both a food and model plant for the grasses. the genome size of rice  is relatively small amongst crop species, but is larger than that of malaria mosquitoes, which have the largest genome used in successful studies of whole-genome hybridization. affymetrix supplies a 3'-expression array for rice, the affymetrix genechip® rice genome array . a trial sfp detection using whole-genome hybridization by the rice array was reported by kumar et al., and more than 70% sfp detection sensitivity at about 10% estimated fdr  was verified by sequencing probe targets  <cit> . sfp detection using rice transcripts was reported by kim et al., andthey detected  <dig>  sfps, and  <dig> out of  <dig> predicted sfps were verified by sequencing predicted sfp-containing amplicons  <cit> . however, because the number of sequenced targets was biased to sfp-predicted ones, it was estimated that the sensitivity would be higher than the true value. genomes of two rice strains have been fully sequenced. one is japonica cultivar nipponbare, which has been sequenced by a bac-by-bac approach  <cit> , and the other is indica cultivar 93- <dig>  which has been sequenced by a shotgun approach  <cit> . nucleotide differences in coding and 3'-untranslated  regions of genes between the two strains were  <dig>  single nucleotide polymorphisms /kb and  <dig>  snps/kb, respectively  <cit> . one of the  <dig> probes was expected to detect an sfp in the 93- <dig> genome, because each probe was 25-mer long, most rice genechip® probes were designed to target the coding and 3'-ut regions of japonica transcripts,  <dig> snps/kb were expected in the target region of the 93- <dig> genome on an average. the two fully sequenced rice strains provided us with an opportunity for detailed analyses of sfp detection efficiency.

first, we searched all probe target sequences in nipponbare and 93- <dig> genomes and predicted sfps between them. second, we investigated optimized experimental conditions to detect these sfps by whole-genome hybridization. several statistical methods for sfp detection were compared using whole-genome hybridization data of nipponbare and 93- <dig> cultivars. effects of several background corrections were also examined for maximum sfp detection performance. third, sfp detection efficiency by crna hybridization was also investigated by applying our recently proposed method for simultaneously detecting nucleotide and expression polymorphisms  using the affymetrix genechip® array  <cit> . finally, a comparison of benefits and limitations of sfp detection by whole-genome and transcript hybridization approaches was made.

RESULTS
blastn analysis of affymetrix genechip® array probes
the affymetrix genechip® array was designed for  <dig>  japonica transcripts and  <dig>  indica transcripts. a transcript is represented as a probe set. a probe set is made up of several probe pairs  comprised of perfect match  and mismatch  probes. mm probes were designed to represent the non-specific hybridization signal value. several probes on this array had a possibility of cross-hybridization with other regions of the rice genome because the array probes were designed before the completion of rice genome sequencing efforts. only 25-mer completely matched and single copy probes of the nipponbare genome were extracted and used in this study. to select single copy completely matched probes, similarities of all  <dig>  pm probe target sequences of the affymetrix genechip® array were searched against the nipponbare genome by blastn analysis . a significant number of probes  had multiple hits on the nipponbare genome. some of the probes were designed to splice sites of japonica or indica-specific transcripts, and  <dig>  probes were neither single hits nor were they completely matched to the nipponbare genome. the remaining  <dig>  probes had single hits and complete matches in the nipponbare genome. we referred to these as unique probes and used them for sfp detection by whole-genome and crna hybridizations. by blastn analysis of nipponbare unique probes,  <dig>  probes were confirmed to be sfps against the 93- <dig> genome. among the unique probes,  <dig>  probes had multiple hits in the 93- <dig> genome; however, we did not eliminate these as the 93- <dig> genome has not yet been sequenced. it is hypothesized that sfp detection performance in this study will be similar for unsequenced strains. for sfp detection by crna hybridization, we selected  <dig>  probes representing  <dig>  transcript sets that consisted of more than six unique probes, since snep needs several probes in a set of transcripts. among the  <dig>  transcript sets,  <dig>  probes out of  <dig>  were predicted to be nucleotide polymorphism  containing probes, sfp, for the 93- <dig> genome.

a, means probe target sequence hit a single site and perfectly match with the nipponbare genome.

b, sets with more than six unique probes in the nipponbare genome.

sfp detection by whole genome dna hybridization
the rice genome, which is about  <dig> mb in size  <cit> , may generate much more noise relative to the true signal intensity in genomic dna  hybridization, compared with other organisms with less complex genomes such as those of yeast and arabidopsis. thus, it is important to investigate conditions that maximize hybridization signal intensity differences between completely matched and np containing targets of probes on the affymetrix genechip® arrays. there are two types of probes on the affymetrix genechip® arrays; pm and mm. although the mm probes were designed with single complementary substitutions at the 13th base  of each pm probe to represent non-specific hybridization signal values, many studies have indicated that some mm probe intensities are frequently higher than those of the corresponding pm probes   <cit> . the mm probe sequence is an ideal np containing a sequence against a complete match target sequence of a pm probe. mm signal intensity would show an ideal sfp intensity for a pm probe. this study thus began as an effort to investigate conditions to maximize the difference between mm and pm intensities for a complete match target.

all affymetrix protocols for hybridization, washing, and scanning have been standardized  <cit> , and were difficult to change. amounts of nipponbare genome dna products that were randomly amplified and labeled  were variable on hybridization. ~ <dig> μg of products were obtained in a single labeling reaction, and  <dig>   <dig>  or  <dig> μg of reaction products was hybridized. to investigate how the overall intensity distribution of pm and mm changed with increasing amounts of labeled products, distribution of probe numbers of the signal intensities were compared . for the study of density plots,  <dig>  unique probes in the nipponbare genome, chosen by the blastn analysis, were used. although we selected unique probes, both pm and mm probe signals exhibited a wide range of intensities. signal intensities increased with the increasing amount of products not only for pm probes, but also for mm probes. the increase in mm signal intensities could be due to both non-specific cross-hybridization and binding to target fragments. when  <dig> μg of the product was applied, the distribution of mm probe intensities appeared to be asymmetric with a lower limit. when  <dig> μg of product was applied, although the signal intensity was not saturated, the distribution curve of pm signals appeared to be asymmetric. when  <dig> μg of the product was hybridized, the overall intensity distribution of mm was best separated from that of pm. the number of probes with pm > mm was maximized with  <dig> μg of product. consequently, we concluded that ~79% would be the maximum sensitivity for sfp detection by whole-genome hybridization. to evaluate the effects of the optimization on sfp detection, significance analysis of microarray   <cit>  was performed on the data of  <dig> μg and  <dig> μg applications. sam has been widely used for sfp detection  <cit> . the log <dig> intensities of raw pm values were used to determine sfps in each analysis. sfp detection performance was evaluated by sensitivity, ratio of the correctly called to the expected number of sfps, the false-positive rate , and the ratio of the number of falsely called to total called sfps. receiver operating characteristic  curves with sensitivity plotted against fpr, are shown in figure  <dig>  in entire threshold, sfp detection in the  <dig> μg application was better than that in the  <dig> μg application. the most suitable threshold in the  <dig> μg application, where the slope of the roc curve was  <dig>  was at delta =  <dig>  for sam, and the detected number of true sfps, the sensitivity and fpr were  <dig> ,  <dig> % and  <dig> %, respectively . in the  <dig> μg application, the detected number of true sfps was reduced to  <dig>  at a similar fpr . the optimization allowed a more than 20% increase in the detected number of true sfps, although a dramatic increase in intensity of pm > mm probes signals was not observed ).

 <dig>  unique probes in  <dig>  probe sets were used for sfp call. a, amount of applied genomic dna for hybridization. b, number of probes detected as sfp probes at a threshold of delta =  <dig>  by sam. c, number of true sfp calls and percentage of true calls to predicted sfp probes by sequence analysis. d, number of false sfp calls and percentage of false calls to total calls.

we compared three methods of sfp detection with the  <dig> μg application: analysis of variance , sam  <cit> , and snep  <cit> . anova is a simple and classical test for sfp detection between two strains  <cit> . snep is our recently developed robust method to detect sfps as outliers of difference log <dig> pm intensities within a probe set between two strains for crna hybridization, and it is also applicable for gdna hybridization. the log <dig> intensities of raw pm values were used to determine sfps in each analysis. sfp detection performance was evaluated by roc curves . although the three methods showed similar performances, sam showed better performance with the stringent threshold where fpr was lower than  <dig> . although both sensitivity and fpr were increased by lowering the threshold level for sfp detection, the fpr reached a limit at about 14% with elevating threshold . to examine background correction effects, major correlations; mas <dig>  <cit> , rma  <cit> , and gcrma  <cit>  and normalization methods; scaling  <cit>  and quantile  <cit>  were applied before selection of probes and comparison of their sfp detection performances . no method had positive effects on the detection of sfp by sam, and the effects of the corrections with other detection methods were found to be the same . as a consequence of above comparisons, a simple sam of log10-transformed pm intensities with no background correction or normalization showed the best performance. the most suitable threshold was at delta =  <dig>  for sam, and the sensitivity and fpr were  <dig> % and  <dig> %, respectively .

considering the wide range of potential applications of detected sfps, it is worthwhile to investigate the distribution of sfps in the genome. the distribution of the number of unique probes, predicted sfps, correctly and falsely called sfps, and the sensitivity of sfp detection in a 1-mb window are indicated in figure  <dig>  on an average, each 1-mb window contained  <dig>  probes, and a total of  <dig>  windows  with a step width of  <dig>  mb resulted from a sliding window approach. the distribution of predicted sfps in the 93- <dig> genome was similar to the number of synonymous substitutions per site between nipponbare and 93- <dig> genes, as reported by tang et al.  <cit> . however, there were differences in the distribution of snps, including in non-coding regions, between nipponbare and 93- <dig> genomes  <cit> . our correctly called sfp probes were distributed similar to predicted sfp probes and the sensitivity appeared uniformly throughout the genome, although some falsely called probes were observed. this suggests that apart from a small region with high false-positive rates, sfp detection by gdna hybridization can cover all snps, including snp-poor regions, with considerable accuracy.

sfp detection using snep by rice transcript crna hybridization
gene expression data from two tissues  of nipponbare and 93- <dig> cultivars were obtained according to affymetrix standard protocols. raw pm values of all probes were transformed to log <dig> intensities and subjected to sfp calls according to the snep procedure  <cit> . as reported by fujisawa et al., it is difficult to detect sfps at low expression levels  <cit> . to investigate the appropriate expression level of sfp detection, pm intensities from  <dig>  unique probes for the nipponbare genome were compared with those for mm by anova . more than 70% of the probe pairs showed significant differences when log <dig> intensities of pm probes were above  <dig>  in both the shoot and young panicle. subsequently, probe sets with a high expression level, where the median log <dig> intensity of a probe set was above  <dig>  for both nipponbare and 93- <dig> transcripts, were extracted from the unique probe sets. the performance of snep using pm intensities for calling sfps was investigated by roc curves of the shoot and young panicle . data of the young panicle showed better performance than the shoot one. this was consistent with results of the comparison between pm and mm intensities of the nipponbare genome when the log <dig> intensities of pm probe were above  <dig>  . snep performances at a significance level of 10- <dig>  the most suitable threshold on the roc curve of the shoot , for shoot and young panicle data are summarized in table  <dig>  sfp detection accuracy with young panicle data was better than that with shoot data, and the number of correctly called sfps was higher in the young panicle  than in the shoot , however, the difference of sfp detection accuracies between young panicle and shoot data was not significant.

the probe sets with intensity above log10- <dig>  for both nipponbare and 93- <dig> genomes were surveyed. called indicates the number of probes detected as sfp probes at p < 10- <dig> by snep. true and false are same as in table  <dig>  a, the case applied to the both shoot and young panicle. b, the case applied to either shoot or young panicle. c, the number of sfps detected by whole-genome hybridization in true.

to investigate effects of selection by gene expression level on sfp detection by transcript hybridization, snep analyses were performed for all probe sets. in snep analysis, extraction of probes sets does not affect on individual sfp detection performance, because snep analysis performs sfp detection on a set by set basis. however, extraction by expression level improved total sfp detection sensitivity and fpr by transcript hybridization . sensitivities of true sfp detection for shoot and young panicle data at the same snep threshold, 10- <dig>  were markedly decreased by addition of low expression genes from  <dig> % to  <dig> % and from  <dig> % to  <dig> %, respectively . fprs also became worse from  <dig> % to  <dig> % in shoot and from  <dig> % to  <dig> % in young panicle. however, in snep analyses for all probe sets, increments of the detected numbers of true sfps in both transcript hybridizations could be achieved without a large increment of false positive sfps at a stringent threshold, 10- <dig> ~10- <dig> , . snep analyses of all probe sets at a stringent threshold are an alternative to those of highly expressed genes at a moderate threshold for obtaining more true sfps.

numbers of "shoot expressed" and "young panicle expressed" were from table  <dig>  numbers of snep analyses for "all" were summarized both at the same snep threshold, 10- <dig>  and at the same fpr of "expressed".

in both shoot and young panicle roc curves, fpr seemed to have a minimum at around  <dig>  . numbers of falsely called sfps in shoot and young panicle data were  <dig> and  <dig> at a significance level of 10- <dig>  respectively . even at a higher threshold, at a significance level of 10- <dig>   <dig> and  <dig> falsely called sfps were observed and  <dig> probes were common in both the shoot and panicle. because most of the decrease in intensity of falsely called sfps appeared to be similar to that of real nps, we investigated this in detail. one possible cause of a falsely called sfp was gene duplication in the 93- <dig> genome. in the  <dig> probe sets with common falsely called sfps, more than half of these target genes appeared to be multiple copies in the 93- <dig> genome by blastn searching, and false-positive probes did not perfectly hit all multiple targets. another possible cause of falsely called sfps is alternative splicing or structural differences between the expressed gene and the model used to design the probes. to confirm the influence of alternative splicing and structural differences on sfp detection, we performed snep analysis between nipponbare shoot and young panicle data, and found a total of  <dig> falsely called sfps at a significance level of 10- <dig> . in other words, intron-targeting probes were called as sfps by snep when the expression level of a gene was different. although  <dig>  and  <dig>  sfps were correctly called from shoot and young panicle data, respectively,  <dig>  sfps were identical due to their similar expression profiles . a disadvantage of sfp detection by transcript hybridization is that the ability to detect sfps from rna data depends on the expression level of a gene in a particular tissue type. to achieve a large number of sfps, various rna profiling data from different tissues would be required. in this study, about 40% of correctly called sfps were detected by transcript hybridization and the remaining were detected by whole-genome hybridization .

the distribution of highly expressed genes and correctly called sfps in the nipponbare genome was investigated in a manner similar to that of whole-genome hybridization, as indicated in the previous section. the distribution of probes of genes expressed highly in both the shoot and young panicle was the same as that of the unique probes used in this study . the distribution of correctly called sfps in both tissues corresponded with that of expressed genes.

analysis of false-negative and -positive sfps by whole-genome hybridization
sfp detection performance of whole-genome hybridization was inferior to that of transcript hybridization . low gene expression levels caused low sensitivity in sfp detection by transcript hybridization. causes of low sensitivity in sfp detection would be different for whole-genome and transcript hybridizations. we examined probe binding affinities. the distribution of binding affinities of all unique probes, correctly called sfp probes, and false-negative sfp probes were investigated . each pm probe binding affinity  was calculated by nearest-neighbor thermodynamic parameters  <cit> . we found that almost all unique probes had binding affinities of approximately -24~- <dig> kcal/mol, and the plot for correctly called sfp probes indicated a sharp and high peak at around - <dig> kcal/mol. however, the plot of sfp probes that were not called  was shifted to strong binding affinities. this result leads us to conclude that sfp detection by whole-genome hybridization is difficult with probes that have very strong binding affinities. by selecting lower-affinity probes, with Δg > - <dig> kcal/mol, the sfp detection sensitivity was improved from  <dig> % to  <dig> % with a similar fpr .

even at a stringent threshold of sfp detection, significant false-positive calls existed and there was a minimum frp limit on the roc curve at around  <dig>  . sources of the false positives in sfp detection by whole-genome hybridization may be different from those by transcript hybridization. amplification polymorphisms during whole-genome amplification by annealing random primers to polymorphic sites are possible causes of false positives. because the amplified fragment length in the case of whole-genome hybridization was 100- <dig> bp and probes in a probe set were concentrated in a ~300- <dig> bp region near the 3'-end of genes, false positives by amplification polymorphisms should be clustered. the number of false-positive probes in a probe set were compared with those expected from random occurrences . the observed false-positive probes were not randomly distributed within probe sets and were clustered. this suggested that amplification polymorphisms caused false-positive sfps by whole-genome hybridization.

discussion
many new applications of oligonucleotide arrays have been developed in recent years. in this study, we describe a method to seek optimal conditions for sfp detection by both genome and mrna hybridizations using the differences between pm and mm probe signal intensities of completely matched targets. these optimizations greatly improve sfp detection performances in both whole-genome and transcript hybridizations. this simple method is applicable to any other affymetrix arrays of any species. especially, for large genome species, this method will be useful to evaluate the possibility of sfp detection.

under the optimized conditions, sfp detection performances in both genome and mrna hybridizations were evaluated using the whole genome sequences of the two sequenced strains of o. sativa nipponbare and 93- <dig>  sensitivity  and fpr  of sfp detection by whole-genome hybridization was less than the reported sensitivity  and fpr  of sfp detection by genome hybridization of arabidopsis  <cit> . following the arabidopsis protocols  <cit> ,  <dig> μg of labeled product was obtained from  <dig> ng of rice gdna. the labeled product  was used in arabidopsis whole-genome hybridization experiments, and the rice optimal concentration was ~ <dig> times lower than that of arabidopsis, considering their genome sizes. although a lower target concentration was used for rice whole-genome hybridization and single copy probes were selected for analysis, pm and mm probe intensities could not be sufficiently differentiated. these limitations affected sfp detection. the gc content of rice genes was found to be higher than that of arabidopsis  <cit> . thus, binding affinities of many rice probes are stronger than those of arabidopsis, making it more difficult to effectively detect sfps. in fact, for rice whole-genome hybridization, it was difficult to separate mm probe intensities in the affymetrix rice genome array from pm probe intensities, although overall pm probe intensities were maintained at the same level as those in the genechip® arabidopsis ath <dig> genome array for arabidopsis whole-genome hybridization .

our results from the whole-genome approach suggested that false-positive probes were clustered due to amplification polymorphism caused by nearby snps. thus, these false positives can be used as genetic markers if there is a real np within  <dig> bp around them.

using shoot and young panicle transcripts, higher sfp detection sensitivities  were observed with a similar fpr of 21%. comparing our previous results, a sensitivity of 65% and fpr of 10% for  <dig>  probe sets from the canonical rice data of the young panicle  <cit> , the sfp detection performances from our present results appears inferior. the differences between previous canonical and present data are as follows: all probe sets of canonical data consisted of  <dig> probes ; all probes in the canonical data set were single copies in both nipponbare and 93- <dig> genomes ; and probe sets that consisted of probes entirely polymorphic to the 93- <dig> genome were eliminated in the canonical data probe sets . these differences made it difficult for snep to detect sfps, because snep detects sfps as outliers.

using sequence analysis, in the focused  <dig>  probe sets,  <dig>  probe sets were expected to have sfp probes in the 93- <dig> genome . however, a substantial number of predicted sfps were excluded for snep analysis of transcripts, because probe intensity with np was affected only when the gene was expressed at a high level. even for sfps containing probe sets with highly expressed gene, 6~7% of sets consisted of more than half the sfp probes and failed to detect sfps as outliers in a set. this proportion of highly diverse genes was higher than that expected from the random occurrence of mutations. this is not an unusual phenomenon because differences in gene evolution rates are often observed. most nps in highly divergent genes were undetected by snep because of the difficulty in distinguishing outliers of log10-intensity differences in a set. on the other hand, several issues aside from np, such as alternative splicing or gene duplication, lead to sfps. gene duplication can result from unequal crossing over in chromosomal duplication, the outcomes of which can be quite different. difference in exon-intron structure between duplicated genes in the 93- <dig> genome could also lead to these misclassifications. some false positive sfps detected by transcript hybridizations were attributed to various forms of genetic diversity such as copy number of a gene and alternative splicing. in other words, snep detects differences not only in nucleotide sequences and expression levels of a gene, but also in the gross structure of a gene.

more than  <dig>  sfps could be detected by whole-genome hybridization, and about  <dig>  sfps and precise expression polymorphisms could be simultaneously detected by snep using transcript hybridization. a technology for simultaneous genotyping by polymorphic markers densely covering the whole genome can be utilized for various applications. analysis of gene expression levels as a quantitative trait  is a promising application of sfps. in eqtl studies of yeast, genotypes of segregants were determined by about  <dig>  sfps from gdna hybridization, and gene expression levels were determined by another type of microarray with spotted pcr products of the genome  <cit> . the first global eqtl study in a plant was performed in arabidopsis using  <dig> recombinant inbred lines, in which genotypes of  <dig> sfp markers and gene expression levels were evaluated by affymetrix expression arrays  <cit> . in barley, using affymetrix expression arrays and  <dig> doubled haploid lines, more than  <dig>  genetic markers were identified and underwent eqtl analysis with  <dig> unique segregation patterns in the population  <cit> . because these eqtl studies used experimental populations with a limited number of recombinations, the number of genetic markers required for eqtl analysis was not so large. to perform eqtl in rice using an experimental population with homozygous genotypes between japonica and indica, application of snep using transcript hybridization would provide a sufficient number of genetic markers and a robust estimation of gene expression levels.

recent revolutionary developments in sequencing technologies have challenged microarray technologies  <cit> . however, the affymetrix genechip® array analysis by bulk gdna hybridization is a cost-effective option for mapping a gene by bulk segregant analysis or qtl extreme mapping, because the rice genome is more than  <dig>  times larger than that of arabidopsis and the required number of reads by a sequencer should be proportional to the genome size.

CONCLUSIONS
in this study, we describe a method to seek optimal conditions for sfp detection by both genome and mrna hybridizations using the differences between pm and mm probe signal intensities of completely matched targets. the optimizations allowed a more than 20% increase in true sfp detection in whole-genome hybridization and a large improvement of sfp detection performance in transcript hybridization. significance analysis of the microarray for log-transformed raw intensities of pm probes gave the best performance in whole genome hybridization, and  <dig>  true sfps were detected with  <dig> % false positives by whole genome hybridization. for transcript hybridization, stable sfp detection was achieved for highly expressed genes, and about  <dig>  sfps were detected at a high sensitivity  in both shoot and young panicle transcripts. high sfp detection performances of both genome and transcript hybridizations indicated that microarrays of a complex genome  can be effectively utilized for whole genome genotyping to conduct mutant mapping and analysis of quantitative traits such as gene expression levels.

