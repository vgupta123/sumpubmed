BACKGROUND
biological motivation and overview
normal development of an organism depends on precisely regulated temporal and spatial expression of its genes. in unicellular organisms, such as yeast, different sets of genes are expressed at different stages of the cell cycle. in higher organisms, with very few exceptions, all of the different types of cell possess the same genes; however each type of cell only expresses a unique set of "signature" genes at a certain time, depending on current developmental tasks  <cit> . different life stages of an organism are thought to share the same or similar set of "signature" genes, which thus play a role throughout ontogenesis. for example, there are two phases of somatic muscle formation in the development of drosophila melanogaster. the first phase of myogenesis occurs during embryonic development and generates larval muscle elements that mediate the relatively simple behaviors of the larva. during pupal metamorphosis, a second phase of myogenesis generates a diverse pattern of muscle fibers, facilitating the more complex behaviors of the adult fly  <cit> .

while appreciating intrinsic differences between these two phases of myogenesis in drosophila, it seems plausible that the genes involved in embryonal myogenesis are re-activated, perhaps in a modified way, during the assembly of adult muscles  <cit> . in a recent study of temporal gene expression during the life cycle of drosophila by arbeitman et al., using cdna microarrays, a group of "muscle" genes was identified from gene expression time courses  <cit> . viewed over the entire life cycle, genes in this group exhibit a two-peak expression pattern where the timing of expression peaks coincides with the timing of larval and adult muscle development. another example is provided by the group of "strictly maternal" genes of drosophila. it has been suggested that "if the information to build the fly is already deployed in the newly laid egg, then the genes that encode that information must be expressed and utilized while the egg is being constructed, during oogenesis"  <cit> . this was confirmed by arbeitman et al., who showed that the "strictly maternal" genes had peaks during the very early hours of embryonal development and were only re-expressed at higher levels in the female germline during oogenesis  <cit> .

it seems straightforward that within a specific biological pathway a gene with higher expression level in an early stage of development also tends to be expressed more in a later stage. however, to the best of our knowledge, this issue has not been quantitatively investigated in the temporal gene expression framework. it is therefore of interest to quantify repeated patterns of gene activation over the life cycle. such patterns may reflect properties of the molecular basis of events during ontogenesis that underlie the cellular changes. on the other hand, as the same set of "signature" genes may appear at different life stages, they orchestrate similar yet distinct phases of development. there appear to be two levels of genetic information being accessed during the different phases: the common information of the same development and the specialized information pursuant to the distinctive phases. this motivates the task to quantitatively ascertain relationships of gene expression trajectories for various developmental stages. variation in the patterns of gene expression may point to unique morphological, physiological or molecular properties of individual phases that manifest themselves in phase-gene specific interactions.

to study these questions, we take advantage of the temporal microarray gene expression data collected by arbeitman et al. for drosophila, with the specific goal to regress later life gene expression patterns on those of embryonal gene expression  <cit> . since these expression patterns are time-dynamic, the goal of relating various gene expression dynamics to each other requires the deployment of statistical methodologies that are adequate for regressing time courses on each other. functional regression analysis is a promising tool to ascertain such relationships. the ultimate goal is to gain insights into pathways that are repeatedly activated during the life cycle. we demonstrate here that distinct relationships exist between later life expression trajectories and embryonal trajectories, which can be summarized as positive and negative association. positive association describes groups of genes for which higher embryonal expression tends to be followed by higher expression during reactivation of these genes in later life as well, with opposite effects in the case of negative association.

temporal gene expression profiles for the drosophila life cycle
arbeitman et al. reported cdna microarray transcriptional profiles for nearly one-third of all  <dig> drosophila melanogaster genes throughout a complete life cycle, covering  <dig> sequential time points, beginning at fertilization and spanning the embryonic, larval and pupal periods and the first  <dig> days of adulthood, when males and females were sampled separately   <cit> . groups  of co-expressed genes were identified. in this paper we study the nature of dynamic relationships of expression during different life cycle phases for two groups of such genes.

a first group is composed of  <dig> "muscle" genes. the tissue-specific  genes in this group have a two-peak expression pattern that coincides with larval and adult muscle development. larval muscle development is initiated in the embryo by the gene twist , which directly regulates another gene dmef <dig>  some twi-expressing cells are set aside during embryonic myogenesis to contribute to adult-specific muscle formation. in both larval and adult muscle development, dmef <dig> is required for the differentiation of the various muscle types  <cit> . fifteen of the  <dig> genes in this group  contain pairs of predicted dmef2-binding sites, so that many of the genes in this group are likely to be direct targets of dmef <dig>  <cit> . our goal is to study the dependence of adult gene expression patterns on larval patterns for this group of genes.

a second group of genes that we consider are  <dig> "strictly" maternal genes. these maternal genes are responsible for the polarity of the egg and ultimately, the embryo. each of these is deposited into the egg during oogenesis by the mother prior to fertilization, in preparation for later function during embryonic development. transcripts from all these genes are degraded after fertilization and are not re-expressed until oogenesis in the female germline  <cit> . our interest is to assess gene expression pattern dependencies between early embryo and the female adult germline for this group of genes.

key features and relevance of functional regression
the developmental gene-specific expression time courses are viewed as being generated by an underlying smooth random trajectory which is specific to each gene. these trajectories are sampled at a grid of measurement points during each life cycle phase, e.g., s <dig> ...,sp, where p =  <dig> for the measurements of gene expression during the embryonal period. if we denote the embryonal phase predictor trajectories by xi, where i is a gene index, then the observed data for the embryonal gene expression are xij = xi + eij, where the eij are measurement errors which are assumed to be independent, with zero mean and finite variance.

the situation is analogous for the response trajectories yi which pertain to measured expression of the same genes but for a different developmental phase and also give rise to a set of analogously defined discrete measurements . as the gene expression dynamics in our model is reflected by the entire embryonal and later life trajectories, the task arises to relate response trajectories yi to predictor trajectories xi. a basic problem here is the high dimension of both responses and predictors. as further detailed in section  <dig> , classical regression models do not provide good estimation for this situation and classical regression inference is hampered by the high dimensions and the necessity to adopt multiple testing procedures. functional regression on the other hand incorporates an automatic dimension reduction step which is data-adaptive and therefore estimation relies on only few parameter estimates. an overall functional coefficient of determination r <dig> in conjunction with the bootstrap can be used for functional inference.

functional linear regression, where both predictors and responses are trajectories, can be understood as an extension of multivariate linear regression. the development of functional regression falls within the expanding area of functional data analysis  <cit> . recent work for the case where predictors are scalars and the responses are trajectories includes references  <cit> . for the purpose of relating gene expression trajectories to each other, a functional regression setting in which both predictor and response are trajectories is appropriate  <cit> .

we extend previous methodological work in various directions useful for the analysis of gene expression trajectories, demonstrating the following beneficial features:  functional linear regression can be broken down into a series of linear regressions of functional principal component scores of the response trajectories on those of the predictor trajectories;  this decomposition leads to a straightforward implementation of functional regression via a series of simple linear regressions;  the decomposition opens up alternative ways to interpret a functional regression relation;  outliers and influential trajectories corresponding to individual genes can be identified with this methodology; and  inference for functional regression can be obtained via bootstrapping.

in biological applications of functional regression it is often of primary interest to test whether a functional regression relationship exists for given data. for this objective, the proposed bootstrap method is very useful; besides testing for significance of a functional regression, it can also be used to construct confidence regions. equally important is the interpretability of the results, for which the decomposition into simple linear regressions provides an useful alternative. for the developmental drosophila gene expression profiles, various types of dependency of adult on embryonal gene expression trajectories can be clearly distinguished through the application of these functional regression tools, reflecting differences in the underlying dynamics of gene expression. the proposed methodology is inherently nonparametric and therefore very versatile.

methods
the description of the methods in the following includes some technical material that is not essential for the description of the results in the following sections but is provided so as to give a complete account of the functional regression methodology. the methodology described below and used for the analysis of gene expression trajectories has been implemented in matlab and is freely available in the pace  package, downloadable from the internet  <cit> .

in this program, if one chooses default values, the only required input for the functional regression part pace-reg are the measurements of gene expressions for predictor and response trajectories, denoted in the previous section by  and  where i ranges over the genes, j over the predictor measurements , and k over the response measurements . as outputs one obtains the quantities as shown in the results section.

preliminaries on functional linear regression
denoting the random predictor and response functions by x resp. y, their mean functions by μx = e), μy  = e) and their covariance functions by gx = cov, x), gy  = cov, y), one obtains under mild conditions the karhunen-loève expansions for trajectories x and y, given by

  x=μx+∑j=1∞ξkφk, 

  y=μy+∑k=1∞ζkψk 

. these representations provide a convenient way to implement the necessary dimension reduction for the trajectories x and y, by truncating the sums on the r.h.s. at a finite number of terms, where the truncation point needs to be chosen data-adaptively . the trajectories are represented by their overall mean function, random coefficients ξj resp. ζk and the sequence of basis functions φj resp. ψk, with indices j and k ranging between  <dig> and the truncation value, say  <dig> ≤ j ≤ j for x and  <dig> ≤ k ≤ k for y. the functions φj and ψk are chosen as eigenfunctions and are often referred to as "modes of variation": they represent the main "directions" in function space in which the trajectories vary. representations  and  are analogous to expressing a centered random vector in terms of the basis of the vector space that consists of the eigenvectors. the random effects ξj, ζk are centered at zero and are referred to as functional principal component scores, or just scores. additional mathematical details can be found in the appendix.

the functional linear regression model with response function y and predictor function x is

  e|x)=μy+∫sβ−μx)ds, 

where the bivariate regression parameter function β is smooth and square integrable  <cit> . this model emerges as a generalization of the multivariate linear regression model e = bx, where x and y are random vectors and b is a parameter matrix. the function β is central to this functional regression model. for fixed t, the value of the response trajectory at t, which is y, is obtained by integrating the predictor trajectory over its domain with the weight function β, viewed as a function of s for fixed t.

one way to interpret the functional regression is therefore to fix various levels of t and to then inspect these weight functions by taking the appropriate cross-section through the surface β when t is held fixed at the selected level. this weight function then indicates which parts of the predictor trajectory contribute positively or negatively to the outcome y. under regularity assumptions, the regression parameter surface β has the following basis representation,

  β=∑k=1∞∑j=1∞βkjφjψk,βkj=ee. 

a detailed description of how the mean functions μx, μy, eigenfunctions φj, ψk and eigenvalues λj, τk can be consistently estimated from noisy data by using nonparametric smoothing methods can be found in references  <cit> . these estimation steps involve pooling the measurements for all predictor  trajectories and then applying a smoothing method to obtain the mean function μx, and to smooth pointwise "raw" covariances  to obtain the smooth covariance function cov, x). then eigenfunctions are obtained by numerical discretization and spectral decomposition of the resulting covariance matrix and projected onto a positive definite covariance function. this leads to estimates ξ^j, ζ^k of the functional principal component scores ξj, ζk. these estimates must cope with noise in the observed expression data and therefore are implemented as estimated conditional expectations. the resulting estimates are then plugged in on the r.h.s. of eq.  to obtain an estimate of the regression parameter function β.

decomposing functional linear regression into simple linear components
as is shown in the appendix, the relationships between response scores within the functional linear model are simple: they are simple linear regressions through the origin, i.e.,

  e = βkjξj. 

here the slope coefficients βkj of these simple linear regressions define the functional regression parameter function according to . this leads to the conclusion that functional linear regression can be decomposed into a series of simple linear regressions of the functional principal component scores of response processes on those of predictor processes.

this fact substantially simplifies the analysis and provides an alternative interpretation of the resulting functional linear regression model. note that representation  implies that for given slopes βkj, the regression parameter surface β is uniquely determined. it follows from  in the appendix that the inverse also holds. therefore, a functional linear relationship between random trajectories y and x can be described equivalently by the regression parameter function β or the doubly-indexed sequence of all slope coefficients βkj, k, j ≥  <dig> 

a consequence of this equivalence is that estimates of the slope coefficients can be directly used to obtain straightforward estimates of the regression parameter function. another consequence of this equivalence is that it opens up two different perspectives for the interpretation of a functional linear regression relation: either through features of the shape of the regression parameter surface β, or through the ensemble of the regression slopes βkj, k, j =  <dig>   <dig> .... for the latter, the interpretation is in terms of changes towards the direction of the corresponding eigenfunctions. for example, if the slope coefficient β <dig> relating the first predictor score to the first response score is positive and large, it implies that as the predictor trajectories move increasingly towards the direction marked by φ <dig>  i.e., from its mean μx towards μx + γφ <dig> for increasing γ, response trajectories move increasingly towards direction ψ <dig>  i.e., from μy towards μy + γψ <dig> for increasing γ. the other slope coefficients can be interpreted analogously.

often there will be interest in measuring the strength of association between predictors and responses in a functional regression. the classical measure in a multiple linear regression relationship is the coefficient of determination r <dig>  extensions to the functional case were discussed in reference  <cit> . when applying the decomposition into simple linear regressions, this functional coefficient of determination assumes a particularly simple form.

implementing the decomposition
given estimates φ^j, ψ^k, ξ^ij and ζ^ik of eigenfunctions and functional principal component scores, the regression parameter surface is estimated by

  β^=∑k=1k∑j=1jβ^kjφ^jψ^k, 

where unknown slope estimates β^kj can be obtained by least squares estimation of the slopes in scatterplots {ζ^ik} on {ξ^ij}, fitted without intercept, for all k =  <dig> ..., k, and j =  <dig> ..., j. these least squares estimates are however subject to attenuation and therefore bias due to the presence of errors in the predictors {ξ^ij} , as these need to be estimated from the data and are therefore imprecise. an alternative estimate that is less subject to this problem is given by

  β^kj=1λ^j∑i=1n,1≤j≤j, 1≤k≤k, 

as the denominator is estimated directly from the covariance surface where the measurement errors are confined to the diagonal which allows to eliminate their effect to a large extent. if the denominator is estimated from empirically observed functional principal component scores, as is the case in the usual least squares estimators, then contamination by error may lead to inflated empirical variances, and as a result to attenuation of the estimated regression coefficients. in the following we therefore adopt the alternative estimate .

note that j and k denote the numbers of random components of predictor resp. response processes to be included in the functional regression analysis. these numbers can be determined in practice by scree plots, displaying the fraction of variance explained as the number of included components increases. this simple and fast approach leads to adequate results, choosing the smallest number of components that explain 85% of the variation. alternative selectors are discussed in references  <cit> . based on , we insert the chosen values of j and k to obtain the estimated coefficient of determination

  r^2=∑j=1j∑k=1kr^kj2τ^k∑k=1kτ^k,withr^kj2=β^kj2λ^jτk, 

using estimates . here the r^kj <dig> are the estimated coefficients of determination of the simple linear regressions of ζik on ξij, which target .

bootstrap inference
inference for the functional regression that overcomes the high dimension and multiple testing problem is obtained by the bootstrap. in the face of the complexity of the dependencies between estimated functional principal component scores and estimated eigenfunctions, the regression bootstrap with resampling from the sample of all pairs of predictor and response trajectories emerges as a doable approach. the starting point for generating the bootstrap samples is to randomly sample n units from trajectory indices { <dig>   <dig> ..., n} by sampling with replacement and, for each sampled index i*, entering all observations for the corresponding predictor and response trajectories. this sampling procedure is repeated until b bootstrap samples, consisting of predictor and response data for each of n trajectories, have been assembled.

for each of these bootstrap samples, we then carry out the functional linear regression procedure, obtaining all relevant estimates. the resulting estimates from the b bootstrap samples are used to construct pointwise confidence intervals for the regression parameter function β, simply by locating the corresponding lower and upper quantiles in the bootstrap distribution of the estimated surface values β^  for all fixed s, t. the resulting upper and lower confidence surfaces will provide an idea how well the surface is actually determined from the data. analogously, local confidence bands can be constructed for individual predicted trajectories, given any predictor function.

in addition to confidence intervals, it is a common objective in regression analysis to establish the "significance of the regression relation", i.e., to infer whether within the assumed model the predictors indeed influence the responses. the classical test for a multiple regression corresponds to the null hypothesis that all regression slope coefficients vanish, or equivalently, that the coefficient of determination r <dig> = var)/var vanishes. the extension to the functional case is not straightforward. in a first attempt to assess the overall significance of the functional regression, one can use pointwise bootstrap confidence intervals, say at the 95% level, and check whether there are areas where  <dig> is not included in these intervals. however, this does not properly account for the multiple confidence statements that are made. to obtain an overall bootstrap test for the significance of the functional regression relation, we use an alternative resampling procedure where predictors and responses are resampled separately under the null hypothesis of no regression relationship. for each resample, the data for a predictor trajectory and the data for a response trajectory are selected separately by sampling with replacement from all predictor and all response trajectories. as predictors and responses are unrelated in this case, applying functional regression to b such null bootstrap samples  provides a null distribution for the pivotal statistic.

in our approach we specifically select the functional coefficient of determination r <dig>  as test statistic, as it summarizes the regression effect. accordingly, we obtain the overall p-value of the functional regression by determining the empirical quantile of the observed value of r <dig> within the null bootstrap distribution for r <dig>  bootstrap inference for the overall regression effect based on this device will be illustrated in the application to gene expression profiles in the next section.

RESULTS
regressing pupa-adult temporal gene expression profiles on embryonal profiles for muscle-specific genes
the functional response is the combined pupa-adult temporal gene expression profile, which we view as a smooth random function. for each of the  <dig> muscle-specific genes, these expression profiles are sampled at  <dig> time points during the combined pupa-adult phase. likewise, the functional predictors are smooth random functions that correspond to the embryonal gene expression profiles, recorded for the same genes as the functional responses, and sampled at  <dig> time points. an initial step is the estimation of the mean trajectories for predictor and response. along with the individual temporal gene expression profiles, these mean trajectories are shown in fig.  <dig>  they are flat in the beginning for both predictors and responses and for predictors increase monotonously in the right half, while they have a marked peak in the right half for the responses. this provides a general timeline for the expression of these muscle-specific genes.

decomposing the functional linear regression into simple linear components as described in methods leads to four scatterplots visualizing first and second functional principal component scores of response processes versus first and second functional principal scores of predictor processes. these are shown in fig.  <dig>  along with the fitted least squares regression lines. we note that the positive slope of the simple linear regression of the first functional principal component scores on each other stands out .

the functional coefficient of determination as defined in  is found to be r <dig> =  <dig> , with p value p =  <dig> , obtained via the null bootstrap  and based on b =  <dig> bootstrap samples. we note that the size of this functional coefficient of determination points towards a strong regression relationship. the associated bootstrap p-value is correspondingly small, indicating the significance of this functional regression relation. we may infer that as the expression profiles of predictor trajectories are increasing proportionally in the direction of the first eigenfunction, the response trajectory gene expressions also tend to increase in the direction of their first eigenfunction. since the first eigenfunctions are overall quite similar to the mean expression trajectories, and explain most of the variation, another way to express this is to say that as the level of gene expression increases proportionally to the mean expression trajectories for embryonal muscle-specific genes, the expression of pupa-adult trajectories also tends to increase proportionally to their respective mean response trajectory.

we conclude that for muscle-specific genes the expression patterns of both embryonal and pupa-adult phases are positively coupled in a relatively straightforward fashion. one could summarize the situation as proportionality of the activity patterns for muscle genes between adult and the embryo phases. this is an instance of functional proportionality. this functional proportionality with its positive coupling is also evident when looking at individual predictor trajectories and their associated fitted response trajectories; these are shown for a sample of randomly selected six genes in fig.  <dig>  the higher the amplitude of a predictor trajectory is, with more expressed features such as lower trough, steeper rise and higher peak, the more expressed are the features of the corresponding response trajectory, such as a higher peak.

functional linear regression of pupa-adult profiles on embryonal profiles for strict maternal genes
a functional regression relationship that clearly differs from the functional proportionality that was seen to be present for the muscle-related genes is found for the group of  <dig> strict maternal genes. the number of time points at which expression is available is the same as for the muscle-specific genes, with expression during the embryonal phase as predictor and expression during pupa-adult phase as response.

as in the analysis for muscle-specific genes, we first plot individual gene expression trajectories for the embryonal predictor phase and the pupa-adult response phase overlaid with the mean trajectories in fig.  <dig>  we find distinct patterns of expression for both embryonal and pupa-adult phases, with fast early and then slower late declines in mean gene expression for the embryonal phase, while the mean trajectory for the pupa-adult phase shows low and nearly constant expression on average for the first  <dig> time units , later followed by rapidly increasing expression .

again, two eigenfunctions are chosen for response as well as predictor trajectories, shown in fig.  <dig>  in contrast to the muscle-specific genes, the first eigenfunction is not proportional to the mean function for predictor trajectories, while the second eigenfunction has this property. for response trajectories, the first eigenfunction is approximately proportional to the mean expression function.

decomposing the functional regression into the corresponding series of four simple linear regressions without intercept, the least squares fitted regression lines are shown in fig.  <dig>  along with the corresponding functional principal component scores. the positive relation of ζ <dig> versus ξ <dig> implies that embryonal expression that is above the mean trajectory, especially in the pattern delineated by the first embryonal eigenfunction, is associated with a pupa-adult response that is below the mean pupa-adult trajectory. this inverse pattern, with a slightly different emphasis on the nature of the deviations from the mean function, is also evident in the simple regressions of ζ <dig> vs ξ <dig> with its positive slope, and in the regression of ζ <dig> vs ξ <dig> with its negative slope. here we note that a larger first principal component ζ <dig> corresponds to a response that is below the mean response, according to the negativity of the first eigenfunction of the response trajectories . we note that  in order to evaluate the signs of the simple linear regression coefficients, they need to be considered in conjunction with the signs of the corresponding eigenfunctions; and  functional principal component scores measure the difference of a random trajectory and its mean trajectory, according to the karhunen-loève expansion , and therefore serve as proxies for the differences in gene expression between an individual's trajectory and the mean trajectory.

the inverse relation between embryonal and pupa-adult expression can also be visualized through the shape of the regression parameter surface : expression for the early part of the pupa-adult phase is larger for those trajectories with a larger increase in the embryonal expression over time , however this effect is reversed for the later part of the pupa-adult expression. this reversal reflects the inverse functional relationship.

a more direct way to interpret the functional regression is provided by looking at a few predictor trajectories and their associated responses . a clear pattern that emerges is that predictor curves  that fall above the mean have associated response curves below the mean and vice versa, thus providing the graphical equivalent of an inverse functional relationship: those genes characterized by increased expression during the embryonal period express less in the pupa-adult period. this observed negative association is of interest, as it is quite unexpected and pinpoints a dynamic interaction of life cycle stage and gene expression. the underlying mechanism causing this phenomenon and the strong differences between muscle and maternal genes is unknown and further studies to uncover it would be of interest.

for bootstrap inference , we construct b =  <dig> bootstrap samples and also null bootstrap samples. for the choices of the number of included components j for predictor processes and k for response processes, implementing the criterion of 85% of variance explained, the relative frequencies of bootstrap selections were as follows: j =  <dig> in  <dig> %, j =  <dig> in  <dig> %, and k =  <dig> in  <dig> %, k =  <dig> in  <dig> %, and k =  <dig> in  <dig> % of all bootstrap samples. pointwise 95% bootstrap confidence intervals are shown along with the function estimates for mean functions μx and μy in fig.  <dig>  and for the first eigenfunctions for predictor and response in fig.  <dig>  the 95% bootstrap confidence surfaces along with the estimated parameter function surface can be found in fig.  <dig>  in view of the large and dominant size of the area where the confidence surfaces do not include  <dig>  it seems likely that the regression is significant.

to more unequivocally establish significance, we also ran the bootstrap test, described above, which is based on the functional coefficient r <dig> as test statistic and the null bootstrap. this led to a p-value of p =  <dig> , for the functional coefficient of determination r <dig> =  <dig> , providing evidence that the functional regression relation is significant here, with a sizable functional coefficient of determination.

discussion and 
CONCLUSIONS
comparison with simpler approaches
a natural question is whether the dimension reduction afforded by functional linear regression through regressing the functional principal components on each other is really useful for modeling gene expression trajectories and their relationships. to investigate this, we compared the proposed method with two simpler alternatives, both utilizing conventional linear regression models.

in the first alternative approach, we use the gene expression measurements of as many predictor time points as possible. this amounts to using the predictor expression at every second predictor trajectory time point to obtain the response at each time point where the response was recorded, fitting a multiple linear regression with  <dig> predictors. note that one cannot use all  <dig> predictor time points in this classical regression approach, since then the number of predictors would be larger than the sample size which is not possible. this approach requires to fit as many such regressions as there are response time points, and therefore it requires a large number of parameters with the associated problems. so while this approach is conceptually and numerically simple, it does not provide dimension reduction, does not take into account the continuity of the underlying trajectories, and is subject to measurement errors in the predictors. this method is also not amenable to global significance analysis, as one encounters a multiple testing problem when dealing with the many separate regressions . in the following, we refer to this as the multiple regression approach.

in a second alternative approach, we first average all response measurements and then all predictor measurements to obtain a scalar response and associated scalar predictor. this corresponds to replacing all trajectories by constants. then we run a simple linear regression of the response on the  predictor. this approach includes drastic dimension reduction but fails to model highly non-constant predictor and response trajectories as encountered for the drosophila life cycle genes. this approach will be referred to as the simple regression model.

these methods are then compared in terms of their one-leave-out prediction errors for the muscle and the maternal gene groups: one removes one predictor-response trajectory pair at a time and then fits the corresponding approach . then the predictor data of the left out pair are fed into these fitted models and the resulting predicted responses at the times where the responses were obtained are recorded and compared with the actual observed responses. the differences are squared and averaged over the response times and then are averaged over the sample size of the gene group by recalculating them in turn for each left out pair. this procedure provides the averaged squared prediction error  and is a measure of the quality of the model and how well it can predict the actual observed data for a new data point.

the comparison of the above two alternative approaches with the functional regression method using this predictive quality measure led to the following squared one-leave-out prediction errors  as shown in table  <dig>  it emerges that functional linear regression provides a more sensible approach for the analysis of gene expression trajectories than classical regression approaches.

role of functional regression for gene expression trajectories
this paper explores functional regression approaches and their application to gene expression pro-files. ultimately, useful statistical methodology should facilitate insights into the dynamics of microarray gene expression time courses. our results in the application to temporal gene expression profiles for drosophila life cycle indicate that while iterated reactivation of similar genes occurs throughout ontogenesis, there are gene-group specific differences in the reactivation patterns. investigating the nature of these patterns eventually may provide a connection to the molecular basis of development. as a step towards this goal, we have proposed to quantitatively relate similar genetic pathways at different life stages. functional regression is an adequate and promising tool for this purpose.

in general, a functional data analysis approach is well suited for the analysis of gene expression profiles, complementing the time series approaches that have been advocated for time course gene expression data  <cit> . we discuss in the following the pros and a few cons of the functional linear regression approach.

 <dig>  easily handles a large variety of designs, including those where trajectories are sampled at many fixed times, or are sparsely sampled in random designs  <cit> . totally at random missing observations present no problem .

 <dig>  works under minimal assumptions, as it is a highly flexible nonparametric approach. the shapes of predictor and response trajectories can be arbitrary . no stationarity is required .

 <dig>  dimension reduction aspect avoids large number of parameters problem with increased variability and the need for multiple testing adjustments for valid inference. trajectory dimension is chosen data-adaptively, enhancing the flexibility.

 <dig>  decomposition into a series of simple linear regressions aids interpretation and motivates functional coefficient of determination r <dig>  summarizing the strength of these regressions and representing an overall measure of the strength of the functional regression relation. it also serves as the bootstrap test statistic, discussed before.

 <dig>  availability of associated graphical devices and visualization, characterizing the nature of the relationship between gene expression trajectories: these include  simple linear regressions through the origin of all response principal component scores on all predictor principal component scores, which in their entirety are equivalent to the functional linear regression;  the regression parameter surface β; and  the side-by-side plots of predictor functions and their fitted responses, that may be displayed for a subsample of the data and provide a trajectory-wise representation of the fitted model. these side-by-side plots allow for the easiest overall interpretation, while the simple linear regression lines also can be nicely interpreted when taking into account the shape of the relevant eigenfunctions. the regression parameter surface has the advantage to summarize the fitted model in one plot, and provides an interpretation of how the values of response trajectories at each fixed domain point depend on the entire predictor trajectories via a weight function.

 <dig>  bootstrap as a useful inference tool to construct confidence bands for the functional components of the models such as mean and eigenfunctions and regression parameter surface, and to infer the overall significance of the functional regression relation. for the latter, the functional coefficient of determination r <dig> is a natural target statistics. this allows the usual interpretation regarding the strength of a regression relationship, albeit here for relating random trajectories to each other.

on the con side, the interpretation of the regression parameter function is complex and requires careful scrutiny, as exemplified in the results. the decomposition into simple linear regressions can ameliorate this situation only to some extent. while the simple linear regressions themselves are easy to interpret, in the context of the functional regression model one must take into account the shape of the respective eigenfunctions.

the computational effort is relatively high, compared to classical regression approaches. the pace package includes default features to accelerate computations for a large number of genes, including prebinning the measurements. besides this package, there are not many software options available at this point which implement the described approach.

insights for life cycle gene expression
using the functional regression tool, a first finding is that for the drosophila life cycle, later life gene expression is significantly related to early life gene expression across genes. a second finding is that the nature of the relationship of later phase gene expression profiles with the profiles of earlier phases of the life cycle is specific to a gene group. for the group of muscle-specific genes, increased expressions along the mean trajectories for the embryonal phase are coupled with equally increased expression along the mean expression for the pupa-adult phase. we refer to this kind of relationship as functional proportionality, implying that similar relative expression levels for muscle-specific genes occur during both embryonal and adult phases. such simple positive coupling of gene expression trajectories points towards close ties between the expressions at different stages and can be interpreted as positive developmental correlation.

while myogenesis in embryonal and adult phases are different processes of somatic muscle formation, they share common biological processes, such as myoblast fusion and neuromuscular junction  <cit> . among the  <dig> "muscle" genes, unsurprisingly, seven  are involved in mesoderm development  <cit> . the expression of those genes during adult muscle development indicates that their function might extend to the pupal stage. chen and olson pointed out that many in vitro studies have implicated several classes of proteins in myoblast fusion, including cell-adhesion molecules, protein kinases and phospholipases  <cit> . six genes are related to cell adhesion/receptor activity/signal transduction/protein kinase/phosphate transport   <cit> . most research on molecular pathways on myoblast fusion in drosophila has focused on the embryonal phase, however it is conceivable that similar molecular mechanisms might be involved in adult satellite-cell fusion analogous to myoblast fusion during embryogenesis  <cit> . it is also noteworthy that six genes  are related to myofibril assembly/actin assembly or binding/microfilament motor activity, and five genes  showed neuronal expression. dscam is involved in axon guidance, neuron development and peripheral nervous system development, and slowpoke in synaptic transmission. these genes might be involved in neuromuscular junction building during muscle development. there is also good evidence that during pupal development, motorneuronal innervation is critical to the specification of at least one set of muscle fibers  <cit> .

identification of the muscle gene cluster was based on evidence of the involvement of the same genes in the two phases as suggested in arbeitman's study  <cit> . our results further show that beyond the involvement of these genes in both phases also their levels of expression are a characteristic that is relevant for normal development. although this is plausible, no previous systematic study that we are aware of has provided evidence for this stability in expression level for this class of genes. while most studies have been focusing on certain genes, or on mean levels of expression for groups of genes, an advantage of our approach is that we study a set of genes as a system, focussing on association of their expression profiles over the life cycle.

in the case of maternal genes, we also find a strong functional relationship between the life cycle phase expressions, but their association is of a quite different nature than for the group of muscle genes. we detected a negative coupling in the sense that predictor trajectories above the overall mean of predictors are associated with response trajectories below the overall mean of responses. more specifically, the existence of an initial rapid decline and deep trough in the middle of embryonal gene expression is associated with larger pupa-adult expression throughout, and if there is an initial larger embryonal expression with a more modest decline then this is associated with relatively low pupa-adult expression, including a deeper trough in the response trajectories. this type of functional relationship is surprising and can be described as inverse functional proportionality. it points to a negative developmental correlation, and to the best of our knowledge, such a negative association of gene expression between different phases of development has not been previously reported. it will be of interest to discover the underlying mechanisms, as not much is known about these genes.

gaining biological knowledge by observing and analyzing developmental time courses of gene expression in simpler organisms  paves the way to gain knowledge of the corresponding genetic mechanisms in more complex organisms. for instance, both embryonic and pupal muscle development in drosophila shows striking similarities with elements of pattern formation in vertebrate muscle. the presence of both positive and negative coupling of expression patterns is intriguing and points to complex regulatory mechanisms.

authors' contributions
hgm initiated the project and contributed basic ideas and writing. jmc contributed statistical modelling, implementation and microarray data analysis. xl provided biological interpretation and contributed to the writing.

appendix: mathematical details and derivations
for square integrable predictor and response processes x resp. y with domains s and t, mean functions μx = e), μy  = e) and auto-covariance functions gx = cov, x), gy  = cov, y), one defines the auto-covariance operators

 =∫fgxds,=∫fgyds. 

these are linear operators in the hilbert space l <dig> of square integrable functions, with eigenfunctions characterized as solutions of the eigen-equations  = λf, where λ is an eigenvalue.

we denote by φj and ψk the sequences of orthonormal eigenfunctions for x and y, with non-increasing eigenvalues λj and τk, ∑jλj < ∞ and ∑kξk < ∞, satisfying

  gx=∑jλjφjφj,s <dig> s2∈s,gy=∑kτkψkψk,t <dig> t2∈t. 

the random coefficients ξj=∫s−μx)φjds and ζk=∫t−μy)ψkdt are uncorrelated random variables, respectively, with means e =  <dig>  e =  <dig>  and variances var = λj, var = τk. the eigenfunctions ψk, φj are also referred to as principal component functions and the random effects ξj, ζk as functional principal component scores. a further assumption is that all functions {μy, ψk}, {μx, φj} are smooth, usually it is assumed they are twice continuously differentiable.

derivation of . replacing function β on the r.h.s. of  by the representation  and x - μx by the karhunen-loève expansion , one finds, using the orthonormality of the eigenfunctions φj, that

 e|x)=μy+∑k=1∞∑j=1∞βkjξjψk. 

then  and the orthonormality of eigenfunctions ψk imply

  e=∫|x)−μy)ψkdt=∑j=1∞βkjξj, 

for all k ≥  <dig>  since {ξj, j =  <dig>   <dig> ...} are uncorrelated random variables, it follows from model  that

  e=e=e=e=βkjξj, 

for all pairs k, j, and  follows.

regression parameter function β determines the slopes βkj. using representation  of β, and the orthonormality properties of eigenfunctions φj and ψk, one finds

  ∫ ∫ β φj ψk dt = βkj   for all j, k. 

therefore, the function β determines all slope coefficients βkj uniquely.

functional r <dig>  one can show

  r2=∫tvar⁡|x])dt∫tvar⁡)dt=∑j=1∞∑k=1∞rkj2τk∑k=1∞τk, 

where

  rkj2=)2eξj2eζk2=2λjτk 

are the coefficients of determination for the simple linear regressions of ξk on ζj. this means that in the decomposition approach, the overall functional coefficient of determination r <dig> is obtained as a sum  of eigenvalue-weighted averages of the coefficients of determination of the simple linear regressions .

