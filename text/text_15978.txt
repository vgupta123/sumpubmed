BACKGROUND
the cancer genome atlas  is a comprehensive database that includes multi-layered genome profiles collected from more than  <dig> cancer types, including genomic mutations, mrna and mirna, dna copy number, dna methylation and protein expression profiles. large-scale collection of data inevitably generates batch effects. for example, processing steps ranging from sample collection to data generation are performed on different days using different lots of reagents or at different sites, potentially introducing batch effects into the data profiles. to compile the tcga data, human tumour samples were collected from hundreds of tissue source sites  and sent to two different biospecimen core resources , which processed quality-checked and stored specimens along with patients’ clinical information. on the other hand, genomic data were generated from multiple genome sequencing centers  and the genome characterization centers . these diverse data processing steps were barcoded with a unique sample name, which included the ids of the tss, participant, sample, vial, portion, analyte, plate and gsc .

previously, batch effects in genomic data have been addressed in diverse platforms including microarrays, rna-seq and exome-seq data . in tcga, systematic biases in variable batches have also been reported  <cit> . mbatch, a web-based analysis tool , has been developed to investigate batch effects comprehensively. however, most of these studies are applicable only to continuous variables such as gene expression levels, but not to mutation data. moreover, the overall patterns or characteristics of the sequence variant calls affected by batch effect have not been investigated extensively. thus, in this study, we systematically evaluated batch effects on sequence variants identified from whole-exome data of tcga. by examining barcodes that can introduce batch effects , we identified  <dig> batch-biased variants from pan-cancer data. systematic errors were generated by platform-dependent sequencing reactions, as well as batch effects due to different sampling conditions. by comparing mutational spectra of the batch-biased variants with the unbiased variants, we observed that batch-biased variants preferentially occurred at the sites prone to sequencing errors. moreover, we found that the batch-biased variants had unique sequence patterns that could be recognised and eliminated from the data. our systematic evaluation of batch-biased variants might be helpful in diminishing false-positive calls from the large-scale and heterogeneous tcga profiles.

methods
data collection and processing
of the  <dig> cancer types in tcga , we collected data from  <dig> cancer types which have more than  <dig> samples per cancer type. these included  <dig>  tumor samples from  <dig> mutation annotation format  datasets, which identified somatic mutations in cancers using various analysis pipelines and/or sequencing platforms. of the selected maf files, those with extremely high frequency of indels , no indels, or sample sizes less than  <dig> were filtered out. finally, we used  <dig> maf datasets from  <dig> cancer types for our analysis .

of the barcodes encoded in the sample names, we tested those with sufficient batch size  for each barcode id, including the ids for tss, plate, and gsc. the bcr id and date of shipment were also included in the barcodes. the batches  were obtained from the sample barcode ids, and ‘date of shipment’ and ‘bcr id’ were obtained from the clinical information and tcga batch code table , respectively. in addition, we also evaluated batch effects by clinical features such as patient’s age, gender, race, smoking history, ethnicity, tumor size, tumor grade, tumor stage, histological type, and country.

additional annotation of mutations, including functional category, genomic region, and coding strand, were performed using the annovar software  <cit> . the flanking sequences of mutation sites were obtained using r library ‘biostrings’. homopolymer runs of each nucleotide were calculated by counting the number of continuous identical nucleotides  within the flanking sequences of a variant.

estimation of batch-biased variant calls
to estimate batch effects on sequence variations, the number of samples with a variation in the tested barcode id and other ids vs. the number of samples without a variation were compared by fisher’s exact test for each variation and each barcode id. filtering out the barcode ids with mutation frequency <  <dig> in each maf file, batch-biased variants were identified with a stringent statistical significance threshold of p-value <  <dig> . then, if the two barcode ids had more than 75% of the same batch-biased variants, the barcode id with the highest frequency of batch-biased variants was chosen as representative.

phylogenic tree analysis
the pairwise distance from sequences of all mutation sites was evaluated using r library ‘phangorn’. the phylogenic tree was constructed using neighbour-joining tree estimation method.

consensus sequence and motif analysis
the position-specific consensus sequence of variants was evaluated using sequence-logo viewer weblogo  <dig> with default parameters  <cit> . de novo motif sequence for batch-biased variants at splicing sites was identified using homer with default parameters  <cit> .

RESULTS
identification of batch-biased sequence variants in tcga data
in this study, we used  <dig> maf datasets from  <dig> cancer types obtained from tcga; the datasets were filtered as described in methods . a total of  <dig> , <dig> somatic sequence variants were included in the overall dataset. the mutation frequencies for each maf dataset were highly variable, ranging from  <dig>  to  <dig>  mutations per sample. skin cutaneous melanoma  had the highest mutation rate , whereas thyroid carcinoma  had the lowest mutation rate  . overall, c > t/g > a transition was the most frequent mutation type , whereas the t > g/a > c transversion was the least frequent  .fig.  <dig> identification of batch-biased variants. a. a workflow to identify batch-biased variants. b. distribution of mutation types in tcga data . frequency of mutations in each maf dataset according to mutation types . c. distribution of mutation types of batch-biased variants . frequency of batch-biased mutations in each maf dataset according to mutation type 




to determine possible batch effects on the sequence variant calls, we monitored the association of the mutation frequencies with batches prepared using different processing and data generation steps. batch effects were estimated by applying fisher’s exact test to each batch id, as described in methods. this analysis revealed  <dig>  somatic sequence variants  associated with non-biological batches. ultimately,  <dig> variants with representative batch ids were determined as potential batch-biased variants .

most of the batch-biased variants were indel-type mutations  . the frequencies of batch-biased variants varied considerably among the cancer types. the kidney renal clear cell carcinoma  had the most frequent batch-biased variants , and luad had the second most frequent variants . batch-biased variants were found only in the  <dig> cancer types: kirc, luad, ucec, coad, lgg, lihc, stad, brca, kirp and prad . all the batch effects were related to the barcodes ‘plate’  or ‘tss’ . in particular, plate id  <dig> in kirc  and plate id  <dig> in luad  had the most frequent batch-biased variants . to determine whether biological batches could be detected by our method, we also examined several clinical features, including the patient’s age, gender, race, smoking history, ethnicity, tumour size, tumour grade, tumour stage, histological type and country. however, none of the clinical features exhibited batch effects , suggesting that our analysis can selectively identify non-biological batch effects.table  <dig> the list of biased batch ids




of the  <dig> batch-biased variants,  <dig>  variants occurred recurrently across different cancer types, indicating that batch biases were not related to cancer types . these recurrent batch biases were identified particularly in kirc, luad, and ucec with the plate ids  <dig> ,  <dig>  and a10c , respectively . we also analysed the mutation frequencies at the gene level, revealing  <dig> genes with recurrent batch-biased mutations: slpi, ovgp <dig>  hebp <dig>  il <dig>  kctd <dig>  ssx <dig>  dcdc <dig>  fam104a, ikzf <dig>  eef1b <dig>  emg <dig>  hpgds, mocs <dig>  and apip . based on these observations, we propose that the mutation frequencies of these genes might be overestimated by the batch-biased error calls, especially in kirc, luad, and ucec data.fig.  <dig> recurrent batch-biased variants across cancer types. a. heatmap shows  <dig> recurrent batch-biased variants in the maf file. b. batch-dependent occurrence of batch-biased variants is shown for kirc, luad and ucec datasets, respectively. barcodes of plate ids in each sample are indicated by different colours. c. gene-level frequency of recurrent batch-biased variants . the heatmap colours indicate the significance of batch-biased calls, i.e., -log <dig>  where p was calculated using fisher’s exact test. d. phylogenic tree analyses for kirc  and luad  are shown. the phylogenic trees between the mutation profiles before correction  and after correction  are compared. the corrected mutation profiles are generated by removing the indicated batch-biased variants in each data. barcodes of plate ids in each sample are indicated by different colours




in addition, to evaluate possible effects of mutation similarity of the samples on the batch effects, we performed phylogenic tree analysis on kirc and luad data that had the most frequent batch-biased variants. this analysis revealed that the samples harboring batch-biased variants were clustered together, indicating that these samples had similar mutation profiles . however, the mutation profiles excluding the batch-biased variants did not cluster together. thus, we could rule out the possibility that those batch-associated variants are the result of the similar mutation profiles among the samples.

comparison of mutation spectrum of the batch-biased and unbiased variants
next, to delineate the overall characteristics of the batch-biased variants, we compared the mutation spectrum of the batch-biased variants with that of other unbiased variants . the batch-biased variants had frequent g/c insertions , whereas the unbiased variants did not . of the substitution mutations, the batch-biased variants had frequent t > a/a > t mutations , whereas the unbiased variants had frequent c > t/g > a mutations , revealing a large difference in mutation spectrum between the biased and the unbiased variants .fig.  <dig> comparison of distributions of batch-biased and unbiased variants. a. distribution of indel types  and non-indel types  for the batch-biased variants  and unbiased variants . b. distribution of gc content in each mutation type  for batch-biased variants  and unbiased variants . ratio of gc content was calculated using the  <dig> nucleotide sequences flanking the variant sites.  c. distribution of mutation types according to protein function for the batch-biased and unbiased calls with indel-type  and non-indel–type  mutations. d. distribution of genome coordinates in relation to gene position for batch-biased variants and unbiased variants. e. distribution of mutation rate in each maf dataset for batch-biased variants  and unbiased variants 




we also evaluated the possible association of gc content with the batch-biased variant calls. by calculating the percentage of gc content in the  <dig> nucleotides flanking the mutation sites for each of the mutation types , we found that the batch-biased non-indel–gc variants had significantly higher gc contents than the unbiased variants . conversely, the batch-biased non-indel–at variants showed significantly lower gc content than the unbiased variants . by contrast, the frequency of indel-type batch-biased variants was not related to the neighbouring gc content levels . in addition, batch-biased indels had frequent frameshift insertions, whereas the unbiased indels had frequent frameshift deletions . of the non-indel variants, the batch-biased variants had more frequent stop-loss mutations than the unbiased non-indel variants . these findings imply that generation of batch-biased variants can largely be attributed to neighbouring sequences with preferential mutation types and characteristic gc contents.

previous genomic landscape studies of the sequence mutations exhibited that the mutation rates vary considerably among genomic locations  <cit> . when we evaluated the distribution of the genomic coordinates of the variants in relation to gene positions, we found that the batch-biased variants occurred frequently at splicing sites, although the unbiased variants did not . this result implies the preferential occurrence of erroneous batch-biased variant calls at splicing sites. furthermore, we found that the batch-biased variants had higher mutation rates than the unbiased variants . taken together, our results suggest that batch-biased erroneous sequence variants have unique genomic features and preferentially occur at the positions prone to sequencing errors. thus, sequencing errors might be more frequent when the sample batches were prepared from lower-quality tissues, either due to inadequate processing of the tissue or errors in data generation.

homopolymer runs are associated with batch-biased variants
sequencing errors, particularly indels, occur frequently at repeated homopolymer sequences . with this in mind, we investigated whether the batch-biased variants are associated with the repeated sequences. for each nucleotide type , we calculated the number of homopolymer runs which was determined based on the maximum length of repeated nucleotides in the  <dig> nucleotides in the left and right regions from the variant sites. remarkably, we observed that the distribution of the number of homopolymer runs in batch-biased variants was right-shifted relative to that in the unbiased variants , indicating that the batch-biased variants were more frequent in longer homopolymer runs. when we examined the distribution of homopolymer runs for each mutation type, batch-biased variants frequently had longer homopolymer runs with more than five repeated nucleotides . we also examined the distribution of homopolymer runs with different window sizes of flanking sequence regions. most of the homopolymer runs were found in downstream regions within  <dig> base pairs of the variant sites . this indicates that the batch effect on the variant call is strongly associated with the homopolymer run. because our observations revealed the sequence patterns affected by the flanking regions, we next examined the position-specific consensus sequence distribution using a sequence-logo viewer weblogo  <dig>  <cit> . this analysis revealed the consensus sequence of homopolymer runs at the flanking regions  which were previously identified as the sites likely prone to sequencing error  <cit> .fig.  <dig> homopolymer runs in flanking sequence of code-biased mutations. a distribution of homopolymer run within the  <dig> nucleotide sequences flanking the batch-biased variants and unbiased variants with indel-type  and non-indel–type  mutations. b distribution of the long  homopolymer runs within flanking regions of different window sizes for batch-biased and unbiased variants




batch-biased variants occur frequently at splicing site
in fig. 3d, we showed that batch-biased non-indels were frequently observed at splicing sites. moreover, we observed that the batch-biased variants had frequent t > a/a > t mutations, particularly in the sense strand, implying selection bias for batch-biased calls at splicing sites . therefore, we sought to identify position-specific consensus sequences at splicing sites using a sequence-logo viewer. as shown in fig.  <dig>  the batch-biased but not the unbiased t > a/a > t variants had a clear consensus sequence of the dinucleotide ‘ag’ with upstream long t polymers and the dinucleotide ‘tt’ in the following downstream sequence . this finding suggests that batch-biased variants at splicing sites occur preferentially at splicing acceptor sites  with upstream polypyrimidine tracts in the intronic region. in addition, de novo motif analysis using homer  <cit>  revealed the consensus motif sequence ‘ttdtttagtt’ for the batch-biased t/a variants at splicing sites . this information might facilitate development of methods for eliminating possible batch-biased variants at splicing sites.fig.  <dig> batch-biased non-indel variants occur preferentially at splicing site. a. distribution of mutations types in batch-biased  and unbiased  non-indel variants at splicing sites. mutation frequencies in each plus and minus strand are indicated by red and blue bars, respectively. b. the sequence-logo plots show the consensus sequence in the  <dig> nucleotide regions flanking the batch-biased  and unbiased  t > a/a > t variants at splicing sites. consensus motif sequence was identified using homer, a de novo motif-finding tool




batch-biased variants in significantly mutated genes 
the presence of batch-biased variants in cancer-driver genes could induce serious errors in data interpretation. as a proof-of-concept, we examined the significantly mutated genes , previously identified in an analysis of  <dig> cancer types as genes that might play driver functions in cancer progression  <cit> . of the smgs, eight  overlapped with the set of genes harbouring batch-biased variants . in particular, kmt2d, arid1a and nav <dig> had mutation sites that exactly matched the batch-biased variants. moreover, these genes had relatively high mutation rates in the pan-cancer data , which might be overestimated due to the erroneous batch-biased variant calls, although this remains to be validated . together, these findings suggest that batch effects on the sequence variants should be considered carefully.fig.  <dig> batch-biased variants in the significantly mutated genes . the venn diagram shows the overlap between smg genes and genes containing batch-biased variants. the number of variants in each gene is indicated in round brackets . genes with position-matched batch-biased variants are indicated in red. frequency of gene mutations in the pan-cancer data is shown in a bar plot 




discussion
in this study, by performing a pan-cancer analysis of exome sequencing data from tcga, we evaluated possible batch effects on somatic mutation calls and identified  <dig> potential batch-biased variants. batch-biased sequence variants were frequently found in specific cancer types: kirc, luad and ucec. most of the batch effects were identified from plate ids  <dig> and  <dig>  implying possible problems with tissue quality on these plates.

mutation spectrum analysis of batch-biased calls revealed sequencing platform–dependent, error-prone features of the batch-biased variants. our results imply that the sample batches with poor tissue quality may lead to batch-biased sequencing errors which might preferentially occur at the sites prone to sequencing error rather than randomly.

in fact, sequencing platform–dependent substitution errors, particularly in the illumina sequencing systems, have been reported previously . frequent sequencing errors are associated with higher gc content and the presence of long g/c homopolymers  <cit> . to reduce false calls, many of variant calling methods have been developed that filter variants based on minimum depth of coverage, masking of repetitive sequence regions and trimming of poor-quality bases from the ends of reads . however, although batch-biased sequencing errors occurred preferentially at sequencing error–prone sites, the batch-biased errors differed significantly from the platform-dependent sequencing errors. we demonstrated that indels were more frequent than substitution mutations in the batch-biased variants, whereas illumina sequencers generate more substitution-type errors more often than indel type  <cit> . comparison of batch-biased variants with the unbiased variants also revealed distinct sequence patterns and mutation spectra between them. these results imply that the biased variants occur preferentially at sites prone to platform-dependent sequencing error, but they also have unique genomic features independent of previously established error-prone sites.

interestingly, we found that the batch-biased variants were frequent at splicing sites , where they may be associated with homopolymer runs at flanking regions. indeed, analysis of the flanking sequences of the batch-biased splicing sites revealed consensus sequences: upstream long t homopolymer in the intronic region and downstream dinucleotide ‘tt’. this finding is consistent with previous studies reporting that the rates of erroneous sequencing increase at long homopolymer runs . nearly all introns of the u <dig> type are spliced by the major spliceosome and flanked by gt-ag splice site dinucleotides  <cit> . the polypyrimidine tracts of gt-ag and gc-ag splice sites have c-rich and t-rich sequences, respectively  <cit> . thus, batch-biased t > a/a > t variants might occur preferentially at u2-type gc-ag splicing sites. indeed, preferential sequencing errors at splicing sites have been reported previously in multiple studies. sequencing errors are prone to occur at the g base of 3′ splice dinucleotides because of the suppression of g after incorporation of a in the dye-terminator sequencing reaction  <cit> . moreover, the ‘g after a’ problem is further enhanced by the polypyrimidine tract that precedes the acceptor ag. sequencing errors at homopolymer runs of t and c can be generated by polymerase slippage. however, because mutations at splicing sites are implicated in a number of cellular processes and diseases  <cit> , preferential batch-biased mutations at splicing sites may lead to misinterpretation of the functional effects of mutation profiles.

in addition, as a proof-of-concept, we demonstrated that some smg genes harbour these batch-biased variants with relatively higher mutation rates . this result implies that batch-biased variants might occur even at cancer genes, emphasising those batch-biased variants should be considered carefully in mutation data analysis.

tcga data are still processing update, correcting erroneous variant calls. however, many previous studies using the legacy tcga data might be affected by the batch biases. therefore, our findings regarding batch bias effect might be helpful in validating or re-analyzing studies using these legacy data.

CONCLUSIONS
our strategy for identifying batch-biased variants and characterising sequence patterns might be useful for eliminating false variant calls, and could thus help to interpret sequence profiles correctly.

additional files

additional file 1: figure s <dig>  frequency of indels and non-indels in each maf dataset. distribution of mutation frequency across mafs for indel variants  and non-indel variants . *, maf datasets with no indels are indicated. figure s <dig>  number of maf data for each cancer type. bar plot shows the number of maf datasets available for each tcga cancer type. figure s <dig>  homopolymer runs in the flanking sequences of the batch-biased indels. distribution of long  and short  homopolymer runs for each altered nucleotide  within the  <dig> nucleotide sequences flanking each variant, shown for batch-biased indel variants  and unbiased indel variants . figure s <dig>  consensus sequences in flanking sequences of batch-biased indels. the sequence-logo plots show consensus sequences in the  <dig> nucleotide flanking regions of the batch-biased  and unbiased  variants for each of the altered nucleotides . 

 
additional file 2: table s <dig>  list of the mafs used in the analysis. table s <dig>  list of  <dig> batch-biased variants in tcga data. table s <dig>  list of batch-biased genes among the smgs. 

 


abbreviations
brcbiospecimen core resource

brcabreast invasive carcinoma

coadcolon adenocarcinoma

gccgenome characterization center

gscgenome sequencing center

kirckidney renal clear cell carcinoma

kirpkidney renal papillary cell carcinoma

lgglower grade glioma

lihcliver hepatocellular carcinoma

luadlung adenocarcinoma

mafmutation annotation format

pradprostate adenocarcinoma

skcmskin cutaneous melanoma

smgsignificantly mutated gene

snpsingle-nucleotide polymorphism

stadstomach adenocarcinoma

stadstomach adenocarcinoma

tcgathe cancer genome atlas

thcathyroid carcinoma

tsstissue source sites

ucecuterine corpus endometrial carcinoma

the results shown here are in whole or in part based upon data generated by the tcga research network: http://cancergenome.nih.gov/.

funding
this research was supported by grants from the korea healthcare technology r&d project, ministry of health & welfare  and from the national research foundation of korea  funded by the korea government  . the funding body played no role in the design or conclusions of this study.

availability of data and materials
all data generated or analysed during this study are included in this published article or the additional files.

authors’ contributions
conceived and designed the study: jhc, seh, hgw. analysed the data: jhc, seh, hgw. wrote the paper: jhc, hgw. all authors read and approved the manuscript.

competing interests
the authors declare that they have no competing interests.

consent for publication
not applicable.

ethics approval and consent to participate
not applicable.

publisher’s note
springer nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.
