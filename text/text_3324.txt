BACKGROUND
metabolomics is a science based on the exhaustive profiling of metabolites. various analytical technologies are used in metabolomic research, including capillary electrophoresis–mass spectrometry , liquid chromatography–ms, gas chromatography–ms, and nuclear magnetic resonance. the statistical analysis of the analytical data obtained has been studied in chemometrics research  <cit> . chemometric approaches that commence with a multivariate analysis, such as principal component analysis   <cit> , partial least squares  <cit> , canonical correlation analysis  <cit> , and so on, have been predominantly applied in metabolomics.

pca  <cit>  is routinely used to visualize high-dimensional metabolomic data in a two- or three-dimensional subspace. a scatter plot of pc score vectors  can be used to detect outliers or to identify biologically interpretable patterns. typically, when a specific pc score is found to be related to a phenotype of interest  <cit> , such as a time course or group information, the corresponding factor loading is evaluated to discern meaningful metabolites from which to draw biological inferences.

in many metabolomic research articles  <cit> , an eigenvector in pca  has been used as the factor loading. to draw biological inferences, some metabolites  are subjectively selected using the eigenvector. however, this approach has several problems. for example, many metabolites may vary with phenotype in one study, whereas only a few metabolites vary with phenotype in another study. with the existing approach, which uses the eigenvector, this is equivalent to using the same number of metabolites to draw biological inferences from these different studies. consequently, biological interpretations might be made using an insignificant metabolite that varies irrelevantly with phenotype.

the eigenvectors for autoscaled data in pca  <cit>  are proportional to the correlation coefficients between the pc scores and the variables. this fact is well established in the multivariate analysis literature  <cit> , but does not appear to be appreciated in metabolomic analyses. in the present study, “factor loading” is defined as the correlation coefficients between the pc scores and the variables. this definition can be used to perform statistical hypothesis testing and to select significant metabolites objectively using statistical criteria. the significance of factor loading in pca can also be computed with a resampling approach, such as bootstrapping, although this is not exact  <cit> .

significant metabolites are selected according to the significance of factor loading or other methods of variable selection in supervised learning approaches, such as support vector machine, random forest, and so on, and then biological inferences are drawn for these metabolites by biologists. biologists often draw these inferences with respect to a biological functional unit, such as a metabolic pathway . in gene expression analyses, gene set enrichment analysis  has been used to identify significant gene sets using gene ontology  terms. in metabolomics, metabolite set enrichment analysis   <cit>  can be used to identify significant metabolic pathways. msea has been computed with several approaches, including overrepresentation analysis   <cit> , subramanian’s gsea  <cit> , and the global test  <cit> . msea is a convenient method for drawing biological inferences from metabolomic data, but this approach has not been applied to metabolites selected by factor loading in pca. recently, web tools for msea have been developed  <cit> . however, no tools that can perform our workflow, including the statistical hypothesis testing of factor loading in pca, have existed in a single platform. in the present study, we performed statistical hypothesis testing of the factor loading in pca for two metabolomic datasets from mouse liver samples as case studies. this approach can be used to select significant metabolites when using factor loading in pca, and msea with an ora approach can be applied to these significant metabolites. we developed the r package “mseapca” to compute the sequence from the statistical hypothesis testing of factor loading in pca to msea.

methods
statistical hypothesis testing of factor loading in pca
consider a mean-centered data matrix x that has samples in each row and variables in each column. the score vector is related to the data matrix by t = xw, where w is a vector of weights. pca is formulated as the optimization problem of maximizing the variance of the score vector t:

  maxvartsubjecttow′w= <dig> 

and the weight vector w is often used for factor loading. after transformation, eq.  can be rewritten as the eigenvalue problem:

  1n-1x′xw=λw 

the eigenvector w and eigenvalue λ of eq.  can be computed using numerical computation libraries for singular value decomposition. the eigenvalue λ corresponds to the variance of the pc score vector formed using the associated eigenvector as the weight vector.

the coefficient of the correlation between the pc score and the p-th variable can be defined as:

  corrt,xp=t′xp/n-1vartvarxp 

where t' is the transpose of t. introducing c as the column vector in which the p-th element is  <dig> and the others are  <dig>  so that xp = xc, we have:

  corrt,xp=w′x′xc/n‒1vartvarxp 

transposing eq.  gives w′x′x/n - 1 = λw ', which can be substituted in eq. , giving:

  corrt,xp=λw′cvartvarxp 

the variance of the score vector can then be replaced with λ and the standard deviation of xp is replaced with σp. finally, the correlation between the pc score and the variables can be written as:

  corrt,xp=λw′cvartvarxp=λwpλσp=λwpσp 

with data scaled to unit variance , the weight wp is proportional to the correlation coefficient between the pc score and variable xp because σp =  <dig> in eq. . thus, the factor loading can be defined as the correlation coefficient in eq. . on the basis of this definition, we can perform a statistical test for factor loading in pca, using the well-known fact that for a correlation coefficient r, the statistic:

  t=rn-21-r <dig> 

has a t-distribution with  degrees of freedom. we can then select variables that have a statistically significant correlation to the pc score and draw biological inferences using these variables.

sample preparation, metabolomic analysis, and data processing
bks.cg-m+/m+/jcl  mice, 12 h-fasted normal mice, bks.c - +leprdb/+leprdb/jcl  mice, and db/db mice orally administered pioglitazone for 10 days were used. the mice were 7-week-old males, and were given unlimited access to food and water, except those on the 12 h fast. the concentration of pioglitazone administered was 100 mg/10 ml per kg. the pioglitazone was purchased from takeda pharmaceutical co. ltd , and was purified by the nard institute ltd . after sampling, the livers were excised and stored at -80°c. all experiments, from the purchase and breeding of the mice to the collection of their liver samples, were performed at kitayama labes co. ltd . the sample preparation procedure used to extract the metabolites has been described by ooga et al.  <cit> .

the metabolite extracts were measured with ce–time-of-flight ms  using the agilent capillary electrophoresis system equipped with an agilent  <dig> time-of-flight mass spectrometer, an agilent  <dig> isocratic high-performance liquid chromatography pump, an agilent g1603a ce–ms adapter kit, and an agilent g1607a ce–esi–ms sprayer kit . the system was controlled with the g2201aa chemstation software version b. <dig>  for ce . modified analytical methods for the measurement of cationic  <cit>  and anionic metabolites  <cit>  were used. the measurement data were processed with peak processing software  <cit> . the signal peaks corresponding to isotopomers, adduct ions, and other product ions of known metabolites were excluded. all signal peaks potentially corresponding to authentic compounds were then extracted, and their migration times  were normalized using those of the internal standards . the peaks were then aligned according to their m/z values and normalized mt values. finally, the peak areas were normalized against those of the internal standards. the resultant relative area values were further normalized by the sample weight. annotation tables were produced from the ce–tofms measurements of standard compounds, and were aligned with the datasets according to their similar m/z values and normalized mt values.

statistical analysis
in this study, all computations were performed with r  <cit>  and the “mseapca”  <cit>  package. a value of  <dig> was imputed to missing values for the computation of pca. a metabolite set list was created with reference to the kyoto encyclopedia of genes and genomes   <cit> , which was partly modified by manual curation. the xml file of the metabolite set list used in this study is included in the “mseapca” package.

software
figure  <dig> show our analytical workflow used to perform the statistical hypothesis testing of the factor loading in pca and the msea with the “mseapca” package. the r package “mseapca”  <cit>  has three major features. the first creates a list of metabolic pathways. this can be generated from two file formats, csv or kegg’s tar.gz. the csv file is used when your own metabolite set list, created by yourself, is used and kegg’s tar.gz is used when a metabolite set originating from kegg’s metabolic pathway is used. a csv file, in which the first column is the name of the metabolic pathway and the second column is the metabolite ids, is manually created and converted to the list format with the “csv2list” function. a “pathway_class” function converts kegg’s tar.gz files  to the list format of the metabolic pathway. kegg’s tar.gz files can be downloaded from kegg ftp, with your own license. the “mseapca” package can save a list of metabolic pathways as xml files for future reuse and feature expansion. the “list2xml” function converts the list format of the metabolic pathways to the xml format. this xml format can be saved as an xml file using the “savexml” function in the “xml” package. the “read_pathway” function can read the created xml file and convert it to a list of metabolic pathways for the computation of msea.

the second feature is the “pca_scaled” function, with which to perform pca. a data frame constructed from metabolite ids and a metabolome data matrix is input for the “pca_scaled” function. metabolite ids should be matched with those in the metabolite set list. with this function, the data matrix is automatically scaled to a zero mean and unit variance  for each metabolite. this function can output the pc scores, factor loadings, and p-values and q-values of benjamini and hochberg  <cit> , which are the results of the statistical hypothesis testing of factor loading. in this function, “factor loading” is defined as the correlation coefficient between the pc score and each metabolite level.

the third feature is the performance of msea. the “msea_ora” function can perform msea with ora  <cit> . with this function, statistical hypothesis testing of the cross-tabulation is performed with the one-sided fisher’s exact test. the “msea_sub” function performs msea in the same way as gsea is implemented by subramanian et al.  <cit> . subramanian’s gsea has two types of random permutation. in one, the class label is randomly permuted and in the other, the metabolites in the metabolite set list are randomly selected to generate the null distribution of the enrichment score. the p-value for the enrichment score can then be computed with both approaches. in the “msea_sub” function, the latter approach is implemented. this procedure corresponds to the “gene set” of the permutation type in the gsea-p software  <cit> . a leading-edge subset analysis is also undertaken following the gsea procedure  <cit> .

the r package “mseapca” is freely available from the cran website  <cit> . see the reference manual for “mseapca” at the cran website  <cit>  for more information.

RESULTS
case study 1: a comparative study of control and 12 h-fasted mice
we describe the use of the statistical hypothesis testing of factor loading in pca using metabolome data from two studies. the first case study is a comparative analysis of normal and 12 h-fasted mice. five liver samples each from the control and 12 h-fasted mice were used for the metabolomic analysis and  <dig> metabolites were identified.

a pca of these metabolomic data was performed after they had been preprocessed by autoscaling. the scores plot of the pca ) showed that the pc <dig> scores of the control and fasted mice were negative and positive, respectively. this result suggests that the pc <dig> score is positively related to the fasting effect. in this case, metabolites that have large positive factor loadings in pc <dig> tend to increase and those with negative factor loadings tend to decrease during the 12 h fast.

statistical hypothesis testing for factor loading in pc <dig> was performed, and  <dig> metabolites were statistically significant at p <  <dig>  . an msea with ora for factor loading was performed independently for the significantly positive and negative metabolites . purine metabolism was significantly activated in the 12 h-fasted mice at p <  <dig> . glycolysis was significantly suppressed at q <  <dig>  and the pentose phosphate pathway tricarboxylic acid  cycle, cysteine metabolism, and polyamine metabolism were significantly suppressed in the 12 h-fasted mice at p <  <dig> . msea using subramanian’s approach was also performed as a reference . histidine metabolism and purine metabolism had negative normalized enrichment scores , so were significantly activated in the 12 h-fasted mice at p <  <dig> . glycolysis had a positive nes, so was significantly suppressed at q <  <dig>  and the pentose phosphate pathway, tca cycle, and polyamine metabolism were significantly suppressed in the 12 h-fasted mice at p <  <dig> . these results suggest that these two msea approaches are largely consistent.

*p <  <dig> , **q <  <dig> .

the results of the msea of factor loading in pc <dig> suggested that the processes of energy metabolism, including glycolysis and the tca cycle, decreased during the 12 h fast. the suppression of these metabolic pathways suggests that glycogen is drained and glucose supplementation is restricted in the mouse liver during a 12 h fast. the mean bodyweight of the normal mice was  <dig>  ±  <dig>  g  and that of the 12 h-fasted mice was  <dig>  ±  <dig>  g, indicating a statistically significant reduction  during the 12 h fast, according to welch’s t test. this result suggests that the suppression of energy metabolism results in a reduction in bodyweight.

case study 2: a comparative study of diabetic model mice with and without pioglitazone treatment
the db/db mouse is a model of obesity, diabetes, and dyslipidemia, in which leptin receptor activity is deficient because the mice are homozygous for a point mutation in the leptin receptor gene  <cit> . pioglitazone reduces insulin resistance in the liver and reduces glucose levels in the blood  <cit> . therefore, it is used for the treatment of diabetes.

we compared the metabolomic data for mouse liver samples from db/db mice treated with or without pioglitazone to examine the effects of administering pioglitazone to diabetic mice. five liver samples from the untreated db/db mice and five from db/db mice administered pioglitazone were used for the metabolomic analysis and  <dig> metabolites were identified.

we performed pca on data preprocessed with autoscaling in a comparative study of the db/db mice treated with and without pioglitazone. the scores plot is shown in figure  <dig>  a perfect separation between the groups was achieved on the first pc axis, and we therefore focused on this axis. the pc <dig> scores for the db/db mice with and without pioglitazone treatment showed positive and negative values, respectively, suggesting that the pc <dig> score is positively related to the effect of pioglitazone.

statistical hypothesis testing of the factor loading in pc <dig> was performed, and  <dig> metabolites were statistically significant at p <  <dig>  . an msea of factor loading was performed as in the previous section . in both msea with ora and using subramanian’s approach, glycolysis was the only statistically significant factor activated by pioglitazone at p <  <dig> . pioglitazone is a peroxisome proliferator-activated receptor -activating agent. lee et al.  <cit>  suggested that pparδ ameliorates hyperglycemia by increasing the glucose flux through the regulation of gene expression. the administration of pioglitazone is known to reduce glucose levels in the blood  <cit> .
db
/
db 
mice treated with and without pioglitazone

*p <  <dig> .

in the present study, the glucose blood level was  <dig>  ±  <dig>  mg/dl  in the db/db mice and  <dig>  ±  <dig>  mg/dl in the db/db mice administered pioglitazone. the reduction in blood glucose was not significant  after the administration of pioglitazone, according to welch’s t test. this result suggests that a metabolomic analysis can detect subtle changes in the glycolysis pathway caused by the administration of pioglitazone, although confirmatory experiments  might be required to confirm our biological inferences.

discussion
metabolite selection by statistical hypothesis testing of the factor loading in pca has several advantages. this approach was applied to metabolomic data in two case studies of mouse liver samples. in the first case study,  <dig> of  <dig> metabolites correlated significantly with the pc <dig> score associated with the groups, and in the second study,  <dig> of  <dig> metabolites showed such a correlation. thus, the number of significant metabolites was two-fold higher in the first case study than in the second case study. this suggests that to set a previously determined number of metabolites  is inappropriate because the number of significant metabolites differs in each study. we also note the relationship between the contribution ratio and the number of significant metabolites for factor loading in pca. the ratio of the number of significant metabolites to all the detected metabolites was  <dig>   in the first case study and  <dig>   in the second case study. the contribution ratio in pc <dig> was  <dig> % in the first case study and  <dig> % in the second case study. this result suggests that an implicit relationship exists between the contribution ratio and the number of significant metabolites in samples of the same size.

in both case studies, we focused on pc <dig> , which differed between the groups. we then compared this approach with ordinary statistical hypothesis testing, such as with a t test. according to welch’s t test,  <dig> metabolites were significant in the first case study and  <dig> metabolites were significant in the second case study. when we compared the metabolites selected with welch’s t test and those selected with the statistical test of factor loading,  <dig> metabolites and  <dig> metabolites in case studies  <dig> and  <dig>  respectively, were common to both studies. most significant metabolites were selected with both approaches. this fact suggests that the statistical testing of factor loading in pca can be readily used to select metabolites as a special case of the two-sample test when the difference between the groups appears in the pc score. the result of msea for statistically significant metabolites with positive t statistics on welch’s t test showed that purine metabolism was statistically significant at p <  <dig> , and the negative t statistics showed that glycolysis and the pentose phosphate pathway were statistically significant at p <  <dig>  . in a positive case, the statistically significant metabolic pathway identified by msea was consistent with both approaches. in a negative case, the statistically significant metabolic pathway was partly consistent, but the number of statistically significant metabolic pathways was fewer with welch’s t test than with the statistical hypothesis testing of factor loading in pca. these results depend on the result that the number of significant metabolites was almost same with welch’s t test  and with statistical hypothesis testing of factor loading in pca  in positive cases, but was fewer with welch’s t test  than with the statistical hypothesis testing of factor loading in pca  in negative cases.

in metabolomics, complex studies  can involve various time points or groups, or the administration of drugs at various concentrations under various conditions  <cit> . in these complex studies, a statistical method for testing should be selected from various methods, such as analysis of variance and multiple comparison procedures, depending on the situation. in our analytical workflow of pca, a specific pc score was selected and we simply performed the statistical hypothesis testing for factor loading corresponding to this selected pc under any circumstances. the statistical testing of factor loading in pca can be widely used, not only in two-sample studies but also in various studies when an association between the pc score and the phenotype can be found.

msea was performed for significant metabolites and acceptable biological inferences were drawn in the two case studies. with the conventional approach, a previously determined number of metabolites  from which to draw biological inferences is subjectively selected. using this approach, msea was performed for the top  <dig> metabolites with large negative factor loadings in the first case study. no significant metabolic pathway was detected at p <  <dig>  . in this case,  <dig> metabolites was too small a sample from which to draw acceptable biological inferences. even if significant metabolic pathways are detected when msea is applied to insignificant metabolites, it is doubtful whether these metabolic pathways are statistically or biologically meaningful. to draw unbiased biological inferences using a statistical analysis, significant metabolites must be selected with statistical tests of factor loading when using pca.

in this study, two msea methods were used, with either ora or subramanian’s approach. as a way of using factor loading for gsea, fehrmann et al.  <cit>  designated the pc score associated with phenotype as the “transcriptional system regulator”  score, and factor loading corresponding to the tsr score is used for gsea with subramanian’s approach. this method directly uses factor loading, but does not use the results of statistical hypothesis testing of factor loading. as far as we know, an approach combining gsea or msea with the results of statistical hypothesis testing of factor loading in pca has not been reported until now.

the results of both msea with ora or subramanian’s approach produced almost the same results in our two case studies. in a comparison of the computational time required by the two msea approaches, the first case study required  <dig>  seconds using subramanian’s approach and  <dig>  seconds with ora. this result shows that msea with ora has the advantage of lower computational cost. conventionally, pca and msea can be computed independently in different steps or with different software. there has been no software that can compute the sequence from pca and statistical hypothesis testing of factor loading to msea. therefore, we developed the r package “mseapca” to compute the whole sequence from the statistical hypothesis testing of factor loading in pca to msea.

CONCLUSIONS
in metabolomics, the targeted metabolites from which biological inferences are drawn are selected subjectively when factor loading is used in pca. we have proposed a statistical procedure to select metabolites using the statistical hypothesis testing of factor loading in pca. these significant metabolites are then used to identify significant metabolic pathways with msea. we applied this approach to two metabolomic datasets from mouse liver samples, with acceptable results in terms of previous biological knowledge. we developed an r package “mseapca” to allow the ready use of our approach. many researchers use pca in metabolomics. our approach can improve the existing use of pca in this field and is expected to be widely applicable to other omics data, including gene expression and proteomic data.

abbreviations
ce–ms: capillary electrophoresis–mass spectrometry; pca: principal component analysis; msea: metabolite set enrichment analysis; gsea: gene set enrichment analysis; go: gene ontology; ora: overrepresentation analysis; kegg: kyoto encyclopedia of genes and genomes; tca: tricarboxylic acid; ness: normalized enrichment scores; tsr: transcriptional system regulator.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
hy proposed the method, performed the statistical analysis, developed the software package, and wrote the manuscript. tf edited the list of metabolic pathways. hs performed the metabolomic analysis and processed the analytical data. yo supervised all research experiments. tf, hs, gi, kk, and yo interpreted the metabolomic data biologically. all authors have read and approved the final manuscript.

supplementary material
additional file 1: table s <dig> and s2
results of statistical hypothesis testing of factor loading in pc <dig> and welch’s t test and msea for the two case studies. table s <dig>  result of msea using ora for significant metabolites selected by welch's t-test in a comparative study of normal and  <dig> h-fasted mice.

click here for file

 acknowledgments
we thank ms mutsuko sato and ms kaori honda for sample preparation and ms yumiko ikarashi and ms sumiko kumaki for their assistance with the metabolomic analysis. we also thank mr seira nakamura and dr makoto suzuki for their valuable discussions about statistical analysis in metabolomics.
