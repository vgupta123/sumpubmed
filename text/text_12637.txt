BACKGROUND
measurement assurance for genome-scale measurements is challenged by the impracticality of creating a sample containing known quantities of tens of thousands of components, such as the rna transcripts measured in an rna-seq experiment. deep sequencing of cellular rna can generate vast quantities of gene expression information, yet measurement biases have been identified at nearly every step of the library preparation process .

as rna-sequencing expression data expands from discovery into clinical applications, the sources and magnitudes of bias and variability must be carefully understood and quantified. the basic units of expression in sequencing, such as transcripts per million reads  or fragments per kilobase per million reads , are still undergoing revision  <cit> . even when using comparable units, it is rarely possible to directly compare gene expression values reported by different labs, on different instruments, or frequently just on different days , unless special care is taken to use uniform samples and protocols. identifying the presence and variation of biases in a measurement process over time requires a standard to be used for process control. the regular use of a process control can help determine the most-appropriate protocol and analysis methods, demonstrating that the measuement process accurately represents the true changes in the underlying sample.

ideally, a measurement process is linear and possesses a known precision. a linear measurement process shows an increase in signal proportional to an increase in the object being measured. it is also helpful if measured signal is additive, arising only from a single source. precision consists of repeatability and reproducibility, defined as the degree of closeness in multiple measurements made by a single user and the closeness between multiple labs, respectively. we show that mixtures can demonstrate that a measurement’s response function is linear and of high specificity  while measuring its variability and precision. properly constructed mixture samples can be used to correct for systematic measurement errors, provide ongoing monitoring of performance, serve as a tool for interlaboratory comparison, and create a context for evaluating batch effects, protocols, and informatic analyses.

there are two known approaches to creating useful genome-scale standards. one is the creation of a limited number of external spike-in controls, such as those designed by the external rna controls consortium , which were created for microarrays and have been applied to next-gen sequencing . a second approach utilizes mixtures of previously characterized samples in defined ratios, and has also been applied to microarrays  but has not been utilized in other genome-scale measurements. using these types of standards provides confidence in the ability of a test to detect both positive and negative results, determining the limits of that detection.

mixtures can serve as a test that applies to each of the tens of thousands of transcripts in a sample’s transcriptome. linearity of the measurement response can be demonstrated based on the fundamental understanding that a mixture is a linear combination of its components. previous work with mixtures in microarrays  utilized an arbitrary 10-fold “selectivity” cutoff to evaluate the linear dynamic range of microarray measurements and understand the variability of these measurements. the arbitrary selectivity cutoff in previous work prevents the identification of interference, as any genes affected by interference would be filtered by the stringent selectivity cutoff.

using known mixture compositions, predicted values can be calculated based on the assumption that the measurement response is linear. deviation of the observed values from the model-predicted value is an indication of bias in the measurement. systematic biases could be introduced by sample preparation, signal processing, interference from related or mis-annotated genes, or sampling variation. signal arising from off-target molecules, such as a closely related transcript, can cause false positive results and result in a lowered specificity. mixture samples can provide information about the measurement sensitivity, specificity, repeatability, reproducibility, dynamic range, and limit of detection.

determining the relative contributions to gene expression of individual components within mixtures of biological states has received some attention in clinical research, where biopsies and other patient samples are often mixtures. the process of resolving gene expression signals introduced by each individual component of a mixture  has been used to account for tumor heterogeneity and to separate whole blood samples into individual cell types. these procedures often separate mixture components based on a subset of genes forming a signature that varies uniquely between components. these deconvolution methods have been used  to develop high-resolution tumor expression signatures from imperfect biological samples  <cit>  and differentiate between cell-type-frequency changes and per-cell gene expression changes  <cit> . many of these methods can determine mixture component types by using a linear model where mixture expression is treated as a combination of expression signatures.

none of these methods corrects for rna enrichment. different cell types express different total amounts of rna of varying types, confounding estimates of cell type proportion made based on the quantification of total rna  <cit> . others have introduced the concept of a biological scaling factor  <cit>  to compensate for variation in the rna content of cells, including the use of spike-in controls to determine this factor. the enrichment of subclasses of rna from total rna  adds a bias to the experiment due to the different abundance of rna classes between cell types.

we assess linear response, specificity, and accuracy of genome-scale measurements using mixtures. in the process, we demonstrate that linear models can be used to separate these mixtures into the proper components. we were mindful that while our mixtures were of total rna, the sequencing process enriches for rna subclasses, and that differential enrichment is an important factor when interpreting results. we anticipate that a mixture-based approach to measurement assurance is highly generalizable to many types of mixtures and can be extended to the wide variety of genome-scale measurements, including but not limited to proteomic and metabolomic measurements.

RESULTS
to assess measurement parameters of genome-scale transcriptome data, we analyzed two rna-seq experiments measuring synthetic mixtures of commercially available human total rna samples   <cit> . first, we analyzed data generated as part of the sequencing quality control consortium  project  <cit> , which contained two mixture samples as part of their inter laboratory experiment. in this study, the  <dig> laboratories sequenced the following samples: universal human reference rna spiked with ercc exfold rna spike-in mix  <dig> , human brain reference rna spiked with ercc exfold rna spike-in mix  <dig>  and two mixtures of seqc-a and seqc-b  with mixture compositions c = 3a + 1b and d = 1a + 3b.fig.  <dig> rna samples used in this study. rna isolated from pure tissues is used to generate pairs of mixtures used in two separate experiments. a two seqc mixtures  are built from two components . b two blm mixtures  are built from three components. the seqc-b component  is from the same source as the brain blm component. per-sample target ratios of tissue proportion between mixtures are shown



in a second experiment, which we call blm, we generated multiple libraries of two mixtures  composed of total rna isolated from human brain , liver , and muscle  tissue were measured for this study. these two mixtures were made with component proportions of 1b:1l:2m and 1b:2l:1m. the total rna of each individual tissue were also sequenced as single component samples to provide an expression signature for each tissue. ercc spike-in control rnas  <cit>  prepared by nist were added to the blm mixtures and individual components. two spike-in control pools were designed with ratiometric differences in the concentration of individual ercc spike-ins. the multiple libraries of blm- <dig> and blm- <dig> mixtures were spiked with either of these pools at one of three  concentrations. as expected based on the mixture designs, erccs spiked-in equally yielded similar expression signal, while signal from erccs spiked differentially into multiple subpools was at ratios corresponding to the designed fold changes. poisson sampling at the lower expression levels results in increased dispersion about the expected ratio  <cit> .

these mixtures were designed to have a defined expression signal ratio between them. for example, if the measurement response were linear and unbiased, the signal in the seqc-c sample would be exactly 1/ <dig> the signal of seqc-b plus 3/ <dig> the signal from seqc-a due to the design of the mixture. however, these total rna mixtures went through rna-seq library preparation by polya selection, which purposely removes certain classes of rna, such as ribosomal rna, from the sample. as the resulting sequence data comes from only the selected subset, the fraction of which can be different from sample to sample, a correction for this differential enrichment must be applied to accurately reflect the experimental process and allow the model to return the designed ratios of expression between mixtures .

linear model-based analysis of genome-scale gene expression
we observed that mixture expression is a linear combination of the component samples and the mixture proportions of each component. equation  <dig> describes the relationship between signal in the mixtures and signal in the constituent samples. a mixture m  is composed of a number of named components c , with each component comprising a proportion of the mixture. Φc. i,m is the expression signal arising from a particular gene/transcript i in mixture m.  <dig> i,m=i,c×Φc,m 

this study uses four mixtures of the same general form: i,blm1=i,b×Φb,1+i,l×Φl,1+i,m×Φm,1i,blm2=i,b×Φb,2+i,l×Φl,2+i,m×Φm,2i,seqc−c=i,seqc−a×Φa,c+i,seqc−b×Φb,ci,seqc−d=i,seqc−a×Φa,d+i,seqc−b×Φb,d 

these mixtures were made of total rna, while the expression signal  arises only from the enriched rna. as the fraction of the total rna mass that matches the enrichment criteria varies between cell types, the enrichment of total rna introduces a bias. additional file 1: figure s <dig> shows the offset from the expected ratios of tissue-specific and ercc rna caused by this bias. we correct the specific equations for the enrichment fraction by multiplying each component by a factor ρ. this factor corresponds to the fraction of measured rna compared to the mass of total rna in each mixture. ρc is defined as the fraction of measured rna per unit total rna in component c.

including this factor, the blm <dig> mixture equation becomes eq. 2:  <dig> i,blm1=i,b×Φb,1×ρb+i,l×Φl,1×ρl+i,m×Φm,1×ρm 

there are a few approaches that have been described to measure ρ. one study directly measured the post-selection rna content between seqc-a and seqc-b samples  <cit> . another described the use of trimmed mean of log expression ratios   <cit>  to measure a biological scaling factor based on enriched rna directly from rna-seq data. these tmm-derived factors have been shown to be an appropriate measure in cases where there is no global expression level change , but are not applicable if there are global expression changes   <cit> .

the ρ factor can be determined using spiked-in rna  <cit>  as sample reads per microgram of total rna divided by spike-in reads per microgram of spike-in rna. this factor utilizes the differential enrichment between polyadenylated spike-in rna and total rna, which is only partly composed of polyadenylated rna.

figure  <dig> compares the distributions of spike-in estimated rho factor ratios across the seqc samples compared to the direct measurement of poly-a enriched rna made previously  <cit> . while the ρ factors do not directly measure the polya content of a sample due to relatively inefficient but consistent polya capture of the spike-in rna, ratiometric measurements of pairs of samples have distributions that are similar to that of a normal distribution with parameters based on the previous enrichment measurements of seqc-a and seqc-b. additionally, the expected equalities of ρc = ρa*.75+ ρb*. <dig> and ρd = ρa*.25+ ρb*. <dig> hold true to within 5 % of ρa, indicating that the enriched rna content of a mixture is a linear combination of the enriched rna content of its components. additionally, solving the system of blm equations only for the enrichment fractions  yields very similar enrichment fractions to those calculated from spiked-in rna, leading us to be confident in these measurements.fig.  <dig> distributions of empirical  and ercc-estimated  enrichment ratios between seqc samples a:b, a:c, and a:d. the empirical distribution was simulated from a normal distribution with means of  <dig>  and  <dig>  and standard deviations of  <dig>  and  <dig>  for samples a and b, as reported previously  <cit> . the ercc-estimated values were calculated from equation  <dig>  individual labs’ rna enrichment varied inside a narrow range, yielding discrete peaks in the distribution for some outlying labs



the target rna fraction ρ is a property of an individual rna sample and can be affected by any sample manipulation - chief among them the polya selection step in sample preparation. for replicates within a single polya-selected seqc experimental run, the ρ of a mix varies slightly, likely due to fluctuations in efficiency of polya selection.  it is also important to note that fpkm units should not be used to calculate the enrichment fraction , as the fpkm derivation  <cit>  includes a term coupling sample abundance to spike abundance.

mixture analysis models recapitulate known mixture proportions
to demonstrate the accuracy of this analytical framework of mixtures, the mixture proportions Φblm were recalculated for the blm mixtures blm- <dig> and blm- <dig>  the ρ values and the sequencing expression data xi were used to solve for the mixture proportions Φblm by linear regression to the mixture equation. figure  <dig> shows that the experimentally observed counts are highly correlated  to the equation-solved counts xi for each transcript. figure  <dig> shows the Φblm values at which residuals were minimized for the two mixtures for each replicate sample in each laboratory. estimates of the three component proportions in the two mixtures are consistent with the designed 25:25: <dig> and 25:50: <dig> proportions in the two blm mixtures. figure  <dig> shows that the designed proportions of seqc mixtures across each of nine labs can also be calculated by this equation, returning the 75: <dig> and 25: <dig> proportions for mixes c and d, with some variability between labs. eq.  <dig>  which lacks correction for enrichment fraction, does not return the designed ratios .fig.  <dig> comparison of observed and predicted counts. observed blm mix  <dig> counts  are plotted against predicted blm mix  <dig> counts . predicted counts are calculated using eq.  <dig>  counts are on the log <dig> scale

fig.  <dig> accuracy of model-derived blm mix estimates. the grey center point is the nominal ‘truth’ ratio in which the samples were mixed. concentric circles with radius at multiples of  <dig>  are added to visually clarify distance from the center point. colored points depict mixture proportion  estimates generated from measurements of  <dig> replicate libraries. black points are the mean of the replicates. error bars show one standard deviation of the four replicate measures

fig.  <dig> mixture proportion  estimates for samples a in seqc-c and seqc-d. the mean  and standard deviation  of four individual replicates  of the Φ estimate for each sample are shown. the nominal mixture proportions are grey points at the center of the target. circles centered at that nominal ratio with radii in multiples of . <dig> are included to more easily identify magnitude of total error. lt and ilm tags indicate the manufacturer of the sequencer used at each lab . deviations from the target indicate process variability, instrument bias, or errors brought about in these labs



linear model-predicted mixture counts are equivalent to replicate measures
in studies by the seqc  <cit> , differential expression between replicate samples was utilized to evaluate measurement performance based on the hypothesis that the control samples used in the study had no true differences between replicates. we created pseudo-replicate predicted count values from the single component samples for use in benchmarking. these simulated mixtures were built based on the measured mixture expression and the true mixture proportions.

figure  <dig> shows a dendrogram of the distance between actual mixture expression and predicted expression counts of seqc samples. the four base samples a, b, c, and d are most distant from one another, reflecting the biological differences between the samples. samples a and c are more closely related, as c consists of 75 % a and 25 % b. modeled pseudo-replicate samples cm and dm across each of the six seqc sites are no more different than cross-lab replicates of the c and d data, indicating that building the model for mixture c from components a and b does not introduce significant variability. this supports the treatment of modeled mixtures as replicate measurements expected to have no true differential expression from the mixture samples. any detected differential expression between a mixture and its predicted expression values is indicative of a bias in the measurement process. in the blm or seqc datasets, differential expression was detected only in the ribosomal rna genes . this detected differential expression reflects the sample to sample variance in rrna depletion.fig.  <dig> clustering of expression measures in  <dig> seqc samples and  <dig> in-silico replicate samples across participating sites: the close agreement between modeled  counts and actual counts  at sites numbered 1– <dig> supports the validity of assumptions used to model cm and dm counts. euclidian distance measures between samples show that the various samples are of greater distance from one another, while the in-silico modeled samples are most similar to the correct corresponding sample



discussion
mixtures of biological samples can be useful as process controls for measurements with linear response functions. a mixture can be treated as linear combination of its components. two experimental datasets with known mixture parameters were used to test the linearity of rna-seq measurements. in rna-seq, the enrichment of the total rna mixture components by polya selection must be accounted for, as the sequencing experiment measures only the rna which passes this enrichment filter.

mixtures with either known or unknown proportions can be analyzed. if mixture proportion information is known a priori, genome-scale data can be used as a process control to test the repeatability and sensitivity of measurements by comparing observed and expected measures. alternatively, if the mixture proportions are an unknown and desired parameter, expression measures from the mixture in combination with the single components can be used to experimentally determine the mixture proportions. this application can be valuable in un-mixing biological mixtures, including clinical mixtures, cell cultures, and xenografts . while target rna fraction correction is required for rna-sequencing measurements, the general mixture model is theoretically applicable to any measurement with a linear response function.

mixtures can provide measurement process assurance to a sequencing experiment. using mixture samples alongside pure samples, one can demonstrate the reproducibility and sensitivity of genome-scale rna, protein, as well as metabolite measurements. the main goal of this type of mixture analysis is to create a known ratio value by which the measurement characteristics of an experiment can be assessed. while an experiment’s measurement of this known ratio is not sufficient to prove the validity of the measurement, it is a necessary condition, and any deviations are indicative of bias.

we demonstrate process control usage of mixtures by comparing the nine seqc sites. figure  <dig> shows a summary plot of the estimated component fractions for each sample. the dispersion and bias of the points from the target value give an indication of the overall process accuracy. within this set of labs there are easily discernible changes, which could indicate process errors. site  <dig> looks strong – there is no bias, and a modest and regular level of dispersion. in site  <dig> the dispersion of component c is exaggerated, suggestive of an issue in the handling of that particular sample. site  <dig> has less dispersion than site  <dig>  but has introduced a bias. site  <dig> is from a completely different sequencing instrument, and shows that there is similar dispersion to the previous instrument, with a bit of a bias. however, site  <dig> shows that this bias does not occur in every run. this comparison of seqc sites shows that even these summary plots can detect differences between runs. it is for this reason that we suggest the use of mixtures as process controls for rna-seq experiments. comparing the dispersion and bias of your measurement against the known truth of mixtures as you make changes to your experimental process allows you to evaluate the effect of these changes on the measurement quality. table  <dig> describes several types of changes that can be evaluated in this way.table  <dig> example use cases for process control mixtures



while we demonstrate mixture analysis with two specific samples, the analysis is generalizable to any number or type of mixture components. any mixture split into known individual components can be measured in this way. for example, a clinical researcher may have three samples of interest from healthy, chronically diseased and acutely diseased sources. a mixture of these three cell types would provide confidence in the measurements made on the three samples individually by verifying the repeatability of that measurement. it can also provide a benchmark sample to assess comparability over space and time. these mixtures can detect biases introduced by batch effects, operator effects, sample mislabeling, and technical artifacts while evaluating the variability of the measurement. mixture samples with known proportions can help determine experimental reproducibility and discover technical artifacts introduced by the measurement process by comparison of the expected to observed proportions.

with this analytical model, end users and core facilities can use known mixtures as a process control to track changes in measurement quality whenever changes to the experimental process are made. by including a predefined mixture, cross-sample comparisons can be made to demonstrate the internal consistency of measurements made using any new experimental technique, kit, or downstream analysis tool. in this way, there is some assurance that changes in experimental protocol have not affected measurement reproducibility. residuals from modeled counts can be used as a metric to evaluate the magnitude of effect an experimental process has on the linearity and precision of underlying measurements.

in addition to gaining an understanding of the measurement process using the benchmarking workflow, unknown samples can be collected and studied to determine the relative proportion of known components. proportions of components can be determined even in the absence of any type-specific markers, given measurable differences in expression between the cell types.

resolving the composition of mixtures has proven useful in determining the purity of cell lines or proportions of heterogeneous cells, in identifying interesting cellular contaminants such as partially differentiated cells, and understanding clinical samples containing mixed cell types. in contrast to approaches using transgene expression  <cit> , the mixture model described here can evaluate tissue sample purity without focusing on a handful of tissue-specific genes, marker genes, or transgenes. we expect mixed-sample rna to be useful in regulatory applications, where a demonstration that a therapeutic stem-cell mixture has a specific composition may be key to ensuring safety and efficacy  <cit> .

spike-in controls measure post-enrichment rna content of samples
in addition to providing limit of detection and cross-experiment comparison characterizations of a dataset, spike-in controls can be used in mixture samples to determine the enriched rna fraction of cells. enrichment fraction is a critical parameter for comparing samples that do not have identical total rna content. this is most relevant to cells with variable global expression  <cit> , including comparisons across and within cell cycle, tissues, and developmental states  <cit> . enrichment fraction is also critical in single cell gene expression studies, where lysis efficiency and total rna content can vary greatly from cell to cell.

we demonstrate that the ercc controls can be used as an estimator of enriched rna content within samples. of note, the seqc study  <cit>  results showed a large degree of variation in sample sequencing library preparation even at the same site, but that the sequencing library replicates prepared at a single site and then sequenced at multiple laboratories resulted in very consistent measurements between sites. variation in library prep is primarily due to variability in rna enrichment, and is the primary source of variability in spike-in controls  <cit> .

there are many methods used to determine component gene expression profiles from mixture samples. to the best of our knowledge, our method is the only one that accounts for rna enrichment as calculated via spike-in controls. when comparing samples of variable rna content, bias arises when that variability is not accounted for. we describe a straightforward method for measuring the enrichment of target rna in rna-seq samples using spike-in rna. we show that enrichment-corrected deconvolution of two mixture datasets returns the best approximation of known mixture proportions , demonstrating suitability for solving unknown mixtures of known components.

previous methods used to determine the composition of rna-seq mixtures make inaccurate estimates of mixture proportion in the blm sample where the enrichment fractions vary substantially between mixture components. these methods are nearer to true values in the seqc sample, where the rna content difference between samples is less significant, but all estimates are improved by incorporating enrichment fraction measurement .

recommendations for use
control mixtures most easily demonstrate that an experimental process is linear and internally consistent, and can track the changes in variability over time. a first experiment with a new process should utilize these controls to demonstrate the reproducibility of measurements between single component and mixture samples. subsequently, changes to the process can be evaluated by comparing the model residuals before and after the change. for example, a lab interested in changing from a total rna measurement to a messenger rna measurement may wish to evaluate if this change had any effect on sequencing output. the change in the sum of residuals between these two different experiments would allow a global comparison, while the change in residuals of individual genes may highlight a set of genes, which become inconsistently biased between experiments. table  <dig> shows three potential use cases for mixtures used as process control.

limitations
although mean mixture proportion values returned from a linear combination of mixture components approximate the nominal mixture proportion in both measured samples, the increased variability of the muscle estimate in the blm mixture  suggests that there is a lower limit to being able to determine low-abundance mixture components. due to a lower target rna fraction in muscle, that component of the blm mix was as low as 10 % of sequenced rna in blm- <dig>  it may be possible to determine lower-proportion mixture components with confidence, but this study did not generate the required data to do so.

our estimation of targeted rna fraction is imperfect; an assumption of the model we built is that the enrichment proportion is constant between replicates of the same sample. additional file 2: table s <dig> shows that the actual enrichment varies by as much as 5 % from library to library. this variability is a source of error in our model. the variability in enrichment is likely due to batch effects in the polya selection process. this hypothesis is reinforced by the prevalence of non-polya transcripts incorrectly called as differentially expressed between mixture replicates. another limitation is that the targeted rna fraction is based on total rna mass, rather than per cell. researchers interested in the relative proportions of cells in a mixture will additionally need a measurement of average mass per cell. the sequencing technology and library preparation methods used in these experiments also added limitations to the experiments. these are described in additional file 5: note s <dig> 

CONCLUSIONS
we demonstrate the linear response function and specificity of rna-sequencing measurements using mixtures of biological samples. we recommend the use of such mixtures as benchmarks to characterize the repeatability and reproducibility of experiments. spike-in controls can be used to calculate the measured rna content of total rna mixtures, compensating for biases introduced by polya enrichment or similar rna enrichment techniques. our method creates a framework for using mixtures in measurement process control and corrects for biases introduced by rna selection. correction for differential enrichment improves the accuracy of mixture proportion determination in rna-seq experiments.

benchmarking genome-scale measurements using mixed samples will remain useful even after the era of short-read sequencing is over. answering the biological question of “what types of cells are in the mixture i’m sequencing?” requires more information than even a perfect transcriptome reconstruction could provide. the biological and measurement value added by mixed samples are demonstrated here to be platform-independent. we anticipate that mixtures can provide the same measurement assurance to protein and metabolite measurements. confidence in the reproducibility of measurement and understanding the components in complex biological samples will always be a staple of quality science.

