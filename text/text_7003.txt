BACKGROUND
site-specific transcription factors  that bind to the regulatory regions surrounding the target gene--so-called cis-regulatory-modules --are known to interact with the basal transcription complex to initiate transcription  <cit> . tfs can increase transcription by functioning as activators, or reduce transcription as repressors, respectively. the frequency and duration of the binding events is influenced by the concentration of the tf proteins, the binding affinities and location of the transcription factor binding sites  in the crm, and the properties of the tfs themselves .

modelling these binding events to quantitatively predict the resulting transcriptional output of the target gene has become increasingly successful  <cit> . the approaches model interaction of tfs and dna using thermodynamic equations and predict the transcriptional response of the target gene as mediated by these interactions. a training algorithm is used to minimize the difference between the observed and predicted transcriptional response by adjusting the model parameters.

in previous research, thermodynamic models have been trained and tested on only one crm  <cit> . because the flexibility of the model is unlikely to be constrained sufficiently by the small amount of data from fitting only one crm, it is possible that these models over-fit their input data, which would render them useless for the prediction of transcriptional output of other genes  <cit> . indeed, in an earlier paper we showed that a large number of different model settings were able to produce nearly identical output, which supports the over-fitting hypothesis  <cit> . gertz et al.  <cit>  showed that the model predictions are more robust when models are trained on multiple synthetically generated crms. hence, training on the regulatory sequence of multiple genes regulated by the same tfs should increase the quality of the generated model. aiming at increasing the confidence in the trained thermodynamic model, segal et al.  <cit>  trained one model to fit the expression data of  <dig> developmental crms  in d. melanogaster. their model was able to fit about one third of the  <dig> crms with a correlation coefficient  larger than  <dig>  . for the majority of the crms, however, the model fails to produce as good a fit, and the cc values are below  <dig>  for a third of the data. they argue that the failure of their model can be attributed to missing higher-order interaction rules  or missing input factors .

an alternative explanation, however, is that not all  <dig> crms are regulated in the same way. though all crms seem to be regulated by the same eight tfs, the role  that the individual tfs have in the regulation of some crms might differ. several experimental studies point to such "context-dependent" regulation for crms of developmental genes in d. melanogaster  <cit> . for example, hunchback  is involved in regulating the even-skipped gene , which is expressed in seven stripes along the body of the d. melanogaster embryo. it has been postulated that hb takes the role of an activator in the crm responsible for the expression of the second stripe, while being a repressor in the crm regulating the third stripe  <cit> .

to date, it is unclear what biological mechanism in d. melanogaster might explain how a tf switches from activator to repressor or vice versa . one hypothesis is that the tf itself does not switch its function, but that the altered outcome is an emergent property of the complex interactions of the system. for example, if a strong and a weak activator share a similar dna binding profile, at high concentrations the weak activator can out-compete the strong activator and ultimately reduce transcription despite its role as activator  <cit> . however, this type of interaction should be fully captured by current thermodynamic models. another hypothesis is the concentration-dependent switch, which proposes that a tf that is an activator at low concentrations can function as repressor at high concentrations   <cit> . yet another hypothesis is cooperativity, where the complex of two different tfs exert the opposite function as its individual components  <cit> . however, a protein-protein binding experiment of tfs and colocalization studies of the tfbss failed to support this hypothesis  <cit> .

in this article we suggest an alternative mechanism by which the developmental tfs in d. melanogaster can switch their regulatory roles. it has been shown that sumoylation of individual tfs can lead to a loss or reversal of the regulatory function  <cit> . sumoylation is a post-translational modification that attaches a small ubiquitin-like modifier  covalently to a target protein  <cit> .

the aims of this paper are twofold. firstly, we investigate the validity of a sumoylation-driven switching mechanism for the eight regulatory tfs in d. melanogaster. secondly, we identify the role for each of the eight regulatory tfs that best describe the developmental gene network in d. melanogaster. to achieve this, we investigate the evidence for one or more tfs to have dual function, that is, function as activator for some crms and as repressor for others.

RESULTS
analyzing the issues with state-of-the-art models
we first establish the ability of existing thermodynamic models of expression  to fit the drosophila gap-gene expression data when only one role per tf is assumed. in order to measure the performance of a model, we record the correlation coefficient  achieved when fitting all  <dig> developmental crms simultaneously. we assign bicoid , caudal  and torso-response-element  as activator and hunchback , giant , knirps , krüppel  and tailless  as repressor  <cit> . we herein refer to this particular role assignment as literature configuration. simulated annealing  is used to optimize the reinitz model on the  <dig> crms and the accuracy is calculated from the resulting model. the accuracy of the segal model on the same data is taken from predictions provided by segal et al.  <cit> .

the second column shows the number of free parameters used in the models. the third column shows the average cc over all  <dig> developmental crms. the standard error is given in parentheses.

determining the regulatory role for each tf
our next objective is to determine which of the 2|tfs| =  <dig> possible configurations of how to assign the roles--activator or repressor--to each of the eight tfs fits the available data best. we consider an upper bound on accuracy by allowing the roles of all tfs to  be different for each crm. a more reasonable upper bound would be given by allowing crms to choose from only a small number of configurations. preferences for a certain role by a tf from each of these scenarios can suggest its true role for a given crm. we also explore a sensitivity-based approach that measures the effect of changing the role of an individual tf.

there are  <dig> crms and  <dig> possible tf role configurations. we would like to consider all possible assignments of configurations to crms, and train models simultaneously using all crms. however, due to the huge number of possible assignments, this is technically infeasible. instead, we train the reinitz model using each crm-configuration pair independently, and record the correlation between the observed crm output and the model. this results in a  <dig> ×  <dig> matrix of cc values, one for each crm-configuration pair. we use this matrix in our three upper-bound and sensitivity analyses as described in the following paragraphs. we expect models trained this way to be heavily over-fitted and the cc to be overly optimistic. however, as described in methods sec.  <dig> , by focusing on the strongest signals in the data, we are only extracting candidate role assignments for further testing in sec.  <dig> , where we train on all  <dig> crms again. we do not use the accuracy estimates otherwise.

we first establish an upper bound on fitting accuracy by finding the best possible tf role configuration for each crm independently. we do this using what we call the smallest-optimal method, ∪, which identifies the tf role configuration with best cc for each crm individually and takes the union. the the smallest subset containing at least one optimal configuration for each crm has size  <dig>  with an average cc of  <dig>  . since the average cc is calculated over the set of optimal configurations with an individually trained model for each crm, it represents the upper bound regarding the accuracy that can be achieved with freely altering the tf roles between crms . we next look for a small set of configurations that most accurately fit the data. we are able to find optimum sets  with up to  <dig> configurations using an algorithm we call the best-n method, β. this method searches for the set of n configurations such that the total cc is minimum when each crm is assigned one of the n configurations and trained independently from the other crms. as seen in figure  <dig>  the single best role assignment  identified by the method already reaches 76% of the upper bound . by comparison, the literature configuration of tf roles achieves far lower accuracy . these two configurations differ only in the role of kr, which is a repressor in the literature configuration. also shown in figure  <dig>  the accuracy converges to the upper bound with the number of additional configurations allowed. we use four configurations in the subsequent parts of the paper, which achieves an average cc of  <dig>  , already 94% of the best cc achievable by the model on this data .

finally, the sensitivity method, Δ, determines the role for each tf individually by identifying which change in role causes the largest change in accuracy between some pair of configurations. this is done independently for each crm. this method results in  <dig> configurations . the average accuracy achieved by the optimal configurations is cc =  <dig>  , slightly below the upper bound . for ten out of the  <dig> crms all three methods predict the same best configuration .

the first rows give the predictions for the tf roles for six of the  <dig> crms . the roles for each tf  are determined by majority vote of the three methods: "∪" - smallest-optimal, "β" - best-n and "Δ" - sensitivity. "+" means activator, "-" repressor, respectively and "na" indicates that no "strong" role prediction could be made for the crm. the disagreeing method, if any, is shown in brackets. the second last row gives the overall prediction of the role of the tf: activator, repressor or switcher, "s" . the last row shows the number of "strong" role predictions summed over the  <dig> crms and three methods .

the disagreement between the methods calls for the construction of a voting ensemble. we aim to integrate the different properties of best accuracy , smallest number of different configurations  and strongest signal  in an ensemble by combining the three methods using majority vote. table  <dig> shows the role assignment over all crms as determined by this ensemble . to define a single role for each tf we first combine for each method individually the evidence for all crms and then build the majority vote from them. we combine the evidence by defining a tf to be an activator or repressor if for more than  of the crms the tf was favoured as activator and repressor, respectively . if for fewer than  of the crms the function agreed, we define the tf to switch roles. based on this approach we propose that cad is consistently an activator, tll and kni are consistently repressors, and bcd, hb, gt, kr and torre function as switching or "dual-functioning" tfs. as shown in table  <dig>  hb and kr are the tfs with the "strongest" role predictions  and provide hence the strongest evidence for dual function. we use both tfs as candidates to address the question how the dual function impacts on the model accuracy.

 <dig>  improving the data fit using dual roles
the above results based on fitting the reinitz model to individual crms strongly suggest that tfs hb and kr may play different roles for different crms. in this section, we further explore this possibility by training models simultaneously on all  <dig> crms. we train three models, which we call hbdual, krdual and hbkrdual, that allow one or both of hb and kr to be assigned a specific role  for each individual crm. for each crm, the role of hb, kr or both is determined by their roles predicted by the sensitivity method . the roles of the other tfs are fixed at the literature configuration. as before, we use the cc of the fit of the model to the data as a measure of accuracy.

each row shows the cc for the reinitz model using the literature configuration, and additionally hb, kr or hb and kr as switching tfs, respectively. the results are contrasted to the segal model given in the last row. the second column shows the number of different configurations in the approach. the third column indicates the number of free parameters in the model. the fourth column shows the average cc when training on all  <dig> crms simultaneously. the reported results for the reinitz model are averaged over five independent runs.

for each tf that is allowed to switch, one additional free parameter is added to the model, since the model must contain an "effectiveness" parameter, , for each role of switching tfs. the complexity of the model is increased further by the fact that it is essentially clustering the crms into two or four classes , and modeling each class separately. however, each of these class models shares all but at most two of its free parameters with the other class models.

the relatively small gain from hbdual to hbkrdual has two implications. firstly, there must be a large set of crms that benefit from either switch. this is most likely due to tfs now developing their full effectiveness rather than compromise to limit the negative effects from wrongly assigned roles. hence, the effect of assigning the "correct" role to a particular crm can also prove beneficial for other crms. the second implication is that despite the global improvement, there are tf-specific gains observable, which can only be achieved if both tfs can serve their crms correctly. the accuracy of each individual crm are provided in additional file  <dig> section  <dig> 

additional file  <dig> section  <dig> shows the expression profile of the crms attributed to hb  as activator, demonstrating that the assignment is not "trivial", that is crms with activation coinciding with the protein expression of hb are not all assigned to the hb activator set. for example, kni_+ <dig> and kr_cd2_ru have a transcriptional output at the ap position where hb is expressed, yet they do not require hb to be an activator.

these three effects are visualized in figure  <dig>  a model with literature configuration assignment achieves a cc of  <dig>  for kr_cd1_ru, which can be improved by hbdual to  <dig> , however the peak of the prediction is clearly shifted posterior by both models. krdual corrects this shift considerably increasing the accuracy to  <dig> , however has an extension of the activation anterior, which can only be corrected by the hbkrdual model. the latter allows for a stronger repressing hb at the required position , achieving a cc of  <dig> . similarly, the initial accuracy of hb_anterior_actv of  <dig>  can be improved by krdual reducing the falsely predicted posterior peaks but only hbdual and hbkrdual can improve the accuracy to capture the shape with cc =  <dig>  correctly. the crm kni_+ <dig> is an example for which accuracy improvement from hbdual, krdual and hbkrdual are identical. for these three models the role of either hb or kr or both deviated from the literature configuration. there are also accuracy gains due to indirect effects such as a more accurate parameter estimation, as shown with run_stripe <dig>  for which the roles of hb and kr do not change with regard to their respective literature configuration. eve_37ext_ru is an example where only the switch of one tf increases accuracy, while  switching of the other tf results in negative effects. the reinitz model initially achieves a cc of  <dig>  on eve_37ext_ru, which improves to  <dig>  by hbdual but then decreases to  <dig>  in hbkrdual. this might be due to a wrong role assignment obtained by the sensitivity method for kr. the same reason may be responsible for a decrease in accuracy on a specific crm for any investigated dual model as exemplified with eve_stripe <dig>  the question remains if other tfs than the investigated eight are involved in the regulation of developmental genes and can account for the observed behavior of hb and kr.

determining the involvement of other tfs in the regulation
in this section we test if other regulatory tfs might be involved in the regulation of developmental genes. since these  tfs are not included during the training of the model, the proposed dual-functioning tfs might mimic or compensate for their task rather than being indeed dual-functioning in vivo.

if such a site-specific tf is missing from the set of regulators, it should have tfbss in the regulatory regions of d. melanogaster. searching in the sequence of all  <dig> developmental crms for enriched sites might indeed retrieve a yet unknown tf that is involved in the regulation. however, without the tf's expression profile we would not be able to make any inferences whether the tf's involvement is a better explanation for the observed regulatory differences than the dual-functioning of one of the eight regulatory tfs. finding a motif that is enriched in one set of crms relative to the other set, however, would be a potential explanation for why the crms act differently.

in the previous section, we already identified two sets of crms with different regulatory mechanisms, one with hb favoured as activator and the other where hb is preferred a repressor. if a missing tf, rather than the dual role of known tfs, is responsible for the difference in regulation between the two crm sets, the tfbss of this unknown tf should be enriched in one set, while underrepresented or background distributed in the other. the enrichment should be more pronounced than when comparing to non-regulatory sequence. the same should be the case with the set of crms favouring divergent roles for kr. we use clover  <cit>  to identify which drosophila tfs with known binding profiles are statistically overrepresented or underrepresented in the sequences of the hb_act set, compared to the hb_rep set , and we do likewise for kr.

the enrichment p-values for the hb and kr sets, compared to all regulatory genomic regions in d. melanogaster, are shown in table  <dig> we identify  <dig> out of the  <dig> known site-specific tfs to be over-represented in one of the four sets of crms. only three are differentially enriched--that is overrepresented in the activator set and underrepresented or background distributed in the repressor set .

the first row shows the number of crms in each set. each following row shows a tf out of the  <dig> tested for which a clover  <cit>  analysis resulted in a significant over- or under-representation in the sequences where hb is preferred as activator  or repressor  or kr preferred as activator  or repressor , respectively. highlighted in bold are the cases with differential enrichment between the activator and repressor set. the tf marked with "*" is not expressed during the developmental time points c <dig> and c <dig> as determined from in-situ staining images http://www.flyexpress.net. the tf marked with "+" has a binding profile that is very similar to bcd. empty cells indicate that the tf was not significant for the sequence sets of hb.

for the hsf and kni motifs, one set of sequences was enriched for the motif with a clover <cit> p-value  of  <dig>  which actually represents a p-value of "no greater than  <dig> "  <cit> . since  <dig> motifs were considered, the corresponding bonferroni corrected p-value is  <dig> , so we can state that these motifs are enriched at that significance level. for these motifs, the other sets of sequences had uncorrected p-values greater than  <dig> , and corrected p-values close to  <dig>  so these motifs were definitely not enriched in the alternate sequence sets. in the case of the br-z <dig> motif, one set of sequences has an uncorrected p-value of  <dig> , which is not significant when corrected. nonetheless, we suspect that this motif is enriched in that set of sequences, and not enriched in the other set, where the uncorrected p-value is  <dig> .

however, based on prior knowledge of the functions of these three candidates, none of them seems to be a missing tf for the regulation during development. hsf does not seem to be present during gastrulation, according to staining images from http://www.flyexpress.net, and hence cannot influence the expression of the developmental genes. br-z <dig> has a binding profile similar to bcd , which is enriched in both sets. the under-representation of br-z <dig> is hence likely due to the higher proportion of the bcd-version of the motif rather than the true absence of any binding sites of br-z <dig>  finally, the under-representation of kni in the kr_act set can be explained by the observation that a large proportion of the crms that prefer kr to be an activator produce expression that coincides with the ap position of highest kni concentration . since kni is consistently a repressor, its binding would inhibit activation, which makes the absence of kni tfbss in those crms favourable and explains the under-representation of kni sites in the kr_act set. it is noteworthy that binding sites for slp <dig>  which was suggested by andrioli et al.  <cit>  to be involved in the regulation of some of the crms studied here, are neither over- nor under-represented) in any of the crms . hence, regulation by slp <dig> appears not able to account for the  differing regulatory function of the other tfs.

analyzing sumoylation as the mechanism for dual-functioning tfs
as described in the previous section, we failed to find an enriched tf binding motif, which strengthens the hypothesis of dual-functioning tfs. in this section we explore the protein sequences of the tfs proposed to be dual-functioning to see if there exists a biological marker that discriminates them from proteins proposed to have a single role. we therefore search for short motifs  common in all protein sequences of tfs with dual function using meme  <cit>  for finding one occurrence per sequence, "oops". in order to identify motifs that generally appear in the eight regulatory sequences, we also scan the protein sequences of tfs predicted to have single roles.

the results of these scans are shown in figure  <dig>  as motifs  <dig> and  <dig> appear also in the protein sequence of tfs predicted to have a single role , they can hence be disregarded as marker. motif  <dig> does not have a high information content because no sequence position was fully conserved amongst the five protein sequences, which indicates that the motif may only represent noise. this narrows the search for a marker down to two motifs: motif  <dig>  which is Ψ k. e, where "Ψ" represents a aliphatic amino acid  and "." represents any amino acid, and motif  <dig>  which is Φc. i, where "Φ" represents a hydrophobic amino acid . while a literature search revealed no information about motif  <dig>  motif  <dig> was in fact identified as the known sumoylation consensus motif. sumoylation is the post-translational modification, where a sumo protein, is covalently attached to the target protein. as a matter of fact, sumoylation has been described to alter the transcriptional function of a tf. additional file  <dig> section  <dig> shows the positions of the sumoylation consensus motifs with respect to other protein domains in the eight tfs  <cit> .

the first row indicates the role we assign to the tfs, where "+" indicate activators, "-" indicate repressors, and "s" indicates a tf switching roles. the second row shows the number of sites found in the protein sequence of the tf that match the sumo-consensus motif. the last rows summarizes the roles for the tfs previously reported in the literature.

it is believed that the functional role of a tf can be mediated by the sumo-dependent interaction with different cofactors. valin et al.  <cit>  validated this hypothesis for sp <dig>  a zinc finger c2h2-protein like hb, where sumoylation promotes the interactions with a corepressor protein causing the complex to repress transcription, whereas a non-sumoylated sp <dig> protein promotes transcription. sumoylation has also been shown to increase transcriptional activation  <cit> . another related example is ikaros, the human homologue of krüppel , whose ability to repress is reduced when sumoylated  <cit> . the loss or reduction of repressor function in concert with the competition for binding sites with a stronger repressor can result in overall activation  <cit> . furthermore, stielow et al.  <cit>  showed that a sumo-modified tf can silence genes by triggering the formation of local heterochromatin-like structures. specifically, they showed that a modified sp <dig> protein recruits chromatin remodelling proteins. it remains to be shown whether one of these mechanisms can account for the postulated functional change in the role of the tfs and whether an interaction with sumo is both protein-concentration and crm dependent.

CONCLUSIONS
in this study we investigated the developmental gene network of d. melanogaster. using a thermodynamic model, we studied the effect of tfs taking opposite roles for distinct sets of crms. we identified five tfs with potentially dual roles from the data and investigated the two tfs that provide the strongest evidence for having dual function, hunchback  and krüppel . our identification of these two tfs as potentially acting both as activators and repressors agrees with previously reported evidence  <cit> . we show that the accuracy with which our chosen thermodynamic model can be fit to existing gene expression data increases by 40% when both kr and hb are allowed to have dual function, and by 30% and 37% respectively when kr or hb are allowed to switch.

our results do not support the previously hypothesized role of hb as a repressor in the crm regulating the third and seventh stripe of eve expression, mse3+ <dig>  <cit> . we predict that hb is an activator for mse <dig> and mse3+ <dig> and a repressor for the remaining eve stripes. interestingly, mse <dig> and mse3+ <dig> are located upstream of the eve gene, while the other mses are located downstream. our findings also disagree with the concentration-dependent switching mechanism proposed by papatsenko et al.  <cit> , as crms requiring hb to act as repressor do not drive peaks in expression at locations in the embryo with the highest concentration of hb protein.

we also explore in silico the possibility that another known site-specific tf might be binding to the crms used in our study. no known tf dna-binding motif is differentially enriched in the crms in which hb  appears to act as an activator compared with those where it appears to act as a repressor . this of course does not rule out the possible involvement of some other tf whose dna-binding motif is not yet known; nor does it address the possibility of an unknown non-dna-binding tf being the mechanism required to explain the inability of the thermodynamic model to successfully fit the data. we hypothesize a sumoylation-propelled mechanism for the tf role-switch in the different crms. support for this idea is provided by the fact that sumo consensus motifs are present in exactly the subset of tfs that our thermodynamic model-based study predict to be role-switchers. our hypothesis is in line with prior evidence linking sumoylation to the modulation of transcriptional activity of tfs  <cit> . this previous work has shown that the sumoylation status of a tf affects which cofactors it can interact with, thus modulating its affect on transcription. our hypothesis is also made more plausible by the fact that the sumo homologue in drosophila, smt <dig>  is uniformly distributed throughout the embryo  <cit> . in conclusion, our results suggest that current assumptions of a uniform, fixed regulatory mechanism for all developmental crms should be revised towards a model allowing for dual roles to improve prediction accuracy. furthermore, our proposed mechanism of a sumoylation-dependent switch represents a promising area for further research, and might be another step towards uncovering the biological mechanisms underlying the transcriptional regulation of the d. melanogaster developmental network. a full knowledge of this system will be one of the breakthroughs needed for a quantitative understanding of transcription and ultimately the development of accurate predictive models of gene expression from dna sequences.

