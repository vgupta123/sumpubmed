BACKGROUND
while the modelling of evolutionary processes in non-coding sequences has received much attention from a context-dependence point of view in the last two decades, the same cannot be said for modelling approaches for coding sequences, at least not in terms of developed model-based approaches. with the advent of new evolutionary models and drastic increases in computation power during the past decades, with desktop machines becoming more powerful and the advent of computer clusters with large amounts of processors  and a vast amount of memory, maximum likelihood and bayesian mcmc approaches now allow for very complex evolutionary models to be used in the analysis of large alignments.

probabilistic modelling of sequence evolution has become the norm in phylogenetic inference, but complex evolutionary models are often not used in studies on molecular evolution, in part due to their increased computational burden but mainly due to the absence of such models in popular model testing tools  <cit> . indeed, while researchers are widely adopting model selection techniques in phylogenetics in order to select the model that best fits their dataset, this may be problematic when complex evolutionary models are not included in popular model selection tools, such as modeltest  <cit> . for example, in the case of analyzing protein-coding sequences, one needs to make sure to incorporate codon models as well as codon partition models in the model selection procedure.

chloroplast genes, such as atpb and rbcl , are protein-coding genes that are often analyzed in concatenated alignments with non-coding sequences using independent nucleotide models  or on their own using independent nucleotide models . while the choice for an independent model of evolution, such as the general time-reversible model  in combination with varying rates across sites , is easily made in the case of non-coding sequences, such a choice is questionable when analyzing protein-coding sequences. indeed, an inappropriate choice of evolutionary model can affect the outcome of any phylogenetic analysis .

models of codon substitution  consider a codon triplet as the unit of evolution and can distinguish between synonymous and non-synonymous substitutions when analyzing protein-coding sequences  <cit> . this way, they are particularly effective in detecting signals of natural selection acting on the protein. an example of such a full codon model is the model of goldman and yang  <cit> . even though the use of this model is computationally demanding due to the increased dimension of the substitution matrix, it is well suited for uncovering both recent and ancient divergences  <cit> . another category of models to analyse protein-coding sequences are the so-called codon partition models, which use different nucleotide-based models to describe the evolutionary process at the different codon positions  <cit> . codon partition models allow for different models of substitution for different partitions of the data. while full codon models - like the model of goldman and yang  <cit>  - model biological reality more closely, codon partition models are much more computationally efficient  <cit> .

in this paper, we aim to provide an overview of current codon partition models and present an extension of these models based upon previous empirical observations. morton  <cit>  studied the rbcl and ndhf genes from the chloroplast genome for signs of context dependence. specifically, the author tested substitutions at four-fold degenerate sites for the existence of a correlation between neighbouring base composition and substitution bias and found that substitution bias, as measured by the proportion of transversions, is significantly different when neighbouring bases differ in their a+t contents. by performing chi-square tests for correlation on the numbers of observed transversions at four-fold degenerate sites and the a+t content of its neighbouring bases, morton  <cit>  found a significant difference in proportion of transversions in the three possible contexts , both in an rbcl and ndhf dataset. these observations serve as the inspiration for this paper.

here, we provide an overview of currently used codon partition models and assess their increase in model fit compared to the independent general-time reversible model  <cit>  and the full codon model of goldman and yang  <cit> . starting from the independent general-time reversible model of evolution, we build these codon partition models in a forward way, continually relaxing specific assumptions concerning evolution in protein-coding regions and calculating the difference in model fit each step of the way. we go on to extend these so-called site-independent codon partition models to context-dependent codon partition models by allowing for the evolution of the third codon position to depend upon the identities of its two immediate flanking positions  and by imposing specific markov chains at the third codon position in the ancestral root sequence. we show that context-dependent evolution at the third codon position is a valuable feature to increase model fit in protein-coding sequences in general and that the properties of four-fold degenerate sites need to be taken into account when building a context-dependent codon partition model.

methods
data
we have selected  <dig> sequences from the available  <dig> in the work of karol et al.  <cit> , for the atpb and rbcl protein-coding sequences. the following sequences were used: arabidopsis thaliana, huperzia spp., psilotum nudum, dicksonia antarctica, anthoceros spp., marchantia polymorpha, chara connivens, lamprothamnium macropogom, lychnothamnus barbatus, nittelopsis obtusa, nitella opaca, tolypella prolifera, coleochaete orbicularis, coleochaete solute, coleochaete irregularis, coleochaete sieminskiana, onychonema sp., cosmocladium perissum, gonatozygon monotaenium, zygnema peliosporum, mougeotia sp., klebsormidium flaccidium, klebsormidium subtilissimum, chlamydomonas spp., nephroselmis olivacea and cyanophora paradoxa . the sequence lengths  are 1203bp for the atpb dataset and 1206bp for the rbcl dataset. our analyses used a fixed consensus tree for these  <dig> sequences, taken from the tree reported in karol et al.  <cit> , as can be seen in figure  <dig> .

site-independent evolutionary models
site-independent models of evolution have been the main subject of many phylogenetic studies since the inception of the model of jukes and cantor  <cit> . probably one of the most used evolutionary models is the general time-reversible model  <cit>  with gamma-distributed rate heterogeneity  and a proportion of invariant sites , often denoted as gtr+Γ+i. for the combined alignment of the four genes , rbcl , nad <dig>  and the small subunit  rrna gene ), karol et al.  <cit>  identified this model using a model selection approach as their model of choice for phylogenetic inference, although it is highly unlikely that this is the model that provides the highest fit to the data since more complex models for protein-coding sequences are often not present in popular packages for model selection . we only consider two truly site-independent models in this paper, i.e. the gtr and the gtr+ Γ model. we have modelled the gamma-distributed rate heterogeneity using yang's discrete approximation with  <dig> rate categories  <cit> .

context-dependent  models
over the past two decades, various context-dependent models have been developed for analysing non-coding sequence . in previous work  <cit> , we have developed a context-dependent model that employs a gtr model for each of the  <dig> possible neighbouring base combinations. we have introduced the notation "gtr16c" for this context-dependent model. a single set of site-independent base frequencies is used for all  <dig> gtr models, as well as to describe the ancestral root sequence distribution. this model drastically outperforms the independent gtr model, as well as the independent gtr model augmented with the assumption of gamma-distributed rates, for a dataset of primate ancestral repeats.

even though protein-coding sequences can in principle not benefit from such models, we have tested the performance of our previously introduced context-dependent model  <cit>  on both protein-coding datasets presented here. however, the main use of this context-dependent model lies in its introduction to the development of so-called context-dependent codon partition models, which will be discussed later in this paper.

full codon models
goldman and yang  <cit>  developed one of the first codon-based evolutionary models, i.e. models that have codons as their states, incorporating biologically meaningful factors such as transition/transversion bias, variability of a gene and amino acid differences. previous models describing the evolution of protein-coding genes in the field of phylogenetics worked either on the mononucleotide level in dna sequences or on the amino acid level in protein sequences. while nucleotide models have  <dig> states and amino acid models have  <dig> states, the codon model of goldman and yang  <cit>  has  <dig> states, i.e. the  <dig> sense codons, as it does not consider the  <dig> nonsense  codons, given that mutations to or from stop codons can be assumed to drastically affect the structure and function of the protein and therefore will rarely survive.

goldman and yang  <cit>  assume that mutations occur independently at the three codon positions and therefore allow only single-nucleotide substitutions to occur. codons are also assumed to evolve independently from one another. the model multiplies rates of substitution involving a transition by a factor κ, which directly affects the ratio of transition and transversion substitutions. to account for selective restraints at the amino acid level, substitution rates are further modified by a multiplicative factor if the two codons code for different amino acids. to do so, the matrix of physicochemical distances between the  <dig> amino acids, as composed by grantham  <cit> , is used. in the implementation of this model, which we denote "gy94", we have used the averages of the observed codon frequencies, as suggested by goldman and yang  <cit> . we also allow for among-codon rate variation and denote such a model as "gy94+Γ".

codon partition  models
codon partition  models are nucleotide models that accommodate the differences in the evolutionary dynamics at the three codon positions . for example, yang  <cit>  takes into account the nucleotide frequency bias, the substitution rate bias and the difference in the extent of rate variation among the three codon positions. while yang  <cit>  only used the hky evolutionary model  <cit>  in his analyses, shapiro et al.  <cit>  also included the gtr model. in their comparative study of suitable models for protein-coding sequence, shapiro et al.  <cit>  found that for only  <dig> out of  <dig> multiple sequence alignments, the gtr+Γ+i model was the best model and for only  <dig> of them, gtr+ Γ was the model of choice. likewise, the hky+i model was only favoured in  <dig> out of the  <dig> alignments. as shown by shapiro et al.  <cit> , codon partition  models are biologically motivated and are a computationally feasible alternative to codon-based models for the analysis of protein-coding sequences, since the dimensions of the evolutionary matrices do not increase.

we here describe currently used codon partition models  but restrict ourselves to those models that use the general time-reversible  evolutionary model. we do not use nor describe models of invariable sites plus gamma-distributed rates , given the strong correlation between the proportion of invariable sites and the gamma shape parameter . all the codon partition models discussed in this section assume that the different codon positions evolve independently from one another.

a first series of models, denoted gtr <dig> and gtr <dig>  employ different general time-reversible models depending on codon position. while the gtr <dig> model groups the first and second codon position together and hence uses  <dig> models , the gtr <dig> model considers each codon positions separately and hence uses  <dig> models . this is also referred to as the accommodation of substitution rate bias.

these two models can be linked with one common set of base frequencies  in which case we simply denote them as gtr <dig> and gtr <dig>  however, these two models can also be combined with  <dig> sets of base frequencies  for the gtr <dig> model and  <dig> sets of base frequencies  for the gtr <dig> model and we denote such models with a "+f" notation, i.e. gtr112+f <dig> and gtr123+f <dig>  this is also referred to as the accommodation of nucleotide frequency bias.

an assumption concerning the evolutionary behaviour of sites in an alignment that typically greatly improves model fit as well as phylogenetic tree reconstruction is that of gamma-distributed rate-heterogeneity, although typically used in non-coding sequence data. in the case of a discrete approximation to rate heterogeneity for all positions, we use the typical "+Γ" notation. modelling rate heterogeneity requires only one extra parameter. however, given the difference in evolutionary dynamics across codon positions, it may be important to allow for the extent of rate variation to vary across sites. this means using two independent gamma distributions when the first and second codon positions are grouped together and using three independent gamma distributions when the three codon positions are modelled separately. we denote these distributions, which require two and three extra parameters, respectively with a "+Γ112" and a "+Γ123" notation.

when simply allowing for different distributions for the rate heterogeneity at different codon positions, it is assumed that the mean rate for each of these distributions is  <dig>  as this may turn out to be unrealistic, so-called rate ratios can be added to allow for different mean rates in the gamma distributions . we have used the random-rates approach presented in the work of burgess and yang  <cit>  to accommodate variable mutation rates among codon positions . in accordance with the work of shapiro et al.  <cit> , we use the notations "+cp112" and "+cp123" to indicate the models with variable mutation rates among codon positions.

context-dependent codon partition  models
while the current codon partition  models  allow for different evolutionary dynamics at the three codon positions, such models do not incorporate dependencies between the different codon partitions . allowing for such dependencies is a particular strength of full codon models. in this paper, we provide a series of possible extensions for current codon partition models, based on the assumption that codon positions do not evolve independently from one another. as stated in the introduction, our context-dependent modelling assumptions are inspired by the work of morton  <cit> , who detected a significant correlation between the number of transversions at four-fold degenerate sites and the a+t content of the two immediate flanking bases.

as a first attempt, we assume context-dependent evolution of the third codon position on its two immediate flanking bases . the first and second codon positions however are still assumed to evolve independently from one another. we model this dependence by assuming that evolution at the third codon position occurs according to our full context-dependent gtr16c model  <cit> . this means that for the third codon position,  <dig> gtr models  set of base frequencies) will be estimated, one for each neighbouring base combination, resulting in  <dig> free evolutionary parameters to be estimated for the third codon position . we use the notation "+cd16" for this assumption.

one of the main conclusions of the study of morton  <cit>  is that the number of transversions at the third codon position are correlated with the a+t content of its two immediate flanking bases. to incorporate this finding, we have adapted our full context-dependent model  to only combine  <dig> gtr models  for the third codon position:  <dig> for an a+t content of  <dig> ,  <dig> for an a+t content of  <dig>  and  <dig> for an a+t content of  <dig> . we use the notation "+cd3" for this assumption. note that both the first and second codon positions are still allowed to evolve independently.

four-fold degenerate sites
a position of a codon is said to be a four-fold degenerate site if any nucleotide at this position specifies the same amino acid. for example, the third position of the glycine codons  is a four-fold degenerate site, because all nucleotide substitutions at this site are synonymous, i.e. they do not change the amino acid. only the third positions of some codons may be fourfold degenerate. the following amino acids have four-fold degenerate codon positions: alanine , arginine , glycine , leucine , praline , threonine , serine  and valine .

here, we expand the context-dependent codon partition model introduced in the previous section in that the context-dependent model at the third codon position is only used for the four-fold degenerate sites, as identified at the start of each branch. non four-fold degenerate sites are assumed to evolve according to a separate site-independent general time-reversible model, which shares the same  set of base frequencies as the context-dependent model at the four-fold degenerate sites. when assuming the full context-dependent model at the third codon position, we denote this model "+ff16"; when using the context-dependent model at the third codon position that is aimed at modelling a correlation to the a+t context of its two immediate flanking bases, we denote the model as "+ff3".

ancestral root sequence distribution
in previous work on context-dependent models for non-coding sequences, we have extensively discussed the importance of an adequate ancestral root sequence distribution to estimate the evolutionary parameters of context-dependent models  <cit> . indeed, while the context-dependent models presented in the two previous sections impose a dependency scheme at the third codon position across the underlying tree, it does not in any way impose a dependency pattern at the ancestral root of the underlying phylogenetic tree. to ensure a dependency scheme across the entire underlying phylogenetic tree, we therefore allow for different ancestral root distributions for the third codon position.

the standard approach would be to use the values of the base frequencies describing the contents of the third codon position as the prior probability for the states of the third codon position , which assumes independence at the ancestral root sequence. an approach which we have shown to be practical when modelling context-dependent evolution in non-coding sequences  <cit> , is to assume a zero-order markov chain  to describe the ancestral root distribution at the third codon position. this approach hence requires merely  <dig> additional free parameters.

an extension of this approach is to use a first-order markov chain to allow for dependence of the third codon position on the second codon position  in the ancestral root sequence, which requires four independent sets of base frequencies πroot = {πx|a, πx|c, πx|g, πx|t}, with x ∈ {a,c,g,t} the identity of the site at the second codon position of the same codon. one could also choose to model a first-order markov chain in the opposite direction, i.e. where the identity of the third codon position would depend upon the identity of the first codon position of the succeeding codon. however, it is realistic to expect that this approach will be less optimal in terms of model fit, so we did not attempt to include this dependency scheme. note that our notation for the distribution at the root sequence differs from the typical notation for conditional probabilities in that we put the conditional part before the 'pipe' symbol .

a final approach to model context-dependence at the third codon position in the ancestral root sequence is to allow its identity to depend upon the identity of its two immediate flanking bases, i.e. the identity of the second codon position of the same codon and the identity of the first codon position of the succeeding codon. we model this "second-order" dependence through  <dig> sets of base frequencies πroot = {πx|a|y, πx|c|y, πx|g|y, πx|t|y}, with x ∈ {a, c, g, t} the identity of the site at the second codon position of the same codon and y ∈ {a, c, g, t} the identity of the site at the first codon position of the succeeding codon.

bayesian markov chain monte carlo using data augmentation
bayesian inference of phylogeny is based on a quantity called the posterior probability function of a tree, in the same way as maximum-likelihood inference is based on the likelihood function. while the posterior probability is generally tedious to calculate, simulating from it is relatively easy through the use of markov chain monte carlo  methods . relaxing the assumption of independent evolution leads to more parameter-rich evolutionary models and computational difficulties, which we handle via a data augmentation scheme  <cit> . as previously discussed  <cit> , consistency problems may arise with such high-dimensional models, along with potential computational burdens. in view of this, a model-selection approach should be used that penalizes the addition of extra parameters unless there is a sufficiently impressive improvement in fit between model and data  <cit> . to compare the different assumptions concerning the root distribution, we have calculated  bayes factors  <cit> . log bayes factors are typically divided into  <dig> categories depending on their value: from  <dig> to  <dig>  indicating nothing worth reporting; from  <dig> to  <dig>  indicating positive evidence of one model over the other; from  <dig> to  <dig>  indicating strong evidence of one model over the other; and larger than  <dig>  indicating very strong evidence of one model over the other. we have chosen to calculate bayes factors using thermodynamic integration  <cit> , since the traditional harmonic mean estimator of the marginal likelihood systematically favours parameter-rich models and is hence unfit to compare these complex context-dependent models. a detailed discussion of the data augmentation approach in our proposed bayesian markov chain monte carlo approach and in the thermodynamic integration framework for model comparison can be found in previous work  <cit> .

prior distributions
let t be the set of branch lengths with tb  one arbitrary branch length and μ a hyperparameter in the prior for tb in t . the following prior distributions q  are chosen for our analysis, with Γ the gamma function. dirichlet priors  assign densities to groups of parameters that measure proportions . for each set of base frequencies  that describes the nucleotide composition of a codon position , the following prior distribution is assumed:  

for each set of model frequencies of which the ancestral root sequence is composed, the following prior distribution is assumed:  

as mentioned earlier, we have used the random-rates approach presented in the work of burgess and yang  <cit>  to accommodate variable mutation rates among codon positions. let the rate at codon position i be ri, with i =  <dig> , <dig>  to avoid overparameterization, the average rate is fixed at one:  and a dirichlet prior is assigned on the variables . for additional information on this prior assignment, we refer to the work of burgess and yang  <cit> .

for each codon position, the parameter αi, with i =  <dig> , <dig>  describing the among-site rate variation gamma-distribution at that codon position, is assumed to follow a uniformly distributed prior between  <dig> and  <dig> 

for the model parameters of each context  independently, the following prior distribution is assumed :  

further, branch lengths are assumed i.i.d. given μ:  

and  

RESULTS
atpb dataset
using the model-switch thermodynamic integration scheme, we have compared all site-independent, codon partition and context-dependent codon partition model to the independent general time-reversible model . figure  <dig> shows all calculated bidirectional mean log bayes factors for those evolutionary models that group first and second codon positions, while figure  <dig> shows the results for those evolutionary models that consider each codon position separately . the presented models are constructed from the bottom up, i.e. from left to right in figures  <dig> and  <dig>  each time an additional evolutionary assumption is relaxed with respect to the models . for matters of comparison, the left-hand side of figures  <dig> and  <dig> show the performances of  <dig> models that can be used in the analysis of non-coding sequences: gtr , gtr+Γ ; gtr16c ; and gtr16c+Γ .

the overall trend in figures  <dig> and  <dig> is identical, albeit that the results presented in figure  <dig>  systematically outperform those presented in figure  <dig> . the basic model in figure  <dig> is hence the gtr <dig> model, while the basic model in figure  <dig> is the gtr <dig> model. to start the various model comparisons, both the gtr <dig> and gtr <dig> models are augmented with the "+cd3", "+cd16", "+ff3" and "+ff16" context-dependent assumptions. in both figures  <dig> and  <dig> it can clearly be seen that the context-dependent substitution patterns for the third codon position increase model fit substantially, even without accommodating additional evolutionary effects such as nucleotide frequency bias or assuming among-site rate variation for each codon position . these context-dependent codon partition models continue to outperform the traditional codon partition models with the inclusion of all the evolutionary assumptions discussed in the methods section.

allowing for among-site variation  yields the largest increase in model fit. as it makes more sense in coding sequences to assume a specific pattern of among-site rate variation for either the first and second codon positions grouped together  or for each codon position separately , the corresponding models clearly outperform a model which imposes  <dig> general pattern of among-site rate variation for all sites. to relax the restriction that each codon position has a mean evolutionary rate of  <dig> , which is deemed unrealistic, this is usually accompanied by a different mean evolutionary rate per codon position .

given that up to this point, one single set of base frequencies has been used for the different codon positions, we have relaxed this assumption and have modelled the so-called nucleotide frequency bias . for both the gtr <dig> and gtr <dig> models without the assumption of context-dependence for the third codon position, this latest inclusion marks the optimal model fit as presented in the literature. we have marked the corresponding increase in model fit in both figures  <dig> and  <dig> by a dotted horizontal line. assuming context-dependence for all third codon positions on the a+t context of the two immediate flanking bases  does not yield an increase over its independence counterpart . all other dependency patterns at the third codon position have however resulted in increases vis-à-vis the current state-of-the-art codon partition models, with the gtr123+Γ123+cp123+f123+ff <dig> model yielding the largest increase in model fit.

of the different ancestral root distributions proposed to model a dependency scheme at the third codon position, the first-order markov chain  offers the largest improvement in model fit across the different model comparisons, followed by the gtr123+Γ123+cp123+f123+ff16+3f model. the same pattern can be seen when grouping first and second codon positions together, but these models are consistently outperformed by those models that treat each codon position separately.

as we have shown in previous work  <cit> , parameter clustering may drastically increase model fit of a given context-dependent evolutionary model. while this is not the aim of this study, it is thus quite realistic that clustering several parameters together will result in the gtr123+Γ123+cp123+f123+ff16+3f model being the optimal codon partition model for the atpb dataset. this is why we go on to discuss the parameter estimates for this model. the parameter estimates shown in figure  <dig> support the model building approach we have taken in this paper. for instance, the evolutionary estimates for those third codon position that are four-fold degenerate sites, are clearly different from those of the first two codon positions, which are clearly different from one another as well , justifying the use of a separate evolutionary model for all three codon positions. particularly interesting is the increased rct substitution rate at those third codon positions that are not four-fold degenerate sites.

the context-dependent substitution rates, which are grouped by the identity of the left neighbouring base, form the most interesting aspect of figure  <dig>  note that, given the small size of the  alignment and the multitude of substitution rates to be estimated, the 95% credibility intervals are quite wide. further, it is important to assess whether there are bidirectional dependencies on the third codon position, i.e. whether there is an influence of the identities of both left and right neighbouring bases on the substitution rate. we discuss the context-dependent substitution rates for the four-fold degenerate sites, as grouped by the identity of their left neighbouring base, in additional file  <dig>  important to notice is that the relationship between these substitution rates and the immediate neighbouring bases extends well beyond an influence of the a+t context of those bases, as proposed by morton  <cit> .

shown are mean estimates of  <dig>  mcmc iterations, discarding the first  <dig>  iterations as the burn-in, and the corresponding 95% credibility intervals. the values in the table clearly illustrate the different substitution dynamics at the three codon positions.

shown are mean estimates of  <dig>  mcmc iterations, discarding the first  <dig>  iterations as the burn-in, and the corresponding 95% credibility intervals. despite the wide 95% credibility intervals, the estimates show why such a first-order dependence is useful.

rbcl dataset
as for the atpb dataset, we have compared all codon partition and context-dependent codon partition model to the independent general time-reversible model using the model-switch thermodynamic integration scheme. figure  <dig> shows all the calculated bidirectional mean log bayes factors for those evolutionary models that group first and second codon positions, while figure  <dig> shows the results for those evolutionary models that consider each codon position separately . for matters of comparison, the left-hand side of figures  <dig> and  <dig> show the performances of  <dig> models that can be used in the analysis of non-coding sequences: gtr , gtr+Γ ; gtr16c ; and gtr16c+Γ .

the overall trend in figures  <dig> and  <dig> is identical to that in figures  <dig> and  <dig>  comparing tables s <dig> through s <dig> in additional file  <dig> reveals that not only the hierarchy of the models is identical, but also that the exact same model is preferred for the rbcl dataset as for the atpb dataset. however, despite the fact that the rbcl alignment is only  <dig> sites shorter than the atpb alignment , there are large differences in the calculated log bayes factors across the models evaluated. for example, the log bayes factor for the gtr123+Γ123+cp123+f123+ff16+3f model compared to the gtr model for the atpb datasets is  <dig> log units higher than the corresponding log bayes factor for the rbcl dataset. hence, as was the case for the atpb dataset, it can be seen from figures  <dig> and  <dig> that the context-dependent substitution patterns for the third codon position increase model fit substantially, even without accommodating additional evolutionary effects such as nucleotide frequency bias or among-site rate variation for each codon position  and that these context-dependent codon partition models outperform traditional codon partition models.

the parameter estimates for the optimal gtr123+Γ123+cp123+f123+ff16+3f model, which are shown in figure  <dig>  are discussed in additional file  <dig>  important to notice is once again that the relationship between these substitution rates and the immediate neighbouring bases extends well beyond an influence of the a+t context of those bases, as proposed by morton  <cit> . in short, compared to figure  <dig> which contains the context-dependent estimates for the atpb dataset, it can be concluded from figure  <dig> that the overall rct substitution rate is drastically lower in the rbcl dataset across all the neighbouring base combinations ; the 95% credibility intervals are much smaller. moreover, the rct estimates do not differ all that much depending on the neighbouring base combinations, as opposed to the atpb dataset. further, the rca and rcg substitution rates are also lower than in the atpb dataset and have much smaller 95% credibility intervals as well. on the other hand, the 95% credibility intervals for the rag and rat estimates are larger than in the atpb dataset. in short, the main differences in terms of the context-dependent substitution rates at the four-fold degenerate sites can be found in the rgc, rgt and rga parameters.

the observation that the overall substitution behaviour as well as the context-dependent substitution patterns at the fourfold degenerate sites differs between the atpb and the rbcl genes is not surprising as morton  <cit>  already reported that rbcl is the exceptional case in the chloroplast genes in terms of the relationship between context and substitution bias. as a possible explanation for this observation, morton  <cit>  suggested that a more complex context dependency exists than the relationship between substitution bias and a+t context that the author has studied. however, given that we have estimated more complex context-dependent substitution patterns at the fourfold degenerate sites, in that we don't refrain ourselves from only distinguishing between transitions and transversions, we still observe clearly different substitution behaviour between the two datasets. additional datasets, such as the ndhf, psba, matk, atpa, ..., genes, should be studied to further clarify the substitution patterns in the chloroplast genes. unfortunately, these genes have not yet been sequenced for the majority of the organisms used in this paper.

as for the atpb dataset, table  <dig> shows drastic differences in the nucleotide frequency estimates for the three codon positions, which is reflected in the higher log bayes factors for those models that treat all three codon positions separately . a notable difference between the two datasets is the underrepresentation of cytosine at the third codon position in the atpb dataset, which is not the case in the rbcl dataset. further, while the among-site rate distribution parameters for the first and second codon positions are quite similar for both datasets, this is not the case for the third codon position, where the gamma distribution parameter is three times higher for the rbcl dataset. hence, only the gamma distributions for the first and second codon positions are l-shaped, meaning that for each codon position, most sites have very low substitution rates or are virtually invariable, while a few sites exist with very high rates. the gamma distribution for the third codon position is bell-shaped, meaning that most sites have intermediate rates while few sites have very low or very high rates  <cit> . the relative rate estimates for the rbcl dataset also show some differences compared to the estimates of the atpb dataset. the mean rates of the first and second codon positions are two to three times higher than in the atpb dataset, with the mean rate at the third codon position dropping about  <dig> percent.

shown are mean estimates of  <dig>  mcmc iterations, discarding the first  <dig>  iterations as the burn-in, and the corresponding 95% credibility intervals. the values in the table clearly illustrate the different substitution dynamics at the three codon positions. there are many differences with the estimates of the atpb dataset, shown in table  <dig>  the most notable differences are the among-site rate variation distribution parameter and the nucleotide frequencies for the third codon position.

shown are mean estimates of  <dig>  mcmc iterations, discarding the first  <dig>  iterations as the burn-in, and the corresponding 95% credibility intervals. despite the wide 95% credibility intervals, the estimates show why such a first-order dependence is useful. based on the mean estimates, many differences with the estimates of the atpb dataset, shown in table  <dig>  can be seen.

discussion
while nucleotide context-dependent models can offer large improvements in terms of model fit to the data as compared to independent evolutionary models, their performance has to be compared to the performance of both codon-based and codon partition  models. shapiro et al.  <cit>  state that few analyses in the literature on protein-coding sequences actually take into account the genetic code. moreover, commonly employed model selection techniques  exclude codon-based models from the model comparisons, presumably due to the associated computational cost. shapiro et al.  <cit>  show, in alignments of  <dig> rna virus genes and  <dig> yeast genes, that the codon-based gy <dig> model  <cit>  is the model of choice for all the yeast genes and for 67% of the virus genes. however, due the computational cost the gy <dig> model seems only of use in smaller datasets. compared to the independence models , the cp models performed better on average for all the alignments analyzed. such biologically motivated cp models are hence a computationally feasible alternative to codon-based models for use with protein-coding sequences, frequently outperforming standard nucleotide models.

we have shown in this paper that the computational requirements for integrating full codon models in a thermodynamic integration framework for model comparison increase drastically. while we have focused on the model of goldman and yang  <cit>  as the full codon model of choice in this paper, better performing codon models have been developed . a study on full codon models is however beyond the scope of this paper, as the main goal was to show that current codon partition models can be approved upon at a computational cost below that of full codon models.

we have shown in this work that codon partition models that are extended with a context-dependence pattern for the third codon position across the entire underlying phylogenetic tree  significantly improve model fit compared to traditional codon partition models. while this work was mainly inspired by empirical findings  <cit> , other context-dependent assumptions to extend traditional codon partition models can be devised and tested, which is the subject of ongoing work. the models proposed in this paper illustrate the complex  substitution patterns at the third codon position, along with increased rates of evolution at that position.

the approach we have taken to model context-dependent evolution at the third codon position selects one of  <dig> models using the neighbouring base combination at the start of each branch, which means that for a given site the context might change at each internal node of the underlying phylogenetic tree. a limiting aspect of this approach however is that the neighbouring base combination is assumed not to change along the length of a branch. this leads to only one in three codon positions  that can undergo substitutions, which is an assumption similar to that of full codon models . contrary to the original context-dependent model developed for non-coding sequences  <cit> , the evolution of the third codon position could be allowed to depend upon the neighbouring base combination at both the start and the end of each branch. however, such an assumption leads to  <dig> possible combinations of neighbours, instead of  <dig> used in this paper. it therefore seems highly unlikely that a sufficient performance increase is obtained to overthrow the penalty in model fit for the additional parameters. we have hence refrained from testing such an assumption in this paper.

apart from drastically increasing the number of parameters to model the evolution at the third codon position more closely, as indicated in the previous paragraph, a continuous-time approximation is often used to allow the neighbouring base combinations to evolve along the length of a branch. the approach we've taken to do this partitions each branch into parts with length no greater than  <dig>   <cit> . as we have shown for non-coding sequences  <cit> , this approach does not yield significantly differing substitution parameter estimates or ancestral root distribution estimates. however, such an approach does lead to higher log bayes factors compared to when the branches are not split into parts. given that this approach does not lead to significantly different parameter estimates, the increased log bayes factor can be attributed to the more accurate approximation of the context-dependent markov substitution process by allowing the ancestral sequences to change in between the internal speciation nodes  <cit> .

the results shown in this paper hence support the notion that four-fold degenerate sites in the atpb and rbcl protein-coding genes of land plants have a substitution process that is dependent on the composition of its neighbouring bases. in the work that inspired this paper, morton  <cit>  suggested that a plausible explanation for such context dependence lies with misincorporations by either the dna polymerase or the mismatch repair process. we refer to different papers by morton  <cit>  and morton et al.  <cit>  for additional plausible explanations for context dependence in the chloroplast genome and to the paper of hawk et al.  <cit>  for a study on the variation in the efficiency of dna mismatch repair at different sites in the yeast genome.

even though we have found that the same context-dependent codon partition model performed best amongst all considered competing models for both atpb and rbcl genes, we have shown that the  substitution patterns at the third codon position differ greatly between both datasets. this means that, should both genes be concatenated to form a larger alignment, different context-dependent codon partition models may need to be used for each gene to perform accurate phylogenetic reconstruction for such a concatenated alignment. the substitution patterns discussed in this paper hence provide additional indications that great care needs to be taken in the analysis of concatenated genes.

as we have introduced the concept of context-dependent codon partition models in this paper, we have not yet undertaken an attempt to perform phylogenetic inference on protein-coding sequences using these models as the relationship between  model fit and the ability to accurately reconstruct phylogenetic trees is intricately complex  <cit> . in order to perform an extensive phylogenetic study on the context-dependent codon partition models we have introduced in this paper, additional context-dependent codon partition models need to be programmed and compared against the models presented in this paper, which is the subject of ongoing work. indeed, while this paper introduces a class of context-dependent codon partition models, only one type of such models is discussed . however, a whole range of such models can be developed, which may for example be aimed towards mimicking full codon models more closely, which was not the aim of this study. the performance of these models can then be compared to the performance of a range of full codon models, in the interest of performing a study on inferring phylogenies. specifically, the comparison with the codon model of muse and gaut  <cit>  would be interesting, since this model, and its derivative mg-type models, relies on estimating only  <dig> equilibrium frequencies, whereas gy-type models estimate  <dig> equilibrium codon frequencies  <cit> . a thorough model comparison, like the one we've performed on non-coding sequences  <cit> , is necessary to determine an accurate evolutionary model for phylogenetic inference.

the computational burden of our context-dependent codon partition models is, as for standard cp models, much lower than for actual codon models due to the decrease in number of parameters and the easier computation of eigenvalues and eigenvectors of the substitution matrices. indeed, the spectral decomposition of the codon probability matrix  as well as the computation of its powers is considerably slower than for a nucleotide model. computational effort in computing the eigenvalues and eigenvectors of a matrix rises as the cube of the number of rows or columns, hence the effort is 613/ <dig> ≈  <dig>  times greater for a codon than for a nucleotide model  <cit> . since our best-performing context-dependent codon partition model uses  <dig> nucleotide models to estimates its parameters, computational efforts of a codon model vis-à-vis this model are to 613/ ≈  <dig> times greater. in other words,

codon partition models  replace the high dimensionality of codon models by a series  of low dimensional matrices, for which spectral decomposition requires much less computational efforts.

the computational differences listed in the above paragraph are theoretical however, since often other estimations  need to be performed alongside eigenvalue decompositions, which do not require calculation of new eigenvalues. we have hence measured the computation time for the different classes of model present in this paper and have listed the results in table  <dig>  given the many different calculations we had to perform, two different systems were used to obtain the results. the architecture used to perform the thermodynamic integration for the codon partition models , context-dependent codon partition models  and gy <dig> model with equal rates is a 4-core amd opteron  <dig> processor  clocked at  <dig>  ghz, which has  <dig> mb l <dig> cache, requires ddr <dig> memory and was introduced in april  <dig>  the architecture used for the gy <dig> model with among-codon rate variation is a 8-core intel xeon x <dig> clocked at  <dig>  ghz, which has  <dig> mb l <dig> cache, requires ddr <dig> memory and was introduced in march  <dig>  note that our software routines are single-threaded. given the methodology we presented in this paper, it can be concluded that in the thermodynamic integration framework the cdcp models are roughly  <dig> times more demanding than the existing cp models, whereas the gy <dig> model with equal rates requires roughly  <dig> times the computational demands of the existing cp models. the comparison with the gy <dig> model with among-codon rate variation is more difficult since a different processor architecture was used for those calculations.

the first column shows the type of model being considered: cp , cdcp , with the most parameter-rich in each of these classes being chosen to provide the computational estimates. the second column contains the number of bayesian mcmc iterations for the comparison of each class of models vis-à-vis the gtr model in the thermodynamic integration framework. given the increased computational demands, fewer iterations were run for the gy <dig> model, which is reflected in the annealing and melting estimates being further apart . the third column lists the computer architecture on which the calculations were run. the fourth column contains the computation time for the model comparisons if they would be executed on a single processor core. finally, the fifth column provides an estimate of the computation time required for the gy <dig> model should an equal amount of iterations be run as for the cp and cdcp models.

CONCLUSIONS
designing accurate context-dependent models is a complex process, with many different assumptions that require testing using an accurate procedure for model testing, which is computationally very demanding. in this paper, we show that current codon partition models may benefit from allowing the evolution of four-fold degenerate sites to depend upon the two immediate neighboring sites. hence, the models we present here do not simply present an intermediate step between codon partition models and full codon models, given that the dependency patterns studied transcend the codon boundaries. hence, dependencies are inferred that cannot be inferred even from high-dimensional full codon models.

our analyses of the atpb and rbcl coding regions of a dataset of land plants show that the context-dependent codon partition models presented in this paper significantly outperform current codon partition models. further, even though for both datasets the same model is selected as yielding the highest increase in model fit, the parameter estimates indicate different substitution patterns in these datasets from a context-dependent point of view. additional datasets will need to be analyzed to further study these substitution patterns and the way they differ among protein-coding genes.

authors' contributions
gb initiated the study, designed the context-dependent codon partition models and the different ancestral root distributions accompanying these models, performed all the analyses, programmed the software routines and wrote a first complete version of the manuscript. yvdp contributed biological expertise to the analyses. sv contributed statistical expertise to the analyses and edited the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
baele et al - supplementary material. file containing supplementary material and information that was not included in the main document. word  <dig> format.

click here for file

 acknowledgements
we would like to thank three anonymous reviewers for helpful comments concerning a first version of the manuscript. yves van de peer acknowledges support from an interuniversity attraction pole  grant for the biomagnet project . stijn vansteelandt acknowledges support from iap research network grant nr. p06/ <dig> from the belgian government . we acknowledge the support of ghent university . the research leading to these results has received funding from the european research council under the european community's seventh framework programme /erc grant agreement n°  <dig> 
