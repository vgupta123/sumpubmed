BACKGROUND
one essential purpose of sequencing a genome is to identify genes for functional study and evolutionary comparison with other species. it requires long genome sequences to predict complete gene structures. the completeness of a genome is usually measured by the n <dig> statistic, the length such that 50% of the assembled genome lies in blocks of the n <dig> size or longer. to increase the n <dig> length, genomic libraries with different inserts are used to span repeat regions and to place contigs in their likely order and orientation in the sequence. this step is repeated from small- to large-insert libraries to generate longer scaffolds. large-insert libraries are necessary to improve the n <dig> length  <cit> . recently modified clone-based or ligation-based approaches have been developed to generate large mate-pair libraries for illumina platforms  <cit> . the insert size can be over 10 kb. however, these procedures are complex and time-consuming. furthermore, in some complex genomes, it is hard to increase the n <dig> length even with large mate-pair libraries, which leads to low transcript coverage. thus, it is necessary to develop other simple scaffolding approaches, to at least solve the elongation of transcribed fragments.

when one transcript is not fully covered by a genomic fragment, adjacent exons located in two genomic fragments are used as evidence of linkage between the fragments. this process is similar to how pair-end/mate-pair reads are used in genome scaffolding. indeed, in the draft human genome, the overlapping fingerprint contigs were first merged with mrnas and expressed sequence tags   <cit> . the whole genome shotgun  strategy is now widely applied into de novo genome assembly. it is possible to use transcriptome data alone to scaffold wgs sequences. from the ensembl annotations of five well-assembled genomes,  <dig> %– <dig> % of the introns are estimated to be longer than 5 kb . although this proportion is low, these large introns cover  <dig> %– <dig> % of all gene loci . moreover, mounting evidence suggests that the vast majority of the genome is transcribed  <cit> . therefore, transcripts from the pervasively transcribed genomic regions might function as long-insert libraries to scaffold most of the transcribed regions in a genome.

in this study, we aim to employ long transcripts to scaffold genomes. briefly, our method, l_rna_scaffolder, seeks to find guide transcript exons, which are anchored to different genomic fragments. an optimal connected fragment is found for every anchored fragment based on the number of transcripts aligned to them. finally, scaffolding paths are built by walking the optimal connections. we demonstrate that l_rna_scaffolder provides a high accuracy of genome scaffolding and its performance is better than most scaffolding results by existing leading methods with mate-pair libraries of different inserts. we also show that the improved transcript coverage after scaffolding is close to the complete genome. finally, we apply our method to the highly polymorphic pearl oyster genome, and demonstrate a significant increase in gene model length. the software is designed to be accessible to a broad audience interested in genome assembly.

RESULTS
l_rna_scaffolder achieves similar transcript coverage to that in the complete genome
to develop l_rna_scaffolder and to assess its accuracy, we chose zebrafish as the model organism because the genome has been updated recently and well-collected transcriptome data are available. we built scaffolds using l_rna_scaffolder from  <dig>  zebrafish contigs  in zv_ <dig> assembly  <cit>   with  <dig>  million ests/mrnas  .

the pipeline selects ‘guide’ transcripts and their aligned regions using maximal intron length , minimal length coverage  and minimal percent identity  as parameters. we varied the parameters and compared the resulting n <dig> length. with mlc and mpi set as  <dig> , the n <dig> length increased to the saturation point of 176 kb with mil over 100 kb . to evaluate the influence of mlc, mil was set as 100 kb and mpi as  <dig> . with these parameters, the n <dig> length was saturated at 177 kb with mlc over  <dig>  . finally, for mpi, the n <dig> length dramatically decreased when the mpi was over  <dig>  with the mil and mlc set as 100 kb and  <dig> , respectively . this decrease could be the result of genome mutation, rna editing or sequencing error. hence, the more stringent the alignment parameters, the fewer usable transcripts that are obtained, leading to a decrease in performance of l_rna_scaffolder. to obtain the optimal performance of our algorithm for zebrafish genome scaffolding, the mil, mlc and mpi parameters were set as 100 kb,  <dig>  and  <dig> , respectively. l_rna_scaffolder generated  <dig>  connections in  <dig>  paths where  <dig>  of the paths consisted of over two contigs . these paths consisted of  <dig>  contigs, covering a total of 636 mb  of the zebrafish genome. after scaffolding, the n <dig> size increased from 140 kb to  <dig>  kb. furthermore, the n <dig> length of the scaffolded fragments increased from 144 kb to 296 kb.

assuming that the zebrafish reference genome assembly is correct, in order to assess the accuracy of l_rna_scaffolder, we compared the predicted contig order and orientation of the  <dig>  connections to the reference contig connections . we found that  <dig>  of the  <dig>  connections were consistent with the zv_ <dig> assembly.

a three approaches including syntenic block orders, human homolog coverage and zebrafish ‘guide’ transcript completeness, are used to determine the correct connection. the connection with the most evidence is regarded to be correct. for these cases, l_rna_scaffolder results have more supporting evidence than zv_ <dig> 

b for these cases, zv_ <dig> connections have more supporting evidence than l_rna_scaffolder results.

c there is the same amount of evidence or no supporting evidence for both conflicting connections. it is hard to determine which connection is correct.

following the genome assembly gold standard evaluations  pipeline  <cit> , the inconsistent connections between l_rna_scaffolder result and the reference genome were tallied into three types of misjoins, including inversions, relocations and translocations. twenty predicted connections belong to the inversions, where one contig in the predicted connection is reversed with respect to the reference genome. however, the orientation of the zebrafish transcripts and/or their human homologs supported our predicted orientation of contigs , indicating that these predicted connections were possibly correct.

a total of  <dig>  predicted connections were attributed to relocations, where two distant contigs in a reference chromosome were joined together in the predicted assembly. transcripts span only exonic contigs, leading to that the intronic contigs between them cannot be reconstructed using our method. indeed, in  <dig> relocations, the intervals between two contigs in the reference genome were smaller than mil. over half of these distances were smaller than 8 kb . although the intronic contigs were not scaffolded in these relocations, the predicted connections could recover the complete transcripts and thus were considered as ‘correct’ relocations . the other  <dig> relocations, where two contigs were over mil apart in the reference genome, were considered as ‘errant’ relocations. three indicators, including syntenic block order, human homolog completeness, and zebrafish transcript coverage, were used to deduce the correct order for ‘errant’ relocations. one hundred and two relocations did not have any unambiguous supporting indicators ; however, the contig orders in  <dig> relocations could be deduced with clear evidence. l_rna_scaffolder connections in  <dig> of these relocations were supported with more evidence compared with that for the reference genome . this result indicated that two contigs with these connections should be scaffolded together.

a total of  <dig> connections were attributed to translocations, where two contigs in the predicted assembly were located in two reference chromosomes. for  <dig> of these translocations, two contigs were from distinct scaffolds in the reference genome, suggesting that these two scaffolds should be joined together. in another  <dig> translocations, two contigs in the predicted assembly were located in one scaffold and one chromosome, respectively, indicating that this scaffold should be integrated into the reference chromosome. in the remaining  <dig> translocations, two contigs from different reference chromosomes were scaffolded together in our prediction. we deduced the possibly correct connections for these  <dig> translocations using the same strategy as for relocations. in  <dig> translocations, both our predicted assembly and the reference genome had either the same amount of evidence or no supporting evidence and thus the correct connections were hard to determine . in  <dig> translocations, more evidence supported l_rna_scaffolder than zv_ <dig> .

overall, assuming that the reference genome is correctly assembled, the corrected accuracy rate of our method is  <dig> % . if the l_rna_scaffolder connections in inversions, relocations and translocations with more supporting evidence are also considered as correct, then the corrected accuracy rate of our method reaches  <dig> %.

to assess the improvement of transcript coverage by l_rna_scaffolder, we mapped cleaned zebrafish transcripts to the initial contigs, l_rna_scaffolder results and zv_ <dig>  we found that the transcript coverage in the l_rna_scaffolder results was higher than in the contigs and nearly equal to the coverage in zv_ <dig> . in particular, the coverage for longer transcripts obtained with l_rna_scaffolder showed better improvement than for short transcripts. for instance, for transcripts longer than 3 kb, the proportion of sequences covered by one scaffold with a length cutoff of 90% increased from  <dig> % in the initial contigs to  <dig> % after scaffolding. comparison of the coverage of  <dig> core eukaryotic genes   <cit>  in the above three genomes showed the same trend . in zv_ <dig>  most of the contigs are anchored to the  <dig> chromosomes and therefore the n <dig> value  is much longer than l_rna_scaffolder n <dig> size. however, a comparison of transcript coverage and ceg coverage between our scaffolds and the zv_ <dig> assembly demonstrated that l_rna_scaffolder produced an assembly that had good enough transcript coverage to enable gene prediction.

scaffolding the genome with an enlarged transcriptome improves the entire n <dig> size
scaffolding the zebrafish genome demonstrated that l_rna_scaffolder significantly improved transcript coverage, indicating that completeness of the transcribed genome regions increased. mounting evidence has suggested that the vast majority of the genome is transcribed  <cit> . therefore, to estimate whether an enlarged transcriptome could increase the completeness of the entire genome, we scaffolded  <dig>  human contigs in the hg <dig> genome version with  <dig>  million human ests/mrnas , a dataset almost six times as large as that of zebrafish. a total of  <dig>  paths were built, consisting of  <dig>  contigs and covering a total of  <dig>  gb  of the human genome. the n <dig> length of the scaffolded genome increased from  <dig>  kb to 432 kb, tripling the initial n <dig> size. because transcribed regions occupy the majority of the human genome, the overall n <dig> length increased from 142 kb to  <dig>  kb; a better performance than with the zebrafish data.

we randomly sampled from 10% to 100% of the transcriptome data and used l_rna_scaffolder to produce new assemblies at each of the defined levels. the n <dig> increased with more transcriptome data . the n <dig> was not saturated, indicating that it will improve as more transcriptome data becomes available.

mate-pair libraries are widely used for genome scaffolding. to compare our method’s power with that of existing scaffolding methods, we used five leading scaffolders with four distinct mate-pair libraries  to scaffold human genome contigs. the amount of mate-pair reads in all four libraries is equal to the transcriptome data in l_rna_scaffolder. in table  <dig>  we present snapshots of the scaffold number and n <dig> size of  <dig> scaffoldings. we found that l_rna_scaffolder produced a larger n <dig> size than  <dig> scaffoldings using libraries of 2 kb, 5 kb or 10 kb but the size was smaller than the ones of scaffoldings using the 35 kb library. the n <dig> size produced by the mip scaffolder with the 10 kb library was also larger than that of l_rna_scaffolder . another conclusion was that no scaffolder refrained from misjoin errors, especially relocations and translocations. following the strategy described above for correcting relocation errors, if the distance between two contigs in the predicted assembly was less than mil in the reference genome, this relocation was correctable. this produced a revised picture of the scaffolders’ accuracy statistics. as shown in figure  <dig> and table  <dig>  the corrected accuracy of l_rna_scaffolder was in the range of the five scaffolders.

column headers are defined in the main text. *: if the interval between two contigs is smaller than mil in the reference genome but they are joined together in the predicted assembly, this relocation is considered correct.

finally, to assess the improvement of transcript coverage with the different methods, we aligned human transcripts against each scaffolding result. as shown in figure  <dig>  with a length threshold of 90%, the transcript coverage in l_rna_scaffolder is higher than that in any other scaffolder and is close to the complete human genome. in particular, the coverage of long transcripts  by l_rna_scaffolder was dramatically improved. taken together, these data demonstrate that l_rna_scaffolder provides not only a practical alternative to the existing scaffolding methods for n <dig> improvement but also a better solution to improve transcript coverage.

scaffolding the draft genome of the highly polymorphic pearl oyster pinctada fucata with the roche  <dig> transcriptome
the n <dig> length of the public genome of the pearl oyster pinctada fucata  is only  <dig>  kb  <cit> . although both the roche  <dig> 10 kb pair-end library and the illumina 10 kb library were employed for scaffolding, the n <dig> size is still small. the major reason for the small n <dig> was heterozygosity of the genome; nearly two-thirds of the genome is highly polymorphic. for this highly polymorphic genome, we applied l_rna_scaffolder to assess improvement of both transcript coverage and gene prediction.

a total of  <dig>  million cleaned roche  <dig> reads  from polya transcriptome libraries were used to scaffold the draft genome. l_rna_scaffolder joined  <dig>  initial fragments into  <dig>  sequences. these initial sequences accounted for 274 mb  of the pearl oyster genome with an n <dig> of  <dig>  kb. the sequences had biased length distribution; half were shorter than 1 kb. after scaffolding, the n <dig> length was improved to  <dig>  kb. as shown in figure 6a, this scaffolding mainly merged the fragments shorter than 1 kb into longer sequences. the scaffolding result had a bias towards the long sequences, half of which were longer than 16 kb. the transcript coverage was improved from  <dig> % to  <dig> %, with the coverage of long reads  improving considerably from  <dig> % to 75% .

a set of gene models in these sequences was generated using fgenesh +  <cit> . the initial sequence contained  <dig>  gene models with a median length of  <dig>  bp. the products had a median length of  <dig> amino acids. we predicted  <dig>  gene models in the l_rna_scaffolder results. the median length of the predicted genes was  <dig>  bp, much longer than the initial median length , with a corresponding median protein length of  <dig> amino acids . in the genome of the pacific oyster crassostrea gigas <cit> , a congener of p. fucata, the genes and proteins had median sizes of  <dig>  bp and  <dig> amino acids, respectively. this comparison showed that gene and protein lengths in the l_rna_scaffolder results were close to those predicted for the pacific oyster genome . therefore, l_rna_scaffolder can greatly improve gene completeness for highly polymorphic genomes.

discussion
to our knowledge, l_rna_scaffolder is the first method that uses long-read transcripts for genome scaffolding. unlike established assembly programs  <cit> , l_rna_scaffolder does not assemble raw reads into contigs and in contrast to existing scaffolding programs that use mate-pair libraries  <cit> , l_rna_scaffolder uses only transcriptome reads.

a number of transcriptome characteristics provide significant challenges to our scaffolding strategy, making l_rna_scaffolder more complicated than existing scaffolding programs. first, without anchoring exons, intronic contigs are not scaffolded with exonic contigs, generating correctable relocations. as shown in table  <dig>  the intervals of two contigs in 80% of relocations  in the zv_ <dig> assembly are less than mil in our method. the lost contigs in over half of these relocations are small . second, alternative splicing may result in correctable relocations. we carefully examined possible cases where alternative splicing exists in the scaffolds.  both constitutive exons and alternative exons are located in the same contigs and support the same connections. the reconstructed scaffolds could completely cover all alternative splicing variants .  if one alternative transcript has dominant expression among all transcripts, l_rna_scaffolder selects this transcript as the guide and builds the connecting paths. if this guide transcript contains all exons of the gene, as shown in additional file 1: figure s6b, then l_rna_scaffolder correctly recovers the connections. otherwise, the intermediate exonic contigs are not joined, leading to a relocation event . to evaluate the coverage completeness of alternatively spliced transcripts in l_rna_scaffolder result, we used zebrafish spliced variants from the ensembl database  <cit>  as a test dataset. in the ensembl database,  <dig>  zebrafish genes have  <dig>  splicing variants. we aligned these variants to the l_rna_scaffolder result using blat and found that  <dig>  variants  were completely aligned, indicating that alternative splicing had little influence on our scaffolding. this result is consistent with the transcript coverage in figure  <dig>  third, other transcriptome events, including trans-splicing  <cit>  and gene fusion  <cit> , generate chimeric rnas from two different genomic regions and may lead to improper scaffolding, including errant relocations and translocations. if the host transcripts are more abundant than the fusion transcripts, l_rna_scaffolder selects these host transcripts as the guides and correctly rebuilds the genome . if the expression of the fusion transcripts is higher than that of the host transcripts, then l_rna_scaffolder rebuilds errant relocations or translocations following the guidance of the fusion transcripts . in spite of the latter phenomenon, in zebrafish and human genome scaffolds, the errant relocations or translocations  have low frequency, accounting for only  <dig> % and  <dig> %, respectively. fourth, in our method the gap between two scaffolded contigs is mainly originated from the intron and the intron sizes show the skewed distribution, different from the normal distribution of insert size in mate-pair libraries. here, to describe the central tendency of intron size distribution, we calculate the median intron size rather than the mean size, which is adopted to measure the insert size distribution in existing scaffolders. then we estimate the gap size by comparing the median intron value and the distance between two neighboring exons , see ‘filter connections with large introns’ below). although there are more difficulties in our method than in existing scaffolding programs that obstruct the improvement of assembly coverage and genome continuity, the assessment reveals our method is equivalent in accuracy to these methods. it is noted that assessing our method is on the assumption that the reference genome is correct. for those inconsistent connections, we used three approaches to deduce the correct orders and most of our results were supported.

we have shown that l_rna_scaffolder is a powerful and effective scaffolder. compared with existing scaffolding strategies, our method has at least three advantages. first, the simplicity and high throughput of rna-seq technology could make transcriptome reads widely applicable to genome scaffolding. mate-pair libraries are very helpful for assemblies; however, these approaches are limited by cloning or ligation efficiency  <cit>  and are much more costly than transcriptome sequencing. our novel approach may have an important impact in the automated reconstruction of genomes. second, one notable improvement of l_rna_scaffolder is to increase transcript coverage, which might facilitate gene identification. l_rna_scaffolder had similar transcript coverage to the complete genomes, making it a convenient tool that can be used to annotate genomes. third, l_rna_scaffolder can be applied to highly polymorphic genomes. increasing numbers of genomes are being published in short fragment form, limiting gene identification. one main reason is high polymorphism, which may split one genomic sequence into separate sets of small scaffolds. takeuchi et al. employed large-insert libraries, including 10 kb mate-pair libraries, to scaffold the pearl oyster genome  <cit> . however, the n <dig> size was comparatively small. they estimated that nearly two-thirds of genome sequences were highly polymorphic, which would lead to a small n <dig> length and incomplete gene structures. with our method, the gene model length in the new genome was close to the length in its congener, demonstrating that l_rna_scaffolder was suitable for gene prediction in highly polymorphic genomes.

the performance of l_rna_scaffolder can be improved in several ways with the further development of sequencing technology and alignment tools. first, the transcriptome consists of polya rnas and polya rnas  <cit> . non-ribosomal rna-seq captures both polya rnas and polya rnas  <cit>  and will help identify more transcribed genomic regions than polya rna-seq. because genes are spatially and temporally expressed, increased sequencing breadth, including multiple tissues and developmental stages, will also cover more genes. as shown in figure  <dig>  increasing sequencing depth indeed improved n <dig> size. the above two approaches would increase sequencing depth and further improve the performance of l_rna_scaffolder. second, the remarkable progress in sequencing technologies, especially increasing read length, might improve the performance of our method. l_rna_scaffolder can directly employ long reads generated from  <dig> and ion torrent sequencers. read length on the illumina platform has increased from an initial 30 bp to 250 bp  <cit> . these reads could be directly aligned to the initial contigs and then employed by our method. besides, de novo assembly of illumina rna-seq reads has been widely adopted in transcriptome reconstruction  <cit>  and the assembly results are able to function as ‘guides’ to build genome scaffolds . the third-generation single-molecule sequencing technologies, for instance, pacbio, significantly improve the read length  <cit>  and have been applied to transcriptome sequencing  <cit> . in the additional file  <dig>  we describe the application of a small dataset of pacbio long rna-seq reads from human brain cerebellum  <cit>  to scaffolding the genome, indicating that our method is also suitable for the third-generation rna-seq data. third, l_rna_scaffolder currently uses the output of blat software for scaffolding. the development of a more effective and accurate alignment approach will reduce the error rate and further improve the efficiency of l_rna_scaffolder.

CONCLUSIONS
l_rna_scaffolder provides a practical alternative to the existing scaffolding methods. the findings in this paper have been derived using three different practices with different data analysis. the comparison with zebrafish reference genome, combined with order determination, reveals that our algorithm has high accuracy. the promising outcomes with the human genome strongly indicate that long transcript reads can scaffold the genome as effectively as large-insert libraries. also, we have put emphasis on improving the transcript coverage and gene completeness so that it can be of wide use for gene prediction, even in highly polymorphic genomes. l_rna_scaffolder can make a significant contribution to the reliable scaffolding of genome assemblies.

