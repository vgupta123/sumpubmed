BACKGROUND
over the last ten years, electron cryomicroscopy  experiments yielded increasing numbers of 3d electron density images of protein molecules. the electron microscopy data bank  currently archives the 3d images, referred to as density maps in this paper, with a wide range of resolutions from 3Å to over 80Å  <cit> . when the density map is resolved to high resolution   <cit> , it is possible to derive the near atomic structure from the density map. however, when the density map is not resolved to the high resolution range, it is still challenging to derive the structure of the imaged molecule  <cit> . fitting and comparative modeling approaches have been developed to utilize the existing atomic structures in the protein data bank   <cit> . these approaches apply when a component of the target density map has been resolved to near atomic resolution structure or when the target protein shares significant homology with existing atomic structures.

modeling protein molecules using de novo methods is a general approach to derive the atomic structure from medium resolution  electron density 3d images  <cit> . only the 3d image  and amino acid sequence  are used in de novo processes. it does not need an atomic template protein structure from pdb as required for fitting and comparative modeling methods. first, the secondary structure elements  such as α-helices  and β-sheets are often identified using pattern recognition methods  <cit> . skeletonization methods detect the medial axis  of a 3d image's iso-surface  <cit> . next, the amino acid sequence segments  of the sses can be predicted using existing prediction tools  <cit> . various approaches have been developed to combine the secondary structure information from the 3d image and 1d sequence in order to derive the topology. the atomic structures can be built once the possible topologies are predicted  <cit> .

an amino acid sequence has a direction, starting with a nitrogen atom  and ending with the a carbon atom . the sse topology is the order in which this sequence traverses the protein's helices and sheets, including the direction of entry into and exit from the secondary structure. the native topology of a protein's sses is likely to produce the lowest energy state compared to incorrect topologies  <cit> . determining the correct topology is a crucial step in de novo modeling. we have formulated the sse topology problem into a constrained graph matching problem and provided a dynamic programming algorithm  <cit> . we later used a dynamic graph approach to handle errors in the data  <cit> .

the distance between two sses is an important constraint in graph matching. as an example, two helices closely located in a 3d image should be matched to two helices with similar distance estimated from the 1d sequence. the distance between two ends of two helices  can be simply estimated as the euclidean distance  <cit> , or can be measured more accurately along the skeleton  <cit> . from the amino acid sequence input, the distance between sses can be estimated assuming a  <dig> Å distance between adjacent amino acids in the sequence. a scoring function can be developed to represent the overall matching between two sets of sses, one from the 3d image and the other from the 1d sequence. the correct topology is assumed to be the one with the best match score.

despite the relative accuracy of skeletonization algorithms, overestimation may occur if length is measured directly along their piecewise linear curves, which contain many right angles and some error from the thinning process and the 3d image itself.

here, we extend our previous work in  <cit> , in which we obtained preliminary results testing a computational-geometric method to measure the length of a simplified skeleton. in addition to expanding our test set to include synthetically generated density maps and additional experimentally derived data, we used the directed hausdorff distance to handle segmentation issues. the measured length appears to agree with the expected length when the sses are detected fairly accurately.

RESULTS
test data and overall process
two data sets were used in testing performance. the simulated data set consists of fifty randomly selected helix-loop-helix  motifs from atomic structures in pdb. the proteins extracted exhibit less than 10% sequence identity. each extracted hlh of the protein structure was used to generate a 3d density map using eman <dig>  pdb2mrc  <cit> . the density maps were simulated to 8Å resolution.

the real data set consists of  <dig> cases whose density maps were downloaded from emdb with resolution from  <dig> Å to  <dig> Å. their emdb entries are  <dig> ,  <dig> ,  <dig> ,  <dig>  and  <dig> . each of these density maps is aligned with their pdb structures at download and provided multiple helix-loop-helix motif samples for the experiment.

the length of a loop was measured along the skeleton voxel points between  the end points of the two surrounding helices. an endpoint of a helix represents an end of the central axis of the helix  <cit> . the helices were detected using ssetracer, a simplified version of sselearner  <cit> . the skeleton was detected using a local maximum clustering method, more details of which are forthcoming in a separate paper. in order to test the accuracy of our algorithm, we visually inspected the detected helices and included only those cases in which the helices were roughly accurate. this was done to distinguish the potential error in our loop length estimation from that of helix detection, skeletonization, or production of the cryoem image itself.

accuracy
the accuracy of the measurement was evaluated using both the simulated data and the real data from the emdb. table  <dig> summarizes the results for the simulated data. the input to our method includes two pieces of information: the detected helix  end points and the skeleton voxels  . each measured length along the skeleton was compared with the expected length of the loop. the expected length was calculated as  <dig> Å ×, where n is the number of the amino acids on the loop and  <dig> Å is the average distance between two amino acids.

id: pdb id from which the loop came; aa: the number of amino acids in the loop; expected =  *  <dig> Å; measured: the estimated length of the loop along the skeleton or its simplification; diff: measured - expected; relerr: difference/expected; dp ∈ is the value that produced the minimum diff in the estimation.

the fifty tested cases were sorted by the length of the loop, ranging from  <dig> to  <dig> amino acids. almost all the  <dig> test cases appear to have the error within  <dig> Å . as an example, the loop in 1du <dig>  has three amino acids and the expected length of the loop is  <dig> Å. the measured length of the loop along the skeleton is  <dig> Å. the relative error is  <dig> % of the expected loop length. the simplified curve  detected by the algorithm appears to be close to the skeleton points . another example is from 1mw <dig>  with six amino acids on the loop. the error of the measurement is  <dig> Å in this case . note that the skeleton points branch into multiple directions , yet the algorithm correctly measured the length between the two ending points of the helices by using hausdorff measurements . in some cases, as in rows  <dig> and  <dig> in table  <dig> the greedy step in the hausdorff computation breaks down and the wrong pair of endpoints was used or the wrong skeleton segment was measured.

the test using the experimentally derived density data involves eighteen hlh motifs from density maps with 4-7Å resolution from emdb. twelve of the eighteen cases have measured error within 2Å, and six have error between 2Å and 5Å. the real density maps from the experiments are often more challenging with missing density and additional densities that do not align with the true structure. the helices and skeletons detected from the real maps are often less accurate than those from the simulated density maps. figure  <dig> shows an example of experimentally derived data in emdb  <dig> . the difference between the measured and the expected distance is  <dig> Å, higher than a comparable case with a synthetic density map used instead. in general, we saw an increase in error using the real density images, due to greater errors in helix detection and skeletonization induced by the noise present.

see table  <dig> for notations except id: the emdb id in which the loop was tested.

the algorithm uses a simplification parameter ∈ that is user defined. ∈ is the width of the vertex removal band . in general, the smaller the ∈ value, the less change in the simplified curve compared to the initial path. in some cases, ∈ =  <dig> is the best option, leaving the original path unchanged. in other cases, a much larger value of ∈ was needed. in order to see the degree of simplification that produced the most accurate results, we sampled ∈'s range inside the interval  <dig> <cit>  in increments of  <dig> . the measured lengths w.r.t. ∈ values appear to form a step function, and the value closest to the expected value  was marked. as seen from this case, the measured length reduces as ∈ increases stepwise.

CONCLUSIONS
we have developed a new approach to estimate loop length along the skeleton from a cryoem density map. our tests, using both simulated and experimentally derived images at medium resolution, show that it is possible for our proposed method to estimate fairly accurately the loop length along the skeleton if the sses such as α-helices and the skeleton are detected fairly accurately.

