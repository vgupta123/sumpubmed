BACKGROUND
over the last  <dig> years, biochemical investigations have discovered an increasingly consistent image of cellular metabolism . this is especially true for less complex organisms such as escherichia coli  <cit> . however, this alone provides a rather static image of the cell and thus investigations have been performed to discover cellular adaptation programs in response to changing environments such as nutrient excess, starvation and other stresses  <cit> . these observations originally followed rather linear interaction and reaction cascades, e.g. by investigating single knock-outs and tediously tracking of transcripts for single genes, or compounds and proteins that may potentially be influenced . however, the advent of dna microarrays has allowed us to explore a major subset or all genes of an organism under a variety of conditions such as alternative treatments, mutants, developmental stages and time points. for example, the technique enables us to classify tumour samples  <cit> , to define small sets of potential marker genes to distinguish leukemias  <cit> , and to discover regulatory mechanisms  <cit> . e.g., without prior information, the structure and function of the network that regulates the sos pathway in e. coli could be elucidated with transcription profiles  <cit> . furthermore, physical and chemical interaction data of proteins have been integrated. knowledge of protein-protein interaction from high-throughput techniques  <cit>  was applied to analyse gene expression data and revealed novel regulatory circuits  <cit> . moreover, interaction knowledge from the biochemical network has been used to support the clustering procedure for gene expression profiles of yeast  <cit> .

in the work reported here, we sought to reveal sub-graphs of a biological interaction network that show substantial adaptations when cells transcriptionally respond to a changing environment or treatment. as a case study, we investigated the response of the hetero-fermentative bacterium e. coli in response to oxygen deprivation. the regulatory machinery can react on this environmental change in different ways. one basic response changes the catabolism of glucose, switching off or down-regulating the respiratory sub-graphs such as the glyoxylate cycle and switching on the fermentation and production of acid end products . this is supported by several signalling concepts, e.g. by inducing inhibitors for glyoxylate cycle genes, down-regulating glyoxylate cycle genes or activating and up-regulating genes for the fermentation processes. simple clustering of gene expression data on these metabolic networks can yield sub-graphs that are either stimulated or repressed as we showed previously for the tryptophan biosynthesis of tryptophan treated cells  <cit> . with this method we were able to find an expression pattern in the network of genes having the same response to environmental changes. we developed our method further by integrating a combination of well established machine learning techniques, which enable the discovery of more complex regulatory patterns. in so doing, we were able to reveal interesting switches that are posted at process bifurcations, in rather good agreement to the expected anaerobic response of hetero-fermentative bacteria.

RESULTS
extracted discriminative patterns
the adjacency matrix of the metabolic network was clustered with a variety of penalty parameters , obtaining the most suitable clusters with d = - <dig>  . this yielded  <dig>  clusters of sizes between  <dig> and  <dig> reactions. the expression data of all  <dig> samples  from the study of covert et al.  <cit>  were mapped and features for each sample calculated by applying the haar-wavelet transformations on gene expression patterns of the clusters. we yielded  <dig>  features for every sample. after deleting features that consisted of zeros from each sample,  <dig>  features remained. a modified t-test was performed  <cit>  to reduce the remaining features and focus the classifier on the most relevant patterns. as a threshold, a false discovery rate of 2e- <dig> was chosen to further analyse the  <dig>  most significant features. with these features, the svm was trained and tested by a ten-time's ten-fold cross-validation. a recursive feature elimination  <cit>  was applied for each run, yielding  <dig> lists of the most discriminating features. these features were ranked according to their selection frequency .  <dig>  out of  <dig>  features were selected at least once. to help us focus on the most relevant features, only features with a significant selection frequency were used . this yielded  <dig> features. network clusters that contained these features were extracted and are further referred to as "extracted sub-graphs". extracted sub-graphs were listed in accordance to their selection frequency. all extracted sub-graphs are given in the supplementary material . in the following, extracted sub-graphs that contained less than six nodes are not considered to focus on larger patterns. doubles are considered once. the remaining first  <dig> extracted sub-graphs are listed in table  <dig> and are described in detail in the following . reactions were regarded as up-regulated  if the corresponding genes were significantly up-regulated under anaerobic conditions, down-regulated if significantly down-regulated , and not significantly differentially regulated otherwise . note, that not all reactions are shown in the figures .

the extracted sub-graphs  <dig>   <dig>   <dig> and  <dig> show the fermentation of formate. in the extracted sub-graph  <dig> , all edges were due to the metabolite formate, except for the edges coming from dihydroneopterin triphosphate 2'-epimerizase and dihydroneopterin triphosphate pyrophosphohydrolase. under anaerobic conditions pyruvate formate lyase was up-regulated to process pyruvate into formate . to avoid additional production of formate, the other formate producing nodes in the sub-graph were down-regulated. formate degradation was supported by up-regulated formate hydrogen lyase, which degrades formate into co <dig> and h <dig>  formate transport into the periplasm was facilitated by the up-regulated expression of the associated transporter gene. degradation of the quite costly 10-formyl-thf into formate and coa-transfer for formate production was down-regulated, as formate is abundant enough under anaerobic conditions. similarily, the gtp cyclohydrolases were down-regulated to limit the biosynthesis of folate.

the extracted sub-graph  <dig> reveals a basic switching of the leucine transporters. the putative sodium/branched chain amino acid symporter, brnq,  was up-regulated while the abc-transporter was down-regulated. both are responsible for leucine uptake. however, brnq requires a na+ gradient whereas the abc-transporter is dependent on atp which is limited under anaerobic conditions.

extracted sub-graphs  <dig> and  <dig>  contained reactions involved in anaerobic utilisation of aspartate. this makes sense when taking the support of glucose and ammonium from the medium into account, as in anaerobically grown e. coli the glyoxylate cycle is separated into an oxidative and a reductive branch terminating at oxoglutarate and succinyl-coa. oxoglutarate and succinyl-coa have anabolic functions and are required as precursors for glutamate and other syntheses. aspartate can be produced by aspartate transaminase from oxalacetate using glutamate which can incorporate ammonium from the ammonium rich m9-medium. indeed, in yeast, it was shown that the aspartate concentration is roughly  <dig> times higher in the cells under anaerobic conditions . the generated aspartate may facilitate the biosynthesis of further amino acids and other important compounds. the genes for the corresponding enzymes were up-regulated in a combined manner. the central role of aspartate was further reinforced by the up-regulation of aspartate transporters. the gene for pyrimidine biosynthesis was slightly but not significantly down-regulated . note, that the synthesis of pyrimidine may not be regulated on a transcriptional level. in e. coli the committed step for the pyrimidine biosynthesis is aspartate transcarbamoylase, at which atp and ctp compete for the same site on the regulatory subunit. atp is activating and ctp inhibiting. as atp is a purine and ctp a pyrimidine, the atp/ctp ratio reflects the balance between these types of nucleotides  <cit> . as energy is limited, the atp concentration is low under anaerobic conditions, enforcing the inhibiting effect to produce pyrimidine and bringing ctp on an equivalent low level. a quite different regulatory behaviour can be seen regarding purine biosynthesis: saicar synthetase is the eighth step in this process. its required substrate, cair, competes with the substrates atp and aspartate. cair binds  <dig> times more tightly to the free enzyme than to the ternary enzyme  <cit> . this explains the up-regulation of saicar synthetase which we observed, giving cair a better chance to bind a free enzyme within the aspartate enriched cytoplasm under anaerobic conditions. pyridoxal kinase- <dig> is needed for the biosynthesis of the co-enzyme pyridoxal 5' phosphate. it was down-regulated to save resources, whereas the peroxidases were up-regulated in accordance to safely remove h2o <dig> 

the seventh extracted sub-graph  shows a general down-regulation of lysine metabolism, such as biosynthesis, degradation, up-take, charging and modification of trnas. the sub-graph also reports its interface to the fructoselysine degradation pathway which, interestingly, was up-regulated. note, that fructoselysine is a degradation product of amadori compounds  which degrade poorly under anaerobic conditions  <cit> .

the eighth sub-graph shows elements of the link between energy storing molecules to glycolysis, which was up-regulated under anaerobic conditions. the degradation of malto-dextrin and maltose leads to the release of beta-d-glucose. beta-d-glucose is converted by glycokinase into beta-d-glucose-phosphate, to be used in glycolysis. the degradation of beta-d-glucose to glucono-delta-lactone was reduced due to the impairment of the electron transfer chain under anaerobic conditions, which is required to further process the resulting ubiquinol. in order to save resources under anaerobic conditions, enzymes participating in the anabolism of galactose and the cata- and anabolism of trehalose were down-regulated. in addition, maltose transporter, maltose-acetyl-transferase and amylomaltase were down-regulated to react upon the exclusive external energy supply by glucose.

the ninth extracted sub-graph  consisted of enzymes at the interface of the glycolysis and an nad biosynthesis pathway. the higher expression of glycolytic enzymes may indicate an enforced glycolytic turnover of glucose as glycolysis becomes the major energy supply during oxygen deprivation. more interestingly, the glycolysis intermediate dihydroxy acetone phosphate is taken up by up-regulated quinolate synthetases which are the starting point of the nad biosynthesis. even though nad may be more constitutively produced, this makes sense, as it could be shown that quinolate synthetases become inactive when exposed to oxygen  <cit>  and nad may be primarily produced via the tryptophan biosynthesis pathway under aerobic conditions.

comparison to a standard feature extraction method
to compare our findings to a standard feature extraction method, we applied the established feature elimination method by ruschhaupt et al.  <cit>  to the gene expression levels for the corresponding reactions . a ten-time's ten-fold cross-validation was performed on support vector machines, the feature extraction method was applied and the selected features then ranked according to their selection frequency. table  <dig> shows the results for the first  <dig> top ranking reactions. at the top of the table is a formate transporter, pyruvate formate lyase and the formate hydrogen lyase complex, with ranks  <dig>   <dig> and  <dig>  respectively. this compares to the first extracted sub-graph  we found using our method, which may be further extended by formate dehydrogenase  and pyruvate formate lyase . note that with exception of one reaction of extracted sub-graph  <dig>  no other reactions of our extracted sub-graphs could be found by this standard method when considering the first  <dig> top ranking reactions. this supports our concept of identifying complex expression patterns that may not be found in a common straightforward manner.

comparison with the results of the original study
we took the raw gene expression data from covert and his co-workers  <cit> . they characterised the regulatory network of e. coli with respect to the aerobic – anaerobic shift and compared the gene expression changes of these regulatory genes with the predictions of their former model and their new model. to compare their results with our results, we selected all genes from this regulatory network  and mapped them on the reactions of the proteins they code for. only genes that had received a corresponding reaction in at least one of our clusters were considered . we could map  <dig> of  <dig> genes. from this list, we characterised a gene as "positive" if its corresponding reaction appeared in the extracted sub-graphs  and as "negative" if otherwise. we treated the modelling results of covert et al. as a 'gold standard' and defined correct predictions of covert et al. as "true", and incorrect as "false". we yielded a good agreement of our findings with their newer, well elaborated model . the precision was much lower, when taking the first model of covert et al. as the standard , supporting the improvement of their modelling method. the recall was reasonable for both models . note that, the precision was calculated by dividing the true positives by all positives. recall was calculated by dividing the true positives by all covert's correctly predicted genes.

discriminative power of the expression data
to test the discriminative power of the expression data, the classification was conducted with the gene expression data alone. using only the expression data,  <dig> of  <dig> samples were correctly classified. note that we yielded the same classification performance with our method.

discussion of the clustering algorithm
clustering the network consisted of two steps. the computationally more demanding first step computed the optimal cluster matrix for a fixed permutation in linear time, with respect to the number of non-zero entries in the matrix. this exploited the symmetry and could therefore improve the running time by a factor of two. we defined a penalty parameter d to select the clustering stringency. this enabled us to adapt the algorithm to a large variety of network topologies. in the non-simultaneous case the consecutive ones property is regarded for rows only. christof, oswald and reinelt  <cit>  successfully used the results of tucker  <cit>  and booth & lueker  <cit>  to develop a branch-and-cut algorithm for the non-simultaneous case to solve the physical mapping problem  <cit> . alizadeh et al.  <cit>  and greenberg et al.  <cit>  used hamming distance tsp heuristics to solve the underlying consecutive ones problem approximately. whether the hamming distance tsp approach works also in the simultaneous case must be tested in the future. note that optimising simultaneous consecutive ones matrices is substantially more difficult than tackling the physical mapping problem. nevertheless, based on the pq-tree-algorithm we were able to implement a fast heuristics and yielded reasonable clustering results. biological networks contain few nodes with high connectivity, so called "hubs"  <cit> . these are not easy to group as they may be included in several clusters. on our cluster-matrices we got off-diagonal entries that were not sorted into appropriate clusters . this problem has to be tackled, for example by testing ensemble methods.

CONCLUSIONS
our method facilitated the discovery of interesting and complex regulated sub-graphs by testing all possible patterns within the metabolic network and sorting out the patterns with the strongest differences between the conditions. it may suit for a variety of further biological interaction networks, such as signalling networks, e.g. when analysing discriminative regulations in cancers with different prognoses, and/or incorporating interaction data from modern high throughput methods, such as yeast-two-hybrid, chip-on-chip or fluorescence based technologies.

in our case study, we found a strong differential expression pattern of the transcripts coding for formic acid processing enzymes at the interface of the aerobic and anaerobic glucose catabolism: the aerobic catabolism processes pyruvate further on the respiratory glyoxylate cycle, whereas an anaerobic processing uses pyruvate formate lyase to produce formic acid as a fermentative product to be further degraded or excreted. pyruvate formate lyase may serve as a single switch. however, our study highlighted a concerted regulation reaction on oxygen deprivation. the bacteria adapted to this environmental change not only by degrading pyruvate into formate, but also by reducing formate production from e.g. 10-formyl-thf. furthermore, formate removal was enhanced by up-regulated genes for formate exocytosis and formate degradation. we revealed an adapted regulation for aspartate processing enzymes. interestingly, coming from aspartate, the starting point for purine biosynthesis was up-regulated, whereas that of pyrimidine biosynthesis was not. searching for an explanation, we identified recent articles and textbook entries which provide plausible reasoning for this situation . further switches were revealed, as e.g. the activation of the nad biosynthesis pathway under oxygen deprivation.

hence, we elucidated some interesting and relevant sub-graphs of the metabolic network that showed necessary changes during the aerobic – anaerobic shift. but note, that such findings may not represent the entire regulatory change during such a shift of the metabolic network.

