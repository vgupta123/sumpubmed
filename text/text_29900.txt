BACKGROUND
microbial forensics and epidemiology is important in tracking the source of a pathogen, whether the disease is a naturally occurring outbreak or part of a criminal investigation. polymorphisms among isolates or strains provide information as to the origin, phylogenetic relationships, or transmission patterns of those isolates  <cit> . the  <dig> anthrax attacks highlight the importance of rapid forensic identification of the source of an agent used in a bioterrorism event. sequencing hiv fragments indicated that a florida dentist probably infected at least six of his patients with hiv  <cit> . a series of court cases in scotland center on accusations that hospital staff are transmitting methicillin resistant staphylococcus aureus to patients  <cit> . the centers for disease control and prevention has also developed a network for molecular subtyping, or fingerprinting, of foodborne pathogens  <cit> . because snps, insertion/deletion mutations, or sequence repeats may affect or be linked with phenotypic traits such virulence or antibiotic resistance, analysis of variance in polymorphic markers may also contribute to improvements in the diagnosis and treatment of infectious diseases <cit> .

increasing availability of genomic sequence data makes it possible to predict regions of a genome that display variation among strains or isolates  <cit> . in the event of a suspected biothreat outbreak, the agent would be completely sequenced; however, full genome sequencing may require weeks or more. ideally, there should be information immediately available about the hotspots of variation, the key sequence regions or assays that can discriminate among the possible sources of the agent, based on existing sequence data. this demands a full-genome analysis of available sequence data to predict discriminating markers among strains or isolates. knowledge of and validated assays to query these variable regions for genotyping analyses could then be used to rapidly classify an unknown isolate in terms of its relationship to the already-characterized strains. these results could be available within hours, long before full sequence information becomes available. once full-sequence information is generated, reliable, automated tools are required to find how this sequence differs or is similar to other strains. recently, budowle and colleagues stated that there is a "need for an infrastructure with analytical tools and knowledge bases to rapidly provide investigative leads..."  <cit> .

the needs described above demand a full knowledge of all the snps and fragment length polymorphisms  that distinguish known isolates. snps and pcr-rflp analyses have been used extensively in genotyping for forensic and epidemiological applications  <cit> . although extensive experimental bench work or human examination of multiple sequence alignments can illuminate such variations, non-automated analysis is tedious and error-prone, especially for long sequences or when more than a few sequences are available. existing software programs related to forensics focus on human crime forensics, paternity investigation, and so on, and do not enable full-genome prediction of marker regions or predict the combinations of variable regions that facilitate maximal isolate discrimination with a minimal number of assays  <cit> .

to address this need, we have developed an automated forensic pipeline for snp and pcr-rflp optimization, called spr opt . to our knowledge, this is the first comprehensive, automated, computational tool that performs the following four steps:

1) identifies all snps or pcr-rflp variations in a set of input sequences that can be as long as whole microbial genomes,

2) groups the co-segregating markers into haplotypes,

3) performs combinatoric analysis on the haplotypes to generate multi-locus solutions to maximally discriminate each of the input sequences from the others,

4) uses simulated annealing to find the best solutions using the smallest total number of haplotypes  to discriminate all the input genomes to the maximum degree possible.

both snp and pcr-rflp solutions computed by the spr opt software include multiple loci when necessary for maximal sequence discrimination. in this paper, input sequences may also be referred to as genomes. however, the input need not be complete genomes; it can be gene sequences or other fragments from a number of isolates. here a snp is considered to be a single polymorphic base surrounded by conserved upstream and downstream sequence  <cit> . the length of the conserved sequence surrounding a snp is specified by the user. in future versions of the software under development, a less strict snp definition will be allowed in which requirements for conservation surrounding the snp position are relaxed, allowing polymorphisms and indels in the region immediately surrounding the snp position.

spr opt also predicts pcr-rflp assays to discriminate the input sequences. those primer pair and restriction enzyme combinations to maximally discriminate the input sequences are identified. for the pcr step, it is assumed that primer pairs must be conserved among all the input sequences. the resulting amplicons are examined for length polymorphisms or sequence variations that would result in differences in fragment length distributions after restriction digest among the multiple input sequences . this software elucidates all pcr-rflp detectable variations, whether they are caused by insertions or deletions of non-repeated sequence, tandem repeats, non-tandem repeats, microsatellites, mutations that alter a restriction site, and so on.

for both snp and pcr-rflp analyses, some conservation is required among the input sequences surrounding the variable site, whether it be conserved bases up and downstream of the snp, or conserved primers surrounding the fragment length polymorphism or rflp. this ensures that there are not false negatives because the surrounding sequence was not amplified or otherwise detected. for example, detection of snps may be performed using a microarray with oligos chosen so that the central base is a snp, and there are  <dig> oligos for each conserved surrounding sequence, each representing the snp position filled with a, t, c, or g, respectively. if there is not a hybridization signal from any of the four oligos, then this serves as an alert that there may be a problem with the reaction conditions or the sample. in contrast, if conserved oligos  are not used, then it is unclear whether the sample is a variant without that particular snp, or whether the sample is degraded, the reaction conditions unsuitable, or the target species is not present.

here it is assumed that a haplotype is a group of markers  that segregate in the same pattern across the genomes. any single marker in a given haplotype indicates the identities of the other markers in this haplotype, so that every marker within the haplotype need not be examined. here it is not assumed that the markers within a given haplotype cluster spatially in any pattern within a given sequence. that is, markers in the same haplotype may be distributed evenly or randomly, and do not necessarily occur within blocks of contiguous sequence. haplotypes do not necessarily correlate with "hotspots" of mutation. markers in the same haplotype may be likely to be linked, located in close proximity and inherited as a group, but it is not assumed that this is the case. indeed, if markers in the same haplotype are separated in the genome, it may indicate that a recombination event has occurred. alternatively, this pattern could be a result of selection or chance. such an investigation of how positional information of markers in the same haplotype may indicate recombination is beyond the scope of this paper.

although the first part of this software depends on locating the snp or pcr-rflp sites , the "backend"  of this computational forensics pipeline depends only on the haplotypes. thus, while the tools are currently coded to work for the snp or pcr-rflp analyses described here, any type of marker such as microarray hybridization patterns, microsatellite markers, or even chemical or physical features that differ among isolates could be categorized into haplotypes and fed into the back end of the combinatorial analyses described below.

one question that is investigated here is that of how well phylogenetic trees based on the haplotype splits of pcr-rflps or snps correspond with those generated from full genome sequence alignments or phenotypic differences. the results presented indicate that trees built solely on forensic markers do not closely match those based on full genome alignments. this finding has important implications for tree generation and interpretation in the absence of sufficient genomic sequence information, since empirical forensic techniques are often used for tree prediction. a second analysis presented is the frequency that different restriction enzymes result in fragment length polymorphisms for the sars and mumps data.

the impacts of this software are the following: 1) the software provides computational guidance as to an optimal set of assays for genotyping the isolates, particularly helpful when large numbers of sequences or genomes are available. 2) all the snp or pcr-rflp variations in the available data are found and grouped into haplotypes. this includes identification of the sequence surrounding a snp that will be useful in designing the assay , or primer prediction and restriction enzyme selection. if the available sequence data is limited, there is no guarantee that the primers identified will be found in unsequenced strains, although requiring conservation among the sequenced isolates increases the chances of conservation among unsequenced isolates as well.

the application of spr opt is illustrated for two viruses for which multiple genomes are publicly available. the software and source code is publicly available and free for non-profit use at .

RESULTS
the output files listed in table  <dig> containing the details of these analyses are provided as supplementary information for the web . the main results are summarized in tables  <dig>   <dig>   <dig>  the large number of genomes, variable sites, and character haplotypes illustrate the utility of this software for focusing in on the most informative combinations of sites. only some of the mumps virus or sars virus genomes can be uniquely discerned from other genomes of the same species. unresolved clusters are given in additional file  <dig>  computational prediction of pcr amplicon length variation  for mumps virus indicates there are no variable length amplicons using the parameter values and definitions used here. therefore, this method when restriction digest is omitted is not appropriate for genotyping mumps virus.

the minimum number of assays indicates the fewest haplotypes that need to be queried to discriminate all the input genomes to the maximum degree possible, that is, the number of assays that would need to be done to classify an unknown isolate in terms of its similarity to the currently sequenced strains using this type of forensic marker.

the number combinations of amplicon x unique fragment length distributions is the number of unique fragment length distributions summed over all variable amplicons.

the number of combinations of amplicon x enzyme x unique fragment length distributions is summed over all variable amplicon, enzyme combinations in the pcr-rflp analyses.

a comparison of the sars phylograms created using full genome sequences, snps, or pcr-rflps  illustrate that although there are similarities within the fine branch structure showing the relationship of very similar genomes, the basic structure of the trees differs. genetic distances, indicated by the lengths of the branches, vary among the trees, and the particular genome clusters predicted to be the least similar  contrast among the trees. a tree created from an optimal solution for snp forensics has little branching structure and homogeneous branch lengths, and does not appear very similar to or to provide as much information as trees created from all the snp data or from the multiple genome alignment.

discussion
pcr without restriction digestion was inferior to pcr-rflp and snps for genome discrimination of the viruses examined, although in additional analyses of bacterial genomes, pcr without digestion was adequate for complete genome discrimination . when it is possible to choose from a very large number of restriction enzymes, pcr-rflp may enable a greater level of discrimination than snp analysis, illustrated by the result that the genomes can be subdivided into more, smaller unresolved clusters using pcr-rflp than using snps. however, this is not always the case: for example the two sars genomes pumc <dig> and sino1- <dig> can be discriminated using snps but not using pcr-rflp. if only a small number of restriction enzymes are available, then analyses using spr opt indicate that snps outperform pcr-rflp . in most cases, either snps or pcr-rflps can discriminate most genomes, with minor differences in the exact unresolved clusters predicted. in these cases, one may need to use both techniques in order to discern different sets of similar genomes.

contrasting the phylogenetic trees generated from full genomes, snps, or pcr-rflps suggests that caution is needed in assessing genome divergence based on forensic/epidemiological data in lieu of full genome sequences, since the isolates predicted to be most divergent may differ across the three measures of variation. in addition, if only the subset of snps determined to be optimal for forensic discrimination are queried, phylogenetic trees based on this information may not be representative of the true phylogenic relationships, and may result in particularly poor estimation of branching structure and branch lengths.

highly heterogeneous viruses like many of the single-stranded rna viruses  must be subdivided into clades or other sub-groupings of genetically similar strains even before this software can be applied. lack of conserved sequence upstream and downstream of a snp, or lack of conserved primers for pcr amplification, may thwart attempts at snp or pcr-rflp discovery at the species level. instead, one requires subgroups of genomes that are sufficiently similar to locate conserved regions surrounding the forensically informative sites. a future version of the software under development will employ a less restrictive definition of snps, allowing some variation surrounding the snp position.

in addition to snp and pcr-rflp analysis like the examples presented here for a given target species, there are many questions one could address with the aid of this software. for example, the character haplotypes and genome groups generated by spr opt contain a wealth of information. if there are differences in virulence, host range, or other interesting phenotypic traits, one may examine the list of genome groups to see if there are any whose genome membership corresponds with the phenotypic variation. if so, these may be interesting regions for further biological investigation. for example, in which genes do the corresponding character haplotypes land? do the nucleotide variations translate into protein sequence differences? one could also take a complementary approach, asking whether snps or pcr-rflps are clustered in certain genes or intergenic regions. it would also be interesting to examine whether or not snp locations within a species correspond to regions of relative inter-specific conservation or variation. as mentioned in the introduction, the distribution of co-segregating markers in a given haplotype across the genome sequence might be used to look for evidence of recombination events or correlated selection on multiple genes, as might be observed if genes are in the same pathway or affected by the same environmental factors.

CONCLUSIONS
in conclusion, bioinformatic software called spr opt is described to optimize snp and pcr-rflp analyses in order to provide the maximum amount of genotyping information from the fewest assays at the bench. spr opt requires as input a set of sequences and their multiple sequence alignment. this software not only predicts the variable sites based on input sequence data, but also groups these into co-segregating haplotypes and provides guidance as to the ways in which these may maximally discriminate genomes using the fewest possible assays. these are computationally challenging problems that are solved using a bit vector intersection approach to determine sets of haplotypes to maximally discriminate each input genome, as well as parallel simulated annealing to select a subset of the many possible solutions that will enable users to extract the most information from the fewest forensic tests. analyses of two viruses were presented, and a number of potential investigations using this software are suggested. this is the first comprehensive tool to optimize the selection of forensic markers to maximize information gained from the fewest assays, accepting whole or partial genome sequence data as input. as more sequence data becomes available for multiple strains and isolates of a species, automated, computational approaches such as those described here will be essential to make sense of large amounts of information, and to guide and optimize efforts in the laboratory.

