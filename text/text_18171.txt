BACKGROUND
with the exponential growth rate of newly sequenced genomes, comparative genomics methods are increasingly important in providing frameworks of automated functional annotation for newly sequenced genomes. approaches such as gene context, gene fusion  <cit> , domain interactions  <cit> , and phylogenetic profiling  <cit>  have been used to help identify functional associations and assign putative roles for unannotated genes. in the past these comparative genomics methods have been applied primarily to prokaryotic genomes, in part due to the lack of sequenced eukaryotic genomes, and in part due to differences in genomic organization of eukaryotes. for example, gene context is of limited use in eukaryotes as the relationship between proximity of genes and functional relatedness is much weaker  <cit> . despite fundamental differences between prokaryotes and eukaryotes, there is preliminary evidence that methods such as gene fusion and phylogenetic profiling may be viable techniques in the annotation of eukaryotic genes  <cit> . with the recent sequencing of more eukaryotic genomes, we are at a point where we can more thoroughly assess how useful comparative genomics methods may be in the annotation of eukaryotic genomes. here we focus on phylogenetic profiling, a method of assigning functional associations based on the patterns of evolutionary co-occurrence of genes among many organisms. our intent is to assess the ability to predict gene function in eukaryotic organisms based on patterns of phylogenetic conservation in different groups of organisms.

genes with similar patterns of co-occurrence across many organisms tend to exist in the same protein complex, biochemical pathway or sub-cellular location  <cit> . the construction of profiles, which capture the phylogenetic distribution of the genes of a given organism, allows for the genome-wide identification of functional linkages between genes which themselves have limited known annotation  <cit> . the utility of this method is reflected in the success of previous studies, where putative associations have been shown to have a high reliability across a number of ontologies, for bacterial organisms as well as s. cerevisiae  <cit> . however, results in s. cerevisiae were obtained with profiles consisting of mostly prokaryotic organisms, limiting the predicted associations to those genes which are of microbial descent.

a phylogenetic profile of a gene is classically represented by a binary vector, representing the presence or absence of homologs to that gene across a set of organisms  <cit> . presence or absence of homologs can be determined with orthology databases, such as cog  <cit> , or by using raw sequence similarity scores, such as a blast  <cit>  e-value, and imposing a threshold for presence. while manually curated orthology databases contain stringent definitions of common descent, they have lower coverage and suffer from infrequent updates due to limitations in manpower and an exponential growth in data. for these reasons, it is advantageous to be able to automate profile construction using only sequence similarity, which allows for greater coverage and the application of phylogenetic profiling to newly sequenced, unannotated organisms. in this vein, several methods have been developed which construct phylogenetic profiles from transformed blast e-values and bit scores. a comparison of commonly used methods does not currently exist in literature, so we initiated our analysis by performing this comparison in both prokaryotic and eukaryotic genomes. we hoped to provide insight for the community regarding which technique may be best when profiling prokaryotes. furthermore, by assessing the predictive abilities in prokaryotes we established a benchmark to evaluate the quality of predicted association in eukaryotic genomes.

in addition to the method used to construct profiles, the set of organisms used is also of great importance. the genome composition of profiles was addressed recently by sun, et al  <cit> , who showed that accuracy of predictions for prokaryotic genomes was improved by using sets of genomes which are maximally distant from one another. in other words, using a more diverse set of organisms results in a more informative pattern of occurrence of a gene – possibly by reducing redundancy caused by having many closely related organisms. with our emphasis on annotating eukaryotic genomes, we sought to extend sun's analysis of genome composition by analyzing the affect of eukaryotic genomes, both with and without additional prokaryotic genomes, on predicted associations. in virtually all previous studies, eukaryotes have been used in profile construction without an assessment of their influence on performance.

with the ultimate goal of assessing the prospects of phylogenetic profiling as a tool for identifying functional linkages in eukaryotic organisms, we explored the influence of both profile construction method and genome composition on performance in e. coli and s. cerevisiae. our analysis of different profile construction methods reveals that in e. coli continuous profiles constructed from transformed blast bit scores perform best, while in s. cerevisiae discretized profiles have higher accuracy, based on common kegg pathway membership of predicted associations. in addition, independent of the profile construction method used, in s. cerevisiae the addition of eukaryotic genomes to profiles consisting of a majority of prokaryotic organisms was extremely detrimental to performance; this was seen both in terms of the number of different kegg pathways in which a nonrandom percentage of correct predictions are made, and the accuracy of these predictions within different pathways. furthermore, when using profiles composed of strictly eukaryotic genomes, performance was drastically reduced based on all metrics used. several attempts to account for potential reasons for this, such as greater domain complexity in eukaryotes, the uneven distribution of sequenced eukaryotes, and the functional biases of different ontologies  all failed to influence profiling performance. we conclude from these findings that fundamental differences between eukaryotic and prokaryotic evolution may restrict the usefulness of phylogenetic profiling in eukaryotes to a limited number of pathways.

RESULTS
comparison of existing methods of profile generation
though an analysis of the effectiveness of applying phylogenetic profiling to eukaryotes has yet to be studied in literature, homology based methods of generating profiles for prokaryotes has been presented in numerous publications  <cit> . to initiate our study we investigated the relative performance of the commonly used previously documented profile generation methods in both e. coli and s. cerevisiae, using profiles consisting of only prokaryotic organisms. we wanted to establish a benchmark for subsequent predictions in eukaryotes, in addition to providing a side-by-side comparison of available methods to the benefit of the community, as currently none exists.

existing homology-based profile creation methods can be placed into one of two classes: those that discretize their sequence similarity scores, and those that don't. original phylogenetic profiles used a binary discretization method, where a gene was designated to be either absent  or present , based on the best hit blastp e-value into each organism being above or below a set cutoff  <cit> . optimization of these binary profiles was recently explored by sun and colleagues, where it was found that setting a cutoff for homolog presence at 10- <dig> was optimal in e. coli, and this threshold was found to be robust when tested in other prokaryotes  <cit> . in this paper, we will refer to this optimal binary profile construction method as sm . building on earlier work with binary profiles, date and marcotte presented a multinary discretization method where best hit blastp e-values were discretized into one of  <dig> bins; this was shown to be quite effective in both e. coli and s. cerevisiae  <cit> . in this paper we will refer to the date and marcotte method as dm . extending the dm method, in this paper we optimized the discretization process by identifying binning parameters which resulted in the maximal performance for a given organism, and refer to this method as sg . sg was developed to determine the upper-bounds performance of using discretized blast scores by finding the query organism specific optimal binning parameters. lastly, a method using continuous values was presented by enault and colleagues, where normalized blastp bit scores are used  <cit> . this continuous profile method will be referred to as em .

to compare the performance of the different methods, we first used e. coli as the query organism against a reference organism set of  <dig> prokaryotes . the kegg pathway ontology was used to assess the accuracy of predicted associations. it should be noted that a few pathways were removed from consideration due to the lack of functional relationships among their members . figure 1a depicts the accuracy, as measured by positive predictive value , of the  <dig> highest-confidence predictions made by each of the three published methods, and the sg method. the em method, based on continuous profiles, has the best overall performance. we found that among the discretized methods, the sg method, using parameters optimized specifically for e. coli in order to identify the 'best case' accuracy for discretized phylogenetic profiling, had the highest accuracy. what is perhaps surprising is that dm, which uses multinary profiles that incorporate gradients of similarity, performed similarly to the binary sm method. this result, in conjunction with the better performance of sg, suggests that dm is losing information by discretizing into too many bins, thus making distinctions between e-values which in effect incorporate misinformation. in this respect using continuous profiles can be advantageous to any discretization method, as arbitrary cutoffs do not need to be imposed.

relative performance using a eukaryote as the query organism
a previous study has shown that when using s. cerevisiae as the query organism in conjunction with profiles composed of primarily prokaryotic organisms, there is a strong correlation between the profile similarity score and the functional relatedness of proteins  <cit> . using prok <dig>  profiles were generated using all previously mentioned methods for s. cerevisiae. as seen in figure 1b, the sg method, using parameters optimized specifically for yeast, outperforms the other three methods on this set. for all methods, the overall performance when using yeast as the query organism is lower than when using e. coli, as is expected due to its increased evolutionary distance to the organisms of which the profiles are composed.

to gain further insight into the predictions made by the methods and, specifically, to determine the diversity of the predictions made, we conducted a pathway centric analysis. this analysis makes use of the hypergeometric test and is described more thoroughly in "methods." the purpose of this test is to determine the number of kegg pathways in which the percentage of correct predicted associations is higher than random. this analysis was performed by looking at the top  <dig> predictions for the methods with the highest accuracy among both method classes: sg representing the discretized profiles and em representing the continuous profiles. when using e. coli as a query organism with the prok <dig> set, a set of  <dig> pathways were found to be statistically enriched by sg, and  <dig> were enriched by em. in contrast, when yeast was used as the query organism with same genome set,  <dig> pathways were found to be enriched by sg, and  <dig> by em. it is unsurprising that fewer pathways were identified in s. cerevisiae when using a profile composed of solely prokaryotes; a large evolutionary distance to the profile organisms, coupled with eukaryotic specific functionality, limit the number of pathways which can be identified using the prok <dig> set.

influence of the incorporation of eukaryotes among the reference organisms
a question that has gone unaddressed until recently is how the genomic composition of phylogenetic profiles affects performance in functional annotation. many previous studies have taken the tack that all available sequenced genomes, prokaryotic and eukaryotic alike, should be included in the profile. our findings strongly suggest two things about the creation of profiles in which the query organism is a eukaryote: first, having a significant number of eukaryotes in a profile, despite the presence of a majority of prokaryotes, will reduce the functional diversity of the results returned by the method; second, profiles consisting entirely of eukaryotes have very limited accuracy and coverage.

previous publications have used eukaryotic genomes in profile construction when available, and we wanted to determine the impact these genomes were having on the predicted associations. twenty-three eukaryotic organisms were added to the prok <dig> set, creating the set designated mix <dig>  first, a comparison of prediction accuracy using s. cerevisiae as a query organism was performed, showing a similar performance using the mix <dig> set to that seen in figure 1b for profiles constructed with prok <dig>  while overall accuracy remained comparable, the pathway centric analysis revealed some striking differences between predictions made using prok <dig> and mix <dig>  in mix <dig>  when using yeast as the query organism, sg had  <dig> statistically enriched kegg pathways, while em had  <dig>  furthermore, the enriched pathways that remained significant tended to be housekeeping processes, such as ribosome, purine and pyrimidine metabolism, and proteasome. these markedly lower numbers of statistically enriched pathways, when compared to  <dig> and  <dig> in prok <dig> for sg and em, respectively, illustrate the loss of diversity that occurs with the introduction of eukaryotes into the prok <dig> profile . this trend was also observed when looking at larger numbers of predictions for the various methods. the difference in the composition of the resulting associations can be partially explained by noticing that profile pairs present in high confidence predictions of mix <dig>  but not of prok <dig>  tended to be nearly ubiquitous in all the eukaryotic organisms. in essence, the addition of a string of identical bits into two previously weakly correlated profiles results in a much increased correlation. in other words, we observe correlations between genomes instead of between genes, typically produced among genes belonging to pathways ubiquitous to eukaryotes. the consequence of including eukaryotic organisms when identifying associations in e. coli is negligible based on both overall accuracy and pathway analysis, as shown in figure 2a.

even though the percentage of eukaryotic organisms making up the profile is only roughly 10% of total organisms, we still see a drastic change in performance in s. cerevisiae. one might expect a priori that using only eukaryotic organisms to construct profiles would be ideal when profiling a eukaryotic organism, but these results show no evidence of this effect. in order to test this explicitly, a new organism set was constructed that contained  <dig> eukaryotic organisms . as can be seen in figure  <dig>  there is a much decreased correlation between profile similarity score and kegg pathway similarity with euk <dig> when using sg, when compared to the strong correlation using prok <dig>  the large decrease in performance in euk <dig> is observed when using all profile creation methods . in addition, calculation of the jaccard coefficient using different levels of the gene ontology  <cit>  instead of kegg resulted in no improvement. the poor performance of the eukaryotic profile is also illustrated by the drastic decrease in number of pathways with significant hypergeometric probabilities, and the low accuracy of predictions even among the significant pathways . these same trends were observed as well when using e. coli as the query organism against euk <dig> 

to ascertain whether this poor performance is a consequence of using homology-based profile generation, as opposed to the use of orthologous definitions, we created profiles using bi-directional best hits, which is a practice commonly used to define orthology  <cit> . no improvement in the correlation between profile similarity and various ontologies was observed when using profiles constructed in this manner. another analysis we performed used profiles constructed from the kog database  <cit> , but using these profiles did not improve results either, although the small number of genomes  used in the construction of groups in kog limits its statistical power for a profile similarity calculation.

possible sources of poor performance in eukaryotic profiling
we found that the poor performance in the euk <dig> organism set is not an artifact of the choice of ontology, and is not circumvented by the use of orthologous gene definitions. therefore we next explored possible evolutionary reasons for the lack of correlation  between profile similarity and pathway membership in eukaryotes. two possible problems are the complex domain architecture of eukaryotic proteins, and insufficient diversity in the currently available sequenced eukaryotic genomes.

using homology-based methods to generate phylogenetic profiles could lead to potential problems in eukaryotic genomes due to the promiscuity of some domains in proteins throughout these genomes. specifically, there could be a significant blast hit into a genome against a protein which shares a common domain with the query, although a true ortholog is not present. by discretizing e-values to account for the degree of similarity it is hoped that some of these problems may be averted as true orthologs will likely receive more significant e-values than domain hits. but the potential for the presence of promiscuous domains to lead to spurious associations still exists, and in order to address this problem we tried limiting our analysis to proteins in s. cerevisiae which had zero or one pfam  <cit>  domains, as described in the methods section. the results show no increase in accuracy by looking strictly for associations among this filtered set. another technique used to circumvent the problem of significant domain hits is to require that the blast alignment cover a predetermined percentage of the sequence of both the query and the target  <cit> . application of this criterion did not affect the results .

a second potential source of the poor results with using profiles composed of eukaryotes is the set of currently sequenced genomes. although the number is large enough to obtain statistically significant associations, it is possible that the available genomes are too clustered on the evolutionary tree to create useful profiles. in other words, the significant associations detected are due to correlations between the genomes, and not between the genes. the existence of correlations in gene content has been discussed previously in literature, and in fact has been exploited in order to reconstruct phylogenetic trees  <cit> . due to the small number of sequenced eukaryotes it is difficult to rule out genome composition as a source of error and a definitive solution will require a diverse set of eukaryotic genomes.

we attempted to get some indication as to whether or not the currently sequenced genome set is a problem by using a metric which we termed clade entropy . clade entropy is a weighted summation of the entropies within each clade, which we used to identify those profiles with high entropy due to selective pressure on the presence of the gene and not the relationship between genomes. we reasoned that if we eliminated profiles with low entropy within clades, we would avoid identifying spurious associations among all genes which may reside within a clade due to a close relationship among the constituent organisms. more specifically, there may be many independent processes which are clade specific, and interactions will indiscriminately be identified both within and between these processes. examining significant relationships among only those profiles above various clade entropy cutoffs resulted in minimal improvement.

although our attempts to account for inadequate genome diversity were unsuccessful, previous research utilizing the structure of the phylogenetic tree while making functional predictions indicates that this may be at least part of the problem  <cit> . barker and pagel performed an analysis in which linkages among yeast proteins were assigned p-values based on having a significantly correlated evolutionary pattern among a set of  <dig> eukaryotic genomes. specifically, the number of times a pair of genes were gained and lost together based on the reconstructed phylogeny was shown to be predictive of functional relatedness. this suggests that profiles composed of eukaryotes may be informative, but the relationship among the constituent genomes convolutes the signal. the question still remains whether there is a genome set which will allow the less computationally demanding profile based methods to successfully predict functional linkages on a global scale.

discussion
the objective of this study was to assess the prospects of applying phylogenetic profiling to eukaryotic organisms. to initiate our study we assessed a number of currently used methods in both e. coli and s. cerevisiae, using profiles composed of prokaryotes. we showed that profiles composed of continuous bit scores perform better in e. coli, while discretized profiles are superior in s. cerevisiae. overall performance is better in e. coli than in s. cerevisiae, which we attributed to the closer relationship of the profile organisms to e. coli. the better performance in e. coli was reflected in both the number of kegg pathways in which a nonrandom percentage of correct functional linkages were predicted, and the prediction accuracy within those pathways. surprisingly, the subsequent incorporation of eukaryotic organisms into the profiles results in a decline in pathway diversity in s. cerevisiae, calling into question the previously published incorporation of eukaryotic organisms into profiles, as has been standard.

we also explored the application of phylogenetic profiling using profiles consisting entirely of eukaryotes. here, we found that there is a much decreased correlation between profile similarity score and common kegg pathway membership, regardless of the profile generation method used. the use of more rigorous gene orthology definitions to create the profiles did not show any improvement in performance, nor did the use of different ontologies.

based on a lack of improvement when examining associations between single domain proteins we ruled out domain complexity in eukaryotic organisms as the sole root of the eukaryotic profiling problem. although this is not the only problem, it is likely that the power law distribution of domains in the proteins of eukaryotic organisms  <cit>  will result in spurious hits when using homology based profiling. an alternative to accounting for the domain complexity in eukaryotes is to take advantage of the variable distribution of domains in eukaryotic organisms and perform profiling using domains instead of whole proteins. given that domains are the functional units of proteins, identifying evolutionary dependencies between domains can yield more general insights into eukaryotic protein evolution. profiling of individual domains in prokaryotic genomes has been implemented previously by pagel et al.  <cit> . its application to eukaryotes, with the caveat of using domain combinations, would be an interesting extension of this work.

a second potential issue with performing phylogenetic profiling on eukaryotic organisms is the lack of an effective set of sequenced eukaryotic genomes. sun, et al  <cit> , showed that there is an optimal set of organisms to be used when profiling prokaryotic organisms and this set has two defining characteristics. one is that organisms are maximally distant from each other, and the second is that the set is large. neither of these criteria is met by the current set, which is relatively small and clustered on the evolutionary tree. information theory suggests that in phylogenetic profiling the optimal signal is attained by using a diverse set of genomes having presence and absence of the genes of interest  <cit> . when the genomes are too clustered it is very difficult to distinguish correlations in the patterns of occurrence of genes from correlations among the genomes. although we attempted to circumvent this problem using a metric to eliminate profiles which had limited diversity within different clades, we cannot rule out an uninformative set of currently sequenced eukaryotic genomes as a problem.

a final possibility, which cannot be addressed until more sequence data is available, is that evolution of eukaryotic genomes precludes the use of phylogenetic profiling on a genome-wide scale. there are several characteristics of prokaryotic genome evolution that make them suitable for phylogenetic profiling. first, functionally related cassettes of genes can be transferred as a unit between organisms, thereby directly maintaining their association in various genomes  <cit> . a second point related to this is that functionally linked genes are often located near each other in prokaryotic genomes. this fact is illustrated by the effectiveness of using patterns of chromosomal proximity to annotate genes  <cit> . due to their chromosomal proximity, genes have an increased probability of being transferred or lost as a unit. the lack of these properties on a global scale in eukaryotic genomes may make the pattern of occurrence of genes less informative. in addition, the more complex regulatory framework in eukaryotes may put less of an importance on the presence of a gene and more on its temporal and spatial occurrence during cellular processes.

the utility of phylogenetic profiling in annotating eukaryotic genomes will not be known for certain until more sequence data becomes available. even if the complexity of eukaryotic genomes makes profiling ineffective on a global scale, it is still likely to be a viable technique in the annotation of particular pathways. previous studies have in fact identified uncharacterized participants in known biological processes by exploiting the knowledge of the phylogenetic distribution of the orthologs of known participants  <cit> . there are sure to be specialized pathways only present in subsets of organisms, and phylogenetic profiling can aid in the identification of their associated genes.

CONCLUSIONS
with the rapid increase in newly sequenced organisms and the need for annotation, automated methods for functional prediction are essential. we focused our attention on the utility of phylogenetic profiling in predicting functional associations in eukaryotic organisms as this has gone largely unaddressed due to the minimal number of sequenced eukaryotic genomes previously available. surprisingly, we found that the most effective organism composition for profiles when predicting functional associations in s. cerevisiae was one consisting solely of prokaryotes. we have discovered that despite their previous use in profile construction, the inclusion of eukaryotic organisms in profiles consisting of a majority of prokaryotes resulted in inferior performance based on the functional diversity of results. furthermore, we have made an initial attempt to apply profiling with a wholly eukaryotic profile to a eukaryotic organism, and shown the results to be extremely poor. these findings have implications in both the optimal genome composition for phylogenetic profiling and indicating possible fundamental differences in the evolution of prokaryotic and eukaryotic genomes, which may limit the use of phylogenetic profiling in annotating eukaryotic organisms. at the very least our results indicate that caution should be used in the naïve application of context based methods, which have been tuned primarily in prokaryotes, to the annotation of eukaryotic genomes.

