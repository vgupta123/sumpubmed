BACKGROUND
a central challenge in the post-genomic era is determining how gene expression is regulated during complex biological processes. hybridization and sequencing-based technologies such as dna microarrays and rna-seq have played a valuable role in identifying and characterizing the components of such processes on a comprehensive scale. moreover, the combination of these technologies with high-throughput methods for studying protein-dna and protein-protein binding has enabled us to glean insights into global networks of interactions  <cit> . with the system components coarsely identified, the challenge now lies in the detailed characterization of how transcription of these large sets of genes changes over time and space during normal cellular processes and in response to perturbation.

however, since existing methods of measuring transcription provide discrete measurements of a transcriptional response obtained from large populations of cells, they suffer from two major drawbacks. first, quantifying transcription dynamics using microarrays at multiple time-points is expensive when long processes are under study. second, despite improvements in assay sensitivity, these approaches typically involve pooling mrna from thousands of cells. the averaged response measured in this way is adequate for classifying different cell or tissue types, but it is not well-suited for studying processes that show cell-to-cell variation, such as cell division, differentiation, or drug responsiveness. recent developments in cell-based assays combined with advances in reporter technology allow us to address these limitations, since expression levels can be repeatedly assayed in single cells. here we describe a method in which we specifically transfect hundreds of clusters of cells with fluorescent reporter constructs and measure single-cell fluorescence changes using automated microscopy.

reverse transfection arrays were first described as a method to introduce mammalian cdna constructs into adherent cells at defined locations  <cit> . since then, the method has been adapted considerably to improve performance and expand its range of applications  <cit> . as any transfectable molecule can be used in this system, reverse transfection studies have been published using cdna  <cit> , sirna/shrna  <cit>  and reporter plasmids  <cit> . however, despite the enormous potential of this method, its use has mostly been centred on endpoint assays. using a novel dual-fluorophore reporter construct, we studied the upregulation of three inducible promoters transfected in  <dig> independent clusters of cells. automated image analysis allows us to segment single cells and quantify their normalized fluorescence intensity. the method is applicable to several cell-types and can be scaled for parallel expression measurements of hundreds of gene promoters. the living microarray provides an in vivo platform for studying complex transcriptional processes such as cell-cycle and cell differentiation, as well as establishing models of transcriptional stochasticity.

RESULTS
construction of the living microarrays
living microarrays use fluorescent reporter constructs to measure the expression of individual promoters in live cells. high throughput parallelization is achieved using a reverse transfection protocol  <cit> , whereby transfection complexes containing reporter constructs are spotted at defined locations on a solid substrate. a monolayer of adherent cells is overlaid and cells adhering to a specific spot become transfected and express a fluorescent reporter protein under the control of the promoter of interest. single-cell expression measurements are then made by segmenting imaged spots and quantifying the amount of intracellular fluorescence using automated image analysis tools .

in our experiments, the array is created using spots with  <dig>  nl transfection complex; these have a 400μm diameter and typically result in  <dig> transfected cells . using a square pattern we can spot 600- <dig> spots within an  <dig>  cm <dig> chambered coverglass slide , though this can easily be doubled by spotting in a checkerboard layout or using a substrate with a larger surface area. the higher throughput represents a significant improvement over existing high-content screening platforms. moreover, since all transfections take place within a single chamber, variations due to plating density, media composition and drug concentrations can be minimized.

to test the suitability of our platform with other cell lines, we tested  <dig> adherent cell lines commonly used as tissue models for disease. we successfully transfected a constitutively active fluorescent reporter  into lines originating from a variety of tissues, including fat, muscle, liver and bone . the reverse transfected cells were spotted on standard glass slides, fixed and imaged on a conventional microarray slide scanner. alternatively, our system uses automated microscopy to serially acquire high-resolution images of live cells at each transfected spot. the scan is repeated continuously to generate time-lapse videos of fluorescence changes for each transfected reporter construct.

while the positions of dried spots can be easily located on the microscope, these boundaries disappear once the slide has been flooded with cells. we therefore developed a method of registering slides on the microscope using the positions of dried spots relative to invariant features at the edges of the slide. to avoid using autofocus routines that are time-consuming and unnecessarily expose cells to potentially damaging light, we also developed a method to determine accurate focus positions for all  <dig> transfected clusters by fitting a subset of  <dig> manually-focused areas to a third-order polynomial function that closely approximates the surface of our slide . these  <dig> focused positions are automatically adjusted at every pass to correct for any drift during the acquisition . in this manner, we have been able to image each transfected cluster of cells every  <dig> minutes over periods as long as  <dig> days.

development of a dual-fluorophore reporter
to measure dynamic changes in transcriptional activity, we used the venus-nls-pest fluorescent reporter  <cit> . this reporter offers several advantages for measuring transcription. first, the venus polypeptide matures  <dig> times faster than eyfp at 37°c and is  <dig> times brighter  <cit> . it is therefore well-suited for measuring dynamic expression changes over time without the long maturation time typically associated with fluorescent reporters. second, the reporter is destabilized by fusion with the pest domain of ornithine decarboxylase, such that it could also measure down-regulation of promoter activity. this modification has been previously shown to reduce the fluorescence half-life of egfp to  <dig> hours in mammalian cells  <cit> . finally, fusion of venus to the sv <dig> large-t antigen nuclear localization signal  allows for signal to be restricted to the cell nucleus, whose regular shape is suitable for automated segmentation of the cells. when placed downstream of an inducible promoter consisting of a three-copy glucocorticoid response element  and the adenovirus major-late minimal promoter , we observed robust induction of venus fluorescence that was comparable in intensity to a commercially-available cytoplasmic destabilized egfp reporter . however, the nuclear localization of the venus signal allows single-cell intensities to be unambiguously determined, particularly for adjacent cells with overlapping cytoplasm .

we automatically measure single-cell expression values by segmenting each frame to identify nuclear boundaries and measure the total pixel intensity within each segmented region . cells are identified using watershed segmentation since it is computationally efficient  <cit>  and performs better on our data compared to global thresholding and contour-based methods, particularly where cells in our images are clustered or the image background is uneven. to evaluate the performance of our segmentation and tracking algorithms, we used a film strip visualization with computationally annotated cell contours and manually examined images for  <dig> single cells transfected with ef1α-vc <dig> over the  <dig> hour time course. of these,  <dig> cells had one or more errors in segmentation or tracking , which corresponds to an error rate of  <dig> %.

to test our venus reporter, we modified the well-known pgl <dig> reporter system by replacing the luciferase gene with a dexamethasone-inducible venus-nls-pest x3-admlp-gv3). 293t cells were co-transfected with this plasmid and a second reporter containing a constitutively active, nuclear-localized dsred  to control for transfection efficiency. single-cell segmentation of cells imaged in venus and dsred channels allowed us to measure a normalized upregulation of cellular fluorescence of  <dig>  fold  after  <dig> hours .

conventional transfection-based reporter strategies typically rely on co-transfected plasmids to normalize signal for variations in plasmid copy number, for instance co-transfection of a plasmid constitutively expressing renilla luciferase while the target signal is detected using photinus luciferase. this approach has been previously used in reverse transfection arrays to normalize spot to spot differences of estrogen receptor alpha transcription in fixed mcf- <dig> cells  <cit> . however, our data indicates that it is not feasible to co-transfect a reporter plasmid to normalize gene expression in single cells, since it results in a variable partition of plasmids among cells. even in highly transfectable cells , co-transfection of our venus-nls-pest reporter with cmv-dsred-nuc resulted in only  <dig> %  of image pixels having overlapping signal from both fluorophores .

we therefore cloned downstream of venus a cassette containing ecfp driven by the human ef1α promoter  and transcriptionally insulated the two genes using the poly-adenylation signal from the pgl <dig> vector. the ef1α promoter is constitutively active in mammalian cell lines, but it is not subject to spontaneous down-regulation like high-level viral promoters such as the cmv immediate early promoter-enhancer  <cit> . as with venus, we fused ecfp to the sv <dig> nls to allow for more accurate quantification of total cellular fluorescence. information from this channel provides three major benefits. first, it allows us to measure relative differences in plasmid concentration between cells. second, the constitutive ecfp signal is useful for segmenting and tracking cells in which venus signal is expressed below detectable levels. third, since the distribution of ecfp pixels is the same as for venus, this channel allows us to normalize for other sources of variability, such as morphological changes and lamp fluctuations.

single-cell transcriptional measurements of inducible promoters
to test our system, we subcloned three inducible promoters into the multiple-cloning site of venus-ecfp <dig> . these promoters contain three copies of consensus response elements for the glucocorticoid receptor  or the retinoic acid receptor  cloned upstream of the admlp minimal promoter. a third reporter was also created using the tetracycline-inducible promoter from the commercially-available ptre-tight-bi vector. each construct, along with positive and negative controls, was reverse transfected in  <dig> replicate spots into 293t cells in triplicate assays. following transfection, the cells were treated with the appropriate ligands and activity of the fluorescent reporters was measured over a  <dig> hour period. each transfected cluster was imaged every  <dig> minutes, resulting in  <dig> time-lapse videos of  <dig> frames in length. approximately  <dig> individual cells were automatically segmented and quantified in each image  and were used to calculate average expression values for each construct over time.

we observed induction of venus transcription for all three synthetic reporter constructs, while the expression levels from the normalization channel remained relatively constant . the x3-admlp-vc <dig> construct was upregulated  <dig>  fold  over  <dig> hours  which is consistent with the published literature  <cit> . this level of induction matches that measured in our single-fluorophore vector x3-admlp-gv <dig>  demonstrating that the further modifications brought about in vc <dig> do not alter reporter activity . in comparison, our promoterless vector  showed no change in expression over  <dig> hours . efficient induction was observed for both the x <dig> and tetre reporters when cotransfected with their respective transcription factors , as well as for the x <dig> reporter, which is regulated by endogenously expressed retinoic acid receptors.

our measurements of gene expression were obtained using data from  <dig> replicate spots. to determine the minimum number of replicate spots that would accurately measure the sample mean and variance, we used a permutation strategy in which the data was segregated into subsets of a fixed number of randomly chosen spots and repeated this process  <dig> times for subsets of between  <dig> and  <dig> spots. the distribution of means from these subsets at the  <dig> hour timepoint was then compared to the actual distribution for  <dig> transfected spots. we found that samples with  <dig> replicates had a standard deviation that was within  <dig>  standard deviations of the population standard deviation.

these endpoint measurements are analogous to existing methods that average responses between cells, such as rt-pcr, dna microarrays and reporter assays. however, in addition to being able to measure average expression changes, single-cell measurements provide a wealth of information that can be used to better characterize signal variability between cells. using the signal from our ecfp cassette, we were able to study the single-cell distribution of responses with respect to transfection efficiency . data from the ef1α-vc <dig> positive control, where each fluorophore is driven by the ef1α promoter, showed that signals from both fluorophores are correlated , indicating that cells transfected with more copies of plasmid  show a greater level of reporter fluorescence. among the inducible constructs, the ecfp signal allowed us to quantify the relationship between plasmid copy number and peak reporter activity in inducing cells . our data suggests that there exists a large degree of signal variability underlying each static point obtained from pooled methods. for instance, although the average venus induction in cells transfected with x3-admlp-vc <dig> was  <dig>  fold, segmentation of  <dig>  transfected cells indicates that  <dig>  cells  induced less than  <dig> fold, while a small number of cells  showed very large responses . this observation was reproducible across three separate passages of cells .

single-cell tracking of inducing cells
the single-cell population endpoint measurements could also be obtained using other technologies, including two-color flow cytometry. a distinct advantage of the living microarray system is that expression changes in individual cells can be tracked over time by linking single cells in consecutive frames. we observed that fluorescent proteins tend to concentrate within sub-nuclear regions, such that each cell has a characteristic appearance that remains relatively constant between frames. we exploited this feature to track each cell over time based on its appearance and position . more dramatic changes in appearance, such as when cells are occluded, are handled by a flexible linking step that joins tracks based on cell position and intensity. since our experiments typically generate large amounts of data , we implemented our segmentation and tracking algorithms to analyze each field separately, such that computation time can be shortened by using parallel computing.

these steps result in a set of tracked cells per field, where each track contains information about the cell's position, intensity and shape over time that can be visualized in many ways. for instance, each cell's position and intensity from a single field can be imaged as 3d trajectories inside a spot-centred space-time volume , such that the dynamics of single-cell expression changes can be viewed in relation to its mobility, its division events or its neighbours. among cells that showed the strongest induction , we observed 10-fold greater induction compared to pooled measurements  with coefficients of variation of  <dig> % for x3-admlp-vc <dig>  and  <dig> % for x3-admlp-vc <dig> . moreover, single cells with different levels of transfection can be compared by normalizing the venus signal with signal from the ecfp channel . among cells that showed the strongest induction , this resulted in an expression plot with a shape and distribution similar to the uncorrected venus signal. however, normalizing the signal for transfection efficiency resulted in a change in the rank order of the cells at the 24-hour timepoint, such that poorly transfected cells were prioritized.

the ability to track single cells allows us to extend population measurements by evaluating the dynamics with which a given cell will change its expression in response to a stimulus . moreover, our image-based assay can recover the appearance of the cells over time and display these as single-cell image strips. while we had observed substantial heterogeneity in the extent of the response to induction, this view shows additional variation in the timing of venus expression among cells that fully induced . compared to methods that only examine responding cells, our platform enables each inducing or un-inducing cell's history to be viewed in relation to its size and morphology . this is a feature that could be particularly powerful when examining processes involving changes in cell shape, such as cell division and differentiation.

discussion
we have described the development of a high-throughput platform capable of measuring transcriptional dynamics for many genes in large numbers of single cells exposed to the same experimental conditions. existing methods for measuring gene regulation, such as dna microarrays and chromatin immunoprecipitation, have excelled at identifying members of transcriptional networks and the interactions that occur between them at specific points in time. however, these techniques acquire data from homogenized samples derived from populations of cells and cannot provide accurate temporal and spatial resolution at a scale appropriate to characterize time-dependent transcriptional responses  <cit> .

here we used a high-throughput cell-based assay to specifically transfect hundreds of constructs into adherent cell lines and tracked each fluorescent cell over  <dig> hours. we adapted the technique to use reporter constructs, so that changes in transcription from different promoters could be assessed at single-cell resolution. in its current form,  <dig> spatially distinct clusters of cells can be specifically transfected in a single chamber. this removes many sources of well-to-well variability that are frequently associated with high-content screening, such as differences in seeding density, ligand concentration and temperature.

using the ecfp channel provides an internal control that enables single-cell normalization of the target promoter activity levels without requiring co-transfection. tracking uninduced cells was also possible using this channel, such that we could investigate each cell's history during the experiment. as with the venus reporter, destabilizing the ecfp protein by fusing it to a pest domain could provide a more sensitive method of detecting loss of the plasmid and relating this to variability in the venus channel.

despite identifying several cell lines suitable for our platform, we determined that a subset of lines  either did not grow as monolayers or could not be transfected at high enough levels to be used . viruses offer an attractive alternative to transfection-mediated delivery of dna into cells that are difficult to transfect, particularly primary cells. previous studies using vsv-g lentiviruses  <cit>  and more recently adenoviruses  <cit>  have demonstrated the feasibility of the reverse infection approach that would be compatible with our live cell techniques. expressing the reporter from a single integration site would provide the added benefit of removing reporter variability from differences in plasmid copy number between cells. moreover, adenovirus systems can accommodate larger insert sizes compared to retroviral ones, such that our dual fluorophore vector could be re-used.

the measurement of single-cell expression offers much potential and has been studied using other methods, such as the dynamic proteomics approach  <cit>  where coding sequences are randomly fused to an eypf cassette in their endogenous context. the primary advantage to this technology is that expression can be studied from a single-copy integrant that would presumably retain the endogenous regulation of the gene at both the transcriptional and translational levels. however, a significant disadvantage of the method is that specific genes cannot be targeted using this method, as it generates a library of randomly integrated yfp cassettes that subsequently requires extensive screening. the maintenance of multiple cell lines, each harbouring a different yfp-tagged gene, is also a limitation that is addressed in our method, where the expression of hundreds of genes can be studied in parallel within a single well.

the living microarray platform can be applied to many systems. expanding the number of synthetic reporters could provide parallel measurements for the activities of dozens of transcription factors in response to various stimuli, as has been shown with pooled measurements of sequencing and luciferase-based reporters  <cit> . the technology could also be used to identify genomic regulatory sequences. given the high-throughput nature of this technology, it would be possible to screen large regions of non-coding dna for transcriptional activity by generating a library of reporters from tiled pcr products. in particular, this approach could be useful for validating putative regulatory variants from genome-wide association studies. constructing a living microarray with known promoters could also profile complex processes, for example in studying the transcriptional changes that occur during the cell cycle  <cit> , where temporal profiling of transcription in mammalian cells has been limited to microarray analysis using pooled rna from synchronized cultures  <cit> . such studies suffer from limited time resolution and fail to capture cell-cell variability or the heritability of expression patterns over successive generations. moreover, chemical synchronization of cells may introduce spurious expression patterns in addition to only being partially effective  <cit> . a recent report performed genome-wide sirna knockdowns in reverse transfection microarrays and scored the phenotypes of the transfected clusters by computationally classifying time-lapse images of cytoplasmic and nuclear fluorophores during mitosis  <cit> . in this way, hundreds of genes were identified as being required for the cell cycle. an attractive extension to these findings would be to construct a living microarray with reporters for these genes to precisely map their temporal regulation.

gene expression is an inherently stochastic process, both within single cells and among cells of a population, owing to the many sources of intrinsic and extrinsic noise  <cit> . for instance, clonal populations of mouse haematopoietic stem cells display heterogeneity in transcriptional profiles; these differences in genetically identical cells are responsible for each cell's propensity to differentiate into myeloid or erythroid lineages  <cit> . cell-fate decisions, such as pheromone switching in isogenic yeast, can also arise from heterogeneity that is more related to the individual cell's signal transmission and expression capacities, rather than on random fluctuations in gene expression  <cit> . nuclear receptor signaling is an ideal model for studying dynamic transcriptional processes, since the timing of induction can be tightly controlled. we found considerable variability in response at the single-cell level that is consistent with previous reports using single-cell measurements. for instance, reporter studies on the gh gene promoter revealed that when activated, only 25% of cells displayed a sustained response, while 50% showed only a transient one and 25% were not induced at all  <cit> . single-cell studies of the prolactin promoter in pituitary cells have indicated that the apparently stable transcription rate in a population may represent the overall sum of dynamically variable patterns of promoter activity among the individual cells  <cit> . this suggests that within populations of cultured cells , there exists a mixture of cells that have different capacities to respond to external stimuli. whether this heterogeneity reflects the presence of distinct subpopulations of cells, or results from normal fluctuations in cell physiology  are questions that merit further investigation.

CONCLUSIONS
the advent of high-throughput methods for measuring changes in gene expression has facilitated the study of biological systems as a whole , rather than on the discovery and characterization of its individual components   <cit> . however, deep understanding of a complex dynamic system requires an examination of the dynamics of individual components during normal function or following perturbations  <cit> . the living microarray platform is a step towards creating a more comprehensive platform for furthering our understanding of dynamic cellular processes at the systems level, as it provides the ability to make parallel high-throughput measurements of transcriptional changes in single cells.

