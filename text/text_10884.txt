BACKGROUND
the development of microarray technologies to assess dna copy number  changes was triggered by the fact that genomic alterations are hallmarks of gene deregulation and genome instability in cancers  <cit> . among these technologies, genotyping microarrays  <cit>  quantify not only total copy numbers  but also contributions of each allele to tcn. besides providing additional evidence for changes in tcn, allelic signal estimates can help pinpoint regions of allelic imbalance  that cannot be identified from tcn alone, such as regions of copy-neutral loss of heterozygosity , or regions that are hard to detect from tcn.

in this paper we present the tumorboost method for normalizing raw allelic signals of a tumor tissue given raw allelic signals of a matched normal tissue or blood extract. by "raw" we mean after preprocessing, but before detection of copy number events.

the result of applying tumorboost is shown in figure  <dig> for two chromosomes in the same individual from a pair of matched tumor-normal samples. the top row displays observed tcns , that is, ratios of total  signal intensities in the tumor relative to the normal. the other three rows display allelic signals as allele b fractions , that is, the proportion of total signal that comes from allele b. this quantity has been used in cancer studies to detect ai  <cit> . both c and β are formally defined in section 'observed summarized allele-specific signals'. the second and third rows display raw values of β for the normal and the tumor, while the last row displays tumorboost-normalized values of β for the tumor. the copy number changes observed in this figure will be interpreted in terms of normal, gained, deleted, and copy neutral loh regions in section 'notation and motivation' and in section 'change points and regions of interest'. already from a visual comparison it is clear that the signal-to-noise ratio  is greatly improved after normalization, which makes it easier to identify and locate cn events using existing detection methods  <cit> .

the outline of this paper is as follows. in section 'methods', after providing the necessary notation, we describe the tumorboost method and its algorithm and implementation. we then describe the data sets used and propose methods to evaluate the performance of tumorboost. in section 'results' we formally demonstrate that cn events are detected with a greater sensitivity and specificity when allele b fractions are normalized using tumorboost. at the end, in section 'discussion', we mention a dual interpretation of our method, connect it to related works, discuss possible extensions, and give future research directions, before concluding the study in section 'conclusions'. the acronyms used in the paper are summarized in section 'list of abbreviations'.

methods
notation and motivation
parental and total copy numbers
we define the  parental copy number  as the number of copies of each of the two parental chromosomes . formally, we denote the unphased pcn, or pcn for short, for sample i ∈ { <dig>  ..., i} at locus j ∈ { <dig>  ..., j} by , with cij <dig> ≤ cij <dig>  cij <dig> and cij <dig> are called minor and major cns, respectively. the true tcn is then cij <dig> + cij <dig> 

in a region with no chromosomal aberrations, the true pcn is constant . consider a non-contaminated homogeneous tumor. in a chromosomal region that is diploid , the true pcn is ; it is  for a hemizygous deletion,  for a homozygous deletion,  for a single gain, and  for a copy-neutral loh.

we wish to emphasize that this paper is not about estimating the true pcn levels or proposing a new copy number change point detection method, but about improving preprocessing in order to enhance the power to detect changes in underlying pcn states using existing change point detection methodologies.

observed summarized allele-specific signals
in practice we do not observe regions but individual probes, and for these probes we cannot observe pcns but only total or allele-specific signals. specifically, genotyping microarrays target a large number of single nucleotide polymorphisms , currently of the order of  <dig> for the latest generation of the two most popular assays, affymetrix's oligo-nucleotide arrays and illumina's bead arrays.

allele-specific snp signals
we assume that normalization and preprocessing of probe-level data have already been done using one of several existing methods  <cit> . for hybridization i and snp j, we then have summarized allele-specific snp intensity estimates .

total intensities and allele b fractions
a convenient alternative representation of these signals is , with   

where θij is referred to as the total  snp signal  <cit>  and βij as the allele b fraction. the latter is also known as the allele b frequency   <cit>   and as the allele ratio   <cit> . a closely related quantity is the relative allele score   <cit> . in  <cit> , the authors defined the raw allele a proportion , which is  <dig> - β. the above transform from  to  is bijective, except for the rare case when θij =  <dig> 

it is interesting to note that the total snp signals {θij} in equation  are comparable to the signals obtained by non-polymorphic markers, which exist on the recent affymetrix and illumina arrays, and for which allele b fractions are not defined.

total and allele-specific copy numbers
as affymetrix and illumina are single-sample technologies and there exist large locus-to-locus variation in total snp signals, it is not feasible to infer cns from a single hybridization. therefore, the observed tcn cij for sample i and snp j is calculated relative to the total snp signal of a reference r, as   

where θrj is the total snp signal in reference r, with the true tcn assumed to be two for a diploid snp.

allele-specific copy numbers , , can be calculated analogously:   

while the observed tcn is cij = cija + cijb.

paired tumor-normal designs
in this paper, we focus on the experimental design where both a normal and a tumor sample are available for a given individual. from the corresponding two hybridizations, we obtain the total copy number in the tumor relative to the normal , and allele b fractions for the tumor  and the normal  as   

in a region of no copy number alteration, the true tcn is  <dig> and the true allele b fraction, denoted by μ, is either  <dig>  1/ <dig> or  <dig>  where  <dig> and  <dig> correspond to homozygous genotypes aa and bb, and 1/ <dig> corresponds to the heterozygous genotype ab. this is why allele b fractions in a normal sample  are expected to have three bands, as observed in the second row of figure  <dig> 

because of copy-number changes, the true allele b fractions  of a tumor can take different values in  <cit> , not only { <dig>  1/ <dig>  1}. we next illustrate this point by giving an interpretation of the chromosome  <dig> regions observed in figure  <dig>  the region from  <dig> to  <dig> mb on chromosome  <dig> is normal, that is, the true pcn is  yielding that the true tcn is  <dig> and true allele b fractions are in { <dig>  1/ <dig>  1}. the region from  <dig> mb to  <dig> mb has gained one or more copies. assuming a single-copy gain, so that the true pcn is , then the true tcn is  <dig> and there exist four possible ascn states corresponding to the two possible allocations of each parental allele: {aaa, aab, abb, bbb}. the corresponding true allele b fractions are therefore { <dig>  1/ <dig>  2/ <dig>  1}. the region from  <dig> mb to the end of chromosome  <dig> is a region of copy neutral loh, where the true pcn is  yielding true tcn is  <dig> and true allele b fractions in { <dig> }.

importantly, because of normal contamination, that is, the presence of normal cells in what is called the "tumor sample", we observe an unknown mixture of cn signals from tumor and normal cells, which reveals itself both in the observed tcns and the observed allele b fractions. as further described in section 'normal contamination and its impacts', as well as in  <cit> , this explains why we observe four bands for βt instead of two in a region of loh. among other things, normal contamination also explains why the mean levels of the observed bands deviate from the expected levels of a pure tumor. see also  <cit>  for discussions on normal contamination.

distinction between genotypes and ascns
in this paper we will use the terms genotype, homozygous and heterozygous only when referring to snps in a normal sample. in a tumor sample, which may be contaminated by normal cells or other types of tumor cells, the true allele b fractions  are not necessarily in { <dig>  1/ <dig>  1}. because of this, we instead use the term true allele-specific copy number  for tumors .

a systematic genotype-specific snp effect
from figure  <dig>  there is considerable variation along the genome in both βt and βn, even for a normal sample where the true allele b fractions are either  <dig>  1/ <dig> or  <dig>  figure  <dig> provides another representation of this data, showing scatter plots of raw allele b fractions in the tumor against the normal sample. each point corresponds to a snp, and each panel corresponds to a region with constant cn level  in figure  <dig>  snps called homozygous  are in gray.

the fact that the observed values differ from the true ones -  <dig>  1/ <dig> or  <dig> in a region of no copy number alteration in the tumor  - is an indication of a snp effect δ, which is not taken care of by preprocessing. we formally define this snp effect for snp j in sample i as the deviation   

between the observed and true allele b fractions. the fact that the observed values extend along the diagonal provides evidence that this snp effect is reproducible between the normal and the tumor, that is, δtj and δnj are positively correlated.

in a region of copy number alteration in the tumor , the true allele b fractions are still  <dig> and  <dig> for homozygous snps, but they deviate from 1/ <dig> for heterozygous snps, as explained above. for example, in a region where one copy has been gained , a snp which is ab in the normal will be aab or abb in the tumor, so that the true allele b fractions are either 1/ <dig> or 2/ <dig> for heterozygous snps in absence of contamination by normal cells. this explains why we are observing two clouds of heterozygous snps instead of one. however, due to the presence of normal cells in the tumor sample, the observed clouds of points are shrunk toward 1/ <dig>  which is the true allele b fraction in the normal.

normalization of allele b fractions
for any given snp j, we can estimate the snp effect  in the normal sample as   

where  is the estimated normal genotype of snp j, that is, either  <dig>  1/ <dig> or  <dig>  genotype calling is discussed in section 'calling normal genotypes'. we define tumorboost-normalized allele b fractions in the tumor as   

where  is an estimate of the snp effect in the tumor sample, depending on the  genotype, as follows.

for homozygous snps , the observed allele b fractions extend along the diagonal βt = βn, regardless of the underlying cn state. therefore, a natural estimate of the snp effect in the tumor is , which yields the following expression for normalized allele b fractions:   

for heterozygous snps , estimating δtj as  would lead to overcorrecting allele b fractions. indeed, the slopes of the regression lines for the heterozygous clusters in figure  <dig> are less than one in regions of copy number alteration, as illustrated by the comparison with the gray diagonal lines. therefore, we estimate the snp effect in the tumor as , where  <dig> ≤ ηj≤  <dig> is a scale factor set to βtj/βnj if βtj ≤ βnj, and symmetrically as / if βtj >βnj. as a result, we normalize allele b fractions for heterozygous snps as   

note that normalizing the normal sample using these equations, if done, would lead to , which means that the snp effect would be removed completely from the normal. note also that the tumorboost method  & ) is applied, not only to each tumor-normal pair independently, but to each snp independently, which also explains the choice of ηj. in particular, it does not require prior knowledge about cn change points and cn regions.

total cn signals are not normalized
by design, the proposed method does not adjust non-polymorphic signals  or total cns , neither for snps nor for non-polymorphic cn loci - it corrects only for systematic effects in the tumor allele b fractions , which by definition exist only for snps. this means that change point detection methods operating solely on tcns, will identify the same cn regions regardless of tumorboost. only methods utilizing also allele b fractions that will gain from tumorboost correction.

calling normal genotypes
tumorboost normalization relies on normal genotypes in order to call a snp homozygous or heterozygous. several methods  <cit>  already exist that provide high-quality genotype calls. these are multi-sample  methods that leverage the accuracy of the calls by using a large pool of reference samples and/or prior parameter estimates. in case such calls are not available, but also in order to make our method applicable to a single tumor-normal pair, we introduce the following "naive" genotyping algorithm. for each autosomal chromosome in a given normal hybridization, we define genotype classes by thresholding βnj at the two local minima of the empirical density of {βnj}. we estimate this density using a gaussian kernel estimator. examples of such density distributions for diploid snps can be seen in the left panels of figure  <dig> . for sex chromosomes that are not diploid, the number of genotype classes and thresholds are adjusted accordingly. all snps are genotyped using the same thresholds.

a pipeline for a single tumor-normal pair
by using an allele-specific version of the single-array crma v <dig>  <cit>  preprocessing method for affymetrix snp & cn arrays in combination with the tumorboost method and the above naive genotyping algorithm, the complete pipeline is applicable to a single pair of tumor-normal hybridizations. to emphasize this, note that the affymetrix-based signals in all figures of this paper are based on two hybridization  only, without utilizing external references or prior parameter estimates.

analogously to crma v <dig> for affymetrix, the  "xy normalization" method available in the beadstudio software  <cit>  can be used to process individual illumina hybridizations.

being able to process a single tumor-normal pair at the time, independently of others, has several implications:  each tumor-normal pair can be analyzed immediately without needing reference samples,  lab and/or batch effects are less of a concern as long as the tumor and normal samples are processed in the same batch,  samples from different individuals can be processed in parallel on different hosts/processors making it possible to decrease the processing time of large data sets, and  contrary to multi-sample methods, there is no need to reprocess the samples from a given individual when new samples are produced, which further saves time and computational resources. furthermore,  the decision to filter out poor quality samples can be postponed, because such samples will not affect the processing of other samples. more importantly, a method applicable to a single tumor-normal pair is  more practical for applied medical diagnostics, because each patient can be analyzed at once, even when they come singly rather than in batches. this may otherwise be a limiting factor in projects with a large number of samples, or, conversely, in projects with a very small number of samples.

algorithm and implementation
the tumorboost normalization method is available in the aroma.cn package and crma v <dig> is part of the aroma.affymetrix package  <cit> , implemented in r  <cit>  running on any operating system. both are open source and available via the aroma project , where further documentation exists. the method can be inserted as a normalization step in most preprocessing pipelines, and both low-level and high-level implementations are available. the algorithm is designed to have bounded-memory usage, regardless of the number of samples/arrays processed. furthermore, the complexity of the algorithm is o, i.e. linear in the number of snps. the tumor-normal pairs can be normalized in parallel on multiple hosts/processors. both tumorboost and the naive genotyping method apply to estimates obtained by any genotyping microarray technology.

data sets
we used data from the cancer genome atlas  project  <cit> , a collaborative initiative to better understand several types of cancers using existing large-scale whole-genome technologies. from the data coordinating center , we downloaded  data for a set of ovarian  and a set of brain  tumor-normal pairs. for affymetrix genomewidesnp_ <dig>  we downloaded the raw data , and estimated  using an allele-specific version of crma v <dig>  <cit> , where the probe summarization step is done for each allele separately instead for the total signal. for this platform, we also downloaded data summarized by the rma/median-polish pipeline  to illustrate the results of using tumorboost with other preprocessing methods . to assess the impact of naive genotyping on tumorboost normalization, we downloaded the birdseed  <cit>  genotype calls.

for illumina, we downloaded the xy-normalized and summarized data  containing  as calculated by the illumina beadstudio software  <cit> . in addition, in order to compare the results from using truly single-sample ascn estimates with those using optimized population-based estimates  <cit>  , we downloaded the allele b frequency data  for the ovarian data set.

evaluation methods
change points and regions of interest
we have evaluated the tumorboost method on a large number of the downloaded samples as well as on other data sets . however, for the purpose of illustrating our method, we will focus on chromosomes  <dig> and  <dig> of ov sample tcga-23- <dig> based on affymetrix genomewidesnp_ <dig> data . results based on illumina human1m-duo data and other preprocessing methods are available in the additional files  <dig>   <dig>   <dig>   <dig>   <dig>   <dig> 

for completeness, in order to illustrate the performance of tumorboost on a different tumor type and different platform, the results of an evaluation of tumorboost sample tcga-02- <dig> are given in additional files  <dig>   <dig>   <dig>   <dig>  this is a gbm tumor which has been assayed by affymetrix genomewidesnp_ <dig> and illumina humanhap <dig> 

the evaluation is done at four different allele b fraction change points corresponding to four common pcn-state transitions, and at one region with no change point  as summarized in table  <dig>  it is worth noting that the general conclusions of this study will be the same whether the true underlying pcn states are known or not. however, in order to simplify the discussion we choose to label the states and propose the following biological interpretation.

each change point, covered by a  <dig>  mb safety region, separates two unique pcn regions . the change points on the same chromosome share parts of the same pcn region. all lengths are in units of mega base pairs .

for chromosome  <dig>  we believe that the tumor has  gained a region from  <dig> mb to the end of the chromosome, and  lost the other parental chromosome from  <dig> mb to the end of the chromosome. as a result, we observe a region with two pcn change points: n/g between the  normal region and the  gain, and g/l between the  gain and the  copy-neutral loh region. for chromosome  <dig>  a possible scenario is that the tumor has  lost a region from  <dig> mb to the end of the chromosome, and then  gained the other parental chromosome from  <dig> mb to  <dig> mb. as a result, we observe a chromosomal region with two pcn change points: n/d between the  normal region and the  deletion, and d/l between the  deletion and the  copy-neutral loh region.

detecting cn events from allelic signals
mirrored allele b fractions
detecting pcn changes using {βij} is not straightforward because its distribution has up to four modes in a given ascn region . however, as the distribution of {βij} is expected to be symmetric around the heterozygous band, it is convenient to work with mirrored allele b fractions: |βij - 1/2| as defined in  <cit> . note that this quantity is also related to the folded baf in  <cit>  and to the observed major copy proportion  defined by  <cit> . the tumorboost-normalized version of this quantity is given by ||.

decrease in heterozygosity
although tumorboost corrects allele b fractions for all snps, it is typically only heterozygous snps that are used for downstream pcn analyses, as they carry all the information regarding ai  <cit> . we define the decrease in heterozygosity  in the tumor sample for a heterozygous snp j as   

dh is close to zero when there is balance between the alleles and parental chromosomes , and deviates from zero when there is ai, e.g. dh is close to one in a region of loh if it is a pure tumor. the tumorboost-normalized version of dh is defined  by   

by equation . note that in this setup the essence of tumorboost lies in the difference |βtj - βnj| with a correction factor. in  <cit> , the authors briefly mention  that "the allele frequency difference between normal and tumor genotypes is very distinct", unfortunately without further discussion. independently, we have found that a normalization that leaves out this correction factor also improves the power to detect pcn change points with respect to raw dh, but is suboptimal because it overcorrects allele b fractions for heterozygous snps, as explained in section 'normalization of allele b fractions' above. in a region of constant pcn, the distribution of decrease-in-heterozygosity signals  has at most two modes, and at most one if only heterozygous snps are considered. the latter property makes it possible to use existing segmentation methods originally proposed for total cn analysis  <cit>  to detect pcn changes  <cit> .

inspired by how these segmentation methods work, we propose an evaluation framework that quantifies the power to detect a pcn change point from {ρtj} and {}. analogously to  <cit> , we assume that we know the location of a pcn change point with high precision and that there exist no other change points nearby. to protect ourselves against errors in the location, we add a safety margin on each side such that the true location is within the safety region with high confidence . furthermore, we assume that the change point, together with the safety region, separates two flanking regions with constant parental copy numbers pcn <dig> and pcn <dig>  we know that the true decrease in heterozygosity differs between regions but not within regions. differences observed within a region are assumed to be due to random errors. by comparing the dhs for heterozygous snps in the two regions, we can assess if they differ and if so, by how much.

testing for equal mean levels
the simplest way to test whether {ρtj} for the two regions originates from the same class of pcns or not is to use student's t-test to test if the means of the heterozygous snps are equal. this is also the most common test used by existing segmentation methods. we calculate the t statistic for each change point in table  <dig>  where a false change point  has been added as a negative control. we also calculate the t statistic based on the total cns for the same heterozygous snps as are used for the allele b fractions. non-polymorphic loci are not considered as they are not affected by the tumorboost method.

as the t statistic depends on sample size, and as different regions have different sizes, the test statistics may not be comparable across regions and methods. we therefore sampled a fixed number of heterozygous snps for each method and each region . because the observed t statistic depends on the sampled data points, we use bootstrap techniques  to estimate the mean and standard deviation of each test statistic.

roc curve analysis
an alternative is to assess how well the two regions on each side of the change point separate. for each change point, heterozygous data points  are annotated as belonging to either of the two cn states. in order to control for sample-size effects, we balance the number of true positives and true negatives, by sampling so that both regions have the same number of data points. in order to control for the fact that different genotyping methods yield different numbers of snps called heterozygous, we also constrain the number of data points sampled to be the same when comparing results involving different genotyping methods. next, we use receiver operating characteristic  analysis to assess how well raw and normalized dhs discriminate the two states studied. this evaluation is done on full-resolution  as well as smoothed signals, where dhs are averaged  in non-overlapping bins of h =  <dig> and h =  <dig> data points per bin. we will return to the smoothed cns in section 'influence of genotype calls on normalization' when discussing sensitivity to genotyping errors. for each comparison, we define the "positive" state as the state with tcn different from two. a similar approach was used in  <cit>  for assessing total cn separation.

robustness against genotyping errors
as genotypes are used for tumorboost normalization, the performance of our method depends on genotype quality. to assess tumorboost's sensitivity to errors in genotype calls, we also use genotype calls from population-based methods: birdseed  <cit>  for affymetrix data, and beadstudio  <cit>  for illumina data. like most available methods for detecting cn changes using dh, our evaluation itself focuses on heterozygous snps, which makes it depend on the genotyping algorithm. for consistency, tumorboost-normalized dhs are evaluated based on the same genotyping method as was used for normalization. the evaluation of raw dhs is done using the best genotyping method. genotyping errors are discussed further in section 'influence of genotype calls on normalization' and section 'influence of genotyping errors'.

normal contamination and its impacts
as with many tumor samples, tumor tcga-23- <dig> is also contaminated with normal  cells. as a result, we do not observe only two but four homozygous allele b fraction bands in loh regions .

for simplicity, assume that the tumor sample contains one type of tumor cells contaminated with normal cells so that the proportion of tumor cells is κ ∈  <cit>   and the proportion of normal cells is  <dig> - κ . we also assume that the average tumor ploidy is two . then, in a tumor region where the true pcn is given by , the true decrease in heterozygosity for heterozygous snps  <cit>  is   

if we assume that the variance of dh is independent of its mean level, then the power to detect a change point in dhs, using a t statistic, is a linear function of the absolute change in its true value,   

which is a function of tumor purity , parametrized by the true pcns  of the two flanking regions. in figure  <dig>  this difference is plotted as a function of tumor purity for each of the four change points in table  <dig>  interestingly, although it is in most cases easier to detect a pcn event the more pure the tumor is, this is not the case when the remaining parental chromosome in a deleted region is duplicated . in that case, the difference is greatest at κ =  <dig>   and decreases to zero toward κ =  <dig> and κ =  <dig>  note that equations - hold provided that there are no additional biases in the allele b fractions. however, because of incomplete offset correction  <cit> , differences in platforms  <cit> , and differences in preprocessing methods, the mean levels of the allele b fractions are almost certainly biased, even after normalization. thus, we only claim that tumorboost removes systematic effects across snps but we do not claim to control for the mean levels. this is why we use the term "normalization" rather than "calibration"  <cit> . however, as we will see later, although there may still be a global bias in the allele b fractions, the relative ordering suggested by equations - is still preserved. we also want to emphasize that this paper is neither about estimating the true pcn levels nor about estimating tumor purity. the main objective is to improve the signal-to-noise ratios such that change points are better detected.

RESULTS
improvements from applying tumorboost
the improvement in snr is also illustrated by the comparison between allele b fractions before and after normalization along chromosomes  <dig> and  <dig> in figure  <dig> . however, we note in this figure that tumorboost does introduce a few outliers in regions of decreased heterozygosity in the tumor: after  <dig> mb in chromosome  <dig> and after  <dig> mb in chromosome  <dig>  these outliers are due to genotyping errors. they are discussed in detail in section 'influence of genotype calls on normalization', where we show that they are of second order when compared to the gain achieved by tumorboost, and in section 'influence of genotype calls on normalization', where we demonstrate how they can be avoided by existing downstream change-point detection methods.

because the snr increases for each pcn region, it is possible to argue that the snr for the difference between dhs in regions flanking a change point also increases making it easier to detect this change point. figure  <dig> and figure  <dig>  in which dhs before and after normalization are plotted for each change point investigated, confirm that this is the case, at least for the change points n/g, g/l and n/d. to quantify this, we applied a t-test for each change point with the null hypothesis that the mean dh levels are equal in the two flanking regions, as described in section 'detecting cn events from allelic signals'. the t statistics in table  <dig> demonstrate that tumorboost normalization greatly improves the power to detect pcn events using dhs. the test statistics are larger after normalization than before, both when naive and birdseed genotype calls are used. we also find that the changes are within the error limits for the negative control. these conclusions also hold for data from the affymetrix platform summarized using the rma/median-polish pipeline, and for data from the illumina human1m-duo platform .

 greater mean values correspond to greater power to detect a change point. raw  and tumorboost-normalized  dhs, and tcns .

these findings are further confirmed by the roc analyses of the four change points at the full and the smoothed resolutions, as summarized by the roc curves in figure  <dig> and figure  <dig>  specific points raised by these results are addressed in the following sections.

influence of genotype calls on normalization
in general, the influence of the genotyping method is of second order: the results obtained when using naive genotyping are almost as good as when using more elaborate  genotype calls. this result holds regardless of the normalization and summarization method . for affymetrix data preprocessed using crma v <dig>  this can be seen by comparing the corresponding roc curves in figure  <dig> and figure  <dig> and by comparing the rows of table  <dig>  however, we note that for the g/l change point, normalization based on the former does worse than not normalizing if the false-positive  rate of an average snp is required to be small enough, i.e. here fp rate ∈ . the reason for this is that there exists a set of false positives  that are due to genotyping errors - truly homozygous snps are incorrectly identified as heterozygous by the naive genotyping method. these outliers can be spotted in the non-normalized dh track in figure  <dig> 

however, as these false positives are individual snp scattered along the genome, we argue that this is not a serious problem for downstream copy number change point detection methods , because their objectives are not to call individual snps, but to infer segments of several consecutive snps with the same pcn. furthermore, segmentation methods usually require more than one data point in order to calculate the test statistic. when allowing for two or more data points per cn region, the false-positive rate goes down substantially while remaining a significantly improved true-positive rates. this is confirmed by the roc analysis of  smoothed signals , and the t statistics .

in section 'influence of genotyping errors' we discuss further options for decreasing the number of genotyping errors, and suggest how segmentation methods can be made more robust against them.

power to detect pcn change points
the above comparison of the results obtained using normalized dhs across change points implies an ordering in the power to detect these change points, which can be seen from ranking either the test statistics in table  <dig> or the roc curves in figure  <dig> and figure  <dig>  these results suggest that it is much easier to detect a change point between a gain and copy-neutral loh region  or between a loss and a normal region , than it is to detect a change point between a gain and a normal region . the hardest change point to detect is the one between a deletion and a copy-neutral loh region . note that this is consistent with the differences in true dhs -), which are depicted in figure  <dig>  we expect to have little power to detect a d/l change point using dh.

from this it also follows that, although the power to detect either of the two change points of a gain, or a loss, surrounded by a copy-neutral region is the same for total cns, this is not the case for dhs. a consequence of this is that, even with a detection method that takes advantage of both tcn and dh, we are more likely to detect certain types of change points before others, and the precision in locating them will also differ.

note that the evaluation presented is not designed to compare the power of tcn and dh to detect pcn change points, as we are comparing the average detection power of heterozygous snps only. in order to perform such a comparison, we would also need to take into account homozygous snps and non-polymorphic loci for tcns, and compare roc curves at a resolution defined by bin widths and not bin counts.

other platforms and preprocessing methods
the aforementioned results are all based on affymetrix genomewidesnp_ <dig> data that was preprocessed by the crma v <dig> method. in order to show that the results hold for other preprocessing methods and microarray genotyping platforms, we applied tumorboost to the same affymetrix data set after rma/median-polish preprocessing , as well as to the illumina data sets preprocessed using beadstudio. in all cases the conclusion is that tumorboost improves the snrs and the power to detect change points, and that the relative power of different types of change points is consistent with the ones expected by theory. it is interesting to notice that the allele b fractions obtained by the rma/median-polish method are attenuated, and that tumorboost also corrects for this. as discussed further in section 'discussion', this compression is due to incomplete offset and crosstalk correction. for the illumina data set, we only report the results obtained with naive genotype calls. we did not perform a comparison with the results obtained with beadstudio genotype calls as a substantial proportion of snps  were not called by beadstudio, making the results of the comparison depend on the  reason why these snps were not called by beadstudio. however we note that naive genotype calls already perform near perfectly for this data set.

discussion
influence of genotyping errors
above we have noted that although our normalization method leads to an improved signal ratio at the chromosome or at the genome scale, snps that have been incorrectly called heterozygous will still appear as outliers after tumorboost normalization. we have argued that this is not a major problem for downstream analysis methods. in this section we show how genotyping errors by our naive genotyping algorithm can be avoided, and suggest ways to make segmentation methods robust against them.

by construction of our naive genotype calling algorithm, genotyping errors correspond to snps for which the allele b fraction is close to the estimated minimum of the density. therefore, some of these errors can be avoided by making more conservative heterozygous calls in the first place. our results show that if we remove the 10% snps with lowest confidence scores for each method compared, the power per snp obtained by tumorboost using naive genotype calls increases and becomes comparable to that achieved by more elaborated population-based genotyping algorithms .

importantly, we observe a gain after taking confidence scores into account for tumorboost-normalized data with naive genotype calls even after adjusting for the loss in resolution due to the discarding of 10% of the data points. this can be seen from the comparison between t statistics across choices of genotype confidence-score thresholds, where we adjusted the number of heterozygous snps accordingly. for example, when restricting to the 90% best genotype calls, we used j' × 90% =  <dig> points .

furthermore, a two-dimensional genotyping algorithm that takes advantage of the fact that the genotype clusters are better separated in the  space  is likely to perform better than a naïve genotyping algorithm that is based on βn alone.

finally, we note that it is possible to make existing segmentation methods more robust against genotyping errors when genotype confidence scores are available, such as scores from the above naive genotyping algorithm, scores provided by existing genotyping algorithms, or generic scores  <cit> . confidence scores can be used to give greater weights to snps with better genotype calls. recently the authors of circular binary segmentation  added support for such weights to their method  <cit> . on top of this, one can utilize an iterative re-weighted approach where the outliers found from one iteration of segmentation are down-weighted in the following iteration until convergence.

interpretation in terms of allelic crosstalk
from equations ,  &  one can show that tumorboost can also be written as   

where   

and   

being a scale factor controlling for the total copy number and protecting against overcorrection . from equations - one see that for an aa snp, any extra signal observed in allele b of the normal is  subtracted from the allele b, and added back to allele a, of the tumor. a bb snp is corrected analogously. for a snp that is ab, the correction is toward the diagonal along the line θb = θ - θa such that if it would be applied to the normal, the normalized signals would be . this is an interpretation of as well as a dual motivation for tumorboost - there exists a snp-specific crosstalk between the two alleles such that one or both alleles "pull" signal from the others, while their total signal is preserved . the effect of tumorboost on the ascns, calculated as in equation , can be seen in figure  <dig>  in a region of diploid ascns, there exist a large snp-to-snp variation within each genotype group, a variation which is decreased after normalization. similarly, for aberrant regions, the ascn clusters are more distinct after normalization.

population-based estimation of snp effects
the main idea behind the tumorboost method is that there exist snp-specific effects that to a large extent are shared by the tumor and normal samples, and that it is easy to estimate them from the normal. in the case when there exist no matched normal, or when one wishes to correct the normal itself, this approach will not work. it has been previously reported that {}i, {}i, or variants of these, cluster into distinct genotype groups across samples  <cit> , which suggests that the snp effects are shared across samples. this is one of the rationales behind tumorboost. a population-based generalization of tumorboost is then to estimate how the observed ascns is as a function fj of the true ascns, and then use the inverse of this function to backtransform a new sample, i.e. . one possibility is to use an affine function for each fj and estimate it from a large population of normal samples for which the true ascns can be called ,  or . major challenges are how to choose and constrain fj, and how to deal with batch and lab effects, small sample sizes, as well as rarely-observed genotype groups. in this context, tumorboost can be thought of as estimating a highly constrained linear function fj defined in a neighborhood of the genotype center as given by the normal sample, see equations -. this function cannot be used to correct for data at other genotypes, which is why tumorboost applies only to paired tumor-normal samples.

continuing, to the best of our knowledge, illumina's proprietary method  <cit> , which normalizes tcns and allele b fractions by regressing on normal training data for each snp separately, is the only method that does this and is readily implemented and widely tested and used. note that tumorboost still improves upon these estimates , which can be because tumorboost can also correct for systematic effects specific to, but not shared across, individuals and/or batches.

in addition to illumina's method, variants of the above ideas have been proposed by others, such as the allele-specific mixture cn model  <cit>  and the birdsuite method  <cit> . unfortunately, these were either only proposed in theory, specific to one technology or to older chip types, used only for calling discrete ascns in copy-number polymorphic regions, or perform suboptimal corrections. we are aware of a few related methods under development that try to close this gap. we look forward to these when they become available.

directions for future research
simultaneous segmentation of tcn and dh
the results presented in this paper suggest that both tcn and dh may carry information regarding the location of a pcn change point. therefore, analyzing these two quantities separately is sub-optimal. this motivated the development of hidden markov model -based methods that make use of both pieces information simultaneously, such as picnic  <cit> , genocn  <cit>  and pscn  <cit> .

to the best of our knowledge, such joint analyses of tcn and dh cannot be done with current segmentation methods, although multi-dimensional segmentation methods for total copy number data have been developed in different contexts: multi-platform segmentation  <cit> , and joint segmentation from multiple biological samples  <cit> . we advocate the development of joint tcn and dh segmentation methods that would close this gap.

calling pcn states
a natural step downstream of the detection of pcn changes is the calling of pcn states. besides the true copy numbers in the tumor, two biological parameters influence the observed copy number intensity levels: normal contamination, as explained in section 'normal contamination and its impacts', and tumor ploidy. as the total mass of dna - not the total number of cells - is fixed by the assay, tumor ploidy in fact acts as an unknown scale factor on observed copy number intensities  <cit> .

even in situations when tumor ploidy is assumed to be known or can be estimated, calling pcn states when κ is unknown and estimating κ when pcn states are unknown are difficult problems. in order to disentangle these two problems, a natural idea is to take advantage of the fact that although pcn states differ across pcn regions, κ is the same across regions for a given sample.

however, we note that equation  makes the strong assumption that the tumor is homogeneous, that is, the "tumor sample" is a mixture of normal tissue and one tumor tissue. another complication is that dhs after normalization need to be calibrated; the mean dh value in a given pcn region might be a biased estimator of the true pcn, also after tumorboost normalization.

furthermore, as noted in section 'power to detect pcn change points', with joint segmentation of tcn and dh, there is a greater risk that one of the change points flanking a constant pcn region is more likely to be detected than the other. this complicates the calling and inference of the underlying pcn states. on the other hand, understanding how this bias works can help locate such expected but "missing" change points.

we are looking forward to further scientific contributions to these problems.

call for the use of matched normals
finally, we wish to emphasize the great value of including matched normals in tumor studies. to start, with paired tumor-normal data there are great opportunities for quality control, e.g. validating sample annotations and identify poor or failed hybridizations. more importantly, it is basically only with a matched normal it is possible to tell if an event is somatic or in the germline. moreover, as reported by others and explained here, matched normals are useful for identifying homozygous snps, which when excluded greatly helps identifying regions of ai in the tumor. not to mention that with a matched normal it is easier to infer the amount of normal contamination. in addition to these, we have in this study shown that with matched normals it is possible to obtain tumor cns with significantly higher snrs, which further helps us identify chromosomal events. for these reasons, we strongly suggest that it becomes standard to collect normal dna  along with the tumor.

CONCLUSIONS
tumorboost increases the power to detect somatic copy-number events  in the tumor from allelic signals of affymetrix, illumina and alike origins. because each snp is normalized separately, tumorboost does not require prior knowledge about copy number change points or copy number regions, and its complexity is linear in the number of snps.

importantly, high-precision allelic estimates can be obtained from a single pair of tumor-normal hybridizations, if tumorboost is combined with single-array preprocessing methods such as  crma v <dig> for affymetrix or beadstudio's  xy-normalization method for illumina. based on these results, we recommend the use of matched normal samples in cancer dna copy number studies.

list of abbreviations
ai: allelic imbalance; ascn: allele-specific copy number; cn: copy number; dh: decrease in heterozygosity; loh: loss of heterozygosity; pcn: parental copy number; roc: receiver operating characteristic; snp: single nucleotide polymorphism; snr: signal-to-noise ratio; tcga: the cancer genome atlas; tcn: total copy number.

authors' contributions
hb and pn developed and iterated the method with help from ts. all authors contributed to the final method and manuscript.

supplementary material
additional file 1
affymetrix genomewidesnp_ <dig> data after crmav <dig> preprocessing . assessment of tumorboost based on tumor/normal pair tcga-23- <dig> in the affymetrix genomewidesnp_ <dig> data set preprocessed with the crmav <dig> method.

click here for file

 additional file 2
affymetrix genomewidesnp_ <dig> data after crmav <dig> preprocessing . assessment of tumorboost based on tumor/normal pair tcga-23- <dig> in the affymetrix genomewidesnp_ <dig> data set preprocessed with the crmav <dig> method using the snps with 90% highest confidence scores.

click here for file

 additional file 3
affymetrix genomewidesnp_ <dig> data after ismpolish preprocessing . assessment of tumorboost based on tumor/normal pair tcga-23- <dig> in the affymetrix genomewidesnp_ <dig> data set preprocessed with the ismpolish method.

click here for file

 additional file 4
affymetrix genomewidesnp_ <dig> data after ismpolish preprocessing . assessment of tumorboost based on tumor/normal pair tcga-23- <dig> in the affymetrix genomewidesnp_ <dig> data set preprocessed with the ismpolish method using the snps with 90% highest confidence scores.

click here for file

 additional file 5
illumina human1m-duo data after beadstudio,xy preprocessing . assessment of tumorboost based on tumor/normal pair tcga-23- <dig> in the illumina human1m-duo data set preprocessed with the beadstudio,xy method.

click here for file

 additional file 6
illumina human1m-duo data after beadstudio,xy preprocessing . assessment of tumorboost based on tumor/normal pair tcga-23- <dig> in the illumina human1m-duo data set preprocessed with the beadstudio,xy method using the snps with 90% highest confidence scores.

click here for file

 additional file 7
illumina human1m-duo data after beadstudio,baf preprocessing . assessment of tumorboost based on tumor/normal pair tcga-23- <dig> in the illumina human1m-duo data set preprocessed with the beadstudio,baf method.

click here for file

 additional file 8
illumina human1m-duo data after beadstudio,baf preprocessing . assessment of tumorboost based on tumor/normal pair tcga-23- <dig> in the illumina human1m-duo data set preprocessed with the beadstudio,baf method using the snps with 90% highest confidence scores.

click here for file

 additional file 9
affymetrix genomewidesnp_ <dig> data after crmav <dig> preprocessing . assessment of tumorboost based on tumor/normal pair tcga-02- <dig> in the affymetrix genomewidesnp_ <dig> data set preprocessed with the crmav <dig> method.

click here for file

 additional file 10
affymetrix genomewidesnp_ <dig> data after crmav <dig> preprocessing . assessment of tumorboost based on tumor/normal pair tcga-02- <dig> in the affymetrix genomewidesnp_ <dig> data set preprocessed with the crmav <dig> method using the snps with 90% highest confidence scores.

click here for file

 additional file 11
illumina humanhap <dig> data after beadstudio,xy preprocessing . assessment of tumorboost based on tumor/normal pair tcga-02- <dig> in the illumina humanhap <dig> data set preprocessed with the beadstudio,xy method.

click here for file

 additional file 12
illumina humanhap <dig> data after beadstudio,xy preprocessing . assessment of tumorboost based on tumor/normal pair tcga-02- <dig> in the illumina humanhap <dig> data set preprocessed with the beadstudio,xy method using the snps with 90% highest confidence scores.

click here for file

 acknowledgements
we gratefully acknowledge the tcga consortium and all its members for the tcga project initiative, for providing samples, tissues, data processing, and making data and results available. this study was supported by nci grant u <dig> ca <dig>  the authors have no conflicts of interest.
