BACKGROUND
terminal-restriction fragment length polymorphism  analysis of 16s rrna gene amplicons is a rapid fingerprinting method for characterization of microbial communities  <cit> . it is based on the restriction endonuclease digestion profile of fluorescently end-labeled pcr products. the digested products are separated by capillary gel electrophoresis, detected and registered on an automated sequence analyzer. each t-rf is represented by a peak in the output chromatogram and corresponds to members of the community that share a given terminal fragment size. peak area is proportional to the abundance of the t-rf in the pcr amplicon pool, which can be used as a proxy for relative abundance in natural populations  <cit> . this method is rapid, relatively inexpensive and provides distinct profiles that reflect the taxonomic composition of sampled communities. although it has extensively been used for comparative purposes, a t-rflp fingerprint alone does not allow for conclusive taxonomic identification of individual phylotypes because it is technically challenging to recover terminal fragments for direct sequencing. however, when coupled with sequence data for representative 16s rrna genes, t-rf identification is feasible . here we describe a method to assign the t-rf peaks generated by t-rflp analysis with either 16s rrna gene sequences obtained from clone libraries of the same samples, metagenome sequences or data from public 16s rrna sequence databases. t-rfpred can thus be used to classify t-rfs from t-rflp profiles for which reference clone libraries are not available, albeit with lower phylogenetic resolution, by taking advantage of the wealth of 16s rrna gene sequence data available from metagenome studies and public databases such as the ribosomal database project   <cit>  or silva  <cit> . metagenome sequencing studies from a variety of environments are accumulating at a rapid pace. while most often partial gene sequences, these libraries have the advantage that they are less subject to biases of other pcr-based techniques  and, thus, can better represent the original community structure. furthermore, both metagenome and pyrosequencing of tagged 16s rrna gene amplicons provides unprecedented coverage of 16s rrna gene diversity in specific environments. therefore, these types of datasets are valuable references when attempting to taxonomically classify t-rf peaks from diverse microbial communities.

tools have been previously developed to perform in silico digestions of 16s rrna gene sequences and/or to assign a taxonomic label to the chromatograms. such programs include tap-trflp  <cit> , mica  <cit> , t-rflp phylogenetic assignment tool , trefid  <cit> , trampr  <cit> , an arb-software integrated tool  <cit>  and trifle  <cit> . table  <dig> contains some of the essential features of these packages. the most obvious advantage of t-rfpred as compared with other available software applications is that the program handles either partial or full-length user input sequences. this is because t-rfpred retrieves complete sequences of close relatives from the public databases for t-rf assignments and at the same time it taxonomically bins the clone sequences. furthermore, it can use large sequence datasets of virtually any size as reference sets in taxonomic assignments. t-rfpred is exclusive to 16s rrna gene sequences and designed to exploit the full potential of t-rflp profiles and their use in the description of prokaryotic communities.

complete sequence at least at the 5'-end of the sample sequence is needed in every case except for t-rfpred, as this program finds the closest related sequence in the ribosomal database project database by blastn.

implementation
t-rfpred is coded in perl and uses the bioperl toolkit  <cit> , fuzznuc from the emboss package  <cit>  and the blastn program from the ncbi blast suite  <cit> . t-rfpred has been tested in unix-like environments, but runs in all the operating systems able to execute perl, bioperl, blast and emboss; a ready-to-use vmware virtual image is also available for download at http://nodens.ceab.csic.es/t-rfpred/.

an interactive shell guides the user through the multiple steps of the analysis. users can choose to analyze archaeal or bacterial sequences using either forward or reverse primers. the primer search utilizes fuzznuc, which allows the user to select the number of nucleotide ambiguities. the program extracts a subset of sequences from the rdp database that will supplement sequence analysis of clone libraries. t-rfpred generates and exports in a tab delimited text file:  the fragment length for the rdp sequence with the best blastn hit to the input sequence,  the estimated fragment length for the input sequence,  the gap length for the input sequence,  the percent identity between the input sequence and the best hit rdp sequence and  the taxonomic classification. the blastn search results and the smith-waterman alignments  <cit>  are saved to allow the user to manually check the results.

database
the program uses a custom version of the aligned rdp as a flat file in fasta format, where the header has been modified to include the ncbi taxonomic information and the forward/reverse position of the first non-gap character from the rdp alignment. t-rfpred exploits the bio::db::flat capabilities from bioperl to index the rdp flat file for the rapid retrieval of 16s rrna gene sequences. all restriction enzymes available in rebase  <cit>  are stored in a flat file and available for use in the analysis. a list of frequently used forward and reverse primers is available, although the user may also input custom primers.

algorithm
in part, the rationale for the described method was to circumvent the need for full-length 16s rrna gene sequences from representative clone libraries. in addition to requiring multiple sequencing reactions, obtaining full-length sequences is generally complicated by the ambiguous nature of the 5' end of a sequence generated by the sanger approach . when the same primer set used to generate t-rflp profiles is also used to generate amplicons for libraries and directional sequencing of representative clones, as is often the case, in silico predictions of expected peak sizes are cumbersome. additionally, the size of the fragment is subject to experimental error  <cit> , which complicates the assignment of chromatogram peaks to specific phylogenetic groups. t-rfpred takes advantage of the most comprehensive database of 16s rrna gene sequences  to identify the closest related sequences for analysis to provide more definitive phylogenetic assignments of chromatogram peaks. collectively, the perl scripts achieve the following steps:

 <dig>  create a subset of all the sequences in the rdp with nucleotide information spanning the region targeted by the fluorescently labeled primer and with a length >  <dig> nucleotides for bacteria and >  <dig> nucleotides for archaea.

 <dig>  convert the subset created in step  <dig> into a blast-ready database using formatdb. conduct a blastn search with the sample sequences  against the rdp database and extract the best hits.

 <dig>  determine if sample sequences have the denoted restriction enzyme recognition site. if the cut site is present, proceed to step  <dig>  if the cut site is not present, estimate the expected fragment size using the closest rdp sequence and proceed to step  <dig> 

 <dig>  generate a smith-waterman alignment of the sample sequence with the best hit from the rdp. this will provide accurate percent identities and the start/end positions of the alignment needed to estimate the fragment sizes.

 <dig>  obtain the position of the restriction enzyme recognition site in the aligned sample sequence and the primer position in the rdp sequence. use the rdp sequence to calculate the number of nucleotides in the gap between the primer and the start position of the smith-waterman alignment as shown in figure  <dig> 

 <dig>  assign a taxonomic classification using the best rdp blast hit.

RESULTS
we have developed a computational method to provide putative phylogenetic affinities of chromatogram peaks of 16s rrna gene t-rflp profiles. additional file  <dig>  supplementary tables s1-s <dig> show the typical output of t-rfpred for the clone sequences from gonzález et al.  <cit> , mou et al.  <cit> , and pinhassi et al.  <cit> , respectively. the t-rfpred output provides the estimated fragment size of the digested clone sequences as well as a user defined number of closest relatives. this feature is valuable for estimating the conservation of the digested product size for a given enzyme and taxonomic group analyzed.

t-rfpred was also evaluated by reanalyzing chromatogram peaks from t-rflp profiles of marine communities described in gonzález et al.  <cit> . two 16s rrna datasets constructed from sequences from public databases, designated "4926"  and "gos" , were analyzed with t-rfpred using three restriction enzymes . details on experimental procedure are described in the additional file  <dig>  the two datasets and their predicted fragment sizes and phylogenetic affiliations were used to taxonomically label the chromatogram peaks from natural samples . with very few exceptions, all valid fragment peaks were properly identified and in good agreement with the phylogenetic assignments reported in the literature using complementary clone libraries . for instance, from the  <dig> sequence dataset analyzed with three restriction enzymes,  <dig> clones yielded in silico digested fragment sizes matching peaks labeled as "1"  in figure  <dig>  of these clones, 90%  were properly classified as roseobacter-related, seven were alphaproteobacteria outside the roseobacter group, four gammaproteobacteria, and two were betaproteobacteria . thus, these t-rfs were labeled as roseobacter. those peaks labeled with a "2"  were mapped to members of the sar <dig> group as  <dig> of the  <dig> sequences  were from this lineage . the chromatogram peak assignments were less ambiguous when the gos dataset was used as the reference. with regards to t-rfs labeled  <dig> and  <dig> in figure  <dig>  95% of the sequences belonged to the roseobacter group and all  sequences belonged to the sar <dig> group . therefore, the gos dataset was more representative of the diversity of the bacterioplankton in the natural samples. this might be because that dataset was comprised of sequences exclusively from surface seawater samples; the t-rflp profiles analyzed were also generated from surface seawater.

sequences that matched the fragment sizes were analyzed using 2- <dig> different restriction enzymes as indicated. alphaproteobaceria sensu latu refers to any bacterial sequences in the class that were not either roseobacter or sar <dig>  see experimental procedures in the additional file  <dig> for details.

CONCLUSIONS
t-rflp is a popular method for analysis of microbial communities and in silico automated methods are needed to facilitate the taxonomic identification of t-rfs in community profiles. traditionally, computational methods to analyze t-rflp experiments follow one of two approaches:  in silico simulation of the digestion of reference sequences from databases to find the most suitable enzymes that describes the microbial community organization or  t-rf from experiments can be binned to the in silico generated fragments to identify the taxonomic groups present in the sample. t-rfpred is designed to provide a list of candidate taxa that corresponds to the chromatogram peaks using a complementary reference clone library or public databases. depending upon the restriction enzyme used, broad phylogenetic groups can sometimes give the same fragment size. thus, we also determined that community profiles generated with at least two different restriction enzymes are needed for the most robust taxonomic identifications . the method has also its caveats as is not meant to positively identify phylogenetic groups or species based upon terminal fragment length, particularly, as the identification of the sequences cannot be solely determined based on the closest blastn hit alone. manual inspection of the blastn hits and additional efforts may also be needed for more conclusive taxonomic assignments. in the example above, we conducted homology searches  to a set of reference sequences from representative taxa as well as phylogenetic treeing methods to confirm the taxonomic affiliations of the gos and  <dig> sequences whose predicted fragment sizes matched a chromatogram peaks . despite these caveats, the position of restriction enzyme recognition sites within the 16s rdna molecule does reflect a level of phylogeny and can be used to help guide experimental design  so that the most reliable results for the t-rflp characterization of a given prokaryotic assemblage can be obtained.

in summary, t-rfpred offers an alternative, freeware and open source program for researchers using t-rflp to examine microbial populations. the program can help researchers determine the most appropriate restriction enzyme to use when designing experiments to assess community structure using the t-rflp method. it can also provide information on the taxonomic assignments of specific t-rfs without the need for comprehensive complementary clone libraries.

availability and requirements
project name: t-rfpred

project home page: http://nodens.ceab.csic.es/t-rfpred/

operating systems: linux , mac os x , windows 

programming language: perl

other requirements: bioperl, blast and emboss

license: none

any restrictions to use by non-academics: none

authors' contributions
afg wrote the script and participated in the analysis and drafting of the manuscript. xm participated in the analysis and ab in the analysis and drafting of the manuscript. eoc coordinated the study, as well as participated in writing the manuscript. jmg conceived the study, and participated in its design and coordination. jmg was also involved in the analysis and interpretation of results and drafting of the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
"project website", "additional experimental procedure" and "supplementary tables s1-s3". project website. webpage to download t-rfpred. additional experimental procedure. origin of chromatograms and reference datasets to label the peaks on figure  <dig>  supplementary tables s1-s <dig>  typical output of t-rfpred for the clone sequences from  <cit> , respectively.

click here for file

 acknowledgements
this work was supported by grant pirena cgl2009-13318-co2-01/bos to eoc, grant ctm2007-63753-c02-01/mar to jmg, and grant consolider-ingenio <dig> graccie csd2007- <dig> to afg from the spanish ministry of science and innovation, and grant oce- <dig> from the national science foundation to ab.
