BACKGROUND
the major histocompatibility complex  region on the short arm of chromosome  <dig> is one of the most complex regions in the human genome with extreme levels of polymorphism and linkage disequilibrium  <cit> . with a span of about  <dig> mb, the mhc comprises many hundreds of genes  <cit> . of these, the human leukocyte antigen  genes are the most prominently studied. the hla genes encode cell-surface proteins responsible for antigen peptide presentation in a cell-mediated immune response. inherited dna sequence variation within these genes is strongly associated with autoimmune and infectious diseases as well as severe adverse drug reactions  <cit> . clinically, hla sequence information is also widely used for matching donor and recipient in transplantation on the basis that more similar alleles will reduce the risk of rejection  <cit> .

to date,  <dig> unique 4-digit hla alleles have been described in the imgt/hla database at class i, and  <dig> at class ii  <cit> . over many years, best practices in hla typing have traditionally been disseminated by the participants of the international histocompatibility workshop. established methods include sequence specific oligonucleotide  hybridization and, more recently, capillary sequencing . sso hybridization uses oligonucleotide probes to detect the presence  of polymorphisms specific to each probe <cit> . the sanger method uses chain-termination fluorescence for dna base-pair detection and sequencing.

although these methods have proven effective for hla typing, they remain labor-intensive, time-consuming and expensive. further, one specific disadvantage of sanger sequencing is that it does not generate two separate, haploid sequences, making it in some cases challenging to resolve the individual hla haplotype sequences in a diploid pair of chromosome  <dig>  the advent of next-generation sequencing technologies motivated us to develop an efficient protocol for genotyping of the classical hla genes of class i.

our strategy for hla typing utilizes the  <dig> gs flx titanium sequencing platform  and allows the use of sequence tags, or barcodes, to label each dna sample at either the amplicon-preparation stage  or during library construction  .

the first method, termed "library construction-based barcoding," involves the addition of a molecular barcode to the standard  <dig> "a" adapter, which is ligated to double-stranded exon-specific amplicons during library construction. the exon-specific amplicons are pooled by sample  after pcr, and up to  <dig> samples are pooled after barcoded adapter ligation .

the second method, termed "pcr-based barcoding" involves the addition of a barcode to the forward and reverse exon-specific pcr primers. the same unique barcode is added to all  <dig> exon-specific primer pairs  for a given sample.  <dig> different barcoded primer sets were designed in total, leaving an empty 96th well as a positional key . post-pcr all amplicons from all  <dig> samples are pooled and the pool proceeds through standard library construction with the addition of a non-barcoded adapter.

both methods facilitate sample multiplexing prior to emulsion pcr and sequencing, which dramatically reduces the overall cost per individual for an all-in cost of less than $ <dig> per sample for typing of class i genes hla-a, -b and -c. using these methods a single technician can process up to  <dig> samples at once, creating a sequence-ready library in under three days. because we are using the flx titanium chemistry, sequence reads extend across entire exons of the hla genes .

in parallel, we have developed an hla calling algorithm to process sequence reads, from the now-standard sam/bam format, and to infer classical types for a given dna sample  <cit> . recognizing that the improvements in next-generation sequencing technologies are rapid, we designed the hla caller to be an integral part of the genome analysis toolkit , a data processing tool for recalibration, quality control, and variant calling of next-generation sequence data  <cit> .

the hla calling algorithm determines the most likely pair of hla types at each locus by systematically evaluating all possible pairs of 4-digit hla types. we use three key components to calculate the posterior probability for each hla allele pair. first, we compare genotypes for each allele pair to the genotypes determined by the genome analysis toolkit  based on sequence data. second, we check the allelic phase of each hla allele pair for consistency with the sequence data. specifically, we calculate the binomial probability that the phase orientation for a specific hla allele pair is consistent with the sequence data at a pair of adjacent polymorphic sites, and aggregate these probabilities across all pairs of polymorphic sites. third, we use information about the expected allele frequency to determine the prior probability of observing each pair of hla alleles in the population . we then multiply the probabilities calculated from base genotypes, allelic phase information, and allele frequencies, rescale , and output the posterior probability for each hla allele pair. the pair with the highest posterior probability corresponds to the best-guess genotype for that dna sample.

in this study, we benchmark our protocol on dna samples used in the international hapmap project with known hla types:  <dig> samples for library construction-based barcoding and  <dig> samples for the barcoded pcr method. we limited the sample number in our validation test of the barcoded pcr method to  <dig> due to the similarities to the already tested library-construction based method, and the number of barcoded primers arrayed per plate . we demonstrate that we can generate reliable hla calls, and in some cases improve upon the existing calls, but also highlight instances of problematic alleles where calls are less robust in our current protocol. overall, our protocol offers comparable data quality but outperforms traditional sanger sequencing in terms of cost-effectiveness and throughput.

RESULTS
using the library construction-based barcoding method, we sequenced exons  <dig> and  <dig> of hla-a, hla-b and hla-c for each of  <dig> hapmap individuals  . this generated a total of  <dig>  ×  <dig> base-pairs of sequence data in  <dig>  sequencing reads. the average read length across all libraries was  <dig> ±  <dig> bp .  <dig> % of reads were parsed using uniquely identifying barcodes, of which  <dig> % were correctly aligned to the reference genome . the average depth of coverage across all samples was  <dig> ±  <dig> reads at each exon  and by individual exon). depth of coverage plots per individual and per locus for the library construction method are shown in additional files  <dig>   <dig> and  <dig> 

using the pcr-based barcoding method, we sequenced class i loci for  <dig> hapmap samples and produced a total of  <dig>  reads.  <dig> % of reads were parsed using uniquely identifying barcodes, of which  <dig> % were correctly aligned to the reference genome . the average depth of coverage per individual was  <dig> ±  <dig> reads at each exon. coverage plots for the barcoded-pcr method are shown in figure  <dig> and an example of aligned dna reads at hla-b is shown in figure  <dig> 

the gold standard data set of  <dig> hapmap individuals generated using sso hybridization contained  <dig>  hla types at 4-digit resolution <cit> . using data from the library construction-based barcoding method, we found that  <dig>  of our hla calls were concordant with the gold standard types . of the  <dig> discordant cases,  <dig> included systematic errors in the gold standard dataset ,  <dig> resulted from inaccurate typing due to low or unbalanced chromosomal coverage, and  <dig> were inaccurately typed due to sample contamination, sequencing errors, or read misalignment.

manual inspection of the aligned reads from the library construction-based barcoding method revealed that inconsistent use of hla allele nomenclature between the gold standard and our hla caller , as well as typing errors in the gold standard generated by sso hybridization, accounted for  <dig> of  <dig>  of the discordant hla calls. in the gold standard, the c*02: <dig> genotype was consistently misnamed as c*02: <dig> in  <dig> cases  since this genotype was previously named cw* <dig> . in other instances, genotype a*02: <dig> was consistently mistyped as a*02: <dig> in  <dig> cases in the gold standard data, because an a > t transversion at position  <dig> , <dig> of hla-a exon  <dig>  was missed . similarly, genotypes c*08: <dig>  c*07: <dig>  a*66: <dig>  a*26: <dig>  and a*36: <dig> were each mistyped in  <dig> individuals due to single point mutations not detected in the hla types of the gold standard data. lastly, c*06: <dig>  c*05: <dig>  c*03: <dig>  c*01: <dig>  b*39: <dig>  b*39: <dig>  and a*11: <dig> were each mistyped once due to differences at one or more bases . in total, the detected error rate of the gold standard was  <dig> %  at the 4-digit resolution. all corrections were reviewed in detail with the laboratory that performed the original sso experiments , and were independently confirmed using sanger sequencing. the corrected class i hla types are listed in additional file  <dig> 

after taking into account errors in the gold standard dataset, overall typing accuracy in the library construction-based barcoding method increased to  <dig> % at 4-digit resolution and  <dig> % at 2-digit resolution . 4-digit accuracy was higher in hla-b  compared to hla-a  and hla-c  . typing accuracy was higher in ceu , jpt , and chb  individuals compared to yri .

most of the incorrect calls in the library construction-based barcoding method were due to low coverage of specific alleles . in these cases, unbalanced chromosomal coverage caused the hla caller to mistake true heterozygous sites for homozygous bases . overall, mistyping at the 4-digit resolution due to low or unbalanced chromosomal coverage occurred in 3%  of all cases. sample contamination contributed to mistyping in one individual in the library construction method, as evidenced by the presence of four distinct chromosomes at a single locus . this individual was later correctly typed using the pcr based barcode method.

in the pcr-based barcoding method,  <dig> individuals were sequenced and typed, with a typing accuracy of  <dig> % at 4-digit resolution and  <dig> % at 2-digit resolution after adjusting for errors in the gold standard . the improved typing accuracy resulted from reducing uneven coverage of specific hla alleles. c*04: <dig>  the genotype with the poorest coverage in the original method, was typed correctly in all  <dig> individuals with that genotype using this method. likewise, a*30: <dig> was typed correctly in all  <dig> individuals with the genotype, highlighting the reduction of errors due to low coverage using this method.

discussion
we have developed two sample preparation methods and a systematic algorithm for class i hla typing using next-generation sequencing. these methods leverage the longer read lengths and clonal amplification inherent to the  <dig> sequencing technology with the titanium chemistry. longer reads  capture critical phase information of nearby dna variants, and enable accurate sequence alignment to the polymorphic hla region. this information enables differentiation between highly similar alleles and is an important advantage over capillary-based methods.

the ability to capture dna sequences with high depth of coverage and with phase information enabled us to confidently detect and correct errors in the gold standard database, originally typed using sso hybridization. the high depth of coverage of  <dig> sequences minimizes genotyping errors, and the long read lengths and use of locus-specific primer sequences together help prevent alignment errors. compared to sso hybridization,  <dig> holds two main advantages: first,  <dig> generates many dna reads for each chromosome while sso generates only one intensity-based read, allowing  <dig> to correct for sequencing errors while sso cannot. second, reads from  <dig> sequencing contain phase information that can be used to resolve ambiguous allele combinations while sso reads cannot. these advantages allowed us to confidently correct errors in the sso based gold standard, and corrections were verified the laboratory that performed the original sso experiments.

related methods for performing hla typing using  <dig> sequencing were recently developed by gabriel et al., lank et al. and bentley et al.  <cit> . all of these methods employ a pcr primer modified with both barcode and adaptor sequences  <cit> , resulting in significantly more expensive primers  for dna library amplification than those in our method. in addition, we multiplex 95- <dig> barcoded samples into a single lane of an 8-region picotiter plate , allowing for a maximum of  <dig> samples per run compared to  <dig> -  <dig> samples per run in the method by bentley et al  <cit> . the current estimate for minimum coverage required for accurate hla typing by our hla caller is  <dig> reads, whereas our samples received on average > <dig> reads per exon. this leaves open the possibility of sequencing additional amplicons per sample, or multiplexing more samples per sequencing run in future if necessary. the longer read lengths provided by the flx titanium technology also permit more flexibility in primer selection than the flx technology used in the bentley et al study. see additional file  <dig> for a comprehensive comparison of these methods to ours.

while sequencing hla exons  <dig> and  <dig> is not sufficient for distinguishing between all known hla genotypes, it provides an extraordinary amount of identifying information, especially when combined with allele frequency information. using the hla database, lank et al.  predict that exons  <dig>   <dig>  and  <dig> theoretically differentiate 85% of all known alleles, however this figure likely underestimates the true typing capacity since they did not considering the effect of allele frequency on the incidence of uniquely identifiable alleles. we were able to achieve  <dig> % to  <dig> % empirical 4-digit typing accuracy by sequencing only exons  <dig> and  <dig>  in addition to using frequency information to differentiate between ambiguous hla genotypes. without frequency information, it is difficult to identify the true hla types, but it is possible to generate a short list  of candidate hla allele pairs from a total of  <dig>  possibilities at hla-a,  <dig>  at hla-b, and  <dig>  at hla-c. the true allele pair may be differentiated from the other candidates by having the highest multiplicative frequency in the vast majority of cases. in the rare instance that the hla genotype remains ambiguous after using frequency information, a list of top candidate alleles may be provided. additional exons may be sequenced if high-resolution hla types are desired, for to type individuals in rare populations or for to discover new hla alleles.

one concern is that the incorporation of population frequency information may bias the hla typing for a few specific hla alleles. the definitive solution for preventing report bias is to sequence the entire hla gene to remove all ambiguities in the genotype background. however this approach is not yet cost effective for most technologies and may hinder multiplexing throughput and efficiency. the interim solution is to report all alleles that match the particular genotype background  and phase, with a pair of alleles that are designated to be the most likely given the expected frequency in the population in question. another concern may be the accuracy of allele frequencies. all frequency information was collected from http://www.allelefrequencies.net, a central resource that has aggregated hla type frequencies from hundreds of sources including blood banks, research facilities, and other studies  <cit> . to our knowledge, this is the most reliable source of hla  allele frequencies available. the problem of allele skew is common to all hla typing methods that do not sequence the entire gene, however report bias may be prevented by reporting all matching alleles in addition to the most likely alleles with frequency information.

our sequencing methods may be modified to accommodate additional amplicons at the hla loci . because the average depth of coverage in the current method  exceeds the estimated coverage required for accurate typing , the addition of a small number of additional amplicons  may work in the current multiplexing protocol. efforts are also underway to develop class ii hla typing capacity. however, the addition of a significant number of amplicons  may require decreasing the multiplexing rate by about ½ to maintain a similar depth of coverage. however such changes are well compensated by the high efficiency of sample multiplexing and cost savings from pre-barcoded primers. the main challenge in class ii is to design primers that target specific class ii hla genes instead of others in the same homologous family .

we have described two sample preparation methods that differ in the pooling and barcoding strategies employed. both methods represent facile approaches to amplification and hla class i genotyping. if large sample numbers  are to be processed the pcr-based barcoding method may be preferential as it facilitates pooling of all amplicons directly after pcr, meaning that only a single library construction is required downstream. these changes significantly cut the cost and increase the throughput of hla typing. using this process a single technician can amplify, pool and adapt up to  <dig> samples in two days. class i hla typing of samples prepared in this way costs less than $ <dig> per sample, as calculated using our all-in, end-to-end internal accounting model.

CONCLUSIONS
next-generation  <dig> sequencing is a reliable, efficient, and scalable technology for hla typing. important advantages of  <dig> over traditional sequencing technologies include its high depth of coverage and long read lengths to improve hla typing accuracy, as well as its high multiplexing rate to maximize throughput while minimizing cost. we have developed novel laboratory methods to sequence the class i hla loci using  <dig> technology, and a robust hla caller algorithm to perform hla typing using sequence genotype, allelic phase, and population-based frequency information. we have validated these laboratory and computational methods by typing hapmap individuals with high accuracy, and in some cases, provided corrections to the sso-based gold standard database after systematic review and validation

