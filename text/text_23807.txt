BACKGROUND
amide hydrogen/deuterium exchange  coupled with mass spectrometry  has proven to be a powerful technique for the study of protein structure and dynamics as well as protein-protein and protein-ligand interactions  <cit> . the rate at which an amide hydrogen exchanges with solvent deuterium reveals much about its local environment. changes in protein structure or dynamics can result in changes in h/d exchange kinetics for a subset of amide hydrogens along the protein backbone. measurement of these alterations in kinetics provides chemical sensors for changes in protein structure and dynamics.

to perform these experiments the target protein or protein complex of interest is subjected to a time course of incubation with deuterium containing buffer to initiate on-exchange of deuterium into the protein. at prescribed time intervals, aliquots of the on-exchange mixture are rapidly quenched by the addition of a low ph and low temperature buffer containing denaturants to prevent further on-exchange, minimize off-exchange of incorporated deuterium and help denature the protein. the quenched and denatured protein is then subjected to enzymatic digestion by acid stable proteases. the resultant peptides are collected on a reverse-phase hplc column and then gradient eluted directly into a mass spectrometer equipped with an electrospray ionization source where the mass of each peptide is measured. alternatively, peptides may be spotted onto a target and analyzed with matrix assisted laser desorption ionization  mass spectrometry  <cit> . by repeating this process for all on-exchange time points the mass increase of each proteolytic peptide over the time course of deuterium exposure can be determined. from these data the rates of deuterium exchange can be determined for the corresponding areas of the intact protein.

since the inception of h/d exchange mass spectrometry, substantial advancements in methodology, automation and instrumentation have been made,  <cit>  however, processing, curation, and validation of the large number of data points produced in a typical h/d exchange experiment  <cit>  presents a significant data processing and analysis challenge. these issues have in part been addressed by several existing software tools and algorithms. interactive software to simplify the calculation of average molecular weight has been developed  <cit> . other algorithms are implemented as command line software which automate the extraction of deuterium content with fourier transform and natural isotopic abundance based calculations  <cit> . proprietary software has also been described that automates the extraction of deuterium content in a standalone software application  <cit> . peak width analysis approaches have been created  <cit>  as well as excel tools leveraging this approach  <cit> . deconvolution techniques have been developed to determine deuterium content in less straightforward situations  <cit> . these above mentioned approaches have shown success in given cases, and their efforts serve to illustrate the interest and challenge of this area, however, the processing and management of h/d exchange data remains a significant bottleneck in the technique.

while progress has been made in h/d exchange data processing, these solutions have not always been easy to employ, and thus have not been widely adopted. some solutions are command line based, and others are not freely available or their methods have not been described in detail. often users are required to run separate programs, covering different functions such as peptide location and centroiding. in addition, output from the wide variety of ms instruments and database search engines presents another hurdle in the creation of broadly applicable solutions. there are no published h/d exchange software solutions based on platform independent common mass spectrometry data file formats, such as mzxml. the large size and number of files in conventional studies overburdens users with organizing, migrating and storing data, a critical factor that has yet to be addressed. integrated user interfaces are also required that allow for the presentation, curation and validation of the results. these factors illustrate the need for software that is precise, efficient, convenient to use, and freely available to the scientific community.

a web-based software system called "the deuterator" is presented here. it is freely available as an online service, and addresses many of the needs described above. the software can be used to precisely determine the deuterium content for protein segments in an integrated, high-throughput manner, taking steps toward instrument platform independence through the use of common data file formats. novel tools have been implemented and are accessible through a user interface providing functionality such as the determination of percentage deuterium incorporation for a given peptide. the software is compatible with data from most common database search engines and is compatible with high and low-resolution mass spectral data. although the software was developed for analyzing lc esi-ms data, processing data from h/d experiments that do not incorporate a chromatographic step or data that were generated with maldi ms instruments are supported equally. the output for each peptide included in the experiment is an accurate measurement of deuterium incorporation over time, which can then be plotted as deuterium vs. log time graphs. peptide sequences can be positioned next to the protein sequence to display the sequence coverage. graphical representations of h/d exchange data can then be added by using two-dimensional color maps to represent the data values, which may also be overlaid onto a high-resolution 3d protein structure. to develop and validate this web-based tool, we tested the system in a production environment for over one year with both low  and high  resolution esi-ms data.

implementation
the deuterator is available as a web-based application. the back-end architecture was built with java and the online service was implemented with jsp. the ms data viewers were implemented using open source software  <cit> . mass spectral and search result data are required in native format, and are converted into common file formats. protein sequence data is required in fasta format.

the broad range of mass spectrometers and sequence search tools has resulted in a large number of differing file formats, resulting in compatibility problems for many new and existing software packages. this issue has been addressed by recent efforts to create the common file formats mzxml  <cit>  and mzdata  <cit>  for mass spectrometric data. one such effort  <cit>  has developed the common formats mzxml and pepxml for mass spectral data and peptide identities respectively, and provides freely available mzxml conversion programs for various instrument formats. the deuterator leverages these files formats and therefore takes steps toward greater compatibility with a broad range of mass spectrometers and protein search engines.

the components of the deuterator are best viewed in a browser with tabbed browsing functionality, allowing for many time points to be viewed simultaneously. results from the calculations are saved in a flat file format , which are easily viewed with applications such as microsoft excel.

RESULTS
workflow
our h/d exchange workflow is shown in figure  <dig> and starts with a typical proteomics experiment. the protein of interest is digested with an enzyme and the resulting peptides are analyzed by liquid chromatography tandem mass spectrometry . peptide identity is then established with the database search tool of choice   and then visually confirmed with tools such as the thermo-finnigan qual browser. alternatively, peptides can be identified by using a peptide mass fingerprinting approach. it should be noted that the method for peptide identification, and the stringency by which the results are validated, are left to the end user. subsequent solution phase amide h/d exchange experiments are performed for a number of pre-defined time periods . following incubation with heavy water , the protein is digested and the resulting peptides are mass measured with lc-esi-ms . the raw ms data and search result files are then converted into the common file formats mzxml and pepxml, respectively . the peptides of interest are selected from the search results to create the peptide set . some experiments may focus on a narrow region of the protein, in which case sequence coverage may not need to be comprehensive. other experiments may require full protein sequence coverage, resulting in a larger peptide set. it is for these reasons that the validation and curation of the peptide set is currently the user's responsibility. the deuterator then retrieves each search result, and uses the protein sequence data and mzxml files to proceed with positional determination, peak identification and centroid calculations . the details of this method will be further discussed. resulting data are then made available, and the curated results can then be sent to statistical interrogation and visualization tools . third party applications are then used to visualize the results such as graphs in microsoft excel and 3d structure overlays in pymol  <cit> . our software facilitates determination of h/d exchange rates and also facilitates differential h/d exchange analysis between multiple treatment conditions .

data processing
there are three user inputs into the deuterator: 1) the mass spectrometry data files ; 2) the protein sequence file in fasta format; and 3) a list of the peptides to be included in the h/d exchange experiment that we refer to as the "peptide set".

it is important to note that the comprehensive list of peptide identifications from a database search may not reflect the concise list of peptides of interest for h/d exchange experiments. for instance, some peptide identifications with poor search scores are often not correct, while other peptides identified may lie outside the experimental region of interest. for these reasons, we convert the pepxml search results into the common file format , and enable manual curation of the "peptide set" prior to import into the deuterator .

once input, the processing begins, and the "peptide set" is initially grouped according to sequence and charge and any redundancy is removed . peptide sequence, charge and retention time are the only data needed for processing, so in cases where these fields are identical, only one row is needed for representation. in cases where there are differing spectrum query times, the average of the group is preserved. optionally, the score from the peptide search result, if available, can be preserved and represented in the deuterator interface. the positional information for each peptide is obtained from the protein sequence located within the fasta file and entered into start and end data fields. for each peptide the monoisotopic neutral mass is calculated and entered into the mass data field. this is achieved by the summation of each residue mass, adding the mass of h2o to the result . a chromatographic retention time  window for each peptide is defined by rtstart and rtend. these values represent the query-spectrum retention time of the peptide in the pepxml file ±  <dig>  minutes and function to allow for some temporal variability in the chromatographic step. all data fields are displayed to the user in the "grid view" , which also contains additional data fields for each peptide; mz <dig>  mz <dig>  mzstart, mzend, %d and centroid.

accounting for the charge state of the peptide, the 0% deuterium incorporation minimum, mz <dig>  is defined as being the mass to charge ratio  value for the peptide's monoisotopic m/z. the 100% deuterium incorporation m/z limit, mz <dig>  for the given protein segment is then calculated according to equation where n = number of amino acids in the peptide, p = the number of non-n-terminal prolines, and z = charge.

 mz <dig> = mz <dig> + /z) 

the amino acid proline has no amide hydrogen and so they are subtracted from the equation. the subtraction of  <dig> in the equation is explained elsewhere  <cit> . the values of mz <dig> and mz <dig> are used in subsequent calculations and are presented in the interface to serve as positional markers. these values are different from mzstart and mzend, which are the user-defined limits of the mz range, used to define the centroid calculation.

the software determines the average intensity of observed ions with given m/z values within the m/z and rt ranges defined by rtstart and rtend mzstart and mzend. the average intensities of ions with given m/z values are derived by dividing the summed total of their observed intensities by the number of contributing spectra in native or profile mode. the end result is a series of mass-intensity pairs, called the "co-added" data that represents the isotopic distribution of the peptide ion of interest. the co-added data is displayed in the appropriate spectral viewer. figure  <dig> shows examples of low , and high  resolution data. to assess the accuracy of the rt window we present an extracted ion chromatogram above the spectral viewer .

deuterium exchange calculations
the calculation of the amount of backbone deuterium exchange can be accomplished using one of two methods, the "centroid" method or the "theoretical fit method".

for the theoretical fit method we followed the approach previously described  <cit> , where the theoretical isotopic envelope is fit to the observed data at varying levels of deuterium incorporation. a number of approaches to calculate the natural isotopic envelope have been described  <cit> . our method determines the natural isotopic envelope of the undeuterated peptide ion, by first determining its chemical formula, and submitting it to the available software package qmass  <cit> . the isotopic abundance calculations from this software are based on the natural abundance ratios of each element, which are stored in a file . to produce a distribution representing a fixed percentage of deuterium incorporation, an entry in the isotope distributions file is created to represent the amide hydrogens, which we label as 'd'. the ratios of 'd' are altered to reflect the desired percentage of deuterium incorporation. for example, to find the isotopic distribution for the peptide sequence "frvse" at 10% deuterium incorporation, one would first determine the chemical formula for the sequence. the resulting formula  is then modified to account for the number of exchangeable hydrogens , to c28h40d4n8o <dig>  the 1h to 2h ratio is then changed to  <dig> / <dig> , reflecting the 10% deuterium incorporation. the resulting qmass theoretical distribution is then scaled to the observed high peak intensity within the predicted theoretical m/z range, smoothed using the normal distribution formula, and aligned according to the resolution of the instrument. least squares is then used to fit the envelope to the observed spectral data by measuring the difference between the y coordinates  of the theoretical and observed plots, squaring them, and summing the result of all y pairs. this process is repeated, iterating through increasing levels of deuterium incorporation , and the lowest score is assumed to be the best fit. the percent deuterium incorporation that produced the best fit is populated into the %d field within the data grid and can be used for downstream calculations. this approach has been incorporated for low-resolution data analysis and is currently being implemented for high-resolution data.

a different approach is taken for the "centroid" method. variables m/z minimum and m/z maximum are initially assigned to mz <dig> - <dig> da and mz <dig> + <dig> da, and are adjustable. xy data between m/z minimum and m/z maximum are used to calculate the intensity weighted mean m/z centroid value. the final centroid result is then used to calculate the percentage of deuterium incorporation with methods outlined previously  <cit> .

for high resolution ms data, the isotopic peaks can be expected to reside within much narrower m/z ranges allowing for precise determination of the weighted average m/z value. peptide ion isotopes are spaced at equal m/z steps according to the charge of the ion. for a doubly charged ion, its isotopes are spaced  <dig>  m/z apart and for a triply charged ion, its isotopes are spaced  <dig>  m/z apart. combining this information with the known monoisotopic mass and charge state of the peptide ion allows the algorithm to predict the central m/z of the first isotope in the distribution, as well as the m/z spacing of the isotopic cluster. an approach using m/z ranges, which we will henceforth call "m/z sub-ranges", is presented here, where the algorithm only considers data residing within a predefined m/z distance from the expected peptide ion center. the sub-range centers are defined by the following equation:

 fi=f0+izi= <dig> ...,imax
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawfqaqaaiabdagamnaabaaaleaacqwgpbqaaeqaaogaeyypa0jaemozay2aasbaasqaaiabicdawaqabagccqghrawkdawcaaqaaiabdmgapbqaaiabdqha6baaasqaaiabdmgapjabg2da9iabicdawiabcycasiabc6cauiabc6cauiabc6cauiabcycasiabdmgapnaabaaameaaiegacqwftbqbcqwfhbqycqwf4baeaeqaaawcbeaaaaa@4488@ 

where f <dig> = mz <dig>  z = charge state, i is an integer, and imax is defined as:

 imax = z  

where α = end m/z. the resulting windows are set to a width based on the desired distance from the peptide ion center to accommodate for the resolution of the instrument. a  <dig>  m/z distance has been shown to be effective for a resolution of ~ <dig> , that generates a baseline peak width of ~ <dig>  m/z. the deuterator uses this number as default. ions with m/z values outside of these sub-ranges cannot arise from the peptide ion of interest and thus they are removed from further consideration. the weighted average of the data within these expected m/z sub-ranges is then calculated. the interface also allows the limits of the m/z sub-ranges to be adjusted, which enables the correct peaks to be extracted from the spectral data. this approach has been shown to correctly distinguish peptides in complex situations such as overlapping peptides or peptide ions with poor signal-to-noise  ratios. the limits of m/z sub-ranges are displayed in the user interface as yellow bars, allowing the visual confirmation of the approach .

main analysis page
it is often beneficial to visually validate and manually curate the data. the main analysis page provides the necessary tools to facilitate the validation, curation and recalculation of the %d and centroid values. this page has three sections: the data grid, the spectral viewer, and the extracted ion chromatogram.

when a peptide row is selected from the data grid, the co-added spectral data for the calculated m/z range of the peptide are presented in the main spectral viewer . the best-fit theoretical isotopic envelope is then overlaid and the sub-ranges are presented for high-resolution data. the indicator bars display the mz <dig>  mz <dig>  m/z, and centroid range positions. adjustment of the m/z range controls allow for zooming in and out of the spectral data. navigation controls are available to further refine the sub-range widths , retention time range, and centroid range of the selected peptide, with the %d and centroid values being automatically recalculated after each refinement. the extracted ion chromatogram  is also populated when a peptide is selected, and the averaged ion intensities for a given mass across all scans is presented. blue bars display the retention time ranges used for the extracted ion plots, and can be adjusted for refinement of the scan range with the best abundance for a given peptide's centroid mass. for example, when the retention time start and end values are equal, the view will represent spectral data from the nearest single scan. when the user has completed data curation, the results can be saved.

synchronization function
adjusting data in the main page can be a lengthy task, especially if there are a large number of curations needed for several experimental repetitions. retention time and m/z ranges for like peptides across replicates are usually consistent. by synchronizing across the replicate data sets the number of manual curations needed is significantly reduced and automated reprocessing of centroid calculations is enabled. the synchronization page provides this functionality by allowing the selection of a "core' time point, a list of "sync" time points, and data column values. the process then adjusts the appropriate ranges and the centroids are recalculated for each peptide row. this has demonstrated to save substantial amounts of time by automating the curation process. a typical experiment produced approximately  <dig> peptides at eight timepoints. each experiment was replicated four times for consistency. in this case  <dig> peptides, each taking one minute to curate with the software, would cost the end user around  <dig> hours. in our tests, the synchronization function has been shown to be effective on roughly 20% of peptides saving over  <dig> hours of manual curation time.

output
once the centroid and %d values for all of the peptides in the peptide set have been determined and saved, the entire grid data can be exported to a common file format. from this point the deuterium content of each peptide is readily calculated using known algorithms  <cit> . generation of deuterium buildup curves using tools such as microsoft excel  is facilitated. high-resolution 3d structural overlays  can be accomplished using tools such as pymol  <cit> .

the deuterator in practice
the deuterator has been used extensively on a number of projects over the last year, one of which has been published  <cit> . another example of these projects was the measurement of perturbation of h/d exchange rates for the nuclear receptor pparγ upon binding of synthetic and endogenous ligands. the aim of this research was to establish the different mechanisms of activation of the receptor upon binding of full and partial agonists. the system has been tested with high and low-resolution raw mass spectral data from thermo electron ltq orbitrap  as well as ltq linear ion-trap . the centroid calculation is a simple weighted average function, and so the validation of the centroid results has been straightforward. the software has been compared to existing tools such as magtran  <cit>  and the results have been shown to be identical. native search engine data from the database search programs mascot and sequest, and x!tandem have also been used with the system. the in-house installation is tightly integrated with commercial lims software , which captures the project files and streamlines automated processing.

future work
rendering components will be built that provide extended graphical capabilities, 2d and 3d color gradient maps, and data grids that convey changes in deuterium incorporation between different experiments. sequence coverage can be presented in the user interface with heat maps, color-coding the rate of exchange. improvements in the preprocessing phase will be implemented which will improve precision and reduce further the need for manual intervention. ongoing tests to increase compatibility with other instrument data formats will be conducted. any future developments to the deuterator will be made accessible to the community.

CONCLUSIONS
the deuterator is a web application presenting integrated and novel functionality in h/d exchange analysis and it is compatible with multiple file formats. the interface presents the centroid results and associated data for each peptide and allows for "drilling-down" and visualization of the mass spectral data. developed to aid scientists at the scripps research institute in the analysis of h/d exchange data, it is freely available online and eventually will be offered as a standalone open source solution.

availability and requirements
project name: the deuterator

project home page: 

operating system: platform independent

programming language: java/jsp

other requirements: n/a

license: available free of charge to academic, government and non-profit users for non-commercial use

abbreviations
da – dalton

esi – electrospray ionization

h/d exchange – hydrogen/deuterium exchange

jsp – java server pages

lc – liquid chromatography

ms – mass spectrometry

m/z – mass-to-charge ratio

nmr – nuclear magnetic resonance

rt – retention time

competing interests
the author declare that they have no competing interests.

authors' contributions
bdp developed the software and wrote the manuscript. mjc provided core requirements and feedback. sab tested the software and provided requirements. mjc and sab acquired all the h/d exchange test data sets. ccm managed the overall software development process and design for the project, and assisted with development. mrs contributed development to the implementation of the external website as well as excel files for rendering h/d exchange data. nft provided essential direction and oversaw all informatics aspects of the project. prg conceived and initiated the h/d exchange program, and was the project manager driving the development of the application. all authors have read and approved of the manuscript.

