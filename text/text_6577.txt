BACKGROUND
random forest   <cit>  and related methods such as conditional inference forest   <cit>  are both tree-building methods that have been found increasingly successful in bioinformatics applications. this is especially true in statistical genetics, microarray analysis and the broad and rapidly expanding area of -omics studies. however, these types of bioinformatics applications often exhibit complex patterns of within-predictor correlation. two recent reports have examined the impact of within-predictor correlation on rf  <cit>  and have arrived at apparently divergent conclusions. both examined whether bias in variable selection during tree-building led to biased variable importance measures  when predictors were correlated. strobl et al.  <cit>  showed larger vims for correlated predictors under ha using cif was due to the preference of correlated predictors in early splits of the trees and the particular permutation scheme employed in the computation of the permutation-based vim. they proposed a new conditional permutation-based vim to circumvent this inflation. in contrast, nicodemus and malley  <cit>  reported that rf prefers uncorrelated predictors over all splits performed in building all trees in the forest under h <dig> and the alternative hypothesis ha  because the splitting rule is based on the gini index. they further reported that, under h <dig>  unconditional permutation-based vims are unbiased under within-predictor correlation for both rf and cif, although gini index-based vims in rf are biased. in a third study, meng et al.  <cit>  suggest a revised tree-building algorithm and vim that suppress the inclusion of correlated predictors in the same tree. their findings indicate that the stronger the association with the response, the stronger the effect predictor correlation has on the performance of rf, which is in accordance to the findings of  <cit>  and  <cit>  with zero to high effects on the response respectively. while the identification of only those predictors associated with the response was found to be aggravated in the presence of predictor correlation, the identification of sets of predictors both associated with the response and correlated with other predictors might be useful, e.g., in genome-wide association studies, where strong ld may be present between physically proximal genetic markers.

to study the reported phenomenon in more detail and to synthesize the results of the previous studies  <cit> , we conducted a simulation study using a simple linear model containing twelve predictors as first studied in  <cit> . this model contained a set of four strongly correlated predictors  and eight uncorrelated predictors  . three of the four correlated predictors and three of the eight uncorrelated predictors had non-zero coefficients. we examined the potential bias in rf and cif during variable selection for the first splitting variable and across all the trees in the forest. we studied the impact of correlated predictors on the resulting variable importance measures generated by the two algorithms, including unscaled, unconditional permutation-based vims , scaled permutation-based vims  and conditional permutation-based vims .

RESULTS
in what follows, the results of rf vim and estimated coefficients of bivariate and multiple linear regression models are compared to the coefficients that were used to generate the data by means of a multiple linear regression model. under the alternative some predictors were influential with the coefficients reported in the methods section. under the null hypothesis all predictors had a coefficient of zero, but the same block correlation structure.

the results are reported in terms of bias in the statistical sense that an estimator is unbiased if, on average, it reproduces the coefficient of the original model used for generating the data, and is biased if it systematically deviates from the original coefficient. however, a key point is whether or not machine learning algorithms, which are by their very nature often nonlinear and nonparametric, should be expected to approximate the linear generating model, or if they contain additional information that may be exploited in the search for highly influential predictors.

predictor selection frequencies
under ha, correlated predictors were selected more frequently at the first split in trees grown with subsets of three and eight  randomly preselected predictors , as reported in  <cit> . this was true for both algorithms. when one variable was selected for splitting , cif selected the four correlated predictors and the three uncorrelated predictors with non-zero coefficients more frequently than the uncorrelated predictors with coefficients =  <dig>  this suggests the p-value splitting criterion in cif is more sensitive to predictor association with the outcome than the gini index used by rf when mtry =  <dig>  because cif selected the associated predictors  more frequently than rf at both the first split and across all splits in the forest .

however, the pattern of selection frequencies using all splits showed the same pattern as reported in  <cit>  for both algorithms . uncorrelated strongly-associated predictors  were selected slightly more frequently across all trees when the pool of potential predictor variables  was set to greater than one because of competition between correlated predictors for selection into a tree . differences from results in  <cit>  are due to different choices in tuning parameters regulating the depth of trees, as further discussed below.

as the number of variables to select from for splitting increased  this preference for uncorrelated predictors was stronger, because the likelihood of more than one correlated predictor being in the pool of available predictors to choose from was greater. further, we observed this same preference for uncorrelated predictors in the first split and across all splits in the tree under h <dig> for both algorithms . in summary, the preference for correlated variables as the first splitting predictor was only induced when the correlated predictors were associated with the outcome. in the next section we explain why this phenomenon was observed here and in  <cit> .

as previously reported  <cit> , we found both algorithms showed increased selection of x <dig>  which had a coefficient of  <dig> in the generating model, versus the uncorrelated predictors with coefficients of  <dig> . here we give a more detailed illustration and explanation of this effect. tree-building uses predictors sequentially in each tree and single predictors that are strongly correlated with the outcome are more likely to be selected at the first split. statistically speaking, in the first split of each tree the split criterion is a measure of the bivariate effect of each predictor on the response, or of the marginal correlation between that predictor and the response. in the case of predictors that are strongly correlated with influential predictors, this univariate or marginal effect is almost as strong as that of the originally influential predictor. in this case, as we show in detail, even though the predictor x <dig> has a coefficient of  <dig> in the generating model, the correlation between x <dig> and the outcome is ~ <dig>  because of the correlation between x <dig> and the correlated predictors  which have non-zero coefficients.

thus, not only the first split of a tree, but also a bivariate linear regression model indicated that predictors that were strongly correlated with an influential predictor - and can thus serve as a proxy for it - is predictive of the response. for example, within the context of a genetic association study, let us suppose there are two snps: snp <dig> and snp <dig>  snp  <dig> is the true causal variant associated with the outcome, which may be disease status or another phenotype, and snp <dig> is in linkage disequilibrium with snp <dig>  in this example, because snp  <dig> and snp  <dig> are correlated with each other, either predictor, considered on its own, may look associated with the outcome.

the fact that in the first split feature selection was only bivariate or marginal is native to tree-building and is not related to properties of the data generating model. however, in the case of linear models it is particularly intuitive that single features can be highly predictive when considered in isolation, even when they appear with small or zero weights in the underlying models having many predictors. therefore, linear models are used both as the data generating process and as a means of illustration here.

bias, 95% coverage and correlation between predictors and outcome under h <dig> and ha
rf and cif consider predictors one at a time during tree-building. in particular, the model is a simple bivariate model at the first split containing the outcome and a single predictor. to better understand the preference for correlated predictors at the first split, we examined the bias, 95% coverage and correlation between the outcome and predictors using the full twelve-predictor model and twelve single-predictor  regression models. we also calculated the true  values of the coefficients and true correlations for bivariate models for each of the predictors and compared those values to the mean value of the bivariate coefficients and correlations observed in our simulations. we further considered a model retaining the same correlation structure but where all coefficients were set to  <dig> .

as expected, when using the full  linear regression model under ha, bias was small and centred around  <dig> , indicating that the linear regression model can reproduce the original coefficients despite the high correlation, as expected since the generating model was linear. ninety-five percent coverage ranged from  <dig> % to  <dig> %, and was centred around 95% for all predictors . however, in the single predictor  regression models, bias was large for correlated predictors, ranging from  <dig>  to  <dig>  higher than the true value from the generating model . the 95% coverage for all four correlated predictors was  <dig> . this effect is known in statistics as a "spurious correlation" where a correlated predictor serves as a proxy and appears to be influential as long as the originally influential predictor is not included in the model. for uncorrelated predictors, the magnitude of the bias ranged from  <dig>  to  <dig>  and the coverage ranged around the expected 95%.

these results are helpful to understand the preference for correlated variables at the first split in trees. at the first split, rf and cif are simply a bivariate model containing the outcome and one predictor. as illustrated by means of the bivariate regression models, from this bivariate or marginal point of view the correlated predictors are actually more strongly associated with the outcome than the uncorrelated predictors. this explains why they were preferred at the first split, which we illustrate further below.

another way to assess the first split preference of rf/cif for the correlated predictors - especially for the correlated predictor which had a  <dig> coefficient in the generating model  - is to calculate the mean bivariate or marginal correlation coefficient between each predictor and the outcome compared with the true value . this showed again that, from the bivariate or marginal point of view, the correlated predictors  were much more strongly correlated with the outcome  than the uncorrelated predictors with - <dig> coefficients  or the uncorrelated predictor with - <dig> coefficient . the observed values from our simulations were virtually identical to the true values, as expected. in addition, we calculated the true value of each coefficient using a single variable model and compared this value with the mean observed value from our simulations. these two values were also nearly identical .

under h <dig>  the magnitude of the bias for correlated predictors in the full model ranged from  <dig>  to  <dig>  and was similar in the single variable models. for uncorrelated predictors the magnitudes were also similar, and 95% coverage was appropriate for all predictors . since the generating model did not contain an intercept, we re-calculated bias and 95% coverage using an intercept-free model which revealed similar results .

unconditional and unscaled rf variable importance measures
unscaled vims for rf under ha using one variable to select from at each split  showed behaviour intermediate to the bivariate models and the full regression model shown in the above section . larger vims were observed for the correlated variables versus uncorrelated predictors, regardless of generating model coefficient, as in  <cit> . the correlated predictors with the largest - coefficients  showed larger vims than correlated predictors with coefficients of  <dig>  or  <dig> , but the latter showed higher vims than uncorrelated predictors with the same coefficients.

as the number of variables to select from at each split increased , the vims for the correlated predictors approached the coefficients in the generating model . in other words, the vims for the correlated predictors with  <dig> or  <dig> coefficients  were reduced relative to those with larger coefficients  regardless of correlation. this is particularly true when eight variables were randomly selected at each split. the vims for the correlated predictors were often larger than those for the uncorrelated due to the stronger association between correlated variables and outcome when only a single correlated predictor is considered. as we showed above, this is often the case, because they are most often selected at the first split, as in  <cit> .

to ascertain whether rf unconditional unscaled permutation-based vims were biased under predictor correlation under h <dig>  we conducted the same analysis under h <dig> . this is an important aspect because a bias under the null hypothesis would mean that one would be mislead to consider some predictors that are correlated as influential, even if all predictors were random noise variables. we observed a negligible inflation in vims for the correlated predictors of approximately  <dig> . this inflation was relatively invariant to the number of splitting variables used.

unconditional scaled rf variable importance measures
as previously shown  <cit> , in the regression case the rf scaled variable importance measures grew larger with the number of trees grown . in addition, we show here that they were also sensitive to predictor correlation . under ha, vims for the uncorrelated but strongly-associated predictors  were the largest because these variables were selected more frequently, thus their empirical standard error was smaller. the scaled vims were calculated using:  

for each vim. under h <dig>  the scaled vims for the correlated predictors are inflated relative to the uncorrelated predictors, which was due to the fact that the unscaled correlated predictors are always non-negative . thus, the magnitude of the scaled predictors was dependent on the size of the forest  <cit>  and the correlation between predictors.

unconditional unscaled cif variable importance measures
for cif, unconditional vims under ha were very similar to those obtained using the unscaled vim in rf . indeed, the rankings of the importance measures did not differ between the two algorithms under any value of mtry. even the magnitude of the vims was similar between the two algorithms when using three or eight variables for splitting. in other words, under ha, the values of the unconditional vims from both algorithms reflected an intermediate step between single predictor linear regression models and the full twelve-predictor linear regression model, with the values for the correlated associated variables larger than for the uncorrelated associated ones.

under h <dig>  cif showed an even smaller bias in inflation of vims for the correlated variables. the median difference between the vims for correlated versus uncorrelated variables when selecting from three predictors to split on at each node was  <dig> ·10- <dig> and with eight predictors it was  <dig> ·10- <dig>  therefore, we did not observe substantial bias in unconditional permutation-based vims for either algorithm under h <dig> 

conditional unscaled cif variable importance measures
using the conditional vim from cif and randomly selecting a single variable to split on at each node  we observed a similar pattern to the unscaled unconditional vims from both cif and rf . when the number of variables to randomly split on was larger  we observed an inflation in the median vims for the uncorrelated strongly-associated variables  relative to those observed for the correlated variables that were strongly-associated . the inflation in the median vims for the uncorrelated strongly-associated variables  is contrary to the inflation found for the correlated strongly-associated variables  for the unconditional unscaled vims. however, neither pattern is consistent with the full generating model. it should be noted that the variability of the conditional vims for the uncorrelated strongly-associated variables  is very high , so that the inflation is less pronounced than for the correlated strongly-associated variables  using the unconditional vims. this increased variability, which was not found in  <cit> , may be attributable to the use of larger trees in the present study and is currently the topic of further research. under h <dig>  the conditional vims showed a negligible bias similar to the unconditional permutation-based variable importance measure from cif: with mtry =  <dig> it was  <dig> ·10- <dig> and with mtry =  <dig> it was  <dig> ·10- <dig> 

CONCLUSIONS
both algorithms, rf and cif, more frequently selected correlated predictors at the first split in the tree, as previously reported  <cit> . as we showed, these predictors were more strongly associated at the bivariate or first-split level than the uncorrelated predictors associated with the outcome . across all splits in the forest under ha, cif and rf showed variable selection frequencies relatively proportional to the effect size of the predictors. however, we observed a slight preference for selection of uncorrelated predictors as shown in  <cit> , and this was true under both ha and h <dig> 

unscaled permutation-based vims were found to reflect an intermediate step between the bivariate and multivariate linear regression model coefficients. we did observe a very slight inflation in these vims for correlated variables under h <dig>  however, the difference between the median vim for correlated versus uncorrelated predictors was less than  <dig> . these results highlight the importance of using monte carlo simulation to assess the size of observed vims relative to those obtained under h <dig> in applied studies. further, the selection of the numbers of variables to randomly use at each split  should be empirically assessed when correlation between predictors is present, as we show that a large value can lead to inflation for the correlated predictors using unconditional vims  whereas the opposite was observed for the conditional vims .

our results regarding the scaled vim from rf agree with those of  <cit> , who recommended the use of the unscaled vim for regression. we also found the scaled vim was dependent on forest size  <cit>  and, as shown here, also dependent on predictor correlation. this was the only vim showing substantial bias under h <dig> 

the conditional vim from cif appeared to inflate the uncorrelated, strongly-associated  predictor estimates of importance  relative to that of the correlated, strongly-associated predictors . however, we found it, at present, computationally intractable for large datasets: we calculated the other vims on the full set of observations  whereas we were only able to calculate the conditional vim on a subset  of observations.

one of the key aims of the study was whether the original rf vim, whose behaviour in the presence of correlation is situated between that of bivariate and multivariate regression models, may be preferable to the conditional vim, whose behaviour is situated closer to that of multiple regression models. the latter may be preferable in small studies where the aim is to uncover spurious correlations and identify a set of truly influential predictors among a set of correlated ones. however, in large-scale screening studies, such as genome wide association studies, the original rf vim may be better suited to identify regions of markers containing influential predictors, because in this case correlation is usually a consequence of physical proximity of loci and thus may help localise causal variants. since rf and cif are nonlinear and nonparametric methods they may not be expected to exactly reproduce inferences drawn from linear regression models. in fact, we would argue that these algorithms may provide a more effective first stage information-gathering scheme than a traditional regression model. this would be especially true as the number of predictors increase, such as in the current era of genome-wide association studies or microarray studies  <cit> .

