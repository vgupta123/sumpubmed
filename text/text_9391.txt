BACKGROUND
high density genetic linkage maps are important tools for qtl fine mapping, map-based cloning, comparative genome analysis and the integration of genetic and physical maps. several genetic linkage maps based on various markers technologies are now available for perennial ryegrass  <cit> . these maps of moderate marker densities have proved valuable for mapping qtl to broad genome regions. public marker resources recently established provide the opportunity to increase marker density of these maps, thereby improving map resolution  <cit> .

for example, the genetic linkage map of the perennial ryegrass mapping population vrna has initially been used for a qtl study to characterise vernalization response and contained  <dig> markers spanning  <dig>  cm with an average distance between markers of 5 cm  <cit> . this map has been complemented over time with candidate gene-based caps markers to study disease resistance traits  <cit>  and contained around  <dig> markers with total map length of 487 cm when used to evaluate seed yield and fertility traits  <cit> . recently, the same map has been used to localise genes involved in water stress and contained  <dig> markers, between  <dig> and  <dig> on each linkage group , spanning a total of 736 cm  <cit> .

among the different marker technologies available to increase the density of a genetic linkage map, snps have attracted much interest, mainly for two reasons: firstly, snps are the most abundant form of genetic variation  <cit>  and occur at regular intervals in the genome  <cit> . secondly, snps are highly suitable for multiplexed genotyping assays on mass spectrometry, microarray or beadarray-based platforms  <cit> . advancements in these technologies has enabled increased throughput at low cost per data point.

the potential of snps for extensive genome analysis has been impressively demonstrated in model plant species such as arabidopsis thaliana, rice , and maize , where fully sequenced genomes resulted in the identification of millions of snps suitable for genome-wide association studies and molecular breeding concepts such as genomic selection  <cit> .

in species where a reference genome sequence has not been established yet, several strategies for large-scale snp discovery have been reported, mainly being divided into in vitro and in silico approaches. amplicon resequencing is an in vitro approach and has proven very reliable for snp identification with a false discovery rate usually below 5%  <cit> . furthermore, cloned pcr fragments and allele-specific sequencing allow haplotype identification at sufficient read lengths and the discrimination of orthologous  and paralogous  sequences. however, amplicon resequencing requires an enormous effort for large scale studies, since each gene needs to be amplified individually and thus might have limited application in the future. despite the labour intensive nature of amplicon cloning and sequencing, this has been the method of choice for snp discovery in ryegrasses to date  <cit> . for in silico snp discovery, the rapidly growing public est databases can be exploited as a potential sequence resource  <cit> . this approach has been applied in other poaceae crop species including wheat   <cit>  and barley   <cit> . however, availability and quality of public ryegrass est sequences are often limited and it might be difficult to obtain a sufficient number of est reads from the same gene, a key factor for reliable in silico snp identification  <cit> . as a result of these limitations, the percentage of false discovery rates is often considerably high and can vary between  <dig> and 50%  <cit> . recent advances in ngs opened up the opportunity for whole genome resequencing as an extremely powerful strategy for in silico snp discovery at appropriate sequence coverage. however, de novo assembly of short ngs reads is difficult in outbreeding species with a highly heterozygous, large and complex genome containing a high degree of repetitive elements. moreover, whole genome resequencing may not be necessary to target recombination blocks present in bi-parental mapping populations. therefore, different strategies for complexity reduction such as reduced representation libraries  have been proposed to sequence only a subset of the genome for snp discovery  <cit> . rrls have been applied in a wide range of plant species such as maize  <cit> , rice  <cit> , grapevine species   <cit> , common bean   <cit>  and soybean   <cit> . another strategy for complexity reduction is transcriptome sequencing  <cit> , where expressed genes are targeted and highly repetitive non-transcribed genomic regions are excluded. this emerged as an efficient method for the high-throughput acquisition of gene-associated snps  <cit> .

for snp genotyping in a scale up to  <dig>  snps, the illumina goldengate technology  <cit>  has successfully been used in several crop species. in diploid barley, for example, custom oligo pool assays  have been designed to estimate linkage disequilibrium  in inbred elite varieties  <cit>  and for genetic linkage mapping  <cit> . recently, two validated  <dig> -snp barley opas  were made available to the barley community as an excellent marker resource in terms of distribution and density in the barely genome, technical performance and biological importance  <cit> . in more complex genomes such as soybean, goldengate genotyping has been used for linkage mapping in recombinant inbred line mapping populations  <cit> . while also being autogamous, soybean contains around twice as many gene paralogues  when compared to 16% in barley  <cit> , which is known to affect the success rate of multiplexed high-throughput genotyping methods  <cit> . however, the rate of 89% successfully scored snps indicated that the genome complexity of soybean had limited impact on goldengate performance in a carefully selected snp panel  <cit> . in maize, the genome contains about 80% repetitive sequences and a similar amount of paralogous sequences as soybean  <cit> , but a substantially higher intraspecific genetic variation  <cit> . despite this, opas containing  <dig>  snps designed from publicly available snps  are routinely used for diversity, linkage and association analysis, as well as for ld estimations  <cit> . to date, the goldengate assay proved even successful for snp genotyping in tetraploid and hexaploid wheat lines  <cit>  and allopolyploid brassica napus <cit> .

encouraged by this, we developed the first open access lolium 768-snp opa  for the allogamous forage grass species l. perenne with a genome size and complexity comparable to maize. specifically, we aimed at  developing an efficient strategy for in silico snp discovery based on next generation transcriptome sequencing,  implementing a pipeline for successful opa design,  getting first insights to cross-species amplification rates of ryegrass snps and  constructing a high density est map in perennial ryegrass as a promising tool for qtl fine mapping, map-based cloning and comparative genome analysis.

RESULTS
snp discovery
a comprehensive est collection consisting of a total of  <dig>  ryegrass ests generated by sanger sequencing was subjected to quality filtering and vector clipping, resulting in  <dig>  high-quality est reads of  <dig>  mbp nucleotide information  <cit> . a de novo assembly using the phred, phrap, and cross_match software packages resulted in  <dig>  non-redundant contigs and singletons with an average length of 889 bp, thereafter referred to as unigene set.

for snp discovery,  <dig> gs flx transcriptome sequencing of the parents of vrna and a ryegrass genotype that has been inbred for six generations was performed. in total,  <dig>  high-quality reads with an average read length of 377 bp were aligned against the unigene set. a minimum of four reads at the snp position and at least two reads for each snp variant was required for snp calling. a total of  <dig>  snps in  <dig>  of these unigenes met the stringent snp calling parameters, out of which one snp in each unigene was selected for further analysis.

snp selection, validation and lolium oligo pool assays  design
out of a total of  <dig>  snp-containing unigenes,  <dig>  were discarded because  the detected snps were located within a distance of 30 bp to the sequence end or intron/exon splice junctions estimated by blastn analysis against the rice genome sequence,  additional snps and/or indels were observed within a distance of 30 bp to the target snp, or  the reference inbred genotype revealed allelic sequence polymorphisms, indicating the presence of similar but non-allelic sequences in the alignment. for another  <dig> unigenes , no significant  sequence similarities to the rice genome sequence were found by blastn analysis, making a proper positional prediction of intron/exon splice junctions impossible. moreover, sequence reads from only one parental genotype were observed for  <dig>  of the snp-containing unigenes.

in order to validate the remaining  <dig>  snps prior to the goldengate assay, a subset of  <dig> randomly selected snps were tested either by direct sequencing of pcr fragments amplified from the mapping parent being polymorphic for the respective snp or by high resolution melting  curve analysis of short amplicons covering the predicted snp polymorphism . as a result,  <dig>  out of the  <dig> examined snp candidates were experimentally confirmed and represented biological snps. sequencing failed for two snps and an additional three  were monomorphic. these five snps were excluded from further analysis.

the remaining  <dig>  snps were subjected to functionality score calculation by illumina technical service, out of which  <dig>  yielded scores lower than  <dig>  and were, therefore, discarded. for eight out of  <dig> unigenes, two snp markers were selected for genotyping. finally,  <dig> snps satisfying the stringent selection criteria were used to design the 768-plex lopa <dig> 

goldengate genotyping and allele calling
the goldengate assay failed for  <dig> out of  <dig> genotyped snps  and poor or inaccurate fluorescent signals were detected . of the remaining  <dig> snps,  <dig>  did not form clusters reliably separating genotypes and/or revealed cluster separation scores lower than  <dig>  . additional  <dig> snps  were monomorphic in the mapping population . the remaining  <dig> snps  were segregating either in one  or in both mapping parents  and were available for genetic linkage mapping.

the two duplicated parental genotypes of the vrna mapping population revealed highly consistent calls. for successfully genotyped snps, the frequency of missing values  was below  <dig> % within the mapping population.

genetic linkage map
the mapping data of the vrna map described in jonavičienė et al.  <cit>  and the  <dig> unigene snps were combined and grouped based on independence lod scores. markers were assigned to lgs at a lod ratio threshold of  <dig>  with the exception of lg <dig> and lg <dig>  for which a lod ratio threshold of  <dig> was necessary to separate the two lgs from each other. fourteen snps failed to group with existing markers and were, therefore, excluded from mapping. thus, a total of  <dig> snp loci associated with transcribed genes  were located on the genetic linkage map . the resulting vrna map contained  <dig> dna markers, ranging from  <dig> on lg  <dig> to  <dig> on lg  <dig> with an average of  <dig> markers per lg, of which a total of  <dig> are gene-derived ssrs, snps or caps markers . markers were clustered around centromeric regions . in order to estimate the accuracy of marker positions,  <dig> unigenes  were mapped based on more than one snp. all snps derived from the same unigene mapped with a distance of  <dig>  cm, four of them within less than  <dig>  cm. similarly, two caps and a snp marker derived from the lpvrn <dig> gene mapped within less than  <dig>  cm, whereas a caps and a snp marker for lpco mapped within the same cm. another set of  <dig> snps were derived from unigenes previously mapped by est-ssrs  <cit> , allowing to compare performance and accuracy of ssr and snp markers for genetic linkage mapping. of the  <dig> comparisons,  <dig>  mapped within  <dig>  cm and only three that were located at the telomeric ends of the lgs, differed more than 3 cm. the slightly higher discrepancy of snp and ssr map positions was an effect of the higher mv rate observed during ssr genotyping .

of the  <dig> non redundant expressed genes mapped in vrna,  <dig>  revealed significant  sequence similarities in a blastx search against the non-redundant  protein database of genbank, out of which  <dig>  corresponded to genes with known molecular functions active in different cell components . unigenes were grouped in functional classes representing binding and catalytic activities , structural molecule activities , transport activities , molecular transducer and transcription activities , enzyme regulatory activities , as well as genes involved in nutrient uptake and transport .

the total map length was 750 cm, ranging from 63 cm on lg <dig> to 151 cm on lg  <dig>  with an average marker distance of less than  <dig>  cm .

intra- and interspecific cross amplification
in addition to the vrna mapping population including parental and grandparental genotypes, eight parental plants of four different perennial ryegrass mapping populations, one parent of the p150/ <dig> intraspecific ilgi reference population  <cit>  and the two parental genotypes of the italian ryegrass  mapping population xtg-art  <cit>  were used for genotyping. this allowed an estimation of the transferability of these snps to other genetic backgrounds. of the  <dig> successfully genotyped snps,  <dig>  detected reliable polymorphisms in at least one of the four additional perennial ryegrass mapping populations ,  <dig> of them  were segregating in all populations. a total of  <dig> snp markers  detected polymorphisms segregating in xtg-art . interestingly, marker pta. <dig> c <dig> failed goldengate genotyping for perennial, but produced clear calls for the two italian ryegrass plants. markers pta. <dig> cb <dig>  pta. <dig> c <dig>  pta. <dig> c <dig>  pta. <dig> c <dig>  pta. <dig> c <dig>  pta. <dig> c <dig>  pta. <dig> c <dig>  pta. <dig> c <dig> and r_005b_a <dig> were monomorphic in perennial ryegrass with a distinct genotype in italian ryegrass. pta. <dig> c <dig> and pta. <dig> c <dig> were monomorphic in perennial ryegrass but segregated in the italian ryegrass mapping population xtg-art.

*mapping populations with different letters vary significantly at p < = <dig>  in their average call rates.

†estimation from one parent only.

snp performance of lopa <dig> in vrna was compared to different lolium multiflorum lam.  and lolium perenne l.  mapping populations, each represented with the two parental genotypes. for each mapping background, the average call rate of all snps is given and varies significantly at p < = <dig>  if indicated with different letters. snps with a clear fluorescent signal detected in both mapping patents are considered as “snps generating signals”. the numbers and percentages of polymorphic snps refer to snp markers being heterozygous either in one or both parents, indicating a segregation pattern of lmxll, nnxnp or hkxhk  <cit> , respectively, in the corresponding mapping population. for the ilgi reference population represented with one parental genotype only, the number of snps being heterozygous is given. the percentages of polymorphic snps are refereeing to the number of snps generating signals and the total number of snps on lopa <dig> 

discussion
in recent years, technological advances in methods for high-throughput detection and genotyping of snp markers have initiated a novel era in using molecular markers for genome analysis and breeding applications  <cit> . but still, the use of snp markers for large-scale genome studies in allogamous forage grass species such as perennial ryegrass is still in its infancy. this is due to the low number of publicly available snps and the challenge of efficient snp discovery and genotyping in a highly heterozygous genome containing a high proportion of repetitive elements and paralogous sequences. here, we present both; an efficient snp discovery pipeline based on  <dig> gs flx transcriptome sequencing, and an illumina goldengate assay to genotype, validate, and map the identified snps in the two way pseudo-testcross population vrna.

genic snp discovery in complex genomes
transcriptome resequencing strategies and subsequent in silico snp discovery have emerged as an efficient strategy for large-scale snp discovery  <cit> . however, time and cost benefits are counterbalanced by a higher false discovery rate compared to in vitro approaches  <cit> . incorrectly detected snps are primarily due to paralogous gene sequences interfering with the assembly of short ngs reads. in the present study, this was resolved by using a ryegrass unigene set with an average length of 889 bp as a reference for the assembly of the shorter  <dig> gs flx transciptome reads. the power of such an approach to separate paralogous sequence variation has recently been shown in salmonids, whose genome contains a high degree of paralogous sequences due to a recent whole genome duplication event  <cit> . moreover, a highly inbred ryegrass genotype was included for transcriptome sequencing as a means to identify paralogous genes and sequences from highly conserved domains of gene families in the alignment. as the inbred genotype was self-pollinated for six generations, the overall degree of heterozygosity is less than  <dig> %. genes that showed polymorphisms in reads from the inbred genotype indicated the presence of similar, non-allelic sequences and were therefore discarded for snp discovery, thereby providing a reliable tool not only to reduce false positives in snp discovery but also to facilitate the identification of genotype clusters during snp genotyping.

sequencing errors may represent an additional source of false positive snps. even though error rates of ngs platforms are low   <cit> , a combination of sanger sequencing  and ngs  was applied. error rates of such combined sequencing approaches are even lower and thus an insignificant source of false-positive snps  <cit> . as a result, the present study revealed a false discovery rate  of less than 12%, even lower than the initial estimation of 14%. the proportion of successfully called to finally mapped snps of 72% is comparable or slightly higher to validation rates between 57% and 77% observed in other species such as brachypodium distachyon <cit>  or rye   <cit> . in conclusion, sequencing depth and a proper handling of paralogous sequences go hand in hand and are key factors for successful in silico snp discovery approaches based on rna-seq. in future, large scale ngs achieving longer read lengths and higher throughput in combination with improved assembly algorithms will provide opportunities for similar in silico snp discovery approaches in less characterized species.

lolium oligo pool assays  design for ryegrass snp genotyping
highly multiplexed illumina snp arrays are efficient tools to enhance mapping of expressed genes, thereby improving the resolution and usefulness of a genetic linkage map  <cit> . the use of a community opa containing validated and well-performing snps as available for barley  <cit>  is straightforward. however, the high calling rate  is often compromised by a lower conversion rate , as these snps were not a priori screened for polymorphisms within a particular mapping population. this was observed in barley, where approximately 51% of snps in the bopa <dig> were polymorphic in a barley doubled haploid  population  <cit> . similarly, high calling  but limited conversion rates  were obtained when de novo opa design was based on validated snps selected from public databases  <cit> . the percentage of polymorphic snps was even lower in pinus and picea species and ranged between  <dig> to 19%  <cit> , which might be an effect of the very large and complex genomes  <cit> , as well as limited sequence resources established for these species.

in contrast, much higher rates of polymorphic snps can be achieved by transcriptome resequencing of parental genotypes in the target mapping population, allowing the design of customized opas containing snps that are segregating in the mapping pedigree. while this was very efficient to generate informative snps for linkage mapping, it might compromise the transferability of these snps to different genetic backgrounds. given the high impact of additional polymorphisms in the flanking sequence of the target snp on genotyping performance  <cit> , intra- and interspecific snp amplification rates in ryegrass might per se be lower when compared to inbreeding species due to increased nucleotide diversity present in outbreeding species. the detected  <dig>  snps in  <dig>  unigenes  reflected the high nucleotide diversity present in a set of only four haplotypes. nevertheless, the percentage of snps generating clear fluorescent signals  was high in other italian and perennial ryegrass backgrounds. estimated rates of polymorphic snps ranging up to 33% indicate that lopa <dig> can be applied to different genetic backgrounds. however, a more detailed study based on larger collections of various ryegrass genotypes will be required to confirm the significance of the reported snp markers for broad-scale applications in ryegrasses. with the aim to further improve our in silico snp discovery pipeline, the  <dig> snps failing goldengate genotyping were further examined and mapped back to genomic dna. interestingly, over 90% of these  <dig> snps had exon-intron boundaries within 20 bp flanking the target snp . this highlights an important drawback when developing snps from transcriptome sequencing data and indicates that blastn analysis to the rice genome sequence was inefficient to identify introns in ests for about 10% of the unigenes. a reference genome sequence will prove very useful to exactly locate intron-exon junctions for future large-scale snp discovery studies.

implications of the transcriptome map for ryegrass genetics and genomics
the ryegrass transcriptome map displays the genetic location of  <dig> expressed genes putatively underlying specific biochemical or physiological functions that control variation for agronomically important traits. the vrna population has already proven to be valuable for mapping and cloning of major genes associated with meristem identity and the control of floral transition such as lpvrn1lpco, and lpvrn <dig> <cit> . for the same traits, the present transcriptome map contains additional candidate genes such as the terminal flower1-like gene  that is a well characterised repressor of flowering and a controller of axillary meristem identity in ryegrass  <cit> , and a homologue of the triticum monococcum l. gene tmvil <dig>  that is up-regulated by vernalization  <cit> . the arabidopsis homoloque of vil <dig> is known to mediate chromatin modifications for stable repression of the flowering locus c . interestingly, the ryegrass homologue of tmvil <dig>  mapped close to the centromere on lg <dig>  syntenic to the map position of tmvil <dig> in t. monococcum.

another key trait that relates to vernalization response is fructan content, and the accumulation of fructans during cold acclimation. fructans are known to play a key role in crop plants in response to abiotic stress in general, including drought, cold and freezing tolerance in particular  <cit> . in the present study, previously characterised, as well as novel genes involved in fructan biosynthesis were mapped, providing the opportunity to study fructan related metabolic processes involved in abiotic stress tolerance of grasses. this might be of particular interest since the vrna grandparents – originating from different geographical latitudes – are not only significantly contrasting for their vernalization requirement, but also for the ability to accumulate fructans during cold acclimation, as well as in the response to drought treatment . thus, given the high degree of segregation for traits such as abiotic stress tolerance and fructan accumulation in the vrna population, it does represent a unique tool to unravel the gene regulatory networks of these traits.

similarly, the current map contains genes involved in resistance to various biotic agents. apart from the previously published nbs-lrr homologues  <cit> , the map locates elements from disease resistance signal transduction pathways  that were shown to be up-regulated after xanthomonas translucens pv. graminis  infection causing bacterial wilt  <cit> . another gene showed high sequence similarity to members of the family of germin-like proteins  that are known to be involved in broad-spectrum basal defence against various pathogens and are also induced upon abiotic stress  <cit> .

other research groups can take advantage of this resource by using the unigene sequence information to develop simple ‘blind mapping’ hrm assays  <cit>  to map a well distributed subset of the markers in their favourite mapping populations. this can then aid the transfer of information between different populations and species. the transcriptome map also serves as a source of candidate genes involved in various biological processes and molecular functions for association mapping. with an average marker distance of less than  <dig>  cm, the presented vrna map represents a good starting point for the establishment of bac contigs for any genomic region of interest and will, in combination with the in-house bac library established from one vrna parental genotype  <cit> , provide a very efficient toolbox for map-based cloning and gene isolation. however, it is worth noting that markers were not evenly distributed along the lgs, but clustered around the centromeres. clustering of genes towards genetic centromeres due to low recombination frequencies is well known and has been described in barley  <cit>  and brachypodium  <cit> . as a consequence, some markers at the centromeres could not be separated by  <dig> mapping individuals and co-segregated within recombination blocks. thus, effects of mv in mapping data became more apparent and single mv resulted in slight changes of map positions, thereby explaining mapping discrepancies of two markers derived from the same unigene. we conclude that the current linkage map comes close to saturation of markers, at least in centromeric regions, and rather more mapping individuals than more markers would further improve map resolution. however, besides the general tendency that recombination frequency is reduced at genetic centromeres, it can vary dramatically along the chromosome  <cit> . in silico mapping of the unigene sequences to the ryegrass genome sequence, when available, will help resolve to what extent recombination frequencies vary along the chromosomes in greater detail, and will be valuable for ordering and orientation of scaffolds into pseudomolecules during the assembly of a ryegrass reference genome.

the availability of fully sequenced model grass genomes such as rice, brachypodium, maize, and sorghum  enables efficient exploitation of grass genome sequence resources for genetic and breeding applications in ryegrasses. once established, syntenic relationships allow transferring map and marker information from related species across conserved genome regions  <cit> . early comparative studies between the pooideae tribes triticeae and poeae relied on restriction fragment length polymorphism  markers mapped across different species and found that the genetic maps of perennial ryegrass and the triticeae cereals are highly conserved in terms of orthology and colinearity  <cit> . however, these results were obtained from low-resolution genetic maps containing a limited number of anchor rflp markers that allowed the detection of large rearrangements only, thereby missing a substantial part of the existing micro-synteny. map and sequence-based markers presented here provide the opportunity to update and redefine synteny between ryegrass and the fully sequenced model grass genomes at a higher level of resolution to address micro-colinearity structure.

future prospective of high throughput snp discovery and genotyping
the advancements in sequencing and genotyping technology were a prerequisite for the work described here, and further improvements in throughput of ngs instruments can be expected. combined with decreasing costs, it is worth considering genotyping by sequencing  approaches, thus by-passing the necessity for array-based genotyping  <cit> . in this case, we move straight to genotyping by means of sequencing all individuals of a mapping or association panel. gbs strategies will prove extremely powerful for genome-wide association studies and for plant breeders moving towards implementing genomic selection in their breeding programmes  <cit> .

however, whole genome resequencing may not be necessary when working within bi-parental mapping populations, where – depending on the population size – a finite amount of recombination and genome reshuffling is present. thus, only snp numbers adequate to cover the recombination blocks in the population are required. in this case, it may be sufficient to sequence a well distributed portion of the genome in all individuals  <cit> . a cost-effective approach of genotyping by sequencing on a small portion of the genome has recently been described and demonstrated in both maize and barley mapping populations  <cit> . the method described the use of a simple bar-coding strategy that allowed a high-level of multiplexing  and enabled mapping of approximately  <dig>  and  <dig>  sequence tags in maize and barley, respectively. with the increasing throughput of ngs, the authors envisage multiplexing up to  <dig> samples per lane, and thus pushing genotyping to under $ <dig> per sample. although a reference genome is not necessarily required for this approach, it does allow for the use of genotype imputation methods when coverage is low.

armed with these new powerful genotyping tools we can begin to reconsider how we construct mapping populations in order to improve power and precision. it will now be possible to densely genotype much larger populations for both bi-parental and association mapping studies, with the need for quality phenotyping remaining the sole bottleneck.

CONCLUSIONS
this study demonstrates the efficiency of using next generation transcriptome sequencing to discover gene-associated snps in species where no reference genome sequence has been established yet. in addition, we describe a workflow on how to successfully use the illumina goldengate technology in outbreeding species characterized by highly heterozygous, large and complex genomes. we have also demonstrated the transferability of these snps to other perennial and italian ryegrass mapping populations. the resulting map locates candidate genes for agronomically important traits and – at the given map resolution – represents a promising starting point for qtl fine mapping, ld-based association mapping, and map-based cloning via bac clone isolation and sequencing. moreover, the present est map provides new anchor points for detailed studies of comparative grass genomics that will prove useful for future ordering and orientation of scaffolds into pseudomolecules during the assembly of a ryegrass reference genome.

