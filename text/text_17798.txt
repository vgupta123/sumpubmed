BACKGROUND
constraint-based modeling techniques such as flux balance analysis  have become central to systems biology  <cit> , enabling a wealth of informative simulations of cellular metabolism. many constraint-based modeling techniques have been first demonstrated for the escherichia coli k– <dig> mg <dig> metabolic network. a series of e. coli constraint-based models have been published by the group of b. palsson  <cit> , extending work on stoichiometric constraint-based modeling of e. coli dating back more than twenty years  <cit> . these models constitute a gold standard for e. coli modeling, and have seen a range of applications  <cit>  including metabolic engineering, model-driven discovery, cellular-phenotype prediction, analysis of metabolic network properties, studies of evolutionary processes, and modeling of interspecies interactions.

motivated by the widespread use of e. coli metabolic models, we aimed to illustrate the benefits of integrating metabolic modeling into model organism databases by developing an e. coli model derived directly from the ecocyc bioinformatics database  <cit> . first, we aimed to use the extensive biochemical literature referenced in ecocyc to develop a model with improved accuracy for phenotypic prediction, specifically for predicting the phenotypes of gene knock-outs, and for predicting growth or lack thereof under different nutrient conditions.

second, we sought to make the model easy to understand and operate. our goal was a high level of model accessibility and readability through  tight web-based integration of the model with extensive model query and visualization tools, and  a model representation that captures extensive information that enriches the model and aids its understanding, such as metabolic pathways, chemical structures, and genetic regulatory information. metabolic models are not just mathematical entities that output predictions; they are also artifacts that scientists interact with in multiple ways. if a model can be quickly and easily understood, scientists are more likely to trust its predictions, and the model is easier to reuse, to modify and extend, to learn from, and to validate through inspection. these aspects of a metabolic model depend strongly on how the model is represented, on the software tools available to interactively inspect the model, and on how tightly integrated the model is with those software tools.

third, we sought to produce a model that is frequently updated to integrate new knowledge of e. coli metabolism.

fourth, we sought to use the ecocyc-derived e. coli metabolic model to identify errors in ecocyc, and open problems in e. coli biology, by performing in-depth investigations of the disagreements between the phenotypic predictions of the model and experimental results.

we present ecocyc– <dig> –gem, a constraint-based genome-scale metabolic model for e. coli k– <dig> mg <dig> that is directly derived from the ecocyc model organism database  built on the genome sequence of e. coli k– <dig> mg <dig>  the model is implemented using the metaflux  <cit>  component of the pathway tools software  <cit> .

RESULTS
the ecocyc– <dig> –gem generated from ecocyc  <dig>  encompasses  <dig> genes,  <dig> unique cytosolic and periplasmic reactions, and  <dig> unique metabolites. table  <dig> compares the statistics of ecocyc– <dig> –gem with previous e. coli metabolic models. ecocyc– <dig> –gem is an advance over previous stoichiometric models of e. coli metabolism in four respects: in its size; in its accuracy; in its form, readability and accessibility; and in its update frequency. here we summarize these results; these points will be expanded in subsequent subsections.
e. coli 
genome-scale model statistics

et al.
et al.
gene knockout prediction accuracy represents simulated growth on glucose minimal media under aerobic conditions. reaction and metabolite counts represent reactions found in the cytosol and periplasm, since ecocyc– <dig> –gem does not cover porin-mediated diffusion of metabolites into the periplasmic space.

the metaflux component of pathway tools translates pathway/genome database  reactions and compounds into constraint-based metabolic models. our methodology of fusing systems-biology models and bioinformatics databases has several advantages because of strong synergies between these approaches. databases and models both require extensive literature-based curation and refinement. it is more efficient to perform that curation once in a manner that benefits a database and a model, than to duplicate curation efforts for a database project and a modeling project. furthermore, the modeling process identifies errors, omissions, and inconsistencies in the description of a metabolic model, and therefore drives correction and further curation of the database if the two efforts are coupled. we made more than  <dig> ecocyc updates as a result of comparing model predictions with experimental data and literature for this work. in addition, bioinformatics database curation methods such as the use of evidence codes and citations to provide data provenance, and the incorporation of mini-review summaries that describe enzymes and pathways, benefit systems-biology models, which typically lack data provenance and explanations.




advances in model size. compared with ijo <dig>  ecocyc– <dig> –gem represents a 6% increase in the number of genes, a 23% increase in the number of unique cytosolic and periplasmic reactions, and a 28% increase in the number of unique metabolites. the size of ecocyc– <dig> –gem is currently exceeded only by the more mathematically complex me-model of o’brien et al. <cit> , which includes simulation of gene expression, transcriptional regulation, and protein synthesis.


advances in model accuracy. we conducted a threephase validation of ecocyc– <dig> –gem to assess its accuracy . in phase i we compared simulated ecocyc– <dig> –gem rates of nutrient uptake and product secretion in aerobic and anaerobic glucose culture with experimental rates derived from chemostat culture; the performance of ecocyc– <dig> –gem was equivalent to previous models. in phase ii we compared essentiality prediction for all  <dig> genes involved in the model with experimental gene essentiality datasets; its error rate in predicting gene-knockout phenotypes decreased by 46% over the best previous model. in phase iii we compared nutrient utilization predictions of ecocyc– <dig> –gem with  <dig> experimental nutrient utilization tests; its accuracy in predicting growth and respiration under different nutrient conditions increased by  <dig> % over previous models as the number of nutrient conditions expanded  <dig> -fold. we investigated conflicts between experimental results and predictions of ecocyc– <dig> –gem in detail, and provide an extensive discussion of these conflicts within the context of ecocyc and the literature.

subjects of particular interest include alternative catalytic routes capable of replacing genes thought to be essential; compounds with unclear routes of catabolism which are capable of supporting growth and/or cellular respiration; regulatory and environmental perturbations of the stoichiometric network model; and investigations of what, exactly, constitutes gene essentiality.


advances in model form, readability, and accessibility. another benefit of coupling systems-biology models with databases, and a corresponding advance of our model, is that generating a constraint-based model from a database that has associated web-based visualization tools leads to a literate model . a literate model is easy to read, and is highly accessible to and understandable by scientists.


advances in model update frequency. because the metaflux component of pathway tools generates constraint-based models directly from the ecocyc pgdbs, as the database is refined through new curation, those refinements are automatically incorporated into newly generated versions of the model. we release new versions of the ecocyc-based model three times per year; previous models were updated every four years  <cit> . although there are reasons to limit the frequency of releases in order to tie them to a well-defined version of the database and throughly test the accuracy of new versions, we believe that more frequent model updates are useful for an organism as important as e. coli.

validation of biomass metabolites, nutrients, and secretions
refinement of ecocyc– <dig> –gem began with the validation of the biomass, nutrient, and secretion metabolite sets, which are detailed at length in additional file  <dig> and additional file 2: table s <dig>  the biomass metabolite set establishes requirements for growth and determines the growth rate of the simulation. the biomass metabolite set for ecocyc– <dig> –gem was based on the ijo <dig> wild-type and core biomass reaction sets published by orth et al., with several revisions stemming from differences in content and functionality between ecocyc and the ijo <dig> model. gene essentiality in constraint-based models is principally determined by the biomass demands of the cell. inclusion of a metabolite in the biomass metabolite set forces the genes required for manufacture of that metabolite to become essential in the simulation.

a wild-type biomass metabolite set, which is derived from measurement of the biomolecular composition of healthy, growing cells, is not representative of the minimal set of biomass metabolites required for cell survival. because biomass metabolites not truly required for cell survival will generate false simulation predictions of essentiality in their biosynthetic pathways, the concept of a core biomass metabolite set was developed by feist et al. the core biomass metabolite set is a biomass metabolite set that is defined with the aim of maintaining quantitative accuracy with regards to cell performance while predicting the observed experimental essentiality data as accurately as possible. because much of this work focuses on testing the minimum requirements for cell growth, we frequently employed the core biomass metabolite set in our simulations. we use the term “expanded biomass set” to refer to our version of the wild-type biomass metabolite set described in orth et al., because we do not wish to imply that the simulated cells always represented the wild-type state.

the biomass metabolite sets described here underwent several revisions reflecting differences in scope between ecocyc– <dig> –gem and ijo <dig>  whereas ijo <dig> is a purpose-built model developed using the cobra toolbox with input from kegg, ecocyc, and other databases, ecocyc is a database with its own schema whose entries are programmatically transformed into an fba model. the specific metabolites present in ijo <dig> therefore cannot always be matched with the specific metabolites generated from ecocyc by metaflux on a one-to-one basis. several biomass metabolites represented as distinct within ijo <dig>  such as phosphatidylethanolamines with different chain lengths and saturations, are summed under the heading of a single representative metabolite in the ecocyc– <dig> –gem biomass set. additionally, not all processes covered in ecocyc– <dig> –gem are covered in ijo <dig>  and the reverse is also true. as a result, the biomass metabolite sets differ slightly. additional file 2: table s <dig> contains a complete side-by-side comparison of the ecocyc– <dig> –gem and ijo <dig> biomass metabolite sets, and lists the differences between them.

we constructed standard nutrient sets based on culture conditions reflecting experiments in glucose or glycerol minimal media and on the model’s capability to use substrates. those substrates include glucose or glycerol as appropriate, o  <dig>  nh4+, phosphate, sulfate, ferrous iron, water, co  <dig>  minerals appropriate to the biomass objective function, and mops buffer  where appropriate. because of passive diffusion at the high concentration of ammonium used in experimental culture, nh4+ is supplied directly in the cytosol , whereas all other nutrients are supplied in the periplasmic space.

finally, we developed a large set of secreted compounds that could be supplied across all growth conditions explored with our model. it contains both plausible products of e. coli metabolism and dead-end metabolites  <cit>  within the model. the presence or absence of metabolites in this set should not be construed to indicate their presence or absence in e. coli culture media.

we verified the metabolic reachability of each component within the ecocyc biomass metabolite set by supplying nutrients representing an aerobic glucose minimal medium and setting the production of each individual metabolite in turn as the optimization goal of metaflux, and repaired gaps by means of literature-based manual curation of ecocyc and expansion of the relevant metabolite sets.

atp maximization validation
we next confirmed that simulations of aerobic growth on glucose run with maximization of atp production as their objective made appropriate use of the glycolytic and tca cycle pathways and agreed with previous work on e. coli fba.

the maximization of atp production under aerobic conditions was studied by setting the atp consumption reaction atp + h 2o → adp + pi + h + as the objective function to be maximized by metaflux. the fluxes resulting from the maximization of atp production on glucose under aerobic conditions were compared with fluxes from cobra toolbox  <cit>  simulations of ijo <dig> under the same conditions and were found to be largely identical . differences arose from variances in proton translocation stoichiometries between the ecocyc– <dig> –gem version of the nadh:ubiquinone oxidoreductase i   and the ijo <dig> version of the nadh:ubiquinone oxidoreductase  . the exact number of protons translocated by the nadh:ubiquinone oxidoreductase is an issue of open discussion in the scientific literature, and this uncertainty is described in the ecocyc summary for the enzyme. if a consensus develops behind the  <dig> h + per  <dig> e - view of translocation stoichiometry, future versions of ecocyc will be changed to reflect this fact.

glucose uptake is set to  <dig> mmol/gcdw/hr. other nutrient and secretion fluxes are unbounded. flux rates are reported as absolute values for clarity. true ijo <dig> fluxes for ex_glc, ex_o <dig>  pgk, pgm, and sucoas are negative because of reaction directionality convention. most ecocyc reactions are identifed by their ecocyc frame ids. the remainder are marked with asterisks, and their frame ids are as follows: atp synthase ecocyc frame id: trans-rxn-249; cytochrome bo oxidase ecocyc frame id: rxn0-5268; succinate dehydrogenase ecocyc frame id: succinate-dehydrogenase-ubiquinone-rxn; glucose pts uptake ecocyc frame id: trans-rxn-157/rxn0-6717/rxn0-6718; fructose 6-phosphate aldolase ecocyc frame id: rxn0-313; dihydroxyacetone kinase ecocyc frame id:  <dig> . <dig> -rxn.

further numerical differences are due to a technical consideration: ecocyc cytochrome bo oxidase reaction stoichiometry is written in terms of whole molecules of oxygen, while ijo <dig> cytbo3_4pp is written in terms of half-molecules .

comparison with ijo <dig> simulation and chemostat data
after completing our basic validation of biomass production and energy generation, we maximized the rate of ecocyc– <dig> –gem biomass metabolite set production under several minimal media conditions and ensured that we obtained results comparable to the ijo <dig> results for the same conditions obtained using the cobra toolbox. divergences were addressed by literature-based manual curation of ecocyc and modification of metaflux reaction sets. we further compared the extracellular flux distributions resulting from these simulations with the experimental data obtained in carbon-limited chemostat environments under both aerobic and anaerobic conditions.

tables  <dig> and  <dig> compare extracellular metabolite flux results derived from ecocyc– <dig> –gem simulation, ijo <dig> simulation, and experimental data  <cit>  for the canonical cases of aerobic and anaerobic growth on glucose-limited chemostat culture. in all simulations, the experimental rate of glucose supply was the only fixed constraint; all other nutrients and secretions were left unconstrained.

metabolite uptake and production rates are in units of mmol/gcdw/hr. growth is in units of hr - <dig>  experimental data from kayser et al. <cit> .

metabolite uptake and production rates are in units of mmol/gcdw/hr. growth is in units of hr - <dig>  experimental data from  <cit>  via  <cit> . formate-hydrogen lyase  was left inactive for purposes of comparison.

the behavior of metaflux/ecocyc– <dig> –gem simulations was very similar in most regards to the behavior of cobra/ijo <dig> simulations. respiration and fermentation rates scaled with nutrient uptake at comparable rates. the generally higher rates of o  <dig> uptake observed experimentally lend support to a lower practical efficiency of proton translation stoichiometry in vivo, perhaps augmented by respiratory inefficiencies such as futile cycling and generation of reactive oxygen species. both models secrete the expected 1:2: <dig> mix of acetate, formate, and ethanol during anaerobic growth on glucose that varma et al. <cit>  originally identified as stoichiometrically optimal. during the transition between purely anaerobic and aerobic domains, the competing demands of energy metabolism and redox elimination cause a characteristic pattern of mixed acid fermentation described by varma et al., in which ethanol, then formate, and finally acetate production are eliminated as the cell’s oxygen supply becomes completely sufficient to support aerobic respiration. figures  <dig> and  <dig> use the cellular overview and omics popup visualization functionalities of pathway tools to illustrate this behavior in ecocyc– <dig> –gem during a transition from anaerobicity to aerobicity.

comparisons between fba-predicted extracellular fluxes and experimental fluxes show that ecocyc– <dig> –gem and ijo <dig> fba predictions agree more closely with each other than with experimental flux results, although the correspondence between simulation and experiment was quite close for the experimental fluxes under consideration. this result was expected given the adaptation of the ijo <dig> biomass function for use in ecocyc– <dig> –gem, the use of ijo <dig> and preceding reconstructions as benchmarks in the development of ecocyc– <dig> –gem, and the use of ecocyc as a reference in the construction of ijo <dig> and its predecessors. the experimental measurements generally demonstrate higher fluxes of the respiratory gases o  <dig> and co  <dig> than the simulated fluxes, suggesting a degree of respiratory inefficiency not properly modeled by fba. similarly, small quantities of succinate and lactate were produced by experimental fermentation, indicating a degree of divergence from metabolic optimality in vivo. broader cellular constraints such as regulation, protein crowding, pathway enzyme synthesis requirements, and pathway-throughput limits underlie these differences  <cit> . successive generations of evolution under constant growth conditions might bring the experimental result closer to theory, as described in ibarra et al. <cit> .

gene essentiality analysis
one of the most exciting aspects of genome-scale flux modeling is the ability to rapidly test computational gene knockouts  for their effects on metabolic function. gene ko simulation is useful both for prediction and for validation: in silico fba screens of gene kos have been applied in a variety of metabolic engineering efforts  <cit> , and e. coli ko library collections with well-characterized growth behavior provide an important tool for flux model validation.

fba gene ko essentiality prediction depends on two types of database associations between genes and chemical reactions: genes whose products catalyze reactions, and genes whose products are reaction substrates . simulation gene kos are carried out by identifying all reactions involving the gene, and then identifying all other genes capable of catalyzing the reactions or supplying the substrates thus identified. reactions for which no isozymes or alternative substrate supplies are found are removed from the fba stoichiometric network. an fba solution is then calculated for the new model. if the simulated gene ko has caused the deletion of one or more reactions required for the synthesis of a biomass metabolite, generation of the full biomass metabolite set will be blocked and the fba simulation returns a no-growth result. such a result represents a prediction of gene essentiality. if the complete biomass metabolite set can still be produced in spite of the simulated gene knockout, the fba simulation returns a growth result, indicating a prediction of gene non-essentiality.

the experimental essentiality data used in our tests consisted of two major datasets. the first, used to study gene essentiality on rich and glucose minimal media, was the deletion study of baba et al. <cit>  as updated by yamamoto et al. <cit> , which tested the keio collection library of  <dig> e. coli gene deletion strains for growth on lb rich media and mops minimal media with  <dig> % glucose. we conducted our glycerol minimal media tests using the gene knockout essentiality data of joyce et al. <cit> , an expansion of the study of the keio collection essentiality to include growth on m <dig> minimal medium with 1% glycerol.

several e. coli gene deletions strongly affect growth on various types of minimal media, but are nonessential to growth on rich media. because the fba simulation result is treated as a binary test , gene deletions that strongly affect growth on minimal media without producing a completely lethal phenotype must be defined either as experimentally essential or as experimentally nonessential.

two representative perspectives on this definition are the narrow essentiality criteria of no observable growth in minimal media and the broad essentiality criteria used by orth et al. the narrow glucose essentiality criteria treat as essential those baba et al. and yamamoto et al. gene deletion mutants with od <dig> ≤  <dig>  after  <dig> and  <dig> hr growth on glucose minimal media. this requires no perceptible growth over a long period. the broad essentiality criteria was originally defined in relative terms by joyce et al., as the slowest-growing ninth of all keio collection deletion mutants.

in absolute terms, that approach treats as essential those deletion mutants measured by baba et al. to have od ≤  <dig>  after  <dig> hr growth on glucose minimal media, which indicates impaired growth over a shorter period. the practical difference between these two perspectives is illustrated in figure  <dig>  which displays the distribution of od <dig> data for all rich media-viable keio collection mutants after  <dig> hr of growth on mops media containing  <dig> % glucose, as originally published in supplementary table three of baba et al. as the figure illustrates, the broad essentiality criteria include a population of cells with severe growth defects that is not contained in the narrow essentiality data. the comparison between narrow and broad essentiality criteria can be expanded to glycerol minimal media by comparing narrow glycerol essentiality criteria of no observed growth on rich media with the glycerol essentiality criteria of orth et al., again derived from the criteria of joyce et al. involving successive division into thirds.

in order to examine criteria for experimental gene essentiality more deeply and to illustrate the effect of defining a core biomass metabolite set, we conducted essentiality testing using both the expanded and core biomass metabolite sets proposed by orth et al. differences in essentiality predictions between the two data sets illustrated the differences between standard cell composition under nominal conditions and the minimal composition required for cell growth.

we simulated single gene kos on glucose and glycerol minimal media for the  <dig> genes in ecocyc– <dig> –gem to test whether the resulting ecocyc– <dig> –gem gene deletion mutants were capable of generating core and expanded biomass metabolite sets from sets of nutrients based on the experimental culture media of baba et al. and joyce et al. gene ko simulations capable of generating any growth at all were scored as nonessential, whereas gene kos blocking generation of the biomass metabolite set were scored as essential.

we compared the results of this simulated essentiality screen with experimental gene essentiality results based on both narrow and broad gene essentiality criteria. incorrect essentiality predictions were addressed by literature-based manual curation of ecocyc and modification of metaflux metabolite sets. final essentiality prediction results after curation are summarized in tables  <dig> for glucose and  <dig> for glycerol. the overall accuracy of prediction for growth on glucose with the core biomass metabolite set and broad essentiality criteria was 1375/ <dig> . for prediction of growth on glycerol under the same simulation conditions, the overall accuracy of prediction was 1365/ <dig> . sensitivity here refers to the percentage of gene deletions resulting in growth that are correctly identified by simulation, while specificity refers to the percentage of gene deletions resulting in no growth that are correctly identified by simulation.

four comparisons are provided — gene essentiality is evaluated with regard to road and arrow experimental essentiality criteria, and with regard to a ore biomass metabolite set that maximizes the accuracy of essentiality predictions as well as an xpanded biomass metabolite set reflecting experimental measurements of healthy cells. the results of these comparisons are arranged based on correspondence between simulation and experiment:  true positive ,  false positive ,  false negative , and  true negative .

see table  <dig> caption for description of column headings.

tables  <dig> and  <dig> illustrate that the gene essentiality predictions in ecocyc– <dig> –gem differed in a number of cases from the gene essentiality conclusions generated by high-throughput gene ko screening. because these are situations of considerable interest to the development of ecocyc as a reference, we examined them in greater detail for the case of growth on glucose, with reference to the e. coli literature. our examination covered two types of incorrect gene deletion growth predictions. the first type was a false positive growth prediction. these genes, which are experimentally essential under the conditions tested by baba et al., were predicted to be nonessential by ecocyc– <dig> –gem. the second type was a false negative growth prediction. these genes, which are not experimentally essential under the conditions tested by baba et al., were predicted to be essential by ecocyc– <dig> –gem.

tables  <dig>   <dig>   <dig>   <dig>   <dig> and  <dig> present five broad categories of incorrect gene deletion predictions from ecocyc– <dig> –gem. table  <dig> cover false predictions involving open questions of e. coli biology, false predictions resulting from interesting facets of experimental or simulation methods, and other situations of special relevance. table  <dig> covers false predictions in core glycolytic, pentose phosphate, entner-doudoroff, and tca cycle metabolism. this highly interconnected region of e. coli metabolism contains several isozymes and opportunities for reversibility, and presents a challenge to fba essentiality predictions in the absence of complete regulatory modeling. table  <dig> cover false predictions that are the result of unmodeled regulation of gene expression or enzyme activity. genes repressed under baba et al. experimental growth conditions, insufficiently expressed isozymes, and cases of enzyme inhibition all fall into this category. table  <dig> covers situations in which the essentiality conclusions of the high-throughput essentiality screen differed significantly from the essentiality conclusions made by the e. coli k– <dig> literature. table  <dig> covers false gene essentiality predictions relating to systems beyond the scope of ecocyc– <dig> –gem’s biomass objective function. finally, table  <dig> covers false gene essentiality predictions made as a result of metaflux and ecocyc technical problems discovered in the course of this study.
e. coli 
 biology and gene essentiality

cases where ecocyc– <dig> –gem essentiality predictions differed from experimental gene-essentiality results for aerobic growth on mops medium with  <dig> % glucose, and posed open biological questions or highlight metabolic network interactions of particular interest in ecocyc– <dig> –gem. certain of these genes deserve further investigation by the experimental community; others highlight interesting aspects of essentiality testing. kim and copley  <cit>  have discussed several of these genes, which remain open issues in the literature. see text for additional details. column headings are as follows: ht: high-throughput experiment . sim: simulation. conv: conventional experiment. column entries are as follows: –: in the experiments, deletion mutant could not be recovered for testing, or was tested and did not grow to more than  <dig>  od <dig> after  <dig> hr, or both isolates were found to have duplications. in the simulations, fba biomass flux was zero. +: in the high-throughput experiments, a deletion mutant was tested and showed growth greater than  <dig>  od <dig> after  <dig> hr. in the conventional experiments, growth was observed. in the simulations, fba biomass flux positive. n/a: information not available for deletion mutant on glucose minimal media. for example, argd is essential in the data of  <cit>  according to the broad essentiality criteria of  <cit> , but ecocyc– <dig> –gem predicts that it is nonessential.

the three available pathway options for navigating the route from glucose to the tca cycle make up the superpathway of glycolysis, the pentose phosphate pathway and the entner-doudoroff pathway. without modeling of regulation, product inhibition, and metabolite toxicity, the multiple re-entry points in the superpathway and the reversible nature of the pentose phosphate pathway allow carbon flux to route around deletions with weak growth. ecocyc– <dig> –gem consequently produces several false positive results for these pathways. this set of genes has previously been discussed at length by  <cit> . the acee and tpia genes identified as essential in figure two of  <cit>  are judged nonessential by  <cit>  and consequently by  <cit> , and were predicted as nonessential by ecocyc– <dig> –gem, but these nonessentiality conclusions appear incorrect based on conventional experiments described in the literature, and are thus included in this table. the converse is true for ppc, which is considered essential by high-throughput experiments, but is not essential in conventional experiment. see table  <dig> caption for a description of column headings.
et al.


c
a
t
false ko predictions caused by the presence of isozymes that are able to catalyze the reaction in the model, but are either down-regulated under the media conditions of  <cit>  or are for other reasons unlikely to substitute for the knocked-out enzyme in vivo. because metaflux does not model regulation, it assumes that these enzymes are active. see table  <dig> caption for a description of column headings.

see table  <dig> caption for a description of column headings.

examples of these systems include cold response and cell envelope maintenance. the ecocyc gem biomass function will be expanded to incorporate the operation of these systems in future versions. see table  <dig> caption for a description of column headings.

these technical issues will be addressed in future versions of metaflux and ecocyc. see table  <dig> caption for a description of column headings.

several of the false gene essentiality predictions described within these tables were discussed in the work of kim and copley, who examined the essentiality conclusions of baba et al. in e. coli core metabolism with reference to the then-current state of ecocyc. constraint-based model improvement and gap-filling based on gene essentiality predictions derived from the work of baba et al. have been examined for the cobra family of constraint-based models of e. coli metabolism by reed et al. <cit> , kumar et al. <cit> , kumar and maranas  <cit> , barua et al. <cit> , orth and palsson  <cit> , and tervo and reed  <cit> . our revisions of ecocyc– <dig> –gem included manual application of a subset of growmatch  <cit>  gap-filling methods, specifically resolution of false positive gene essentiality predictions associated with blocked genes and false negative results associated with secretion of metabolites. the essentiality prediction accuracy resulting from our manual curation process is similar to the accuracy resulting from applying the full growmatch algorithm to the iaf <dig> model.

additional file 2: table s <dig> provides detailed listings of essentiality status and model predictions, including a breakdown of gene essentiality prediction status by criteria used.

nutrient utilization analysis
observation of culture growth on various nutrient sources is a foundation of microbiology  <cit> . ecocyc  <dig>  contains information on e. coli respiration for  <dig> types of media, including  <dig> conventional types of minimal growth media and  <dig> biolog phenotype microarray  wells. the  <dig> biolog pm media conditions represent a high-throughput method of evaluating metabolic phenotypes in culture based on a tetrazolium dye assay of cellular respiration. each well in a biolog 96-well pm plate contains a standard minimal media composition plus a nutrient source that is varied across the pm plate, with the element supplied by the varying nutrient source dependent on the type of biolog pm plate in use  <cit> .

we evaluated the performance of ecocyc– <dig> –gem in predicting growth for the following available datasets:  aerobic e. coli growth on the  <dig> common conventional minimal growth media;  consensus estimates of respiration based on four different experimentalists’ measurements of aerobic biolog 96-well plates pm1– <dig>  representing  <dig> conflict-free growth observations; and  an anaerobic biolog pm <dig> plate assay surveying carbon source utilization in the absence of oxygen, representing  <dig> anaerobic growth observations. biolog pm data stored in ecocyc measures utilization of nutrients as sources of carbon , nitrogen , sulfur , and phosphorus .

conventional media compositions and growth results were drawn from the literature. aerobic biolog pm nutrient utilization assay results were compiled from four different datasets captured in ecocyc:  from our own experiments;  from a dataset obtained from b. bochner; and from the recent publications of  abuoun et al. <cit>  and  yoon et al. <cit> . anaerobic biolog pm nutrient utilization assay results were obtained from b. bochner. we did not include the data of baumler et al. in our analysis of biolog pm results because of variation in culture conditions and a high degree of conflict with other datasets under both aerobic and anaerobic conditions  <cit> . see the methods section for additional details.

growth on a given type of media was tested by constructing simulated metaflux nutrient sets corresponding to the contents of the media in question and comparing ecocyc– <dig> –gem growth predictions with experimental growth results. due to the absence of enterobactin iron uptake modeling in ecocyc, fe 3+ in the medium was replaced with fe 2+. anaerobic simulations were prepared identically to those performed for aerobic growth, except for the removal of oxygen from the nutrient set, inclusion of the formate-hydrogen lyase reaction, and the removal of the protoheme and pyridoxal 5’-phosphate synthesis requirement from the biomass.

literature-based ecocyc curation and appropriate modifications of metaflux metabolite sets were used to address incorrect nutrient utilization predictions. the final results for pm array validation after curation are listed in table  <dig>  overall accuracy of growth prediction for aerobic biolog pm assays was 252/ <dig> , with  <dig> assays not evaluated because of experimental conflicts . anaerobic biolog pm assay predictions had an overall accuracy of 74/ <dig> . aerobic growth tests on conventional minimal media contained in ecocyc had an overall accuracy of 22/ <dig> .

aerobic pm:  <dig> absolute consensus results from biolog phenotype microarray carbon, nitrogen, sulfur, and phosphorus source tests  conducted under aerobic conditions. anaerobic pm:  <dig> biolog phenotype microarray carbon source tests  conducted under anaerobic conditions. conventional:  <dig> e. coli minimal growth media described in ecocyc.

the overall accuracy of nutrient utilization prediction across all aerobic and anaerobic pm and conventional growth media is 348/ <dig> . tables  <dig>   <dig>   <dig> and  <dig> provide detailed discussions of false negatives and false positives for aerobic pm assays. tables of results for anaerobic pm assays and conventional growth media are available in additional file 2: tables s <dig> and s <dig>  respectively.

column headings are as follows: < 
element 
> source: nutrient source under test. ht: high-throughput experiment. sim: simulation. column entries are as follows: +: nutrient can support growth. –: nutrient cannot support growth. for example, d-fructose supports growth according to the consensus of experimental aerobic biolog pm assays recorded in ecocyc, but ecocyc– <dig> –gem predicts that it does not support growth.

see table  <dig> caption for description of column headings.

see table  <dig> caption for description of column headings.

see table  <dig> caption for description of column headings.

model readability and accessibility
scientists naturally need to ask many questions of a metabolic model, such as “what are the chemical structures of all substrates in reaction x, and is x chemically balanced?” “what metabolic pathway is reaction x a member of, and what are the adjacent reactions?” “which e. coli enzymes are inhibited by adp?” “what transcriptional regulators affect the expression of the enzymes for reaction x?” their ability to answer these questions rapidly and accurately is strongly dependent on the model representation, the software tools available for querying and visualizing that representation, the tightness with which those tools are integrated with the model, and the presence of additional enriching information for the model.

existing e. coli models are represented as spreadsheet files and as sbml files, making it tedious or impossible for non-programmers to answer the preceding questions directly from those files. although sbml files can be imported into software tools such as the raven toolbox  <cit>  and rbionet  <cit> , in practice that approach is limited because of variations in sbml encodings, the effort required to install and integrate multiple software tools with disparate capabilities, and the limited visualization capabilities of those tools. more fundamentally, previous e. coli models do not capture  additional enriching information that, while not required for the mathematical operation of a model, greatly enhances our ability to validate and understand a model, and to answer the preceding questions. examples of such enriching information present in ecocyc– <dig> –gem are metabolite chemical structures, arrangements of reactions within metabolic pathways, and gene regulatory information. note that introducing ad-hoc definitions of these data  in the sbml “notes” field, or introducing sbml links to external databases, would be considered out of bounds: since pathways are not captured formally in the sbml specification today, there is no guarantee regarding interoperability of software tools with such ad-hoc data.

ecocyc– <dig> –gem is highly understandable because it can be interactively queried and visualized through the ecocyc web site and desktop pathway tools software, which supports visualization of metabolic pathways and reaction diagrams; metabolite pages that depict metabolite structures and all reactions a metabolite is involved in; depiction of gene/reaction connections and of genome organization via a genome browser; navigation through the e. coli gene regulatory network; constructing structured queries such as: find all reactions of a given metabolite; find all enzymes utilizing a given cofactor; and presentation of text summaries and citations that explain and support aspects of the model. in general, other tools for metabolic model visualization tend to be less comprehensive, and to be less closely coupled to the model; see  <cit>  for recent reviews.

the reaction fluxes computed from ecocyc– <dig> –gem are more understandable than those from previous e. coli models because ecocyc– <dig> –gem fluxes can be immediately painted onto the ecocyc cellular overview, a zoomable diagram of the complete metabolic map of e. coli that allows immediate visual inspection of flux patterns. although other software tools exist for visualizing flux patterns on metabolic networks, e.g., the raven toolbox, they are unlikely to be easily usable with previous e. coli models. for example, raven toolbox requires that the user manually construct the metabolic network diagram, which could take days or weeks of effort. in contrast, pathway tools generates metabolic map diagrams algorithmically from a pgdb.

CONCLUSIONS
ecocyc– <dig> –gem demonstrates the advantages of literate modeling based on comprehensive organism databases. it provides comprehensive genome-scale coverage of the e. coli metabolic network, representing gene function with an unprecedented degree of accuracy.

integration of ecocyc– <dig> –gem into the ecocyc database gives investigators working with the model access to the full pathway tools bioinformatics and data visualization suite. this allows construction of complex database queries involving the full range of biochemical entities within e. coli, and visualization of pathways and reactions within the model as they change throughout the course of construction. as part of ecocyc, ecocyc– <dig> –gem will receive frequent updates to remain abreast of recent research developments.

the process of ecocyc– <dig> –gem construction and validation resulted in more than  <dig> updates to ecocyc. these included expansion and revision of periplasmic phosphatase activities many updates to sugar transport and phosphotransferase system modeling; correction of incorrect compartment assignments; fixes for l-lactate dehydrogenase action; revisions to glutathione hydrolysis; new transport reactions for compounds identified as nutrient sources during biolog pm testing; addition of mops catabolism via the alkanesulfonate pathway; removal of several incorrect reactions and gene-protein relationships; numerous fixes to reaction reversibility and directionality; several compound class reassignments to correct issues with reaction instantiation; mass rebalancing for several reactions; and revisions to atp synthase proton stoichiometry. these updates are outlined in additional file 2: table s <dig> 

the metaflux software has also been improved as a result of the fba validation of ecocyc. these improvements include upgrades to compartmentalization handling, gene deletion code, and electron transfer reaction handling. metaflux solution and log files have been updated to contain additional statistical information and provide a more detailed explanation of the metabolic network construction process to the user. numerous updates and revisions to the metaflux model of e. coli have been introduced as part of this effort. biomass metabolite sets have been revised to reflect the work of orth et al., and additional updates have been made on the basis of the validation process in order to create the most accurate final product possible.

many questions of interest to e. coli modelers and experimentalists were raised in the course of ecocyc– <dig> –gem development. by highlighting these questions and presenting them within the context of ecocyc as a reference database, we address the interests of the general metabolic modeling audience and of e. coli experimentalists interested in using models to explore their results and generate new leads for research. we summarize these questions here.

experimental measurements of respiratory fluxes in glucose-fed aerobic chemostat culture are higher than those predicted by simulation, and small quantities of succinate and lactate are generated in experimental anaerobic fermentations, suggesting interesting in vivo deviations from theoretical in silico optimality.

a small number of metabolic byproducts must be removed directly from the cytosol in the secretion set because of a lack of known salvage or excretion pathways. the fate of these metabolites is of interest.

several incorrect essentiality predictions are associated with unclear cellular biomass requirements, pathways with potential alternate routes of catalysis, uncertain determinations of essentiality on glucose minimal media, and ambiguous or missing gene function. similarly, nutrient utilization predictions have identified a number of compounds that lack clear pathways of entry into metabolism but are capable of supporting respiration and/or growth. resolution of these uncertainties would improve our understanding of e. coli function in varying environments.

