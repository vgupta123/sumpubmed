BACKGROUND
the modus operandi of the modern day sequence homology concept  <cit>  is founded on two inductively proven implications:  the inference of evolutionary history from sets of homologous protein sequences  to build believable phylogenetic trees  <cit> ;  the inference of homology for functionally uncharacterized sequences with high sequence similarity to proteins with characterized structure and/or function through the trinity of sequence-structure-function relationship .

in both proofs, there are some crucial, yet problematic assumptions  <cit> . in the first implication, it requires the antecedent that the sequences are homologous , then, as a consequence, the sequences are expected to be high in similarity . whereas this first implication appears quite acceptable , the second one is by far not obvious. in the proof of the second implication where structure/function similarity is concluded from high sequence similarity , the conserved key amino acids in the uncharacterized sequence for concluding similarity to the structure/function of the well-studied protein need to be those that correspond to the hydrophobic patterns responsible for the 3d structure formation and the residues critical for binding/catalysis/etc. to note, in both cases of inductive proofs, the proteins under scrutiny were soluble, globular proteins of limited size without non-globular segments.

thus, homology has the precise meaning of “having a common evolutionary origin” but it also carries the loose meaning of “possessing sequence similarity or being matched”. in addition, homology between sequences is always a hypothesis while similarity, being a measurable fact, can be attributed to either chance, convergent evolution or common ancestry  <cit> . in other words, high sequence similarity is a necessary but insufficient condition for concluding homology.

fortunately, sequence similarity by chance can be eliminated via stringent statistical criteria like e-value cutoffs in blast  <cit>  or hmmer-based  <cit>  sequence searches. nevertheless, the statistical cutoff does not help in reversing the conditional statement p → q into q → p since the issue of distinguishing between convergent evolution and common ancestry among hits of high similarity is non-trivial. as a guide, similarities to any types of non-globular segments  are pertinent sources for mistaken homologies  <cit> . although this issue has been mentioned even in early work  <cit> , regretfully, these considerations regularly escape attention in large-scale annotation studies since, often, there is nothing to substitute manual handling of these cases. quantitative criteria are required to suppress events of function annotation transfer as a result of false homology assignments. our previous work has shown that the exclusion of undesirable signal peptides  and simple transmembrane helices  in protein domain models can suppress many unrelated sequence hits and even reveal true homologies that, otherwise, would have disappeared in the noise  <cit> .

standard alignment tools  and domain libraries  have become the obligatory components of many modern-day automated annotation pipelines for detecting homology and, hence, to infer the functions of many unknown sequences accumulating in the relentlessly growing sequence databases. but these automated packages operate strictly in the similarity space with preset score or, equivalently, e-value cutoffs. thus, statistically significant similarities of any aligned pieces following as the program outputs are declared as homologies without any alternative consideration of convergence cases. the latter operation q → p is a non-equivalent converse statement of the original proof p → q. indeed, this is the bane of current sequence search approaches that, frequently, lead to wrongful protein function predictions or annotations, especially when one attempts to extrapolate very deep into sequence space  <cit> .

to alleviate the abovementioned issue, we reiterate that the working principle of the sequence homology concept is based on the similarity comparison between the structural elements, the basic building blocks for conferring the overall fold of a protein which in turn characterizes its biological function  <cit> . to note, the issue of alignment segmentation into blocks of higher quality more relevant for structure, fold and function conservation has been discussed widely in context of multiple alignment generation, fold recognition and threading  <cit> . therefore, a viable approach for improving the existing sequence searches is to dissect each total alignment into two types of segments. the first class is suggestive of structured, essential components providing a conserved, complex hydrophobic/hydrophilic sequence pattern  possibly complemented by further, function-critical positions. the other group of segments includes all types of non-globular segments, very long loops and other elaborations in 3d structures, etc. that are not under the same fold/function conservation evolutionary pressure   <cit> . the purpose is to independently re-evaluate the respective two score sums for statistical significance, subsequently. as a necessary condition to be considered as a valid hit, the total score of fold segments should either be more statistically significant than the score sum of remnant segments or, minimally, be statistically significant on its own.

to further emphasize, the concept of a globular domain has a deeply-rooted notion where it implies a sequence segment  having an independent tertiary structure , it folds and melts autonomously. its sequence evolves as a unit in phylogeny  <cit> . the unsettling thing is that a sizeable number of domain models in protein domain libraries often represent something else, not a globular domain in the sense as described above. the model might consist of several globular domains or contain non-globular additions. since the sequence homology-based annotation transfer in the case of low sequence identity is applicable only for the single globular domain, some type of model dissection becomes intuitively important. one can either go via the work-intensive route of creating new, elementary domain model libraries or, alternatively, follow the path of score dissection with regard to the contributing sequence segments. generally speaking, the idea of score dissection is more generic and is applicable to any existing sequence-based methods  as long as one can reconstruct the alignment scores from the various parameterization of the search algorithms. in addition, score dissection does not require the original algorithms to be modified.

in this work, we achieved four main objectives. first, we created an algorithm and the software tool dissecthmmer  that can re-compute the scores of hmmer <dig> and hmmer <dig> and assign the respective contributions to predefined query – domain model alignment segments. we were able to achieve good replication of the log-odd scores/e-values generated by both hmmer <dig> and hmmer <dig> across all the seed sequences in smart and pfam domains. second, we show the usefulness of this tool in case studies where dissecting the alignment scores into fold-critical and remnant contributions  enables us to identify false hits that are statistically significant for the total hmm model and, at the same time, we could elucidate previously insignificant true hits among the truly false ones.

third, to generalize the dissection framework to domains without pdb/dssp representation, the quality score based on alignment quality was introduced. out of  <dig> smart and  <dig> pfam domains with structures,  <dig> smart and  <dig> pfam domains were found to be enriched with structural residues in their high-quality segments. this was more than 80% of the statistically testable cases. thus, the quality score is justifiable surrogate for estimating fold-related and remnant segments in domain models. importantly, this and similar criteria can be applied to segmenting hmm models in domain libraries without having the domain alignments to be re-edited or the hmmer searches to be rerun.

finally, the application of the dissection framework  on the seed alignments of smart and pfam domains gave an average positive concordance rates of almost 100% and a negative one of less than 1%. the latter implies that almost all of the seed sequences were recognized correctly as true hits. meanwhile, the dissection of alignment results from searches against the uniprot/swissprot for these smart and pfam domains returned average false-positive rates of less than 1% but average false-negative  rates of  <dig> %  and  <dig> % . the latter presents an opportunity to recover previously obscured homologous relationship between the fn hits and its associated domain model. filtering for domain models that have exceptionally high error rates also allows finding those cases where reconsidering the seed alignment might be useful.

RESULTS
methodology for the reconstruction of hmmer <dig> and hmmer <dig> scores
in the current implementation of the hmmer packages , a single, total log-odd score is returned for each domain-to-sequence alignment. fundamentally, each score is composed of two types of contributions: the positional scores  and the position-invariant scores .

the positional scores are composed from a series of emission  scores and transition  scores where m/d/i are match, delete and insert states. in the case of the invariant scores, they account for the fixed transition entry scores  and exit scores  for each domain-to-sequence alignment. these are added to the positional scores to give the final log-odd score of the alignment. as a rule, these positional and position-invariant components are retrievable from the respective hmm model files provided with domain libraries. then, the reconstruction of the hmmer scores follows the straightforward arithmetic computations as described in equation  .

in fact, the score reconstruction has already been applied on hmmer <dig> glocal  and global  outputs in one of our earlier works  <cit> . therefore, the score reconstruction procedure should logically be directly applicable to the hmmer <dig> domain-to-sequence alignments.

however, two issues ensue to complicate the straightforward procedure. first, the current implementation of hmmer <dig>  <cit>  lacks support of the glocal/global search mode. hence, local alignments are to be expected since there is no way to enforce glocal/global alignments. for the cases of seed sequences that are closely related to the domains, the local alignments will somewhat resemble the glocal/global alignment generated by hmmer <dig> and the hmmer <dig> score reconstruction can still achieve good replication results. but for many cases of fragmented local alignments, their reconstruction will have less precision in comparison due to the following issues.

this problem stems from the exclusion of certain invariant score parameters during the conversion of hmmer <dig> model files to hmmer <dig> format. regretfully, the conversion is necessary to export the hmmer <dig> null model parameters  since they are embedded in the hmmer <dig> program code, the second major issue. in contrast, the hmmer <dig> null model parameters are already captured in their model files. to note, the hmmer <dig> software suite only allows for model conversion  from the hmmer <dig> local model to the hmmer <dig> glocal/global model. in the process, only the first hmmer state  and last state  were kept while the other transition log-odd scores  were excluded from the converted hmmer <dig> model files since these parameters are not part of a global model. therefore, the reconstruction of hmmer <dig> local alignment score is bound to suffer some estimation errors inherently due to the unavailability of these parameters for the straightforward summing.

in hindsight though, the estimation is not detrimental to the overall accuracy of hmmer <dig> score reconstruction as demonstrated by the subsequent section. it is in fact only slightly less accurate than the hmmer <dig> reconstruction. only in cases where hmmer <dig> returns heavily fragmented alignments, the reconstruction error becomes noticeable; yet, it is still sufficiently small to not interfere in the significance analysis of the segmental subscores.

in this work, a program – dissecthmmer, was written to compute the reconstructed score relative to pre-defined alignment segments using the alignment  and the hmm model file as inputs independent on the hmmer suite version used . the algorithmic detail is described in the methods section. the code is provided as additional file  <dig> .

reproducibility and error estimation of the reconstructed hmmer log odd scores
to summarize, the score calculation in the various hmmer versions is a complicated routine with some parts not explicitly documented in the literature. besides algorithmic assumptions, numerical issues such as rounding errors also play a role. thus, it cannot be expected that the reconstructed scores exactly match the scores reported by hmmer but it is close enough for the purpose of reconstructing the segmental contributions to the total score.

to test the score reconstruction workflow, the seed alignments from smart version  <dig> and pfam release  <dig> were used. in comparison to smart, the current pfam library is about  <dig> times larger and, hence, the rigor of the scores reproduction was truly being tested in this case. in total,  <dig> smart domains  and  <dig> pfam domains  were examined.

for each domain alignment, the hmmer model is first built  and, then, it is searched against  the same set of seed sequences. for each seed sequence, the alignments reported are considered true hits. by this constraint, both hmmer <dig> and hmmer <dig> share the same search space and, hence, the alignments generated by both are expected to be similar . next, the hmmer log-odd scores for the total alignment were reconstructed as described in methods ).

once this computation was completed for all seed sequences of a given domain, linear regression analysis was performed against the original scores  in methods). the regression analysis output, in terms of slope  and coefficient of determination  as goodness of fit, is plotted for both smart  and pfam  domains in figure  <dig>  figure 2a and b depict the histograms of the slopes β^ for the original versus reconstructed scores for smart domains calculated for hmmer <dig> and hmmer <dig>  respectively, while figure 2c and d depict the histograms of the slopes β^ for the pfam domains. generally speaking, the hmmer <dig> results exhibit high reproducibility at an average β^ with an ideal value of  <dig>   with small standard deviations of  <dig>   and  <dig>  . in comparison, hmmer <dig> results also show good, though slightly worse reproducibility with average β^ of  <dig>  ±  <dig>   and  <dig>  ±  <dig>  .

the goodness of fit, in terms of coefficient of determination , for the original versus reconstructed hmmer <dig> and hmmer <dig> scores are depicted in figure 2e, f, g and h respectively as histograms. again, the hmmer <dig> reconstruction exhibits excellent fit at an average r <dig> of  <dig>   and small standard deviations of  <dig>   and  <dig>  . hmmer <dig> reconstruction closely followed at an average r <dig> of  <dig>   and  <dig>   over a slightly larger variation of  <dig>  . taken together, the general trend where all values of β^ and r <dig> converges to one with little variation, implies that the reconstruction workflow for hmmer2/ <dig> scores are highly reliable and reproducible. the reconstruction works well for the relatively small smart library as well as for the huge pfam library.next, the relative error estimates per smart/pfam domain were examined  in methods). to note, the scores generated for various seed sequences of one domain are quite similar to each other in the case of hmmer <dig>  mostly, because the glocal mode enforces alignments of similar length. in the case of hmmer <dig>  the alignments are often  identical with those in the hmmer <dig> case. yet, the alignments for a large number of many other seed sequences are heavily fragmented. since we are interested in assessing the error of reconstruction over the representative domain score and not over each individual alignment fragment where, especially, the assignment of gap scores to the individual fragment scores by hmmer <dig> is difficult to recover as discussed above, we rather compare the total error of reconstruction for the seed sequence – domain alignment with the sum of scores for all the seed – domain alignment fragments reported. therefore, we estimate the error for each domain as ratio between the sum of deviations between original and reconstructed score for each seed sequence on the one hand and the sum of original scores for each seed sequence on the other hand. figure 3a, b and c, d show the histograms of the relative errors for the hmmer <dig> and hmmer <dig> results and the smart and pfam domain databases, respectively. the majority of the reconstruction errors by hmmer <dig> are well below the satisfactory  <dig>  margin  and at an average of  <dig>   and  <dig>   as depicted by the vertical dashed lines. similarly, the reconstruction errors attributed by hmmer <dig> are well below the  <dig>  line . the average relative errors are about  <dig>  and  <dig>  for smart and pfam domains, respectively . as a general trend, the relative errors tend being dwarfed by their respective domain-wise alignment scores for all seed sequences.

taken together, the results show that the reconstruction recovers the original score within a few percent at worst. since we wish to make a qualitative conclusion whether a certain alignment segment of the total query sequence – domain alignment makes a substantial or even overwhelming contribution to the total score, the reconstruction algorithm with all errors taken into consideration appears well suited for the purpose.

this large scale study of seed sequence scores also allows comparing some aspects of hmmer <dig> and hmmer <dig> program behaviors. figure  <dig> shows the hmmer <dig> versus hmmer <dig> score averaged over all seed sequences for each domain plotted for all domains . as a trend, the hmmer <dig> scores  are clearly smaller than the hmmer <dig> scores . they are strongly correlated  but not equivalent. to note, this work was not planned as a comparative study between the two tools and we strived as much as possible to focus on conclusions supported by either program.

dissection of sequence alignments accentuates homology evidence in true hits while deemphasizes false hits
the idea of dissecting a hmm score into several segments of a larger alignment stems from the observation that the influence of well conserved, truly homologous alignment segments on the score can be overwhelmed by score contribution from spurious alignment extensions. in our previous work  <cit> , we have shown that the score enhancements from aligning non-relevant sp/tm hydrophobic stretches can create the appearance of high scores and significant e-values of alignments between unrelated sequences.

at the same time, it is well accepted that structural elements are the basic building blocks for conferring the overall fold of a protein which in turn characterizes its biological function. therefore, for the purpose of inferring homology, one should evaluate the score of the structural, fold-relevant segments independently from the score associated with remnant segments. figure  <dig> shows an example of such a segmentation highlighting the fold-relevant alignment pieces . furthermore, as a necessary condition to be considered as a true hit, the structural, fold-relevant score should either be more statistically significant than the score for other segments or, at least, it should be statistically significant on its own. the postmortem dissection of the alignment can provide additional insights beyond what a standard single total score/e-value could, as illustrated through a selected, validated set of  <dig> hits  found by  <dig> pfam domains  as listed in table  <dig> 

1
: e-value
2
the segmentation of domain models is based on pdb/dssp information.

in retrospect, all hit examples  were retrieved from the results of hmmer <dig>  and hmmer <dig> when searched against the swissprot/uniprot sequence database . to note, the hmmsearch option ‘nobias’ in hmmer <dig> was turned off to increase the search sensitivity  as stated in the manual  <cit> . for example, the true hit glutamyl-trna reductase  was not detected by hmmer <dig> when the ‘nobias’ option was turned on. next, the representative structures for the pfam domains were obtained by searching against pdb fasta database for the most significant hit with e-value <  <dig>  using the global hmm model  for maximum model coverage.

then, the structural residues  were retrieved from the corresponding dssp annotations  <cit>  with the purpose of dissecting each domain alignment into its fold-related/remnant segments so that the final singular fold-related and remnant scores with respect to the hits can be derived using the score reconstruction procedure from the preceding section. also, all the hits except for tip12_maize were found by both hmmer <dig> and hmmer <dig> , although the hmmer <dig> returned only fragmented alignments which offered only partial coverage with respect to the domain models . the statistical significance e-value cutoff for the evaluation was  <dig> .

based on a collective view of the standard hmmer output scores/e-values in table  <dig> , the hits produced hmmer <dig> e-values of between  <dig> e- <dig> to  <dig>  and between  <dig> e- <dig> to  <dig> e- <dig> via hmmer <dig>  at an e-value cutoff of  <dig> , the overwhelming majority of the hits would be considered false based on hmmer <dig>  yet true by hmmer <dig>  and it would be hard-pressed to tell the differences based on the standard total alignment hmmer score/e-value alone.

however, once the fold-critical and remnant scores  were considered, the distinction between the true and false hits becomes apparent as depicted in figure  <dig>  as a general trend, the fold-related scores of hits  <dig> to  <dig>  were vastly smaller than the remnant scores indicating that they are spurious hits. the corresponding fold-related e-values spans from  <dig> e- <dig> to  <dig>   and  <dig> e +  <dig> to  <dig> e +  <dig>  against the more significant remnant segments’ e-values ranges of  <dig> e- <dig> to  <dig> e- <dig>  and  <dig> e- <dig> to  <dig> e- <dig> .

in contrast, the opposite trend was observed for hits  <dig> and  <dig>  where the fold-related scores were larger than the remnant scores. for hit  <dig> , the difference between its fold-related and remnant scores was marginal. the corresponding fold-related e-values of  <dig> e- <dig> to  <dig> e- <dig>  and  <dig> e- <dig> to  <dig> e- <dig>  were more significant than the remnant segments’ e-values of  <dig> e- <dig> to  <dig> e +  <dig>  and  <dig> e +  <dig> to  <dig> e +  <dig> . thus, the latter three hits are rather true homologies in the segment representing the protein fold.

furthermore, to investigate the difference in magnitudes between the fold-critical and remnant e-values, their ratios  were taken. a small ratio  is indicative that the fold-related component is more significant than its remnant counterpart and, hence, its overall sequence similarity gravitates towards homology. on the other hand, a large ratio is suggestive of spurious sequence similarity. at a ratio of  <dig>  both fold-related and remnant segments’ components are on-par. as such, with the range of ratios between  <dig> e +  <dig> to  <dig> e +  <dig>  and between  <dig> e +  <dig> to  <dig> e +  <dig> , hit  <dig> to  <dig> are to be considered as false hits. and with ratios between  <dig> e- <dig> to  <dig>   and between  <dig> e- <dig> to  <dig> e- <dig> , hits  <dig> to  <dig> are to be labeled as true hits.

for the alleged false hits , the sequence architecture analysis was performed  <cit>  and their false associations with the domains is justified as follows . the model lipoprotein  <dig>  can be represented by the transferring-binding protein b  from various bacteria. tbpb is part of the transferring receptor and it is an outer membrane protein that is anchored to membrane via a lipidated n-terminus segment  <cit> . in contrast to the model, if2p_human, if2p_mouse and if2p_ponab are translation initialization factors which are essentially cytoplasmic proteins from various eukaryotes while nucl1_orysj is a plant nucleolin which binds rna in the nucleus. these diverse proteins were related spuriously to the model via an n-terminal disordered/low-complexity segment with remnant segment’s e-values of  <dig> e- <dig> to  <dig> e- <dig>  and  <dig> e- <dig> to  <dig> e- <dig> . for the translation initialization factors, this linker segment contains multiple phosphorylation sites  <cit> . separately, another unrelated domain model hand , a chromatin remodeling factor  <cit> , hits the nucleolin  again, albeit human, on the n-terminal disordered/low-complexity segment with e-values of  <dig> e- <dig>  and  <dig> e- <dig> .

next, the model hnf-1 n  describes the n-terminus of the homeobox-containing transcription factor hnf- <dig> . the latter contains a dimerization sequence and an acidic region which is implicated in transcription activation  <cit> . in contrast, the diversely different false hits mll2_mouse, corto_drome and dhkl_dicdi are a methyltransferase, a chromosomal protein and a kinase respectively. they are related to the hnf- <dig> model merely via a small stretch of n- or c-terminal disordered segments with e-values of  <dig> e- <dig> to  <dig> e- <dig>  and  <dig> e- <dig> to  <dig> e- <dig> .

meanwhile, the model t2sl  describes protein l, an inner membrane protein of the bacterial type ii secretion system that serves as a critical link between the cytoplasmic and the periplasmic part of the eps-system  <cit> . in contrast, the mouse angiomotin  is involved in angiogenesis and regulates the action of the angiogenesis inhibitor angiostatin  <cit> . the angiostatin-binding linker segment of the angiomotin made a false association to this bacterial domain model with remnant segments’ e-values of  <dig> e- <dig>  and  <dig> e- <dig> .

finally, the model ell  is a rna polymerase ii elongation factor that regulates the polymerase ii  <cit> . yet, the hit pk4_dicdi, a protein kinase of slime mold, is related to the model through a small stretch of disordered/low-complexity linker with segmental e-values of  <dig> e- <dig>  and  <dig> e- <dig> .

for the alleged true hits, the justification of sequence similarity between the hit and domain model is best shown by fold similarity, especially for cases of distant homologs  where more sequence divergence is expected. therefore, structure alignment was performed on each pair of representative pdb structures from the hit and the domain model using the jce algorithm  <cit>  .

the model aaa  is a family of atpases associated with various cellular activities. the atp-dependent metal binding core of the domain’s representative pdb structure  consists of the characteristic walker a or p-loop motif, walker b motif and sensor motif, each extending beyond a ß-strand  <cit> . the hit chli_porpu  from plant is a magnesium chelatase that is involved in chlorophyll biosynthesis. its atp core also consists of the three hallmark motifs   <cit> . although the total hmm’s e-values between the hit and model were insignificant at  <dig>   and  <dig> e- <dig>   <dig>  , the fold-relevant e-values were nevertheless significant at  <dig> e- <dig>  and  <dig> e- <dig>   <dig> e- <dig> . in contrast, the remnant segments’ e-values were large at  <dig> e +  <dig>  and  <dig> e +  <dig>   <dig> e +  <dig> . independently, a structural alignment revealed that, despite vast differences between the loop lengths of the two structures, a reasonable rmsd score of  <dig>  over an alignment length of  <dig> positions was achievable over the structural elements . the atp binding domains of both hit chli_porpu and model aaa are indeed homologous.

next, the model adh_short  is a family of nadp-dependent oxidoreductases. its representative pdb structure  is an a-type ketoreductases consisting of two subdomains, a n-terminal sub-structural domain and a c-terminal catalytic subdomain that binds nadp+ and its ß-ketoacyl substrates  <cit> . on the other hand, the hit hem1_metka  is a glutamyl-trna reductase which essential for initiating tetrapyrrole biosynthesis in plants and prokaryotes. structurally, it consists of  <dig> domains : a n-terminal rna-binding domain, a nadph-binding domain and dimerization domain  <cit> . the standard e-values of hit to model were insignificant at  <dig>  for hmmer <dig> but significant at  <dig> e- <dig> for hmmer <dig> over a small fragmented piece. however, both fold-related e-values were significant  while both remnant segments’ e-values were insignificant . separately, a structural alignment between the two pdb structures gave a good rmsd score of  <dig>  over  <dig> alignment positions between the 3mjc structure and the nadph-binding domain of 1gpj . again, the structural alignment revealed the major differences in the loop lengths. nevertheless, both hit and domain share a homologous nadp+/nadph binding structure.

finally, the model form_nir_trans  describes the multi-membrane formate/nitrite transporter  of bacteria that facilitates the formate/nitrite transport essential for anaerobic respiration  <cit> . on the other hand, the hit tip12_maize is a plant aquaporin  that transport water and small neutral solute across the membrane  <cit> . interestingly, it has been previously reported that the fold of the formate transporter is uncannily similar to the family of aquaporins despite a low sequence identity of 9-12%  <cit> , thus raising the question if this transporter is indeed a channel. consistent with previous findings, the structural alignment between the two representative structures produced a good rmsd of  <dig>  over  <dig> alignment positions . meanwhile, the hit tip12_maize was only detectable by the hmmer <dig> domain model at an insignificant standard e-value of  <dig> , but its fold-relevant segments’ e-value was nevertheless significant at  <dig> e- <dig>  interestingly, its remnant segments’ e-value also showed high significance at  <dig> e- <dig>  the latter suggests that, like the diverse family of gpcrs where the loop regions confers the sub-family functions  <cit> , a similar role might also be expected with the non-fold-related segments in the formate/nitrite/aquaporin family.

taken together, we have illustrated that the dissection framework provides the segment-based scores  for a more concise assessment of sequence similarity as evidence for homology. to emphasize, filtering of compositionally-bias sequence segment might be unnecessary since false hits will be occluded under this framework when their non-fold-related segments appeared significant statistically. most importantly, the framework provides an opportunity to elucidate the obscured true hits hidden among the false ones in the twilight e-value range of  <dig>  to  <dig> 

quality score as a proxy to identify the structural segments of domain models for score dissection
in an ideal situation, the combined pdb/dssp data provides the best information for dissecting a domain model into its fold-related and remaining segments for score reconstruction. but currently, only a small portion of domain models have an associated pdb structure. as such, one needs a surrogate for estimating the potentially more conserved elements and remaining segments for the dissection framework to be applicable on a larger set of domain models.

for this purpose, the alignment quality measure  that assesses sequence conservation in clustalx  <cit>  was investigated; yet, the exact form of the measure is not critical for us here. for example, one could have relied on the measure used in jalview  <cit>  or others  <cit> . as a trend, fold-critical segments will deliver dense parts in multiple alignments and, thus, generate high quality scores. in contrast, variable loops and man non-globular types of sequence will result in poor multiple alignments and, hence, produce low quality scores. as is illustrated by figure  <dig>  the segmentation based on dssp annotation will, as a trend, correctly estimate fold-relevant segments  whereas the score based on alignment quality tends to segment more generously including also other segments besides the most fold-relevant ones. nevertheless, in the subsequent section, we show that the high-quality alignment segments  still contain significantly higher fractions of residues engaged in secondary structural elements compared with low-quality alignment segments .

first, the quality score per position for each domain alignment in smart and pfam were computed  in the methods). alignments with less than  <dig> sequences were not considered for the analysis due to insufficient statistical power at a significance level of α =  <dig> . next, each alignment position is classified as high or low-quality based on the appropriate thresholds  in methods). the quality score thresholds are at least  <dig>   and  <dig>   for smart and pfam domains respectively. finally, the high-quality and low-quality segments per domain alignment were derived using equation .

separately, matching structures were searched for. the global-mode hmm models were built using the hmmer <dig> software suite to maximize for full coverage. the hmm models were searched against the pdb fasta sequences to obtain the most significant hit  with the associated secondary structure residues resolved for each alignment position using the dssp annotations  <cit> , and the number of structural residues  is computed.

in total,  <dig>  smart and  <dig>  pfam domains were able to retrieve a significant pdb hit that covers the model’s full length. each of these domain models was then subjected to the fisher’s exact test  in the methods section “fisher’s exact  test …” and also the table therein) to determine if there is an enrichment of structural residues in the high-quality segments against the low-quality segments. interestingly, at a significance level of α =  <dig> ,  <dig>  smart domains and  <dig>  pfam domains were enriched with structural residues in their respective high-quality segments . this is more than 80% of the testable smart/pfam domains. for the remaining  <dig> smart domains and  <dig> pfam domains, there is insufficient statistical power to reject the null hypotheses. this is supported by a control test where the same  <dig> smart and  <dig> pfam domains were tested in the opposite direction to see if there is an enrichment of non-structural residues in the high-quality segments against the low-quality segments but none was significant. thus as a trend, high-quality alignment segments and secondary structures go hand in hand. at the same time, we emphasize that secondary structural elements, as a rule, will lead to high-quality alignments, the opposite is not necessarily true; non-globular segments might also produce high-quality alignments, especially if the number of sequences is not large. for our purpose, it is enough to have the quality score as necessary condition for fold-related segments.

it is also noteworthy to mention that the dissection framework using the quality score were applied to the  <dig> validated examples from the preceding section. the conclusions were similar to that of table  <dig> except for the cases of aquaporin tip12_maize and hem1_metka for hmmer <dig> . in addition, the results of the seg-derived dissection ) for the  <dig> examples were also included; a method that find low-complexity regions as surrogate for long loops and intrinsically unstructured segments  <cit> . based on the seg-derived hmmer <dig> results, the conclusions were generally comparable to that of the quality score. however, the seg-derived hmmer <dig> results suffered from a handful of differences and inaccuracies e.g.  <dig> false hits of the lipoprotein <dig>  domain were concluded as true hits. from this mini study, it appears that any inaccuracy in the segmentation of domain models into its fold-critical and remnant components will be amplified in the final dissection results. this is especially true for the fragmented hmmer <dig> alignments. from the case study examples, the quality score is a better surrogate of pdb/dssp information for domain model dissection when compared to the seg-derived ones.

the dissection framework validates the seed sequences in domain alignments and systematically identifies the potential false positive and false negative hits in hmmer searches
in this section, the behavior of the score dissection framework when applied to the hits’ alignments returned by domain models from hmmer searches was examined. for this purpose,  <dig>  smart and  <dig>  pfam domain models were taken from the preceding section after filtering domain models with low-quality segments of less than  <dig> alignment positions. furthermore, to avoid potential bias in outcome due to differences in search sensitivity by either hmmer <dig> or hmmer <dig>  both were used for the generation of the initial result sets where only common hits by both hmmer <dig> and hmmer <dig> were dissected.

first, each selected smart/pfam domain was searched  against  the seed database consisting of seed sequences and  uniprot/swissprot database to generate altogether  <dig> sets of scores: hmmer2/seed, hmmer3/seed, hmmer2/swissprot and hmmer3/swissprot score sets. next, for each score set, the hit alignments were dissected into high-quality  and low-quality segments. the corresponding sub-scores as well as the total score were statistically evaluated in terms of e-values independently for both high- and low-quality parts .

type  occurs when the score threshold causes the total score to become insignificant  or vice versa.

in the statistical evaluation, the e-values were calculated using a standard database size of  <dig>  in the methods section). this implies that the hmmer <dig> e-values were adjusted since their original e-values were computed based on the size of the returned set. on the other hand, the peculiarity in hmmer <dig> e-value calculation previously reported in  <cit>   was suppressed and the usage of the extreme value distribution  was enforced in all computations. finally, the significance call for e-value is set at  <dig>  as recommended by the hmmer authors  <cit> . subsequently, all hits were tagged as true-positive , false-negative , true-negative  and false-positive  .

finally, the hits from hmmer2/seed and hmmer3/seed score sets were paired as long as the hits shared a common sequence segment to create a unified set between hmmer <dig> and hmmer <dig> results. the same was repeated for hmmer2/swissprot and hmmer3/swissprot score sets. among the paired hits, they can be sub-classified into the concordance and discordance class. accordingly, the concordance class contains hit results agreed upon by both hmmer <dig> and hmmer <dig> where the positive concordance class suggests that the hits are true while the negative concordance class suggests that the hits are false. on the other hand, the discordance class contains the results where hmmer <dig> and hmmer <dig> disagreed upon. fundamentally, this class arises due to the differences in model parameterization and search/alignment algorithm attributed by the two flavors of hmmer. it is beyond the scope of this work to resolve which version of hmmer is better suited for the purpose. in addition, unmatched or orphaned hits are also excluded since this touches on the issue of search sensitivity and it is again not the focus of this work on score dissection .figure  <dig> shows the base performance of the dissection framework when applied on the seed score set. basically, one would expect a high positive concordance rate  and a low negative concordance rate  per domain model given that all its seed sequences are considered to be true hits. this also necessarily follows that the high-quality scores/e-values are more dominant than the low-quality counterparts for these seed sequences.figure 9a and b depict the histograms of the positive concordance rates  in methods) for the  <dig> smart and  <dig> pfam domain models respectively. note that the total paired hits included the discordance hits. generally speaking,  <dig>  smart and  <dig>  pfam domains under investigation exhibit a perfect positive concordance rate as depicted by the horizontal dotted lines. on average, the positive concordance rate was % for smart and % for pfam as depicted by the vertical dotted lines. this suggests that almost all the seed sequences were correctly labeled as true hits.

true
hmmer3
true

false
hmmer3
false

true
hmmer3
false

false
hmmer3
true

only
only
however, there were about a dozen of domains that have deviated from the ideal rate of 100% quite significantly. at below 90% positive concordance rate, there were altogether  <dig> pfam and  <dig> smart domains. a detailed breakdown of the seed sequence classification of these  <dig> domains was given in table  <dig>  among these domains, the discordance rates of several domains like sm <dig> , pf <dig>  , sm <dig> , sm <dig> , pf <dig>   and pf <dig>   stood out at more than 20% . incidentally, their domain lengths range between  <dig> and  <dig> alignment positions . this implies that for these short domains, an e-value threshold of  <dig>  is not optimal.

there was also another interesting observation with regard to the differences in search sensitivity between the hmmer variants. for the cases of sm <dig>  and pf <dig>  , it was found that the number of orphaned hits found by hmmer <dig> only  was more than the number of common hits that can be paired between hmmer <dig> and hmmer <dig> . as a side effect, they suffered a low positive-concordance rate. an investigation on their domain model revealed that more than half the alignment positions are made up by gaps rather than sequences . thus, the list of domain models that dramatically differ from the optimal recovery rate of sequences in this test can also be seen as a suggestion for domains that might benefit from seed alignment re-valuation and polishing. this might include either alignment re-arrangement and/or exclusion of some of the seed sequences.meanwhile, figure 9c and d show the histograms for the negative concordance rates  in methods) of the same sets of domains. in this case,  <dig>  smart and  <dig>  pfam domains have a zero negative concordance rate . on average, the smart and pfam domains have a negative concordance rate of % and % respectively , implying that almost none of the seed sequences are mistaken as false hits. taken together, the dissection framework has asserted the validity of the seed sequences as true hits of their respective domains.the concordance hits were also plotted in terms of their high-quality  e-values and low-quality  e-values in figure 9e to h. the positive concordance hits are in red while the negative ones are in blue. figure 9e and f shows the concordance hits generated by hmmer <dig> for smart and pfam domains. from both plots, the trend where the high-quality e-values are more dominant than the low-quality e-values is apparent . this implies that these positive concordance seed sequences are indeed true hits of the respective smart and pfam domains. meanwhile, a small number of negative concordance hits reside in the insignificance quadrant defined by high-quality e-value >  <dig>  and low-quality e-value >  <dig> . these are the hits that had contributed to the non-zero discordance rates. meanwhile, figure 9g and h depict the smart/pfam results for hmmer <dig>  essentially, the same conclusion can be made.

having established the baseline performance of the dissection framework, we then attempt to quantify the level of false-negative  and false-positive  hits from the results of the unified swissprot score set generated earlier . to emphasize, a fn hit is a positive hit that has been mistaken as a negative hit due to its inability to score well against the low-quality segments while a fp hit is a negative hit that is thought to be a true hit due to a significant score on the low-quality segments. the low-quality segment score is especially redundant for the current domain models under investigation since these segments harbored mostly residues which contribute lesser to the overall fold of a protein than the structural residues. as a measure of fn and fp rates, the sum of tpfn, fntp and fnfn hits and the sum of fptn, tnfp and fpfp over the total paired hits was taken respectively  in methods and table 3).figure 10a and b show the histograms of the non-zero fn rates for  <dig>  smart and  <dig>  pfam domain models respectively. the remaining  <dig> smart and  <dig> pfam domains with zero fn rates were excluded from the plots. in particular, these  <dig> smart and  <dig> pfam domains potentially generated fn hits in the hmm searches. in fact, some of the fn hits from these domain models were validated as true hits like the magnesium chelatase  and the glutamyl-trna reductase  from our earlier illustration. henceforth, it is suggestive that there are many yet to be validated homologous relationship, albeit distant, between these fn hits and their associated domain model that requires case-to-case clarification. on average, the fn rates were % and % for smart and pfam respectively .meanwhile, figure 10c and d depict the histograms of the non-zero fp rates for  <dig>  smart and  <dig>  pfam domains. the remaining  <dig> smart and  <dig> pfam domains with zero fp rates were excluded from the plots. in contrast to the fn rates, the fp rates were relatively lower where the average fp rate for smart is % and % for pfam . unsurprisingly, since most domain models were constructed from the well-curated swissprot sequences, this resulted in only  <dig> smart and  <dig> pfam domains with non-zero fp rates. indeed, the current domain models have generally very low false hits inclusion as expected. note that all the averages above were taken over  <dig> smart and  <dig> pfam domains respectively.

in hindsight, smart and pfam domain models have never been constructed to find all true hits  and this is not a matter to worry. it is more important in this context that the fp rate is extreme low  for most domain models. the few exceptional models with high fp rates deserve re-visiting and some modifications in their seed alignment. however, it is important to bear in mind that the error rates estimated here are suggestive of baseline rates since the searches have been performed over uniprot/swissprot, which is a relatively small database. the expected error rates might be higher when a larger database such as ncbi’s non-redundant protein database is considered.

discussion
sequence homology concept in its current implementation and the necessity of dissecting sequence alignments
the sequence homology concept is backed by an inductive proof. it originates from the observation that homologous proteins share a high degree of sequence similarity, protein fold and biological function. the key to sharing a similar fold, implying a similar function, between the homologs is dependent on the similarity between the more conserved parts, most importantly the structural elements. as such, the evidence for homology should stem from the similarity between the aligned structural elements and key functional motifs with less emphasis from the other sequence segments. as we delve deeper into the search space, higher sequence divergence is to be expected and it will dilute overall sequence similarity and consequently, the homology signal. therefore, the emphasis on similarity between the structural elements in alignments is the key to finding the homologs  while keeping the false ones at bay.

despite its simplicity and elegance, the sequence homology concept is not readily computable since homology has no direct measure. it can at best be formulated into a hypothesis to be tested from the sequence similarity which is a necessary but insufficient condition for concluding homology. although similarity by chance can be removed by some statistical criterion like e-value, often, the main issue is dealing with the statistically significant similarities of any aligned pieces  that are concluded as homologous instead of convergence as alternative. since current sequence search packages can only operate strictly in similarity space, this has a tendency to promote, to some extent, the fallacy that ‘high sequence similarity implies homology’.

even in current times, this fallacy is still being extensively discussed by several authors, e.g. by varshavsky and coworkers who coined the term “sequelog” in an attempt to differentiate homology from high sequence similarity  <cit>  and by theobald who highlighted the sins of sequence similarity derived p-values in concluding common ancestry  <cit> . however, there was no proposed quantitative solution on the fallacy issue. in mitigation, certain convergence cases in the form of compositional bias segments can be suppressed by pre-filtering with seg prior to blast searches or by turning on ‘null2’ and ‘nobias’ options in hmmer searches, but this also comes with the price of sacrificing some sensitivity   <cit> . on top of that, not all loop segments are compositionally-biased per se. for example, the extracellular loops of gpcr are important in functionally distinguishing the diverse gpcr families  <cit> .

thus, the sequence homology concept has yet to be fully implemented in current sequence homology search packages because mindful distinction between contributions from evolutionary important pieces versus spurious similarity pieces was never explicitly dealt with; hence, this necessitates for the dissection of an alignment for explicit segments to be reevaluated. as we emphasized in the introduction, a  domain is a special protein sequence unit with structural , thermodynamic  and evolutionary  implications  <cit> . protein domain libraries widely used for homology-based annotation contain a sizeable number of entries that do not represent domains in this sense. thus, score dissection becomes an option to deal with this problem. as a necessary condition to be considered as a true hit, the fold-relevant segments should either be more statistically significant than the other segments or minimally be statistically significant on its own.

the dissection framework and its implications in evaluating and detecting homology in annotation pipelines
in our proposed dissection framework, an alignment is dissected into its high-quality segments  and low-quality segments  with the subsequent purpose of statistically evaluating the two segment-based score sums. together with the original scores/e-values, these segment-based sums provide a new level of granularity to the dissection framework for determining if a hit is true  or false . in a nutshell, the dissection framework has created a new paradigm in which homology can be evaluated more concisely and, at the same time, more faithful to the sequence homology concept. and for the purist of the homology concept, sequence searches now have a better chance to escape the fallacy of ‘high sequence similarity implies homology’.

for the true-positives of the domain model, the dissection framework can reassert their validity as legit hits with respect to the domain. indeed, when the framework was applied to the seed sequences of  <dig> smart and  <dig> pfam domain models , they exhibited the average positive and negative concordance rates of 99% and almost 0% respectively. these results imply that the seed sequences were recognized correctly by the framework as true hits of the domains.

on the other hand, cases of false hits  will be occluded by the framework due to their significant low-quality scores/e-values. this scenario was played out by the case study of the  <dig> false hits  where their original hmmer <dig> e-values were insignificant yet significant for hmmer <dig>  despite a contradictory conclusion from the hmmer variants, their remnant segment-based e-values were indisputably significant for both hmmer versions. thus, hmmer <dig> hits were tagged as false-positives while the same hits by hmmer <dig> were labeled as true-negatives. in both cases, they were considered as false hits by the framework. interestingly, pre-filtering of compositionally-bias sequence segment may become less critical under the dissection framework since these hits will anyhow exit as false hits due to their significant remnant segments’ e-values. this also meant that the ‘null <dig> model correction’ and the ‘nobias’ option in hmmer2/ <dig> can be turned off to maximize for search sensitivity to allow more hits.

given the results in this work, a quantitative criterion for assessing segmented hmm scores in annotation pipelines might include the expectation  for the fold-relevant contribution resulting in a low e-value  independently of the e-value for the total alignment and/or  for the ratio between the e-value of the fold-critical part versus that of the remnant contribution clearly below  <dig> 

to emphasize, score dissection with regard to fold-critical and other segments is a generic concept that can be applied to any sequence or multiple aligment comparison technique. this idea can be easily extended, for example, to the blast-based approach with minor adaptations: first, the extraction of the evd parameters from the blast statistics and second, the parameters used for score reconstruction need to be extracted from blosum/pam for blastp algorithm and pssm for psi-blast algorithm.

most importantly, the dissection itself should aim squarely at approximating the location of globular domains by applying either tertiary structure finding algorithms or any tools for detecting non-globular segments. we can only warn against applying non-physical, non-evolutionary dissection principles such as cutting sequences arithmetically first in two parts, then in four and then, maybe, in eight as many might be tempted to. this approach is likely to distribute fold-critical residues to many of the segments, hence diluting evolutionary information instead of enriching it in one class.

the dissection approach helps finding yet unexplored homology relationships
perhaps, the most interesting additional capability of the dissection framework, aside from being able to isolate false hits, is its proposal of unexplored homologous relationships between the hits and domain models. this means the recovery of hits presently being falsely labeled as negatives. when the dissection framework was applied to the search results against uniprot/swissprot for these  <dig> smart and  <dig> pfam domains, it revealed an overall average false-positive rate of less than 1% but the average false-negative rates of  <dig> % for smart and  <dig> % for pfam. although the low false-positive rate implies that the current domain models have generally very low false hits inclusion, the moderate false-negative rates suggest that there are many potential true hits that are obscured by bad e-values. this situation was exemplified by our case study where the previously insignificant true hits  were obscured as a result of heavy score penalties on the low-quality alignment segments. however, they were subsequently rescued by their significant fold related segments’ e-values.

in particular, the discovery of the homologous relationship between the plant aquaporin  and formate/nitrate transporter , which indicates that the latter is actually a channel, was essentially exclusive to the structure-alignment based approaches. even though certain sequence search methods might detect some level of sequence similarity between aquaporin and formate transporter but their e-values remain statistically insignificant . however, with the proposed dissection framework, this evolutionary relationship can be rediscovered in sequence similarity space through the justification of a statistically significant fold-critical e-value. taken together, we have shown that it is possible to explore deeper into sequence space to recover novel true hits without admitting the false ones. surprisingly, this is achievable without tweaking or modifying the existing search algorithms but by simply performing postmortem dissection of alignments and re-evaluation of the segment-based scores.

estimation of evolutionary segments in domain models
it is neither practical nor reasonable to create domain models without their non-fold-related segments so identifying these pieces is a matter of necessity. a critical component in the proposed dissection framework is the pre-definition of the evolutionary-related pieces in the domain models. the pdb/dssp data gave the best delineation of fold-critical segments from the remaining ones. however, it suffices only as a proof of concept for the dissection framework and is not readily applicable to domain models that do not have a significant pdb structure representation. hence, a more generalized measure is required as a reasonable surrogate for estimating structural segments of domain models. as such, the quality score from clustalx  <cit>  as representative of similar alignment quality scales, which measures sequence conservation for each alignment column, was investigated.

as it turns out, the fishers’ exact test showed that  <dig> smart and  <dig> pfam domains were enriched with structural residues in their respective high-quality segments. this was out of  <dig> smart and  <dig> pfam domains with a representative pdb structure. correspondingly, the high-quality and low-quality segments were able to reasonably estimate the fold-critical and remaining segments respectively. this was further reinforced when the examples from the case study were reexamined by the dissection framework using the quality score instead of pdb/dssp. overall, the conclusions were similar with the exception of  <dig> hits . for the cases of these  <dig> hits, this signifies that quality score is an overestimate of fold-critical segments and as a result, it tends to underestimate the false-negative hits by adding part of the negative remnant sum to the fold-critical sum. indeed, a scrutiny on the high-quality segments of the associated domain models for these  <dig> hits revealed that some of these segments were covered by loop residues when compared against the pdb/dssp annotations.

in hindsight though, one should err on the side of conservativeness; i,e., one needs to be more stringent with claiming a true hit. therefore, the quality-score is still a reasonable estimate for partitioning the fold-relevant and remnant segments. nevertheless, one can easily add more estimates like low-complexity/disorder predictors  on top of the existing quality score measure so that a more comprehensive definition of fold- and domain function-critical versus other segments can be derived.

however, this task of selecting/combining predictors to mimic the pdb/dssp information to perform domain segmentation is not straightforward. when compared to the quality-score results, the application of seg-based dissection to the  <dig> case study examples worked equally well for the hmmer <dig> hits but less so for many of the fragmented hmmer <dig> hits. this revealed the sub-optimality of seg in elucidating the fold-critical domain segments when compared to the quality-score. consequently, the effect is more pronounced in the short fragmented hmmer <dig> hits than the longer hmmer <dig> hits. despite so, the seg-derived segments can still help to identify well-conserved low-complexity segments  that will otherwise be missed by the quality-score. hence some combination of the two predictors makes sense.

in any case, the creation of a catalogue of segmentations for existing protein domain libraries such as pfam or smart will be necessary in the absence of complete pdb/dssp information for a foreseeable future and it will be considered in our future work.

CONCLUSIONS
as sequence homology can only be concluded inductively and overall sequence similarity is a measurable, necessary but insufficient criterion to justify homology, additional considerations are required to decide about homology relationships between biomolecular sequences. to distinguish the true cases from the false background might be possible in a manual study for individual cases; yet, a computerized pipeline for large-scale annotation requires quantitative conditions.

the complex hydrophobic/hydrophilic sequence pattern necessary for fold formation and conserved during evolution can be used for this purpose by dissecting the similarity score into fold-critical contributions and other parts originating from non-globular segments, long loops, etc. this work serves as a proof of concept for this idea. the dissection framework and the software tools provided with this article are useful for systematically suppressing otherwise generated false-positive hits in sequence similarity searches.

the dissection approach allows also extracting more value out of existing protein domain model databases without the need to re-edit them simply by defining segmental contribution and, thus enhancing or deemphasizing certain parts of the seed alignments.

surprisingly, this approach was also successful in recovering hitherto hidden homology relationships by stripping away the noise created by score contributions from non-fold-critical, non-globular protein regions.

