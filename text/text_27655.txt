BACKGROUND
comprehensive and accurate reconstruction of the metabolic networks remains an important problem for both newly sequenced and well-studied organisms  <cit> . the challenges posed by the experimental determination of the metabolic enzymes have lead to development of computational methods for metabolic reconstruction. the most common approach is to identify genes encoding a specific metabolic enzyme by establishing sequence homology to functionally characterized enzymes in other species  <cit> . although such sequence homology methods have been remarkably successful overall, they fail to identify enzymes encoded by genes with poor sequence homology to known metabolic enzymes, and result in partially reconstructed metabolic networks. in some cases sufficient biological evidence exists to believe that a particular pathway is present in the organism, however genes associated with key reaction steps can not be identified. the problem of identifying genes encoding for a specific metabolic function in such partially reconstructed networks has been referred to as the "missing gene" problem  <cit> . the case for a missing gene can be based either on direct experimental evidence for a particular enzymatic function in the organism, or on variety of comparative and computational analysis of known metabolic pathways, biochemical constraints and environmental conditions  <cit> . we note that the problem of identifying missing genes, considered in this manuscript, is different from the traditional problem of functional gene annotation, which aims to assign function to a given gene.

computational strategies for identifying missing metabolic genes rely on refined sequence homology analysis  <cit>  and consideration of functional association evidence linking candidate genes with known enzyme-encoding genes  <cit> . for example, pathwaytools hole-filler developed by green et al.  <cit> , prioritizes candidates obtained from an initial sequence homology search by using, among other factors, information on whether the candidate gene is located adjacent to, or in the same transcriptional unit as known enzyme-encoding genes of related metabolic function. in some cases, strong genome context association evidence, such as clustering of genes on the chromosome, or co-occurrence of genes in phylogenetic lineages, has played a key role in identifying metabolic genes in several organisms  <cit> .

an extensive set of tools has been developed to detect and catalog general pair-wise functional associations between genes based on a combination of genome context methods and other evidence, such as co-expression or protein interactions  <cit> . combinations of heterogeneous association evidence have been used for general functional inference  <cit> , prediction of protein complexes  <cit>  and synthetic lethal interactions  <cit> . a recent work by yamanishi et al.  <cit>  relied on a combination of genomic, mrna expression and localization evidence, together with information on chemical compatibility to reconstruct metabolic pathways from known metabolic enzymes. while it has been suggested that genome context associations can be used for general prediction of missing enzyme-encoding genes  <cit> , methods for systematic targeting of missing genes have not been characterized. we develop a method for generating such predictions based on combination of genome context and other functional association evidence, and show that it is effective for majority of the enzymatic functions in e. coli and s. cerevisiae.

in an earlier study we have described a method for identifying missing enzyme-encoding genes based on gene co-expression and local structure of metabolic network  <cit> . the candidate genes for encoding a missing metabolic enzyme were evaluated based on the overall similarity of their expression profile with the expression of the metabolic network neighborhood of the missing enzyme . the local property of gene co-expression, which formed the basis of this method, is also observed for other types of functional associations, in particular for associations established by genome context  <cit> . in this work we show that such approach can be extended to identify metabolic enzyme-encoding genes from a number of different types of functional association evidence, including phylogenetic profile co-occurrence, physical clustering of genes on the chromosome and protein interaction data. we note that the presented method does not rely on sequence homology to known enzymes, and its predictions are complementary to the traditional methods of metabolic reconstruction.

we illustrate the performance of each individual type of association evidence by testing how well the method is able to predict known enzyme-encoding genes of e. coli  <cit>  and s. cerevisiae  <cit>  metabolic models . a set of candidate genes, containing all non-metabolic genes in an organism, is evaluated and prioritized by evaluating overall association of each candidate gene with the neighborhood of the missing metabolic enzyme . the overall association is calculated by combining associations with each layer of the metabolic neighborhood. specifically, for a missing enzyme with a metabolic neighborhood consisting of layers {l <dig>  l <dig>  l3}, each candidate gene x is evaluated by a combination of layer association scores, scoreli
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgzbwccqwgjbwycqwgvbwbcqwgybgccqwglbqzdawgaawcbagaemitaw0aasbaawqaaiabdmgapbqabaaaleqaaaaa@3671@ , that measure the strength of functional associations of candidate gene x with known enzyme-encoding genes in the neighborhood layer li . the individual layer association scores are combined using one of two methods  to obtain a measure of overall association of candidate gene x with the metabolic network neighborhood of the missing enzyme.

to assess the performance of our method we rely on a self-rank measure, which is the rank of a known enzyme-encoding gene among the set of candidates prioritized for its own metabolic function . we develop techniques for combining multiple types of association evidence and show that significantly better prediction performance can be achieved based on combined association evidence.

RESULTS
similarity of phylogenetic profiles
a number of earlier studies have explored using patterns of gene co-occurrence or absence in the phylogenetic lineages to infer functional association between gene pairs  <cit> . the basic premise of the method is that a function is likely to be encoded by several associated genes; therefore lineages maintaining only some of these genes will have lower evolutionary fitness. for instance, enzymes catalyzing successive steps of a linear metabolic pathway are likely to be present together in an organisms relying on that metabolic pathway, and absent together from an organisms that does not require that pathway.

a phylogenetic profile of a given gene on a set of ng genomes can be encoded as binary string of length ng, with each position marking presence  or absence  of an ortholog in the corresponding genome. functional association between a pair of genes is assessed by the degree of similarity of their phylogenetic profiles. a number of different distance measures have been used to calculate such similarity, including hamming string distance, mutual information and hypergeometric distribution  <cit> . we find that the performance of different distance measures is very similar . these profile similarity measures do not take into account variable degree of divergence between genomes comprising the orthology dataset. this is particularly clear in the case of hypergeometric distribution measure  <cit> , which assumes that ortholog occurrences are independently and identically distributed across the set of included genomes .

the identity assumption would suggest that the total number of ortholog occurrences within each genome should be approximately the same, and the distribution of the number of orthologs should form a single, narrow peak around an average ortholog number. the empirical distribution , however, is quite different from the expected form, lacking a peak around the mean, and showing substantial density over almost an entire range of ortholog numbers. when the identity assumption is relaxed, profile similarity probability is described by the extended multivariable hypergeometric distribution  <cit> . because probability functions of this distribution have not been derived in a closed form, we developed a numerical algorithm for estimating these probabilities .

bias stemming from the violation of the independence assumption can be minimized by exclusion or reduction of closely related species in the ortholog occurrence dataset. we employ a method similar to previously published work  <cit> , which reduces the bias by folding together phylogenetic branches containing closely related species, and using an ortholog occurrence pattern based on the agreement within the folded branch .

the effect of both corrections on the ability to predict enzyme-encoding genes in e. coli is illustrated by the cumulative self-rank distributions  in figure 2a. the extended hypergeometric distribution correction for the variable genome divergence from e. coli target genome  provides a noticeable improvement in prediction performance . on the other hand, the folding method correcting for variable divergence with the set of query genomes  does not significantly improve the results.

the phylogenetic profile co-occurrence method depends on identification of orthologous genes across potentially diverse lineages. existing investigations have used a variety of methods, including readily available clusters of orthologous groups  database  <cit> , closest homologs  <cit> , and best bi-directional homology pairs  <cit> . the results presented in our work rely on two alternative sets of orthology data. the first set comes from kegg ssdb database  <cit> , and includes closest homologs and best bi-directional hits as determined by the smith and waterman algorithm . the second set was constructed based on results of blast  <cit>  queries against a "non-redundant" set of known protein sequences maintained by ncbi . the set also includes information on reverse blast searches to determine best bi-directional hits .

predictive performance of different orthology datasets is compared in figure 2b. we note that coverage of the cog orthology data is biased towards genes encoding known metabolic enzymes , and the self-rank performance of this dataset was estimated by normalizing with respect to the non-metabolic gene coverage. figure 2b shows that profile associations calculated using blast-based dataset provide better predictions of enzyme-encoding genes than association based on the kegg orthology dataset. we also find that in the case of both datasets better performance is attained when using best bi-directional homology pairs instead of closest homologs .

as a consequence of gene duplications, metabolism contains a significant number of paralogous enzyme pairs  <cit> . in many cases, such enzymes continue to catalyze the same reactions . such pairs will frequently have similar or identical orthology mappings, and their inclusion can lead to a significant bias in estimation of the predictive performance . the results presented in this work, therefore, exclude self-ranks of any metabolic enzymes that have high sequence homology to any other metabolic enzyme in the organism .

co-expression of orthologous genes
the approach for identifying enzyme-encoding genes based on the similarity of mrna expression profiles  <cit>  can be extended to include co-expression information of orthologous genes in other organisms. conservation of mrna co-expression across different species has been investigated by a number of recent studies  <cit> . for example, analysis of co-expressed gene pairs between s. cerevisiae and c. elegans shows statistically significant  level of conservation  <cit> . although the number of pairs with highly conserved co-expression is small, incorporating ortholog co-expression can provide significant improvements to the accuracy of functional predictions based on the mrna expression data  <cit> .

we find that enzyme-encoding gene predictions based on the co-expression of e. coli orthologs in s. cerevisiae  achieve good performance on the enzymes covered by such dataset. although s. cerevisiae orthologs can be identified for only  <dig> % of e. coli metabolic genes, combining native and ortholog co-expression scores provides noticeable improvements. combination of native and ortholog co-expression increases the fraction of metabolic enzymes predicted within the top  <dig> candidates from 27% to 36% . similarly, using e. coli expression data improves prediction results for enzyme-encoding genes of s. cerevisiae metabolic network. overall self-rank performance based on combined co-expression data is included in figure  <dig> 

clustering of genes on the chromosome
relative positions of genes on the chromosome have also been successfully used to infer functional associations. most notably, analysis of prokaryotic genomes focused on identifying pairs of orthologs located close to each other on the chromosome, as well as sets of such pairs  <cit> . such clustering is also observed in the eukaryotic genomes, even though they lack well-defined operon structures. a recent study by lee et al.  <cit>  analyzed clustering of genes in kegg pathways for  <dig> distant eukaryotic species. the study demonstrated that depending on the genome, 30% to 98% of the pathways exhibit statistically significant levels of gene clustering on the chromosome. a variety of methods have been developed for identifying chromosome gene clusters and evaluating their significance  <cit> . to generate association scores we use a simple statistical evaluation strategy based on the chromosome gene order, which allows for computationally efficient treatment of large number of genomes .

the self-rank performance based on the chromosome clustering association is shown in figure  <dig>  the overall performance for known e. coli metabolic enzymes is better than for the s. cerevisiae enzymes, which is expected given the prominent role of operons in prokaryotic transcriptional regulation.

other association measures
interacting proteins encoded by separate genes in some species, may sometimes occur as a single, multi-domain fusion protein in other species. detecting fusion of non-homologous proteins in another organism has been shown to be a significant predictor of functional association between genes  <cit> . our calculations of a fusion association score are based on a combination of fusions detected at several sequence homology thresholds , almost all of predicted enzymes are returned within the top  <dig> candidates.

a number of metabolic reactions are catalyzed by well established protein complexes, such as the phosphofructokinase complex. furthermore, metabolic processes commonly involve interactions between multiple metabolic enzymes. for instance, the phosphofructokinase alpha subunit encoded by pfk <dig> also interacts with a product of fba <dig>  fructose-biphosphate adolase ii, catalyzing an adjacent reaction in the glycolysis pathway  <cit> . large protein-protein interaction datasets have been generated by studies using yeast two-hybrid systems  <cit>  and, more recently, mass spectrometry-based techniques  <cit> . in the framework of our approach, candidate genes can be evaluated by assessing the overall amount of interactions between a candidate gene and the metabolic network neighborhood of a missing enzyme. to assess confidence of individual interactions, our analysis makes use of the probabilistic protein interaction dataset from jansen et al.  <cit> , which combines results of four high-throughput interaction datasets  <cit> . the performance of our prediction method on the protein interaction data is significantly lower than that of other association scores, nevertheless it is above of what is expected from a random association score .

functional association can be also assessed through similarity of deletion mutant phenotypes under a large set of environmental conditions. for example, deletions of genes that are adjacent to each other in a linear metabolic pathway are likely to result in identical mutant phenotypes. a recent work by dudley et al.  <cit>  experimentally measured growth phenotypes of  <dig> s. cerevisiae mutants under  <dig> experimental conditions, including different carbon sources, nutrient limitations, stress and others conditions. we tested the performance of our prediction algorithm on a set of  <dig> known metabolic enzyme-encoding genes for which high-confidence data was available . while the results illustrate predictive power of phenotypic profile associations, overall contribution of this score to the predictions of unidentified enzyme-encoding genes is very small. this is expected, because available high-confidence phenotypic data covers only 14% of s. cerevisiae genes.

overall enhancements of the individual association scores
description of a metabolic network neighborhood can be enhanced by considering relative strength of metabolic connections established by different metabolites. metabolites connecting many enzyme-encoding genes pairs establish, on average, weaker functional associations  <cit> . the performance of our predictive method can be improved by weighting the contribution of each neighbor in evaluating the overall association of a candidate gene with the metabolic network neighborhood of a missing enzyme. the weight is assigned according to the total number of enzyme pairs associated with a connecting metabolite .

distributions of association scores between a given gene and all other genes in an organism tend to differ from one gene to another. for instance, a gene whose orthologs can be identified in many organisms will typically have more high-confidence chromosome clustering associations than a gene with relatively few detected orthologs. this introduces bias when evaluating overall association with a metabolic network neighborhood. the association-rank rescaling  reduces this bias by translating raw association scores into probabilities of metabolic adjacency, calculated based on the rank of raw association score within a distribution of all scores for a particular gene. the rescaling procedure also reduces the number of false positives by considering raw association score of a gene pair with respect to organism-wide score distributions of both genes and choosing a more conservative adjacency probability value.

the effect of metabolite-weighting and association-rank corrections on the self-rank performance is shown in additional file  <dig>  the predictive performance of all association scores is improved by either correction, with the exception of the protein fusion score, where application of metabolite weighting results in weaker performance.

predictions based on combined association evidence
enzyme-encoding gene predictions based on the individual association scores can be combined to achieve better performance. normalizing relative strength of different association scores requires informative priors. such priors can be either constructed manually, for example by consulting experts  <cit> , or learned from known test-cases. this problem has been extensively considered with respect to confidence in pair-wise gene functional associations, and test cases for learning the priors were based on known functional groupings, such as go annotations  <cit>  or membership in kegg pathways  <cit> . for the current problem of prioritizing enzyme-encoding gene candidates, such priors can be learned from known enzyme-encoding genes  <cit> .

towards the goal of integrating multiple types of association evidence, we have developed two distinct methods. the first approach is based on a direct likelihood-ratio  evaluation of the association score probability distributions. the likelihood that a given candidate gene encodes the desired metabolic enzyme is calculated under the simplifying assumptions that individual association scores are independent and monotonic. the monotonic assumption states that for every association score, the likelihood of association increases monotonically with the absolute value of the score. both assumptions allow for useful approximations, but in general can be shown to be incorrect. for example, clustering of genes on the chromosomes in e. coli is statistically significantly correlated with the similarity in expression profiles , violating the independence assumption. the dlr method calculates overall likelihood ratio of a candidate gene encoding the desired enzyme as a product of likelihood ratios for each individual association score .

the second approach uses a general machine learning method called adaboost  <cit> , and does not rely on independence or monotonicity of the association scores. the generated classifiers are in the form of alternating decision trees , which are generalization of decision stumps, decision trees, and their combination  <cit>  . in addition to flexible semantic representation, adt-based classifiers provide a real-valued measure of confidence, called classification margin, which can be related to the probability of a given classification being correct  <cit> . the adaboost method has been successfully applied to several large-scale biological problems, including detection of transcription factor binding motifs and prediction of regulatory response  <cit> .

we find that in identifying missing metabolic genes both adt and dlr methods achieve comparable levels of performance . the adt method performs slightly better on e. coli metabolic enzymes, and dlr on s. cerevisiae. success of the dlr method relative to a general classifier, such as adt, suggests that the derived association scores are largely consistent with the underlying assumptions of monotonicity and independence, and allow quality predictions to be made based on a straightforward evaluation of the score probability distributions. the adt method, however, does not require such assumptions, and may be used to incorporate in the future a wide variety of unrestricted descriptors, such as sequence homology data or expression variability  <cit> .

prediction performance of individual functional association scores and their combination using adt method is shown for e. coli metabolic enzymes in figure 4a. the figure illustrates that predictions based on the combined evidence are clearly superior to what is achieved by any individual type of functional association evidence, with 43% of known enzymes predicted as number one candidates for their enzymatic function, and 60% within the top  <dig> candidates. associations based on the chromosome clustering provide the best predictions of any single evidence type, and are able to predict almost half of the metabolic enzymes within the top  <dig> candidates. it is also important to note that different association evidence types are not redundant – none of the predictions based on a particular association score are completely covered by the predictions of another association score . predictions for  <dig> unknown and recently identified enzyme-encoding genes that are specified as missing in the e. coli metabolic model are given in additional file  <dig> 

individual and combined prediction performance for enzymes of s. cerevisiae metabolic network is illustrated in figure 4b. relative to e. coli predictions, co-expression score in s. cerevisiae tends to perform better; however chromosome clustering and phylogenetic profile association scores perform worse. the overall level of performance is also lower, with approximately 60% of the enzymes predicted within top  <dig> candidates . the performance difference can be partially attributed to lower number of candidate genes in e. coli  and wider availability of the genomic data for bacterial organisms. for instance, chromosome clustering associations were calculated on a dataset that contains nearly a hundred bacterial species and only a handful of eukaryotic genomes.

as earlier studies have utilized pre-defined metabolic pathways to establish functional context of a missing gene, we compared performance of predictions based on layered metabolic neighborhoods with predictions based on kegg pathway membership. a set of kegg metabolic pathways for a particular organism provides a list of reactions and enzymes analogous to the e. coli and s. cerevisiae metabolic models used throughout this manuscript. such pathways also represent pre-defined, functionally meaningful partitions of the metabolic network. to compare predictive performance, the candidates were evaluated based on the functional associations with genes in the relevant kegg pathway, instead of the metabolic network neighborhood. we find that associations with layered metabolic neighborhoods are more informative in both e. coli and s. cerevisiae metabolic models than associations with enzymes in shared kegg pathways . for e. coli the difference in fraction of predicted enzymes is greatest at low self-ranks , and decreases for higher self-ranks . this is expected because metabolic neighborhoods are determined specifically for the desired enzymatic function and prioritize neighbors into layers of decreasing functional relevance.

CONCLUSIONS
the results presented in this work demonstrate that the gene encoding a specific metabolic function can be effectively identified from combined functional association with the metabolic network neighborhood of the desired function. this indicates that the relationships established by the local structure of the metabolic network impose constraints on a wide range of natural processes, such as gene expression or evolutionary processes on both molecular and genomic scales. our tests used a combination of genome context and expression data to identify known e. coli metabolic enzymes, predicting them within the top  <dig>  candidates in 60% of the cases. we show that in the case of both e. coli and s. cerevisiae, combining multiple types of association evidence results in a significantly better prediction performance than that of any individual association score.

in validating the performance of our method, we relied on the functional associations established by the metabolic network neighborhood as the sole source of information about the desired enzymatic activity. in practice, additional clues regarding activity or physical properties of the unidentified enzyme can be often used to narrow down the set of candidates. these additional clues may provide restrictions on the phylogenetic profile pattern, protein size, presence or absence of membrane spanning regions or specific protein domains. for example, the recently identified e. coli arabinose-5-phosphate isomerase, yrbh  <cit> , is predicted as a 10th candidate among all genes, but is the only candidate within the top  <dig> with a putative sugar isomerase domain .

the presented approach is limited in its ability to predict additional functions for the enzyme-encoding genes already present in the metabolic model. specifically, evaluating an enzyme-encoding gene from the metabolic neighborhood of a desired enzymatic function as a candidate for that function, would typically result in a high score regardless of whether the gene actually encodes a desired enzyme.

sequence homology to known proteins remains the primary method of identifying missing enzymes  <cit> . predictions based on the association evidence considered in this work are complementary to homology-based methods, and can be used to target enzymes that have not been identified in any organism . integration of genome context information into the refined sequence homology searches has been shown to improve the predictions  <cit> . it will be important to analyze how incorporation of diverse association evidence presented in this work would improve the performance, in particular in with respect to the difficult cases of weak or ambiguous sequence homology. the overall performance of the presented method can be improved in a number of ways. the datasets underlying individual scores can be expanded. genome divergence corrections for the chromosome clustering score are also likely to improve the results. further extensions can provide better identification in the cases where multiple missing genes appear within the same metabolic neighborhood. this should be particularly helpful for enzyme identification in poorly studied organisms. in such organisms, the performance of the method will be determined by how much is known about the metabolic neighborhood of the specific enzymatic function. we hope that the presented method, and its future derivations, will be important in completing metabolic models of different organisms.

