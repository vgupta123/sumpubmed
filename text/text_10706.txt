BACKGROUND
one of the imperative aspects in drug design and development is to perceive corresponding bioactive conformations which determine the physical and biological properties of drugs  <cit> . conformation generation is the kernel in computer-aided drug design  methods such as molecular docking  <cit> , pharmacophore construction and matching  <cit> , 3d database searching  <cit> , 3d-qsar  <cit> , and molecular similarity/dissimilarity analysis  <cit> , to name a few. the ability to account for conformational flexibility is highly valued by these methods as it presumes that small molecules have to adopt energy-reasonable conformations in respect of different environments. however, according to boltzmann law, the properties observed for "one molecule" are actually the conformer-ensemble averages  <cit> . the conformers with high energies contribute little to the ensemble-average properties quantitatively and consequently have to be discarded during the conformation generation process. to select those low-energy conformers, a brute-force method can be applied to enumerate a set of conformations to describe the real-life distribution of the molecular conformational ensemble across the energy surface. unfortunately, thorough conformational sampling may lead to combinatorial explosion problem even if the molecules are decomposed into fragments first and recombined into new conformers using predefined torsion library  <cit> . therefore, a practical conformational ensemble should guarantee the conformers are energy reasonable and can span available conformational space evenly.

recent studies on crystal structures of ligand-protein complexes revealed that the bioactive molecules tend to adopt more extended conformations than compact ones  <cit>  and may be several kcal/mol higher in energy than their respective global energy minima  <cit> . although our knowledge about the pharmacologically allowed conformational space is still limited, one of the criteria for accessing conformer generation tools remains to be to what extent the experimental determined conformations can be reproduced as quickly as possible since it's not applicable to cover the whole conformational space in short time. researchers are referred to the works by bostrom who evaluated the capability of reproducing the bioactive conformations of several state-of-art conformation generation programs  <cit> . when it comes to conformational analysis in which multiple low-energy conformations are required, the generated conformers need to be geometrically distinct in case that some "hot spots" of the conformational space are over sampled, which cannot reflect the molecular flexibility because duplicated conformers failed to provide new information about the system. from this point of view, conformation generation may be formulated as a multi-objective optimization process in which the optima are not dominated by sole criteria exclusively. moreover, besides of potential energy and geometrical diversity restraints, other sophisticated or rule-of-thumb criteria such as pharmacophore and binding pocket mapping can be implemented to sample more biased conformers fulfilling these objectives.

as a non-deterministic optimization method, genetic algorithm  has been broadly applied in molecular docking, pharmacophore construction, and conformation generation  <cit> . most traditional ga implementations of conformation generation perturb the dihedral torsions of rotatable bonds  fused aliphatic rings) using single objective function, which can be either potential energy of single individual conformers or some sophisticated designed metric of conformational space completeness/saturation in conjunction with the population each individual belongs to. for a detailed review of application of single objective ga in computer-aided drug design see the references  <cit> . however, in practical application, an ideal conformer ensemble must meet both energy and diversity criteria simultaneously , and it's imperative to consider all the objectives to find a set of equally valid optima  to maintain the balance between these restraints. consequently multi-objective genetic algorithm  or multi-objective evolution algorithm  is an alternative appropriate method to solve such trade-off problems.

moga or moea method has been successfully applied to diverse areas in cadd, e.g. molecular docking  <cit> , pharmacophore generation  <cit> , combinational library building  <cit> , and qsar analysis  <cit> . during the preparation of this manuscript, vainio used the moga method to generate conformer ensembles for drug-size organic molecules  <cit> . in his work, two uncorrelated objective functions, van de waals  energy and dihedral torsion energy, were calculated individually using the mmff <dig> force field. a niche filter on the basis of calculating the root mean square deviation  between conformers as well as a user-definable energy cutoff value were used to reduce the size of the generated ensemble in the post processing step. tested against the ccdc/astex test set containing  <dig> entries with known bioactive conformations, the authors declared their method successfully produced low-energy conformers that are geometrically distinct from each other, which was the result their method designed to obtain.

in this work, a moea-based conformation generation method, named cyndi, is presented with four specially designed objective functions. the conformers are encoded into ga individuals with the dihedral torsions of rotatable bonds, vdw and torsional energy terms are selected as two distinctive objectives to separate the generated conformers in energy space using tripos force field  <cit> ; moreover, the geometric dissimilarity  of the individuals is characterized by comparing the rmsd value between each individual and the corresponding initial conformer. as an optional objective, the molecular gyration radius is employed to sample the conformations with various geometric extension degrees. as a proof-of-concept test, a combined test set composed of  <dig> small molecules, whose bioactive conformers are available from protein data bank   <cit> , is benchmarked against our method. the ability of cyndi in reproducing bioactive conformations as well as generating geometrically diverse conformational ensembles is well assessed and the results demonstrate that cyndi provides an effective means to sample the conformational space and find the set of conformers with expected energy stability and geometric diversity.

RESULTS
flowchart
the design and application of the genomes and objectives are based on ο-moea method developed by deb et al.  <cit> . the general flowchart of cyndi is elucidated in figure  <dig> and summarized below:

a. read the input molecules, and then initialize the population of n individuals by perturbing the input 3d conformer with randomly generated dihedral angles. afterwards, step through the population to pick up the non-dominant individuals into archives.

b. pick up the parents using tournament selection to generate new child with crossover and mutation operations, calculate the fitness for the new child and update the archive if the new child dominates any individuals in the archive. repeat the generation procedure until the termination condition is achieved.

c. discard the geometrical redundant conformers with the rmsd filter.

d. optimize the remaining conformers with energy minimization and discard the conformers outside the energy cutoff, then discard the geometrical redundant conformers again.

e. output the final generated conformers.

profiles of conformer ensembles generated by moea method
with traditional single-objective approach, the solutions identified through several independent runs may be local minimum in a single-objective space. hence, compromise between energy and geometrical feasibility has to be explicitly considered to select the solutions from the single-objective conformational space  <cit> . cyndi surmounted this problem by offering a set of pareto solutions from which the users can select a conformer bearing favoured vdw energy but low gd value or vice versa. in this way the pareto frontier actually covers the different region of the solution space and suppresses the "randomness" inherited with the ea algorithm. different conformations are generated and possess rationality with respect to at least one objective.

for the case with 2-objective functions, the pareto optimal solutions in the final archive should distribute across a 2d pareto frontier curve and non-overlap with each other. for the case with 3-objective functions, the pareto front curve transformed into a 3d surface whose profile is hard to predict. therefore, to visualize the distribution of the solutions on the pareto front, the exemplary scatter points as well as surface landscape for the ligand of 1mcr  is plotted in the 3d space composed of  <dig> objective values of each solution in the final archive . to clarify the result, the 3d hypersurface are mapped onto the plane formed by the other two objectives in contour mode that using continuous deepening colors to represent increasing gd values . then corresponding solutions are also mapped on the same plane as scattered points whose sizes varied with corresponding rmsd values. one can see the solutions in the final archive are separated quite well in the three-objective space and only few points overlapped on the solution surface . these solutions are the representatives of the feasible solution space.

computational performance of cyndi
the ability for conformation generation of cyndi was tested against a data set containing  <dig> drug-sized molecules whose bioactive conformations were extracted from the pdb database . figure  <dig> presents the distribution of the rotatable bonds of the test set, the pdb ids and rotatable bonds numbers corresponding to each molecule are listed in table a <dig> . most of the molecules posses less than  <dig> rotatable bonds. to access the computational cost of cyndi, the histogram of processing times is presented in figure  <dig>  for the overwhelming majority of the molecules, the conformation generation time distributes from  <dig>  seconds to  <dig>  seconds and the average computation time is about  <dig>  ±  <dig>  seconds per molecule. the computational cost of post minimization was not considered during the evaluation because energy minimization is the major time limit step for most stochastic conformational analysis algorithms and intensively depends on the applied local optimization algorithms, adopted force field, and specified minimization iterations. alternatively the conformer ensembles generated with cyndi can also be energy minimized by external softwares implemented with alternative force fields, therefore the energy optimization is discarded from computational time evaluation. as a matter of fact, the average computational time of cyndi amounts to  <dig>  seconds and never exceeds  <dig> seconds for each molecular conformer ensemble in an independent run, which is still acceptable and superior to that of balloon or catalyst best . the result presented here proves that cyndi is extremely fast and capable of generating conformers in nearly constant time disregarding the molecular flexibility, and therefore, can be utilized to prepare conformational database for large-scale molecular database used in virtual screening.

cyndi is originally designed as an "upstream" conformation generator for ligand-based virtual screening in the pipeline of computer-aided drug design. the numbers of generated conformers have to be limited due to the fact that "downstream" calculations are probably highly computationally expensive. theoretically the sizes of the conformational ensembles may increase significantly for highly flexible molecules. the number of conformers obtained after post processing are plotted against the number of rotatable bonds of each molecules . interestingly, the numbers of generated conformers don't increase linearly with the numbers of rotatable bonds as expected, instead, a skewed distribution with a peak value of  <dig> rotatable bonds was observed . for highly flexible molecules with more than  <dig> rotatable bonds, the rmsd filter scaled on number of rotatable bonds tends to drive the geometric similarity criterion more stringent by increasing rmsd tolerance. therefore the conformational space in the archive is considered to be more "crowded" and more conformers were discarded for the highly flexible molecules. this treatment was a trade-off between elimination of conformational "combinatorial explosion" and enumeration of excessive geometrically diverse conformers. cyndi employs fixed population size, and if one hopes to sample the conformational space for the flexible molecules more thoroughly, multiple runs or increased population size is recommended. cyndi combines the pareto optimal conformers from independent runs and outputs final conformation ensemble after energy as well as geometric filter.

assesing the ability of reproducing bioactive conformations of cyndi
to evaluate cyndi's capability of reproducing the bioactive crystal structures, the distribution of minimum rmsd values between best-fit conformers and crystal structures is shown in figure  <dig> by plotting against the number of rotatable bonds of corresponding molecules. the minimum rmsd values are linearly correlated to the numbers of rotatable bonds of ligands with r <dig> =  <dig> , which is in accordance to the expectation that the predictive inaccuracy increases with the molecular flexibility. the average minimum rmsd value of total  <dig> conformational ensembles to their crystal bound conformers is  <dig>  ±  <dig>  Å for 3-objective case , and in addition, nearly  <dig> % of the minimum rmsd values are below  <dig>  Å . as a comparison, both the results of cyndi with and without the optional objective  are compared with balloon, and three conformation generation methods provided in catalyst. figure  <dig> shows the histogram of the cumulative distribution of the  <dig> molecules whose minimum rmsd to crystal conformers is within specific cutoff thresholds. it's apparent that the results of cyndi are better or equal to those of the  <dig> methods considering that they share similar percentage of conformers within  <dig> Å threshold to the bioactive ones. with regard to the apparent potency of bioactive conformations reproduction  as well as speedup advantage, cyndi outperforms other methods both in accuracy and efficiency. table a <dig>  lists more detailed comparisons of cyndi and other methods for each molecule. the result of initial single 3d conformers generated by chemaxon's standardizer module is also tabulated in table a <dig>  as reference.

comparing with 3-objective case, additional objective of gyration radius slightly bettered the result  and the number of minimum rmsd within 0– <dig>  Å cutoff to the bioactive conformers increased from  <dig> to  <dig>  essentially, considering the definition of gyration radius and essence of vdw energy, there would be certain overlapping between these two objectives on penalizing the steric bumped conformations, which has been observed . this is part of the reason that gyration radius was formulated as an optional objective. including gyration radius may improve the qualities of generated conformations for some flexible molecules, but it is not always the case. actually the pareto solutions in 4-objective space do not necessarily bear larger gyration radius because moea algorithm never optimizes towards the extremum of any single objective. figure  <dig> depicts the alignments of best-fit conformers for two flexible molecules  generated with and without gyration radius objective. for 1if <dig>  the bioactive structure adopts a relatively extended conformer with a gyration radius of  <dig>  Å; comparing with the conformer generated in 3-objective case, the minimum rmsd  of conformer generated by cyndi with 4-objective is reduced from  <dig>  Å to  <dig>  Å with gyration radius increasing from  <dig>  Å to  <dig>  Å ; while for 1sme, the minimum rmsd increases from  <dig>  Å to  <dig>  Å with gyration radius increasing from  <dig>  Å to  <dig>  Å for 3-objective and 4-objective cases respectively . in fact, additional objective separates the solutions across more refined hyper grids on the pareto frontiers so as to sample the conformational space more thoroughly. for linear molecules, including gyration radius may boost the procedure of conformational sampling if the bioactive conformers adopt more extended conformation; however, maximizing gyration radius in cyndi may blur the unbiased sampling procedure for highly branched molecules  which may harbor multiple reasonable spatial extensions. practically, because of the inherit irreproducibility flaw of evolution algorithm, one is advised to repeat several independent runs from diverse multiple random conformations both with and without gyration radius objective to sample the conformational space more thoroughly, as table a <dig>  shows, the results from  <dig> independent runs of cyndi outperformed that of single run to some extent.

assessment geometrical diversity of generated conformer ensembles
the rmsd filter was applied to remove the conformational redundancy. to quantify the geometrical variation, agglomerative hierarchical clustering analysis was performed on the populated distance matrix via calculating the rmsd values between each pair of conformers. the resulted clustering dendrograms as well as corresponding reordered similarity heatmaps for four selected conformer ensembles are shown in figure  <dig>  in principle, if the conformers in the ensemble are totally geometrically different from each other, explicit non-overlapping diagonal blocks should emerge from the similarity matrix. the ligand of 1apt -val-val-lysta-o-et) is typically a peptide mimic with  <dig> peptide bonds and a total of  <dig> rotatable bonds. since the stiffness induced by the peptide bonds , the conformer ensemble is generally clustered into two major groups indicated by two large on-diagonal blocks, the members in each cluster are at least within  <dig>  Å rmsd threshold against each other . each of the large clusters is divided into much smaller independent ones if we lower the dissimilarity threshold to  <dig>  or  <dig>  Å, indicating the generated conformers are geometrically dissimilar to each other at this level. similar results have also been observed in the case of all other three molecules because they all bear one or more peptide bonds. comparing with 1apt, more distinguishable small-size on-diagonal blocks are exemplified by ligand of 1tmn  and that of 1epo  in figures 9b and 9d. the conformers are geometrically distinguishable with each other below the rmsd threshold of  <dig>  Å, illustrating the generated conformers are highly distantly spread in conformational space. as for a less flexible case, the ligand of 8gch  in figure 9c exhibits a more blurred profile of clustering heatmap below the rmsd threshold of  <dig>  Å. allowing for the more compact conformational space formed by relatively small number of rotatable bonds, the rmsd threshold for dissimilarity should be lowered by reducing the scaling factor in gd filter.

theoretically, the generated conformers should maximize diversity by distinguishing geometrically with each other completely. practically, this goal can not be achieved because for a molecule bearing middle level flexibility , the energy-favoured accessible areas are limited with respect to broadly sampled conformational space. herein many conformers have to be discarded which failed to pass the low-energy filter despite their geometrical dissimilarity. the rmsd threshold in the rmsd filter increases with molecular flexibility, and for those molecules with moderate flexibility , the threshold is about  <dig>  Å with the scaling parameter set to  <dig> . from the observation of the clustering heatmaps, most of the conformers are geometrically different from each other at the threshold level of  <dig>  Å considering the corresponding on-diagonal blocks are small-size and non-overlapped . when increasing the threshold, the areas of on-diagonal blocks become larger and the corresponding borders turn out fuzzier. cyndi employs a scalable rmsd threshold instead and achieves a good compromise to generate limited number  of diverse conformers.

it may be argued that the generated conformers can be biased geometrically to mimic the starting conformation because gd objective reflects essentially minimized rmsd between the individuals and initial conformation. actually, different from single objective ga in which the population evolves towards the extremum in the single objective space exclusively, the optimization essential of cyndi is to generate a non-dominant solution set in the hyperspace of multiple objectives because no single or a few objectives can exclusively harness the optima towards the extrema in single or parts of objective space. for the pareto optimal conformers in the final archive, most of them are geometrically distant from the initial conformers because they are favourable in other objective spaces such as vdw and torsion energy. namely the objectives divide the objective hyperspace into grids with the size of corresponding ο values and the pareto solutions scatters across those non-dominant grids consisting of pareto frontier.

currently, cyndi only supports generating conformer ensemble from an initial 3d conformation, and moreover, since cyndi merely perturbs the dihedral torsions in optimization procedure, it is not compulsive but highly recommended starting from the conformer converted by the 2d-to-3d conversion toolkits or the one energy-minimized to local minimum with appropriate force field to ensure the generated conformers bear reasonable bond lengths and bond angles. the work of integrating the 1d-to-3d and 2d-to-3d features to perfect cyndi in handling the problem of conformation generation is under progress.

CONCLUSIONS
a new conformation generation method cyndi was designed based on a fast and robust moea theory. using multiple objectives controlling energy accessibility as well as geometric diversity, cyndi is capable of searching the conformational space in nearly constant time and sampling the pareto frontier on which both energy and diversity features are favoured. three independent objectives  are employed and tested against  <dig> ligands with available crystal determined conformations, the resulted minimum rmsd to bioactive conformers amounts to  <dig>  Å in average. the objectives can be implemented easily so it's very simple to customize cyndi to generate different conformation ensembles which are pareto optimals scattering in the hyperspace formed by different objectives.

