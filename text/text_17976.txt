BACKGROUND
in many biological experiments, we analyze regulation of gene or protein expression over time and in some other cases we examine how the expression pattern changes as the grade/stage of a disease progresses, including over time.

these biomarkers are "monotonic" because their pattern ascends or descends with time , important in time-series studies  <cit> . for example, hnf4α is a well-known factor promoting stem cell hepatogenesis <cit> , and its levels increase with a monotonic pattern during differentiation <cit> . genes in such studies may exhibit a natural temporal ordering in the samples, distinguishing them from others dealing with issues like discriminating tumor from non-tumor cases. a time series model generally shows that samples close in time are more closely related. for example, the expression of a stemness gene or microrna should be more abundant in stem cells and precursors than in fully differentiated and mature progenies. here we identify those genes monotonically ascending or descending over a given period of time.

many approaches are used to find differentially expressed biomarkers from microarray data  <cit> . by statistical tests and other computational methods, the two-class and multi-class array data are usually analyzed focusing on the class-specific signature genes  and unexpressed for the other/rest of the class). in order to identify differentially expressed genes, many approaches adopt student's t-test for two-class data, and few approaches adopt statistical tests such as anova f-test for multi-class data  <cit>  or a nonparametric rank-based statistical test such as kruskal-wallis test  <cit>  also for multi-class data  <cit> . however, distribution-based and rank-based statistical tests may not be appropriate because they find differentially expressed genes, not monotonically ascending or descending genes.

some methods to discover monotonic expression patterns are correlation-based, where a seed feature or template is chosen to find genes with good correlation. but the choice of the template plays a critical role, and this is time-consuming, requiring experienced bioinformaticians. in addition, the cuzick-test  <cit>  can be used to discover a specific trend/pattern from microarray data. also, the modified m statistic test  <cit>  can be used to detect monotonic trend through a combination of the means ordering strategy and a distribution-based statistical test. however, outliers affect the monotonic trend there because of weighting used in the cuzick-test and the means ordering strategy used in the modified m statistic test. furthermore, the cuzick-test does not provide any information about the extent a gene expression pattern is monotonic  for genes with the same z-score/p-value. therefore, an approach without statistical assumptions and not affected by outliers, and able to identify the degree of monotonicity between genes with the same z-score/p-value, is needed. our method proposed herein, mfselector  based on the total discriminating error , is quite effective in discovering genes with monotonic attributes. it identifies gradually increasing or decreasing genes irrespective of any heterogeneity in the array data. furthermore, mfselector, eliminates the subjectivity required in seed/template selection and also provides assessments of confidence . this new approach is user-friendly as we integrate our algorithm into a simple r function. users with no proficiency in programming can generate a monotonic gene list and related scatter plots.

methods
data sets
all microarray data sets were downloaded from the ncbi geo public archive, generated in affymetrix human genome u <dig> plus  <dig>  platform with  <dig> probe sets on chips. the raw data  were normalized by rma algorithm using the 'affy' package of the bioconductor http://www.bioconductor.org <cit>  software suite in the r project for statistical computing http://www.r-project.org. see materials s <dig> in additional file  <dig> for details.

embryonic stem cell neurogenesis data set 
this data set contains  <dig> samples over five periods of human embryonic development: three embryonic stem cell  samples, three embryoid body  samples, six primitive ectoderm cell  samples, six neural tube-like rosette cell samples, and nine post-natal neural stem cell  samples.

embryonic stem cell vasculogenesis data set 
in this data set, there are  <dig> samples over four periods of human embryonic stem cell differentiation into human mature  endothelial cells: three undifferentiated embryonic stem cell  samples, three mesodermal progenitor cell  samples, four embryoid body  samples, and three human mature vascular endothelial cell  samples. the results and discussion of application of mfselector to this data set are exhibited in materials s <dig> .

synthetic data sets
we generated two sets of synthetic data. these data sets contain  <dig> samples each spread over five equal sized stages. there is a set with descending trends  and a set with ascending trends . these synthetic data sets are named 's50_asc' and 's50_des', respectively. in addition, each data set has  <dig> genes which are classified into  <dig> types of monotonic genes : 'good ', 'good ', 'slightly', 'outliers ', 'outliers ', 'moderately', 'severely', 'partially ordered ', and 'partially ordered '. there are  <dig> genes for each of 'slightly', 'moderately', and 'severely' types and  <dig> genes for each of 'good ', 'good ', 'outliers ', 'outliers ', 'partially ordered ', and 'partially ordered '. if most of the samples follow a trend over time/stages but only a few do not, we call those few samples as outliers. in this study the number of outliers for the synthetic data sets is restricted to less than 6% of total samples.

here we use genes with a monotonic ascending trend to illustrate these nine types of genes used in the synthetic data as shown in figure  <dig>  in this study, genes with a monotonic ascending trend are those where the average expression values of samples in stage one are lower than those of samples in stage two, the average expression values of samples in stage two are lower than those of samples in stage three, and so on. in the synthetic data sets, 'good' type genes have the strongest degree of monotonicity followed in order with 'slightly', 'moderately', and 'severely' monotonic type genes. for 'good' type genes, there is no overlapping of samples between stages, and for 'severely' type genes, the samples in one stage have samples that severely overlap the samples in the adjacent/other stages. in addition, 'partially ordered' type genes indicate that the samples in four of the five stages form a monotonic ascending trend, while the samples in the remaining stage overlap the samples in other stages. 'outliers' type genes denote that samples in the five stages form a monotonic ascending trend, but some of the samples in one of the five stages are slightly/significantly away from the expression values of other samples in the same stage.

the 'good' category has two subcategories, 'good ' and 'good '. 'good ' genes indicate they have the strongest monotonic ascending trend and samples have distinct separation between stages; while 'good ' genes indicate they still have the strongest monotonic trend but samples between stages are close. 'partially ordered' type genes are also further separated into 'partially ordered ', and 'partially ordered '. the 'partially ordered ' means that the samples in one of the stages are significantly far from the monotonic trend in a gene expression profile while 'partially ordered ' means that the samples in one of the stages are close to the monotonic trend but it is still out of monotonic order in the gene expression profile. the genes of type 'outliers ' represent genes where at most six percent of the samples are relatively away from the monotonic trend, and type 'outliers ' indicates that at most six percent of the samples are slightly away from the monotonic trend. the results on these synthetic data sets by our proposed method  and other two methods are presented in the results section.

monotonic feature selector 
in this study, we propose a novel tool, monotonic feature selector  which includes a novel index, called detotal , used to identify genes/biomarkers with stronger monotonic features which may bear a correlation to stem cell development. detotal does not make any distributional assumption about the data. mfselector also provides the related statistical information  for each monotonic gene. moreover, in order to distinguish among monotonic genes with the same detotal, mfselector also offers an additional novel index, called svde . users can download mfselector from the web site: http://microarray.ym.edu.tw/tools/mfselector/. figure  <dig> depicts the processing steps involved in the computation of detotal, p- and q- values, and svde.

computation of discriminating error for each level of a gene
here we use several steps to examine genes with monotonically ascending or descending profiles, which are distributed over n stages. for example, when a monotonic gene has an ascending profile, first we assume samples in stage one have the lower expression values and samples in other stages have higher expression values. we use a sample in stage one to draw a horizontal discriminating line to determine how many samples in stage one have higher expression values than the discriminating line and how many samples in other stages have lower expression values than the discriminating line. the number of samples on the wrong side of the discriminating line is referred to as "discriminating errors". distinguishing stage one from all other stages is called the "level one" process. in addition, since every sample in stage one can be used to draw a discriminating line, we select the discriminating line with the smallest number of discriminating errors for this level. note that, when more than one discriminating line for stage one have the same number of discriminating errors, we can choose any one of the lines; here we use the discriminating line corresponding to the lowest sample number. secondly, again for the same gene, as a "level two" process, we assume samples in stages one and two have lower expression patterns than samples in other stages. therefore, we use each sample from stages one and two taken together to draw a discriminating line and determine discriminating error as in level one. when more than one sample from stages one and two together result in the same smallest number of discriminating errors, we consider:  when the samples are from the same stage, then we select the line  corresponding to the lowest sample number;  when the samples are from different stages, we give priority to the lowest sample number from the highest stage, in this case, stage two. this entire process is repeated n- <dig> times, each time adding one stage . the discriminating line is selected in the same manner for each of the n- <dig> levels . it is interesting to note that, if the number of distinct discriminating lines is equal to n- <dig>  the corresponding gene is more likely to be a good monotonic gene.

our outlier strategy is different from that used by rank-based statistical tests , where an outlier's deviation in expression value influences its rank, often adversely affecting the statistical calculation. mfselector does not count samples on the wrong side of the discriminating line more than once. suppose an outlier adds a discriminating error in the level m process. this outlier is very likely to add a discriminating error in later levels, i.e., "level m+1" to "level n-1"). but we count the outlier's discriminating error only once at level m. we compare the results for the cuzick-test and ours in the results section.

for a monotonic gene with a descending profile, samples in stage one should have the higher expression values than the samples in other stages. thus, we can get the "discriminating errors" for "level one" process by drawing a discriminating line through one of the samples in stage one to determine the number of samples in stage one that have lower expression values than the discriminating line and the number of samples in other stages having higher expression values than the discriminating line. as with an ascending profile, this process is repeated n- <dig> times, though in this case, in descending direction. the discriminating line for each level is also selected in the same manner as that for the ascending case.

computation of total discriminating error  for a gene
in order to evaluate monotonicity of a gene , we use the sum of its discriminating errors over all n- <dig> level processes  denoted by "detotal". for instance, when detotal=k, k discriminating errors exist over n- <dig> level processes. here, the smaller detotal of a gene, the fewer the number of discriminating errors and the stronger the monotonicity of the gene. detotal is an evaluation index to determine monotonic genes. we sort the detotal values for all genes in increasing order to select genes with stronger monotonic features for multi-stage and time-series array data. note that, in this study we separately consider the detotal for monotonically ascending or descending cases. in addition, we also develop another strategy using sample variance for discriminating error  to further determine the gene with stronger monotonic feature when several genes have the same detotal value. this is explained later.

calculating detotal for a gene: an illustration
we now demonstrate our algorithm using a synthetic gene profile with five stages as shown in figure  <dig>  suppose in this case, this gene has an ascending nature. we perform the following steps for this gene as mentioned above.

first, for the "level one" process, every sample in stage one is used to draw a discriminating line to determine its associated number of discriminating errors . in this case, we obtain  <dig>   <dig>  and  <dig> discriminating errors taking each of three samples in order from stage one to draw the discriminating lines. for example, one sample from stage one and another sample from stage four are on the wrong side of the discriminating line when considering the 2nd sample in stage one to draw the discriminating line, resulting in two discriminating errors. in addition, since two discriminating lines  from stage one have the same number of discriminating errors, we choose the sample with the lowest sample number  and get two discriminating errors in this level.

second, for the "level two" process, every sample in stages one and two is used to draw a discriminating line to determine its associated number of discriminating errors. in this level, we obtain  <dig>   <dig>   <dig>   <dig>   <dig>  and  <dig> discriminating errors taking each of six samples in order from stages one and two to draw the discriminating lines. note that, to compute the discriminating errors for the "level two" process, we do not consider the samples which have already caused discriminating errors in "level one". such samples are masked pink in figure  <dig>  one sample from stage one and another sample from stage four. the extent of outliers may strongly influence results in other methods, but in our method we consider "outliers" only once to contribute to the discriminating errors and hence it allows us to determine monotonicity without the results being skewed by the position of "outliers". this is why our method has some advantage over other approaches. finally, we choose the sample with the lowest number of discriminating errors  and get no discriminating errors in this level.

third, for the "level three" process, every sample in stages one, two, and three is used to draw a discriminating line to determine its associated number of discriminating errors. we get  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  and  <dig> discriminating errors taking each of  <dig> samples in order from stage one to stage three. the 10th sample is selected as the discriminating line because its discriminating error is the lowest, and it has the lowest sample number of the two level three samples with the same discriminating error of one.

similarly, the process is continued for the "level four". in this case we determine the 16th sample with no discriminating error. finally, we add up all discriminating errors for each selected discriminating line from every level and get the detotal =  <dig> +  <dig> +  <dig> +  <dig> =  <dig> 

statistical analysis of monotonic genes
computation of p-value and q-value
to assess the statistical significance of the detotal index associated with the identified genes in ascending and descending profiles, a permutation test has been performed in figure  <dig>  both unadjusted p-values and adjusted q-values for multiple comparisons are computed as in our previous studies  <cit> . let g be the total number of genes and s be the total number of sample points. the procedure followed is summarized below.

step  <dig>  given a gene expression matrix x  with class labels , we compute the detotal,g for ascending case and denotes it by ag for notational simplicity. similarly, for the descending case also we compute detotal,g and denote it by dg.

step  <dig>  randomly permute the class labels ys b times . in the bth permutation , compute ag and dg for gene g using the gene expression matrix x and the permuted labels ys.

step  <dig>  the p-value of the observed detotal,g with ascending characteristic, ag, for gene g is

  p=∑b=1b∑g′=1g≤ag)g×b 

where i is an indicator function that takes the value one when true and takes the value zero when false. similarly, the p-value of the observed detotal,g with descending nature, dg, is

  p=∑b=1b∑g′=1gi≤dg)g×b 

step  <dig>  to account for the multiple tests being performed for the g genes, q-values of the observed ag and dg are calculated as

  q=∑b=1b∑g′=1gi≤ag)∑g′=1gi×b 

and

  q=∑b=1b∑g′=1gi≤dg)∑g′=1gi×b 

computation of sample variance for discriminating error 
statistical tests are unable to distinguish which genes with the same level of statistical significance are better. two genes with the same detotal may exhibit different monotonicities. therefore, we develop svde to address the degree of monotonicity of a gene. this can also help to differentiate between genes with the same detotal value.

for example, in the escn data set, loc <dig> and fam60a are monotonically descending genes and have the same detotal =  <dig> . however, the expressions of the samples of fam60a from stages one to four are tightly grouped  and of loc <dig> from stages one to four are highly distinguished, and only the expression values of the samples from stages four and five are somewhat close. for these two genes with the same detotal, loc <dig> should have a higher degree of monotonicity ) than fam60a ).

in order to assess the degree of monotonicity , all samples for each of the genes are slightly altered in expression values to examine whether the detotal of the altered expression values has changed significantly or not. to evaluate this, we propose an index, called sample variance for discriminating error . we perturb a dataset and evaluate the extent of confidence on the monotonicity properly by adding noise to all samples , and apply the same method to the perturbed a dataset to calculate the detotal of genes.

to perturb a dataset with m samples and n genes, we first compute the standard deviation σi of each gene xi and divide it by  <dig> to compute σ'i. next, we generate m noise values from a normal distribution with mean equal to  <dig> and standard deviation equal to σ'i for each gene. finally, we add such a random noise to every observed value of gene xi. the noise corrupted gene is used to compute its discriminating errors for each level. let the resulting total discriminating error for this noisy gene be detotal. we repeat this procedure in the same manner m times , and get m new detotal values for each gene. we denote the new detotal value as the dei, i =  <dig>   <dig>  ..., m. next we compute the variance of these dei values with respect to original detotal for this gene. we denote the original detotal as deorg. hence for these new detotal values we can calculate the variance as

  svde=1m∑i=1m <dig> 

the svde is a measure of how far the set of the new detotal values are spread around the original detotal . if each dei is equal to or close to deorg, the svde will be very small. figure  <dig> shows how hard it is to change the detotal of a highly confident monotonic gene even after randomly altering the expression values of all samples. the smaller the svde, the stronger the monotonicity of the gene. figure  <dig> depicts the monotonic profile of another gene where detotal is equal to zero, but the svde is high. the reason is that separation between adjacent stages for stages one to four is not sufficiently distinct. consequently, genes with a smaller svde can be considered more strongly monotonic than genes with a larger svde.

one may think that the time interval between observations should be given importance in defining any index for finding such stemness markers. this is not so because here our objective is to discover monotonic stemness marker genes which are associated with stages of stem cell differentiation. these stages are clinical stages which depend on pathology/clinical phenotypes and are not defined taking observations with arbitrary/equal time interval, but the biological process here dictates the time interval between observations. however, our method would be equally applicable to other experimental scenario where the researchers design experiments to take observations with equal time interval for some scientific reasons. it does not matter if the required time interval is large or small.

cuzick-test
in order to further validate the ability of our method to identify monotonic genes, we have made a comparison with the cuzick-test  <cit> , an extension of a wilcoxon-type statistical test for discovering specific patterns with pre-designed trends, such as oscillation, step-wise patterns, and in this case monotonicity. here we use the cuzick-test to compute the cuzick value  for the gene expression data for each gene as follows. let n be the total number of samples from all classes, ri be the rank of the ith sample determined by the order of its expression value among all samples, n be the number of stages, and pi be the proportion of samples from class i. each stage has a weight wk, k =  <dig> ...,n. we associate a weight zi to a sample i, zi = wj, if the ith sample is from the jth stage. the cuzick statistic is computed as

  z=t-evar 

where

  t=∑i=1nziri 

  var=n212⋅∑i=1nzi2pi-∑j=1nzjpj <dig> 

  e=∑j=1nj⋅∑j=1nzjpj 

to find ascending genes, we use wi = i, i =  <dig>  ..., n; while for descending genes, we use wi = n-i+ <dig>  i =  <dig>  ..., n. the cuzick statistic above is obtained as a z-score, hence, we can determine a p-value for each gene and identify whether a gene is monotonic and the extent of its monotonicity  by referring to the z-score table. in this study, we compare the performance of the cuzick-test approach and our mfselector approach .

the modified m statistic test
we have also performed a comparison with the modified m statistic test  <cit> . the modified m statistic test  is used to analyze dose-response studies in microarray experiments and investigate a trend in the response level expression with respect to doses in multi-class array data. in order to effectively find monotonic genes, the modified m statistic test adopts the means ordering strategy that considers the order restriction of mean expressions  regarding the increasing or decreasing doses through k stages, respectively. the modified m statistic test and several other statistical tests are further integrated into an r package called isogene  <cit> . however, the modified m statistic test is less effective because the existence of outliers in a stage strongly influences the order of mean responses .

functional annotation
after getting the list of monotonic genes, we can sort them by detotal or p-value in ascending order to identify those genes with stronger monotonic patterns, and decide the threshold for the gene list based on monotonicity. in addition, we further sort these monotonic genes with the same detotal values according to their associated svde. the resulting gene list is fed into the web service tool david bioinformatics resources http://david.abcc.ncifcrf.gov/ to identify correspondingly enriched biological processes by cross-referencing to the gene ontology database http://www.geneontology.org/.

RESULTS
results on the escn data set by mfselector
as mentioned in the materials and methods section, we use two microarray data sets, i.e., embryonic stem cell neurogenesis  and embryonic stem cell vasculogenesis , to demonstrate the effectiveness of our algorithm in identifying monotonic genes during different stages of stem cell differentiation. the results of application of mfselector to the escv data set are exhibited in materials s <dig> .

figure s <dig>  reveals that principal component analysis  based on  <dig>  probe sets  clearly distinguishes embryonic stem cells  from post-natal neural stem cells . it also shows that embryoid bodies , primitive ectoderm cells  and neural rosette cells are differentiated along the neural lineage as evidenced by moving toward post-natal neural stem cells. figure s <dig>  also shows that the addition of basic fibroblast growth factor   <cit>  does not make dramatic transcriptome changes on either day  <dig> primitive ectoderm cells  or day  <dig> neural rosette cells . so samples in d <dig> and d10+ are considered to belong to the same stage in this experiment. similarly, samples in d <dig> and d17+ are considered to be in the same stage also.

by applying our algorithm for the escn data set, we create gene lists for the ascending and descending nature respectively and sort these genes by the detotal. using detotal <=  <dig> with the constraint p-value< <dig> e- <dig> and with n- <dig> distinct discriminating lines , we get  <dig> ascending and  <dig>  descending monotonic genes. the lists of these genes and correlated gene information are shown in table s <dig> . since there are too many monotonic genes whose p-value is less than  <dig> e- <dig>  we illustrate approximately one hundred top ranked ascending and descending genes from table s <dig>  by using two heatmap visualizations in figure  <dig>  figure  <dig> displays a heatmap of  <dig> ascending monotonic genes with detotal <=  <dig>  similarly, the gene expressions of the top  <dig> descending monotonic genes  are delineated in a heatmap in figure  <dig>  in figure  <dig>  the x-axis represents samples in the five stages in stage order , the y-axis represents the set of genes in descending detotal order. the gene expression values change gradually from the blue band  into the red band  in figure  <dig>  and vice versa in figure  <dig>  making the monotonicity easily discernible and obvious.

biomarkers for a specific cell type exhibit high expression values when the stem cell is differentiated to this cell at the later stage of differentiation. this is a kind of stemness markers. figure  <dig> depicts pnma <dig>  one of the top three ascending monotonic genes with detotal =  <dig> for the escn data set. for pnma <dig>  the samples from each stage are well distinguished from the samples from other stages sequentially because there is no discriminating error for every level of the process. a preliminary study indicates that pnma <dig>  is homologous to a recently cloned gene, ma <dig>  which is a novel neuron- and testis-specific protein, and is recognized by the serum of patients with paraneoplastic neurological disorders  <cit> . another two of the top three ascending monotonic genes  also have correlation with neuronal receptor and neurogenesis  <cit> . hence, the top three ascending monotonic genes identified by mfselector from the escn data set are in fact reported to be related to neurogenesis. in addition, mfselector has also identified sox <dig> , a famous marker for neural lineage cells  <cit> .

similarly, there are another kind of stemness markers which exhibit high expression at early stages of development and are monotonically descending during embryonic stem cell differentiation into the other cells/tissues . figure  <dig> displays dnmt3b, one of the top  <dig> descending genes with detotal =  <dig>  here, samples from all stages are also well separated by discriminating lines for each level. dnmt3b is associated with embryonic stem cell development  <cit> . some of other top  <dig> descending genes are correlated with developmental pluripotency and are usually expressed in undifferentiated pluripotent stem cells   <cit> . thus, some of these top descending monotonic genes may play important roles in maintaining pluripotentiality. we shall further discuss some well-known embryonic stem cell related genes in discussion section. note that, we also identify some other previously unreported  genes of unknown function  with monotonic features.

in addition, we have checked one by one whether the top monotonic genes with detotal <=  <dig>  in the escn dataset are reported in the literature to be related to some stem cell characteristics, including stemness, differentiation, reprogramming, or induced pluripotent stem cell . here we find that  <dig>  monotonically descending genes related to some stem cell characteristics: stemness , reprogramming , and ips . thirty-four  genes are related to differentiation and some of them are related to embryogenesis. we could regard some of identified descending genes as stemness or embryo biomarkers. on the other hand,  <dig>  monotonically ascending genes are found to be related to differentiation and most of them are related to neurogenesis . we could also regard some of identified ascending genes as biomarkers of specific cell types in the differentiated cells. please see table s <dig> .

furthermore, we have also checked one by one whether the top monotonic genes with detotal <=  <dig> in the escn dataset have a bi-stable profile with a significant drop or rise in expression level between two successive stages. we subjectively find that about  <dig>  ascending genes and  <dig>  descending genes are likely to have bi-stable switches. in the table s <dig> , we have discussed some of those genes that are reported in the literature to be related to some stem cell characteristics.

to differentiate genes with the same detotal, we provide the svde value for each monotonic gene in table s <dig> . figure  <dig> shows the gene expression patterns of four ascending monotonic genes with the same detotal/p-value . these four genes are distinguished by the svde values obtained by adding noise to the expression value and repeating the process  <dig> times. figure  <dig> reveals that sox <dig>  with svde =  <dig> , is the most monotonic gene compared to the other three genes in figure  <dig>  because its samples from different stages are well separated, except for a single discriminating error for stage four. thus the detotal is not easily changed  after adding noise to each sample. figure  <dig> shows that stmn <dig> with svde =  <dig>  is the second most monotonic gene, because the expression values of two samples, one from stage three and another from stage four, are very close. therefore, the number of misclassified samples  for stmn <dig> is changed more frequently than sox <dig> during the  <dig> experiments after adding noise to each sample. visual inspection of the figures also suggests that stmn <dig> is the next monotonic gene in the list of four. figure  <dig> indicates that arid5b with svde =  <dig>  is the third most monotonic gene. this is indeed the case because every two adjacent stages contain samples which have close expression values. finally, figure  <dig> displays scd <dig> with svde =  <dig>  the least monotonic of the four genes. a careful inspection of the figures also reveals the same and this is so because samples from stage three and stage four have expression values which are too close to avoid misclassification during the svde process.

comparison among three methods based on the escn data
since the cuzick-test can find many monotonic genes with the same rank, for preliminary comparison we have decided to use ascending genes with rank up to  <dig> as determined by the cuzick-test as an example. for cuzick-test, the number of genes selected with ranks 1~ <dig> is  <dig>  then we use the top  <dig> monotonic ascending genes identified by each of the other methods, to find the number of common and unique identified genes. from table s <dig> , we find that a large number of common genes  are discovered by the cuzick-test and mfselector. on the other hand, a large number of unique genes are discovered by the modified m statistic test  common genes found with mfselector and  <dig>  common genes found with cuzick-test). the detail results are shown in table s <dig> and s <dig>  for ascending and descending cases, respectively. these findings suggest that the performances of the cuzick-test and mfselector are more similar than the performances of the modified m statistic test and mfselector. however, there are some drawbacks in the cuzick-test, which will be revealed when we further evaluate the three methods on the escn data set and the synthetic data sets.

comparison between results by the cuzick-test and mfselector
for comparison with mfselector, we have also applied the cuzick-test to the escn data set and the escv data set, and determined the trends of the gene expression profiles. for illustration we have used only the escn data set. the results demonstrate several superior characteristics of mfselector.

first, although the cuzick-test can identify monotonic genes, the cuzick-test results contain some non-monotonic genes  at or near the top of the gene lists. figure s <dig>  shows four genes identified by the cuzick-test as strong monotonic genes in terms of z-score/p-value because only samples from one stage  are out of the monotonic trend. figure s <dig> and   display two genes with only roughly ascending features as a result of the deviation from the trend in the expressions of samples from stage two. figure s <dig> and   display two other genes with only roughly descending features as a result of the deviation from the trend in the expressions of samples also from stage two. note that, mfselector discards most of this kind of genes with a partial monotonic trend  by examining whether we can determine their n- <dig> distinct discriminating lines.

second, mfselector uses svde to further determine different levels of monotonicity of genes with the same detotal values . actually, many monotonic genes ranked by the cuzick-test have the same p-value. for example, all of those genes with detotal =  <dig> always belong to the cuzick-test top level. figures s <dig> and   show two genes with detotal =  <dig> that should have different levels of monotonicity based on their respective svde values. similarly, figs. s <dig> and   also indicate different monotonicity under mfselector svde analysis for two other genes which have the same detotal values  and both are ranked 10th in the list generated by the cuzick-test.

in addition, the cusick-test may assign a low rank to a highly monotonic gene that contains some outlier samples which in fact do not adversely affect monotonicity. figure s <dig>  shows that the gene expression value for znf <dig> is 164th in the list generated by mfselector, but is 105th  in the list generated by the cuzick-test because two samples from stage one and four, respectively, are significantly distant from its stage . this situation arises because this gene's ranking is significantly affected by the weight assigned to the anomalous expression value for these samples from stage one and four, causing the poor ranking for this gene under the cuzick-test. figure s <dig>  also shows the same characteristic influenced by outlier samples. on the other hand, the cusick-test may also give a high rank to a gene which is insufficiently monotonic as a result of too much overlapping, where the lack of monotonicity is quite clear. for example, those monotonic genes in figs. s <dig> and s <dig>  have too much overlapping among stages.

comparison between results by the modified m statistic test and mfselector
by applying the modified m statistic test, we create two gene lists, one for the ascending nature and the other for the descending nature respectively, and sort these genes by their corresponding m values. we illustrate only the top hundred ranked ascending and descending genes by using two heatmaps in figs. s <dig> and s <dig> . figure s <dig>  displays the heatmap of one hundred ascending monotonic genes produced by mfselector and fig. s <dig>  displays the same produced by the modified m statistic test. similarly, the gene expressions of the top hundred descending monotonic genes chosen by mfselector and the modified m statistic test are delineated in heatmaps in figs. s <dig> and  , respectively. note that, genes chosen from the top hundred are further clustered using hierarchical clustering with the average linkage strategy. it is evident from the yellow rectangular area on the heatmaps created from the gene lists  and s9), the genes found by the modified m selector method are not monotonic. this is a consequence of the existence of outliers in a stage  satisfying the means ordering constraint. on the other hand, the genes found by mfselector actually have monotonic trend  and s9).

results on the synthetic data
nine pseudo genes are chosen randomly from the  <dig> types of monotonic genes as shown in figure  <dig>  we also use synthetic data sets to perform extensive comparisons, including quantitative and qualitative evaluations, between mfselector, the cuzick-test, and the modified m statistic test.

comparison among three methods based on the synthetic data
in the ideal ranking, the top  <dig> pseudo genes should belong to the type 'good ' , 'slightly' , and 'outliers ' , and that is what mfselector does. the results using the cuzick-test are the approximately the same as that by mfselector, but the modified m statistic test always selects about fifteen percent of genes in the type 'partially ordered' which are worse cases and are out of monotonic trend . nevertheless, the cuzick-test and the modified m statistic test are seriously affected by the variation in the nature of outliers such as "slight" versus "severe" and the nature of partially ordered trends such as "far" versus "close". we think that both 'outliers' type genes, slight or severe, should have similar monotonic trends. these outlier samples should not influence the extent of monotonic trends. similarly, in the 'partially ordered' type genes, no matter how significantly far the samples in one of the stages are from the monotonic trend in a gene expression profile, most of those genes should not influence the degree of monotonicity. in addition, as mentioned earlier, mfselector discards most of this kind of genes with a partial monotonic trend  by examining the number of distinct discriminating lines. therefore, genes having slight/severe outliers or having partially ordered patterns with the level 'far' or 'close' should be given the similar significance/rank. for the synthetic data set, we find that the ranks of the pseudo genes g <dig>  and g <dig>  discovered by mfselector are not different  but their ranks are significantly different for the cuzick-test and the modified m statistic test. the ranks of the pseudo genes g <dig>  and g <dig>  identified by mfselector are also not different  but the ranks suggested by the cuzick-test and the modified m statistic test are significantly different , , , and  <dig> and additional file 15: table s5).

discussion
biological relevance of other monotonic genes
expressions of monotonic genes in different stages of cell lineage are closely related to the function of specific cell stage. monotonicity of genes over stages is a good rationale to identify biomarkers responsible for differentiation of stem or precursor cells. for example, biomarkers for stemness exhibit high expression at early stages and those are responsible for maintaining proliferation and self-renewal activities. by contrast, biomarkers of specific cell types exhibit high expression in later stages after differentiation. and those genes also contribute to the specific phenotype and function of differentiated cells such as development of neural system which is mentioned earlier.

among the top ascending and descending monotonic genes for the escn data set , we have found many well-known and annotated marker genes proven and reported in previous studies. for example, pou5f <dig> , nanog, and blbp  ,  and  <dig>  respectively) have been identified as important marker genes  in a microarray time series analysis  and further validated using rt-pcr  <cit> . pou5f <dig>  is a well-known transcription factor for maintaining and introducing stemness into embryonic stem cells  <cit> . pou5f <dig> is also important for pluripotency of embryonic stem cells  <cit> . nanog , is a well-known transcription factor critically involved with self-renewal of undifferentiated embryonic stem cells, and blbp  is a neuroepithelial progenitor marker  <cit> . furthermore, as reported earlier, blbp is always expressed during development in radial glia by the activation of notch receptors  <cit> . the expression of blbp is usually induced in neural progenitor cells via notch- <dig> activation  <cit> . note that, in the previous study authors have also reported another important gene, hes <dig> with some ascending monotonic characteristics. this is a neuroepithelial progenitor marker  <cit>  that mainly regulates brain development process  <cit> . it is interesting to observe that, while in the previous study, hes <dig> has been characterized as a monotonic ascending gene by their microarray data analysis, but in our study, figure  <dig> clearly shows that hes <dig> expression for stages 1- <dig> is up-regulated and it is down-regulated for stage  <dig>  our finding is consistent with that of the previous study  <cit> , which suggests that this gene is usually expressed in the rosette stage  and stage  <dig> is beyond day  <dig>  consequently, in their rt-pcr experiment , the same up- and down-regulated variance in expression patterns as shown in figure  <dig> can be observed. while in our study, mfselector does not define such genes with partial monotonic characteristics as good monotonic genes. for hes <dig> it has a very high detotal =  <dig>  in future studies we may consider redefining de values to include partial monotonicity.

another research  <cit>  has also reported a gene list comprised of known esc-specific genes and some new candidates  that can serve as markers for human embryonic stem cells and may also contribute to the stemness phenotype. of particular interest in that study is the strong monotonic descending pattern of dnmt3b  in our study during embryonic stem cell differentiation. lin28a is without n- <dig> distinct discriminating lines because its expression is tightly grouping from stage one to stage three. it has a small number of discriminating errors  though. additional transcription factors that were also highly expressed in human embryonic stem cells include btf <dig> and erh. these genes are marker genes for embryonic stem cell, which show high expressions only in human embryonic stem cells  <cit> . we depict the expression profile of these four genes in the escn data set in fig. s <dig> . these scatter plots ,  and ) fit within the scenario for embryonic stem cell development explained by that study  <cit> . however, the expression profile of erh over different stage is not clearly separated and is not monotonically descending during the neurogenesis process ). we make a hypothesis that erh does not clearly exhibit monotonic expression during neurogenesis even though it is an embryonic stem cell specific marker gene. this new biomarker needs to be surveyed and studied further both in wet- and dry- laboratory experiments.

biological processes involved in monotonic genes
the genes expressed in an early stage of stem cells or in undifferentiated cells  of stem cells are often regarded as stem cell biomarkers, which are thought to maintain the pluripotency of embryonic stem cells. based on the concept of pluripotency, cell growth or proliferation and the self-renewal activity are the most representative characteristics of stem cells which are known to be sustained by multiple genes in both stem cells and precursor cells  <cit> . differentiation of stem cells or precursor cells is accompanied by the loss of pluripotency, which suggests that the expression of stemness related genes will decrease as well. this provides a rationale for why those genes should be included in the descending gene list generated by mfselector.

logically, the differentiation program of stem cells and precursor cells is not only driven by gene regulation but also manipulated by the circumstances of differentiation  <cit> . combination of multiple stimulations in distinct circumstances provides the specific niche for differentiating into certain cell lineage, which is triggered by growth factors, transcription factors, and the specific cell surface receptors. different growth factors or transcription factors are accompanied by different signals for the activation of specific functional genes, which are responsible for the generation of specific cell lineage. therefore, we believe that those functional proteins related to the specialized cell type, structures, and functions will be involved in the ascending gene list generated by mfselector.

to validate our inferences, we corroborate the biological processes for those monotonic genes identified from the two data sets by gene ontology analysis on the david web tool http://david.abcc.ncifcrf.gov/. this helps us find distinct genes expressed in certain organogenesis with different processes.

for the escn data set, the top  <dig> ascending monotonic genes  found by mfselector are subjected to gene ontology analysis. some of the biological processes those genes are involved in are neuron differentiation , regulation of neurogenesis , regulation of nervous system development , regulation of neuron differentiation , neuron development , neuron projection development , cell morphogenesis involved in neuron differentiation , axonogenesis , neuron projection morphogenesis , and regulation of axonogenesis . these biological processes very likely play important roles in differentiation of esc neurogenesis and the development of the organs or the tissues of the nervous system. there are other ascending genes involved in neurotransmission, such as regulation of axon extension , axon guidance , transmission of nerve impulse , and neuron migration . these monotonic genes directly indicate their importance during the development of the nervous system and the process of neurogenesis.

similarly, some of the top  <dig>  descending monotonic genes  found by mfselector are involved in basic dna/rna biological processes, such as translation , rna processing , ribosome biogenesis , ribonucleoprotein complex biogenesis , rrna processing , and ncrna metabolic process . according to the common understanding about the characteristics of undifferentiated or early stage stem cells, basic cellular processes are crucial for maintaining the capacity of self-renewal and proliferation. in addition, these monotonic genes may be responsible for the basic metabolisms and the stability of chromosome structures in cells. proliferation of cells must undergo the process of cell cycle, and genes involved in the mechanism of cell cycle are able to imply the progress of proliferation. in conformity with this, we notice that genes for m phase , dna replication , m phase of mitotic cell cycle , mitotic cell cycle , nuclear division , mitosis , cell cycle process , and cell cycle phase  are in the descending monotonic list. this evidence suggests that the stem cell features in the early stage exist during neurogenesis.

CONCLUSIONS
we have developed a novel and robust scheme to identify genes with monotonic patterns in multi-stage as well as in time-series genomic data. our method is based on a concept of total discriminating error practically without requiring any assumption. using our proposed scheme we have been able to reveal genes with gradually increasing or decreasing expression patterns during stem cell differentiation. some of these genes are known stemness genes ), while many other genes have not been linked to stem cell neurogenesis or vasculogenesis before. in the escn and escv data sets monotonic features could be found even from heterogeneous gene expression profiles. in addition, we have used monotonic markers discovered from one data set to analyze another data set and obtained very interesting results. an r package implementing our algorithm and data sets can be found at: http://microarray.ym.edu.tw/tools/mfselector/.

competing interests
the authors declare that they have no competing interests.

authors' contributions
hww conceived that such a study is valuable for time-series array data analysis. hjs, gct, ctl, ifc and nrp designed the analysis approaches. hww, tyc and sjc collected microarray data sets. hjs carried out the implementation of data analysis. hww, tyc, hhl and wcc provided biological guidance during the analysis process. hww, nrp, ifc and hjs wrote the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
materials s <dig>  supporting online materials for the main article.

click here for file

 additional file 2
figure s <dig>  illustration of adding noise to original expression values of 223038_s_at  of the escn data set. the detotal is four after running a simulation with added noise.

click here for file

 additional file 3
figure s <dig>  a three-dimensional scatter plot of the escv data set analyzed by principal component analysis.

click here for file

 additional file 4
table s <dig>  the lists of monotonic genes and correlated gene information of the escn and escv data sets.

click here for file

 additional file 5
table s <dig>  details for the top monotonic genes  identified by mfselector along with information from the literature in support of the facts that those genes are related to some stem cell characteristics, including stemness, differentiation, reprogramming or induced pluripotent stem cells.

click here for file

 additional file 6
table s <dig>  the lists of the number of common or unique genes from the monotonic ascending gene set  of the escn data set identified by mfselector, the cuzick-test, and the modified m statistic test.

click here for file

 additional file 7
table s <dig>  the lists of the number of common or unique genes from the monotonic descending gene set  of the escn data set identified by mfselector, the cuzick-test, and the modified m statistic test.

click here for file

 additional file 8
figure s <dig>  scatter plots of the four false positive monotonic genes identified by the cuzick-test from the escn data set.  200794_x_at ;  229824_at ;  206424_at ;  209122_at .

click here for file

 additional file 9
figure s <dig>  scatter plots of the four monotonic genes with the same detotal values but different svde values identified from the escn data set.  1559280_a_at ;  223000_s_at ;  230896_at ;  202234_s_at .

click here for file

 additional file 10
figure s <dig>  scatter plots of the two monotonic genes for the escn data set ranked low by the cuzick-test but high by mfselector.  202668_at ;  228393_s_at .

click here for file

 additional file 11
figure s <dig>  scatter plots of the four ascending monotonic genes from the escn data set ranked high by the cuzick-test but low by mfselector.  225717_at ;  226907_at ;  229126_at ;  244040_at .

click here for file

 additional file 12
figure s <dig>  scatter plots of the four descending monotonic genes from the escn data set ranked high by the cuzick-test but low by mfselector.  204765_at ;  201930_at ;  219786_at ;  225359_at .

click here for file

 additional file 13
figure s <dig>  heatmaps of the monotonic ascending gene set  of the escn data set identified by mfselector and the modified m statistic test, respectively.  the top hundred monotonic ascending gene set chosen by mfselector;  the top hundred ascending gene set chosen by the modified m statistic test.

click here for file

 additional file 14
figure s <dig>  heatmaps of the monotonic descending gene set  of the escn data set identified by mfselector and the modified m statistic test, respectively.  the top hundred monotonic descending gene set chosen by mfselector;  the top hundred descending gene set chosen by the modified m statistic test.

click here for file

 additional file 15
table s <dig>  the lists of the ranks of monotonic genes for the synthetic data sets identified by mfselector, the cuzick-test, and the modified m statistic test.

click here for file

 additional file 16
table s <dig>  the list of the number of top genes identified by mfselector, the cuzick-test, and the modified m statistic test, in each type of monotonic genes of the synthetic data sets.

click here for file

 additional file 17
figure s <dig>  scatter plots of the four genes of the escn data set reported in the previous study <cit>   220668_s_at ;  219823_at ;  214800_x_at ;  200043_at .

click here for file

 acknowledgements
we acknowledge the efforts of zhang et al. at nih neuroscience microarray consortium and mrugala et al. at inserm, france for their valuable microarray data sets.

declarations
this work is supported by ministry of science and technology   and national yang-ming university . the funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.

this article has been published as part of bmc genomics volume  <dig> supplement  <dig>  2015: selected articles from the thirteenth asia pacific bioinformatics conference : genomics. the full contents of the supplement are available online at http://www.biomedcentral.com/bmcgenomics/supplements/16/s2
