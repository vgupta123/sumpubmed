BACKGROUND
metabolism  is the biochemical modification of chemical compounds in living organisms and cells. it comprises a series of chemical reactions that occur in a cell and enable it to keep living, growing and dividing. without metabolism we would not be able to survive. metabolism comprises a series of chemical reactions that occur in a cell and enable it to keep living, growing and dividing. metabolism usually consists of sequences of enzymatic steps, the so-called metabolic pathways. the number of metabolic pathways is very large, reflecting the fact that "life is extremely complicated". metabolic pathways interact in a complex way in order to allow an adequate regulation. this interaction includes the enzymatic control and hormone control. in the current study, we are focused on the enzyme control category, where metabolic pathway is the network linking various chemical reactions of compounds  catalyzed by enzymes. as is known, many metabolic pathways are available in the pathway databases, such as kegg pathway  <cit> , which enable us to analyze known metabolic pathways. however, since there are many compounds and enzymes whose biological functions are not discovered completely, many reactions cannot be determined. thus, determination of the network of substrate-enzyme-product triads  would be very helpful for expanding our knowledge about the metabolic pathways, and conducting in-depth studies in this regard. however, it is time-consuming and expensive to determine the network through biological experiments alone. therefore, it is highly desired if an automated method can be developed to address this problem. encouraged by the successes of using computational approaches to tackle various problems in different biological systems , here we are to develop a different computational approach for predicting the network of substrate-enzyme-product triads.

the benchmark dataset used in this study consists of positive triads and negative triads, where the number of negative triads was about  <dig> times as many as positive ones. to evaluate the prediction model, one-tenth triads were randomly selected as testing samples and the rest triads used to train the prediction engine. the nearest neighbour algorithm  <cit>  was used to conduct prediction, where the metric to measure the nearness was formulated by combining the compound similarity and functional domain composition. the compound similarity was calculated based on the smiles  <cit>  and graph representations  <cit> ; while the functional domain composition representations  <cit>  were used to represent the enzyme samples and estimate their similarity. the highest accuracy thus obtained in predicting the positive triads was  <dig> %. interestingly, it was observed through this research that similar triads always tended to have the same network.

methods
materials
molecular samples were downloaded from the public database kegg  <cit>  at http://www.genome.jp/kegg/ , from which  <dig>  molecules were retrieved. among these molecules, only  <dig> compounds take part in the main reactant-pairs in each metabolic reaction of yeast. for these selected small molecules, after removing those that had no information to calculate their similarity with other small molecules, we had  <dig>  small molecules left; for enzyme molecules, after removing those whose functional domain compositions were not available,  <dig> enzyme molecules of yeast genome were obtained.

although a same substrate might be converted into many products with different catalyst enzymes, a triad and its network would be unique. each of the triads in the positive dataset consists of two small molecules  and one enzyme molecule. all the triads in the positive dataset were determined by solid experiments, and they were extracted from two kegg files "reaction" and "enzyme", downloaded from ftp://ftp.genome.jp/pub/kegg/pathway/map/ . each of the samples in the negative dataset, the so-called "negative triad", was generated by randomly picking two small molecules  and one enzyme molecule. since the possibility for such three molecules to be a positive triad was extremely low, the credibility of the negative dataset thus constructed would be also very high. also, to reflect the real world that the number of positive triads is much less than that of the negative ones, the negative triads were generated  <dig> times as many as the positive ones. the final benchmark dataset thus constructed contains  <dig>  positive triads and  <dig>  negative triads. positive triads are also termed as networking triads, and negative triads termed as non-networking triads.

in order to evaluate the prediction model, one-tenth positive triads and one-tenth negative triads were randomly selected as testing samples, while the rest triads in the benchmark dataset were used to train the prediction engine. the detail information for the  =  <dig>  testing samples and  =  <dig>  training samples can be found in additional file  <dig> 

encoding methods
a key step for conducting accurate prediction and analysis is to effectively encode and compare the three components: substrates, enzymes, and products. since substrates and products are compounds, some established methods, such as smiles  <cit>  and maccs keys  <cit>  can be used to estimate the similarity of compounds. recently, a method based on graph theory was proposed to measure the similarity of two compounds by means of the undirected graph  <cit> . using graphic approaches to study biological systems can provide an intuitive vision and useful insights for helping analyze complicated relations therein, as indicated by many previous studies on a series of important biological topics, such as enzyme-catalyzed reactions  <cit> , protein folding kinetics and folding rates  <cit> , inhibition of hiv- <dig> reverse transcriptase  <cit> , inhibition kinetics of processive nucleic acid polymerases and nucleases  <cit> , and drug metabolism systems  <cit> . in this study, a different graph approach  <cit>  will be utilized as described below.

graph representation
using graph representation to estimate the similarity of two compounds was proposed by hattori et al.  <cit> . according to their method, each chemical structure can be represented by a two-dimensional  graph where the vertices correspond to the atoms and the edges correspond to the bonds between them. the similarity of the two compounds is estimated by detecting their common subgraphs, followed by aligning them accordingly. the similarity score between two compounds by the graph representation can be calculated by the online web-server at http://www.genome.jp/ligand-bin/search_compound. however, the web-server only provides similarity scores that are greater than  <dig> . accordingly, in the current study, the similarity of two compounds is assigned to be zero if it is less than  <dig> . the similarity score thus obtained between two compounds c <dig> and c <dig> is denoted by sgraph.

meanwhile, the following non-graphic smiles  <cit>  approach will also be utilized to facilitate comparison.

smiles
abbreviated from the full name of "simplified molecular input line entry system"  <cit> , smiles is a line representation for compound, which consists of a series of characters without including spaces. the similarity score between two compounds with the smiles representation can be obtained from a pre-computed database called stitch  <cit>  at http://stitch.embl.de/cgi/, where the similarity score between two compounds c <dig> and c <dig> is denoted by ssmiles/ <dig>  the developers of stitch applied the open-source chemistry development kit  <cit>  to calculate the chemical fingerprints and used the tanimoto  <dig> d chemical similarity scores  <cit> .

functional domain composition representation
since enzyme belongs to protein, we can use various descriptors for proteins as summarized in a recent review  <cit>  to represent enzymes. in this study, we adopted the functional domain composition to represent the enzyme samples because it has been successfully used for predicting various protein attributes  <cit> . the concept of protein functional domain composition was first introduced by chou and cai for predicting protein subcellular localization  <cit> , where the sbase-a database  <cit>  was used that contained  <dig>  functional domains. in this research, we used a more complete database, the interpro database   <cit>  that contained  <dig>  functional domain entries. accordingly, by following the similar procedures as elaborated in  <cit> , an enzyme molecule e can be formulated as the following 21144-d vector   

where xi =  <dig> if there is a hit at the i-th functional domain entry by searching the interpro database for the enzyme sample e; otherwise, xi =  <dig>  thus, the similarity between two enzyme molecules, e <dig> and e <dig> is given by  <cit>    

where  is the dot product of two vectors, and  and  are their modulus, respectively.

thus, the similarities between any two substrate-enzyme-product triads can be calculated using the above equations, as will be further discussed below.

k-nearest neighbour algorithm 
in this research, the k-nearest neighbour  algorithm  <cit>  was applied to predict a query triad belonging to networking or non-networking. to utilizing the knn algorithm, we have to first define a metric to measure the nearness between two triads t <dig> =  and t <dig> = , where s <dig>  e <dig>  p <dig> represent the substrate, enzyme, product in the first triad t <dig>  and s <dig>  e <dig>  p <dig> those in the second triad t <dig>  since there are three members in each triad, and we do not know which one of the three will play more important role in determining the network, let us first define the following metric with a weight parameter to measure the nearness between the two triads:   

where the weight factor w can be obtained by optimizing the predicted result. according to the knn rule  <cit> , also named the "voting knn rule", a query triad should be assigned to the class represented by a majority of its k nearest neighbours. if the majority of its k nearest neighbour triads belong to the triad networking, and so does the query triad; otherwise, it belongs to the non-networking triad.

accuracy measurement
the accuracy of prediction is defined by   

where tp represents true positives, tn true negative, fp false positives, and fn false negative  <cit> , with   

for the sensitivity and   

for the specificity.

in order to evaluate the performance of prediction models more accurate, matthew's correlation coefficient   <cit>  was employed in this study, which is defined by   

RESULTS
the predicted accuracies with k =  <dig> and w = 1/ <dig>  1/ <dig>  and 3/ <dig> for the testing triads in which the substrate and product compounds were represented by smiles are given in table  <dig>  while those with graph to represent the compounds are given in table  <dig>  the detailed predicted results are provided in additional file  <dig> 

it can be seen from table  <dig> and  <dig> that, when w = 1/ <dig> and using the graph representation for the substrate and product compounds, we obtained not only the highest overall prediction accuracy  but also the highest mcc value , indicating that the graph representation approach is really quite effective.

shown in table  <dig> are the prediction accuracies when k =  <dig>   <dig>  and w = 1/ <dig>  compared with the case of k =  <dig>  although the rate for the non-networking triads was remarkably increased somewhat, the rate for the networking triads was decreased.

discussion
our results have shown that, in the study of the substrate-enzyme-product triad network, it is quite promising and encouraged to use the functional domain composition to represent enzyme and use the graph descriptor to represent substrate and product compounds, fully consistent with the advantage of using functional domain to represent enzyme samples for predicting enzyme family classification  <cit>  and the advantage of using the graph descriptor to represent compounds as discussed in  <cit> .

as indicated in additional file  <dig>  there are  <dig>  positive triads in testing samples. for each of these positive triads ti , we calculated the distance of eq. <dig>  from ti to its nearest positive triad and nearest negative triad in the training set, respectively. denote the two distances thus obtained by pi and ni, respectively. shown in fig  <dig> are two curves generated from pi and ni, named as p-curve and n-curve, respectively. the p-curve is the one with the index i of ti as its x-axis and pi as its y-axis. the n-curve is the one with the index i of ti as its x-axis and ni as its y-axis. it can be seen from fig  <dig> that the n-curve is almost always above the p-curve, meaning that the distances of the  <dig>  testing triads to their nearest positive triads in the training set are almost always smaller than those to their nearest negative triads in the training set, fully consistent with the very high success rate of  <dig> % for predicting the  <dig>  networking triads, as shown in table  <dig>  furthermore, for the distribution of these distance values, there are  <dig>   ti with pi <  <dig> , while there are only  <dig>  ti with ni <  <dig> . the most of ni  were clustered in the interval from  <dig>  to  <dig> , indicating that the distance defined by eq. <dig> for the knn algorithm with w = 1/ <dig> can separate the positive triads and negative triads very well. also, since the distance of eq. <dig> is defined based on the similarities of two substrates, two enzymes and two products, the smaller the distance between the two triads, the more similar the two triads are. it is interesting to see from the current study that the similar triads as defined by our formulation almost always exhibit the same network.

as indicated by comparing the results in table  <dig>  table  <dig> and table  <dig>  the best predicted rate for the  <dig>  networking triads in the testing set was  <dig> %, with w = 1/ <dig> and k =  <dig>  of these triads,  <dig> were mispredicted. it is instructive to see the reason behind these by examining table  <dig>  where the difference between the distance to the nearest positive triad and the distance to the nearest negative triad for each of the  <dig> misclassified triad samples was given. as we can see from the table, the maximum difference was  <dig>  and the minimum difference was  <dig> . shown in fig  <dig> is the distribution of the distance differences listed in table  <dig>  of the  <dig> misclassified positive samples,  <dig>  samples are with the distance differences less than  <dig> , implying that the mispredicted triads are pretty close to the margin of correct prediction, and that the current metric as defined in eq. <dig> for measuring the nearness for the knn algorithm is quite effective.

like most of the other prediction methods, the current prediction method also has its own limitation. for example, for those query triads without any similarity at all to any of the triads in the training datasets, the performance of the current prediction method might be poor. this is because the current prediction method was established on the basis of the "triad similarity", i.e., the similarity between substrates, between enzymes, and between products.

as pointed out by one of the anonymous reviewers, it would be interesting to further discuss the current algorithm from the viewpoint of divergent and convergent evolution  <cit> . we shall work on such an interesting topic in our future work.

CONCLUSIONS
metabolic pathway is one of the key biological networks, consisting of many metabolic reactions involving substrates, enzymes, and products, where substrates can be transformed into products with some particular catalytic enzymes. knowledge about the network of substrate-enzyme-product triads is very useful for in-depth studies of the metabolic pathways. it is both time-consuming and costly to determine the network through biological experiments alone, and hence it is highly desired to develop computational methods in this regard. the computational method reported in this paper can be used to identify the network of substrate-enzyme-product triads with quite high success rate. it is anticipated that the method may become a very useful tool for studying drug metabolism systems. meanwhile, as shown through this study, it is quite promising to introduce the molecular graph and functional domain composition into this area. since user-friendly and publicly accessible web-servers represent the future direction for developing practically more useful predictors  <cit> , we shall design a user-friendly web-server for the prediction method so that many experimental bench scientists can easily use it to get the desired results without the need to go through all the mathematical details.

authors' contributions
lc, kyf, and ydc did materials preparation, method design and programming. lc wrote the paper, kyf, ydc, kcc, and hpl gave scientific advice and made revision. all authors have read and approved the final manuscript.

supplementary material
additional file 1
networking and non-networking triad samples in the training dataset and testing dataset used in this study. each triad consists of a substrate, an enzyme, and a product.

click here for file

 additional file 2
the detailed prediction results. this file lists the prediction results for each of the testing sample in additional file  <dig> 

click here for file

 acknowledgements
we would like to take this opportunity to thank the four anonymous reviewers for their constructive comments, which are very helpful for strengthening the presentation of this paper. this study was supported by the grant from shanghai commission for science and technology .
