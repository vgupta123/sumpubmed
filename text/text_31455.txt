BACKGROUND
the potential influence of past history on evolutionary outcomes has been debated since darwin first addressed the issue in the "origin of species  <cit> . it has been popularized after the famous metaphor of stephen j. gould about “replaying life’s tape”: “you press the rewind button and, making sure you thoroughly erase everything that actually happened, go back to any time and place in the past… then let the tape run again and see if the repetition looks at all like the original… any replay of the tape would lead evolution down a pathway radically different from the road actually taken”  <cit> .

two main approaches are used to analyze historical contingency. one investigates the level of evolutionary parallelism at the macro-evolution level, i.e. the major innovations that have repeatedly evolved in life history  <cit>  or whether evolution is repeatable in natural populations/species that evolved independently in similar but geographically disconnected environmental conditions, such as oceanic islands or glacial lakes  <cit> . a famous example involves the repeated adaptive radiations of anolis lizards in caribbean islands  <cit> . in a second approach, historical contingency can be investigated by experimental evolution with viruses , bacteria , and yeasts  <cit>  that are propagated from an initial ancestral strain in controlled laboratory conditions for hundreds to tens of thousands of generations  <cit> . since microorganisms can be cryo-preserved and revived, these evolution experiments provide frozen fossil records that allow comparisons between evolved clones or populations and their common ancestor and therefore investigation of the detailed evolutionary trajectories at both phenotypic and genomic levels.

several evolution studies have shown that historical contingency may play a major role in the evolution of protein structure and properties  <cit> , as well as of rare phenotypic innovations that required successive mutations and a potentiating genetic background  <cit> . hence, the emergence, after a very long evolutionary time , of a citrate-utilizing phenotype in escherichia coli was contingent upon mutations accumulated during a particular evolution history . successive and contingent mutational steps were also detected during the co-evolution of λ phage and its e. coli host that first allowed evolved bacteria to escape phage infection, and then evolved phages to target a new bacterial membrane receptor, from which newly evolved bacteria escaped again  <cit> . in another study, the establishment of a stable bacterial polymorphism was found to be contingent upon the complex epistatic interactions between mutations  <cit> . by contrast, other studies have found that adaptation is not always historically contingent. a two-step evolution experiment with e. coli showed similar fitness evolution despite distinct initial genetic state and evolutionary history of the evolved populations  <cit> . phenotypic adaptation of tobacco virus strains to their n. tabacum host was also found to be independent from past evolutionary histories  <cit> . similarly, yeast populations have been shown to converge at the phenotypic level and partially at the genomic level during adaptation  <cit> .

in contrast to the previous studies, we investigated contingency by directly addressing whether and how different past environments influence evolutionary trajectories of a bacterial population at both the phenotypic and genomic levels. in the context of the adaptive fitness landscape metaphor , populations initiated with the same ancestor and evolving in different environmental conditions will diverge both phenotypically and genetically as they climb the nearest adaptive peaks in their respective environment . we investigated whether and how such historical adaptive divergence may influence subsequent adaptation to new environmental conditions . two scenarios may be considered: in the first, populations with different environmental histories may converge when placed in the same environmental condition, i.e. climb the same fitness peak , while in the second, the initial divergence in the historical environments may fuel further divergence in the new environment . the topology of the adaptive landscape in the new environment will determine which scenario occurs. if the landscape is relatively smooth with only few adaptive peaks, i.e. few phenotypic/genetic solutions that are mainly additive, then convergence without strong influence of the historical environments would be expected. by contrast, if the landscape is rugged with multiple adaptive peaks, i.e. with multiple phenotypic/genetic solutions that have epistatic interactions, then adaptation to the historical environments would be expected to influence evolution in the new environment, and divergence would be expected between populations that initially evolved in different conditions.fig.  <dig> historical contingency and adaptation in theoretical fitness landscapes. a and b adaptive trajectories of a single ancestor  in two environments represented by two-dimensional fitness landscapes. light blue  and light red  dots indicate the position of a theoretical population after adaptation. c and d when the two populations resulting from the initial adaptation events are placed in the same environment , historical contingency may cause adaptive convergence  or divergence  depending on both the past environment and the fitness landscape of the new environment. dark blue and dark red dots indicate the position of the populations after adaptation to the new environment. white arrows indicate adaptive trajectories. in the landscapes, fitness increases from white to black



we investigated the influence of evolutionary history on adaptation to a new environment by designing a two-step evolution experiment. bacterial populations initiated from a single ancestral clone of e. coli were first propagated in four different environments  and then in a single new environment . phase i was already performed and analyzed in a previous study, during which we propagated four replicate populations of e. coli for  <dig> generations in each of four different environments that were different for their carbon sources, structure and oxygenation  <cit> . these four environments represent the historical environments. we sequenced the genomes of one evolved clone isolated from each of the  <dig> populations and assayed the growth rate and fitness traits of the  <dig> clones in all four environments  <cit> . here, we performed phase ii during which we propagated both a sample from the same  <dig> populations and a randomly isolated evolved clone from each population in a single new environment for another 1000-generation experiment. evolved lineages were characterized at both the phenotypic and genomic levels to assess the impact of historical contingency on evolutionary trajectories.

RESULTS
the impact of historical contingency on evolution was analyzed using a two-step evolution experimental design . briefly, populations initiated from a single ancestor were propagated in four different environments during  <dig> generations  <cit> . at the end of this phase i, population samples as well as randomly isolated clones  were propagated during  <dig> additional generations in a final environment . growth rate and fitness assays in the final environment were performed on population samples at the end of phases i and ii, on clones isolated at the end of phase i, as well as on the population samples derived from these clones at the end of phase ii. the populations founded from isolated clones were mainly studied for the genomic aspect of our study. the phenotypic results obtained from the two types of populations were similar .fig.  <dig> two-step experimental evolution design. populations were initiated from a single ancestor  and propagated in four initial historical environments named ace , gly , glc , and glu  during  <dig> generations   <cit> . from each replicate population, both a population sample and a randomly isolated evolved clone were preserved and used both for phenotypic assays and to found new populations that were propagated in a single new environment during  <dig> generations . at the end of phase ii, a population sample from each of the populations as well as a randomly isolated evolved clone from each of the populations founded from the individual evolved clones derived from phase i were preserved. genome sequences from the evolved clones sampled after phase i have been previously determined  <cit>  and here we sequenced the genomes the evolved clones sampled after phase ii 



historical contingency and phenotypic evolution
divergence of the populations in the four historical environments has been previously reported  <cit> . here, we measured the maximum growth rate and fitness of the populations  in the new environment at both the start and end of phase ii  to investigate how adaptation in the historical environments affected both the phenotype and evolution trajectories in the new environment. maximum growth rate and fitness are not independent phenotypic traits. indeed, fitness often increases owing to growth rate improvement, although this is not systematic. for example, fitness, but not growth rate, may improve if the lag phase is shortened. conversely, growth rate may improve without dramatic fitness increase if the duration of growth at maximum growth rate is reduced. analyzing both fitness and maximum growth rate give complementary data on how populations perform and adapt to the final environment.fig.  <dig> boxplots indicating the phenotypes  and maximum growth rate , both relative to the ancestor) at the start  and end  of phase ii in the final environment for populations founded from population samples  and individual clones . results from tukey hsd post-hoc analyses  on phenotypic difference between populations that evolved in distinct initial environments are indicated 



after phase i , the phenotypic traits of the populations showed differences in the new environment for both population samples and isolated clones . divergence occurred between the populations that evolved in different historical environments , but also between the replicate populations that evolved in identical historical environments . the major effect is due to the between historical environment divergence  and illustrates that adaptation in different initial environments affected the performance in the new environment. this is especially true for the populations and clones that initially evolved in gly. these samples tend to display both higher fitness and growth rate in the final environment compared to the population and clones that initially evolved in the three other environments . to a lesser extent, within environment divergence shows that differences in evolutionary trajectories of replicate populations that evolved in identical historical environments also affected the phenotypic performance in the new environment.

after phase ii, the maximum growth rate and the fitness of the populations increased indicating adaptation to the new environment . this adaptation was strongly dependent upon the historical environment . this may be illustrated by the major fitness improvement of the populations that initially evolved in ace compared to the populations that initially evolved in glc and glu . one may wonder whether such environment-specific historical contingency may be caused by initial differences in growth rate and fitness. indeed, both growth rate and fitness improvement rates have been shown to depend on initial levels . however, in our experiment, this cannot be the only explanation for the detected contingency, because populations displaying similar fitness levels at the end of phase i  have very different fitness levels at the end of phase ii . the adaptation during phase ii is also influenced by the differences between replicate populations . these results show that historical evolution affected the ability to adapt to a new environment.

we then wanted to better visualize whether the populations that initially evolved in different environments converged or diverged when adapting to the same final environment. for all pairwise combination of populations and for both fitness and maximum growth rate, we calculated the difference between the end and start of phase ii of the absolute phenotypic difference between the populations . depending on the historical environments, patterns of convergence and divergence  were identified during phase ii. the fitness of the populations that evolved in ace during phase i diverged from the populations that evolved in glc and glu , due to a major fitness improvement of the populations that initially evolved in ace during phase ii . also, the maximum growth rate of the populations that initially evolved in ace and glu, increased during phase ii , leading to the convergence with the populations that initially evolved in gly .fig.  <dig> boxplot showing historical environment-specific divergence or convergence after phase ii. we measured the difference between the end and start of phase ii in the absolute phenotypic difference  for fitness  and growth rate  between any pair of populations . results are given for populations founded from phase i population samples  and isolated clones . population pairs are grouped based on the historical environments . dapd values below and above  <dig> indicate phenotypic convergence and divergence, respectively, during phase ii



historical contingency and genetic evolution
in addition, we investigated the impact of historical contingency on the genomic changes that occurred during the two phases. sequencing the genomes of one evolved clone sampled from each of the populations at the end of phase i  allowed us to detect  <dig> mutations  <cit> . here, we sequenced the genomes of one evolved clone sampled from each population at the end of phase ii . we detected  <dig> new mutations  including  <dig> point mutations,  <dig> of which are in coding regions  and three in intergenic regions. we also characterized six small deletions including four in coding regions and two in intergenic regions, one 3-bp insertion and one is <dig> insertion in a coding region. genetic parallelism was detected as seven genes  carried mutations in clones isolated from independent populations. as genome sequencing may have missed dna rearrangements, we investigated by pcr amplification and sanger sequencing whether these seven genes were affected by larger insertions or deletions in the clones where no point mutations were initially identified. we found one additional mutation, an is <dig> insertion in nadr in the clone from population glu_ <dig> .fig.  <dig> mutational events in phase i , phase ii  and both . the four historical environments are indicated with colours, with red, blue, green and purple corresponding to ace, gly, glc, and glu, respectively. genes written in white have been affected by mutations in more than one historical environment. genes written in colours have been affected by mutations in more than one replicate population from either identical historical environments during phase i or coming from identical historical environments during phase ii, the colour corresponding to a given historical environment. genes specific to the e. coli b ancestor strain are indicated with their ecb numbers. in a, mutated genes are dependent on the historical environment . in b, mutated genes are not influenced by the historical environment . in c, mutated genes are not influenced by the historical environment . statistical tests were performed on genes written in white



we investigated whether and how the genetic modifications detected after phase ii were contingent on the historical environments. after phase i,  <dig> mutations have been identified with two to seven mutations per clone  <cit> . after phase ii, we found  <dig> mutations with a lower number of mutations  per clone . during phase i, seven genes  and one operon  were repeatedly affected by mutations, i.e. in more than one clone . moreover, the genes mutated in parallel were different from one environment to the other . this pattern holds even when considering only the four genes  that were mutated in more than one historical environment . by contrast, during phase ii  <dig> genes  and  <dig> operon  were repeatedly mutated in more than one clone but without historical contingency . we observed the same trend when considering all mutations that occurred during both evolution phases . three additional lines of evidence supported the same conclusion. first, mutations in glp genes have been identified after phase i specifically in the clones isolated from the glycerol-containing historical environment  and after phase ii in various clones irrespective to their historical environments , suggesting specific adaptation to glycerol-containing environments. second, mutations in nadr have been identified after phase i in clones from the two glycerol- and glucose-containing environments , and after phase ii in clones from populations that historically evolved in the two other acetate- and gluconate-containing environments , suggesting general adaptation. third, after phase ii, one gene  was affected by mutations in several clones irrespective to their historical environments, which indicates no strong historical contingency. these clones showed no other shared mutated gene during either phase i or ii. we found no evidence for contingency linked to the historical environments on genes mutated during phase ii. likewise, the mutations detected during phase ii were not contingent upon the mutations that accumulated during phase i .

discussion
we designed a two-step experimental evolution approach to investigate whether adaptation to a given initial  environment may influence further adaption to new environments. we investigated this historical contingency at both phenotypic and genomic levels. populations that initially evolved during  <dig> generations in four different historical environments were transferred to a new environment in which they were propagated for an additional 1000-generation period. adaptation to the historical environments after phase i was associated with phenotypic as well as genetic divergence when assayed in the new environment. after phase ii, the phenotypes of the populations in the new environment were dependent on the historical environments, showing that adaptation was influenced by the environment in which the populations initially evolved. however, the mutations that occurred during phase ii were neither contingent on the historical environments nor on the mutations accumulated during phase i.

our results contrast with others studies showing that historical contingency may be easier to detect at the genomic rather than phenotypic level, especially for fitness-related traits, because selection is supposed to overcome historical contingency  <cit> . here, we measured two phenotypes that are obvious targets of selection, maximum growth rate and fitness relative to the ancestor in the new environment. hence, all populations improved both phenotypic traits in the new environment during phase ii, but with a speed/magnitude that was influenced by the historical environments. moreover, considering growth rate and fitness, convergence or divergence of the populations in the new environment was also dependent on the historical environment. therefore, even for phenotypic traits that are strongly driven by selection, the evolutionary trajectories of populations adapting to a new environment may be contingent on the environments in which they historically evolved. eventually, growth rate and fitness may likely improve to the point that they do not appear to be influenced by historical contingency anymore. however, such improvement would have been achieved following different phenotypic evolutionary paths.

it is somehow surprising that the historical contingency detected at the phenotypic level was not related to parallelism at the genomic level. several hypotheses may explain this discrepancy. first, it is important to emphasize that some mutations, including for example those mediated by the transposition of insertion sequences  and large dna rearrangements, may have been missed by our genomic analyses. these types of mutations are frequent enough to be drivers of phenotypic evolution, including parallel evolution during experimental evolution  <cit> . we indeed found one such mutation when we analyzed repeatedly-mutated genes by pcr followed by sanger sequencing .

second, we addressed genomic parallelism at the gene or operon level and assumed that different allelic versions of the same gene resulted in similar phenotypic effects. however, several evolution experiments revealed allelic divergence where different alleles of the same gene may lead to distinct phenotypic traits  <cit> . in our study, we have no indication that the effects of the different alleles in the repeatedly-mutated genes were more similar between clones that evolved in the same historical environment than in different ones. indeed, all clones from the same historical environment are only rarely mutated in identical genes and, if so, there is no obvious historical environment-specific pattern. for instance, potential loss-of-function mutations  in glpr were identified in clones from three of the four historical environments and strictly identical spot mutations in clones from two historical environments.

third, genetic parallelism may occur at a level higher than the gene since mutations of different genes may have similar phenotypic effects, many different genes being involved in identical functions. although parallelism or convergence at the phenotypic level may be related to mutations in the same genes  <cit> , such phenotypic redundancy may also involve mutations in different genes  <cit> . in our study, the gene functions give no evidence that mutations occurring in different genes might explain environment-specific historical contingency at the phenotypic level. however, such relationships are impossible to rule out and testing them would require extensive genetic manipulations.

fourth, the importance of historical contingency may depend on the composition of both the historical and new environments, thereby explaining the seemingly different results obtained in our and previous studies  <cit> . in the context of environmental contingency, selective pressures may first favour mutations either in environment-specific genes or to compensate maladaptive effects of changes that were beneficial in the historical environments but not in the new one. in the first case, historical contingency may be detected at the phenotypic level during adaptation to a new environment while, in the second case, the initial steps of the adaptive process may mask the phenotypic signature of historical contingency. here, the selective environment of phase ii contains glycerol as the sole carbon source and previous evolution experiments in glycerol-containing medium revealed changes in the genes that are specific to the glycerol metabolism  <cit> . in our study, ten of the  <dig> evolved clones carried mutations in glycerol-specific genes at the end of phase ii, suggesting mutations directly improving glycerol consumption. another instance of genetic adaptation in the new environment independent from the historical environments includes the mutations in flu, a gene involved in biofilm formation  <cit> , identified in three clones that evolved in three different historical environments. agitation and thus oxygenation were probably affecting growth in the 1-ml microplates in which all populations were propagated during phase ii, thereby potentially favouring clones with different aggregation abilities.

CONCLUSIONS
by designing a two-step evolution experiment with e. coli, we investigated whether phenotypic and genomic evolution were contingent on historical environment. at the phenotypic level, evolution in a new environment was contingent on the historical environment even for fitness-related traits . however, such historical contingency signatures were not detected at the genomic level. this work illustrates that historical contingency may affect phenotypic adaptation to a new environment without clear genomic signature.

