BACKGROUND
biochemical pathways or networks are typically very large. a well-characterized example is the protein-protein interaction network of the yeast saccharomyces cerevisiae with approximately a thousand putative interactions involving an approximate equal number of proteins
 <cit> . it is also a fact that a significant number of species are found in low copy numbers in both prokaryotic and eukaryotic cells
 <cit> . recent mass spectrometry-based studies have, for example, shown that 75% of the proteins in the cytosol of the bacterium escherichia coli appear in copy numbers below  <dig> and the median copy number of all identified proteins is approximately 500
 <cit> . this means that simulation methods intended to realistically capture the inner workings of a cell have to  be stochastic to take into account the significant intrinsic noise associated with low copy number conditions;  be able to simulate fairly large networks in a reasonable amount of time. the stochastic simulation algorithm 
 <cit>  has been and still is the algorithm of choice for a large number of studies exploring the role of noise in biology. the advantage of the algorithm is that it is exact, i.e., it exactly samples the trajectories of the stochastic process described by the chemical master equation , the accepted mesoscopic description of chemical kinetics. its disadvantage is that it simulates every reaction event and hence is not particularly suited for the study of large networks
 <cit> . this problem is an outstanding challenge in the fields of computational and systems biology.

a common way of circumventing the problem is to simulate a network of species which is much smaller than the size of the full network but which nevertheless captures the essential dynamics. for example, the three elementary  reactions which describe the enzyme-assisted catalysis of substrate s into product p via the michaelis-menten reaction,
s+e⇌k1k0c→k2e+p, can be replaced by a single effective reaction
s→k′p. note that here e and c denote the free enzyme species and the enzyme-substrate complex species, respectively. the latter first-order reaction is non-elementary, i.e., it can be broken down into a set of fundamental elementary reactions. the implicit assumption in this lumping or coarse-graining method is that the transients in the average concentrations of some species decay over much longer timescales than those of the rest of the species. hence, one can argue that the relevant network to be simulated is that involving the slowly varying species only. in the michaelis-menten example, the fast species were the enzyme and the complex and the slow species are the substrate and product. the dynamics of this reduced network are of course only a faithful approximation of those of the full network, the michaelis-menten reaction, whenever the rate constants guarantee reasonable timescale separation.

on the macroscopic level, where molecule numbers are so large that intrinsic noise can be ignored, there is a well-known practical recipe for obtaining this reduced or coarse-grained network from the full network of elementary reactions. one writes down the rate equations  for each species, decides which species are fast and slow, sets the time derivative of the concentration of the fast species to zero, solves for the steady-state concentrations of the fast species and finally substitutes these concentrations into the equations for the slow species. this procedure is the deterministic quasi-steady-state assumption . the result is a set of new res for the slow species only; corresponding to these reduced equations is the coarse-grained network, i.e., the network of reactions between slow species whose macroscopic rate laws are dictated by the new res. generally, all coarse-grained networks will have at least one reaction which is non-elementary; however those reactions involving the interaction of only slow species in the full network will naturally also remain elementary in the coarse-grained network. the deterministic qssa presents a rigorous method of achieving a coarse-grained macroscopic description based on the deterministic res
 <cit> . its major shortcoming is that it ignores the inherent stochasticity of the system.

on the mesoscopic level, or, in other words, whenever the size of intrinsic noise becomes comparable with the average molecule numbers, the description of chemical kinetics is given by the cme. one would hope that under conditions of timescale separation, just as one can write effective res for a coarse-grained network starting from the res of the full network, in a similar manner one can obtain an effective  cme for the coarse-grained network starting from the cme of the full network. the effective res have information about the macroscopic concentrations of the slow species only, while the effective cme has information about the fluctuations of the slow species only. this line of reasoning has led to a stochastic formulation of the qssa which is in widespread use. in what follows we concisely review the cme formulation of stochastic kinetics and point out compelling reasons which cast doubt on the validity of the popular stochastic qssa.

suppose the network  under consideration consists of a number n of distinct chemical species interacting via r elementary or non-elementary chemical reactions of the type 

  s1jx1+…+snjxn→kjr1jx1+…+rnjxn. 

here, j is an index running from  <dig> to r, xidenotes chemical species i, sijand rij are the stoichiometric coefficients and kjis the macroscopic rate coefficient of the reaction. if reaction scheme  describes the full network with ns number of slow species and nf=n−ns number of fast species, then we adopt the convention that x1to
xns denote the slow species, while
xns+ <dig> to xn label the fast species. let nidenote the absolute number of molecules of the ith species; then, at any point in time, the system is described by the state vector
n→=t. when the jth reaction occurs, the system jumps from state
n→ to a new state
n→+μ→j, where
μ→j=r1j−s1j,...,rnj−snj. furthermore, one defines a propensity function aj for the jth reaction such that
ajn→dt is the probability that the jth reaction occurs in the next infinitesimal time interval
t,t+dt. using these definitions and the laws of probability, one can then deduce that the general form of the cme is
 <cit> 

  ∂pn→,t∂t=∑j=1rajn→−μ→jpn→−μ→j,t−ajn→pn→,t, 

where
p is the probability that the system is in a particular mesoscopic state
n→. the recipe becomes complete once we specify the form of the propensity functions for each chemical reaction. figure
 <dig> lists the microscopic rate function,
f^j=aj/Ω, i.e., the propensity functions divided by the volume Ω, for  <dig> elementary reactions and  <dig> common non-elementary reactions. the macroscopic rate function fj, i.e., the rate of reaction according to the deterministic res, is also shown alongside the microscopic rate functions. note that
xi in the macroscopic rate functions denotes the macroscopic concentration of species i.
f^ for various common types of chemical reaction steps. the former define the res while the latter define the cme. the first four reactions are elementary, i.e., they are unimolecular or bimolecular reactions. the last three reactions are non-elementary, i.e., they can be decomposed into a number of simpler elementary reactions. these reactions represent  the catalysis of a substrate by enzyme, up-regulation of a gene  by an activator and down-regulation of a gene by a repressor

if we are modeling the full network, then the constituent reactions have to be all elementary. for such reactions, the propensity and microscopic rate functions have been derived from molecular physics
 <cit>  and hence the cme for the full network is fundamentally correct. now say that we are modeling a coarse-grained network in which case some reactions are non-elementary. microscopic considerations do not tell us anything about the form of the propensity functions for such reactions. rather the propensities and the microscopic rate functions are a heuristic extrapolation of the macroscopic reaction rates at the heart of the effective res for the non-elementary reactions:
f^ is obtained by performing the substitution
xi→ni/Ω on f .

hence it follows that the cme for the coarse-grained network is not rigorously derived from that of the full network under conditions of timescale separation but rather is heuristic and hence its validity is a priori doubtful. janssen was the first to investigate this question by means of an analytical approach applied to a simple chemical example, the dissociation of n2o5; he showed that “the master equation for a complex chemical reaction cannot always be reduced to a simpler master equation, even if there are fast and slow individual reaction steps”
 <cit> . this suggests that even if the molecules numbers are quite large, the conditions for timescale separation required for the validity of the deterministic qssa are not generally enough to guarantee the validity of the heuristic cme, a hypothesis which has been recently verified in the context of the michaelis-menten reaction with substrate input
 <cit> . in other words, the heuristic cme is not the legitimate stochastic equivalent of the deterministic qssa, in the sense that it does not correctly describe the statistics of the intrinsic noise about the macroscopic concentrations as given by the reduced res of the coarse-grained network.

notwithstanding the fundamental objections of janssen, and frequently in the name of pragmatism, many studies
 <cit>  have employed the heuristic cme to obtain a coarse-grained stochastic description of various complex networks. a number of studies
 <cit>  have reported good agreement between the results of stochastic simulations of the full and coarse-grained networks for enzyme reactions and circadian oscillators which has enhanced faith in the heuristic approach of stochastic modeling of networks with non-elementary reactions and given it the status of a mainstream methodology.

in this article we seek to derive a rigorous alternative to the heuristic approach. given the cme of the full network of elementary reactions, we derive a reduced linear fokker-planck equation  which describes the noise statistics of the same network when the molecule numbers are not too small and under the same conditions of timescale separation imposed by the deterministic qssa. this new fpe is the legitimate mesoscopic description of intrinsic noise about the macroscopic concentrations of the coarse-grained network as obtained by the deterministic qssa. the noise statistics from this approach are compared with stochastic simulations of the full network and with simulations of the coarse-grained network using the conventional heuristic approach. in all cases our approach agrees very well with the full network results. in contrast, we show how the size of intrinsic noise as predicted by the conventional approach can be different by more than an order of magnitude than the actual value and how in some instances this approach even misses the existence of noise-induced oscillations. we also show using our method how one can obtain the regions of parameter space where the conventional approach qualitatively fails and where it fares well.

the article is organized as follows. in the results section, we discuss in general terms the procedure of obtaining a rigorous mesoscopic description under conditions of timescale separation akin to those of the deterministic qssa. we then apply this novel method to two different examples: an enzyme mechanism capable of displaying both michaelis-menten and hill-type kinetics and a gene network with a single negative feedback loop. the results from our method are contrasted and compared with stochastic simulations of the full network and with those of the coarse-grained network using the conventional heuristic method. we finish by a discussion. detailed derivations concerning results and applications can be found in the methods section.

RESULTS
the optimal method to determine the validity of the heuristic cme would be to obtain its analytical solution and compare it with that of the cme for the full network and for rate constants chosen such that the deterministic qssa is valid. note that the latter constraint on rate constants is necessary because the propensities of the heuristic cme are based on the macroscopic rate laws as given by the reduced res and hence the heuristic cme can only give meaningful results if the deterministic qssa is valid. unfortunately, cmes are generally analytically intractable, with exact solutions only known for a handful of simple elementary reactions
 <cit> . to circumvent this problem we take recourse to a systematic approximation method, the system-size expansion of van kampen
 <cit> . the starting point of this method is to write the absolute number of molecules of species i in the cme, equation , as 

  niΩ=xi+Ω−1/2εi, 

where
xi is the macroscopic concentration of species i and εiis proportional to the noise about this concentration. this substitution leads to an infinite expansion of the master equation. the first term, that proportional to Ω
1/ <dig>  leads to the deterministic equations for the mean concentrations as predicted by the cme in the macroscopic limit of large volumes . the rest of the terms give a time-evolution equation for the probability density function of the fluctuations,
Π. this partial differential equation is an infinite series in powers of the inverse square root of the volume . truncating this series to include only the first term, i.e., that which is proportional to Ω
 <dig>  leads to a second-order partial differential equation, also called the linear fokker-planck equation or the linear noise approximation 
 <cit> . the solution of the latter equation is a multivariate gaussian probability distribution and hence expressions for the statistics of intrinsic noise about the macroscopic concentrations, e.g., the variance of fluctuations, can be obtained straightforwardly from this formalism, a distinctive advantage over the cme. the restrictions which must be kept in mind are that this method only provides a reliable approximation to the cme if the molecule numbers are sufficiently large  and the chemical network is monostable .

hence we can now formulate two questions to precisely determine the validity of the heuristic cme in timescale separation conditions:  in the macroscopic limit, are the mean concentrations of the heuristic cme exactly given by the reduced res obtained from the deterministic qssa?  are the noise statistics about these mean concentrations, as given by the lna applied on the heuristic cme, equal to the noise statistics obtained from applying the lna on the cme of the full network? if the heuristic cme is correct then the answer to both these questions should be yes.

the first question can be answered straightforwardly. the deterministic equations for the mean concentrations of the heuristic cme, in the macroscopic limit of infinite volumes, necessarily only depend on the macroscopic limit of the heuristic microscopic rate functions in the heuristic cme. more specifically, consideration of the first term of the system-size expansion leads to a deterministic set of equations of the form
d→/dt=sf^→|Ω→∞, where s is the stoichiometric matrix with elements sij=rij−sij <cit> . as discussed in the introduction, the vector of heuristic microscopic rate functions for the heuristic cme,
f^→, is constructed from the macroscopic rate function vector,
f→, of the reduced res by performing the substitution
xi→ni/Ω on
f→. given the ansatz, equation , we can see that the heuristic method guarantees, by construction, that
f^→|Ω→∞=f→. this implies that the first term of the system-size expansion applied to the heuristic cme leads to a deterministic set of equations of the form
d→/dt=sf→, which indeed are the reduced res obtained from the deterministic qssa. hence, we can conclusively state that in the macroscopic limit, the heuristic cme does reproduce the correct mean concentrations for timescale separation conditions.

the second question, regarding agreement in noise statistics not simply in the means, has not been considered before and presents a considerably more difficult challenge. in what follows we briefly review the lna applied to the heuristic cme of the coarse-grained network which we shall call the hlna and we derive the lna applied to the full network under conditions of timescale separation, a novel method which we refer to as the slow-scale lna .

the lna applied to the heuristic cme
the application of the lna to the heuristic cme has been the subject of a number of studies
 <cit> . for a step-by-step guide to implementing the lna we refer the reader to the supplementary material of ref.
 <cit> . here we simply state the well known results. we shall use the underline notation to denote a matrix throughout the rest of the article.

given the coarse-grained network, reaction scheme , one can construct the stoichiometric matrix s with elements sij=rij−sij and the macroscopic rate vector with entries
fj=kj∏m=1nxmsmj. note that the latter, as discussed in the introduction, encapsulates the macroscopic rate law for each individual reaction composing the network. note also that the k’s for a coarse-grained network are generally functions of the macroscopic concentrations and not constants as for a full network . the reduced res are then given by
d→/dt=sf→ and consequently the jacobian matrix j has elements
jij=∂ji, where ∂j denotes the partial derivative with respect to
xj, the concentration of species j.

it then follows by the lna that the noise statistics given by the heuristic cme, i.e., equation  with heuristic propensities, in the limit of large molecule numbers, are approximately described by the following linear fpe 

  ∂pη→s,t∂t=−∇stjη→s+12∇stdh∇spη→s,t, 

where
η→s is the vector of concentration fluctuations about the macroscopic concentrations of the slow species, i.e.,
ηs,i=−xi. note that in the traditional approach due to van kampen
 <cit>  one writes a linear fpe for the noise vector
ε→s because of the form of the ansatz, equation  . here we have instead chosen to write the fpe for
η→s=Ω−1/2ε→s since
η→ is the true measure of fluctuations about the mean concentrations. the operator ∇sdenotes the vector of derivatives with respect to components of the vector
η→s. the matrix dh is the diffusion matrix which is given by the following formula 

  dh=Ω−1sfst, 

where f is a diagonal matrix whose non-zero diagonal entries are the elements of the macroscopic rate function vector
f→, i.e.,
f=diag.

the solution of the linear fpe, equation , is a multivariate gaussian and hence noise statistics can be straightforwardly computed. the covariance matrix h of the concentration fluctuations about the steady-state concentrations, as described by the linear fpe, can be obtained by solving the lyapunov equation
 <cit> 

  jh+hjt+dh= <dig>  

where hij=〈ηs,iηs,j〉. the variance of the fluctuations of species j is hence given by the jth diagonal element of h. the power spectrum of the concentration fluctuations of the jth species is given by 

  pj=iiω+j−1d─h−iiω+jt−1jj, 

where i is the identity matrix, i is the imaginary unit number and ω is the frequency.

note that we have chosen to compute the variance and power spectrum as our noise statistics for the following reasons. the variance can be used to calculate the fano factor  and the coefficient of variation 
 <cit> . the coefficient of variation provides a non-dimensional measure of the size of intrinsic noise, and is a particularly natural measure when the probability distribution solution of the cme is approximately gaussian. the fano factor multiplied by the volume provides another non-dimensional measure of the noise level: it gives the size of the fluctuations in the molecule numbers relative to that of a poissonian distribution with the same mean number of molecules. generally these measures provide different but complementary information and both have been reported in recent experiments
 <cit> . hence in this article we calculate both measures. we also calculate the power spectrum which gives the intensity of fluctuations at a given frequency; a peak in the spectrum indicates noise-induced oscillations
 <cit> , a phenomenon which is of importance in biochemical networks responsible for biological rhythms such as circadian clocks
 <cit> .

the lna applied to the full network under conditions of timescale separation
the lna approach mentioned in the previous subsection works equally well if applied to the cme of the full network. this leads to a linear fpe of the form 

  ∂pη→,t∂t=−∇tjfη→+12∇tdf∇pη→,t, 

where
η→=η→s,η→f and
η→s and
η→f are, respectively, the vectors of concentration fluctuations about the macroscopic concentrations of the slow and fast species. the operator ∇ denotes the vector of derivatives with respect to components of
η→. the matrix jf is the jacobian of the res of the full network, while the diffusion matrix df is given by equation  with s and f now equal to the stoichiometric matrix and the diagonal matrix of the macroscopic rate function vector for the full network, respectively.

note that while equation  is based on the heuristic cme and therefore inherits all its problems, equation  has no such problems: it is derived from the cme of the full network of elementary reactions, which is fundamentally correct. hence, ideally, we would obtain the multivariate gaussian solution of the two linear fpes, compare and then decide upon the validity of the heuristic cme. unfortunately, this direct comparison is impossible because equation  gives a joint probability distribution function for the slow species only, whereas equation  leads to a joint probability density function for both slow and fast species.

in the methods section we devise an adiabatic elimination method by which, starting from equation , we obtain a closed-form solution for a linear fpe that describes the time evolution of the joint probability density function of slow variables only. we call the reduced linear fpe obtained from this method, the slow-scale lna. our result can be stated as follows. under conditions of timescale separation consistent with the deterministic qssa, the noise statistics of the slow species according to the cme of the full network can be approximately described by the following linear fpe 

  ∂pη→s,t∂t=−∇stjη→s+12∇stdss∇spη→s,t. 

note that the matrix j is the jacobian of the reduced res of the coarse-grained network, indeed the same as in equation . however, the diffusion matrix dss is generally different than dh, which indeed proves the non-validity of the heuristic cme as a stochastic description of the coarse-grained network. we show that the new diffusion matrix is given by 

  dss=Ω−1a−ba−bt, 

where
a=ssf and
b=jsfjf−1sff. we have also used the following convenient definitions   

where s and jf are the stoichiometric and jacobian matrices of the full network and f is the diagonal matrix of the macroscopic rate function vector of the full network with the macroscopic concentrations of the fast species expressed in terms of the macroscopic concentrations of the slow ones. the matrices s and jf are partitioned into sub-matrices of the following sizes: ss is an ns×r matrix, sf  is an nf×r matrix, js is an ns×ns matrix, jsf  is an ns×nf matrix, jfs is an nf×ns matrix and jf  is an nf×nf matrix. note that nsand nf are the number of slow and fast species respectively. note also that the fact that the new diffusion matrix can be written in the form of equation  immediately implies that it is symmetric and positive semi-definite, two crucial properties of the diffusion matrices for all fpes
 <cit> . it also follows that the variance and power spectrum of the slow species according to the sslna can be calculated from equations  and  with dh replaced by dss.

the derivation of the sslna leads us to a fundamental conclusion: although the existence of an effective cme for a coarse-grained network under conditions of timescale separation cannot be generally guaranteed , it is always possible to write down a effective linear fpe for the coarse-grained network. we now also have a viable strategy to compare the heuristic and full cmes under conditions of timescale separation: one obtains the noise statistics from the hlna and the sslna and compares them for rate constants such that the deterministic qssa is a valid approximation . furthermore, the sslna provides us not only with a new method to analytically obtain the noise statistics of a coarse-grained network but also with a new simulation tool which replaces conventional ssa simulations with heuristic propensities. the new simulation method consists in numerically solving the set of stochastic differential equations  which exactly correspond to equation 
 <cit> 

  ddtη→s=jη→s+Ω−1/2ss−jsfjf−1sffΓ→, 

where the r dimensional vector
Γ→ is white gaussian noise defined by 〈 Γi〉=0and
〈ΓiΓj〉=δi,jδ.

one may ask whether there is an effective cme which in the large volume limit can be approximated by the sslna, eq. . the form of the noise coefficient in eq.  implies that the sslna corresponds to the master equation of an effective reaction scheme with a stoichiometric matrix 

  s′=ss−jsfjf−1sf. 

such a reaction scheme is compatible with the reduced res: defining
 as the macroscopic concentration vector of the slow species, we have
d/dt=s′f→=ssf→ since
sff→= <dig> as required by the deterministic qssa. note that while s’ is not the only stoichiometric matrix which is compatible with the reduced res , it is the matrix which is uniquely selected by adiabatic elimination of the concentration fluctuations of the fast species. of course this reduced reaction scheme characterized by s’ is only physically meaningful if its entries are time-independent and integer-valued. under timescale separation, this condition is not generally fulfilled. rather this constitutes an additional, stronger condition. hence it follows that generally a reduced cme description does not exist under timescale separation conditions, though a reduced langevin equation description, i.e., the sslna, always exists.

in the rest of this article, we apply the systematic comparison method developed in the results section to two examples of biological importance: enzyme-facilitated catalysis of substrate into product by cooperative and non-cooperative mechanisms and a genetic network with a negative feedback loop. for each of these, we shall obtain the noise properties of the coarse-grained versions of the circuits in the limit of large molecule numbers using the sslna and the hlna. because the expressions for the noise statistics from these two are quite simple, we shall be able to readily identify the regions of parameter space where the hlna, and hence the heuristic cme, is correct and where it gives misleading results. the theoretical results are confirmed by stochastic simulations based on the cme of the full network and on the heuristic cme of the coarse-grained network.

application i: cooperative and non-cooperative catalytic mechanisms
many regulatory mechanisms in intracellular biochemistry involve multisubunit enzymes with multiple binding sites
 <cit> . we consider a simple network involving the catalysis of substrate into product by a two- subunit enzyme 

  →kins,s+ee⇌k−1k1ees→k3ee+p,s+ees⇌k−2k2sees→k4ees+p. 

substrate s is input into the compartment where the reaction is occurring, it reversibly binds with an enzyme ee which has two free binding sites to form the first complex ees with one binding site occupied by a substrate molecule. this complex either decays into the original enzyme ee and a product molecule or else it can reversibly bind to another substrate molecule leading to a second complex sees with both binding sites occupied by substrate molecules. finally, this last complex decays into the first complex and product p. note that reaction scheme  is the considered full network, since only elementary reactions are involved.

deterministic analysis and network coarse-graining
the full network   has been previously studied using res by tyson
 <cit> . the coarse-grained network is obtained by implementing the deterministic qssa: transients in the enzyme and complex concentrations are assumed to decay much faster than transients in the substrate concentrations. hence, the time derivatives of the res for the concentrations of the two complexes are set to zero, the steady-state concentrations of the two complexes are found and substituted in the re for substrate concentration, leading to a single effective rate equation
 <cit>  given by 

  ddt=kin−k′, 

  k′=eetkm1k3+k4km21+km1+2km1km <dig>  

where s is the instantaneous substrate concentration and k′is an effective first-order rate coefficient. the michaelis-menten constants are
km1=k−1+k3/k <dig> and
km2=k−2+k4/k <dig> and the total enzyme concentration is denoted as
eet, which is a constant at all times and equal to
eet=++, the sum of the concentrations of free enzyme and of the two complexed forms. hence, the coarse-grained version of the full network  is simply 

  →kins→k′p. 

note that the deterministic qssa has reduced our network from one with  <dig> species interacting via  <dig> elementary reactions, reaction scheme , to one with  <dig> species interacting via  <dig> reactions, one elementary and one non-elementary, reaction scheme . a cartoon representation of the two networks can be found in figure
 <dig>  the dynamics of the coarse-grained network are a good approximation of those of the full network provided the timescales for the decay of the transients in the concentrations of the two complexes are much shorter than those of the substrate.

note that throughout the rest of this article, the notation  will generally denote the steady-state concentration of species x, unless it appears in the context of a differential equation as in equation  where then it necessarily refers to the instantaneous concentration.

stochastic analysis of the coarse-grained network: sslna and hlna methods
we use the sslna  to obtain the langevin equation for the intrinsic noise ηs about the steady-state macroscopic substrate concentration of the coarse-grained network, i.e., the steady-state solution  of equation . the derivation leading to the langevin equation can be found in the methods section. the result is

  ddtηs=jηs+Ω−1/2kinΓ1−k1q1Γ2+k−1q1Γ3−k31−q1Γ4−k2q2Γ5+k−2q2Γ6−k41−q2Γ7), 

where j is the jacobian of the reduced re, equation , and the functions q <dig> and q <dig> are defined as 

  q1=k3km2+k4k12+km2+km1km <dig>  

  q2=k4km1+k4−k3k22+km2+km1km <dig>  

note that Γidenotes the contribution to the intrinsic noise in the steady-state substrate concentration due to the ith elementary reaction of the full network of which there are  <dig> in total. it is clear that Γ <dig> is the noise from the input reaction since it has a pre-factor of kin, Γ2is the noise from the binding of substrate and free enzyme since it has a pre-factor of k <dig> and so on for the rest of the noise terms. hence, we see that according to the sslna, under conditions of timescale separation, all elementary reactions in the full network contribute to the intrinsic noise in the substrate concentration. the variance of the intrinsic noise described by the langevin equation, equation , can be calculated according to the recipe described in the results section  and is found to be given by 

  σsslna2=−2jΩ−1kin+k1+k−1q12+k2+k−2q22+k3×2+k41−q <dig>  

next we obtain the variance of the substrate fluctuations by applying the lna to the heuristic cme of the coarse-grained network . the heuristic microscopic rate functions, i.e., the propensities divided by the volume, are in this case 

  f^1=kin, 

  f^2=nsΩk′|s→ns/Ω. 

using the prescription for the hlna , one obtains the variance of the fluctuations to be 

  σhlna2=−− <dig>  

a comparison of equations  and  leads one to the observation that the latter can be obtained from the former by setting q1=q2= <dig>  substituting these conditions in the langevin equation, equation , we obtain physical insight into the shortcomings of the conventional heuristic method. this method rests on the incorrect implicit assumption that under conditions of timescale separation, the reversible elementary reactions involving the fast species do not contribute to the intrinsic noise in the substrate concentration.

stochastic michaelis-menten and hill-type kinetics
we now consider two subcases which are of special interest in biochemical kinetics:  k2→ <dig>  km2→∞;  k2→∞, km2→ <dig> at constant
km1km2=km <dig>  these limits applied to the reduced re, equations , lead to the two simplified res, respectively, 

  case ddt=kin−k3eetkm1+, 

  case ddt=kin−k4eet2km2+ <dig>  

hence, the first case leads to michaelis-menten  kinetics  and the second to hill-type kinetics with a hill coefficient of two .

applying limit  to equations  and , we obtain the variance of the fluctuations for michaelis-menten kinetics as predicted by the sslna and the hlna 

  mm-kineticsσsslna2=Ω1+k−1/k1+km1+km <dig>  

  σhlna2=Ω1+km <dig>  

similarly applying limit  to equations  and , we obtain the variance of the fluctuations for hill-type kinetics as predicted by the sslna and the hlna 

  hill-kineticsσsslna2=2Ωkm2+2km2+k42k1Ω22+km <dig>  

  σhlna2=2Ωkm2+2km <dig>  

comparison of equations  and  shows that the heuristic cme description of the coarse-grained network overestimates the size of intrinsic noise whenever the deterministic kinetics are michaelis-menten. interestingly, comparison of equations  and  shows the opposite for hill-type kinetics: the size of noise predicted by the heuristic cme underestimates the true value. note also that for both types of kinetics, the heuristic cme predicts the correct noise statistics in the limit of very small and very large substrate concentrations . the predictions for the michaelis-menten case agree with those reported by a recent simulation-based study
 <cit>  and a study using the lna applied to the full network
 <cit> . indeed, this agreement is an important benchmark for the sslna. to our knowledge, the results for the hill-type kinetics have not been obtained before.

the results for hill-type kinetics are shown in figure
 <dig>  in figures
4a and
4b we plot the coefficient of variation cvs and the fano factor ffs of the substrate concentration fluctuations  and ) versus the non-dimensional fraction
Θ=kin/k4eet. from equation  it can be deduced that
2=km2Θ/; hence, the physical meaning of Θis that it is a measure of enzyme saturation since as it increases, the substrate concentration increases as well, and consequently the free enzyme concentration decreases. the values of rate constants are chosen such that timescale separation is guaranteed, i.e., there is very good agreement between the concentration of the slow species as predicted by the res of the full network and the reduced res obtained using the deterministic qssa .
cvs <dig>   for the substrate fluctuations as a function of the non-dimensional fraction Θ, in steady-state conditions. the latter is a measure of enzyme saturation. the solid lines are the sslna predictions, the dashed lines are the hlna predictions, the solid circles are obtained from stochastic simulations of the full network and the open circles are obtained from stochastic simulations of the coarse-grained network using the ssa with heuristic propensities. the color coding indicates different values of the bimolecular rate constant k1: 5×10− <dig>  5×10− <dig>  and 5×10− <dig>  the remaining parameters are given by
eet= <dig>  k2= <dig>  k−1=k−2= <dig>  k3=k4= <dig>  note that in  the black dashed line indicates the hlna prediction for all three different values of k <dig>  which are indistinguishable in this figure. the stochastic simulations were carried out for a volume Ω= <dig>  in  sample paths of the ssa for the full network , the slow scale langevin equation  as given by equation  and the ssa with heuristic propensities  are compared for Θ= <dig> . the slow scale langevin equation is numerically solved using the euler-maruyama method with timestep δt= <dig> . note that in all cases, the chosen parameters guarantee timescale separation  
 <dig>  and ; the value of Θis  <dig> . the excellent agreement between the two re solutions, implies timescale separation conditions

the following observations can be made from figures
4a and
4b. the sslna quantitatively agrees with the results of stochastic simulations of the full network for a large enough volume Ω. in contrast, the heuristic approach, hlna, and stochastic simulations based on the corresponding heuristic cme, are generally in quantitative disagreement with the results of the sslna and of stochastic simulations of the full network, even if the volume is very large. for example, for the case k1=5×10− <dig> and Θ=1/ <dig>  the cvs and ffs from the hlna are approximately  <dig> and  <dig> times smaller, respectively, than the prediction of the sslna. in figure
4c we also illustrate the large differences which these statistics imply, by showing sample paths  of the cme of the full network, of the heuristic cme and of the langevin equation given by the sslna, equation . this confirms that:  the hlna and, hence, the heuristic cme on which it is based, predicts the correct mean concentrations but incorrect noise statistics even if the molecule numbers are considerably large;  the langevin equation obtained from the sslna is a viable accurate simulation alternative to ssa simulations based on the heuristic cme.

besides quantitative disagreement we also note that the qualitative dependence of the ffs and the cvs with Θ as predicted by the heuristic approach is also very different than the predictions of the sslna and stochastic simulations with the full network. for example, for the case k1=5×10− <dig>  according to stochastic simulations of the full network and the sslna, the ffs reaches a maximum at Θ=1/ <dig>  whereas the heuristic approach predicts a monotonic increase of the ffswith Θ. the case Θ< <dig> is particularly interesting because the sslna and stochastic simulations of the full network lead to Ωffswhich is much greater than  <dig>  whereas the heuristic approach predicts Ωffs which is below  <dig>  hence, for Θ< <dig> , the sslna correctly predicts the fluctuations to be super-poissonian, i.e., the size of the fluctuations is larger than those of a poissonian with the same mean number of substrate molecules, whereas the hlna incorrectly predicts the opposite case of sub-poissonian fluctuations.

the power spectrum for the substrate fluctuations has also been calculated . although there is some quantitative disagreement between the predictions of the sslna and hlna both are in qualitative agreement: the spectrum is monotonic in the frequency and hence no noise-induced oscillations are possible by this mechanism. more generally, it can be shown that the spectra of the hlna and sslna are in qualitative agreement for all full networks with at most one slow species because as can be deduced from equation , for such networks, the spectrum for a single species chemical system is invariably monotonic in the frequency.

application ii: a gene network with negative feedback
finally, we study an example of a gene network with autoregulatory negative feedback. such a feedback mechanism is ubiquitous in biology appearing in such diverse contexts as metabolism
 <cit> , signaling
 <cit> , somitogenesis
 <cit>  and circadian clocks
 <cit> . two reasons hypothesized for its widespread occurance are that  it supresses the size of intrinsic noise
 <cit>  thereby providing enhanced stability and  it can lead to concentration oscillations or rhythms which are crucial to the control of several aspects of cell physiology
 <cit> .

we consider the following prototypical gene network. for convenience, we divide the network into two parts:  the set of reactions which describe transcription, translation and degradation, and  the set of reactions which constitute the negative feedback loop. the first part is described by the reactions 

  g→k0g+m,m→ksp+m,p+e⇌k−3k3ep→k4e,m→kdm∅. 

the mrna, m, is produced by transcription from a single gene g, and it is translated into protein p which subsequently is degraded via an enzymatic reaction catalyzed by enzyme e. the mrna can furthermore decay into an inactive form spontaneously. in addition, we have a negative feedback loop described by the reactions 

  p+g⇌k−1k1gp,p+gp⇌k−2k2gp <dig> gp→k0gp+m. 

note that the gene with two bound proteins is inactive, in the sense that it does not lead to mrna production. this implies that sudden increases in protein concentration lead to a decrease in mrna transcription which eventually results in a lowered protein concentration; this is the negative feedback or auto-inhibitory mechanism. the reaction network as given by reaction schemes  and  is our full network for this example. note that the first two reactions in reaction scheme  are not in reality elementary chemical reactions but they are the simplest accepted forms of modeling the complex processes of transcription and translation and hence it is in this spirit that we include them in our full network description.

deterministic analysis and coarse-grained network
model reduction on the macroscopic level proceeds by applying the deterministic qssa to the res of the full network . the fast species are the enzyme, e, the enzyme complex, ep, and the gene species in its various non-complexed and complexed forms g, gp and gp <dig>  the slow species are the mrna, m, and the protein, p. furthermore, we also impose the limit k2→∞, k1→ <dig> at constant k2k1; this enforces cooperative behavior since the binding of p to g is quite slow but once it occurs the next binding of p to the complex gp is very quick. the resultant reduced res are given by 

  ddt=k0gtk2k2+2−kdm,ddt=ks−k4etkm+, 

where k2=k−1k−2/k1k <dig> 
km=k−3+k4/k <dig> 
et is the total enzyme concentration and
gt is the total gene concentration. the model reduction process just described is illustrated in figure
 <dig> 

stochastic analysis of the coarse-grained network: sslna and hlna methods
we denote ηs,1and ηs, <dig> as the fluctuations about the concentrations of mrna and of protein, respectively. the sslna leads to reduced langevin equations of the form 

  ddtηs,1=j11ηs,1+j12ηs,2+Ω−1/2×k0Γ1+k0Γ2−p1k1Γ3+p1k−1Γ4−kdmΓ <dig> ddtηs,2=j21ηs,1+j22ηs,2+Ω−1/2×ksΓ8−k3Γ9+k−3Γ10−qk4Γ <dig>  

where Γi is the noise contributed by reaction number i and the reactions are numbered according to the order: g→g + m, gp→gp + m, p + g→gp, gp→p + g, p + gp→gp <dig>  gp2→p + gp, m→∅, m→m + p, p + e→ep, ep→p + e, and ep→e. the element jij denotes the i-jentry of the jacobian j of the reduced res . furthermore, the parameters p <dig> and q are given by 

  p1=k0k1k2+ <dig>  

  q=+k3+km, 

where k3=k−3/k <dig>  note that the coupled langevin equations  imply that the fluctuations in the mrna and protein concentrations are affected by noise from all of the  <dig> constituent reactions of the full network  and ) except from those of the reversible reaction p + gp⇌gp <dig>  as shown in the methods section, the noise from this reaction becomes zero due to the imposition of cooperative behavior in the feedback loop.

the covariance matrix for the fluctuations of the langevin equations  is given by the lyapunov equation  with jacobian being equal to that of the reduced res  and diffusion matrix dh replaced by dss, which is given by 

  dss=Ω−1diagdm,dp,dm=kdm+k0gtk2k2+2+p12k0gtk22k2+ <dig> dp=ks+k4etkm+−2k4et2km+ <dig>  

it is also possible to calculate the covariance matrix of the fluctuations of the slow variables using the hlna . this is given by a lyapunov equation  with jacobian being equal to that of the reduced res  and diffusion matrix dh given by 

  dh=Ω−1diagdh,m,dh,p,dh,m=kdm+k0gtk2k2+ <dig> dh,p=ks+k4etkm+. 

a comparison of equation  and equation  shows that the sslna and hlna are generally different except in the limits of p1→ <dig> and q→ <dig>  from the langevin equations  we see that setting p1= <dig> implies ignoring the noise due to the reversible reaction p + g⇌gp, while setting q= <dig> is equivalent to ignoring the noise from the reversible reaction p + e⇌ep. hence, as for the previous example of enzyme kinetics, we can state that the hlna and the heuristic cme upon which it rests, implicitly  assume that under conditions of timescale separation, the reversible reactions involving the fast species do not contribute to the intrinsic noise in the slow species.

furthermore, by the comparison of equations  and , one can also deduce that the heuristic cme provides a statistically correct description when the protein concentration  is either very small or very large, in other words the case of very weak or very strong transcriptional repression .

detailed comparison of the noise statistics from the sslna and hlna
figure
 <dig> shows the sslna and hlna predictions for the coefficient of variation squared and the fano factor of the protein fluctuations as a function of the transcription rate k <dig>  these are obtained by solving the two lyapunov equations mentioned in the previous subsection for the covariance matrix; the variances are then the diagonal elements of this matrix, from which one finally calculates the fano factors and the coefficients of variation. the values of rate constants are chosen such that we have timescale separation conditions . from figure
 <dig> we can see that under such conditions, the sslna predictions agree very well with the stochastic simulations of the full network but the hlna exhibits considerable quantitative and qualitative differences compared to the latter simulations. in particular, note that for k3= <dig> and k0> <dig>  the predictions of the sslna are approximately  <dig> orders of magnitude larger than those of the hlna .
gt= <dig> ,
et= <dig>  k1=10− <dig>  k2= <dig>  k−1=k−2=k−3= <dig>  k4=ks=kdm= <dig>  stochastic simulations of the full networks  and of the coarse-grained network  using the cme and the heuristic cme, respectively, were performed for a volume of Ω= <dig>  note that at this volume there is one gene and  <dig> enzyme molecules. note also that the chosen parameters guarantee timescale separation  and cooperative behavior in the feedback loop 
7; the value of k0is  <dig>  the excellent agreement between the two re solutions, implies timescale separation conditions

finally, we investigate the differences between the predictions of the sslna and hlna for noise-induced oscillations in the mrna concentrations. these are oscillations which are predicted by cme based approaches but not captured by re approaches. in particular, these noise-induced oscillations occur in regions of parameter space where the res predict a stable steady-state
 <cit> . calculation of the power spectra is key to the detection of these noise-induced oscillations: a peak in the spectrum indicates a noise-induced oscillation. for the hlna this is given by equation  with jacobian being equal to that of the reduced res, equation , and diffusion matrix dh given by equation . for the sslna this is given by equation  with jacobian being equal to that of the reduced res, equation , and diffusion matrix dh replaced by dss, which is given by equation . since the two diffusion matrices dh and dss are not generally equal to each other we expect the spectra calculated according to the sslna and hlna to differ. indeed we find  <dig> possible scenarios: both spectra do not have a peak in frequency , both spectra have a peak in frequency  and the most interesting case where the sslna spectrum exhibits a peak but the hlna does not predict one. the results are summarized in figure
 <dig>  where we show the regions of parameter space in which each of these scenarios occur and a comparison of the power spectra as predicted by the hlna and sslna in these regions. note that in all cases the hlna  agrees with stochastic simulations of the coarse-grained network using the heuristic cme , while the sslna  agrees with stochastic simulations of the full network  under conditions of timescale separation. the hlna and sslna spectra are only in good quantitative agreement in a very small region of parameter space , where both do predict noise-induced oscillations.
et= <dig> ,
gt=1/Ω and kdm= <dig> , k1= <dig> , k−1= <dig>  k2= <dig>  k−2= <dig>  k−3= <dig>  k3= <dig> , k4= <dig>  these parameters guarantee timescale separation  and cooperative behavior in the feedback loop. note that the hlna spectrum in  and  is scaled up  <dig> and  <dig> times, respectively

we emphasize that the main message brought by our analysis is that there are significantly large regions of parameter space , where the hlna  does not predict noise-induced oscillations but such oscillations are obtained from stochastic simulations of the full network as well as being captured by the sslna.

qualitative discrepancies in the prediction of noise-induced oscillations arise because the hlna does not correctly take into account the fluctuations stemming from the rate limiting step of the cooperative binding mechanism. the latter involves the slow binding reaction between a protein molecule p and a gene g leading to a complex gp. the reason for this is the hlna’s tacit assumption that the fast species are not involved in slow reactions. this rate limiting reaction is at the heart of the negative feedback loop that is responsible for concentration oscillations in many biological networks such as circadian clocks
 <cit>  and hence why we speculate that the hlna misses the occurrence of noise-induced oscillations in certain regions of parameter space.

discussion and 
CONCLUSIONS
concluding, in this article we have rigorously derived in closed-form, linear langevin equations which describe the noise statistics of the fluctuations about the deterministic concentrations as predicted by the reduced res obtained from the deterministic qssa. equivalently, the sslna, as the method was called, is the statistically correct description of biochemical networks under conditions of timescale separation and sufficiently large molecule numbers. we note that our method provides an accurate means of performing stochastic simulation in such conditions. this is particularly relevant since it has been proven that there is generally no reduced cme description in such cases
 <cit> . another advantage of the sslna is that it enables quick computation of noise statistics through the solution of a set of simultaneous, deterministic linear algebraic equations. by applying the sslna to two biologically relevant networks, we showed that this procedure can lead to particularly simple and compact expressions for the noise statistics, which are in very good numerical agreement with stochastic simulations of the cme of the full network under the above conditions. this is in contrast to the heuristic cme, which generally performed with poor accuracy and in some instances even missed the prediction of noise-induced oscillations.

the limitations of the sslna are precisely those of the conventional lna on which it is based. namely, if the system is composed of at least one bimolecular reaction, then it is valid for large enough molecule numbers  and provided the biochemical network is monostable. if the system is purely composed of first-order reactions and if one is only interested in variance and power spectra, then the only requirement is that of monostability. this is since in such a case it is well known that the first and second moments are exactly given by the lna. for monostable systems with bimolecular reactions, the finite-volume corrections to the lna can be considerable when the network has implicit conservation laws, when bursty phenomena are at play and when steady-states are characterized by few tens or hundreds of molecules
 <cit> . these problems probably become exacerbated when the network is bistable or possesses absorbing states
 <cit> . hence, it is clear that although the sslna presented in this article is valid for a considerable number of biologically interesting cases, it cannot be homogeneously applied to all intracellular reaction networks of interest. these require the development of methods beyond those presented in this article and hence present an interesting research challenge for the future.

a necessary and sufficient condition for timescale separation is that the timescales governing the decay of the transients in the average concentrations are well separated. fast species are those whose transients decay on fast timescales while the slow species are those whose transients decay on slow timescales. at the microscopic level, there are several different scenarios which can lead to timescale separation. grouping chemical reactions as fast or slow according to the relative size of their associated timescales, pahlajani et al. <cit>  obtain timescale separation by defining fast species as those which are involved in fast reactions only and slow species as those involved in slow reactions only. zeron and santillan
 <cit>  use a similar but less restrictive approach whereby the fast species are involved in fast reactions only and the slow species can participate in both fast and slow reactions. another method is that due to cao et al. <cit>  who define slow species as those involved in slow reactions only and fast species as those participating in at least one fast reaction and any number of slow reactions. while the three aforementioned scenarios will lead to timescale separation, it must be emphasized that they only constitute a subset of the possible scenarios leading to such conditions. the derivation behind the sslna is not based on any particular microscopic scenario, rather it simply requires that the timescales of the transients in the average macroscopic concentrations are well separated. hence it follows that in the limit of large molecule numbers, the methods developed in
 <cit>  cover only a sub-space of the parameter space over which timescale separation is valid. in the methods section we indeed show that pahlajani’s approach
 <cit>  leads to a reduced linear langevin equation which is a special case of the sslna, the case where the matrix b in equation  can be neglected. the approaches of zeron and santillan
 <cit>  and of cao et al. <cit>  lead to a reduced cme description. as we have shown in the results section, under conditions of timescale separation and for small intrinsic noise, there always exists a reduced linear langevin description of monostable stochastic reaction networks  but there is generally not a physically meaningful reduced master equation description. the latter is only obtained if one imposes stronger conditions.

these results are in line with those of mastny et al. <cit>  which show that for the michaelis-menten reaction without substrate input, the sqspa method, a rigorous singular-perturbation approach, leads to a reduced master equation whenever the free enzyme or complex concentrations are very small . this equation has the same form as the heuristic cme. this implies that for such conditions the error in the predictions of the heuristic cme should be zero, a result which is reproduced by the sslna . however, note that though these concentration conditions can be compatible with the deterministic qssa they are not synonymous with it. generally, the sqspa methods do not lead to a reduced stochastic description consistent with the deterministic qssa over the whole parameter space, whereas the sslna does, albeit within the constraints that molecule numbers should not be too small and that the network is monostable.

finally we consider the approach of shahrezaei and swain
 <cit> , who derived the probability distribution for a linear two-stage model of gene expression under conditions of timescale separation. their method rests on an exact solution of the generating function equation corresponding to the cme in the limit that the protein lifetime is much greater than that of the mrna. in the methods section we show that the sslna applied to their example leads to the same variance as obtained from their reduced probability distribution. the upside of their method over the sslna is that they obtain the full probability distribution valid for all molecule numbers. the downside of their method is that the generating function equation can only be solved exactly for networks composed of first-order processes  or very simple bimolecular reactions
 <cit>  and hence the method has a restricted range of applicability compared to the sslna.

while the stochastic simulation algorithm explicitly simulates every individual reaction event, the langevin approach yields approximate stochastic differential equations for the molecular populations. this is computationally advantageous whenever the reactant populations are quite large
 <cit> . this reasoning can be deduced from the relationship between the propensities and the microscopic rate functions as given by
aj=Ωf^j. it is well known that in the large population number limit, the vector
n→/Ω is approximately equal to the vector of macroscopic concentrations and hence the magnitude of the propensities increases with the reaction volume or equivalently with molecule numbers. in particular, this implies that the time between consecutive reaction events, given by
τ=−−1ln where r∈ is a uniform random number, decreases with increasing reaction volume. this means that the time spent by the stochastic simulation algorithm increases with increasing volume because more reaction events have to be resolved within the same time window. given this reasoning we can compare the discussed methods in terms of speed and accuracy. the computation time of the langevin methods, hlna and sslna, is independent of the volume and hence if the molecule numbers are not too small, both methods are much quicker than simulating any reduced cme of the coarse-grained network or the cme of the full network. however the sslna enjoys the additional advantage that under conditions of timescale separation, it is as accurate as the cme of the full network. the same argument does not generally hold for the hlna.

we emphasize that besides deriving the sslna method, in this paper we have used it to determine the range of validity of the conventional heuristic cme approach and the size of errors in its predictions. to our knowledge, this is the first study which attempts to answer these important and timely questions via a rigorous, systematic theoretical approach.

our main message is that, the “conventional wisdom” that the heuristic cme is generally a good approximation to the cme of the full network under conditions of timescale separation is incorrect, if one is interested in intrinsic noise statistics and the prediction of noise-induced oscillations.

