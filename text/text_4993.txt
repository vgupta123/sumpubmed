BACKGROUND
body water is distributed between the intracellular fluid  and the extracellular fluid  compartments , whose volume depends on the osmotic pressure exerted by their electrolyte composition. due to the selective permeability of biological membranes, sodium  and accompanying anions are mostly restricted to the ecf compartment, while potassium  is confined to the icf compartment. therefore, these two ions are the effective electrolytes creating the osmotic pressure and affecting the movement of water between the two body water compartments. in mammals, the maintenance of osmotic pressure is crucial for the integrity of the cells and organs and small variations from a stable set-point trigger compensatory responses to restore the body fluid osmolality. these homeostatic responses mainly control the retention of water and na+ at the level of the kidneys  <cit> , as well as fluid and na+ ingestive behaviors  <cit> . for instance, plasma hyperosmolality triggers rapid homeostatic responses like vasopressin  secretion, an increased rate of natriuresis and the sensation of thirst  <cit> .

the simultaneous quantification of the ecf osmolality and resulting homeostatic responses at a high temporal resolution would be difficult to measure and study experimentally and one approach would be to design a realistic computational model aimed at simulating the dynamics of the biological parameters under study. this model does not have to be necessarily as complex as the biological function it simulates  <cit> . however, it should include the essential measurable inputs and outputs and connect them in a manner that carries out the processing that occurs, here the secretion of avp and the adjustment of the ecf osmolality. in this line, the present model of the hydromineral homeostasis is organized around three distinct systems that define the scope of the simulation:  the current state of the icf and ecf compartment in terms of ion composition and volume;  the input/output to the body fluid compartments in terms of regulated and unregulated water and na+ intake or loss, respectively and  the controllers that specifically regulate water and na+ excretion at the level of the kidneys. note that some of the biological parameters that characterize each of the systems rely on necessary assumptions that are presented in the methods .

the modeling principle is based on the use of "high-level" functions, i.e., a black-box approach to model the components of each system. such a modeling approach uses necessary simplifications of the model and does not therefore implement all the complex cascade of hormones and/or cellular mechanisms underlying the output of the black boxes. for instance, the model includes the "aldosterone  controller" and the "atrial natriuretic peptides  controller", which add to the model the capacity to respond to a certain degree of hypovolemia and hypervolemia, respectively by modulating na+ excretion. the secretion of ald and anps is multifactorial and depends on the action of other hormones like angiotensin ii and oxytocin  <cit> . however, considering the experimental data on ald and anps will indirectly include the regulatory action of angiotensin ii and oxytocin in this high-level model without a direct implementation of the regulatory action of these hormones in the model. moreover, the experimental data on ald, anps and avp introduce in the model the relationship that links the secretion of these hormones to the ecf volume without the need of implementing a complex system of blood pressure control.

the purpose of the present study was to develop a computational simulation of the dynamics of the ecf osmolality and vasopressin release under stable hydromineral condition, as well as during osmotic challenges.

methods
biological parameters
the present model will specifically be developed for rats since this animal species has historically provided much of the data in the field of the hydromineral homeostasis.

all of the initial values for the biological parameters used in the simulation were compiled from published experimental data and are presented in table  <dig>  biological parameters are tightly correlated with the animal's weight. however, a simple linear scaling of the parameters extracted from the literature may be biased by physiopathological condition of the animals under study. for example, obese rats have an expanded skin surface compared to lean rats, a condition that directly affects the amount of water lost by evaporation. in the same line, the amount of metabolic water resulting from the ingested food in obese rats is larger than in lean rats  <cit> . therefore, to minimize the introduction of conversion error in the model, the rat's weight was fixed at  <dig> g, a value that is well within the range of weights reported in the experimental studies referenced. moreover, data were selected from studies using rats in the same age range because aging directly affects the water balance of rats  <cit> .

the values identified with a star  were defined by fine-tuning the simulation within the range of the data reported in the literature.  indicates the initial set of the parameter to start the simulation. the value of all these time-dependent parameters is updated every minute during the simulation.

software
the simulation is performed using scicos, a dynamical system simulator included in the scilab software http://www.scilab.org. scilab is an open source software that is equivalent to matlab, the leading software in scientific computing . scicos has a graphical user interface  that is particularly useful for our task of modeling a complex system and the flexibility of the software allows easy substitution of a standard box by a function coded in a different programming language . the simulation has a time resolution of one minute implying that time-dependent parameters are updated every minute according to the current state.

the model architecture
the "high-level" simulation is organized around three functional systems:  the current state of the body fluid compartments,  the controllers specifically acting at the level of the kidneys and  the inputs/outputs of the body fluid compartments. for the implementation of the model in the computer simulation, each system is represented by one or several black boxes, called meta-boxes. the system "current state of the body fluid compartments" is composed of one meta-box called "body fluids". the system "inputs/outputs of the body fluid compartments" is composed of four meta-boxes called "kidney", "digestive system", "unregulated water balance" and "hydromineral challenges". finally, the system "controllers" is composed of one meta-box called "avp secreting magnocellular neurons" and additional corrections for active natriuresis and/or na+ retention. in addition, the simulation includes a timing generator  and two boxes that summate the sodium changes and the water changes, respectively. figure  <dig> illustrates a screenshot of scicos' main window, displaying the architecture of the simulation described above. the content of all the meta-boxes are detailed in the following sections

system 1; the meta-box "body fluids"
the body fluids are distributed between the icf and the ecf compartments. the solute composition of each compartment differs considerably: na+ is the major cation in the ecf, whereas k+ is dominant in the icf. in the present simulation we simplified the ecf compartment by merging together the vascular space and the interstitial fluid because the time course describing na+ exchange between these two distinct spaces is below one minute  <cit> , the time resolution of the simulation. the icf k+ concentration  is set as a non-variable parameter in the simulation  <cit> . this assumption was initially chosen because the large volume of the icf compartment prevents dramatic changes in the . in addition, regulation of  was considered less critical for the integrity of the organism than regulation of   <cit> . therefore, time-dependent changes in icf volume in the simulation result from water movement driven by changes in ecf .

the ecf  was preferred over the ecf osmotic pressure because osmotic pressure depends on additional parameters including the level of sugars, proteins and urea. however, a correction was included in the simulation to account for the osmotic weight of these parameters .

altogether, the body-fluid compartments are simulated by a meta-box that dynamically integrates three biological parameters:  the ecf volume,  the ecf  and  the icf volume. the physiological set-point of these parameters is indicated in table  <dig> 

system 2; the meta-box "avp secreting magnocellular neurons"
this meta-box is the main controller of the simulation. it simulates the regulation of avp concentration in the plasma and it contains three items:  a mathematical equation adjusting the avp concentration as a function of the ecf osmolality,  a time-dependent degradation of avp and  a circadian modulation of avp secretion.

 the mathematical equation was created using experimental measurement from dunn et al.,  <dig>  in this paper and other reports, it is shown that the avp level is a linear function of the plasma osmolality and an exponential function of the volume  <cit> . in addition, a correction was included in the equation to reflect the volume-dependent change in the slope of avp secretion reported in the experimental data. using a linear regression based on figure six of dunn et al. , the correction term of the slope was set at  <dig>  the ecf  in the equation was also corrected for the contribution of sugar, proteins and urea to plasma osmolality according to the approximation stated in verbalis,  <dig>  but using the values for the rat   <cit> . the resulting avp level is calculated using the following equation:

  =ecfv)⋅]− <dig> ))+ <dig> ⋅e−17⋅ecfΔvecfv 

all symbols are defined in table  <dig>  the delta  symbol denotes the difference between the current state in the simulation and the initial state defined in table  <dig>  all the numerical values are based on the fits of the experimental data reported in dunn et al. . since a negative value for hormone secretion is meaningless, we avoid non-physiological values by allowing "ecfΔv" to be strictly negative  in the equation and by forcing avp level to be positive . note that the change in avp secretion caused by osmotic fluctuation is larger than the change caused by volume fluctuation .

 a time-dependent degradation of avp was added to the model so that 15% of circulating avp is cleared every minute when avp secretion is reduced  <cit>  .

 a circadian pattern of avp secretion is also included in the model. this implementation was derived from data presented in figure one of graugaard-jensen et al. . thus, the total avp concentration is linearly reduced at a speed of 5%/h starting at  <dig> am to reach a maximum of 30% reduction at  <dig> am. then, the negative modulation of avp secretion is progressively inactivated from  <dig> am to  <dig> am before being controlled by the current state of the ecf  .

system 3; the meta-box "kidney"
this meta-box is designed to dynamically simulate the rate of urine flow and the rate of na+ excretion by the kidneys .

the rate of urine flow is calculated every minute in the simulation. the calculation is adapted from an equation that expresses the rate of urine flow as a function of avp in humans  <cit> . here, the basal avp level was linearly rescaled from  <dig> pg/ml  to  <dig>  pg/ml . the rate of urine flow was also scaled so that the flow caused by  <dig>  pg/ml of avp corresponds to  <dig> μl/min/ <dig> g of body weight . this value corresponds to the normal rate of urine flow in the rat  <cit> . the maximum rate of urine flow, in the absence of avp, was fixed at  <dig> μl/min/ <dig> g bw that corresponds to  <dig> ml/day/ <dig> g bw  <cit> .

the value of na+ clearance used in the model  was calculated from experimental data reported in four distinct studies  <cit>  and calculations are presented in additional file  <dig>  na+ clearance combined with the action of the avp controller are however, not sufficient to overcome the small variations in ecf volume resulting from the change in ecf osmolality . we thus, implement two additional controllers in the model to introduce a volume-dependent change in na+ excretion  or in na+ retention. these active controllers will be referred to as the atrial natriuretic peptides  factor and as the aldosterone  factor, respectively. anpfactor is a multiplicative factor  on na+ excretion that accounts for an increase in ecf volume over the volume set-point . aldfactor is a multiplicative factor  on na+ excretion that accounts for a decrease in ecf volume below the volume set-point.

the rate of na+ excretion is calculated every minute with the following equation:

  naurine+=⋅cna+⋅aldfactor⋅anpfactor 

na+urine refers to the millimoles of na+ excreted during the current minute of the simulation.  is the ecf  one minute before the current minute. cna+ is the na+ clearance defined in table  <dig> 

anpfactor was calculated from paul et al.  in two separated steps:  the plasma anp concentration was first computed as a function of the expansion of the plasma volume  and a linear interpolation was added between the experimental values. the maximum anp level was set to  <dig> pg/ml  to prevent a non-linear error in case of large volume changes.  the increase  in natriuresis was associated with the plasma anp concentration  and this percentage is used as the anpfactor.

aldfactor was based from two studies  <cit> . figure oneb of stricker et al.  was first adapted to express the aldosterone concentration as a function of the ecf volume instead of the plasma volume. the study of morris et al.  was then adapted to compute aldfactor as a function of the aldosterone concentration. here the dose of aldosterone  was converted to aldosterone concentration by dividing the dose by the volume of plasma. moreover, a linear interpolation including an aldfactor with an upper limit of  <dig>  and a lower limit of  <dig>   was introduced to the conversion of the experimental data.

system 3; the meta-box "digestive system"
this meta-box is created to simulate water and na+ intake. it contains a digestive module and a motivation module making this meta-box the most complex of the model. the "digestive module" simulates the transition of orally ingested water from the stomach to the intestine and its final absorption in the ecf. this module reproduces the intestine and stomach modules generated by toates et al. , which was based on experimental data from two studies  <cit> . our model includes the same time constants for  the active and passive exchange of water and na+ between the stomach, intestine and ecf, and  the emptying of water content from the stomach to the intestine.

the motivation module takes the decision of drinking distilled water or na+-containing water. these decisions are based on two simple rules that are sufficient to reproduce realistic behavior.

rule 1: if ecf  exceeds the pre-established set-point by a threshold of 4%  <cit> , the motivation module allows intake of distilled water until the ecf  is restored, or until the stomach is full . in the latter case, water intake stops until the stomach volume is reduced to a comfortable level  by emptying water into the intestines and by passive diffusion to the ecf.

rule 2: if ecf  is normal  or slightly lower, the motivation module allows intake of na+-containing water  to model unregulated drinking  <cit> . in the simulation, unregulated drinking is triggered randomly following a statistical distribution, which is a translated sinusoidal to account for the circadian modulation of fluid and electrolyte intake.

there is no access to dry food in the model and the introduction of na+-containing water compensates for the lack of this essential source of na+. the amount of na+ contained in the water is adjusted to approximately match the daily amount of na+ ingested by a rat of  <dig> g fed with regular pellets . instead of randomly injecting na+ in the model, the sodium input is associated with water input since in reality the feeding and drinking period are associated in rat.

system 3; the box "unregulated water balance"
this box includes a constant factor that accounts for the balance between the loss of water in sweat  and feces  versus water gained from eating food  and metabolic processes . reference values were obtained from  <cit>  and were linearly scaled for a rat of  <dig> g. in the simulation, the water balance is negative  implying that the gain of water from food and metabolic process is not sufficient to offset the loss of water from sweat and feces. therefore, the water intake through drinking has to overpass the urine volume to prevent the loss of body fluid.

system 3; the meta-box "hydromineral challenges"
this box contains two distinct hydromineral challenges that can be switched on during the simulation. all of the virtual challenges occur during the sleeping period of the rat, a period during which most of the experimental protocols are performed in laboratories. simulation of hydromineral challenges, inducing either intracellular or extracellular dehydration, are intended to predict changes in the ecf  and volume, in the icf volume as well as the changes in avp secretion.

challenge 1: intracellular dehydration
this virtual challenge simulates the effect of a short-term  jugular injection of  <dig> mmole na+. this injection of na+ per se  was intended to mimic a rise in extracellular osmolality creating an intracellular dehydration. this challenge evokes avp secretion and osmotic thirst leading to water intake.

challenge 2: extracellular dehydration
this challenge simulates the effect of a loop diuretic  that is known to induce a rapid urinary loss of na+ and water. the resulting loss of fluid stimulates avp secretion and hypovolemic thirst leading to water and salt intake. the effects of furosemide were simulated by substituting the regular kidney output of the model  by a computed furosemide output. this specific output consisting of a modified urine flow rate and  induced by the furosemide injections were calculated from two studies reporting the dynamics of these parameters after furosemide treatment  <cit> . linear interpolation of the data illustrated in figure one in kikkoji et al.  and in figure one in hori et al.  served to calculate the urine flow rate and , respectively.

experimental measurements
experiments were carried out according to the recommendations of the canadian council on animal care and approved by the ethical committee on animal research of the université laval.

experimental data were collected from  <dig> male wistar rats  to validate the predictive results obtained with the simulation of extracellular dehydration . the experimental protocol combines two subcutaneous injections of furosemide  and a na+ deficient diet  that extends over  <dig> h. figure  <dig> illustrates the timeline of the experimental protocol where time  <dig> in the experimental protocol corresponds to  <dig> am in the simulation. during the first  <dig> h, the rats were housed individually in metabolic cages without access to water and food. at time  <dig> , the rats received the first furosemide injection, followed by the second injection  <dig> h later . at time  <dig> h , urine was collected and the urine volume was measured. the rats were housed individually in regular plastic cages where they had access to tap water  and to na+ deficient food for  <dig> h. in the simulation the rat did not have access to food and the lack of this na+ source was compensated by water containing na+. the na+ content was adjusted to match the amount of na+ ingested during exposure to the na+ deficient food .

RESULTS
the following section presents the computed predictions of the dynamics of six parameters of interest: the body fluid compartments , the avp level and the water intake and excretion under balanced hydromineral conditions  and during two evoked hydromineral challenges.

computed predictions under control hydromineral conditions
here, the control conditions refer to a rat being active during the night and sleeping during the day. the rat has free access to water and sodium by bouts, randomly and mostly distributed during the night. these control conditions in our simulation are not "steady-state" simulation. indeed constant inputs and outputs do not represent physiological conditions for a rat . the simulation under control conditions quantifies the mean level of the six parameters of interest for  <dig> h, over a period of  <dig> consecutive days. the mean and standard deviation of each parameter over that long-term simulation are presented in table  <dig>  note that the predicted ecf , ecf and icf volume remain stable over the long-term simulation and agree with the physiological expectations. beyond these global data, the simulation predicts significant differences between the sleeping period  and the waking period  of the rat over the period of  <dig> consecutive days. the low probability of unregulated drinking that occurs during the sleeping period is correlated with a weak cumulative water intake  and a moderate increase  in ecf . indeed, the predicted maximal ecf  for this period is  <dig> ±  <dig> mmol/l compared to the daily mean ecf  that includes both the sleeping and the waking period . the predicted ecf volume  reaches a minimum of  <dig> ±  <dig> ml  and the icf volume  shows a minimum of  <dig> ±  <dig> ml during the sleeping period. these changes are correlated with a progressive increase in avp, which reaches a maximal level of  <dig> ±  <dig> pg/ml compared to the daily mean avp level of  <dig> ±  <dig> pg/ml . during the sleeping period, the urine flow is reduced from  <dig>  ±  <dig>  ml/min  to  <dig>  ±  <dig>  ml/min  and the urine  is increased from  <dig> ±  <dig> mmol/l  to  <dig> ±  <dig> mmol/l 

daily mean and standard deviation of each parameter are obtained after  <dig> consecutive days of simulation under control conditions. all the predictions are coherent with experimental data reported in the literature according to their deviations. some experimental data had to be normalized for comparison. the "**" symbol indicates that the value was obtained by subtracting the icf or ecf volume of the model from the total water content of the rat measured experimentally.

interestingly, the high resolution of the long-term simulation  allows an instantaneous average of each parameter value over the period of the simulation . this average reduces the inter-day fluctuation of the parameters and highlights the overall trend of the circadian dynamic of the parameters . it clearly indicates that waking period is split into two distinct phases defined here as the restoration phase and the maintenance phase. the onset of the restoration phase corresponds to the peak of avp level  and to the maxima of ecf  . the simulation predicts that restoration of avp concentration  requires cumulative water absorption of approximately  <dig> ml  and has a duration of approximately  <dig> h. the maintenance phase follows the restoration phase. the onset of this phase corresponds to the time point at which the current avp concentration is not significantly different from its steady-state concentration observed between  <dig> and  <dig> am. using the confidence interval of this period , the onset of the maintenance phase is set to  <dig>  pg/ml of avp . at the beginning of this phase the ecf  is restored to a value of  <dig> ±  <dig> mmol/l . the maintenance phase is essentially composed of unregulated drinking that reflects the mean na+ and water consumption expected for a rat of about  <dig> g. the maintenance phase is characterized by a weak variability of the avp level and a relative stability of the parameters of the body fluid compartment.

validation of the model by experimental data
it is essential to validate the predictions of the simulation produced under balanced hydromineral condition. this step is crucial to insure that the prediction of each parameter of interest over a period of  <dig> h agree with physiological expectations and are supported by published experimental data. however, these experimental data have to fulfill criteria for compatibility with the present model: they have to be sampled from adult animals and from rat strain that do not present physiopathological conditions . the animals have to be housed in regular laboratory conditions . table  <dig> summarizes the prediction of the mean and standard deviation of each parameter of the simulation tested over a period of  <dig> consecutive days and it presents experimental data collected from many studies, which are in agreement with the simulated parameters.

in addition to the validation of the daily means over a long-term simulation, it is important to validate the high-resolution  dynamic of the simulation. the lack of experimental data approaching the present temporal resolution is critical. however, few studies did collect data with a high enough resolution to validate the simulated dynamics  <cit> . additional file  <dig> compares the dynamics of the water intake , urine volume  and avp concentration  with these experimental data. the goodness of fit of our simulated parameters was considered satisfactory if the mean of the experimental data is included within the standard deviation of the simulated parameter for  <dig> h. additional file  <dig> indicates that the simulated dynamic of water intake, urine volume and avp concentration are in agreement with published experimental data measuring these three parameters at several time points during  <dig> h.

role of early water intake in reducing variability of ecf  and circulating avp level
data summarized in table  <dig> highlight the presence of large daily fluctuation in fluid and electrolyte intake over the long-term . these differences mainly depend on the frequency and distribution of unregulated drinking in the simulation  and illustrate the random nature of the daily fluid and electrolyte consumption of the rat. here the simulation tested the influence of this random consumption on the level and dynamic of the ecf  and avp for a period of  <dig> h. the occurrence of a single additional drinking bout  at the onset of the sleeping period  delays the increase in ecf  , compared to the absence of additional drinking bout . in this example, the additional drinking bout reduces the circulating level of avp by about  <dig> pg/ml  and shortly delays the onset of the maintenance phase . the fluctuation of both the ecf and icf volume are also attenuated . these predictions highlight the high sensibility of the system to random daily fluctuation in the frequency and distribution of drinking bout.

role of the icf compartment in reducing variability of ecf  and circulating avp level
the long-term simulation predicts a circadian fluctuation in icf volume, likely indicating a putative role of the icf compartment in stabilizing the ecf . in order to validate that hypothesis, we simulated a lack of water transfer between the icf and ecf fluid compartments for a period of  <dig> h . interestingly, this test predicts a sharp increase in ecf  during the sleeping period that rapidly exceeds the threshold for drinking  and triggers water intake . moreover, the occurrence of sharp rise in ecf  over the threshold is also increased, triggering additional need-induced water intake to restore ecf  . the simulation also predicts increased avp level fluctuation  that contributes to attenuate fluctuation in ecf . it also appears from this prediction that drinking bouts occurring at the end of the sleeping period and during the waking period  trigger fluctuation of larger amplitude in the ecf   and circulating avp level . the water intake needed to compensate for the lack of icf water transfer is approximately  <dig> ml over a period of  <dig> h, representing 19% of the daily water intake. the fluctuations in ecf , circulating avp level and drinking bouts are greatly attenuated when the icf compartment is included in the simulation , emphasizing the buffer role of the icf compartment, working in synergy with circulating avp to maintain the stability of the ecf  and to lower the daily need of water intake.

the previous results demonstrate that this model of rat hydromineral homeostasis produces coherent predictions of the major parameters of the system under balanced hydromineral conditions indicating that all essential components are included in the model. the next series of simulations are intended to predict changes in these parameters in response to hydromineral challenges.

challenge 1: intracellular  dehydration
the challenge consists of injecting  <dig> mmol na+ over  <dig> minutes into the ecf compartment. the na+ infusion abruptly raises the ecf , creating a threatening hyperosmotic condition . the simulation indicates that the responses engaged to restore the ecf  level occur in two distinct phases contributing to an increase in the ecf volume . the first phase consists of a rapid transfer of water from the icf to the ecf compartment . the reduction in the icf compartment reaches 3% of its initial volume in a short interval, causing intracellular dehydration. na+ infusion also triggers an immediate rise in avp levels that is added to the initial increase resulting from the reduced probability of drinking during the sleeping period . the peak in avp  reduces the urine flow rate to optimize water conservation and lower the ecf . note that the rise in avp is concomitant to  <dig>  fold increased in urine na+ concentration . the second corrective phase consists of water absorption . this phase is shortly delayed and is engaged after the ecf  exceeds the pre-established threshold  and after the stomach starts exchanging water with the ecf and the intestine. the intake of distilled water also contributes to the increase in ecf volume and also acts to restore the icf volume. the rapid dilution of the extracellular na+ by exchanging water with the icf, by ingesting water and by increasing renal na+ excretion are responsible for the quick recovery of the ecf .

challenge 2: extracellular  dehydration
the challenge consists of two injections of furosemide without access to water during the first  <dig> h. that depletion period is followed by  <dig> h of a na+ deficient diet and ad libitum access to tap water. the challenge starts at  <dig> am  after one day of simulation under balanced hydromineral conditions . the  <dig> h pre-simulation is intended to generate hydromineral parameters that fluctuate slightly from their pre-established set-point. the dynamics of these parameters are presented in figure  <dig> as a control . note that cumulative urine volume and water intake at the onset of day  <dig> are thus, above  <dig> . as expected, furosemide injections rapidly increase the cumulative urine excretion by  <dig>  ml  decreasing the ecf volume by approximately 10% . avp shows a sharp and massive release  with a peak of  <dig>  pg/ml during the furosemide protocol. avp release reduces the urine flow rate to a minimum . interestingly, the simulation also predicts an increased ecf  of approximately 6%  due to the negative balance between water and na+ loss. note that the rise in  exceeds the threshold  and would have triggered drinking if water was available. the icf volume is simultaneously reduced by 5%  to buffer the increase in ecf . predictions of all the physiological parameters after  <dig> h of extracellular dehydration are summarized in table  <dig> and compared to the control day. the furosemide treatment induces mild hypovolemia and the simulation predicts water intake as soon as water is available . note the large water intake despite a low unregulated drinking probability during the sleeping period. the simulation predicts that water intake combined with the na+ deficient diet set after the injections progressively reduces the ecf  to  <dig> mmol/l , resulting in hyponatremia. the progressive decrease in ecf  is correlated with low level of anp and a high level of ald to minimize renal na+ excretion . moreover, water intake restores both the icf and ecf volume. however, if repletion of the ecf volume is completed by the end of day  <dig> , the simulation predicts an expansion of the icf volume . the overload of the icf compartment likely results from the predicted low ecf  causing an osmotic movement of water to the icf compartment. predictions of all of the physiological parameters after  <dig> h of sodium depletion are summarized in table  <dig>  in order to validate the simulation of the extracellular dehydration, predictions for two parameters were compared to measurements carried out on rats in the same range of weight . the experimental data indicate that ecf  measured at the end of the experimental protocol , as well as water intake measured  <dig> and  <dig> h after the start of the protocol  are all within the range of the predicted values.

predictions at different time-points  under control condition are listed under day  <dig> and predictions under na+ deficit are listed under day  <dig>  "*" indicates the amount of water ingested during the first  <dig> h after access to tap water .

discussion
the high temporal resolution of the graphical output of the simulation gives new insights into the hydromineral dynamic of the rat and allows the simulation to answer fundamental questions about the homeostatic parameters. the model integrates experimental data of different forms into specific meta-boxes to translate the biological realities into equations  or computational algorithms . here, we discuss some of the strategic choices we made while building our model.

assumptions on the inputs to the body fluid compartments
our model requires a "digestive module" sub-system to simulate the obligatory delays between fluid and na+ intake and their absorption by the body. for that purpose we used the time constants reported in a previous computer simulation of the water balance  <cit> . in this model, the water and na+ flow rates between digestive compartments were calculated from the water and  content of the stomach and intestine  <cit> . the model also includes passive and active transfer of water and electrolytes across the intestine wall. various attempts were made to increase the accuracy of this module. for example, a second "digestive module" based on the recent study of smith et al.  was also tested in the model. however, the assumption of a constant rate  for sodium transfer between the digestive compartments  <cit>  does not generate overall predictions in agreement with experimental data.

the model includes need-induced fluid intake, which is triggered when ecf  exceeds the pre-established set-point by 4%. introducing this threshold in the model is based on two distinct studies  <cit> . in anderson et al. , the authors showed that a mean increase of  <dig> mosmol/l was needed to trigger drinking in pigs. this increase represents about 4% of the normal osmolality . in the second study performed in humans, the authors presented a relationship between plasma osmolality and thirst sensation  <cit> . according to their regression function, a 4% increase in osmolality  lead to a score of  <dig> over  <dig> in term of thirst sensation.

the "motivation" module of our model includes unregulated drinking, an essential aspect of fluid and electrolyte intake. water and na+ consumption exceed the daily needs of the rat and physiological stimuli do not stop unregulated drinking  <cit> . this aspect of fluid intake was therefore introduced in our model to enhance the realism of the prediction generated by the simulation. moreover, a circadian modulation of unregulated drinking was added to the model. this modulation takes into account the fact that the probability of drinking is not constant over  <dig> h and the probability of drinking was therefore modeled by a sinusoidal function of time with a minimum at  <dig> pm and a maximum at  <dig> am. the maximum probability was set to the middle of the waking period  in agreement with the fact that drinking is correlated with eating  <cit>  and that rats almost exclusively eat during their waking period .

assumptions on the outputs to the body fluid compartments
it is known that the rate of renal na+ clearance can be slightly affected by hormones such as avp  <cit> . however, the absence of suitable data on na+ clearance as a function of avp concentration and the fact that the effect is negligible in most condition  <cit>  led us to consider a non-variable parameter in the model. this non-variable na+ clearance does not imply a fixed na+ excretion in the model. indeed, variable urine na+ excretion mechanism was introduced to control ecf  and volume , as well as a na+ retention mechanism . the actions of these mechanisms combined with the action of the avp controller exert a powerful mechanism of urine concentration.

avp is the main controller of the model. the measurable avp concentration in the plasma represents the equilibrium between avp secreted from the pituitary gland and its clearance  <cit> . however, in our model, those two components of the equilibrium are not simulated individually, only the resulting avp level. in order to have a more realistic simulation, we included the delay imposed by the fixed clearance of avp. when avp secretion is reduced, an exponential decay of plasma avp concentration was introduced in our model. this decay was adjusted so that 15% of circulating avp is cleared every minute  <cit>  until the correct avp level is reached. in addition, a recent study evaluating the circadian changes of plasma vasopressin in patients presenting nocturia, has reported a circadian modulation of avp  <cit> . inspired by this paper, a modulation of avp was introduced in the model by assuming that a mechanism lowers the avp level before the sleeping period of the rat in order to prevent nocturia. based on figure one of graugaard-jensen et al.  <dig> , we introduced the following modulation: at  <dig> am, the level of avp is reduced in a linear function of time until a nadir of -30% is reached at  <dig> am. then, avp concentration is restored to its computed level by  <dig> am. it should be noted that the lack of these two regulatory mechanisms controlling the level of circulating avp greatly impairs the quantitative and dynamic predictions of this parameter and resulting ecf .

focus on the long-term simulation of hydromineral balance
in the present study, the predictions mainly concern six individual parameters characterizing the hydromineral parameters and homeostatic responses: the ecf  and volume, the icf volume, the avp secretion and the cumulative water intake and urine excretion. we simulated normal hydromineral conditions to validate our model in terms of a quantitative prediction of the parameters of interest. comparison of these predictions with published experimental data  allows us to conclude that our model contains at least the minimal and essential sub-systems that are required to model the hydromineral balance. moreover, these subsystems are correctly connected using appropriate approximations and time constants to produce overall realistic predictions. therefore, the present high-level model is appropriate to deliver realistic simulation of avp secretion and ecf osmolality under normal hydromineral conditions, i.e. when the rat meets regular conditions of laboratory housing. this latter assumption might reduce the precision of any predictions on the biological parameters of interest made under either pathophysiological conditions, or extreme experimental conditions  as these specific situations require the implementation of additional regulatory systems.

the simulation over  <dig> consecutive days predicts relatively large inter-day fluctuations in avp, in water and electrolyte intake and in urine excretion compared to the stability of the ecf and the icf parameters . these fluctuations indicate that the daily distribution of fluid and electrolyte intake under normal osmotic conditions is not completely correlated with physiological needs. on the contrary, the fluctuations might reflect the unregulated nature of water intake and suggests that either a deficit, or overload in fluid and na+ consumption occur on a daily basis. these large discrepancies may explain the inter-individual variability that has been reported in experimental data. for example, measurement of the urine flow rate and urine osmolality in a population of male sprague-dawley rats extended over an almost threefold range .

the long-term simulation produced mean data and smoothed the random variations in each parameter tested, leading to the identification of two distinct phases during the active period of the rat: the restoration and the maintenance. the identification of these two phases was based on the prediction of a time-dependent secretion of avp that is well correlated with the phases of the hydromineral cycle. the predicted dynamics of plasma avp shows a constant rise over the sleeping period of the rat  and a decrease during the active period of the rat . this pattern of secretion matches the partial experimental observations indicating a circadian pattern in plasma vasopressin level with a peak in secretion at the end of the sleeping period  <cit> . however, the temporal resolution of the experimental measurements is not as accurate as the simulation  and the estimation of the mean experimental avp level and peak concentration for  <dig> h might be biased by individual fluctuations as shown in the additional file  <dig>  the temporal resolution of the simulation, as well as the average of avp level at each time point for several consecutive days greatly improves our perception of the circadian secretion of avp.

interestingly, the simulation allows the prediction  of parameters that would be difficult to measure experimentally, such as the icf and ecf volume. here, the long-term simulation highlights the role of the icf compartment in the stabilization of the ecf volume. the sleeping period is associated with a progressive decrease in the ecf volume that is concomitant to the decrease in the icf volume. the parallel depletion of both fluid compartments suggests the importance of water transfer between the icf and the ecf compartment to attenuate the depletion of the extracellular compartment. the role of the icf compartment was further demonstrated using a 24-h simulation, during which fluid exchange was blocked. under these conditions, the threshold for drinking was reached more often and small random perturbations in the ecf  or avp caused by drinking became larger. it should be noted that the role of the icf compartment as a buffer is a primary and fast compensatory response triggered by all the simulated hydromineral challenges. the predicted reduction in the ecf volume during the night  is certainly caused by evaporative water loss, which is compensated neither by water intake, nor by metabolic water. however, such a change in volume is not necessarily associated with hypotension. indeed, blood pressure is regulated by additional mechanisms like vasoconstriction.

focus on the simulations of hydromineral challenges
the simulations of the hydromineral challenges yielded several important results. the simulation of intracellular dehydration indicates that restoration of the ecf  mainly involves two sets of responses with different dynamics. water transfer from the icf to the ecf, and avp secretion are rapid homeostatic responses. need-induced water intake is delayed and has a high impact on both the icf volume and ecf . however, avid drinking creates hypervolemic conditions and further restoration of the ecf volume involves water and salt excretion that extends over the next  <dig> h.

the simulation of furosemide injection led to predictions that are in agreement with the experimental data. it also indicates that hyponatremia is only achieved by combining diuretic injections with a na+ deficient diet . hyponatremia is correlated with a sustained increase in the icf volume caused by the osmotic gradient generated between the ecf  and icf . furosemide injections per se induced hypernatremia, likely resulting from hyponatriuria. experimental data showed that blocking na+ re-uptake with furosemide injections led to urine  ranging from slightly hyponatriuric to hyponatriuric . despite a larger hyponatriuria, the data reported in hori et al.,  <dig>  were privileged because they provided the most detailed experimental measurements needed to create an accurate furosemide model. it should be noted that implementation of a higher na+ excretion rate in the furosemide model would lower ecf na+ content without creating hyponatremia. in this line, we tested the assumption in which we forced isonatriuria, approximately  <dig> mmol/l na+, during the simulated furosemide treatment. this extreme simulation also led to slightly hypernatremic ecf after the first  <dig> h of simulation , suggesting that furosemide treatment per se is not sufficient to cause efficient na+ depletion of the ecf compartment.

CONCLUSIONS
in the present study, we developed a high-level simulation of hydromineral homeostasis. the coherence shown between the simulations  and the experimental data indicates that the model integrates most of the essential components to predict realistic physiological values for the parameters under study. therefore, the model is able to render quantitative and precise temporal predictions on the ecf osmolality and avp secretion, as well as on their relationship with the ecf and icf volume, making it an appropriate tool to predict the state of the rat hydromineral balance when challenged by various osmotic perturbations. such predictions will help in the design of experimental protocols to test specific hypothesis. for example, we can suggest that the best period to experiment on rat is during the maintenance phase as this is the period where hydromineral fluctuations are less likely. also, obtaining a global view of all the hydromineral parameters that the simulation can produce with equivalent temporal precision would be difficult or impossible to obtain with in vivo measurements. moreover, one interesting application of the model is its use in predicting the putative action of pharmacological compounds on the hydromineral balance. as an example, we use the present model to simulate furosemide injections and our results are compatible with experimental data demonstrating that our model would be appropriate to test the action of other pharmacological compound affecting the homeostasis in the future.

the use of the model to an extended range of applications requires however, the implementation of additional components. for example, the implementation of a graded na+ appetite would be possible by modeling a sophisticated renin-angiotensin-aldosterone system and digestive module in the model. interestingly, substitution of the meta-box "vasopressin level" by a biologically inspired simulation of the magnocellular neuron network  <cit>  in future versions of the simulation would allow us to predict how local modulation of neuronal excitability by osmotic challenges and drugs targeting these neurons would influence the dynamics of global homeostatic parameters in rats.

authors' contributions
ln established the rat model and programmed the simulation using computer software. he wrote the first draft of the present paper and he approves the final version. da performed the animal experiments, i.e. the furosemide injections and all the measurements of the parameters. moreover she participated to the criticisms and revisions of the manuscript. da approved the last version of the manuscript. dm analyzed the experimental and predicted data of the simulation and he suggested all the final improvements of the model. he performed all the writing revisions of the manuscript and approved the last version of the manuscript.

supplementary material
additional file 1
comparison of the impact of osmotic and volemic fluctuation on vasopressin secretion. this additional file shows the relative impact of the osmotic and volemic fluctuation on the avp secretion based on equation  <dig> of the method.

click here for file

 additional file 2
calculation of the sodium clearance used in the simulation. four different calculations of the sodium clearance based on four different paper are presented and their results are averaged in order to generate the sodium clearance value used in the simulation.

click here for file

 additional file 3
comparison of the simulated dynamics of three hydromineral parameters with experimental data. this additional file compared the simulated dynamics of the water intake , avp concentration  and urine volume  with experimental data and shows that they are in agreement.

click here for file

 acknowledgements
this project was supported by the canadian institutes for health research  mop- <dig>  ln received a scholarship from the natural sciences and engineering research council of canada .
