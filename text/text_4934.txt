BACKGROUND
genotype imputation is a key step in the analysis of genome-wide association studies  and genomic prediction  <cit> . since obtaining whole genome sequences until recently was very costly, genomic studies have mostly relied on single nucleotide polymorphism  marker arrays, where only a small fraction of polymorphisms are preselected to be highly polymorphic and to cover the whole genome  <cit> . furthermore, it has been suggested that many quantitative trait nucleotide  are rare variants  <cit> . this means that the analyses have typically relied on linkage disequilibrium  between markers on the snp panel and the causal polymorphism, since qtn that affect a certain trait are not expected to be among the commonly available snps from marker panels. genotype imputation allows the analysis of variants not represented in snp arrays without the cost of genotyping millions of additional snps. this increases the probability that causal variants are included in the panel tested for association. besides, with increased marker density as well as allele frequency spectrum, the chance of having higher ld among markers and qtl increases.

recently the availability of next generation sequencing  techniques has made it possible to obtain whole genome sequences at a reasonable cost. the cost is however not so low that it is possible to just sequence all the individuals of interest. therefore most of these individuals will be genotyped with snp panels and a large part of the genomic data will have to be inferred with genotype imputation methods. in human genetics an initiative known as the  <dig> genomes project  <cit>  has provided an open database with reference sequence data which can be used for imputing markers in a study sample. recently an analogous initiative known as the  <dig> bull genomes project was started for bovine genetics and genomics studies  <cit> . currently a large part of the information in the database is dominated by holstein bulls, but genome sequences from other dairy and beef breeds are also available.

imputation of whole genome sequence markers offers two major challenges. 1) the accuracy of imputation depends on the size of the reference data , but the reference population could be small for some breeds due to the cost involved in sequencing. 2) the number of variants obtained from whole genome sequence is huge and could result in a massive computational burden.

the first problem might be overcome by pooling reference data across breeds. previous studies on combining reference populations for imputation from 50 k to high density  marker panels in cattle have shown no gain in accuracy  <cit> , brøndum et al. however concluded that the imputation accuracy could be improved for animals with a mixed genetic background without decreasing the accuracy for the purebred animals when using a combined breed reference population  <cit> . the limited success of across breed imputation from 50 k to hd is most likely caused by differences in ld phase and thus haplotype dissimilarity across breeds on the 50 k panel  <cit> , but the greater marker density on the hd panel might alleviate these differences for diverged breeds  <cit> , meaning that across breed imputation could be successful from hd to whole genome sequence data  <cit> .

the second problem could be solved by using a pre-phasing strategy. howie et al. showed that pre-phasing the data is a time-efficient method for imputation which only results in a minor loss in accuracy  <cit> . a number of fast and accurate phasing approaches are available, for example, shapeit <dig>  <cit>  and beagle  <cit> .

it has been shown that high accuracies of imputation from 50 k to hd data in cattle can be obtained using methods that rely mostly on population ld information  <cit> , such as beagle  <cit>  and impute <dig>  <cit> . ma et al. showed that impute <dig> outperformed beagle for rare variants, but at a cost of longer computation time, and that slightly higher accuracies for rare variants was possible when using fimpute  <cit> , which also uses pedigree information  <cit> ; a full pedigree across countries and breeds was however not available for the data in this study. beagle is not designed for an admixed reference population, but it seems that the underlying graphical model describing the patterns in ld is able to properly account for substructure in the data. the model in impute <dig> has been designed to use local sequence similarity to build a custom reference panel for each sample haplotype from a mixed reference population  <cit> .

the objective of this study was to investigate how well whole genome sequence variants can be imputed from a hd snp marker panel in nordic dairy bulls. we compared the accuracy using both a single or multi-breed reference population, and compared the accuracy and computation time of beagle and impute <dig> with or without pre-phased reference data.

methods
the whole genome sequence data used as a reference for this study is compiled from two different sources. at aarhus university  <dig> bulls from the three major nordic dairy cattle breeds, i.e. holstein, jersey and nordic reds, have been sequenced. a subset of them has been shared in the  <dig> bulls genomes collaboration and in turn it was possible to increase the imputation reference with an additional  <dig> dairy bulls from run <dig> of the  <dig> bull genomes reference data. different variant calling pipelines where used for the two datasets; these are described below. in order to reduce computation time without losing generality only markers mapped to bovine autosome  <dig>  were investigated. however, similar results are expected for other autosomes.

nordic sequence data 
dna was extracted from semen samples using standard procedures at aarhus university, foulum. sequencing was done using illumina sequencers at beijing genomics institute, shenzhen, china. sequencing was shotgun paired-end sequencing with a read length of  <dig> base pairs. fastq data were converted from illumina to sanger quality encoding using a patched version of maq  <cit> . they were aligned to the umd <dig>  assembly of the cattle genome  <cit>  using bwa v <dig> . <dig>  <cit> . they were converted to bam files using samtools  <cit> . quality scores were re-calibrated using the genome analysis toolkit v <dig>   <cit>  following the human  <dig> genome guidelines incorporating information from dbsnp vers.  <dig>  <cit> . sequence realignment around insertion/deletions  and variant calling was done using the genome analysis toolkit v <dig> .

 <dig> bull genomes run <dig> 
variants were called using samtools- <dig> . <dig>  additional custom made filters were used to remove false positive variant calls, and filters were calibrated by the concordance of sequence and bovine high density chip genotypes and the rate of opposing homozygotes for sire-son paired genotypes. detailed guidelines are available at http://www.1000bullgenomes.com.

combined sequence data
data from both sources were available as vcf files, containing both genotype probabilities and unphased most likely alleles; for a full description of the data-format see  <cit> . data was combined using picards mergevcfs . from the available datasets only holstein, jersey, nordic red and brown-swiss bulls were kept for further analysis, leaving a total of  <dig> dairy bulls, with a mean sequencing depth of  <dig> x as a reference for imputation. as the  <dig> bull genomes project shares data after variant calling, some markers were not called for all animals in the combined dataset. to avoid large gaps of missing markers in the dataset only markers that were called in both the nordic and the  <dig> bull genomes project datasets were kept. for positions containing both a snp and an indel, the indel was deleted as the imputation methods rely on unambiguous sequences of variants. positions with disagreements between alleles for sequence and hd data were also deleted. reference genotype probability data was run through beagle and all markers with an r <dig> value  below  <dig>  were removed from the original sequence data. this was done in order to remove uncertain marker genotypes that might have adverse effects on the imputation procedures, but might also cause a positive bias in the estimated imputation accuracies. these quality control steps left a total of  <dig>  markers on bta29:  <dig>  snps and  <dig>  indels.

hd data
seventy-two of the sequenced nordic bulls had previously been genotyped with the illumina bovine hd chip  and were chosen as a validation set. for the hd data, markers that were monomorphic, had a gencall score of less than  <dig>  or a call rate less than  <dig>  were removed. these quality control steps left  <dig>  markers from bta <dig>  hd marker data for the nordic holstein and nordic reds have previously been used in a number of studies on both genomic prediction and imputation, e.g.  <cit> .

for more detail on the number of animals per breed from each data source, see table  <dig> table  <dig> 
number of animals with whole-genome sequence and high density genotype information used in the study



nordic sequence

 <dig> bull genomes sequence

high density snp data


imputation
imputation accuracy from hd to sequence data was tested in a number of different scenarios for comparison on both imputation accuracy and speed. pre-phasing of the reference data was done using either beagle v <dig> . <dig> or shapeit <dig> v <dig> , both with default parameters and using genotype probability data as input.

imputation was done in beagle or impute <dig> using either pre-phased haplotypes or genotype probabilities. for all scenarios a leave-one-out validation was done, where each of the animals with both sequence and hd data in turn was deleted from the reference data and included as a target individual with only hd data. accuracy was computed as the correlation of the true genotypes from sequence calls and imputed dosages.

beagle
for beagle two different scenarios were tested. the first was the effect of using a combined reference population versus using a single breed reference population; the second was using pre-phased reference data from either beagle or shapeit <dig> versus using un-phased genotype probability data. the first scenario was only tested using pre-phased reference data. a previously designed pipeline with beagle where the data was divided in chunks of ~ <dig>  markers with an overlap of  <dig> markers was used for the imputations with phased reference data. the number of hd markers in these chunks averaged  <dig> with a range from  <dig> to  <dig>  imputations with un-phased data were done for the entire chromosome in one run. all imputations were done using the default parameters.

impute2
for impute <dig> we did not test the effect of single- versus multi-breed references; only the effect of pre-phased most likely genotypes versus genotype probability data was investigated. pre-phased data was obtained from either beagle or shapeit <dig>  the imputations were done in chunks of  <dig>  mb . the number of sequence markers in these chunks including buffer regions of  <dig>  mb averaged  <dig>  with a range from  <dig>  to  <dig> , and the number of hd markers averaged  <dig> with a range from  <dig> to  <dig>  the effective population size was set to  <dig> and all other parameters were kept at their default values.

RESULTS
the quality of the sequence data was assessed by comparing best calls from the sequence data with variants from the hd chip for the  <dig> test animals. results showed a mean concordance of  <dig> %, with a range from  <dig> % to  <dig> %. the mismatches between hd and sequence data suggests that the best calls based solely on individual sequence information, does not necessarily represent the actual variants, which might cause a negative bias in the assessment of imputation accuracy. it was found that the concordance between hd and sequence variants increased to an average of  <dig> % with a range from  <dig> % to  <dig> % when the comparison was done based on best calls from beagle posterior genotype probabilities instead of using the genotype probabilities obtained from the variant calling software, which strengthens this hypothesis. all calculations of accuracy below are however done based on raw genotype calls to avoid a bias in favor of either beagle or impute <dig> 

mean imputation accuracies for the three breeds are shown in table  <dig>  by comparing the first and second row of the table it is seen that all populations gain from using the combined reference population, with the largest gain for nordic reds. these results are in line with previous results by brøndum et al.  <cit> , where it was found that the imputation accuracy for danish reds was improved when including holsteins in the reference. all of the nordic red animals included as test animals are from danish red which historically has used sires from both holstein and brown-swiss. furthermore, the accuracy of imputation has been shown to depend on the relationship between reference and validation animals  <cit> . an investigation of the available pedigree data showed that the for the rdc validation animals there were  <dig> sire,  <dig> maternal grandsire and  <dig> paternal grandsires in either the holstein or brown-swiss reference data. these facts combined could explain the large gains in accuracy for the rdc test animals. holstein animals gain very little from inclusion of other breeds, which could be due to their relatively large single breed reference population. for the jerseys an investigation of the available pedigree data showed no relationships between test animals and the added animals in the combined reference population. furthermore, a principal component analysis of the nordic dairy breeds, shows that the jersey population and the other populations analyzed in this study are quite distinct with no evidence of recent admixture  <cit> . the small gain in imputation accuracy for the jersey population when using the combined reference population thus suggests that the persistence of ld phase between the hd markers across populations is strong enough to utilize information from one population in the other for imputation from hd to full sequence data, even with distant relations.table  <dig> 
mean and standard deviation  of correlation between true and imputed genotype dosage for holstein , jersey  and nordic red 




results for the comparison between beagle and impute <dig> with combined reference populations are also shown in table  <dig>  overall the accuracies from different scenarios are quite similar within the respective breeds, but across the three breeds the highest imputation accuracies are found when using beagle with un-phased reference data. similar accuracies are found when using impute <dig> for the holstein and rdc animals, but for the jersey animals beagle with un-phased reference data has the best results. for beagle, there seems to be some loss of accuracy when using pre-phased reference data, but impute <dig> is less affected. the larger difference for beagle, could be caused not only by the differences in input data, but also by dividing the data in smaller chunks in the phased setup, although an overlap between chunks was used to avoid increases in error rate at either end. impute <dig> also uses a strategy to improve speed by dividing the data in smaller chunks, but the number of overlapping markers was larger. when comparing accuracies obtained using pre-phased data, a slight advantage is seen for pre-phased data from beagle in both beagle and impute <dig>  although shapeit <dig> is the recommended software for pre-phasing for impute <dig>  possibly better results could be obtained by increasing the number of conditioning states in the shapeit <dig> algorithm, but this would also result in increased computation time, and it has previously been shown that the gain is limited when exceeding the default value of  <dig> states  <cit> .

figure  <dig> shows the imputation accuracy across bta <dig> for the two most accurate scenarios, i.e. beagle and impute <dig> with genotype probability data and a combined reference population. there is a large variation with accuracies ranging from - <dig> to + <dig>  i.e. from opposite imputation to completely true. spikes of low imputation accuracy are consistent across the three breeds in beagle which might result from problems in sequencing these regions or from errors in the assembly since the imputation procedures rely on correct sequences of markers. comparing the results from beagle to results from impute <dig> there seems to be some overlap in spikes of low accuracy; they are, however, less pronounced for impute <dig> figure  <dig> 
imputation accuracy along bta <dig> for holstein , jersey  and nordic red . imputed data was obtained using beagle or impute <dig> with genotype probability data in the reference.



one of the powers in sequence data lies in the ability to use rare variants for analysis, and these have to be imputed accurately in order to use them efficiently. in other words it is important that the imputation procedure performs well for the full allele frequency spectrum. figure  <dig> shows that the distribution of loci across the minor allele frequency  spectrum is skewed to the left which means that poor imputation for rare variants would heavily influence the overall imputation accuracies. on figure  <dig>  average imputation accuracies are shown plotted against the maf; averages where calculated in bins of 1%. this was done for each of the seven scenarios listed in table  <dig>  results show that impute <dig> performs better than beagle when imputing rare variants, which confirms previous results  <cit> , but on the contrary beagle performs better for the more common variants . this larger variation in accuracy across the allele frequency spectrum when using beagle is also evident from the larger standard deviations for beagle in table  <dig>  in addition, for beagle the pre-phased setups seem to have the largest impact on the imputation error for loci with low maf, whereas this pattern is less noticeable for impute <dig>  for the jerseys and nordic reds imputation accuracies drop fast for maf less than  <dig>  in the single breed reference scenarios. this might be caused by the fact that many rare variants would be poorly represented in the single breed imputation references for the smaller breeds. looking at the overall picture it seems that with the current size of the imputation reference, there is not enough information for accurate imputation of rare alleles, but the reference is growing, and the accuracy is expected to follow. however, it might also be possible to increase the accuracy for rare variants with the current size of reference data by using methods such as fimpute that utilize pedigree data along with the ld information as shown in the results by ma et al.  <cit> .figure  <dig> 
distribution of minor allele frequency for sequence markers on bta <dig>  minor allele frequencies are calculated based on the  <dig> sequenced animals.
imputation accuracy versus minor allele frequency . imputation accuracies are averaged in bins of 1% of maf.



the accuracies of imputation from hd to whole genome sequence data obtained in this study are larger than previous results from the  <dig> bull genomes project where an average accuracy of imputation  of  <dig>  was reported when using beagle within the holstein breed only  <cit> . these results where however obtained using a validation procedure that removed more animals from the reference. accuracies of imputation to whole genome sequence are much lower than those reported for imputation from 50 k to hd data in cattle with beagle and impute <dig>  genotype correlations of  <dig>  have been reported for imputation of hd markers from 50 k in nordic holstein and red  <cit> , and berry et al. reports genotype correlations of  <dig>  and above for imputation from 50 k to hd data in  <dig> different dairy and beef breeds  <cit> . the higher accuracies obtained in these studies are most likely caused by larger within breed references and fewer markers with very low minor allele frequencies.

computation times for the different procedures are shown in table  <dig>  it is seen that with un-phased reference data computational demands for impute <dig> are much higher than what is required for beagle with un-phased reference data . when using pre-phased reference data impute <dig> is however, much faster than beagle .table  <dig> 
computation times for phasing and imputation procedures


computations were done on a unix computer cluster with intel xeon x5670/x <dig> processors.



for the phasing procedures beagle was faster, than shapeit <dig> which required around 52 hours to phase bta <dig> for the  <dig> available animals, whereas beagle performed the same job in less than 3 hours. shapeit <dig> supports parallel computing, and this implementation has been shown to be competitive with beagle and in fact faster for sample sizes of  <dig>  individuals or more using a snp density similar to the bovine hd panel  <cit> . in the data at hand we were not able to reproduce this result, which suggests that for smaller sample sizes beagle is much more effective; there might however also be an effect of the snp density, but a more in depth investigation is needed to confirm this. furthermore beagle  <dig>  <cit>  which was recently released also supports parallel computation, which presumable makes the advantage larger.

all estimates of imputation runtimes were done using only one test individual. to validate that the ranking of methods also holds for larger samples sizes we reran a single chunk of  <dig>  markers using pre-phased reference data with the  <dig> sequenced animals in the reference and  <dig>  animals with hd data. we found that beagle was able to impute all these animals in 8 hours, whereas impute <dig> required only 4 hours. if the hd data was also pre-phased, beagle was able to complete the task in 1 hour, whereas impute <dig> used only 10 minutes. using the pre-phased hd data did not decrease the imputation accuracies , but further studies are required to confirm these results as they include information from many more hd animals in the pre-phasing which could improve the phasing quality, thus making them not directly comparable. a previous study by howie et al., however shows that pre-phasing the study data only results in a minor loss of imputation accuracy  <cit> .

CONCLUSIONS
when imputing whole genome sequence variants with a limited number of reference individuals, combining the references across breeds is a good strategy to improve the imputation accuracy. furthermore, impute <dig> is more accurate than beagle for rare variants. using impute <dig> with pre-phased data from beagle is computationally efficient, and only results in a minor loss in accuracy. overall accuracies are lower than previous reports on imputation of hd markers, especially for rare alleles. there is also a large variation in the accuracy across loci, so the added benefit of sequence data for genomic prediction at the moment might be limited. imputation accuracy is, however, expected to improve as the size of the reference population increases. taking both computation time and accuracy into account, using beagle for pre-phasing and impute <dig> for imputation would be a good strategy for large scale imputation of whole genome sequence markers.

availability of supporting data
all dna sequences used were taken from a publicly available assembly. the assembly is available for download at ftp://ftp.ensembl.org/pub/release-73/fasta/bos_taurus/dna. all variations identified have been submitted by the  <dig> bull genomes project for inclusion in dbsnp . whole genome sequence data for the  <dig> individuals included in run <dig> of the  <dig> bull genomes project are available at ncbi using sra no. srp <dig> .

competing interests

the authors declare that they have no competing interests.

authors’ contributions

concept and design of the study was done by all authors. bgu performed alignment and variant calling for the nordic dataset, and combined it with data from the  <dig> bull genomes project. rfb performed all imputation analyses and drafted the manuscript. all authors contributed to interpretation of results, and revised and approved the final manuscript.

