BACKGROUND
in genomics research, the dimensionality of assayed data has increased far beyond the pace of analytical tool development, with data sets likely to continue to increase in size and complexity  <cit> . we appreciate that gene expression is regulated through a number of interacting mechanisms that include epigenetic processes such as dna methylation. dna methylation can also reflect the local binding of transcription factors  <cit> , which are capable of influencing local chromatin structure  <cit>  and post-translational modifications of histones  <cit> . furthermore, transcription can induce dna methylation  <cit> , and dna methylation can itself influence transcription factor binding . while these observations indicate complex interactions between regulators of genomic organization, they also suggest that multiple types of events observed at the same locus increase confidence that regulatory activity is genuinely occurring at that locus. current methods to explore multiple coincident processes using integrated analysis introduce bias by pruning data sets, either by focusing only on a subset of loci with the most significant effects, or requiring pairwise comparisons of data sets with progressively smaller intersections. furthermore integrative methods, like functional epigenetic modules   <cit> , score genes within a network and identify subnetworks, referred to as modules, but they lack an implemented method to define further functional interpretability an essential outcome of genomics experiment  <cit> . therefore, there is a need for a flexible method integrating genomic assay data into a single score that can be used to identify functionally important pathways for further study.

here we describe an intuitive gene scoring system that combines transcriptional and epigenetic regulatory data sets, an approach we call significance-based modules integrating the transcriptome and epigenome . the novelty of smite lies in the use of mathematic principles and sampling techniques to simplify multiple complex genome-level signals into a single set of interpretable results. we use smite to identify novel gene modules in a large, high dimension epigenetic and transcriptomic data set, and we show that smite offers improved detection, characterization, and visualization of functional modules within a gene network compared to existing methods. overall, smite provides a useful and intuitive answer to the most important question in integrative genomics: what we can learn from integrating multiple sources of high-resolution information instead of considering each source separately?

implementation
toxoplasma gondii  human foreskin fibroblast data set
to benchmark smite and demonstrate implemented features, we obtained a large multifaceted genomics data set from a controlled experiment studying the transcriptional regulatory effects on human foreskin fibroblasts  following infection by t. gondii. further description of the experimental methods used to produce the data set and results are available in additional file  <dig>  including alignment to a combined human/toxoplasma genome assembly .

required inputs to smite
smite provides a pipeline that results in annotated functional modules . it requires the following inputs: 1) a gene annotation bed file, 2) an interaction network, and 3) data sets of effects and statistical test significance from at least one gene expression and/or epigenomic profile. in addition, users can include an unlimited number of previously identified genomic intervals of interest -seq peaks, enhancers, additional file 1: table s1). notably, the software relies on p-values without specifying the source statistical test, so it is necessary for users to ensure appropriate sample sizes, data quality, and statistical testing of the original experiments.fig.  <dig> summary of smite. the flowchart details the pipeline through which smite takes p-values, associates them with genomic intervals, and scores genes. the steps and input required to discover significant modules are shown as well as the downstream functions that smite provides for module interpretation




motivation for smite
in functional genomics experiments, after performing genomic assays on two or more groups, one generally uses a statistical test to estimate an effect for up to millions of genomic loci . these estimates are then compared to their standard errors to derive test statistics, t, and p-values, p, where p is defined as the probability that t is greater than a threshold from a statistical distribution, t, such that p = p. these test statistics and corresponding p-values are used to reject a null hypothesis . while a p-value does not represent the probability that a hypothesis is true, in practice, each p-value does correspond to a researcher’s relative prioritization of a gene or genomic region within a ranked list  <cit> . an observed p, which increases in significance as it approaches zero, is proportional, ∝, to a new heuristic that is maximized as 1-p approaches  <dig>  and this heuristic is the probability, p, that a gene or genomic region is prioritized by a researcher for further analysis:  <dig> pt<t=1−p∝pgeneorgenomicregionisprioritized 


therefore, in application, p-values are generally reinterpreted beyond their intended purpose, and in this capacity they contribute to new heuristics that are used as the primary criteria for prioritization. while the functional interpretation of significant hypothesis tests from gene expression experiments is straightforward , to understand specific functional genomic contexts we must interpret multiple p-values as contributing evidence. for example, dna modifications like dna methylation and dna hydroxymethylation are typically measured at the single base pair level, whereas functional genomic contexts are represented by genomic intervals that vary in size, like gene promoters. this necessitates a method of combining multiple p-values overlapping the same genomic interval, while also accounting for their likely interdependence. therefore, these genomic intervals can contribute to a single heuristic that can be used to score their associated genes. since the relationships between genomic intervals and their associated genes are complex, a flexible approach is needed to allow user input for optimal weighting of genomic contexts depending on a particular experiment.

there are several p-value combination methods used in meta-analyses. because these methods assume independence of experiments, smite includes a preprocessing step using monte carlo methods  to account for non-zero correlations when combining dependent p-values  <cit> . this novel approach implementing mcms assesses the average strength of the correlations and determine a new distribution of combined p-values. subsequently, p-values are recursively combined until every node  in a specific interaction network is associated with a single score that in turn reflects a researcher’s intuitive belief that the node has sufficient evidence to be prioritized for further analysis.

combining p-values in smite
given k experiments with k hypotheses, h
i…k, test statistics and corresponding p-values, p
1…k, are calculated so that each p-value reflects the probability of observing a particular test statistic or more extreme values; the p-value itself is, however, a random variable that follows a uniform distribution, u  <cit> . p-value combination methods attempt to characterize the joint distributions of two or more of these random variables. if the p-values are not independent from one another, then there is a covariance/correlation matrix that needs to be incorporated into the analysis in order to maintain statistical validity. rather than focus on the statistical distributions of combined p-values, which can be complex, difficult to calculate, and risks over-interpreting p-values, smite uses mcms, like bootstrapping, to sample randomly a particular set of values from an unknown distribution and to estimate the characteristics of the new combined distribution. smite employs these sampling methods before combining large correlated p-value data sets. smite offers several methods for combining p-values including stouffer’s z-score method  <cit>  , sidak’s adjustment  <cit> , fisher’s method  <cit> , and binomial testing. more detail about the available methods is provided in additional file  <dig> 

in the idealized scenario, the application of p-value combination methods is trivial because of the independence of each epigenetic signal; however, modifications like dna methylation are thought to be highly correlated over short distances  <cit> , with methods like bumphunting exploiting this local correlation to define differentially methylated regions  <cit> . for this reason, smite estimates the average correlation between the dependent p-values as a function of distance. for each gene g
i for i in  <dig> …i, we first find the j genomic intervals r
ij for j in  <dig> …j related to g
i . then, we determine the n overlapping p-values, p
ijk for k in 1…n
ij, for each genomic interval. next, we convert the p-values to a standard normal distribution with the transformation z
ijk = Φ
−1
, where Φ is the standard normal cumulative distribution function . rather than incorrectly assuming that the p-values are independent, we chose to use a non-parametric mcm approach to estimate correlation coefficients for modifications that overlap the same interval, r
ij.

we estimate a correlation matrix using the physical distance between loci associated with p-values, and thus, we control for a background level of spatial correlation. to estimate this matrix, we find for each significant p-value within a type of interval r.
j the distances to the closest upstream and downstream p-value. as help-tagging  <cit>  and illumina humanmethylation <dig> beadchip array  <cit>  data have ~ <dig> million data points and ~ <dig>  probes, respectively, these distances were binned in  <dig> bins, resulting in as little as single basepair bins for the smallest distances, where we expect the largest correlations. we randomly sampled within bins with replacement and found the pearson correlation between the transformed p-values. this process was repeated  <dig> times and the average correlation was associated with the bin. the results from a correlation matrix using dna methylation from the t. gondii hff data set indicate, as expected, that the estimated correlation is generally higher between p-values close to one another, and that it tends to decrease with distance . even when these correlations are small, it is inappropriate to ignore them completely, and this calculation is necessary to account for the background interdependence of effects.fig.  <dig> monte carlo simulation of correlation matrix for dna methylation. the average pearson correlations as a function of distance separating adjacent effects for dna methylation in the t. gondii hff data set. as expected, there is general decrease in the correlation of dna methylation values as the distance between assayed sites increases




having determined a correlation matrix, Σij, that is symmetric, positive, and definite, we can determine an upper triangular matrix with positive diagonal entries using the cholesky decomposition, c
ij, so that Σij
=c
ij
t
c
ij, and this decomposition can be used to adjust the previously transformed p-values zijk, where z
ijk = Φ
−1
, such that  <cit> :  <dig> cij−1Φ−11−pijk2=zijk* 


through this method the correlated z
m and z
n for m ≠ n are now approximately independent and can be combined as independent experiments. the cholesky decomposition is discussed in greater detail in additional file  <dig>  additionally, smite employs mcms to estimate the distribution of the combined statistics so that the new p-values can be thought of as completely new heuristics indicating confidence in a particular p-value, zijk*.

an aggregated score, r
ij, is calculated using the weighted stouffer’s method:  <dig> rij=∑k=1nwijkzijk*∑i=1kwijk2~n <dig> where w
ijk represents optional weights such as distance from the gene transcription start site   <cit> . an analysis where no weights w
ijk are used is shown in additional file 1: figure s <dig> where an r2 =  <dig>  between final scores with and without weighting and nearly identical final modules and annotations in additional file 2: tables s14–s <dig>  indicate that smite is robust for choices of w
ijk
. in a high-resolution epigenomic assay like help-tagging, it is possible to have as many as ~ <dig> data points  associated with a large region like a gene body. because aggregated scores increase as the number of p-values within a genomic interval increases, smite implements a quantile-permutation adjustment, whereby a specific r
ij is compared to  <dig> distributions of randomly sampled r’
ij scores from the same n
ij quantile. we estimate p*
ij, the proportion of sampled r’
ij scores at or more extreme than the observed r
ij and p¯
*
ij, the average of the proportions from random samples. finally, we consider r
ij = Φ −1
 with an effect direction  derived from the p-value effect sizes. the improvement after controlling for the number of combined p-values on the combined significance can be seen before and after adjustment .fig.  <dig> the effect of adjustment by the total number of combined p-values. in this example taken from the t. gondii hff data set, the negative natural log of the significance of the combined p-value is plotted against the number of p-values that were combined for each value. the increased trend is visible before adjustment  and is no longer present after adjustment 




normalization of aggregated p-value-derived scores
we found that despite each component score r
ij being normalized for the number of combined p-values, a slight difference in the distribution of one component can drive downstream scores and bias module detection. to resolve this potential limitation, we implement a normalization step that results in more comparable component scores, rij, for all genes . there are two methods available for normalizing scores depending on the distribution of the combined p-values and both represent monotonic transformations preserving the order of the scores. the first available method is a logit transform of the p-values, followed by rescaling to a common scale and then recovering the adjusted p-value. this method has minimal effects on the actual data, but it successfully improves the overall distribution and comparability of the different types of data . the second available method is a variation on box-cox transformations where an iterative process identifies an optimal power transformation of the data.fig.  <dig> normalization of combined p-value scores. the densities of the scores/p-values for the t. gondii hff data set are plotted using the smite functions to compare each of the annotated contexts to determine if normalization is necessary . after normalizing the values by logit transformation, rescaling, and back-transformation, the densities of the normalized p-values are shown 




the comparison of rij  can provide useful information about the overall observed trends. here, we show a comparison of the gene promoter scores with gene body scores for dna methylation and dna hydroxymethylation in the t. gondii hff data set, and we can see that hypo-hydroxymethylated gene bodies are associated with hypo-hydroxymethylated promoters .fig.  <dig> epigenetic modifications at promoters compared with gene bodies. using the smite functions, we show a comparison of the component scores  version of the score) and the effect direction for gene promoters and gene bodies in the t. gondii hff data set. for dna methylation , there is not a large relationship between scores and directions of scores between promoters and bodies, whereas for dna hydroxymethylation  there is a concordance of loss of hydroxymethylation in promoters and gene bodies




final score derivation for downstream analysis
finally, we derive a single score for each gene, g
i, using the stouffer method again, with optional weights w.
j for each r.
j reflecting the researcher’s main analysis goals , including a directionality coefficient b.
j reflecting a researcher’s a priori understanding about the relationship between each r.
j . because the combined score represents linear combinations of weights and transformed p-values, we again use mcms by bootstrapping to determine a new adjusted p-value for each gene, pi. scores for each gene are then calculated using fisher’s method as g
i 
= −2ln, which has an approximate chi-square distribution with 2° of freedom. high scoring genes can be used for other analyses such as gene set enrichment analysis  <cit>  and network-based approaches.

to explore the impact of weight choice for each r.
j on downstream analysis, we fixed the weight values w.
j for j in  <dig> …j, varied the one individual weight w.
m, for m not in { <dig> …j} and for each variation, we extracted the highest scoring genes using a sampling approach with replacement to determine the background score distribution. this analysis allowed us to assess how individual gene’s scores varied with weight choice, and to what extent the overall high scoring geneset was altered in additional file 1: figure s <dig>  as expected, we observe that as the relative weighting increases, the effect of each r.
m on the overall identified geneset is greater; however, roughly 50% of the identified genes remain constant, likely depending mostly on other r.
j for m ≠ j for their overall scores. for each r.
m, as w.
m increases, a different subset of genes emerges that likely depends on r.
m . ultimately, we believe this flexibility in identified genes is a strength of the technique as it allows the researcher to identify a subset of genes that is robust to weight choice, but also allows for overall gene sets that differ depending on r.
j of interest.

module identification within smite
in smite, modules are identified by inputting scores into a spin-glass algorithm as in epimods  <cit>  or a heinz algorithm  <cit>  as in bionet  <cit> . the spin-glass algorithm in network analysis was initially suggested by reichardt and bornholdt  <cit>  who sought a method of defining subsets of nodes within a network that were more densely interconnected, suggesting that these represented a joint spin state, or community. they proposed that the relative density of the connections, called modularity, could be compared to modularity under a null distribution to derive significant communities within a larger network. the spin-glass algorithm, which depends on a single parameter  <cit> , has been shown to an effective method for finding modules as long as its parameter is set below  <dig> , and in fact, it was shown that fixing this parameter at  <dig>  results in an optimal number of genes within a module  <cit> . thus, smite also uses a  <dig>  parameter for running the spin-glass algorithm. alternatively, the heinz algorithm uses a linear programming approach called branch-and-cut where connections between nodes are converted to two directed edges and trimmed until a single optimal subnetwork is identified. thus in practice, the heinz algorithm produces a larger summary subnetwork of genes that typically encompasses the separate modules found using the spin-glass algorithm.

whereas other subnetwork identification algorithms define significance on the basis of observed subnetwork modularity , smite allows modules to have both connectivity significance and an additional associated statistical significance related to the sum of the individual node within a module. because our scores are derived from p-values, we employ fisher’s method mentioned above to assess the overall module significance, which should follow a chi-square distribution with 2 k degrees of freedom, where k is the number of genes within a module . therefore, this significance can be used to rank and filter modules.

RESULTS
integrative analysis increases study power
smite increases the power of analysis at four levels:  by analyzing combined genomic signals from multi-level genomics experiments and avoiding the inflated type i error that characterizes pairwise comparisons of genomic signals;  by combining incomplete data sets so that having one missing signal will not eliminate a gene from analysis;  by allowing prioritization of the most important signals and genomic contexts  for further downstream analysis; and  by implementing methods to analyze groups of genes within networks or pathways together. we have therefore designed smite to aid in the interpretation of integrated data that were given rigorous statistical treatment during upstream analysis. in the setting of underpowered, preliminary research, smite is better used as an exploratory tool to help target downstream analysis and plan further experiments.

smite identifies novel dysregulated functional modules in t. gondii-infected human cells
in additional file 1: table s <dig>  we show two sets of criteria that we used to score the t. gondii hff data called reduced  and full  models that illustrate how a researcher can use smite with varied weighting to identify varied gene modules. the smite-r model only includes gene expression and gene promoter dna methylation; whereas in the smite-f model also includes enhancer  and gene body dna methylation and hydroxymethylation. we were primarily interested in transcriptional regulatory alterations at enhancers  and how those relate to functional annotations, so in smite-f, enhancer-defining marks were weighted highest, followed by gene expression, gene promoters, and gene bodies. as mentioned previously, we expect that dna methylation should have a negative correlation with gene expression at gene promoters  <cit> , and a positive correlation with gene expression at gene bodies . in contrast, for the purpose of this demonstration, we do not assume any known relationship between dna methylation at enhancers or for dna hydroxymethylation at any genomic feature. for both the reduced and full models, we ran the spin-glass and the heinz algorithms. for the spin-glass algorithm, we requested modules that had at least  <dig> genes but no more than  <dig> genes. for the heinz algorithm, we input a subset of high scoring genes identified by randomly sampling the scores to find the background distribution. the r code that we used is shown in additional file 1: appendix  <dig>  and the list of genes within the summary network generated by the heinz algorithm is shown in additional file 2: table s <dig> 

the effect of smite-r and smite-f model choices on the overall scores is shown in additional file 1: figure s <dig>  through the spin-glass algorithm, both smite-r and smite-f identified  <dig> modules representing  <dig> and  <dig> genes, respectively , with an overlap of only  <dig> genes. notably, four and two of the  <dig> modules for smite-r and smite-f, respectively, showed enrichment for infection-related and inflammation-related annotations, as would be expected for infection of a host cell by an intracellular pathogen. in addition, we find that generally metabolism-related modules are dysregulated in five and four of the  <dig> modules for smite-r and smite-f, respectively, suggesting that host cell metabolism may be altered after infection. for smite-r, two modules enriched for cell cycle and apoptosis related effects confirming prior observations regarding t. gondii infection in host cells . in fig.  <dig> we show one cell cycle related functional module identified by smite-r that also indicates altered mapk signaling, a previously implicated feature in toxoplasmosis of mice  <cit>  and humans  <cit> . while it has been demonstrated that t. gondii infection of human cells induces host cell cycle arrest at g <dig>  <cit> , the identified module indicates that t. gondii may accomplish this through combined epigenetic dysregulation at promoters and transcriptomic dysregulation. in smite-f, three modules strongly implicate chromatin remodeling, epigenetic regulation of gene expression, and detection of pathogen dna in the cytosol, and in fig.  <dig>  we show an identified module with multiple epigenetic events at genes’ active and poised enhancers. results from the heinz algorithm are concordant in showing many cell cycle related pathways for the reduced model and additional altered cell signaling pathways in the full model . therefore, smite analysis suggests that t. gondii infection remodels the epigenome of the infected host and alters host gene expression, impacting host gene networks that regulate metabolism, intracellular signaling, and cell cycle progression, and these findings are part of a manuscript in preparation . to ensure robustness of results, we performed the analysis twice more, and despite using random sampling procedures at multiple points within smite, we obtained the same modules and module significance each time, indicating that smite results are highly reproducible. more detail about each module is given in additional file 2: tables s5–s <dig> and tables s7–s <dig> fig.  <dig> smite-identified module implicating cell cycle and mapk pathways. smite allows visualization of the relationship between each component score and the overall node score. this functional module is enriched in human genes that regulate cell cycle by altering cell survival and apoptosis consistent with the known property of t. gondii infection of human cells to induce host cell cycle arrest at g <dig>  the module shows mapk <dig> as a highly scoring gene  centered within the network


fig.  <dig> smite-identified module implicating chromatin regulation. the module centered around histones and their regulators is plotted in a circular layout in two modes, with  and without  component score details. we can see that many of these genes were implicated because of their component scores for gene expression and events occurring at enhancers




smite improves integrative genomics methods
we identified fem and bionet as computationally efficient methods to identify gene modules, and we designed smite to improve the gene scoring functionality of these technologies. while smite can serve as a wrapper for module-identifying functions of fem and bionet, there are several major shortcomings of these approaches, which we have addressed with smite. although these improvements preclude a direct head-to-head comparison of smite to other methods, a discussion of these improvements illustrates the novel aspects of smite as compared to state-of-the-art technology.

both smite and bionet use p-values as an input, while fem usually employs t-statistics that have been averaged over a region near the transcription stat site . by averaging t-statistics over a region directly adjacent to the tss, fem does not preserve the biology of epigenetic processes like dna methylation that may occur far from the tss and may not occur equally throughout a region. though fem is not limited to t-tests, the algorithm assumes sample normality and uses scaling of the relationship between dna methylation and expression by the ratio of the t-statistic variances – a technique that is optimal for combining t-tests. therefore, fem is only functionally optimal for analyzing t-tests, which is often inappropriate in genomics considering data distributions and the necessary adjustments for confounders such as experimental batch effects  <cit> . thus, the p-value is a more versatile input because it can be derived from different statistical methods depending on each individual experiment.

fem can only integrate one epigenetic modification, usually dna methylation, with gene expression. if a researcher wanted to compare multiple types of epigenetic data with expression and with each other, it would necessitate either pairwise comparisons between each epigenetic dataset and expression, which would hinder the overall study interpretation, or manual selection of a single p-value for each gene, which would bias the findings. though bionet allows several p-values to be associated with a gene so that more than one epigenetic modification could be integrated, it does not have an implemented method to arrive at a single summary statistic or p-value for the epigenetic modifications, again requiring manual curating of the input data. to address these major shortcomings, smite uses a statistically sophisticated aggregation and normalization algorithm that that allows the user to input p-values and multiple genomic intervals, thus allowing simultaneous comparison of many types of data including, but not limited to, dna methylation, dna hydroxymethylation, and chip-seq peak data.

bionet does not incorporate the effect direction its scoring method, and fem incorrectly assumes that the epigenetic modification statistic will always have an inverse relationship with gene expression, which oversimplifies the complexity of gene expression regulation. to address this limitation, smite is novel in allowing the user to adjust the directionality of an epigenetic modification’s relationship with gene expression in a genomic context-dependent manner.

in addition, fem has a very specific input structure that requires rows of the dna methylation data, expression data, and graph objects to have matching entrez gene ids. unfortunately, this may not be straightforward to assemble and will negatively select genes that only have partial data  or are not part of an interaction network. functionally, each fem analysis becomes centered around the nodes that are still available in a specific interaction network instead of centered around high scoring genes regardless of missing data. bionet employs non-parametric order statistics that ignore missing data. because smite uses a combined p-value for each node, it does not specifically require a high scoring node to have complete data. smite is also not limited by gene annotation  as a consistent set of identifiers is used. thus, smite allows for missing data and flexibility of gene annotation.

finally, fem and bionet rely on ranking genes based off the sum of their dna methylation and gene expression statistics and a combined p-value, respectively. in contrast, smite is novel in allowing users to input a prioritization of genomic contexts relative to one another so that the identified functional modules reflect the researcher’s goals or intuition. therefore, the findings in smite are more robust for novel pathway discovery and exploratory analysis.

comparison of modules detected using smite and fem
though smite and fem are not directly comparable, having shown that smite can identify functionally important modules within the t. gondii hff data set, we aimed to demonstrate that smite-identified modules are not the same as those identified by fem. additionally, because the spin-glass algorithm can identify several modules compared to a single module in bionet, a comparison of the multiple identified modules between smite and fem allows more resolution. to compare smite and fem, we used the criteria defined in the fem vignette to associate genes with dna methylation. we calculated t-statistics with four degrees of freedom for gene expression and dna methylation analysis, and we associated dna methylation with genes by: 1) taking the average of all effects within 200 bp from a gene transcription start site , 2) if no effects were found, taking the average of effects over the first exon, and 3) if no effects were found, taking the average over 1500 bp around the tss. the r code that we used to run fem is shown in additional file 1: appendix  <dig>  the high-scoring genes identified by the three models  are listed in additional file 2: table s <dig>  we compare the fem model with the smite-r model, which is directly comparable because it equally weights gene expression and promoter dna methylation and in opposite directions, and the smite-f model, which incorporates additional information regarding gene enhancers.

we used the dofem.bi function in fem with the default settings provided in the fem package vignette. using fem we identified  <dig> modules that have between  <dig> and  <dig> genes . in summary, fem implicated  <dig> genes, only  <dig> of which overlapped those identified with the reduced smite model and  <dig> of which overlapped those identified by smite-f . therefore, since smite-f identified modules represent combined gene expression and dna methylation and dna hydroxymethylation at enhancers, and the smite-r and fem-identified modules only focus on dna methylation at gene promoters and expression, the techniques appear to identify largely different modules and genes. additionally, smite-r and fem models appear to also identify mutually exclusive genes. though fem does not have an implemented method to examine further pathway annotations, we annotated it using goseq and compared enriched pathways. in additional file 2: table s <dig>  it is apparent that all three models enrich for metabolism, signal transduction, and the immune system to some extent; however, while fem and smite-r model enrich for cell cycle regulation, only the smite models indicate transcriptional regulatory processes.fig.  <dig> smite comparison with fem. a an euler diagram showing that no genes were found by all three models: fem, smite-r, and smite-f. smite-f and smite-r overlap much more than either do with fem. b a comparison of the densities of all scores compared to genes identified within modules by smite-f , smite-r , and fem , indicating that there is a statistically significant enrichment for high scoring genes using smite even when using the reduced model




we then examined how each technique was able to enrich for high scoring nodes within identified functional modules. in fig. 8b we compare the density of all scores compared to the density of scores for genes within modules for fem, smite-r and smite-f. smite-r and smite-f have a statistically different distribution  test p =  <dig>  and p =  <dig> , respectively) of enriched genes compared to all scored genes whereas fem contains the equivalent of a random sampling of scored genes . the derivation of the ks-test significance for these tests is shown in additional file 1: figure s <dig> 

finally, in additional file 1: figure s <dig> we show the relationship between high scoring genes and the number of p-values associated with those genes. because the fem input involved averaging p-values in discrete regions around the tss, the highest scoring genes in fem tend to be biased by having more associated p-values when compared to high scoring genes in the full-smite model .

the limitations of fem make it impossible to perform a head-to-head comparison with smite to identify simulated effects occurring at putative enhancers and incorporating dna hydroxymethylation. nevertheless, assuming the existence of true functional modules that represent interconnected genes that are dysregulated by common epigenetic mechanisms within a pathway, smite enriches for genes that are high scoring and is, therefore, very sensitive and specific. in contrast, fem modules will tend to have many low scoring nodes, which may indicate that fem is not as sensitive, or there may be many more false positives within fem modules. fem genes are also biased by having a higher number of associated p-values. therefore, we conclude that the heuristic used to prioritize genes in smite employs a robust algorithm that integrates multi-level genomics findings and can identify novel functional modules that are both focused and meaningful.

CONCLUSIONS
current genomic experiments are underpowered to detect genomic events comprehensively within a network, and a functional module identified by smite is implicated by the cumulative evidence of varied input data over all of its members. modules implicate potentially important network members for which there may be no statistically significant evidence. thus, smite is a discovery platform to integrate multi-level genomic observations that represents a significant improvement over existing integrative genomics approaches. through smite, researchers can increase study power to find a single set of interpretable results integrating epigenomic and transcriptomic data sets.

additional files

additional file 1: supplementary methods. figure s <dig> proportions of rna-seq reads from t. gondii-infected hffs aligning to a composite hg19/toxoplasma genome. figure s <dig> comparison of distance weighting effect on gene scores. figure s <dig> representation of simulations demonstrating the effects on high scoring genes of variation of weightings. figure s <dig> comparison of gene scores with reduced and full smite models. figure s <dig> examples of modules generated by full and reduced smite models. figure s <dig> ks test results comparing smite and fem module genes and a random sampling of  <dig>  genes. figure s <dig> comparison of the performance of the full smite model with the fem model. table s <dig> criteria for defining genomic contexts in hffs. table s <dig> weighting criteria used for smite analysis of the t. gondii hff dataset. appendix  <dig> r code for analyzing t. gondii hff dataset with smite. appendix  <dig> r code for analyzing t. gondii hff dataset with fem. supplementary references 


additional file 2: supplementary tables. table s <dig> gene symbol and score of the high scoring genes using three different methods: smite full model, smite reduced model, and fem. table s <dig> modules discovered using fem and genes composing the modules with their dna methylation, expression, and overall statistics. table s <dig> modules discovered using the reduced model of smite  with spin-glass. table s <dig> modules discovered using the full model of smite  with spin-glass. table s <dig> pathways associated with the genes composing the modules discovered by fem. table s <dig> pathways associated with the genes composing the modules discovered by the reduced model of smite  using spin-glass. table s <dig> pathways associated with the genes composing the modules discovered by the full model of smite  using spin-glass. table s <dig> quantifying the number of times pathways were found to be associated the modules discovered by either fem, the reduced model of smite  using spin-glass, or the full model of smite using spin-glass. table s <dig> genes composing the “summary network” found by either the reduced  or full  smite models using the heinz algorithm. table s <dig> pathways associated with the genes composing the “summary network” discovered by the reduced model of smite using the heinz algorithm. table s <dig> pathways associated with the genes composing the “summary network” discovered by the full model of smite  using the heinz algorithm. table s <dig> genes composing the “modules” found using no weights instead of weighting by distance. table s <dig> pathways associated with the genes in the modules identified without using distance weighting. 




abbreviations
chipchromatin immunoprecipitation

femfunctional epigenetic modules

hffhuman foreskin fibroblasts

mcmmonte carlo method

smitesignificance-based modules integrating the transcriptome and epigenome

tsstranscription start site

