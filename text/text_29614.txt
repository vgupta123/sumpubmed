BACKGROUND
fungi are diverse and ubiquitous, having evolved over time to occupy a wide range of ecological niches. some fungal species are exceptionally proficient at surviving a broad range of environmental conditions. in nature, these species can inhabit latitudinal and altitudinal clines that span considerable temperature ranges  <cit> . individuals from species with broad ecological amplitudes exhibit local adaptation when divergent selection is strong relative to the rate of gene flow  <cit> . locally adapted individuals show higher fitness in their focal environment relative to immigrants. despite the wealth of studies investigating genetic structure and dispersal of fungi, the processes that shape adaptive genetic polymorphism in wild populations are not well understood.

environmental factors have been shown to be drivers of local adaptation in diverse fungi. for example, temperature differences are responsible for the maintenance of differentially adapted populations of pathogens  <cit> . temperature changes were also shown to be drivers of adaptation in natural populations of the saprotrophic fungus neurospora crassa, resulting in genomic islands of differentiation involved in cold-response and circadian rhythm  <cit> . differences in climate and soil salinity correlated with regions of extreme genomic divergence between coastal and montane populations of an ectomycorrhizal basidiomycete  <cit> . furthermore, experimental evidence suggests that salinity and temperature are drivers of ecological isolation in experimentally derived lineages of baker’s yeast saccharomyces cerevisiae  <cit> . in some cases, ecological divergence can promote reproductive barriers between populations of differentially adapted ecotypes  <cit> , as is the case in the filamentous fungus neurospora crassa  <cit> . overall however, adaptive genomic polymorphisms have been investigated only in a small set of fungal species and life styles.

lichen-forming fungi, which constitute about half of the described ascomycetes, are a nutritionally specialized group of fungi that form obligate symbiotic associations with green algae and bacteria  <cit> . lichens are suitable to study local adaptation because they can tolerate extreme environmental conditions and sustain growth despite frequent cycles of desiccation and rehydration, low nutrient availability, and large fluctuations in temperature . the distributional ranges of many lichens span broad climatic ranges . furthermore, long-lived, sessile organisms such as lichens experience strong selection pressures  <cit> . this may lead to reduced survival of maladapted individuals, and create steeper genetic gradients between differentially selected populations  <cit> . environmental stressors, such as drought and high-light conditions, have been shown to trigger physiological adjustments in different lichens . the genetic bases of these adaptive responses are currently poorly understood. many species of lichenized fungi show genetic differentiation among populations despite ongoing gene flow, even across thousands of kilometers. this suggests a role of spatially varying selection in maintaining biogeographic structure . interestingly, one study reported gene pool associations with altitude and interpreted this as evidence for climate-driven local adaptation  <cit> . however, no study so far has specifically addressed adaptive diversity in geographically close , but ecologically distant lichen populations.

altitudinal gradients are suited to study local adaptation because ecological transitions are typically steep and occur at relatively short distances, thus limiting the confounding effect of distinct regional evolutionary histories  <cit> . moreover, altitudinal gradients are also climatic gradients, characterized by decreasing temperature and atmospheric pressure, increasing relative air humidity, rainfall, and solar radiation with increasing altitude  <cit> . thus, adaptation along altitudinal gradients can be explored as a proxy model for genomic responses to climate change .

here we report on the population genomics of a lichen-forming ascomycete along an altitudinal gradient in the mediterranean region. as model, we chose lasallia pustulata , a species with a distribution from southern europe to northern scandinavia, which forms dense populations on exposed, siliceous rocks  <cit> . using genomic data from geographically close populations along a steep altitudinal gradient in northern sardinia , we analyzed whether genetic clusters were present, and whether relatedness between clusters was correlated with signatures of local adaptation. heat, drought, and radiation stress constitute determining factors in the composition of biological communities inhabiting rocky outcrops and boulders in mediterranean mountains  <cit> . therefore we tested the hypothesis that environmental factors shape genome-wide population differentiation in lichenized fungi which occur across different bioclimatic regions. specifically, we addressed the following questions: i) what is the genome-wide population structure and connectivity between geographically close populations along an elevation gradient?, ii) what are putative functions of highly differentiated genes between the genetic clusters?, iii) what are putative functions of the genes showing strong correlation with local climatic factors?, and iv) do individuals belonging to different genetic clusters  display fitness differences?

methods
study organism, study site, and sampling

lasallia pustulata is a foliose, rock-inhabiting, haploid lichen-forming ascomycete. individuals are attached to the substrate with a central holdfast. l. pustulata has a mixed strategy of asexual and sexual cycles. asexual reproduction via isidia – macroscopic dispersal units containing both symbionts that break off the mother thallus – is the typical  way of reproduction. isidia are considered to be detached from the thallus mainly by raindrops, and dispersed over short distances  <cit> . we collected samples from six populations along an altitudinal gradient in the limbara massif . the transect extended from lake coghinas  to punta balestrieri  covering a linear distance of ~ <dig>  km. intermediate populations were located at 297 m a.s.l. , 588 m a.s.l. , 842 m a.s.l. , and 1125 m a.s.l. . the maximal linear distance between populations was ~9 km . populations were located on horizontal or gently sloping, fully sun-exposed rock faces in scattered paleozoic granitic outcrops, and covered an area of ~50 m <dig>  for each population, we collected  <dig> thallus pieces of ~8 mm in diameter. our sampling design aimed at capturing the maximal diversity present at the sites. the minimum distance between sampled individuals was 50 cm to maximize the inclusion of different genets. samples were collected with sterile tools and transferred into sterile 2 ml tubes.fig.  <dig> location of the study site in north-eastern sardinia  and location of six populations of l. pustulata along the elevation cline. the numbers in the color legend refer to the bioclimatic zones by  <cit> :  <dig> - lower mesomediterranean-upper dry-weak euoceanic,  <dig> - lower mesomediterranean-lower sub-humid-weak euoceanic,  <dig> - upper mesomediterranean-lower sub-humid-weak euoceanic,  <dig> - upper mesomediterranean-upper sub-humid-weak euoceanic,  <dig> - upper mesomediterranean-lower humid-weak euoceanic,  <dig> - upper mesotemperate -lower humid-weak euoceanic,  <dig> - upper mesotemperate -lower humid-weak semi-continental,  <dig> - lower supratemperate-lower humid-weak semi-continental,  <dig> - lower supratemperate-lower hyperhumid-weak semi-continental. the color gradient represents the bioclimatic profile of the cline, ranging from mediterranean pluviseasonal oceanic   to temperate oceanic, submediterranean variant  , to temperate oceanic   climate




the study area encompasses three distinct bioclimates: i) mediterranean pluviseasonal oceanic , ii) temperate oceanic submediterranean , and iii) temperate oceanic    <cit> . temperature data collected between may 28th  <dig> and june 2nd  <dig> from loggers positioned at the level of l. pustulata thalli  indicate that localities  <dig> to  <dig> have higher summer temperatures and are less prone to freezing during winter than populations  <dig> and  <dig>  logger data also showed that temperatures of the rock surfaces to which thalli are attached frequently exceeded 50 °c in summer. the populations therefore experienced seasonal temperature fluctuations on the order of >40 °c .

dna extraction and genome resequencing
for each population, we extracted genomic dna separately from each individual using a ctab-based method  <cit> . dna concentration was measured with a qubit fluorometer . a pooled sample was created for each population containing equal amounts of dna from each sample . library preparation , sequencing on an illumina hiseq <dig> with 100 bp paired-end chemistry at ~90x coverage per population, as well as tags and adaptor removal were performed by genxpro gmbh .

genome annotation
as reference genome, we used the draft assembly of l. pustulata available at the european nucleotide archive . the draft genome is composed of  <dig> scaffolds  for a total length of  <dig>  mbp and an n <dig> scaffold of size  <dig> kbp. the genome is ~92% complete according to an assessment with the software busco  <dig>   <cit>  and a lineage-specific set of ascomycota single-copy orthologs.

for gene model prediction we used both ab-initio based methods and rna-seq derived transcript mapping onto the assembled genome following the method described in  <cit> . for this purpose, total rna was isolated from a thallus of l. pustulata collected near orscholz  in july  <dig> using the method by  <cit> , and purified using the rneasy minelute clean-up kit . paired-end sequencing was performed using illumina miseq  by starseq . rna-seq data was quality-filtered using trimmomatic  <cit> , with a length cutoff of  <dig> and a quality cutoff of  <dig> in a window of 5 bp.

we used blast2go  <cit>  to annotate the predicted protein sequences with gene ontology  terms and protein names using ncbi's nr database at an e-value cut-off of 1x10− <dig>  and default weighting parameters. we also annotated each protein with interpro domains using interproscan  <cit> .

snp analysis
we filtered out reads shorter than 80 bp, reads with n's, and reads with average base quality scores less than  <dig> along with their pairs using fastqfs  <cit> . trimmed paired-end reads of each pool were mapped to the l. pustulata genome using bwa-mem  <cit>  and default parameters. unambiguously aligned reads with a minimum mapping quality of  <dig> were extracted with samtools v <dig>   <cit> . reads were sorted and duplicates were marked with picard using the tools sortsam.jar and markduplicates.jar. single nucleotide polymorphisms were called with samtools . indels were detected and masked with popoolation  <cit>  using the scripts identify-genomic-indel-regions.pl  and filter-pileup-by-gtf.pl. the synchronized file was converted into a gene-based synchronized file using the script create-genewise-sync.pl in popoolation <dig>  <cit> . the coverage for each population was reduced to a uniform coverage of  <dig> with popoolation <dig> using the sync-file and the script subsample-synchronized.pl .

population genetics analyses
to characterize genome-wide patterns of variation, we estimated three population genetic parameters by accounting for pooling: i) π, a measure of polymorphism in a sample of sequences scaled to their length, ii) watterson's θ , a measure of the number of segregating sites, and iii) tajima's d, a measure of the skew of allele frequency distribution. all estimates were calculated in non-overlapping 10-kb windows across the genome using popoolation  <cit> , assuming a minimum count of two. differences in genetic diversity among populations were tested using linear mixed effect models in r  <dig> . <dig>  <cit> . for each diversity measure, models included population as a fixed effect predictor and incorporated scaffolds as a random effect across populations. pairwise population comparisons were then obtained from post hoc tukey contrasts of the respective model predictors  <cit> .

to identify strongly differentiated alleles, we adopted an empirical outlier approach. genetic differentiation  was calculated with fst-sliding.pl in popoolation <dig>  we only considered snps with a minimum count of  <dig>  a minimum quality of  <dig>  and falling into the upper  <dig> % tail of the fst distribution, corresponding to an fst threshold of  <dig> . highly differentiated snps were further inspected with fisher’s exact test  <cit>  to identify significant allele frequencies differences between population pairs using the script fisher-test.pl in popoolation <dig> and a bonferroni-corrected p-value of  <dig> . in addition, we estimated average fst across all polymorphic snps for each gene and only considered those falling into the upper 5% tail of distribution to be truly differentiated. based on this analysis, we calculated the percentage of overlap between snp-based and gene-based lists. snps were classified as genic and non-genic loci. genic snps were further classified as exonic, coding, and intronic. non-genic snps located in the 600 bp 5'-flanking sequence of each gene were considered putative promoter snps.

to visualize groups of populations with varying degrees of similarity to one another, we first obtained a reduced set of pairwise fst distance matrices based on sample quantiles  of the full set of distances across all polymorphic snps. the resulting set of pairwise  distances was then jointly analyzed using a three-way generalization of classical multidimensional scaling . distatis calculates a compromise distance space from the weighted average of all cross-product matrices derived from the set of quantile distance matrices. this compromise can then be used to visualize positional relations among populations  <dig> –  <dig> based on their genetic distances. moreover, we obtained 95% confidence intervals around each population's compromise position using bootstrap resampling  <cit> .

to reconstruct the historical relationships among populations using their current genome-wide allele frequencies, we used treemix v <dig>   <cit> . we created a maximum likelihood phylogeny of the populations based on all polymorphic snps, using blocks of  <dig> snps to account for linkage disequilibrium. to test for the presence of admixture and migration among populations, we calculated f <dig> and f <dig> statistics. these statistics are formal tests for admixture as they detect correlations in allele frequencies that are not compatible with population evolution following a bifurcating tree. to calculate f <dig> and f <dig> statistics we used the threepop and fourpop functions in treemix on all possible triplets and tetraplets population groups. to further explore population relationships, we calculated neighbor joining trees for the correlation matrix obtained with bayenv <dig>   and for the matrix of pairwise fst values calculated across all polymorphic sites using the package ape in r  <cit> .

to corroborate the hypothesis of admixture, we estimated gene flow among the three major groups  across multiple intergenic polymorphic loci using the coalescent-based method migrate-n  <dig> . <dig>  <cit> . we estimated relative effective population size  according to the relation θ = neμ, assuming identical but unknown mutation rates  in all populations. haplotypes  were obtained by parsing the output files of popoolation <dig> for genomic regions shorter than 90 bp, and containing three or more snps. to minimize the chance that the loci are linked, we retained only one such region per scaffold. this information was then used to extract the individual illumina reads covering this region from the mapping file for each population. the reads were aligned and trimmed to the informative region. the alignments were filtered for a minimum coverage of 15x, maximum coverage of 100x and minimum length of 20 bp in all populations. this resulted in a data set of  <dig> sequences from  <dig> loci, covering in total 1763 bp. all previously described steps were performed with custom python scripts . bayesian estimates of number of migrants  and θ were obtained under an unconstrained migration model with variable θ using migrate-n  <dig> . <dig>  <cit>  for each pair of genetic clusters separately. we used a uniform prior on both θ  and nm . a metropolis-coupled monte-carlo chain with static heating  was run for  <dig>  ×  <dig> generations, recording every 600th step after a burn-in period of 6 ×  <dig> generations. convergence was monitored with tracer . all effective sample sizes of the mcmc chain were larger than  <dig> 

environmental association analysis
to identify candidate loci for altitude specific adaptation, we correlated allele frequencies of populations with the environment using bayenv <dig>   <cit> . bayenv <dig>  models the sampling error of pooled sequencing, and accounts for the confounding effect of neutral, demographic signals. to summarize the climate along the cline, we used elevation and  <dig> bioclimatic variables from the worldclim database  <cit> . correlation among these was checked using the function rcorr in r  <cit> . elevation was strongly correlated with all bioclimatic variables. variation in the bioclimatic variables and elevation was thus summarized using pca, resulting in one composite climate variable explaining  <dig> % of the variance, hereafter referred to as env <dig> . to build the reference covariance matrix of population allele frequencies, we used a subsample of  <dig>  polymorphic snps based on  <dig> , <dig> mcmc iterations. to ensure convergence we estimated a second matrix from another subsample of  <dig>  snps. we explored gene-environment correlation by estimating the statistic z between allele frequencies of all snps and env <dig> per population for  <dig>  iterations. snps with the highest score possible for z  were considered as showing strong support for a non-zero correlation.

gene ontology enrichment
gene ontology  term enrichment is a technique for interpreting the functions of a set of genes making use of the go system of classification . in this system genes are assigned to predefined bins depending on their functional characteristics in a species-independent manner. an enrichment analysis will find which go terms are over-represented in a given data set using the annotations for that gene set. we used the r package topgo  <cit>  to search for an enrichment of different go categories. the analysis was performed for i) the set of genes containing snps falling into the upper  <dig> % tail of the snp-derived fst distribution, ii) the subset of these that are differentially fixed between the low altitude  and high altitude  genetic clusters, and iii) the set of genes containing the baynev <dig>  top 1% snps. all genes with a go annotation were used as background. significance for each go-identifier was computed with fisher’s exact test at α = 5%. we used the ‘elim’ method in topgo to iteratively remove genes mapped to significant go terms from more general terms, thus reducing the rate of false positives. only gos with more than three associated genes were considered. we used the revigo tool  <cit>  to produce summaries of non-redundant go terms grouped into functional categories.

ecophysiology
we performed ecophysiological experiments to assess differences in physiological traits in the populations. measurements were performed on three samples per population. for this analysis, we randomly selected specimens with a minimum diameter of 6 cm to have enough material to perform replicate measurements. to explore the genetic relatedness of the individuals we genotyped each specimen at six loci, covering a total of approximately  <dig>  kbp. we selected three of the loci from genes containing top  <dig> % differentiated snps, and three from those with top bayenv <dig>  snps. for primers and genetic characteristics of the loci see additional file  <dig> 

we investigated the thalli for differences in biomass and chlorophyll content per surface area. to calculate the specific thallus area , we first determined the thallus size by photographing wetted thalli on scale paper using a binocular microscope and the axiovision software . we determined the dry weights  of these thalli by weighing after 3 days of oven drying at 60 °c. we also measured thallus chlorophyll content according to  <cit> . statistical significance of differences in biomass and chlorophyll content between groups was determined using a mann–whitney test.

to characterize the physiological response to different light conditions, and different thallus water contents, we conducted co <dig> gas exchange measurements using a portable mini cuvette system . we measured the response of net photosynthesis  and dark respiration  to thallus water content  for a subsample of six thalli, representing the two main genetic groups present along the gradient. we measured complete desiccation cycles  at saturating light , ambient co <dig>  at 17 °c . we weighed the samples between each measurement and later extrapolated wc as a percentage of dw. we determined dw after 5 days in a desiccator over silica gel. we considered ninety percent of maximum np to be a reasonable estimate for optimal water saturation. we measured the samples at 3– <dig> h intervals for np and dr. immediately after each measurement we removed the samples from the cuvettes and determined their weight to calculate the decrease in wc. this process was continued for 97 h with each sample until co <dig> exchange ceased due to complete drying. statistical significance of differences in twc and maximum np between groups was determined using a t-test.

RESULTS
reference gene set
we identified a total of  <dig> genes in the l. pustulata genome. in total  <dig> genes were assigned a go term.

genome-wide variation
after adapter and quality trimming, we obtained  <dig> , <dig> paired-end reads .

to examine sequence variation, we used two estimates of nucleotide diversity, π and θw. when averaged for all 10-kb windows across the genome, estimates of π were highest in population  <dig> , and lowest in population  <dig> . estimates of θw were instead highest in population  <dig> , and lowest in population  <dig> . to examine deviation from neutrality, we calculated tajima's d in 10-kb windows across the genome. average d deviated from neutrality and differed significantly among populations. d was negative in populations  <dig>  and  <dig> , and positive in all other populations, being highest in population  <dig>  .table  <dig> sampling locations of lasallia pustulata populations and the mean and standard deviation for three standard population genetic parameters, π, watterson's θ , and tajima's d in nonoverlapping 10-kb windows across the genome of l. pustulata





patterns of genetic differentiation
among the six populations we identified  <dig>  polymorphic snps . mean pairwise fst based on all polymorphic sites was moderate with an average of  <dig> , and ranging from  <dig>   to  <dig>   .table  <dig> number of variants for all annotated features of the l. pustulata genome


aa , c 


fig.  <dig> pairwise fst comparisons of populations  <dig> to  <dig> across a total of  <dig>  snps. boxes extend from the first to the third quartiles, with a horizontal line indicating the median. the horizontal line across the graph indicates the top  <dig>  quantile 




a total of  <dig>  snps located in  <dig> genes fell into the upper  <dig> % tail of the distribution. of these,  <dig> snps in  <dig> genes were differentially fixed between the low  and high-altitude  population clusters. when calculating average fst across all polymorphic sites within a given gene,  <dig> genes fell into the top 5% tail. our snp-based approach detected  <dig> % of the highly differentiated genes.

we found strong genetic structure separating lower altitude populations  from the other populations. the multidimensional scaling of the fst quantile distance snp matrix illustrated the close genetic affinities of populations  <dig> to  <dig>  with population  <dig> occupying an intermediate position between these and population  <dig> . the tree-based analyses showed a similar, well-resolved structure , with the tree derived from the bayenv <dig>  correlation matrix showing longer internal branches . bayenv <dig> - and fst-matrices were highly correlated .fig.  <dig> 
a compromise configuration of categories between populations based on the fst quantile distance matrix for  <dig>  polymorphic snps, with 95% tolerance ellipses. b tree inferred with treemix for the six population of l. pustulata based on  <dig>  polymorphic snps. numbers at the branching points are support values from bootstrapping based on  <dig> runs




using the threepop test we found clear evidence of admixture at the level of population  <dig>  all population triplets having population  <dig> as the admixed group displayed significantly negative f <dig> values . this is in accord with the higher nucleotide diversity and positive tajima's d values for population  <dig> . we also found support for migration among populations as  <dig> out of  <dig> four-population tests rejected all possible tree topologies without migration . we inferred higher significance for pairs grouping together population  <dig> and  <dig> with one of the lower altitude populations, respectively , which is also in accordance with the proposed admixture scenario.

to further describe the migration pattern, we performed estimations of migration rates among the major genetic groups with migrate-n  <dig> . <dig>  mutation-scaled effective population sizes varied between groups, ranging from θ = ~ <dig>  in group a  to θ = ~ <dig>  in group b  . migration rates varied by several orders of magnitude. results supported the hypothesis that the genetic diversity of population  <dig> is the result of admixture from the other two genetic groups, while gene flow rates between the other groups are negligible in comparison. this is in line with the fst- and tree-based analyses.

candidate loci for local adaptation
to identify candidate loci for altitude specific adaptation, we correlated allele frequencies with an environmental variable summarizing altitude and climate using bayenv <dig> . a total of  <dig> snps showed the highest score possible for z and were located in  <dig> genes.

at the snp level, the overlap between the bayenv <dig> - and fst-based approaches was low . of these,  <dig> snps were located in  <dig> genes . genes containing top bayenv <dig>  snps matched  <dig> of the fst-based top 5% differentiated genes.

functional inference of candidate genes
gene set enrichment analysis of the  <dig> genes containing top  <dig> % snps indicated the presence of  <dig> enriched biological processes . these involve many pathways, some of which are centrally important for stress response, cell growth, carbohydrate transport, and both asexual and sexual reproduction. for example among the significantly enriched categories we found biological processed like response to abiotic stimulus, growth, gene expression, rna processing, translation, fungal-type cell wall polysaccharide biosynthetic process, catabolic processes, protein n-linked glycosylation, trehalose biosynthetic process, and developmental process involved in reproduction. go enrichment of the  <dig> genes containing snps differentially fixed between the low  and high-altitude  genetic groups resulted in  <dig> enriched biological processes, including sexual and asexual reproduction, trehalose biosynthesis, growth, response to oxidative stresses, cell wall and ribosome biogenesis, and gene expression .

go enrichment of the top 1% bayenv <dig>  snps indicated that  <dig> biological processes were enriched . among the biological processes likely involved in adaptation to altitude we found localization, signal transduction, dna repair, lipid modification, histone methylation, catabolic processes, and cell-wall biogenesis.table  <dig> go enriched categories for top 1% z bayenv <dig>  environmentally associated snps




ecophysiology
multi-locus genotyping grouped the samples into two genetic groups, one composed of all thalli from population  <dig> , and one composed of thalli from all remaining sites . differentiated snps in all six markers were monomorphic between the two groups . the genetic separation coincided with differences in anatomy and physiological responses to thallus water content  and high light conditions . first, g <dig> thalli had higher biomass , and higher chlorophyll a + b content per surface area unit  . second, g <dig> thalli needed higher wc for reaching maximal np  compared to g <dig> thalli . in addition, g <dig> thalli reached their maximum np rates  at lower light intensity  . in relation to surface area unit, g <dig> thalli fixed almost three times as much co <dig>  in relation to thallus dry weight g <dig> and g <dig> specimens did not significantly differ in their co <dig> fixation rates  .fig.  <dig> photosynthetic co <dig> gas exchange of l. pustulata highland  and lowland population  related to thallus water content . twc is expressed as mm “precipitation”. polynomic regressions lines are indicated with their r <dig> value. circles = net co <dig> uptake, triangles = dark respiration





discussion
temperature and precipitation drive large-scale distribution patterns of lichens. it is thus expected that much of the signal of adaptation among lichen populations should occur along these gradients  <cit> . here we presented the first genome-based analysis of population differentiation associated with an environmental gradient for a lichen-forming fungus. the studied populations underwent several generations of asexual reproduction, as only rarely sexual structures  were observed in any of the sites. thus, by applying pool-seq resequencing to large population samples, we were able to track the frequencies of diverged long-lived lineages in each of the sites, and describe genome-wide population divergence in relation to changes in altitude.

our study revealed significant differentiation and structure of l. pustulata populations. we found two genetic clusters along the gradient. one cluster is predominant at low elevations , while the other is predominant at high elevations . our data suggest extensive admixture of these clusters at ~1100 m a.s.l. given the high number of reciprocally fixed snps between the clusters and the high levels of clonal propagation in this fungal species, possible explanations for the observed pattern include ancient divergence, and a combination of limited gene flow, long generation times, and strong environmental filtering. unfortunately there are no estimates for sexual or asexual generation times in l. pustulata from which we could calculate the age of the split between the clusters. thus it is currently impossible to formally distinguish between the above scenarios. ancient population splits and high genomic divergence have been reported in non-lichenized fungi. for example, strong genomic divergence, evidence for ancient population splits and introgression between subpopulations were inferred for the human pathogens coccidioides immitis and c. posadasii  <cit> . strong genetic structure was also found in locally adapted subpopulations of neurospora crassa  <cit> . numerous theoretical and empirical studies suggest that strong population divergence among continuously distributed populations may be caused by selection along environmental gradients promoting adaptation to different environmental conditions and ultimately impeding gene flow . interestingly, the genetic clusters of l. pustulata correspond to the major bioclimatic zones covered by our transect, with their admixture zone coinciding with the transition between the mediterranean and the temperate-oceanic climate. therefore, environmental filters likely contribute to the observed genetic structure.

to search for loci putatively involved in environmental adaptation, we detected allele-climate associations. heat, drought, and intense light belong to the selective forces that cause differentiation among and within plant species in mediterranean ecosystems  <cit> . we thus expected to find diversifying selection in those loci associated with pathways of the fungal environmental stress response . the esr is in fact a common feature in the response of fungi to different environments, and it is responsible for initiating gene expression that protects the cell against stress  <cit> . in yeasts, the esr includes ~ <dig> genes and requires a coordinated effort from multiple pathways, including signal transduction molecules, enzymes involved in cellwall biogenesis and maintenance, genes responsible for regulation of transcription, post-translational modification, and enzymes with proteolytic or antioxidant activities  <cit> . we found representative genes of each of the above pathways in our set of candidates for altitudinal adaptation. one example is alpha-ketoglutarate-dependent dioxygenase, a gene that is involved in the catalysis of taurine. taurine is a solute required in osmoregulation, and has been linked to the survival of the fungus ochroconis mirabilis in different habitats  <cit> . in the same functional category, we found candidate snps in genes such as a flavin-binding monooxygenase, and in the putative essential subunit of u3-containing 90s preribosome , which has been reported among the  <dig> essential genes required for oxidative stress tolerance in saccharomyces cerevisiae  <cit> . additionally we found the calcium channel subunit cch <dig>  which has been reported to be involved in the ca2+ release in response to exogenous oxidative stress in yeast  <cit> , and a putative flap endonuclease, which is part of the base-excision repair pathway that removes lesions resulting from exposure to reactive oxygen species in yeast  <cit> . among the candidates involved in thermal stress response, we found the small heat shock protein hsp <dig>  glutamate carboxypeptidase, and a putative thermotolerance protein. other candidates for diversifying selection include genes involved in the regulation of gene transcription, in particular isw <dig>  a gene that functions in parallel with the nua <dig> and swr <dig> complexes to regulate stress-induced gene transcription via chromatin remodeling in yeast  <cit> ; interestingly, also swr <dig> was detected among the candidates. furthermore we found genes putatively involved in cellwall integrity and filamentous growth pathways , and in uv-damage response .

several of the top differentiated genes containing environmentally associated snps were also involved in the esr  <cit> . in particular we found genes linked to signal transduction and cell-wall integrity pathways, such as the transmembrane cellwall sensor wsc <dig>  a mapkkk-cascade protein kinase, a two-component osmosensing histidine kinase, and a calcium/calmodulin-dependent kinase . camk proteins were reported to be involved in thermotolerance and oxidative stress survival in neurospora crassa  <cit> . the presence of a putative trehalose-phosphate synthase, and of a number of ribosomal proteins genes, rna helicases, and thioredoxin among the candidates suggests that many genes involved in redox homeostasis and also important for cold-shock response are putative targets of selection  <cit> . it is therefore tempting to speculate that adaptation to different temperatures, in particular cold-shock, is a driver of population differentiation in l. pustulata, given a difference of ~6 °c in the mean annual temperature between top and bottom of the cline, and frequent winter frost above 1100 m a.s.l.

the overlap between environmentally associated snps and fst-based outliers was low in our study. as in other studies of local adaptation , different approaches to identify candidate loci yielded different sets of candidates. this is probably due to the effects of population structure, and the parameters used for the environmental correlation. the limited overlap between sets of outliers indicates that selection along the gradient occurs mainly at the scale of local populations, and only partially at the evolutionary scale of the ancestral genetic groups  <cit> . another reason for this difference may be attributed to the presence of environmental drivers that do not covary with chosen environmental factors, either biotic , or abiotic . in addition, covariance of population structure with the environment has been shown to make the method correcting for neutral population structure over-conservative  <cit> . thus, candidates identified via methods that do not adjust for population structure should not be ignored, just treated carefully as their interpretation is necessarily post hoc. future studies of l. pustulata will have to include more populations and replicate independent clines to fully disentangle demography from local selection.

many candidate genes have known roles in stress response and growth regulation, and it is thus tempting to hypothesize that variation at these loci might affect fitness-related traits. our ecophysiological experiments showed the presence of genetic lineages with differential fitness under different environmental conditions along the cline. the high altitude group seems to be better adapted to more humid conditions and to lower light intensities than the lowland group. in particular, samples from this population had thicker thalli and thus more biomass per area unit. in poikilohydric organisms such as lichens, an increased fungal biomass may be beneficial at wetter high-elevation sites and where winds speed up drying, especially on the exposed rocky outcrops where the species lives. this is because a higher fungal biomass may lead to i) higher mechanical stability against mechanical damage, ii) prolongation of the wet phase for an increase of the active period  <cit> , and iii) acceptance of higher thallus water content  <cit> . the latter point is supported by our finding that high-altitude individuals need more water for maximal net photosynthesis than low-altitude ones. moreover, under similar light and humidity conditions, low-altitude individuals would eventually die because of respiration rates exceeding carbon fixation rates. structural changes towards improved thallus hydration in relation to improved photosynthetic exploitation were shown to drive acclimation in populations from different slopes in ramalina capitata  <cit> , between vagrant and attached morphs of cetraria aculeata  <cit> , between shaded and exposed populations in the antarctic endemic catillaria corymbosa  <cit> , and between populations from different biomes in psora decipiens  <cit> . thallus thickness is a property controlled by the mycobiont and thus is related to the mycobiont’s response capability to environmental conditions  <cit> . future genome-wide studies on the photobiont are required in order to elucidate the relative role of each symbiont in shaping the lichen’s response to the environment. studies on the ecological benefits of phenotypic plasticity in lichens are still in their infancy, and the genomic basis of physiologically-relevant traits is far from being understood. our results suggest that a surprisingly high, possibly adaptive, genetic diversity is responsible for anatomical and physiological differences between ecomorphs of a morphologically homogeneous lichen species. further genomic research and physiological experiments based on replicate populations from different geographic areas, and comparisons with other lichen species will enable us to test the aforementioned hypothesis.

adaptation to divergent environments promotes environmental specialization and reproductive isolation among fungal populations  <cit> . in fact, the exclusion of immigrating individuals due to higher fitness of local genotypes  can also lead to reproductive isolation resulting in little or no effective gene flow between geographically close populations  <cit> . this process, known as ecological speciation, interprets reproductive isolation as a by-product of adaptation to divergent environments. our analysis of fixed variation between the highly differentiated genetic clusters of l. pustulata showed that several genes involved in sexual reproduction were significantly enriched, supporting the hypothesis of reproductive isolation. this is interesting, because we did not observe morphological evidence for sexual reproduction, such as presence of apothecia. additional indication for reproductive isolation stems from the observation that genomic divergence between clusters is not limited to a few genomic areas, but rather widely dispersed across the genome. it involves many pathways centrally important for the response to environmental signals and stress, gene expression, growth, and metabolism. overall, the high level of genomic divergence, and the presence of physiological differences between genetic clusters suggest the existence of l. pustulata ecotypes adapted to the mediterranean and temperate-oceanic bioclimatic zone.

CONCLUSIONS
pool-seq genome resequencing is a cost-effective and powerful approach to assess allelic diversity in populations, and to identify genes that are potentially under selection . however, this method also has limitations, mainly associated with the increased impact of sequencing errors and resampling of alleles. to circumvent these issues, we created equimolar genomic libraries based on high sampling density, sequenced each population at high coverage, and used strict thresholds for sequence quality filtering. furthermore, we based the calculations of genetic diversity measures on subsampled data to avoid coverage bias, and used analysis tools specifically adapted to pool-seq data. an intrinsic limitation of pooled sequencing is the loss of linkage disequilibrium information. the proposed candidates may not be under selection but may have been detected because of being linked to the actual targets of selection, or to other loci that diverged because of different evolutionary processes . this limitation can only be overcome by using different sequencing strategies, such as genome resequencing of individuals.

our exploratory work into the genomics of adaptation of a lichen-forming fungus reveals numerous loci and pathways putatively involved in environmental adaptation, including many loci shown in other fungi to be linked to temperature and uv-radiation stress response. such genes provide excellent targets for further investigations. future studies based on individual genotyping, possibly including replicate populations from different regions, additional physiological analyses including more samples, and quantitative trait locus mapping experiments of the candidate genes in controlled and field settings will help to elucidate the drivers of local adaptation in this and other fungal species.

additional files

additional file 1: temperature data  collected between may 28th  <dig> and june 2nd  <dig> from loggers positioned at the level of l. pustulata thalli . 

 
additional file 2: plot of the first two axes of a pca showing high correlation between  <dig> bioclimatic variables and altitude for the six populations along the cline. 

 
additional file 3: genetic characteristics of the six loci used to genotype 18 l. pustulata samples for anatomical and physiological measurements. 

 
additional file 4: distribution of nucleotide diversity, measured as tajima's d, across  <dig> non-overlapping sliding windows of 10-kb. for the six scatterplots on the left, the data are plotted in ascending order of mean diversity across the six populations  together with the respective 95% confidence interval . black crosses depict population-specific outlier snps. for the boxplot on the right, the data are summarized for each population across all windows. 

 
additional file 5: a) the mean and standard deviation for three standard population genetic parameters, π, watterson's θ , and tajima's d in non-overlapping 10-kb windows across the genome of l. pustulata. b) pairwise tukey contrasts based on linear mixed effect models for each measure and population. 

 
additional file 6: nj trees of the correlation matrix obtained with bayenv <dig>  and the pairwise fst values. 

 
additional file 7: average pairwise fst  and pairwise correlations of bayenv <dig>  correlation matrix among allele frequencies . 

 
additional file 8: three- and four- population test of the l. pustulata populations. the test was performed on  <dig>  high confidence snps. bold values indicate significant f <dig>  or f <dig> statistics . 

 
additional file 9: parameter estimates from migrate-n based on  <dig> loci for pairs of three genetic groups of l. pustulata found along the altitudinal gradient . 

 
additional file 10: allele frequency and annotation for the  <dig> environmentally associated , highly differentiated  snps. 

 
additional file 11: go enriched categories for a) top  <dig> % highly differentiated snps, b) top  <dig> % highly differentiated snps differentially fixed between populations 1– <dig> and population  <dig>  

 
additional file 12: list of significantly enriched go terms for environmentally associated genes. gene names in bold indicate genes containing top z bayenv <dig>  snps. 

 
additional file 13: neighbor-joining tree of the aligned concatenated gene fragments of the six loci at which we genotyped  <dig> thalli l. pustulata used for the anatomical and ecophysiological measurements. samples in bold and underlined  were used for the gas exchange experiments. 

 
additional file 14: light , temperature  curves for  <dig> thalli representing two genetic groups . 

 
additional file 15: net photosynthesis at optimal thallus water content and optimal temperature for genetic group a  and b . 

 


