BACKGROUND
the low cost and high throughput of next generation sequencing has led to numerous reference genomes and resequenced genomes being published  <cit> . however, almost all of these projects neglect the fact that diploid organisms contain two genome copies and consequently what is published is a composite of the two. this means that the relationship between alternate alleles at two or more linked loci is lost. humans typically carry 250– <dig> loss of function variants most of which exist as heterozygotes  <cit> . if two deleterious mutations are both heterozygous within the same gene and the deleterious alleles are both on the same chromosome then the individual will still have one non-affected copy of the gene and there may be no phenotypic consequence. however, if the individual is a compound heterozygote and both gene copies contain a deleterious allele then the activity of the gene product may be severely compromised, with detectable phenotypic consequences.

the phase relationship between common alleles can be recovered using population or pedigree data based on linkage disequilibrium or co-segregation, respectively. however, it is becoming increasingly apparent that a substantial amount of the phenotypic variation within populations is attributable to rare genomic variants  <cit>  and the haplotypes on which these variants lie cannot be reliably inferred from genotypes at common marker single nucleotide polymorphisms . diploid genome sequences have been published using a range of techniques; however, with the exceptions of  <cit>  and  <cit>  they require either large amounts of data, complex sample preparation or purpose built equipment, placing the method beyond the reach of most laboratories.

there have been multiple reports of sequencing from single cells  but few have gone on to sequence single chromosomes. the simplest strategy is to use single sperm. individual sperm have been separated on a custom-built microfluidic device for whole genome amplification and sequencing  <cit> . the use of haploid gametes considerably simplifies the complexity of downstream data analysis and provides access to whole chromosome haplotypes, however gametes cannot practically be recovered from females and are difficult to obtain from many male animals. for example, males of many livestock species are castrated or slaughtered before sexual maturity and even intact bulls require training to donate semen for artificial insemination and consequently semen is usually only available from elite animals. individual chromosomes from diploid cells have also been recovered and amplified using a custom built microfluidic device; however, the required equipment is currently restricted to a single laboratory  <cit> .

haploid sequences have been obtained by sequencing dna diluted to less than a haploid genome per aliquot . however kaper et al.  <cit>  acknowledged the difficulty of obtaining accurate dilutions at very low concentrations. furthermore, the extraction, dilution and necessary mixing are likely to shear the dna leading to short scaffolds, which requires more data for assembly and results in a greater difficulty in phasing across repeats or extended regions of homozygosity where there are no informative snp for joining scaffolds. regions of homozygosity are particularly likely in livestock where large numbers of animals are bred from semen from elite sires leading to significant levels of inbreeding. we have developed a single cell isolation protocol that allows the accurate selection of appropriately diluted dna whilst minimizing the number of pipetting steps that might shear the dna. this approach overcomes many of the difficulties in the method of kaper et al.  <cit>  and is potentially automatable using cell sorting devices. we have also developed a collection of open source java and perl software for processing the data and obtaining a rich set of metadata and quality metrics .

we tested the method with three sets of samples: 1) diploid sequence of an angus steer using 75 bp fragment reads that was validated against illumina bovinehd snp  haplotypes imputed by beagle  <dig> . <dig>  <cit>  without using pedigree information; 2) the diploid sequence of an angus bull with dna obtained from sperm using 75 bp fragment reads; 3) partial diploid sequences of  <dig> east african zebu cattle obtained from  <dig> libraries of  <dig> × 100 bp paired end reads to discover common haplotypes. finally, the diploid sequence of a single east african zebu  cow obtained from  <dig> × 100 bp paired-end reads from  <dig> fosmid pools was also obtained to validate the software  <cit> .

RESULTS
isolation and amplification of aliquots of single cells
diploid sequence of an angus steer
analysis pipelines were developed using the 75 bp fragment reads for the angus steer. the following results are from those data unless otherwise stated.

forty aliquots each predicted to contain a single cell were prepared from the angus steer  <dig>  seven of the  <dig> test genomiphi amplifications produced readily visible products on an agarose gel. no dna was detectable by agarose gel electrophoresis in the remaining reactions . the lower than expected proportion of positive reactions suggests that the cells were more diluted than predicted by counting on the haemocytometer and that therefore there was even less chance than expected of two cells being in the same reaction. the remaining lysate from the seven positive samples was divided into five aliquots and amplified with genomiphi. thirty of these  <dig> reactions had products that were detectable by fluorescence spectroscopy  with a mean concentration of 33 ng/μl .fig.  <dig> genomiphi products from test amplifications from 1/6th of the lysate of an individual cell. amplifications gave either clear negatives or clear positives



a second genomiphi reaction was performed on the genomiphi product of all positive samples and this product was used to screen the genome by pcr at  <dig> loci to estimate the proportion of the genome that was represented in each sample. there was a mean of  <dig>  pcr positive loci  for each subcellular sample. there was no correlation between the concentration of the genomiphi product from a subcell and the number of pcr positive loci . the observed mean of  <dig> positive loci is less than the expected mean of eight, which would represent 1/3rd of the haploid genome . this may be a consequence of the dropout of genomic regions that is frequently observed when using phi <dig> to amplify trace amounts of dna but is consistent with the subcellular samples being derived from the dna of less than a single cell. thirty-one subcellular samples that produced between  <dig> and  <dig> positive pcr reactions were chosen for library preparation and sequencing to obtain 75 bp fragment reads on an abi  <dig>  a bulk genomic dna sample was also sequenced to obtain  <dig> × 100 bp paired end reads on an illumina gaii instrument.

the semen sample from the angus bull was diluted in the same way as the lymphocytes and  <dig> aliquots each expected to contain a single cell were amplified with genomiphi. seventeen of the  <dig> reactions generated detectable product and nine of these were selected for sequencing together with a sample of dna amplified from  <dig> cells.

sequence data
the expected genomiphi product length from whole genomic dna was > 10 kb and this was observed in agarose gels of genomiphi products suggesting that degradation of chromosomal dna during cell lysis and dilution had not reduced its mean size to less than 10 kb.

in order to create a reference with best possible mapping characteristics the  <dig> × 100 bp paired end reads of the bulk genomic dna sample were first mapped to umd <dig>  bovine genome assembly with bwa and snp were called using gatk. a modified reference sequence was then generated with iupac redundancy codes for heterozygous snp using bcftools “consensus.” reads from the subcellular libraries were mapped to the modified umd <dig>  assembly using bwa. contigs of overlapping mapped reads were obtained with the purpose written picard module “contigmetrics.” this showed that each subcellular library covered a mean of  <dig>  % of the genome. this is less than the expected 33 %  suggesting that the remaining 19 % of the genome was in regions derived from both chromosomes, not sequenced due to low depth of coverage for each library or lost to drop-outs in the amplification or during the sample preparation process.

phi <dig> amplification from trace amounts of dna is expected to give rise to very uneven coverage with some regions having very high coverage and others very low or none  <cit> . the coverage distribution was obtained by summing the coverage distributions for all  <dig> subcellular libraries and was compared to the expected poisson distribution. the two distributions differed substantially, with many more regions with low and high coverage observed in the data than expected from a poisson distribution with the same mean .fig.  <dig> histograms of read coverage of 75 bp fragment reads from the angus steer obtained by summing coverage data from all  <dig> subcellular libraries of diploid cells and separately for the bulk genomic library. the histogram shows the percentage of the genome at different coverages between one and  <dig> x. the observed coverage is shown as columns, whilst the expected random poisson distribution of coverage with mean derived from the data is shown as a line. the observed coverage was truncated at  <dig> x for clarity, but 17 % of the genome had coverage >  <dig> x. the coverage of the bulk genomic dna is only slightly broader than expected from the poisson distribution, but coverage from fractions of cells is highly skewed



contigs from diploid cells had an n <dig> length of 359 bp and a read coverage of  <dig>  x. given the low and skewed genome coverage , it was expected that clusters of contigs would be observed with small gaps between contigs from a single amplicon and large gaps between contigs mapping to adjacent amplicons. this would give rise to many short gaps between contigs from the same amplicon and large gaps between contigs from adjacent amplicons. groups of contigs could then be classified as scaffolds. figure  <dig> shows histograms of percentages of total gap length in bins of 100 bp and of percentages of the total gap count in bins of 10 bp. eighty percent of the total gap length is in gaps > 3000 bp but 50 % of gaps are less than 80 bp. this shows the expected skewed gap distribution with many small gaps between contigs from the same amplicon and large gaps between contigs from different amplicons. however, there was no clear discontinuity in the distributions that could be used to define a threshold gap length below which contigs could be joined into scaffolds. the problem was therefore to identify a rational strategy for joining contigs into scaffolds.fig.  <dig> histograms of lengths and counts of gaps between contigs. note the 4-fold difference in x axis scale of the two plots: gap lengths are in bins of 100 bp and gap counts are in bins of 20 bp. panel a shows the first 20 % of gap lengths  and panel b the first 92 % of gap counts . panel b also shows the expected distribution of gap counts if they were exponentially distributed first using the global mean gap length of 584 bp and second using the mean length of gaps < 1000 bp 



gaps between contigs were assigned to 1000 bp bins and the mean gap length in each bin was obtained. for bins with gap lengths > 1000 bp the mean gap length was close to the midpoint of the bin size , however the mean length of gaps that were < 1000 bp was 144 bp . therefore it appeared that gaps greater than 1000 bp were approximately randomly distributed and those that were less than 1000 bp were highly skewed in length.

if junctions of contigs and gaps were randomly distributed they would be expected to follow a poisson distribution  <cit> . block lengths would then be expected to follow the inter arrival distances represented by a poisson process which are exponentially distributed  <cit> . figure 3b shows that the number of small gaps exceeded the numbers expected under an exponential distribution. the number of large gaps also exceeds the numbers expected under an exponential distribution. there were more gaps with lengths greater than 3424 bp than expected using the global mean gap length of 584 bp and more gaps with lengths greater than 468 bp than expected using the mean length of gaps < 1000 bp . these deviations are consistent with the expectation that contigs will be clustered with short gaps between them and that clusters of contigs will have larger distances between them. this justifies the joining of clusters of contigs into scaffolds.

the sensitivity of n <dig> scaffold length and total length of all scaffolds to variation in the maximum gap length for joining adjacent contigs into scaffolds was tested using threshold gap lengths from  <dig> to 2000 bp in increments of 100 bp for chromosome  <dig> . the n <dig> scaffold length increased almost linearly with increasing threshold gap length, however the rate of increase in total length of all scaffolds from a library declined as gap length increased, particularly after about 600 bp. this is presumably a consequence of a decline in the length of gap relative to the length of contig and scaffolds as more scaffolds are joined. the effect on n <dig> scaffold size of using an absolute gap of 1000 bp or a gap of the mean +  <dig> standard deviations  ≈ 652 bp for each library and chromosome was compared. the n <dig> scaffold size for scaffolds assembled using gaps < 1000 bp was  <dig>  kb and for scaffolds assembled with gaps <  ≈ 584 bp was 18 kb, a difference of 33 %. for chromosome  <dig> the mean total length of scaffolds in each library for scaffolds assembled with gaps <1000 bp was 19 mb  and for scaffolds with gaps <  was  <dig>  mb a difference of 20 %. the 20 % increase in total scaffold length when threshold gap length was increased by 71 % indicates that scaffold construction is relatively insensitive to the threshold gap length and hence that the precise choice of gap length is not critically important for scaffold construction. the subsequent snp haplotype construction was performed with a fixed threshold of 1000 bp for joining scaffolds.fig.  <dig> effect of using different maximum gap lengths for joining contigs into scaffolds for chromosome  <dig>  n <dig> scaffold lengths increase almost linearly , whilst total length of scaffolds grows logarithmically  +  <dig>  × 107; r2 =  <dig> ) as the size of scaffolds being joined gets larger relative to the gaps between them. note that n <dig> scaffold length  is plotted against the left hand y axis and total length of scaffolds  per library against the right hand y axis



effect of repeats on contigs and scaffolds
contigs and scaffolds that fall within repeats could compromise the construction of snp haplotypes since the reads could have been incorrectly mapped and repeat regions can give rise to false snp calls. to discover whether contigs or scaffolds were affected by repeats, the numbers of contigs and scaffolds in, or overlapping, repeats were calculated for chromosome ten and compared with the number of contigs that would be within repeats if the same scaffolds were randomly placed . there were  <dig>  times as many scaffolds wholly within repeats in the observed data  as there were in the random data . the scaffolds that were wholly within a repeat were also about one fifth the length of other scaffolds  in both random and observed data sets. the large excess of scaffolds wholly within repeats in the observed data suggests that many of these are mapping artifacts and that they should be excluded from the analysis. the excess of scaffolds in repeats was not reflected in an excess of contigs in repeats which was much lower  and therefore contigs in repeats were retained for scaffold construction but scaffolds wholly within repeats were removed from the subsequent analysis. scaffolds in repeats tended to be short in both observed and random data and this is probably a consequence of the relatively short average length of repeats .table  <dig> observed and expected scaffolds in repeat regions. counts and lengths of scaffolds with different interactions with repeats. there are  <dig>  fold more scaffolds entirely within repeats than would be expected by chance


1mean scaffold lengths reported here are much shorter than the mean scaffold sizes reported in table  <dig> from which scaffolds less than 1 kb have been removed



snp data
input files for the single individual haplotyper  programme were prepared using buildrefhapinput.v <dig> .jar. scaffolds were checked for excess heterozygous snp before inclusion in the sih input. only loci that were heterozygous in both the bulk genomic dna sequence data and had both alleles represented in the subcellular libraries were taken forward for snp haplotype assembly. before assembly, loci were tested against two quality criteria and loci failing these tests were excluded from the haplotype construction.

if contigs were randomly placed across the genome and each subcellular library contained 1/6th of the cellular genome then it would be expected that about 9 % of the contigs would represent both orthologous chromosomes and might therefore contain true heterozygous snp 2 =  <dig>  % of the genome will be heterozygous but this is ~9 % of a sample that had gone into the library). for each subcellular library ~8 % of loci that were heterozygous in the bulk dna were also heterozygous in that library; about the expected number. apparent heterozygotes can also be a consequence of copy number variants , repeats and sequencing errors. the coverage of all loci that were heterozygous in the sequence obtained from bulk genomic dna was obtained and plotted against the number of libraries for which there was a heterozygote call at that position . there was a strong correlation between coverage and the number of libraries that were detected as containing a heterozygous snp at that position . this would suggest that at least some of the heterozygous snp calls were artefacts of cnv or expanded repeats in the tested animal or collapsed repeats in the reference genome assembly.fig.  <dig> coverage at snp loci in bulk genomic dna data plotted against the number of subcellular libraries in which heterozygotes were found. the strong correlation between depth of coverage in the bulk genomic dna sample and number of heterozygote containing subcell libraries  suggests that increasing copy number causes more libraries to contain contigs representing that region



there was a more complex relationship between the number of subcell libraries represented at a locus and the depth of coverage in the bulk genomic dna sample. coverage was between  <dig> and  <dig> fold up to about  <dig> libraries at a locus. howevever at loci with more than  <dig> libraries represented the coverage in the bulk genomic sample rose steeply suggesting that these loci are associated with cnv .fig.  <dig> association between coverage in the bulk dna sample and number of subcellular libraries represented at the locus. coverage is constant up to about  <dig> libraries at a locus. at loci with more than  <dig> libraries represented the coverage in the bulk genomic sample rises steeply suggesting that these loci are associated with cnv



up to six libraries were prepared from each cell, but only two contigs should be found covering any given genomic region in the sequence from a single cell. it is possible to obtain more than two copies if the region has a copy number greater than  <dig> per chromosome. higher numbers of copies of a region would lead to more libraries containing contigs across the region and hence the observed association between numbers of libraries containing heterozygotes and coverage. approximately  <dig>  % of the angus genome is associated with cnv > 20 kb and more is associated with smaller cnv  <cit> . in total, 46 % of the genome was classified as repetitive by repeat masker with a mean repeat size of 229 bp and a maximum of  <dig>  kb. some heterozygous snp in subcellular libraries are therefore to be expected as a consequence of cnv and repeats and are not necessarily an indicator of both chromosomes being represented in a library. scaffolds that contained more than three heterozygous loci or that had a heterozygote frequency greater than  <dig>  were removed by buildrefhapinput.v <dig> .jar. these parameters were chosen after inspection of a small number of clearly mixed  scaffolds. this procedure removed 93 % of all heterozygotes in the data set and involved deleting  <dig>  % of the scaffolds. this filter should remove scaffolds that genuinely are a consequence of both orthologous chromosomes being represented in the library and also scaffolds affected by repeats and cnv.

for any pair of adjacent snp loci with alleles a/a and b/b there are  <dig> possible haplotypes , only one or two of which should be present in any given diploid animal. the number of haplotypes was counted for all pairs of adjacent loci on chromosome  <dig> . four percent of the two snp haplotypes had >  <dig> alleles but after filtering to remove both loci, over 90 % of the new two snp haplotypes that spanned the original locus had two or fewer alleles leaving only  <dig>  % of two snp haplotypes with >  <dig> alleles. these residual anomalous loci were not further filtered. this procedure for removal of anomalous loci was applied to all chromosomes using buildrefhapinput.v <dig> .jar. the number of subcellular libraries at loci with >  <dig> two snp haplotypes was compared with coverage. the coverage at loci with >  <dig> two snp haplotypes increased directly with the number of subcellular libraries which contained these loci . this suggests that these loci are caused by cnv, repeats or reference genome assembly errors rather than sample contamination.table  <dig> counts of two snp haplotypes. counts of two snp haplotypes with 1– <dig> alleles for chromosome  <dig> before and after filtering to remove the loci with more than two  <dig> snp haplotypes. removing any pair of adjacent loci creates a new two snp haplotype. but the efficacy of the filtering is indicated by the 90 % reduction in loci with >  <dig> haplotypes after filtering



validation
haplotypes were validated in three ways: first by testing for self-consistency of scaffolds; overlapping scaffolds from the  <dig> subcellular samples should either have all the same genotypes or all different genotypes. second, scaffolds were tested for consistency with haplotypes constructed independently by beagle using data from the illumina 770 k bovinehd snp chip. third, haplotypes constructed using sih which uses snp to join scaffolds on the same haplotype were also compared against the 770 k snp beagle phased haplotypes.

for each approach two measures of consistency were obtained as previously described  <cit> . when comparing two scaffolds derived from the same animal all snp alleles should be the same or all should be different since the scaffolds will be derived from the same or different haplotypes. the first measure of consistency was the greater of the percentage of positions that were identical or different in two scaffolds. however, if an error occurs during scaffold reconstruction then multiple contiguous alleles will be out of phase with the preceding alleles. kaper et al.  <cit>  described these as a “switch errors”; defined as two or more adjacent loci that were out of phase with the preceding loci. switch consistency was calculated by disregarding switch errors and only counting single isolated loci that were out of phase with neighbours on both sides as an error. the effect on the two measures of consistency of using maximum gap sizes of  <dig> to 5000 bp for joining contigs to form scaffolds was also examined. as the maximum gap sizes for joining contigs increases more switch errors are likely to occur and the difference between the two error rates can be used to identify an appropriate maximum gap length.

table  <dig> shows the percentages of both types of errors for the three tests of consistency described above for the five maximum gap lengths. in addition, the consistencies obtained after using targetcut to assemble scaffolds were also obtained. self-consistency between scaffolds from different libraries was 99 % with a 1 kb gap length. as expected, self-consistency declined when using larger maximum gaps between contigs for scaffold construction but only to  <dig>  % for a 5 kb maximum gap. consistency when disregarding switch errors remained constant indicating that the decline in the uncorrected consistency score was due to inappropriate joining of contigs on different haplotypes. the uncorrected consistency of the scaffolds against the illumina bovinehd snp haplotypes was  <dig> –96 % and 97 % for the corrected consistency. finally, the uncorrected consistencies of sih constructed haplotypes against the illumina bovinehd snp haplotypes were 89–96 % and after correction was ~97 %. scaffolds obtained with targetcut had consistencies similar to those obtained with gaps of 2 kb using contigmetrics.table  <dig> haplotype consistency after using five different maximum gap lengths for joining contigs into scaffolds. haplotype consistency with and without corrections for switch errors for five different maximum gap lengths for joining contigs into scaffolds for chromosome one. the consistency values for all chromosomes with the default distance of  <dig> is shown in the top line for comparison. the relative low value of consistency for the whole genome against snp haplotypes  is due to three chromosomes with low consistencies , all other consistencies were >  <dig>  and the median was  <dig> . the consistencies obtained after using targetcut to generate scaffolds is also shown. the n <dig> haplotype length obtained using sih shows the large effect of increasing threshold gap length between contigs



increasing the maximum gap length allowed for joining contigs into scaffolds increased the n <dig> scaffold length in almost direct proportion to the increase in gap length  and n <dig> snp haplotype length . since consistency declined relatively slowly with increasing gap size it is possible to use contigmetrics with a threshold gap size that optimises the trade-off between haplotype size and accuracy for a particular application.

snp haplotype construction
the size of the interval between informative snp determines the resolution of haplotype boundaries. the mean interval between informative snp in the sequence of the bulk genomic dna sample was 1820 bp but the n <dig> distance was 9791 bp both of which are less than the mean  and n <dig>  scaffold lengths . therefore there are expected to be about nine snp loci per scaffold and, although this will be very variable, there should be sufficient data to reconstruct haplotypes from snp genotypes. scaffolds less than 1000 bp were discarded since they were unlikely to contain two informative snp loci and hence aid in snp haplotype reconstruction  and were also associated with repeats .table  <dig> descriptive statistics for scaffolds

sample set1

1
cm = scaffolds constructed using contigmetrics with a 1000 bp gap permitted between contigs; tc targetcut in samtools



after filtering out scaffolds with > 20 % or >  <dig> heterozygous loci and pairs of snp loci with >  <dig> two snp haplotypes, the remaining snp loci were formatted for haplotype construction by sih with input from scaffolds constructed using either contigmetrics with a 1000 bp maximum gap or samtools targetcut. the mean and n <dig> size of scaffolds are shown in tables  <dig> and the same data for snp haplotypes compiled by sih are shown in table  <dig>  descriptive statistics are shown for the contigs  and scaffolds  for all sets of processed samples.table  <dig> descriptive statistics for snp containing haploid sequences constructed by sih averaged over all autosomes

sample set1

1the low proportion of genome covered by the angus bull snp haplotypes compared to the high genome coverage of scaffolds was partly due to a large proportion of scaffolds containing heterozygotes that were filtered prior to haplotype construction. for the angus bull no scaffolds were used that contained heterozygotes, for the other sample sets scaffolds with a maximum of  <dig> heterozygotes or a maximum of 20 % heterozygotes were accepted and the heterozygous positions deleted


1the high number of reads for the angus bull was in part due to a single outlier library, after excluding that library the number of reads was 88 m



the n <dig> scaffold length for the angus steer was  <dig>  kb and the n <dig> haplotype length for snp based haplotypes obtained by sih was 97 kb. 89 % of the genome had scaffold coverage of at least  <dig> x but only 64 % of the genome had haplotypes assigned by sih. this may at least in part be due to the distribution of gaps between informative snp. although 50 % of the genome had snp less than 2446 bp apart, 22 % had snp > 10 kb apart and 15 % > 20 kb apart. haplotypes in these regions might not be captured by the scaffolds, which had mean and n <dig> lengths of 16 kb and 27 kb respectively. although <90 % of the genome was covered by informative scaffolds or snp haplotypes >  <dig>  % of heterozygous snp loci were phased on scaffolds and 88 % on the longer snp haplotypes, supporting the hypothesis that <90 % of the genome was covered by informative scaffolds or snp haplotypes because of an absence of informative snp in these regions.

comparison of sample sets
libraries were prepared from four sets of samples. genomiphi amplified single cells from: 1) an angus steer prepared from freshly collected cells at the university of missouri; 2) single sperm cells from an angus bull prepared from semen shipped at ambient temperature from missouri usa to liverpool uk; 3) blood of eaz cattle collected in western kenya and stored at ambient temperature  for 24–48 h prior to amplification. 4) a fosmid library from bulk genomic dna of a single eaz cow without genomiphi amplification.

furthermore two different sequencing technologies were used. the angus samples were sequenced from 75 bp fragment libraries on applied biosystems solid  <dig> machines and the eaz samples were sequenced from  <dig> × 100 bp paired-end libraries on an illumina hiseq.

the fosmid library was supplied in pools of  <dig> fosmids with 30–45 kb inserts and three pools were combined for each library preparation. each library was expected to cover 24 % of the haploid genome and 6 % of the sequence data in a given library was expected to come from both orthologous chromosomes 2)/ <dig> ). sequence from each library covered approximately 22 %  of the haploid genome suggesting that the stated fosmid pool size was accurate.

the contig and scaffold length parameters reflected the different sources of the libraries and the different sequence data types and analysis methods.

effect of sequence data type: the  <dig> × 100 bp paired-end libraries sequenced on the illumina hiseq generated contigs at least four times longer than the 75 bp fragment libraries sequenced on the abi solid. however, the scaffold lengths from the comparable angus steer  and eaz cells  only differed by two to three fold. contig lengths of the two 75 bp fragment libraries from angus animals had similar distributions . more of the total lengths of contigs from the eaz cells were in short contigs than the contigs from eaz fosmids presumably because of the low coverage of this sample.fig.  <dig> distributions of contig lengths  and scaffold lengths  for the four sets of samples. the two 75 bp fragment libraries from the angus cattle had much shorter contigs than did the  <dig> × 100 bp paired-end libraries from the eaz animal



effect of sample source: we sequenced dna from aliquots of single cells, single intact sperm cells and a fosmid library. the unfragmented sperm cells generated the longest scaffolds as expected . given that the sperm were shipped from the usa to uk at ambient temperature , it is also an indicator of the robustness of these cells.

the fosmid library generated scaffolds with n <dig> scaffold sizes that approximated to the expected insert size  and these had the smallest variability in scaffold size  relative to mean scaffold length . the n <dig> sizes of scaffolds found by contigmetrics and targetcut were similar. targetcut was developed for fosmid samples and generated a mean and n <dig> scaffold length that only differed by 5 % , which also indicates that the length distribution was almost symmetrical. sixty five percent of the total scaffold lengths from the eaz fosmids were in the 22–60 kb range whilst scaffolds from other libraries had a broader distribution . the scaffold length of the libraries from subcellular aliquots  had n <dig> lengths between 16 kb and 51 kb depending on source and analysis method and the n <dig> scaffold lengths were larger than the mean scaffold lengths, indicative of a skewed distribution with many shorter scaffolds. given the good approximation of the fosmid scaffolds to the expected fosmid sizes, the scaffold sizes derived from the subcellular fragments may also reflect the size of the chromosome fragments or the phi <dig> polymerase products derived from them. the sperm cells from the angus bull had the largest proportion of the scaffold lengths in long scaffolds. this is presumably because the sperm cells were not aliquoted and hence there was no opportunity for fragmentation by pipetting .

the importance of the sample source is further emphasised by the large variation in the amount of available data, which varied between  <dig>  x and  <dig>  x scaffold coverage. the scaffold coverage of the genome from the eaz subcellular libraries was particularly sparse at  <dig>  x. but there was no correlation between scaffold coverage of the genome and n <dig> scaffold length , supporting the hypothesis that scaffold lengths represent the lengths of the underlying fragments.

effect of scaffold reconstruction method: targetcut was specifically designed for reconstructing scaffolds of reads across fosmids and assumes that scaffolds will be in the range 25–45 kb; it appears to have been very successful at obtaining scaffolds with both mean and n <dig> sizes close to the expected size  for the fosmid library. however, where the template does not conform to this expectation, targetcut risks joining contigs from adjacent shorter scaffolds. the mean lengths of scaffolds generated by targetcut on subcellular fractions were 2– <dig> times longer than those generated with contigmetrics when using a maximum permitted gap between contigs of 1000 bp. contigmetrics with a gap of 2000 bp generated similar snp haplotype lengths to targetcut  but preliminary analysis suggested that gaps in the 1–2000 bp range were randomly distributed, which provides no support for combining such distant contigs into scaffolds. there was a modest loss of data and data quality to offset this substantial gain in scaffold length when using targetcut; consistency was ~2 % greater with contigmetrics and the number of scaffolds that had to be rejected because they contained excess heterozygotes was 1–4 % greater with targetcut, with the exception of the sperm data, which was an outlier in many respects. the choice of scaffold assembly method could be guided by the relative importance of size of scaffold and correctness of assembly.

a key objective of haplotype reconstruction is to identify the phase of pairs of functional alleles within a gene. in order to test the sensitivity of the sequence-based haplotyping we estimated the percentage of pairs of non-synonymous  snp that would be on the same scaffold or sih snp based haplotype. over 99 % of pairs of missense snp within a given gene shared at least one scaffold  suggesting that the majority of potentially functional interactions between polymorphisms in genes will be captured by this method.

the mean length of cattle genes in ensembl <dig> was 32 kb  which is substantially greater than the 10 kb mean haplotype length estimated by linkage disequilibrium  <cit> . the very long genes  require correspondingly very long scaffolds or haplotypes to cover them and many were not fully covered. tables  <dig> and  <dig> show the percentages of genes entirely with a single scaffold or snp haplotype respectively. for most samples and analyses 65–82 % of genes were within scaffolds but only 19–48 % were within snp haplotypes despite the greater length of snp haplotypes. this is likely to be because multiple scaffolds but only one or two snp haplotypes cover any given locus.

annotation: snp in genes were annotated with their consequences for gene structure using the ensembl api. counts of each type of structural change are shown in table  <dig>  the eaz have many more snp in all categories. this is probably for two reasons: first, the eaz cell samples were collected from  <dig> different animals and not just one. second, eaz cattle are primarily of bos indicus origin with some bos taurus introgression, whereas the reference sequence and the angus cattle are of bos taurus origin. bos taurus and bos indicus cattle separated about  <dig>  years ago and have adapted to different environments as well as accumulating neutral variants.table  <dig> counts of consequences of snp for gene structure. counts of consequences for gene structure of snp within genes for each group of sequences



the counts of non-synonymous  and synonymous variants were obtained for each gene in the eaz cattle. the  <dig> genes with a ratio of non-synonymous/synonymous >  <dig> were submitted to david to identify pathways that might be under strong positive selection. the only cluster of genes with an enrichment score >  <dig> contained  <dig> olfactory receptor genes .

we have demonstrated a simple method for obtaining direct molecular haploid sequences by isolating and amplifying fractions of individual cells. molecular haplotypes have been obtained before, by a range of methods  <cit> . the key objective of our protocol was to reduce the complexity and cost of the procedure in order to make it available to any laboratory with access to next generation sequencing. our method only requires a haemocytometer and a microscope and we minimised the number of libraries to be sequenced and the amount of sequence obtained from each library. the amount of raw sequence data obtained for the angus steer was in the same range  as would commonly be used for a high quality consensus sequence. making  <dig> libraries instead of just one adds to the cost of haploid sequencing and this is true of all methods proposed to date. kaper et al.  <cit>  and kuleshov et al.  <cit>  have also obtained haploid sequences by limiting dilution. kaper et al.  <cit>  diluted bulk genomic dna and used phi <dig> polymerase to amplify the aliquots. kuleshov et al.  <cit>  sheared bulk genomic dna to 10 kb fragments, aliquoted the fragments into pools of 3000– <dig> fragments and amplified these by long range pcr. this latter strategy should produce a less skewed read coverage distribution than phi <dig> polymerase, but may suffer more problems with hard to amplify regions. alternative methods of amplifying dna from trace samples such as malbac  <cit>  should also generate less skewed coverage than phi <dig> amplification and be capable of amplifying from longer template fragments than long range pcr.

kaper et al.  <cit>  used 96– <dig> libraries per sample and kuleshov et al.  <cit>  used 384– <dig> libraries per sample. in these protocols the cost of library construction can exceed the cost of sequencing. reagents for library preparation from the sequencer manufacturers cost ~ $50–$ <dig> per library in the uk and reagents for  <dig> gb of sequence to give ~  <dig> x genome coverage costs ~ $ <dig>  the number of required libraries depends on the desired level of scaffold coverage but also on the fraction of the haploid genome in each sample. we used  <dig>  haploid equivalents and kaper et al.  <cit>  used  <dig>  haploid equivalents per sample, however, kuleshov et al.  <cit>  used  <dig>  haploid equivalents. using smaller fractions of the genome reduces the risk of sequencing template derived from both orthologous chromosomes but increases the number of libraries required. we expected about 9 % of scaffolds to be derived from both chromosomes and the value for kaper et al.  <cit>  was similar but for kuleshov et al.  <cit>  the fraction would be about  <dig> × 10− <dig>  if scaffolds from both chromosomes can reliably be identified and filtered out then an optimal sequencing strategy would minimise the combined cost of sequencing and library construction. by removing  <dig>  % of scaffolds from the data set we eliminated 82 % of heterozygous snp in scaffolds. the majority of the remaining heterozygotes were assumed to be due to cnv and repeats. a cost calculator for different strategies is included in the supplementary files . the project cost varies only by about 10 % for dilutions between  <dig>  and  <dig>  genome equivalents per library, but using a very small proportion of the genome, as did kuleshov et al.  <cit> , increases project costs almost threefold at manufacturer’s current list prices. at >  <dig>  genome equivalents per library the main determinants of cost were the target depth of read coverage over scaffolds and the scaffold coverage of the genome. read coverage of scaffolds has to be sufficiently high to detect a large proportion of heterozygotes within a scaffold to mark it for removal. if read coverage is uniform then  <dig> x read coverage of scaffolds would detect 61 % of heterozygotes which should be sufficient to detect most diploid scaffolds . however genome amplification with phi <dig> is very skewed so scaffold coverage would need to be correspondingly increased; with long pcr  <cit>  or malbac  <cit>   <dig> x coverage should be adequate. with very high genome dilutions then detection of heterozygotes becomes unnecessary and coverage can be correspondingly lower, kuleshov et al. obtained consistent and long haplotypes with a  <dig> x scaffold coverage.

there are no established quality criteria benchmarks for a diploid genome sequence and criteria will ultimately depend on the intended application. for understanding long-range interactions within the genome of a given individual haplotypes of 1 mb or greater could be desirable, for example for resolving hla  haplotypes. however for understanding the haplotype structure of populations, to increase the power of mapping studies, then much shorter haplotypes that capture most snp in linkage disequilibrium within genomic regions harboring quantitative trait loci would be sufficient. we used simulation to obtain the percentage of haplotypes that would be completely covered by at least one scaffold given ratios of scaffold length to population haplotype length of between  <dig> and  <dig> and scaffold coverage of 2– <dig> x, assuming haplotype lengths are exponentially distributed and that the mean haplotype length in the cattle that we sequenced was 10 kb  <cit>  . with the coverage that we achieved we would expect to capture ~ <dig>  % of the angus steer population haplotypes within scaffolds; 82 % with the eaz cells;  <dig>  % eaz fosmids and ~100 % angus sperm, all with the targetcut analysis but contigmetrics gave similar results except for eaz cells where coverage was predicted to achieve 70 %. since less than 100 % of the genome was covered by scaffolds, these percentages need to be adjusted for the actual percentage of the genome covered .table  <dig> percentage of population haplotypes expected to be covered by a scaffold for different mean scaffold lengths and scaffold coverage of the genome



sih uses the snp data from all scaffolds to form a single pair of snp haplotypes from all overlapping scaffolds. the snp haplotypes are expected to be larger than the scaffolds and this was found, although mean snp haplotype lengths were only marginally longer than mean scaffold lengths for the eaz cells, presumably because these cells were drawn from a population not a single animal and therefore overlapping scaffolds would not necessarily be consistent. although n <dig> lengths for snp haplotypes were large  for the angus steer there was a substantial loss of data since genome coverage fell from ~ 91 % for the informative scaffolds to ~66 % for the snp haplotypes. the ability of any method to reconstruct whole genome haplotypes will ultimately be determined by the length of scaffolds used and the lengths of homozygous regions across the genome. homozygous regions might be quite short in highly outbred populations, such as many human groups, but correspondingly large in intensively selected livestock such as the angus cattle used here. the mean and n <dig> gap between informative snp used for haplotype reconstruction was 1820 bp and 9791 bp. the maximum gap between informative snp was  <dig>  mb on bta <dig> 

the n <dig> length of scaffolds in the angus steer was 46 kb, which is substantially longer than the 14 kb n <dig> scaffolds obtained by kaper et al.  <cit>  using dilutions of bulk dna and the same analysis method . this suggests that the direct dilution of dna may have fragmented the template more than taking aliquots from individual cells. the n <dig> snp haplotype length obtained using sih by kaper et al.  <cit>  was dependent on the number of libraries and depth of sequence, ranging from 197 kb n <dig> haplotype length for  <dig> libraries and  <dig> x genome coverage to 702 kb n <dig> haplotype length from  <dig> libraries at  <dig> x genome coverage. we observed a n <dig> haplotype length of 190 kb for the angus steer when using targetcut with  <dig> libraries and  <dig> x genome coverage, respectively. despite using a similar coverage and less than a third of the number of libraries that kaper et al.  <cit>  used we obtained haplotypes that were 96 % of the length, which may well be attributable to the longer scaffold length obtained from diluted cells rather than diluted dna. the relative efficiency of our method may be greater than these data suggest since we were working with inbred cattle with long homozygous regions that could not be linked by informative snp. therefore the use of cell aliquots rather than diluted dna seems to generate data of similar quality with only one third of the libraries and increases the ease of library preparation .

molecular haplotypes have also previously been obtained by fosmid cloning and targetcut and sih for haplotype reconstruction, which produced n <dig> haplotypes of 1 mb and 81 % of genes completely within haplotypes <cit> . this is about five times larger than the n <dig> of the haplotypes that we obtained using 75 bp fragment reads on the angus steer and four times larger haplotypes than we obtained using fosmid libraries. however suk et al. used more libraries  and more data  than did we for the angus steer and eaz fosmid sequences, respectively. furthermore, our cattle samples were likely to be more inbred than the human samples used by suk et al. the number of libraries and amount of sequence obtained by either method can be adapted to the particular objectives of the experiment. the n <dig> haplotype length that we obtained from fosmids was 257 kb and >99 % of haplotypes were longer than 20 kb. this is sufficient for many purposes since > 95 % of human snp are < ~10 kb apart  <cit>  and therefore the data presented here should be sufficient to tag most haplotypes.

CONCLUSIONS
we have demonstrated a simple sample preparation method for generating dna derived from single chromosomes. this together with the suite of data processing tools we have written will enable staff in any laboratory to obtain direct molecular haplotypes. the n <dig> size of scaffolds of paired end illumina reads assembled with targetcut on the eaz cells were  <dig> kb and covered  <dig> % of the genome. using sih to infer snp haplotypes extended the n <dig> size in the eaz cells to  <dig> kb. these diploid sequences of the eaz cells were obtained using a genome read coverage of  <dig>  x, similar to a standard high quality resequencing project. the preparation of  <dig> libraries rather than a single library was the only significant source of increased costs, and this cost penalty is likely to decline with the maturation of laboratory automation and library preparation kits.

this strategy therefore puts direct haplotype sequencing of diploid genomes within the reach of any laboratory. the method may be particularly useful for haplotype sequencing of large numbers of samples around loci of interest, since amplified aliquots of single cells can be screened by pcr to identify those containing the locus. this provides a route to sequencing megabase regions without complex cloning or primer walking or the discovery biases inherent in sequence capture.

