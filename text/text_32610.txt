BACKGROUND
polymerase chain reaction  is a widely used technique both in clinical diagnosis and research applications. the success of a pcr reaction is essentially determined by the oligonucleotides used as primers for the amplification of the target sequence. although a large variety of primer-design softwares exist, some aspects of the design are rarely considered by these programs. for example only very few programs can design primers to amplify bisulfite treated dna  <cit> . this is surprising since the number of studies including pcr on bisulfite treated dna templates is exponentially growing. bisulfite treated dna is used to determine cpg methylation profile  <cit> . methylation of the mammalian dna influences gene expression regulation, cell division and chromosome stability  <cit> . aberrant dna methylation profiles are generally observed in pathological processes, such as cancerogenesis  <cit> . bisulfite genomic pcr based diagnostic tools were developed to detect these aberrant methylation profiles  <cit> . the principle of the bisulfite treatment is the specific chemical conversion of non-methylated cytosines to uracils, while methyl-cytosines remain unconverted. these templates are then pcr amplified and uracils and methyl-cytosines are replaced in the product by thymines and cytosines, respectively. the amplification of a bisulfite treated sequence is a difficult task as the treated dna sequences are characterized by a very high percentage of t, leading to low efficiency of amplification and high frequency of undesired pcr products. indeed, amplification of undesired pcr products can seriously alter the efficiency of a reaction  <cit> . surprisingly, another rarely addressed aspect of primer-design is the post-design in silico screen for mispriming sites and undesired pcr products . we have created bisearch  <cit> , a primer-design software, which considers both the above mentioned aspects of primer-design. after a complete upgrading of the software, here we describe the second version of bisearch. the current version is composed of a primer-design and an epcr module. the primer-design module is applicable to a wide variety of templates and was supplemented with new parameters used specifically for bisulfite treated dna. the epcr module can test primers for mispriming sites and misamplification products both in native or bisulfite treated genomic libraries. bisearch can recognize imperfect matches as well, which are likely to anneal and cause potentially undesired pcr product amplification. the new version was also supplemented with eight cdna libraries. the search is carried out with a completely new algorithm and became hundred times faster in the current program than it was in the previous version and is currently the fastest on the web. the rapidity of the epcr search allowed the development of a new option of high-throughput primer screening, necessary in some applications.

implementation
bisearch web server is fast and user friendly due to the combination of various techniques and programming languages. the bisearch software is composed of two parts: the core applications and the web interface. the main programs  are written in c and c++ to ensure rapidity. for primer design we coded the algorithm proposed by kämpke et. al  <cit>  with some modification described previously  <cit> . the epcr tool contains two programs. indexer was developed for indexing databases and generating the appropriate hash matrices. indexer is run only once for each new assembly of a database. the second part of the epcr tool is the fpcr program. this program can take one or more primer or primer pair as input. first, it generates all oligonucleotides, which differ from the query sequence according to the mismatch string . then these oligonucleotides are sorted according to their hash index, and genomic localizations are given by the linked list designated by the appropriate hash matrix element. potential pcr products are predicted by the further analysis of the generated genomic hits. in this step, the full-length primer sequences are taken into account.

the web interface of bisearch is written in php. the main programs communicate by the php scripts via cgi. the different options and modules of bisearch web server are structured by the main menu. a dynamic help, generated by javascript facilitates the use of the software.

RESULTS
primer design
primers can be designed for native or bisulfite treated dna sequences by the bisearch web server. the software also proposes primer-design for methylation specific pcr   <cit> , when qualitative analysis of dna methylation is needed after bisulfite treatment.

due to the bisulfite treatment of dna, the originally double-stranded, self-complementary dna molecules loose the complementarity of the two strands. therefore the original sense and antisense strands need separate amplification. accordingly, bisearch proposes to design primers either for the amplification of bisulfite treated sense or antisense strand. in both cases the bisulfite conversion is carried out by the software on the native input sequence. this allows the consideration during primer-design both the methylated and the unmethylated state of each cpg dinucleotide.

the following general parameters are considered for primer-design: self and pair  annealing of the primers, their melting temperature , gc content, length and maximum acceptable tm difference between the forward and reverse primers. although default parameters are given, each parameter used for primer-design  can be changed . the software calculates the tm with the nearest neighbor method, according to the published equations  <cit> .

some specific parameters are used only when the template is bisulfite treated. first, gc content in a bisulfite treated sequence is lower than in native sequences. therefore, to make primer-design easier we have modified the default range of acceptable gc content for primer-design on bisulfite treated template. second, since the objective of bisulfite treatment is to determine the dna methylation profile of the target sequence, it was logical to include a minimal number of cpg dinucleotides in the pcr product, necessary for primer design. this can be determined by the user. finally, the primers proposed by the software may include cpg dinucleotides of the original sequence. these primers are degenerate since at the corresponding site either a c or a t is incorporated. these degenerate primers are characterized by two  different tms according to the number and the methylation state of the cpg dinucleotides. the maximal acceptable tm difference between the methylated and unmethylated primers can be set by the user.

bisearch software proposes only significantly different primer pairs. two primer pairs are significantly different from each other if the location of either the left or the right primer's 5' or 3' end has at least  <dig> base difference relative to the corresponding primer. the advantage of this approach is the possibility of the setting up of alternative pcrs to amplify the same template. this may become necessary when the best primer pair proposed by the software turns out to have a great number of mispriming sites and potential misamplification product after the analysis by the epcr tool .

in case of primer-design for methylation specific pcr , the software calculates the tm values for both a fully converted  and a partially non-converted template . in contrast to the "classic" bisulfite pcr, where the objective is the unbiased amplification of both methylated and unmethylated alleles, here the aim is the specific amplification of the methylated template. therefore the software searches primers with high tm difference. to increase the specificity for the methylated template, only those primer pairs are accepted where at least one of the primers has a c at the 3' end.

the score of primer pairs is calculated as described in  <cit> . briefly, each parameter has a minimum, maximum and an optimum value determined by the user. primers are considered when the value of all the parameters fall in the predefined range. the parameters are also characterized by a weight used for scoring. the score of a primer pair equals the simple weighted sum of the deviations from the optimum. designed primer pairs are ranked in a table according to their scores where lower score means better primers . the table also includes the calculated values for the different parameters. the pcr amplicon is shown with the primers underlined and the cpg dinucleotides highlighted. the fpcr  button serves to start the post-design electronic pcr analysis.

post-design electronic pcr tool
contaminating pcr products can seriously alter the efficiency of an amplification reaction. unfortunately, all pcr templates  can serve as mispriming site for primers leading eventually to undesired pcr amplicons. selected primers can frequently bind to similar or identical sequences other than targeted in complex templates such as mammalian genomic dna. due to bisulfite treatment the complementarity of the strands is lost and high sequence redundancy is typical because of the t-richness after the conversion of cs. here, mispriming and misamplification happen much more often. this illustrates that post-design primer analysis for mispriming sites and more importantly for undesired pcr products is crucially important. the unique epcr functions of bisearch were created to meet these needs.

the epcr tool in this new version of bisearch is based on hashing of various template dna libraries using  <dig> base long oligonucleotide sequences instead of direct string search. the principle of hashing technique is the initial identification of locations of all n-mer oligos  in the databases to be analyzed. the hash tables are generated for cdna and both bisulfite converted and native genome sequences. three hash tables are generated for each genome, one for the original sequence and two for the bisulfite converted non-complementary dna strands. the hash tables are splitted up into smaller parts to avoid large files and to speed up search. each occurrence of the analyzed primer sequence in the selected template dna library is collected as a result of an epcr search.

however, mispriming may also occur  at sequences, which are almost identical to the primer but harbor some mismatches. since the hashing technique allows the identification of only exact matches, we developed a new algorithm to identify primer-binding sites with mismatches. the software generates all possible primer sequences differing from the original primer sequence as defined by a "mismatch string". the mismatch string is a  <dig> character long string, where each position represents the corresponding nucleotide from the 3' end of the primer. the string is composed of numbers indicating the maximum allowable cumulative number of mismatches in the primer from the 3' end to the specific position. the default mismatch string is , which means no mismatch is acceptable within the first eight nucleotides from the 3' end of the primer, while sequences with one mismatch between nucleotides 9– <dig> from the 3' end are identified as binding sites for the oligo. this approach identifies hits with more stringent 3' than 5' end similarity to the primer sequence. these hits may serve as templates for the amplification of undesired pcr products with higher probability than sequences with higher overall but lower 3' end similarity.

after the collection of hits, the software identifies the potential pcr products by the position codes in the template dna library. two hits are considered as primer binding sites leading to pcr amplification if they are well oriented and are not more distanced than  <dig> kb . full-length primer sequences are used for the identification of potential pcr products and sequences having more mismatches than allowed for the entire oligonucleotide are discarded. four mammalian genomes  were downloaded from ensembl ftp site  <cit>  and were indexed. hash tables for the cdna libraries of these species were also prepared in addition to bovine, zebrafish, fruit fly and c. elegans cdna sequences. hash tables for further genomic and cdna sequences can be prepared upon request.

the output format of the results of a simple genome search with a single oligonucleotide is the listing of the genomic hits with their precise location and an alignment between the primer and the hit sequences. if the search is carried out on a bisulfite treated genome the results are separately shown for the  sense and antisense strands. the primer genome search report starts with the total number and the complete sequence of the potential pcr products. the primers are color-coded in the pcr products and mismatches are highlighted. the pcr data are followed by the priming sites. results from bisulfite treated templates are given first for the original sense then for the antisense strands.

in general, search time of binding sites of a single oligonucleotide with the default parameters in a non-converted genome is approximately  <dig> seconds. the same search on the bisulfite treated genomes takes approximately  <dig> seconds, which is approximately hundred times faster than it was in the previous version of bisearch. the search time depends on the number of generated mismatch strings. however, the main time consuming step in the algorithm is to find the appropriate position list in the hash tables, therefore strings having position lists close together can be found more quickly. thus sorting the primers according to their hash index speeds up the search. moreover, simultaneous epcr analysis of several primers is faster than separate search with each sequence. in conclusion, the simultaneous analysis of multiple primer pairs and their initial sorting according to their position lists contributed to that bisearch became a high-throughput online primer screening epcr tool.

both the efficiency and the rapidity of the epcr module were tested and compared to other web tools. bisearch is the only available online tool to our knowledge to predict potential pcr amplification products of a primer pair on a bisulfite treated template. mispriming sites of a single oligonucleotide can be also predicted by methblast, a derivative of the blast software  <cit> . in contrast to bisearch, methblast software readily detects sequences with mismatches corresponding to the 3' end of the primer, while a sequence with a single mismatch corresponding to the middle of the primer is hardly recognized. thus, it is more likely that the hits identified by bisearch can serve to initiate elongation by taq polymerase than the hits of methblast.

the epcr module of bisearch was also compared to other online tools available for native sequences. the currently available fastest program for electronic pcr on native genomic dna is the genometester program part of the genomemasker software package described recently  <cit> . groups of randomly selected  <dig> human primer pairs were used from the rtprimerdb  <cit>  to compare genometester and bisearch. the search time with the default parameters of bisearch  was consequently three times shorter than that observed with the online available genometester software, which detects only identical matches.

we have also compared bisearch to two other previously developed epcr softwares, vpcr  <cit>  and spcr  <cit> . in all our tests bisearch showed the best performance, since it was not only very fast but also predicted almost all real pcr products, while no false undesired amplification was suggested. this is due to the fact that bisearch is the only software out of the three, which uses real text search algorithm to identify the potential pcr products.

a new feature of bisearch is the possibility to analyze primer pairs on cdna libraries. this option was also tested on the same randomly selected  <dig> primer pairs. not surprisingly the search on the cdna library revealed potential pcr products, which remained undetected by the test on the genomic templates. furthermore, in some cases the same primer pair detected several different pcr products from the cdna library corresponding to potential alternative splicing products. therefore, we suggest to test each primer pair designed to amplify a cdna on both the corresponding cdna library  and the native genomic library .

CONCLUSIONS
in conclusion, bisearch web server is a useful tool for primer-design for any dna template and especially for bisulfite treated sequences. the epcr tool for detection of mispriming sites and alternative pcr products in cdna libraries and native or bisulfite treated genomes are the unique features of the new version of bisearch software. the major differences between bisearch and the other softwares are that the epcr tool presented here can search: i) in both cdna and genomic libraries ; ii) in bisulfite treated genomic libraries ; iii) for hits identical to the query sequence or harboring mismatches with high probability of 3' end annealing and iv) faster than any similar online available software. these improvements of the bisearch software make it a highly performant and versatile primer-design web tool.

competing interests
the author declare that they have no competing interests.

availability and requirements
• project name: bisearch: primer design and search tool

• project home page: 

• operating system: linux on server side, platform independent on client sides

• programming language: c, c++, javascript, php, html

• license: free for academic users

• any restrictions to use by non-academics: licence needed

authors' contributions
get developed and implemented the tool and drafted the manuscript. ta participated in design and preparation of manuscript. av offered technical help during the development. is and av supervised the project. all the authors read and approved the manuscript.

