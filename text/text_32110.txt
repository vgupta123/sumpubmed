BACKGROUND
understanding the processes that drive lineage-specific evolution is a fundamental challenge in comparative genomics  <cit> . many methods have been developed that detect selection, including positive directional selection, at the level of the protein encoding gene. however, proteins function together in pathways and networks, and metabolic pathways are a particularly well understood system. when enzymes under positive selection cluster in a pathway, this can be a sign of directional selection on the pathway, but it can also potentially be explained by negative selection on the pathway with compensatory co-evolution of individual enzymes. these epistatic effects are an important part of the genotype-phenotype map that while ignored by most existing methods, are critical to predicting when changes in genome sequences result in changes to molecular, cellular, and organismal phenotypes. the importance of this work is in characterizing the epistatic nature of the genotype-phenotype map towards this type of prediction of functional shift, using the particular example of metabolic pathways. the same processes that apply to metabolic pathways, apply to other types of pathways and inter-molecular networks, as well as to intra-molecular epistasis  <cit> . at higher levels of organization, pathways can be redundant and can also have epistatic effects on each other, resulting in ridges in fitness landscapes and more complex patterns of evolution  <cit> . these complex patterns of evolution are shaped by the interplay of selection on phenotypes, mutational processes, drift, and population genetic processes, which must be understood together to characterize the genotype-phenotype map.

a previous study examined the co-evolution of enzymes in a pathway under negative  selection to preserve pathway flux, which presents a null model for what co-evolution looks like as pathways evolve under more complex scenarios  <cit> . this previous work, using forward evolutionary simulations  <cit>  and computational analysis of pathways like glycolysis  <cit>  and pyrimidine biosynthesis  <cit> , established the dynamics of the systems, including an important role for mutation-selection-drift balance over longer evolutionary periods. a point to be emphasized is that even when negative selection prevails at the pathway level, individual enzymes can evolve more rapidly than the cumulative function of the pathway as a whole within this paradigm as selection does not act to preserve the activities of an individual enzyme in isolation from the rest of the pathway. if individual enzymes are shifting in their activities relative to the flux through the entire pathway, then their control over the flux of the pathway will shift. this corresponds to potential to shift the flux of the entire pathway through changes to individual enzymes, the potential for mutations of large effect in individual enzyme encoding genes. the stability of flux control on evolutionary timescales can be measured by the number of generations a particular enzymatic step is the slowest and has the most effect on flux.

before examining selection, one key aspect that has not yet been examined is how the system responds to fluctuations in population size, for example as driven by ecology . an example of this is the seasonal bottlenecking of mammals, reptiles, insects, fungal and plant species . dramatic changes in population size are observed during seasonal and ecological shifts. one hypothesis here is that flux-control stability may be affected by shifting population size. it is hypothesized by us that flux-control step stability may be prolonged due to extreme changes in population size. similar to shifts in population size, one might also expect interesting dynamics with fluctuating selection.

moreover, adaptive shifts are expected to pull the population out of the mutation-selection balance and facilitate directional changes in fitness component parameters. many studies have looked for evidence of pathway-level selection by examining pathways where multiple individual genes show co-temporal evidence for lineage-specific positive selection . this will lead to candidate hypotheses, but does not explicitly differentiate between compensatory processes and directional processes. here the role of fluctuating population size and selection as well as an adaptive directional shift in flux were examined to evaluate patterns of co-evolution and of flux control.

methods
simulated evolution of metabolic pathways
to evaluate the role of population genetic parameters in biochemical pathway evolution, a population of cells with a key metabolic pathway was evolved under different selective and population genetic schemes. evolution involves proposing mutations in parameters of the system of ordinary differential equations, followed by selection based upon their effects. the key elements of that scheme were described previously  <cit>  and are summarized here. we simulate the evolution of a metabolic pathway with five reversible reactions and one regulatory loop that controls the rate of production of the first step and one mass action reaction to remove the final product from the system. the simplified kinetic model contains features of glycolysis  <cit>  and is shown in s <dig>  this includes the feedback loop  and the synthesis of final metabolite f as analogous to pyruvate in a linear pathway. the model is described by a system of ordinary differential equations where reactions are represented by reversible michaelis-menten kinetics  <cit> . each enzyme has parameters for enzyme concentration  , the catalytic constant  , the michaelis constant for the substrate  , the reversible catalytic constant  , and the michaelis constant for the product  . the kinetic model has a single inhibitory reaction that is described in the system by the inhibition constant ki . additional dynamics include a constant influx of metabolite a and a mass action reaction utilizing f. the steady state solution of that system is calculated using the copasi environment  <cit> . below, we describe two evolutionary simulation frameworks with explicit and non-explicit populations of cells containing the pathways.

first, we have introduced a forward evolutionary simulation framework where a population of cells  containing the synthetic pathways evolves with wright-fisher dynamics with mutation and weighted sampling with replacement between generations. we can assign different mutation rates and effects and use various selective schemes to evaluate the fixation of introduced mutations in order to test how the synthetic metabolic pathways evolve. each forward simulation was repeated  <dig> times. mutations were introduced with a probability of  <dig> *10− <dig> per parameter per individual per generation. the mutational effects on the catalytic rate constant and enzyme concentration  are derived from a standard normal distribution with variable mean μn <dig>   <dig> μn1=− <dig> ec∗∙pn1− <dig>  


the mutational effects on the binding constants  are described by a standard normal distribution with a variable mean μn <dig>   <dig> μn2=1− <dig> ec∙kn2− <dig> 


the index value c is used to scale the mutational effects, with the following values for each constant:  <dig> c= <dig> ∗10− <dig> enzyme concentration <dig> ∗10− <dig> inhibition constant <dig> ∗10− <dig> catalytic constant <dig> ´∗10− <dig> reversible catalytic constant <dig> product constant <dig> ´∗10− <dig> reversable product constant 


this mutational scheme allows for scaling across orders of magnitude in kinetic parameters and generates a distribution of mutational effects with a bias towards slightly degrading change that is dependent upon the activity and expression level of the protein.

fitness of an individual is described as  <dig> f1=11+e−flux− <dig>  


values in this logistic function control the asymptotic fitness and the gradient of the flux to fitness relationship. as enzymes reach limits of adaptation because of the ability to utilize products, so do pathways, where the end products are also subjected to the rules of binding and catalysis. the asymptotic control of  <dig> and slope of  <dig>  are arbitrary, but are chosen to reflect the ultimate utilizable flux.

each of these simulations was run until the point of mutation-selection balance was reached. the point of mutation-selection balance was determined by the stability of the fitness of the median individual across generational time as assessed by observation of approximately equal rates of positive and negative changes.

another evolutionary simulation framework used a scheme where the kimura fixation probability was used to evaluate the fixation of proposed mutations, eliminating an explicit population and any probability of multiple segregating changes and representing the population by a single wild type individual. we have  <dig> ψ=1−e−2cnesp1−e−2cnes 


to represent the fixation probability, where ne is the population size, c is the ploidy , s is the selective coefficient  and p is the initial frequency of the allele in a population. the initial frequency p was set to ½ rather than 1/n for computational efficiency, giving the property that a neutral mutation has a 50% chance of fixation, which scales the selective coefficient. the effects of population size contributed to experimental results in rising from a  <dig>  frequency to fixation and the introduction of new mutations was independent of population size.

this experimental setup with the kimura fixation probability was run for  <dig>  generations per experimental replicate and the rate-limiting step length was calculated as was previously described  <cit> . each instance of population size was run for  <dig> replicates. sensitivity analysis was used to calculate the rate-limiting step for a generation by changing one reaction step at a time by 10%, while others were fixed, and calculating the difference between the original and perturbed state fluxes, generating a sensitivity coefficient. when a reaction is rate-limiting, changing the reaction rate has a larger effect than it does for reactions that are not rate-limiting.

experiments with fluctuating population size and fluctuating selective pressure
a subset of experiments used an explicit population. for these experiments with an explicit population, mutations were introduced with a higher rate of  <dig> *10− <dig> per parameter per individual per generation . the previously published scheme  <cit>  with selection on flux only was used as the basis for all of the experiments. simulations with an explicit population had various schemes for fluctuating the population size . six experiments will be analyzed here: n <dig> with a periodicity of  <dig> generations and amplitudes that range between  <dig> and  <dig> individuals, n <dig> with periodicity  <dig> generations and amplitudes that range between  <dig> and  <dig> individuals, n <dig> with periodicity  <dig> generations and amplitudes with the range of  individuals, n <dig> with periodicity  <dig> generations and amplitude with the range of  individuals, n <dig> with periodicity  <dig> generations and amplitude with the range of  individuals, n <dig> with periodicity  <dig>  generations and amplitudes with the range of  individuals . corresponding to each population scheme, three control experiments were examined: the lowest population size, the median population size, and the highest population size. for schemes n <dig>  n <dig> controls are the experiments with population size  <dig>   <dig>   <dig>  for schemes n <dig>  n <dig>  n <dig> and n <dig> controls are the experiments with population size  <dig>   <dig>  and  <dig> table  <dig> a summary of the parameters used across experiments  is shown




a number of fluctuating population size schemes were implemented in the experiments with a calculated fixation probability for each introduced mutation . the amplitude was set to a range of  <dig> to  <dig> , <dig> individuals for the following schemes with variable periodicity: k <dig>  <dig> generations, k <dig>  <dig>  generations, k <dig>  <dig>  generations. for the periodicity of  <dig>  generations, two more amplitudes were tested: experiment k <dig> with the amplitude range of  <dig> to  <dig> individuals, and experiment k <dig> with the amplitude range of  <dig> to  <dig>  individuals. control experiments correspondingly contain population sizes of  <dig>   <dig> , and  <dig> , <dig> 

two fluctuating selection schemes were tested here by adjusting the asymptote of the fitness parameter that was originally introduced in  <cit> :  <dig> f1=11+e−flux−a∗ <dig>  


schemes following the same amplitude range  and different periodicity included s <dig> with periodicity  <dig> and s <dig> with periodicity  <dig>  three controls with a set to  <dig> ,  <dig> , and  <dig>  were evaluated correspondingly. these changes in the a value result in changes to the amplitude.

simulations with positive directional selection
in simulating with positive directional selection, for the first  <dig> generations of simulations, the asymptotic parameter x was equal to  <dig>  representing the previously described selection on flux only. the adaptive shift experiment contains the following scheme. two different asymptotic control parameters x were applied to the fitness function as below.  <dig> f1=11+e−flux−x <dig>  


after  <dig> generations, x was set to  <dig>  which triggered a fitness recalculation in the system and enabled the adaptation process to begin. after applying a positive selection stimulus , a new mutation-selection equilibrium  was established after  <dig>  generations  with system adaptation to the new conditions. it was additionally run for  <dig> generations after equilibrium state  <dig>  .fig.  <dig> during positive directional selection, fitness , flux  and the selected fitness value  over the time-course in the experiment with an explicit population are shown




statistical analysis of flux control stability
to assess statistical significance of any step spending a longer period as rate limiting, a permutation test was utilized for the null hypothesis of no flux control stability, which implicitly means that each reaction should have the same average number of consecutive generations that it remains rate limiting. thus, we chose the average absolute deviation as our statistic of interest and generated its null distribution in each case, in a manner similar to that in  <cit> . additionally, bootstrap confidence intervals were constructed by first bootstrapping the replicates, and then bootstrapping the values of consecutive runs within each replicate. error bars on the corresponding figures indicate 95% confidence bounds, obtained by taking the  <dig> th and  <dig> th percentiles from the bootstrap sampling distribution.

examination of evolution and co-evolution in experiments under positive directional selection
simulations where positive directional selection was applied using methodology that was similar to that which has been described previously with an explicit population of individuals  <cit> . briefly, coevolution was estimated using the kinetic parameter values  in the median individual at each generation for each  <dig> generations. every  <dig> generations, complete linkage clustering was performed using absolute correlations as a measure of relatedness between the rates of change of parameters of the system. the largest clusters that were significant at the  <dig>  level were used to identify co-evolving parameters. a total of  <dig> periods of evolution were tested and subjected to statistical analysis.

statistical analysis of co-evolution during selection for increased flux
testing whether the rate of change of flux was associated with the amount of inter-molecular co-evolution was a hypothesis to be tested here. each block of  <dig> consecutive generations was examined, for the change in flux from its beginning to end, and the number of inter-molecular clusters identified . a mixed-effects model was employed, to account for the multi-level data structure induced by the fact that observations within each replicate are correlated. our statistic of interest is the slope main effect describing the extent to which an increase in the rate of change of flux is associated with increased inter-molecular co-evolution. we analyzed this non-parametrically by utilizing a permutation test to generate a null distribution for the slope.

RESULTS
it has previously been shown that flux control in metabolic pathways is expected to be unstable under mutation-selection-drift balance with simple population genetic and selective schemes  <cit> . one question raised from the observed results is when flux control stability might emerge. the evolutionary ecology  and molecular evolution literatures  <cit>  have emphasized an important role of fluctuating environments or population sizes in complex evolutionary dynamics. fluctuation of both flux asymptotes  and population sizes have been evaluated in forward evolutionary simulation frameworks to examine this in parameter-controlled settings.

experiments with an explicit population and a fluctuating population size
the analysis started with an explicit population framework that estimates the effect of a fluctuating population size with different amplitudes and frequencies  on the evolutionary stability of rate-limiting steps. a number of fluctuating population size schemes and controls with fixed population sizes were tested for stability of rate-limiting steps and are shown here . the schemes  represent different amplitudes and periodicities of population size fluctuations. schemes n <dig> and n <dig> have the same periodicity, while schemes n <dig>  n <dig>  n <dig>  n <dig> and n <dig>  n <dig> have the same amplitude. rate-limiting step stability was assessed when mutation-selection-drift balance equilibrium was reached and flux changes over the time-course didn’t show any directional fluctuations. figure  <dig> shows that fitnesses of all of the experiments do not show local temporal adaptation to fluctuation in the population size, where all observed changes come from compensatory processes under mutation-selection balance with no directional adaptive changes. it is well understood that population size alters the relative roles of drift and selection, with a stronger role for selection in larger population sizes. this is in fact observed in the population size effects in fig.  <dig>  it is also understood that the dynamics of fluctuating population sizes are driven by the bottlenecks .fig.  <dig> the fluxes from experiments with an explicit population that fluctuated in size are shown. a. the fluxes for fluctuating experiments n <dig> , n <dig> , n <dig> , n <dig>  are shown. black lines correspond to the control experiments with population sizes  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> . b. the fluxes for fluctuating experiments n <dig> , n <dig> , n <dig>  are shown. black lines correspond to the control experiments with population sizes  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> 




controls for the experimental schemes were assessed correspondingly at the highest, lowest, and middle point of each scheme: with population sizes of  <dig>   <dig> and  <dig> for schemes n <dig>  n <dig> and population sizes of  <dig>   <dig> and  <dig> for schemes n <dig>  n <dig>  n <dig> and n <dig>  calculation of the average consecutive length of each reaction being rate-limiting  showed that scheme n <dig> has a statistically significant difference in the number of consecutive generations spent as rate limiting, across the reactions. this scheme has elevated amplitude as compared to the scheme n <dig> and n <dig>  but also has a smaller periodicity as compared to schemes n <dig> and n <dig> and larger periodicity as compared to scheme n <dig>  also it could be seen that the experiment with higher amplitude and lower periodicity  has a signal for elevated rate-limiting step stability when compared to n <dig> and controls cn <dig>  cn <dig>  and cn <dig>  but there is not statistical support for differences across reactions. a further increase in periodicity  did not result in a signal for elevated rate-limiting step stability. the strongest signal for differences in the consecutive number of rate limiting steps across reactions was observed in n <dig>  however, it should be noted that one of the control experiments, cn <dig>  showed a p-value for unequal flux control across steps of less than  <dig> , at p =  <dig> , and this was the control scenario specifically for schemes n <dig> and n <dig> fig.  <dig> the distributions of the average length of rate-limiting steps between the reactions in the experiments with an explicit population and a fluctuating population size are shown. the schemes for fluctuating experiments n <dig> , n <dig> , n <dig> , n <dig> , n <dig> , and n <dig>  are shown. black bars correspond to the control experiments with population sizes  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> . nominal p-values were obtained via permutation tests with the null hypothesis that the average absolute deviation in the number of consecutive generations for each step was zero




experiments with a calculated fixation probability and a fluctuating population size
with an explicit population, multiple mutations can simultaneously segregate, an elevated amplitude with an appropriate frequency  in population size fluctuations increased the evolutionary stability of rate-limiting steps. however, because the increase of the amplitude is computationally expensive in the explicit population framework, an alternative population framework involving the kimura fixation probability that allows the implementation of any population size in a computationally feasible manner was used. five different schemes with an explicit fixation probability were studied here in order to estimate various ranges of amplitudes. first, an elevated amplitude  <cit>  was tested on different periodicity schemes  corresponding to consecutive doubled increases in periodicity. the resulting stability increase slightly correlates with the periodicity increase . two other amplitude schemes k <dig>  <cit>  and k <dig>  <cit>  were examined with both having the same periodicity as scheme k <dig>  scheme k <dig> showed the largest average rate-limiting step stability out of all tested schemes. as in the previous experimental design, the specific range of both periodicity and amplitude can result in a signal of elevated rate-limiting step stability. analysis of finesses revealed that schemes k1-k <dig> represent adaptive behavior of the system . here, the range of population size fluctuations independent of the periodicity represent local directional selection on flux. this can be seen in the fluctuations of the flux that follow the fluctuations in population size. this behavior changes when the amplitude of population size fluctuations is reduced to be less extreme causing less intense selective pressure, as can be seen for experiments k <dig> and k <dig>  it should be noted that the asymmetry in the responses to increasing and decreasing flux reflect the relative frequencies of flux increasing  and flux decreasing mutations , according to the mutational scheme that has been designed. this reflects the natural bias towards “deleterious” mutations that is known. controls for the experimental schemes were assessed correspondingly at the highest, lowest, and middle point of scheme k <dig>  k <dig> and k3: with population size  <dig>   <dig>  and  <dig> , <dig> fig.  <dig> the distributions of the average consecutive length of rate-limiting steps in the experiments with a calculated fixation probability for each mutation and a fluctuating population size are shown. the schemes of fluctuating experiments k <dig> , k <dig> , k <dig> , k <dig> , and k <dig>  are shown. black bars correspond to the control experiments with population sizes  <dig> ,  <dig>  ,  <dig> , <dig> .). nominal p-values were obtained via permutation tests with the null hypothesis that the average absolute deviation in the number of consecutive generations for each step was zero



fig.  <dig> the fluxes of the experiments with a calculated mutational fixation probability and a fluctuating population size are shown. a. the fluxes of fluctuating experiments k <dig> , k <dig> , k <dig>  are shown. black lines correspond to the control experiments with population sizes  <dig> ,  <dig>  ,  <dig> , <dig> . b. the fluxes of fluctuating experiments k <dig> , k <dig> , k <dig>  are shown. black lines correspond to the control experiments with population sizes  <dig> ,  <dig>  ,  <dig> , <dig> 




there is also a noticeable decrease in the evolutionary stability of rate-limiting step at reaction  <dig> in some of the experiments including controls. additional tests for differences in rates of mutational acceptance at each step did not show any deviations. moreover, examination of the fraction of time each reaction was rate-limiting showed that all reactions have somewhat equal time being rate-limiting in all of the experiments , although less equal than suggested by the rate limiting step stability. these findings suggest that the reduced evolutionary stability of rate limitation for reaction  <dig> is connected to the location of reaction as the last step in the pathway and the interplay of the pathway flux with the mass action procedure. changing the mass action procedure to ensure that it cannot be rate-limiting causes this evolutionary instability to disappear.

overall, elevated evolutionary stability of rate-limiting steps could be found in a limited range of parameters space . as can be seen from the figs.  <dig> and  <dig>  different range of the amplitude and periodicity cause different system responses. an extremely large amplitude  brings an adaptive response of the system fitness and decreased evolutionary stability of rate-limiting steps , while less extreme schemes of parameter change  generate stable fitness with no directional changes and elevated evolutionary stability of rate-limiting steps. some schemes  show no directional changes but fail to show elevated evolutionary stability of rate-limiting steps, as this appears to be tuned to the mutation rate and effect size of the population with the amplitude and frequency of the differences that would enable a response to occur. overall, this does not support a hypothesized role for non-equilibrium processes in generating different rates of equilibration at different steps and corresponding different flux control during the adaptation process, at least in the conditions tested here.fig.  <dig> fluxes overlaid with the experimental design are shown for fluctuating experiments with an explicit population and a fluctuating population size are shown. a. the flux  and the experimental design  for experiment n <dig> are shown. b. the flux  and the experimental design  for experiment n <dig> are shown


fig.  <dig> fluxes overlaid with the experimental design are shown for fluctuating experiments with an explicit population and a fluctuating population size are shown. a. the flux  and the experimental design  for experiment k <dig> are shown. b. the flux  and the experimental design  for experiment n <dig> are shown




experiments with an explicit population and a fluctuating asymptotic flux
along with a fluctuating population size, fluctuating optimal flux was suggested to make a difference in evolutionary stability of rate-limiting steps, as this also has the potential to lead to non-equilibrium dynamics. fluctuating selection in metabolic networks was studied previously and an increased robustness to changes was reported as a result of this fluctuating selection scheme  <cit> . several schemes of fluctuating asymptotic flux were tested here, but only two were able to establish mutation-selection-drift balance because of numerical instability in solving the set of differential equations. ). as can be seen in fig.  <dig>  there is no significant signal for elevated rate-limiting step stability in either experiment, although a slight increase in reaction stability in s <dig> was detected. controls for the experimental schemes were assessed correspondingly at the highest, lowest, and middle point of schemes with a set to  <dig> ,  <dig>  and  <dig> . fitness behavior over evolutionary time resembles adaptive changes for both schemes studied here . a closer look at the combined plot of the amplitude and flux  revealed that in both experiments, adaptive directional changes in flux correspond to fluctuations of asymptotic flux coefficients , as with population size. these observations support the findings above about the absence of elevated evolutionary stability of rate-limiting steps when fitness directional changes are present.fig.  <dig> the distributions of the average lengths of rate-limiting steps between the reactions in the fluctuating selection experiments with an explicit population and fluctuating asymptotic flux, s <dig> , s <dig> , are shown. black bars correspond to the control experiments with a =  <dig> ; , a =  <dig>  , and a =  <dig>   correspondingly


fig.  <dig> the fluxes of the experiments with an explicit population and fluctuating asymptotic flux, s <dig> , s <dig> , are shown. black lines correspond to the control experiments with a =  <dig>  , a =  <dig>  , and a =  <dig>   correspondingly


fig.  <dig> fluxes and experimental designs of experiments with an explicit population and a fluctuating asymptotic flux are shown. a. the flux  and the experimental design  for experiment s <dig> are shown. b. the flux  and the experimental design  for experiment s <dig> are shown




positive directional selection in an explicit population
to complement evolution with negative selection, a scheme involving positive selection was introduced. selective pressures here directionally changed the flux. the co-evolution of enzyme activities across the pathway during adaptation is poorly understood, but presents a major challenge in generating a basic understanding of adaptive processes and differentiation from compensatory processes reflecting stabilizing selection. co-evolutionary analysis was performed for the positive selection experiment with an explicit population. cluster analysis estimated co-evolutionary relationships between various enzymatic parameters at different stages, the pre-adaptation equilibrium state , during adaptation , and late adaptation towards equilibrium  . as was expected, there are differences between the described stages . both equilibrium stages  contain clustered enzymatic parameters that belong to the same enzyme , similar to patterns observed for negative selection on flux only in previous studies  <cit> . the stages not in equilibrium showed different distributions of clusters. stage  <dig> has the first  <dig> generation after adaptive shift and is similar to stage  <dig> by containing intra enzyme clustered parameters. stages 3– <dig> all contain various combination of clusters with inter- and intra-enzyme parameters clustered together, but never just intra-enzymes parameters clustered alone.fig.  <dig> clusters for significant co-evolving parameters during each evolutionary time regime were generated. this cluster analysis includes early and late periods of equilibrium surrounding a longer period of adaptation. parameters that show the same color belong to the same cluster and co-evolve together, while black parameters are not significantly part of any cluster




since mutations that required increasing flux values come from the beneficial part of the mutational distribution, this process became time consuming, in taking  <dig>  generations to reach equilibrium. the rate of adaptation varies at the different stages. the earlier and middle stages  show more rapid accumulation of beneficial changes and are responsible for most of the new equilibrium flux value gain, as might be expected. mixed-effects regression analyses were performed in order to assess the association between flux change and the ratio/count of clusters across stages of adaptation, shown fig.  <dig> fig.  <dig> the association between the change in flux and the time period  are compared with the count of inter-molecular pairwise parameter clusters  and the ratio of inter-molecular to intra-molecular pairwise clusters  per period




mixed-effects regression analyses were performed in order to assess the association between flux change and the ratio/count of clusters across stages of adaptation, summarized numerically in table  <dig> and graphically in fig.  <dig>  a statistically significant association was found between the count of inter-molecular clusters and the change in flux at the  <dig>  level . however, a corresponding association was not found between the ratio of inter-molecular clusters and the change in flux at the  <dig>  level . overall, this provides some suggestive evidence that high changes in flux may have an effect on the amount of inter-molecular coevolution occurring at any given time and can be informative in analyzing the sequence co-evolution of enzymes in metabolic pathways from comparative genomic analysis. the exact patterns will be indicative of features of the enzymes and the fitness landscape.table  <dig> a statistical analysis is presented to evaluate the role of adaptation in driving inter-molecular vs. intra-molecular patterns of co-evolution

clusters that reflect co-evolving parameters were evaluated in cluster count and in the ratio of the inter- to intra-molecular clusters observed over different periods in fig.  <dig>  this was done, both during periods of adaptation and with an observation of a lag period for a response. slope estimates are the main effect from the mixed-effects regression analyses, and standard errors are estimated based on the null distribution of slopes generated by the permutation test. the p-values were obtained by counting the proportion of the generated null distribution that was greater than the slope estimates




discussion
here, various demographic and selective scenarios were tested in order to find out if specific population and selection parameters when systems may be out of equilibrium can give rise to a more evolutionary stable rate-limiting steps, following from previous work  <cit> . further, we sought to examine if there was a systematic difference in the patterns of co-evolution between positive diversifying selection and compensatory covariation that might be predictive. our findings here suggest that there is a specific range of population size fluctuations that cause elevated evolutionary stability of rate-limiting steps. it can be seen from two experimental frameworks, with an explicit population where scheme n <dig> generated the highest stabilities, while a decrease in periodicity representing more extreme shifts in population size don’t lead to an increase in the evolutionary stability of rate-limiting steps, but instead slightly decrease it . increased amplitude was shown to have a major impact in increasing rate-limiting steps stability. to investigate further the influence of the amplitude in fluctuating population size experiments, a switch to a non-explicit population experimental scheme was necessitated as the explicit scheme become too computationally intensive.

a number of schemes were implemented in the experiments with a calculated mutational fixation probability . surprisingly, assigning the amplitude to a higher range  and maintaining the periodicity that was used in the previous experiments  didn’t give an increased rate-limiting step stability. instead, the average consecutive length was slightly smaller than controls. it was possible that the values of periodicity and amplitude were too extreme and more relaxed amplitude and periodicity values were tested. experimental scheme k <dig> showed the highest signal of stability from our sampling, suggesting that a reduced amplitude has a major impact on rate-limiting step evolutionary stability and that significant stability increase potentially exists in a certain periodicity and amplitude range, which would need to be established further by parameter sampling.

positive diversifying selection resulted in an increase in the co-evolution of parameters that belong to different enzymes when compared with compensatory covariation under negative selection. in previous work  <cit> , it was observed that more complex stabilizing selective or mutational schemes could also give rise to increases in inter-molecular parameter co-evolution, so the null model of stabilizing selection needs to be properly tuned to use this result in the identification of positive directional selection. the particular results observed in this study and the nature of the ridge in the fitness landscape are dependent upon the structure and the constraints of the pathway, which is treated in isolation here. while in an actual cell pathways may be less isolated and this is likely to change the size and nature of the fitness ridge of optima, we expect that the conclusions of this and prior work upon which this builds  <cit>  are generalizable.

it had been hypothesized that constant adaptation when out of equilibrium would lead to different rates of adaptation in different parts of the pathway and the emergence of flux control, but this was not what was observed. this observation relates to patterns of evolution in changing environments that correspond to generalists vs. specialists. specialist species are affected by isolation of their populations; they follow scenarios where there is constant rapid local adaptation. specialists are known for stronger genetic differentiation among populations due to small and sometimes fluctuating population sizes with high frequencies of genetic bottlenecks  <cit> . scenarios where this constant rapid adaptation does not happen are found for more generalist species. generalists often have high genetic diversities in their populations and low genetic differentiation among them  <cit> . this is the consequence of the absence of genetic bottlenecks and strong gene flow among populations. in regards to the overall evolutionary rate it is thought that specialists adapt faster than generalists to any given set of environmental conditions  <cit> . several studies have reported rates of adaptation that are consistent with the prediction that specialists evolve faster than generalists  <cit> . long-term environmental variation may not lead to the evolution of generalists in all population genetic scenarios. instead repeated evolution of specialists adapted to each set of growth conditions happens, as has been observed in adaptation of bacteriophage to alternate hosts  <cit> .

CONCLUSIONS
this study discovers that demographic and ecological variation has a direct impact on the evolutionary dynamics of metabolic pathways. population size fluctuations when following a particular scheme with tuned periodicity facilitates increasing the evolutionary stability of flux-control points in metabolic pathway. adaptation itself is a factor that changes co-evolutionary dynamics and adds a particular signal on top of the corresponding dynamics associated with stabilizing selection and compensatory processes. while at the mutation-selection-drift balance in a simple selective scheme, compensatory intra-enzyme mechanisms dominate, while during adaptive directional processes, inter-molecular parameters within the system co-evolve with stronger signals. overall, these studies give a picture of the nature of pathway evolution under more complex selective and population genetic schemes and gives the potential to develop methods that might detect such scenarios from comparative sequence evolution patterns.

additional files

additional file 1: table s <dig>  this table shows the ratio of positive fitness change counts, negative fitness change counts, total positive fitness change, total negative fitness change and total fitness change per evolutionary simulation step. table s <dig>  this table shows the average fitness for the first  <dig> generations of each simulation step, the average fitness for the second  <dig> generations of simulation step and p-values of mann-whitney’s test comparing fitness values of the first and the second halves of the simulation step. figure s <dig>  the simplified pathway that was simulated is shown. this pathway contains features from glycolysis  <cit> . a constant concentration of compound a is converted to compound f and the steady state flux is measured. figure s <dig>  schemes of the experiments with an explicit population and a fluctuating population size are shown. the schemes for experiments n <dig> , n <dig> , n <dig> , n <dig> , n <dig> , n <dig>  are shown. black lines correspond to the control experiments with population sizes  <dig>   <dig>   <dig>   <dig>  and  <dig>  figure s <dig>  schemes of the experiments with a calculated fixation probability and with fluctuating population size. a. the schemes for experiments k <dig> , k <dig> , k <dig>  are shown. b. the schemes for the experiments k <dig> , k <dig> , k <dig>  are shown. black lines correspond to the control experiments with population size  <dig>   <dig>   <dig> , <dig>  figure s <dig>  schemes of the experiments with an explicit population and fluctuating asymptotic flux. s <dig>  and s <dig> . black lines correspond to the control experiments with a set to  <dig> ,  <dig> ,  <dig> , corresponding to flux amplitudes of  <dig>   <dig>  and  <dig>  

 


abbreviations
this is the concentration of the enzyme

kcatthis is the catalytic constant for the enzyme

kcatrthis is the catalytic constant of the reverse reaction for the enzyme

kmthis is the michaelis constant for the enzyme

kmrthis is the michaelis constant of the reverse reaction for the enzyme

electronic supplementary material

the online version of this article  contains supplementary material, which is available to authorized users.

the authors wish to thank dr. ashley teufel for support and comments in the generation of this manuscript.

funding
this research was funded by nsf award dbi- <dig> 

availability of data and materials
raw data and scripts used for statistical analysis are available for download from https://liberles.cst.temple.edu/public/pathway_evolution/.

authors’ contributions
this study was conceived by dal. simulations were performed by ao. statistical analysis was performed by ao and pbc. dal, ao, and pbc all contributed to the writing of this manuscript. all authors read and approved the final manuscript.

competing interests
the authors declare that they have no competing interests.

consent for publication
not applicable.

ethics approval and consent to participate
not applicable.

publisher’s note
springer nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.
