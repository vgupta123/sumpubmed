BACKGROUND
some years ago, genomes were considered as static objects containing an informative part, the coding sequences, representing only a small percentage of the total genome, and a part referred to as "junk dna" that was generally free of any annotation. it is now widely acknowledged that genomes must be considered from a more dynamic point of view, involving the study of the many " copy" events that occur during evolution, while covering not only coding genes, but non-coding sequences as well. a large number of in silico studies have revealed that repetitive sequences play an important role in the structure, function, dynamics and evolution of genomes in archaea  <cit> , bacteria  <cit>  and eukarya  <cit> . it is well known, for instance, that proteins are combinations in a finite set of domains that represent basic structural units whose arrangements determine a wide variety of functions. other classes of repeats, such as transposable elements, allow mobile elements to move around a genome, and have a major impact on the evolution of sequences  <cit> . dna palindromes, a particular form of repeat, are widespread in human cancers. other repeats in centromeric or telomeric regions of chromosomes seem to endow a certain robustness to the sequences during replication. repeats may be strictly conserved through evolution, as revealed by comparisons of human, mouse, rat, chicken and dog genomes  <cit> . complex mechanisms such as chromosome segment duplications, or even whole genome duplications, are thought to occur, explaining genome evolution  <cit> . converging studies of human and other genomes have also revealed that variations in the number of occurrences of particular repeats may be an important factor responsible for diseases such as diabetes, epilepsy, fragile-x mental retardation and myotonic dystrophy diabetes  <cit> . from a technical point of view, repeats are the source of many difficulties encountered in assembling or comparing sequences, requiring their extraction from these sequences. for these and other reasons, the analysis of repetitive sequences is an essential step in genome assembly, annotation and analysis.

at the core of life information, there exists an outstanding opportunity to analyse the genomic structure by deciphering its content in repeated sequences. the exhaustive analysis of  <dig> published complete sequences from archaea, bacteria and eukarya genomes  has revealed that most of them, especially in eukarya, have a genomic content consisting of large proportions of repeats. revealing the structure of sequences as an assembly of elementary repeated sequences is thus a task of utmost importance.

an important goal in computational molecular biology is therefore finding repeats of biological interest, i.e. repeats that have a role in genome structure and function. practical libraries of repeats have been established in an attempt to collect prototypical sequences and group them into families, either for a large set of genomes or for a particular species  <cit> . to achieve this goal using computational methods, the problem consists in giving a precise definition of a "repeat". in the biological literature, three main classes of repeats are proposed: tandem repeats , duplicated segments  and interspersed repeats . tandem repeats are thought to have originated by slippage of a replicated chromosome against its template. the patterns in tandem repeats are k-mers, k being generally less than  <dig> , but sometimes far greater . the number of repeats for a given satellite may differ between individuals. therefore, they can be used for dna fingerprinting or to provide information about paternity.

microsatellites, also known as short tandem repeats , have a repeat unit that is  <dig> to  <dig> bp long, with the entire repetitive region spanning less than  <dig> bp. minisatellites are generally gc-rich repeats that range in length from  <dig> to over  <dig> bp with total length ranging from  <dig> kb to  <dig> kb. duplicated segments are large intra- or interchromosomally dna segments, ranging from  <dig> to  <dig> kb in size and likely to result from replication accidents. these events result in the duplication of gene clusters. interspersed repeats or mobile elements are dna sequences located in dispersed regions in a genome, produced by mechanisms such as dna recombination. the gene pool of a species consists of dna sequences in a network linked by gene conversion events. this type of repetitive sequence plays the role of uncoupling the network, thereby allowing new genes to evolve. in mammals, the most common mobile elements are lines for interchromosomal uncoupling  and sine for intrachromosomal uncoupling . the first mobile elements were discovered by barbara mcclintock in the 1940s in studies on corn. subsequently, they were found in all kinds of organisms. classifications such as these provide a better understanding of the biological processes at hand during genome evolution. but since they are based on current limited biological knowledge, these definitions introduce some bias in the type of repeats targeted by the analysis, and also introduce complexity in the algorithms used to locate them, especially when considering error-prone repeats. piler,  <cit>  represents the current state of the art in this respect, where four classes of biological repeats are defined. classes ta  and df  correspond to the previously cited tandem repeats and interspersed repeats, respectively. the other two classes are pseudosatellites , which are clustered elements in the genome that are not tandem repeats, and terminal repeats , which are copies of the same element located at the termini of a duplicated element.

a number of formal definitions have been proposed to capture the essence of observable repeats. a vast amount of literature covers this problem, and essentially three categories of formal repeats have been proposed: words, contiguous repeats and structured repeats. the first category tries to distinguish among repeated words those that include all other ones and are thus representative of the whole set of repeats. it mainly uses a maximization criterion, such as the longest repeats  <cit>  and maximal repeats  <cit> . the second category introduces a basic model to achieve a closer approximation of observed repeats, since natural repeats in genomic sequences usually present many variations of close basic repeat units. certain authors propose to look for trains of contiguous repeats such as tandem arrays , or pairs of repeats at a fixed distance , or to introduce an edit distance or a similarity score to take into account local variations . finally, the third category contains sophisticated repeat models that include all the previous notions and are designed to discover the complex word arrangements that occur with a minimum frequency. a structured motif consists of an ordered collection of p >  <dig> parts separated from one another by spacers, the length and distance between parts being bounded with given min and max values  <cit> . this kind of repeat seems of particular interest in studying non-coding sequences in gene expression and regulation.

among these formal definitions, the notion of exact maximal repeat is quite attractive, since it is at the core of all others. it only focuses on sequences present in the two largest common blocks, with no possible extension to the right or left, and with no biological a priori. maximal repeats have nice properties: they can be computed in linear time using a suffix-tree-based algorithm, their number is linear , and they can be used as basic blocks to compute error-prone repeats  <cit> .

associated visualization techniques play a fundamental role in analysing these numerous repeats, and various kinds of tools displaying repeats at genome level have been proposed in the past few years. among them are dotplots  <cit> , landscapes  <cit> , chaos games  <cit> , percent identity plots  <cit> , repeat graphs  <cit>  and bard  <cit> . interpreting the views created using these tools is quite difficult, however, especially for large genomes, since most of them rely on displaying repeat pairs. they do not usually provide convenient zooming features to analyse regions of particular interest. tools like dotplot, chaos game and bard still can only be used on pairwise genome sequence alignments, and, because they only work at sequence level, become difficult to use as the sequence size and/or number of repeats increases. moreover, they are not capable of summarizing the hierarchical organization of repetitive structures in a convenient way so that they can be interpreted by the end users.

this paper introduces the pyramid diagram, or pygram, designed to provide an abstract representation of the organization of repeated structures in genomic sequences. the theoretical foundation of pygrams is similar to sequence landscapes, which display all exact maximal repeats in a picture. but the pygram improves the original sequence landscape visualization in several ways. aside from various practical improvements , pygram offers several new features, including frequency visualization and multigenome repeat analysis. most important, pygram visualization is closely associated with a query system designed to locate repeats that share specific properties. when combined, the query system and visual interface provide an efficient repeat browser that is useful for discovering unexpected structures in genomes.

RESULTS
pyramid diagram  description
a pygram for a genome sequence s of length n is a bi-dimensional plot where s and all its exact maximal repeats  are mapped along the x-axis. given an x-axis magnifying factor k and a y-axis magnifying factor l, mapping is defined as follows: the ith nucleotide of s is located at position , and the emr of size m located at position i within s corresponds to the interval  on the x-axis. the size m emr located at position a within s is symbolized in the diagram by an isosceles triangle  of height δ m/l. δ is either '+1' for an emr located on the normal  strand of s, or '-1' for an emr located on the reverse complement  strand of s.

since focus will be placed on emrs in the rest of this paper, and most of the presentation does not depend on the kind of repeat used, the simpler term "repeat" will be used instead of "exact maximal repeat". it is first important to emphasize three basic facts about managing two dna strands to avoid confusion in the interpretation of results.

• a single coordinate system is used for both strands, i.e. all repeat coordinates, whether they are located on n or rc strands, are computed relative to the n strand.

• the word on the reverse complement strand must be read as usual in the reverse direction. on the pygram each pyramid has an associated colour computed from the corresponding emr sequence, ensuring that each repeat has its own specific colour. consequently, all occurrences of the same repeat will have the same colour on both strands.

• the definition of an emr is symmetrical with regards to n and rc strands: if a word w is an emr, then word w¯c
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqdaaqaaiabdeha3baadaahaawcbeqaaiabdogajbaaaaa@2fb0@, the reverse complement of w, is also an emr. the display of an emr along one strand is always mirrored with an emr of the same size on the other strand.

since the basic idea behind the pygram is to display all exact maximal repeats, pygrams may be considered as a rational reconstruction of landscapes  <cit> , fully characterizing the structure that is displayed without requiring the computation of intermediate repeats. landscapes do indeed display maximal repeats, where the scope of the right triangles is such that increasing the corresponding subword to the left or right removes at least one occurrence of the repeat in the extended subword. this provides a precise definition of maximal repeats.

producing pygrams and browsing repeats
the first step in creating a pygram consists in producing the complete set of repeats. since the repeat structures are to be analysed either within a single sequence or across several sequences, gusfield's emr detection algorithm  <cit>  was implemented on a generalized suffix tree .

the second step in constructing a pygram consists in creating an indexed representation of the complete set of emr occurrences. indexing aims to order repeats along the sequences, so that pygrams can be created efficiently. indexing also improves browsing speed when checking specific repeat properties, such as frequency, size, location , and conservation between two or more sequences. this close association between repeat visualization and querying provides an efficient browsing function for in-depth analysis of repeat organization at various levels, from the highest level  to the lowest level .

the following discussion illustrates the browser capabilities through two case studies. the first shows how to detect and analyse clustered regularly interspaced short palindromic repeats . the second presents an analysis of the horizontal transfer of dna sequences between two genomes.

visual analysis of repeat organization
to further investigate these frequently repeated regions, a pygram with two zoom lenses is presented in figure 2c . the lenses magnify two frequently repeated regions previously identified on the complete genome pygram, where numerous repeats appear to be organized in arrays of spaced tandems. zooming in further  reveals that the two regions share a similar structure. the tandem repeat in the first lens is preceded by two large repeats, symbolized by pink and red triangles on the n strand. identical large repeats can be observed on the opposite strand, downstream of the tandem repeat displayed in the second lens. instances of a 25-nucleotide-long repeat appear regularly spaced, consecutive occurrences being separated by non-repetitive sequences. this type of structure has already been observed in this genome  <cit>  and is known as crispr.

crisprs are a very peculiar family of repeated sequences found in archaea and bacteria genomes  <cit> . their remarkably constant structure consists of short sequences from  <dig> to  <dig> nucleotides long, repeated almost exactly, and referred to as 'units', separated by similarly sized non-repetitive sequences, called 'spacers' . in most species with two or more crispr loci, these loci are flanked on one side by a common leader sequence of 300– <dig> nucleotides. in figure 2d, the leader sequence is delineated by the previously mentioned pink and red large repeat.

each crispr unit appears as a group of co-occurring repeats that differ by only a few nucleotides. this is the result observed when a sequence, here the crispr unit, is repeated several times with point mutations. if a maximal repeat occurrence mutates at some point, it results in two included maximal repeats overlapping at the point of mutation: if aubvc is an emr, a, b and c being letters and u and v two words, then a mutation from b to d leads to emrs aud and dvc. visualizing all emrs detected on both strands of a complete genome can therefore be used to identify error-prone repeated sequences.

querying the emr index to locate exceptional repeats
another way to target the presence of specific repeated structures consists in querying the emr index file, then interpreting query results on a pygram. such queries can be simple, consisting of searching for the most frequent repeats, or complex, as in the case of searching for specific repeat patterns. in the case of s. solfataricus, querying the index to answer the first question returns a 25-nucleotide emr repeated  <dig> times in the complete genome,  <dig> occurrences being located on the n strand and  <dig> on the rc strand. this information can be drawn directly from pygrams , where the specific emr is highlighted in red on the centre frequency line. these pygrams immediately show that the most repeated emr is located exclusively within two different crisprs, forming the most conserved element of the repeated units .

searching for more crisprs in the s. solfataricus genome can be performed by querying the emr, index file using a crispr model defined on the basis of emr properties. more precisely, the index file can be queryied to select repeats based on their size, number of occurrences and location in the sequence. in figure  <dig>  the index file was queried to locate repeats ranging from  <dig> to  <dig> nucleotides, repeated at least  <dig> times, with consecutive repeat occurrences being separated by no more than  <dig> nucleotides. the emr occurrences reported by the query are distributed among seven different regions in the genome. visualization of the corresponding pygrams  led to the identification of the six well-known crisprs published previously  <cit> ; pygrams from figures 3a and 3b display the crisprs presented in the previous section .

the pygrams presented in figure  <dig> show that some crisprs have a similar leader sequence. the left side of figure 3a has two large repeats  that correspond to the right side of figure 3b, but on the opposite strand. likewise, repeats at the end of figure 3c  match those at the beginning of figure 3d. considering the visual properties of these pictures, it is worth noting that pygrams using a logarithmic y-axis  render the crispr, structure better than linear-pygrams magnified using the zoom lens .

among the various crisprs displayed in figure  <dig>  two are questionable , since they do not fit the repetitive structure observed in figures 3a to 3e. the crispr in figure 3f is quite short, with its seven repeated units, and there is no detectable leader sequence. however, querying the index file to retrieve all emr occurrences forming the units in this crispr reveals that these repeats are also located within the crispr units from figure 3e, and nowhere else on the genome. therefore, the crispr in figure 3f should be a real one, even if it is quite short. the relationship between crisprs from figures 3e and 3f remains unclear.

the structure presented in figure 3g is an example of what could be a false positive reported when querying the index file using the above-mentioned crispr model. even if some repeats are organized like crispr units, the overall structure is repeated, as revealed by the large brown trapezoid on the n strand, and the emr forming that structure cannot be found anywhere else in the genome. this example illustrates the advantages of using pygrams to visually interpret the results of a computational method that predicts the presence of specific patterns of repeated structures.

the conventional crispr model is based on repeated units separated by non-repeated sequences, known as spacers  <cit> . figure 3b, however, shows a short duplication on the left side of the structure, depicted by the orange trapezoid containing roughly  <dig> nucleotides. duplication involves two units and one spacer that are exact repeats. other exceptional internal duplications in crisprs can be observed in archaea genomes. for instance, the large  <dig> kb crispr from methanothermobacter thermautotrophicus str. delta h  contains five duplications . two of them look like tandem duplications, but closer examination shows that they overlap by one crispr unit. the other three duplications show partial overlaps, as pointed out in figure  <dig>  these examples illustrate the ability of a pygram to reveal the complex hierarchical organization of repeated sequences where large repeats contain smaller but highly organized repeated sequences. another example of these hierarchical structures is shown in figure 3g.

analysing repeats across two genome sequences
it was recently reported that s. solfataricus crisprs contained foreign genetic elements from the sirv <dig> virus  <cit> . the authors have suggested that these particular crisprs, which contain sirv <dig> foreign dna, could be involved in the known immunity of s. solfataricus against sirv viruses.

this type of dna transfer can be detected using the pygram application. it consists in looking for repeats for which one copy is located on the archaeal genome, the other copy being located on the virus genome. using this method, five sirv <dig> sub-sequences were detected within the s. solfataricus genome . figure  <dig> shows three of them, and it is interesting to note that these sequences are located within the spacers of a crispr on the archaeal genome sequence. none of the three sirv <dig> short sequences were detected anywhere else in the archaeal genome.

these observations are consistent with data reported by mojica et al.  <cit> , although the present study failed to locate one out of the six known sirv <dig> sub-sequences integrated in s. solfataricus as reported by these authors. this can be explained by the fact that the study only covered recognition of repeats containing  <dig> nucleotides or more, whereas mojica et al. used blast, which is capable of recognizing shorter sequences. the pygram method may still be used to locate this particular sub-sequence, however, by lowering the repeat recognition size to  <dig> nucleotides.

comparison with existing visualization methods
we generated a dotplot, percent identity plot , repeat graph and pygram from the same sequence to compare these visualization techniques in studying repeated sub-sequence organization within genome sequences. the sequence analysed here is the  <dig>  mb genome of s. solfataricus.

the dotplot was produced using dottup from the emboss package  <cit> . it displays the location of all exact hits of sub-sequences measuring  <dig> bp or more . the dotplot provides a general overview of the genome sequence compared with itself, where it appears that a large number of repeated sub-sequences exist. the interpretation of a dotplot, however, is limited to the general location of repeated segments, and two figures are actually required: one to compare the n strand with itself and another to compare the n strand against the rc strand. the result does not provide any information regarding the size and organization of these repeats, even when zooming in on regions of interest such as crisprs . pygrams reveal this kind of information more precisely, from a general view down to more detailed images . in the general view, repeat frequencies underline regions of particular interest, and the magnified views of these regions clearly depict how they are organized.

a pip is useful in determining the degree of conservation between two or more sequences. the pip is a 2d diagram where the x-axis displays a sequence, while the y-axis shows the percentage of identity, in the 50–100% range, of gap-free segments of blast z-computed sequence alignments. the pip presented in figure  <dig> was created using ptpmaker  <cit>  to compare the s. solfataricus genome sequence with itself. unlike the dotplot, the pip diagram does not sketch an overall view of the sequence: figure  <dig> is a small snapshot of a 30-page document. like dotplots, a pip remains useful in locating repeated segments, but still conveys no information regarding the size and structural organization of these repeats: figure  <dig> spans a crispr , but it remains difficult to understand its structure.

repeat graphs were produced using reputer  <cit>  . like the dotplot and pip, repeat graphs highlight the strong repetitive organization of the s. solfataricus genome sequence, but it remains quite difficult to depict the nature of this organization. for instance, when targeting crispr analysis, a repeat graph does not conveniently depict a structure of this type . unlike a pygram, at least two pictures must be produced when using a repeat graph: the first is used to compare the n strand with itself, while the second is used to compare the n strand with the rc strand.

CONCLUSIONS
the pyramid diagram  is a new visualization method that aims to summarize the complex hierarchical organization of repetitive sequence structures for either a single genomic sequence or across several sequences.

in contrast to similar existing tools, the pygram is not based on repeat pair display, and provides convenient graphical functions such as two-strand visualization, repeat frequency display, a zoom feature, repeat selection and annotation display. it therefore produces a better view of repeated sequences at all levels, from the complete genome sequence down to the nucleotide. moreover, closely associating a viewer and a querying tool results in an efficient repeat browser, as illustrated in the examples on crispr investigation and dna transfers in archaea genomes.

the prototype developed uses a generalized suffix tree to produce emrs. it achieves good linear performance  with respect to the sequence size and the number of emr occurrences to be handled, but the current application is limited to genome sequences containing no more than  <dig> million nucleotides on a computer with  <dig> gb of ram. during development, however, in the pygram browser implementation phase, the system that identifies the repeated sequences , was separated from the browser engine. this feature opens the pygram browsing infrastructure to other repeat models, in particular error-prone ones. in this way, pygram could be used to perform the difficult job of analysing divergent sequences, a particularly crucial task in comparative genomics.

