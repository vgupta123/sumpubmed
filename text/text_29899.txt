BACKGROUND
until very recently, genome sequencing projects such as the human , mouse , or maize genome projects  have relied on the construction of physical maps as a framework to support bac-by-bac or whole-genome shotgun sequencing  <cit> . alternatively, genome sequencing could be conducted via whole genome shotgun approach  or using the novel next generation sequencing technologies . physical maps can be established via bac clones fingerprinting using restriction enzyme profiling  <cit>  or by digital fingerprinting  <cit> , and subsequent assembly of the clones into contigs based on the systematic comparison of fingerprint profiles. bac contigs are then ordered using molecular markers and genetic or radiation hybrid maps. in addition, to providing a framework for sequencing, such maps can be used for high-resolution gene mapping  <cit>  and map-based gene cloning  <cit> . despite significant progress in fingerprinting techniques such as high information content fingerprinting   <cit>  and the development of efficient programs such as fpc   <cit> , maximal likelihood-based reconstruction of physical map  <cit> , random cost algorithm minimizing triplewise linking distance  <cit> , etc. to automatically cluster clones into contigs, physical mapping remains long, laborious, and expensive especially for large and complex genomes that contain a high amount of repeated sequences . therefore, the development of algorithms and methods making this process more cost effective is important in view of the increasing amount of non-model species that will be sequenced in the near future.

the basis of contig assembly is that the same dna fragments in different clones are cut by a given restriction enzyme at the same sites. hence, the presence of fragments with the same length in the fingerprints of two clones, c <dig> and c <dig>  indicates a possible overlap between these clones. however, in large genomes, the abundance of repeated elements and the limited accuracy of scoring the band lengths may lead to the identification of shared bands for two clones that originate from different parts of a chromosome, thereby reducing the reliability of contig assembly. thus, contig assembly relies on the identification of significant overlaps. this implies the calculation of p-values of clone overlap for any pair of clones c <dig> and c <dig>  namely, the p-value is the probability for two random clones to have the same or a higher number of shared bands by chance. the exact calculation of the p-value is usually problematic . the fpc software uses the sulston approximation  <cit>  that is based on the simplest model of taking into account tolerance , and the assumption that appearances of fragments  of different lengths are independent and identically distributed . this approximation is valid in cases where a small number of clones are matching but can be very inaccurate in situations with an intermediate to large number of common bands  <cit> . moreover, it was observed that different bands can have very different abundances within a fingerprint database. to take this variation into account nelson et al.   <cit>  proposed to exclude the most abundant bands for reducing the proportion of false overlaps. other ways of taking into account band frequencies based on bayes theorem were also proposed , but such methods are cumbersome, especially with hicfs .

the fpc program package assembles clones into contigs based on fingerprints generated by either the end-labeled double digest method  <cit>  or the complete digest method  <cit> . because of technical difficulties related to the large amount of clones to order, fpc divides the clones into subsets of relatively small contigs in which clones are supposed to be highly significantly overlapping. clones are ordered using local optimization and building band maps. to achieve a treatable size and ensure high accuracy of contigs, fpc users usually employ a very high initial threshold  for the p-value of clone overlaps. however, for many clone pairs that do overlap physically, the p-value may not overcome such a cutoff. as a result, numerous short sub-contigs and singletons are produced calling for subsequent merging. in fact, the ordering of bands and highly overlapping clones in short contigs is questionable. the merging of short sub-contigs and singletons is also problematic.

additional difficulties can be caused by the presence of "questionable"  clones . the presence of q-clones and false clone overlaps can result in a wrong clone order or even in the assembly of clones deriving from different parts of the genome into the same contig. the presence of bands with similar lengths also make a clone ordering complex thereby hampering the correct map assembly  <cit>  and resulting in low-quality minimum tiling paths . in particular, unexpected gaps can arise when a mtp is checked by sequencing . although many physical maps have been constructed with the standard fpc algorithm and successfully employed for genome sequencing, quite a lot of errors in contig assembling were also found  <cit> . the diversity of factors affecting the map quality in different situations calls for the development of new methods and tools complementing fpc and other existing packages. this problem is especially important for physical mapping of complex genomes with a high level of repeats, such as in wheat  <cit>  and barley.

in this paper, we present a novel approach coordinating clone clustering and ordering. we also propose to use a new metric of clone overlap instead of the standard sulston score. in contrast to fpc, the linear topology contig  program starts clustering with a relatively relaxed cutoff and uses the topology of significant clone overlap to obtain longer contigs with a realistic  structure. in each cluster, clones are ordered based on a global optimization procedure, and clones that disturb the order stability  are excluded from the contig. ordered contigs are then merged with a relaxed cutoff into longer contigs using the network representation of the significant clone overlaps as a control of the contig topology . in addition to contig building, ltc can be used for verification, repairing, and elongation of contigs obtained by other methods .

the reliability of the proposed methodology was assessed with hicf data from the wheat 3b physical map  <cit> . the performance of ltc vs. fpc was compared also on the simulated bac libraries based on the known genome sequences for chromosome  <dig> of rice and chromosome  <dig> of maize. the results demonstrate that contigs built by ltc are longer, better ordered, and more robust to errors caused by false and missing bands than those obtained by fpc and can make the mtp selection more effective, leading to more reliable physical maps and increased sequencing cost efficiency.

methods
i. contigs construction
in ltc, the contig construction algorithm includes the following steps:  calculation of p-values for clone overlaps;  temporary exclusion from the analysis of the clones and clone overlaps unproved by parallel paths;  adaptively changing cutoff clustering;  "non-linear" cluster splitting into sub-clusters with linear topological structure;  global optimization ordering;  verification of the orders by re-sampling;  sub-contig merging into contigs; and  mtp construction.

 calculation of p-values for clone overlaps
in the first step, ltc calculates all pair-wise p-values pr of clone overlaps and selects threshold pr <dig>  to declare clones c <dig> and c <dig> with pr <pr <dig> as overlapping clones. a proper choice of the threshold pr <dig> should provide a reasonable trade-off between two requirements:  providing a sufficient number of pairs of overlapping clones, and  reducing the proportion of false overlaps among selected clone pairs. instead of the sulston score pr employed in the fpc package, ltc uses metrics pr and pr that estimate p-values more accurately  and the corresponding modifications pr and pr that take into account the number of shared genetic markers. metric pr is based on the sulston model of "random" clones  <cit> . this model assumes that appearances of fragments  of different lengths are independent and identically distributed . unlike the sulston score, pr provides a good approximation even in situations with relatively large clones and a high number of matching × bands. metric pr is based on a model with similar assumptions, but bands may not be identically distributed  .

let n <dig> and n <dig> be the numbers of bands in clones c <dig> and c <dig>  ltc approximates the probability that the number of bands present in both clones c <dig> and c <dig> is equal or higher than k by exp{-}, for k >k <dig>  coefficients a <dig>  a <dig>  and a <dig> are estimated by the monte-carlo method, i.e., by simulating a large number of pairs of random clones  and scoring the "observed" number of shared bands ; value k <dig> is defined by inequality: exp{-} <  <dig>  for all k >k <dig> . shared genetic markers are taken into account by adding the term amarkm to a <dig> + a1k + a2k <dig>  where m is the number of shared markers. we used amark =  <dig> ln  <dig> to make the overlap of clones with a shared marker more significant than 10- <dig>  if bands are not assumed to be identically abundant, then the number of shared bands k is represented by -∑ lnfb, where the sum is taken over all shared bands and fb is the abundance of band b. clearly, if all bands have equal abundances then k is proportional to the number of shared bands . values fb can be estimated by the maximum likelihood method: the probability that a random clone with n bands contains band b is 1-n. . taking band abundances into account satisfies the additive condition, when the sum of weights of two bands is equal to the weight of "pair of bands" that appears with an abundance equal to the product of abundances of the bands .

 temporal exclusion of clones and clone overlaps not proved by parallel paths 
in contrast to fpc, ltc excludes putatively false significant overlaps and putatively problematic clones before clustering. the main idea behind the identification of problematic clones and clone overlaps is that each part of the chromosome is most probably covered by several clones . one can expect that chimerical clones and false clone overlaps are not proven by parallel clones  <cit> . thus, clustering should subdivide the clones into groups covering different parts of the chromosome. ltc clusters the clones in such a way that each position of a chromosomal region , covered by clones from the cluster, is covered by several  significantly overlapping clones. moreover, it requires that, even after excluding any single clone or clone overlap, for any pair of clones ci and cj from the cluster c <dig>  a sequence of clones c,..,c from c <dig> should exist such that c = ci, c = cj and overlap of clones c and c is significant for all k =  <dig> ..,n- <dig> 

let pr <dig> be a liberal level of cutoff . ltc calculates all pair-wise clone overlaps pr and considers the results as a net of significant  overlaps. for each edge e  of the net, parallel short paths  connecting vertexes  of edge e, but not going through edge e, are searched . edges having no such paths are temporarily excluded from the analysis. then, the following procedure is applied to each vertex c0: for each pair of neighbor vertices c <dig> and c <dig>  <pr <dig> and pr <pr0), short "parallel" paths of 2- <dig> edges in this net, connecting vertices c <dig> and c <dig>  but not going through vertex c <dig>  are searched . vertices having at least one pair of neighbors without such parallel paths are also temporarily excluded from the analysis. the excluded clones and overlaps can be used later to merge or elongate contigs . for convenience, we refer to such a procedure of temporal excluding from the analysis not proven by parallel paths as to the tenpp procedure with respective cutoff.

 clustering with "adaptively" varying cutoff
the ideal way to obtain a reliable contig assembly is to write down a full likelihood for the entire problem that allows a possibility for errors and repeats in data and find out all solutions with likelihood close to the maximum  <cit> . however, the expected length of band map for entire dataset is usually too long and finding maximal likelihood solution will be too hard even for modern computers. moreover, estimating the probabilities included in the likelihood function is also not straightforward. subdividing the data into clusters putatively covering non-overlapped parts of genome sequences by identification of putatively false clone overlaps and chimerical clones can simplify the problem  <cit> . in contrast to fpc that uses a stringent uniform cutoff ltc starts clustering with a liberal cutoff pr <dig> by the single-linkage algorithm  <cit> , and selects the resulting reasonably sized clusters . by "reasonably sized clusters", we arbitrarily  define clusters with 6- <dig> clones. actually, larger clusters also can be analyzed by the ltc program and subdivided into parts with linear topological structure . such a restriction was used to reduce the cpu time increasing cubically with number of clones in cluster. additional reason for this restriction was the fact that the program pajek  <cit>  used for the visual control of the net structure of significant overlaps cannot represent large nets well. using other programs for net visualization can help to overcome this problem. artificial split of real contig can result in additional errors in ordering of obtained parts complicating their merging on the next steps.

for each cutoff level, ltc excludes putative false clone overlaps and putative chimerical clones in large clusters  by the tenpp procedure described above. then, the single linkage algorithm is run again. at the next step, ltc increases the stringency, but only after removing the selected reasonably sized clusters . a schematic representation of the algorithm is provided in figure  <dig>  refer to additional file  <dig>  section  <dig> for simple example illustrating the efficiency of the proposed algorithm. note that repeating the tenpp procedure will be effective only in cases of high proportions of false significant clone overlaps. if such proportion is not high, then it is reasonable to expect that most of the putatively chimerical clones and false clone overlaps will be excluded directly after the first tenpp procedure. sizes of clusters can also be reduced by temporary exclusion of "buried" clones. these clones can be used later to obtain more reliable band maps.

 looking for linear topological structure
false clone overlaps and chimerical clones can lead to clusters with non-linear topological structures  which is incompatible with the one-dimensional structure of eukaryotic chromosomes. to facilitate the detection and visualization of such clusters, ltc employs a representation of clusters as nets of significant overlaps. obviously, ordering topologically non-linear clusters is problematic. to overcome this problem, we propose to split such clusters into sub-clusters with linear topological structure by excluding clones from the branching nodes from the analysis . non-linearity of the cluster structure can be detected by scoring ranks of vertices relative to the diametric path. by definition, a diametric path of the net is the longest, in terms of the number of edges, among the shortest paths between all possible pairs of vertices . note that several diametric paths can exist for the same net. any of diametric paths can be used for detection of non-linearity: the presence of vertices with rank  <dig> and higher indicates on non-short offshoots from the selected diametric path and, hence, a possibility of non-linear structure .

 ordering using global optimization
ltc orders clusters with linear topological structures without constructing their band maps. here, the ordering problems are formulated in terms of global optimization of some criterion . for simplicity, let's consider only the situation where all clones are not buried. this can be achieved by the temporal exclusion of buried clones, although sometimes this can lead to loosing the contig connection. the criterion w of clone order Ω = ,..., cΩ) is calculated as:

 w=Σk= <dig> ..,n−1wΩ,Ω−bw <dig>  

where wi,j = -log pr, b is the number of adjacent  clones with pr, cΩ) >pr <dig> and w <dig> is the penalty for non-significant overlap of adjacent clones.

the maximization of such criterion can be reformulated as the well-known and intensively studied traveling salesman problem  without the need to return to the starting point. let wmax be the maximum of wi,j = -log pr. ltc defines distance between two clones as

 d=wmax−wi,j+w01{pr>pr0}, 

where 1{pr >pr0} is indicator function equal to  <dig>  if pr >pr <dig>  and equal to zero otherwise. global optimization is effective especially when marker information is also available  <cit> . the exact solution to the tsp is a computationally challenging problem. nevertheless, good heuristics  for the solution of tsp were developed for situations where the number of vertices is up to  <dig> orders of magnitude  <cit> . coordinates of clone ends within the contig based on the solution path Ωbest can be calculated by methods proposed by flibotte et al.   <cit> . using such global optimization approach can result in a reduced number of q-clones and of places in the contig where two neighbor clones have an unexpected non-significant overlap. more effective triplewise linking distance also can be used to reduce the effect of false positive and false negative bands  <cit> .

 resampling verification of ordering
the quality of the clone order within a contig is characterized not only by the value of the chosen criterion, but also by its robustness to small uncertainty of band content of the clones, which can be referred to as "contig stability". to evaluate this stability, ltc uses jackknife re-sampling iterations . namely, ltc first constructs the order using clone overlaps scored over all bands. in addition, it constructs orders using clone overlaps based on randomly selected subsets of bands . then, the identification of unstable regions is conducted based on the frequency distribution of the right-side and left-side neighbors for each clone in the contig order. the higher the deviation from  <dig>  is, the less certain the local order is . one of the main reasons for the appearance of unstable orders is the high similarity of parallel clones that cannot be ordered properly due to missing and false bands. excluding parallel clones allows the construction of a stable "skeleton" map, similarly to the approach suggested for building genetic maps .

 merging of sub-contigs
after ordering, ltc tries to elongate contigs by merging those that display significant end-to-end overlaps , or by adding singletons. first, ltc re-analyzes all clones and clone overlaps temporally excluded at previous stages . to elongate a concrete contig, ltc searches for all clones connected  with the clones from either of the contig ends. if adding all of the clones  does not lead to a violation of contig linearity, then such elongation is not problematic. if adding the clones does lead to branching , then each of the possibilities of linear elongations needs to be considered . the correct elongation can be detected by testing clone overlaps based on clone-end sequencing  <cit> . the same problem arises when clones from one contig significantly overlap with internal clones from another contig. the availability of dna markers  with known chromosomal position helps to prevent the merging of contigs from different chromosomal zones. contigs resulting from elongation should be reordered ).

 mtp establishment
in the current version of ltc, mtp construction was based only on the topology of clone overlaps without building of the band map . in our algorithms, we assume:  that mtp should include the terminal clones of the contig;  the adjacent clones in mtp should significantly overlap ; and  mtp should be of minimal length, i.e., include the minimal number of clones. to satisfy these conditions, we select clones for mtp from the diametric path of the net of the significant clone overlaps . in practice other criteria come into play, such as whether or not a particular bac has a genetic marker on it and whether or not bac end sequence is available. a further sophistication of the criterion may also the lengths of the clones  and overlaps with clones disturbing the contig linearity .

ii. verification and improvement of fpc contigs
ltc can be used also to verify and improve contigs obtained with other methods and tools. to test the quality of a contig and understand the underlying reason for the assembly problem, the following procedure can be applied:  calculate all pair-wise probabilities of clone overlaps and represent the contig as a net of significant overlaps;  test connections within this net; and  test for topological linearity of the contig. if poor overlap  of adjacent clones in the mtp occurs together with low significance of the clones' overlap, but the contig is connected and has a linear structure, then it makes sense to attempt fixing the contig by reordering the clones and selecting an alternative mtp. in this case, one needs to take into account that if some part of the analysis was already done for the old mtp, then it can be cheaper to select a mtp with common parts with the old one, rather than to repeat the analysis for the optimal mtp. if the detected problems in the mtp can be explained by non-connectivity or non-linearity of the contig structure, then the contigs must be split into connected parts each with linear structures. ltc first temporally excludes clones and clone overlaps not proven by parallel paths from the analysis . after contig splitting, reordering and verification, ltc attempts merging the contigs by decreasing cutoff stringency or via returning back the previously excluded clones and clone overlaps. ltc also checks  that the added clones are not specified as belonging to other parts of the chromosome.

comparison of clone partitions
different clone partitions obtained with different clustering schemes were compared for the number of clones covered by reasonable size clusters and by direct comparisons of clusters. the comparison was performed by scoring the rand index r  <cit>  and its modification r' . additionally to these characteristics, the mean number m of clusters of the one clone partition overlaps with each of the other clone partition clusters was scored; if the two partitions are very similar, m should be close to  <dig>  two modifications of the m value, m* and m**, that reduce the role played by small clusters and singletons were also scored .

graphical representation of the cluster topological structure
topological structures of clusters are represented by the net of significant  clone overlaps. the nets were drawn using the publicly available program pajek  <cit> . draft pictures were obtained with the kamada-kawai algorithm for drawing undirected graphs  <cit>  performed in the pajek program.

simulation of bac libraries based on the known genome sequences
to test the effectiveness of contig assembly algorithms we simulated clone libraries and clone fingerprints based on known genome sequences . by renzyme we denote the sequentially ordered set of n restriction sites ri corresponding to the chosen enzyme sequence . for convenience, we supplement this set by r <dig> and rn+ <dig> corresponding to the start and end points of the sequence. let l be the total length of the sequence. for each generating clone the program selects a start and end points from renzyme. index istart is selected randomly from  <dig> to n +  <dig>  index iend calculated by istart + s h, where s is equal to  <dig> or - <dig> with probabilities  <dig>   and h is the integer part of a normally distributed random value with mean a and variance σ <dig> . values a and σ <dig> are selected such that mean and standard deviation of clone length be about  <dig> kbp and  <dig> kbp, respectively /l). chimerical clones were generated as union of regular clones, occurring with a probability pchimer .

fingerprint for generated clones were defined by the set of bands of k types  presented in the clone; we used enzymes bamhi, ecori, xbai and xhoi  analogously to ding et al.   <cit> . presence of a band b with length lb and type kb is defined by the presence of sequence part of length lb bp bounded by the restriction site of enzyme kb from the one side and restriction site of one of the k enzymes mentioned above, or restriction site of blunt-end restriction enzyme  or clone end from the another side. in fact, sequence parts bounded by two different protruding-end restriction enzymes are twice included into fingerprint. bands with length <lmin =  <dig> bp or >lmin =  <dig> were filtered out. clones with number of bands n <nmin =  <dig> or n >nmax =  <dig> were also filtered out.

in the preparation of input data for the fpc and ltc programs we introduced noise into sequence length scoring to simulate errors in wet fingerprinting process. "observed" band length was calculated by lb + err, where err is a random value uniformly distributed within interval  or within  with probabilities pε =  <dig>  and p3ε = 1-pε =  <dig>  respectively. this imples that difference between two observations of the same band is less than constant tolerance value t with probability τ = pε22) + p3ε22) + 2pεp3ε. we used ε = t/ <dig> =  <dig>  implying τ =  <dig> . to satisfy fpc format, band lengths were multiplied by  <dig> and rounded . type of band was taken into account by adding  <dig>   <dig>   <dig> or  <dig> for the resulted band length for bands of type k =  <dig>   <dig>   <dig> and  <dig>  respectively. some bands of clones were excluded  to simulate false negatives caused by problems in pcr reactions. automatic fpc assembly was conducted using cutoffs 10- <dig> - 10- <dig> with step ×  <dig> and dqer for contigs having more than 10% q-clones  and rebuild with corresponding cutoff if needed .

materials
to illustrate the advantages of the ltc analytical framework we employed the results obtained in the physical mapping of wheat chromosome 3b  <cit> . the corresponding database included high information content fingerprinting results of  <dig>  of bac clones obtained from the chromosome 3b specific library. the initial input data for ltc included band lengths classified according to four dyes. for each dye, up to  <dig> distinct points  were obtained. two bands were considered of the same if their sizes were within a tolerance = t .

the elements of the ltc analytical framework were tested with fingerprinting data from two regions of chromosome 3b corresponding to clones located in the 3bl7- <dig> - <dig>  and 3bs1- <dig> - <dig>  deletion bins. sixty-nine contigs comprising  <dig>  clones that were found to belong to bin 3bl7- <dig> - <dig>  and  <dig>  to bin 3bs1- <dig> - <dig>  <cit>  were used in the analysis. using ltc, these  <dig> contigs were verified/corrected/extended; alternative contigs were also constructed and compared to the results obtained with fpc.

simulated bac libraries
simulated bac libraries libricechr <dig> and libmaizechr <dig> were constructed based on the known genome sequences seqricechr <dig> and seqmaizechr <dig> for chromosome  <dig> of rice  and chromosome  <dig> of maize , respectively. basic characteristics of the libraries are summarized in table table  <dig> 

here nbinends is the number of restriction sites corresponding to enzyme hindiii chosen for clone-end simulation; lbin is the mean length of bin equal to distance between restriction sites corresponding to enzyme hindiii; nbandends is the number of restriction sites corresponding to the enzymes bamhi, ecori, xbai, xhoi and haeiii used for fingerprinting; lbandreal is the mean distance between restriction sites corresponding to these enzyme; nmean is the mean number of bands  per clone; nmeanobs is the mean observed number of bands . lcloneobs and lclone are mean lengths of clones ; lbandobs is the mean length of bands with length from  <dig> to  <dig> bp; lbandmap is the mean length of bands used for band map length calculation ; nclonessimul is the number of simulated clones; nclones is the number of simulated clones with observed number of bands from  <dig> to 250; nch <dig>  nch <dig>  and nch <dig> are resulted numbers of chimerical clones with number of bands from  <dig> to  <dig> and composed by union of  <dig>   <dig> and  <dig> parts, respectively.

RESULTS
distribution of bands and clone lengths
in total,  <dig> to  <dig> bands were scored  for each of the n =  <dig>  clones of the 3b bac library . the frequency of a band b was calculated as πb = nb/n, where nb is the number of clones containing bands with lengths different from b not more than the tolerance value. the bands showed quite variable abundances . in particular, one band was observed with πb =  <dig> , one with πb =  <dig> , six with πb from  <dig>  up to  <dig> ,  <dig> with πb from  <dig>  up to  <dig> ,  <dig> with πb from  <dig>  up to  <dig> , and others were observed in less than 5% of the clones. the minimal band abundance was  <dig> %. we found more than  <dig> of the five-band combinations  present in multiple clones in a range of 1000- <dig>  clones, where πb of bands was in the range of  <dig>  to  <dig> , pointing to highly significant "linkage disequilibria" of the bands. this can result from physical overlap of considered clones and from repeats  <cit> . the distribution of clone length  was bimodal . the origin of this bimodality is in the construction of the bac library itself. three sub-libraries were constructed including large, medium, and small fragments . fingerprinting results revealed that the medium length sub-library was actually a mix of large and small inserts, and not medium inserts. this resulted in two distinct populations of clone length.

ltc, a new algorithm for building contigs from fingerprinted clones
in this work we have developed a new analytical framework, ltc, for contig assembly of fingerprinted bac clones that can be used as an alternative or as a complement to fpc. in contrast to fpc, the ltc program starts clustering with a relatively relaxed cutoff and uses the topology of significant clone overlaps to obtain longer and more realistic contig structures. instead of a uniform cutoff, ltc uses a procedure that adaptively increases the cutoff stringency. using stringent cutoffs only for large clusters generates fewer short contigs or singletons. after ordering, ltc merges the contigs by relaxing the cutoff , hence, this approach can be referred to as "up-down-up", in contrast to the fpc approach that can be referred to as "down-up" . ltc differs from fpc in a number of important features that are:  the metrics of clone overlap,  consideration of the band abundances,  the algorithm used for clone clustering,  the use of the topological structure of clusters for contig construction,  the application of global optimization methods for clone ordering, and  the assessment of the reliability of the mapping results by re-sampling. these parameters should enable the construction of more robust and longer contigs in particular when dealing with large and repetitive genomes.

to demonstrate the efficiency of ltc in contig assembly, we compared contigs obtained by ltc with contigs obtained using the standard fpc package for bac clones from the wheat chromosome 3b  <cit> . the results are presented for the three main analytical stages shared between the ltc and fpc packages, i.e.,  the identification of significant clone overlaps;  the subdivision of clones into clusters of significantly overlapped clones; and  the ordering of clones within clusters. to assess the capacity of ltc to verify, repair, and elongate contigs obtained by fpc, we also ran ltc on the 3b dataset previously obtained by fpc for the same contigs.

 identification of significant clone overlaps by ltc
both fpc and ltc identify significant clone overlaps in a similar way: for each pair of clones, c <dig> and c <dig>  the p-value pr of clone overlap is calculated and compared with a predefined threshold pr <dig> . clones c <dig> and c <dig> with pr <pr <dig> are declared as overlapping clones. in contrast to fpc that uses sulston score pr  <cit> , ltc uses new alternative metrics pr and pr  in methods) for more accurate approximation of p-value. to compare metrics used in fpc and ltc, values pr, pr, and pr were calculated for each pair of clones from the 3b dataset . the results indicate that pr generally overestimates the significance of clone overlap compared to pr. for highly significant clone overlaps, pr also provides a substantially higher p-value than the standard sulston score pr . however, logarithms of pr, pr, and pr were not absolutely correlated, especially for strongly overlapping clones. for example, liberal cutoffs p <dig> = 10- <dig>  p <dig> = 10- <dig> , and p <dig> = 10- <dig>  gave comparable numbers of significant clone overlaps . we found that  <dig> % of clone-overlaps, which was significant with pr, was not significant with pr  and vice versa . similarly,  <dig> % and  <dig> % of false positives were found for pairs based on the pr &pr, and pr &pr criteria for clone overlaps, respectively. such inconsistencies of the criteria can be explained by non-identical band abundances and by insufficient accuracy of the sulston score to estimate clone overlap probability .

a more accurate estimation of p-values for clone overlaps used in ltc reduces the proportion of falsely significant clone overlaps and increases the proportion of real clone overlaps that have a significant number of common bands. this leads to a reduction of clustering errors. such errors can result in two undesired outcomes:  a wrong contig ordering with poor overlap of some adjacent clones from mtp, referred to as a gap that will call for  splitting the contig into shorter contigs; and  a wrong partition of contigs into "independent" contigs that could not be merged. both outcomes will yield shorter contigs than one could obtain using more correct clone clustering. hence, using more accurate metrics for clone overlaps can result in longer contigs even with fpc algorithms for contig assembly.

analogously to fpc, choosing cutoff stringency for clone clustering should be based on a tradeoff between the advantages of stringent and liberal cutoff values. indeed, on the one hand, clustering with a liberal cutoff results in large but unreliable clusters, where ordering and detecting problematic clones and clone overlaps is challenging. on the other hand, clustering with a stringent cutoff results in many small clusters from which the ordering and identification of problematical clones is presumably "easy", while merging is difficult. therefore, using liberal cutoffs may be a reasonable strategy if and only if powerful tools for multipoint ordering are available, such as with ltc.

 clustering the 3b fingerprinting dataset: comparing different procedures
partition of clones using the ltc adaptive clustering procedure
we applied the ltc main adaptive clustering procedure to the  <dig>  fingerprints obtained for chromosome 3b  <cit> . out of n/ <dig> =  <dig> · <dig> possible clone overlaps,  <dig>   were significant at pr <pr <dig> = 10- <dig> . from these,  <dig>  clone overlaps  and  <dig>  clones  have not been confirmed by parallel paths . after temporal exclusion of these clones and clone overlaps, the entire database was subdivided into  <dig> clusters with a minimal number of clones per cluster of  <dig>  in total,  <dig>  clones  were found in clusters with smaller sizes or as singletons. among the  <dig> clusters, one was large , three were of intermediate size  whereas the remaining ones included less than  <dig> clones per cluster .
k - number of significant clone overlaps; n - number of clones in clusters of reasonable size ; ∑n - total number of clones in clusters of reasonable size; n¯ - number of clones in clusters with less than  <dig> clones, singletons, or clones excluded by tenpp procedures; k¯ - number of significant clone overlaps excluded by tenpp procedures; k - number of clusters of reasonable size; m = ∑n/k - mean number of clones in clusters of reasonable size; n =  <dig>  is the total number of clones in the database; ni -number of clones in the large or intermediate size cluster i.

the tenpp procedure was used again on the entire database with cutoffs pr <dig> = 10-3pr <dig> = 10- <dig> which found additional significant clone overlaps and  <dig> clones not proven by short parallel paths. after temporal exclusion of these clones and clone overlaps, four large and intermediate clusters were subdivided into  <dig> clusters with at least  <dig> clones per cluster. in this stage, additional  <dig> clones were found either in smaller size clusters, or as singletons, or were excluded by the last tenpp procedure. among the remaining  <dig> clusters, one was large , one was intermediate , and the others contained up to  <dig> clones per cluster .

another round of the tenpp procedure with cutoffs pr <dig> = 10-3pr <dig> = 10- <dig> identified additional significant clone overlaps and  <dig> clones not proven by short parallel paths. large and intermediate clusters were subdivided into  <dig> clusters with a minimal number of clones per cluster of at least  <dig> after temporal exclusion. this resulted in  <dig> clones that were found in clusters with smaller sizes or as singletons, or that were excluded by the last application of tenpp procedure. thirteen clusters were obtained with one intermediate containing  <dig> clones while the rest had up to  <dig> clones per cluster .

a final tenpp procedure with cutoffs pr <dig> = 10-3pr <dig> = 10- <dig> found additional significant clone overlaps and  <dig> clones not proven by short parallel paths. after temporal exclusion, the remaining clusters were subdivided into  <dig> clusters with  <dig> to  <dig> clones;  <dig> clones were found in clusters with smaller sizes and singletons or were excluded by the last tenpp procedure .

thus, in total,  <dig>  fingerprints were subdivided into  <dig> clusters comprised of  <dig> to  <dig> clones;  <dig>  clones were found in clusters with less than  <dig> clones, were singletons, or were excluded by the last tenpp procedures. the average number of clones per cluster was  <dig> . the partition of clones obtained with this first approach will be referred hereafter as cltc.

skipping some components of the ltc clustering algorithm
to demonstrate the power of the ltc adaptive clustering procedure, we skipped some of the clustering scheme components described above . three versions were considered:  using tenpp only once;  clustering with adaptively changing cutoff stringency but without the tenpp procedure; and  clustering with a uniformly stringent cutoff .

 figure 4b shows that if the tenpp is used only once  then in addition to reasonable size clusters, clustering with cutoff pr <dig> = 10- <dig> results also in two large  and two intermediate size  clusters. repeated clustering with the more stringent cutoff pr <dig> = 10- <dig> gives additional reasonable size clusters plus one large cluster with  <dig>  clones and two intermediate size clusters  . further increase of the cutoff stringency up to pr <dig> = 10- <dig> splits these clusters into one large cluster with  <dig>  clones and two intermediate size clusters . the clone partition obtained with this scenario was called c <dig> 

 without using the tenpp procedure , one very large cluster is obtained even for very stringent cutoffs . this clone partition was called c <dig> 

 clustering with a stringent uniform cutoff   resulted in more singletons and smaller clusters compared to clustering with adaptively changing cutoff . the clone partition obtained with the uniform cutoff will be referred to as c <dig>  whereas the partition obtained with fpc  will be called cfpc. in partition cfpc,  <dig>  of the  <dig>  bac clones were automatically subdivided into  <dig>  contigs  that were manually merged into  <dig>  contigs with  <dig> to  <dig> clones per contig; the remaining  <dig>  clones were found in clusters with less than  <dig> clones or were singletons  <cit> .

among the  <dig> clusters of cltc  only  <dig> have non-linear topological structures, and  <dig> of them have only one branching point. the branching  <dig> non-linear clusters were split into about  <dig> "topologically linear" clusters. note that among the clusters obtained with the other scenarios  the proportion of clusters with non-linear topological structure was much higher . thus, these results demonstrate that the tenpp procedure enables the use of much more liberal cutoffs to obtain clusters of reasonable size. repeating the procedure with more stringent cutoffs helps to split large clusters into reasonable size clusters. clustering with adaptively changing cutoffs helps to protect from "dissolving" the reasonably sized clusters obtained at liberal cutoff stringency under more stringent cutoffs .

comparing ltc vs. fpc clustering
the cltc clustering contains more clones in the reasonable size clusters than cfpc: 80% vs. 73% of the  <dig>  clones. as described in the methods section , "reasonable size of clusters" were arbitrary  defined as clusters with  <dig> to  <dig> clones; obviously, other ranges can also be successfully used. although the number of clusters in cfpc was less than in cltc after the split into clusters with linear topological structure , cltc clusters are proven by parallel clones and hence should be more reliable. moreover, many of the fpc clusters were obtained by manual merging smaller clusters, whereas  <dig> clusters were obtained by ltc before any merging was undertaken. the rand index was high, r =  <dig>  because most of the clone pairs appeared in different clusters. the modification of r: r' =  <dig>  was more informative, reflecting that large clusters in cltc and cfpc were rather different . nevertheless, the values of m <dig> =  <dig> , m1* =  <dig> , and m1** =  <dig>  for the mean number of clusters from cltc overlapped with cfpc  indicating that most of the differences between cfpc and cltc originate from the difference between q-clones excluded by fpc and those excluded by the tenpp procedure in ltc. if one excludes the clones and clone overlaps from the cfpc clusters that were excluded by tenpp in ltc and a clustering is applied with a liberal cutoff pr <dig> = 10- <dig>  then a new clustering cfpc is obtained with m1**) =  <dig>  and m1**, cltc) =  <dig> . this demonstrates that each of cfpc clusters is actually a sub-cluster of cltc. thus, all of ltc contigs are longer than the corresponding fpc sub-contigs proven by parallel clones.

 verification of fpc contigs
the ltc adaptive clustering procedure was also used to test  <dig> fpc contigs  that were assigned to the 3bl7- <dig> - <dig>  and 3bs1- <dig> - <dig>  deletion bins of wheat chromosome 3b  <cit> . the ltc analysis indicated that  <dig> of the contigs  had regions where the overlap between two adjacent clones was not significant with the pr <dig> = 10- <dig> criterion and therefore were considered as gaps by ltc. the maximum number of gaps per contig was  <dig> . the gaps detected in the fpc-based contigs were of five main origins:  contig consisting of two  non-connected parts;  buried clones causing conflicts between requests of linear ordering and contig connectivity;  weak power of ordering tools in fpc based on local optimization;  non-synchronous utilization of information on shared markers and common bands;  topologically non-linear structure of the contig, mostly caused by the presence of clones and clone overlaps not proven by short parallel paths.

contig consisting of two non-connected parts
only one contig located in the 3bl7- <dig> - <dig>  bin corresponded to this category. the net of significant clone overlaps for this contig consisted of two non-connected parts  = 10-10). these parts can be connected by adding only one clone . such a situation may result from the exclusion of one or two connecting clones  presumably considered as q-clones by fpc at the stage of cluster ordering.

buried clones causing conflicts between ordering and contig connectivity
the significance of clone overlap is determined by the number of common bands and clone lengths. hence, if clone ci is buried in clone cj and significantly overlaps with clone ck,, then it is not necessary that the overlap of clones ci and ck is also significant . thus, after excluding buried clones, the net of significant clone overlaps can lose its connectivity . on the other hand, it is likely that each path along the net of significant connections, that visits all vertices, will visit the vertex corresponding to clone ci, buried in clone cj, before and after visiting the vertex corresponding to clone cj . in other words, vertex corresponding to clone cj is visited twice, and therefore, such paths cannot be found directly by tools constructed for solving the classical tsp. such a situation was found in  <dig> contigs and could be solved by temporal exclusion of only a subset of buried clones from the cluster before ordering.

weak power of ordering tools based on local optimization
gaps that can be repaired by clone reordering within clusters were found in  <dig> of the  <dig> considered contigs . such reordering of clones usually changes clone positions in the contig only locally . band maps based on ltc clone ordering were compared with fpc band maps. it was found that adjacent clones in ltc ordering cover on average more common bands in a corresponding band map than adjacent clones in the fpc band map . this leads to better correspondence between number of common bands and number of common positions in the band map for significantly overlapped clones. similar results were obtained by flibotte et al.   <cit> . increased coverage of the band map leads to higher robustness of ltc contigs to technical errors in fingerprinting. it also results in a lower number of band repeats. hence, band maps based on ltc ordering are somewhat simpler than band maps obtained by fpc.

topologically non-linear structure of the contig
a non-linear contig structure was found in  <dig> of the considered contigs . this was mostly due to the presence of clones and clone overlaps not proven by short parallel paths. excluding such clones and clone overlaps  and clustering by the single linkage algorithm subdivided all of the  <dig> contigs with non-linear structure into linear parts, but also splits some other  contigs into smaller parts. hence, some of ltc contigs are shorter than corresponding fpc contigs, but are much more robust to the presence of chimerical clones and false significant clone overlaps. it should be noted that end-to-end merging of ltc contigs seems to be a less problematic procedure than merging of fpc contigs because ltc does not place most problematic clones to the contig ends.

non-synchronous utilization of information on common markers and common bands
in certain cases, the anchoring of markers to physical contigs leads to situations where a marker is found in two different contigs or even in two non-overlapping clones of the same contig. such a situation can arise in cases when a single marker is situated on the overlap of two clones having only a non-significant number of common bands. it also can be a result of marker duplication or errors in marker amplification or contig assembly. using fpc tools, such a situation cannot be recognized  and generally results in the artificial fusion of the two contigs. in contrast, ltc is able to detect such a situation because marker information is used synchronously with shared-band information in the analysis. in this case, the presence of duplicated markers and/or errors in marker amplification will usually lead to non-linearity in the topological structure of the cluster that will be detected by ltc .

 elongation of fpc contigs by using ltc
fpc contigs from the 3bl7- <dig> - <dig>  and 3bs1- <dig> - <dig>  deletion bins were compared with the contigs that were constructed from the entire fingerprinting dataset using ltc . it appeared that short fpc contigs  were usually parts of ltc contigs. in such situations, ltc allowed the elongation of fpc contigs in a natural way. several examples of such elongation of fpc contigs are presented in figure  <dig>  long fpc contigs  were usually different from those obtained with ltc. we assume that the main reason for such a difference is that clones and clone overlaps excluded by the tenpp procedure do not fully coincide with q-clones and false significant clone overlaps identified by fpc. this leads to differences in clone partitions into clusters  and can result in different contigs. in such cases, pcr amplification of bac-end-sequences should be performed to assess the robustness of the contigs and determine which assembly is correct. for example, in the 3b dataset, some overlaps of adjacent clones from the mtp were not confirmed by sequencing and no satisfactory alternative mtps could be found using fpc for these contigs . for such situations alternative ltc contig assemblies were proven useful . note, sometimes ltc contigs included parts of different fpc contigs that were considered as belonging to different chromosomal zones based on marker assignment information . we explain such observations by the fact that the location of the contig in the chromosomes is determined by position markers that were found in the clones of the contig. hence, if contig assembly was made incorrectly, then the position of clones on the chromosomes is also determined with errors. verification of the contig using bac-end-sequencing can clarify the contig assembly and help to determine the position of clones on the chromosome.

comparison of ltc vs. fpc on simulated bac libraries based on known genome sequences
simulated bac libraries libricechr <dig> and libmaizechr <dig> were automatically assembled using fpc program and our ltc package . resulted contigs were tested using methods from ltc program and compared with real position of simulated clones in the genome sequence. results of this analysis are briefly summarized in the table  <dig> 

here nclonesctg is the total number of clones in contigs with  <dig> clones and more ; nctgs is the number of contigs with  <dig> clones and more; nmeanclonesctg is the mean number of clones in the contigs with  <dig> clones and more; lmeanclonesctg = lcloneobs nmeanclonesctg/covarege is estimated mean length of the contigs with  <dig> clones and more; nchctg is the number of chimerical clones in the contigs with  <dig> clones and more ; nqnotch is the number of non-chimerical clones that were identified as q-clones ; nq is the number of clones that were not included into contigs; nctgsnonlinear is the number of contigs with non-linear topological structure; nctgch is the number of contigs containing clones  from non-overlapping parts; nctgparts is the mean number of non-overlapping parts per contig; nctgordwrong is the number of continuous contigs with errors in clone ordering.

the results presented in table  <dig> indicate that ltc contigs are longer and more reliable than those obtained by fpc:  average contig length  <dig>   vs.  <dig>  kbp  for rice, and  <dig>  vs.  <dig>  kbp for maize;  number of contigs with non-linear topological structure was  <dig> out of  <dig>  vs.  <dig> out of  <dig>  observed in rice analysis, and  <dig> out of  <dig>  vs.  <dig> out of  <dig>  in maize. low efficiency of chimerical clones identification seems to be the main source of the errors in the fpc contig assembly: only 9%  or 7%  of chimerical clones were not included into fpc contigs. excluding clones and clone overlaps not proven by parallel clones  used in ltc algorithm enabled us to identify and exclude 89%  and 81%  of chimerical clones even using much more liberal cutoff: 10-25- 10- <dig>  vs. 10-45-10- <dig> . diagnosis of contig linearity implemented in ltc can also assist in detecting problematic contigs assembled using fpc:  <dig> out of  <dig> chimerical rice fpc contigs and  <dig> out of  <dig> chimerical maize contigs were detected as having non-linear structure. ltc was also able to identify problems in clone positioning within fpc contigs leading to non-significant overlaps of adjacent clones. reordering of clones within contigs without chimerical clones was usually able to fix these problems.

using these simulated bac-libraries we found that ltc can encounter some difficulties with ordering contigs that contain long repeats causing false significant overlap of clones that belong local neighborhoods. likewise, we found one pair regions separated by ~ <dig> mbp in the sequence of maize chromosome  <dig>  with several significant  overlaps between corresponding clones. in fact, these overlaps caused non-linear cluster topology , but overlaps of clones within each of these two regions were by far more significant  and increasing the cutoff stringency resulted in split of this cluster into two with linear topological structure. ltc can also encounter difficulties in situations where chimerical clone consists of two parts that in fact belong to non-overlapping regions of a small neighborhood in the sequence. in addition, we found that most of chimerical clones that have not been detected by ltc actually consisted of one long part  belonging to the region of the contig and shorter part  outside the region. we think that these chimerical clones can be identified by constructing more accurate maximal likelihood band map for ltc contig  <cit> .

general discussion
although many physical maps constructed with the standard fpc algorithm have been successfully employed for genome sequencing, a substantial amount of errors were found in contig assembling  <cit>  and subsequently corrected using complementary methods. various factors, such as the genome composition , employed wet strategies and technologies of dna cloning and clone fingerprinting, insufficient genome coverage of the bac libraries, and a low accuracy of band scoring can affect the efficiency and accuracy of bac assembly, hence the quality of the physical map. the power and flexibility of bioinformatics tools and human factors may also play a role:  from the beginning, reading the band sizes is somewhat subjective because it is very sensitive to selection of the threshold parameters for automatic peak detection;  clustering  can be highly affected by false significant clone overlaps and chimerical clones;  cluster ordering depends on the selection of an initial clone and the presence of equal-sizes but not common bands in different clones;  decision-making in contig merging is difficult to formalize and the result depends on the choices made among a high number of possibilities;  anchoring  is also mostly made by hand and verification of mapping results  is needed.

our results show that many of the previously mentioned difficulties can become less problematic with the use of new physical mapping algorithms and empowering of standard algorithms by additional tools. the quality of physical maps can be improved by a more accurate identification of chimerical clones and false clone overlaps. in particular this can be achieved by a more reliable scoring of the clone overlap p-value, by the utilization of "information content" of the bands, and by investigating the topology of nets of significant clone overlaps. clustering can be improved by the utilization of clone overlaps with more liberal p-values: such overlaps result in larger clusters and hence simplify contig elongation and merging. using more effective tools of contig ordering and ordering verification also improves contig quality and leads to shorter mtps. more reliable multilocus genetic maps allow aligning the physical contigs to the correct chromosomal position more accurately thereby improving the quality of anchoring.

CONCLUSIONS
the proposed ltc methodology helps in obtaining more realistic  clusters of clones that are expected to have linear topological structure corroborating the linear structure of the eukaryotic chromosome. analytical tools for clone ordering based on global optimization methods allow achieving coordinated clone orders and, presumably, shorter band map. tools of ltc can also be used to "cure" and elongate contigs obtained with fpc or other methods. in particular, the proposed framework proved effective for fixing gaps in mtps detected at the sequence level as well as for choosing alternative mtps to increase the efficiency of sequencing.

we have shown that the ltc program has a few advantages over standard fpc in contig assembly. the disadvantages of ltc are in its less friendly interface, which lead to the possibility to work only with a windows operating system and to a rather primitive output of the results. some steps, such as, the building of band maps and automatic merging of contigs, the possibility of compound alignment and optimization of physical and genetic maps, are still not implemented in ltc. at this stage, it would make sense to utilize the advantages of these two packages in the following way:  construct the contigs with ltc at the beginning of a physical mapping project;  for each resulting contig separately construct band maps using fpc;  test fpc orders using ltc;  resolve the detected problems by excluding clones disturbing the ltc-order in fpc-contig;  select a mtp for the verified contigs;  if some gaps are found in the resulting mtp, try to cure them by changing or adding clones to the mtp using ltc;  align contigs to a consensus genetic map  <cit>  using genetic markers using fpc. in addition, ltc can be used to check the results of physical maps already constructed by fpc and provide additional information or corrections by curing, elongating, and merging the fpc contigs. this can be useful in the final steps of a fpc-based project in which ltc can be used for selecting or curing the mtp.

although our approximation of p-value seems to be more accurate than the standard sulston score, better approximations are needed to estimate p-values for highly significant overlaps. this can be important for very large databases of clones  especially for organisms with highly repeated genomes. to achieve stability of clone ordering we need to construct effective algorithms of excluding extra parallel clones for highly covered regions and buried clones without endangering contig connectivity. ordering of clones is associated with the bands' relative positions in the chromosome. hence, ltc procedure used for clone ordering can be improved by the parallel construction of a globally optimal map of bands. the process of merging contigs can be further optimized by better coordinating the "wet" and "dry" tools. we also think that criteria for the mtp selection can be improved by taking into account the number of bands and band abundances in clones and clone overlaps.

authors' contributions
zf designed algorithms, wrote the code for ltc package, conducted the analysis using ltc  and fpc packages  and wrote the manuscript. ep provided the hicf data on 3b, conducted the fpc analysis for 3b, suggested the algorithm for simulations, proposed ideas for comparison of ltc and fpc methodologies and participated in preparing the manuscript. dm developed algorithms and wrote code for fast global optimization of clones ordering within the contigs. cf contributed to the discussion and participated in preparing the manuscript. ak supervised the project, proposed ideas for ltc methodologies, contributed to developing of the algorithms, helped to conduct the analysis and wrote the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
more detailed description of ltc approach. we have included the following items in an additional file named add_file_ <dig> doc:  description of p-value approximation for clone overlapping;  paragraph about comparison of ltc-approximation of p-value for clone overlapping, sulston score, and mutual overlap statistic;  example illustrating clustering with "adaptively" varying cutoff;  examples of complications that one can meet in dealing with clusters having non-linear topological structure; and  a paragraph about comparison of clustering results obtained by different methods.

click here for file

 additional file 2
supplemental figs. in this file we present figures that were not included into the main text of the paper. these figures clarify ideas of ltc approach and illustrate some of our results.

click here for file

 acknowledgements
the research leading to these results has received funding from the european community's seventh framework programme  under the grant agreement fp7- <dig> . it was also partially supported by binational agricultural research and development fund  and by the israeli ministry of absorption.
