BACKGROUND
microarray-based comparative genomic hybridization  for two-color array platforms uses dna samples from a reference individual and a test individual, each labelled with a different fluorescent dye, and competitively hybridizes them to an array composed of immobilized dna fragments based on genomic sequence of the reference individual  <cit> . array cgh produces abundant information about genetic distance for all genes between pairs of individuals. this ability to estimate genetic distance for all genes in one assay has made array cgh an attractive tool for phylogenetic analysis. several studies have used array cgh to compare bacterial species  <cit> , and in one case both human and bovine data  <cit> , to deduce evolutionary relationships from cluster analysis. other studies, also mostly in bacterial systems, applied distance and parsimony tree-building techniques to construct phylogenies from microarray data  <cit> .

a complication that has not been addressed in these studies involves the use of one species to design the array, which requires that all competitive hybridizations have as one partner the same reference species. this situation has been termed "unbalanced gene content"  <cit>  or, as we will refer to it, the single reference design. use of a single reference individual is at odds with traditional sequence-based phylogenetic analysis, where all pairwise comparisons among the taxa are used for tree construction. an underlying assumption of array cgh phylogeny is that the massively parallel nature of microarrays, where genes number in the thousands, will provide enough phylogenetic signal to resolve a tree, even when the microarray is based on a single reference taxon.

this approach has been applied to bacterial species with largely clonal reproduction, for example studies by dagerhamn, wan, and guidot  <cit>  reported uses of cgh for a subset of genes to recover clusters of bacteria concordant with previously published mlsa phylogenies. the work of solheim et al directly compared mlst with acgh trees for enteroccocus species with the goal of defining lineage-specific genes  <cit> . although the biology of bacteria differs from that of fungi like neurospora or yeast in that bacterial horizontal gene transfer is not the same as eukaryotic mating and meiosis, we wanted to determine if cgh would be as useful with eukaryotic microbes as it appeared to be with bacteria.

in the accompanying study we examined this question using an in silico approach. while it was sometimes possible to recover the topology used to initiate the simulation, it was possible for only a very restricted set of conditions involving the underlying tree topology. key parameters affecting success were the position in the topology of the reference taxon, and the method of phylogenetic analysis.

to challenge our in silico findings with experimental data, we developed experimentally derived cgh data for neurospora, and used it to test cgh as a tool for phylogenetic analysis that could be applied to any group of genetically isolated taxa with any combination of clonal and recombining reproduction. using the  <dig> mer expression array designed for neurospora crassa  <cit> , we compared seven species of neurospora, as well as the related species podospora anserina and sordaria macrospora. the relationships of these nine species have been established by phylogenetic analyses of multiple dna sequences , which has provided a well supported tree spanning closely related neurospora species and representatives of their neighboring genera  <cit> . the close relatedness of these taxa — and the fact that they are not subject to large amounts of fluctuation in gene content — makes them excellent candidates for successful acgh phylogeny.

based on published accounts, we used eight general methods of phylogenetic analysis of acgh data. these approaches, which are detailed in the methods section, encompass different methods of data normalization and post-normalization, two basic tree construction methods , and three more sophisticated methods of processing cgh ratio data . to compare the phylogenies inferred from array cgh analysis to those based on mlsa, we used the symmetric  and agreement subtree  tree-to-tree distance metrics  <cit>  implemented in the program paup  <cit> .

we show that cgh cannot be counted on to recover the established multilocus phylogeny for neurospora  <cit> . we also find, in our reanalysis of yeast cgh data  <cit> , that cgh cannot be counted on to recover the mlsa phylogeny for saccharomyces sensu stricto species. a good phylogenetic method should be able to recover phylogenies in cases where there is sufficient phylogenetic signal in the genetic or genomic variation to produce a well-supported phylogeny. our application of phylogenetic methods to these two sets of empirical cgh data does nothing to contradict the conclusions of our accompanying analysis of simulated data . in fact, our results suggest that the noise inherent in array cgh data further compromises use of these data for phylogenetics.

methods
dna preparation and hybridization
fungal strains used in this study are listed in table  <dig>  neurospora strains were obtained from the fungal genetics stock center  <cit> , sordaria macrospora was generously provided by the kück lab , while podospora anserina was provided by philippe silar of the institut de génétique et microbiologie .

genomic dna was isolated with the dneasy plant tissue kit  with the following modifications: tissue was lyophilized, ground, and then incubated at  <dig> c for an hour with  <dig> mm tris-hcl,  <dig> mm edta, 3% sds solution with  <dig> μl of proteinaise k . this was followed by chloroform:isoamyl alcohol extraction. the aqueous phase was added to the qiagen extraction buffer and extraction proceeded according to the manufacturer's instructions.

genomic dna was sheared mechanically with a target range of  <dig> kb using a hydroshear® . test species and reference species were labelled using the bioprime® plus array cgh indirect genomic labeling kit . a full-genome  <dig> mer oligonucleotide microarray representing  <dig>  individual elements was constructed as described for a partial  <cit>  and the full genome array  <cit> . slides were treated to minimize background fluorescence with the pronto!™ background reduction kit according to the manufacturer's instructions , then pre-hybridized and hybridized as described  <cit>  with several modifications, which are published online at http://www.yale.edu/townsend/links/ffdatabase/downloads.html.

images were scanned with an axon genepix  <dig> b scanner . genepix pro  <dig> software was used to quantify hybridization signals. bad spots were flagged automatically by genepix software and each slide was manually inspected. each species comparison was done in at least quadruplicate with dye swaps.

data filtration and normalization
data were normalized for non-biological variation related to printing and hybridization of spotted microarrays by four methods. the first normalization, linear and based on the ratio of means , used a set of twelve control spots with no known sequence polymorphisms between n. crassa and n. discreta to standardize the ratio data . for the second normalization, print-tip lowess , an additional percent pixel saturation cutoff and a roundness score were used to filter the initial dataset according to the acuity manufacturer's recommendations. the third normalization method is a different implementation of loess  and the fourth is robust spline , both from the r package limma  <cit> .

in addition to the four kinds of normalization, filtered according to the criteria discussed in the methods, an additional filtering criterion was applied for a duplicate subset of the linear and lowess normalizations, where a spot had to scored as present in at least 40% of the slides to be included. these additionally filtered data sets are referred to as the "40% present" set while the rest are referred to as the standard set. all were imported to r to calculate correlation and euclidean distance matrices. paup neighbor-joining trees were constructed from these matrices.

distance and binary matrix calculation
using the functions cor() and dist() from the r stats package  <cit> , the pearson correlation or euclidean distance was calculated from mean or median ratio values to make a distance matrix. note that this step does not require discretizing the ratio values prior to the distance calculation. euclidean and correlation-based distance matrices  were used for neighbor-joining tree construction. distance matrices were calculated for normalized filtered ratio values and for bagel  estimates of hybridization level.

to convert continuous distances to binary characters , we used the program gack, genome composition analysis by charles kim, to implement a "genomotyping" method. this program employs a dynamic cutoff based on the signal ratio distribution to classify genes as present or absent  <cit> . the exact value of the cutoff could be modified by changing the value of the expected probability of being present  within the range of  <dig> to 100%  <cit> . for example, a 50% epp value, calculated from the distribution of the ratio data, categorizes all genes with a 50% or greater chance of being present as conserved , and those with a less than 50% chance as diverged . these binary matrices were used for parsimony tree construction.

phylogenetic analysis
phylogenies were created from distance data by the neighbor-joining  algorithm from paup version  <dig> b <dig>  <cit> . phylogenies were created from discrete data with the parsimony analysis using a heuristic search with  <dig> replicates, followed by construction of a 50% majority rule consensus tree  also in paup  <cit> .

bagel
we used bayesian analysis of gene expression levels  because it estimates hybridization levels for the reference species differently than all of the other methods that we employed, except mpp. typically, hybridization values for the reference species are taken from hybridizations between the reference species and itself. however, with bagel, for each gene, the ratio data from all the hybridizations involving the reference and test species are used to estimate a relative hybridization level for each species, including an extrapolated value for the reference species  <cit> . for distance phylogenetic analyses, the bagel output was converted to euclidean and correlation-based distance matrices as before. for parsimony phylogenetic analyses, the ratio data were converted to binary characters by binning the ratio values in the taxon-by-gene matrix in one of the four quartiles  and choosing to score presence  for genes with values in q <dig>  q4-q <dig>  or q4-q <dig> and absence  for genes with values in lower quartiles . this binary data set made from bagel-treated data could then be compared to the one made by applying gack to the filtered, normalized data.

mpp
in addition to genomotyping with gack, we utilized a second genomotyping program -the microarray to phylogeny pipeline   <cit> . mpp is an all-inclusive pipeline that uses cgh hybridization data, converts it to binary and uses those values to create a distance matrix for tree construction.

gpr files from the genepix program were input into mpp and replicate spots were averaged according to species. the ratio data were filtered and then log-transformed or transformed with the inverse hyperbolic sine  function  <cit> . following transformation, the data were binned with the epp method or the bayesian probability of presence , to determine thresholds for the presence or absence of a probe. a binwidth setting of . <dig> and the experimental binwidth option  were applied to the data during the binning process. binned matrices were exported from the program for parsimony phylogenetic analysis by paup  or were used to calculate a pairwise distance matrix using the cghdist method implemented in mpp. this method employs a death process to model loss of genes in a set of related taxa and is meant to compensate for the "unbalanced gene content" that results from having a single reference taxon for array cgh  <cit> . during this process mpp extrapolates a value for the reference from the comparisons. this pairwise distance matrix was then used for neighbor-joining tree construction.

tree to tree distance metric quantification
to quantitatively assess the differences between cgh-derived and mlsa trees, we compared the mlsa topology for the nine sordariomycete fungi  <cit>  to the cgh derived trees using two tree-to-tree distance metrics, symmetric distance  and agreement subtree , implemented in paup  <cit> . the symmetric distance, symd, determines the number of branches that must be rearranged or collapsed to make two topologies identical. if the topologies are identical the step size is  <dig>  one step indicates a single collapsed branch and a rearrangement between two taxa is scored as two steps  <cit> . the agreement subtree metric, d <dig>  counts the number of taxa that must be pruned to make two topologies identical  <cit> . the symmetric distance is reported by default while values for d <dig> are available in the additional files  <dig>   <dig>  and 4: table s <dig>  s <dig>  and s <dig> 

RESULTS
almost all of the steps needed to process array cgh ratio data for phylogenetic analysis can influence the result. these include the filtering, normalization and tree-building procedures applied to the data. using empirical data, we tested the effect of different analytical approaches on distance and parsimony analysis. different methods of normalization combined with mean or median hybridization values for each species were used. for neighbor-joining analysis, different metrics for converting normalized intensity ratios to genetic distances were used, as well as different thresholds for converting ratios to discrete character data for parsimony analysis. one such method was a probabilistic method for converting ratios to discrete character data  and the other was a self-contained work-flow , which converts raw cgh data to data suitable for phylogenetic analysis. an alternative to average or median cgh ratio values, bagel , was also tested.

to consider the effect of evolutionary distance among taxa on the analyses, we grouped taxa into three datasets that varied in combined genetic distance. the con set consisted of the six most closely related outbreeding individuals of neurospora . the neu set is the con set plus n. terricola, an obligately self-fertilizing relative. the all taxa set is the neu set plus two more distant relatives, sordaria macrospora and podospora anserina. phylogenetic trees for these taxon sets, based on multilocus sequence analyses  are shown in figure  <dig>  with and without the reference taxon as indicated. as detailed in the methods, in all analyses, we present results with and without the reference taxon because some analyses are confounded by the zero distance between the reference taxon and itself.

summaries of our analyses given below are supported by analyses in the additional material as follows: analysis of filtered normalized data for nj  and parsimony after gack processing . analysis of bayesian-based  treatments for nj  and parsimony . parsimony analyses using mpp . mpp was also used to implement a likelihood approach with neighbor-joining to compensate for the single reference design .

neighbor-joining analysis normalized data, 
in no case did analysis of the all taxa set by neighbor-joining of cgh data that had been simply normalized produce the same tree as mlsa tree . the most successful analyses produced trees at least two steps longer than the mlsa tree as judged by the symd  metric. these most successful analyses used nj with either pearson's correlation coefficient or euclidean distance and with or without the reference taxon, and with loess , robust spline or linear normalization, but never with lowess  normalization. taking the mean or median of normalization values had no effect on the outcome and neither did employing the additional 40% filter.

with the neu taxa set, the mlsa tree was recovered perfectly by nj using euclidean distance, but only with linear normalization based on the ratio of means. there was no effect of including or excluding the reference taxon, using the mean or median value for each gene, or adding the additional 40% filter. clearly, exclusion of the distant taxa, sordaria and podospora, had a positive effect on the analyses, but only with this combination of methods.

with the con taxa set, the mlsa tree was recovered less frequently. here, again, the most robust result  was by nj analysis using euclidean distance of data linearly normalized by the linear ratio of means. however, results were better when the reference taxon was included and the additional 40% filter was omitted on mean values for each gene. again, inclusion or exclusion of the more divergent taxa had the largest effect on recovery of the mlsa tree and trees with topologies close to the mlsa tree were found only with a narrow combination of methods.

parsimony analysis normalized data, 
for the all dataset, with or without the reference, no trees with topologies identical to the mlsa tree were produced for any normalization. with the reference taxon included, the averaged loess and median of the spline normalization give trees two to four steps distant for most values of the %epp cutoff. the lowess trees were  <dig> to  <dig> steps longer than the mlsa tree, depending on the values of the %epp. trees that included the reference taxon were substantially worse .

with the neu taxon set, several of the thresholds based on %epp resulted in trees with topologies identical to the mlsa tree when the reference taxon was excluded. these trees identical to mlsa trees included those made using the averaged values of the loess and the median values of the spline normalizations, and many of the percent eep values using averaged linear normalization. adding the additional 40% filter had a negative effect such that only the 50% epp threshold gave the mlsa tree topology. with the reference taxon included in the analysis, the mlsa tree topology was not recovered as judged by the symd metric  or the d <dig> metric .

for the con dataset, excluding the reference, the averaged values of the linear and loess normalizations recovered the mlsa tree topology in four and five of the eleven percent epp thresholds respectively. the median and average values of the robust spline normalization were also successful in capturing the mlsa tree. again, the additional 40% filter resulted in poorer trees overall. the remaining iterations of the data were two to four steps away. including the reference species gave trees that were no closer to the mlsa tree than four steps and then only for the spline and loess normalizations.

nj after bayesian estimation of a relative hybridization level 
for the all taxa set, with and without the reference species, the mlsa tree topology was not recovered with either the euclidean or correlation-based metric. the closest approximation of the mlsa tree was achieved by the robust spline and loess normalizations . for the correlation metric, including the reference species had no effect on results. however, for the euclidean metric, including the reference species in some cases increased the length as compared to the mlsa tree by from two to six steps.

for the neu dataset, the euclidean distance metric captured the mlsa tree for both the spline and loess normalizations while the correlation metric did so solely with the robust spline normalization. this result was found regardless of whether or not the reference taxon was included. for the con dataset, the correlation metric outperformed the euclidean metric by capturing the mlsa tree with almost all approaches  regardless of whether the reference taxon was included or excluded. the euclidean metric recovered the msla tree topology with fewer combinations of approaches, and performed worse when the reference taxon was included .

one noteworthy result with bagel nj trees is that, unlike the other methods tested, the results are far less sensitive to inclusion or exclusion of the reference taxon. this insensitivity is presumably due to bagel's extrapolation of the reference value, which appears to be a more robust way of including the reference taxon than including self-self controls for tree construction.

bagel parsimony 
for parsimony analysis, the bagel estimates of hybridization levels described above were binned at the first, second, and the third quartile. for the all dataset, no method of analysis recovered the mlsa tree topology. the loess, spline, and lowess normalizations were four steps distant irrespective of inclusion of the reference taxon. the linear normalization was worse  and the worst result was obtained when the reference taxon was included .

for the neu set, no method of analysis recovered the mlsa tree topology, although the loess, spline, and loess normalizations again performed best . the cgh trees constructed from the linear normalization were at best four steps longer than the mlsa tree when the reference taxon was excluded, and six steps longer when it was included. binning at the second or third quartile resulted in trees that were typically four steps longer.

for the con taxon set the mlsa tree topology was recovered only when the reference taxon included, and then only when binning at the first quartile for the spline, loess or lowess normalizations, or at the third quartile for spline and loess normalizations. other approaches gave trees two to four steps longer than the mlsa tree.

unlike the bagel nj analyses, which were insensitive to inclusion or exclusion of the reference taxon, the bagel parsimony analysis improved when the reference taxon was included in the cgh phylogeny. however, in the bagel parsimony analyses, the mlsa tree was recovered only for the con taxa dataset, any only for a narrow set of approaches, as noted above.

treebuilding with mpp, the microarray to phylogeny pipeline 
as described in the methods, we used the mpp pipeline to construct both neighbor-joining and parsimony trees for the three groups of taxa. the mpp method begins by using cgh data to score hybridization probes as present or absent. these data can be exported for parsimony analysis or they can be used to make pairwise distance matrices by a likelihood approach that is designed to compensate for the single reference design. these distance data are then used for phylogenetic analysis by neighbor-joining analysis. mpp allows the user to control various options: the cgh data can be transformed using either a log or an inverse hyperbolic sine function , the presence or absence of a probe can be estimated by epp or by bpp, and the binwidth for assigning probe presence or absence can be set at either  <dig>   or determined experimentally . applying these options in all combinations gave us eight basic combinations of options for both parsimony and nj phylogenetic analyses.

for the all dataset, mpp using nj did not recover the mlsa tree for any of the eight options. a tree two steps longer than the mlsa tree was recovered using arsinh, bpp, with a binwidth set at norm and excluding the reference taxon. use of epp or inclusion of the reference taxon gave trees at least twice as distant.

for the neu taxon set using mpp and nj, with the reference taxon excluded, trees concordant with the mlsa tree were recovered for five of the eight options. these five included all of the log-transformed data and the arsinh-transformed data option with bpp and norm binwidth. when the reference was included, the same iterations gave cgh trees four to six steps longer than the mlsa tree.

for the con dataset using mpp with nj, the results were similar to the neu set in that all log-transformed data options recovered the mlsa tree topology when the reference taxon was excluded and no options recovered the mlsa tree topology when the reference taxon was included.

parsimony mpp tree construction 
for parsimony analysis, the same eight combinations were used to convert gch data to presence/absence data sets and trees were made using 50% majority-rule consensus.

for mpp with parsimony analysis of the all dataset with the reference taxon excluded, the best trees using any option were one step longer than the mlsa tree . when the reference taxon was included, trees from the four bpp and epp arsinh-transformed sets were eight steps longer and those from the log-transformed data were even more distant.

for mpp with parsimony analysis of the neu dataset with the reference taxon excluded, the five iterations that recovered the mlsa tree topology for the nj analysis did the same for parsimony analysis, i.e., all of the log-transformed data and the arsinh-transformed data option with bpp and norm binwidth. when the reference taxon was included in the cgh phylogeny, no option returned the mlsa topology.

for mpp with parsimony analysis of the con dataset, when the reference was excluded from the cgh phylogeny, the results were identical to those the results of the neu taxon set. when the reference was included, the results were nearly identical to those for the neu data set, i.e., no option returned the mlsa tree topology.

discussion
in order to assess if cgh data can be used to infer phylogeny, we applied a variety of approaches to cgh data from nine species of filamentous fungi in the sordariales derived from a microarray constructed for one of the species, the reference taxon n. crassa a. we chose to focus on these taxa because their relationships had been carefully characterized by multi-locus sequence analysis   <cit> . the nine species were analyzed in three sets, all, neu and con, which represent a decreasing range of evolutionary distances. the all taxon set has a maximum of  <dig> % sequence variation in coding regions  <cit>  and protein amino acid sequence similarity of 60% - 70%  <cit> . at the other end of the spectrum, the con taxon set has 2% to 7% sequence difference in coding regions . we should note that our analysis assumes that hybridization data accurately reflects evolutionary distance. though the mismatch kinetics of dna polymorphisms are not always perfectly correlated to hybridization level, the relationship between the two is roughly linear  <cit> . consequently hybridization level should provide an adequate proxy for evolutionary distance though it is subject to some experimental noise.

the diversity of approaches that we used to apply cgh data to phylogenetics included the following. to filter the data and normalize them to estimate hybridization levels we used four methods, two from the acuity package  and two from the limma package in r . we filtered for pixel saturation and for consistency among replicates. to complement these four approaches, we also used a bayesian approach  to estimate hybridization levels. euclidean and correlation methods were used to determine genetic distances from the hybridization levels. the distance method, neighbor-joining, was used for phylogenetic analyses of the genetic distances. to allow the use of parsimony phylogenetic methods, genetic distances were converted to binary data using gack. we also investigated the microarray-to-phylogenetics pipeline , which transforms the data with either of two methods  and converts the hybridization levels to binary data by either of two methods  for use in parsimony analysis. the binary data are then converted to genetic distances using a likelihood method intended to compensate for the shortcomings of using a single reference taxon for cgh. to assess the utility of the many permutations of these methods, we compared phylogenetic trees made from cgh data to the mlsa tree for the sordariaceous fungi using both symmetric distance  and taxon pruning .

we found no single method that consistently produced a cgh phylogeny equivalent to an mlsa phylogeny. instead, all the methods had different degrees of success depending on the combination of treatments applied to the data. two trends stood out: that the greater the genetic distance among taxa the lower success, and that distance phylogenetic analysis, neighbor-joining, performed better than parsimony analysis. however, even with distance methods and data sets with restricted genetic distance, success was low; the nj trees the neu and con topologies were recovered  <dig> % and 25% of the time, respectively. it should be noted that the greatest distance among taxa was only  <dig> %, roughly at the acknowledged limit of utility for long oligomer arrays  <cit> .

there was considerable variation between the normalization methods. for the distance-based trees, the most successful recovery was with a basic linear normalization  and the worst was lowess normalization . for the parsimony trees, the linear normalization was the worst, with a  <dig> % recovery rate and the best was the robust spline, with a recovery rate of 12%.

the neighbor-joining method was better than the parsimony method . of the two distance metrics used to construct distance trees, the euclidean method performed better than the correlation-based metric . this result was in contrast to our in silico investigations, detailed in the accompanying work, where the correlation-based metric was superior in capturing topologies. the euclidean metric, however, was better able to estimate the branch-lengths. typically, correlation measures are more reliable as they smooth rough data. however, in this case correlation measures may not be sensitive enough to distinguish very small differences in relationships based on microarray data, particularly with taxa close to the reference taxon.

when hybridization levels for the con and neu datasets were estimated using bagel, distance phylogenetic analysis recovered the mlsa tree more often, but this advantage was not seen with parsimony analysis.

tree construction with bayesian estimates of relative hybridization levels for each species was slightly more robust than a simple average or median of ratio values. for the distance trees of the con and neu datasets, more bagel-treated normalizations recovered the mlsa tree than normalization alone. the advantage of bagel-treated datasets was not seen with parsimony analysis.

mpp nj and parsimony
the mpp platform, an all-inclusive pipeline designed specifically for cgh phylogeny construction, performed similarly to the traditional filtering and normalization methods. mpp was sensitive to inclusion of the reference taxon, that is, no nj tree equalled the mlsa tree when the reference taxon was included, but  <dig> % of nj trees and  <dig> % of parsimony trees did equal the mlsa tree with the reference taxon was excluded. mpp was also sensitive to the genetic distance among taxa, no analysis of the all data set found the mlsa tree, while the mlsa tree was recovered from the con and neu datasets in between 25% and 32% of nj or parsimony analyses. in mpp, the log transformation, with a fixed binwidth, performed better than the arsinh transformation, indicating that the former is better suited to our empirical cgh data.

our analysis of cgh for eukaryotic microbes may be compared to a similar study of yeast species  <cit> . we took the opportunity to reanalyze the yeast cgh data with the newly developed mpp workflow  <cit>  to see if our neurospora results were of general significance. the yeast dataset contains more genetic distance than the neurospora dataset , so the analysis of yeast data would be expected to be more challenging. cgh phylogenies were compared to a mlsa phylogeny for the yeast taxa based on  <dig> orthologous genes  <cit> . when all eight taxa  from the cgh study of edwards-inghram et al.  <cit>  were used for tree construction, all cgh trees were at least ten steps longer than the mlsa tree. the gap dropped to  <dig> steps when s. cerevisiae was excluded . when the taxon set was restricted to just the six species studied by both edwards-inghram and rokas et al. , some cgh trees equalled the mlsa tree. here, bpp outperformed epp in converting cgh data to discrete data, although both methods did equally well when the reference species was excluded. it seems that mpp analysis of yeast is confounded by taxa that are too closely related, whereas mpp analysis of neurospora was confounded by taxa that were too distantly related. in the end, however, with neither yeast nor neurospora could cgh data be counted on to recover the sequence-based mlsa phylogeny reliably or consistently.

as a final point of discussion, our results with empirical cgh data can be compared to our previous analyses of simulated cgh data, which allowed for comparison of three different topologies. in both cases, distance analysis was superior to parsimony analysis, probably due to the loss of information when genetic distances are converted to discrete data. similarly, using distance analysis, highly filtered data sets produced less well-resolved phylogenies than data sets that included more ratio data. finally, it was more difficult to recover mlsa phylogenies using empirical cgh data than using simulated cgh data, likely due to the additional noise in empirical data.

CONCLUSIONS
our results with empirical cgh data and those of the accompanying in silico analysis demonstrate that acgh-based phylogenetics cannot be counted on to produce a phylogeny equivalent to those derived by mlsa. even with methods specifically designed to compensate for the single reference cgh design, there is inconsistent recovery of the mlsa phylogeny. therefore, in experimental contexts without prior knowledge of the relationships, it would be impossible to be certain that the true tree was recovered by cgh phylogeny. these findings are in contrast to several published works in bacterial species, which have found concordance between their acgh tree and those based on one or a few loci. while our results confirm that acgh is partially successful in some cases, inconsistent recovery in our datasets precludes our endorsement of the technique for widespread use. this does not forestall the usefulness of cgh data for various other analyses.

our analysis does suggest that some normalization and post-processing methods may best reflect the underlying genetic distance between taxa and these methods might be best for other analyses of cgh data. of the normalization methods implemented, the linear and robust spline methods worked better than the lowess/loess methods. the bagel estimation of hybridization levels also performed well. unlike most other methods, it allowed for inclusion of the reference without a penalty. if a quick approximation of a topology is sufficient for the user's needs, the mpp pipeline offers a simple and easy way to construct a tree from cgh data. however, even the mpp approach recovered the mlsa topology less than half the time. if phylogeny is the aim, it would be better to invest in a modest mlsa approach.

authors' contributions
lbg participated in its design and coordination and drafted the manuscript. lg, tk, and jwt also participated in the design of the study. lbg modified existing code to automate programs used in this work. lbg completed the statistical analysis. lbg and jwt wrote the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
additional table s <dig> - method matrix listing data treatments that are represented in each figure.

click here for file

 additional file 2
additional table s <dig> - figure 2: neighbor-joining and gack parsimony analysis when the dataset is only normalized. figure  <dig> in table form, with actual tree scores. zeros are bolded. in excel format.

click here for file

 additional file 3
additional table s <dig> - figure 3: nj and parsimony analysis after bayesian estimation of a relative hybridization level. figure  <dig> in table form, with actual tree scores. zeros are bolded. in excel format.

click here for file

 additional file 4
additional table s <dig> - figure 4: mpp-based tree construction. figure  <dig> in table form, with actual tree scores. zeros are bolded. in excel format.

click here for file

 acknowledgements
thanks to michael b. eisen and sandrine dudoit for statistical advice. thanks to tom sharpton and jason staich for scripting advice. thanks to h. matthew fourcade for technical assistance. special thanks to tracy k. powell for editorial assistance. funding for lbg provided by the ford pre-doctoral and dissertation year fellowships. funding for tk was provided by nih program project grant gm <dig> to n. louise glass, pmb, uc berkeley. the research was supported by nsf deb - <dig> and nih ro <dig> ai <dig> to jwt.
