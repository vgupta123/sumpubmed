BACKGROUND
sociality in spiders involves the formation of permanent family groups and extensive cooperation in prey capture and brood care. while sociality is relatively rare in spiders with less than  <dig> known social species, it is intriguing because it has evolved independently at least  <dig> times in six families across the spider phylogeny  <cit> . the evolution of sociality involves convergent life history traits that include female-biased sex ratios, an inbreeding mating system, and cooperative breeding with allomaternal care  <cit> . the genus stegodyphus contains three social species  <cit> , and although the phylogenetic relationship of stegodyphus is poorly resolved, a partial molecular phylogeny suggests three independent origins of sociality, and that sociality is a derived state  <cit> . sociality is hypothesized to evolve via the subsocial route through the elimination of pre-mating dispersal, the transition to intra-colony mating, and the evolution of cooperation among individuals. the presence of independent social lineages and periodic-social  congeners makes stegodyphus a suitable system for comparative studies of the evolution of regular inbreeding and sociality, and for examining its consequences for evolutionary processes and genomic architecture.

the combination of strong inbreeding, female-biased sex ratios, and dynamic meta-population structure in the social spiders is expected to have pronounced effects on genetic processes  <cit> . comparative data from studies on selfing and outcrossing plants are consistent with theoretical predictions that inbreeding populations are expected to experience reduced genetic diversity. this prediction is founded on three factors: firstly, that inbreeding reduces effective population size relative to outbreeding populations; secondly, high homozygosity reduces the effective frequency of recombination throughout the genome; and thirdly, isolation between populations is increased with inbreeding  <cit> . as a consequence, the efficacy of natural selection should be reduced. examining these expectations and additional genomic consequences of the transition to sociality and regular inbreeding has so far not been possible due to a lack of genetic resources. next generation sequencing technologies have made it possible to survey genomes of non-model organisms , and to identify suitable parts of the genome for phylogenetic, molecular evolutionary and population genetic studies. using  <dig> pyrosequencing , we sequenced the transcriptomes of three stegodyphus species to identify ortholog gene sequences across species to use in phylogenetic and population genetic studies.

the three stegodyphus species sequenced here  were specifically selected to be as distantly related as possible, based on the most recent molecular phylogeny of the genus  <cit> , to maximize the chance of finding regions conserved across the entire genus for the design of primers that will amplify in all or most stegodyphus species. one social species and two periodic-social species  <cit>  were included to perform preliminary contrasts of evolutionary patterns of the transcriptomes for inbreeding and outcrossing mating systems to substantiate evolutionary hypotheses to test in future studies.

we obtained a library of  <dig>  ortholog loci and detected open reading frames   in  <dig>  loci. preliminary analysis on the transcriptome sequence data showed that heterozygosity was strongly depleted in the social individual compared with the two periodic-social individuals . estimates of dn/ds, cg-content and codon usage bias did not reveal differences in the strength of selection averaged over the phylogenetic branches. however, levels of non-synonymous and synonymous polymorphisms suggest that selection is relaxed in the social s. mimosarum compared to the periodic-social species. from these results we hypothesize that permanent sociality evolved recently in s. mimosarum.

RESULTS
assembly and characterization of transcriptomes
three transcriptomes were assembled from quality filtered sequences into  <dig> ,  <dig>  and  <dig>  transcripts, with a median length of approximately  <dig> bp and median coverage of  <dig> ,  <dig>  and  <dig>  for s. lineatus, s. mimosarum and s. tentoriicola respectively . based on transcript clustering,  <dig> ,  <dig>  and  <dig>  individual putative genes for each of the respective species were identified, of which approximately  <dig> % were found to have more than one splice variant. the statistics for the original and assembled data are summarised in table  <dig> 

approximately half of the putative genes in s. lineatus and 60% in s. mimosarum and s. tentoriicola were annotated by comparative analysis using blastx against the ncbi non-redundant protein database . functional annotation  was similar across all three species with the highest number of annotated transcripts related to metabolic processes  and cellular processes  . many of these genes are probably highly conserved genes, such as genes involved in dna repair, gene expression regulation and transfer of chemical substances. this category of genes contains the largest amount of products in the gene ontology  database, and the abundance of transcripts in different categories in the present data set is similar to the abundance of the number of products in the go database.

the study species were found to have highly similar patterns of coding gc content and codon usage. the overall gc content of the transcriptomes was  <dig> %,  <dig> % and  <dig> % in s. lineatus, s. mimosarum and s. tentoriicola, respectively, while in defined coding regions  the gc content was slightly higher  compared to the overall gc content. the patterns of codon usage in these genes, studied as the effective number of codons  and the gc content in synonymous sites , were highly similar in all study species. the effective numbers of codons was approximately  <dig>  and at-rich codons were preferred . the amount of codon usage bias was of the same order of magnitude as several diptera and hymenoptera species  <cit> . however, while in many diptera species the preferred codons are gc-rich, at-rich codons were more common in stegodyphus. thirty-seven nematode species have shown large variation in gc content of preferred codons, but, with a few exceptions, the gc content in third codon position is generally much higher in nematode genomes than found in the spider species here  <cit> .

orthology
 <dig>  transcripts were found to have reciprocal best hit in all three pair-wise comparisons, and were considered to be ortholog across all three study species. however,  <dig>   <dig>  and  <dig>  respective sequences were found to have best reciprocal hits between two species only . of these sequences,  <dig> s. lineatus,  <dig> s. mimosarum and  <dig> s. tentoriicola transcripts showed reciprocal best hits among two species pairs only, which might have been caused by technical issues or paralogy . to avoid paralog genes in the downstream analyses, these loci were excluded.

the alignments of  <dig>  ortholog sequences serve as a highly useful library for further genetic studies across the stegodyphus genus. since the three species sequenced here are phylogenetically distant within the genus, the likelihood that pcr primers designed from conserved regions in the alignments will amplify throughout the genus is maximized. indeed, the first ten pcr primer pairs designed from ortholog sequences amplified in  <dig> species tested across the genus. the sequences of these primer pairs can be found in additional file  <dig> 

molecular evolution
to study patterns of molecular evolution of protein coding genes we generated multiple alignments of the longest open reading frames detected from the three way ortholog sequences. this resulted in  <dig>  alignments with a median length of  <dig> codons ranging from  <dig> to  <dig> . these  <dig>  ortholog alignments can be found in additional file  <dig>  eighty-seven percent of the longest translated orfs had at least one significant blastp hit  in the ncbi non-redundant database, suggesting that in the majority of genes the correct reading frame was detected.

single genes were concatenated into  <dig> units with an average length of  <dig>  bp to estimate genome-wide substitution patterns, and the total length of the aligned region was  <dig>  bp, gaps included. alignments were concatenated to increase reliability of branch length estimation, and we generated  <dig> units  to be able to estimate confidence limits. the proportion of variable sites in pair-wise comparisons was  <dig> % both between s. lineatus and s. mimosarum and between s. lineatus and s. tentoriicola, and  <dig> %. between s. mimosarum and s. tentoriicola. the transcriptome-wide selection against amino acid changing mutations was found to be strong in all lineages, but in the s. lineatus lineage selection was significantly stronger than in the other two lineages. the estimates of the ratio of non-synonymous to synonymous divergence   were  <dig>  ,  <dig>   and  <dig>   in s. lineatus, s. tentoriicola, and s. mimosarum lineages respectively. this is comparable with genome-wide estimates of ω in drosphila  <cit> . we note that because we extracted rna from the entire body and used non-normalized cdna libraries, genes that are expressed in all tissues are overrepresented in the dataset. these genes are likely to be under strong purifying selection  <cit> .

genetic polymorphism in social and periodic-social spiders
we found strikingly fewer polymorphisms in the transcriptome from the social species compared to that of periodic-social species. from the assembled transcript in coverage range  <dig> to  <dig>  we detected  <dig>  and  <dig>  polymorphisms for s. lineatus and s. tentoriicola respectively, while only  <dig> polymorphisms were detected from s. mimosarum transcripts. if only one transcript per gene was taken into account the difference in detected polymorphisms was even higher, with  <dig>  polymorphism in s. lineatus and  <dig>  in s. tentoriicola respectively, while only  <dig> polymorphisms were detected in the s. mimosarum transcript. these data are in keeping with low population level genetic variation in mitochondrial loci that were previously demonstrated in two genera of social spiders  <cit> . our data for the social s. mimosarum transcriptome is consistent with the prediction of reduced population level polymorphism in social species as a consequence of inbreeding. this is the goal of future comparative studies of social and periodic-social stegodyphus species.

in addition, we found evidence for a higher ratio of non-synonymous polymorphisms to synonymous polymorphisms /π) in the social species compared with the outcrossing congeners. the number of polymorphisms that could be determined as synonymous and non-synonymous were  <dig> and  <dig> for s. lineatus,  <dig> and  <dig> for s. tentoriicola, and  <dig> and  <dig> for s. mimosarum respectively. the estimated π/π were  <dig>  for s. lineatus and  <dig>  for s. tentoriicola, and  <dig>  for the social species s. mimosarum, indicating a relaxation of purifying selection. lower polymorphism and higher π /π in the social species suggest lower effective population size and relaxed purifying selection, as expected for highly inbred species  <cit> . contrary to these findings, the ω estimates in different branches did not show consistent significant differences between social and periodic-social species. ω is expected to increase over evolutionary time in inbreeding social species with low effective population size and relaxed purifying selection because of increased accumulation of slightly deleterious mutation  <cit> . however, since we did not observe an increased ω relaxation of purifying selection in s. mimosarum probably only occurred relatively recently. assuming that relaxed purifying selection followed the transition to sociality, we tentatively hypothesize that sociality and regular inbreeding in s. mimosarum evolved relatively recently, and that the transition was not associated with speciation.

genetic relationships of stegodyphus
mean synonymous substitution rates  from concatenated genes with a free-ratio model were  <dig> ,  for both s. mimosarum and s. tentoriicola, and non-synonymous substitution rates  were  <dig>   and  <dig>   respectively. in the s. lineatus lineage, the rate estimates were  <dig>   for ds and  <dig>   for dn. these data suggest that s. mimosarum and s. tentoriicola are genetically the more closely related species . this is supported by cytogenetic studies of chromosome numbers  <cit>  and a recent phylogenetic study  <cit> , but is contrary to the phylogeny estimated by johannesen et al.  <cit> .

under the assumption of a molecular clock of synonymous substitutions, we estimated the time for speciation using two different types of calibration. first we estimated a 'spider mutation rate' from an estimated synonymous divergence of ds =  <dig>   between s. lineatus and acanthoscurria gomesiana  . the split time between these species has been estimated at ~ <dig> my  <cit> , yielding a mutation rate of approximately  <dig>  4e- <dig> per year. stegodyphus species are annual with one generation per year, therefore, based on this estimated mutation rate, we date the split between s. mimosarum and s. tentoriicola to ~ <dig> million years ago, and the split of s. mimosarum/s. tentoriicola and s. lineatus to ~ <dig> million years ago . we also used a direct mutation rate estimate from mutation accumulation lineages of drosophila melanogaster by haag-liautard et al.  <cit> . using this mutation rate estimate of  <dig> e- <dig>  we date the splits between s. mimosarum and s. tentoriicola at ~ <dig> million years ago and between s. lineatus and s. mimosarum/s. tentoriicola at ~ <dig> million years ago . we note that the mutation rates considered here may differ from the actual mutation rate in stegodyphus species and that these time estimates should be considered with caution.

CONCLUSIONS
we identified  <dig>  three-way ortholog genes that provide a unique resource for comparative studies in ecology, eco-genomics, population genetics and molecular evolution that relate to the evolution of sociality in the spider genus stegodyphus. preliminary analyses suggest depleted heterozygosity and relaxed selection in the inbreeding social species s. mimosarum relative to outcrossing congeners. however, relaxed selection could not be detected in the substitution pattern, suggesting a recent transition to sociality.

materials and methods
live specimens were collected from israel  and south africa  and brought to aarhus university, denmark. total rna was extracted from the entire body of one individual of each species and complementary dna  was synthesized using evrogen smart adapters  <cit>  . cdna libraries were sequenced using the genome sequencer flx instrument  at the gene pool facility at the university of edinburgh. the raw sequence reads and assembled contigs can be downloaded , jt <dig> - jt <dig> , jt <dig> - jt <dig> ).

for the assembly of the sequence reads we applied gs de novo assembler software  using transcriptome assembly default settings. for the s. mimosarum assembly an additional -large option for large genomes was used, since the assembly could otherwise not be completed. the assembled contigs  represent transcripts. alternative splicing was quantified based on isotig clustering by gs de novo assembler software. the isotig clusters  are referred to as putative genes in the results.

assembled transcripts were annotated using blastx search against the ncbi non-redundant protein database  with 10- <dig> e-value cut-off. sequences were functionally annotated using the program blast2go  <cit>  with default settings. annotation against drosophila uniprotkb  was performed in bioedit  <dig> . <dig>   <cit> . local blastx with 10- <dig> e-value cut-off and default settings.

a reciprocal best similarity hit method was used for the ortholog sequence identification, where triplets of reciprocal best hits were selected to represent a putative ortholog set of transcripts. for simplicity they are referred to as ortholog sequences in the results. nucleotide blast was used for the similarity search with default parameters and an e-value cut-off of 10- <dig> using bioedit  <dig> . <dig>   <cit> . first, a pair-wise reciprocal blast was performed of which the best hits based on bit scores were selected. if the best hits were similar in both directions, the sequences were scored as putative ortholog between the two species. the putative three-way ortholog sequences were selected from these loci if they were putative orthologs in all three way comparisons. the reciprocal best hit selection was performed using a set of java scripts implemented in a locally developed sequence manipulation tool . putative ortholog sequences between s. lineatus and acanthoscurria gomesiana were detected based on the same principle using identified orthologs to query in s. lineatus.

for identifying polymorphisms we developed a custom python script snp_finder.py  to mine polymorphic sites from gs de novo assembler output files. the polymorphisms were called from sites with a coverage range of 10- <dig>  minor allele frequency was required to be >  <dig>  and only contigs longer than  <dig> were used, excluding  <dig> nucleotides from each edge of an assembly. detected snps were assigned ancestral or derived by assuming that the nucleotide found in the same position in the two other species was the ancestral nucleotide. the snp was assigned non-synonymous if the derived nucleotide changed the amino acid, and synonymous if not.

from the detected ortholog sequences we generated alignments of protein coding regions. the longest open reading frames of detected ortholog sequences, obtained with the online version of virtual ribosome  <cit> , were aligned using the alignment program prank  <cit> . the alignments were manually edited assuming that most frame shift errors are caused by sequencing or assembly errors. all sequences were cut after a frame shift gap due to uncertainties of the correct reading frame. all gaps divisible by three were moved to the closest inframe position. to reduce the risk of false positive open reading frames, alignments shorter than  <dig> bp were discarded. this threshold was set assuming that the number of stop codons in a random sequence with length n follows a binomial distribution

 !)*p∧k*∧ 

where k is the number of stop codons, and p is the probability of the random occurrence of a stop codon, i.e. 3/ <dig>  we set the probability to achieve an orf  with a length n to  <dig> . from this equation the minimum length of orfs was solved.

 !)*3/64∧0*∧> <dig> ∣!)= <dig> /64∧0= <dig> 

 1*1*∧n> <dig> ∣logn*log61/64 > log <dig>  ∣:log61/64n > log <dig> /log61/64n >  <dig> n = >  <dig> 

thus, to set the probability of a random orf occurring at below 5%,  <dig> was selected as orf length threshold.

the alignments with orfs  were assigned a random number, and sequences were concatenated in ascending order to form  <dig> sets of alignments with an equal number of genes. the concatenated genes were used to estimate the transcriptome-wide substitution rates in protein coding genes. the pair-wise proportion of sequence diversity was calculated as the proportion of variable sites from the total. to estimate the rate of synonymous , non-synonymous  and the dn/ds ratio  for each branch of the phylogeny, we used maximum likelihood estimations implemented in the program codeml in the paml  <dig>  package  <cit> . codon usage bias of the aligned transcripts was measured as the gc content in silent sites and the effective number of codons was computed using the formula by novembre  <cit>  calculated with the software inca  <dig>   <cit> .

authors' contributions
jsb, mhs and tb designed the study. tmm and tth carried out bioinformatics analyses. tmm and jsb carried out the data analyses. tmm, jsb, mhs and tb wrote the paper. all authors read and approved the final manuscript.

supplementary material
additional file 1
procedure for three way orthology identification. a) three-way ortholog sequences were selected if they were detected as reciprocal best hits  in all three two-way comparisons. b) only one comparison had reciprocal best hits. c) in some cases the reciprocal best hit was detected in two comparisons but not in the third. these were not accepted as three way ortholog sequences.

click here for file

 additional file 2
pcr primer sequences. a set of  <dig> pcr primer sets that amplify in all tested stegodyphus species . the loci amplified are named after the s. lineatus transcript name.

click here for file

 additional file 3
nucleotide alignments of three way ortholog sequences. this file contains  <dig> alignments of nucleotide sequences found to be ortholog in s. mimosarum, s. lineatus, and s. tentoriicola with open reading frames.

click here for file
