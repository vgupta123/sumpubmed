BACKGROUND
the majority of protein folds descend from a relatively small set of ancestral domains through divergent evolution  <cit> . the mechanism by which new structures emerge or evolve from existing proteins is still an open question. unlike sequence evolution, the drift of the core of a domain structure is unlikely be stable and functional. therefore, it is reasonable to postulate that structural innovation is more likely to be the result of evolution at the periphery of the conserved core of domains. a recent study about the indels in protein sequences found that the fraction of domains and individual unaligned regions increasing in size is almost twofold larger than the fraction decreasing in size  <cit> . ancient domain families show bias towards insertions in the variable region which grow in size  <cit> . in comparison with deletions, a succession of insertions and rapid evolution appears to be a reasonable process that could lead to the emergence of novel protein architectures  <cit> . determining the extent and the mechanism of emergence of protein structure is difficult because observations are limited to extant protein folds. the evolution of sub-structures over time must then be inferred from this limited information.

because of a high degree of inter-residue dependence, protein structures evolve much more slowly than their sequences  <cit> . these structural constraints are relaxed in some parts of protein structures; these are typically surface loops where mutations, insertions, and deletions can occur with lesser consequences to the biological function for which a gene is selected. it was observed that the probability of observing insertions and deletions in a pairwise alignment of protein sequences correlates with their evolutionary distance  <cit> . the study of structural similarity of loop regions in homologous proteins also observed a linear correlation between sequence and structural similarities  <cit> . these observations are consistent with the assumption that insertion and deletion events are continuous processes that parallel the better characterized process of substitution.

incremental change in loops through insertion or deletion is a possible mechanism that can generate new polypeptidic folds  <cit> . the proposed model of emergence assumes that regions with faster evolutionary rates, such as surface loops, are the most probable locations for the occurrence of rare events. as proteins evolve, insertions can accumulate in these loop regions without affecting the folding of the core structure. unless an insert is eliminated by purifying selection, multiple and nested insertions will make surface loops appear to grow over time. these variable regions have the ability to explore the conformational space and thus acquire novel sub-structures. subsequently, a fraction of novel structural features generated via this process can be positively selected, and eventually become independently folding units .

the key element leading to structural emergence under the proposed model is thus the extension of surface loops into nascent substructures. testing this model requires to infer the sequence of events  leading to structural variability in protein structures. a series of efficient and robust tools were developed to produce structure-based phylogenies of protein domains and high quality structure-based multiple sequence alignments. phylogenetics usually relies on the signal in biological sequences to infer the evolution of a gene. the tertiary structure of a protein evolves much slower than its sequence, and potentially contains a phylogenetic signal which is likely to persist beyond the timeframe where sequence signal becomes saturated.

the structure-based phylogenetic method utilizes a distance measure qh  <cit>  to compute trees using the neighbor-joining algorithm  <cit> . we also developed a method to build the structure-based multiple sequence alignments. this tool is derived from a multiple sequence alignment method proposed by casbon and saqi  <cit> , which generates multiple structure-based alignment by running t-coffee  <cit>  to perform hierarchical alignment using information from the pairwise structural alignments. in this work, we used the application flexible structure alignmentt by chaining aligned fragment pairs with twists   <cit>  to produce the pairwise alignments. according to the results presented in this work, the trees inferred with qh distances are consistent with results of sequence-based methods. the structure-based phylogenetic method is efficient and robust. because the sequence identity amongst domain families is often low, the structure-based phylogenies are also more suitable for this study than sequence-based phylogenetic methods.

this work used the structure-based phylogenies to infer a possible sequence of insertion events leading to the extant domain structures. the objective was to assess whether complex and novel protein structures can arise through the incremental growth of variable regions in protein domains. the analyses were performed on a large test set of homologous proteins built from structural classification of proteins  database  <cit> . the study revealed a large portion of insertions are bounded by earlier insertions in the variable regions of protein domains. we demonstrate that the average size of inserts created by nested insertions is substantially larger than block inserts. we analyzed the conformations of inserts, and found some structures of nested inserts show complex or even domain-like fold patterns including helices, strands and loops. the β-lactamase/d-ala carboxypeptidase domain family was used as an example to illustrate the inference of insertion events, and how the incremental growth of a variable region is capable to generate novel structures.

RESULTS
statistics of insertions
the results of the quantitative study of insertions are listed in table  <dig>  in the test set, 98% of domain families belong to the four scop classes all α, all β, α/β, and α+β. the detected insertions are not evenly distributed in the four classes. the amount of insertions in all β class is significantly larger than all α class. all α class has  <dig> families,  <dig> domains, and  <dig> inserts. for all β class, there are  <dig> families,  <dig> domains, and  <dig> inserts. the size of all β class is slightly bigger than all α class. whereas the inserts detected in all β class are almost twice as many as the inserts of all α class. the numbers of insert-containing regions per domain for all α, all β, α/β, and α+β classes are  <dig> ,  <dig> ,  <dig> , and  <dig> , respectively. the results indicate that domains from scop class α/β have more variable regions on average than those from other three classes.

a number of superfamilies; b number of families with at least  <dig> domains; c number of domains in the families with size ≥3; d number of families with nested inserts; e number of insert-containing regions; f number of nested inserts; g membrane and cell surface proteins.

our method detected  <dig> insert-containing regions, including  <dig> block insertions and  <dig> nested insertions. there are a total of  <dig> insertions with size > <dig> observed in the  <dig> inserts, in which  <dig> are block insertions and  <dig> insertions are nested. a total of  <dig> out of  <dig> families contained lineages with nested insertions. consequently, our analysis of scop family test sets found that  <dig> % of all insert-containing regions have at least one nested insertion while the remaining proportion are inserts that appear to have been inserted in a single step . overall,  <dig> % of the inferred insertion events are those nested into an insert region. the addition of more homologous domains in a given family is likely to divide some of the block insertions into nested insertions. this, in turn, will increase the number of observations of nested insertions, although it is impossible to determine how much this would affect the net proportion of these two types of inserts.

the distributions of insert rank and size were analyzed. the distribution of insert rank of the insert-containing regions fits an exponential decay . the total numbers of inserts with rank from  <dig> to  <dig> are  <dig>   <dig>   <dig>   <dig>   <dig>  and  <dig>  respectively. four domains have maximal insert rank  <dig>  they are domains d1gw0a <dig>  d1aoza <dig>  and d1gska <dig> from the multidomain cupredoxins family, and d1qhoa <dig> from the amylase family. figure  <dig> shows the distributions of insert size with insert rank. the average sizes of inserts with rank ranging from  <dig> to  <dig> are  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig>  and  <dig>  respectively. despite the average size for inserts with rank  <dig>  which were calculated from a small portion of samples, the insert size tends to increase with the insert rank. the observations are consistent with the model that variable regions of a protein appear to "grow" because of the accumulation of nested insertions. the inserted protein segments generated by the nested insertions are much longer than the block inserts. the average size of nested inserts with rank > <dig> is  <dig>  residues long, whereas the average size of block inserts is  <dig> . it indicates that block insertions, by virtue of their length, are less likely to be the site of structural innovation.

insertions produce complex sub-structure
to investigate whether insertions can create novel protein structure, structural complexity and novelty analyses were performed on a large dataset of protein domains. our functional definition of complexity is when the p-value of the alignment of a segment to itself is below a significance threshold. our functional definition of novelty is when a segment is complex and does not align with any other polypeptide segments other than itself. the screening of all identified inserts identified  <dig> complex block inserts and  <dig> complex nested inserts. the properties of the complex inserts are given in table  <dig>  the complex inserts were classified by their secondary structural content as helices, helices+strands, strands, and loops. in comparison to the nested inserts, the secondary structures of the complex block inserts have more loops and less helices+strands local conformations. the average size of the complex block inserts is  <dig> residues, which is smaller than the average  <dig> residues of the complex nested inserts. by comparing the complex inserts with domains from other superfamilies in the astral scop  <dig>  subset,  <dig> out of  <dig> complex block inserts were identified as novel structures, and  <dig> nested inserts were identified as novel out of a set of  <dig> complex nested inserts. the nested insertions produced about twice as many novel structures as the block insertions. this is in part because nested inserts are averagely longer, and because stabilizing substitutions can accumulate between insertion events to stabilize the intermediate structures. it should be noted that some observed large complex 'block' inserts could be the product of nested insertions but there were not enough structures in the analysis to permit their identification.

a h: helices; b s: strands; c hs: helices and strands; d l: loops.

several representative inserts  are shown in figure  <dig> as examples of the structures produced by incremental growth through nested insertion events. the insert structures were colored with the mapping method described in the methodology section. the color, scaled from blue to red, indicates the insert rank to which each site is classified. for the colored inserts, the more blue intensive color implies the earlier the ancestral insertion event. this illustrates how incremental growth within variable region is capable to generate complex structural patterns.

it is much more difficult to demonstrate that existing domains have emerged via this mechanism. evidence that a given domain in a gene is significantly similar to an insert-nesting variable region in an unrelated gene would constitute a demonstration that these novel folds can be propagated through the proteome. however, it is fair to assume that most common domains are relatively ancient and that structural intermediates are thus unlikely to exist to this day. the analysis of distant but evolutionarily related protein folds may provide further insight into this possibility.

an example of the growth of variable region via stepwise nested insertions
a novel nested insert was discovered on the estb domain with insert rank of  <dig>  the multiple sequence alignment of the variable region of all domains is given in figure  <dig>  the multiple structural alignment in figure  <dig> shows the structural variation of different domains in the region. the structure-based phylogenetic tree of the family was built, and the insertions of d1ci9a_ were detected by comparing the structural consensus. the nested insertions of d1ci9a_ are color mapped according to the insert rank as shown in figure  <dig>  in figure  <dig>  the structure-based phylogenetic tree of the family was rooted with a domain d1u60a from the glutaminase family, which also belongs to the β-lactamase/transpeptidase-like superfamily. the estb domain d1ci9a_ are grouped with class c β-lactamases and dd-peptidases, and it is structurally closer to the dd-peptidases d1pwga. c <dig>  c <dig>  and c <dig> represent the common structures of clades marked with circles. c <dig> represents the ancestor and thus the core structure of the β-lactamase family. the inserts are shown in blue: by comparing the structures of c <dig> and c <dig>  the first large insert can be identified as a segment with a small β hairpin and a short helix. in figure  <dig>  the insert is indicated in green on the d1ci9a_ variable region. from c <dig> to c <dig>  the loop between the two β strands of the first insert region grows longer. this is the second nested insertion , the yellow segment in figure  <dig>  the third nested insert is an extra β-hairpin  of the estb domain, which is red in figure  <dig>  it was inserted into the same variable region subsequently to the first hairpin insert in c <dig> 

phylogenetic consistency of signal
to validate the phylogeny and nested insertion events inferred with structure-based method, we also performed sequence-based phylogenetic analysis using the structure-based multiple sequence alignment . the unrooted sequence-based and structure-based trees are similar, and the stepwise growth of the same variable region is also detected in the sequence-based phylogeny. the topologies of the consensus trees inferred from bootstrap with distance method and the maximum likelihood method phyml are consistent. a sequence-based phylogenetic tree is shown in figure  <dig>  and the confidence values of branches produced with bootstrap method in  <dig> replicates is also shown. the main difference between the structure-based and sequence-based trees is the location of root. given the inherent low sequence similarity within this dataset, a consistent "rooting" of this tree is not expected. the consensus structures of the node list from root c <dig> to d1ci9a suggest the iterative growth of the variable region along the path within the structure-based phylogeny . the consensus structures c <dig>  c <dig>  and c <dig> and their sequence in the node list of sequence-based phylogeny are the same as those of structure-based method. the sequence of ancestral consensus structures indicates a probable sequence of insertion events on the evolutionary path from root to the domain d1ci9a.

the estb has a structural homology to β-lactamase, but shows no β-lactamase activity even though the nature and arrangement of active-site residues is very similar between estb and the homologous β-lactamase. modeling studies suggested steric factors account for the enzyme's selectivity for ester hydrolysis versus β-lactam cleavage  <cit> . one of the steric factors comes from the nested insert. the insert hairpin covers part of the active site entrance in estb, which may affect the enzyme's selectivity by narrowing the access path to the active site tunnel. the stepwise nested insertions observed in the evolution of estb demonstrate that the stepwise nested insertions can create novel complex sub-structure and affect the function of protein.

discussion
applicability of the structure-based phylogenetic method
for sequence-based phylogeny, manual editing of alignments is necessary to remove variable/gapped regions, and most methods cannot provide a reliable tree when the similarity amongst sequences is low. in contrast with sequence phylogenies, the substructures of a protein which are not suitable for sequence-based phylogeny actually constitute a source of phylogenetic signal. the structure-based phylogeny is thus expected to be more robust than sequence-based methods when domains in a family have low to very-low sequence similarities and regions which cannot be unambiguously aligned.

the scop database contains families with low sequence identity  despite having very close structures and functions  <cit> . these families are appropriate for tertiary structure phylogeny because more distant homologs usually have more insertions and structural variations. several works have utilized structure-based methods to study these scop families with low sequence homology, including the β-lactamase/d-ala carboxypeptidase family  <cit> , the class ii aminoacyl-trna synthetase -like family  <cit> , and the short-chain alcohol dehydrogenases family  <cit> .

the structure-based distance metrics used in this work provide a reasonable estimate of phylogenetic distance. several protein structural distance measures, including root mean square distances   <cit> , and hausdorff distance of loops  <cit> , and qh  <cit> , have been applied to phylogenetic analysis. the distance metric qh adopted in this work, which considers the differences of the aligned segments and the non-aligned gap regions simultaneously, has been successfully applied to study the evolution of structures in aminoacyl-trna synthetases  <cit> , and has been built into the molecular modeling software vmd since version  <dig> . <dig>  based on previous work and our results, the topologies of trees inferred with qh distance are generally consistent with results of sequence-based methods. however, it is important to note that consistency with sequence-based phylogeny in difficult cases does not constitute a definitive proof of the suitability of qh at capturing phylogenetic distances.

effect of flexible structural alignment
many programs for the alignment of protein structures have been developed. most structural alignment methods, such as ce  <cit>  and dali  <cit> , assume that protein molecules are rigid bodies. this assumption is made despite the knowledge that many proteins are flexible molecules. the validity of the rigid body assumption is further questionable for variable regions since it is usually more flexible than the conserved core of the structure. when flexible molecules in different conformations are compared to each other as rigid bodies, even strong structural similarities can be missed. several flexible structural alignment algorithms including flexprot  <cit>  and fatcat  <cit>  have been developed to solve the problem. in this study, flexible structural alignment method fatcat was used to generate the pairwise structural alignment.

because the information used for phylogeny relies on structural distances, a reliable alignment of regions with higher structural variability is very important. although some sub-structures may be homologs, the presence of a flexible hinge may cause a rigid body structural alignment method to fail to detect similarity. the structural alignment of protein 2ak <dig> and 1aky is such a case. the flexible regions of 2ak <dig>  and 1aky  have similar conformations but interact differently with the rest of the protein. the structures of the two domains and the flexible structural alignment created by fatcat are illustrated in figure  <dig>  because this type of signal is critical to our analyses, we used the flexible structural alignment algorithm fatcat to generate the pairwise alignments of domain structures. the contributions of flexible structural alignment have been extensively discussed before  <cit> .

accuracy of structure-based multiple sequence alignment
the accuracy of the structure-based multiple sequence alignments produced with the alignment tool developed for this study has been tested with a hard benchmark sabmark <dig>   <cit> . the average developer scores of our method for the superfamily and twilight sets in sabmark are  <dig>  and  <dig> , respectively. the average developer scores of t-coffee are  <dig>  and  <dig> , respectively. the accuracy of the method proposed in this paper is thus sufficient to perform subsequent phylogenetic analyses on more difficult, sequence-based problems. the effect of using more accurate alignment methods on the phylogeny of distantly related sequence will be tested in the future.

there are a few databases providing protein structure-based alignments for homologous families, including homstrad  <cit>  and pali  <cit> . the structure alignment methods used by homstrad and pali were comparer  <cit>  and stamp  <cit> , respectively. in general, the structure-based sequence alignment can improve the accuracy of sequence alignment especially when sequences are distantly related. both comparer and stamp are rigid-body superposition programs. in this study, the multiple structure-based alignments of homologous families were produced by flexible alignment algorithm fatcat. as discussed in the "effect of flexible structural alignment" section, the flexible alignment method is very important for improving the accuracy of alignments.

CONCLUSIONS
the signal provided by the tertiary structure of protein domains was used to infer phylogenies. it is important to contrast the nature of sequence and structural signals. the signal from structures is generated by the similarity of the shared regions  and the presence and magnitude of differences of their variable regions . it is unclear whether the signal provided by the distance between the structures of the conserved cores reflects evolutionary distances. as cores are assumed to remain constant over time, the difference between sequences may be restricted to the presence and structure of the variable regions. an important caveat, our reconstruction of sequences of insertion did not account for the influence of deletion. deletions in this context would appear as simultaneous insertions events in all other lineages. this would systematically increase the distance to all other related structures that are conserving the deleted segment. the effect of deletions on phylogenies would, therefore, bias this lineage toward the root of the tree.

it is clear that the underlying process of evolution of sequence and structure are different: homologous positions in sequences are subjected to a substitution process while their geometry is assumed to remain constant. the relative stability of structure over time, however, suggests that some of the tertiary structures contain phylogenetic signals that persist beyond the saturation of the substitution process of their coding sequence. the consequence to this is that 3d signal can be used to tackle questions spanning at unreachable evolutionary depths up to now.

one of these questions is whether a parsimonious process of innovation can be inferred from existing domain structures. as structural innovation is expected to be infrequent and spanning evolutionary distances which are not tractable at the sequence level, we constructed tertiary structure-based phylogenies. we reported that inserts which appear to have evolved iteratively are longer, more complex and some appear to be novel. for this reason, we propose that the methodology presented in this work is an early step to use tertiary structure phylogenetic analysis to study the evolution of structures and functional diversification.

