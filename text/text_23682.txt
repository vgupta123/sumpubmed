BACKGROUND
one of the most important elements of an organism’s biochemistry is its ability to produce energy in the form of atp from nutrients in the environment under a wide variety of environmental conditions. energy production pathways are of fundamental importance because these pathways define much of the behavior of a microbe and have the greatest impact on the quantitative prediction of biomass and metabolite production yields  <cit> . cellular energy generation in microbes is a crucial aspect of metabolic modeling, which depends on environmental factors such as carbon source, electron donor, fermentation capability, presence of electron acceptors, and variations in the electron transport chain .

metabolic models provide a valuable means for simulating and understanding energy metabolism based on annotated genome sequences  <cit> . recently, tools such as the model seed  have emerged to automate the generation of draft metabolic models to keep pace with the ever growing set of sequenced genomes. however, automatically reconstructed models, and even some curated models, struggle to represent energy biosynthesis accurately primarily for three reasons:  genome-scale models integrate complex interweaving pathways that, when under-constrained, can interact to form routes for energy production that are not biologically meaningful or even physically feasible;  poor representation of complex and diverse bacterial etcs and the key pathways related to energy production; and  these models often require extensive gapfilling  <cit>  that can lead to the inclusion of some pathways that are not actually present in the species being modeled.

here we present a set of tools and analyses aimed at a focused understanding of energy biosynthesis across the prokaryotic tree of life. building on important early work in metabolic modeling and engineering  <cit> , we define a “core metabolic model” , which has a reduced scope consisting of well-annotated central metabolism, fermentation, and etc pathways. we developed a new high-throughput pipeline for the reconstruction, comparison, and analysis of cmms for prokaryotic genomes . then we applied our pipeline to the reconstruction and analysis of cmms for over  <dig>   completely sequenced prokaryotic genomes . the cmms produced by our pipeline had minimal need for gapfilling, demonstrating a key value in cmms as functional models that are as close as possible to raw annotation output, minimizing model-driven conjectures. in tests of the atp yield on our models, the results show nearly complete agreement with known values for model organisms. most importantly, comparative analysis of our core models revealed substantial variation in energy biosynthesis strategies and pathway representation, including variations even at short phylogenetic distances. we observe only a small fraction of theoretically possible combinations of these pathways, with both positive and negative correlations in energy biosynthesis pathways, suggesting a limited number of optimal pathway configurations.fig.  <dig> core metabolic model construction pipeline. the pipeline starts with gene annotations provided by rast annotation pipeline of assembled microbial genomes. next, the cmms are constructed based on a manually curated cmt that consists of biochemical reactions derived from phylogenetically diverse set of model organisms including escherichia coli, bacillus. subtilis, pseudomonas aeroginosa, clostridium acetobutylicum, and paracococcus denitrificans. in the final step, fba is performed optimizing the biomass or atp hydrolysis as the objective function



RESULTS
core model reconstructions and patterns in pathway co-occurrence
we applied our new core model reconstruction pipeline  to generate  <dig>  cmms belonging to  <dig> major phylogenetic groups . cmms were constructed based on a core model template  that consists of a highly curated set of biochemical reactions derived from a diverse set of model organisms. we selected ~ <dig> unique reactions  that comprise  <dig> key energy biosynthesis pathways linked to central metabolism  and variations of bacterial etcs . these pathways include glucose oxidation pathways and fermentation pathways . the presence and absence of each pathway was determined using a set of boolean rules  based on reactions present in the cmm .fig.  <dig> phylogenetic distribution of cmm pathways and pathway co-occurrence in central metabolism. presence and absence of  <dig> key pathways related to energy metabolism including glucose oxidation pathways  and fermentation pathways  computed using boolean rules. taxonomic groups that are displayed in the horizontal axis of the graph were sorted sequentially as they appear in a 16 s rrna based phylogenetic tree. the distribution patterns of these key pathways among major phylogenetic groups and pairwise comparisons of pathway presence or absence shows that most pathways are positively correlated. blue pie slices show comparisons with positive correlations in the clockwise direction while red pie slices show negative relationships in the counterclockwise direction. relationships shown in pies outlined in bold were consistent across all size classes. increasing strength of correlation is denoted by increased pie slice size as well as color intensity. empty pies are relationships that are not significant at p <  <dig> . filled pies are self-comparisons



although the pathways included in cmms are fundamental to energy generation, not all pathways are present in every genome. individual pathways were annotated as present in as few as  <dig>  and as many as  <dig>   genomes. we examined pairwise relationships among all pathways present in cmms in order to understand variation in core metabolism across this diverse set of microorganisms. in this analysis, we filtered out  <dig> cmms from our dataset because their associated genomes were overly close phylogenetically to other cmms . we found an overall pattern of positive co-occurrence  among pathways suggesting that core metabolism is diverse, yet consists of a set of interdependent sub-modules. once we controlled this analysis for cmm size , we found slightly fewer positive co-occurrences, with small cmms having 62 % positive co-occurrences, medium cmms having 71 % positive co-occurrences, and large cmms having 79 % positive co-occurrences. we found little evidence to support the idea of substrate competition among pathways  <cit> , regardless of cmm size, despite many fermentation pathways deriving from the same substrate. to the contrary, the two strongest positive correlations were between pairs of pathways that branched from a single substrate: the butanol and butyrate pathways  and the acetate and ethanol pathways . fermentation pathways deriving from the same substrate tended to have strong positive relationships among themselves and also tended to respond similarly to the presence or absence of other pathways .

seven negative relationships between pathways were identified, with five of these being consistent across cmm size classes. these consistent negative co-occurrences may represent physiological trade-offs between adaptation toward maximizing biomass yield and growth rate. a yield versus growth rate trade-off has been previously suggested  <cit> , and is supported by the multiple negative relationships with the entner-doudoroff  pathway observed here. for example, we found a negative correlation between ed and glycolysis. ed is found in a wide range of genomes, despite having a lower atp production efficiency  <cit> . meanwhile, glycolysis is more efficient with twice the atp yield, but it incurs a greater enzymatic cost  <cit> , potentially leading to slower growth than ed . ed also had non-positive relationships with fermentation pathways containing three or more reactions . these longer fermentation pathways were found primarily in fermentative anaerobes expected to grow under energy-limited conditions, which have been shown to favour energy-efficient glycolysis  <cit> . in these organisms, continued selection pressure for maximizing atp production may have led to an overall negative relationship between these fermentation pathways and ed.

etc variations, predictions and atp yield in core models
as metabolic models generally require an objective function  that is optimized during flux balance analysis  to predict flux profiles, we explored two ofs . in order to quantitatively predict energy biosynthesis in cmms, we used the atp hydrolysis reaction  as one of. using this of we performed fba on seven minimal media conditions  with a range of electron acceptors to determine the atp yield under various environmental conditions . these models were not subjected to gapfilling and the predictions were based solely on reactions derived from existing annotations. atp production depended on the carbon source used, type of electron acceptors available in the media, and the ability to recycle cofactors through the fermentation pathways. this analysis demonstrated a strong capacity for cmms to capture variations in growth yields and flux profiles based on the electron donor and acceptors present in the media . when grown in the presence of oxygen, facultative anaerobes, such as escherichia coli and pseudomonas putida preferentially use oxygen as the preferred electron acceptor  <cit> . thus aerobic conditions using glucose as the primary carbon source resulted in the highest yields for these organisms, enabled by oxidative phosphorylation activity. fba simulations also showed variations in atp production among different carbon sources. for example, when e.coli or salmonella enterica were grown anaerobically in glucose or glycerol with nitrate as the electron acceptor, predicted atp production from glycerol  was lower than atp production from glucose , as expected given that glycerol is a more oxidized carbon source . we also note that when cmms are grown aerobically, in some cases the flux distributions show that they use aerobic respiration in combination with fermentation. we notice that about 12 %  of the models that are able to produce atp show this behavior. this result agrees with observed behavior when organisms are grown under laboratory conditions . variations in anaerobic respiration also resulted in differing yields due to differences in the number of protons pumped out of the cell membrane in response to particular electron acceptors and due to differences in the degree of substrate-level phosphorylation. some obligate anaerobic organisms belonging to the class clostridia  have neither aerobic nor anaerobic respiration; hence such organisms use fermentation as the sole means of atp production  <cit> . their yields in our simulations were constant regardless of the electron acceptors present . thus, cmms are accurate enough to capture atp yields by integrating only relevant etcs based on consistent rast annotations. our e. coli model predicts atp yields under aerobic respiration and anaerobic fermentation that closely agree with the theoretically determined values described in kaleta. et al and muir. et al respectively  <cit> . specifically, we predict  <dig>  mmol atp/mmol of glucose during aerobic growth  and  <dig>  mmol atp/mmol of glucose during anaerobic fermentation . furthermore, analysis of cmms shows that organisms such as bacillus subtilis or streptomyces coelicolor, which are classified as obligate aerobes in the public domain, in fact do have the ability to respire anaerobically in the presence of nitrate. these predictions are in agreement with previous studies done on these organisms  <cit> . analysis of cmms can shed light on respiratory capabilities of any sequenced bacterium and generate hypotheses regarding which sets of environmental conditions favour its activity. a complete list of fba results from our cmm simulations can be found in additional file 2: table s <dig> fig.  <dig> predictions of atp yields using fba on selected core models. the atp yield predictions were simulated in presence of aerobic, anaerobic electron acceptors  and without any electron acceptors. glucose or glycerol was used as the carbon source. labeled bars show the mmol of atp/mmol of glucose/glycerol for escherichia coli k <dig> and clostridium botulinum a str. atcc  <dig>  atp hydrolysis is used as the of for fba simulations



fermentation is an essential process for obligate anaerobes to produce atp and for many facultative anaerobes, which use it to produce atp when suitable exogenous electron acceptors are not present. it is also important for metabolic engineering applications, as it is a primary means of producing many biofuel molecules. analysis of cmms for the ability to produce fermentation products showed that obligate anaerobes and facultative anaerobes are able to use a variety of fermentation pathways when oxidizing sugars under anaerobic conditions. for example, fba simulations of a taxonomically diverse set of organisms including facultative anaerobes and anaerobes grown in glucose solely by fermentation, show atp yields around 2 mmol atp/mmol of glucose for wide range of bacteria  <cit>  . in our analysis we found that fermentation pathways, including formation of formate, ethanol, and acetate, are conserved in the classes bacilli and alpha, gamma and beta preoteobacteria . 91 % of acetate, 93 % of ethanol and 84 % of formate producing pathways are present in models belonging to one of those four classes. volatile fermentation products such as acetone, butyrate, butanol, and  <dig>  butanediol  are conserved mostly in organisms belonging to the bacilli and clostridia classes. a complete list of fba results from these simulations can be found in additional file 2: table s <dig>  a complete list of the organisms and the presence and absence of fermentation pathways can be found in additional file 2: table s <dig> 

coverage of the core model template
our reconstruction of cmms for over  <dig> microbial genomes provides a means of evaluating the extent to which the annotations and biochemistry comprising our core-model template are sufficient to capture at least one of the energy biosynthesis strategies for each sequenced organism used in this study. to conduct this evaluation, we simulated fba on all cmms in seven media conditions using atp production as the of. our analysis shows that about  <dig>   of the cmms have some type of aerobic electron transport chain , whereas about  <dig>   have an anaerobic etc; and  <dig>   of cmms do not have any etc. furthermore, we see that  <dig>  models  were able to produce atp in glucose minimal media aerobically, while up to 61 % of the cmms were able to produce atp with each of the alternate electron acceptors  examined here.  <dig>   cmms were able to grow solely by fermentation when no electron acceptors were present. if aeas were present in the medium, then cmms with etcs tended to use anaerobic etcs via reduction of the terminal aeas. this study demonstrates that using cmms in standard fba while maximizing energy production can produce accurate predictions for a wide range of organisms.

we also identified  <dig>   cmms those were unable to produce atp under any of the tested conditions . we found two explanations for the lack of atp production in these species:  many species are parasitic and have lost key genes in their central metabolism which results these organisms unable to oxidize glucose or glycerol to produce energy and biomass, and  annotation inconsistencies or missing annotations in the respective genomes. to explore the extent of key missing reactions in central metabolic pathways, we simulated the cmms with a biomass of based on biomass precursor stoichiometry derived by varma and palsson . models were subjected to gapfilling  <cit>  using glucose as the sole carbon source and oxygen as the electron acceptor. our analysis shows  <dig>  models  across different phyla did not require any gapfilling to produce all  <dig> central carbon biomass precursors . of the remaining  <dig>  models that required gapfilling,  <dig>   required five or fewer reactions to be added or modified in order to generate all biomass precursors . it is possible that these models did not grow on glucose because they lack the pathways needed to utilize glucose as a sole carbon source. thus we explored the capacity of these models to utilize one or more alternative carbon sources, including glycerol, lactate, succinate and ribose. this study revealed that only a small percentage of the models that failed to grow on glucose  were able to utilize one of these alternate carbon sources instead . from this result, we can conclude that most of the models that fail to grow on glucose do so because of gaps in the biosynthetic pathways for the production of one or more biomass precursor compounds. we applied flux balance analysis with these models to identify which specific biomass precursors could not be produced by each model. this data is provided in additional file 2: table s <dig> fig.  <dig> number of gapfilled reactions that are required in cmms in order to produce all biomass precursors. blue bars represent the gene-associated reactions and the red bars represent the gapfilled reactions for all cmms used in this study. the height of the bars represents the number of reactions. cmms are grouped according to taxonomical groups



in our gapfilling analysis, we found that over  <dig> organisms were missing an annotation for the anaplerotic reaction “pyruvate carboxylase ” that is required to supplement oxaloacetate during glucose oxidation in gram positive bacteria  <cit> . among heavily gapfilled models, many of the organisms that were identified belonged to genera known for either parasitic or pathogenic lifestyles including streptococcus, clostridium, lactobacillus, bifidobacterium, enterococcus, helicobacter, and campylobacter as well as more apparently parasitic bacteria with small genomes in the genera rickettsia, ureaplasma, borrelia, chlamydia, treponema and mycoplasma  <cit>  . these organisms lack the ability to synthesise a range of intermediates in central metabolic pathways, primarily in the tca cycle, which prevent their growth in glucose. in addition, this analysis was able to capture the reactions and metabolites that are absent in these organisms due to a loss of genes in glycolysis, pentose phosphate pathway, and the tca cycle, which are the key precursors for synthesis of amino acids, vitamins, cofactors and lipids  <cit>  . we suggest that this type of analysis is useful in screening likely parasitic organisms. a complete list of organisms and their gapfilling analysis is available in additional file 2: table s <dig> 

exploration and analysis of cmm pathways in a phylogenetic context
we explored the potential presence of annotation inconsistencies in our models by examining cmm biochemical pathways within a phylogenetic context . we found that missing or incorrect annotations can be systematically recognized and fixed with high accuracy when genome annotations are analysed in the context of biochemical pathways. having the ability to visualize these pathways with respect to phylogenetic relationships , annotators can see the propagation of incorrectly annotated pathways in closely related genomes in order to correct them. we also demonstrate the value of focusing on the most well curated pathways first, as with these pathways errors may be more easily separated from novel biology.

in our analysis we identified multiple missing or incorrect annotations including transporter genes, key genes in central metabolism and fermentation pathways. for instance, through our analysis we noticed an aerobic etc present in obligate anaerobes belonging to the genus bacteroides. this error was due to an incorrectly annotated “ubiquinol cytochrome oxidase” gene throughout this genus. usually ubiquinol-based cytochrome oxidases could not be found in obligate anaerobes. we corrected this issue in our models. additionally, we improved the specificity of our annotations where appropriate, such as “cytochrome o ubiquinol oxidase subunit iv ” instead of “ubiquinol cytochrome oxidase”. we then integrated these new more-specific functions into our template. we also noticed that the genus acinetobacter does not appear to have functional glycolysis or ed pathways for the degradation of glucose, yet previous studies have suggested that many acinetobacter species are able to utilize the ed pathway for oxidization of glucose  <cit> . we found that all enzymes in the ed pathway are consistently annotated in acinetobacter except for the enzyme “gluconolactonase  <dig> . <dig> ”. this apparent inconsistency may in fact be biologically accurate, because the reaction catalysed by this enzyme has been shown to occur spontaneously, and thus the enzyme may not be necessary in every organism containing the broader pathway  <cit> .

it has been known that some members of streptococcus produce formate during fermentation  <cit> , yet no annotations representing formate transporters were found within the streptococcus genus. we also identified key missing gene-protein reaction associations within the cmm template, such as polyphosphate glucokinase , a gene that is abundant in many actinobacteria  <cit> . annotation inconsistencies can be a result of multiple factors including poorly sequenced areas of the genomes, assembly errors, and missed or incorrectly assigned annotations. through this study we also determined that the genome annotations associated with important reducing reactions for iron, chromium, sulphur, and sulphur derivatives are either not present or not fully propagated among the rast annotated genomes. in rast, the consistent propagation of functional annotations is driven by the creation, curation, and maintenance of annotation subsystems  <cit> . often, when a subsystem is missing, this is due to a lack of literature data required to accurately assign constituent functions across a diverse set of microbial genera. proper annotation of these reducing reactions will ultimately permit the prediction of at least one energy production strategy for additional organisms, further improving the coverage of energy production by our cmms. the approach we used in this study to explore and identify inconsistent or missing annotations in our cmms by evaluating the coverage of our core model template, comparative analysis of complete biochemical pathways across the microbial tree of life, and gapfilling analysis all represent promising routes to producing consistent annotations.

CONCLUSIONS
here we present cmms and comparative analysis for over  <dig>  completely sequenced genomes in diverse phylogenetic groups that are derived from a manually curated core model template. unlike the complexity of genome scale models, cmms are simpler, offering a quick and accurate way of determining:  respiration type  and atp yield predictions ,  electron acceptors that can be reduced during anaerobic respiration ,  ability to produce useful fermentation products ,  presence/absence of functional pathways in central metabolism  and  evaluate ability to produce key pathway intermediates in central metabolism which are precursors of essential biomass compounds . having integrated a set of highly curated reactions that represent etcs, fermentation, and central metabolic pathways, cmms are able to predict atp yield variations under aerobic and anaerobic conditions mediated by anaerobic electron acceptors present in the growth medium   <cit> . using glucose or glycerol as the sole carbon source, we found ~30 %  of the genomes  used in this study could not be simulated to produce atp solely based on existing rast annotations due to incomplete or missing annotations that mapped to reactions comprising the energy producing pathways and etcs. a major piece of missing etcs consisted of key reducing reactions for inorganic electron acceptors including iron, chromium, and sulphur that are not consistently annotated across the prokaryotic tree of life. annotation inconsistencies and missing annotations identified in this study evaluate the quality of rast annotations and highlight the areas where more attention is needed. metabolic pathway determination data  and respiration type determinations  are a valuable resource in recognizing inconsistent annotations across the tree of life, even at short phylogenetic distances. using pathway determinations we identified patterns in pathway co-occurrence and identified potential physiological trade-offs that may influence the ability of organisms to maintain individual central metabolic pathways . while these tools and analyses were developed specifically to examine central metabolism, the approach is easily scalable to consider the entire metabolic network or other subsets of metabolism of interest enabling researches to address specific research goals.

