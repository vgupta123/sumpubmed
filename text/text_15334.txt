BACKGROUND
previous gene co-expression studies
in recent years, we have witnessed a deluge of new results coming from genome-wide microarray experiments, and the torrent of data seems likely to increase in the future. in particular, thousands of microarray data sets from experiments on the organism arabidopsis thaliana based upon the affymetrix ath <dig> genechip microarray platform have been accumulating in data repositories such as geo  <cit> , arrayexpress  <cit> , and nascarrays  <cit> . gene co-expression analysis has emerged as a powerful tool in analyzing this information. in contrast to standard microarray experiments in which gene expression levels in a set of control and treated plants are measured and compared to find differentially expressed genes, co-expression analyses work on much larger datasets comprised of many experiments. similar gene expression patterns can be observed across many treatments, instead of being limited to just one.

in general, gene co-expression studies fall into two broad categories: condition dependent and condition independent  <cit> . condition independent studies use as many unique conditions as possible and a co-expression score between gene pairs  is calculated. this analysis reveals underlying relationships between genes irrespective of tissue type, experimental stimuli, or developmental stage. condition dependent studies are a more specific type of analysis, in which samples in the dataset are restricted by certain criteria such as tissue type or experimental stimuli such as abiotic stress or hormone treatment.

in an elegant condition dependent study by bassel et al. <cit> ,  <dig> microarray samples from imbibed mature arabidopsis seeds were used to investigate genes involved with seed germination. pearson correlations between gene expression profiles were calculated, and agglomerative hierarchical clustering revealed the existence of three large clusters of gene interactions. the gene correlation network created in the study revealed connections between genes known to be involved in the regulation of seed germination, with other genes whose function was unknown.

the idea of ‘guilt by association’, forming hypotheses concerning the biological role of genes based upon similar patterns of gene expression, plays an important role in co-expression analysis  <cit> . in a study by lee et al. <cit> , a probabilistic network  of functional associations was constructed using network-guided guilt by association. in this study, a diverse collection of functional genomics, proteomics, and comparative genomics data sets for arabidopsis were integrated together. functional gene relationships were then calculated based upon this extensive experimental data to form aranet. the biological role of new candidate genes is inferred by measuring their network associations with genes in aranet whose functional role has been determined experimentally. a similar approach was taken in a condition-dependent study by schmid et al.  <cit>  which analyzed global gene expression patterns from the atgenexpress data series taken from samples covering the developmental stages of arabidopsis. results from this study indicate substantial overlap in gene expression activity between samples. interestingly, histograms of relative gene expression values taken from samples from the root, leaf, apex, and pollen samples of the plant showed marked differences.

in a condition independent study by atias et al. <cit> , gene expression profiles from  <dig> microarray experiments conducted on arabidopsis thaliana were analyzed. their data is comprised of  <dig> hybridization samples collected under a wide variety of experimental conditions at different times and across  <dig> different laboratories. within the microarray samples comprising each experiment in the experimental series, they calculated the pearson correlation coefficient between all gene pairs. only highly correlated gene pairs appearing simultaneously in  <dig> of the  <dig> experiments were considered for further analysis. a novel scoring function developed for the study allowed them to measure the degree of correlation for gene expression profiles spanning the entire dataset. this was then used to develop a gene correlation network. an excellent discussion and overview of different co-expression studies is presented in a study by usadel et al.  <cit> .

the model organism arabidopsis thaliana
arabidopsis thaliana is popular as a model organism in the plant sciences. it has one of the smallest genomes in the plant kingdom , approximately  <dig>  genes. currently the function of about half of these genes are unknown. arabidopsis fulfils the same role in plant biology that drosophila melanogaster and mice play in animal science. although arabidopsis is not an agriculturally useful plant, many of the genes within its genome are homologous to genes in plants with more complex genomes, and often play similar roles within these organisms. it is particularly useful in studying the biology of flowering plants. this is the primary reason we chose to focus on arabidopsis in our research. by formulating biological hypotheses concerning many of the unknown genes, we hope our research will serve as a guide for planning future microarray experiments.

the nmf algorithm
the nmf algorithm was first introduced in  <dig> by lee and seung  <cit> . it is in the same class as other dimensionality-reducing algorithms like principal component analysis  and vector quantization . in contrast to the more holistic data representations returned by pca and vq methods, the nmf algorithm provides a local, parts-based representation of the data. when applied to a gene expression dataset, the nmf algorithm finds metagenes composed of correlated genes representing a local or global gene expression pattern. in contrast to more traditional clustering methods such as hierarchical clustering, genes can appear in multiple metagenes and are not constrained by the algorithm to be a member of only one cluster. the nmf algorithm is capable of finding clusters of genes co-expressed on a small set of experiments as well as genes co-expressed globally. more importantly, the algorithm allows genes to be in different clusters at different activation levels, instead of being placed in just one cluster. both of these features make the nmf method an ideal candidate for analyzing the atgenexpress dataset.

nmf has been applied with considerable success to gene expression datasets other than arabidopsis <cit> . in a study by brunet et al. <cit>  the nmf algorithm was used to reveal cancer subtypes by clustering human tumor samples, and to find metagenes involved in leukemia and brain cancer datasets. they also developed a novel method for finding the optimum number of metagenes intrinsic to a dataset. we incorporated this method into our study.

RESULTS
the atgenexpress dataset
atgenexpress is a large global research project whose purpose is to discover the transcriptome of the model organism arabidopsis thaliana. the datasets were downloaded from the ncbi gene expression omnibus  <cit> . the combined dataset is comprised of  <dig> samples over  <dig> different experimental series . this is a condition independent study involving many different type of stimuli and experimental conditions. since nmf algorithm has been applied with much success in gene co-expression studies on human tissue samples, we were interested to see how it would fare when applied to arabidopsis. we are looking for genes co-expressed locally on specific experiments as well as globally.

selecting the dimensionality reduction parameter for the nmf algorithm
an important part of the nmf algorithm is that it reduces the dimensionality of the original data space to a much smaller dimension k. thus it is important that we choose the optimal value for k which decomposes the dataset into k metagenes/encoding coefficients. in figure  <dig>  the cophenetic correlation coefficient  is plotted against different k values in the range k = 5… <dig>  the ccc is a measure which quantifies the stability of a dimensionality reduction parameter k. for stable values, it will be close to  <dig>  and for unstable values, it will be close to  <dig>  peaks in the plot represent stable values, but we were also looking for consistency . based upon these considerations, we felt k =  <dig> was an optimal choice. the method for generating this graph was adopted from the study by brunet et al. <cit>  and is explained in the methods section.

the metagenes and encoding coefficients
analysis of the dataset involved applying the nmf algorithm to reduce the dimensionality of the data to a set of metagenes, and associated encoding coefficients. each metagene represents a collection of genes behaving in a functionally correlated fashion within the genome. the encoding coefficients express the degree of activation of each metagene on each sample within the dataset. see the methods section for details.

each gene within a metagene has an activation level which represents the degree to which that gene is expressed. the metagenes were sorted in descending order according to the activation levels of their genes, and the genes within each metagene were also sorted in descending order. metagene  <dig> represents the most highly expressed metagene within the dataset, and metagene  <dig> the least highly expressed. some of the genes in the metagenes have been well-studied, while others have not been annotated at all. table  <dig> below displays the top  <dig> genes involved in metagene  <dig>  a list of all the metagenes is given in additional file  <dig> 

metagene involvement in experimental series
the encoding coefficients returned by the nmf algorithm measure the degree to which each metagene is active in each of the  <dig> samples within the dataset. multiple samples comprise an experiment, and through an application of the kruskal-wallis test  <cit> , it is possible to determine on which series of experiments each metagene is active on. figure  <dig> is a heat map of the z-values returned by the kruskal-wallis test for each experiment in the atgenexpress dataset. information about how this figure was generated can be found in the methods section.

one striking feature in figure  <dig> is that metagenes  <dig>   <dig> and  <dig> are the dominant metagenes involved in the stress series of experiments, and appear to suppress the other metagenes in that series. these metagenes also represent the most actively expressed metagenes our analysis uncovered. results from examining their functional annotation in david   <cit>  appear to confirm this. the top five most highly enriched categories for the three metagenes are shown in table  <dig>  metagenes  <dig> and  <dig> are primarily involved in responses to stimuli . metagene  <dig> is involved in photosynthetic responses related to light stimuli, as well as the generation of precursor metabolites used in catabolic and anabolic pathways to generate atp or in the synthesis of more complicated organic chemicals such as lipids, amino acids, and nucleotides. another interesting feature of figure  <dig> is that metagenes  <dig>   <dig>   <dig> and  <dig> appear very active in the developmental series related to shoots and stems, while all of the other metagenes are suppressed.

functional characterization of metagenes using gene set enrichment analysis
gsea  <cit>  was applied to the metagenes returned by nmf. the gsea algorithm accepts as one of its inputs a ranked list of genes. the ranking scheme is specified by the researcher to highlight some feature they are interested in. since the coefficient of a gene in a metagene correlates to a general degree of expression within that metagene , the metagene coefficients provided a useful way to rank the genes in the metagenes for input into gsea.

metagene involvement in three gene ontologies  was examined and the results for the biological processes ontology are summarized in figure  <dig>  only gene ontologies enriched with a nominal p-value of less than  <dig>  were examined.

the nes  is a measure of the enrichment of a metagene within a gene ontology – and is the value plotted in figure  <dig>  the interpretation of this measurement is discussed in the methods section on gsea, and the spreadsheets from which this heat map was generated  are included in additional file  <dig>   <dig>  and  <dig>  results for the cellular components and molecular functions ontology are summarized in additional file 5: figure s <dig> and s <dig>  respectively.

in figure  <dig>  some metagenes appear to be involved in a number of different biological processes, while others are involved in only a few. metagene  <dig> is active on biological process ontologies involving responses to light, as well as those involved with defense responses to bacterium and funguses. it is also active in a variety ontologies related to stress response experiments such as water deprivation and response to wounding. an examination of figure  <dig> reveals that it is a dominant metagene involved in the stress series of experiments. in contrast to this, metagene  <dig> is involved only in three different biological process ontologies . looking at figure  <dig> reveals that it is strongly suppressed on the developmental series of experiments related to shoots and stems, but expressed on experiments for responses to bacterial derived elicitors. it is not very active on the other experimental series.

metagenes  <dig>   <dig> and 5
we observed in figure  <dig> that metagenes  <dig>   <dig>   <dig> were the principal metagenes involved in the stress series of experiments. a closer look at the gsea analysis for these metagenes appears to confirm this.

in figure  <dig>  metagene  <dig> is enriched in a number of defense responses and responses to a wide variety of stimuli. moreover, metagene  <dig> is involved in a number of defense responses and responses to stimuli, and is also enriched in categories such as ribosome biogenesis and photosynthesis. metagene  <dig> is heavily enriched in lipid transport and catabolic processes involved in the breakdown of toxins – which would certainly make sense if it was active in the stress series of experiments.

metagene correlation network
to determine how the metagenes interact with each other, a spearman correlation matrix c was calculated by computing all pair-wise correlations between the metagenes.

 <dig>  each network node represents a metagene.

 <dig>  the size of each node is proportional to the metagene activity within the dataset.

 <dig>  a line is drawn between a pair of nodes if the p-value of their spearman correlation is less than 10- <dig> 

a. positive correlations are denoted by red lines

b. negative correlations are denoted by green lines

c. the width of the line is proportional to the strength of the correlation.

 <dig>  the pie slices within each node represent the amount of enrichment for specific gene ontologies as determined by gsea.

in the correlation network of figure  <dig>  metagene  <dig> is comprised of genes which are the most actively expressed across all samples within the dataset. it has a very strong positive correlation with metagenes  <dig> and  <dig>  metagenes  <dig> and  <dig> have a strong positive correlation. a close examination of the kruskal-wallis z-values for these two metagenes confirms this. metagene  <dig> is strongly expressed when metagene  <dig> is the most active during the stress series of experiments, and both metagenes are suppressed during the pathogen and developmental series of experiments. correlation networks for the gene ontologies of cellular components and molecular functions are available in additional file 5: figure s <dig> and figure s <dig>  respectively.

a comparison of metagenes with atias et al.
in the study by atias et al.  <cit>  a scoring function was developed that measures the correlation between gene pairs across different experimental series. the methodology for selecting and clustering genes in the atias study is fundamentally different than those employed here, so comparing the results from atias with ours is useful to verifying the results of this study.

atias created three different gene correlation networks based on the scoring threshold. for the  <dig> -threshold network, gene pairs with a score less than  <dig>  were filtered out of the analysis. using graph theoretic methods encapsulated within the mcode plug-in for cytoscape  <cit> ,  <dig> clusters of genes were identified. the same process was repeated to create the  <dig> -threshold network , and identified  <dig> clusters. a network generated from the pathogen series of experiments within their dataset was also created. this data subset includes microarray samples from  <dig> of the  <dig> arabidopsis experiments involved with pathogen treatments. within this network, mcode identified  <dig> gene clusters.

a hypergeometric test was used to determine the degree of intersection between the metagenes in this study, and the clusters identified in the  <dig> -threshold and pathogen networks of atias. see the methods section for details. a matrix of p-values for each of the networks was calculated. hierarchical clustering analysis on both metagenes/clusters from atias was then performed. the p-values in the heat maps shown in figures 6– <dig> were log <dig> transformed, and the bright green squares correspond to p-values less than or equal to 10- <dig> 

the atias network with a score threshold of  <dig>  contains  <dig> genes. of these,  <dig> genes are also contained within the metagenes discovered in this analysis. significant statistical overlaps were observed  between metagenes  <dig> and  <dig>  and clusters 1– <dig>  overlaps also occur between metagenes  <dig> and  <dig>  and cluster  <dig>  metagene  <dig> exhibits strong overlaps between clusters  <dig>   <dig>   <dig>   <dig>   <dig>  and  <dig> . most significantly , metagenes 1– <dig> , exhibited very strong overlaps with a large number of clusters identified by atias.

in both the study by atias and our study, portions of each dataset are comprised of microarray samples involved in pathogen experiments. in this study, metagenes  <dig>   <dig>   <dig>  and  <dig> are actively expressed in at least two out of the three pathogen series . see additional file 5: figure s <dig> for a heat map showing metagene involvement in the pathogen series.

examining the p-values of intersection for these metagenes with the clusters from the pathogen network in the atias study reveals many significant overlaps. not surprisingly, metagene  <dig> intersects with the most clusters. see additional file 5: figure s <dig> 

discussion
the three primary steps of the analysis conducted in this paper are:

 <dig>  filtering genes of interest based upon their expression activity on the samples.

 <dig>  finding the optimal number of metagenes intrinsic to the dataset and applying nmf. using the results of nmf to construct a metagene correlation network.

 <dig>  determining the functionality of the metagenes by applying gsea, and using nmf results to provide a ranking for the genes within each metagene.

in the study by lee and colleagues  <cit> , as well as the study by atias et al.  <cit> , step  <dig> was accomplished by ranking gene-pairs based on their frequency of correlation within experiments in the dataset. the benefit of using this approach is that differences in scale/resolution between different experiments are no longer an issue because the pearson correlation between two variables is invariant  to changes in location and scale of each variable. a drawback to this approach  is that it preferentially selects genes which are highly correlated with other genes across a large number of samples. genes which have correlated expression patterns with other genes on a small number of experiments could potentially be filtered out. the nmf algorithm is adept at finding genes like this, and so we chose a filtering scheme based on expression activity across all of the samples. despite using a different methodology for gene selection, significant overlaps between genes in the atias study and this one were observed.

a benefit of using the nmf algorithm instead of other algorithms such as hierarchical clustering, pca, or vq methods is that it does not constrain genes to belong exclusively to one cluster, so the method realistically models the way in which many genes perform different functional roles within the genome. there is also a way to approximate an optimum number of metagenes , which is not true of many other clustering methods.

in figure  <dig> in which the cophenetic correlation coefficient is plotted for different values of the k parameter, more than one peak was observed . a promising area of future research could be to calculate metagenes for different stable k-values and examine differences between them. it would also be interesting to see if applying gsea analysis to metagenes resulting from higher k-values results in more functionally specific metagenes than smaller k-values.

CONCLUSIONS
nmf analysis of the atgenexpress dataset revealed  <dig> metagenes representing collections of genes with correlated expression patterns . by combining the nmf results with z-values returned by the kruskal-wallis test, interesting interactions between the metagenes were revealed. some of the metagenes appear to act in concert to suppress other metagenes for some of the experiments while they are active . a metagene correlation network also revealed similar trends. application of gsea showed many interesting specializations of functions among the different metagenes, and it is hoped that the analysis presented here provides useful insight for planning future experiments.

